var AP=Object.defineProperty;var PP=(e,n,t)=>n in e?AP(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Ln=(e,n,t)=>PP(e,typeof n!="symbol"?n+"":n,t);function DP(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(r,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var Jc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var iv={exports:{}},Dm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IS;function IP(){if(IS)return Dm;IS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,s){var l=null;if(s!==void 0&&(l=""+s),a.key!==void 0&&(l=""+a.key),"key"in a){s={};for(var f in a)f!=="key"&&(s[f]=a[f])}else s=a;return a=s.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:s}}return Dm.Fragment=n,Dm.jsx=t,Dm.jsxs=t,Dm}var MS;function MP(){return MS||(MS=1,iv.exports=IP()),iv.exports}var i=MP(),av={exports:{}},Ut={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RS;function RP(){if(RS)return Ut;RS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=g&&A[g]||A["@@iterator"],typeof A=="function"?A:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function E(A,ae,ce){this.props=A,this.context=ae,this.refs=k,this.updater=ce||v}E.prototype.isReactComponent={},E.prototype.setState=function(A,ae){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,ae,"setState")},E.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function T(){}T.prototype=E.prototype;function I(A,ae,ce){this.props=A,this.context=ae,this.refs=k,this.updater=ce||v}var D=I.prototype=new T;D.constructor=I,S(D,E.prototype),D.isPureReactComponent=!0;var q=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},$=Object.prototype.hasOwnProperty;function B(A,ae,ce,M,de,Se){return ce=Se.ref,{$$typeof:e,type:A,key:ae,ref:ce!==void 0?ce:null,props:Se}}function z(A,ae){return B(A.type,ae,void 0,void 0,void 0,A.props)}function U(A){return typeof A=="object"&&A!==null&&A.$$typeof===e}function L(A){var ae={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(ce){return ae[ce]})}var R=/\/+/g;function G(A,ae){return typeof A=="object"&&A!==null&&A.key!=null?L(""+A.key):ae.toString(36)}function ee(){}function te(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(ee,ee):(A.status="pending",A.then(function(ae){A.status==="pending"&&(A.status="fulfilled",A.value=ae)},function(ae){A.status==="pending"&&(A.status="rejected",A.reason=ae)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function oe(A,ae,ce,M,de){var Se=typeof A;(Se==="undefined"||Se==="boolean")&&(A=null);var fe=!1;if(A===null)fe=!0;else switch(Se){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(A.$$typeof){case e:case n:fe=!0;break;case h:return fe=A._init,oe(fe(A._payload),ae,ce,M,de)}}if(fe)return de=de(A),fe=M===""?"."+G(A,0):M,q(de)?(ce="",fe!=null&&(ce=fe.replace(R,"$&/")+"/"),oe(de,ae,ce,"",function(_e){return _e})):de!=null&&(U(de)&&(de=z(de,ce+(de.key==null||A&&A.key===de.key?"":(""+de.key).replace(R,"$&/")+"/")+fe)),ae.push(de)),1;fe=0;var we=M===""?".":M+":";if(q(A))for(var ie=0;ie<A.length;ie++)M=A[ie],Se=we+G(M,ie),fe+=oe(M,ae,ce,Se,de);else if(ie=b(A),typeof ie=="function")for(A=ie.call(A),ie=0;!(M=A.next()).done;)M=M.value,Se=we+G(M,ie++),fe+=oe(M,ae,ce,Se,de);else if(Se==="object"){if(typeof A.then=="function")return oe(te(A),ae,ce,M,de);throw ae=String(A),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.")}return fe}function K(A,ae,ce){if(A==null)return A;var M=[],de=0;return oe(A,M,"","",function(Se){return ae.call(ce,Se,de++)}),M}function V(A){if(A._status===-1){var ae=A._result;ae=ae(),ae.then(function(ce){(A._status===0||A._status===-1)&&(A._status=1,A._result=ce)},function(ce){(A._status===0||A._status===-1)&&(A._status=2,A._result=ce)}),A._status===-1&&(A._status=0,A._result=ae)}if(A._status===1)return A._result.default;throw A._result}var J=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function ne(){}return Ut.Children={map:K,forEach:function(A,ae,ce){K(A,function(){ae.apply(this,arguments)},ce)},count:function(A){var ae=0;return K(A,function(){ae++}),ae},toArray:function(A){return K(A,function(ae){return ae})||[]},only:function(A){if(!U(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Ut.Component=E,Ut.Fragment=t,Ut.Profiler=a,Ut.PureComponent=I,Ut.StrictMode=r,Ut.Suspense=u,Ut.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Ut.__COMPILER_RUNTIME={__proto__:null,c:function(A){return F.H.useMemoCache(A)}},Ut.cache=function(A){return function(){return A.apply(null,arguments)}},Ut.cloneElement=function(A,ae,ce){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var M=S({},A.props),de=A.key,Se=void 0;if(ae!=null)for(fe in ae.ref!==void 0&&(Se=void 0),ae.key!==void 0&&(de=""+ae.key),ae)!$.call(ae,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&ae.ref===void 0||(M[fe]=ae[fe]);var fe=arguments.length-2;if(fe===1)M.children=ce;else if(1<fe){for(var we=Array(fe),ie=0;ie<fe;ie++)we[ie]=arguments[ie+2];M.children=we}return B(A.type,de,void 0,void 0,Se,M)},Ut.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:s,_context:A},A},Ut.createElement=function(A,ae,ce){var M,de={},Se=null;if(ae!=null)for(M in ae.key!==void 0&&(Se=""+ae.key),ae)$.call(ae,M)&&M!=="key"&&M!=="__self"&&M!=="__source"&&(de[M]=ae[M]);var fe=arguments.length-2;if(fe===1)de.children=ce;else if(1<fe){for(var we=Array(fe),ie=0;ie<fe;ie++)we[ie]=arguments[ie+2];de.children=we}if(A&&A.defaultProps)for(M in fe=A.defaultProps,fe)de[M]===void 0&&(de[M]=fe[M]);return B(A,Se,void 0,void 0,null,de)},Ut.createRef=function(){return{current:null}},Ut.forwardRef=function(A){return{$$typeof:f,render:A}},Ut.isValidElement=U,Ut.lazy=function(A){return{$$typeof:h,_payload:{_status:-1,_result:A},_init:V}},Ut.memo=function(A,ae){return{$$typeof:d,type:A,compare:ae===void 0?null:ae}},Ut.startTransition=function(A){var ae=F.T,ce={};F.T=ce;try{var M=A(),de=F.S;de!==null&&de(ce,M),typeof M=="object"&&M!==null&&typeof M.then=="function"&&M.then(ne,J)}catch(Se){J(Se)}finally{F.T=ae}},Ut.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Ut.use=function(A){return F.H.use(A)},Ut.useActionState=function(A,ae,ce){return F.H.useActionState(A,ae,ce)},Ut.useCallback=function(A,ae){return F.H.useCallback(A,ae)},Ut.useContext=function(A){return F.H.useContext(A)},Ut.useDebugValue=function(){},Ut.useDeferredValue=function(A,ae){return F.H.useDeferredValue(A,ae)},Ut.useEffect=function(A,ae,ce){var M=F.H;if(typeof ce=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return M.useEffect(A,ae)},Ut.useId=function(){return F.H.useId()},Ut.useImperativeHandle=function(A,ae,ce){return F.H.useImperativeHandle(A,ae,ce)},Ut.useInsertionEffect=function(A,ae){return F.H.useInsertionEffect(A,ae)},Ut.useLayoutEffect=function(A,ae){return F.H.useLayoutEffect(A,ae)},Ut.useMemo=function(A,ae){return F.H.useMemo(A,ae)},Ut.useOptimistic=function(A,ae){return F.H.useOptimistic(A,ae)},Ut.useReducer=function(A,ae,ce){return F.H.useReducer(A,ae,ce)},Ut.useRef=function(A){return F.H.useRef(A)},Ut.useState=function(A){return F.H.useState(A)},Ut.useSyncExternalStore=function(A,ae,ce){return F.H.useSyncExternalStore(A,ae,ce)},Ut.useTransition=function(){return F.H.useTransition()},Ut.version="19.1.0",Ut}var OS;function Sw(){return OS||(OS=1,av.exports=RP()),av.exports}var w=Sw();const An=Qd(w),LS=DP({__proto__:null,default:An},[w]);var sv={exports:{}},Im={},ov={exports:{}},lv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FS;function OP(){return FS||(FS=1,function(e){function n(K,V){var J=K.length;K.push(V);e:for(;0<J;){var ne=J-1>>>1,A=K[ne];if(0<a(A,V))K[ne]=V,K[J]=A,J=ne;else break e}}function t(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var V=K[0],J=K.pop();if(J!==V){K[0]=J;e:for(var ne=0,A=K.length,ae=A>>>1;ne<ae;){var ce=2*(ne+1)-1,M=K[ce],de=ce+1,Se=K[de];if(0>a(M,J))de<A&&0>a(Se,M)?(K[ne]=Se,K[de]=J,ne=de):(K[ne]=M,K[ce]=J,ne=ce);else if(de<A&&0>a(Se,J))K[ne]=Se,K[de]=J,ne=de;else break e}}return V}function a(K,V){var J=K.sortIndex-V.sortIndex;return J!==0?J:K.id-V.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,f=l.now();e.unstable_now=function(){return l.now()-f}}var u=[],d=[],h=1,g=null,b=3,v=!1,S=!1,k=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function q(K){for(var V=t(d);V!==null;){if(V.callback===null)r(d);else if(V.startTime<=K)r(d),V.sortIndex=V.expirationTime,n(u,V);else break;V=t(d)}}function F(K){if(k=!1,q(K),!S)if(t(u)!==null)S=!0,$||($=!0,G());else{var V=t(d);V!==null&&oe(F,V.startTime-K)}}var $=!1,B=-1,z=5,U=-1;function L(){return E?!0:!(e.unstable_now()-U<z)}function R(){if(E=!1,$){var K=e.unstable_now();U=K;var V=!0;try{e:{S=!1,k&&(k=!1,I(B),B=-1),v=!0;var J=b;try{t:{for(q(K),g=t(u);g!==null&&!(g.expirationTime>K&&L());){var ne=g.callback;if(typeof ne=="function"){g.callback=null,b=g.priorityLevel;var A=ne(g.expirationTime<=K);if(K=e.unstable_now(),typeof A=="function"){g.callback=A,q(K),V=!0;break t}g===t(u)&&r(u),q(K)}else r(u);g=t(u)}if(g!==null)V=!0;else{var ae=t(d);ae!==null&&oe(F,ae.startTime-K),V=!1}}break e}finally{g=null,b=J,v=!1}V=void 0}}finally{V?G():$=!1}}}var G;if(typeof D=="function")G=function(){D(R)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,te=ee.port2;ee.port1.onmessage=R,G=function(){te.postMessage(null)}}else G=function(){T(R,0)};function oe(K,V){B=T(function(){K(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(K){switch(b){case 1:case 2:case 3:var V=3;break;default:V=b}var J=b;b=V;try{return K()}finally{b=J}},e.unstable_requestPaint=function(){E=!0},e.unstable_runWithPriority=function(K,V){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var J=b;b=K;try{return V()}finally{b=J}},e.unstable_scheduleCallback=function(K,V,J){var ne=e.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ne+J:ne):J=ne,K){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=J+A,K={id:h++,callback:V,priorityLevel:K,startTime:J,expirationTime:A,sortIndex:-1},J>ne?(K.sortIndex=J,n(d,K),t(u)===null&&K===t(d)&&(k?(I(B),B=-1):k=!0,oe(F,J-ne))):(K.sortIndex=A,n(u,K),S||v||(S=!0,$||($=!0,G()))),K},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(K){var V=b;return function(){var J=b;b=V;try{return K.apply(this,arguments)}finally{b=J}}}}(lv)),lv}var $S;function LP(){return $S||($S=1,ov.exports=OP()),ov.exports}var cv={exports:{}},Ni={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zS;function FP(){if(zS)return Ni;zS=1;var e=Sw();function n(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(u,d,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:u,containerInfo:d,implementation:h}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ni.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ni.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(n(299));return s(u,d,null,h)},Ni.flushSync=function(u){var d=l.T,h=r.p;try{if(l.T=null,r.p=2,u)return u()}finally{l.T=d,r.p=h,r.d.f()}},Ni.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},Ni.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Ni.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,g=f(h,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):h==="script"&&r.d.X(u,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ni.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=f(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},Ni.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,g=f(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ni.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=f(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},Ni.requestFormReset=function(u){r.d.r(u)},Ni.unstable_batchedUpdates=function(u,d){return u(d)},Ni.useFormState=function(u,d,h){return l.H.useFormState(u,d,h)},Ni.useFormStatus=function(){return l.H.useHostTransitionStatus()},Ni.version="19.1.0",Ni}var BS;function a2(){if(BS)return cv.exports;BS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),cv.exports=FP(),cv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var US;function $P(){if(US)return Im;US=1;var e=LP(),n=Sw(),t=a2();function r(o){var c="https://react.dev/errors/"+o;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function s(o){var c=o,p=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(p=c.return),o=c.return;while(o)}return c.tag===3?p:null}function l(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function f(o){if(s(o)!==o)throw Error(r(188))}function u(o){var c=o.alternate;if(!c){if(c=s(o),c===null)throw Error(r(188));return c!==o?null:o}for(var p=o,x=c;;){var N=p.return;if(N===null)break;var P=N.alternate;if(P===null){if(x=N.return,x!==null){p=x;continue}break}if(N.child===P.child){for(P=N.child;P;){if(P===p)return f(N),o;if(P===x)return f(N),c;P=P.sibling}throw Error(r(188))}if(p.return!==x.return)p=N,x=P;else{for(var H=!1,Z=N.child;Z;){if(Z===p){H=!0,p=N,x=P;break}if(Z===x){H=!0,x=N,p=P;break}Z=Z.sibling}if(!H){for(Z=P.child;Z;){if(Z===p){H=!0,p=P,x=N;break}if(Z===x){H=!0,x=P,p=N;break}Z=Z.sibling}if(!H)throw Error(r(189))}}if(p.alternate!==x)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?o:c}function d(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o;for(o=o.child;o!==null;){if(c=d(o),c!==null)return c;o=o.sibling}return null}var h=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.consumer"),D=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function G(o){return o===null||typeof o!="object"?null:(o=R&&o[R]||o["@@iterator"],typeof o=="function"?o:null)}var ee=Symbol.for("react.client.reference");function te(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===ee?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case S:return"Fragment";case E:return"Profiler";case k:return"StrictMode";case F:return"Suspense";case $:return"SuspenseList";case U:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case v:return"Portal";case D:return(o.displayName||"Context")+".Provider";case I:return(o._context.displayName||"Context")+".Consumer";case q:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case B:return c=o.displayName||null,c!==null?c:te(o.type)||"Memo";case z:c=o._payload,o=o._init;try{return te(o(c))}catch{}}return null}var oe=Array.isArray,K=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},ne=[],A=-1;function ae(o){return{current:o}}function ce(o){0>A||(o.current=ne[A],ne[A]=null,A--)}function M(o,c){A++,ne[A]=o.current,o.current=c}var de=ae(null),Se=ae(null),fe=ae(null),we=ae(null);function ie(o,c){switch(M(fe,c),M(Se,o),M(de,null),c.nodeType){case 9:case 11:o=(o=c.documentElement)&&(o=o.namespaceURI)?Wn(o):0;break;default:if(o=c.tagName,c=c.namespaceURI)c=Wn(c),o=tr(c,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}ce(de),M(de,o)}function _e(){ce(de),ce(Se),ce(fe)}function Ve(o){o.memoizedState!==null&&M(we,o);var c=de.current,p=tr(c,o.type);c!==p&&(M(Se,o),M(de,p))}function tt(o){Se.current===o&&(ce(de),ce(Se)),we.current===o&&(ce(we),Bc._currentValue=J)}var Ke=Object.prototype.hasOwnProperty,Oe=e.unstable_scheduleCallback,xe=e.unstable_cancelCallback,Me=e.unstable_shouldYield,ve=e.unstable_requestPaint,Ee=e.unstable_now,Pe=e.unstable_getCurrentPriorityLevel,rt=e.unstable_ImmediatePriority,lt=e.unstable_UserBlockingPriority,Ze=e.unstable_NormalPriority,Rt=e.unstable_LowPriority,kt=e.unstable_IdlePriority,on=e.log,se=e.unstable_setDisableYieldValue,Q=null,re=null;function je(o){if(typeof on=="function"&&se(o),re&&typeof re.setStrictMode=="function")try{re.setStrictMode(Q,o)}catch{}}var Ae=Math.clz32?Math.clz32:mt,Ue=Math.log,ot=Math.LN2;function mt(o){return o>>>=0,o===0?32:31-(Ue(o)/ot|0)|0}var ft=256,Be=4194304;function Xe(o){var c=o&42;if(c!==0)return c;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Fe(o,c,p){var x=o.pendingLanes;if(x===0)return 0;var N=0,P=o.suspendedLanes,H=o.pingedLanes;o=o.warmLanes;var Z=x&134217727;return Z!==0?(x=Z&~P,x!==0?N=Xe(x):(H&=Z,H!==0?N=Xe(H):p||(p=Z&~o,p!==0&&(N=Xe(p))))):(Z=x&~P,Z!==0?N=Xe(Z):H!==0?N=Xe(H):p||(p=x&~o,p!==0&&(N=Xe(p)))),N===0?0:c!==0&&c!==N&&(c&P)===0&&(P=N&-N,p=c&-c,P>=p||P===32&&(p&4194048)!==0)?c:N}function st(o,c){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&c)===0}function Je(o,c){switch(o){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xt(){var o=ft;return ft<<=1,(ft&4194048)===0&&(ft=256),o}function Vn(){var o=Be;return Be<<=1,(Be&62914560)===0&&(Be=4194304),o}function $n(o){for(var c=[],p=0;31>p;p++)c.push(o);return c}function _n(o,c){o.pendingLanes|=c,c!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function yn(o,c,p,x,N,P){var H=o.pendingLanes;o.pendingLanes=p,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=p,o.entangledLanes&=p,o.errorRecoveryDisabledLanes&=p,o.shellSuspendCounter=0;var Z=o.entanglements,ye=o.expirationTimes,Ie=o.hiddenUpdates;for(p=H&~p;0<p;){var qe=31-Ae(p),Ye=1<<qe;Z[qe]=0,ye[qe]=-1;var Le=Ie[qe];if(Le!==null)for(Ie[qe]=null,qe=0;qe<Le.length;qe++){var Re=Le[qe];Re!==null&&(Re.lane&=-536870913)}p&=~Ye}x!==0&&fn(o,x,0),P!==0&&N===0&&o.tag!==0&&(o.suspendedLanes|=P&~(H&~c))}function fn(o,c,p){o.pendingLanes|=c,o.suspendedLanes&=~c;var x=31-Ae(c);o.entangledLanes|=c,o.entanglements[x]=o.entanglements[x]|1073741824|p&4194090}function _r(o,c){var p=o.entangledLanes|=c;for(o=o.entanglements;p;){var x=31-Ae(p),N=1<<x;N&c|o[x]&c&&(o[x]|=c),p&=~N}}function Wr(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function li(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function ha(){var o=V.p;return o!==0?o:(o=window.event,o===void 0?32:yx(o.type))}function Pi(o,c){var p=V.p;try{return V.p=o,c()}finally{V.p=p}}var ir=Math.random().toString(36).slice(2),Zn="__reactFiber$"+ir,zn="__reactProps$"+ir,Ua="__reactContainer$"+ir,fs="__reactEvents$"+ir,rp="__reactListeners$"+ir,ip="__reactHandles$"+ir,Xd="__reactResources$"+ir,hs="__reactMarker$"+ir;function ou(o){delete o[Zn],delete o[zn],delete o[fs],delete o[rp],delete o[ip]}function Qs(o){var c=o[Zn];if(c)return c;for(var p=o.parentNode;p;){if(c=p[Ua]||p[Zn]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(o=ax(o);o!==null;){if(p=o[Zn])return p;o=ax(o)}return c}o=p,p=o.parentNode}return null}function Js(o){if(o=o[Zn]||o[Ua]){var c=o.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return o}return null}function qa(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o.stateNode;throw Error(r(33))}function Ks(o){var c=o[Xd];return c||(c=o[Xd]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function dr(o){o[hs]=!0}var Zd=new Set,ql={};function ps(o,c){Va(o,c),Va(o+"Capture",c)}function Va(o,c){for(ql[o]=c,o=0;o<c.length;o++)Zd.add(c[o])}var Qr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Xs={},Ha={};function ef(o){return Ke.call(Ha,o)?!0:Ke.call(Xs,o)?!1:Qr.test(o)?Ha[o]=!0:(Xs[o]=!0,!1)}function Yo(o,c,p){if(ef(c))if(p===null)o.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":o.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){o.removeAttribute(c);return}}o.setAttribute(c,""+p)}}function Zs(o,c,p){if(p===null)o.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttribute(c,""+p)}}function ci(o,c,p,x){if(x===null)o.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(p);return}o.setAttributeNS(c,p,""+x)}}var Wo,Vl;function pa(o){if(Wo===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);Wo=c&&c[1]||"",Vl=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wo+o+Vl}var lu=!1;function cu(o,c){if(!o||lu)return"";lu=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var Ye=function(){throw Error()};if(Object.defineProperty(Ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ye,[])}catch(Re){var Le=Re}Reflect.construct(o,[],Ye)}else{try{Ye.call()}catch(Re){Le=Re}o.call(Ye.prototype)}}else{try{throw Error()}catch(Re){Le=Re}(Ye=o())&&typeof Ye.catch=="function"&&Ye.catch(function(){})}}catch(Re){if(Re&&Le&&typeof Re.stack=="string")return[Re.stack,Le.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=x.DetermineComponentFrameRoot(),H=P[0],Z=P[1];if(H&&Z){var ye=H.split(`
`),Ie=Z.split(`
`);for(N=x=0;x<ye.length&&!ye[x].includes("DetermineComponentFrameRoot");)x++;for(;N<Ie.length&&!Ie[N].includes("DetermineComponentFrameRoot");)N++;if(x===ye.length||N===Ie.length)for(x=ye.length-1,N=Ie.length-1;1<=x&&0<=N&&ye[x]!==Ie[N];)N--;for(;1<=x&&0<=N;x--,N--)if(ye[x]!==Ie[N]){if(x!==1||N!==1)do if(x--,N--,0>N||ye[x]!==Ie[N]){var qe=`
`+ye[x].replace(" at new "," at ");return o.displayName&&qe.includes("<anonymous>")&&(qe=qe.replace("<anonymous>",o.displayName)),qe}while(1<=x&&0<=N);break}}}finally{lu=!1,Error.prepareStackTrace=p}return(p=o?o.displayName||o.name:"")?pa(p):""}function tf(o){switch(o.tag){case 26:case 27:case 5:return pa(o.type);case 16:return pa("Lazy");case 13:return pa("Suspense");case 19:return pa("SuspenseList");case 0:case 15:return cu(o.type,!1);case 11:return cu(o.type.render,!1);case 1:return cu(o.type,!0);case 31:return pa("Activity");default:return""}}function uu(o){try{var c="";do c+=tf(o),o=o.return;while(o);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function zr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function eo(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Hl(o){var c=eo(o)?"checked":"value",p=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),x=""+o[c];if(!o.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,P=p.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return N.call(this)},set:function(H){x=""+H,P.call(this,H)}}),Object.defineProperty(o,c,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(H){x=""+H},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function ms(o){o._valueTracker||(o._valueTracker=Hl(o))}function Gl(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var p=c.getValue(),x="";return o&&(x=eo(o)?o.checked?"true":"false":o.value),o=x,o!==p?(c.setValue(o),!0):!1}function Bi(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var du=/[\n"\\]/g;function Mr(o){return o.replace(du,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Qo(o,c,p,x,N,P,H,Z){o.name="",H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?o.type=H:o.removeAttribute("type"),c!=null?H==="number"?(c===0&&o.value===""||o.value!=c)&&(o.value=""+zr(c)):o.value!==""+zr(c)&&(o.value=""+zr(c)):H!=="submit"&&H!=="reset"||o.removeAttribute("value"),c!=null?no(o,H,zr(c)):p!=null?no(o,H,zr(p)):x!=null&&o.removeAttribute("value"),N==null&&P!=null&&(o.defaultChecked=!!P),N!=null&&(o.checked=N&&typeof N!="function"&&typeof N!="symbol"),Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?o.name=""+zr(Z):o.removeAttribute("name")}function to(o,c,p,x,N,P,H,Z){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(o.type=P),c!=null||p!=null){if(!(P!=="submit"&&P!=="reset"||c!=null))return;p=p!=null?""+zr(p):"",c=c!=null?""+zr(c):p,Z||c===o.value||(o.value=c),o.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,o.checked=Z?o.checked:!!x,o.defaultChecked=!!x,H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(o.name=H)}function no(o,c,p){c==="number"&&Bi(o.ownerDocument)===o||o.defaultValue===""+p||(o.defaultValue=""+p)}function ma(o,c,p,x){if(o=o.options,c){c={};for(var N=0;N<p.length;N++)c["$"+p[N]]=!0;for(p=0;p<o.length;p++)N=c.hasOwnProperty("$"+o[p].value),o[p].selected!==N&&(o[p].selected=N),N&&x&&(o[p].defaultSelected=!0)}else{for(p=""+zr(p),c=null,N=0;N<o.length;N++){if(o[N].value===p){o[N].selected=!0,x&&(o[N].defaultSelected=!0);return}c!==null||o[N].disabled||(c=o[N])}c!==null&&(c.selected=!0)}}function ro(o,c,p){if(c!=null&&(c=""+zr(c),c!==o.value&&(o.value=c),p==null)){o.defaultValue!==c&&(o.defaultValue=c);return}o.defaultValue=p!=null?""+zr(p):""}function gs(o,c,p,x){if(c==null){if(x!=null){if(p!=null)throw Error(r(92));if(oe(x)){if(1<x.length)throw Error(r(93));x=x[0]}p=x}p==null&&(p=""),c=p}p=zr(c),o.defaultValue=p,x=o.textContent,x===p&&x!==""&&x!==null&&(o.value=x)}function ga(o,c){if(c){var p=o.firstChild;if(p&&p===o.lastChild&&p.nodeType===3){p.nodeValue=c;return}}o.textContent=c}var ya=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Jo(o,c,p){var x=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?o.setProperty(c,""):c==="float"?o.cssFloat="":o[c]="":x?o.setProperty(c,p):typeof p!="number"||p===0||ya.has(c)?c==="float"?o.cssFloat=p:o[c]=(""+p).trim():o[c]=p+"px"}function Ko(o,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(o=o.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?o.setProperty(x,""):x==="float"?o.cssFloat="":o[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&p[N]!==x&&Jo(o,N,x)}else for(var P in c)c.hasOwnProperty(P)&&Jo(o,P,c[P])}function Xo(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Wl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ys(o){return Wl.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var io=null;function Zo(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Br=null,Ga=null;function Ql(o){var c=Js(o);if(c&&(o=c.stateNode)){var p=o[zn]||null;e:switch(o=c.stateNode,c.type){case"input":if(Qo(o,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=o;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Mr(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var x=p[c];if(x!==o&&x.form===o.form){var N=x[zn]||null;if(!N)throw Error(r(90));Qo(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<p.length;c++)x=p[c],x.form===o.form&&Gl(x)}break e;case"textarea":ro(o,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&ma(o,!!p.multiple,c,!1)}}}var xa=!1;function ao(o,c,p){if(xa)return o(c,p);xa=!0;try{var x=o(c);return x}finally{if(xa=!1,(Br!==null||Ga!==null)&&(Qf(),Br&&(c=Br,o=Ga,Ga=Br=null,Ql(c),o)))for(c=0;c<o.length;c++)Ql(o[c])}}function el(o,c){var p=o.stateNode;if(p===null)return null;var x=p[zn]||null;if(x===null)return null;p=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(o=o.type,x=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!x;break e;default:o=!1}if(o)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),so=!1;if(ui)try{var xs={};Object.defineProperty(xs,"passive",{get:function(){so=!0}}),window.addEventListener("test",xs,xs),window.removeEventListener("test",xs,xs)}catch{so=!1}var Ui=null,Jl=null,bs=null;function nf(){if(bs)return bs;var o,c=Jl,p=c.length,x,N="value"in Ui?Ui.value:Ui.textContent,P=N.length;for(o=0;o<p&&c[o]===N[o];o++);var H=p-o;for(x=1;x<=H&&c[p-x]===N[P-x];x++);return bs=N.slice(o,1<x?1-x:void 0)}function xn(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function cn(){return!0}function Kl(){return!1}function Rr(o){function c(p,x,N,P,H){this._reactName=p,this._targetInst=N,this.type=x,this.nativeEvent=P,this.target=H,this.currentTarget=null;for(var Z in o)o.hasOwnProperty(Z)&&(p=o[Z],this[Z]=p?p(P):P[Z]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?cn:Kl,this.isPropagationStopped=Kl,this}return h(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=cn)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=cn)},persist:function(){},isPersistent:cn}),c}var Kt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oo=Rr(Kt),Ya=h({},Kt,{view:0,detail:0}),fu=Rr(Ya),Wa,vs,er,ws=h({},Ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qi,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==er&&(er&&o.type==="mousemove"?(Wa=o.screenX-er.screenX,vs=o.screenY-er.screenY):vs=Wa=0,er=o),Wa)},movementY:function(o){return"movementY"in o?o.movementY:vs}}),Jr=Rr(ws),hu=h({},ws,{dataTransfer:0}),tl=Rr(hu),Or=h({},Ya,{relatedTarget:0}),ba=Rr(Or),pu=h({},Kt,{animationName:0,elapsedTime:0,pseudoElement:0}),Xl=Rr(pu),Ss=h({},Kt,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),rf=Rr(Ss),mu=h({},Kt,{data:0}),fr=Rr(mu),Zl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ur={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ap={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nl(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=ap[o])?!!c[o]:!1}function qi(){return nl}var ec=h({},Ya,{key:function(o){if(o.key){var c=Zl[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=xn(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Ur[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qi,charCode:function(o){return o.type==="keypress"?xn(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?xn(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),gu=Rr(ec),Rn=h({},ws,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),va=Rr(Rn),yu=h({},Ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qi}),sp=Rr(yu),xu=h({},Kt,{propertyName:0,elapsedTime:0,pseudoElement:0}),op=Rr(xu),af=h({},ws,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),lp=Rr(af),rl=h({},Kt,{newState:0,oldState:0}),tc=Rr(rl),Kr=[9,13,27,32],Vi=ui&&"CompositionEvent"in window,qr=null;ui&&"documentMode"in document&&(qr=document.documentMode);var bu=ui&&"TextEvent"in window&&!qr,il=ui&&(!Vi||qr&&8<qr&&11>=qr),al=" ",nc=!1;function rc(o,c){switch(o){case"keyup":return Kr.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sl(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var wa=!1;function cp(o,c){switch(o){case"compositionend":return sl(c);case"keypress":return c.which!==32?null:(nc=!0,al);case"textInput":return o=c.data,o===al&&nc?null:o;default:return null}}function vu(o,c){if(wa)return o==="compositionend"||!Vi&&rc(o,c)?(o=nf(),bs=Jl=Ui=null,wa=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return il&&c.locale!=="ko"?null:c.data;default:return null}}var Xr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ic(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!Xr[o.type]:c==="textarea"}function lo(o,c,p,x){Br?Ga?Ga.push(x):Ga=[x]:Br=x,c=nh(c,"onChange"),0<c.length&&(p=new oo("onChange","change",null,p,x),o.push({event:p,listeners:c}))}var co=null,uo=null;function up(o){Ky(o,0)}function Sa(o){var c=qa(o);if(Gl(c))return o}function sf(o,c){if(o==="change")return c}var ac=!1;if(ui){var wu;if(ui){var Qa="oninput"in document;if(!Qa){var of=document.createElement("div");of.setAttribute("oninput","return;"),Qa=typeof of.oninput=="function"}wu=Qa}else wu=!1;ac=wu&&(!document.documentMode||9<document.documentMode)}function Hi(){co&&(co.detachEvent("onpropertychange",sc),uo=co=null)}function sc(o){if(o.propertyName==="value"&&Sa(uo)){var c=[];lo(c,uo,o,Zo(o)),ao(up,c)}}function Su(o,c,p){o==="focusin"?(Hi(),co=c,uo=p,co.attachEvent("onpropertychange",sc)):o==="focusout"&&Hi()}function Ja(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Sa(uo)}function oc(o,c){if(o==="click")return Sa(c)}function dp(o,c){if(o==="input"||o==="change")return Sa(c)}function fp(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Zr=typeof Object.is=="function"?Object.is:fp;function Gi(o,c){if(Zr(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var p=Object.keys(o),x=Object.keys(c);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var N=p[x];if(!Ke.call(c,N)||!Zr(o[N],c[N]))return!1}return!0}function di(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Nu(o,c){var p=di(o);o=0;for(var x;p;){if(p.nodeType===3){if(x=o+p.textContent.length,o<=c&&x>=c)return{node:p,offset:c-o};o=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=di(p)}}function lf(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?lf(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function Cu(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var c=Bi(o.document);c instanceof o.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)o=c.contentWindow;else break;c=Bi(o.document)}return c}function lc(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}var cf=ui&&"documentMode"in document&&11>=document.documentMode,he=null,be=null,W=null,ue=!1;function me(o,c,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;ue||he==null||he!==Bi(x)||(x=he,"selectionStart"in x&&lc(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),W&&Gi(W,x)||(W=x,x=nh(be,"onSelect"),0<x.length&&(c=new oo("onSelect","select",null,c,p),o.push({event:c,listeners:x}),c.target=he)))}function $e(o,c){var p={};return p[o.toLowerCase()]=c.toLowerCase(),p["Webkit"+o]="webkit"+c,p["Moz"+o]="moz"+c,p}var Qe={animationend:$e("Animation","AnimationEnd"),animationiteration:$e("Animation","AnimationIteration"),animationstart:$e("Animation","AnimationStart"),transitionrun:$e("Transition","TransitionRun"),transitionstart:$e("Transition","TransitionStart"),transitioncancel:$e("Transition","TransitionCancel"),transitionend:$e("Transition","TransitionEnd")},nt={},Xt={};ui&&(Xt=document.createElement("div").style,"AnimationEvent"in window||(delete Qe.animationend.animation,delete Qe.animationiteration.animation,delete Qe.animationstart.animation),"TransitionEvent"in window||delete Qe.transitionend.transition);function Ht(o){if(nt[o])return nt[o];if(!Qe[o])return o;var c=Qe[o],p;for(p in c)if(c.hasOwnProperty(p)&&p in Xt)return nt[o]=c[p];return o}var fo=Ht("animationend"),ju=Ht("animationiteration"),hr=Ht("animationstart"),uf=Ht("transitionrun"),h0=Ht("transitionstart"),cc=Ht("transitioncancel"),_u=Ht("transitionend"),ku=new Map,pn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pn.push("scrollEnd");function Na(o,c){ku.set(o,c),ps(c,[o])}var hp=new WeakMap;function ei(o,c){if(typeof o=="object"&&o!==null){var p=hp.get(o);return p!==void 0?p:(c={value:o,source:c,stack:uu(c)},hp.set(o,c),c)}return{value:o,source:c,stack:uu(c)}}var Yi=[],uc=0,pp=0;function ol(){for(var o=uc,c=pp=uc=0;c<o;){var p=Yi[c];Yi[c++]=null;var x=Yi[c];Yi[c++]=null;var N=Yi[c];Yi[c++]=null;var P=Yi[c];if(Yi[c++]=null,x!==null&&N!==null){var H=x.pending;H===null?N.next=N:(N.next=H.next,H.next=N),x.pending=N}P!==0&&Eu(p,N,P)}}function Ca(o,c,p,x){Yi[uc++]=o,Yi[uc++]=c,Yi[uc++]=p,Yi[uc++]=x,pp|=x,o.lanes|=x,o=o.alternate,o!==null&&(o.lanes|=x)}function dc(o,c,p,x){return Ca(o,c,p,x),Tu(o)}function ll(o,c){return Ca(o,null,null,c),Tu(o)}function Eu(o,c,p){o.lanes|=p;var x=o.alternate;x!==null&&(x.lanes|=p);for(var N=!1,P=o.return;P!==null;)P.childLanes|=p,x=P.alternate,x!==null&&(x.childLanes|=p),P.tag===22&&(o=P.stateNode,o===null||o._visibility&1||(N=!0)),o=P,P=P.return;return o.tag===3?(P=o.stateNode,N&&c!==null&&(N=31-Ae(p),o=P.hiddenUpdates,x=o[N],x===null?o[N]=[c]:x.push(c),c.lane=p|536870912),P):null}function Tu(o){if(50<Ic)throw Ic=0,lm=null,Error(r(185));for(var c=o.return;c!==null;)o=c,c=o.return;return o.tag===3?o.stateNode:null}var cl={};function df(o,c,p,x){this.tag=o,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(o,c,p,x){return new df(o,c,p,x)}function ul(o){return o=o.prototype,!(!o||!o.isReactComponent)}function ti(o,c){var p=o.alternate;return p===null?(p=fi(o.tag,c,o.key,o.mode),p.elementType=o.elementType,p.type=o.type,p.stateNode=o.stateNode,p.alternate=o,o.alternate=p):(p.pendingProps=c,p.type=o.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=o.flags&65011712,p.childLanes=o.childLanes,p.lanes=o.lanes,p.child=o.child,p.memoizedProps=o.memoizedProps,p.memoizedState=o.memoizedState,p.updateQueue=o.updateQueue,c=o.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=o.sibling,p.index=o.index,p.ref=o.ref,p.refCleanup=o.refCleanup,p}function Au(o,c){o.flags&=65011714;var p=o.alternate;return p===null?(o.childLanes=0,o.lanes=c,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=p.childLanes,o.lanes=p.lanes,o.child=p.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=p.memoizedProps,o.memoizedState=p.memoizedState,o.updateQueue=p.updateQueue,o.type=p.type,c=p.dependencies,o.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),o}function ff(o,c,p,x,N,P){var H=0;if(x=o,typeof o=="function")ul(o)&&(H=1);else if(typeof o=="string")H=V0(o,p,de.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case U:return o=fi(31,p,c,N),o.elementType=U,o.lanes=P,o;case S:return dl(p.children,N,P,c);case k:H=8,N|=24;break;case E:return o=fi(12,p,c,N|2),o.elementType=E,o.lanes=P,o;case F:return o=fi(13,p,c,N),o.elementType=F,o.lanes=P,o;case $:return o=fi(19,p,c,N),o.elementType=$,o.lanes=P,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case T:case D:H=10;break e;case I:H=9;break e;case q:H=11;break e;case B:H=14;break e;case z:H=16,x=null;break e}H=29,p=Error(r(130,o===null?"null":typeof o,"")),x=null}return c=fi(H,p,c,N),c.elementType=o,c.type=x,c.lanes=P,c}function dl(o,c,p,x){return o=fi(7,o,x,c),o.lanes=p,o}function mp(o,c,p){return o=fi(6,o,null,c),o.lanes=p,o}function fc(o,c,p){return c=fi(4,o.children!==null?o.children:[],o.key,c),c.lanes=p,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}var Ns=[],ho=0,hf=null,Pu=0,Wi=[],Qi=0,Bn=null,Hn=1,Cs="";function fl(o,c){Ns[ho++]=Pu,Ns[ho++]=hf,hf=o,Pu=c}function gp(o,c,p){Wi[Qi++]=Hn,Wi[Qi++]=Cs,Wi[Qi++]=Bn,Bn=o;var x=Hn;o=Cs;var N=32-Ae(x)-1;x&=~(1<<N),p+=1;var P=32-Ae(c)+N;if(30<P){var H=N-N%5;P=(x&(1<<H)-1).toString(32),x>>=H,N-=H,Hn=1<<32-Ae(c)+N|p<<N|x,Cs=P+o}else Hn=1<<P|p<<N|x,Cs=o}function yp(o){o.return!==null&&(fl(o,1),gp(o,1,0))}function Du(o){for(;o===hf;)hf=Ns[--ho],Ns[ho]=null,Pu=Ns[--ho],Ns[ho]=null;for(;o===Bn;)Bn=Wi[--Qi],Wi[Qi]=null,Cs=Wi[--Qi],Wi[Qi]=null,Hn=Wi[--Qi],Wi[Qi]=null}var xr=null,Gn=null,Zt=!1,ja=null,hi=!1,hc=Error(r(519));function Ji(o){var c=Error(r(418,""));throw po(ei(c,o)),hc}function Pg(o){var c=o.stateNode,p=o.type,x=o.memoizedProps;switch(c[Zn]=o,c[zn]=x,p){case"dialog":Jt("cancel",c),Jt("close",c);break;case"iframe":case"object":case"embed":Jt("load",c);break;case"video":case"audio":for(p=0;p<vd.length;p++)Jt(vd[p],c);break;case"source":Jt("error",c);break;case"img":case"image":case"link":Jt("error",c),Jt("load",c);break;case"details":Jt("toggle",c);break;case"input":Jt("invalid",c),to(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),ms(c);break;case"select":Jt("invalid",c);break;case"textarea":Jt("invalid",c),gs(c,x.value,x.defaultValue,x.children),ms(c)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||x.suppressHydrationWarning===!0||ex(c.textContent,p)?(x.popover!=null&&(Jt("beforetoggle",c),Jt("toggle",c)),x.onScroll!=null&&Jt("scroll",c),x.onScrollEnd!=null&&Jt("scrollend",c),x.onClick!=null&&(c.onclick=rh),c=!0):c=!1,c||Ji(o)}function Dg(o){for(xr=o.return;xr;)switch(xr.tag){case 5:case 13:hi=!1;return;case 27:case 3:hi=!0;return;default:xr=xr.return}}function Iu(o){if(o!==xr)return!1;if(!Zt)return Dg(o),Zt=!0,!1;var c=o.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=o.type,p=!(p!=="form"&&p!=="button")||ah(o.type,o.memoizedProps)),p=!p),p&&Gn&&Ji(o),Dg(o),c===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));e:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8)if(p=o.data,p==="/$"){if(c===0){Gn=Pa(o.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++;o=o.nextSibling}Gn=null}}else c===27?(c=Gn,na(o.type)?(o=Sm,Sm=null,Gn=o):Gn=c):Gn=xr?Pa(o.stateNode.nextSibling):null;return!0}function Mu(){Gn=xr=null,Zt=!1}function Ig(){var o=ja;return o!==null&&(wi===null?wi=o:wi.push.apply(wi,o),ja=null),o}function po(o){ja===null?ja=[o]:ja.push(o)}var hl=ae(null),mo=null,X=null;function Di(o,c,p){M(hl,c._currentValue),c._currentValue=p}function Ki(o){o._currentValue=hl.current,ce(hl)}function pi(o,c,p){for(;o!==null;){var x=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),o===p)break;o=o.return}}function Gt(o,c,p,x){var N=o.child;for(N!==null&&(N.return=o);N!==null;){var P=N.dependencies;if(P!==null){var H=N.child;P=P.firstContext;e:for(;P!==null;){var Z=P;P=N;for(var ye=0;ye<c.length;ye++)if(Z.context===c[ye]){P.lanes|=p,Z=P.alternate,Z!==null&&(Z.lanes|=p),pi(P.return,p,o),x||(H=null);break e}P=Z.next}}else if(N.tag===18){if(H=N.return,H===null)throw Error(r(341));H.lanes|=p,P=H.alternate,P!==null&&(P.lanes|=p),pi(H,p,o),H=null}else H=N.child;if(H!==null)H.return=N;else for(H=N;H!==null;){if(H===o){H=null;break}if(N=H.sibling,N!==null){N.return=H.return,H=N;break}H=H.return}N=H}}function Ru(o,c,p,x){o=null;for(var N=c,P=!1;N!==null;){if(!P){if((N.flags&524288)!==0)P=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var H=N.alternate;if(H===null)throw Error(r(387));if(H=H.memoizedProps,H!==null){var Z=N.type;Zr(N.pendingProps.value,H.value)||(o!==null?o.push(Z):o=[Z])}}else if(N===we.current){if(H=N.alternate,H===null)throw Error(r(387));H.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(o!==null?o.push(Bc):o=[Bc])}N=N.return}o!==null&&Gt(c,o,p,x),c.flags|=262144}function pf(o){for(o=o.firstContext;o!==null;){if(!Zr(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function pl(o){mo=o,X=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function ar(o){return Mg(mo,o)}function mf(o,c){return mo===null&&pl(o),Mg(o,c)}function Mg(o,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},X===null){if(o===null)throw Error(r(308));X=c,o.dependencies={lanes:0,firstContext:c},o.flags|=524288}else X=X.next=c;return p}var p0=typeof AbortController<"u"?AbortController:function(){var o=[],c=this.signal={aborted:!1,addEventListener:function(p,x){o.push(x)}};this.abort=function(){c.aborted=!0,o.forEach(function(p){return p()})}},m0=e.unstable_scheduleCallback,g0=e.unstable_NormalPriority,Pn={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xp(){return{controller:new p0,data:new Map,refCount:0}}function Ou(o){o.refCount--,o.refCount===0&&m0(g0,function(){o.controller.abort()})}var Lu=null,bp=0,pc=0,mi=null;function y0(o,c){if(Lu===null){var p=Lu=[];bp=0,pc=th(),mi={status:"pending",value:void 0,then:function(x){p.push(x)}}}return bp++,c.then(Rg,Rg),c}function Rg(){if(--bp===0&&Lu!==null){mi!==null&&(mi.status="fulfilled");var o=Lu;Lu=null,pc=0,mi=null;for(var c=0;c<o.length;c++)(0,o[c])()}}function x0(o,c){var p=[],x={status:"pending",value:null,reason:null,then:function(N){p.push(N)}};return o.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<p.length;N++)(0,p[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<p.length;N++)(0,p[N])(void 0)}),x}var Og=K.S;K.S=function(o,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&y0(o,c),Og!==null&&Og(o,c)};var ml=ae(null);function js(){var o=ml.current;return o!==null?o:On.pooledCache}function gf(o,c){c===null?M(ml,ml.current):M(ml,c.pool)}function Lg(){var o=js();return o===null?null:{parent:Pn._currentValue,pool:o}}var ni=Error(r(460)),Fg=Error(r(474)),yf=Error(r(542)),vp={then:function(){}};function $g(o){return o=o.status,o==="fulfilled"||o==="rejected"}function xf(){}function wp(o,c,p){switch(p=o[p],p===void 0?o.push(c):p!==c&&(c.then(xf,xf),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,Bg(o),o;default:if(typeof c.status=="string")c.then(xf,xf);else{if(o=On,o!==null&&100<o.shellSuspendCounter)throw Error(r(482));o=c,o.status="pending",o.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,Bg(o),o}throw mc=c,ni}}var mc=null;function zg(){if(mc===null)throw Error(r(459));var o=mc;return mc=null,o}function Bg(o){if(o===ni||o===yf)throw Error(r(483))}var Ka=!1;function gl(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gc(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function go(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function _s(o,c,p){var x=o.updateQueue;if(x===null)return null;if(x=x.shared,(wn&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=Tu(o),Eu(o,null,p),c}return Ca(o,x,c,p),Tu(o)}function Fu(o,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var x=c.lanes;x&=o.pendingLanes,p|=x,c.lanes=p,_r(o,p)}}function _a(o,c){var p=o.updateQueue,x=o.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var N=null,P=null;if(p=p.firstBaseUpdate,p!==null){do{var H={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};P===null?N=P=H:P=P.next=H,p=p.next}while(p!==null);P===null?N=P=c:P=P.next=c}else N=P=c;p={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:P,shared:x.shared,callbacks:x.callbacks},o.updateQueue=p;return}o=p.lastBaseUpdate,o===null?p.firstBaseUpdate=c:o.next=c,p.lastBaseUpdate=c}var $u=!1;function ka(){if($u){var o=mi;if(o!==null)throw o}}function Vr(o,c,p,x){$u=!1;var N=o.updateQueue;Ka=!1;var P=N.firstBaseUpdate,H=N.lastBaseUpdate,Z=N.shared.pending;if(Z!==null){N.shared.pending=null;var ye=Z,Ie=ye.next;ye.next=null,H===null?P=Ie:H.next=Ie,H=ye;var qe=o.alternate;qe!==null&&(qe=qe.updateQueue,Z=qe.lastBaseUpdate,Z!==H&&(Z===null?qe.firstBaseUpdate=Ie:Z.next=Ie,qe.lastBaseUpdate=ye))}if(P!==null){var Ye=N.baseState;H=0,qe=Ie=ye=null,Z=P;do{var Le=Z.lane&-536870913,Re=Le!==Z.lane;if(Re?(ln&Le)===Le:(x&Le)===Le){Le!==0&&Le===pc&&($u=!0),qe!==null&&(qe=qe.next={lane:0,tag:Z.tag,payload:Z.payload,callback:null,next:null});e:{var Nt=o,wt=Z;Le=c;var En=p;switch(wt.tag){case 1:if(Nt=wt.payload,typeof Nt=="function"){Ye=Nt.call(En,Ye,Le);break e}Ye=Nt;break e;case 3:Nt.flags=Nt.flags&-65537|128;case 0:if(Nt=wt.payload,Le=typeof Nt=="function"?Nt.call(En,Ye,Le):Nt,Le==null)break e;Ye=h({},Ye,Le);break e;case 2:Ka=!0}}Le=Z.callback,Le!==null&&(o.flags|=64,Re&&(o.flags|=8192),Re=N.callbacks,Re===null?N.callbacks=[Le]:Re.push(Le))}else Re={lane:Le,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},qe===null?(Ie=qe=Re,ye=Ye):qe=qe.next=Re,H|=Le;if(Z=Z.next,Z===null){if(Z=N.shared.pending,Z===null)break;Re=Z,Z=Re.next,Re.next=null,N.lastBaseUpdate=Re,N.shared.pending=null}}while(!0);qe===null&&(ye=Ye),N.baseState=ye,N.firstBaseUpdate=Ie,N.lastBaseUpdate=qe,P===null&&(N.shared.lanes=0),jo|=H,o.lanes=H,o.memoizedState=Ye}}function Ug(o,c){if(typeof o!="function")throw Error(r(191,o));o.call(c)}function Sp(o,c){var p=o.callbacks;if(p!==null)for(o.callbacks=null,o=0;o<p.length;o++)Ug(p[o],c)}var yl=ae(null),yo=ae(0);function ks(o,c){o=Os,M(yo,o),M(yl,c),Os=o|c.baseLanes}function bf(){M(yo,Os),M(yl,yl.current)}function Np(){Os=yo.current,ce(yl),ce(yo)}var Ea=0,Bt=null,vn=null,en=null,yc=!1,xl=!1,Hr=!1,xc=0,xo=0,Xi=null,qg=0;function tn(){throw Error(r(321))}function zu(o,c){if(c===null)return!1;for(var p=0;p<c.length&&p<o.length;p++)if(!Zr(o[p],c[p]))return!1;return!0}function Cp(o,c,p,x,N,P){return Ea=P,Bt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,K.H=o===null||o.memoizedState===null?ny:Up,Hr=!1,P=p(x,N),Hr=!1,xl&&(P=Hg(c,p,x,N)),Vg(o),P}function Vg(o){K.H=Ku;var c=vn!==null&&vn.next!==null;if(Ea=0,en=vn=Bt=null,yc=!1,xo=0,Xi=null,c)throw Error(r(300));o===null||kr||(o=o.dependencies,o!==null&&pf(o)&&(kr=!0))}function Hg(o,c,p,x){Bt=o;var N=0;do{if(xl&&(Xi=null),xo=0,xl=!1,25<=N)throw Error(r(301));if(N+=1,en=vn=null,o.updateQueue!=null){var P=o.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}K.H=ry,P=c(p,x)}while(xl);return P}function jp(){var o=K.H,c=o.useState()[0];return c=typeof c.then=="function"?Bu(c):c,o=o.useState()[0],(vn!==null?vn.memoizedState:null)!==o&&(Bt.flags|=1024),c}function _p(){var o=xc!==0;return xc=0,o}function bl(o,c,p){c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~p}function vf(o){if(yc){for(o=o.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}yc=!1}Ea=0,en=vn=Bt=null,xl=!1,xo=xc=0,Xi=null}function gi(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?Bt.memoizedState=en=o:en=en.next=o,en}function pr(){if(vn===null){var o=Bt.alternate;o=o!==null?o.memoizedState:null}else o=vn.next;var c=en===null?Bt.memoizedState:en.next;if(c!==null)en=c,vn=o;else{if(o===null)throw Bt.alternate===null?Error(r(467)):Error(r(310));vn=o,o={memoizedState:vn.memoizedState,baseState:vn.baseState,baseQueue:vn.baseQueue,queue:vn.queue,next:null},en===null?Bt.memoizedState=en=o:en=en.next=o}return en}function vl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Bu(o){var c=xo;return xo+=1,Xi===null&&(Xi=[]),o=wp(Xi,o,c),c=Bt,(en===null?c.memoizedState:en.next)===null&&(c=c.alternate,K.H=c===null||c.memoizedState===null?ny:Up),o}function wf(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Bu(o);if(o.$$typeof===D)return ar(o)}throw Error(r(438,String(o)))}function Uu(o){var c=null,p=Bt.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var x=Bt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=vl(),Bt.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(o),x=0;x<o;x++)p[x]=L;return c.index++,p}function Xa(o,c){return typeof c=="function"?c(o):c}function Sf(o){var c=pr();return kp(c,vn,o)}function kp(o,c,p){var x=o.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=p;var N=o.baseQueue,P=x.pending;if(P!==null){if(N!==null){var H=N.next;N.next=P.next,P.next=H}c.baseQueue=N=P,x.pending=null}if(P=o.baseState,N===null)o.memoizedState=P;else{c=N.next;var Z=H=null,ye=null,Ie=c,qe=!1;do{var Ye=Ie.lane&-536870913;if(Ye!==Ie.lane?(ln&Ye)===Ye:(Ea&Ye)===Ye){var Le=Ie.revertLane;if(Le===0)ye!==null&&(ye=ye.next={lane:0,revertLane:0,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null}),Ye===pc&&(qe=!0);else if((Ea&Le)===Le){Ie=Ie.next,Le===pc&&(qe=!0);continue}else Ye={lane:0,revertLane:Ie.revertLane,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null},ye===null?(Z=ye=Ye,H=P):ye=ye.next=Ye,Bt.lanes|=Le,jo|=Le;Ye=Ie.action,Hr&&p(P,Ye),P=Ie.hasEagerState?Ie.eagerState:p(P,Ye)}else Le={lane:Ye,revertLane:Ie.revertLane,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null},ye===null?(Z=ye=Le,H=P):ye=ye.next=Le,Bt.lanes|=Ye,jo|=Ye;Ie=Ie.next}while(Ie!==null&&Ie!==c);if(ye===null?H=P:ye.next=Z,!Zr(P,o.memoizedState)&&(kr=!0,qe&&(p=mi,p!==null)))throw p;o.memoizedState=P,o.baseState=H,o.baseQueue=ye,x.lastRenderedState=P}return N===null&&(x.lanes=0),[o.memoizedState,x.dispatch]}function Ep(o){var c=pr(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=o;var x=p.dispatch,N=p.pending,P=c.memoizedState;if(N!==null){p.pending=null;var H=N=N.next;do P=o(P,H.action),H=H.next;while(H!==N);Zr(P,c.memoizedState)||(kr=!0),c.memoizedState=P,c.baseQueue===null&&(c.baseState=P),p.lastRenderedState=P}return[P,x]}function Tp(o,c,p){var x=Bt,N=pr(),P=Zt;if(P){if(p===void 0)throw Error(r(407));p=p()}else p=c();var H=!Zr((vn||N).memoizedState,p);H&&(N.memoizedState=p,kr=!0),N=N.queue;var Z=Cf.bind(null,x,N,o);if(Hu(2048,8,Z,[o]),N.getSnapshot!==c||H||en!==null&&en.memoizedState.tag&1){if(x.flags|=2048,bc(9,Tf(),Gg.bind(null,x,N,p,c),null),On===null)throw Error(r(349));P||(Ea&124)!==0||Nf(x,c,p)}return p}function Nf(o,c,p){o.flags|=16384,o={getSnapshot:c,value:p},c=Bt.updateQueue,c===null?(c=vl(),Bt.updateQueue=c,c.stores=[o]):(p=c.stores,p===null?c.stores=[o]:p.push(o))}function Gg(o,c,p,x){c.value=p,c.getSnapshot=x,Ap(c)&&Pp(o)}function Cf(o,c,p){return p(function(){Ap(c)&&Pp(o)})}function Ap(o){var c=o.getSnapshot;o=o.value;try{var p=c();return!Zr(o,p)}catch{return!0}}function Pp(o){var c=ll(o,2);c!==null&&Li(c,o,2)}function jf(o){var c=gi();if(typeof o=="function"){var p=o;if(o=p(),Hr){je(!0);try{p()}finally{je(!1)}}}return c.memoizedState=c.baseState=o,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:o},c}function qu(o,c,p,x){return o.baseState=p,kp(o,vn,typeof x=="function"?x:Xa)}function b0(o,c,p,x,N){if(If(o))throw Error(r(485));if(o=c.action,o!==null){var P={payload:N,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){P.listeners.push(H)}};K.T!==null?p(!0):P.isTransition=!1,x(P),p=c.pending,p===null?(P.next=c.pending=P,Dp(c,P)):(P.next=p.next,c.pending=p.next=P)}}function Dp(o,c){var p=c.action,x=c.payload,N=o.state;if(c.isTransition){var P=K.T,H={};K.T=H;try{var Z=p(N,x),ye=K.S;ye!==null&&ye(H,Z),Ip(o,c,Z)}catch(Ie){_f(o,c,Ie)}finally{K.T=P}}else try{P=p(N,x),Ip(o,c,P)}catch(Ie){_f(o,c,Ie)}}function Ip(o,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Yg(o,c,x)},function(x){return _f(o,c,x)}):Yg(o,c,p)}function Yg(o,c,p){c.status="fulfilled",c.value=p,Wg(c),o.state=p,c=o.pending,c!==null&&(p=c.next,p===c?o.pending=null:(p=p.next,c.next=p,Dp(o,p)))}function _f(o,c,p){var x=o.pending;if(o.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=p,Wg(c),c=c.next;while(c!==x)}o.action=null}function Wg(o){o=o.listeners;for(var c=0;c<o.length;c++)(0,o[c])()}function kf(o,c){return c}function Mp(o,c){if(Zt){var p=On.formState;if(p!==null){e:{var x=Bt;if(Zt){if(Gn){t:{for(var N=Gn,P=hi;N.nodeType!==8;){if(!P){N=null;break t}if(N=Pa(N.nextSibling),N===null){N=null;break t}}P=N.data,N=P==="F!"||P==="F"?N:null}if(N){Gn=Pa(N.nextSibling),x=N.data==="F!";break e}}Ji(x)}x=!1}x&&(c=p[0])}}return p=gi(),p.memoizedState=p.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kf,lastRenderedState:c},p.queue=x,p=$p.bind(null,Bt,x),x.dispatch=p,x=jf(!1),P=zp.bind(null,Bt,!1,x.queue),x=gi(),N={state:c,dispatch:null,action:o,pending:null},x.queue=N,p=b0.bind(null,Bt,N,P,p),N.dispatch=p,x.memoizedState=o,[c,p,!1]}function Ef(o){var c=pr();return Qg(c,vn,o)}function Qg(o,c,p){if(c=kp(o,c,kf)[0],o=Sf(Xa)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Bu(c)}catch(H){throw H===ni?yf:H}else x=c;c=pr();var N=c.queue,P=N.dispatch;return p!==c.memoizedState&&(Bt.flags|=2048,bc(9,Tf(),Rp.bind(null,N,p),null)),[x,P,o]}function Rp(o,c){o.action=c}function Ft(o){var c=pr(),p=vn;if(p!==null)return Qg(c,p,o);pr(),c=c.memoizedState,p=pr();var x=p.queue.dispatch;return p.memoizedState=o,[c,x,!1]}function bc(o,c,p,x){return o={tag:o,create:p,deps:x,inst:c,next:null},c=Bt.updateQueue,c===null&&(c=vl(),Bt.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=o.next=o:(x=p.next,p.next=o,o.next=x,c.lastEffect=o),o}function Tf(){return{destroy:void 0,resource:void 0}}function vc(){return pr().memoizedState}function Vu(o,c,p,x){var N=gi();x=x===void 0?null:x,Bt.flags|=o,N.memoizedState=bc(1|c,Tf(),p,x)}function Hu(o,c,p,x){var N=pr();x=x===void 0?null:x;var P=N.memoizedState.inst;vn!==null&&x!==null&&zu(x,vn.memoizedState.deps)?N.memoizedState=bc(c,P,p,x):(Bt.flags|=o,N.memoizedState=bc(1|c,P,p,x))}function Jg(o,c){Vu(8390656,8,o,c)}function Ii(o,c){Hu(2048,8,o,c)}function Kg(o,c){return Hu(4,2,o,c)}function Gu(o,c){return Hu(4,4,o,c)}function Af(o,c){if(typeof c=="function"){o=o();var p=c(o);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function Op(o,c,p){p=p!=null?p.concat([o]):null,Hu(4,4,Af.bind(null,c,o),p)}function Pf(){}function yi(o,c){var p=pr();c=c===void 0?null:c;var x=p.memoizedState;return c!==null&&zu(c,x[1])?x[0]:(p.memoizedState=[o,c],o)}function Es(o,c){var p=pr();c=c===void 0?null:c;var x=p.memoizedState;if(c!==null&&zu(c,x[1]))return x[0];if(x=o(),Hr){je(!0);try{o()}finally{je(!1)}}return p.memoizedState=[x,c],x}function Yu(o,c,p){return p===void 0||(Ea&1073741824)!==0?o.memoizedState=c:(o.memoizedState=p,o=Ay(),Bt.lanes|=o,jo|=o,p)}function Lp(o,c,p,x){return Zr(p,c)?p:yl.current!==null?(o=Yu(o,p,x),Zr(o,c)||(kr=!0),o):(Ea&42)===0?(kr=!0,o.memoizedState=p):(o=Ay(),Bt.lanes|=o,jo|=o,c)}function Wu(o,c,p,x,N){var P=V.p;V.p=P!==0&&8>P?P:8;var H=K.T,Z={};K.T=Z,zp(o,!1,c,p);try{var ye=N(),Ie=K.S;if(Ie!==null&&Ie(Z,ye),ye!==null&&typeof ye=="object"&&typeof ye.then=="function"){var qe=x0(ye,x);wl(o,c,qe,Yr(o))}else wl(o,c,x,Yr(o))}catch(Ye){wl(o,c,{then:function(){},status:"rejected",reason:Ye},Yr())}finally{V.p=P,K.T=H}}function Xg(){}function Qu(o,c,p,x){if(o.tag!==5)throw Error(r(476));var N=Fp(o).queue;Wu(o,N,c,J,p===null?Xg:function(){return Df(o),p(x)})}function Fp(o){var c=o.memoizedState;if(c!==null)return c;c={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:J},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:p},next:null},o.memoizedState=c,o=o.alternate,o!==null&&(o.memoizedState=c),c}function Df(o){var c=Fp(o).next.queue;wl(o,c,{},Yr())}function Ju(){return ar(Bc)}function Ts(){return pr().memoizedState}function Zg(){return pr().memoizedState}function bo(o){for(var c=o.return;c!==null;){switch(c.tag){case 24:case 3:var p=Yr();o=go(p);var x=_s(c,o,p);x!==null&&(Li(x,c,p),Fu(x,c,p)),c={cache:xp()},o.payload=c;return}c=c.return}}function ey(o,c,p){var x=Yr();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},If(o)?ty(c,p):(p=dc(o,c,p,x),p!==null&&(Li(p,o,x),Bp(p,c,x)))}function $p(o,c,p){var x=Yr();wl(o,c,p,x)}function wl(o,c,p,x){var N={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(If(o))ty(c,N);else{var P=o.alternate;if(o.lanes===0&&(P===null||P.lanes===0)&&(P=c.lastRenderedReducer,P!==null))try{var H=c.lastRenderedState,Z=P(H,p);if(N.hasEagerState=!0,N.eagerState=Z,Zr(Z,H))return Ca(o,c,N,0),On===null&&ol(),!1}catch{}finally{}if(p=dc(o,c,N,x),p!==null)return Li(p,o,x),Bp(p,c,x),!0}return!1}function zp(o,c,p,x){if(x={lane:2,revertLane:th(),action:x,hasEagerState:!1,eagerState:null,next:null},If(o)){if(c)throw Error(r(479))}else c=dc(o,p,x,2),c!==null&&Li(c,o,2)}function If(o){var c=o.alternate;return o===Bt||c!==null&&c===Bt}function ty(o,c){xl=yc=!0;var p=o.pending;p===null?c.next=c:(c.next=p.next,p.next=c),o.pending=c}function Bp(o,c,p){if((p&4194048)!==0){var x=c.lanes;x&=o.pendingLanes,p|=x,c.lanes=p,_r(o,p)}}var Ku={readContext:ar,use:wf,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useLayoutEffect:tn,useInsertionEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useSyncExternalStore:tn,useId:tn,useHostTransitionStatus:tn,useFormState:tn,useActionState:tn,useOptimistic:tn,useMemoCache:tn,useCacheRefresh:tn},ny={readContext:ar,use:wf,useCallback:function(o,c){return gi().memoizedState=[o,c===void 0?null:c],o},useContext:ar,useEffect:Jg,useImperativeHandle:function(o,c,p){p=p!=null?p.concat([o]):null,Vu(4194308,4,Af.bind(null,c,o),p)},useLayoutEffect:function(o,c){return Vu(4194308,4,o,c)},useInsertionEffect:function(o,c){Vu(4,2,o,c)},useMemo:function(o,c){var p=gi();c=c===void 0?null:c;var x=o();if(Hr){je(!0);try{o()}finally{je(!1)}}return p.memoizedState=[x,c],x},useReducer:function(o,c,p){var x=gi();if(p!==void 0){var N=p(c);if(Hr){je(!0);try{p(c)}finally{je(!1)}}}else N=c;return x.memoizedState=x.baseState=N,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:N},x.queue=o,o=o.dispatch=ey.bind(null,Bt,o),[x.memoizedState,o]},useRef:function(o){var c=gi();return o={current:o},c.memoizedState=o},useState:function(o){o=jf(o);var c=o.queue,p=$p.bind(null,Bt,c);return c.dispatch=p,[o.memoizedState,p]},useDebugValue:Pf,useDeferredValue:function(o,c){var p=gi();return Yu(p,o,c)},useTransition:function(){var o=jf(!1);return o=Wu.bind(null,Bt,o.queue,!0,!1),gi().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,c,p){var x=Bt,N=gi();if(Zt){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),On===null)throw Error(r(349));(ln&124)!==0||Nf(x,c,p)}N.memoizedState=p;var P={value:p,getSnapshot:c};return N.queue=P,Jg(Cf.bind(null,x,P,o),[o]),x.flags|=2048,bc(9,Tf(),Gg.bind(null,x,P,p,c),null),p},useId:function(){var o=gi(),c=On.identifierPrefix;if(Zt){var p=Cs,x=Hn;p=(x&~(1<<32-Ae(x)-1)).toString(32)+p,c=""+c+"R"+p,p=xc++,0<p&&(c+="H"+p.toString(32)),c+=""}else p=qg++,c=""+c+"r"+p.toString(32)+"";return o.memoizedState=c},useHostTransitionStatus:Ju,useFormState:Mp,useActionState:Mp,useOptimistic:function(o){var c=gi();c.memoizedState=c.baseState=o;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=zp.bind(null,Bt,!0,p),p.dispatch=c,[o,c]},useMemoCache:Uu,useCacheRefresh:function(){return gi().memoizedState=bo.bind(null,Bt)}},Up={readContext:ar,use:wf,useCallback:yi,useContext:ar,useEffect:Ii,useImperativeHandle:Op,useInsertionEffect:Kg,useLayoutEffect:Gu,useMemo:Es,useReducer:Sf,useRef:vc,useState:function(){return Sf(Xa)},useDebugValue:Pf,useDeferredValue:function(o,c){var p=pr();return Lp(p,vn.memoizedState,o,c)},useTransition:function(){var o=Sf(Xa)[0],c=pr().memoizedState;return[typeof o=="boolean"?o:Bu(o),c]},useSyncExternalStore:Tp,useId:Ts,useHostTransitionStatus:Ju,useFormState:Ef,useActionState:Ef,useOptimistic:function(o,c){var p=pr();return qu(p,vn,o,c)},useMemoCache:Uu,useCacheRefresh:Zg},ry={readContext:ar,use:wf,useCallback:yi,useContext:ar,useEffect:Ii,useImperativeHandle:Op,useInsertionEffect:Kg,useLayoutEffect:Gu,useMemo:Es,useReducer:Ep,useRef:vc,useState:function(){return Ep(Xa)},useDebugValue:Pf,useDeferredValue:function(o,c){var p=pr();return vn===null?Yu(p,o,c):Lp(p,vn.memoizedState,o,c)},useTransition:function(){var o=Ep(Xa)[0],c=pr().memoizedState;return[typeof o=="boolean"?o:Bu(o),c]},useSyncExternalStore:Tp,useId:Ts,useHostTransitionStatus:Ju,useFormState:Ft,useActionState:Ft,useOptimistic:function(o,c){var p=pr();return vn!==null?qu(p,vn,o,c):(p.baseState=o,[o,p.queue.dispatch])},useMemoCache:Uu,useCacheRefresh:Zg},br=null,xi=0;function Mf(o){var c=xi;return xi+=1,br===null&&(br=[]),wp(br,o,c)}function Xu(o,c){c=c.props.ref,o.ref=c!==void 0?c:null}function Sl(o,c){throw c.$$typeof===g?Error(r(525)):(o=Object.prototype.toString.call(c),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o)))}function Nl(o){var c=o._init;return c(o._payload)}function qp(o){function c(ke,Ce){if(o){var De=ke.deletions;De===null?(ke.deletions=[Ce],ke.flags|=16):De.push(Ce)}}function p(ke,Ce){if(!o)return null;for(;Ce!==null;)c(ke,Ce),Ce=Ce.sibling;return null}function x(ke){for(var Ce=new Map;ke!==null;)ke.key!==null?Ce.set(ke.key,ke):Ce.set(ke.index,ke),ke=ke.sibling;return Ce}function N(ke,Ce){return ke=ti(ke,Ce),ke.index=0,ke.sibling=null,ke}function P(ke,Ce,De){return ke.index=De,o?(De=ke.alternate,De!==null?(De=De.index,De<Ce?(ke.flags|=67108866,Ce):De):(ke.flags|=67108866,Ce)):(ke.flags|=1048576,Ce)}function H(ke){return o&&ke.alternate===null&&(ke.flags|=67108866),ke}function Z(ke,Ce,De,He){return Ce===null||Ce.tag!==6?(Ce=mp(De,ke.mode,He),Ce.return=ke,Ce):(Ce=N(Ce,De),Ce.return=ke,Ce)}function ye(ke,Ce,De,He){var ht=De.type;return ht===S?qe(ke,Ce,De.props.children,He,De.key):Ce!==null&&(Ce.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===z&&Nl(ht)===Ce.type)?(Ce=N(Ce,De.props),Xu(Ce,De),Ce.return=ke,Ce):(Ce=ff(De.type,De.key,De.props,null,ke.mode,He),Xu(Ce,De),Ce.return=ke,Ce)}function Ie(ke,Ce,De,He){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==De.containerInfo||Ce.stateNode.implementation!==De.implementation?(Ce=fc(De,ke.mode,He),Ce.return=ke,Ce):(Ce=N(Ce,De.children||[]),Ce.return=ke,Ce)}function qe(ke,Ce,De,He,ht){return Ce===null||Ce.tag!==7?(Ce=dl(De,ke.mode,He,ht),Ce.return=ke,Ce):(Ce=N(Ce,De),Ce.return=ke,Ce)}function Ye(ke,Ce,De){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ce=mp(""+Ce,ke.mode,De),Ce.return=ke,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case b:return De=ff(Ce.type,Ce.key,Ce.props,null,ke.mode,De),Xu(De,Ce),De.return=ke,De;case v:return Ce=fc(Ce,ke.mode,De),Ce.return=ke,Ce;case z:var He=Ce._init;return Ce=He(Ce._payload),Ye(ke,Ce,De)}if(oe(Ce)||G(Ce))return Ce=dl(Ce,ke.mode,De,null),Ce.return=ke,Ce;if(typeof Ce.then=="function")return Ye(ke,Mf(Ce),De);if(Ce.$$typeof===D)return Ye(ke,mf(ke,Ce),De);Sl(ke,Ce)}return null}function Le(ke,Ce,De,He){var ht=Ce!==null?Ce.key:null;if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return ht!==null?null:Z(ke,Ce,""+De,He);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case b:return De.key===ht?ye(ke,Ce,De,He):null;case v:return De.key===ht?Ie(ke,Ce,De,He):null;case z:return ht=De._init,De=ht(De._payload),Le(ke,Ce,De,He)}if(oe(De)||G(De))return ht!==null?null:qe(ke,Ce,De,He,null);if(typeof De.then=="function")return Le(ke,Ce,Mf(De),He);if(De.$$typeof===D)return Le(ke,Ce,mf(ke,De),He);Sl(ke,De)}return null}function Re(ke,Ce,De,He,ht){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return ke=ke.get(De)||null,Z(Ce,ke,""+He,ht);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case b:return ke=ke.get(He.key===null?De:He.key)||null,ye(Ce,ke,He,ht);case v:return ke=ke.get(He.key===null?De:He.key)||null,Ie(Ce,ke,He,ht);case z:var Yt=He._init;return He=Yt(He._payload),Re(ke,Ce,De,He,ht)}if(oe(He)||G(He))return ke=ke.get(De)||null,qe(Ce,ke,He,ht,null);if(typeof He.then=="function")return Re(ke,Ce,De,Mf(He),ht);if(He.$$typeof===D)return Re(ke,Ce,De,mf(Ce,He),ht);Sl(Ce,He)}return null}function Nt(ke,Ce,De,He){for(var ht=null,Yt=null,gt=Ce,Ct=Ce=0,Ar=null;gt!==null&&Ct<De.length;Ct++){gt.index>Ct?(Ar=gt,gt=null):Ar=gt.sibling;var un=Le(ke,gt,De[Ct],He);if(un===null){gt===null&&(gt=Ar);break}o&&gt&&un.alternate===null&&c(ke,gt),Ce=P(un,Ce,Ct),Yt===null?ht=un:Yt.sibling=un,Yt=un,gt=Ar}if(Ct===De.length)return p(ke,gt),Zt&&fl(ke,Ct),ht;if(gt===null){for(;Ct<De.length;Ct++)gt=Ye(ke,De[Ct],He),gt!==null&&(Ce=P(gt,Ce,Ct),Yt===null?ht=gt:Yt.sibling=gt,Yt=gt);return Zt&&fl(ke,Ct),ht}for(gt=x(gt);Ct<De.length;Ct++)Ar=Re(gt,ke,Ct,De[Ct],He),Ar!==null&&(o&&Ar.alternate!==null&&gt.delete(Ar.key===null?Ct:Ar.key),Ce=P(Ar,Ce,Ct),Yt===null?ht=Ar:Yt.sibling=Ar,Yt=Ar);return o&&gt.forEach(function(Ro){return c(ke,Ro)}),Zt&&fl(ke,Ct),ht}function wt(ke,Ce,De,He){if(De==null)throw Error(r(151));for(var ht=null,Yt=null,gt=Ce,Ct=Ce=0,Ar=null,un=De.next();gt!==null&&!un.done;Ct++,un=De.next()){gt.index>Ct?(Ar=gt,gt=null):Ar=gt.sibling;var Ro=Le(ke,gt,un.value,He);if(Ro===null){gt===null&&(gt=Ar);break}o&&gt&&Ro.alternate===null&&c(ke,gt),Ce=P(Ro,Ce,Ct),Yt===null?ht=Ro:Yt.sibling=Ro,Yt=Ro,gt=Ar}if(un.done)return p(ke,gt),Zt&&fl(ke,Ct),ht;if(gt===null){for(;!un.done;Ct++,un=De.next())un=Ye(ke,un.value,He),un!==null&&(Ce=P(un,Ce,Ct),Yt===null?ht=un:Yt.sibling=un,Yt=un);return Zt&&fl(ke,Ct),ht}for(gt=x(gt);!un.done;Ct++,un=De.next())un=Re(gt,ke,Ct,un.value,He),un!==null&&(o&&un.alternate!==null&&gt.delete(un.key===null?Ct:un.key),Ce=P(un,Ce,Ct),Yt===null?ht=un:Yt.sibling=un,Yt=un);return o&&gt.forEach(function(tv){return c(ke,tv)}),Zt&&fl(ke,Ct),ht}function En(ke,Ce,De,He){if(typeof De=="object"&&De!==null&&De.type===S&&De.key===null&&(De=De.props.children),typeof De=="object"&&De!==null){switch(De.$$typeof){case b:e:{for(var ht=De.key;Ce!==null;){if(Ce.key===ht){if(ht=De.type,ht===S){if(Ce.tag===7){p(ke,Ce.sibling),He=N(Ce,De.props.children),He.return=ke,ke=He;break e}}else if(Ce.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===z&&Nl(ht)===Ce.type){p(ke,Ce.sibling),He=N(Ce,De.props),Xu(He,De),He.return=ke,ke=He;break e}p(ke,Ce);break}else c(ke,Ce);Ce=Ce.sibling}De.type===S?(He=dl(De.props.children,ke.mode,He,De.key),He.return=ke,ke=He):(He=ff(De.type,De.key,De.props,null,ke.mode,He),Xu(He,De),He.return=ke,ke=He)}return H(ke);case v:e:{for(ht=De.key;Ce!==null;){if(Ce.key===ht)if(Ce.tag===4&&Ce.stateNode.containerInfo===De.containerInfo&&Ce.stateNode.implementation===De.implementation){p(ke,Ce.sibling),He=N(Ce,De.children||[]),He.return=ke,ke=He;break e}else{p(ke,Ce);break}else c(ke,Ce);Ce=Ce.sibling}He=fc(De,ke.mode,He),He.return=ke,ke=He}return H(ke);case z:return ht=De._init,De=ht(De._payload),En(ke,Ce,De,He)}if(oe(De))return Nt(ke,Ce,De,He);if(G(De)){if(ht=G(De),typeof ht!="function")throw Error(r(150));return De=ht.call(De),wt(ke,Ce,De,He)}if(typeof De.then=="function")return En(ke,Ce,Mf(De),He);if(De.$$typeof===D)return En(ke,Ce,mf(ke,De),He);Sl(ke,De)}return typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint"?(De=""+De,Ce!==null&&Ce.tag===6?(p(ke,Ce.sibling),He=N(Ce,De),He.return=ke,ke=He):(p(ke,Ce),He=mp(De,ke.mode,He),He.return=ke,ke=He),H(ke)):p(ke,Ce)}return function(ke,Ce,De,He){try{xi=0;var ht=En(ke,Ce,De,He);return br=null,ht}catch(gt){if(gt===ni||gt===yf)throw gt;var Yt=fi(29,gt,null,ke.mode);return Yt.lanes=He,Yt.return=ke,Yt}finally{}}}var Cl=qp(!0),iy=qp(!1),Mi=ae(null),ri=null;function Zi(o){var c=o.alternate;M(sr,sr.current&1),M(Mi,o),ri===null&&(c===null||yl.current!==null||c.memoizedState!==null)&&(ri=o)}function ay(o){if(o.tag===22){if(M(sr,sr.current),M(Mi,o),ri===null){var c=o.alternate;c!==null&&c.memoizedState!==null&&(ri=o)}}else As()}function As(){M(sr,sr.current),M(Mi,Mi.current)}function Za(o){ce(Mi),ri===o&&(ri=null),ce(sr)}var sr=ae(0);function Zu(o){for(var c=o;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||ai(p)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function wc(o,c,p,x){c=o.memoizedState,p=p(x,c),p=p==null?c:h({},c,p),o.memoizedState=p,o.lanes===0&&(o.updateQueue.baseState=p)}var ed={enqueueSetState:function(o,c,p){o=o._reactInternals;var x=Yr(),N=go(x);N.payload=c,p!=null&&(N.callback=p),c=_s(o,N,x),c!==null&&(Li(c,o,x),Fu(c,o,x))},enqueueReplaceState:function(o,c,p){o=o._reactInternals;var x=Yr(),N=go(x);N.tag=1,N.payload=c,p!=null&&(N.callback=p),c=_s(o,N,x),c!==null&&(Li(c,o,x),Fu(c,o,x))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var p=Yr(),x=go(p);x.tag=2,c!=null&&(x.callback=c),c=_s(o,x,p),c!==null&&(Li(c,o,p),Fu(c,o,p))}};function td(o,c,p,x,N,P,H){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(x,P,H):c.prototype&&c.prototype.isPureReactComponent?!Gi(p,x)||!Gi(N,P):!0}function sy(o,c,p,x){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,x),c.state!==o&&ed.enqueueReplaceState(c,c.state,null)}function vo(o,c){var p=c;if("ref"in c){p={};for(var x in c)x!=="ref"&&(p[x]=c[x])}if(o=o.defaultProps){p===c&&(p=h({},p));for(var N in o)p[N]===void 0&&(p[N]=o[N])}return p}var jl=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function Vp(o){jl(o)}function Rf(o){console.error(o)}function oy(o){jl(o)}function nd(o,c){try{var p=o.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function es(o,c,p){try{var x=o.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Of(o,c,p){return p=go(p),p.tag=3,p.payload={element:null},p.callback=function(){nd(o,c)},p}function Hp(o){return o=go(o),o.tag=3,o}function ly(o,c,p,x){var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var P=x.value;o.payload=function(){return N(P)},o.callback=function(){es(c,p,x)}}var H=p.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(o.callback=function(){es(c,p,x),typeof N!="function"&&(_o===null?_o=new Set([this]):_o.add(this));var Z=x.stack;this.componentDidCatch(x.value,{componentStack:Z!==null?Z:""})})}function cy(o,c,p,x,N){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=p.alternate,c!==null&&Ru(c,p,N,!0),p=Mi.current,p!==null){switch(p.tag){case 13:return ri===null?um():p.alternate===null&&or===0&&(or=3),p.flags&=-257,p.flags|=65536,p.lanes=N,x===vp?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([x]):c.add(x),hm(o,x,N)),!1;case 22:return p.flags|=65536,x===vp?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([x]):p.add(x)),hm(o,x,N)),!1}throw Error(r(435,p.tag))}return hm(o,x,N),um(),!1}if(Zt)return c=Mi.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==hc&&(o=Error(r(422),{cause:x}),po(ei(o,p)))):(x!==hc&&(c=Error(r(423),{cause:x}),po(ei(c,p))),o=o.current.alternate,o.flags|=65536,N&=-N,o.lanes|=N,x=ei(x,p),N=Of(o.stateNode,x,N),_a(o,N),or!==4&&(or=2)),!1;var P=Error(r(520),{cause:x});if(P=ei(P,p),fd===null?fd=[P]:fd.push(P),or!==4&&(or=2),c===null)return!0;x=ei(x,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,o=N&-N,p.lanes|=o,o=Of(p.stateNode,x,o),_a(p,o),!1;case 1:if(c=p.type,P=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(_o===null||!_o.has(P))))return p.flags|=65536,N&=-N,p.lanes|=N,N=Hp(N),ly(N,o,p,x),_a(p,N),!1}p=p.return}while(p!==null);return!1}var uy=Error(r(461)),kr=!1;function Un(o,c,p,x){c.child=o===null?iy(c,null,p,x):Cl(c,o.child,p,x)}function Lf(o,c,p,x,N){p=p.render;var P=c.ref;if("ref"in x){var H={};for(var Z in x)Z!=="ref"&&(H[Z]=x[Z])}else H=x;return pl(c),x=Cp(o,c,p,H,P,N),Z=_p(),o!==null&&!kr?(bl(o,c,N),Ps(o,c,N)):(Zt&&Z&&yp(c),c.flags|=1,Un(o,c,x,N),c.child)}function Ff(o,c,p,x,N){if(o===null){var P=p.type;return typeof P=="function"&&!ul(P)&&P.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=P,$f(o,c,P,x,N)):(o=ff(p.type,null,x,c,c.mode,N),o.ref=c.ref,o.return=c,c.child=o)}if(P=o.child,!Ta(o,N)){var H=P.memoizedProps;if(p=p.compare,p=p!==null?p:Gi,p(H,x)&&o.ref===c.ref)return Ps(o,c,N)}return c.flags|=1,o=ti(P,x),o.ref=c.ref,o.return=c,c.child=o}function $f(o,c,p,x,N){if(o!==null){var P=o.memoizedProps;if(Gi(P,x)&&o.ref===c.ref)if(kr=!1,c.pendingProps=x=P,Ta(o,N))(o.flags&131072)!==0&&(kr=!0);else return c.lanes=o.lanes,Ps(o,c,N)}return Sc(o,c,p,x,N)}function rd(o,c,p){var x=c.pendingProps,N=x.children,P=o!==null?o.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=P!==null?P.baseLanes|p:p,o!==null){for(N=c.child=o.child,P=0;N!==null;)P=P|N.lanes|N.childLanes,N=N.sibling;c.childLanes=P&~x}else c.childLanes=0,c.child=null;return _l(o,c,x,p)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},o!==null&&gf(c,P!==null?P.cachePool:null),P!==null?ks(c,P):bf(),ay(c);else return c.lanes=c.childLanes=536870912,_l(o,c,P!==null?P.baseLanes|p:p,p)}else P!==null?(gf(c,P.cachePool),ks(c,P),As(),c.memoizedState=null):(o!==null&&gf(c,null),bf(),As());return Un(o,c,N,p),c.child}function _l(o,c,p,x){var N=js();return N=N===null?null:{parent:Pn._currentValue,pool:N},c.memoizedState={baseLanes:p,cachePool:N},o!==null&&gf(c,null),bf(),ay(c),o!==null&&Ru(o,c,x,!0),null}function bt(o,c){var p=c.ref;if(p===null)o!==null&&o.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(o===null||o.ref!==p)&&(c.flags|=4194816)}}function Sc(o,c,p,x,N){return pl(c),p=Cp(o,c,p,x,void 0,N),x=_p(),o!==null&&!kr?(bl(o,c,N),Ps(o,c,N)):(Zt&&x&&yp(c),c.flags|=1,Un(o,c,p,N),c.child)}function zf(o,c,p,x,N,P){return pl(c),c.updateQueue=null,p=Hg(c,x,p,N),Vg(o),x=_p(),o!==null&&!kr?(bl(o,c,P),Ps(o,c,P)):(Zt&&x&&yp(c),c.flags|=1,Un(o,c,p,P),c.child)}function wo(o,c,p,x,N){if(pl(c),c.stateNode===null){var P=cl,H=p.contextType;typeof H=="object"&&H!==null&&(P=ar(H)),P=new p(x,P),c.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=ed,c.stateNode=P,P._reactInternals=c,P=c.stateNode,P.props=x,P.state=c.memoizedState,P.refs={},gl(c),H=p.contextType,P.context=typeof H=="object"&&H!==null?ar(H):cl,P.state=c.memoizedState,H=p.getDerivedStateFromProps,typeof H=="function"&&(wc(c,p,H,x),P.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(H=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),H!==P.state&&ed.enqueueReplaceState(P,P.state,null),Vr(c,x,P,N),ka(),P.state=c.memoizedState),typeof P.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(o===null){P=c.stateNode;var Z=c.memoizedProps,ye=vo(p,Z);P.props=ye;var Ie=P.context,qe=p.contextType;H=cl,typeof qe=="object"&&qe!==null&&(H=ar(qe));var Ye=p.getDerivedStateFromProps;qe=typeof Ye=="function"||typeof P.getSnapshotBeforeUpdate=="function",Z=c.pendingProps!==Z,qe||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(Z||Ie!==H)&&sy(c,P,x,H),Ka=!1;var Le=c.memoizedState;P.state=Le,Vr(c,x,P,N),ka(),Ie=c.memoizedState,Z||Le!==Ie||Ka?(typeof Ye=="function"&&(wc(c,p,Ye,x),Ie=c.memoizedState),(ye=Ka||td(c,p,ye,x,Le,Ie,H))?(qe||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(c.flags|=4194308)):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Ie),P.props=x,P.state=Ie,P.context=H,x=ye):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{P=c.stateNode,gc(o,c),H=c.memoizedProps,qe=vo(p,H),P.props=qe,Ye=c.pendingProps,Le=P.context,Ie=p.contextType,ye=cl,typeof Ie=="object"&&Ie!==null&&(ye=ar(Ie)),Z=p.getDerivedStateFromProps,(Ie=typeof Z=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(H!==Ye||Le!==ye)&&sy(c,P,x,ye),Ka=!1,Le=c.memoizedState,P.state=Le,Vr(c,x,P,N),ka();var Re=c.memoizedState;H!==Ye||Le!==Re||Ka||o!==null&&o.dependencies!==null&&pf(o.dependencies)?(typeof Z=="function"&&(wc(c,p,Z,x),Re=c.memoizedState),(qe=Ka||td(c,p,qe,x,Le,Re,ye)||o!==null&&o.dependencies!==null&&pf(o.dependencies))?(Ie||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(x,Re,ye),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(x,Re,ye)),typeof P.componentDidUpdate=="function"&&(c.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof P.componentDidUpdate!="function"||H===o.memoizedProps&&Le===o.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||H===o.memoizedProps&&Le===o.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Re),P.props=x,P.state=Re,P.context=ye,x=qe):(typeof P.componentDidUpdate!="function"||H===o.memoizedProps&&Le===o.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||H===o.memoizedProps&&Le===o.memoizedState||(c.flags|=1024),x=!1)}return P=x,bt(o,c),x=(c.flags&128)!==0,P||x?(P=c.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:P.render(),c.flags|=1,o!==null&&x?(c.child=Cl(c,o.child,null,N),c.child=Cl(c,null,p,N)):Un(o,c,p,N),c.memoizedState=P.state,o=c.child):o=Ps(o,c,N),o}function dy(o,c,p,x){return Mu(),c.flags|=256,Un(o,c,p,x),c.child}var id={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bf(o){return{baseLanes:o,cachePool:Lg()}}function Er(o,c,p){return o=o!==null?o.childLanes&~p:0,c&&(o|=ta),o}function fy(o,c,p){var x=c.pendingProps,N=!1,P=(c.flags&128)!==0,H;if((H=P)||(H=o!==null&&o.memoizedState===null?!1:(sr.current&2)!==0),H&&(N=!0,c.flags&=-129),H=(c.flags&32)!==0,c.flags&=-33,o===null){if(Zt){if(N?Zi(c):As(),Zt){var Z=Gn,ye;if(ye=Z){e:{for(ye=Z,Z=hi;ye.nodeType!==8;){if(!Z){Z=null;break e}if(ye=Pa(ye.nextSibling),ye===null){Z=null;break e}}Z=ye}Z!==null?(c.memoizedState={dehydrated:Z,treeContext:Bn!==null?{id:Hn,overflow:Cs}:null,retryLane:536870912,hydrationErrors:null},ye=fi(18,null,null,0),ye.stateNode=Z,ye.return=c,c.child=ye,xr=c,Gn=null,ye=!0):ye=!1}ye||Ji(c)}if(Z=c.memoizedState,Z!==null&&(Z=Z.dehydrated,Z!==null))return ai(Z)?c.lanes=32:c.lanes=536870912,null;Za(c)}return Z=x.children,x=x.fallback,N?(As(),N=c.mode,Z=ad({mode:"hidden",children:Z},N),x=dl(x,N,p,null),Z.return=c,x.return=c,Z.sibling=x,c.child=Z,N=c.child,N.memoizedState=Bf(p),N.childLanes=Er(o,H,p),c.memoizedState=id,x):(Zi(c),Gp(c,Z))}if(ye=o.memoizedState,ye!==null&&(Z=ye.dehydrated,Z!==null)){if(P)c.flags&256?(Zi(c),c.flags&=-257,c=Yp(o,c,p)):c.memoizedState!==null?(As(),c.child=o.child,c.flags|=128,c=null):(As(),N=x.fallback,Z=c.mode,x=ad({mode:"visible",children:x.children},Z),N=dl(N,Z,p,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,Cl(c,o.child,null,p),x=c.child,x.memoizedState=Bf(p),x.childLanes=Er(o,H,p),c.memoizedState=id,c=N);else if(Zi(c),ai(Z)){if(H=Z.nextSibling&&Z.nextSibling.dataset,H)var Ie=H.dgst;H=Ie,x=Error(r(419)),x.stack="",x.digest=H,po({value:x,source:null,stack:null}),c=Yp(o,c,p)}else if(kr||Ru(o,c,p,!1),H=(p&o.childLanes)!==0,kr||H){if(H=On,H!==null&&(x=p&-p,x=(x&42)!==0?1:Wr(x),x=(x&(H.suspendedLanes|p))!==0?0:x,x!==0&&x!==ye.retryLane))throw ye.retryLane=x,ll(o,x),Li(H,o,x),uy;Z.data==="$?"||um(),c=Yp(o,c,p)}else Z.data==="$?"?(c.flags|=192,c.child=o.child,c=null):(o=ye.treeContext,Gn=Pa(Z.nextSibling),xr=c,Zt=!0,ja=null,hi=!1,o!==null&&(Wi[Qi++]=Hn,Wi[Qi++]=Cs,Wi[Qi++]=Bn,Hn=o.id,Cs=o.overflow,Bn=c),c=Gp(c,x.children),c.flags|=4096);return c}return N?(As(),N=x.fallback,Z=c.mode,ye=o.child,Ie=ye.sibling,x=ti(ye,{mode:"hidden",children:x.children}),x.subtreeFlags=ye.subtreeFlags&65011712,Ie!==null?N=ti(Ie,N):(N=dl(N,Z,p,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,Z=o.child.memoizedState,Z===null?Z=Bf(p):(ye=Z.cachePool,ye!==null?(Ie=Pn._currentValue,ye=ye.parent!==Ie?{parent:Ie,pool:Ie}:ye):ye=Lg(),Z={baseLanes:Z.baseLanes|p,cachePool:ye}),N.memoizedState=Z,N.childLanes=Er(o,H,p),c.memoizedState=id,x):(Zi(c),p=o.child,o=p.sibling,p=ti(p,{mode:"visible",children:x.children}),p.return=c,p.sibling=null,o!==null&&(H=c.deletions,H===null?(c.deletions=[o],c.flags|=16):H.push(o)),c.child=p,c.memoizedState=null,p)}function Gp(o,c){return c=ad({mode:"visible",children:c},o.mode),c.return=o,o.child=c}function ad(o,c){return o=fi(22,o,null,c),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function Yp(o,c,p){return Cl(c,o.child,null,p),o=Gp(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function Wp(o,c,p){o.lanes|=c;var x=o.alternate;x!==null&&(x.lanes|=c),pi(o.return,c,p)}function Qp(o,c,p,x,N){var P=o.memoizedState;P===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:N}:(P.isBackwards=c,P.rendering=null,P.renderingStartTime=0,P.last=x,P.tail=p,P.tailMode=N)}function hy(o,c,p){var x=c.pendingProps,N=x.revealOrder,P=x.tail;if(Un(o,c,x.children,p),x=sr.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Wp(o,p,c);else if(o.tag===19)Wp(o,p,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}x&=1}switch(M(sr,x),N){case"forwards":for(p=c.child,N=null;p!==null;)o=p.alternate,o!==null&&Zu(o)===null&&(N=p),p=p.sibling;p=N,p===null?(N=c.child,c.child=null):(N=p.sibling,p.sibling=null),Qp(c,!1,N,p,P);break;case"backwards":for(p=null,N=c.child,c.child=null;N!==null;){if(o=N.alternate,o!==null&&Zu(o)===null){c.child=N;break}o=N.sibling,N.sibling=p,p=N,N=o}Qp(c,!0,p,null,P);break;case"together":Qp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ps(o,c,p){if(o!==null&&(c.dependencies=o.dependencies),jo|=c.lanes,(p&c.childLanes)===0)if(o!==null){if(Ru(o,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(o!==null&&c.child!==o.child)throw Error(r(153));if(c.child!==null){for(o=c.child,p=ti(o,o.pendingProps),c.child=p,p.return=c;o.sibling!==null;)o=o.sibling,p=p.sibling=ti(o,o.pendingProps),p.return=c;p.sibling=null}return c.child}function Ta(o,c){return(o.lanes&c)!==0?!0:(o=o.dependencies,!!(o!==null&&pf(o)))}function ii(o,c,p){switch(c.tag){case 3:ie(c,c.stateNode.containerInfo),Di(c,Pn,o.memoizedState.cache),Mu();break;case 27:case 5:Ve(c);break;case 4:ie(c,c.stateNode.containerInfo);break;case 10:Di(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(Zi(c),c.flags|=128,null):(p&c.child.childLanes)!==0?fy(o,c,p):(Zi(c),o=Ps(o,c,p),o!==null?o.sibling:null);Zi(c);break;case 19:var N=(o.flags&128)!==0;if(x=(p&c.childLanes)!==0,x||(Ru(o,c,p,!1),x=(p&c.childLanes)!==0),N){if(x)return hy(o,c,p);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),M(sr,sr.current),x)break;return null;case 22:case 23:return c.lanes=0,rd(o,c,p);case 24:Di(c,Pn,o.memoizedState.cache)}return Ps(o,c,p)}function Uf(o,c,p){if(o!==null)if(o.memoizedProps!==c.pendingProps)kr=!0;else{if(!Ta(o,p)&&(c.flags&128)===0)return kr=!1,ii(o,c,p);kr=(o.flags&131072)!==0}else kr=!1,Zt&&(c.flags&1048576)!==0&&gp(c,Pu,c.index);switch(c.lanes=0,c.tag){case 16:e:{o=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")ul(x)?(o=vo(x,o),c.tag=1,c=wo(null,c,x,o,p)):(c.tag=0,c=Sc(null,c,x,o,p));else{if(x!=null){if(N=x.$$typeof,N===q){c.tag=11,c=Lf(null,c,x,o,p);break e}else if(N===B){c.tag=14,c=Ff(null,c,x,o,p);break e}}throw c=te(x)||x,Error(r(306,c,""))}}return c;case 0:return Sc(o,c,c.type,c.pendingProps,p);case 1:return x=c.type,N=vo(x,c.pendingProps),wo(o,c,x,N,p);case 3:e:{if(ie(c,c.stateNode.containerInfo),o===null)throw Error(r(387));x=c.pendingProps;var P=c.memoizedState;N=P.element,gc(o,c),Vr(c,x,null,p);var H=c.memoizedState;if(x=H.cache,Di(c,Pn,x),x!==P.cache&&Gt(c,[Pn],p,!0),ka(),x=H.element,P.isDehydrated)if(P={element:x,isDehydrated:!1,cache:H.cache},c.updateQueue.baseState=P,c.memoizedState=P,c.flags&256){c=dy(o,c,x,p);break e}else if(x!==N){N=ei(Error(r(424)),c),po(N),c=dy(o,c,x,p);break e}else{switch(o=c.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(Gn=Pa(o.firstChild),xr=c,Zt=!0,ja=null,hi=!0,p=iy(c,null,x,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Mu(),x===N){c=Ps(o,c,p);break e}Un(o,c,x,p)}c=c.child}return c;case 26:return bt(o,c),o===null?(p=cx(c.type,null,c.pendingProps,null))?c.memoizedState=p:Zt||(p=c.type,o=c.pendingProps,x=Tl(fe.current).createElement(p),x[Zn]=c,x[zn]=o,Sr(x,p,o),dr(x),c.stateNode=x):c.memoizedState=cx(c.type,o.memoizedProps,c.pendingProps,o.memoizedState),null;case 27:return Ve(c),o===null&&Zt&&(x=c.stateNode=sx(c.type,c.pendingProps,fe.current),xr=c,hi=!0,N=Gn,na(c.type)?(Sm=N,Gn=Pa(x.firstChild)):Gn=N),Un(o,c,c.pendingProps.children,p),bt(o,c),o===null&&(c.flags|=4194304),c.child;case 5:return o===null&&Zt&&((N=x=Gn)&&(x=ix(x,c.type,c.pendingProps,hi),x!==null?(c.stateNode=x,xr=c,Gn=Pa(x.firstChild),hi=!1,N=!0):N=!1),N||Ji(c)),Ve(c),N=c.type,P=c.pendingProps,H=o!==null?o.memoizedProps:null,x=P.children,ah(N,P)?x=null:H!==null&&ah(N,H)&&(c.flags|=32),c.memoizedState!==null&&(N=Cp(o,c,jp,null,null,p),Bc._currentValue=N),bt(o,c),Un(o,c,x,p),c.child;case 6:return o===null&&Zt&&((o=p=Gn)&&(p=oh(p,c.pendingProps,hi),p!==null?(c.stateNode=p,xr=c,Gn=null,o=!0):o=!1),o||Ji(c)),null;case 13:return fy(o,c,p);case 4:return ie(c,c.stateNode.containerInfo),x=c.pendingProps,o===null?c.child=Cl(c,null,x,p):Un(o,c,x,p),c.child;case 11:return Lf(o,c,c.type,c.pendingProps,p);case 7:return Un(o,c,c.pendingProps,p),c.child;case 8:return Un(o,c,c.pendingProps.children,p),c.child;case 12:return Un(o,c,c.pendingProps.children,p),c.child;case 10:return x=c.pendingProps,Di(c,c.type,x.value),Un(o,c,x.children,p),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,pl(c),N=ar(N),x=x(N),c.flags|=1,Un(o,c,x,p),c.child;case 14:return Ff(o,c,c.type,c.pendingProps,p);case 15:return $f(o,c,c.type,c.pendingProps,p);case 19:return hy(o,c,p);case 31:return x=c.pendingProps,p=c.mode,x={mode:x.mode,children:x.children},o===null?(p=ad(x,p),p.ref=c.ref,c.child=p,p.return=c,c=p):(p=ti(o.child,x),p.ref=c.ref,c.child=p,p.return=c,c=p),c;case 22:return rd(o,c,p);case 24:return pl(c),x=ar(Pn),o===null?(N=js(),N===null&&(N=On,P=xp(),N.pooledCache=P,P.refCount++,P!==null&&(N.pooledCacheLanes|=p),N=P),c.memoizedState={parent:x,cache:N},gl(c),Di(c,Pn,N)):((o.lanes&p)!==0&&(gc(o,c),Vr(c,null,null,p),ka()),N=o.memoizedState,P=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),Di(c,Pn,x)):(x=P.cache,Di(c,Pn,x),x!==N.cache&&Gt(c,[Pn],p,!0))),Un(o,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Ds(o){o.flags|=4}function qf(o,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!Nr(c)){if(c=Mi.current,c!==null&&((ln&4194048)===ln?ri!==null:(ln&62914560)!==ln&&(ln&536870912)===0||c!==ri))throw mc=vp,Fg;o.flags|=8192}}function Vf(o,c){c!==null&&(o.flags|=4),o.flags&16384&&(c=o.tag!==22?Vn():536870912,o.lanes|=c,Tc|=c)}function sd(o,c){if(!Zt)switch(o.tailMode){case"hidden":c=o.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?o.tail=null:p.sibling=null;break;case"collapsed":p=o.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:x.sibling=null}}function Dn(o){var c=o.alternate!==null&&o.alternate.child===o.child,p=0,x=0;if(c)for(var N=o.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=o,N=N.sibling;else for(N=o.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=o,N=N.sibling;return o.subtreeFlags|=x,o.childLanes=p,c}function py(o,c,p){var x=c.pendingProps;switch(Du(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dn(c),null;case 1:return Dn(c),null;case 3:return p=c.stateNode,x=null,o!==null&&(x=o.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),Ki(Pn),_e(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(o===null||o.child===null)&&(Iu(c)?Ds(c):o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ig())),Dn(c),null;case 26:return p=c.memoizedState,o===null?(Ds(c),p!==null?(Dn(c),qf(c,p)):(Dn(c),c.flags&=-16777217)):p?p!==o.memoizedState?(Ds(c),Dn(c),qf(c,p)):(Dn(c),c.flags&=-16777217):(o.memoizedProps!==x&&Ds(c),Dn(c),c.flags&=-16777217),null;case 27:tt(c),p=fe.current;var N=c.type;if(o!==null&&c.stateNode!=null)o.memoizedProps!==x&&Ds(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Dn(c),null}o=de.current,Iu(c)?Pg(c):(o=sx(N,x,p),c.stateNode=o,Ds(c))}return Dn(c),null;case 5:if(tt(c),p=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==x&&Ds(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Dn(c),null}if(o=de.current,Iu(c))Pg(c);else{switch(N=Tl(fe.current),o){case 1:o=N.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:o=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":o=N.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":o=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":o=N.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?o.multiple=!0:x.size&&(o.size=x.size);break;default:o=typeof x.is=="string"?N.createElement(p,{is:x.is}):N.createElement(p)}}o[Zn]=c,o[zn]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)o.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=o;e:switch(Sr(o,p,x),p){case"button":case"input":case"select":case"textarea":o=!!x.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&Ds(c)}}return Dn(c),c.flags&=-16777217,null;case 6:if(o&&c.stateNode!=null)o.memoizedProps!==x&&Ds(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(o=fe.current,Iu(c)){if(o=c.stateNode,p=c.memoizedProps,x=null,N=xr,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}o[Zn]=c,o=!!(o.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||ex(o.nodeValue,p)),o||Ji(c)}else o=Tl(o).createTextNode(x),o[Zn]=c,c.stateNode=o}return Dn(c),null;case 13:if(x=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(N=Iu(c),x!==null&&x.dehydrated!==null){if(o===null){if(!N)throw Error(r(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[Zn]=c}else Mu(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Dn(c),N=!1}else N=Ig(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(Za(c),c):(Za(c),null)}if(Za(c),(c.flags&128)!==0)return c.lanes=p,c;if(p=x!==null,o=o!==null&&o.memoizedState!==null,p){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var P=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(P=x.memoizedState.cachePool.pool),P!==N&&(x.flags|=2048)}return p!==o&&p&&(c.child.flags|=8192),Vf(c,c.updateQueue),Dn(c),null;case 4:return _e(),o===null&&xm(c.stateNode.containerInfo),Dn(c),null;case 10:return Ki(c.type),Dn(c),null;case 19:if(ce(sr),N=c.memoizedState,N===null)return Dn(c),null;if(x=(c.flags&128)!==0,P=N.rendering,P===null)if(x)sd(N,!1);else{if(or!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(P=Zu(o),P!==null){for(c.flags|=128,sd(N,!1),o=P.updateQueue,c.updateQueue=o,Vf(c,o),c.subtreeFlags=0,o=p,p=c.child;p!==null;)Au(p,o),p=p.sibling;return M(sr,sr.current&1|2),c.child}o=o.sibling}N.tail!==null&&Ee()>Ac&&(c.flags|=128,x=!0,sd(N,!1),c.lanes=4194304)}else{if(!x)if(o=Zu(P),o!==null){if(c.flags|=128,x=!0,o=o.updateQueue,c.updateQueue=o,Vf(c,o),sd(N,!0),N.tail===null&&N.tailMode==="hidden"&&!P.alternate&&!Zt)return Dn(c),null}else 2*Ee()-N.renderingStartTime>Ac&&p!==536870912&&(c.flags|=128,x=!0,sd(N,!1),c.lanes=4194304);N.isBackwards?(P.sibling=c.child,c.child=P):(o=N.last,o!==null?o.sibling=P:c.child=P,N.last=P)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=Ee(),c.sibling=null,o=sr.current,M(sr,x?o&1|2:o&1),c):(Dn(c),null);case 22:case 23:return Za(c),Np(),x=c.memoizedState!==null,o!==null?o.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(p&536870912)!==0&&(c.flags&128)===0&&(Dn(c),c.subtreeFlags&6&&(c.flags|=8192)):Dn(c),p=c.updateQueue,p!==null&&Vf(c,p.retryQueue),p=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==p&&(c.flags|=2048),o!==null&&ce(ml),null;case 24:return p=null,o!==null&&(p=o.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),Ki(Pn),Dn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function my(o,c){switch(Du(c),c.tag){case 1:return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return Ki(Pn),_e(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 26:case 27:case 5:return tt(c),null;case 13:if(Za(c),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Mu()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return ce(sr),null;case 4:return _e(),null;case 10:return Ki(c.type),null;case 22:case 23:return Za(c),Np(),o!==null&&ce(ml),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 24:return Ki(Pn),null;case 25:return null;default:return null}}function gy(o,c){switch(Du(c),c.tag){case 3:Ki(Pn),_e();break;case 26:case 27:case 5:tt(c);break;case 4:_e();break;case 13:Za(c);break;case 19:ce(sr);break;case 10:Ki(c.type);break;case 22:case 23:Za(c),Np(),o!==null&&ce(ml);break;case 24:Ki(Pn)}}function od(o,c){try{var p=c.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var N=x.next;p=N;do{if((p.tag&o)===o){x=void 0;var P=p.create,H=p.inst;x=P(),H.destroy=x}p=p.next}while(p!==N)}}catch(Z){In(c,c.return,Z)}}function So(o,c,p){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var P=N.next;x=P;do{if((x.tag&o)===o){var H=x.inst,Z=H.destroy;if(Z!==void 0){H.destroy=void 0,N=c;var ye=p,Ie=Z;try{Ie()}catch(qe){In(N,ye,qe)}}}x=x.next}while(x!==P)}}catch(qe){In(c,c.return,qe)}}function yy(o){var c=o.updateQueue;if(c!==null){var p=o.stateNode;try{Sp(c,p)}catch(x){In(o,o.return,x)}}}function Jp(o,c,p){p.props=vo(o.type,o.memoizedProps),p.state=o.memoizedState;try{p.componentWillUnmount()}catch(x){In(o,c,x)}}function Nc(o,c){try{var p=o.ref;if(p!==null){switch(o.tag){case 26:case 27:case 5:var x=o.stateNode;break;case 30:x=o.stateNode;break;default:x=o.stateNode}typeof p=="function"?o.refCleanup=p(x):p.current=x}}catch(N){In(o,c,N)}}function ts(o,c){var p=o.ref,x=o.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(N){In(o,c,N)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(N){In(o,c,N)}else p.current=null}function Hf(o){var c=o.type,p=o.memoizedProps,x=o.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(N){In(o,o.return,N)}}function Gf(o,c,p){try{var x=o.stateNode;M0(x,o.type,p,c),x[zn]=c}catch(N){In(o,o.return,N)}}function Cc(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&na(o.type)||o.tag===4}function ld(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Cc(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&na(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Yf(o,c,p){var x=o.tag;if(x===5||x===6)o=o.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(o,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(o),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=rh));else if(x!==4&&(x===27&&na(o.type)&&(p=o.stateNode,c=null),o=o.child,o!==null))for(Yf(o,c,p),o=o.sibling;o!==null;)Yf(o,c,p),o=o.sibling}function cd(o,c,p){var x=o.tag;if(x===5||x===6)o=o.stateNode,c?p.insertBefore(o,c):p.appendChild(o);else if(x!==4&&(x===27&&na(o.type)&&(p=o.stateNode),o=o.child,o!==null))for(cd(o,c,p),o=o.sibling;o!==null;)cd(o,c,p),o=o.sibling}function ud(o){var c=o.stateNode,p=o.memoizedProps;try{for(var x=o.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);Sr(c,x,p),c[Zn]=o,c[zn]=p}catch(P){In(o,o.return,P)}}var ns=!1,bn=!1,Is=!1,xy=typeof WeakSet=="function"?WeakSet:Set,vr=null;function v0(o,c){if(o=o.containerInfo,Aa=dh,o=Cu(o),lc(o)){if("selectionStart"in o)var p={start:o.selectionStart,end:o.selectionEnd};else e:{p=(p=o.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var N=x.anchorOffset,P=x.focusNode;x=x.focusOffset;try{p.nodeType,P.nodeType}catch{p=null;break e}var H=0,Z=-1,ye=-1,Ie=0,qe=0,Ye=o,Le=null;t:for(;;){for(var Re;Ye!==p||N!==0&&Ye.nodeType!==3||(Z=H+N),Ye!==P||x!==0&&Ye.nodeType!==3||(ye=H+x),Ye.nodeType===3&&(H+=Ye.nodeValue.length),(Re=Ye.firstChild)!==null;)Le=Ye,Ye=Re;for(;;){if(Ye===o)break t;if(Le===p&&++Ie===N&&(Z=H),Le===P&&++qe===x&&(ye=H),(Re=Ye.nextSibling)!==null)break;Ye=Le,Le=Ye.parentNode}Ye=Re}p=Z===-1||ye===-1?null:{start:Z,end:ye}}else p=null}p=p||{start:0,end:0}}else p=null;for(ih={focusedElem:o,selectionRange:p},dh=!1,vr=c;vr!==null;)if(c=vr,o=c.child,(c.subtreeFlags&1024)!==0&&o!==null)o.return=c,vr=o;else for(;vr!==null;){switch(c=vr,P=c.alternate,o=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&P!==null){o=void 0,p=c,N=P.memoizedProps,P=P.memoizedState,x=p.stateNode;try{var Nt=vo(p.type,N,p.elementType===p.type);o=x.getSnapshotBeforeUpdate(Nt,P),x.__reactInternalSnapshotBeforeUpdate=o}catch(wt){In(p,p.return,wt)}}break;case 3:if((o&1024)!==0){if(o=c.stateNode.containerInfo,p=o.nodeType,p===9)wm(o);else if(p===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":wm(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(r(163))}if(o=c.sibling,o!==null){o.return=c.return,vr=o;break}vr=c.return}}function by(o,c,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:No(o,p),x&4&&od(5,p);break;case 1:if(No(o,p),x&4)if(o=p.stateNode,c===null)try{o.componentDidMount()}catch(H){In(p,p.return,H)}else{var N=vo(p.type,c.memoizedProps);c=c.memoizedState;try{o.componentDidUpdate(N,c,o.__reactInternalSnapshotBeforeUpdate)}catch(H){In(p,p.return,H)}}x&64&&yy(p),x&512&&Nc(p,p.return);break;case 3:if(No(o,p),x&64&&(o=p.updateQueue,o!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{Sp(o,c)}catch(H){In(p,p.return,H)}}break;case 27:c===null&&x&4&&ud(p);case 26:case 5:No(o,p),c===null&&x&4&&Hf(p),x&512&&Nc(p,p.return);break;case 12:No(o,p);break;case 13:No(o,p),x&4&&Sy(o,p),x&64&&(o=p.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(p=Xf.bind(null,p),Oc(o,p))));break;case 22:if(x=p.memoizedState!==null||ns,!x){c=c!==null&&c.memoizedState!==null||bn,N=ns;var P=bn;ns=x,(bn=c)&&!P?Rs(o,p,(p.subtreeFlags&8772)!==0):No(o,p),ns=N,bn=P}break;case 30:break;default:No(o,p)}}function vy(o){var c=o.alternate;c!==null&&(o.alternate=null,vy(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&ou(c)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Yn=null,bi=!1;function Ms(o,c,p){for(p=p.child;p!==null;)wy(o,c,p),p=p.sibling}function wy(o,c,p){if(re&&typeof re.onCommitFiberUnmount=="function")try{re.onCommitFiberUnmount(Q,p)}catch{}switch(p.tag){case 26:bn||ts(p,c),Ms(o,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:bn||ts(p,c);var x=Yn,N=bi;na(p.type)&&(Yn=p.stateNode,bi=!1),Ms(o,c,p),wd(p.stateNode),Yn=x,bi=N;break;case 5:bn||ts(p,c);case 6:if(x=Yn,N=bi,Yn=null,Ms(o,c,p),Yn=x,bi=N,Yn!==null)if(bi)try{(Yn.nodeType===9?Yn.body:Yn.nodeName==="HTML"?Yn.ownerDocument.body:Yn).removeChild(p.stateNode)}catch(P){In(p,c,P)}else try{Yn.removeChild(p.stateNode)}catch(P){In(p,c,P)}break;case 18:Yn!==null&&(bi?(o=Yn,sh(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,p.stateNode),Td(o)):sh(Yn,p.stateNode));break;case 4:x=Yn,N=bi,Yn=p.stateNode.containerInfo,bi=!0,Ms(o,c,p),Yn=x,bi=N;break;case 0:case 11:case 14:case 15:bn||So(2,p,c),bn||So(4,p,c),Ms(o,c,p);break;case 1:bn||(ts(p,c),x=p.stateNode,typeof x.componentWillUnmount=="function"&&Jp(p,c,x)),Ms(o,c,p);break;case 21:Ms(o,c,p);break;case 22:bn=(x=bn)||p.memoizedState!==null,Ms(o,c,p),bn=x;break;default:Ms(o,c,p)}}function Sy(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Td(o)}catch(p){In(c,c.return,p)}}function w0(o){switch(o.tag){case 13:case 19:var c=o.stateNode;return c===null&&(c=o.stateNode=new xy),c;case 22:return o=o.stateNode,c=o._retryCache,c===null&&(c=o._retryCache=new xy),c;default:throw Error(r(435,o.tag))}}function Kp(o,c){var p=w0(o);c.forEach(function(x){var N=k0.bind(null,o,x);p.has(x)||(p.add(x),x.then(N,N))})}function Ri(o,c){var p=c.deletions;if(p!==null)for(var x=0;x<p.length;x++){var N=p[x],P=o,H=c,Z=H;e:for(;Z!==null;){switch(Z.tag){case 27:if(na(Z.type)){Yn=Z.stateNode,bi=!1;break e}break;case 5:Yn=Z.stateNode,bi=!1;break e;case 3:case 4:Yn=Z.stateNode.containerInfo,bi=!0;break e}Z=Z.return}if(Yn===null)throw Error(r(160));wy(P,H,N),Yn=null,bi=!1,P=N.alternate,P!==null&&(P.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Xp(c,o),c=c.sibling}var ea=null;function Xp(o,c){var p=o.alternate,x=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Ri(c,o),vi(o),x&4&&(So(3,o,o.return),od(3,o),So(5,o,o.return));break;case 1:Ri(c,o),vi(o),x&512&&(bn||p===null||ts(p,p.return)),x&64&&ns&&(o=o.updateQueue,o!==null&&(x=o.callbacks,x!==null&&(p=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var N=ea;if(Ri(c,o),vi(o),x&512&&(bn||p===null||ts(p,p.return)),x&4){var P=p!==null?p.memoizedState:null;if(x=o.memoizedState,p===null)if(x===null)if(o.stateNode===null){e:{x=o.type,p=o.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":P=N.getElementsByTagName("title")[0],(!P||P[hs]||P[Zn]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=N.createElement(x),N.head.insertBefore(P,N.querySelector("head > title"))),Sr(P,x,p),P[Zn]=o,dr(P),x=P;break e;case"link":var H=fx("link","href",N).get(x+(p.href||""));if(H){for(var Z=0;Z<H.length;Z++)if(P=H[Z],P.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&P.getAttribute("rel")===(p.rel==null?null:p.rel)&&P.getAttribute("title")===(p.title==null?null:p.title)&&P.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){H.splice(Z,1);break t}}P=N.createElement(x),Sr(P,x,p),N.head.appendChild(P);break;case"meta":if(H=fx("meta","content",N).get(x+(p.content||""))){for(Z=0;Z<H.length;Z++)if(P=H[Z],P.getAttribute("content")===(p.content==null?null:""+p.content)&&P.getAttribute("name")===(p.name==null?null:p.name)&&P.getAttribute("property")===(p.property==null?null:p.property)&&P.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&P.getAttribute("charset")===(p.charSet==null?null:p.charSet)){H.splice(Z,1);break t}}P=N.createElement(x),Sr(P,x,p),N.head.appendChild(P);break;default:throw Error(r(468,x))}P[Zn]=o,dr(P),x=P}o.stateNode=x}else hx(N,o.type,o.stateNode);else o.stateNode=dx(N,x,o.memoizedProps);else P!==x?(P===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):P.count--,x===null?hx(N,o.type,o.stateNode):dx(N,x,o.memoizedProps)):x===null&&o.stateNode!==null&&Gf(o,o.memoizedProps,p.memoizedProps)}break;case 27:Ri(c,o),vi(o),x&512&&(bn||p===null||ts(p,p.return)),p!==null&&x&4&&Gf(o,o.memoizedProps,p.memoizedProps);break;case 5:if(Ri(c,o),vi(o),x&512&&(bn||p===null||ts(p,p.return)),o.flags&32){N=o.stateNode;try{ga(N,"")}catch(Re){In(o,o.return,Re)}}x&4&&o.stateNode!=null&&(N=o.memoizedProps,Gf(o,N,p!==null?p.memoizedProps:N)),x&1024&&(Is=!0);break;case 6:if(Ri(c,o),vi(o),x&4){if(o.stateNode===null)throw Error(r(162));x=o.memoizedProps,p=o.stateNode;try{p.nodeValue=x}catch(Re){In(o,o.return,Re)}}break;case 3:if(zc=null,N=ea,ea=Ot(c.containerInfo),Ri(c,o),ea=N,vi(o),x&4&&p!==null&&p.memoizedState.isDehydrated)try{Td(c.containerInfo)}catch(Re){In(o,o.return,Re)}Is&&(Is=!1,Ny(o));break;case 4:x=ea,ea=Ot(o.stateNode.containerInfo),Ri(c,o),vi(o),ea=x;break;case 12:Ri(c,o),vi(o);break;case 13:Ri(c,o),vi(o),o.child.flags&8192&&o.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(am=Ee()),x&4&&(x=o.updateQueue,x!==null&&(o.updateQueue=null,Kp(o,x)));break;case 22:N=o.memoizedState!==null;var ye=p!==null&&p.memoizedState!==null,Ie=ns,qe=bn;if(ns=Ie||N,bn=qe||ye,Ri(c,o),bn=qe,ns=Ie,vi(o),x&8192)e:for(c=o.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(p===null||ye||ns||bn||kl(o)),p=null,c=o;;){if(c.tag===5||c.tag===26){if(p===null){ye=p=c;try{if(P=ye.stateNode,N)H=P.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none";else{Z=ye.stateNode;var Ye=ye.memoizedProps.style,Le=Ye!=null&&Ye.hasOwnProperty("display")?Ye.display:null;Z.style.display=Le==null||typeof Le=="boolean"?"":(""+Le).trim()}}catch(Re){In(ye,ye.return,Re)}}}else if(c.tag===6){if(p===null){ye=c;try{ye.stateNode.nodeValue=N?"":ye.memoizedProps}catch(Re){In(ye,ye.return,Re)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===o)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break e;for(;c.sibling===null;){if(c.return===null||c.return===o)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=o.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Kp(o,p))));break;case 19:Ri(c,o),vi(o),x&4&&(x=o.updateQueue,x!==null&&(o.updateQueue=null,Kp(o,x)));break;case 30:break;case 21:break;default:Ri(c,o),vi(o)}}function vi(o){var c=o.flags;if(c&2){try{for(var p,x=o.return;x!==null;){if(Cc(x)){p=x;break}x=x.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var N=p.stateNode,P=ld(o);cd(o,P,N);break;case 5:var H=p.stateNode;p.flags&32&&(ga(H,""),p.flags&=-33);var Z=ld(o);cd(o,Z,H);break;case 3:case 4:var ye=p.stateNode.containerInfo,Ie=ld(o);Yf(o,Ie,ye);break;default:throw Error(r(161))}}catch(qe){In(o,o.return,qe)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function Ny(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var c=o;Ny(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),o=o.sibling}}function No(o,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)by(o,c.alternate,c),c=c.sibling}function kl(o){for(o=o.child;o!==null;){var c=o;switch(c.tag){case 0:case 11:case 14:case 15:So(4,c,c.return),kl(c);break;case 1:ts(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&Jp(c,c.return,p),kl(c);break;case 27:wd(c.stateNode);case 26:case 5:ts(c,c.return),kl(c);break;case 22:c.memoizedState===null&&kl(c);break;case 30:kl(c);break;default:kl(c)}o=o.sibling}}function Rs(o,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=o,P=c,H=P.flags;switch(P.tag){case 0:case 11:case 15:Rs(N,P,p),od(4,P);break;case 1:if(Rs(N,P,p),x=P,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Ie){In(x,x.return,Ie)}if(x=P,N=x.updateQueue,N!==null){var Z=x.stateNode;try{var ye=N.shared.hiddenCallbacks;if(ye!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ye.length;N++)Ug(ye[N],Z)}catch(Ie){In(x,x.return,Ie)}}p&&H&64&&yy(P),Nc(P,P.return);break;case 27:ud(P);case 26:case 5:Rs(N,P,p),p&&x===null&&H&4&&Hf(P),Nc(P,P.return);break;case 12:Rs(N,P,p);break;case 13:Rs(N,P,p),p&&H&4&&Sy(N,P);break;case 22:P.memoizedState===null&&Rs(N,P,p),Nc(P,P.return);break;case 30:break;default:Rs(N,P,p)}c=c.sibling}}function Zp(o,c){var p=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),o=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(o=c.memoizedState.cachePool.pool),o!==p&&(o!=null&&o.refCount++,p!=null&&Ou(p))}function em(o,c){o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&Ou(o))}function rs(o,c,p,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Cy(o,c,p,x),c=c.sibling}function Cy(o,c,p,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:rs(o,c,p,x),N&2048&&od(9,c);break;case 1:rs(o,c,p,x);break;case 3:rs(o,c,p,x),N&2048&&(o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&Ou(o)));break;case 12:if(N&2048){rs(o,c,p,x),o=c.stateNode;try{var P=c.memoizedProps,H=P.id,Z=P.onPostCommit;typeof Z=="function"&&Z(H,c.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(ye){In(c,c.return,ye)}}else rs(o,c,p,x);break;case 13:rs(o,c,p,x);break;case 23:break;case 22:P=c.stateNode,H=c.alternate,c.memoizedState!==null?P._visibility&2?rs(o,c,p,x):dd(o,c):P._visibility&2?rs(o,c,p,x):(P._visibility|=2,jc(o,c,p,x,(c.subtreeFlags&10256)!==0)),N&2048&&Zp(H,c);break;case 24:rs(o,c,p,x),N&2048&&em(c.alternate,c);break;default:rs(o,c,p,x)}}function jc(o,c,p,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var P=o,H=c,Z=p,ye=x,Ie=H.flags;switch(H.tag){case 0:case 11:case 15:jc(P,H,Z,ye,N),od(8,H);break;case 23:break;case 22:var qe=H.stateNode;H.memoizedState!==null?qe._visibility&2?jc(P,H,Z,ye,N):dd(P,H):(qe._visibility|=2,jc(P,H,Z,ye,N)),N&&Ie&2048&&Zp(H.alternate,H);break;case 24:jc(P,H,Z,ye,N),N&&Ie&2048&&em(H.alternate,H);break;default:jc(P,H,Z,ye,N)}c=c.sibling}}function dd(o,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=o,x=c,N=x.flags;switch(x.tag){case 22:dd(p,x),N&2048&&Zp(x.alternate,x);break;case 24:dd(p,x),N&2048&&em(x.alternate,x);break;default:dd(p,x)}c=c.sibling}}var Gr=8192;function _c(o){if(o.subtreeFlags&Gr)for(o=o.child;o!==null;)jy(o),o=o.sibling}function jy(o){switch(o.tag){case 26:_c(o),o.flags&Gr&&o.memoizedState!==null&&G0(ea,o.memoizedState,o.memoizedProps);break;case 5:_c(o);break;case 3:case 4:var c=ea;ea=Ot(o.stateNode.containerInfo),_c(o),ea=c;break;case 22:o.memoizedState===null&&(c=o.alternate,c!==null&&c.memoizedState!==null?(c=Gr,Gr=16777216,_c(o),Gr=c):_c(o));break;default:_c(o)}}function _y(o){var c=o.alternate;if(c!==null&&(o=c.child,o!==null)){c.child=null;do c=o.sibling,o.sibling=null,o=c;while(o!==null)}}function kc(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];vr=x,Ey(x,o)}_y(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)ky(o),o=o.sibling}function ky(o){switch(o.tag){case 0:case 11:case 15:kc(o),o.flags&2048&&So(9,o,o.return);break;case 3:kc(o);break;case 12:kc(o);break;case 22:var c=o.stateNode;o.memoizedState!==null&&c._visibility&2&&(o.return===null||o.return.tag!==13)?(c._visibility&=-3,Wf(o)):kc(o);break;default:kc(o)}}function Wf(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];vr=x,Ey(x,o)}_y(o)}for(o=o.child;o!==null;){switch(c=o,c.tag){case 0:case 11:case 15:So(8,c,c.return),Wf(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,Wf(c));break;default:Wf(c)}o=o.sibling}}function Ey(o,c){for(;vr!==null;){var p=vr;switch(p.tag){case 0:case 11:case 15:So(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Ou(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,vr=x;else e:for(p=o;vr!==null;){x=vr;var N=x.sibling,P=x.return;if(vy(x),x===p){vr=null;break e}if(N!==null){N.return=P,vr=N;break e}vr=P}}}var S0={getCacheForType:function(o){var c=ar(Pn),p=c.data.get(o);return p===void 0&&(p=o(),c.data.set(o,p)),p}},tm=typeof WeakMap=="function"?WeakMap:Map,wn=0,On=null,Qt=null,ln=0,Sn=0,Oi=null,Co=!1,Ec=!1,nm=!1,Os=0,or=0,jo=0,El=0,rm=0,ta=0,Tc=0,fd=null,wi=null,im=!1,am=0,Ac=1/0,hd=null,_o=null,Lr=0,ko=null,Pc=null,Dc=0,sm=0,om=null,Ty=null,Ic=0,lm=null;function Yr(){if((wn&2)!==0&&ln!==0)return ln&-ln;if(K.T!==null){var o=pc;return o!==0?o:th()}return ha()}function Ay(){ta===0&&(ta=(ln&536870912)===0||Zt?xt():536870912);var o=Mi.current;return o!==null&&(o.flags|=32),ta}function Li(o,c,p){(o===On&&(Sn===2||Sn===9)||o.cancelPendingCommit!==null)&&(Mc(o,0),Eo(o,ln,ta,!1)),_n(o,p),((wn&2)===0||o!==On)&&(o===On&&((wn&2)===0&&(El|=p),or===4&&Eo(o,ln,ta,!1)),is(o))}function Py(o,c,p){if((wn&6)!==0)throw Error(r(327));var x=!p&&(c&124)===0&&(c&o.expiredLanes)===0||st(o,c),N=x?j0(o,c):dm(o,c,!0),P=x;do{if(N===0){Ec&&!x&&Eo(o,c,0,!1);break}else{if(p=o.current.alternate,P&&!N0(p)){N=dm(o,c,!1),P=!1;continue}if(N===2){if(P=c,o.errorRecoveryDisabledLanes&P)var H=0;else H=o.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){c=H;e:{var Z=o;N=fd;var ye=Z.current.memoizedState.isDehydrated;if(ye&&(Mc(Z,H).flags|=256),H=dm(Z,H,!1),H!==2){if(nm&&!ye){Z.errorRecoveryDisabledLanes|=P,El|=P,N=4;break e}P=wi,wi=N,P!==null&&(wi===null?wi=P:wi.push.apply(wi,P))}N=H}if(P=!1,N!==2)continue}}if(N===1){Mc(o,0),Eo(o,c,0,!0);break}e:{switch(x=o,P=N,P){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Eo(x,c,ta,!Co);break e;case 2:wi=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(N=am+300-Ee(),10<N)){if(Eo(x,c,ta,!Co),Fe(x,0,!0)!==0)break e;x.timeoutHandle=tx(Dy.bind(null,x,p,wi,hd,im,c,ta,El,Tc,Co,P,2,-0,0),N);break e}Dy(x,p,wi,hd,im,c,ta,El,Tc,Co,P,0,-0,0)}}break}while(!0);is(o)}function Dy(o,c,p,x,N,P,H,Z,ye,Ie,qe,Ye,Le,Re){if(o.timeoutHandle=-1,Ye=c.subtreeFlags,(Ye&8192||(Ye&16785408)===16785408)&&(Tr={stylesheets:null,count:0,unsuspend:H0},jy(c),Ye=Y0(),Ye!==null)){o.cancelPendingCommit=Ye(pd.bind(null,o,c,P,p,x,N,H,Z,ye,qe,1,Le,Re)),Eo(o,P,H,!Ie);return}pd(o,c,P,p,x,N,H,Z,ye)}function N0(o){for(var c=o;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var N=p[x],P=N.getSnapshot;N=N.value;try{if(!Zr(P(),N))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Eo(o,c,p,x){c&=~rm,c&=~El,o.suspendedLanes|=c,o.pingedLanes&=~c,x&&(o.warmLanes|=c),x=o.expirationTimes;for(var N=c;0<N;){var P=31-Ae(N),H=1<<P;x[P]=-1,N&=~H}p!==0&&fn(o,p,c)}function Qf(){return(wn&6)===0?(yd(0),!1):!0}function cm(){if(Qt!==null){if(Sn===0)var o=Qt.return;else o=Qt,X=mo=null,vf(o),br=null,xi=0,o=Qt;for(;o!==null;)gy(o.alternate,o),o=o.return;Qt=null}}function Mc(o,c){var p=o.timeoutHandle;p!==-1&&(o.timeoutHandle=-1,O0(p)),p=o.cancelPendingCommit,p!==null&&(o.cancelPendingCommit=null,p()),cm(),On=o,Qt=p=ti(o.current,null),ln=c,Sn=0,Oi=null,Co=!1,Ec=st(o,c),nm=!1,Tc=ta=rm=El=jo=or=0,wi=fd=null,im=!1,(c&8)!==0&&(c|=c&32);var x=o.entangledLanes;if(x!==0)for(o=o.entanglements,x&=c;0<x;){var N=31-Ae(x),P=1<<N;c|=o[N],x&=~P}return Os=c,ol(),p}function Iy(o,c){Bt=null,K.H=Ku,c===ni||c===yf?(c=zg(),Sn=3):c===Fg?(c=zg(),Sn=4):Sn=c===uy?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Oi=c,Qt===null&&(or=1,nd(o,ei(c,o.current)))}function My(){var o=K.H;return K.H=Ku,o===null?Ku:o}function Ry(){var o=K.A;return K.A=S0,o}function um(){or=4,Co||(ln&4194048)!==ln&&Mi.current!==null||(Ec=!0),(jo&134217727)===0&&(El&134217727)===0||On===null||Eo(On,ln,ta,!1)}function dm(o,c,p){var x=wn;wn|=2;var N=My(),P=Ry();(On!==o||ln!==c)&&(hd=null,Mc(o,c)),c=!1;var H=or;e:do try{if(Sn!==0&&Qt!==null){var Z=Qt,ye=Oi;switch(Sn){case 8:cm(),H=6;break e;case 3:case 2:case 9:case 6:Mi.current===null&&(c=!0);var Ie=Sn;if(Sn=0,Oi=null,Rc(o,Z,ye,Ie),p&&Ec){H=0;break e}break;default:Ie=Sn,Sn=0,Oi=null,Rc(o,Z,ye,Ie)}}C0(),H=or;break}catch(qe){Iy(o,qe)}while(!0);return c&&o.shellSuspendCounter++,X=mo=null,wn=x,K.H=N,K.A=P,Qt===null&&(On=null,ln=0,ol()),H}function C0(){for(;Qt!==null;)fm(Qt)}function j0(o,c){var p=wn;wn|=2;var x=My(),N=Ry();On!==o||ln!==c?(hd=null,Ac=Ee()+500,Mc(o,c)):Ec=st(o,c);e:do try{if(Sn!==0&&Qt!==null){c=Qt;var P=Oi;t:switch(Sn){case 1:Sn=0,Oi=null,Rc(o,c,P,1);break;case 2:case 9:if($g(P)){Sn=0,Oi=null,Ly(c);break}c=function(){Sn!==2&&Sn!==9||On!==o||(Sn=7),is(o)},P.then(c,c);break e;case 3:Sn=7;break e;case 4:Sn=5;break e;case 7:$g(P)?(Sn=0,Oi=null,Ly(c)):(Sn=0,Oi=null,Rc(o,c,P,7));break;case 5:var H=null;switch(Qt.tag){case 26:H=Qt.memoizedState;case 5:case 27:var Z=Qt;if(!H||Nr(H)){Sn=0,Oi=null;var ye=Z.sibling;if(ye!==null)Qt=ye;else{var Ie=Z.return;Ie!==null?(Qt=Ie,Jf(Ie)):Qt=null}break t}}Sn=0,Oi=null,Rc(o,c,P,5);break;case 6:Sn=0,Oi=null,Rc(o,c,P,6);break;case 8:cm(),or=6;break e;default:throw Error(r(462))}}Oy();break}catch(qe){Iy(o,qe)}while(!0);return X=mo=null,K.H=x,K.A=N,wn=p,Qt!==null?0:(On=null,ln=0,ol(),or)}function Oy(){for(;Qt!==null&&!Me();)fm(Qt)}function fm(o){var c=Uf(o.alternate,o,Os);o.memoizedProps=o.pendingProps,c===null?Jf(o):Qt=c}function Ly(o){var c=o,p=c.alternate;switch(c.tag){case 15:case 0:c=zf(p,c,c.pendingProps,c.type,void 0,ln);break;case 11:c=zf(p,c,c.pendingProps,c.type.render,c.ref,ln);break;case 5:vf(c);default:gy(p,c),c=Qt=Au(c,Os),c=Uf(p,c,Os)}o.memoizedProps=o.pendingProps,c===null?Jf(o):Qt=c}function Rc(o,c,p,x){X=mo=null,vf(c),br=null,xi=0;var N=c.return;try{if(cy(o,N,c,p,ln)){or=1,nd(o,ei(p,o.current)),Qt=null;return}}catch(P){if(N!==null)throw Qt=N,P;or=1,nd(o,ei(p,o.current)),Qt=null;return}c.flags&32768?(Zt||x===1?o=!0:Ec||(ln&536870912)!==0?o=!1:(Co=o=!0,(x===2||x===9||x===3||x===6)&&(x=Mi.current,x!==null&&x.tag===13&&(x.flags|=16384))),Fy(c,o)):Jf(c)}function Jf(o){var c=o;do{if((c.flags&32768)!==0){Fy(c,Co);return}o=c.return;var p=py(c.alternate,c,Os);if(p!==null){Qt=p;return}if(c=c.sibling,c!==null){Qt=c;return}Qt=c=o}while(c!==null);or===0&&(or=5)}function Fy(o,c){do{var p=my(o.alternate,o);if(p!==null){p.flags&=32767,Qt=p;return}if(p=o.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(o=o.sibling,o!==null)){Qt=o;return}Qt=o=p}while(o!==null);or=6,Qt=null}function pd(o,c,p,x,N,P,H,Z,ye){o.cancelPendingCommit=null;do Kf();while(Lr!==0);if((wn&6)!==0)throw Error(r(327));if(c!==null){if(c===o.current)throw Error(r(177));if(P=c.lanes|c.childLanes,P|=pp,yn(o,p,P,H,Z,ye),o===On&&(Qt=On=null,ln=0),Pc=c,ko=o,Dc=p,sm=P,om=N,Ty=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,Gy(Ze,function(){return qy(),null})):(o.callbackNode=null,o.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=K.T,K.T=null,N=V.p,V.p=2,H=wn,wn|=4;try{v0(o,c,p)}finally{wn=H,V.p=N,K.T=x}}Lr=1,$y(),zy(),By()}}function $y(){if(Lr===1){Lr=0;var o=ko,c=Pc,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=K.T,K.T=null;var x=V.p;V.p=2;var N=wn;wn|=4;try{Xp(c,o);var P=ih,H=Cu(o.containerInfo),Z=P.focusedElem,ye=P.selectionRange;if(H!==Z&&Z&&Z.ownerDocument&&lf(Z.ownerDocument.documentElement,Z)){if(ye!==null&&lc(Z)){var Ie=ye.start,qe=ye.end;if(qe===void 0&&(qe=Ie),"selectionStart"in Z)Z.selectionStart=Ie,Z.selectionEnd=Math.min(qe,Z.value.length);else{var Ye=Z.ownerDocument||document,Le=Ye&&Ye.defaultView||window;if(Le.getSelection){var Re=Le.getSelection(),Nt=Z.textContent.length,wt=Math.min(ye.start,Nt),En=ye.end===void 0?wt:Math.min(ye.end,Nt);!Re.extend&&wt>En&&(H=En,En=wt,wt=H);var ke=Nu(Z,wt),Ce=Nu(Z,En);if(ke&&Ce&&(Re.rangeCount!==1||Re.anchorNode!==ke.node||Re.anchorOffset!==ke.offset||Re.focusNode!==Ce.node||Re.focusOffset!==Ce.offset)){var De=Ye.createRange();De.setStart(ke.node,ke.offset),Re.removeAllRanges(),wt>En?(Re.addRange(De),Re.extend(Ce.node,Ce.offset)):(De.setEnd(Ce.node,Ce.offset),Re.addRange(De))}}}}for(Ye=[],Re=Z;Re=Re.parentNode;)Re.nodeType===1&&Ye.push({element:Re,left:Re.scrollLeft,top:Re.scrollTop});for(typeof Z.focus=="function"&&Z.focus(),Z=0;Z<Ye.length;Z++){var He=Ye[Z];He.element.scrollLeft=He.left,He.element.scrollTop=He.top}}dh=!!Aa,ih=Aa=null}finally{wn=N,V.p=x,K.T=p}}o.current=c,Lr=2}}function zy(){if(Lr===2){Lr=0;var o=ko,c=Pc,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=K.T,K.T=null;var x=V.p;V.p=2;var N=wn;wn|=4;try{by(o,c.alternate,c)}finally{wn=N,V.p=x,K.T=p}}Lr=3}}function By(){if(Lr===4||Lr===3){Lr=0,ve();var o=ko,c=Pc,p=Dc,x=Ty;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Lr=5:(Lr=0,Pc=ko=null,Uy(o,o.pendingLanes));var N=o.pendingLanes;if(N===0&&(_o=null),li(p),c=c.stateNode,re&&typeof re.onCommitFiberRoot=="function")try{re.onCommitFiberRoot(Q,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=K.T,N=V.p,V.p=2,K.T=null;try{for(var P=o.onRecoverableError,H=0;H<x.length;H++){var Z=x[H];P(Z.value,{componentStack:Z.stack})}}finally{K.T=c,V.p=N}}(Dc&3)!==0&&Kf(),is(o),N=o.pendingLanes,(p&4194090)!==0&&(N&42)!==0?o===lm?Ic++:(Ic=0,lm=o):Ic=0,yd(0)}}function Uy(o,c){(o.pooledCacheLanes&=c)===0&&(c=o.pooledCache,c!=null&&(o.pooledCache=null,Ou(c)))}function Kf(o){return $y(),zy(),By(),qy()}function qy(){if(Lr!==5)return!1;var o=ko,c=sm;sm=0;var p=li(Dc),x=K.T,N=V.p;try{V.p=32>p?32:p,K.T=null,p=om,om=null;var P=ko,H=Dc;if(Lr=0,Pc=ko=null,Dc=0,(wn&6)!==0)throw Error(r(331));var Z=wn;if(wn|=4,ky(P.current),Cy(P,P.current,H,p),wn=Z,yd(0,!1),re&&typeof re.onPostCommitFiberRoot=="function")try{re.onPostCommitFiberRoot(Q,P)}catch{}return!0}finally{V.p=N,K.T=x,Uy(o,c)}}function Vy(o,c,p){c=ei(p,c),c=Of(o.stateNode,c,2),o=_s(o,c,2),o!==null&&(_n(o,2),is(o))}function In(o,c,p){if(o.tag===3)Vy(o,o,p);else for(;c!==null;){if(c.tag===3){Vy(c,o,p);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(_o===null||!_o.has(x))){o=ei(p,o),p=Hp(2),x=_s(c,p,2),x!==null&&(ly(p,x,c,o),_n(x,2),is(x));break}}c=c.return}}function hm(o,c,p){var x=o.pingCache;if(x===null){x=o.pingCache=new tm;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(p)||(nm=!0,N.add(p),o=_0.bind(null,o,c,p),c.then(o,o))}function _0(o,c,p){var x=o.pingCache;x!==null&&x.delete(c),o.pingedLanes|=o.suspendedLanes&p,o.warmLanes&=~p,On===o&&(ln&p)===p&&(or===4||or===3&&(ln&62914560)===ln&&300>Ee()-am?(wn&2)===0&&Mc(o,0):rm|=p,Tc===ln&&(Tc=0)),is(o)}function Hy(o,c){c===0&&(c=Vn()),o=ll(o,c),o!==null&&(_n(o,c),is(o))}function Xf(o){var c=o.memoizedState,p=0;c!==null&&(p=c.retryLane),Hy(o,p)}function k0(o,c){var p=0;switch(o.tag){case 13:var x=o.stateNode,N=o.memoizedState;N!==null&&(p=N.retryLane);break;case 19:x=o.stateNode;break;case 22:x=o.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),Hy(o,p)}function Gy(o,c){return Oe(o,c)}var md=null,To=null,Zf=!1,gd=!1,eh=!1,Ao=0;function is(o){o!==To&&o.next===null&&(To===null?md=To=o:To=To.next=o),gd=!0,Zf||(Zf=!0,pm())}function yd(o,c){if(!eh&&gd){eh=!0;do for(var p=!1,x=md;x!==null;){if(o!==0){var N=x.pendingLanes;if(N===0)var P=0;else{var H=x.suspendedLanes,Z=x.pingedLanes;P=(1<<31-Ae(42|o)+1)-1,P&=N&~(H&~Z),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(p=!0,Wy(x,P))}else P=ln,P=Fe(x,x===On?P:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(P&3)===0||st(x,P)||(p=!0,Wy(x,P));x=x.next}while(p);eh=!1}}function E0(){xd()}function xd(){gd=Zf=!1;var o=0;Ao!==0&&(R0()&&(o=Ao),Ao=0);for(var c=Ee(),p=null,x=md;x!==null;){var N=x.next,P=bd(x,c);P===0?(x.next=null,p===null?md=N:p.next=N,N===null&&(To=p)):(p=x,(o!==0||(P&3)!==0)&&(gd=!0)),x=N}yd(o)}function bd(o,c){for(var p=o.suspendedLanes,x=o.pingedLanes,N=o.expirationTimes,P=o.pendingLanes&-62914561;0<P;){var H=31-Ae(P),Z=1<<H,ye=N[H];ye===-1?((Z&p)===0||(Z&x)!==0)&&(N[H]=Je(Z,c)):ye<=c&&(o.expiredLanes|=Z),P&=~Z}if(c=On,p=ln,p=Fe(o,o===c?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),x=o.callbackNode,p===0||o===c&&(Sn===2||Sn===9)||o.cancelPendingCommit!==null)return x!==null&&x!==null&&xe(x),o.callbackNode=null,o.callbackPriority=0;if((p&3)===0||st(o,p)){if(c=p&-p,c===o.callbackPriority)return c;switch(x!==null&&xe(x),li(p)){case 2:case 8:p=lt;break;case 32:p=Ze;break;case 268435456:p=kt;break;default:p=Ze}return x=Yy.bind(null,o),p=Oe(p,x),o.callbackPriority=c,o.callbackNode=p,c}return x!==null&&x!==null&&xe(x),o.callbackPriority=2,o.callbackNode=null,2}function Yy(o,c){if(Lr!==0&&Lr!==5)return o.callbackNode=null,o.callbackPriority=0,null;var p=o.callbackNode;if(Kf()&&o.callbackNode!==p)return null;var x=ln;return x=Fe(o,o===On?x:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),x===0?null:(Py(o,x,c),bd(o,Ee()),o.callbackNode!=null&&o.callbackNode===p?Yy.bind(null,o):null)}function Wy(o,c){if(Kf())return null;Py(o,c,!0)}function pm(){L0(function(){(wn&6)!==0?Oe(rt,E0):xd()})}function th(){return Ao===0&&(Ao=xt()),Ao}function Qy(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:ys(""+o)}function Jy(o,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,o.id&&p.setAttribute("form",o.id),c.parentNode.insertBefore(p,c),o=new FormData(o),p.parentNode.removeChild(p),o}function T0(o,c,p,x,N){if(c==="submit"&&p&&p.stateNode===N){var P=Qy((N[zn]||null).action),H=x.submitter;H&&(c=(c=H[zn]||null)?Qy(c.formAction):H.getAttribute("formAction"),c!==null&&(P=c,H=null));var Z=new oo("action","action",null,x,N);o.push({event:Z,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Ao!==0){var ye=H?Jy(N,H):new FormData(N);Qu(p,{pending:!0,data:ye,method:N.method,action:P},null,ye)}}else typeof P=="function"&&(Z.preventDefault(),ye=H?Jy(N,H):new FormData(N),Qu(p,{pending:!0,data:ye,method:N.method,action:P},P,ye))},currentTarget:N}]})}}for(var mm=0;mm<pn.length;mm++){var gm=pn[mm],A0=gm.toLowerCase(),P0=gm[0].toUpperCase()+gm.slice(1);Na(A0,"on"+P0)}Na(fo,"onAnimationEnd"),Na(ju,"onAnimationIteration"),Na(hr,"onAnimationStart"),Na("dblclick","onDoubleClick"),Na("focusin","onFocus"),Na("focusout","onBlur"),Na(uf,"onTransitionRun"),Na(h0,"onTransitionStart"),Na(cc,"onTransitionCancel"),Na(_u,"onTransitionEnd"),Va("onMouseEnter",["mouseout","mouseover"]),Va("onMouseLeave",["mouseout","mouseover"]),Va("onPointerEnter",["pointerout","pointerover"]),Va("onPointerLeave",["pointerout","pointerover"]),ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ps("onBeforeInput",["compositionend","keypress","textInput","paste"]),ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(vd));function Ky(o,c){c=(c&4)!==0;for(var p=0;p<o.length;p++){var x=o[p],N=x.event;x=x.listeners;e:{var P=void 0;if(c)for(var H=x.length-1;0<=H;H--){var Z=x[H],ye=Z.instance,Ie=Z.currentTarget;if(Z=Z.listener,ye!==P&&N.isPropagationStopped())break e;P=Z,N.currentTarget=Ie;try{P(N)}catch(qe){jl(qe)}N.currentTarget=null,P=ye}else for(H=0;H<x.length;H++){if(Z=x[H],ye=Z.instance,Ie=Z.currentTarget,Z=Z.listener,ye!==P&&N.isPropagationStopped())break e;P=Z,N.currentTarget=Ie;try{P(N)}catch(qe){jl(qe)}N.currentTarget=null,P=ye}}}}function Jt(o,c){var p=c[fs];p===void 0&&(p=c[fs]=new Set);var x=o+"__bubble";p.has(x)||(Xy(c,o,2,!1),p.add(x))}function ym(o,c,p){var x=0;c&&(x|=4),Xy(p,o,x,c)}var Si="_reactListening"+Math.random().toString(36).slice(2);function xm(o){if(!o[Si]){o[Si]=!0,Zd.forEach(function(p){p!=="selectionchange"&&(D0.has(p)||ym(p,!1,o),ym(p,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[Si]||(c[Si]=!0,ym("selectionchange",!1,c))}}function Xy(o,c,p,x){switch(yx(c)){case 2:var N=J0;break;case 8:N=Uc;break;default:N=Em}p=N.bind(null,c,p,o),N=void 0,!so||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?o.addEventListener(c,p,{capture:!0,passive:N}):o.addEventListener(c,p,!0):N!==void 0?o.addEventListener(c,p,{passive:N}):o.addEventListener(c,p,!1)}function Ls(o,c,p,x,N){var P=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var H=x.tag;if(H===3||H===4){var Z=x.stateNode.containerInfo;if(Z===N)break;if(H===4)for(H=x.return;H!==null;){var ye=H.tag;if((ye===3||ye===4)&&H.stateNode.containerInfo===N)return;H=H.return}for(;Z!==null;){if(H=Qs(Z),H===null)return;if(ye=H.tag,ye===5||ye===6||ye===26||ye===27){x=P=H;continue e}Z=Z.parentNode}}x=x.return}ao(function(){var Ie=P,qe=Zo(p),Ye=[];e:{var Le=ku.get(o);if(Le!==void 0){var Re=oo,Nt=o;switch(o){case"keypress":if(xn(p)===0)break e;case"keydown":case"keyup":Re=gu;break;case"focusin":Nt="focus",Re=ba;break;case"focusout":Nt="blur",Re=ba;break;case"beforeblur":case"afterblur":Re=ba;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Re=Jr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Re=tl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Re=sp;break;case fo:case ju:case hr:Re=Xl;break;case _u:Re=op;break;case"scroll":case"scrollend":Re=fu;break;case"wheel":Re=lp;break;case"copy":case"cut":case"paste":Re=rf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Re=va;break;case"toggle":case"beforetoggle":Re=tc}var wt=(c&4)!==0,En=!wt&&(o==="scroll"||o==="scrollend"),ke=wt?Le!==null?Le+"Capture":null:Le;wt=[];for(var Ce=Ie,De;Ce!==null;){var He=Ce;if(De=He.stateNode,He=He.tag,He!==5&&He!==26&&He!==27||De===null||ke===null||(He=el(Ce,ke),He!=null&&wt.push(Pt(Ce,He,De))),En)break;Ce=Ce.return}0<wt.length&&(Le=new Re(Le,Nt,null,p,qe),Ye.push({event:Le,listeners:wt}))}}if((c&7)===0){e:{if(Le=o==="mouseover"||o==="pointerover",Re=o==="mouseout"||o==="pointerout",Le&&p!==io&&(Nt=p.relatedTarget||p.fromElement)&&(Qs(Nt)||Nt[Ua]))break e;if((Re||Le)&&(Le=qe.window===qe?qe:(Le=qe.ownerDocument)?Le.defaultView||Le.parentWindow:window,Re?(Nt=p.relatedTarget||p.toElement,Re=Ie,Nt=Nt?Qs(Nt):null,Nt!==null&&(En=s(Nt),wt=Nt.tag,Nt!==En||wt!==5&&wt!==27&&wt!==6)&&(Nt=null)):(Re=null,Nt=Ie),Re!==Nt)){if(wt=Jr,He="onMouseLeave",ke="onMouseEnter",Ce="mouse",(o==="pointerout"||o==="pointerover")&&(wt=va,He="onPointerLeave",ke="onPointerEnter",Ce="pointer"),En=Re==null?Le:qa(Re),De=Nt==null?Le:qa(Nt),Le=new wt(He,Ce+"leave",Re,p,qe),Le.target=En,Le.relatedTarget=De,He=null,Qs(qe)===Ie&&(wt=new wt(ke,Ce+"enter",Nt,p,qe),wt.target=De,wt.relatedTarget=En,He=wt),En=He,Re&&Nt)t:{for(wt=Re,ke=Nt,Ce=0,De=wt;De;De=wr(De))Ce++;for(De=0,He=ke;He;He=wr(He))De++;for(;0<Ce-De;)wt=wr(wt),Ce--;for(;0<De-Ce;)ke=wr(ke),De--;for(;Ce--;){if(wt===ke||ke!==null&&wt===ke.alternate)break t;wt=wr(wt),ke=wr(ke)}wt=null}else wt=null;Re!==null&&lr(Ye,Le,Re,wt,!1),Nt!==null&&En!==null&&lr(Ye,En,Nt,wt,!0)}}e:{if(Le=Ie?qa(Ie):window,Re=Le.nodeName&&Le.nodeName.toLowerCase(),Re==="select"||Re==="input"&&Le.type==="file")var ht=sf;else if(ic(Le))if(ac)ht=dp;else{ht=Ja;var Yt=Su}else Re=Le.nodeName,!Re||Re.toLowerCase()!=="input"||Le.type!=="checkbox"&&Le.type!=="radio"?Ie&&Xo(Ie.elementType)&&(ht=sf):ht=oc;if(ht&&(ht=ht(o,Ie))){lo(Ye,ht,p,qe);break e}Yt&&Yt(o,Le,Ie),o==="focusout"&&Ie&&Le.type==="number"&&Ie.memoizedProps.value!=null&&no(Le,"number",Le.value)}switch(Yt=Ie?qa(Ie):window,o){case"focusin":(ic(Yt)||Yt.contentEditable==="true")&&(he=Yt,be=Ie,W=null);break;case"focusout":W=be=he=null;break;case"mousedown":ue=!0;break;case"contextmenu":case"mouseup":case"dragend":ue=!1,me(Ye,p,qe);break;case"selectionchange":if(cf)break;case"keydown":case"keyup":me(Ye,p,qe)}var gt;if(Vi)e:{switch(o){case"compositionstart":var Ct="onCompositionStart";break e;case"compositionend":Ct="onCompositionEnd";break e;case"compositionupdate":Ct="onCompositionUpdate";break e}Ct=void 0}else wa?rc(o,p)&&(Ct="onCompositionEnd"):o==="keydown"&&p.keyCode===229&&(Ct="onCompositionStart");Ct&&(il&&p.locale!=="ko"&&(wa||Ct!=="onCompositionStart"?Ct==="onCompositionEnd"&&wa&&(gt=nf()):(Ui=qe,Jl="value"in Ui?Ui.value:Ui.textContent,wa=!0)),Yt=nh(Ie,Ct),0<Yt.length&&(Ct=new fr(Ct,o,null,p,qe),Ye.push({event:Ct,listeners:Yt}),gt?Ct.data=gt:(gt=sl(p),gt!==null&&(Ct.data=gt)))),(gt=bu?cp(o,p):vu(o,p))&&(Ct=nh(Ie,"onBeforeInput"),0<Ct.length&&(Yt=new fr("onBeforeInput","beforeinput",null,p,qe),Ye.push({event:Yt,listeners:Ct}),Yt.data=gt)),T0(Ye,o,Ie,p,qe)}Ky(Ye,c)})}function Pt(o,c,p){return{instance:o,listener:c,currentTarget:p}}function nh(o,c){for(var p=c+"Capture",x=[];o!==null;){var N=o,P=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||P===null||(N=el(o,p),N!=null&&x.unshift(Pt(o,N,P)),N=el(o,c),N!=null&&x.push(Pt(o,N,P))),o.tag===3)return x;o=o.return}return[]}function wr(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function lr(o,c,p,x,N){for(var P=c._reactName,H=[];p!==null&&p!==x;){var Z=p,ye=Z.alternate,Ie=Z.stateNode;if(Z=Z.tag,ye!==null&&ye===x)break;Z!==5&&Z!==26&&Z!==27||Ie===null||(ye=Ie,N?(Ie=el(p,P),Ie!=null&&H.unshift(Pt(p,Ie,ye))):N||(Ie=el(p,P),Ie!=null&&H.push(Pt(p,Ie,ye)))),p=p.return}H.length!==0&&o.push({event:c,listeners:H})}var I0=/\r\n?/g,Po=/\u0000|\uFFFD/g;function Zy(o){return(typeof o=="string"?o:""+o).replace(I0,`
`).replace(Po,"")}function ex(o,c){return c=Zy(c),Zy(o)===c}function rh(){}function kn(o,c,p,x,N,P){switch(p){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||ga(o,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&ga(o,""+x);break;case"className":Zs(o,"class",x);break;case"tabIndex":Zs(o,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Zs(o,p,x);break;case"style":Ko(o,x,P);break;case"data":if(c!=="object"){Zs(o,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||p!=="href")){o.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){o.removeAttribute(p);break}x=ys(""+x),o.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){o.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(p==="formAction"?(c!=="input"&&kn(o,c,"name",N.name,N,null),kn(o,c,"formEncType",N.formEncType,N,null),kn(o,c,"formMethod",N.formMethod,N,null),kn(o,c,"formTarget",N.formTarget,N,null)):(kn(o,c,"encType",N.encType,N,null),kn(o,c,"method",N.method,N,null),kn(o,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){o.removeAttribute(p);break}x=ys(""+x),o.setAttribute(p,x);break;case"onClick":x!=null&&(o.onclick=rh);break;case"onScroll":x!=null&&Jt("scroll",o);break;case"onScrollEnd":x!=null&&Jt("scrollend",o);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));o.innerHTML=p}}break;case"multiple":o.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":o.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){o.removeAttribute("xlink:href");break}p=ys(""+x),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?o.setAttribute(p,""+x):o.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?o.setAttribute(p,""):o.removeAttribute(p);break;case"capture":case"download":x===!0?o.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?o.setAttribute(p,x):o.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?o.setAttribute(p,x):o.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?o.removeAttribute(p):o.setAttribute(p,x);break;case"popover":Jt("beforetoggle",o),Jt("toggle",o),Yo(o,"popover",x);break;case"xlinkActuate":ci(o,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":ci(o,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":ci(o,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":ci(o,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":ci(o,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":ci(o,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":ci(o,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":ci(o,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":ci(o,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Yo(o,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Yl.get(p)||p,Yo(o,p,x))}}function bm(o,c,p,x,N,P){switch(p){case"style":Ko(o,x,P);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));o.innerHTML=p}}break;case"children":typeof x=="string"?ga(o,x):(typeof x=="number"||typeof x=="bigint")&&ga(o,""+x);break;case"onScroll":x!=null&&Jt("scroll",o);break;case"onScrollEnd":x!=null&&Jt("scrollend",o);break;case"onClick":x!=null&&(o.onclick=rh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ql.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(N=p.endsWith("Capture"),c=p.slice(2,N?p.length-7:void 0),P=o[zn]||null,P=P!=null?P[p]:null,typeof P=="function"&&o.removeEventListener(c,P,N),typeof x=="function")){typeof P!="function"&&P!==null&&(p in o?o[p]=null:o.hasAttribute(p)&&o.removeAttribute(p)),o.addEventListener(c,x,N);break e}p in o?o[p]=x:x===!0?o.setAttribute(p,""):Yo(o,p,x)}}}function Sr(o,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Jt("error",o),Jt("load",o);var x=!1,N=!1,P;for(P in p)if(p.hasOwnProperty(P)){var H=p[P];if(H!=null)switch(P){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:kn(o,c,P,H,p,null)}}N&&kn(o,c,"srcSet",p.srcSet,p,null),x&&kn(o,c,"src",p.src,p,null);return;case"input":Jt("invalid",o);var Z=P=H=N=null,ye=null,Ie=null;for(x in p)if(p.hasOwnProperty(x)){var qe=p[x];if(qe!=null)switch(x){case"name":N=qe;break;case"type":H=qe;break;case"checked":ye=qe;break;case"defaultChecked":Ie=qe;break;case"value":P=qe;break;case"defaultValue":Z=qe;break;case"children":case"dangerouslySetInnerHTML":if(qe!=null)throw Error(r(137,c));break;default:kn(o,c,x,qe,p,null)}}to(o,P,Z,ye,Ie,H,N,!1),ms(o);return;case"select":Jt("invalid",o),x=H=P=null;for(N in p)if(p.hasOwnProperty(N)&&(Z=p[N],Z!=null))switch(N){case"value":P=Z;break;case"defaultValue":H=Z;break;case"multiple":x=Z;default:kn(o,c,N,Z,p,null)}c=P,p=H,o.multiple=!!x,c!=null?ma(o,!!x,c,!1):p!=null&&ma(o,!!x,p,!0);return;case"textarea":Jt("invalid",o),P=N=x=null;for(H in p)if(p.hasOwnProperty(H)&&(Z=p[H],Z!=null))switch(H){case"value":x=Z;break;case"defaultValue":N=Z;break;case"children":P=Z;break;case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(91));break;default:kn(o,c,H,Z,p,null)}gs(o,x,N,P),ms(o);return;case"option":for(ye in p)if(p.hasOwnProperty(ye)&&(x=p[ye],x!=null))switch(ye){case"selected":o.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:kn(o,c,ye,x,p,null)}return;case"dialog":Jt("beforetoggle",o),Jt("toggle",o),Jt("cancel",o),Jt("close",o);break;case"iframe":case"object":Jt("load",o);break;case"video":case"audio":for(x=0;x<vd.length;x++)Jt(vd[x],o);break;case"image":Jt("error",o),Jt("load",o);break;case"details":Jt("toggle",o);break;case"embed":case"source":case"link":Jt("error",o),Jt("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ie in p)if(p.hasOwnProperty(Ie)&&(x=p[Ie],x!=null))switch(Ie){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:kn(o,c,Ie,x,p,null)}return;default:if(Xo(c)){for(qe in p)p.hasOwnProperty(qe)&&(x=p[qe],x!==void 0&&bm(o,c,qe,x,p,void 0));return}}for(Z in p)p.hasOwnProperty(Z)&&(x=p[Z],x!=null&&kn(o,c,Z,x,p,null))}function M0(o,c,p,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,P=null,H=null,Z=null,ye=null,Ie=null,qe=null;for(Re in p){var Ye=p[Re];if(p.hasOwnProperty(Re)&&Ye!=null)switch(Re){case"checked":break;case"value":break;case"defaultValue":ye=Ye;default:x.hasOwnProperty(Re)||kn(o,c,Re,null,x,Ye)}}for(var Le in x){var Re=x[Le];if(Ye=p[Le],x.hasOwnProperty(Le)&&(Re!=null||Ye!=null))switch(Le){case"type":P=Re;break;case"name":N=Re;break;case"checked":Ie=Re;break;case"defaultChecked":qe=Re;break;case"value":H=Re;break;case"defaultValue":Z=Re;break;case"children":case"dangerouslySetInnerHTML":if(Re!=null)throw Error(r(137,c));break;default:Re!==Ye&&kn(o,c,Le,Re,x,Ye)}}Qo(o,H,Z,ye,Ie,qe,P,N);return;case"select":Re=H=Z=Le=null;for(P in p)if(ye=p[P],p.hasOwnProperty(P)&&ye!=null)switch(P){case"value":break;case"multiple":Re=ye;default:x.hasOwnProperty(P)||kn(o,c,P,null,x,ye)}for(N in x)if(P=x[N],ye=p[N],x.hasOwnProperty(N)&&(P!=null||ye!=null))switch(N){case"value":Le=P;break;case"defaultValue":Z=P;break;case"multiple":H=P;default:P!==ye&&kn(o,c,N,P,x,ye)}c=Z,p=H,x=Re,Le!=null?ma(o,!!p,Le,!1):!!x!=!!p&&(c!=null?ma(o,!!p,c,!0):ma(o,!!p,p?[]:"",!1));return;case"textarea":Re=Le=null;for(Z in p)if(N=p[Z],p.hasOwnProperty(Z)&&N!=null&&!x.hasOwnProperty(Z))switch(Z){case"value":break;case"children":break;default:kn(o,c,Z,null,x,N)}for(H in x)if(N=x[H],P=p[H],x.hasOwnProperty(H)&&(N!=null||P!=null))switch(H){case"value":Le=N;break;case"defaultValue":Re=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==P&&kn(o,c,H,N,x,P)}ro(o,Le,Re);return;case"option":for(var Nt in p)if(Le=p[Nt],p.hasOwnProperty(Nt)&&Le!=null&&!x.hasOwnProperty(Nt))switch(Nt){case"selected":o.selected=!1;break;default:kn(o,c,Nt,null,x,Le)}for(ye in x)if(Le=x[ye],Re=p[ye],x.hasOwnProperty(ye)&&Le!==Re&&(Le!=null||Re!=null))switch(ye){case"selected":o.selected=Le&&typeof Le!="function"&&typeof Le!="symbol";break;default:kn(o,c,ye,Le,x,Re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wt in p)Le=p[wt],p.hasOwnProperty(wt)&&Le!=null&&!x.hasOwnProperty(wt)&&kn(o,c,wt,null,x,Le);for(Ie in x)if(Le=x[Ie],Re=p[Ie],x.hasOwnProperty(Ie)&&Le!==Re&&(Le!=null||Re!=null))switch(Ie){case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(r(137,c));break;default:kn(o,c,Ie,Le,x,Re)}return;default:if(Xo(c)){for(var En in p)Le=p[En],p.hasOwnProperty(En)&&Le!==void 0&&!x.hasOwnProperty(En)&&bm(o,c,En,void 0,x,Le);for(qe in x)Le=x[qe],Re=p[qe],!x.hasOwnProperty(qe)||Le===Re||Le===void 0&&Re===void 0||bm(o,c,qe,Le,x,Re);return}}for(var ke in p)Le=p[ke],p.hasOwnProperty(ke)&&Le!=null&&!x.hasOwnProperty(ke)&&kn(o,c,ke,null,x,Le);for(Ye in x)Le=x[Ye],Re=p[Ye],!x.hasOwnProperty(Ye)||Le===Re||Le==null&&Re==null||kn(o,c,Ye,Le,x,Re)}var Aa=null,ih=null;function Tl(o){return o.nodeType===9?o:o.ownerDocument}function Wn(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tr(o,c){if(o===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&c==="foreignObject"?0:o}function ah(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var vm=null;function R0(){var o=window.event;return o&&o.type==="popstate"?o===vm?!1:(vm=o,!0):(vm=null,!1)}var tx=typeof setTimeout=="function"?setTimeout:void 0,O0=typeof clearTimeout=="function"?clearTimeout:void 0,nx=typeof Promise=="function"?Promise:void 0,L0=typeof queueMicrotask=="function"?queueMicrotask:typeof nx<"u"?function(o){return nx.resolve(null).then(o).catch(rx)}:tx;function rx(o){setTimeout(function(){throw o})}function na(o){return o==="head"}function sh(o,c){var p=c,x=0,N=0;do{var P=p.nextSibling;if(o.removeChild(p),P&&P.nodeType===8)if(p=P.data,p==="/$"){if(0<x&&8>x){p=x;var H=o.ownerDocument;if(p&1&&wd(H.documentElement),p&2&&wd(H.body),p&4)for(p=H.head,wd(p),H=p.firstChild;H;){var Z=H.nextSibling,ye=H.nodeName;H[hs]||ye==="SCRIPT"||ye==="STYLE"||ye==="LINK"&&H.rel.toLowerCase()==="stylesheet"||p.removeChild(H),H=Z}}if(N===0){o.removeChild(P),Td(c);return}N--}else p==="$"||p==="$?"||p==="$!"?N++:x=p.charCodeAt(0)-48;else x=0;p=P}while(p);Td(c)}function wm(o){var c=o.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":wm(p),ou(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}o.removeChild(p)}}function ix(o,c,p,x){for(;o.nodeType===1;){var N=p;if(o.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(x){if(!o[hs])switch(c){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(P=o.getAttribute("rel"),P==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(P!==N.rel||o.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||o.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||o.getAttribute("title")!==(N.title==null?null:N.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(P=o.getAttribute("src"),(P!==(N.src==null?null:N.src)||o.getAttribute("type")!==(N.type==null?null:N.type)||o.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&P&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(c==="input"&&o.type==="hidden"){var P=N.name==null?null:""+N.name;if(N.type==="hidden"&&o.getAttribute("name")===P)return o}else return o;if(o=Pa(o.nextSibling),o===null)break}return null}function oh(o,c,p){if(c==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!p||(o=Pa(o.nextSibling),o===null))return null;return o}function ai(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function Oc(o,c){var p=o.ownerDocument;if(o.data!=="$?"||p.readyState==="complete")c();else{var x=function(){c(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),o._reactRetry=x}}function Pa(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return o}var Sm=null;function ax(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var p=o.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return o;c--}else p==="/$"&&c++}o=o.previousSibling}return null}function sx(o,c,p){switch(c=Tl(p),o){case"html":if(o=c.documentElement,!o)throw Error(r(452));return o;case"head":if(o=c.head,!o)throw Error(r(453));return o;case"body":if(o=c.body,!o)throw Error(r(454));return o;default:throw Error(r(451))}}function wd(o){for(var c=o.attributes;c.length;)o.removeAttributeNode(c[0]);ou(o)}var Fi=new Map,as=new Set;function Ot(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var ss=V.d;V.d={f:ra,r:ox,D:F0,C:lx,L:lh,m:$0,X:B0,S:z0,M:U0};function ra(){var o=ss.f(),c=Qf();return o||c}function ox(o){var c=Js(o);c!==null&&c.tag===5&&c.type==="form"?Df(c):ss.r(o)}var Lc=typeof document>"u"?null:document;function mn(o,c,p){var x=Lc;if(x&&typeof c=="string"&&c){var N=Mr(c);N='link[rel="'+o+'"][href="'+N+'"]',typeof p=="string"&&(N+='[crossorigin="'+p+'"]'),as.has(N)||(as.add(N),o={rel:o,crossOrigin:p,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),Sr(c,"link",o),dr(c),x.head.appendChild(c)))}}function F0(o){ss.D(o),mn("dns-prefetch",o,null)}function lx(o,c){ss.C(o,c),mn("preconnect",o,c)}function lh(o,c,p){ss.L(o,c,p);var x=Lc;if(x&&o&&c){var N='link[rel="preload"][as="'+Mr(c)+'"]';c==="image"&&p&&p.imageSrcSet?(N+='[imagesrcset="'+Mr(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(N+='[imagesizes="'+Mr(p.imageSizes)+'"]')):N+='[href="'+Mr(o)+'"]';var P=N;switch(c){case"style":P=Fc(o);break;case"script":P=$c(o)}Fi.has(P)||(o=h({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:o,as:c},p),Fi.set(P,o),x.querySelector(N)!==null||c==="style"&&x.querySelector(Sd(P))||c==="script"&&x.querySelector(Nd(P))||(c=x.createElement("link"),Sr(c,"link",o),dr(c),x.head.appendChild(c)))}}function $0(o,c){ss.m(o,c);var p=Lc;if(p&&o){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+Mr(x)+'"][href="'+Mr(o)+'"]',P=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=$c(o)}if(!Fi.has(P)&&(o=h({rel:"modulepreload",href:o},c),Fi.set(P,o),p.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Nd(P)))return}x=p.createElement("link"),Sr(x,"link",o),dr(x),p.head.appendChild(x)}}}function z0(o,c,p){ss.S(o,c,p);var x=Lc;if(x&&o){var N=Ks(x).hoistableStyles,P=Fc(o);c=c||"default";var H=N.get(P);if(!H){var Z={loading:0,preload:null};if(H=x.querySelector(Sd(P)))Z.loading=5;else{o=h({rel:"stylesheet",href:o,"data-precedence":c},p),(p=Fi.get(P))&&Cd(o,p);var ye=H=x.createElement("link");dr(ye),Sr(ye,"link",o),ye._p=new Promise(function(Ie,qe){ye.onload=Ie,ye.onerror=qe}),ye.addEventListener("load",function(){Z.loading|=1}),ye.addEventListener("error",function(){Z.loading|=2}),Z.loading|=4,ch(H,c,x)}H={type:"stylesheet",instance:H,count:1,state:Z},N.set(P,H)}}}function B0(o,c){ss.X(o,c);var p=Lc;if(p&&o){var x=Ks(p).hoistableScripts,N=$c(o),P=x.get(N);P||(P=p.querySelector(Nd(N)),P||(o=h({src:o,async:!0},c),(c=Fi.get(N))&&Nm(o,c),P=p.createElement("script"),dr(P),Sr(P,"link",o),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(N,P))}}function U0(o,c){ss.M(o,c);var p=Lc;if(p&&o){var x=Ks(p).hoistableScripts,N=$c(o),P=x.get(N);P||(P=p.querySelector(Nd(N)),P||(o=h({src:o,async:!0,type:"module"},c),(c=Fi.get(N))&&Nm(o,c),P=p.createElement("script"),dr(P),Sr(P,"link",o),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(N,P))}}function cx(o,c,p,x){var N=(N=fe.current)?Ot(N):null;if(!N)throw Error(r(446));switch(o){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=Fc(p.href),p=Ks(N).hoistableStyles,x=p.get(c),x||(x={type:"style",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){o=Fc(p.href);var P=Ks(N).hoistableStyles,H=P.get(o);if(H||(N=N.ownerDocument||N,H={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(o,H),(P=N.querySelector(Sd(o)))&&!P._p&&(H.instance=P,H.state.loading=5),Fi.has(o)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Fi.set(o,p),P||q0(N,o,p,H.state))),c&&x===null)throw Error(r(528,""));return H}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=$c(p),p=Ks(N).hoistableScripts,x=p.get(c),x||(x={type:"script",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,o))}}function Fc(o){return'href="'+Mr(o)+'"'}function Sd(o){return'link[rel="stylesheet"]['+o+"]"}function ux(o){return h({},o,{"data-precedence":o.precedence,precedence:null})}function q0(o,c,p,x){o.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=o.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),Sr(c,"link",p),dr(c),o.head.appendChild(c))}function $c(o){return'[src="'+Mr(o)+'"]'}function Nd(o){return"script[async]"+o}function dx(o,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var x=o.querySelector('style[data-href~="'+Mr(p.href)+'"]');if(x)return c.instance=x,dr(x),x;var N=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(o.ownerDocument||o).createElement("style"),dr(x),Sr(x,"style",N),ch(x,p.precedence,o),c.instance=x;case"stylesheet":N=Fc(p.href);var P=o.querySelector(Sd(N));if(P)return c.state.loading|=4,c.instance=P,dr(P),P;x=ux(p),(N=Fi.get(N))&&Cd(x,N),P=(o.ownerDocument||o).createElement("link"),dr(P);var H=P;return H._p=new Promise(function(Z,ye){H.onload=Z,H.onerror=ye}),Sr(P,"link",x),c.state.loading|=4,ch(P,p.precedence,o),c.instance=P;case"script":return P=$c(p.src),(N=o.querySelector(Nd(P)))?(c.instance=N,dr(N),N):(x=p,(N=Fi.get(P))&&(x=h({},p),Nm(x,N)),o=o.ownerDocument||o,N=o.createElement("script"),dr(N),Sr(N,"link",x),o.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,ch(x,p.precedence,o));return c.instance}function ch(o,c,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,P=N,H=0;H<x.length;H++){var Z=x[H];if(Z.dataset.precedence===c)P=Z;else if(P!==N)break}P?P.parentNode.insertBefore(o,P.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(o,c.firstChild))}function Cd(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.title==null&&(o.title=c.title)}function Nm(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.integrity==null&&(o.integrity=c.integrity)}var zc=null;function fx(o,c,p){if(zc===null){var x=new Map,N=zc=new Map;N.set(p,x)}else N=zc,x=N.get(p),x||(x=new Map,N.set(p,x));if(x.has(o))return x;for(x.set(o,null),p=p.getElementsByTagName(o),N=0;N<p.length;N++){var P=p[N];if(!(P[hs]||P[Zn]||o==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var H=P.getAttribute(c)||"";H=o+H;var Z=x.get(H);Z?Z.push(P):x.set(H,[P])}}return x}function hx(o,c,p){o=o.ownerDocument||o,o.head.insertBefore(p,c==="title"?o.querySelector("head > title"):null)}function V0(o,c,p){if(p===1||c.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return o=c.disabled,typeof c.precedence=="string"&&o==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Nr(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var Tr=null;function H0(){}function G0(o,c,p){if(Tr===null)throw Error(r(475));var x=Tr;if(c.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=Fc(p.href),P=o.querySelector(Sd(N));if(P){o=P._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(x.count++,x=jd.bind(x),o.then(x,x)),c.state.loading|=4,c.instance=P,dr(P);return}P=o.ownerDocument||o,p=ux(p),(N=Fi.get(N))&&Cd(p,N),P=P.createElement("link"),dr(P);var H=P;H._p=new Promise(function(Z,ye){H.onload=Z,H.onerror=ye}),Sr(P,"link",p),c.instance=P}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=jd.bind(x),o.addEventListener("load",c),o.addEventListener("error",c))}}function Y0(){if(Tr===null)throw Error(r(475));var o=Tr;return o.stylesheets&&o.count===0&&Cm(o,o.stylesheets),0<o.count?function(c){var p=setTimeout(function(){if(o.stylesheets&&Cm(o,o.stylesheets),o.unsuspend){var x=o.unsuspend;o.unsuspend=null,x()}},6e4);return o.unsuspend=c,function(){o.unsuspend=null,clearTimeout(p)}}:null}function jd(){if(this.count--,this.count===0){if(this.stylesheets)Cm(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var uh=null;function Cm(o,c){o.stylesheets=null,o.unsuspend!==null&&(o.count++,uh=new Map,c.forEach(W0,o),uh=null,jd.call(o))}function W0(o,c){if(!(c.state.loading&4)){var p=uh.get(o);if(p)var x=p.get(null);else{p=new Map,uh.set(o,p);for(var N=o.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<N.length;P++){var H=N[P];(H.nodeName==="LINK"||H.getAttribute("media")!=="not all")&&(p.set(H.dataset.precedence,H),x=H)}x&&p.set(null,x)}N=c.instance,H=N.getAttribute("data-precedence"),P=p.get(H)||x,P===x&&p.set(null,N),p.set(H,N),this.count++,x=jd.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),P?P.parentNode.insertBefore(N,P.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(N,o.firstChild)),c.state.loading|=4}}var Bc={$$typeof:D,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function Q0(o,c,p,x,N,P,H,Z){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$n(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$n(0),this.hiddenUpdates=$n(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=P,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function px(o,c,p,x,N,P,H,Z,ye,Ie,qe,Ye){return o=new Q0(o,c,p,H,Z,ye,Ie,Ye),c=1,P===!0&&(c|=24),P=fi(3,null,null,c),o.current=P,P.stateNode=o,c=xp(),c.refCount++,o.pooledCache=c,c.refCount++,P.memoizedState={element:x,isDehydrated:p,cache:c},gl(P),o}function mx(o){return o?(o=cl,o):cl}function jm(o,c,p,x,N,P){N=mx(N),x.context===null?x.context=N:x.pendingContext=N,x=go(c),x.payload={element:p},P=P===void 0?null:P,P!==null&&(x.callback=P),p=_s(o,x,c),p!==null&&(Li(p,o,c),Fu(p,o,c))}function _m(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var p=o.retryLane;o.retryLane=p!==0&&p<c?p:c}}function km(o,c){_m(o,c),(o=o.alternate)&&_m(o,c)}function gx(o){if(o.tag===13){var c=ll(o,67108864);c!==null&&Li(c,o,67108864),km(o,67108864)}}var dh=!0;function J0(o,c,p,x){var N=K.T;K.T=null;var P=V.p;try{V.p=2,Em(o,c,p,x)}finally{V.p=P,K.T=N}}function Uc(o,c,p,x){var N=K.T;K.T=null;var P=V.p;try{V.p=8,Em(o,c,p,x)}finally{V.p=P,K.T=N}}function Em(o,c,p,x){if(dh){var N=Tm(x);if(N===null)Ls(o,c,x,fh,p),xx(o,x);else if(X0(N,o,c,p,x))x.stopPropagation();else if(xx(o,x),c&4&&-1<K0.indexOf(o)){for(;N!==null;){var P=Js(N);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var H=Xe(P.pendingLanes);if(H!==0){var Z=P;for(Z.pendingLanes|=2,Z.entangledLanes|=2;H;){var ye=1<<31-Ae(H);Z.entanglements[1]|=ye,H&=~ye}is(P),(wn&6)===0&&(Ac=Ee()+500,yd(0))}}break;case 13:Z=ll(P,2),Z!==null&&Li(Z,P,2),Qf(),km(P,2)}if(P=Tm(x),P===null&&Ls(o,c,x,fh,p),P===N)break;N=P}N!==null&&x.stopPropagation()}else Ls(o,c,x,null,p)}}function Tm(o){return o=Zo(o),Am(o)}var fh=null;function Am(o){if(fh=null,o=Qs(o),o!==null){var c=s(o);if(c===null)o=null;else{var p=c.tag;if(p===13){if(o=l(c),o!==null)return o;o=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null)}}return fh=o,null}function yx(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pe()){case rt:return 2;case lt:return 8;case Ze:case Rt:return 32;case kt:return 268435456;default:return 32}default:return 32}}var hh=!1,Fs=null,Do=null,Io=null,_d=new Map,kd=new Map,Mo=[],K0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xx(o,c){switch(o){case"focusin":case"focusout":Fs=null;break;case"dragenter":case"dragleave":Do=null;break;case"mouseover":case"mouseout":Io=null;break;case"pointerover":case"pointerout":_d.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":kd.delete(c.pointerId)}}function Ed(o,c,p,x,N,P){return o===null||o.nativeEvent!==P?(o={blockedOn:c,domEventName:p,eventSystemFlags:x,nativeEvent:P,targetContainers:[N]},c!==null&&(c=Js(c),c!==null&&gx(c)),o):(o.eventSystemFlags|=x,c=o.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),o)}function X0(o,c,p,x,N){switch(c){case"focusin":return Fs=Ed(Fs,o,c,p,x,N),!0;case"dragenter":return Do=Ed(Do,o,c,p,x,N),!0;case"mouseover":return Io=Ed(Io,o,c,p,x,N),!0;case"pointerover":var P=N.pointerId;return _d.set(P,Ed(_d.get(P)||null,o,c,p,x,N)),!0;case"gotpointercapture":return P=N.pointerId,kd.set(P,Ed(kd.get(P)||null,o,c,p,x,N)),!0}return!1}function bx(o){var c=Qs(o.target);if(c!==null){var p=s(c);if(p!==null){if(c=p.tag,c===13){if(c=l(p),c!==null){o.blockedOn=c,Pi(o.priority,function(){if(p.tag===13){var x=Yr();x=Wr(x);var N=ll(p,x);N!==null&&Li(N,p,x),km(p,x)}});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){o.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}o.blockedOn=null}function ph(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var p=Tm(o.nativeEvent);if(p===null){p=o.nativeEvent;var x=new p.constructor(p.type,p);io=x,p.target.dispatchEvent(x),io=null}else return c=Js(p),c!==null&&gx(c),o.blockedOn=p,!1;c.shift()}return!0}function vx(o,c,p){ph(o)&&p.delete(c)}function Z0(){hh=!1,Fs!==null&&ph(Fs)&&(Fs=null),Do!==null&&ph(Do)&&(Do=null),Io!==null&&ph(Io)&&(Io=null),_d.forEach(vx),kd.forEach(vx)}function mh(o,c){o.blockedOn===c&&(o.blockedOn=null,hh||(hh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Z0)))}var gh=null;function wx(o){gh!==o&&(gh=o,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){gh===o&&(gh=null);for(var c=0;c<o.length;c+=3){var p=o[c],x=o[c+1],N=o[c+2];if(typeof x!="function"){if(Am(x||p)===null)continue;break}var P=Js(p);P!==null&&(o.splice(c,3),c-=3,Qu(P,{pending:!0,data:N,method:p.method,action:x},x,N))}}))}function Td(o){function c(ye){return mh(ye,o)}Fs!==null&&mh(Fs,o),Do!==null&&mh(Do,o),Io!==null&&mh(Io,o),_d.forEach(c),kd.forEach(c);for(var p=0;p<Mo.length;p++){var x=Mo[p];x.blockedOn===o&&(x.blockedOn=null)}for(;0<Mo.length&&(p=Mo[0],p.blockedOn===null);)bx(p),p.blockedOn===null&&Mo.shift();if(p=(o.ownerDocument||o).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var N=p[x],P=p[x+1],H=N[zn]||null;if(typeof P=="function")H||wx(p);else if(H){var Z=null;if(P&&P.hasAttribute("formAction")){if(N=P,H=P[zn]||null)Z=H.formAction;else if(Am(N)!==null)continue}else Z=H.action;typeof Z=="function"?p[x+1]=Z:(p.splice(x,3),x-=3),wx(p)}}}function Pm(o){this._internalRoot=o}yh.prototype.render=Pm.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,x=Yr();jm(p,x,o,c,null,null)},yh.prototype.unmount=Pm.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;jm(o.current,2,null,o,null,null),Qf(),c[Ua]=null}};function yh(o){this._internalRoot=o}yh.prototype.unstable_scheduleHydration=function(o){if(o){var c=ha();o={blockedOn:null,target:o,priority:c};for(var p=0;p<Mo.length&&c!==0&&c<Mo[p].priority;p++);Mo.splice(p,0,o),p===0&&bx(o)}};var Sx=n.version;if(Sx!=="19.1.0")throw Error(r(527,Sx,"19.1.0"));V.findDOMNode=function(o){var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=u(c),o=o!==null?d(o):null,o=o===null?null:o.stateNode,o};var ev={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xh.isDisabled&&xh.supportsFiber)try{Q=xh.inject(ev),re=xh}catch{}}return Im.createRoot=function(o,c){if(!a(o))throw Error(r(299));var p=!1,x="",N=Vp,P=Rf,H=oy,Z=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(P=c.onCaughtError),c.onRecoverableError!==void 0&&(H=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(Z=c.unstable_transitionCallbacks)),c=px(o,1,!1,null,null,p,x,N,P,H,Z,null),o[Ua]=c.current,xm(o),new Pm(c)},Im.hydrateRoot=function(o,c,p){if(!a(o))throw Error(r(299));var x=!1,N="",P=Vp,H=Rf,Z=oy,ye=null,Ie=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onUncaughtError!==void 0&&(P=p.onUncaughtError),p.onCaughtError!==void 0&&(H=p.onCaughtError),p.onRecoverableError!==void 0&&(Z=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(ye=p.unstable_transitionCallbacks),p.formState!==void 0&&(Ie=p.formState)),c=px(o,1,!0,c,p??null,x,N,P,H,Z,ye,Ie),c.context=mx(null),p=c.current,x=Yr(),x=Wr(x),N=go(x),N.callback=null,_s(p,N,x),p=x,c.current.lanes=p,_n(c,p),is(c),o[Ua]=c.current,xm(o),new yh(c)},Im.version="19.1.0",Im}var qS;function zP(){if(qS)return sv.exports;qS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),sv.exports=$P(),sv.exports}var BP=zP(),Mm={},VS;function UP(){if(VS)return Mm;VS=1,Object.defineProperty(Mm,"__esModule",{value:!0}),Mm.parse=l,Mm.serialize=d;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,s=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new s,k=b.length;if(k<2)return S;const E=(v==null?void 0:v.decode)||h;let T=0;do{const I=b.indexOf("=",T);if(I===-1)break;const D=b.indexOf(";",T),q=D===-1?k:D;if(I>q){T=b.lastIndexOf(";",I-1)+1;continue}const F=f(b,T,I),$=u(b,I,F),B=b.slice(F,$);if(S[B]===void 0){let z=f(b,I+1,q),U=u(b,q,z);const L=E(b.slice(z,U));S[B]=L}T=q+1}while(T<k);return S}function f(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function u(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function d(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const E=k(v);if(!n.test(E))throw new TypeError(`argument val is invalid: ${v}`);let T=b+"="+E;if(!S)return T;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);T+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);T+="; Domain="+S.domain}if(S.path){if(!r.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);T+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);T+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(T+="; HttpOnly"),S.secure&&(T+="; Secure"),S.partitioned&&(T+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":T+="; Priority=Low";break;case"medium":T+="; Priority=Medium";break;case"high":T+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":T+="; SameSite=Strict";break;case"lax":T+="; SameSite=Lax";break;case"none":T+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return T}function h(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Mm}UP();var HS="popstate";function qP(e={}){function n(r,a){let{pathname:s,search:l,hash:f}=r.location;return h1("",{pathname:s,search:l,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:sg(a)}return HP(n,t,null,e)}function cr(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function qs(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function VP(){return Math.random().toString(36).substring(2,10)}function GS(e,n){return{usr:e.state,key:e.key,idx:n}}function h1(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Hh(n):n,state:t,key:n&&n.key||r||VP()}}function sg({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Hh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function HP(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:s=!1}=r,l=a.history,f="POP",u=null,d=h();d==null&&(d=0,l.replaceState({...l.state,idx:d},""));function h(){return(l.state||{idx:null}).idx}function g(){f="POP";let E=h(),T=E==null?null:E-d;d=E,u&&u({action:f,location:k.location,delta:T})}function b(E,T){f="PUSH";let I=h1(k.location,E,T);d=h()+1;let D=GS(I,d),q=k.createHref(I);try{l.pushState(D,"",q)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(q)}s&&u&&u({action:f,location:k.location,delta:1})}function v(E,T){f="REPLACE";let I=h1(k.location,E,T);d=h();let D=GS(I,d),q=k.createHref(I);l.replaceState(D,"",q),s&&u&&u({action:f,location:k.location,delta:0})}function S(E){return GP(E)}let k={get action(){return f},get location(){return e(a,l)},listen(E){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(HS,g),u=E,()=>{a.removeEventListener(HS,g),u=null}},createHref(E){return n(a,E)},createURL:S,encodeLocation(E){let T=S(E);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:b,replace:v,go(E){return l.go(E)}};return k}function GP(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),cr(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:sg(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function s2(e,n,t="/"){return YP(e,n,t,!1)}function YP(e,n,t,r){let a=typeof n=="string"?Hh(n):n,s=Ol(a.pathname||"/",t);if(s==null)return null;let l=o2(e);WP(l);let f=null;for(let u=0;f==null&&u<l.length;++u){let d=aD(s);f=rD(l[u],d,r)}return f}function o2(e,n=[],t=[],r=""){let a=(s,l,f)=>{let u={relativePath:f===void 0?s.path||"":f,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};u.relativePath.startsWith("/")&&(cr(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length));let d=Ml([r,u.relativePath]),h=t.concat(u);s.children&&s.children.length>0&&(cr(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),o2(s.children,n,h,d)),!(s.path==null&&!s.index)&&n.push({path:d,score:tD(d,s.index),routesMeta:h})};return e.forEach((s,l)=>{var f;if(s.path===""||!((f=s.path)!=null&&f.includes("?")))a(s,l);else for(let u of l2(s.path))a(s,l,u)}),n}function l2(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return a?[s,""]:[s];let l=l2(r.join("/")),f=[];return f.push(...l.map(u=>u===""?s:[s,u].join("/"))),a&&f.push(...l),f.map(u=>e.startsWith("/")&&u===""?"/":u)}function WP(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:nD(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var QP=/^:[\w-]+$/,JP=3,KP=2,XP=1,ZP=10,eD=-2,YS=e=>e==="*";function tD(e,n){let t=e.split("/"),r=t.length;return t.some(YS)&&(r+=eD),n&&(r+=KP),t.filter(a=>!YS(a)).reduce((a,s)=>a+(QP.test(s)?JP:s===""?XP:ZP),r)}function nD(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function rD(e,n,t=!1){let{routesMeta:r}=e,a={},s="/",l=[];for(let f=0;f<r.length;++f){let u=r[f],d=f===r.length-1,h=s==="/"?n:n.slice(s.length)||"/",g=lb({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),b=u.route;if(!g&&d&&t&&!r[r.length-1].route.index&&(g=lb({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:Ml([s,g.pathname]),pathnameBase:cD(Ml([s,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(s=Ml([s,g.pathnameBase]))}return l}function lb(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=iD(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let s=a[0],l=s.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:g},b)=>{if(h==="*"){let S=f[b]||"";l=s.slice(0,s.length-S.length).replace(/(.)\/+$/,"$1")}const v=f[b];return g&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:l,pattern:e}}function iD(e,n=!1,t=!0){qs(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,f,u)=>(r.push({paramName:f,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function aD(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return qs(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Ol(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function sD(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Hh(e):e;return{pathname:t?t.startsWith("/")?t:oD(t,n):n,search:uD(r),hash:dD(a)}}function oD(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function uv(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function lD(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function Nw(e){let n=lD(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function Cw(e,n,t,r=!1){let a;typeof e=="string"?a=Hh(e):(a={...e},cr(!a.pathname||!a.pathname.includes("?"),uv("?","pathname","search",a)),cr(!a.pathname||!a.pathname.includes("#"),uv("#","pathname","hash",a)),cr(!a.search||!a.search.includes("#"),uv("#","search","hash",a)));let s=e===""||a.pathname==="",l=s?"/":a.pathname,f;if(l==null)f=t;else{let g=n.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}f=g>=0?n[g]:"/"}let u=sD(a,f),d=l&&l!=="/"&&l.endsWith("/"),h=(s||l===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Ml=e=>e.join("/").replace(/\/\/+/g,"/"),cD=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),uD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,dD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function fD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var c2=["POST","PUT","PATCH","DELETE"];new Set(c2);var hD=["GET",...c2];new Set(hD);var Gh=w.createContext(null);Gh.displayName="DataRouter";var $b=w.createContext(null);$b.displayName="DataRouterState";var u2=w.createContext({isTransitioning:!1});u2.displayName="ViewTransition";var pD=w.createContext(new Map);pD.displayName="Fetchers";var mD=w.createContext(null);mD.displayName="Await";var Gs=w.createContext(null);Gs.displayName="Navigation";var yg=w.createContext(null);yg.displayName="Location";var Ys=w.createContext({outlet:null,matches:[],isDataRoute:!1});Ys.displayName="Route";var jw=w.createContext(null);jw.displayName="RouteError";function gD(e,{relative:n}={}){cr(Yh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(Gs),{hash:a,pathname:s,search:l}=xg(e,{relative:n}),f=s;return t!=="/"&&(f=s==="/"?t:Ml([t,s])),r.createHref({pathname:f,search:l,hash:a})}function Yh(){return w.useContext(yg)!=null}function oi(){return cr(Yh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(yg).location}var d2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function f2(e){w.useContext(Gs).static||w.useLayoutEffect(e)}function yt(){let{isDataRoute:e}=w.useContext(Ys);return e?TD():yD()}function yD(){cr(Yh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(Gh),{basename:n,navigator:t}=w.useContext(Gs),{matches:r}=w.useContext(Ys),{pathname:a}=oi(),s=JSON.stringify(Nw(r)),l=w.useRef(!1);return f2(()=>{l.current=!0}),w.useCallback((u,d={})=>{if(qs(l.current,d2),!l.current)return;if(typeof u=="number"){t.go(u);return}let h=Cw(u,JSON.parse(s),a,d.relative==="path");e==null&&n!=="/"&&(h.pathname=h.pathname==="/"?n:Ml([n,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[n,t,s,a,e])}w.createContext(null);function Ti(){let{matches:e}=w.useContext(Ys),n=e[e.length-1];return n?n.params:{}}function xg(e,{relative:n}={}){let{matches:t}=w.useContext(Ys),{pathname:r}=oi(),a=JSON.stringify(Nw(t));return w.useMemo(()=>Cw(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function xD(e,n){return h2(e,n)}function h2(e,n,t,r){var I;cr(Yh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:s}=w.useContext(Gs),{matches:l}=w.useContext(Ys),f=l[l.length-1],u=f?f.params:{},d=f?f.pathname:"/",h=f?f.pathnameBase:"/",g=f&&f.route;{let D=g&&g.path||"";p2(d,!g||D.endsWith("*")||D.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${D}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${D}"> to <Route path="${D==="/"?"*":`${D}/*`}">.`)}let b=oi(),v;if(n){let D=typeof n=="string"?Hh(n):n;cr(h==="/"||((I=D.pathname)==null?void 0:I.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${D.pathname}" was given in the \`location\` prop.`),v=D}else v=b;let S=v.pathname||"/",k=S;if(h!=="/"){let D=h.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(D.length).join("/")}let E=!s&&t&&t.matches&&t.matches.length>0?t.matches:s2(e,{pathname:k});qs(g||E!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),qs(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=ND(E&&E.map(D=>Object.assign({},D,{params:Object.assign({},u,D.params),pathname:Ml([h,a.encodeLocation?a.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?h:Ml([h,a.encodeLocation?a.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),l,t,r);return n&&T?w.createElement(yg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},T):T}function bD(){let e=ED(),n=fD(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:s},"ErrorBoundary")," or"," ",w.createElement("code",{style:s},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var vD=w.createElement(bD,null),wD=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(Ys.Provider,{value:this.props.routeContext},w.createElement(jw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function SD({routeContext:e,match:n,children:t}){let r=w.useContext(Gh);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Ys.Provider,{value:e},t)}function ND(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,s=t==null?void 0:t.errors;if(s!=null){let u=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);cr(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,f=-1;if(t)for(let u=0;u<a.length;u++){let d=a[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(f=u),d.route.id){let{loaderData:h,errors:g}=t,b=d.route.loader&&!h.hasOwnProperty(d.route.id)&&(!g||g[d.route.id]===void 0);if(d.route.lazy||b){l=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}return a.reduceRight((u,d,h)=>{let g,b=!1,v=null,S=null;t&&(g=s&&d.route.id?s[d.route.id]:void 0,v=d.route.errorElement||vD,l&&(f<0&&h===0?(p2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):f===h&&(b=!0,S=d.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,h+1)),E=()=>{let T;return g?T=v:b?T=S:d.route.Component?T=w.createElement(d.route.Component,null):d.route.element?T=d.route.element:T=u,w.createElement(SD,{match:d,routeContext:{outlet:u,matches:k,isDataRoute:t!=null},children:T})};return t&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?w.createElement(wD,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:E(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):E()},null)}function _w(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CD(e){let n=w.useContext(Gh);return cr(n,_w(e)),n}function jD(e){let n=w.useContext($b);return cr(n,_w(e)),n}function _D(e){let n=w.useContext(Ys);return cr(n,_w(e)),n}function kw(e){let n=_D(e),t=n.matches[n.matches.length-1];return cr(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function kD(){return kw("useRouteId")}function ED(){var r;let e=w.useContext(jw),n=jD("useRouteError"),t=kw("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function TD(){let{router:e}=CD("useNavigate"),n=kw("useNavigate"),t=w.useRef(!1);return f2(()=>{t.current=!0}),w.useCallback(async(a,s={})=>{qs(t.current,d2),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...s}))},[e,n])}var WS={};function p2(e,n,t){!n&&!WS[e]&&(WS[e]=!0,qs(!1,t))}w.memo(AD);function AD({routes:e,future:n,state:t}){return h2(e,void 0,t,n)}function gn({to:e,replace:n,state:t,relative:r}){cr(Yh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(Gs);qs(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=w.useContext(Ys),{pathname:l}=oi(),f=yt(),u=Cw(e,Nw(s),l,r==="path"),d=JSON.stringify(u);return w.useEffect(()=>{f(JSON.parse(d),{replace:n,state:t,relative:r})},[f,d,r,n,t]),null}function ut(e){cr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function PD({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:s=!1}){cr(!Yh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),f=w.useMemo(()=>({basename:l,navigator:a,static:s,future:{}}),[l,a,s]);typeof t=="string"&&(t=Hh(t));let{pathname:u="/",search:d="",hash:h="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=Ol(u,l);return S==null?null:{location:{pathname:S,search:d,hash:h,state:g,key:b},navigationType:r}},[l,u,d,h,g,b,r]);return qs(v!=null,`<Router basename="${l}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(Gs.Provider,{value:f},w.createElement(yg.Provider,{children:n,value:v}))}function kh({children:e,location:n}){return xD(p1(e),n)}function p1(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let s=[...n,a];if(r.type===w.Fragment){t.push.apply(t,p1(r.props.children,s));return}cr(r.type===ut,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),cr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=p1(r.props.children,s)),t.push(l)}),t}var Qx="get",Jx="application/x-www-form-urlencoded";function zb(e){return e!=null&&typeof e.tagName=="string"}function DD(e){return zb(e)&&e.tagName.toLowerCase()==="button"}function ID(e){return zb(e)&&e.tagName.toLowerCase()==="form"}function MD(e){return zb(e)&&e.tagName.toLowerCase()==="input"}function RD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function OD(e,n){return e.button===0&&(!n||n==="_self")&&!RD(e)}var Nx=null;function LD(){if(Nx===null)try{new FormData(document.createElement("form"),0),Nx=!1}catch{Nx=!0}return Nx}var FD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function dv(e){return e!=null&&!FD.has(e)?(qs(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jx}"`),null):e}function $D(e,n){let t,r,a,s,l;if(ID(e)){let f=e.getAttribute("action");r=f?Ol(f,n):null,t=e.getAttribute("method")||Qx,a=dv(e.getAttribute("enctype"))||Jx,s=new FormData(e)}else if(DD(e)||MD(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||f.getAttribute("action");if(r=u?Ol(u,n):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||Qx,a=dv(e.getAttribute("formenctype"))||dv(f.getAttribute("enctype"))||Jx,s=new FormData(f,e),!LD()){let{name:d,type:h,value:g}=e;if(h==="image"){let b=d?`${d}.`:"";s.append(`${b}x`,"0"),s.append(`${b}y`,"0")}else d&&s.append(d,g)}}else{if(zb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Qx,r=null,a=Jx,l=e}return s&&a==="text/plain"&&(l=s,s=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:s,body:l}}function Ew(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function zD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function BD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function UD(e,n,t){let r=await Promise.all(e.map(async a=>{let s=n.routes[a.route.id];if(s){let l=await zD(s,t);return l.links?l.links():[]}return[]}));return GD(r.flat(1).filter(BD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function QS(e,n,t,r,a,s){let l=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,f=(u,d)=>{var h;return t[d].pathname!==u.pathname||((h=t[d].route.path)==null?void 0:h.endsWith("*"))&&t[d].params["*"]!==u.params["*"]};return s==="assets"?n.filter((u,d)=>l(u,d)||f(u,d)):s==="data"?n.filter((u,d)=>{var g;let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(l(u,d)||f(u,d))return!0;if(u.route.shouldRevalidate){let b=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function qD(e,n,{includeHydrateFallback:t}={}){return VD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function VD(e){return[...new Set(e)]}function HD(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function GD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let s=JSON.stringify(HD(a));return t.has(s)||(t.add(s),r.push({key:s,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var YD=new Set([100,101,204,205]);function WD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Ol(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function m2(){let e=w.useContext(Gh);return Ew(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function QD(){let e=w.useContext($b);return Ew(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Tw=w.createContext(void 0);Tw.displayName="FrameworkContext";function g2(){let e=w.useContext(Tw);return Ew(e,"You must render this element inside a <HydratedRouter> element"),e}function JD(e,n){let t=w.useContext(Tw),[r,a]=w.useState(!1),[s,l]=w.useState(!1),{onFocus:f,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=T=>{T.forEach(I=>{l(I.isIntersecting)})},E=new IntersectionObserver(k,{threshold:.5});return b.current&&E.observe(b.current),()=>{E.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[s,b,{}]:[s,b,{onFocus:Rm(f,v),onBlur:Rm(u,S),onMouseEnter:Rm(d,v),onMouseLeave:Rm(h,S),onTouchStart:Rm(g,v)}]:[!1,b,{}]}function Rm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function KD({page:e,...n}){let{router:t}=m2(),r=w.useMemo(()=>s2(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(ZD,{page:e,matches:r,...n}):null}function XD(e){let{manifest:n,routeModules:t}=g2(),[r,a]=w.useState([]);return w.useEffect(()=>{let s=!1;return UD(e,n,t).then(l=>{s||a(l)}),()=>{s=!0}},[e,n,t]),r}function ZD({page:e,matches:n,...t}){let r=oi(),{manifest:a,routeModules:s}=g2(),{basename:l}=m2(),{loaderData:f,matches:u}=QD(),d=w.useMemo(()=>QS(e,n,u,a,r,"data"),[e,n,u,a,r]),h=w.useMemo(()=>QS(e,n,u,a,r,"assets"),[e,n,u,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let S=new Set,k=!1;if(n.forEach(T=>{var D;let I=a.routes[T.route.id];!I||!I.hasLoader||(!d.some(q=>q.route.id===T.route.id)&&T.route.id in f&&((D=s[T.route.id])!=null&&D.shouldRevalidate)||I.hasClientLoader?k=!0:S.add(T.route.id))}),S.size===0)return[];let E=WD(e,l);return k&&S.size>0&&E.searchParams.set("_routes",n.filter(T=>S.has(T.route.id)).map(T=>T.route.id).join(",")),[E.pathname+E.search]},[l,f,r,a,d,n,e,s]),b=w.useMemo(()=>qD(h,a),[h,a]),v=XD(h);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function eI(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var y2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{y2&&(window.__reactRouterVersion="7.6.0")}catch{}function tI({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=qP({window:t,v5Compat:!0}));let a=r.current,[s,l]=w.useState({action:a.action,location:a.location}),f=w.useCallback(u=>{w.startTransition(()=>l(u))},[l]);return w.useLayoutEffect(()=>a.listen(f),[a,f]),w.createElement(PD,{basename:e,children:n,location:s.location,navigationType:s.action,navigator:a})}var x2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cs=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:s,replace:l,state:f,target:u,to:d,preventScrollReset:h,viewTransition:g,...b},v){let{basename:S}=w.useContext(Gs),k=typeof d=="string"&&x2.test(d),E,T=!1;if(typeof d=="string"&&k&&(E=d,y2))try{let U=new URL(window.location.href),L=d.startsWith("//")?new URL(U.protocol+d):new URL(d),R=Ol(L.pathname,S);L.origin===U.origin&&R!=null?d=R+L.search+L.hash:T=!0}catch{qs(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let I=gD(d,{relative:a}),[D,q,F]=JD(r,b),$=aI(d,{replace:l,state:f,target:u,preventScrollReset:h,relative:a,viewTransition:g});function B(U){n&&n(U),U.defaultPrevented||$(U)}let z=w.createElement("a",{...b,...F,href:E||I,onClick:T||s?n:B,ref:eI(v,q),target:u,"data-discover":!k&&t==="render"?"true":void 0});return D&&!k?w.createElement(w.Fragment,null,z,w.createElement(KD,{page:I})):z});cs.displayName="Link";var nI=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:s,to:l,viewTransition:f,children:u,...d},h){let g=xg(l,{relative:d.relative}),b=oi(),v=w.useContext($b),{navigator:S,basename:k}=w.useContext(Gs),E=v!=null&&uI(g)&&f===!0,T=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,I=b.pathname,D=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(I=I.toLowerCase(),D=D?D.toLowerCase():null,T=T.toLowerCase()),D&&k&&(D=Ol(D,k)||D);const q=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let F=I===T||!a&&I.startsWith(T)&&I.charAt(q)==="/",$=D!=null&&(D===T||!a&&D.startsWith(T)&&D.charAt(T.length)==="/"),B={isActive:F,isPending:$,isTransitioning:E},z=F?n:void 0,U;typeof r=="function"?U=r(B):U=[r,F?"active":null,$?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let L=typeof s=="function"?s(B):s;return w.createElement(cs,{...d,"aria-current":z,className:U,ref:h,style:L,to:l,viewTransition:f},typeof u=="function"?u(B):u)});nI.displayName="NavLink";var rI=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:s,method:l=Qx,action:f,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:g,...b},v)=>{let S=lI(),k=cI(f,{relative:d}),E=l.toLowerCase()==="get"?"get":"post",T=typeof f=="string"&&x2.test(f),I=D=>{if(u&&u(D),D.defaultPrevented)return;D.preventDefault();let q=D.nativeEvent.submitter,F=(q==null?void 0:q.getAttribute("formmethod"))||l;S(q||D.currentTarget,{fetcherKey:n,method:F,navigate:t,replace:a,state:s,relative:d,preventScrollReset:h,viewTransition:g})};return w.createElement("form",{ref:v,method:E,action:k,onSubmit:r?u:I,...b,"data-discover":!T&&e==="render"?"true":void 0})});rI.displayName="Form";function iI(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function b2(e){let n=w.useContext(Gh);return cr(n,iI(e)),n}function aI(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:s,viewTransition:l}={}){let f=yt(),u=oi(),d=xg(e,{relative:s});return w.useCallback(h=>{if(OD(h,n)){h.preventDefault();let g=t!==void 0?t:sg(u)===sg(d);f(e,{replace:g,state:r,preventScrollReset:a,relative:s,viewTransition:l})}},[u,f,d,t,r,n,e,a,s,l])}var sI=0,oI=()=>`__${String(++sI)}__`;function lI(){let{router:e}=b2("useSubmit"),{basename:n}=w.useContext(Gs),t=kD();return w.useCallback(async(r,a={})=>{let{action:s,method:l,encType:f,formData:u,body:d}=$D(r,n);if(a.navigate===!1){let h=a.fetcherKey||oI();await e.fetch(h,t,a.action||s,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||l,formEncType:a.encType||f,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||l,formEncType:a.encType||f,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function cI(e,{relative:n}={}){let{basename:t}=w.useContext(Gs),r=w.useContext(Ys);cr(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),s={...xg(e||".",{relative:n})},l=oi();if(e==null){s.search=l.search;let f=new URLSearchParams(s.search),u=f.getAll("index");if(u.some(h=>h==="")){f.delete("index"),u.filter(g=>g).forEach(g=>f.append("index",g));let h=f.toString();s.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:Ml([t,s.pathname])),sg(s)}function uI(e,n={}){let t=w.useContext(u2);cr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=b2("useViewTransitionState"),a=xg(e,{relative:n.relative});if(!t.isTransitioning)return!1;let s=Ol(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=Ol(t.nextLocation.pathname,r)||t.nextLocation.pathname;return lb(a.pathname,l)!=null||lb(a.pathname,s)!=null}[...YD];var dI=a2();class fI extends w.Component{constructor(){super(...arguments);Ln(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}class hI{constructor(){Ln(this,"requestCount",0);Ln(this,"listeners",[])}subscribe(n){return this.listeners.push(n),()=>{this.listeners=this.listeners.filter(t=>t!==n)}}notify(){const n=this.requestCount>0;this.listeners.forEach(t=>t(n))}addRequest(){this.requestCount++,this.notify()}removeRequest(){this.requestCount--,this.requestCount<0&&(this.requestCount=0),this.notify()}}const zs=new hI,pI="https://backend.newtons.in",mI=()=>localStorage.getItem("authToken"),ge=async(e,n={})=>{const t=mI(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let s=e.startsWith("/")?e:`/${e}`;s.startsWith("/api/")||(s=`/api${s}`);const l=`${pI}${s}`;zs.addRequest();try{console.log(`Making API call to: ${l}`);const f=await fetch(l,{...n,headers:a});if(f.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!f.ok){let u=`HTTP error! status: ${f.status}`;try{const d=await f.json();u=(d==null?void 0:d.message)||(d==null?void 0:d.error)||u}catch{}throw console.error(`API Error: ${f.status} ${f.statusText} - ${u}`),new Error(u)}return f}catch(f){throw f instanceof TypeError&&f.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",f):console.error("API Fetch Error:",f),f}finally{zs.removeRequest()}},gI=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[s,l]=w.useState(null),[f,u]=w.useState(!1),d=yt(),h=async g=>{g.preventDefault(),u(!0),l(null);try{const b=await ge("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!b.ok){let S=`Login failed with status: ${b.status}`;try{S=(await b.json()).message||S}catch{try{const E=await b.text();E&&(S=`${S} - ${E}`)}catch{}}throw new Error(S)}const v=await b.json();console.log("Login successful:",v),localStorage.setItem("authToken",v.token),localStorage.setItem("currentUser",JSON.stringify(v.user)),v.user.clinic_id&&localStorage.setItem("currentClinicId",v.user.clinic_id),e(v.user),v.user.role==="doctor"?d("/dashboard/queue"):d("/dashboard")}catch(b){console.error("Login failed:",b),l(b.message||"Login failed. Please check your credentials.")}finally{u(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Sign in to Newtons OPD Zero"}),i.jsxs("form",{onSubmit:h,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email address"}),i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:g=>t(g.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Password"}),i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:g=>a(g.target.value),className:"auth-text-input",placeholder:"Password"})]}),s&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:s})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:f,className:"auth-submit-button",children:f?"Signing in...":"Sign In"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(cs,{to:"/register",className:"auth-navigation-link",children:"Register a new clinic"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},yI=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,s]=w.useState(""),[l,f]=w.useState(""),[u,d]=w.useState(null),[h,g]=w.useState(!1),b=yt(),v=async S=>{S.preventDefault(),g(!0),d(null);try{const k=await ge("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),E=await k.json();if(!k.ok)throw new Error(E.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",E),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),d(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>r(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>s(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>f(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),u&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:u})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:h,className:"auth-submit-button",children:h?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(cs,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var v2={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},JS=An.createContext&&An.createContext(v2),xI=["attr","size","title"];function bI(e,n){if(e==null)return{};var t=vI(e,n),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function vI(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function cb(){return cb=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},cb.apply(this,arguments)}function KS(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function ub(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?KS(Object(t),!0).forEach(function(r){wI(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):KS(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function wI(e,n,t){return n=SI(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function SI(e){var n=NI(e,"string");return typeof n=="symbol"?n:n+""}function NI(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function w2(e){return e&&e.map((n,t)=>An.createElement(n.tag,ub({key:t},n.attr),w2(n.child)))}function ds(e){return n=>An.createElement(CI,cb({attr:ub({},e.attr)},n),w2(e.child))}function CI(e){var n=t=>{var{attr:r,size:a,title:s}=e,l=bI(e,xI),f=a||t.size||"1em",u;return t.className&&(u=t.className),e.className&&(u=(u?u+" ":"")+e.className),An.createElement("svg",cb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:u,style:ub(ub({color:e.color||t.color},t.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),s&&An.createElement("title",null,s),e.children)};return JS!==void 0?An.createElement(JS.Consumer,null,t=>n(t)):n(v2)}function Om(e){return ds({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function jI(e){return ds({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function XS(e){return ds({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function Eh(e){return ds({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function Cx(e){return ds({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function jx(e){return ds({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function _x(e){return ds({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Th(e){return ds({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function S2(e){return ds({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function ZS(e){return ds({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function fv(e){return ds({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function bh(e){return ds({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const Aw={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:Eh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:Cx},{path:"/dashboard/users",name:"User Management",icon:bh}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:Eh}]},{title:"Staff Management",links:[{path:"/dashboard/staff",name:"Manage Staff",icon:bh},{path:"/dashboard/staff/add",name:"Add Staff",icon:fv}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:Cx},{path:"/dashboard/patients",name:"All Patients",icon:bh},{path:"/dashboard/patients/search",name:"Search Patient",icon:Th}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Om},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:_x},{path:"/dashboard/purchase",name:"Add Drug",icon:_x},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Om},{path:"/dashboard/distributors",name:"Distributor Management",icon:bh}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:ZS},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:jx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:jx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:Th},{path:"/dashboard/add-patient",name:"Add Patient",icon:Cx},{path:"/manage-admission",name:"Manage Admission",icon:fv}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:XS},{path:"/billing",name:"Billing",icon:jx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:ZS}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:Eh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:bh},{path:"/dashboard/patients/add",name:"Add Patient",icon:Cx},{path:"/dashboard/patients/search",name:"Search Patient",icon:Th}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:jx},{path:"/manage-admission",name:"Manage Admission",icon:fv}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:Eh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:XS},{path:"/lab/search-report",name:"Search Lab Report",icon:Th}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:Eh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:_x},{path:"/dashboard/purchase",name:"Add Drug",icon:_x},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:Om},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Om},{path:"/dashboard/distributors",name:"Distributor Management",icon:bh}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Om},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:jI},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:Th}]}]},_I=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const s=oi(),[l,f]=w.useState(""),u=Aw[t]||[],[d,h]=w.useState(500),g=w.useRef(!1),b=w.useCallback(E=>{g.current=!0,E.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(E=>{if(g.current){const T=window.innerWidth-E.clientX;T>250&&T<window.innerWidth*.8&&h(T)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=u.map(E=>({...E,links:E.links.filter(T=>T.name.toLowerCase().includes(l.toLowerCase()))})).filter(E=>E.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${d}px`,right:r?"0":`-${d}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(cs,{to:"/dashboard",className:"home-button",onClick:a,children:i.jsx(Eh,{})}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx(Th,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:E=>f(E.target.value)})]}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:k.map((E,T)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:E.title}),i.jsx("ul",{className:"sub-page-list",children:E.links.map(I=>{const D=I.icon;return i.jsx("li",{children:i.jsxs(cs,{to:I.path,className:s.pathname===I.path?"active":"",onClick:a,children:[D&&i.jsx(D,{})," ",I.name]})},I.path)})})]},T))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(S2,{})," Logout"]})]})]})},kI=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:s})=>{const l=oi(),f=s[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:f.map((u,d)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:u.title}),i.jsx("ul",{className:"sub-page-list",children:u.links.map(h=>{const g=h.icon;return i.jsx("li",{children:i.jsxs(cs,{to:h.path,className:l.pathname===h.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",h.name]})},h.path)})})]},d))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(S2,{})," Logout"]})]})]})]})};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),TI=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),eN=e=>{const n=TI(e);return n.charAt(0).toUpperCase()+n.slice(1)},N2=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var AI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:s,iconNode:l,...f},u)=>w.createElement("svg",{ref:u,...AI,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:N2("lucide",a),...f},[...l.map(([d,h])=>w.createElement(d,h)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=(e,n)=>{const t=w.forwardRef(({className:r,...a},s)=>w.createElement(PI,{ref:s,iconNode:n,className:N2(`lucide-${EI(eN(e))}`,`lucide-${e}`,r),...a}));return t.displayName=eN(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Yc=ct("arrow-down",DI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Lt=ct("arrow-left",II);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Pl=ct("arrow-up",MI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],Pw=ct("beaker",RI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],LI=ct("bed-double",OI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],$I=ct("bell",FI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],BI=ct("bell-ring",zI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],m1=ct("brain",UI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],VI=ct("building",qI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],GI=ct("calendar-check-2",HI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],WI=ct("calendar-days",YI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],og=ct("calendar",QI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],KI=ct("chart-no-axes-column",JI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Dw=ct("check",XI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],db=ct("chevron-down",ZI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Bb=ct("chevron-left",eM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],bg=ct("chevron-right",tM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],g1=ct("chevron-up",nM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],rr=ct("circle-alert",rM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ba=ct("circle-check-big",iM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],sM=ct("circle-minus",aM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Il=ct("circle-plus",oM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],cM=ct("circle-user",lM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],tN=ct("clipboard-list",uM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],C2=ct("clipboard",dM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],hM=ct("clock",fM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],mM=ct("copy",pM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gM=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],j2=ct("credit-card",gM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],$d=ct("dollar-sign",yM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xM=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_2=ct("eye",xM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],nN=ct("file-check",bM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vM=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],us=ct("file-text",vM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wM=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],fb=ct("flask-conical",wM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SM=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],k2=ct("funnel",SM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Od=ct("hash",NM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CM=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],E2=ct("house",CM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Uo=ct("info",jM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _M=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],kM=ct("list-ordered",_M);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EM=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],TM=ct("list",EM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],zd=ct("loader-circle",AM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PM=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],rN=ct("lock",PM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DM=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],IM=ct("message-square",DM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MM=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],RM=ct("mic-off",MM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OM=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],T2=ct("mic",OM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LM=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],FM=ct("monitor",LM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],zM=ct("moon",$M);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],UM=ct("package-open",BM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ud=ct("package",qM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],HM=ct("paperclip",VM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GM=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],YM=ct("pause",GM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Md=ct("pencil",WM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],JM=ct("phone",QM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Ll=ct("pill",KM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XM=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],ZM=ct("play",XM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Fl=ct("plus",eR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Bs=ct("printer",tR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],hb=ct("refresh-cw",nR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],qd=ct("save",rR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],jr=ct("search",iR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],sR=ct("send",aR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],pb=ct("server-crash",oR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],vg=ct("settings",lR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],A2=ct("share-2",cR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],dR=ct("shield-check",uR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],hR=ct("shopping-cart",fR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Vd=ct("square-pen",pR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],gR=ct("stethoscope",mR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],xR=ct("sun",yR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],vR=ct("tag",bR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Fr=ct("trash-2",wR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],P2=ct("triangle-alert",SR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],CR=ct("truck",NR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],_R=ct("upload",jR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],D2=ct("user-check",kR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],I2=ct("user-plus",ER);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Vs=ct("user",TR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Fh=ct("users",AR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],DR=ct("video",PR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],M2=ct("wallet",IR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Kn=ct("x",MR),RR="_container_djej9_1",OR="_title_djej9_17",LR="_filtersContainer_djej9_31",FR="_dateInputLabel_djej9_55",$R="_dateInput_djej9_55",zR="_fetchButton_djej9_105",BR="_summarySection_djej9_145",UR="_totalRevenue_djej9_153",qR="_totalRevenueAmount_djej9_175",VR="_card_djej9_187",HR="_cardTitle_djej9_203",GR="_cardList_djej9_217",YR="_cardListItem_djej9_227",WR="_cardListItemAmount_djej9_247",QR="_revenueGrid_djej9_257",JR="_revenueCard_djej9_271",KR="_revenueCardTitle_djej9_285",XR="_revenueCardAmount_djej9_297",ZR="_revenueCardSubtitle_djej9_307",e4="_receptionRevenue_djej9_317",t4="_pharmacyRevenue_djej9_323",n4="_labRevenue_djej9_329",r4="_revenueCardList_djej9_337",i4="_tableSectionTitle_djej9_377",a4="_tableContainer_djej9_397",s4="_styledTable_djej9_411",o4="_capitalize_djej9_461",l4="_noDataMessage_djej9_469",c4="_errorAlert_djej9_489",u4="_loadingContainer_djej9_521",d4="_breathingBall_djej9_543",St={container:RR,title:OR,filtersContainer:LR,dateInputLabel:FR,dateInput:$R,fetchButton:zR,summarySection:BR,totalRevenue:UR,totalRevenueAmount:qR,card:VR,cardTitle:HR,cardList:GR,cardListItem:YR,cardListItemAmount:WR,revenueGrid:QR,revenueCard:JR,revenueCardTitle:KR,revenueCardAmount:XR,revenueCardSubtitle:ZR,receptionRevenue:e4,pharmacyRevenue:t4,labRevenue:n4,revenueCardList:r4,tableSectionTitle:i4,tableContainer:a4,styledTable:s4,capitalize:o4,noDataMessage:l4,errorAlert:c4,loadingContainer:u4,breathingBall:d4},f4=()=>{const e=new Date().toISOString().split("T")[0],[n,t]=w.useState(e),[r,a]=w.useState(e),[s,l]=w.useState([]),[f,u]=w.useState([]),[d,h]=w.useState([]),[g,b]=w.useState(0),[v,S]=w.useState(0),[k,E]=w.useState(null),[T,I]=w.useState(null),[D,q]=w.useState({reception:{},pharmacy:{},lab:{}}),[F,$]=w.useState(!1),[B,z]=w.useState(null),U=async()=>{if($(!0),z(null),l([]),u([]),h([]),b(0),S(0),E(null),I(null),q({reception:{},pharmacy:{},lab:{}}),!n||!r){z("Please select both start and end dates."),$(!1);return}if(new Date(n)>new Date(r)){z("Start date cannot be after end date."),$(!1);return}try{const[R,G,ee]=await Promise.all([ge(`/api/bills?startDate=${n}&endDate=${r}`),ge(`/api/payment/admission?startDate=${n}&endDate=${r}`),ge(`/api/subscriptions/transactions/manual?startDate=${n}&endDate=${r}`)]);if(!R.ok){const Se=await R.json().catch(()=>({}));throw new Error(`Bills fetch error: ${Se.message||R.statusText}`)}if(!G.ok){const Se=await G.json().catch(()=>({}));throw new Error(`Admission Payments fetch error: ${Se.message||G.statusText}`)}if(!ee.ok){const Se=await ee.json().catch(()=>({}));throw new Error(`Manual Subscriptions fetch error: ${Se.message||ee.statusText}`)}const te=await R.json(),oe=await G.json(),K=await ee.json(),V=te.bills||[],J=oe.admissionPayments||[],ne=K||[];l(V),u(J),h(ne);let A=0,ae=0;const ce={},M={consultation:0,pharmacy:0,lab:0,other:0},de={reception:{},pharmacy:{},lab:{}};V.forEach(Se=>{if(Se.status==="paid"||Se.type==="pharmacy_return"){const fe=parseFloat(Se.amount.toString()),we=Se.payment_mode||"Unknown";let ie=Se.type||"other";ie==="pharmacy_return"&&(ae+=fe,ie="pharmacy"),A+=fe,ce[we]=(ce[we]||0)+fe,M.hasOwnProperty(ie)?M[ie]=(M[ie]||0)+fe:M.other=(M.other||0)+fe,ie==="pharmacy"?de.pharmacy[we]=(de.pharmacy[we]||0)+fe:ie==="lab"?de.lab[we]=(de.lab[we]||0)+fe:de.reception[we]=(de.reception[we]||0)+fe}}),J.forEach(Se=>{const fe=parseFloat(Se.amount_paid.toString()),we=Se.payment_mode||"Unknown";A+=fe,ce[we]=(ce[we]||0)+fe,de.reception[we]=(de.reception[we]||0)+fe}),ne.forEach(Se=>{var ie,_e;const fe=parseFloat(((_e=(ie=Se.subscriptionPlan)==null?void 0:ie.price)==null?void 0:_e.toString())??"0"),we=Se.subscription_payment_method||"Unknown";A+=fe,ce[we]=(ce[we]||0)+fe,de.reception[we]=(de.reception[we]||0)+fe}),E(ce),I(M),q(de),b(A),S(ae)}catch(R){console.error("Failed to fetch money flow data:",R),z(R.message||"Failed to fetch data. Check console for details.")}finally{$(!1)}},L=()=>{U()};return i.jsxs("div",{className:St.container,children:[i.jsx("h2",{className:St.title,children:"Money Flow Analysis"}),i.jsxs("div",{className:St.filtersContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-money",className:St.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-money",value:n,onChange:R=>t(R.target.value),className:St.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-money",className:St.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-money",value:r,onChange:R=>a(R.target.value),className:St.dateInput})]}),i.jsx("button",{onClick:L,disabled:F,className:St.fetchButton,children:F?"Loading...":"Fetch Data"})]}),B&&i.jsxs("div",{className:St.errorAlert,role:"alert",children:[i.jsx(rr,{size:20})," ",i.jsxs("span",{children:["Error: ",B]})]}),!F&&!B&&(s.length>0||f.length>0||d.length>0)&&i.jsxs("div",{className:St.summarySection,children:[i.jsxs("h3",{className:St.totalRevenue,children:["Total Paid Revenue (",n," to ",r,"):",i.jsxs("span",{className:St.totalRevenueAmount,children:["",g.toFixed(2)]})]}),k&&Object.keys(k).length>0&&i.jsxs("div",{className:St.card,children:[i.jsx("h4",{className:St.cardTitle,children:"Revenue by Payment Mode:"}),i.jsx("ul",{className:St.cardList,children:Object.entries(k).map(([R,G])=>i.jsxs("li",{className:St.cardListItem,children:[R,": ",i.jsxs("span",{className:St.cardListItemAmount,children:["",G.toFixed(2)]})]},R))})]}),T&&D&&i.jsxs("div",{className:St.revenueGrid,children:[i.jsxs("div",{className:`${St.revenueCard} ${St.receptionRevenue}`,children:[i.jsx("h4",{className:St.revenueCardTitle,children:"Reception Revenue"}),i.jsxs("p",{className:St.revenueCardAmount,children:["",(T.consultation+T.other).toFixed(2)]}),i.jsx("span",{className:St.revenueCardSubtitle,children:"(Consultation + Other + Admissions + Subscriptions)"}),Object.keys(D.reception).length>0&&i.jsx("ul",{className:St.revenueCardList,children:Object.entries(D.reception).map(([R,G])=>i.jsxs("li",{children:[R,": ",i.jsxs("span",{children:["",G.toFixed(2)]})]},`reception-${R}`))})]}),i.jsxs("div",{className:`${St.revenueCard} ${St.pharmacyRevenue}`,children:[i.jsx("h4",{className:St.revenueCardTitle,children:"Pharmacy Revenue"}),i.jsxs("p",{className:St.revenueCardAmount,children:["",T.pharmacy.toFixed(2)]}),v<0&&i.jsxs("p",{className:St.revenueCardSubtitle,children:["Returns: ",i.jsxs("span",{className:St.negativeAmount,children:["",v.toFixed(2)]})]}),Object.keys(D.pharmacy).length>0&&i.jsx("ul",{className:St.revenueCardList,children:Object.entries(D.pharmacy).map(([R,G])=>i.jsxs("li",{children:[R,": ",i.jsxs("span",{children:["",G.toFixed(2)]})]},`pharmacy-${R}`))})]}),i.jsxs("div",{className:`${St.revenueCard} ${St.labRevenue}`,children:[i.jsx("h4",{className:St.revenueCardTitle,children:"Lab Revenue"}),i.jsxs("p",{className:St.revenueCardAmount,children:["",T.lab.toFixed(2)]}),Object.keys(D.lab).length>0&&i.jsx("ul",{className:St.revenueCardList,children:Object.entries(D.lab).map(([R,G])=>i.jsxs("li",{children:[R,": ",i.jsxs("span",{children:["",G.toFixed(2)]})]},`lab-${R}`))})]})]}),i.jsxs("h4",{className:St.tableSectionTitle,children:["Individual Bills (",s.filter(R=>R.status==="paid"||R.type==="pharmacy_return").length,"):"]}),s.filter(R=>R.status==="paid"||R.type==="pharmacy_return").length>0?i.jsx("div",{className:St.tableContainer,children:i.jsxs("table",{className:St.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Bill ID"}),i.jsx("th",{children:"Patient ID"}),i.jsx("th",{children:"Type"}),i.jsx("th",{children:"Amount"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:s.filter(R=>R.status==="paid"||R.type==="pharmacy_return").map(R=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(R.createdAt).toLocaleDateString()}),i.jsx("td",{children:R.id}),i.jsx("td",{children:R.patient_id}),i.jsx("td",{className:St.capitalize,children:R.type}),i.jsxs("td",{children:["",parseFloat(R.amount.toString()).toFixed(2)]}),i.jsx("td",{children:R.payment_mode})]},`bill-${R.id}`))})]})}):i.jsx("p",{className:St.noDataMessage,children:"No relevant bills found for the selected period."}),i.jsxs("h4",{className:St.tableSectionTitle,children:["Admission Payments (",f.length,"):"]}),f.length>0?i.jsx("div",{className:St.tableContainer,children:i.jsxs("table",{className:St.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:f.map(R=>{var G;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date(R.payment_date).toLocaleDateString()}),i.jsx("td",{children:R.id}),i.jsx("td",{children:((G=R.Patient)==null?void 0:G.name)??R.patient_id})," ",i.jsxs("td",{children:["",parseFloat(R.amount_paid.toString()).toFixed(2)]}),i.jsx("td",{children:R.payment_mode})]},`admission-${R.id}`)})})]})}):i.jsx("p",{className:St.noDataMessage,children:"No admission payments found for the selected period."}),i.jsxs("h4",{className:St.tableSectionTitle,children:["Manual Subscription Payments (",d.length,"):"]}),d.length>0?i.jsx("div",{className:St.tableContainer,children:i.jsxs("table",{className:St.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Start Date"}),i.jsx("th",{children:"Patient ID"}),i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Plan Name"}),i.jsx("th",{children:"Plan Amount"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:d.map(R=>{var G,ee,te;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date(R.subscription_start_date).toLocaleDateString()}),i.jsx("td",{children:R.id}),i.jsx("td",{children:R.name}),i.jsx("td",{children:((G=R.subscriptionPlan)==null?void 0:G.name)??"N/A"}),i.jsxs("td",{children:["",parseFloat(((te=(ee=R.subscriptionPlan)==null?void 0:ee.price)==null?void 0:te.toString())??"0").toFixed(2)]}),i.jsx("td",{className:St.capitalize,children:R.subscription_payment_method})]},`sub-patient-${R.id}`)})})]})}):i.jsx("p",{className:St.noDataMessage,children:"No manual subscription payments found for the selected period."})]}),F&&i.jsxs("div",{className:St.loadingContainer,children:[i.jsx("div",{className:St.breathingBall}),i.jsx("p",{children:"Loading data..."})]}),!F&&!B&&s.length===0&&f.length===0&&d.length===0&&i.jsx("p",{className:St.noDataMessage,children:"No data found for the selected period. Click 'Fetch Data'."})]})},h4=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},R2=()=>localStorage.getItem("authToken"),Iw=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!1),[a,s]=w.useState(null),[l,f]=w.useState(!1),[u,d]=w.useState(null),h=w.useRef(null),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,E]=w.useState(!1),[T,I]=w.useState(!1),[D,q]=w.useState(null),[F,$]=w.useState({name:"",description:"",price:"",default_parameters:[]}),B=w.useCallback(async()=>{r(!0),s(null),d(null),S(null);try{const ce=await ge("/api/lab-tests");if(!ce.ok)throw new Error(`HTTP error! status: ${ce.status}`);const M=await ce.json();n(M)}catch(ce){console.error("Error fetching lab tests:",ce),s(ce.message||"Failed to fetch lab tests.")}finally{r(!1)}},[]);w.useEffect(()=>{B()},[B]);const z=ce=>{const{name:M,value:de}=ce.target;$(Se=>({...Se,[M]:de}))},U=(ce,M,de)=>{const Se=[...F.default_parameters],fe=Se[ce];if(M==="type")switch(fe.type=de,de){case"number":fe.defaultValue=0,fe.lower_limit=null,fe.upper_limit=null,fe.unit="";break;case"boolean":fe.defaultValue=!1,fe.lower_limit=void 0,fe.upper_limit=void 0,fe.unit=void 0;break;case"string":default:fe.defaultValue="",fe.lower_limit=void 0,fe.upper_limit=void 0,fe.unit=void 0;break}else M==="defaultValue"?fe.type==="number"?fe.defaultValue=parseFloat(de)||0:(fe.type,fe.defaultValue=de):M==="lower_limit"||M==="upper_limit"?fe[M]=de===""?null:parseFloat(de):fe[M]=de;$(we=>({...we,default_parameters:Se}))},L=()=>{$(ce=>({...ce,default_parameters:[...ce.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},R=ce=>{$(M=>({...M,default_parameters:M.default_parameters.filter((de,Se)=>Se!==ce)}))},G=async ce=>{ce.preventDefault(),r(!0),s(null);const M=D!==null,de=M?`/api/lab-tests/${D}`:"/api/lab-tests",Se=M?"PUT":"POST";try{const fe=await ge(de,{method:Se,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:F.name,description:F.description,price:parseFloat(F.price),default_parameters:F.default_parameters})});if(!fe.ok){const we=await fe.json();throw new Error(we.message||`HTTP error! status: ${fe.status}`)}I(!1),q(null),$({name:"",description:"",price:"",default_parameters:[]}),B()}catch(fe){console.error(`Error ${M?"updating":"adding"} lab test:`,fe),s(fe.message||`Failed to ${M?"update":"add"} lab test.`)}finally{r(!1)}},ee=()=>{q(null),$({name:"",description:"",price:"",default_parameters:[]}),I(!0)},te=ce=>{if(D===ce.id)q(null);else{q(ce.id);const M=(ce.default_parameters||[]).map(de=>({...de,unit:de.unit||"",lower_limit:de.lower_limit===void 0?null:de.lower_limit,upper_limit:de.upper_limit===void 0?null:de.upper_limit}));$({name:ce.name,description:ce.description||"",price:ce.price,default_parameters:M}),I(!1)}},oe=async ce=>{if(window.confirm("Are you sure you want to delete this lab test?")){r(!0),s(null);try{const M=await ge(`/api/lab-tests/${ce}`,{method:"DELETE"});if(!M.ok){const de=await M.json();throw new Error(de.message||`HTTP error! status: ${M.status}`)}B()}catch(M){console.error("Error deleting lab test:",M),s(M.message||"Failed to delete lab test.")}finally{r(!1)}}},K=()=>{I(!1),q(null),s(null),$({name:"",description:"",price:"",default_parameters:[]})},V=async ce=>{if(!ce){d("No file selected.");return}f(!0),d(null),s(null);const M=new FormData;M.append("file",ce);try{const de=await ge("/api/lab-tests/import",{method:"POST",body:M});if(!de.ok){const Se=await de.json();throw new Error(Se.message||`Import failed: ${de.statusText}`)}B()}catch(de){console.error("Error importing lab tests from Excel:",de),d(de.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},J=async ce=>{if(ce.target.files&&ce.target.files[0]){const M=ce.target.files[0];await V(M),ce.target&&(ce.target.value="")}},ne=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){b(!0),S(null),s(null);try{const ce=await ge("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!ce.ok){const M=await ce.json();throw new Error(M.message||`Default import failed: ${ce.statusText}`)}B()}catch(ce){console.error("Error importing default lab tests:",ce),S(ce.message||"Failed to import default lab tests.")}finally{b(!1)}}},A=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){E(!0),s(null),d(null),S(null);try{const ce=await ge("/api/lab-tests/all",{method:"DELETE"});if(!ce.ok){const M=await ce.json();throw new Error(M.message||`Delete all failed: ${ce.statusText}`)}B()}catch(ce){console.error("Error deleting all lab tests:",ce),s(ce.message||"Failed to delete all lab tests.")}finally{E(!1)}}},ae=t||l||g||k;return i.jsxs("div",{className:"lab-inventory-card",children:[i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:ee,className:"lab-inventory-button",disabled:ae,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var ce;return(ce=h.current)==null?void 0:ce.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:ae,children:l?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:h,onChange:J,accept:".xlsx, .xls",style:{display:"none"},disabled:l}),i.jsx("button",{onClick:ne,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ae,children:g?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:A,className:"lab-inventory-button lab-inventory-button-danger",disabled:ae,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:k?"Deleting All...":"Delete All Tests"})]}),a&&i.jsx("div",{className:"error-text mb-4",children:a}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),v&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",v]}),T&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:G,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:z,className:"lab-inventory-input",required:!0,disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:z,rows:3,className:"lab-inventory-input",disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:z,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),F.default_parameters.map((ce,M)=>{var de,Se;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:ce.name,onChange:fe=>U(M,"name",fe.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:ce.type,onChange:fe=>U(M,"type",fe.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),ce.type==="boolean"?i.jsxs("select",{value:ce.defaultValue.toString(),onChange:fe=>U(M,"defaultValue",fe.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:ce.type==="number"?"number":"text",placeholder:"Default Value",value:ce.defaultValue.toString(),onChange:fe=>U(M,"defaultValue",fe.target.value),className:"lab-inventory-input"}),ce.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:ce.lower_limit===null?"":((de=ce.lower_limit)==null?void 0:de.toString())??"",onChange:fe=>U(M,"lower_limit",fe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:ce.upper_limit===null?"":((Se=ce.upper_limit)==null?void 0:Se.toString())??"",onChange:fe=>U(M,"upper_limit",fe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:ce.unit||"",onChange:fe=>U(M,"unit",fe.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>R(M),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},M)}),i.jsx("button",{type:"button",onClick:L,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:K,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ae,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ae,children:t?"Saving...":"Add Test"})]})]})]}),ae&&!T&&i.jsxs("p",{className:"loading-text",children:[" ",l?"Importing Excel data...":g?"Importing default data...":"Loading tests..."]}),!ae&&e.length===0&&!a&&!u&&!v&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!ae&&e.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:e.map(ce=>{const M=D===ce.id,de=ce.price&&typeof ce.price=="string"?parseFloat(ce.price):NaN,Se=isNaN(de)?"0.00":de.toFixed(2);return i.jsxs(An.Fragment,{children:[i.jsxs("tr",{onClick:()=>te(ce),style:{cursor:"pointer"},children:[i.jsx("td",{children:ce.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:ce.description||"-"}),i.jsxs("td",{children:["",Se]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:fe=>{fe.stopPropagation(),te(ce)},className:"lab-inventory-link",disabled:ae,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:fe=>{fe.stopPropagation(),oe(ce.id)},className:"lab-inventory-link",disabled:ae,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),M&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:G,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:z,className:"lab-inventory-input",required:!0,disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:z,rows:3,className:"lab-inventory-input",disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:z,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),F.default_parameters.map((fe,we)=>{var ie,_e;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:fe.name,onChange:Ve=>U(we,"name",Ve.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:fe.type,onChange:Ve=>U(we,"type",Ve.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),fe.type==="boolean"?i.jsxs("select",{value:fe.defaultValue.toString(),onChange:Ve=>U(we,"defaultValue",Ve.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:fe.type==="number"?"number":"text",placeholder:"Default Value",value:fe.defaultValue.toString(),onChange:Ve=>U(we,"defaultValue",Ve.target.value),className:"lab-inventory-input"}),fe.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:fe.lower_limit===null?"":((ie=fe.lower_limit)==null?void 0:ie.toString())??"",onChange:Ve=>U(we,"lower_limit",Ve.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:fe.upper_limit===null?"":((_e=fe.upper_limit)==null?void 0:_e.toString())??"",onChange:Ve=>U(we,"upper_limit",Ve.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:fe.unit||"",onChange:Ve=>U(we,"unit",Ve.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>R(we),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},we)}),i.jsx("button",{type:"button",onClick:L,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:K,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ae,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ae,children:t?"Saving...":"Update Test"})]})]})]})})})]},ce.id)})})]})]})]})},O2=6048e5,p4=864e5,L2=6e4,F2=36e5,iN=Symbol.for("constructDateFrom");function Hs(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&iN in e?e[iN](n):e instanceof Date?new e.constructor(n):new Date(n)}function Ei(e,n){return Hs(n||e,e)}function y1(e,n,t){const r=Ei(e,t==null?void 0:t.in);if(isNaN(n))return Hs(e,NaN);if(!n)return r;const a=r.getDate(),s=Hs(e,r.getTime());s.setMonth(r.getMonth()+n+1,0);const l=s.getDate();return a>=l?s:(r.setFullYear(s.getFullYear(),s.getMonth(),a),r)}let m4={};function Ub(){return m4}function lg(e,n){var f,u,d,h;const t=Ub(),r=(n==null?void 0:n.weekStartsOn)??((u=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:u.weekStartsOn)??t.weekStartsOn??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,a=Ei(e,n==null?void 0:n.in),s=a.getDay(),l=(s<r?7:0)+s-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function mb(e,n){return lg(e,{...n,weekStartsOn:1})}function $2(e,n){const t=Ei(e,n==null?void 0:n.in),r=t.getFullYear(),a=Hs(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const s=mb(a),l=Hs(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const f=mb(l);return t.getTime()>=s.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function aN(e){const n=Ei(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function g4(e,...n){const t=Hs.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function sN(e,n){const t=Ei(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function y4(e,n,t){const[r,a]=g4(t==null?void 0:t.in,e,n),s=sN(r),l=sN(a),f=+s-aN(s),u=+l-aN(l);return Math.round((f-u)/p4)}function x4(e,n){const t=$2(e,n),r=Hs(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),mb(r)}function b4(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function cg(e){return!(!b4(e)&&typeof e!="number"||isNaN(+Ei(e)))}function v4(e,n){const t=Ei(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const w4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},S4=(e,n,t)=>{let r;const a=w4[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function hv(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const N4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},C4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},j4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_4={date:hv({formats:N4,defaultWidth:"full"}),time:hv({formats:C4,defaultWidth:"full"}),dateTime:hv({formats:j4,defaultWidth:"full"})},k4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},E4=(e,n,t,r)=>k4[e];function Lm(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,f=t!=null&&t.width?String(t.width):l;a=e.formattingValues[f]||e.formattingValues[l]}else{const l=e.defaultWidth,f=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[f]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(n):n;return a[s]}}const T4={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},A4={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},P4={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},D4={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},I4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},M4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},R4=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},O4={ordinalNumber:R4,era:Lm({values:T4,defaultWidth:"wide"}),quarter:Lm({values:A4,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Lm({values:P4,defaultWidth:"wide"}),day:Lm({values:D4,defaultWidth:"wide"}),dayPeriod:Lm({values:I4,defaultWidth:"wide",formattingValues:M4,defaultFormattingWidth:"wide"})};function Fm(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=n.match(a);if(!s)return null;const l=s[0],f=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(f)?F4(f,g=>g.test(l)):L4(f,g=>g.test(l));let d;d=e.valueCallback?e.valueCallback(u):u,d=t.valueCallback?t.valueCallback(d):d;const h=n.slice(l.length);return{value:d,rest:h}}}function L4(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function F4(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function $4(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],s=n.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=t.valueCallback?t.valueCallback(l):l;const f=n.slice(a.length);return{value:l,rest:f}}}const z4=/^(\d+)(th|st|nd|rd)?/i,B4=/\d+/i,U4={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},q4={any:[/^b/i,/^(a|c)/i]},V4={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},H4={any:[/1/i,/2/i,/3/i,/4/i]},G4={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Y4={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},W4={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Q4={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},J4={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},K4={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},X4={ordinalNumber:$4({matchPattern:z4,parsePattern:B4,valueCallback:e=>parseInt(e,10)}),era:Fm({matchPatterns:U4,defaultMatchWidth:"wide",parsePatterns:q4,defaultParseWidth:"any"}),quarter:Fm({matchPatterns:V4,defaultMatchWidth:"wide",parsePatterns:H4,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Fm({matchPatterns:G4,defaultMatchWidth:"wide",parsePatterns:Y4,defaultParseWidth:"any"}),day:Fm({matchPatterns:W4,defaultMatchWidth:"wide",parsePatterns:Q4,defaultParseWidth:"any"}),dayPeriod:Fm({matchPatterns:J4,defaultMatchWidth:"any",parsePatterns:K4,defaultParseWidth:"any"})},Z4={code:"en-US",formatDistance:S4,formatLong:_4,formatRelative:E4,localize:O4,match:X4,options:{weekStartsOn:0,firstWeekContainsDate:1}};function eO(e,n){const t=Ei(e,n==null?void 0:n.in);return y4(t,v4(t))+1}function tO(e,n){const t=Ei(e,n==null?void 0:n.in),r=+mb(t)-+x4(t);return Math.round(r/O2)+1}function z2(e,n){var h,g,b,v;const t=Ei(e,n==null?void 0:n.in),r=t.getFullYear(),a=Ub(),s=(n==null?void 0:n.firstWeekContainsDate)??((g=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=Hs((n==null?void 0:n.in)||e,0);l.setFullYear(r+1,0,s),l.setHours(0,0,0,0);const f=lg(l,n),u=Hs((n==null?void 0:n.in)||e,0);u.setFullYear(r,0,s),u.setHours(0,0,0,0);const d=lg(u,n);return+t>=+f?r+1:+t>=+d?r:r-1}function nO(e,n){var f,u,d,h;const t=Ub(),r=(n==null?void 0:n.firstWeekContainsDate)??((u=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:u.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,a=z2(e,n),s=Hs((n==null?void 0:n.in)||e,0);return s.setFullYear(a,0,r),s.setHours(0,0,0,0),lg(s,n)}function rO(e,n){const t=Ei(e,n==null?void 0:n.in),r=+lg(t,n)-+nO(t,n);return Math.round(r/O2)+1}function Mn(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const qc={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Mn(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Mn(t+1,2)},d(e,n){return Mn(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Mn(e.getHours()%12||12,n.length)},H(e,n){return Mn(e.getHours(),n.length)},m(e,n){return Mn(e.getMinutes(),n.length)},s(e,n){return Mn(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Mn(a,n.length)}},vh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},oN={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return qc.y(e,n)},Y:function(e,n,t,r){const a=z2(e,r),s=a>0?a:1-a;if(n==="YY"){const l=s%100;return Mn(l,2)}return n==="Yo"?t.ordinalNumber(s,{unit:"year"}):Mn(s,n.length)},R:function(e,n){const t=$2(e);return Mn(t,n.length)},u:function(e,n){const t=e.getFullYear();return Mn(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Mn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Mn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return qc.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Mn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=rO(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Mn(a,n.length)},I:function(e,n,t){const r=tO(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Mn(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):qc.d(e,n)},D:function(e,n,t){const r=eO(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Mn(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),s=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(s);case"ee":return Mn(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),s=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(s);case"cc":return Mn(s,n.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Mn(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=vh.noon:r===0?a=vh.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=vh.evening:r>=12?a=vh.afternoon:r>=4?a=vh.morning:a=vh.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return qc.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):qc.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Mn(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Mn(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):qc.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):qc.s(e,n)},S:function(e,n){return qc.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return cN(r);case"XXXX":case"XX":return Id(r);case"XXXXX":case"XXX":default:return Id(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return cN(r);case"xxxx":case"xx":return Id(r);case"xxxxx":case"xxx":default:return Id(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+lN(r,":");case"OOOO":default:return"GMT"+Id(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+lN(r,":");case"zzzz":default:return"GMT"+Id(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Mn(r,n.length)},T:function(e,n,t){return Mn(+e,n.length)}};function lN(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),s=r%60;return s===0?t+String(a):t+String(a)+n+Mn(s,2)}function cN(e,n){return e%60===0?(e>0?"-":"+")+Mn(Math.abs(e)/60,2):Id(e,n)}function Id(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Mn(Math.trunc(r/60),2),s=Mn(r%60,2);return t+a+n+s}const uN=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},B2=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},iO=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return uN(e,n);let s;switch(r){case"P":s=n.dateTime({width:"short"});break;case"PP":s=n.dateTime({width:"medium"});break;case"PPP":s=n.dateTime({width:"long"});break;case"PPPP":default:s=n.dateTime({width:"full"});break}return s.replace("{{date}}",uN(r,n)).replace("{{time}}",B2(a,n))},aO={p:B2,P:iO},sO=/^D+$/,oO=/^Y+$/,lO=["D","DD","YY","YYYY"];function cO(e){return sO.test(e)}function uO(e){return oO.test(e)}function dO(e,n,t){const r=fO(e,n,t);if(console.warn(r),lO.includes(e))throw new RangeError(r)}function fO(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const hO=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,pO=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,mO=/^'([^]*?)'?$/,gO=/''/g,yO=/[a-zA-Z]/;function $h(e,n,t){var h,g,b,v;const r=Ub(),a=r.locale??Z4,s=r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,l=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,f=Ei(e,t==null?void 0:t.in);if(!cg(f))throw new RangeError("Invalid time value");let u=n.match(pO).map(S=>{const k=S[0];if(k==="p"||k==="P"){const E=aO[k];return E(S,a.formatLong)}return S}).join("").match(hO).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:xO(S)};if(oN[k])return{isToken:!0,value:S};if(k.match(yO))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(u=a.localize.preprocessor(f,u));const d={firstWeekContainsDate:s,weekStartsOn:l,locale:a};return u.map(S=>{if(!S.isToken)return S.value;const k=S.value;(uO(k)||cO(k))&&dO(k,n,String(e));const E=oN[k[0]];return E(f,k,a.localize,d)}).join("")}function xO(e){const n=e.match(mO);return n?n[1].replace(gO,"'"):e}function Ld(e,n){return+Ei(e)<+Ei(n)}function gb(e,n){const t=()=>Hs(n==null?void 0:n.in,NaN),a=SO(e);let s;if(a.date){const d=NO(a.date,2);s=CO(d.restDateString,d.year)}if(!s||isNaN(+s))return t();const l=+s;let f=0,u;if(a.time&&(f=jO(a.time),isNaN(f)))return t();if(a.timezone){if(u=_O(a.timezone),isNaN(u))return t()}else{const d=new Date(l+f),h=Ei(0,n==null?void 0:n.in);return h.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),h.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),h}return Ei(l+f+u,n==null?void 0:n.in)}const kx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},bO=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,vO=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,wO=/^([+-])(\d{2})(?::?(\d{2}))?$/;function SO(e){const n={},t=e.split(kx.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],kx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(kx.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=kx.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function NO(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,s=r[2]?parseInt(r[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((r[1]||r[2]).length)}}function CO(e,n){if(n===null)return new Date(NaN);const t=e.match(bO);if(!t)return new Date(NaN);const r=!!t[4],a=$m(t[1]),s=$m(t[2])-1,l=$m(t[3]),f=$m(t[4]),u=$m(t[5])-1;if(r)return PO(n,f,u)?kO(n,f,u):new Date(NaN);{const d=new Date(0);return!TO(n,s,l)||!AO(n,a)?new Date(NaN):(d.setUTCFullYear(n,s,Math.max(a,l)),d)}}function $m(e){return e?parseInt(e):1}function jO(e){const n=e.match(vO);if(!n)return NaN;const t=pv(n[1]),r=pv(n[2]),a=pv(n[3]);return DO(t,r,a)?t*F2+r*L2+a*1e3:NaN}function pv(e){return e&&parseFloat(e.replace(",","."))||0}function _O(e){if(e==="Z")return 0;const n=e.match(wO);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return IO(r,a)?t*(r*F2+a*L2):NaN}function kO(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,s=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+s),r}const EO=[31,null,31,30,31,30,31,31,30,31,30,31];function U2(e){return e%400===0||e%4===0&&e%100!==0}function TO(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(EO[n]||(U2(e)?29:28))}function AO(e,n){return n>=1&&n<=(U2(e)?366:365)}function PO(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function DO(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function IO(e,n){return n>=0&&n<=59}const dN=10,MO=3,q2=()=>{const e=yt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[s,l]=w.useState(""),[f,u]=w.useState(!0),[d,h]=w.useState(null),[g,b]=w.useState(new Set),[v,S]=w.useState("all"),k=async()=>{try{const se=await ge("/api/inventory/download-csv");if(!se.ok)throw new Error(`Failed to download CSV: ${se.statusText}`);const Q=await se.blob(),re=window.URL.createObjectURL(Q),je=document.createElement("a");je.href=re,je.download="pharmacy_inventory.csv",document.body.appendChild(je),je.click(),je.remove(),window.URL.revokeObjectURL(re)}catch(se){console.error("Failed to download CSV:",se),h(se.message||"Failed to download inventory CSV. Please try again.")}},[E,T]=w.useState(!1),[I,D]=w.useState(!1),[q,F]=w.useState(null),[$,B]=w.useState(!1),[z,U]=w.useState(new Set),[L,R]=w.useState(null),[G,ee]=w.useState(0),[te,oe]=w.useState(!1),[K,V]=w.useState(null),[J,ne]=w.useState(1),[A,ae]=w.useState(!1),ce=w.useCallback(async()=>{u(!0),h(null);try{const se=await ge("/api/drugs");if(!se.ok)throw new Error(`Failed to fetch drugs: ${se.statusText} (${se.status})`);let Q=await se.json();Q=Q.map(re=>({...re,price:parseFloat(String(re.price))||0,buying_price:re.buying_price!==null&&re.buying_price!==void 0?parseFloat(String(re.buying_price)):null,quantity_in_stock:parseInt(String(re.quantity_in_stock),10)||0,gst:re.gst!==null&&re.gst!==void 0?parseFloat(String(re.gst)):null,margin:re.margin!==null&&re.margin!==void 0?parseFloat(String(re.margin)):null,discount:re.discount!==null&&re.discount!==void 0?parseFloat(String(re.discount)):null})),t(Q),a(Q)}catch(se){console.error("Failed to fetch drugs:",se),h(se.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{ce()},[ce]),w.useEffect(()=>{const se=s.toLowerCase();let Q=n.filter(Ae=>{var Xe,Fe,st,Je,xt;const Ue=((Xe=Ae.name)==null?void 0:Xe.toLowerCase())||"",ot=((Fe=Ae.description)==null?void 0:Fe.toLowerCase())||"",mt=((st=Ae.supplier)==null?void 0:st.toLowerCase())||"",ft=((Je=Ae.box_number)==null?void 0:Je.toLowerCase())||"",Be=((xt=Ae.brand_name)==null?void 0:xt.toLowerCase())||"";return Ue.includes(se)||ot.includes(se)||mt.includes(se)||ft.includes(se)||Be.includes(se)});const re=new Date,je=y1(re,MO);v==="low-stock"?Q=Q.filter(Ae=>Ae.quantity_in_stock<=dN):v==="near-expiry"?Q=Q.filter(Ae=>{if(!Ae.expiry_date)return!1;const Ue=gb(Ae.expiry_date);return cg(Ue)&&Ld(Ue,je)&&!Ld(Ue,re)}):v==="expired"&&(Q=Q.filter(Ae=>{if(!Ae.expiry_date)return!1;const Ue=gb(Ae.expiry_date);return cg(Ue)&&Ld(Ue,re)})),a(Q)},[s,n,v]);const M=()=>{T(!1),R(null)},de=se=>{ee(parseInt(se.target.value,10)||0)},Se=async se=>{if(se.preventDefault(),h(null),!L||!L.id||G===0){h("No drug selected or adjustment amount is zero.");return}try{const Q=await ge(`/api/drugs/${L.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:G})});if(!Q.ok){const je=await Q.json();throw new Error(je.message||`Failed to adjust stock: ${Q.statusText}`)}const re=await Q.json();t(je=>je.map(Ae=>Ae.id===re.id?re:Ae)),M(),alert(`Stock for "${re.name}" adjusted successfully. New stock: ${re.quantity_in_stock}`)}catch(Q){console.error("Failed to adjust stock:",Q),h(Q.message||"Failed to adjust stock. Please try again.")}},fe=se=>{F(se),D(!0)},we=()=>{D(!1),F(null)},ie=async()=>{if(!q||!q.id){h("No drug selected for deletion.");return}u(!0),h(null);try{const se=await ge(`/api/drugs/${q.id}`,{method:"DELETE"});if(!se.ok){const Q=await se.json();throw new Error(Q.message||`Failed to delete drug: ${se.statusText}`)}alert(`Drug "${q.name}" deleted successfully.`),ce(),we()}catch(se){console.error("Failed to delete drug:",se),h(se.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},_e=()=>{B(!0)},Ve=()=>{B(!1)},[tt,Ke]=w.useState(!1),Oe=()=>{z.size>0&&Ke(!0)},xe=()=>{Ke(!1)},Me=async()=>{if(z.size===0){h("No drugs selected for deletion.");return}u(!0),h(null);try{const se=await ge("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(z)})});if(!se.ok){const Q=await se.json();throw new Error(Q.message||`Failed to delete selected drugs: ${se.statusText}`)}alert(`${z.size} drug(s) deleted successfully.`),ce(),U(new Set),xe()}catch(se){console.error("Failed to delete selected drugs:",se),h(se.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},ve=async()=>{u(!0),h(null);try{const se=await ge("/api/drugs/all",{method:"DELETE"});if(!se.ok){const Q=await se.json();throw new Error(Q.message||`Failed to delete all drugs: ${se.statusText}`)}alert("All drugs deleted successfully."),ce(),Ve()}catch(se){console.error("Failed to delete all drugs:",se),h(se.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},Ee=se=>{if(!se)return null;const Q=se.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return Q?parseInt(Q[1],10):null},Pe=se=>{V(se),ne(1),oe(!0)},rt=()=>{oe(!1),V(null),ne(1)},lt=se=>{ne(parseInt(se.target.value,10)||0)},Ze=async se=>{if(se.preventDefault(),h(null),!K||!K.id||J<=0){h("No drug selected or invalid number of packs to convert.");return}const Q=Ee(K.unit);if(!Q||Q<=0){h(`Cannot convert "${K.name}" to loose. Invalid pack unit: ${K.unit||"N/A"}.`);return}if(J>(K.quantity_in_stock??0)){h(`Cannot convert ${J} packs. Only ${K.quantity_in_stock??0} packs are in stock.`);return}try{const re=await ge(`/api/drugs/${K.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:J,packSize:Q})});if(!re.ok){const Ae=await re.json();throw new Error(Ae.message||`Failed to convert to loose: ${re.statusText}`)}const je=await re.json();t(Ae=>Ae.map(Ue=>Ue.id===je.id?je:Ue)),rt(),alert(`Converted ${J} pack(s) of "${je.name}" to loose. New stock: ${je.quantity_in_stock} packs, ${je.loose??0} loose units.`)}catch(re){console.error("Failed to convert to loose:",re),h(re.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},Rt=()=>{ae(!0)},kt=()=>{ae(!1)},on=async()=>{u(!0),h(null);try{const se=await ge("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!se.ok){const Q=await se.json();throw new Error(Q.message||`Failed to add default medications: ${se.statusText}`)}alert("Default medications added successfully."),ce(),kt()}catch(se){console.error("Failed to add default medications:",se),h(se.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):d?i.jsxs("div",{className:"error-indicator",children:["Error: ",d]}):i.jsxs("div",{className:"pharmacy-inventory-page",children:[i.jsxs("div",{className:"inventory-header-controls",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:i.jsx(Lt,{size:24})}),i.jsx("h2",{className:"inventory-page-title",children:"Pharmacy Inventory"})]}),i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",children:[i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-drug-button",children:[i.jsx(Il,{size:18,className:"button-icon"}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-purchase-button",children:[i.jsx(Il,{size:18,className:"button-icon"}),"Open Purchase Page"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"action-button view-distributors-button",children:[i.jsx(Il,{size:18,className:"button-icon"}),"View Distributors"]})]}),i.jsxs("div",{className:"action-group-right",children:[i.jsx("button",{onClick:k,className:"action-button download-csv-button",children:"Download CSV"}),i.jsxs("button",{onClick:Rt,className:"action-button add-defaults-button",children:[i.jsx(Il,{size:18,className:"button-icon"}),"Add Default Medications"]}),i.jsxs("button",{onClick:Oe,className:"action-button delete-selected-drugs-button",disabled:z.size===0,children:[i.jsx(Fr,{size:18,className:"button-icon"}),"Delete Selected (",z.size,")"]}),i.jsxs("button",{onClick:_e,className:"action-button delete-all-drugs-button",children:[i.jsx(Fr,{size:18,className:"button-icon"}),"Delete All Drugs"]})]})]})]}),i.jsxs("div",{className:"search-bar-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drugs by name, brand, description, or supplier...",value:s,onChange:se=>l(se.target.value),className:"inventory-search-input"}),i.jsx(jr,{size:18,className:"search-input-icon"})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"filter-option",className:"sr-only",children:"Filter Inventory"}),i.jsxs("select",{id:"filter-option",value:v,onChange:se=>S(se.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:se=>{if(se.target.checked){const Q=new Set(r.map(re=>re.id));U(Q)}else U(new Set)},checked:z.size===r.length&&r.length>0,disabled:r.length===0})}),i.jsx("th",{className:"drug-name-header",children:"Drug Name"}),i.jsx("th",{className:"brand-name-header",children:"Brand Name"}),i.jsx("th",{className:"pack-header",children:"Pack"}),i.jsx("th",{className:"expiry-header",children:"Expiry"}),i.jsx("th",{className:"text-stock qty-header",children:"Stock"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"Rate"}),i.jsx("th",{className:"box-number-header",children:"Box Number"}),i.jsx("th",{className:"discount-header",children:"Discount (%)"}),i.jsx("th",{className:"margin-header",children:"Margin (%)"}),i.jsx("th",{className:"hidden-loose-price",children:"Loose Price"}),i.jsx("th",{className:"actions-cell",children:"Actions"}),i.jsx("th",{className:"expand-collapse-header"})]})}),i.jsxs("tbody",{children:[r.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:15,children:"No drugs found matching your search."})}),r.map(se=>i.jsxs(i.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const Q=new Set(g);Q.has(se.id)&&se.id!==void 0?Q.delete(se.id):se.id!==void 0&&Q.add(se.id),b(Q)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:Q=>Q.stopPropagation(),checked:z.has(se.id),onChange:()=>{const Q=new Set(z);Q.has(se.id)?Q.delete(se.id):Q.add(se.id),U(Q)}})}),i.jsx("td",{className:"drug-name-cell",children:se.name||"-"}),i.jsx("td",{className:"brand-name-cell",children:se.brand_name||"-"}),i.jsx("td",{className:"text-muted pack-cell",children:se.unit||"-"}),i.jsx("td",{className:"text-muted",children:se.expiry_date?new Date(se.expiry_date).toLocaleDateString():"-"}),i.jsxs("td",{className:`text-stock ${se.quantity_in_stock<=dN?"low-stock":""}`,children:[i.jsxs("div",{children:[se.quantity_in_stock," packs"]}),i.jsx("div",{className:"loose-quantity",children:se.loose!==null&&se.loose!==void 0?`${se.loose} loose`:""})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof se.price=="number"?se.price.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:se.buying_price!==null&&se.buying_price!==void 0?`${se.buying_price.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:se.box_number||"-"}),i.jsx("td",{className:"text-muted",children:se.discount!==null&&se.discount!==void 0?`${se.discount.toFixed(2)}%`:"-"}),i.jsx("td",{className:"text-muted",children:(()=>{const Q=se.price||0,re=se.buying_price||0,je=se.discount||0,Ae=se.gst||0,ot=re*(1-je/100)*(1+Ae/100),mt=Q-ot;return`${(Q>0?mt/Q*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"text-muted hidden-loose-price",children:(()=>{const Q=Ee(se.unit);return Q&&Q>0&&typeof se.price=="number"?`${(se.price/Q).toFixed(2)}`:"N/A"})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:()=>e(`/dashboard/inventory/edit/${se.id}`),className:"action-icon-button",title:"Edit Drug",children:i.jsx(Vd,{size:18})}),i.jsx("button",{onClick:()=>fe(se),className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(Fr,{size:18})}),i.jsx("button",{onClick:()=>{R(se),T(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(sM,{size:18})}),i.jsx("button",{onClick:()=>Pe(se),className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!se.unit||Ee(se.unit)===null,children:i.jsx(UM,{size:18})})]})}),i.jsx("td",{className:"expand-collapse-cell",children:g.has(se.id)?i.jsx(g1,{size:20}):i.jsx(db,{size:20})})]},se.id),g.has(se.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:15,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Drug Name:"})," ",se.name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",se.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",se.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Brand Name:"})," ",se.brand_name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",se.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",se.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",se.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose:"})," ",se.loose!==null&&se.loose!==void 0?se.loose:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const Q=Ee(se.unit);return Q&&Q>0&&typeof se.price=="number"?`${(se.price/Q).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",se.gst!==null&&se.gst!==void 0?`${se.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Discount:"})," ",se.discount!==null&&se.discount!==void 0?`${se.discount.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Calculated Margin:"}),(()=>{const Q=se.price||0,re=se.buying_price||0,je=se.discount||0,Ae=se.gst||0,ot=re*(1-je/100)*(1+Ae/100),mt=Q-ot;return`${(Q>0?mt/Q*100:0).toFixed(2)}%`})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(se.last_updated).toLocaleString()]})]})})})]}))]})]})}),I&&q&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:we,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:q.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:we,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:ie,className:"button-delete",children:"Delete"})]})]})}),E&&L&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:M,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:L.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",L.quantity_in_stock]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("form",{onSubmit:Se,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:G,onChange:de,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:M,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),$&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ve,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ve,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:ve,className:"button-delete",children:"Delete All"})]})]})}),tt&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:xe,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:z.size})," selected drug(s)? This action cannot be undone."]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:xe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Me,className:"button-delete",children:"Delete Selected"})]})]})}),te&&K&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:rt,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert Pack to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:K.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Packs in Stock: ",K.quantity_in_stock??0,i.jsx("br",{}),"Current Loose Units: ",K.loose??0,i.jsx("br",{}),"Pack Size: ",Ee(K.unit)||"N/A"," units per pack"]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("form",{onSubmit:Ze,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packs-to-convert",className:"form-label",children:"Number of Packs to Convert"}),i.jsx("input",{type:"number",name:"packs-to-convert",id:"packs-to-convert",required:!0,min:"1",step:"1",value:J,onChange:lt,placeholder:"e.g., 1",className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["This will reduce pack quantity by ",J," and add ",J*(Ee(K.unit)||0)," to loose quantity."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:rt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert to Loose"})]})]})]})}),A&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:kt,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:kt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:on,className:"button-submit",children:"Add Defaults"})]})]})})]})},RO="_container_1ihgb_1",OO="_title_1ihgb_17",LO="_dateRangeContainer_1ihgb_31",FO="_dateInputLabel_1ihgb_51",$O="_dateInput_1ihgb_51",zO="_fetchButton_1ihgb_87",BO="_sectionTitle_1ihgb_123",UO="_tableContainer_1ihgb_137",qO="_analysisTable_1ihgb_153",VO="_textRight_1ihgb_217",HO="_textGreen_1ihgb_225",GO="_textRed_1ihgb_233",YO="_textOrange_1ihgb_249",WO="_alertBox_1ihgb_265",QO="_alertBoxError_1ihgb_283",JO="_alertBoxIcon_1ihgb_295",KO="_loadingContainer_1ihgb_303",XO="_viewSwitcher_1ihgb_321",ZO="_viewButton_1ihgb_339",eL="_viewButtonActive_1ihgb_365",tL="_viewButtonInactive_1ihgb_383",nL="_reasonDistribution_1ihgb_497",rL="_totalRow_1ihgb_513",qt={container:RO,title:OO,dateRangeContainer:LO,dateInputLabel:FO,dateInput:$O,fetchButton:zO,sectionTitle:BO,tableContainer:UO,analysisTable:qO,textRight:VO,textGreen:HO,textRed:GO,textOrange:YO,alertBox:WO,alertBoxError:QO,alertBoxIcon:JO,loadingContainer:KO,viewSwitcher:XO,viewButton:ZO,viewButtonActive:eL,viewButtonInactive:tL,reasonDistribution:nL,totalRow:rL},x1=()=>{const e=yt(),n=new Date().toISOString().split("T")[0],[t,r]=w.useState(n),[a,s]=w.useState(n),[l,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState("analysis"),S=async()=>{if(d(!0),g(null),f(null),!t||!a){g("Please select both start and end dates."),d(!1);return}if(new Date(t)>new Date(a)){g("Start date cannot be after end date."),d(!1);return}try{const T=h4();if(!T){g("Clinic ID not found. Please log in again."),d(!1);return}const I=await ge(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${T}`);if(!I.ok){const q=await I.json();throw new Error(q.message||`HTTP error! status: ${I.status}`)}const D=await I.json();f(D)}catch(T){console.error("Failed to fetch comprehensive inventory analysis data:",T),g(T.message||"Failed to fetch data. Check console for details.")}finally{d(!1)}},k=()=>{S()},E=T=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(T);return i.jsxs("div",{className:qt.container,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[" ",i.jsx("h2",{className:qt.title,children:"Inventory Analysis & Management"}),i.jsx("button",{onClick:()=>e(-1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 text-sm",children:"Back"})]}),i.jsxs("div",{className:qt.viewSwitcher,children:[i.jsxs("button",{onClick:()=>v("analysis"),className:`${qt.viewButton} ${b==="analysis"?qt.viewButtonActive:qt.viewButtonInactive}`,children:[i.jsx(KI,{size:16})," ","Analysis"]}),i.jsxs("button",{onClick:()=>v("labInventory"),className:`${qt.viewButton} ${b==="labInventory"?qt.viewButtonActive:qt.viewButtonInactive}`,children:[i.jsx(Pw,{size:16}),"Lab Test Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:`${qt.viewButton} ${b==="pharmacyInventory"?qt.viewButtonActive:qt.viewButtonInactive}`,children:[i.jsx(Ll,{size:16}),"Pharmacy Inventory"]})]}),b==="analysis"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:qt.dateRangeContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-inventory",className:qt.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-inventory",value:t,onChange:T=>r(T.target.value),className:qt.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-inventory",className:qt.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-inventory",value:a,onChange:T=>s(T.target.value),className:qt.dateInput})]}),i.jsx("button",{onClick:k,disabled:u,className:qt.fetchButton,children:u?"Loading...":"Fetch Comprehensive Analysis"})]}),h&&i.jsxs("div",{className:`${qt.alertBox} ${qt.alertBoxError}`,role:"alert",children:[i.jsx("div",{className:qt.alertBoxIcon,children:i.jsx(rr,{size:18})}),i.jsxs("div",{children:[" ",i.jsxs("span",{children:["Error: ",h]})]})]}),u&&i.jsxs("div",{className:qt.loadingContainer,children:[" ",i.jsx("p",{children:"Loading data..."})]}),l&&!u&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:qt.sectionTitle,children:["Pharmacy Inventory Changes (",l.startDate," to ",l.endDate,")"]}),l.pharmacyAnalysis.length>0?i.jsx("div",{className:qt.tableContainer,children:i.jsxs("table",{className:qt.analysisTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Drug Name"}),i.jsx("th",{children:"Unit"}),i.jsx("th",{className:qt.textRight,children:"Price"}),i.jsx("th",{children:"Qty In (+)"}),i.jsx("th",{className:qt.textRight,children:"Packs Out (-)"}),i.jsx("th",{className:qt.textRight,children:"Loose Qty Out (-)"}),i.jsx("th",{className:qt.textRight,children:"Packs Converted"})]})}),i.jsx("tbody",{children:l.pharmacyAnalysis.map(T=>i.jsxs("tr",{children:[i.jsx("td",{children:T.name}),i.jsx("td",{children:T.unit||"N/A"}),i.jsx("td",{className:qt.textRight,children:E(T.price)}),i.jsxs("td",{className:qt.textGreen,children:[" ",i.jsxs("div",{className:qt.reasonDistribution,children:[Object.entries(T.quantity_in_by_reason).map(([I,D])=>i.jsxs("div",{children:[i.jsxs("span",{children:[I,":"]}),i.jsx("span",{children:D})]},I)),Object.keys(T.quantity_in_by_reason).length>0&&i.jsxs("div",{className:qt.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:T.quantity_in})]})]})]}),i.jsxs("td",{className:qt.textRed,children:[" ",i.jsxs("div",{className:qt.reasonDistribution,children:[Object.entries(T.quantity_out_by_reason||{}).map(([I,D])=>i.jsxs("div",{children:[i.jsxs("span",{children:[I,":"]}),i.jsx("span",{children:D})]},I)),Object.keys(T.quantity_out_by_reason||{}).length>0&&i.jsxs("div",{className:qt.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:T.quantity_out})]}),(!T.quantity_out_by_reason||Object.keys(T.quantity_out_by_reason).length===0)&&i.jsx("div",{className:qt.textRight,children:T.quantity_out})]})]}),i.jsx("td",{className:`${qt.textRed} ${qt.textRight}`,children:T.loose_quantity_out}),i.jsx("td",{className:`${qt.textOrange} ${qt.textRight}`,children:T.quantity_converted})]},T.drug_id))})]})}):i.jsx("p",{className:"text-gray-500",children:"No pharmacy inventory changes found for the selected period."})]})]})]}),b==="labInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(Iw,{})]}),b==="pharmacyInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(q2,{})]})]})};var mv,fN;function iL(){if(fN)return mv;fN=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt,u=typeof Jc=="object"&&Jc&&Jc.Object===Object&&Jc,d=typeof self=="object"&&self&&self.Object===Object&&self,h=u||d||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return h.Date.now()};function E(F,$,B){var z,U,L,R,G,ee,te=0,oe=!1,K=!1,V=!0;if(typeof F!="function")throw new TypeError(e);$=q($)||0,T(B)&&(oe=!!B.leading,K="maxWait"in B,L=K?v(q(B.maxWait)||0,$):L,V="trailing"in B?!!B.trailing:V);function J(we){var ie=z,_e=U;return z=U=void 0,te=we,R=F.apply(_e,ie),R}function ne(we){return te=we,G=setTimeout(ce,$),oe?J(we):R}function A(we){var ie=we-ee,_e=we-te,Ve=$-ie;return K?S(Ve,L-_e):Ve}function ae(we){var ie=we-ee,_e=we-te;return ee===void 0||ie>=$||ie<0||K&&_e>=L}function ce(){var we=k();if(ae(we))return M(we);G=setTimeout(ce,A(we))}function M(we){return G=void 0,V&&z?J(we):(z=U=void 0,R)}function de(){G!==void 0&&clearTimeout(G),te=0,z=ee=U=G=void 0}function Se(){return G===void 0?R:M(k())}function fe(){var we=k(),ie=ae(we);if(z=arguments,U=this,ee=we,ie){if(G===void 0)return ne(ee);if(K)return G=setTimeout(ce,$),J(ee)}return G===void 0&&(G=setTimeout(ce,$)),R}return fe.cancel=de,fe.flush=Se,fe}function T(F){var $=typeof F;return!!F&&($=="object"||$=="function")}function I(F){return!!F&&typeof F=="object"}function D(F){return typeof F=="symbol"||I(F)&&b.call(F)==t}function q(F){if(typeof F=="number")return F;if(D(F))return n;if(T(F)){var $=typeof F.valueOf=="function"?F.valueOf():F;F=T($)?$+"":$}if(typeof F!="string")return F===0?F:+F;F=F.replace(r,"");var B=s.test(F);return B||l.test(F)?f(F.slice(2),B?2:8):a.test(F)?n:+F}return mv=E,mv}var aL=iL();const qb=Qd(aL),Mw=async()=>{const e=await ge("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},sL=async e=>{const n=await ge(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},oL=async e=>{const n=await ge(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},lL=async e=>{const n=await ge(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},cL=async e=>{const n=await ge("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},uL=async(e,n)=>{const t=await ge(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},dL=async e=>{const n=await ge(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},fL=async e=>{const n=await ge("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},hL=async()=>{try{const e=await ge("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},V2=async()=>{const e=await ge("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()};var gv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var hN;function pL(){return hN||(hN=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var s="",l=0;l<arguments.length;l++){var f=arguments[l];f&&(s=a(s,r(f)))}return s}function r(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var l="";for(var f in s)n.call(s,f)&&s[f]&&(l=a(l,f));return l}function a(s,l){return l?s?s+" "+l:s+l:s}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(gv)),gv.exports}var mL=pL();const Kc=Qd(mL);function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Hd(e)}function gL(e,n){if(Hd(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(Hd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function H2(e){var n=gL(e,"string");return Hd(n)=="symbol"?n:n+""}function Km(e,n,t){return(n=H2(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function pN(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function jt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?pN(Object(t),!0).forEach(function(r){Km(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pN(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function yL(e){if(Array.isArray(e))return e}function xL(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,s,l,f=[],u=!0,d=!1;try{if(s=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=s.call(t)).done)&&(f.push(r.value),f.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(d)throw a}}return f}}function b1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function G2(e,n){if(e){if(typeof e=="string")return b1(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?b1(e,n):void 0}}function bL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rl(e,n){return yL(e)||xL(e,n)||G2(e,n)||bL()}function vL(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Bl(e,n){if(e==null)return{};var t,r,a=vL(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var wL=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function SL(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,s=e.defaultValue,l=s===void 0?null:s,f=e.inputValue,u=e.menuIsOpen,d=e.onChange,h=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=Bl(e,wL),k=w.useState(f!==void 0?f:t),E=Rl(k,2),T=E[0],I=E[1],D=w.useState(u!==void 0?u:a),q=Rl(D,2),F=q[0],$=q[1],B=w.useState(v!==void 0?v:l),z=Rl(B,2),U=z[0],L=z[1],R=w.useCallback(function(J,ne){typeof d=="function"&&d(J,ne),L(J)},[d]),G=w.useCallback(function(J,ne){var A;typeof h=="function"&&(A=h(J,ne)),I(A!==void 0?A:J)},[h]),ee=w.useCallback(function(){typeof b=="function"&&b(),$(!0)},[b]),te=w.useCallback(function(){typeof g=="function"&&g(),$(!1)},[g]),oe=f!==void 0?f:T,K=u!==void 0?u:F,V=v!==void 0?v:U;return jt(jt({},S),{},{inputValue:oe,menuIsOpen:K,onChange:R,onInputChange:G,onMenuClose:te,onMenuOpen:ee,value:V})}function At(){return At=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},At.apply(null,arguments)}function NL(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function mN(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,H2(r.key),r)}}function CL(e,n,t){return n&&mN(e.prototype,n),t&&mN(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function v1(e,n){return v1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},v1(e,n)}function jL(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&v1(e,n)}function yb(e){return yb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},yb(e)}function Y2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Y2=function(){return!!e})()}function _L(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kL(e,n){if(n&&(Hd(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _L(e)}function EL(e){var n=Y2();return function(){var t,r=yb(e);if(n){var a=yb(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return kL(this,t)}}function TL(e){if(Array.isArray(e))return b1(e)}function AL(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PL(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rw(e){return TL(e)||AL(e)||G2(e)||PL()}function DL(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function IL(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var ML=function(){function e(t){var r=this;this._insertTag=function(a){var s;r.tags.length===0?r.insertionPoint?s=r.insertionPoint.nextSibling:r.prepend?s=r.container.firstChild:s=r.before:s=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,s),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(IL(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var s=DL(a);try{s.insertRule(r,s.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Ci="-ms-",xb="-moz-",Nn="-webkit-",W2="comm",Ow="rule",Lw="decl",RL="@import",Q2="@keyframes",OL="@layer",LL=Math.abs,Vb=String.fromCharCode,FL=Object.assign;function $L(e,n){return si(e,0)^45?(((n<<2^si(e,0))<<2^si(e,1))<<2^si(e,2))<<2^si(e,3):0}function J2(e){return e.trim()}function zL(e,n){return(e=n.exec(e))?e[0]:e}function Cn(e,n,t){return e.replace(n,t)}function w1(e,n){return e.indexOf(n)}function si(e,n){return e.charCodeAt(n)|0}function ug(e,n,t){return e.slice(n,t)}function $o(e){return e.length}function Fw(e){return e.length}function Ex(e,n){return n.push(e),e}function BL(e,n){return e.map(n).join("")}var Hb=1,zh=1,K2=0,ca=0,Ir=0,Wh="";function Gb(e,n,t,r,a,s,l){return{value:e,root:n,parent:t,type:r,props:a,children:s,line:Hb,column:zh,length:l,return:""}}function zm(e,n){return FL(Gb("",null,null,"",null,null,0),e,{length:-e.length},n)}function UL(){return Ir}function qL(){return Ir=ca>0?si(Wh,--ca):0,zh--,Ir===10&&(zh=1,Hb--),Ir}function Fa(){return Ir=ca<K2?si(Wh,ca++):0,zh++,Ir===10&&(zh=1,Hb++),Ir}function Vo(){return si(Wh,ca)}function Kx(){return ca}function wg(e,n){return ug(Wh,e,n)}function dg(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function X2(e){return Hb=zh=1,K2=$o(Wh=e),ca=0,[]}function Z2(e){return Wh="",e}function Xx(e){return J2(wg(ca-1,S1(e===91?e+2:e===40?e+1:e)))}function VL(e){for(;(Ir=Vo())&&Ir<33;)Fa();return dg(e)>2||dg(Ir)>3?"":" "}function HL(e,n){for(;--n&&Fa()&&!(Ir<48||Ir>102||Ir>57&&Ir<65||Ir>70&&Ir<97););return wg(e,Kx()+(n<6&&Vo()==32&&Fa()==32))}function S1(e){for(;Fa();)switch(Ir){case e:return ca;case 34:case 39:e!==34&&e!==39&&S1(Ir);break;case 40:e===41&&S1(e);break;case 92:Fa();break}return ca}function GL(e,n){for(;Fa()&&e+Ir!==57;)if(e+Ir===84&&Vo()===47)break;return"/*"+wg(n,ca-1)+"*"+Vb(e===47?e:Fa())}function YL(e){for(;!dg(Vo());)Fa();return wg(e,ca)}function WL(e){return Z2(Zx("",null,null,null,[""],e=X2(e),0,[0],e))}function Zx(e,n,t,r,a,s,l,f,u){for(var d=0,h=0,g=l,b=0,v=0,S=0,k=1,E=1,T=1,I=0,D="",q=a,F=s,$=r,B=D;E;)switch(S=I,I=Fa()){case 40:if(S!=108&&si(B,g-1)==58){w1(B+=Cn(Xx(I),"&","&\f"),"&\f")!=-1&&(T=-1);break}case 34:case 39:case 91:B+=Xx(I);break;case 9:case 10:case 13:case 32:B+=VL(S);break;case 92:B+=HL(Kx()-1,7);continue;case 47:switch(Vo()){case 42:case 47:Ex(QL(GL(Fa(),Kx()),n,t),u);break;default:B+="/"}break;case 123*k:f[d++]=$o(B)*T;case 125*k:case 59:case 0:switch(I){case 0:case 125:E=0;case 59+h:T==-1&&(B=Cn(B,/\f/g,"")),v>0&&$o(B)-g&&Ex(v>32?yN(B+";",r,t,g-1):yN(Cn(B," ","")+";",r,t,g-2),u);break;case 59:B+=";";default:if(Ex($=gN(B,n,t,d,h,a,f,D,q=[],F=[],g),s),I===123)if(h===0)Zx(B,n,$,$,q,s,g,f,F);else switch(b===99&&si(B,3)===110?100:b){case 100:case 108:case 109:case 115:Zx(e,$,$,r&&Ex(gN(e,$,$,0,0,a,f,D,a,q=[],g),F),a,F,g,f,r?q:F);break;default:Zx(B,$,$,$,[""],F,0,f,F)}}d=h=v=0,k=T=1,D=B="",g=l;break;case 58:g=1+$o(B),v=S;default:if(k<1){if(I==123)--k;else if(I==125&&k++==0&&qL()==125)continue}switch(B+=Vb(I),I*k){case 38:T=h>0?1:(B+="\f",-1);break;case 44:f[d++]=($o(B)-1)*T,T=1;break;case 64:Vo()===45&&(B+=Xx(Fa())),b=Vo(),h=g=$o(D=B+=YL(Kx())),I++;break;case 45:S===45&&$o(B)==2&&(k=0)}}return s}function gN(e,n,t,r,a,s,l,f,u,d,h){for(var g=a-1,b=a===0?s:[""],v=Fw(b),S=0,k=0,E=0;S<r;++S)for(var T=0,I=ug(e,g+1,g=LL(k=l[S])),D=e;T<v;++T)(D=J2(k>0?b[T]+" "+I:Cn(I,/&\f/g,b[T])))&&(u[E++]=D);return Gb(e,n,t,a===0?Ow:f,u,d,h)}function QL(e,n,t){return Gb(e,n,t,W2,Vb(UL()),ug(e,2,-2),0)}function yN(e,n,t,r){return Gb(e,n,t,Lw,ug(e,0,r),ug(e,r+1,-1),r)}function Ih(e,n){for(var t="",r=Fw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function JL(e,n,t,r){switch(e.type){case OL:if(e.children.length)break;case RL:case Lw:return e.return=e.return||e.value;case W2:return"";case Q2:return e.return=e.value+"{"+Ih(e.children,r)+"}";case Ow:e.value=e.props.join(",")}return $o(t=Ih(e.children,r))?e.return=e.value+"{"+t+"}":""}function KL(e){var n=Fw(e);return function(t,r,a,s){for(var l="",f=0;f<n;f++)l+=e[f](t,r,a,s)||"";return l}}function XL(e){return function(n){n.root||(n=n.return)&&e(n)}}function ZL(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var e3=function(n,t,r){for(var a=0,s=0;a=s,s=Vo(),a===38&&s===12&&(t[r]=1),!dg(s);)Fa();return wg(n,ca)},t3=function(n,t){var r=-1,a=44;do switch(dg(a)){case 0:a===38&&Vo()===12&&(t[r]=1),n[r]+=e3(ca-1,t,r);break;case 2:n[r]+=Xx(a);break;case 4:if(a===44){n[++r]=Vo()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Vb(a)}while(a=Fa());return n},n3=function(n,t){return Z2(t3(X2(n),t))},xN=new WeakMap,r3=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!xN.get(r))&&!a){xN.set(n,!0);for(var s=[],l=n3(t,s),f=r.props,u=0,d=0;u<l.length;u++)for(var h=0;h<f.length;h++,d++)n.props[d]=s[u]?l[u].replace(/&\f/g,f[h]):f[h]+" "+l[u]}}},i3=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function ek(e,n){switch($L(e,n)){case 5103:return Nn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Nn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Nn+e+xb+e+Ci+e+e;case 6828:case 4268:return Nn+e+Ci+e+e;case 6165:return Nn+e+Ci+"flex-"+e+e;case 5187:return Nn+e+Cn(e,/(\w+).+(:[^]+)/,Nn+"box-$1$2"+Ci+"flex-$1$2")+e;case 5443:return Nn+e+Ci+"flex-item-"+Cn(e,/flex-|-self/,"")+e;case 4675:return Nn+e+Ci+"flex-line-pack"+Cn(e,/align-content|flex-|-self/,"")+e;case 5548:return Nn+e+Ci+Cn(e,"shrink","negative")+e;case 5292:return Nn+e+Ci+Cn(e,"basis","preferred-size")+e;case 6060:return Nn+"box-"+Cn(e,"-grow","")+Nn+e+Ci+Cn(e,"grow","positive")+e;case 4554:return Nn+Cn(e,/([^-])(transform)/g,"$1"+Nn+"$2")+e;case 6187:return Cn(Cn(Cn(e,/(zoom-|grab)/,Nn+"$1"),/(image-set)/,Nn+"$1"),e,"")+e;case 5495:case 3959:return Cn(e,/(image-set\([^]*)/,Nn+"$1$`$1");case 4968:return Cn(Cn(e,/(.+:)(flex-)?(.*)/,Nn+"box-pack:$3"+Ci+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Nn+e+e;case 4095:case 3583:case 4068:case 2532:return Cn(e,/(.+)-inline(.+)/,Nn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if($o(e)-1-n>6)switch(si(e,n+1)){case 109:if(si(e,n+4)!==45)break;case 102:return Cn(e,/(.+:)(.+)-([^]+)/,"$1"+Nn+"$2-$3$1"+xb+(si(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~w1(e,"stretch")?ek(Cn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(si(e,n+1)!==115)break;case 6444:switch(si(e,$o(e)-3-(~w1(e,"!important")&&10))){case 107:return Cn(e,":",":"+Nn)+e;case 101:return Cn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Nn+(si(e,14)===45?"inline-":"")+"box$3$1"+Nn+"$2$3$1"+Ci+"$2box$3")+e}break;case 5936:switch(si(e,n+11)){case 114:return Nn+e+Ci+Cn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Nn+e+Ci+Cn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Nn+e+Ci+Cn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Nn+e+Ci+e+e}return e}var a3=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case Lw:n.return=ek(n.value,n.length);break;case Q2:return Ih([zm(n,{value:Cn(n.value,"@","@"+Nn)})],a);case Ow:if(n.length)return BL(n.props,function(s){switch(zL(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ih([zm(n,{props:[Cn(s,/:(read-\w+)/,":"+xb+"$1")]})],a);case"::placeholder":return Ih([zm(n,{props:[Cn(s,/:(plac\w+)/,":"+Nn+"input-$1")]}),zm(n,{props:[Cn(s,/:(plac\w+)/,":"+xb+"$1")]}),zm(n,{props:[Cn(s,/:(plac\w+)/,Ci+"input-$1")]})],a)}return""})}},s3=[a3],o3=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var E=k.getAttribute("data-emotion");E.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||s3,s={},l,f=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var E=k.getAttribute("data-emotion").split(" "),T=1;T<E.length;T++)s[E[T]]=!0;f.push(k)});var u,d=[r3,i3];{var h,g=[JL,XL(function(k){h.insert(k)})],b=KL(d.concat(a,g)),v=function(E){return Ih(WL(E),b)};u=function(E,T,I,D){h=I,v(E?E+"{"+T.styles+"}":T.styles),D&&(S.inserted[T.name]=!0)}}var S={key:t,sheet:new ML({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:s,registered:{},insert:u};return S.sheet.hydrate(f),S},yv={exports:{}},Tn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN;function l3(){if(bN)return Tn;bN=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,f=e?Symbol.for("react.context"):60110,u=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,E=e?Symbol.for("react.fundamental"):60117,T=e?Symbol.for("react.responder"):60118,I=e?Symbol.for("react.scope"):60119;function D(F){if(typeof F=="object"&&F!==null){var $=F.$$typeof;switch($){case n:switch(F=F.type,F){case u:case d:case r:case s:case a:case g:return F;default:switch(F=F&&F.$$typeof,F){case f:case h:case S:case v:case l:return F;default:return $}}case t:return $}}}function q(F){return D(F)===d}return Tn.AsyncMode=u,Tn.ConcurrentMode=d,Tn.ContextConsumer=f,Tn.ContextProvider=l,Tn.Element=n,Tn.ForwardRef=h,Tn.Fragment=r,Tn.Lazy=S,Tn.Memo=v,Tn.Portal=t,Tn.Profiler=s,Tn.StrictMode=a,Tn.Suspense=g,Tn.isAsyncMode=function(F){return q(F)||D(F)===u},Tn.isConcurrentMode=q,Tn.isContextConsumer=function(F){return D(F)===f},Tn.isContextProvider=function(F){return D(F)===l},Tn.isElement=function(F){return typeof F=="object"&&F!==null&&F.$$typeof===n},Tn.isForwardRef=function(F){return D(F)===h},Tn.isFragment=function(F){return D(F)===r},Tn.isLazy=function(F){return D(F)===S},Tn.isMemo=function(F){return D(F)===v},Tn.isPortal=function(F){return D(F)===t},Tn.isProfiler=function(F){return D(F)===s},Tn.isStrictMode=function(F){return D(F)===a},Tn.isSuspense=function(F){return D(F)===g},Tn.isValidElementType=function(F){return typeof F=="string"||typeof F=="function"||F===r||F===d||F===s||F===a||F===g||F===b||typeof F=="object"&&F!==null&&(F.$$typeof===S||F.$$typeof===v||F.$$typeof===l||F.$$typeof===f||F.$$typeof===h||F.$$typeof===E||F.$$typeof===T||F.$$typeof===I||F.$$typeof===k)},Tn.typeOf=D,Tn}var vN;function c3(){return vN||(vN=1,yv.exports=l3()),yv.exports}var xv,wN;function u3(){if(wN)return xv;wN=1;var e=c3(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};s[e.ForwardRef]=r,s[e.Memo]=a;function l(S){return e.isMemo(S)?a:s[S.$$typeof]||n}var f=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,E){if(typeof k!="string"){if(b){var T=g(k);T&&T!==b&&v(S,T,E)}var I=u(k);d&&(I=I.concat(d(k)));for(var D=l(S),q=l(k),F=0;F<I.length;++F){var $=I[F];if(!t[$]&&!(E&&E[$])&&!(q&&q[$])&&!(D&&D[$])){var B=h(k,$);try{f(S,$,B)}catch{}}}}return S}return xv=v,xv}u3();var d3=!0;function f3(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var tk=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||d3===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},h3=function(n,t,r){tk(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var s=t;do n.insert(t===s?"."+a:"",s,n.sheet,!0),s=s.next;while(s!==void 0)}};function p3(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var m3={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},g3=/[A-Z]|^ms/g,y3=/_EMO_([^_]+?)_([^]*?)_EMO_/g,nk=function(n){return n.charCodeAt(1)===45},SN=function(n){return n!=null&&typeof n!="boolean"},bv=ZL(function(e){return nk(e)?e:e.replace(g3,"-$&").toLowerCase()}),NN=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(y3,function(r,a,s){return zo={name:a,styles:s,next:zo},a})}return m3[n]!==1&&!nk(n)&&typeof t=="number"&&t!==0?t+"px":t};function fg(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return zo={name:a.name,styles:a.styles,next:zo},a.name;var s=t;if(s.styles!==void 0){var l=s.next;if(l!==void 0)for(;l!==void 0;)zo={name:l.name,styles:l.styles,next:zo},l=l.next;var f=s.styles+";";return f}return x3(e,n,t)}case"function":{if(e!==void 0){var u=zo,d=t(e);return zo=u,fg(e,n,d)}break}}var h=t;return h}function x3(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=fg(e,n,t[a])+";";else for(var s in t){var l=t[s];if(typeof l!="object"){var f=l;SN(f)&&(r+=bv(s)+":"+NN(s,f)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var u=0;u<l.length;u++)SN(l[u])&&(r+=bv(s)+":"+NN(s,l[u])+";");else{var d=fg(e,n,l);switch(s){case"animation":case"animationName":{r+=bv(s)+":"+d+";";break}default:r+=s+"{"+d+"}"}}}return r}var CN=/label:\s*([^\s;{]+)\s*(;|$)/g,zo;function rk(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";zo=void 0;var s=e[0];if(s==null||s.raw===void 0)r=!1,a+=fg(t,n,s);else{var l=s;a+=l[0]}for(var f=1;f<e.length;f++)if(a+=fg(t,n,e[f]),r){var u=s;a+=u[f]}CN.lastIndex=0;for(var d="",h;(h=CN.exec(a))!==null;)d+="-"+h[1];var g=p3(a)+d;return{name:g,styles:a,next:zo}}var b3=function(n){return n()},v3=LS.useInsertionEffect?LS.useInsertionEffect:!1,w3=v3||b3,ik=w.createContext(typeof HTMLElement<"u"?o3({key:"css"}):null);ik.Provider;var S3=function(n){return w.forwardRef(function(t,r){var a=w.useContext(ik);return n(t,a,r)})},N3=w.createContext({}),$w={}.hasOwnProperty,N1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",C3=function(n,t){var r={};for(var a in t)$w.call(t,a)&&(r[a]=t[a]);return r[N1]=n,r},j3=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return tk(t,r,a),w3(function(){return h3(t,r,a)}),null},_3=S3(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[N1],s=[r],l="";typeof e.className=="string"?l=f3(n.registered,s,e.className):e.className!=null&&(l=e.className+" ");var f=rk(s,void 0,w.useContext(N3));l+=n.key+"-"+f.name;var u={};for(var d in e)$w.call(e,d)&&d!=="css"&&d!==N1&&(u[d]=e[d]);return u.className=l,t&&(u.ref=t),w.createElement(w.Fragment,null,w.createElement(j3,{cache:n,serialized:f,isStringTag:typeof a=="string"}),w.createElement(a,u))}),k3=_3,vt=function(n,t){var r=arguments;if(t==null||!$w.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,s=new Array(a);s[0]=k3,s[1]=C3(n,t);for(var l=2;l<a;l++)s[l]=r[l];return w.createElement.apply(null,s)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(vt||(vt={}));function zw(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return rk(n)}function E3(){var e=zw.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function T3(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const A3=Math.min,P3=Math.max,bb=Math.round,Tx=Math.floor,vb=e=>({x:e,y:e});function D3(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function Yb(){return typeof window<"u"}function ak(e){return ok(e)?(e.nodeName||"").toLowerCase():"#document"}function $l(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function sk(e){var n;return(n=(ok(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function ok(e){return Yb()?e instanceof Node||e instanceof $l(e).Node:!1}function I3(e){return Yb()?e instanceof Element||e instanceof $l(e).Element:!1}function Bw(e){return Yb()?e instanceof HTMLElement||e instanceof $l(e).HTMLElement:!1}function jN(e){return!Yb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof $l(e).ShadowRoot}const M3=new Set(["inline","contents"]);function lk(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Uw(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!M3.has(a)}function R3(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const O3=new Set(["html","body","#document"]);function L3(e){return O3.has(ak(e))}function Uw(e){return $l(e).getComputedStyle(e)}function F3(e){if(ak(e)==="html")return e;const n=e.assignedSlot||e.parentNode||jN(e)&&e.host||sk(e);return jN(n)?n.host:n}function ck(e){const n=F3(e);return L3(n)?e.ownerDocument?e.ownerDocument.body:e.body:Bw(n)&&lk(n)?n:ck(n)}function wb(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=ck(e),s=a===((r=e.ownerDocument)==null?void 0:r.body),l=$l(a);if(s){const f=C1(l);return n.concat(l,l.visualViewport||[],lk(a)?a:[],f&&t?wb(f):[])}return n.concat(a,wb(a,[],t))}function C1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function $3(e){const n=Uw(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Bw(e),s=a?e.offsetWidth:t,l=a?e.offsetHeight:r,f=bb(t)!==s||bb(r)!==l;return f&&(t=s,r=l),{width:t,height:r,$:f}}function qw(e){return I3(e)?e:e.contextElement}function _N(e){const n=qw(e);if(!Bw(n))return vb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:s}=$3(n);let l=(s?bb(t.width):t.width)/r,f=(s?bb(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!f||!Number.isFinite(f))&&(f=1),{x:l,y:f}}const z3=vb(0);function B3(e){const n=$l(e);return!R3()||!n.visualViewport?z3:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function U3(e,n,t){return!1}function kN(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),s=qw(e);let l=vb(1);n&&(l=_N(e));const f=U3()?B3(s):vb(0);let u=(a.left+f.x)/l.x,d=(a.top+f.y)/l.y,h=a.width/l.x,g=a.height/l.y;if(s){const b=$l(s),v=r;let S=b,k=C1(S);for(;k&&r&&v!==S;){const E=_N(k),T=k.getBoundingClientRect(),I=Uw(k),D=T.left+(k.clientLeft+parseFloat(I.paddingLeft))*E.x,q=T.top+(k.clientTop+parseFloat(I.paddingTop))*E.y;u*=E.x,d*=E.y,h*=E.x,g*=E.y,u+=D,d+=q,S=$l(k),k=C1(S)}}return D3({width:h,height:g,x:u,y:d})}function uk(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function q3(e,n){let t=null,r;const a=sk(e);function s(){var f;clearTimeout(r),(f=t)==null||f.disconnect(),t=null}function l(f,u){f===void 0&&(f=!1),u===void 0&&(u=1),s();const d=e.getBoundingClientRect(),{left:h,top:g,width:b,height:v}=d;if(f||n(),!b||!v)return;const S=Tx(g),k=Tx(a.clientWidth-(h+b)),E=Tx(a.clientHeight-(g+v)),T=Tx(h),D={rootMargin:-S+"px "+-k+"px "+-E+"px "+-T+"px",threshold:P3(0,A3(1,u))||1};let q=!0;function F($){const B=$[0].intersectionRatio;if(B!==u){if(!q)return l();B?l(!1,B):r=setTimeout(()=>{l(!1,1e-7)},1e3)}B===1&&!uk(d,e.getBoundingClientRect())&&l(),q=!1}try{t=new IntersectionObserver(F,{...D,root:a.ownerDocument})}catch{t=new IntersectionObserver(F,D)}t.observe(e)}return l(!0),s}function V3(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:f=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,d=qw(e),h=a||s?[...d?wb(d):[],...wb(n)]:[];h.forEach(T=>{a&&T.addEventListener("scroll",t,{passive:!0}),s&&T.addEventListener("resize",t)});const g=d&&f?q3(d,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(T=>{let[I]=T;I&&I.target===d&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var D;(D=v)==null||D.observe(n)})),t()}),d&&!u&&v.observe(d),v.observe(n));let S,k=u?kN(e):null;u&&E();function E(){const T=kN(e);k&&!uk(k,T)&&t(),k=T,S=requestAnimationFrame(E)}return t(),()=>{var T;h.forEach(I=>{a&&I.removeEventListener("scroll",t),s&&I.removeEventListener("resize",t)}),g==null||g(),(T=v)==null||T.disconnect(),v=null,u&&cancelAnimationFrame(S)}}var j1=w.useLayoutEffect,H3=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Sb=function(){};function G3(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function Y3(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var s=[].concat(r);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&s.push("".concat(G3(e,l)));return s.filter(function(f){return f}).map(function(f){return String(f).trim()}).join(" ")}var EN=function(n){return nF(n)?n.filter(Boolean):Hd(n)==="object"&&n!==null?[n]:[]},dk=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=Bl(n,H3);return jt({},t)},gr=function(n,t,r){var a=n.cx,s=n.getStyles,l=n.getClassNames,f=n.className;return{css:s(t,n),className:a(r??{},l(t,n),f)}};function Wb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function W3(e){return Wb(e)?window.innerHeight:e.clientHeight}function fk(e){return Wb(e)?window.pageYOffset:e.scrollTop}function Nb(e,n){if(Wb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function Q3(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function J3(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function Ax(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Sb,a=fk(e),s=n-a,l=10,f=0;function u(){f+=l;var d=J3(f,a,s,t);Nb(e,d),f<t?window.requestAnimationFrame(u):r(e)}u()}function TN(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?Nb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&Nb(e,Math.max(n.offsetTop-a,0))}function K3(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function AN(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function X3(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var hk=!1,Z3={get passive(){return hk=!0}},Px=typeof window<"u"?window:{};Px.addEventListener&&Px.removeEventListener&&(Px.addEventListener("p",Sb,Z3),Px.removeEventListener("p",Sb,!1));var eF=hk;function tF(e){return e!=null}function nF(e){return Array.isArray(e)}function Dx(e,n,t){return e?n:t}var rF=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var s=Object.entries(n).filter(function(l){var f=Rl(l,1),u=f[0];return!r.includes(u)});return s.reduce(function(l,f){var u=Rl(f,2),d=u[0],h=u[1];return l[d]=h,l},{})},iF=["children","innerProps"],aF=["children","innerProps"];function sF(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,s=e.shouldScroll,l=e.isFixedPosition,f=e.controlHeight,u=Q3(t),d={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return d;var h=u.getBoundingClientRect(),g=h.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,E=t.offsetParent.getBoundingClientRect(),T=E.top,I=l?window.innerHeight:W3(u),D=fk(u),q=parseInt(getComputedStyle(t).marginBottom,10),F=parseInt(getComputedStyle(t).marginTop,10),$=T-F,B=I-k,z=$+D,U=g-D-k,L=v-I+D+q,R=D+k-F,G=160;switch(a){case"auto":case"bottom":if(B>=S)return{placement:"bottom",maxHeight:n};if(U>=S&&!l)return s&&Ax(u,L,G),{placement:"bottom",maxHeight:n};if(!l&&U>=r||l&&B>=r){s&&Ax(u,L,G);var ee=l?B-q:U-q;return{placement:"bottom",maxHeight:ee}}if(a==="auto"||l){var te=n,oe=l?$:z;return oe>=r&&(te=Math.min(oe-q-f,n)),{placement:"top",maxHeight:te}}if(a==="bottom")return s&&Nb(u,L),{placement:"bottom",maxHeight:n};break;case"top":if($>=S)return{placement:"top",maxHeight:n};if(z>=S&&!l)return s&&Ax(u,R,G),{placement:"top",maxHeight:n};if(!l&&z>=r||l&&$>=r){var K=n;return(!l&&z>=r||l&&$>=r)&&(K=l?$-F:z-F),s&&Ax(u,R,G),{placement:"top",maxHeight:K}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return d}function oF(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var pk=function(n){return n==="auto"?"bottom":n},lF=function(n,t){var r,a=n.placement,s=n.theme,l=s.borderRadius,f=s.spacing,u=s.colors;return jt((r={label:"menu"},Km(r,oF(a),"100%"),Km(r,"position","absolute"),Km(r,"width","100%"),Km(r,"zIndex",1),r),t?{}:{backgroundColor:u.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:f.menuGutter,marginTop:f.menuGutter})},mk=w.createContext(null),cF=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,s=n.menuPlacement,l=n.menuPosition,f=n.menuShouldScrollIntoView,u=n.theme,d=w.useContext(mk)||{},h=d.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=Rl(b,2),S=v[0],k=v[1],E=w.useState(null),T=Rl(E,2),I=T[0],D=T[1],q=u.spacing.controlHeight;return j1(function(){var F=g.current;if(F){var $=l==="fixed",B=f&&!$,z=sF({maxHeight:a,menuEl:F,minHeight:r,placement:s,shouldScroll:B,isFixedPosition:$,controlHeight:q});k(z.maxHeight),D(z.placement),h==null||h(z.placement)}},[a,s,l,f,r,h,q]),t({ref:g,placerProps:jt(jt({},n),{},{placement:I||pk(s),maxHeight:S})})},uF=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return vt("div",At({},gr(n,"menu",{menu:!0}),{ref:r},a),t)},dF=uF,fF=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return jt({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},hF=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,s=n.isMulti;return vt("div",At({},gr(n,"menuList",{"menu-list":!0,"menu-list--is-multi":s}),{ref:a},r),t)},gk=function(n,t){var r=n.theme,a=r.spacing.baseUnit,s=r.colors;return jt({textAlign:"center"},t?{}:{color:s.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},pF=gk,mF=gk,gF=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,s=Bl(n,iF);return vt("div",At({},gr(jt(jt({},s),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},yF=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,s=Bl(n,aF);return vt("div",At({},gr(jt(jt({},s),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},xF=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},bF=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,s=n.innerProps,l=n.menuPlacement,f=n.menuPosition,u=w.useRef(null),d=w.useRef(null),h=w.useState(pk(l)),g=Rl(h,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),E=Rl(k,2),T=E[0],I=E[1],D=w.useCallback(function(){if(a){var B=K3(a),z=f==="fixed"?0:window.pageYOffset,U=B[b]+z;(U!==(T==null?void 0:T.offset)||B.left!==(T==null?void 0:T.rect.left)||B.width!==(T==null?void 0:T.rect.width))&&I({offset:U,rect:B})}},[a,f,b,T==null?void 0:T.offset,T==null?void 0:T.rect.left,T==null?void 0:T.rect.width]);j1(function(){D()},[D]);var q=w.useCallback(function(){typeof d.current=="function"&&(d.current(),d.current=null),a&&u.current&&(d.current=V3(a,u.current,D,{elementResize:"ResizeObserver"in window}))},[a,D]);j1(function(){q()},[q]);var F=w.useCallback(function(B){u.current=B,q()},[q]);if(!t&&f!=="fixed"||!T)return null;var $=vt("div",At({ref:F},gr(jt(jt({},n),{},{offset:T.offset,position:f,rect:T.rect}),"menuPortal",{"menu-portal":!0}),s),r);return vt(mk.Provider,{value:S},t?dI.createPortal($,t):$)},vF=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},wF=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,s=n.isRtl;return vt("div",At({},gr(n,"container",{"--is-disabled":a,"--is-rtl":s}),r),t)},SF=function(n,t){var r=n.theme.spacing,a=n.isMulti,s=n.hasValue,l=n.selectProps.controlShouldRenderValue;return jt({alignItems:"center",display:a&&s&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},NF=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,s=n.hasValue;return vt("div",At({},gr(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":s}),r),t)},CF=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},jF=function(n){var t=n.children,r=n.innerProps;return vt("div",At({},gr(n,"indicatorsContainer",{indicators:!0}),r),t)},PN,_F=["size"],kF=["innerProps","isRtl","size"],EF={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},yk=function(n){var t=n.size,r=Bl(n,_F);return vt("svg",At({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:EF},r))},Vw=function(n){return vt(yk,At({size:20},n),vt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},xk=function(n){return vt(yk,At({size:20},n),vt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},bk=function(n,t){var r=n.isFocused,a=n.theme,s=a.spacing.baseUnit,l=a.colors;return jt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?l.neutral60:l.neutral20,padding:s*2,":hover":{color:r?l.neutral80:l.neutral40}})},TF=bk,AF=function(n){var t=n.children,r=n.innerProps;return vt("div",At({},gr(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||vt(xk,null))},PF=bk,DF=function(n){var t=n.children,r=n.innerProps;return vt("div",At({},gr(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||vt(Vw,null))},IF=function(n,t){var r=n.isDisabled,a=n.theme,s=a.spacing.baseUnit,l=a.colors;return jt({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?l.neutral10:l.neutral20,marginBottom:s*2,marginTop:s*2})},MF=function(n){var t=n.innerProps;return vt("span",At({},t,gr(n,"indicatorSeparator",{"indicator-separator":!0})))},RF=E3(PN||(PN=T3([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),OF=function(n,t){var r=n.isFocused,a=n.size,s=n.theme,l=s.colors,f=s.spacing.baseUnit;return jt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?l.neutral60:l.neutral20,padding:f*2})},vv=function(n){var t=n.delay,r=n.offset;return vt("span",{css:zw({animation:"".concat(RF," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},LF=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,s=a===void 0?4:a,l=Bl(n,kF);return vt("div",At({},gr(jt(jt({},l),{},{innerProps:t,isRtl:r,size:s}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),vt(vv,{delay:0,offset:r}),vt(vv,{delay:160,offset:!0}),vt(vv,{delay:320,offset:!r}))},FF=function(n,t){var r=n.isDisabled,a=n.isFocused,s=n.theme,l=s.colors,f=s.borderRadius,u=s.spacing;return jt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:u.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?l.neutral5:l.neutral0,borderColor:r?l.neutral10:a?l.primary:l.neutral20,borderRadius:f,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},$F=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,s=n.innerRef,l=n.innerProps,f=n.menuIsOpen;return vt("div",At({ref:s},gr(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":f}),l,{"aria-disabled":r||void 0}),t)},zF=$F,BF=["data"],UF=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},qF=function(n){var t=n.children,r=n.cx,a=n.getStyles,s=n.getClassNames,l=n.Heading,f=n.headingProps,u=n.innerProps,d=n.label,h=n.theme,g=n.selectProps;return vt("div",At({},gr(n,"group",{group:!0}),u),vt(l,At({},f,{selectProps:g,theme:h,getStyles:a,getClassNames:s,cx:r}),d),vt("div",null,t))},VF=function(n,t){var r=n.theme,a=r.colors,s=r.spacing;return jt({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:s.baseUnit*3,paddingRight:s.baseUnit*3,textTransform:"uppercase"})},HF=function(n){var t=dk(n);t.data;var r=Bl(t,BF);return vt("div",At({},gr(n,"groupHeading",{"group-heading":!0}),r))},GF=qF,YF=["innerRef","isDisabled","isHidden","inputClassName"],WF=function(n,t){var r=n.isDisabled,a=n.value,s=n.theme,l=s.spacing,f=s.colors;return jt(jt({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},QF),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:f.neutral80})},vk={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},QF={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":jt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},vk)},JF=function(n){return jt({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},vk)},KF=function(n){var t=n.cx,r=n.value,a=dk(n),s=a.innerRef,l=a.isDisabled,f=a.isHidden,u=a.inputClassName,d=Bl(a,YF);return vt("div",At({},gr(n,"input",{"input-container":!0}),{"data-value":r||""}),vt("input",At({className:t({input:!0},u),ref:s,style:JF(f),disabled:l},d)))},XF=KF,ZF=function(n,t){var r=n.theme,a=r.spacing,s=r.borderRadius,l=r.colors;return jt({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:s/2,margin:a.baseUnit/2})},e6=function(n,t){var r=n.theme,a=r.borderRadius,s=r.colors,l=n.cropWithEllipsis;return jt({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:s.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},t6=function(n,t){var r=n.theme,a=r.spacing,s=r.borderRadius,l=r.colors,f=n.isFocused;return jt({alignItems:"center",display:"flex"},t?{}:{borderRadius:s/2,backgroundColor:f?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},wk=function(n){var t=n.children,r=n.innerProps;return vt("div",r,t)},n6=wk,r6=wk;function i6(e){var n=e.children,t=e.innerProps;return vt("div",At({role:"button"},t),n||vt(Vw,{size:14}))}var a6=function(n){var t=n.children,r=n.components,a=n.data,s=n.innerProps,l=n.isDisabled,f=n.removeProps,u=n.selectProps,d=r.Container,h=r.Label,g=r.Remove;return vt(d,{data:a,innerProps:jt(jt({},gr(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),s),selectProps:u},vt(h,{data:a,innerProps:jt({},gr(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:u},t),vt(g,{data:a,innerProps:jt(jt({},gr(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},f),selectProps:u}))},s6=a6,o6=function(n,t){var r=n.isDisabled,a=n.isFocused,s=n.isSelected,l=n.theme,f=l.spacing,u=l.colors;return jt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:s?u.primary:a?u.primary25:"transparent",color:r?u.neutral20:s?u.neutral0:"inherit",padding:"".concat(f.baseUnit*2,"px ").concat(f.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:s?u.primary:u.primary50}})},l6=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,s=n.isSelected,l=n.innerRef,f=n.innerProps;return vt("div",At({},gr(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":s}),{ref:l,"aria-disabled":r},f),t)},c6=l6,u6=function(n,t){var r=n.theme,a=r.spacing,s=r.colors;return jt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:s.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},d6=function(n){var t=n.children,r=n.innerProps;return vt("div",At({},gr(n,"placeholder",{placeholder:!0}),r),t)},f6=d6,h6=function(n,t){var r=n.isDisabled,a=n.theme,s=a.spacing,l=a.colors;return jt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?l.neutral40:l.neutral80,marginLeft:s.baseUnit/2,marginRight:s.baseUnit/2})},p6=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return vt("div",At({},gr(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},m6=p6,g6={ClearIndicator:DF,Control:zF,DropdownIndicator:AF,DownChevron:xk,CrossIcon:Vw,Group:GF,GroupHeading:HF,IndicatorsContainer:jF,IndicatorSeparator:MF,Input:XF,LoadingIndicator:LF,Menu:dF,MenuList:hF,MenuPortal:bF,LoadingMessage:yF,NoOptionsMessage:gF,MultiValue:s6,MultiValueContainer:n6,MultiValueLabel:r6,MultiValueRemove:i6,Option:c6,Placeholder:f6,SelectContainer:wF,SingleValue:m6,ValueContainer:NF},y6=function(n){return jt(jt({},g6),n.components)},DN=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function x6(e,n){return!!(e===n||DN(e)&&DN(n))}function b6(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!x6(e[t],n[t]))return!1;return!0}function v6(e,n){n===void 0&&(n=b6);var t=null;function r(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return r.clear=function(){t=null},r}var w6={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},S6=function(n){return vt("span",At({css:w6},n))},IN=S6,N6={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,s=n.context,l=n.isInitialFocus;switch(s){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,s=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(s.length>1?"s":""," ").concat(s.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,s=n.label,l=s===void 0?"":s,f=n.selectValue,u=n.isDisabled,d=n.isSelected,h=n.isAppleDevice,g=function(k,E){return k&&k.length?"".concat(k.indexOf(E)+1," of ").concat(k.length):""};if(t==="value"&&f)return"value ".concat(l," focused, ").concat(g(f,r),".");if(t==="menu"&&h){var b=u?" disabled":"",v="".concat(d?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},C6=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,s=n.focusableOptions,l=n.isFocused,f=n.selectValue,u=n.selectProps,d=n.id,h=n.isAppleDevice,g=u.ariaLiveMessages,b=u.getOptionLabel,v=u.inputValue,S=u.isMulti,k=u.isOptionDisabled,E=u.isSearchable,T=u.menuIsOpen,I=u.options,D=u.screenReaderStatus,q=u.tabSelectsValue,F=u.isLoading,$=u["aria-label"],B=u["aria-live"],z=w.useMemo(function(){return jt(jt({},N6),g||{})},[g]),U=w.useMemo(function(){var oe="";if(t&&z.onChange){var K=t.option,V=t.options,J=t.removedValue,ne=t.removedValues,A=t.value,ae=function(ie){return Array.isArray(ie)?null:ie},ce=J||K||ae(A),M=ce?b(ce):"",de=V||ne||void 0,Se=de?de.map(b):[],fe=jt({isDisabled:ce&&k(ce,f),label:M,labels:Se},t);oe=z.onChange(fe)}return oe},[t,z,k,f,b]),L=w.useMemo(function(){var oe="",K=r||a,V=!!(r&&f&&f.includes(r));if(K&&z.onFocus){var J={focused:K,label:b(K),isDisabled:k(K,f),isSelected:V,options:s,context:K===r?"menu":"value",selectValue:f,isAppleDevice:h};oe=z.onFocus(J)}return oe},[r,a,b,k,z,s,f,h]),R=w.useMemo(function(){var oe="";if(T&&I.length&&!F&&z.onFilter){var K=D({count:s.length});oe=z.onFilter({inputValue:v,resultsMessage:K})}return oe},[s,v,T,z,I,D,F]),G=(t==null?void 0:t.action)==="initial-input-focus",ee=w.useMemo(function(){var oe="";if(z.guidance){var K=a?"value":T?"menu":"input";oe=z.guidance({"aria-label":$,context:K,isDisabled:r&&k(r,f),isMulti:S,isSearchable:E,tabSelectsValue:q,isInitialFocus:G})}return oe},[$,r,a,S,k,E,T,z,f,q,G]),te=vt(w.Fragment,null,vt("span",{id:"aria-selection"},U),vt("span",{id:"aria-focused"},L),vt("span",{id:"aria-results"},R),vt("span",{id:"aria-guidance"},ee));return vt(w.Fragment,null,vt(IN,{id:d},G&&te),vt(IN,{"aria-live":B,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!G&&te))},j6=C6,_1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],_6=new RegExp("["+_1.map(function(e){return e.letters}).join("")+"]","g"),Sk={};for(var wv=0;wv<_1.length;wv++)for(var Sv=_1[wv],Nv=0;Nv<Sv.letters.length;Nv++)Sk[Sv.letters[Nv]]=Sv.base;var Nk=function(n){return n.replace(_6,function(t){return Sk[t]})},k6=v6(Nk),MN=function(n){return n.replace(/^\s+|\s+$/g,"")},E6=function(n){return"".concat(n.label," ").concat(n.value)},T6=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=jt({ignoreCase:!0,ignoreAccents:!0,stringify:E6,trim:!0,matchFrom:"any"},n),s=a.ignoreCase,l=a.ignoreAccents,f=a.stringify,u=a.trim,d=a.matchFrom,h=u?MN(r):r,g=u?MN(f(t)):f(t);return s&&(h=h.toLowerCase(),g=g.toLowerCase()),l&&(h=k6(h),g=Nk(g)),d==="start"?g.substr(0,h.length)===h:g.indexOf(h)>-1}},A6=["innerRef"];function P6(e){var n=e.innerRef,t=Bl(e,A6),r=rF(t,"onExited","in","enter","exit","appear");return vt("input",At({ref:n},r,{css:zw({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var D6=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function I6(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,s=e.onTopLeave,l=w.useRef(!1),f=w.useRef(!1),u=w.useRef(0),d=w.useRef(null),h=w.useCallback(function(E,T){if(d.current!==null){var I=d.current,D=I.scrollTop,q=I.scrollHeight,F=I.clientHeight,$=d.current,B=T>0,z=q-F-D,U=!1;z>T&&l.current&&(r&&r(E),l.current=!1),B&&f.current&&(s&&s(E),f.current=!1),B&&T>z?(t&&!l.current&&t(E),$.scrollTop=q,U=!0,l.current=!0):!B&&-T>D&&(a&&!f.current&&a(E),$.scrollTop=0,U=!0,f.current=!0),U&&D6(E)}},[t,r,a,s]),g=w.useCallback(function(E){h(E,E.deltaY)},[h]),b=w.useCallback(function(E){u.current=E.changedTouches[0].clientY},[]),v=w.useCallback(function(E){var T=u.current-E.changedTouches[0].clientY;h(E,T)},[h]),S=w.useCallback(function(E){if(E){var T=eF?{passive:!1}:!1;E.addEventListener("wheel",g,T),E.addEventListener("touchstart",b,T),E.addEventListener("touchmove",v,T)}},[v,b,g]),k=w.useCallback(function(E){E&&(E.removeEventListener("wheel",g,!1),E.removeEventListener("touchstart",b,!1),E.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var E=d.current;return S(E),function(){k(E)}}},[n,S,k]),function(E){d.current=E}}var RN=["boxSizing","height","overflow","paddingRight","position"],ON={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function LN(e){e.cancelable&&e.preventDefault()}function FN(e){e.stopPropagation()}function $N(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function zN(){return"ontouchstart"in window||navigator.maxTouchPoints}var BN=!!(typeof window<"u"&&window.document&&window.document.createElement),Bm=0,wh={capture:!1,passive:!1};function M6(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),s=w.useRef(null),l=w.useCallback(function(u){if(BN){var d=document.body,h=d&&d.style;if(r&&RN.forEach(function(S){var k=h&&h[S];a.current[S]=k}),r&&Bm<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(ON).forEach(function(S){var k=ON[S];h&&(h[S]=k)}),h&&(h.paddingRight="".concat(v,"px"))}d&&zN()&&(d.addEventListener("touchmove",LN,wh),u&&(u.addEventListener("touchstart",$N,wh),u.addEventListener("touchmove",FN,wh))),Bm+=1}},[r]),f=w.useCallback(function(u){if(BN){var d=document.body,h=d&&d.style;Bm=Math.max(Bm-1,0),r&&Bm<1&&RN.forEach(function(g){var b=a.current[g];h&&(h[g]=b)}),d&&zN()&&(d.removeEventListener("touchmove",LN,wh),u&&(u.removeEventListener("touchstart",$N,wh),u.removeEventListener("touchmove",FN,wh)))}},[r]);return w.useEffect(function(){if(n){var u=s.current;return l(u),function(){f(u)}}},[n,l,f]),function(u){s.current=u}}var R6=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},O6={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function L6(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,s=e.onBottomArrive,l=e.onBottomLeave,f=e.onTopArrive,u=e.onTopLeave,d=I6({isEnabled:a,onBottomArrive:s,onBottomLeave:l,onTopArrive:f,onTopLeave:u}),h=M6({isEnabled:t}),g=function(v){d(v),h(v)};return vt(w.Fragment,null,t&&vt("div",{onClick:R6,css:O6}),n(g))}var F6={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},$6=function(n){var t=n.name,r=n.onFocus;return vt("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:F6,value:"",onChange:function(){}})},z6=$6;function Hw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function B6(){return Hw(/^iPhone/i)}function Ck(){return Hw(/^Mac/i)}function U6(){return Hw(/^iPad/i)||Ck()&&navigator.maxTouchPoints>1}function q6(){return B6()||U6()}function V6(){return Ck()||q6()}var H6=function(n){return n.label},G6=function(n){return n.label},Y6=function(n){return n.value},W6=function(n){return!!n.isDisabled},Q6={clearIndicator:PF,container:vF,control:FF,dropdownIndicator:TF,group:UF,groupHeading:VF,indicatorsContainer:CF,indicatorSeparator:IF,input:WF,loadingIndicator:OF,loadingMessage:mF,menu:lF,menuList:fF,menuPortal:xF,multiValue:ZF,multiValueLabel:e6,multiValueRemove:t6,noOptionsMessage:pF,option:o6,placeholder:u6,singleValue:h6,valueContainer:SF},J6={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},K6=4,jk=4,X6=38,Z6=jk*2,e5={baseUnit:jk,controlHeight:X6,menuGutter:Z6},Cv={borderRadius:K6,colors:J6,spacing:e5},t5={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:AN(),captureMenuScroll:!AN(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:T6(),formatGroupLabel:H6,getOptionLabel:G6,getOptionValue:Y6,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:W6,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!X3(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function UN(e,n,t,r){var a=Ek(e,n,t),s=Tk(e,n,t),l=kk(e,n),f=Cb(e,n);return{type:"option",data:n,isDisabled:a,isSelected:s,label:l,value:f,index:r}}function eb(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(l,f){return UN(e,l,n,f)}).filter(function(l){return VN(e,l)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var s=UN(e,t,n,r);return VN(e,s)?s:void 0}).filter(tF)}function _k(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,Rw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function qN(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,Rw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function n5(e,n){return _k(eb(e,n))}function VN(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,s=n.isSelected,l=n.label,f=n.value;return(!Pk(e)||!s)&&Ak(e,{label:l,value:f,data:a},r)}function r5(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var s=n.indexOf(t);if(s>-1)return t;if(a<n.length)return n[a]}return null}function i5(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var jv=function(n,t){var r,a=(r=n.find(function(s){return s.data===t}))===null||r===void 0?void 0:r.id;return a||null},kk=function(n,t){return n.getOptionLabel(t)},Cb=function(n,t){return n.getOptionValue(t)};function Ek(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function Tk(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=Cb(e,n);return t.some(function(a){return Cb(e,a)===r})}function Ak(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var Pk=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},a5=1,Dk=function(e){jL(t,e);var n=EL(t);function t(r){var a;if(NL(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(u){a.controlRef=u},a.focusedOptionRef=null,a.getFocusedOptionRef=function(u){a.focusedOptionRef=u},a.menuListRef=null,a.getMenuListRef=function(u){a.menuListRef=u},a.inputRef=null,a.getInputRef=function(u){a.inputRef=u},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(u,d){var h=a.props,g=h.onChange,b=h.name;d.name=b,a.ariaOnChange(u,d),g(u,d)},a.setValue=function(u,d,h){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(u,{action:d,option:h})},a.selectOption=function(u){var d=a.props,h=d.blurInputOnSelect,g=d.isMulti,b=d.name,v=a.state.selectValue,S=g&&a.isOptionSelected(u,v),k=a.isOptionDisabled(u,v);if(S){var E=a.getOptionValue(u);a.setValue(v.filter(function(T){return a.getOptionValue(T)!==E}),"deselect-option",u)}else if(!k)g?a.setValue([].concat(Rw(v),[u]),"select-option",u):a.setValue(u,"select-option");else{a.ariaOnChange(u,{action:"select-option",option:u,name:b});return}h&&a.blurInput()},a.removeValue=function(u){var d=a.props.isMulti,h=a.state.selectValue,g=a.getOptionValue(u),b=h.filter(function(S){return a.getOptionValue(S)!==g}),v=Dx(d,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:u}),a.focusInput()},a.clearValue=function(){var u=a.state.selectValue;a.onChange(Dx(a.props.isMulti,[],null),{action:"clear",removedValues:u})},a.popValue=function(){var u=a.props.isMulti,d=a.state.selectValue,h=d[d.length-1],g=d.slice(0,d.length-1),b=Dx(u,g,g[0]||null);h&&a.onChange(b,{action:"pop-value",removedValue:h})},a.getFocusedOptionId=function(u){return jv(a.state.focusableOptionsWithIds,u)},a.getFocusableOptionsWithIds=function(){return qN(eb(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return Y3.apply(void 0,[a.props.classNamePrefix].concat(d))},a.getOptionLabel=function(u){return kk(a.props,u)},a.getOptionValue=function(u){return Cb(a.props,u)},a.getStyles=function(u,d){var h=a.props.unstyled,g=Q6[u](d,h);g.boxSizing="border-box";var b=a.props.styles[u];return b?b(g,d):g},a.getClassNames=function(u,d){var h,g;return(h=(g=a.props.classNames)[u])===null||h===void 0?void 0:h.call(g,d)},a.getElementId=function(u){return"".concat(a.state.instancePrefix,"-").concat(u)},a.getComponents=function(){return y6(a.props)},a.buildCategorizedOptions=function(){return eb(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return _k(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(u,d){a.setState({ariaSelection:jt({value:u},d)})},a.onMenuMouseDown=function(u){u.button===0&&(u.stopPropagation(),u.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(u){a.blockOptionHover=!1},a.onControlMouseDown=function(u){if(!u.defaultPrevented){var d=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&a.onMenuClose():d&&a.openMenu("first"):(d&&(a.openAfterFocus=!0),a.focusInput()),u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&u.preventDefault()}},a.onDropdownIndicatorMouseDown=function(u){if(!(u&&u.type==="mousedown"&&u.button!==0)&&!a.props.isDisabled){var d=a.props,h=d.isMulti,g=d.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!h}),a.onMenuClose()):a.openMenu("first"),u.preventDefault()}},a.onClearIndicatorMouseDown=function(u){u&&u.type==="mousedown"&&u.button!==0||(a.clearValue(),u.preventDefault(),a.openAfterFocus=!1,u.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(u){typeof a.props.closeMenuOnScroll=="boolean"?u.target instanceof HTMLElement&&Wb(u.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(u)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(u){var d=u.touches,h=d&&d.item(0);h&&(a.initialTouchX=h.clientX,a.initialTouchY=h.clientY,a.userIsDragging=!1)},a.onTouchMove=function(u){var d=u.touches,h=d&&d.item(0);if(h){var g=Math.abs(h.clientX-a.initialTouchX),b=Math.abs(h.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(u){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(u.target)&&a.menuListRef&&!a.menuListRef.contains(u.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(u){a.userIsDragging||a.onControlMouseDown(u)},a.onClearIndicatorTouchEnd=function(u){a.userIsDragging||a.onClearIndicatorMouseDown(u)},a.onDropdownIndicatorTouchEnd=function(u){a.userIsDragging||a.onDropdownIndicatorMouseDown(u)},a.handleInputChange=function(u){var d=a.props.inputValue,h=u.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(h,{action:"input-change",prevInputValue:d}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(u){a.props.onFocus&&a.props.onFocus(u),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(u){var d=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(u),a.onInputChange("",{action:"input-blur",prevInputValue:d}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(u){if(!(a.blockOptionHover||a.state.focusedOption===u)){var d=a.getFocusableOptions(),h=d.indexOf(u);a.setState({focusedOption:u,focusedOptionId:h>-1?a.getFocusedOptionId(u):null})}},a.shouldHideSelectedOptions=function(){return Pk(a.props)},a.onValueInputFocus=function(u){u.preventDefault(),u.stopPropagation(),a.focus()},a.onKeyDown=function(u){var d=a.props,h=d.isMulti,g=d.backspaceRemovesValue,b=d.escapeClearsValue,v=d.inputValue,S=d.isClearable,k=d.isDisabled,E=d.menuIsOpen,T=d.onKeyDown,I=d.tabSelectsValue,D=d.openMenuOnFocus,q=a.state,F=q.focusedOption,$=q.focusedValue,B=q.selectValue;if(!k&&!(typeof T=="function"&&(T(u),u.defaultPrevented))){switch(a.blockOptionHover=!0,u.key){case"ArrowLeft":if(!h||v)return;a.focusValue("previous");break;case"ArrowRight":if(!h||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if($)a.removeValue($);else{if(!g)return;h?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||u.shiftKey||!E||!I||!F||D&&a.isOptionSelected(F,B))return;a.selectOption(F);break;case"Enter":if(u.keyCode===229)break;if(E){if(!F||a.isComposing)return;a.selectOption(F);break}return;case"Escape":E?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!E){a.openMenu("first");break}if(!F)return;a.selectOption(F);break;case"ArrowUp":E?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":E?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!E)return;a.focusOption("pageup");break;case"PageDown":if(!E)return;a.focusOption("pagedown");break;case"Home":if(!E)return;a.focusOption("first");break;case"End":if(!E)return;a.focusOption("last");break;default:return}u.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++a5),a.state.selectValue=EN(r.value),r.menuIsOpen&&a.state.selectValue.length){var s=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),f=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=s,a.state.focusedOption=l[f],a.state.focusedOptionId=jv(s,l[f])}return a}return CL(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&TN(this.menuListRef,this.focusedOptionRef),V6()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var s=this.props,l=s.isDisabled,f=s.menuIsOpen,u=this.state.isFocused;(u&&!l&&a.isDisabled||u&&f&&!a.menuIsOpen)&&this.focusInput(),u&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!u&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(TN(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,s){this.props.onInputChange(a,s)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var s=this,l=this.state,f=l.selectValue,u=l.isFocused,d=this.buildFocusableOptions(),h=a==="first"?0:d.length-1;if(!this.props.isMulti){var g=d.indexOf(f[0]);g>-1&&(h=g)}this.scrollToFocusedOptionOnUpdate=!(u&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:d[h],focusedOptionId:this.getFocusedOptionId(d[h])},function(){return s.onMenuOpen()})}},{key:"focusValue",value:function(a){var s=this.state,l=s.selectValue,f=s.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var u=l.indexOf(f);f||(u=-1);var d=l.length-1,h=-1;if(l.length){switch(a){case"previous":u===0?h=0:u===-1?h=d:h=u-1;break;case"next":u>-1&&u<d&&(h=u+1);break}this.setState({inputIsHidden:h!==-1,focusedValue:l[h]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",s=this.props.pageSize,l=this.state.focusedOption,f=this.getFocusableOptions();if(f.length){var u=0,d=f.indexOf(l);l||(d=-1),a==="up"?u=d>0?d-1:f.length-1:a==="down"?u=(d+1)%f.length:a==="pageup"?(u=d-s,u<0&&(u=0)):a==="pagedown"?(u=d+s,u>f.length-1&&(u=f.length-1)):a==="last"&&(u=f.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:f[u],focusedValue:null,focusedOptionId:this.getFocusedOptionId(f[u])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Cv):jt(jt({},Cv),this.props.theme):Cv}},{key:"getCommonProps",value:function(){var a=this.clearValue,s=this.cx,l=this.getStyles,f=this.getClassNames,u=this.getValue,d=this.selectOption,h=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:s,getStyles:l,getClassNames:f,getValue:u,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:d,selectProps:g,setValue:h,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,s=a.isClearable,l=a.isMulti;return s===void 0?l:s}},{key:"isOptionDisabled",value:function(a,s){return Ek(this.props,a,s)}},{key:"isOptionSelected",value:function(a,s){return Tk(this.props,a,s)}},{key:"filterOption",value:function(a,s){return Ak(this.props,a,s)}},{key:"formatOptionLabel",value:function(a,s){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,f=this.state.selectValue;return this.props.formatOptionLabel(a,{context:s,inputValue:l,selectValue:f})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,s=a.isDisabled,l=a.isSearchable,f=a.inputId,u=a.inputValue,d=a.tabIndex,h=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,E=k.inputIsHidden,T=k.ariaSelection,I=this.commonProps,D=f||this.getElementId("input"),q=jt(jt(jt({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(T==null?void 0:T.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,At({},I,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:D,innerRef:this.getInputRef,isDisabled:s,isHidden:E,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:d,form:h,type:"text",value:u},q)):w.createElement(P6,At({id:D,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Sb,onFocus:this.onInputFocus,disabled:s,tabIndex:d,inputMode:"none",form:h,value:""},q))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,s=this.getComponents(),l=s.MultiValue,f=s.MultiValueContainer,u=s.MultiValueLabel,d=s.MultiValueRemove,h=s.SingleValue,g=s.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,E=v.isMulti,T=v.inputValue,I=v.placeholder,D=this.state,q=D.selectValue,F=D.focusedValue,$=D.isFocused;if(!this.hasValue()||!S)return T?null:w.createElement(g,At({},b,{key:"placeholder",isDisabled:k,isFocused:$,innerProps:{id:this.getElementId("placeholder")}}),I);if(E)return q.map(function(z,U){var L=z===F,R="".concat(a.getOptionLabel(z),"-").concat(a.getOptionValue(z));return w.createElement(l,At({},b,{components:{Container:f,Label:u,Remove:d},isFocused:L,isDisabled:k,key:R,index:U,removeProps:{onClick:function(){return a.removeValue(z)},onTouchEnd:function(){return a.removeValue(z)},onMouseDown:function(ee){ee.preventDefault()}},data:z}),a.formatOptionLabel(z,"value"))});if(T)return null;var B=q[0];return w.createElement(h,At({},b,{data:B,isDisabled:k}),this.formatOptionLabel(B,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),s=a.ClearIndicator,l=this.commonProps,f=this.props,u=f.isDisabled,d=f.isLoading,h=this.state.isFocused;if(!this.isClearable()||!s||u||!this.hasValue()||d)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(s,At({},l,{innerProps:g,isFocused:h}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),s=a.LoadingIndicator,l=this.commonProps,f=this.props,u=f.isDisabled,d=f.isLoading,h=this.state.isFocused;if(!s||!d)return null;var g={"aria-hidden":"true"};return w.createElement(s,At({},l,{innerProps:g,isDisabled:u,isFocused:h}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),s=a.DropdownIndicator,l=a.IndicatorSeparator;if(!s||!l)return null;var f=this.commonProps,u=this.props.isDisabled,d=this.state.isFocused;return w.createElement(l,At({},f,{isDisabled:u,isFocused:d}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),s=a.DropdownIndicator;if(!s)return null;var l=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused,d={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(s,At({},l,{innerProps:d,isDisabled:f,isFocused:u}))}},{key:"renderMenu",value:function(){var a=this,s=this.getComponents(),l=s.Group,f=s.GroupHeading,u=s.Menu,d=s.MenuList,h=s.MenuPortal,g=s.LoadingMessage,b=s.NoOptionsMessage,v=s.Option,S=this.commonProps,k=this.state.focusedOption,E=this.props,T=E.captureMenuScroll,I=E.inputValue,D=E.isLoading,q=E.loadingMessage,F=E.minMenuHeight,$=E.maxMenuHeight,B=E.menuIsOpen,z=E.menuPlacement,U=E.menuPosition,L=E.menuPortalTarget,R=E.menuShouldBlockScroll,G=E.menuShouldScrollIntoView,ee=E.noOptionsMessage,te=E.onMenuScrollToTop,oe=E.onMenuScrollToBottom;if(!B)return null;var K=function(M,de){var Se=M.type,fe=M.data,we=M.isDisabled,ie=M.isSelected,_e=M.label,Ve=M.value,tt=k===fe,Ke=we?void 0:function(){return a.onOptionHover(fe)},Oe=we?void 0:function(){return a.selectOption(fe)},xe="".concat(a.getElementId("option"),"-").concat(de),Me={id:xe,onClick:Oe,onMouseMove:Ke,onMouseOver:Ke,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:ie};return w.createElement(v,At({},S,{innerProps:Me,data:fe,isDisabled:we,isSelected:ie,key:xe,label:_e,type:Se,value:Ve,isFocused:tt,innerRef:tt?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(M.data,"menu"))},V;if(this.hasOptions())V=this.getCategorizedOptions().map(function(ce){if(ce.type==="group"){var M=ce.data,de=ce.options,Se=ce.index,fe="".concat(a.getElementId("group"),"-").concat(Se),we="".concat(fe,"-heading");return w.createElement(l,At({},S,{key:fe,data:M,options:de,Heading:f,headingProps:{id:we,data:ce.data},label:a.formatGroupLabel(ce.data)}),ce.options.map(function(ie){return K(ie,"".concat(Se,"-").concat(ie.index))}))}else if(ce.type==="option")return K(ce,"".concat(ce.index))});else if(D){var J=q({inputValue:I});if(J===null)return null;V=w.createElement(g,S,J)}else{var ne=ee({inputValue:I});if(ne===null)return null;V=w.createElement(b,S,ne)}var A={minMenuHeight:F,maxMenuHeight:$,menuPlacement:z,menuPosition:U,menuShouldScrollIntoView:G},ae=w.createElement(cF,At({},S,A),function(ce){var M=ce.ref,de=ce.placerProps,Se=de.placement,fe=de.maxHeight;return w.createElement(u,At({},S,A,{innerRef:M,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:D,placement:Se}),w.createElement(L6,{captureEnabled:T,onTopArrive:te,onBottomArrive:oe,lockEnabled:R},function(we){return w.createElement(d,At({},S,{innerRef:function(_e){a.getMenuListRef(_e),we(_e)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:D,maxHeight:fe,focusedOption:k}),V)}))});return L||U==="fixed"?w.createElement(h,At({},S,{appendTo:L,controlElement:this.controlRef,menuPlacement:z,menuPosition:U}),ae):ae}},{key:"renderFormField",value:function(){var a=this,s=this.props,l=s.delimiter,f=s.isDisabled,u=s.isMulti,d=s.name,h=s.required,g=this.state.selectValue;if(h&&!this.hasValue()&&!f)return w.createElement(z6,{name:d,onFocus:this.onValueInputFocus});if(!(!d||f))if(u)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:d,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,E){return w.createElement("input",{key:"i-".concat(E),name:d,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:d,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:d,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,s=this.state,l=s.ariaSelection,f=s.focusedOption,u=s.focusedValue,d=s.isFocused,h=s.selectValue,g=this.getFocusableOptions();return w.createElement(j6,At({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:f,focusedValue:u,isFocused:d,selectValue:h,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),s=a.Control,l=a.IndicatorsContainer,f=a.SelectContainer,u=a.ValueContainer,d=this.props,h=d.className,g=d.id,b=d.isDisabled,v=d.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(f,At({},k,{className:h,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(s,At({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(u,At({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,At({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,s){var l=s.prevProps,f=s.clearFocusValueOnUpdate,u=s.inputIsHiddenAfterUpdate,d=s.ariaSelection,h=s.isFocused,g=s.prevWasFocused,b=s.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,E=a.inputValue,T=a.isMulti,I=EN(S),D={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||E!==l.inputValue)){var q=k?n5(a,I):[],F=k?qN(eb(a,I),"".concat(b,"-option")):[],$=f?r5(s,I):null,B=i5(s,q),z=jv(F,B);D={selectValue:I,focusedOption:B,focusedOptionId:z,focusableOptionsWithIds:F,focusedValue:$,clearFocusValueOnUpdate:!1}}var U=u!=null&&a!==l?{inputIsHidden:u,inputIsHiddenAfterUpdate:void 0}:{},L=d,R=h&&g;return h&&!R&&(L={value:Dx(T,I,I[0]||null),options:I,action:"initial-input-focus"},R=!g),(d==null?void 0:d.action)==="initial-input-focus"&&(L=null),jt(jt(jt({},D),U),{},{prevProps:a,ariaSelection:L,prevWasFocused:R})}}]),t}(w.Component);Dk.defaultProps=t5;var s5=w.forwardRef(function(e,n){var t=SL(e);return w.createElement(Dk,At({ref:n},t))}),Ik=s5;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let o5,l5;function c5(){return{geminiUrl:o5,vertexUrl:l5}}function u5(e,n,t){var r,a,s;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=c5();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(s=l.geminiUrl)!==null&&s!==void 0?s:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sg{}function It(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const s=n[a];return s!=null?String(s):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function j(e,n,t){for(let s=0;s<n.length-1;s++){const l=n[s];if(l.endsWith("[]")){const f=l.slice(0,-2);if(!(f in e))if(Array.isArray(t))e[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[f])){const u=e[f];if(Array.isArray(t))for(let d=0;d<u.length;d++){const h=u[d];j(h,n.slice(s+1),t[d])}else for(const d of u)j(d,n.slice(s+1),t)}return}else if(l.endsWith("[0]")){const f=l.slice(0,-3);f in e||(e[f]=[{}]);const u=e[f];j(u[0],n.slice(s+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const s=e[a];return Array.isArray(s)?s.map(l=>C(l,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ur(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function Mk(e,n){const t=ur(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function Rk(e,n){return Array.isArray(n)?n.map(t=>jb(e,t)):[jb(e,n)]}function jb(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function d5(e,n){const t=jb(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function f5(e,n){const t=jb(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function HN(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function Ok(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>HN(e,t)):[HN(e,n)]}function k1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function GN(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function YN(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function sa(e,n){if(n==null)throw new Error("ContentUnion is required");return k1(n)?n:{role:"user",parts:Ok(e,n)}}function Lk(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=sa(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=sa(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>sa(e,t)):[sa(e,n)]}function eu(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(GN(n)||YN(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[sa(e,n)]}const t=[],r=[],a=k1(n[0]);for(const s of n){const l=k1(s);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(s);else{if(GN(s)||YN(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(s)}}return a||t.push({role:"user",parts:Ok(e,r)}),t}function Fk(e,n){return n}function $k(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Qb(e,n){return n}function Jb(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function h5(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function tu(e,n){if(typeof n!="string")throw new Error("name must be a string");return h5(e,n,"cachedContents")}function zk(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function nu(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function p5(e){return e!=null&&typeof e=="object"&&"name"in e}function m5(e){return e!=null&&typeof e=="object"&&"video"in e}function g5(e){return e!=null&&typeof e=="object"&&"uri"in e}function Bk(e,n){var t;let r;if(p5(n)&&(r=n.name),!(g5(n)&&(r=n.uri,r===void 0))&&!(m5(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const s=r.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${r}`);r=s[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function Uk(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function qk(e,n){for(const t of["models","tunedModels","publisherModels"])if(y5(n,t))return n[t];return[]}function y5(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function x5(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function b5(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],x5(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function WN(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>b5(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function v5(){return{}}function w5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function S5(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],w5(e,r)),t}function N5(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],v5());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],S5(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const s=C(n,["codeExecution"]);s!=null&&j(t,["codeExecution"],s);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function C5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function j5(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&j(t,["functionCallingConfig"],C5(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function _5(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const s=C(n,["expireTime"]);t!==void 0&&s!=null&&j(t,["expireTime"],s);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const f=C(n,["contents"]);if(t!==void 0&&f!=null){let g=eu(e,f);Array.isArray(g)&&(g=g.map(b=>WN(e,b))),j(t,["contents"],g)}const u=C(n,["systemInstruction"]);t!==void 0&&u!=null&&j(t,["systemInstruction"],WN(e,sa(e,u)));const d=C(n,["tools"]);if(t!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(b=>N5(e,b))),j(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&j(t,["toolConfig"],j5(e,h)),r}function k5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],Mk(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],_5(e,a,t)),t}function E5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],tu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function T5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],tu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function A5(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const s=C(n,["expireTime"]);return t!==void 0&&s!=null&&j(t,["expireTime"],s),r}function P5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],tu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],A5(e,a,t)),t}function D5(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);return t!==void 0&&s!=null&&j(t,["_query","pageToken"],s),r}function I5(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],D5(e,r,t)),t}function M5(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function R5(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],M5(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function QN(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>R5(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function O5(){return{}}function L5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function F5(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],L5(e,r)),t}function $5(){return{}}function z5(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function B5(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],z5(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const s=C(n,["googleServiceAccountConfig"]);s!=null&&j(t,["googleServiceAccountConfig"],s);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const f=C(n,["oauthConfig"]);f!=null&&j(t,["oauthConfig"],f);const u=C(n,["oidcConfig"]);return u!=null&&j(t,["oidcConfig"],u),t}function U5(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],B5(e,r)),t}function q5(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],O5());const s=C(n,["googleSearchRetrieval"]);s!=null&&j(t,["googleSearchRetrieval"],F5(e,s)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],$5());const f=C(n,["googleMaps"]);f!=null&&j(t,["googleMaps"],U5(e,f));const u=C(n,["codeExecution"]);u!=null&&j(t,["codeExecution"],u);const d=C(n,["functionDeclarations"]);return d!=null&&j(t,["functionDeclarations"],d),t}function V5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function H5(e,n){const t={},r=C(n,["latitude"]);r!=null&&j(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function G5(e,n){const t={},r=C(n,["latLng"]);return r!=null&&j(t,["latLng"],H5(e,r)),t}function Y5(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&j(t,["functionCallingConfig"],V5(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],G5(e,a)),t}function W5(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const s=C(n,["expireTime"]);t!==void 0&&s!=null&&j(t,["expireTime"],s);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const f=C(n,["contents"]);if(t!==void 0&&f!=null){let g=eu(e,f);Array.isArray(g)&&(g=g.map(b=>QN(e,b))),j(t,["contents"],g)}const u=C(n,["systemInstruction"]);t!==void 0&&u!=null&&j(t,["systemInstruction"],QN(e,sa(e,u)));const d=C(n,["tools"]);if(t!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(b=>q5(e,b))),j(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&j(t,["toolConfig"],Y5(e,h)),r}function Q5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],Mk(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],W5(e,a,t)),t}function J5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],tu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function K5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],tu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function X5(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const s=C(n,["expireTime"]);return t!==void 0&&s!=null&&j(t,["expireTime"],s),r}function Z5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],tu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],X5(e,a,t)),t}function e$(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);return t!==void 0&&s!=null&&j(t,["_query","pageToken"],s),r}function t$(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],e$(e,r,t)),t}function tb(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["model"]);s!=null&&j(t,["model"],s);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["expireTime"]);u!=null&&j(t,["expireTime"],u);const d=C(n,["usageMetadata"]);return d!=null&&j(t,["usageMetadata"],d),t}function n$(){return{}}function r$(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>tb(e,l))),j(t,["cachedContents"],s)}return t}function nb(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["model"]);s!=null&&j(t,["model"],s);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["expireTime"]);u!=null&&j(t,["expireTime"],u);const d=C(n,["usageMetadata"]);return d!=null&&j(t,["usageMetadata"],d),t}function i$(){return{}}function a$(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>nb(e,l))),j(t,["cachedContents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Bh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Bh||(Bh={}));class Kb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,s;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var JN;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(JN||(JN={}));var KN;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(KN||(KN={}));var XN;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(XN||(XN={}));var ZN;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(ZN||(ZN={}));var eC;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(eC||(eC={}));var tC;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(tC||(tC={}));var nC;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(nC||(nC={}));var Uh;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Uh||(Uh={}));var rC;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(rC||(rC={}));var iC;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(iC||(iC={}));var aC;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(aC||(aC={}));var sC;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(sC||(sC={}));var oC;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(oC||(oC={}));var Xc;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Xc||(Xc={}));var lC;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(lC||(lC={}));var E1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(E1||(E1={}));var cC;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(cC||(cC={}));var uC;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(uC||(uC={}));var dC;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(dC||(dC={}));var fC;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(fC||(fC={}));var hC;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(hC||(hC={}));var pC;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(pC||(pC={}));var mC;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(mC||(mC={}));var gC;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(gC||(gC={}));var yC;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(yC||(yC={}));var xC;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(xC||(xC={}));var bC;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(bC||(bC={}));var vC;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(vC||(vC={}));var wC;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(wC||(wC={}));var SC;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(SC||(SC={}));var NC;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(NC||(NC={}));var CC;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(CC||(CC={}));var jC;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(jC||(jC={}));var _C;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(_C||(_C={}));class Ix{get text(){var n,t,r,a,s,l,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const g=[];for(const b of(u=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)!==null&&u!==void 0?u:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;h=!0,d+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var n,t,r,a,s,l,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const g of(u=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)!==null&&u!==void 0?u:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&h.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(d+=atob(g.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var n,t,r,a,s,l,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(u=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var n,t,r,a,s,l,f,u,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(u=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var n,t,r,a,s,l,f,u,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(u=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class kC{}class EC{}class s${}class o${}class TC{}class AC{}class PC{}class l${}class DC{}class IC{}class MC{}class c${}class T1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class u${}class d${}class f${get text(){var n,t,r;let a="",s=!1;const l=[];for(const f of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(f))u!=="text"&&u!=="thought"&&d!==null&&l.push(u);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;s=!0,a+=f.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?a:void 0}get data(){var n,t,r;let a="";const s=[];for(const l of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,u]of Object.entries(l))f!=="inlineData"&&u!==null&&s.push(f);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class h$ extends Sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Kb(Bh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=Q5(this.apiClient,n);return f=It("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>nb(this.apiClient,h))}else{const d=k5(this.apiClient,n);return f=It("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>tb(this.apiClient,h))}}async get(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=J5(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>nb(this.apiClient,h))}else{const d=E5(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>tb(this.apiClient,h))}}async delete(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=K5(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=i$(),g=new IC;return Object.assign(g,h),g})}else{const d=T5(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(()=>{const h=n$(),g=new IC;return Object.assign(g,h),g})}}async update(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=Z5(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>nb(this.apiClient,h))}else{const d=P5(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>tb(this.apiClient,h))}}async listInternal(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=t$(this.apiClient,n);return f=It("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=a$(this.apiClient,h),b=new MC;return Object.assign(b,g),b})}else{const d=I5(this.apiClient,n);return f=It("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=r$(this.apiClient,h),b=new MC;return Object.assign(b,g),b})}}}function RC(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function ji(e){return this instanceof ji?(this.v=e,this):new ji(e)}function _b(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function f(v,S){r[v]&&(a[v]=function(k){return new Promise(function(E,T){s.push([v,k,E,T])>1||u(v,k)})},S&&(a[v]=S(a[v])))}function u(v,S){try{d(r[v](S))}catch(k){b(s[0][3],k)}}function d(v){v.value instanceof ji?Promise.resolve(v.value.v).then(h,g):b(s[0][2],v)}function h(v){u("next",v)}function g(v){u("throw",v)}function b(v,S){v(S),s.shift(),s.length&&u(s[0][0],s[0][1])}}function A1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof RC=="function"?RC(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=e[s]&&function(l){return new Promise(function(f,u){l=e[s](l),a(f,u,l.done,l.value)})}}function a(s,l,f,u){Promise.resolve(u).then(function(d){s({value:d,done:f})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function p$(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:Vk(t)}function Vk(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function m$(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function g$(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const s=[];let l=!0;for(;r<t&&e[r].role==="model";)s.push(e[r]),l&&!Vk(e[r])&&(l=!1),r++;l&&(n.push(a),n.push(...s))}return n}class y${constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new x$(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class x${constructor(n,t,r,a={},s=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=s,this.sendPromise=Promise.resolve(),m$(s)}async sendMessage(n){var t;await this.sendPromise;const r=sa(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,l;const u=(l=(s=(await a).candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,d=u?[u]:[];this.recordHistory(r,d)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=sa(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const s=await a;return this.processStreamResponse(s,r)}getHistory(n=!1){return n?g$(this.history):this.history}processStreamResponse(n,t){var r,a;return _b(this,arguments,function*(){var l,f,u,d;const h=[];try{for(var g=!0,b=A1(n),v;v=yield ji(b.next()),l=v.done,!l;g=!0){d=v.value,g=!1;const S=d;if(p$(S)){const k=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&h.push(k)}yield yield ji(S)}}catch(S){f={error:S}}finally{try{!g&&!l&&(u=b.return)&&(yield ji(u.call(b)))}finally{if(f)throw f.error}}this.recordHistory(t,h)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function b$(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);return t!==void 0&&s!=null&&j(t,["_query","pageToken"],s),r}function v$(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],b$(e,r,t)),t}function w$(e,n){const t={},r=C(n,["details"]);r!=null&&j(t,["details"],r);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const s=C(n,["code"]);return s!=null&&j(t,["code"],s),t}function S$(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["mimeType"]);s!=null&&j(t,["mimeType"],s);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const f=C(n,["createTime"]);f!=null&&j(t,["createTime"],f);const u=C(n,["expirationTime"]);u!=null&&j(t,["expirationTime"],u);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const h=C(n,["sha256Hash"]);h!=null&&j(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const E=C(n,["error"]);return E!=null&&j(t,["error"],w$(e,E)),t}function N$(e,n){const t={},r=C(n,["file"]);r!=null&&j(t,["file"],S$(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function C$(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","file"],Bk(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function j$(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","file"],Bk(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function _$(e,n){const t={},r=C(n,["details"]);r!=null&&j(t,["details"],r);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const s=C(n,["code"]);return s!=null&&j(t,["code"],s),t}function P1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["mimeType"]);s!=null&&j(t,["mimeType"],s);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const f=C(n,["createTime"]);f!=null&&j(t,["createTime"],f);const u=C(n,["expirationTime"]);u!=null&&j(t,["expirationTime"],u);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const h=C(n,["sha256Hash"]);h!=null&&j(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const E=C(n,["error"]);return E!=null&&j(t,["error"],_$(e,E)),t}function k$(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["files"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>P1(e,l))),j(t,["files"],s)}return t}function E$(){return{}}function T$(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class A$ extends Sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Kb(Bh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>P1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=v$(this.apiClient,n);return s=It("files",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=k$(this.apiClient,u),h=new c$;return Object.assign(h,d),h})}}async createInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=N$(this.apiClient,n);return s=It("upload/v1beta/files",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(()=>{const u=E$(),d=new u$;return Object.assign(d,u),d})}}async get(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=C$(this.apiClient,n);return s=It("files/{file}",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>P1(this.apiClient,u))}}async delete(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=j$(this.apiClient,n);return s=It("files/{file}",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(()=>{const u=T$(),d=new d$;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function P$(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function D$(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function I$(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],P$(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function M$(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],D$(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function R$(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>I$(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function O$(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>M$(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function L$(){return{}}function F$(){return{}}function $$(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function z$(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function B$(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],$$(e,r)),t}function U$(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],z$(e,r)),t}function q$(){return{}}function V$(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function H$(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],V$(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const s=C(n,["googleServiceAccountConfig"]);s!=null&&j(t,["googleServiceAccountConfig"],s);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const f=C(n,["oauthConfig"]);f!=null&&j(t,["oauthConfig"],f);const u=C(n,["oidcConfig"]);return u!=null&&j(t,["oidcConfig"],u),t}function G$(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],H$(e,r)),t}function Y$(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],L$());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],B$(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const s=C(n,["codeExecution"]);s!=null&&j(t,["codeExecution"],s);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function W$(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],F$());const s=C(n,["googleSearchRetrieval"]);s!=null&&j(t,["googleSearchRetrieval"],U$(e,s)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],q$());const f=C(n,["googleMaps"]);f!=null&&j(t,["googleMaps"],G$(e,f));const u=C(n,["codeExecution"]);u!=null&&j(t,["codeExecution"],u);const d=C(n,["functionDeclarations"]);return d!=null&&j(t,["functionDeclarations"],d),t}function Q$(e,n){const t={},r=C(n,["handle"]);if(r!=null&&j(t,["handle"],r),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function J$(e,n){const t={},r=C(n,["handle"]);r!=null&&j(t,["handle"],r);const a=C(n,["transparent"]);return a!=null&&j(t,["transparent"],a),t}function OC(){return{}}function LC(){return{}}function K$(e,n){const t={},r=C(n,["disabled"]);r!=null&&j(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const s=C(n,["endOfSpeechSensitivity"]);s!=null&&j(t,["endOfSpeechSensitivity"],s);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const f=C(n,["silenceDurationMs"]);return f!=null&&j(t,["silenceDurationMs"],f),t}function X$(e,n){const t={},r=C(n,["disabled"]);r!=null&&j(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const s=C(n,["endOfSpeechSensitivity"]);s!=null&&j(t,["endOfSpeechSensitivity"],s);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const f=C(n,["silenceDurationMs"]);return f!=null&&j(t,["silenceDurationMs"],f),t}function Z$(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&j(t,["automaticActivityDetection"],K$(e,r));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const s=C(n,["turnCoverage"]);return s!=null&&j(t,["turnCoverage"],s),t}function ez(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&j(t,["automaticActivityDetection"],X$(e,r));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const s=C(n,["turnCoverage"]);return s!=null&&j(t,["turnCoverage"],s),t}function tz(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&j(t,["targetTokens"],r),t}function nz(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&j(t,["targetTokens"],r),t}function rz(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&j(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],tz(e,a)),t}function iz(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&j(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],nz(e,a)),t}function az(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const s=C(n,["responseModalities"]);t!==void 0&&s!=null&&j(t,["setup","generationConfig","responseModalities"],s);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const f=C(n,["topP"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topP"],f);const u=C(n,["topK"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","topK"],u);const d=C(n,["maxOutputTokens"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","maxOutputTokens"],d);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&j(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],R$(e,sa(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let q=Jb(e,S);Array.isArray(q)&&(q=q.map(F=>Y$(e,Qb(e,F)))),j(t,["setup","tools"],q)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],Q$(e,k));const E=C(n,["inputAudioTranscription"]);t!==void 0&&E!=null&&j(t,["setup","inputAudioTranscription"],OC());const T=C(n,["outputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","outputAudioTranscription"],OC());const I=C(n,["realtimeInputConfig"]);t!==void 0&&I!=null&&j(t,["setup","realtimeInputConfig"],Z$(e,I));const D=C(n,["contextWindowCompression"]);return t!==void 0&&D!=null&&j(t,["setup","contextWindowCompression"],rz(e,D)),r}function sz(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const s=C(n,["responseModalities"]);t!==void 0&&s!=null&&j(t,["setup","generationConfig","responseModalities"],s);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const f=C(n,["topP"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topP"],f);const u=C(n,["topK"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","topK"],u);const d=C(n,["maxOutputTokens"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","maxOutputTokens"],d);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&j(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],O$(e,sa(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let q=Jb(e,S);Array.isArray(q)&&(q=q.map(F=>W$(e,Qb(e,F)))),j(t,["setup","tools"],q)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],J$(e,k));const E=C(n,["inputAudioTranscription"]);t!==void 0&&E!=null&&j(t,["setup","inputAudioTranscription"],LC());const T=C(n,["outputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","outputAudioTranscription"],LC());const I=C(n,["realtimeInputConfig"]);t!==void 0&&I!=null&&j(t,["setup","realtimeInputConfig"],ez(e,I));const D=C(n,["contextWindowCompression"]);return t!==void 0&&D!=null&&j(t,["setup","contextWindowCompression"],iz(e,D)),r}function oz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["setup","model"],ur(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],az(e,a,t)),t}function lz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["setup","model"],ur(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],sz(e,a,t)),t}function cz(){return{}}function uz(){return{}}function dz(){return{}}function fz(){return{}}function hz(e,n){const t={},r=C(n,["media"]);r!=null&&j(t,["mediaChunks"],Rk(e,r));const a=C(n,["audio"]);a!=null&&j(t,["audio"],f5(e,a));const s=C(n,["audioStreamEnd"]);s!=null&&j(t,["audioStreamEnd"],s);const l=C(n,["video"]);l!=null&&j(t,["video"],d5(e,l));const f=C(n,["text"]);return f!=null&&j(t,["text"],f),C(n,["activityStart"])!=null&&j(t,["activityStart"],cz()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],dz()),t}function pz(e,n){const t={},r=C(n,["media"]);if(r!=null&&j(t,["mediaChunks"],Rk(e,r)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&j(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&j(t,["activityStart"],uz()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],fz()),t}function mz(){return{}}function gz(){return{}}function yz(e,n){const t={},r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function xz(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function bz(e,n){const t={},r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],yz(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function vz(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],xz(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function wz(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>bz(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function Sz(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>vz(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function FC(e,n){const t={},r=C(n,["text"]);r!=null&&j(t,["text"],r);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function $C(e,n){const t={},r=C(n,["text"]);r!=null&&j(t,["text"],r);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function Nz(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&j(t,["modelTurn"],wz(e,r));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const s=C(n,["interrupted"]);s!=null&&j(t,["interrupted"],s);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const f=C(n,["generationComplete"]);f!=null&&j(t,["generationComplete"],f);const u=C(n,["inputTranscription"]);u!=null&&j(t,["inputTranscription"],FC(e,u));const d=C(n,["outputTranscription"]);return d!=null&&j(t,["outputTranscription"],FC(e,d)),t}function Cz(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&j(t,["modelTurn"],Sz(e,r));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const s=C(n,["interrupted"]);s!=null&&j(t,["interrupted"],s);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const f=C(n,["generationComplete"]);f!=null&&j(t,["generationComplete"],f);const u=C(n,["inputTranscription"]);u!=null&&j(t,["inputTranscription"],$C(e,u));const d=C(n,["outputTranscription"]);return d!=null&&j(t,["outputTranscription"],$C(e,d)),t}function jz(e,n){const t={},r=C(n,["id"]);r!=null&&j(t,["id"],r);const a=C(n,["args"]);a!=null&&j(t,["args"],a);const s=C(n,["name"]);return s!=null&&j(t,["name"],s),t}function _z(e,n){const t={},r=C(n,["args"]);r!=null&&j(t,["args"],r);const a=C(n,["name"]);return a!=null&&j(t,["name"],a),t}function kz(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>jz(e,s))),j(t,["functionCalls"],a)}return t}function Ez(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>_z(e,s))),j(t,["functionCalls"],a)}return t}function Tz(e,n){const t={},r=C(n,["ids"]);return r!=null&&j(t,["ids"],r),t}function Az(e,n){const t={},r=C(n,["ids"]);return r!=null&&j(t,["ids"],r),t}function Mx(e,n){const t={},r=C(n,["modality"]);r!=null&&j(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function Rx(e,n){const t={},r=C(n,["modality"]);r!=null&&j(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function Pz(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&j(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const s=C(n,["responseTokenCount"]);s!=null&&j(t,["responseTokenCount"],s);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const f=C(n,["thoughtsTokenCount"]);f!=null&&j(t,["thoughtsTokenCount"],f);const u=C(n,["totalTokenCount"]);u!=null&&j(t,["totalTokenCount"],u);const d=C(n,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(S=>Mx(e,S))),j(t,["promptTokensDetails"],v)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(S=>Mx(e,S))),j(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>Mx(e,S))),j(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>Mx(e,S))),j(t,["toolUsePromptTokensDetails"],v)}return t}function Dz(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&j(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const s=C(n,["candidatesTokenCount"]);s!=null&&j(t,["responseTokenCount"],s);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const f=C(n,["thoughtsTokenCount"]);f!=null&&j(t,["thoughtsTokenCount"],f);const u=C(n,["totalTokenCount"]);u!=null&&j(t,["totalTokenCount"],u);const d=C(n,["promptTokensDetails"]);if(d!=null){let S=d;Array.isArray(S)&&(S=S.map(k=>Rx(e,k))),j(t,["promptTokensDetails"],S)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(k=>Rx(e,k))),j(t,["cacheTokensDetails"],S)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>Rx(e,k))),j(t,["responseTokensDetails"],S)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>Rx(e,k))),j(t,["toolUsePromptTokensDetails"],S)}const v=C(n,["trafficType"]);return v!=null&&j(t,["trafficType"],v),t}function Iz(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&j(t,["timeLeft"],r),t}function Mz(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&j(t,["timeLeft"],r),t}function Rz(e,n){const t={},r=C(n,["newHandle"]);r!=null&&j(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const s=C(n,["lastConsumedClientMessageIndex"]);return s!=null&&j(t,["lastConsumedClientMessageIndex"],s),t}function Oz(e,n){const t={},r=C(n,["newHandle"]);r!=null&&j(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const s=C(n,["lastConsumedClientMessageIndex"]);return s!=null&&j(t,["lastConsumedClientMessageIndex"],s),t}function Lz(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],mz());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],Nz(e,a));const s=C(n,["toolCall"]);s!=null&&j(t,["toolCall"],kz(e,s));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],Tz(e,l));const f=C(n,["usageMetadata"]);f!=null&&j(t,["usageMetadata"],Pz(e,f));const u=C(n,["goAway"]);u!=null&&j(t,["goAway"],Iz(e,u));const d=C(n,["sessionResumptionUpdate"]);return d!=null&&j(t,["sessionResumptionUpdate"],Rz(e,d)),t}function Fz(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],gz());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],Cz(e,a));const s=C(n,["toolCall"]);s!=null&&j(t,["toolCall"],Ez(e,s));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],Az(e,l));const f=C(n,["usageMetadata"]);f!=null&&j(t,["usageMetadata"],Dz(e,f));const u=C(n,["goAway"]);u!=null&&j(t,["goAway"],Mz(e,u));const d=C(n,["sessionResumptionUpdate"]);return d!=null&&j(t,["sessionResumptionUpdate"],Oz(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $z(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function zz(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],$z(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function Xb(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>zz(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function Bz(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=C(n,["category"]);r!=null&&j(t,["category"],r);const a=C(n,["threshold"]);return a!=null&&j(t,["threshold"],a),t}function Uz(){return{}}function qz(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function Vz(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],qz(e,r)),t}function Hz(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],Uz());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],Vz(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const s=C(n,["codeExecution"]);s!=null&&j(t,["codeExecution"],s);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function Gz(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function Yz(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&j(t,["functionCallingConfig"],Gz(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function Wz(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&j(t,["voiceName"],r),t}function Qz(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&j(t,["prebuiltVoiceConfig"],Wz(e,r)),t}function Jz(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&j(t,["voiceConfig"],Qz(e,r));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function Kz(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&j(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function Xz(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Xb(e,sa(e,a)));const s=C(n,["temperature"]);s!=null&&j(r,["temperature"],s);const l=C(n,["topP"]);l!=null&&j(r,["topP"],l);const f=C(n,["topK"]);f!=null&&j(r,["topK"],f);const u=C(n,["candidateCount"]);u!=null&&j(r,["candidateCount"],u);const d=C(n,["maxOutputTokens"]);d!=null&&j(r,["maxOutputTokens"],d);const h=C(n,["stopSequences"]);h!=null&&j(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&j(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(r,["seed"],k);const E=C(n,["responseMimeType"]);E!=null&&j(r,["responseMimeType"],E);const T=C(n,["responseSchema"]);if(T!=null&&j(r,["responseSchema"],Fk(e,T)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=C(n,["safetySettings"]);if(t!==void 0&&I!=null){let L=I;Array.isArray(L)&&(L=L.map(R=>Bz(e,R))),j(t,["safetySettings"],L)}const D=C(n,["tools"]);if(t!==void 0&&D!=null){let L=Jb(e,D);Array.isArray(L)&&(L=L.map(R=>Hz(e,Qb(e,R)))),j(t,["tools"],L)}const q=C(n,["toolConfig"]);if(t!==void 0&&q!=null&&j(t,["toolConfig"],Yz(e,q)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=C(n,["cachedContent"]);t!==void 0&&F!=null&&j(t,["cachedContent"],tu(e,F));const $=C(n,["responseModalities"]);$!=null&&j(r,["responseModalities"],$);const B=C(n,["mediaResolution"]);B!=null&&j(r,["mediaResolution"],B);const z=C(n,["speechConfig"]);if(z!=null&&j(r,["speechConfig"],Jz(e,$k(e,z))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=C(n,["thinkingConfig"]);return U!=null&&j(r,["thinkingConfig"],Kz(e,U)),r}function zC(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["contents"]);if(a!=null){let l=eu(e,a);Array.isArray(l)&&(l=l.map(f=>Xb(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["generationConfig"],Xz(e,s,t)),t}function Zz(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["requests[]","taskType"],a);const s=C(n,["title"]);t!==void 0&&s!=null&&j(t,["requests[]","title"],s);const l=C(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&j(t,["requests[]","outputDimensionality"],l),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function eB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["contents"]);a!=null&&j(t,["requests[]","content"],Lk(e,a));const s=C(n,["config"]);s!=null&&j(t,["config"],Zz(e,s,t));const l=C(n,["model"]);return l!==void 0&&j(t,["requests[]","model"],ur(e,l)),t}function tB(e,n,t){const r={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const s=C(n,["aspectRatio"]);t!==void 0&&s!=null&&j(t,["parameters","aspectRatio"],s);const l=C(n,["guidanceScale"]);if(t!==void 0&&l!=null&&j(t,["parameters","guidanceScale"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const f=C(n,["safetyFilterLevel"]);t!==void 0&&f!=null&&j(t,["parameters","safetySetting"],f);const u=C(n,["personGeneration"]);t!==void 0&&u!=null&&j(t,["parameters","personGeneration"],u);const d=C(n,["includeSafetyAttributes"]);t!==void 0&&d!=null&&j(t,["parameters","includeSafetyAttributes"],d);const h=C(n,["includeRaiReason"]);t!==void 0&&h!=null&&j(t,["parameters","includeRaiReason"],h);const g=C(n,["language"]);t!==void 0&&g!=null&&j(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&j(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&j(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function nB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["config"]);return s!=null&&j(t,["config"],tB(e,s,t)),t}function rB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],ur(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function iB(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);t!==void 0&&s!=null&&j(t,["_query","pageToken"],s);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const f=C(n,["queryBase"]);return t!==void 0&&f!=null&&j(t,["_url","models_url"],Uk(e,f)),r}function aB(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],iB(e,r,t)),t}function sB(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const s=C(n,["description"]);t!==void 0&&s!=null&&j(t,["description"],s);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),r}function oB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],ur(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],sB(e,a,t)),t}function lB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],ur(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function cB(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function uB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["contents"]);if(a!=null){let l=eu(e,a);Array.isArray(l)&&(l=l.map(f=>Xb(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["config"],cB(e,s)),t}function dB(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["imageBytes"]);r!=null&&j(t,["bytesBase64Encoded"],nu(e,r));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function fB(e,n,t){const r={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=C(n,["durationSeconds"]);if(t!==void 0&&s!=null&&j(t,["parameters","durationSeconds"],s),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=C(n,["aspectRatio"]);if(t!==void 0&&l!=null&&j(t,["parameters","aspectRatio"],l),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const f=C(n,["personGeneration"]);if(t!==void 0&&f!=null&&j(t,["parameters","personGeneration"],f),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=C(n,["negativePrompt"]);if(t!==void 0&&u!=null&&j(t,["parameters","negativePrompt"],u),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function hB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["image"]);s!=null&&j(t,["instances[0]","image"],dB(e,s));const l=C(n,["config"]);return l!=null&&j(t,["config"],fB(e,l,t)),t}function pB(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function mB(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],pB(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function Qh(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>mB(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function gB(e,n){const t={},r=C(n,["featureSelectionPreference"]);return r!=null&&j(t,["featureSelectionPreference"],r),t}function yB(e,n){const t={},r=C(n,["method"]);r!=null&&j(t,["method"],r);const a=C(n,["category"]);a!=null&&j(t,["category"],a);const s=C(n,["threshold"]);return s!=null&&j(t,["threshold"],s),t}function xB(){return{}}function bB(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function vB(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],bB(e,r)),t}function wB(){return{}}function SB(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function NB(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],SB(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const s=C(n,["googleServiceAccountConfig"]);s!=null&&j(t,["googleServiceAccountConfig"],s);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const f=C(n,["oauthConfig"]);f!=null&&j(t,["oauthConfig"],f);const u=C(n,["oidcConfig"]);return u!=null&&j(t,["oidcConfig"],u),t}function CB(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],NB(e,r)),t}function Hk(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],xB());const s=C(n,["googleSearchRetrieval"]);s!=null&&j(t,["googleSearchRetrieval"],vB(e,s)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],wB());const f=C(n,["googleMaps"]);f!=null&&j(t,["googleMaps"],CB(e,f));const u=C(n,["codeExecution"]);u!=null&&j(t,["codeExecution"],u);const d=C(n,["functionDeclarations"]);return d!=null&&j(t,["functionDeclarations"],d),t}function jB(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function _B(e,n){const t={},r=C(n,["latitude"]);r!=null&&j(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function kB(e,n){const t={},r=C(n,["latLng"]);return r!=null&&j(t,["latLng"],_B(e,r)),t}function EB(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&j(t,["functionCallingConfig"],jB(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],kB(e,a)),t}function TB(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&j(t,["voiceName"],r),t}function AB(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&j(t,["prebuiltVoiceConfig"],TB(e,r)),t}function PB(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&j(t,["voiceConfig"],AB(e,r));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function DB(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&j(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function IB(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Qh(e,sa(e,a)));const s=C(n,["temperature"]);s!=null&&j(r,["temperature"],s);const l=C(n,["topP"]);l!=null&&j(r,["topP"],l);const f=C(n,["topK"]);f!=null&&j(r,["topK"],f);const u=C(n,["candidateCount"]);u!=null&&j(r,["candidateCount"],u);const d=C(n,["maxOutputTokens"]);d!=null&&j(r,["maxOutputTokens"],d);const h=C(n,["stopSequences"]);h!=null&&j(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&j(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(r,["seed"],k);const E=C(n,["responseMimeType"]);E!=null&&j(r,["responseMimeType"],E);const T=C(n,["responseSchema"]);T!=null&&j(r,["responseSchema"],Fk(e,T));const I=C(n,["routingConfig"]);I!=null&&j(r,["routingConfig"],I);const D=C(n,["modelSelectionConfig"]);D!=null&&j(r,["modelConfig"],gB(e,D));const q=C(n,["safetySettings"]);if(t!==void 0&&q!=null){let te=q;Array.isArray(te)&&(te=te.map(oe=>yB(e,oe))),j(t,["safetySettings"],te)}const F=C(n,["tools"]);if(t!==void 0&&F!=null){let te=Jb(e,F);Array.isArray(te)&&(te=te.map(oe=>Hk(e,Qb(e,oe)))),j(t,["tools"],te)}const $=C(n,["toolConfig"]);t!==void 0&&$!=null&&j(t,["toolConfig"],EB(e,$));const B=C(n,["labels"]);t!==void 0&&B!=null&&j(t,["labels"],B);const z=C(n,["cachedContent"]);t!==void 0&&z!=null&&j(t,["cachedContent"],tu(e,z));const U=C(n,["responseModalities"]);U!=null&&j(r,["responseModalities"],U);const L=C(n,["mediaResolution"]);L!=null&&j(r,["mediaResolution"],L);const R=C(n,["speechConfig"]);R!=null&&j(r,["speechConfig"],PB(e,$k(e,R)));const G=C(n,["audioTimestamp"]);G!=null&&j(r,["audioTimestamp"],G);const ee=C(n,["thinkingConfig"]);return ee!=null&&j(r,["thinkingConfig"],DB(e,ee)),r}function BC(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["contents"]);if(a!=null){let l=eu(e,a);Array.isArray(l)&&(l=l.map(f=>Qh(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["generationConfig"],IB(e,s,t)),t}function MB(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["instances[]","task_type"],a);const s=C(n,["title"]);t!==void 0&&s!=null&&j(t,["instances[]","title"],s);const l=C(n,["outputDimensionality"]);t!==void 0&&l!=null&&j(t,["parameters","outputDimensionality"],l);const f=C(n,["mimeType"]);t!==void 0&&f!=null&&j(t,["instances[]","mimeType"],f);const u=C(n,["autoTruncate"]);return t!==void 0&&u!=null&&j(t,["parameters","autoTruncate"],u),r}function RB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["contents"]);a!=null&&j(t,["instances[]","content"],Lk(e,a));const s=C(n,["config"]);return s!=null&&j(t,["config"],MB(e,s,t)),t}function OB(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const s=C(n,["negativePrompt"]);t!==void 0&&s!=null&&j(t,["parameters","negativePrompt"],s);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const f=C(n,["aspectRatio"]);t!==void 0&&f!=null&&j(t,["parameters","aspectRatio"],f);const u=C(n,["guidanceScale"]);t!==void 0&&u!=null&&j(t,["parameters","guidanceScale"],u);const d=C(n,["seed"]);t!==void 0&&d!=null&&j(t,["parameters","seed"],d);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&j(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const E=C(n,["outputCompressionQuality"]);t!==void 0&&E!=null&&j(t,["parameters","outputOptions","compressionQuality"],E);const T=C(n,["addWatermark"]);t!==void 0&&T!=null&&j(t,["parameters","addWatermark"],T);const I=C(n,["enhancePrompt"]);return t!==void 0&&I!=null&&j(t,["parameters","enhancePrompt"],I),r}function LB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["config"]);return s!=null&&j(t,["config"],OB(e,s,t)),t}function Gw(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["gcsUri"],r);const a=C(n,["imageBytes"]);a!=null&&j(t,["bytesBase64Encoded"],nu(e,a));const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function FB(e,n){const t={},r=C(n,["maskMode"]);r!=null&&j(t,["maskMode"],r);const a=C(n,["segmentationClasses"]);a!=null&&j(t,["maskClasses"],a);const s=C(n,["maskDilation"]);return s!=null&&j(t,["dilation"],s),t}function $B(e,n){const t={},r=C(n,["controlType"]);r!=null&&j(t,["controlType"],r);const a=C(n,["enableControlImageComputation"]);return a!=null&&j(t,["computeControl"],a),t}function zB(e,n){const t={},r=C(n,["styleDescription"]);return r!=null&&j(t,["styleDescription"],r),t}function BB(e,n){const t={},r=C(n,["subjectType"]);r!=null&&j(t,["subjectType"],r);const a=C(n,["subjectDescription"]);return a!=null&&j(t,["subjectDescription"],a),t}function UB(e,n){const t={},r=C(n,["referenceImage"]);r!=null&&j(t,["referenceImage"],Gw(e,r));const a=C(n,["referenceId"]);a!=null&&j(t,["referenceId"],a);const s=C(n,["referenceType"]);s!=null&&j(t,["referenceType"],s);const l=C(n,["maskImageConfig"]);l!=null&&j(t,["maskImageConfig"],FB(e,l));const f=C(n,["controlImageConfig"]);f!=null&&j(t,["controlImageConfig"],$B(e,f));const u=C(n,["styleImageConfig"]);u!=null&&j(t,["styleImageConfig"],zB(e,u));const d=C(n,["subjectImageConfig"]);return d!=null&&j(t,["subjectImageConfig"],BB(e,d)),t}function qB(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const s=C(n,["negativePrompt"]);t!==void 0&&s!=null&&j(t,["parameters","negativePrompt"],s);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const f=C(n,["aspectRatio"]);t!==void 0&&f!=null&&j(t,["parameters","aspectRatio"],f);const u=C(n,["guidanceScale"]);t!==void 0&&u!=null&&j(t,["parameters","guidanceScale"],u);const d=C(n,["seed"]);t!==void 0&&d!=null&&j(t,["parameters","seed"],d);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&j(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const E=C(n,["outputCompressionQuality"]);t!==void 0&&E!=null&&j(t,["parameters","outputOptions","compressionQuality"],E);const T=C(n,["editMode"]);t!==void 0&&T!=null&&j(t,["parameters","editMode"],T);const I=C(n,["baseSteps"]);return t!==void 0&&I!=null&&j(t,["parameters","editConfig","baseSteps"],I),r}function VB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["referenceImages"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(u=>UB(e,u))),j(t,["instances[0]","referenceImages"],f)}const l=C(n,["config"]);return l!=null&&j(t,["config"],qB(e,l,t)),t}function HB(e,n,t){const r={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&j(t,["parameters","includeRaiReason"],a);const s=C(n,["outputMimeType"]);t!==void 0&&s!=null&&j(t,["parameters","outputOptions","mimeType"],s);const l=C(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&j(t,["parameters","outputOptions","compressionQuality"],l);const f=C(n,["numberOfImages"]);t!==void 0&&f!=null&&j(t,["parameters","sampleCount"],f);const u=C(n,["mode"]);return t!==void 0&&u!=null&&j(t,["parameters","mode"],u),r}function GB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["image"]);a!=null&&j(t,["instances[0]","image"],Gw(e,a));const s=C(n,["upscaleFactor"]);s!=null&&j(t,["parameters","upscaleConfig","upscaleFactor"],s);const l=C(n,["config"]);return l!=null&&j(t,["config"],HB(e,l,t)),t}function YB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],ur(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function WB(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);t!==void 0&&s!=null&&j(t,["_query","pageToken"],s);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const f=C(n,["queryBase"]);return t!==void 0&&f!=null&&j(t,["_url","models_url"],Uk(e,f)),r}function QB(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],WB(e,r,t)),t}function JB(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const s=C(n,["description"]);t!==void 0&&s!=null&&j(t,["description"],s);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),r}function KB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],JB(e,a,t)),t}function XB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],ur(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function ZB(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Qh(e,sa(e,a)));const s=C(n,["tools"]);if(t!==void 0&&s!=null){let f=s;Array.isArray(f)&&(f=f.map(u=>Hk(e,u))),j(t,["tools"],f)}const l=C(n,["generationConfig"]);return t!==void 0&&l!=null&&j(t,["generationConfig"],l),r}function e8(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["contents"]);if(a!=null){let l=eu(e,a);Array.isArray(l)&&(l=l.map(f=>Qh(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["config"],ZB(e,s,t)),t}function t8(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["contents"]);if(a!=null){let l=eu(e,a);Array.isArray(l)&&(l=l.map(f=>Qh(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["config"],s),t}function n8(e,n,t){const r={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const s=C(n,["outputGcsUri"]);t!==void 0&&s!=null&&j(t,["parameters","storageUri"],s);const l=C(n,["fps"]);t!==void 0&&l!=null&&j(t,["parameters","fps"],l);const f=C(n,["durationSeconds"]);t!==void 0&&f!=null&&j(t,["parameters","durationSeconds"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&j(t,["parameters","aspectRatio"],d);const h=C(n,["resolution"]);t!==void 0&&h!=null&&j(t,["parameters","resolution"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&j(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&j(t,["parameters","negativePrompt"],v);const S=C(n,["enhancePrompt"]);return t!==void 0&&S!=null&&j(t,["parameters","enhancePrompt"],S),r}function r8(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],ur(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["image"]);s!=null&&j(t,["instances[0]","image"],Gw(e,s));const l=C(n,["config"]);return l!=null&&j(t,["config"],n8(e,l,t)),t}function i8(e,n){const t={},r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function a8(e,n){const t={},r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],i8(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function s8(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>a8(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function o8(e,n){const t={},r=C(n,["citationSources"]);return r!=null&&j(t,["citations"],r),t}function l8(e,n){const t={},r=C(n,["content"]);r!=null&&j(t,["content"],s8(e,r));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],o8(e,a));const s=C(n,["tokenCount"]);s!=null&&j(t,["tokenCount"],s);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const f=C(n,["avgLogprobs"]);f!=null&&j(t,["avgLogprobs"],f);const u=C(n,["groundingMetadata"]);u!=null&&j(t,["groundingMetadata"],u);const d=C(n,["index"]);d!=null&&j(t,["index"],d);const h=C(n,["logprobsResult"]);h!=null&&j(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function UC(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let f=r;Array.isArray(f)&&(f=f.map(u=>l8(e,u))),j(t,["candidates"],f)}const a=C(n,["modelVersion"]);a!=null&&j(t,["modelVersion"],a);const s=C(n,["promptFeedback"]);s!=null&&j(t,["promptFeedback"],s);const l=C(n,["usageMetadata"]);return l!=null&&j(t,["usageMetadata"],l),t}function c8(e,n){const t={},r=C(n,["values"]);return r!=null&&j(t,["values"],r),t}function u8(){return{}}function d8(e,n){const t={},r=C(n,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>c8(e,l))),j(t,["embeddings"],s)}return C(n,["metadata"])!=null&&j(t,["metadata"],u8()),t}function f8(e,n){const t={},r=C(n,["bytesBase64Encoded"]);r!=null&&j(t,["imageBytes"],nu(e,r));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function Gk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&j(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const s=C(n,["contentType"]);return s!=null&&j(t,["contentType"],s),t}function h8(e,n){const t={},r=C(n,["_self"]);r!=null&&j(t,["image"],f8(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const s=C(n,["_self"]);return s!=null&&j(t,["safetyAttributes"],Gk(e,s)),t}function p8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>h8(e,l))),j(t,["generatedImages"],s)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],Gk(e,a)),t}function m8(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const s=C(n,["updateTime"]);return s!=null&&j(t,["updateTime"],s),t}function D1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["description"]);s!=null&&j(t,["description"],s);const l=C(n,["version"]);l!=null&&j(t,["version"],l);const f=C(n,["_self"]);f!=null&&j(t,["tunedModelInfo"],m8(e,f));const u=C(n,["inputTokenLimit"]);u!=null&&j(t,["inputTokenLimit"],u);const d=C(n,["outputTokenLimit"]);d!=null&&j(t,["outputTokenLimit"],d);const h=C(n,["supportedGenerationMethods"]);return h!=null&&j(t,["supportedActions"],h),t}function g8(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let s=qk(e,a);Array.isArray(s)&&(s=s.map(l=>D1(e,l))),j(t,["models"],s)}return t}function y8(){return{}}function x8(e,n){const t={},r=C(n,["totalTokens"]);r!=null&&j(t,["totalTokens"],r);const a=C(n,["cachedContentTokenCount"]);return a!=null&&j(t,["cachedContentTokenCount"],a),t}function b8(e,n){const t={},r=C(n,["video","uri"]);r!=null&&j(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],nu(e,a));const s=C(n,["encoding"]);return s!=null&&j(t,["mimeType"],s),t}function v8(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],b8(e,r)),t}function w8(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(f=>v8(e,f))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const s=C(n,["raiMediaFilteredReasons"]);return s!=null&&j(t,["raiMediaFilteredReasons"],s),t}function S8(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const f=C(n,["response","generateVideoResponse"]);return f!=null&&j(t,["response"],w8(e,f)),t}function N8(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function C8(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],N8(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function j8(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>C8(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function _8(e,n){const t={},r=C(n,["citations"]);return r!=null&&j(t,["citations"],r),t}function k8(e,n){const t={},r=C(n,["content"]);r!=null&&j(t,["content"],j8(e,r));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],_8(e,a));const s=C(n,["finishMessage"]);s!=null&&j(t,["finishMessage"],s);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const f=C(n,["avgLogprobs"]);f!=null&&j(t,["avgLogprobs"],f);const u=C(n,["groundingMetadata"]);u!=null&&j(t,["groundingMetadata"],u);const d=C(n,["index"]);d!=null&&j(t,["index"],d);const h=C(n,["logprobsResult"]);h!=null&&j(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function qC(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>k8(e,h))),j(t,["candidates"],d)}const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const s=C(n,["responseId"]);s!=null&&j(t,["responseId"],s);const l=C(n,["modelVersion"]);l!=null&&j(t,["modelVersion"],l);const f=C(n,["promptFeedback"]);f!=null&&j(t,["promptFeedback"],f);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function E8(e,n){const t={},r=C(n,["truncated"]);r!=null&&j(t,["truncated"],r);const a=C(n,["token_count"]);return a!=null&&j(t,["tokenCount"],a),t}function T8(e,n){const t={},r=C(n,["values"]);r!=null&&j(t,["values"],r);const a=C(n,["statistics"]);return a!=null&&j(t,["statistics"],E8(e,a)),t}function A8(e,n){const t={},r=C(n,["billableCharacterCount"]);return r!=null&&j(t,["billableCharacterCount"],r),t}function P8(e,n){const t={},r=C(n,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>T8(e,l))),j(t,["embeddings"],s)}const a=C(n,["metadata"]);return a!=null&&j(t,["metadata"],A8(e,a)),t}function D8(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["gcsUri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["imageBytes"],nu(e,a));const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function Yk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&j(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const s=C(n,["contentType"]);return s!=null&&j(t,["contentType"],s),t}function Yw(e,n){const t={},r=C(n,["_self"]);r!=null&&j(t,["image"],D8(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const s=C(n,["_self"]);s!=null&&j(t,["safetyAttributes"],Yk(e,s));const l=C(n,["prompt"]);return l!=null&&j(t,["enhancedPrompt"],l),t}function I8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>Yw(e,l))),j(t,["generatedImages"],s)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],Yk(e,a)),t}function M8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Yw(e,s))),j(t,["generatedImages"],a)}return t}function R8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Yw(e,s))),j(t,["generatedImages"],a)}return t}function O8(e,n){const t={},r=C(n,["endpoint"]);r!=null&&j(t,["name"],r);const a=C(n,["deployedModelId"]);return a!=null&&j(t,["deployedModelId"],a),t}function L8(e,n){const t={},r=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const s=C(n,["updateTime"]);return s!=null&&j(t,["updateTime"],s),t}function F8(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&j(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const s=C(n,["step"]);return s!=null&&j(t,["step"],s),t}function I1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["description"]);s!=null&&j(t,["description"],s);const l=C(n,["versionId"]);l!=null&&j(t,["version"],l);const f=C(n,["deployedModels"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(v=>O8(e,v))),j(t,["endpoints"],b)}const u=C(n,["labels"]);u!=null&&j(t,["labels"],u);const d=C(n,["_self"]);d!=null&&j(t,["tunedModelInfo"],L8(e,d));const h=C(n,["defaultCheckpointId"]);h!=null&&j(t,["defaultCheckpointId"],h);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>F8(e,v))),j(t,["checkpoints"],b)}return t}function $8(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let s=qk(e,a);Array.isArray(s)&&(s=s.map(l=>I1(e,l))),j(t,["models"],s)}return t}function z8(){return{}}function B8(e,n){const t={},r=C(n,["totalTokens"]);return r!=null&&j(t,["totalTokens"],r),t}function U8(e,n){const t={},r=C(n,["tokensInfo"]);return r!=null&&j(t,["tokensInfo"],r),t}function q8(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],nu(e,a));const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function V8(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],q8(e,r)),t}function H8(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(f=>V8(e,f))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const s=C(n,["raiMediaFilteredReasons"]);return s!=null&&j(t,["raiMediaFilteredReasons"],s),t}function G8(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const f=C(n,["response"]);return f!=null&&j(t,["response"],H8(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Y8="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function W8(e,n,t){const r=new f$;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const s=Fz(e,a);Object.assign(r,s)}else{const s=Lz(e,a);Object.assign(r,s)}n(r)}class Q8{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,s;const l=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let u;const d=Z8(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())u=`${l}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{const q=this.apiClient.getApiKey();u=`${l}/ws/google.ai.generativelanguage.${f}.GenerativeService.BidiGenerateContent?key=${q}`}let h=()=>{};const g=new Promise(q=>{h=q}),b=n.callbacks,v=function(){var q;(q=b==null?void 0:b.onopen)===null||q===void 0||q.call(b),h({})},S=this.apiClient,k={onopen:v,onmessage:q=>{W8(S,b.onmessage,q)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(q){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(q){}},E=this.webSocketFactory.create(u,X8(d),k);E.connect(),await g;let T=ur(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&T.startsWith("publishers/")){const q=this.apiClient.getProject(),F=this.apiClient.getLocation();T=`projects/${q}/locations/${F}/`+T}let I={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[Xc.AUDIO]}:n.config.responseModalities=[Xc.AUDIO]),!((s=n.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const D={model:T,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?I=lz(this.apiClient,D):I=oz(this.apiClient,D),delete I.config,E.send(JSON.stringify(I)),new K8(E,this.apiClient)}}const J8={turnComplete:!0};class K8{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=eu(n,t.turns),n.isVertexAI()?r=r.map(a=>Qh(n,a)):r=r.map(a=>Xb(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!n.isVertexAI()&&!("id"in s))throw new Error(Y8)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},J8),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:pz(this.apiClient,n)}:t={realtimeInput:hz(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function X8(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function Z8(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eU extends Sg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let s;const l=[];if(r!=null&&r.generatedImages)for(const u of r.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((a=u==null?void 0:u.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?s=u==null?void 0:u.safetyAttributes:l.push(u);let f;return s?f={generatedImages:l,positivePromptSafetyAttributes:s}:f={generatedImages:l},f}),this.list=async t=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Kb(Bh.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(l),l)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=BC(this.apiClient,n);return f=It("{model}:generateContent",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=qC(this.apiClient,h),b=new Ix;return Object.assign(b,g),b})}else{const d=zC(this.apiClient,n);return f=It("{model}:generateContent",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=UC(this.apiClient,h),b=new Ix;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=BC(this.apiClient,n);f=It("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return l=h.requestStream({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(g){return _b(this,arguments,function*(){var b,v,S,k;try{for(var E=!0,T=A1(g),I;I=yield ji(T.next()),b=I.done,!b;E=!0){k=I.value,E=!1;const q=qC(h,yield ji(k.json())),F=new Ix;Object.assign(F,q),yield yield ji(F)}}catch(D){v={error:D}}finally{try{!E&&!b&&(S=T.return)&&(yield ji(S.call(T)))}finally{if(v)throw v.error}}})})}else{const d=zC(this.apiClient,n);f=It("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return l=h.requestStream({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(g){return _b(this,arguments,function*(){var b,v,S,k;try{for(var E=!0,T=A1(g),I;I=yield ji(T.next()),b=I.done,!b;E=!0){k=I.value,E=!1;const q=UC(h,yield ji(k.json())),F=new Ix;Object.assign(F,q),yield yield ji(F)}}catch(D){v={error:D}}finally{try{!E&&!b&&(S=T.return)&&(yield ji(S.call(T)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=RB(this.apiClient,n);return f=It("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=P8(this.apiClient,h),b=new kC;return Object.assign(b,g),b})}else{const d=eB(this.apiClient,n);return f=It("{model}:batchEmbedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=d8(this.apiClient,h),b=new kC;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=LB(this.apiClient,n);return f=It("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=I8(this.apiClient,h),b=new EC;return Object.assign(b,g),b})}else{const d=nB(this.apiClient,n);return f=It("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=p8(this.apiClient,h),b=new EC;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=VB(this.apiClient,n);return s=It("{model}:predict",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=M8(this.apiClient,u),h=new s$;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=GB(this.apiClient,n);return s=It("{model}:predict",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=R8(this.apiClient,u),h=new o$;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=YB(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>I1(this.apiClient,h))}else{const d=rB(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>D1(this.apiClient,h))}}async listInternal(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=QB(this.apiClient,n);return f=It("{models_url}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=$8(this.apiClient,h),b=new TC;return Object.assign(b,g),b})}else{const d=aB(this.apiClient,n);return f=It("{models_url}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=g8(this.apiClient,h),b=new TC;return Object.assign(b,g),b})}}async update(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=KB(this.apiClient,n);return f=It("{model}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>I1(this.apiClient,h))}else{const d=oB(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>D1(this.apiClient,h))}}async delete(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=XB(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=z8(),g=new AC;return Object.assign(g,h),g})}else{const d=lB(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(()=>{const h=y8(),g=new AC;return Object.assign(g,h),g})}}async countTokens(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=e8(this.apiClient,n);return f=It("{model}:countTokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=B8(this.apiClient,h),b=new PC;return Object.assign(b,g),b})}else{const d=uB(this.apiClient,n);return f=It("{model}:countTokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=x8(this.apiClient,h),b=new PC;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=t8(this.apiClient,n);return s=It("{model}:computeTokens",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=U8(this.apiClient,u),h=new l$;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=r8(this.apiClient,n);return f=It("{model}:predictLongRunning",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>G8(this.apiClient,h))}else{const d=hB(this.apiClient,n);return f=It("{model}:predictLongRunning",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>S8(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tU(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function nU(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function rU(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["operationName"],r);const a=C(n,["resourceName"]);a!=null&&j(t,["_url","resourceName"],a);const s=C(n,["config"]);return s!=null&&j(t,["config"],s),t}function iU(e,n){const t={},r=C(n,["video","uri"]);r!=null&&j(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],nu(e,a));const s=C(n,["encoding"]);return s!=null&&j(t,["mimeType"],s),t}function aU(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],iU(e,r)),t}function sU(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(f=>aU(e,f))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const s=C(n,["raiMediaFilteredReasons"]);return s!=null&&j(t,["raiMediaFilteredReasons"],s),t}function oU(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const f=C(n,["response","generateVideoResponse"]);return f!=null&&j(t,["response"],sU(e,f)),t}function lU(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],nu(e,a));const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function cU(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],lU(e,r)),t}function uU(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(f=>cU(e,f))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const s=C(n,["raiMediaFilteredReasons"]);return s!=null&&j(t,["raiMediaFilteredReasons"],s),t}function VC(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const f=C(n,["response"]);return f!=null&&j(t,["response"],uU(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dU extends Sg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let s;return r&&"httpOptions"in r&&(s=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:s}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=nU(this.apiClient,n);return f=It("{operationName}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>VC(this.apiClient,h))}else{const d=tU(this.apiClient,n);return f=It("{operationName}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>oU(this.apiClient,h))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=rU(this.apiClient,n);return s=It("{resourceName}:fetchPredictOperation",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>VC(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fU="Content-Type",hU="X-Server-Timeout",pU="User-Agent",mU="x-goog-api-client",gU="0.14.1",yU=`google-genai-sdk/${gU}`,xU="v1beta1",bU="v1beta",HC=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Wk extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class M1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class vU{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:xU,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:bU,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[l,f]of Object.entries(n.queryParams))a.searchParams.append(l,String(f));let s={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=n.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,n.abortSignal),this.unaryApiCall(a,s,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,s]of Object.entries(t))typeof s=="object"?r[a]=Object.assign(Object.assign({},r[a]),s):s!==void 0&&(r[a]=s);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let s={};return s.body=n.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,n.abortSignal),this.streamApiCall(a,s,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,s=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=s}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await GC(a),new T1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await GC(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return _b(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:f,value:u}=yield ji(a.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=s.decode(u);try{const g=JSON.parse(d);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new Wk(k);if(S>=500&&S<600)throw new M1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=d;let h=l.match(HC);for(;h;){const g=h[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield ji(new T1(b)),l=l.slice(h[0].length),h=l.match(HC)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=yU+" "+this.clientOptions.userAgentExtra;return n[pU]=t,n[mU]=t,n[fU]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(hU,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const s=this.clientOptions.uploader,l=await s.stat(n);a.sizeBytes=String(l.size);const f=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:l.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=f;const u=await this.fetchUploadUrl(a,t);return s.upload(n,u,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const s={file:n},l=await this.request({path:It("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function GC(e){var n;if(e===void 0)throw new M1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const s=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new Wk(s):t>=500&&t<600?new M1(s):new Error(s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wU(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function SU(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);t!==void 0&&s!=null&&j(t,["_query","pageToken"],s);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),r}function NU(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],SU(e,r,t)),t}function CU(e,n){const t={},r=C(n,["textInput"]);r!=null&&j(t,["textInput"],r);const a=C(n,["output"]);return a!=null&&j(t,["output"],a),t}function jU(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>CU(e,s))),j(t,["examples","examples"],a)}return t}function _U(e,n,t){const r={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&j(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=C(n,["epochCount"]);t!==void 0&&s!=null&&j(t,["tuningTask","hyperparameters","epochCount"],s);const l=C(n,["learningRateMultiplier"]);if(l!=null&&j(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const f=C(n,["batchSize"]);t!==void 0&&f!=null&&j(t,["tuningTask","hyperparameters","batchSize"],f);const u=C(n,["learningRate"]);return t!==void 0&&u!=null&&j(t,["tuningTask","hyperparameters","learningRate"],u),r}function kU(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&j(t,["tuningTask","trainingData"],jU(e,a));const s=C(n,["config"]);return s!=null&&j(t,["config"],_U(e,s,t)),t}function EU(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function TU(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);t!==void 0&&s!=null&&j(t,["_query","pageToken"],s);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),r}function AU(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],TU(e,r,t)),t}function PU(e,n,t){const r={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function DU(e,n){const t={},r=C(n,["gcsUri"]);return r!=null&&j(t,["validationDatasetUri"],r),t}function IU(e,n,t){const r={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&j(t,["supervisedTuningSpec"],DU(e,a));const s=C(n,["tunedModelDisplayName"]);t!==void 0&&s!=null&&j(t,["tunedModelDisplayName"],s);const l=C(n,["description"]);t!==void 0&&l!=null&&j(t,["description"],l);const f=C(n,["epochCount"]);t!==void 0&&f!=null&&j(t,["supervisedTuningSpec","hyperParameters","epochCount"],f);const u=C(n,["learningRateMultiplier"]);t!==void 0&&u!=null&&j(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const d=C(n,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&j(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=C(n,["adapterSize"]);if(t!==void 0&&h!=null&&j(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function MU(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],PU(e,a,t));const s=C(n,["config"]);return s!=null&&j(t,["config"],IU(e,s,t)),t}function RU(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["model"],r);const a=C(n,["name"]);return a!=null&&j(t,["endpoint"],a),t}function Qk(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["state"]);a!=null&&j(t,["state"],zk(e,a));const s=C(n,["createTime"]);s!=null&&j(t,["createTime"],s);const l=C(n,["tuningTask","startTime"]);l!=null&&j(t,["startTime"],l);const f=C(n,["tuningTask","completeTime"]);f!=null&&j(t,["endTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const d=C(n,["description"]);d!=null&&j(t,["description"],d);const h=C(n,["baseModel"]);h!=null&&j(t,["baseModel"],h);const g=C(n,["_self"]);g!=null&&j(t,["tunedModel"],RU(e,g));const b=C(n,["distillationSpec"]);b!=null&&j(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&j(t,["experiment"],v);const S=C(n,["labels"]);S!=null&&j(t,["labels"],S);const k=C(n,["pipelineJob"]);k!=null&&j(t,["pipelineJob"],k);const E=C(n,["tunedModelDisplayName"]);return E!=null&&j(t,["tunedModelDisplayName"],E),t}function OU(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["tunedModels"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>Qk(e,l))),j(t,["tuningJobs"],s)}return t}function LU(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);return l!=null&&j(t,["error"],l),t}function FU(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&j(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const s=C(n,["step"]);s!=null&&j(t,["step"],s);const l=C(n,["endpoint"]);return l!=null&&j(t,["endpoint"],l),t}function $U(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],r);const a=C(n,["endpoint"]);a!=null&&j(t,["endpoint"],a);const s=C(n,["checkpoints"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(f=>FU(e,f))),j(t,["checkpoints"],l)}return t}function R1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["state"]);a!=null&&j(t,["state"],zk(e,a));const s=C(n,["createTime"]);s!=null&&j(t,["createTime"],s);const l=C(n,["startTime"]);l!=null&&j(t,["startTime"],l);const f=C(n,["endTime"]);f!=null&&j(t,["endTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const d=C(n,["error"]);d!=null&&j(t,["error"],d);const h=C(n,["description"]);h!=null&&j(t,["description"],h);const g=C(n,["baseModel"]);g!=null&&j(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&j(t,["tunedModel"],$U(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&j(t,["supervisedTuningSpec"],v);const S=C(n,["tuningDataStats"]);S!=null&&j(t,["tuningDataStats"],S);const k=C(n,["encryptionSpec"]);k!=null&&j(t,["encryptionSpec"],k);const E=C(n,["partnerModelTuningSpec"]);E!=null&&j(t,["partnerModelTuningSpec"],E);const T=C(n,["distillationSpec"]);T!=null&&j(t,["distillationSpec"],T);const I=C(n,["experiment"]);I!=null&&j(t,["experiment"],I);const D=C(n,["labels"]);D!=null&&j(t,["labels"],D);const q=C(n,["pipelineJob"]);q!=null&&j(t,["pipelineJob"],q);const F=C(n,["tunedModelDisplayName"]);return F!=null&&j(t,["tunedModelDisplayName"],F),t}function zU(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["tuningJobs"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>R1(e,l))),j(t,["tuningJobs"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BU extends Sg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Kb(Bh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:E1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=EU(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>R1(this.apiClient,h))}else{const d=wU(this.apiClient,n);return f=It("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>Qk(this.apiClient,h))}}async listInternal(n){var t,r,a,s;let l,f="",u={};if(this.apiClient.isVertexAI()){const d=AU(this.apiClient,n);return f=It("tuningJobs",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=zU(this.apiClient,h),b=new DC;return Object.assign(b,g),b})}else{const d=NU(this.apiClient,n);return f=It("tunedModels",d._url),u=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=OU(this.apiClient,h),b=new DC;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=MU(this.apiClient,n);return s=It("tuningJobs",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>R1(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=kU(this.apiClient,n);return s=It("tunedModels",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>LU(this.apiClient,u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UU{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const qU=1024*1024*8,VU=3,HU=1e3,GU=2,_v="x-goog-upload-status";async function YU(e,n,t){var r,a,s;let l=0,f=0,u=new T1(new Response),d="upload";for(l=e.size;f<l;){const g=Math.min(qU,l-f),b=e.slice(f,f+g);f+g>=l&&(d+=", finalize");let v=0,S=HU;for(;v<VU&&(u=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(f),"Content-Length":String(g)}}}),!(!((r=u==null?void 0:u.headers)===null||r===void 0)&&r[_v]));)v++,await QU(S),S=S*GU;if(f+=g,((a=u==null?void 0:u.headers)===null||a===void 0?void 0:a[_v])!=="active")break;if(l<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(u==null?void 0:u.json());if(((s=u==null?void 0:u.headers)===null||s===void 0?void 0:s[_v])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function WU(e){return{size:e.size,type:e.type}}function QU(e){return new Promise(n=>setTimeout(n,e))}class JU{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await YU(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await WU(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KU{create(n,t,r){return new XU(n,t,r)}}class XU{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const YC="x-goog-api-key";class ZU{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(YC)===null&&n.append(YC,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const e9="gl-node/";class Jk{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=u5(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new ZU(this.apiKey);this.apiClient=new vU({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:e9+"web",uploader:new JU,downloader:new UU}),this.models=new eU(this.apiClient),this.live=new Q8(this.apiClient,a,new KU),this.chats=new y$(this.models,this.apiClient),this.caches=new h$(this.apiClient),this.files=new A$(this.apiClient),this.operations=new dU(this.apiClient),this.tunings=new BU(this.apiClient)}}const Sh=new Map,Kk=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&Sh.has(n.id)){const a=Sh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Sh.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&Sh.has(n.id)){const a=Sh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Sh.set(n.id,r),r}}})();function t9(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const n9=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,Xk=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,Ox=new Map,O1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var kv={exports:{}},WC;function r9(){return WC||(WC=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(u,d,h){this.fn=u,this.context=d,this.once=h||!1}function s(u,d,h,g,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,g||u,b),S=t?t+d:d;return u._events[S]?u._events[S].fn?u._events[S]=[u._events[S],v]:u._events[S].push(v):(u._events[S]=v,u._eventsCount++),u}function l(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function f(){this._events=new r,this._eventsCount=0}f.prototype.eventNames=function(){var d=[],h,g;if(this._eventsCount===0)return d;for(g in h=this._events)n.call(h,g)&&d.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},f.prototype.listeners=function(d){var h=t?t+d:d,g=this._events[h];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},f.prototype.listenerCount=function(d){var h=t?t+d:d,g=this._events[h];return g?g.fn?1:g.length:0},f.prototype.emit=function(d,h,g,b,v,S){var k=t?t+d:d;if(!this._events[k])return!1;var E=this._events[k],T=arguments.length,I,D;if(E.fn){switch(E.once&&this.removeListener(d,E.fn,void 0,!0),T){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,h),!0;case 3:return E.fn.call(E.context,h,g),!0;case 4:return E.fn.call(E.context,h,g,b),!0;case 5:return E.fn.call(E.context,h,g,b,v),!0;case 6:return E.fn.call(E.context,h,g,b,v,S),!0}for(D=1,I=new Array(T-1);D<T;D++)I[D-1]=arguments[D];E.fn.apply(E.context,I)}else{var q=E.length,F;for(D=0;D<q;D++)switch(E[D].once&&this.removeListener(d,E[D].fn,void 0,!0),T){case 1:E[D].fn.call(E[D].context);break;case 2:E[D].fn.call(E[D].context,h);break;case 3:E[D].fn.call(E[D].context,h,g);break;case 4:E[D].fn.call(E[D].context,h,g,b);break;default:if(!I)for(F=1,I=new Array(T-1);F<T;F++)I[F-1]=arguments[F];E[D].fn.apply(E[D].context,I)}}return!0},f.prototype.on=function(d,h,g){return s(this,d,h,g,!1)},f.prototype.once=function(d,h,g){return s(this,d,h,g,!0)},f.prototype.removeListener=function(d,h,g,b){var v=t?t+d:d;if(!this._events[v])return this;if(!h)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===h&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,E=[],T=S.length;k<T;k++)(S[k].fn!==h||b&&!S[k].once||g&&S[k].context!==g)&&E.push(S[k]);E.length?this._events[v]=E.length===1?E[0]:E:l(this,v)}return this},f.prototype.removeAllListeners=function(d){var h;return d?(h=t?t+d:d,this._events[h]&&l(this,h)):(this._events=new r,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=t,f.EventEmitter=f,e.exports=f}(kv)),kv.exports}var i9=r9();const Zk=Qd(i9);function a9(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class eE extends Zk{constructor(t=16e3){super();Ln(this,"stream");Ln(this,"audioContext");Ln(this,"source");Ln(this,"recording",!1);Ln(this,"recordingWorklet");Ln(this,"vuWorklet");Ln(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await Kk({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=O1(r,n9);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async l=>{const f=l.data.data.int16arrayBuffer;if(f){const u=a9(f);this.emit("data",u)}},this.source.connect(this.recordingWorklet);const s="vu-meter";await this.audioContext.audioWorklet.addModule(O1(s,Xk)),this.vuWorklet=new AudioWorkletNode(this.audioContext,s),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(s=>s.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const s9=3,o9=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const s=()=>{r.current.forEach((l,f)=>{l&&(l.style.height=`${Math.min(24,4+n*(f===1?400:60))}px`)}),a=window.setTimeout(s,100)};return s(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:Kc("audioPulse",{active:e,hover:t}),children:Array(s9).fill(null).map((a,s)=>i.jsx("div",{ref:l=>{r.current[s]=l},style:{animationDelay:`${s*133}ms`}},s))})};var Xm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var l9=Xm.exports,QC;function c9(){return QC||(QC=1,function(e,n){(function(){var t,r="4.17.21",a=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",f="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",d=500,h="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,E=1,T=2,I=4,D=8,q=16,F=32,$=64,B=128,z=256,U=512,L=30,R="...",G=800,ee=16,te=1,oe=2,K=3,V=1/0,J=9007199254740991,ne=17976931348623157e292,A=NaN,ae=4294967295,ce=ae-1,M=ae>>>1,de=[["ary",B],["bind",E],["bindKey",T],["curry",D],["curryRight",q],["flip",U],["partial",F],["partialRight",$],["rearg",z]],Se="[object Arguments]",fe="[object Array]",we="[object AsyncFunction]",ie="[object Boolean]",_e="[object Date]",Ve="[object DOMException]",tt="[object Error]",Ke="[object Function]",Oe="[object GeneratorFunction]",xe="[object Map]",Me="[object Number]",ve="[object Null]",Ee="[object Object]",Pe="[object Promise]",rt="[object Proxy]",lt="[object RegExp]",Ze="[object Set]",Rt="[object String]",kt="[object Symbol]",on="[object Undefined]",se="[object WeakMap]",Q="[object WeakSet]",re="[object ArrayBuffer]",je="[object DataView]",Ae="[object Float32Array]",Ue="[object Float64Array]",ot="[object Int8Array]",mt="[object Int16Array]",ft="[object Int32Array]",Be="[object Uint8Array]",Xe="[object Uint8ClampedArray]",Fe="[object Uint16Array]",st="[object Uint32Array]",Je=/\b__p \+= '';/g,xt=/\b(__p \+=) '' \+/g,Vn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,$n=/&(?:amp|lt|gt|quot|#39);/g,_n=/[&<>"']/g,yn=RegExp($n.source),fn=RegExp(_n.source),_r=/<%-([\s\S]+?)%>/g,Wr=/<%([\s\S]+?)%>/g,li=/<%=([\s\S]+?)%>/g,ha=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pi=/^\w*$/,ir=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zn=/[\\^$.*+?()[\]{}|]/g,zn=RegExp(Zn.source),Ua=/^\s+/,fs=/\s/,rp=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ip=/\{\n\/\* \[wrapped with (.+)\] \*/,Xd=/,? & /,hs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ou=/[()=,{}\[\]\/\s]/,Qs=/\\(\\)?/g,Js=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qa=/\w*$/,Ks=/^[-+]0x[0-9a-f]+$/i,dr=/^0b[01]+$/i,Zd=/^\[object .+?Constructor\]$/,ql=/^0o[0-7]+$/i,ps=/^(?:0|[1-9]\d*)$/,Va=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qr=/($^)/,Xs=/['\n\r\u2028\u2029\\]/g,Ha="\\ud800-\\udfff",ef="\\u0300-\\u036f",Yo="\\ufe20-\\ufe2f",Zs="\\u20d0-\\u20ff",ci=ef+Yo+Zs,Wo="\\u2700-\\u27bf",Vl="a-z\\xdf-\\xf6\\xf8-\\xff",pa="\\xac\\xb1\\xd7\\xf7",lu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",cu="\\u2000-\\u206f",tf=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",uu="A-Z\\xc0-\\xd6\\xd8-\\xde",zr="\\ufe0e\\ufe0f",eo=pa+lu+cu+tf,Hl="[']",ms="["+Ha+"]",Gl="["+eo+"]",Bi="["+ci+"]",du="\\d+",Mr="["+Wo+"]",Qo="["+Vl+"]",to="[^"+Ha+eo+du+Wo+Vl+uu+"]",no="\\ud83c[\\udffb-\\udfff]",ma="(?:"+Bi+"|"+no+")",ro="[^"+Ha+"]",gs="(?:\\ud83c[\\udde6-\\uddff]){2}",ga="[\\ud800-\\udbff][\\udc00-\\udfff]",ya="["+uu+"]",Jo="\\u200d",Ko="(?:"+Qo+"|"+to+")",Xo="(?:"+ya+"|"+to+")",Yl="(?:"+Hl+"(?:d|ll|m|re|s|t|ve))?",Wl="(?:"+Hl+"(?:D|LL|M|RE|S|T|VE))?",ys=ma+"?",io="["+zr+"]?",Zo="(?:"+Jo+"(?:"+[ro,gs,ga].join("|")+")"+io+ys+")*",Br="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ga="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ql=io+ys+Zo,xa="(?:"+[Mr,gs,ga].join("|")+")"+Ql,ao="(?:"+[ro+Bi+"?",Bi,gs,ga,ms].join("|")+")",el=RegExp(Hl,"g"),ui=RegExp(Bi,"g"),so=RegExp(no+"(?="+no+")|"+ao+Ql,"g"),xs=RegExp([ya+"?"+Qo+"+"+Yl+"(?="+[Gl,ya,"$"].join("|")+")",Xo+"+"+Wl+"(?="+[Gl,ya+Ko,"$"].join("|")+")",ya+"?"+Ko+"+"+Yl,ya+"+"+Wl,Ga,Br,du,xa].join("|"),"g"),Ui=RegExp("["+Jo+Ha+ci+zr+"]"),Jl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,bs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],nf=-1,xn={};xn[Ae]=xn[Ue]=xn[ot]=xn[mt]=xn[ft]=xn[Be]=xn[Xe]=xn[Fe]=xn[st]=!0,xn[Se]=xn[fe]=xn[re]=xn[ie]=xn[je]=xn[_e]=xn[tt]=xn[Ke]=xn[xe]=xn[Me]=xn[Ee]=xn[lt]=xn[Ze]=xn[Rt]=xn[se]=!1;var cn={};cn[Se]=cn[fe]=cn[re]=cn[je]=cn[ie]=cn[_e]=cn[Ae]=cn[Ue]=cn[ot]=cn[mt]=cn[ft]=cn[xe]=cn[Me]=cn[Ee]=cn[lt]=cn[Ze]=cn[Rt]=cn[kt]=cn[Be]=cn[Xe]=cn[Fe]=cn[st]=!0,cn[tt]=cn[Ke]=cn[se]=!1;var Kl={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Rr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Kt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},oo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ya=parseFloat,fu=parseInt,Wa=typeof Jc=="object"&&Jc&&Jc.Object===Object&&Jc,vs=typeof self=="object"&&self&&self.Object===Object&&self,er=Wa||vs||Function("return this")(),ws=n&&!n.nodeType&&n,Jr=ws&&!0&&e&&!e.nodeType&&e,hu=Jr&&Jr.exports===ws,tl=hu&&Wa.process,Or=function(){try{var W=Jr&&Jr.require&&Jr.require("util").types;return W||tl&&tl.binding&&tl.binding("util")}catch{}}(),ba=Or&&Or.isArrayBuffer,pu=Or&&Or.isDate,Xl=Or&&Or.isMap,Ss=Or&&Or.isRegExp,rf=Or&&Or.isSet,mu=Or&&Or.isTypedArray;function fr(W,ue,me){switch(me.length){case 0:return W.call(ue);case 1:return W.call(ue,me[0]);case 2:return W.call(ue,me[0],me[1]);case 3:return W.call(ue,me[0],me[1],me[2])}return W.apply(ue,me)}function Zl(W,ue,me,$e){for(var Qe=-1,nt=W==null?0:W.length;++Qe<nt;){var Xt=W[Qe];ue($e,Xt,me(Xt),W)}return $e}function Ur(W,ue){for(var me=-1,$e=W==null?0:W.length;++me<$e&&ue(W[me],me,W)!==!1;);return W}function ap(W,ue){for(var me=W==null?0:W.length;me--&&ue(W[me],me,W)!==!1;);return W}function nl(W,ue){for(var me=-1,$e=W==null?0:W.length;++me<$e;)if(!ue(W[me],me,W))return!1;return!0}function qi(W,ue){for(var me=-1,$e=W==null?0:W.length,Qe=0,nt=[];++me<$e;){var Xt=W[me];ue(Xt,me,W)&&(nt[Qe++]=Xt)}return nt}function ec(W,ue){var me=W==null?0:W.length;return!!me&&Kr(W,ue,0)>-1}function gu(W,ue,me){for(var $e=-1,Qe=W==null?0:W.length;++$e<Qe;)if(me(ue,W[$e]))return!0;return!1}function Rn(W,ue){for(var me=-1,$e=W==null?0:W.length,Qe=Array($e);++me<$e;)Qe[me]=ue(W[me],me,W);return Qe}function va(W,ue){for(var me=-1,$e=ue.length,Qe=W.length;++me<$e;)W[Qe+me]=ue[me];return W}function yu(W,ue,me,$e){var Qe=-1,nt=W==null?0:W.length;for($e&&nt&&(me=W[++Qe]);++Qe<nt;)me=ue(me,W[Qe],Qe,W);return me}function sp(W,ue,me,$e){var Qe=W==null?0:W.length;for($e&&Qe&&(me=W[--Qe]);Qe--;)me=ue(me,W[Qe],Qe,W);return me}function xu(W,ue){for(var me=-1,$e=W==null?0:W.length;++me<$e;)if(ue(W[me],me,W))return!0;return!1}var op=il("length");function af(W){return W.split("")}function lp(W){return W.match(hs)||[]}function rl(W,ue,me){var $e;return me(W,function(Qe,nt,Xt){if(ue(Qe,nt,Xt))return $e=nt,!1}),$e}function tc(W,ue,me,$e){for(var Qe=W.length,nt=me+($e?1:-1);$e?nt--:++nt<Qe;)if(ue(W[nt],nt,W))return nt;return-1}function Kr(W,ue,me){return ue===ue?fp(W,ue,me):tc(W,qr,me)}function Vi(W,ue,me,$e){for(var Qe=me-1,nt=W.length;++Qe<nt;)if($e(W[Qe],ue))return Qe;return-1}function qr(W){return W!==W}function bu(W,ue){var me=W==null?0:W.length;return me?sl(W,ue)/me:A}function il(W){return function(ue){return ue==null?t:ue[W]}}function al(W){return function(ue){return W==null?t:W[ue]}}function nc(W,ue,me,$e,Qe){return Qe(W,function(nt,Xt,Ht){me=$e?($e=!1,nt):ue(me,nt,Xt,Ht)}),me}function rc(W,ue){var me=W.length;for(W.sort(ue);me--;)W[me]=W[me].value;return W}function sl(W,ue){for(var me,$e=-1,Qe=W.length;++$e<Qe;){var nt=ue(W[$e]);nt!==t&&(me=me===t?nt:me+nt)}return me}function wa(W,ue){for(var me=-1,$e=Array(W);++me<W;)$e[me]=ue(me);return $e}function cp(W,ue){return Rn(ue,function(me){return[me,W[me]]})}function vu(W){return W&&W.slice(0,Nu(W)+1).replace(Ua,"")}function Xr(W){return function(ue){return W(ue)}}function ic(W,ue){return Rn(ue,function(me){return W[me]})}function lo(W,ue){return W.has(ue)}function co(W,ue){for(var me=-1,$e=W.length;++me<$e&&Kr(ue,W[me],0)>-1;);return me}function uo(W,ue){for(var me=W.length;me--&&Kr(ue,W[me],0)>-1;);return me}function up(W,ue){for(var me=W.length,$e=0;me--;)W[me]===ue&&++$e;return $e}var Sa=al(Kl),sf=al(Rr);function ac(W){return"\\"+oo[W]}function wu(W,ue){return W==null?t:W[ue]}function Qa(W){return Ui.test(W)}function of(W){return Jl.test(W)}function Hi(W){for(var ue,me=[];!(ue=W.next()).done;)me.push(ue.value);return me}function sc(W){var ue=-1,me=Array(W.size);return W.forEach(function($e,Qe){me[++ue]=[Qe,$e]}),me}function Su(W,ue){return function(me){return W(ue(me))}}function Ja(W,ue){for(var me=-1,$e=W.length,Qe=0,nt=[];++me<$e;){var Xt=W[me];(Xt===ue||Xt===h)&&(W[me]=h,nt[Qe++]=me)}return nt}function oc(W){var ue=-1,me=Array(W.size);return W.forEach(function($e){me[++ue]=$e}),me}function dp(W){var ue=-1,me=Array(W.size);return W.forEach(function($e){me[++ue]=[$e,$e]}),me}function fp(W,ue,me){for(var $e=me-1,Qe=W.length;++$e<Qe;)if(W[$e]===ue)return $e;return-1}function Zr(W,ue,me){for(var $e=me+1;$e--;)if(W[$e]===ue)return $e;return $e}function Gi(W){return Qa(W)?Cu(W):op(W)}function di(W){return Qa(W)?lc(W):af(W)}function Nu(W){for(var ue=W.length;ue--&&fs.test(W.charAt(ue)););return ue}var lf=al(Kt);function Cu(W){for(var ue=so.lastIndex=0;so.test(W);)++ue;return ue}function lc(W){return W.match(so)||[]}function cf(W){return W.match(xs)||[]}var he=function W(ue){ue=ue==null?er:be.defaults(er.Object(),ue,be.pick(er,bs));var me=ue.Array,$e=ue.Date,Qe=ue.Error,nt=ue.Function,Xt=ue.Math,Ht=ue.Object,fo=ue.RegExp,ju=ue.String,hr=ue.TypeError,uf=me.prototype,h0=nt.prototype,cc=Ht.prototype,_u=ue["__core-js_shared__"],ku=h0.toString,pn=cc.hasOwnProperty,Na=0,hp=function(){var m=/[^.]+$/.exec(_u&&_u.keys&&_u.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),ei=cc.toString,Yi=ku.call(Ht),uc=er._,pp=fo("^"+ku.call(pn).replace(Zn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ol=hu?ue.Buffer:t,Ca=ue.Symbol,dc=ue.Uint8Array,ll=ol?ol.allocUnsafe:t,Eu=Su(Ht.getPrototypeOf,Ht),Tu=Ht.create,cl=cc.propertyIsEnumerable,df=uf.splice,fi=Ca?Ca.isConcatSpreadable:t,ul=Ca?Ca.iterator:t,ti=Ca?Ca.toStringTag:t,Au=function(){try{var m=wo(Ht,"defineProperty");return m({},"",{}),m}catch{}}(),ff=ue.clearTimeout!==er.clearTimeout&&ue.clearTimeout,dl=$e&&$e.now!==er.Date.now&&$e.now,mp=ue.setTimeout!==er.setTimeout&&ue.setTimeout,fc=Xt.ceil,Ns=Xt.floor,ho=Ht.getOwnPropertySymbols,hf=ol?ol.isBuffer:t,Pu=ue.isFinite,Wi=uf.join,Qi=Su(Ht.keys,Ht),Bn=Xt.max,Hn=Xt.min,Cs=$e.now,fl=ue.parseInt,gp=Xt.random,yp=uf.reverse,Du=wo(ue,"DataView"),xr=wo(ue,"Map"),Gn=wo(ue,"Promise"),Zt=wo(ue,"Set"),ja=wo(ue,"WeakMap"),hi=wo(Ht,"create"),hc=ja&&new ja,Ji={},Pg=Is(Du),Dg=Is(xr),Iu=Is(Gn),Mu=Is(Zt),Ig=Is(ja),po=Ca?Ca.prototype:t,hl=po?po.valueOf:t,mo=po?po.toString:t;function X(m){if(tr(m)&&!Pt(m)&&!(m instanceof Gt)){if(m instanceof pi)return m;if(pn.call(m,"__wrapped__"))return vr(m)}return new pi(m)}var Di=function(){function m(){}return function(y){if(!Wn(y))return{};if(Tu)return Tu(y);m.prototype=y;var _=new m;return m.prototype=t,_}}();function Ki(){}function pi(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}X.templateSettings={escape:_r,evaluate:Wr,interpolate:li,variable:"",imports:{_:X}},X.prototype=Ki.prototype,X.prototype.constructor=X,pi.prototype=Di(Ki.prototype),pi.prototype.constructor=pi;function Gt(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ae,this.__views__=[]}function Ru(){var m=new Gt(this.__wrapped__);return m.__actions__=br(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=br(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=br(this.__views__),m}function pf(){if(this.__filtered__){var m=new Gt(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function pl(){var m=this.__wrapped__.value(),y=this.__dir__,_=Pt(m),O=y<0,Y=_?m.length:0,le=fy(0,Y,this.__views__),pe=le.start,Ne=le.end,Te=Ne-pe,Ge=O?Ne:pe-1,We=this.__iteratees__,et=We.length,dt=0,pt=Hn(Te,this.__takeCount__);if(!_||!O&&Y==Te&&pt==Te)return Xg(m,this.__actions__);var Et=[];e:for(;Te--&&dt<pt;){Ge+=y;for(var Wt=-1,Tt=m[Ge];++Wt<et;){var nn=We[Wt],dn=nn.iteratee,Da=nn.type,$i=dn(Tt);if(Da==oe)Tt=$i;else if(!$i){if(Da==te)continue e;break e}}Et[dt++]=Tt}return Et}Gt.prototype=Di(Ki.prototype),Gt.prototype.constructor=Gt;function ar(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function mf(){this.__data__=hi?hi(null):{},this.size=0}function Mg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function p0(m){var y=this.__data__;if(hi){var _=y[m];return _===u?t:_}return pn.call(y,m)?y[m]:t}function m0(m){var y=this.__data__;return hi?y[m]!==t:pn.call(y,m)}function g0(m,y){var _=this.__data__;return this.size+=this.has(m)?0:1,_[m]=hi&&y===t?u:y,this}ar.prototype.clear=mf,ar.prototype.delete=Mg,ar.prototype.get=p0,ar.prototype.has=m0,ar.prototype.set=g0;function Pn(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function xp(){this.__data__=[],this.size=0}function Ou(m){var y=this.__data__,_=gc(y,m);if(_<0)return!1;var O=y.length-1;return _==O?y.pop():df.call(y,_,1),--this.size,!0}function Lu(m){var y=this.__data__,_=gc(y,m);return _<0?t:y[_][1]}function bp(m){return gc(this.__data__,m)>-1}function pc(m,y){var _=this.__data__,O=gc(_,m);return O<0?(++this.size,_.push([m,y])):_[O][1]=y,this}Pn.prototype.clear=xp,Pn.prototype.delete=Ou,Pn.prototype.get=Lu,Pn.prototype.has=bp,Pn.prototype.set=pc;function mi(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function y0(){this.size=0,this.__data__={hash:new ar,map:new(xr||Pn),string:new ar}}function Rg(m){var y=Sc(this,m).delete(m);return this.size-=y?1:0,y}function x0(m){return Sc(this,m).get(m)}function Og(m){return Sc(this,m).has(m)}function ml(m,y){var _=Sc(this,m),O=_.size;return _.set(m,y),this.size+=_.size==O?0:1,this}mi.prototype.clear=y0,mi.prototype.delete=Rg,mi.prototype.get=x0,mi.prototype.has=Og,mi.prototype.set=ml;function js(m){var y=-1,_=m==null?0:m.length;for(this.__data__=new mi;++y<_;)this.add(m[y])}function gf(m){return this.__data__.set(m,u),this}function Lg(m){return this.__data__.has(m)}js.prototype.add=js.prototype.push=gf,js.prototype.has=Lg;function ni(m){var y=this.__data__=new Pn(m);this.size=y.size}function Fg(){this.__data__=new Pn,this.size=0}function yf(m){var y=this.__data__,_=y.delete(m);return this.size=y.size,_}function vp(m){return this.__data__.get(m)}function $g(m){return this.__data__.has(m)}function xf(m,y){var _=this.__data__;if(_ instanceof Pn){var O=_.__data__;if(!xr||O.length<a-1)return O.push([m,y]),this.size=++_.size,this;_=this.__data__=new mi(O)}return _.set(m,y),this.size=_.size,this}ni.prototype.clear=Fg,ni.prototype.delete=yf,ni.prototype.get=vp,ni.prototype.has=$g,ni.prototype.set=xf;function wp(m,y){var _=Pt(m),O=!_&&Ls(m),Y=!_&&!O&&Po(m),le=!_&&!O&&!Y&&Oc(m),pe=_||O||Y||le,Ne=pe?wa(m.length,ju):[],Te=Ne.length;for(var Ge in m)(y||pn.call(m,Ge))&&!(pe&&(Ge=="length"||Y&&(Ge=="offset"||Ge=="parent")||le&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||Ta(Ge,Te)))&&Ne.push(Ge);return Ne}function mc(m){var y=m.length;return y?m[Ef(0,y-1)]:t}function zg(m,y){return ud(br(m),ka(y,0,m.length))}function Bg(m){return ud(br(m))}function Ka(m,y,_){(_!==t&&!Si(m[y],_)||_===t&&!(y in m))&&_a(m,y,_)}function gl(m,y,_){var O=m[y];(!(pn.call(m,y)&&Si(O,_))||_===t&&!(y in m))&&_a(m,y,_)}function gc(m,y){for(var _=m.length;_--;)if(Si(m[_][0],y))return _;return-1}function go(m,y,_,O){return ks(m,function(Y,le,pe){y(O,Y,_(Y),pe)}),O}function _s(m,y){return m&&xi(y,Nr(y),m)}function Fu(m,y){return m&&xi(y,Tr(y),m)}function _a(m,y,_){y=="__proto__"&&Au?Au(m,y,{configurable:!0,enumerable:!0,value:_,writable:!0}):m[y]=_}function $u(m,y){for(var _=-1,O=y.length,Y=me(O),le=m==null;++_<O;)Y[_]=le?t:Cd(m,y[_]);return Y}function ka(m,y,_){return m===m&&(_!==t&&(m=m<=_?m:_),y!==t&&(m=m>=y?m:y)),m}function Vr(m,y,_,O,Y,le){var pe,Ne=y&g,Te=y&b,Ge=y&v;if(_&&(pe=Y?_(m,O,Y,le):_(m)),pe!==t)return pe;if(!Wn(m))return m;var We=Pt(m);if(We){if(pe=Yp(m),!Ne)return br(m,pe)}else{var et=Er(m),dt=et==Ke||et==Oe;if(Po(m))return $p(m,Ne);if(et==Ee||et==Se||dt&&!Y){if(pe=Te||dt?{}:Wp(m),!Ne)return Te?Xu(m,Fu(pe,m)):Mf(m,_s(pe,m))}else{if(!cn[et])return Y?m:{};pe=Qp(m,et,Ne)}}le||(le=new ni);var pt=le.get(m);if(pt)return pt;le.set(m,pe),ix(m)?m.forEach(function(Tt){pe.add(Vr(Tt,y,_,Tt,m,le))}):ah(m)&&m.forEach(function(Tt,nn){pe.set(nn,Vr(Tt,y,_,nn,m,le))});var Et=Ge?Te?Ff:Lf:Te?Tr:Nr,Wt=We?t:Et(m);return Ur(Wt||m,function(Tt,nn){Wt&&(nn=Tt,Tt=m[nn]),gl(pe,nn,Vr(Tt,y,_,nn,m,le))}),pe}function Ug(m){var y=Nr(m);return function(_){return Sp(_,m,y)}}function Sp(m,y,_){var O=_.length;if(m==null)return!O;for(m=Ht(m);O--;){var Y=_[O],le=y[Y],pe=m[Y];if(pe===t&&!(Y in m)||!le(pe))return!1}return!0}function yl(m,y,_){if(typeof m!="function")throw new hr(l);return Cc(function(){m.apply(t,_)},y)}function yo(m,y,_,O){var Y=-1,le=ec,pe=!0,Ne=m.length,Te=[],Ge=y.length;if(!Ne)return Te;_&&(y=Rn(y,Xr(_))),O?(le=gu,pe=!1):y.length>=a&&(le=lo,pe=!1,y=new js(y));e:for(;++Y<Ne;){var We=m[Y],et=_==null?We:_(We);if(We=O||We!==0?We:0,pe&&et===et){for(var dt=Ge;dt--;)if(y[dt]===et)continue e;Te.push(We)}else le(y,et,O)||Te.push(We)}return Te}var ks=qp(Hr),bf=qp(xc,!0);function Np(m,y){var _=!0;return ks(m,function(O,Y,le){return _=!!y(O,Y,le),_}),_}function Ea(m,y,_){for(var O=-1,Y=m.length;++O<Y;){var le=m[O],pe=y(le);if(pe!=null&&(Ne===t?pe===pe&&!ai(pe):_(pe,Ne)))var Ne=pe,Te=le}return Te}function Bt(m,y,_,O){var Y=m.length;for(_=Ot(_),_<0&&(_=-_>Y?0:Y+_),O=O===t||O>Y?Y:Ot(O),O<0&&(O+=Y),O=_>O?0:ss(O);_<O;)m[_++]=y;return m}function vn(m,y){var _=[];return ks(m,function(O,Y,le){y(O,Y,le)&&_.push(O)}),_}function en(m,y,_,O,Y){var le=-1,pe=m.length;for(_||(_=Ps),Y||(Y=[]);++le<pe;){var Ne=m[le];y>0&&_(Ne)?y>1?en(Ne,y-1,_,O,Y):va(Y,Ne):O||(Y[Y.length]=Ne)}return Y}var yc=Cl(),xl=Cl(!0);function Hr(m,y){return m&&yc(m,y,Nr)}function xc(m,y){return m&&xl(m,y,Nr)}function xo(m,y){return qi(y,function(_){return Aa(m[_])})}function Xi(m,y){y=Ts(y,m);for(var _=0,O=y.length;m!=null&&_<O;)m=m[bn(y[_++])];return _&&_==O?m:t}function qg(m,y,_){var O=y(m);return Pt(m)?O:va(O,_(m))}function tn(m){return m==null?m===t?on:ve:ti&&ti in Ht(m)?dy(m):yy(m)}function zu(m,y){return m>y}function Cp(m,y){return m!=null&&pn.call(m,y)}function Vg(m,y){return m!=null&&y in Ht(m)}function Hg(m,y,_){return m>=Hn(y,_)&&m<Bn(y,_)}function jp(m,y,_){for(var O=_?gu:ec,Y=m[0].length,le=m.length,pe=le,Ne=me(le),Te=1/0,Ge=[];pe--;){var We=m[pe];pe&&y&&(We=Rn(We,Xr(y))),Te=Hn(We.length,Te),Ne[pe]=!_&&(y||Y>=120&&We.length>=120)?new js(pe&&We):t}We=m[0];var et=-1,dt=Ne[0];e:for(;++et<Y&&Ge.length<Te;){var pt=We[et],Et=y?y(pt):pt;if(pt=_||pt!==0?pt:0,!(dt?lo(dt,Et):O(Ge,Et,_))){for(pe=le;--pe;){var Wt=Ne[pe];if(!(Wt?lo(Wt,Et):O(m[pe],Et,_)))continue e}dt&&dt.push(Et),Ge.push(pt)}}return Ge}function _p(m,y,_,O){return Hr(m,function(Y,le,pe){y(O,_(Y),le,pe)}),O}function bl(m,y,_){y=Ts(y,m),m=Nc(m,y);var O=m==null?m:m[bn(Gr(y))];return O==null?t:fr(O,m,_)}function vf(m){return tr(m)&&tn(m)==Se}function gi(m){return tr(m)&&tn(m)==re}function pr(m){return tr(m)&&tn(m)==_e}function vl(m,y,_,O,Y){return m===y?!0:m==null||y==null||!tr(m)&&!tr(y)?m!==m&&y!==y:Bu(m,y,_,O,vl,Y)}function Bu(m,y,_,O,Y,le){var pe=Pt(m),Ne=Pt(y),Te=pe?fe:Er(m),Ge=Ne?fe:Er(y);Te=Te==Se?Ee:Te,Ge=Ge==Se?Ee:Ge;var We=Te==Ee,et=Ge==Ee,dt=Te==Ge;if(dt&&Po(m)){if(!Po(y))return!1;pe=!0,We=!1}if(dt&&!We)return le||(le=new ni),pe||Oc(m)?cy(m,y,_,O,Y,le):uy(m,y,Te,_,O,Y,le);if(!(_&S)){var pt=We&&pn.call(m,"__wrapped__"),Et=et&&pn.call(y,"__wrapped__");if(pt||Et){var Wt=pt?m.value():m,Tt=Et?y.value():y;return le||(le=new ni),Y(Wt,Tt,_,O,le)}}return dt?(le||(le=new ni),kr(m,y,_,O,Y,le)):!1}function wf(m){return tr(m)&&Er(m)==xe}function Uu(m,y,_,O){var Y=_.length,le=Y,pe=!O;if(m==null)return!le;for(m=Ht(m);Y--;){var Ne=_[Y];if(pe&&Ne[2]?Ne[1]!==m[Ne[0]]:!(Ne[0]in m))return!1}for(;++Y<le;){Ne=_[Y];var Te=Ne[0],Ge=m[Te],We=Ne[1];if(pe&&Ne[2]){if(Ge===t&&!(Te in m))return!1}else{var et=new ni;if(O)var dt=O(Ge,We,Te,m,y,et);if(!(dt===t?vl(We,Ge,S|k,O,et):dt))return!1}}return!0}function Xa(m){if(!Wn(m)||Vf(m))return!1;var y=Aa(m)?pp:Zd;return y.test(Is(m))}function Sf(m){return tr(m)&&tn(m)==lt}function kp(m){return tr(m)&&Er(m)==Ze}function Ep(m){return tr(m)&&Tl(m.length)&&!!xn[tn(m)]}function Tp(m){return typeof m=="function"?m:m==null?Re:typeof m=="object"?Pt(m)?jf(m[0],m[1]):Pp(m):un(m)}function Nf(m){if(!Dn(m))return Qi(m);var y=[];for(var _ in Ht(m))pn.call(m,_)&&_!="constructor"&&y.push(_);return y}function Gg(m){if(!Wn(m))return So(m);var y=Dn(m),_=[];for(var O in m)O=="constructor"&&(y||!pn.call(m,O))||_.push(O);return _}function Cf(m,y){return m<y}function Ap(m,y){var _=-1,O=wr(m)?me(m.length):[];return ks(m,function(Y,le,pe){O[++_]=y(Y,le,pe)}),O}function Pp(m){var y=zf(m);return y.length==1&&y[0][2]?my(y[0][0],y[0][1]):function(_){return _===m||Uu(_,m,y)}}function jf(m,y){return Uf(m)&&py(y)?my(bn(m),y):function(_){var O=Cd(_,m);return O===t&&O===y?zc(_,m):vl(y,O,S|k)}}function qu(m,y,_,O,Y){m!==y&&yc(y,function(le,pe){if(Y||(Y=new ni),Wn(le))b0(m,y,pe,_,qu,O,Y);else{var Ne=O?O(Hf(m,pe),le,pe+"",m,y,Y):t;Ne===t&&(Ne=le),Ka(m,pe,Ne)}},Tr)}function b0(m,y,_,O,Y,le,pe){var Ne=Hf(m,_),Te=Hf(y,_),Ge=pe.get(Te);if(Ge){Ka(m,_,Ge);return}var We=le?le(Ne,Te,_+"",m,y,pe):t,et=We===t;if(et){var dt=Pt(Te),pt=!dt&&Po(Te),Et=!dt&&!pt&&Oc(Te);We=Te,dt||pt||Et?Pt(Ne)?We=Ne:lr(Ne)?We=br(Ne):pt?(et=!1,We=$p(Te,!0)):Et?(et=!1,We=Bp(Te,!0)):We=[]:na(Te)||Ls(Te)?(We=Ne,Ls(Ne)?We=ox(Ne):(!Wn(Ne)||Aa(Ne))&&(We=Wp(Te))):et=!1}et&&(pe.set(Te,We),Y(We,Te,O,le,pe),pe.delete(Te)),Ka(m,_,We)}function Dp(m,y){var _=m.length;if(_)return y+=y<0?_:0,Ta(y,_)?m[y]:t}function Ip(m,y,_){y.length?y=Rn(y,function(le){return Pt(le)?function(pe){return Xi(pe,le.length===1?le[0]:le)}:le}):y=[Re];var O=-1;y=Rn(y,Xr(bt()));var Y=Ap(m,function(le,pe,Ne){var Te=Rn(y,function(Ge){return Ge(le)});return{criteria:Te,index:++O,value:le}});return rc(Y,function(le,pe){return ny(le,pe,_)})}function Yg(m,y){return _f(m,y,function(_,O){return zc(m,O)})}function _f(m,y,_){for(var O=-1,Y=y.length,le={};++O<Y;){var pe=y[O],Ne=Xi(m,pe);_(Ne,pe)&&vc(le,Ts(pe,m),Ne)}return le}function Wg(m){return function(y){return Xi(y,m)}}function kf(m,y,_,O){var Y=O?Vi:Kr,le=-1,pe=y.length,Ne=m;for(m===y&&(y=br(y)),_&&(Ne=Rn(m,Xr(_)));++le<pe;)for(var Te=0,Ge=y[le],We=_?_(Ge):Ge;(Te=Y(Ne,We,Te,O))>-1;)Ne!==m&&df.call(Ne,Te,1),df.call(m,Te,1);return m}function Mp(m,y){for(var _=m?y.length:0,O=_-1;_--;){var Y=y[_];if(_==O||Y!==le){var le=Y;Ta(Y)?df.call(m,Y,1):Yu(m,Y)}}return m}function Ef(m,y){return m+Ns(gp()*(y-m+1))}function Qg(m,y,_,O){for(var Y=-1,le=Bn(fc((y-m)/(_||1)),0),pe=me(le);le--;)pe[O?le:++Y]=m,m+=_;return pe}function Rp(m,y){var _="";if(!m||y<1||y>J)return _;do y%2&&(_+=m),y=Ns(y/2),y&&(m+=m);while(y);return _}function Ft(m,y){return ld(Jp(m,y,Re),m+"")}function bc(m){return mc(Uc(m))}function Tf(m,y){var _=Uc(m);return ud(_,ka(y,0,_.length))}function vc(m,y,_,O){if(!Wn(m))return m;y=Ts(y,m);for(var Y=-1,le=y.length,pe=le-1,Ne=m;Ne!=null&&++Y<le;){var Te=bn(y[Y]),Ge=_;if(Te==="__proto__"||Te==="constructor"||Te==="prototype")return m;if(Y!=pe){var We=Ne[Te];Ge=O?O(We,Te,Ne):t,Ge===t&&(Ge=Wn(We)?We:Ta(y[Y+1])?[]:{})}gl(Ne,Te,Ge),Ne=Ne[Te]}return m}var Vu=hc?function(m,y){return hc.set(m,y),m}:Re,Hu=Au?function(m,y){return Au(m,"toString",{configurable:!0,enumerable:!1,value:Ie(y),writable:!0})}:Re;function Jg(m){return ud(Uc(m))}function Ii(m,y,_){var O=-1,Y=m.length;y<0&&(y=-y>Y?0:Y+y),_=_>Y?Y:_,_<0&&(_+=Y),Y=y>_?0:_-y>>>0,y>>>=0;for(var le=me(Y);++O<Y;)le[O]=m[O+y];return le}function Kg(m,y){var _;return ks(m,function(O,Y,le){return _=y(O,Y,le),!_}),!!_}function Gu(m,y,_){var O=0,Y=m==null?O:m.length;if(typeof y=="number"&&y===y&&Y<=M){for(;O<Y;){var le=O+Y>>>1,pe=m[le];pe!==null&&!ai(pe)&&(_?pe<=y:pe<y)?O=le+1:Y=le}return Y}return Af(m,y,Re,_)}function Af(m,y,_,O){var Y=0,le=m==null?0:m.length;if(le===0)return 0;y=_(y);for(var pe=y!==y,Ne=y===null,Te=ai(y),Ge=y===t;Y<le;){var We=Ns((Y+le)/2),et=_(m[We]),dt=et!==t,pt=et===null,Et=et===et,Wt=ai(et);if(pe)var Tt=O||Et;else Ge?Tt=Et&&(O||dt):Ne?Tt=Et&&dt&&(O||!pt):Te?Tt=Et&&dt&&!pt&&(O||!Wt):pt||Wt?Tt=!1:Tt=O?et<=y:et<y;Tt?Y=We+1:le=We}return Hn(le,ce)}function Op(m,y){for(var _=-1,O=m.length,Y=0,le=[];++_<O;){var pe=m[_],Ne=y?y(pe):pe;if(!_||!Si(Ne,Te)){var Te=Ne;le[Y++]=pe===0?0:pe}}return le}function Pf(m){return typeof m=="number"?m:ai(m)?A:+m}function yi(m){if(typeof m=="string")return m;if(Pt(m))return Rn(m,yi)+"";if(ai(m))return mo?mo.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Es(m,y,_){var O=-1,Y=ec,le=m.length,pe=!0,Ne=[],Te=Ne;if(_)pe=!1,Y=gu;else if(le>=a){var Ge=y?null:oy(m);if(Ge)return oc(Ge);pe=!1,Y=lo,Te=new js}else Te=y?[]:Ne;e:for(;++O<le;){var We=m[O],et=y?y(We):We;if(We=_||We!==0?We:0,pe&&et===et){for(var dt=Te.length;dt--;)if(Te[dt]===et)continue e;y&&Te.push(et),Ne.push(We)}else Y(Te,et,_)||(Te!==Ne&&Te.push(et),Ne.push(We))}return Ne}function Yu(m,y){return y=Ts(y,m),m=Nc(m,y),m==null||delete m[bn(Gr(y))]}function Lp(m,y,_,O){return vc(m,y,_(Xi(m,y)),O)}function Wu(m,y,_,O){for(var Y=m.length,le=O?Y:-1;(O?le--:++le<Y)&&y(m[le],le,m););return _?Ii(m,O?0:le,O?le+1:Y):Ii(m,O?le+1:0,O?Y:le)}function Xg(m,y){var _=m;return _ instanceof Gt&&(_=_.value()),yu(y,function(O,Y){return Y.func.apply(Y.thisArg,va([O],Y.args))},_)}function Qu(m,y,_){var O=m.length;if(O<2)return O?Es(m[0]):[];for(var Y=-1,le=me(O);++Y<O;)for(var pe=m[Y],Ne=-1;++Ne<O;)Ne!=Y&&(le[Y]=yo(le[Y]||pe,m[Ne],y,_));return Es(en(le,1),y,_)}function Fp(m,y,_){for(var O=-1,Y=m.length,le=y.length,pe={};++O<Y;){var Ne=O<le?y[O]:t;_(pe,m[O],Ne)}return pe}function Df(m){return lr(m)?m:[]}function Ju(m){return typeof m=="function"?m:Re}function Ts(m,y){return Pt(m)?m:Uf(m,y)?[m]:ns(mn(m))}var Zg=Ft;function bo(m,y,_){var O=m.length;return _=_===t?O:_,!y&&_>=O?m:Ii(m,y,_)}var ey=ff||function(m){return er.clearTimeout(m)};function $p(m,y){if(y)return m.slice();var _=m.length,O=ll?ll(_):new m.constructor(_);return m.copy(O),O}function wl(m){var y=new m.constructor(m.byteLength);return new dc(y).set(new dc(m)),y}function zp(m,y){var _=y?wl(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.byteLength)}function If(m){var y=new m.constructor(m.source,qa.exec(m));return y.lastIndex=m.lastIndex,y}function ty(m){return hl?Ht(hl.call(m)):{}}function Bp(m,y){var _=y?wl(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.length)}function Ku(m,y){if(m!==y){var _=m!==t,O=m===null,Y=m===m,le=ai(m),pe=y!==t,Ne=y===null,Te=y===y,Ge=ai(y);if(!Ne&&!Ge&&!le&&m>y||le&&pe&&Te&&!Ne&&!Ge||O&&pe&&Te||!_&&Te||!Y)return 1;if(!O&&!le&&!Ge&&m<y||Ge&&_&&Y&&!O&&!le||Ne&&_&&Y||!pe&&Y||!Te)return-1}return 0}function ny(m,y,_){for(var O=-1,Y=m.criteria,le=y.criteria,pe=Y.length,Ne=_.length;++O<pe;){var Te=Ku(Y[O],le[O]);if(Te){if(O>=Ne)return Te;var Ge=_[O];return Te*(Ge=="desc"?-1:1)}}return m.index-y.index}function Up(m,y,_,O){for(var Y=-1,le=m.length,pe=_.length,Ne=-1,Te=y.length,Ge=Bn(le-pe,0),We=me(Te+Ge),et=!O;++Ne<Te;)We[Ne]=y[Ne];for(;++Y<pe;)(et||Y<le)&&(We[_[Y]]=m[Y]);for(;Ge--;)We[Ne++]=m[Y++];return We}function ry(m,y,_,O){for(var Y=-1,le=m.length,pe=-1,Ne=_.length,Te=-1,Ge=y.length,We=Bn(le-Ne,0),et=me(We+Ge),dt=!O;++Y<We;)et[Y]=m[Y];for(var pt=Y;++Te<Ge;)et[pt+Te]=y[Te];for(;++pe<Ne;)(dt||Y<le)&&(et[pt+_[pe]]=m[Y++]);return et}function br(m,y){var _=-1,O=m.length;for(y||(y=me(O));++_<O;)y[_]=m[_];return y}function xi(m,y,_,O){var Y=!_;_||(_={});for(var le=-1,pe=y.length;++le<pe;){var Ne=y[le],Te=O?O(_[Ne],m[Ne],Ne,_,m):t;Te===t&&(Te=m[Ne]),Y?_a(_,Ne,Te):gl(_,Ne,Te)}return _}function Mf(m,y){return xi(m,id(m),y)}function Xu(m,y){return xi(m,Bf(m),y)}function Sl(m,y){return function(_,O){var Y=Pt(_)?Zl:go,le=y?y():{};return Y(_,m,bt(O,2),le)}}function Nl(m){return Ft(function(y,_){var O=-1,Y=_.length,le=Y>1?_[Y-1]:t,pe=Y>2?_[2]:t;for(le=m.length>3&&typeof le=="function"?(Y--,le):t,pe&&ii(_[0],_[1],pe)&&(le=Y<3?t:le,Y=1),y=Ht(y);++O<Y;){var Ne=_[O];Ne&&m(y,Ne,O,le)}return y})}function qp(m,y){return function(_,O){if(_==null)return _;if(!wr(_))return m(_,O);for(var Y=_.length,le=y?Y:-1,pe=Ht(_);(y?le--:++le<Y)&&O(pe[le],le,pe)!==!1;);return _}}function Cl(m){return function(y,_,O){for(var Y=-1,le=Ht(y),pe=O(y),Ne=pe.length;Ne--;){var Te=pe[m?Ne:++Y];if(_(le[Te],Te,le)===!1)break}return y}}function iy(m,y,_){var O=y&E,Y=Zi(m);function le(){var pe=this&&this!==er&&this instanceof le?Y:m;return pe.apply(O?_:this,arguments)}return le}function Mi(m){return function(y){y=mn(y);var _=Qa(y)?di(y):t,O=_?_[0]:y.charAt(0),Y=_?bo(_,1).join(""):y.slice(1);return O[m]()+Y}}function ri(m){return function(y){return yu(N(Fs(y).replace(el,"")),m,"")}}function Zi(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var _=Di(m.prototype),O=m.apply(_,y);return Wn(O)?O:_}}function ay(m,y,_){var O=Zi(m);function Y(){for(var le=arguments.length,pe=me(le),Ne=le,Te=_l(Y);Ne--;)pe[Ne]=arguments[Ne];var Ge=le<3&&pe[0]!==Te&&pe[le-1]!==Te?[]:Ja(pe,Te);if(le-=Ge.length,le<_)return Vp(m,y,sr,Y.placeholder,t,pe,Ge,t,t,_-le);var We=this&&this!==er&&this instanceof Y?O:m;return fr(We,this,pe)}return Y}function As(m){return function(y,_,O){var Y=Ht(y);if(!wr(y)){var le=bt(_,3);y=Nr(y),_=function(Ne){return le(Y[Ne],Ne,Y)}}var pe=m(y,_,O);return pe>-1?Y[le?y[pe]:pe]:t}}function Za(m){return Un(function(y){var _=y.length,O=_,Y=pi.prototype.thru;for(m&&y.reverse();O--;){var le=y[O];if(typeof le!="function")throw new hr(l);if(Y&&!pe&&rd(le)=="wrapper")var pe=new pi([],!0)}for(O=pe?O:_;++O<_;){le=y[O];var Ne=rd(le),Te=Ne=="wrapper"?$f(le):t;Te&&qf(Te[0])&&Te[1]==(B|D|F|z)&&!Te[4].length&&Te[9]==1?pe=pe[rd(Te[0])].apply(pe,Te[3]):pe=le.length==1&&qf(le)?pe[Ne]():pe.thru(le)}return function(){var Ge=arguments,We=Ge[0];if(pe&&Ge.length==1&&Pt(We))return pe.plant(We).value();for(var et=0,dt=_?y[et].apply(this,Ge):We;++et<_;)dt=y[et].call(this,dt);return dt}})}function sr(m,y,_,O,Y,le,pe,Ne,Te,Ge){var We=y&B,et=y&E,dt=y&T,pt=y&(D|q),Et=y&U,Wt=dt?t:Zi(m);function Tt(){for(var nn=arguments.length,dn=me(nn),Da=nn;Da--;)dn[Da]=arguments[Da];if(pt)var $i=_l(Tt),Ia=up(dn,$i);if(O&&(dn=Up(dn,O,Y,pt)),le&&(dn=ry(dn,le,pe,pt)),nn-=Ia,pt&&nn<Ge){var Cr=Ja(dn,$i);return Vp(m,y,sr,Tt.placeholder,_,dn,Cr,Ne,Te,Ge-nn)}var $s=et?_:this,Al=dt?$s[m]:m;return nn=dn.length,Ne?dn=ts(dn,Ne):Et&&nn>1&&dn.reverse(),We&&Te<nn&&(dn.length=Te),this&&this!==er&&this instanceof Tt&&(Al=Wt||Zi(Al)),Al.apply($s,dn)}return Tt}function Zu(m,y){return function(_,O){return _p(_,m,y(O),{})}}function wc(m,y){return function(_,O){var Y;if(_===t&&O===t)return y;if(_!==t&&(Y=_),O!==t){if(Y===t)return O;typeof _=="string"||typeof O=="string"?(_=yi(_),O=yi(O)):(_=Pf(_),O=Pf(O)),Y=m(_,O)}return Y}}function ed(m){return Un(function(y){return y=Rn(y,Xr(bt())),Ft(function(_){var O=this;return m(y,function(Y){return fr(Y,O,_)})})})}function td(m,y){y=y===t?" ":yi(y);var _=y.length;if(_<2)return _?Rp(y,m):y;var O=Rp(y,fc(m/Gi(y)));return Qa(y)?bo(di(O),0,m).join(""):O.slice(0,m)}function sy(m,y,_,O){var Y=y&E,le=Zi(m);function pe(){for(var Ne=-1,Te=arguments.length,Ge=-1,We=O.length,et=me(We+Te),dt=this&&this!==er&&this instanceof pe?le:m;++Ge<We;)et[Ge]=O[Ge];for(;Te--;)et[Ge++]=arguments[++Ne];return fr(dt,Y?_:this,et)}return pe}function vo(m){return function(y,_,O){return O&&typeof O!="number"&&ii(y,_,O)&&(_=O=t),y=as(y),_===t?(_=y,y=0):_=as(_),O=O===t?y<_?1:-1:as(O),Qg(y,_,O,m)}}function jl(m){return function(y,_){return typeof y=="string"&&typeof _=="string"||(y=ra(y),_=ra(_)),m(y,_)}}function Vp(m,y,_,O,Y,le,pe,Ne,Te,Ge){var We=y&D,et=We?pe:t,dt=We?t:pe,pt=We?le:t,Et=We?t:le;y|=We?F:$,y&=~(We?$:F),y&I||(y&=-4);var Wt=[m,y,Y,pt,et,Et,dt,Ne,Te,Ge],Tt=_.apply(t,Wt);return qf(m)&&Gf(Tt,Wt),Tt.placeholder=O,Yf(Tt,m,y)}function Rf(m){var y=Xt[m];return function(_,O){if(_=ra(_),O=O==null?0:Hn(Ot(O),292),O&&Pu(_)){var Y=(mn(_)+"e").split("e"),le=y(Y[0]+"e"+(+Y[1]+O));return Y=(mn(le)+"e").split("e"),+(Y[0]+"e"+(+Y[1]-O))}return y(_)}}var oy=Zt&&1/oc(new Zt([,-0]))[1]==V?function(m){return new Zt(m)}:ht;function nd(m){return function(y){var _=Er(y);return _==xe?sc(y):_==Ze?dp(y):cp(y,m(y))}}function es(m,y,_,O,Y,le,pe,Ne){var Te=y&T;if(!Te&&typeof m!="function")throw new hr(l);var Ge=O?O.length:0;if(Ge||(y&=-97,O=Y=t),pe=pe===t?pe:Bn(Ot(pe),0),Ne=Ne===t?Ne:Ot(Ne),Ge-=Y?Y.length:0,y&$){var We=O,et=Y;O=Y=t}var dt=Te?t:$f(m),pt=[m,y,_,O,Y,We,et,le,pe,Ne];if(dt&&od(pt,dt),m=pt[0],y=pt[1],_=pt[2],O=pt[3],Y=pt[4],Ne=pt[9]=pt[9]===t?Te?0:m.length:Bn(pt[9]-Ge,0),!Ne&&y&(D|q)&&(y&=-25),!y||y==E)var Et=iy(m,y,_);else y==D||y==q?Et=ay(m,y,Ne):(y==F||y==(E|F))&&!Y.length?Et=sy(m,y,_,O):Et=sr.apply(t,pt);var Wt=dt?Vu:Gf;return Yf(Wt(Et,pt),m,y)}function Of(m,y,_,O){return m===t||Si(m,cc[_])&&!pn.call(O,_)?y:m}function Hp(m,y,_,O,Y,le){return Wn(m)&&Wn(y)&&(le.set(y,m),qu(m,y,t,Hp,le),le.delete(y)),m}function ly(m){return na(m)?t:m}function cy(m,y,_,O,Y,le){var pe=_&S,Ne=m.length,Te=y.length;if(Ne!=Te&&!(pe&&Te>Ne))return!1;var Ge=le.get(m),We=le.get(y);if(Ge&&We)return Ge==y&&We==m;var et=-1,dt=!0,pt=_&k?new js:t;for(le.set(m,y),le.set(y,m);++et<Ne;){var Et=m[et],Wt=y[et];if(O)var Tt=pe?O(Wt,Et,et,y,m,le):O(Et,Wt,et,m,y,le);if(Tt!==t){if(Tt)continue;dt=!1;break}if(pt){if(!xu(y,function(nn,dn){if(!lo(pt,dn)&&(Et===nn||Y(Et,nn,_,O,le)))return pt.push(dn)})){dt=!1;break}}else if(!(Et===Wt||Y(Et,Wt,_,O,le))){dt=!1;break}}return le.delete(m),le.delete(y),dt}function uy(m,y,_,O,Y,le,pe){switch(_){case je:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case re:return!(m.byteLength!=y.byteLength||!le(new dc(m),new dc(y)));case ie:case _e:case Me:return Si(+m,+y);case tt:return m.name==y.name&&m.message==y.message;case lt:case Rt:return m==y+"";case xe:var Ne=sc;case Ze:var Te=O&S;if(Ne||(Ne=oc),m.size!=y.size&&!Te)return!1;var Ge=pe.get(m);if(Ge)return Ge==y;O|=k,pe.set(m,y);var We=cy(Ne(m),Ne(y),O,Y,le,pe);return pe.delete(m),We;case kt:if(hl)return hl.call(m)==hl.call(y)}return!1}function kr(m,y,_,O,Y,le){var pe=_&S,Ne=Lf(m),Te=Ne.length,Ge=Lf(y),We=Ge.length;if(Te!=We&&!pe)return!1;for(var et=Te;et--;){var dt=Ne[et];if(!(pe?dt in y:pn.call(y,dt)))return!1}var pt=le.get(m),Et=le.get(y);if(pt&&Et)return pt==y&&Et==m;var Wt=!0;le.set(m,y),le.set(y,m);for(var Tt=pe;++et<Te;){dt=Ne[et];var nn=m[dt],dn=y[dt];if(O)var Da=pe?O(dn,nn,dt,y,m,le):O(nn,dn,dt,m,y,le);if(!(Da===t?nn===dn||Y(nn,dn,_,O,le):Da)){Wt=!1;break}Tt||(Tt=dt=="constructor")}if(Wt&&!Tt){var $i=m.constructor,Ia=y.constructor;$i!=Ia&&"constructor"in m&&"constructor"in y&&!(typeof $i=="function"&&$i instanceof $i&&typeof Ia=="function"&&Ia instanceof Ia)&&(Wt=!1)}return le.delete(m),le.delete(y),Wt}function Un(m){return ld(Jp(m,t,vi),m+"")}function Lf(m){return qg(m,Nr,id)}function Ff(m){return qg(m,Tr,Bf)}var $f=hc?function(m){return hc.get(m)}:ht;function rd(m){for(var y=m.name+"",_=Ji[y],O=pn.call(Ji,y)?_.length:0;O--;){var Y=_[O],le=Y.func;if(le==null||le==m)return Y.name}return y}function _l(m){var y=pn.call(X,"placeholder")?X:m;return y.placeholder}function bt(){var m=X.iteratee||Nt;return m=m===Nt?Tp:m,arguments.length?m(arguments[0],arguments[1]):m}function Sc(m,y){var _=m.__data__;return Ds(y)?_[typeof y=="string"?"string":"hash"]:_.map}function zf(m){for(var y=Nr(m),_=y.length;_--;){var O=y[_],Y=m[O];y[_]=[O,Y,py(Y)]}return y}function wo(m,y){var _=wu(m,y);return Xa(_)?_:t}function dy(m){var y=pn.call(m,ti),_=m[ti];try{m[ti]=t;var O=!0}catch{}var Y=ei.call(m);return O&&(y?m[ti]=_:delete m[ti]),Y}var id=ho?function(m){return m==null?[]:(m=Ht(m),qi(ho(m),function(y){return cl.call(m,y)}))}:nv,Bf=ho?function(m){for(var y=[];m;)va(y,id(m)),m=Eu(m);return y}:nv,Er=tn;(Du&&Er(new Du(new ArrayBuffer(1)))!=je||xr&&Er(new xr)!=xe||Gn&&Er(Gn.resolve())!=Pe||Zt&&Er(new Zt)!=Ze||ja&&Er(new ja)!=se)&&(Er=function(m){var y=tn(m),_=y==Ee?m.constructor:t,O=_?Is(_):"";if(O)switch(O){case Pg:return je;case Dg:return xe;case Iu:return Pe;case Mu:return Ze;case Ig:return se}return y});function fy(m,y,_){for(var O=-1,Y=_.length;++O<Y;){var le=_[O],pe=le.size;switch(le.type){case"drop":m+=pe;break;case"dropRight":y-=pe;break;case"take":y=Hn(y,m+pe);break;case"takeRight":m=Bn(m,y-pe);break}}return{start:m,end:y}}function Gp(m){var y=m.match(ip);return y?y[1].split(Xd):[]}function ad(m,y,_){y=Ts(y,m);for(var O=-1,Y=y.length,le=!1;++O<Y;){var pe=bn(y[O]);if(!(le=m!=null&&_(m,pe)))break;m=m[pe]}return le||++O!=Y?le:(Y=m==null?0:m.length,!!Y&&Tl(Y)&&Ta(pe,Y)&&(Pt(m)||Ls(m)))}function Yp(m){var y=m.length,_=new m.constructor(y);return y&&typeof m[0]=="string"&&pn.call(m,"index")&&(_.index=m.index,_.input=m.input),_}function Wp(m){return typeof m.constructor=="function"&&!Dn(m)?Di(Eu(m)):{}}function Qp(m,y,_){var O=m.constructor;switch(y){case re:return wl(m);case ie:case _e:return new O(+m);case je:return zp(m,_);case Ae:case Ue:case ot:case mt:case ft:case Be:case Xe:case Fe:case st:return Bp(m,_);case xe:return new O;case Me:case Rt:return new O(m);case lt:return If(m);case Ze:return new O;case kt:return ty(m)}}function hy(m,y){var _=y.length;if(!_)return m;var O=_-1;return y[O]=(_>1?"& ":"")+y[O],y=y.join(_>2?", ":" "),m.replace(rp,`{
/* [wrapped with `+y+`] */
`)}function Ps(m){return Pt(m)||Ls(m)||!!(fi&&m&&m[fi])}function Ta(m,y){var _=typeof m;return y=y??J,!!y&&(_=="number"||_!="symbol"&&ps.test(m))&&m>-1&&m%1==0&&m<y}function ii(m,y,_){if(!Wn(_))return!1;var O=typeof y;return(O=="number"?wr(_)&&Ta(y,_.length):O=="string"&&y in _)?Si(_[y],m):!1}function Uf(m,y){if(Pt(m))return!1;var _=typeof m;return _=="number"||_=="symbol"||_=="boolean"||m==null||ai(m)?!0:Pi.test(m)||!ha.test(m)||y!=null&&m in Ht(y)}function Ds(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function qf(m){var y=rd(m),_=X[y];if(typeof _!="function"||!(y in Gt.prototype))return!1;if(m===_)return!0;var O=$f(_);return!!O&&m===O[0]}function Vf(m){return!!hp&&hp in m}var sd=_u?Aa:rv;function Dn(m){var y=m&&m.constructor,_=typeof y=="function"&&y.prototype||cc;return m===_}function py(m){return m===m&&!Wn(m)}function my(m,y){return function(_){return _==null?!1:_[m]===y&&(y!==t||m in Ht(_))}}function gy(m){var y=xd(m,function(O){return _.size===d&&_.clear(),O}),_=y.cache;return y}function od(m,y){var _=m[1],O=y[1],Y=_|O,le=Y<(E|T|B),pe=O==B&&_==D||O==B&&_==z&&m[7].length<=y[8]||O==(B|z)&&y[7].length<=y[8]&&_==D;if(!(le||pe))return m;O&E&&(m[2]=y[2],Y|=_&E?0:I);var Ne=y[3];if(Ne){var Te=m[3];m[3]=Te?Up(Te,Ne,y[4]):Ne,m[4]=Te?Ja(m[3],h):y[4]}return Ne=y[5],Ne&&(Te=m[5],m[5]=Te?ry(Te,Ne,y[6]):Ne,m[6]=Te?Ja(m[5],h):y[6]),Ne=y[7],Ne&&(m[7]=Ne),O&B&&(m[8]=m[8]==null?y[8]:Hn(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=Y,m}function So(m){var y=[];if(m!=null)for(var _ in Ht(m))y.push(_);return y}function yy(m){return ei.call(m)}function Jp(m,y,_){return y=Bn(y===t?m.length-1:y,0),function(){for(var O=arguments,Y=-1,le=Bn(O.length-y,0),pe=me(le);++Y<le;)pe[Y]=O[y+Y];Y=-1;for(var Ne=me(y+1);++Y<y;)Ne[Y]=O[Y];return Ne[y]=_(pe),fr(m,this,Ne)}}function Nc(m,y){return y.length<2?m:Xi(m,Ii(y,0,-1))}function ts(m,y){for(var _=m.length,O=Hn(y.length,_),Y=br(m);O--;){var le=y[O];m[O]=Ta(le,_)?Y[le]:t}return m}function Hf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Gf=cd(Vu),Cc=mp||function(m,y){return er.setTimeout(m,y)},ld=cd(Hu);function Yf(m,y,_){var O=y+"";return ld(m,hy(O,xy(Gp(O),_)))}function cd(m){var y=0,_=0;return function(){var O=Cs(),Y=ee-(O-_);if(_=O,Y>0){if(++y>=G)return arguments[0]}else y=0;return m.apply(t,arguments)}}function ud(m,y){var _=-1,O=m.length,Y=O-1;for(y=y===t?O:y;++_<y;){var le=Ef(_,Y),pe=m[le];m[le]=m[_],m[_]=pe}return m.length=y,m}var ns=gy(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(ir,function(_,O,Y,le){y.push(Y?le.replace(Qs,"$1"):O||_)}),y});function bn(m){if(typeof m=="string"||ai(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Is(m){if(m!=null){try{return ku.call(m)}catch{}try{return m+""}catch{}}return""}function xy(m,y){return Ur(de,function(_){var O="_."+_[0];y&_[1]&&!ec(m,O)&&m.push(O)}),m.sort()}function vr(m){if(m instanceof Gt)return m.clone();var y=new pi(m.__wrapped__,m.__chain__);return y.__actions__=br(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function v0(m,y,_){(_?ii(m,y,_):y===t)?y=1:y=Bn(Ot(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var Y=0,le=0,pe=me(fc(O/y));Y<O;)pe[le++]=Ii(m,Y,Y+=y);return pe}function by(m){for(var y=-1,_=m==null?0:m.length,O=0,Y=[];++y<_;){var le=m[y];le&&(Y[O++]=le)}return Y}function vy(){var m=arguments.length;if(!m)return[];for(var y=me(m-1),_=arguments[0],O=m;O--;)y[O-1]=arguments[O];return va(Pt(_)?br(_):[_],en(y,1))}var Yn=Ft(function(m,y){return lr(m)?yo(m,en(y,1,lr,!0)):[]}),bi=Ft(function(m,y){var _=Gr(y);return lr(_)&&(_=t),lr(m)?yo(m,en(y,1,lr,!0),bt(_,2)):[]}),Ms=Ft(function(m,y){var _=Gr(y);return lr(_)&&(_=t),lr(m)?yo(m,en(y,1,lr,!0),t,_):[]});function wy(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Ot(y),Ii(m,y<0?0:y,O)):[]}function Sy(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Ot(y),y=O-y,Ii(m,0,y<0?0:y)):[]}function w0(m,y){return m&&m.length?Wu(m,bt(y,3),!0,!0):[]}function Kp(m,y){return m&&m.length?Wu(m,bt(y,3),!0):[]}function Ri(m,y,_,O){var Y=m==null?0:m.length;return Y?(_&&typeof _!="number"&&ii(m,y,_)&&(_=0,O=Y),Bt(m,y,_,O)):[]}function ea(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var Y=_==null?0:Ot(_);return Y<0&&(Y=Bn(O+Y,0)),tc(m,bt(y,3),Y)}function Xp(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var Y=O-1;return _!==t&&(Y=Ot(_),Y=_<0?Bn(O+Y,0):Hn(Y,O-1)),tc(m,bt(y,3),Y,!0)}function vi(m){var y=m==null?0:m.length;return y?en(m,1):[]}function Ny(m){var y=m==null?0:m.length;return y?en(m,V):[]}function No(m,y){var _=m==null?0:m.length;return _?(y=y===t?1:Ot(y),en(m,y)):[]}function kl(m){for(var y=-1,_=m==null?0:m.length,O={};++y<_;){var Y=m[y];O[Y[0]]=Y[1]}return O}function Rs(m){return m&&m.length?m[0]:t}function Zp(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var Y=_==null?0:Ot(_);return Y<0&&(Y=Bn(O+Y,0)),Kr(m,y,Y)}function em(m){var y=m==null?0:m.length;return y?Ii(m,0,-1):[]}var rs=Ft(function(m){var y=Rn(m,Df);return y.length&&y[0]===m[0]?jp(y):[]}),Cy=Ft(function(m){var y=Gr(m),_=Rn(m,Df);return y===Gr(_)?y=t:_.pop(),_.length&&_[0]===m[0]?jp(_,bt(y,2)):[]}),jc=Ft(function(m){var y=Gr(m),_=Rn(m,Df);return y=typeof y=="function"?y:t,y&&_.pop(),_.length&&_[0]===m[0]?jp(_,t,y):[]});function dd(m,y){return m==null?"":Wi.call(m,y)}function Gr(m){var y=m==null?0:m.length;return y?m[y-1]:t}function _c(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var Y=O;return _!==t&&(Y=Ot(_),Y=Y<0?Bn(O+Y,0):Hn(Y,O-1)),y===y?Zr(m,y,Y):tc(m,qr,Y,!0)}function jy(m,y){return m&&m.length?Dp(m,Ot(y)):t}var _y=Ft(kc);function kc(m,y){return m&&m.length&&y&&y.length?kf(m,y):m}function ky(m,y,_){return m&&m.length&&y&&y.length?kf(m,y,bt(_,2)):m}function Wf(m,y,_){return m&&m.length&&y&&y.length?kf(m,y,t,_):m}var Ey=Un(function(m,y){var _=m==null?0:m.length,O=$u(m,y);return Mp(m,Rn(y,function(Y){return Ta(Y,_)?+Y:Y}).sort(Ku)),O});function S0(m,y){var _=[];if(!(m&&m.length))return _;var O=-1,Y=[],le=m.length;for(y=bt(y,3);++O<le;){var pe=m[O];y(pe,O,m)&&(_.push(pe),Y.push(O))}return Mp(m,Y),_}function tm(m){return m==null?m:yp.call(m)}function wn(m,y,_){var O=m==null?0:m.length;return O?(_&&typeof _!="number"&&ii(m,y,_)?(y=0,_=O):(y=y==null?0:Ot(y),_=_===t?O:Ot(_)),Ii(m,y,_)):[]}function On(m,y){return Gu(m,y)}function Qt(m,y,_){return Af(m,y,bt(_,2))}function ln(m,y){var _=m==null?0:m.length;if(_){var O=Gu(m,y);if(O<_&&Si(m[O],y))return O}return-1}function Sn(m,y){return Gu(m,y,!0)}function Oi(m,y,_){return Af(m,y,bt(_,2),!0)}function Co(m,y){var _=m==null?0:m.length;if(_){var O=Gu(m,y,!0)-1;if(Si(m[O],y))return O}return-1}function Ec(m){return m&&m.length?Op(m):[]}function nm(m,y){return m&&m.length?Op(m,bt(y,2)):[]}function Os(m){var y=m==null?0:m.length;return y?Ii(m,1,y):[]}function or(m,y,_){return m&&m.length?(y=_||y===t?1:Ot(y),Ii(m,0,y<0?0:y)):[]}function jo(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Ot(y),y=O-y,Ii(m,y<0?0:y,O)):[]}function El(m,y){return m&&m.length?Wu(m,bt(y,3),!1,!0):[]}function rm(m,y){return m&&m.length?Wu(m,bt(y,3)):[]}var ta=Ft(function(m){return Es(en(m,1,lr,!0))}),Tc=Ft(function(m){var y=Gr(m);return lr(y)&&(y=t),Es(en(m,1,lr,!0),bt(y,2))}),fd=Ft(function(m){var y=Gr(m);return y=typeof y=="function"?y:t,Es(en(m,1,lr,!0),t,y)});function wi(m){return m&&m.length?Es(m):[]}function im(m,y){return m&&m.length?Es(m,bt(y,2)):[]}function am(m,y){return y=typeof y=="function"?y:t,m&&m.length?Es(m,t,y):[]}function Ac(m){if(!(m&&m.length))return[];var y=0;return m=qi(m,function(_){if(lr(_))return y=Bn(_.length,y),!0}),wa(y,function(_){return Rn(m,il(_))})}function hd(m,y){if(!(m&&m.length))return[];var _=Ac(m);return y==null?_:Rn(_,function(O){return fr(y,t,O)})}var _o=Ft(function(m,y){return lr(m)?yo(m,y):[]}),Lr=Ft(function(m){return Qu(qi(m,lr))}),ko=Ft(function(m){var y=Gr(m);return lr(y)&&(y=t),Qu(qi(m,lr),bt(y,2))}),Pc=Ft(function(m){var y=Gr(m);return y=typeof y=="function"?y:t,Qu(qi(m,lr),t,y)}),Dc=Ft(Ac);function sm(m,y){return Fp(m||[],y||[],gl)}function om(m,y){return Fp(m||[],y||[],vc)}var Ty=Ft(function(m){var y=m.length,_=y>1?m[y-1]:t;return _=typeof _=="function"?(m.pop(),_):t,hd(m,_)});function Ic(m){var y=X(m);return y.__chain__=!0,y}function lm(m,y){return y(m),m}function Yr(m,y){return y(m)}var Ay=Un(function(m){var y=m.length,_=y?m[0]:0,O=this.__wrapped__,Y=function(le){return $u(le,m)};return y>1||this.__actions__.length||!(O instanceof Gt)||!Ta(_)?this.thru(Y):(O=O.slice(_,+_+(y?1:0)),O.__actions__.push({func:Yr,args:[Y],thisArg:t}),new pi(O,this.__chain__).thru(function(le){return y&&!le.length&&le.push(t),le}))});function Li(){return Ic(this)}function Py(){return new pi(this.value(),this.__chain__)}function Dy(){this.__values__===t&&(this.__values__=Fi(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function N0(){return this}function Eo(m){for(var y,_=this;_ instanceof Ki;){var O=vr(_);O.__index__=0,O.__values__=t,y?Y.__wrapped__=O:y=O;var Y=O;_=_.__wrapped__}return Y.__wrapped__=m,y}function Qf(){var m=this.__wrapped__;if(m instanceof Gt){var y=m;return this.__actions__.length&&(y=new Gt(this)),y=y.reverse(),y.__actions__.push({func:Yr,args:[tm],thisArg:t}),new pi(y,this.__chain__)}return this.thru(tm)}function cm(){return Xg(this.__wrapped__,this.__actions__)}var Mc=Sl(function(m,y,_){pn.call(m,_)?++m[_]:_a(m,_,1)});function Iy(m,y,_){var O=Pt(m)?nl:Np;return _&&ii(m,y,_)&&(y=t),O(m,bt(y,3))}function My(m,y){var _=Pt(m)?qi:vn;return _(m,bt(y,3))}var Ry=As(ea),um=As(Xp);function dm(m,y){return en(pd(m,y),1)}function C0(m,y){return en(pd(m,y),V)}function j0(m,y,_){return _=_===t?1:Ot(_),en(pd(m,y),_)}function Oy(m,y){var _=Pt(m)?Ur:ks;return _(m,bt(y,3))}function fm(m,y){var _=Pt(m)?ap:bf;return _(m,bt(y,3))}var Ly=Sl(function(m,y,_){pn.call(m,_)?m[_].push(y):_a(m,_,[y])});function Rc(m,y,_,O){m=wr(m)?m:Uc(m),_=_&&!O?Ot(_):0;var Y=m.length;return _<0&&(_=Bn(Y+_,0)),oh(m)?_<=Y&&m.indexOf(y,_)>-1:!!Y&&Kr(m,y,_)>-1}var Jf=Ft(function(m,y,_){var O=-1,Y=typeof y=="function",le=wr(m)?me(m.length):[];return ks(m,function(pe){le[++O]=Y?fr(y,pe,_):bl(pe,y,_)}),le}),Fy=Sl(function(m,y,_){_a(m,_,y)});function pd(m,y){var _=Pt(m)?Rn:Ap;return _(m,bt(y,3))}function $y(m,y,_,O){return m==null?[]:(Pt(y)||(y=y==null?[]:[y]),_=O?t:_,Pt(_)||(_=_==null?[]:[_]),Ip(m,y,_))}var zy=Sl(function(m,y,_){m[_?0:1].push(y)},function(){return[[],[]]});function By(m,y,_){var O=Pt(m)?yu:nc,Y=arguments.length<3;return O(m,bt(y,4),_,Y,ks)}function Uy(m,y,_){var O=Pt(m)?sp:nc,Y=arguments.length<3;return O(m,bt(y,4),_,Y,bf)}function Kf(m,y){var _=Pt(m)?qi:vn;return _(m,bd(bt(y,3)))}function qy(m){var y=Pt(m)?mc:bc;return y(m)}function Vy(m,y,_){(_?ii(m,y,_):y===t)?y=1:y=Ot(y);var O=Pt(m)?zg:Tf;return O(m,y)}function In(m){var y=Pt(m)?Bg:Jg;return y(m)}function hm(m){if(m==null)return 0;if(wr(m))return oh(m)?Gi(m):m.length;var y=Er(m);return y==xe||y==Ze?m.size:Nf(m).length}function _0(m,y,_){var O=Pt(m)?xu:Kg;return _&&ii(m,y,_)&&(y=t),O(m,bt(y,3))}var Hy=Ft(function(m,y){if(m==null)return[];var _=y.length;return _>1&&ii(m,y[0],y[1])?y=[]:_>2&&ii(y[0],y[1],y[2])&&(y=[y[0]]),Ip(m,en(y,1),[])}),Xf=dl||function(){return er.Date.now()};function k0(m,y){if(typeof y!="function")throw new hr(l);return m=Ot(m),function(){if(--m<1)return y.apply(this,arguments)}}function Gy(m,y,_){return y=_?t:y,y=m&&y==null?m.length:y,es(m,B,t,t,t,t,y)}function md(m,y){var _;if(typeof y!="function")throw new hr(l);return m=Ot(m),function(){return--m>0&&(_=y.apply(this,arguments)),m<=1&&(y=t),_}}var To=Ft(function(m,y,_){var O=E;if(_.length){var Y=Ja(_,_l(To));O|=F}return es(m,O,y,_,Y)}),Zf=Ft(function(m,y,_){var O=E|T;if(_.length){var Y=Ja(_,_l(Zf));O|=F}return es(y,O,m,_,Y)});function gd(m,y,_){y=_?t:y;var O=es(m,D,t,t,t,t,t,y);return O.placeholder=gd.placeholder,O}function eh(m,y,_){y=_?t:y;var O=es(m,q,t,t,t,t,t,y);return O.placeholder=eh.placeholder,O}function Ao(m,y,_){var O,Y,le,pe,Ne,Te,Ge=0,We=!1,et=!1,dt=!0;if(typeof m!="function")throw new hr(l);y=ra(y)||0,Wn(_)&&(We=!!_.leading,et="maxWait"in _,le=et?Bn(ra(_.maxWait)||0,y):le,dt="trailing"in _?!!_.trailing:dt);function pt(Cr){var $s=O,Al=Y;return O=Y=t,Ge=Cr,pe=m.apply(Al,$s),pe}function Et(Cr){return Ge=Cr,Ne=Cc(nn,y),We?pt(Cr):pe}function Wt(Cr){var $s=Cr-Te,Al=Cr-Ge,DS=y-$s;return et?Hn(DS,le-Al):DS}function Tt(Cr){var $s=Cr-Te,Al=Cr-Ge;return Te===t||$s>=y||$s<0||et&&Al>=le}function nn(){var Cr=Xf();if(Tt(Cr))return dn(Cr);Ne=Cc(nn,Wt(Cr))}function dn(Cr){return Ne=t,dt&&O?pt(Cr):(O=Y=t,pe)}function Da(){Ne!==t&&ey(Ne),Ge=0,O=Te=Y=Ne=t}function $i(){return Ne===t?pe:dn(Xf())}function Ia(){var Cr=Xf(),$s=Tt(Cr);if(O=arguments,Y=this,Te=Cr,$s){if(Ne===t)return Et(Te);if(et)return ey(Ne),Ne=Cc(nn,y),pt(Te)}return Ne===t&&(Ne=Cc(nn,y)),pe}return Ia.cancel=Da,Ia.flush=$i,Ia}var is=Ft(function(m,y){return yl(m,1,y)}),yd=Ft(function(m,y,_){return yl(m,ra(y)||0,_)});function E0(m){return es(m,U)}function xd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new hr(l);var _=function(){var O=arguments,Y=y?y.apply(this,O):O[0],le=_.cache;if(le.has(Y))return le.get(Y);var pe=m.apply(this,O);return _.cache=le.set(Y,pe)||le,pe};return _.cache=new(xd.Cache||mi),_}xd.Cache=mi;function bd(m){if(typeof m!="function")throw new hr(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Yy(m){return md(2,m)}var Wy=Zg(function(m,y){y=y.length==1&&Pt(y[0])?Rn(y[0],Xr(bt())):Rn(en(y,1),Xr(bt()));var _=y.length;return Ft(function(O){for(var Y=-1,le=Hn(O.length,_);++Y<le;)O[Y]=y[Y].call(this,O[Y]);return fr(m,this,O)})}),pm=Ft(function(m,y){var _=Ja(y,_l(pm));return es(m,F,t,y,_)}),th=Ft(function(m,y){var _=Ja(y,_l(th));return es(m,$,t,y,_)}),Qy=Un(function(m,y){return es(m,z,t,t,t,y)});function Jy(m,y){if(typeof m!="function")throw new hr(l);return y=y===t?y:Ot(y),Ft(m,y)}function T0(m,y){if(typeof m!="function")throw new hr(l);return y=y==null?0:Bn(Ot(y),0),Ft(function(_){var O=_[y],Y=bo(_,0,y);return O&&va(Y,O),fr(m,this,Y)})}function mm(m,y,_){var O=!0,Y=!0;if(typeof m!="function")throw new hr(l);return Wn(_)&&(O="leading"in _?!!_.leading:O,Y="trailing"in _?!!_.trailing:Y),Ao(m,y,{leading:O,maxWait:y,trailing:Y})}function gm(m){return Gy(m,1)}function A0(m,y){return pm(Ju(y),m)}function P0(){if(!arguments.length)return[];var m=arguments[0];return Pt(m)?m:[m]}function vd(m){return Vr(m,v)}function D0(m,y){return y=typeof y=="function"?y:t,Vr(m,v,y)}function Ky(m){return Vr(m,g|v)}function Jt(m,y){return y=typeof y=="function"?y:t,Vr(m,g|v,y)}function ym(m,y){return y==null||Sp(m,y,Nr(y))}function Si(m,y){return m===y||m!==m&&y!==y}var xm=jl(zu),Xy=jl(function(m,y){return m>=y}),Ls=vf(function(){return arguments}())?vf:function(m){return tr(m)&&pn.call(m,"callee")&&!cl.call(m,"callee")},Pt=me.isArray,nh=ba?Xr(ba):gi;function wr(m){return m!=null&&Tl(m.length)&&!Aa(m)}function lr(m){return tr(m)&&wr(m)}function I0(m){return m===!0||m===!1||tr(m)&&tn(m)==ie}var Po=hf||rv,Zy=pu?Xr(pu):pr;function ex(m){return tr(m)&&m.nodeType===1&&!na(m)}function rh(m){if(m==null)return!0;if(wr(m)&&(Pt(m)||typeof m=="string"||typeof m.splice=="function"||Po(m)||Oc(m)||Ls(m)))return!m.length;var y=Er(m);if(y==xe||y==Ze)return!m.size;if(Dn(m))return!Nf(m).length;for(var _ in m)if(pn.call(m,_))return!1;return!0}function kn(m,y){return vl(m,y)}function bm(m,y,_){_=typeof _=="function"?_:t;var O=_?_(m,y):t;return O===t?vl(m,y,t,_):!!O}function Sr(m){if(!tr(m))return!1;var y=tn(m);return y==tt||y==Ve||typeof m.message=="string"&&typeof m.name=="string"&&!na(m)}function M0(m){return typeof m=="number"&&Pu(m)}function Aa(m){if(!Wn(m))return!1;var y=tn(m);return y==Ke||y==Oe||y==we||y==rt}function ih(m){return typeof m=="number"&&m==Ot(m)}function Tl(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=J}function Wn(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function tr(m){return m!=null&&typeof m=="object"}var ah=Xl?Xr(Xl):wf;function vm(m,y){return m===y||Uu(m,y,zf(y))}function R0(m,y,_){return _=typeof _=="function"?_:t,Uu(m,y,zf(y),_)}function tx(m){return rx(m)&&m!=+m}function O0(m){if(sd(m))throw new Qe(s);return Xa(m)}function nx(m){return m===null}function L0(m){return m==null}function rx(m){return typeof m=="number"||tr(m)&&tn(m)==Me}function na(m){if(!tr(m)||tn(m)!=Ee)return!1;var y=Eu(m);if(y===null)return!0;var _=pn.call(y,"constructor")&&y.constructor;return typeof _=="function"&&_ instanceof _&&ku.call(_)==Yi}var sh=Ss?Xr(Ss):Sf;function wm(m){return ih(m)&&m>=-9007199254740991&&m<=J}var ix=rf?Xr(rf):kp;function oh(m){return typeof m=="string"||!Pt(m)&&tr(m)&&tn(m)==Rt}function ai(m){return typeof m=="symbol"||tr(m)&&tn(m)==kt}var Oc=mu?Xr(mu):Ep;function Pa(m){return m===t}function Sm(m){return tr(m)&&Er(m)==se}function ax(m){return tr(m)&&tn(m)==Q}var sx=jl(Cf),wd=jl(function(m,y){return m<=y});function Fi(m){if(!m)return[];if(wr(m))return oh(m)?di(m):br(m);if(ul&&m[ul])return Hi(m[ul]());var y=Er(m),_=y==xe?sc:y==Ze?oc:Uc;return _(m)}function as(m){if(!m)return m===0?m:0;if(m=ra(m),m===V||m===-1/0){var y=m<0?-1:1;return y*ne}return m===m?m:0}function Ot(m){var y=as(m),_=y%1;return y===y?_?y-_:y:0}function ss(m){return m?ka(Ot(m),0,ae):0}function ra(m){if(typeof m=="number")return m;if(ai(m))return A;if(Wn(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=Wn(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=vu(m);var _=dr.test(m);return _||ql.test(m)?fu(m.slice(2),_?2:8):Ks.test(m)?A:+m}function ox(m){return xi(m,Tr(m))}function Lc(m){return m?ka(Ot(m),-9007199254740991,J):m===0?m:0}function mn(m){return m==null?"":yi(m)}var F0=Nl(function(m,y){if(Dn(y)||wr(y)){xi(y,Nr(y),m);return}for(var _ in y)pn.call(y,_)&&gl(m,_,y[_])}),lx=Nl(function(m,y){xi(y,Tr(y),m)}),lh=Nl(function(m,y,_,O){xi(y,Tr(y),m,O)}),$0=Nl(function(m,y,_,O){xi(y,Nr(y),m,O)}),z0=Un($u);function B0(m,y){var _=Di(m);return y==null?_:_s(_,y)}var U0=Ft(function(m,y){m=Ht(m);var _=-1,O=y.length,Y=O>2?y[2]:t;for(Y&&ii(y[0],y[1],Y)&&(O=1);++_<O;)for(var le=y[_],pe=Tr(le),Ne=-1,Te=pe.length;++Ne<Te;){var Ge=pe[Ne],We=m[Ge];(We===t||Si(We,cc[Ge])&&!pn.call(m,Ge))&&(m[Ge]=le[Ge])}return m}),cx=Ft(function(m){return m.push(t,Hp),fr(jd,t,m)});function Fc(m,y){return rl(m,bt(y,3),Hr)}function Sd(m,y){return rl(m,bt(y,3),xc)}function ux(m,y){return m==null?m:yc(m,bt(y,3),Tr)}function q0(m,y){return m==null?m:xl(m,bt(y,3),Tr)}function $c(m,y){return m&&Hr(m,bt(y,3))}function Nd(m,y){return m&&xc(m,bt(y,3))}function dx(m){return m==null?[]:xo(m,Nr(m))}function ch(m){return m==null?[]:xo(m,Tr(m))}function Cd(m,y,_){var O=m==null?t:Xi(m,y);return O===t?_:O}function Nm(m,y){return m!=null&&ad(m,y,Cp)}function zc(m,y){return m!=null&&ad(m,y,Vg)}var fx=Zu(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=ei.call(y)),m[y]=_},Ie(Re)),hx=Zu(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=ei.call(y)),pn.call(m,y)?m[y].push(_):m[y]=[_]},bt),V0=Ft(bl);function Nr(m){return wr(m)?wp(m):Nf(m)}function Tr(m){return wr(m)?wp(m,!0):Gg(m)}function H0(m,y){var _={};return y=bt(y,3),Hr(m,function(O,Y,le){_a(_,y(O,Y,le),O)}),_}function G0(m,y){var _={};return y=bt(y,3),Hr(m,function(O,Y,le){_a(_,Y,y(O,Y,le))}),_}var Y0=Nl(function(m,y,_){qu(m,y,_)}),jd=Nl(function(m,y,_,O){qu(m,y,_,O)}),uh=Un(function(m,y){var _={};if(m==null)return _;var O=!1;y=Rn(y,function(le){return le=Ts(le,m),O||(O=le.length>1),le}),xi(m,Ff(m),_),O&&(_=Vr(_,g|b|v,ly));for(var Y=y.length;Y--;)Yu(_,y[Y]);return _});function Cm(m,y){return Bc(m,bd(bt(y)))}var W0=Un(function(m,y){return m==null?{}:Yg(m,y)});function Bc(m,y){if(m==null)return{};var _=Rn(Ff(m),function(O){return[O]});return y=bt(y),_f(m,_,function(O,Y){return y(O,Y[0])})}function Q0(m,y,_){y=Ts(y,m);var O=-1,Y=y.length;for(Y||(Y=1,m=t);++O<Y;){var le=m==null?t:m[bn(y[O])];le===t&&(O=Y,le=_),m=Aa(le)?le.call(m):le}return m}function px(m,y,_){return m==null?m:vc(m,y,_)}function mx(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:vc(m,y,_,O)}var jm=nd(Nr),_m=nd(Tr);function km(m,y,_){var O=Pt(m),Y=O||Po(m)||Oc(m);if(y=bt(y,4),_==null){var le=m&&m.constructor;Y?_=O?new le:[]:Wn(m)?_=Aa(le)?Di(Eu(m)):{}:_={}}return(Y?Ur:Hr)(m,function(pe,Ne,Te){return y(_,pe,Ne,Te)}),_}function gx(m,y){return m==null?!0:Yu(m,y)}function dh(m,y,_){return m==null?m:Lp(m,y,Ju(_))}function J0(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:Lp(m,y,Ju(_),O)}function Uc(m){return m==null?[]:ic(m,Nr(m))}function Em(m){return m==null?[]:ic(m,Tr(m))}function Tm(m,y,_){return _===t&&(_=y,y=t),_!==t&&(_=ra(_),_=_===_?_:0),y!==t&&(y=ra(y),y=y===y?y:0),ka(ra(m),y,_)}function fh(m,y,_){return y=as(y),_===t?(_=y,y=0):_=as(_),m=ra(m),Hg(m,y,_)}function Am(m,y,_){if(_&&typeof _!="boolean"&&ii(m,y,_)&&(y=_=t),_===t&&(typeof y=="boolean"?(_=y,y=t):typeof m=="boolean"&&(_=m,m=t)),m===t&&y===t?(m=0,y=1):(m=as(m),y===t?(y=m,m=0):y=as(y)),m>y){var O=m;m=y,y=O}if(_||m%1||y%1){var Y=gp();return Hn(m+Y*(y-m+Ya("1e-"+((Y+"").length-1))),y)}return Ef(m,y)}var yx=ri(function(m,y,_){return y=y.toLowerCase(),m+(_?hh(y):y)});function hh(m){return x(mn(m).toLowerCase())}function Fs(m){return m=mn(m),m&&m.replace(Va,Sa).replace(ui,"")}function Do(m,y,_){m=mn(m),y=yi(y);var O=m.length;_=_===t?O:ka(Ot(_),0,O);var Y=_;return _-=y.length,_>=0&&m.slice(_,Y)==y}function Io(m){return m=mn(m),m&&fn.test(m)?m.replace(_n,sf):m}function _d(m){return m=mn(m),m&&zn.test(m)?m.replace(Zn,"\\$&"):m}var kd=ri(function(m,y,_){return m+(_?"-":"")+y.toLowerCase()}),Mo=ri(function(m,y,_){return m+(_?" ":"")+y.toLowerCase()}),K0=Mi("toLowerCase");function xx(m,y,_){m=mn(m),y=Ot(y);var O=y?Gi(m):0;if(!y||O>=y)return m;var Y=(y-O)/2;return td(Ns(Y),_)+m+td(fc(Y),_)}function Ed(m,y,_){m=mn(m),y=Ot(y);var O=y?Gi(m):0;return y&&O<y?m+td(y-O,_):m}function X0(m,y,_){m=mn(m),y=Ot(y);var O=y?Gi(m):0;return y&&O<y?td(y-O,_)+m:m}function bx(m,y,_){return _||y==null?y=0:y&&(y=+y),fl(mn(m).replace(Ua,""),y||0)}function ph(m,y,_){return(_?ii(m,y,_):y===t)?y=1:y=Ot(y),Rp(mn(m),y)}function vx(){var m=arguments,y=mn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var Z0=ri(function(m,y,_){return m+(_?"_":"")+y.toLowerCase()});function mh(m,y,_){return _&&typeof _!="number"&&ii(m,y,_)&&(y=_=t),_=_===t?ae:_>>>0,_?(m=mn(m),m&&(typeof y=="string"||y!=null&&!sh(y))&&(y=yi(y),!y&&Qa(m))?bo(di(m),0,_):m.split(y,_)):[]}var gh=ri(function(m,y,_){return m+(_?" ":"")+x(y)});function wx(m,y,_){return m=mn(m),_=_==null?0:ka(Ot(_),0,m.length),y=yi(y),m.slice(_,_+y.length)==y}function Td(m,y,_){var O=X.templateSettings;_&&ii(m,y,_)&&(y=t),m=mn(m),y=lh({},y,O,Of);var Y=lh({},y.imports,O.imports,Of),le=Nr(Y),pe=ic(Y,le),Ne,Te,Ge=0,We=y.interpolate||Qr,et="__p += '",dt=fo((y.escape||Qr).source+"|"+We.source+"|"+(We===li?Js:Qr).source+"|"+(y.evaluate||Qr).source+"|$","g"),pt="//# sourceURL="+(pn.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++nf+"]")+`
`;m.replace(dt,function(Tt,nn,dn,Da,$i,Ia){return dn||(dn=Da),et+=m.slice(Ge,Ia).replace(Xs,ac),nn&&(Ne=!0,et+=`' +
__e(`+nn+`) +
'`),$i&&(Te=!0,et+=`';
`+$i+`;
__p += '`),dn&&(et+=`' +
((__t = (`+dn+`)) == null ? '' : __t) +
'`),Ge=Ia+Tt.length,Tt}),et+=`';
`;var Et=pn.call(y,"variable")&&y.variable;if(!Et)et=`with (obj) {
`+et+`
}
`;else if(ou.test(Et))throw new Qe(f);et=(Te?et.replace(Je,""):et).replace(xt,"$1").replace(Vn,"$1;"),et="function("+(Et||"obj")+`) {
`+(Et?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Ne?", __e = _.escape":"")+(Te?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+et+`return __p
}`;var Wt=P(function(){return nt(le,pt+"return "+et).apply(t,pe)});if(Wt.source=et,Sr(Wt))throw Wt;return Wt}function Pm(m){return mn(m).toLowerCase()}function yh(m){return mn(m).toUpperCase()}function Sx(m,y,_){if(m=mn(m),m&&(_||y===t))return vu(m);if(!m||!(y=yi(y)))return m;var O=di(m),Y=di(y),le=co(O,Y),pe=uo(O,Y)+1;return bo(O,le,pe).join("")}function ev(m,y,_){if(m=mn(m),m&&(_||y===t))return m.slice(0,Nu(m)+1);if(!m||!(y=yi(y)))return m;var O=di(m),Y=uo(O,di(y))+1;return bo(O,0,Y).join("")}function xh(m,y,_){if(m=mn(m),m&&(_||y===t))return m.replace(Ua,"");if(!m||!(y=yi(y)))return m;var O=di(m),Y=co(O,di(y));return bo(O,Y).join("")}function o(m,y){var _=L,O=R;if(Wn(y)){var Y="separator"in y?y.separator:Y;_="length"in y?Ot(y.length):_,O="omission"in y?yi(y.omission):O}m=mn(m);var le=m.length;if(Qa(m)){var pe=di(m);le=pe.length}if(_>=le)return m;var Ne=_-Gi(O);if(Ne<1)return O;var Te=pe?bo(pe,0,Ne).join(""):m.slice(0,Ne);if(Y===t)return Te+O;if(pe&&(Ne+=Te.length-Ne),sh(Y)){if(m.slice(Ne).search(Y)){var Ge,We=Te;for(Y.global||(Y=fo(Y.source,mn(qa.exec(Y))+"g")),Y.lastIndex=0;Ge=Y.exec(We);)var et=Ge.index;Te=Te.slice(0,et===t?Ne:et)}}else if(m.indexOf(yi(Y),Ne)!=Ne){var dt=Te.lastIndexOf(Y);dt>-1&&(Te=Te.slice(0,dt))}return Te+O}function c(m){return m=mn(m),m&&yn.test(m)?m.replace($n,lf):m}var p=ri(function(m,y,_){return m+(_?" ":"")+y.toUpperCase()}),x=Mi("toUpperCase");function N(m,y,_){return m=mn(m),y=_?t:y,y===t?of(m)?cf(m):lp(m):m.match(y)||[]}var P=Ft(function(m,y){try{return fr(m,t,y)}catch(_){return Sr(_)?_:new Qe(_)}}),H=Un(function(m,y){return Ur(y,function(_){_=bn(_),_a(m,_,To(m[_],m))}),m});function Z(m){var y=m==null?0:m.length,_=bt();return m=y?Rn(m,function(O){if(typeof O[1]!="function")throw new hr(l);return[_(O[0]),O[1]]}):[],Ft(function(O){for(var Y=-1;++Y<y;){var le=m[Y];if(fr(le[0],this,O))return fr(le[1],this,O)}})}function ye(m){return Ug(Vr(m,g))}function Ie(m){return function(){return m}}function qe(m,y){return m==null||m!==m?y:m}var Ye=Za(),Le=Za(!0);function Re(m){return m}function Nt(m){return Tp(typeof m=="function"?m:Vr(m,g))}function wt(m){return Pp(Vr(m,g))}function En(m,y){return jf(m,Vr(y,g))}var ke=Ft(function(m,y){return function(_){return bl(_,m,y)}}),Ce=Ft(function(m,y){return function(_){return bl(m,_,y)}});function De(m,y,_){var O=Nr(y),Y=xo(y,O);_==null&&!(Wn(y)&&(Y.length||!O.length))&&(_=y,y=m,m=this,Y=xo(y,Nr(y)));var le=!(Wn(_)&&"chain"in _)||!!_.chain,pe=Aa(m);return Ur(Y,function(Ne){var Te=y[Ne];m[Ne]=Te,pe&&(m.prototype[Ne]=function(){var Ge=this.__chain__;if(le||Ge){var We=m(this.__wrapped__),et=We.__actions__=br(this.__actions__);return et.push({func:Te,args:arguments,thisArg:m}),We.__chain__=Ge,We}return Te.apply(m,va([this.value()],arguments))})}),m}function He(){return er._===this&&(er._=uc),this}function ht(){}function Yt(m){return m=Ot(m),Ft(function(y){return Dp(y,m)})}var gt=ed(Rn),Ct=ed(nl),Ar=ed(xu);function un(m){return Uf(m)?il(bn(m)):Wg(m)}function Ro(m){return function(y){return m==null?t:Xi(m,y)}}var tv=vo(),lP=vo(!0);function nv(){return[]}function rv(){return!1}function cP(){return{}}function uP(){return""}function dP(){return!0}function fP(m,y){if(m=Ot(m),m<1||m>J)return[];var _=ae,O=Hn(m,ae);y=bt(y),m-=ae;for(var Y=wa(O,y);++_<m;)y(_);return Y}function hP(m){return Pt(m)?Rn(m,bn):ai(m)?[m]:br(ns(mn(m)))}function pP(m){var y=++Na;return mn(m)+y}var mP=wc(function(m,y){return m+y},0),gP=Rf("ceil"),yP=wc(function(m,y){return m/y},1),xP=Rf("floor");function bP(m){return m&&m.length?Ea(m,Re,zu):t}function vP(m,y){return m&&m.length?Ea(m,bt(y,2),zu):t}function wP(m){return bu(m,Re)}function SP(m,y){return bu(m,bt(y,2))}function NP(m){return m&&m.length?Ea(m,Re,Cf):t}function CP(m,y){return m&&m.length?Ea(m,bt(y,2),Cf):t}var jP=wc(function(m,y){return m*y},1),_P=Rf("round"),kP=wc(function(m,y){return m-y},0);function EP(m){return m&&m.length?sl(m,Re):0}function TP(m,y){return m&&m.length?sl(m,bt(y,2)):0}return X.after=k0,X.ary=Gy,X.assign=F0,X.assignIn=lx,X.assignInWith=lh,X.assignWith=$0,X.at=z0,X.before=md,X.bind=To,X.bindAll=H,X.bindKey=Zf,X.castArray=P0,X.chain=Ic,X.chunk=v0,X.compact=by,X.concat=vy,X.cond=Z,X.conforms=ye,X.constant=Ie,X.countBy=Mc,X.create=B0,X.curry=gd,X.curryRight=eh,X.debounce=Ao,X.defaults=U0,X.defaultsDeep=cx,X.defer=is,X.delay=yd,X.difference=Yn,X.differenceBy=bi,X.differenceWith=Ms,X.drop=wy,X.dropRight=Sy,X.dropRightWhile=w0,X.dropWhile=Kp,X.fill=Ri,X.filter=My,X.flatMap=dm,X.flatMapDeep=C0,X.flatMapDepth=j0,X.flatten=vi,X.flattenDeep=Ny,X.flattenDepth=No,X.flip=E0,X.flow=Ye,X.flowRight=Le,X.fromPairs=kl,X.functions=dx,X.functionsIn=ch,X.groupBy=Ly,X.initial=em,X.intersection=rs,X.intersectionBy=Cy,X.intersectionWith=jc,X.invert=fx,X.invertBy=hx,X.invokeMap=Jf,X.iteratee=Nt,X.keyBy=Fy,X.keys=Nr,X.keysIn=Tr,X.map=pd,X.mapKeys=H0,X.mapValues=G0,X.matches=wt,X.matchesProperty=En,X.memoize=xd,X.merge=Y0,X.mergeWith=jd,X.method=ke,X.methodOf=Ce,X.mixin=De,X.negate=bd,X.nthArg=Yt,X.omit=uh,X.omitBy=Cm,X.once=Yy,X.orderBy=$y,X.over=gt,X.overArgs=Wy,X.overEvery=Ct,X.overSome=Ar,X.partial=pm,X.partialRight=th,X.partition=zy,X.pick=W0,X.pickBy=Bc,X.property=un,X.propertyOf=Ro,X.pull=_y,X.pullAll=kc,X.pullAllBy=ky,X.pullAllWith=Wf,X.pullAt=Ey,X.range=tv,X.rangeRight=lP,X.rearg=Qy,X.reject=Kf,X.remove=S0,X.rest=Jy,X.reverse=tm,X.sampleSize=Vy,X.set=px,X.setWith=mx,X.shuffle=In,X.slice=wn,X.sortBy=Hy,X.sortedUniq=Ec,X.sortedUniqBy=nm,X.split=mh,X.spread=T0,X.tail=Os,X.take=or,X.takeRight=jo,X.takeRightWhile=El,X.takeWhile=rm,X.tap=lm,X.throttle=mm,X.thru=Yr,X.toArray=Fi,X.toPairs=jm,X.toPairsIn=_m,X.toPath=hP,X.toPlainObject=ox,X.transform=km,X.unary=gm,X.union=ta,X.unionBy=Tc,X.unionWith=fd,X.uniq=wi,X.uniqBy=im,X.uniqWith=am,X.unset=gx,X.unzip=Ac,X.unzipWith=hd,X.update=dh,X.updateWith=J0,X.values=Uc,X.valuesIn=Em,X.without=_o,X.words=N,X.wrap=A0,X.xor=Lr,X.xorBy=ko,X.xorWith=Pc,X.zip=Dc,X.zipObject=sm,X.zipObjectDeep=om,X.zipWith=Ty,X.entries=jm,X.entriesIn=_m,X.extend=lx,X.extendWith=lh,De(X,X),X.add=mP,X.attempt=P,X.camelCase=yx,X.capitalize=hh,X.ceil=gP,X.clamp=Tm,X.clone=vd,X.cloneDeep=Ky,X.cloneDeepWith=Jt,X.cloneWith=D0,X.conformsTo=ym,X.deburr=Fs,X.defaultTo=qe,X.divide=yP,X.endsWith=Do,X.eq=Si,X.escape=Io,X.escapeRegExp=_d,X.every=Iy,X.find=Ry,X.findIndex=ea,X.findKey=Fc,X.findLast=um,X.findLastIndex=Xp,X.findLastKey=Sd,X.floor=xP,X.forEach=Oy,X.forEachRight=fm,X.forIn=ux,X.forInRight=q0,X.forOwn=$c,X.forOwnRight=Nd,X.get=Cd,X.gt=xm,X.gte=Xy,X.has=Nm,X.hasIn=zc,X.head=Rs,X.identity=Re,X.includes=Rc,X.indexOf=Zp,X.inRange=fh,X.invoke=V0,X.isArguments=Ls,X.isArray=Pt,X.isArrayBuffer=nh,X.isArrayLike=wr,X.isArrayLikeObject=lr,X.isBoolean=I0,X.isBuffer=Po,X.isDate=Zy,X.isElement=ex,X.isEmpty=rh,X.isEqual=kn,X.isEqualWith=bm,X.isError=Sr,X.isFinite=M0,X.isFunction=Aa,X.isInteger=ih,X.isLength=Tl,X.isMap=ah,X.isMatch=vm,X.isMatchWith=R0,X.isNaN=tx,X.isNative=O0,X.isNil=L0,X.isNull=nx,X.isNumber=rx,X.isObject=Wn,X.isObjectLike=tr,X.isPlainObject=na,X.isRegExp=sh,X.isSafeInteger=wm,X.isSet=ix,X.isString=oh,X.isSymbol=ai,X.isTypedArray=Oc,X.isUndefined=Pa,X.isWeakMap=Sm,X.isWeakSet=ax,X.join=dd,X.kebabCase=kd,X.last=Gr,X.lastIndexOf=_c,X.lowerCase=Mo,X.lowerFirst=K0,X.lt=sx,X.lte=wd,X.max=bP,X.maxBy=vP,X.mean=wP,X.meanBy=SP,X.min=NP,X.minBy=CP,X.stubArray=nv,X.stubFalse=rv,X.stubObject=cP,X.stubString=uP,X.stubTrue=dP,X.multiply=jP,X.nth=jy,X.noConflict=He,X.noop=ht,X.now=Xf,X.pad=xx,X.padEnd=Ed,X.padStart=X0,X.parseInt=bx,X.random=Am,X.reduce=By,X.reduceRight=Uy,X.repeat=ph,X.replace=vx,X.result=Q0,X.round=_P,X.runInContext=W,X.sample=qy,X.size=hm,X.snakeCase=Z0,X.some=_0,X.sortedIndex=On,X.sortedIndexBy=Qt,X.sortedIndexOf=ln,X.sortedLastIndex=Sn,X.sortedLastIndexBy=Oi,X.sortedLastIndexOf=Co,X.startCase=gh,X.startsWith=wx,X.subtract=kP,X.sum=EP,X.sumBy=TP,X.template=Td,X.times=fP,X.toFinite=as,X.toInteger=Ot,X.toLength=ss,X.toLower=Pm,X.toNumber=ra,X.toSafeInteger=Lc,X.toString=mn,X.toUpper=yh,X.trim=Sx,X.trimEnd=ev,X.trimStart=xh,X.truncate=o,X.unescape=c,X.uniqueId=pP,X.upperCase=p,X.upperFirst=x,X.each=Oy,X.eachRight=fm,X.first=Rs,De(X,function(){var m={};return Hr(X,function(y,_){pn.call(X.prototype,_)||(m[_]=y)}),m}(),{chain:!1}),X.VERSION=r,Ur(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){X[m].placeholder=X}),Ur(["drop","take"],function(m,y){Gt.prototype[m]=function(_){_=_===t?1:Bn(Ot(_),0);var O=this.__filtered__&&!y?new Gt(this):this.clone();return O.__filtered__?O.__takeCount__=Hn(_,O.__takeCount__):O.__views__.push({size:Hn(_,ae),type:m+(O.__dir__<0?"Right":"")}),O},Gt.prototype[m+"Right"]=function(_){return this.reverse()[m](_).reverse()}}),Ur(["filter","map","takeWhile"],function(m,y){var _=y+1,O=_==te||_==K;Gt.prototype[m]=function(Y){var le=this.clone();return le.__iteratees__.push({iteratee:bt(Y,3),type:_}),le.__filtered__=le.__filtered__||O,le}}),Ur(["head","last"],function(m,y){var _="take"+(y?"Right":"");Gt.prototype[m]=function(){return this[_](1).value()[0]}}),Ur(["initial","tail"],function(m,y){var _="drop"+(y?"":"Right");Gt.prototype[m]=function(){return this.__filtered__?new Gt(this):this[_](1)}}),Gt.prototype.compact=function(){return this.filter(Re)},Gt.prototype.find=function(m){return this.filter(m).head()},Gt.prototype.findLast=function(m){return this.reverse().find(m)},Gt.prototype.invokeMap=Ft(function(m,y){return typeof m=="function"?new Gt(this):this.map(function(_){return bl(_,m,y)})}),Gt.prototype.reject=function(m){return this.filter(bd(bt(m)))},Gt.prototype.slice=function(m,y){m=Ot(m);var _=this;return _.__filtered__&&(m>0||y<0)?new Gt(_):(m<0?_=_.takeRight(-m):m&&(_=_.drop(m)),y!==t&&(y=Ot(y),_=y<0?_.dropRight(-y):_.take(y-m)),_)},Gt.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},Gt.prototype.toArray=function(){return this.take(ae)},Hr(Gt.prototype,function(m,y){var _=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),Y=X[O?"take"+(y=="last"?"Right":""):y],le=O||/^find/.test(y);Y&&(X.prototype[y]=function(){var pe=this.__wrapped__,Ne=O?[1]:arguments,Te=pe instanceof Gt,Ge=Ne[0],We=Te||Pt(pe),et=function(nn){var dn=Y.apply(X,va([nn],Ne));return O&&dt?dn[0]:dn};We&&_&&typeof Ge=="function"&&Ge.length!=1&&(Te=We=!1);var dt=this.__chain__,pt=!!this.__actions__.length,Et=le&&!dt,Wt=Te&&!pt;if(!le&&We){pe=Wt?pe:new Gt(this);var Tt=m.apply(pe,Ne);return Tt.__actions__.push({func:Yr,args:[et],thisArg:t}),new pi(Tt,dt)}return Et&&Wt?m.apply(this,Ne):(Tt=this.thru(et),Et?O?Tt.value()[0]:Tt.value():Tt)})}),Ur(["pop","push","shift","sort","splice","unshift"],function(m){var y=uf[m],_=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);X.prototype[m]=function(){var Y=arguments;if(O&&!this.__chain__){var le=this.value();return y.apply(Pt(le)?le:[],Y)}return this[_](function(pe){return y.apply(Pt(pe)?pe:[],Y)})}}),Hr(Gt.prototype,function(m,y){var _=X[y];if(_){var O=_.name+"";pn.call(Ji,O)||(Ji[O]=[]),Ji[O].push({name:y,func:_})}}),Ji[sr(t,T).name]=[{name:"wrapper",func:t}],Gt.prototype.clone=Ru,Gt.prototype.reverse=pf,Gt.prototype.value=pl,X.prototype.at=Ay,X.prototype.chain=Li,X.prototype.commit=Py,X.prototype.next=Dy,X.prototype.plant=Eo,X.prototype.reverse=Qf,X.prototype.toJSON=X.prototype.valueOf=X.prototype.value=cm,X.prototype.first=X.prototype.head,ul&&(X.prototype[ul]=N0),X},be=he();Jr?((Jr.exports=be)._=be,ws._=be):er._=be}).call(l9)}(Xm,Xm.exports)),Xm.exports}var tE=c9();class u9{constructor(n){Ln(this,"sampleRate",24e3);Ln(this,"bufferSize",7680);Ln(this,"audioQueue",[]);Ln(this,"isPlaying",!1);Ln(this,"isStreamComplete",!1);Ln(this,"checkInterval",null);Ln(this,"scheduledTime",0);Ln(this,"initialBufferTime",.1);Ln(this,"gainNode");Ln(this,"source");Ln(this,"endOfQueueAudioSource",null);Ln(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=Ox.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(Ox.set(this.context,{}),a=Ox.get(this.context)),a[n]={handlers:[r]};const s=O1(n,t);await this.context.audioWorklet.addModule(s);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const s=r.getInt16(a*2,!0);t[a]=s/32768}catch(s){console.error(s)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const s=Ox.get(this.context);s&&Object.entries(s).forEach(([,f])=>{const{node:u,handlers:d}=f;u&&(a.connect(u),u.port.onmessage=function(h){d.forEach(g=>{g.call(u.port,h)})},u.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function nE(e,n){return function(){return e.apply(n,arguments)}}const{toString:d9}=Object.prototype,{getPrototypeOf:Ww}=Object,Zb=(e=>n=>{const t=d9.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ws=e=>(e=e.toLowerCase(),n=>Zb(n)===e),e0=e=>n=>typeof n===e,{isArray:Jh}=Array,hg=e0("undefined");function f9(e){return e!==null&&!hg(e)&&e.constructor!==null&&!hg(e.constructor)&&$a(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const rE=Ws("ArrayBuffer");function h9(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&rE(e.buffer),n}const p9=e0("string"),$a=e0("function"),iE=e0("number"),t0=e=>e!==null&&typeof e=="object",m9=e=>e===!0||e===!1,rb=e=>{if(Zb(e)!=="object")return!1;const n=Ww(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},g9=Ws("Date"),y9=Ws("File"),x9=Ws("Blob"),b9=Ws("FileList"),v9=e=>t0(e)&&$a(e.pipe),w9=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||$a(e.append)&&((n=Zb(e))==="formdata"||n==="object"&&$a(e.toString)&&e.toString()==="[object FormData]"))},S9=Ws("URLSearchParams"),[N9,C9,j9,_9]=["ReadableStream","Request","Response","Headers"].map(Ws),k9=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ng(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),Jh(e))for(r=0,a=e.length;r<a;r++)n.call(null,e[r],r,e);else{const s=t?Object.getOwnPropertyNames(e):Object.keys(e),l=s.length;let f;for(r=0;r<l;r++)f=s[r],n.call(null,e[f],f,e)}}function aE(e,n){n=n.toLowerCase();const t=Object.keys(e);let r=t.length,a;for(;r-- >0;)if(a=t[r],n===a.toLowerCase())return a;return null}const Fd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,sE=e=>!hg(e)&&e!==Fd;function L1(){const{caseless:e}=sE(this)&&this||{},n={},t=(r,a)=>{const s=e&&aE(n,a)||a;rb(n[s])&&rb(r)?n[s]=L1(n[s],r):rb(r)?n[s]=L1({},r):Jh(r)?n[s]=r.slice():n[s]=r};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&Ng(arguments[r],t);return n}const E9=(e,n,t,{allOwnKeys:r}={})=>(Ng(n,(a,s)=>{t&&$a(a)?e[s]=nE(a,t):e[s]=a},{allOwnKeys:r}),e),T9=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),A9=(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},P9=(e,n,t,r)=>{let a,s,l;const f={};if(n=n||{},e==null)return n;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)l=a[s],(!r||r(l,e,n))&&!f[l]&&(n[l]=e[l],f[l]=!0);e=t!==!1&&Ww(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},D9=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const r=e.indexOf(n,t);return r!==-1&&r===t},I9=e=>{if(!e)return null;if(Jh(e))return e;let n=e.length;if(!iE(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},M9=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&Ww(Uint8Array)),R9=(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=r.next())&&!a.done;){const s=a.value;n.call(e,s[0],s[1])}},O9=(e,n)=>{let t;const r=[];for(;(t=e.exec(n))!==null;)r.push(t);return r},L9=Ws("HTMLFormElement"),F9=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,a){return r.toUpperCase()+a}),JC=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),$9=Ws("RegExp"),oE=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};Ng(t,(a,s)=>{let l;(l=n(a,s,e))!==!1&&(r[s]=l||a)}),Object.defineProperties(e,r)},z9=e=>{oE(e,(n,t)=>{if($a(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if($a(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},B9=(e,n)=>{const t={},r=a=>{a.forEach(s=>{t[s]=!0})};return Jh(e)?r(e):r(String(e).split(n)),t},U9=()=>{},q9=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function V9(e){return!!(e&&$a(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const H9=e=>{const n=new Array(10),t=(r,a)=>{if(t0(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[a]=r;const s=Jh(r)?[]:{};return Ng(r,(l,f)=>{const u=t(l,a+1);!hg(u)&&(s[f]=u)}),n[a]=void 0,s}}return r};return t(e,0)},G9=Ws("AsyncFunction"),Y9=e=>e&&(t0(e)||$a(e))&&$a(e.then)&&$a(e.catch),lE=((e,n)=>e?setImmediate:n?((t,r)=>(Fd.addEventListener("message",({source:a,data:s})=>{a===Fd&&s===t&&r.length&&r.shift()()},!1),a=>{r.push(a),Fd.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",$a(Fd.postMessage)),W9=typeof queueMicrotask<"u"?queueMicrotask.bind(Fd):typeof process<"u"&&process.nextTick||lE,ze={isArray:Jh,isArrayBuffer:rE,isBuffer:f9,isFormData:w9,isArrayBufferView:h9,isString:p9,isNumber:iE,isBoolean:m9,isObject:t0,isPlainObject:rb,isReadableStream:N9,isRequest:C9,isResponse:j9,isHeaders:_9,isUndefined:hg,isDate:g9,isFile:y9,isBlob:x9,isRegExp:$9,isFunction:$a,isStream:v9,isURLSearchParams:S9,isTypedArray:M9,isFileList:b9,forEach:Ng,merge:L1,extend:E9,trim:k9,stripBOM:T9,inherits:A9,toFlatObject:P9,kindOf:Zb,kindOfTest:Ws,endsWith:D9,toArray:I9,forEachEntry:R9,matchAll:O9,isHTMLForm:L9,hasOwnProperty:JC,hasOwnProp:JC,reduceDescriptors:oE,freezeMethods:z9,toObjectSet:B9,toCamelCase:F9,noop:U9,toFiniteNumber:q9,findKey:aE,global:Fd,isContextDefined:sE,isSpecCompliantForm:V9,toJSONObject:H9,isAsyncFn:G9,isThenable:Y9,setImmediate:lE,asap:W9};function zt(e,n,t,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}ze.inherits(zt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ze.toJSONObject(this.config),code:this.code,status:this.status}}});const cE=zt.prototype,uE={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{uE[e]={value:e}});Object.defineProperties(zt,uE);Object.defineProperty(cE,"isAxiosError",{value:!0});zt.from=(e,n,t,r,a,s)=>{const l=Object.create(cE);return ze.toFlatObject(e,l,function(u){return u!==Error.prototype},f=>f!=="isAxiosError"),zt.call(l,e.message,n,t,r,a),l.cause=e,l.name=e.name,s&&Object.assign(l,s),l};const Q9=null;function F1(e){return ze.isPlainObject(e)||ze.isArray(e)}function dE(e){return ze.endsWith(e,"[]")?e.slice(0,-2):e}function KC(e,n,t){return e?e.concat(n).map(function(a,s){return a=dE(a),!t&&s?"["+a+"]":a}).join(t?".":""):n}function J9(e){return ze.isArray(e)&&!e.some(F1)}const K9=ze.toFlatObject(ze,{},null,function(n){return/^is[A-Z]/.test(n)});function n0(e,n,t){if(!ze.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=ze.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,E){return!ze.isUndefined(E[k])});const r=t.metaTokens,a=t.visitor||h,s=t.dots,l=t.indexes,u=(t.Blob||typeof Blob<"u"&&Blob)&&ze.isSpecCompliantForm(n);if(!ze.isFunction(a))throw new TypeError("visitor must be a function");function d(S){if(S===null)return"";if(ze.isDate(S))return S.toISOString();if(!u&&ze.isBlob(S))throw new zt("Blob is not supported. Use a Buffer instead.");return ze.isArrayBuffer(S)||ze.isTypedArray(S)?u&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function h(S,k,E){let T=S;if(S&&!E&&typeof S=="object"){if(ze.endsWith(k,"{}"))k=r?k:k.slice(0,-2),S=JSON.stringify(S);else if(ze.isArray(S)&&J9(S)||(ze.isFileList(S)||ze.endsWith(k,"[]"))&&(T=ze.toArray(S)))return k=dE(k),T.forEach(function(D,q){!(ze.isUndefined(D)||D===null)&&n.append(l===!0?KC([k],q,s):l===null?k:k+"[]",d(D))}),!1}return F1(S)?!0:(n.append(KC(E,k,s),d(S)),!1)}const g=[],b=Object.assign(K9,{defaultVisitor:h,convertValue:d,isVisitable:F1});function v(S,k){if(!ze.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+k.join("."));g.push(S),ze.forEach(S,function(T,I){(!(ze.isUndefined(T)||T===null)&&a.call(n,T,ze.isString(I)?I.trim():I,k,b))===!0&&v(T,k?k.concat(I):[I])}),g.pop()}}if(!ze.isObject(e))throw new TypeError("data must be an object");return v(e),n}function XC(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function Qw(e,n){this._pairs=[],e&&n0(e,this,n)}const fE=Qw.prototype;fE.append=function(n,t){this._pairs.push([n,t])};fE.toString=function(n){const t=n?function(r){return n.call(this,r,XC)}:XC;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function X9(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function hE(e,n,t){if(!n)return e;const r=t&&t.encode||X9;ze.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let s;if(a?s=a(n,t):s=ze.isURLSearchParams(n)?n.toString():new Qw(n,t).toString(r),s){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class ZC{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){ze.forEach(this.handlers,function(r){r!==null&&n(r)})}}const pE={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Z9=typeof URLSearchParams<"u"?URLSearchParams:Qw,e7=typeof FormData<"u"?FormData:null,t7=typeof Blob<"u"?Blob:null,n7={isBrowser:!0,classes:{URLSearchParams:Z9,FormData:e7,Blob:t7},protocols:["http","https","file","blob","url","data"]},Jw=typeof window<"u"&&typeof document<"u",$1=typeof navigator=="object"&&navigator||void 0,r7=Jw&&(!$1||["ReactNative","NativeScript","NS"].indexOf($1.product)<0),i7=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",a7=Jw&&window.location.href||"http://localhost",s7=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Jw,hasStandardBrowserEnv:r7,hasStandardBrowserWebWorkerEnv:i7,navigator:$1,origin:a7},Symbol.toStringTag,{value:"Module"})),_i={...s7,...n7};function o7(e,n){return n0(e,new _i.classes.URLSearchParams,Object.assign({visitor:function(t,r,a,s){return _i.isNode&&ze.isBuffer(t)?(this.append(r,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},n))}function l7(e){return ze.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function c7(e){const n={},t=Object.keys(e);let r;const a=t.length;let s;for(r=0;r<a;r++)s=t[r],n[s]=e[s];return n}function mE(e){function n(t,r,a,s){let l=t[s++];if(l==="__proto__")return!0;const f=Number.isFinite(+l),u=s>=t.length;return l=!l&&ze.isArray(a)?a.length:l,u?(ze.hasOwnProp(a,l)?a[l]=[a[l],r]:a[l]=r,!f):((!a[l]||!ze.isObject(a[l]))&&(a[l]=[]),n(t,r,a[l],s)&&ze.isArray(a[l])&&(a[l]=c7(a[l])),!f)}if(ze.isFormData(e)&&ze.isFunction(e.entries)){const t={};return ze.forEachEntry(e,(r,a)=>{n(l7(r),a,t,0)}),t}return null}function u7(e,n,t){if(ze.isString(e))try{return(n||JSON.parse)(e),ze.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const Cg={transitional:pE,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const r=t.getContentType()||"",a=r.indexOf("application/json")>-1,s=ze.isObject(n);if(s&&ze.isHTMLForm(n)&&(n=new FormData(n)),ze.isFormData(n))return a?JSON.stringify(mE(n)):n;if(ze.isArrayBuffer(n)||ze.isBuffer(n)||ze.isStream(n)||ze.isFile(n)||ze.isBlob(n)||ze.isReadableStream(n))return n;if(ze.isArrayBufferView(n))return n.buffer;if(ze.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let f;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return o7(n,this.formSerializer).toString();if((f=ze.isFileList(n))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return n0(f?{"files[]":n}:n,u&&new u,this.formSerializer)}}return s||a?(t.setContentType("application/json",!1),u7(n)):n}],transformResponse:[function(n){const t=this.transitional||Cg.transitional,r=t&&t.forcedJSONParsing,a=this.responseType==="json";if(ze.isResponse(n)||ze.isReadableStream(n))return n;if(n&&ze.isString(n)&&(r&&!this.responseType||a)){const l=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(n)}catch(f){if(l)throw f.name==="SyntaxError"?zt.from(f,zt.ERR_BAD_RESPONSE,this,null,this.response):f}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_i.classes.FormData,Blob:_i.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ze.forEach(["delete","get","head","post","put","patch"],e=>{Cg.headers[e]={}});const d7=ze.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),f7=e=>{const n={};let t,r,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),t=l.substring(0,a).trim().toLowerCase(),r=l.substring(a+1).trim(),!(!t||n[t]&&d7[t])&&(t==="set-cookie"?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n},ej=Symbol("internals");function Um(e){return e&&String(e).trim().toLowerCase()}function ib(e){return e===!1||e==null?e:ze.isArray(e)?e.map(ib):String(e)}function h7(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}const p7=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ev(e,n,t,r,a){if(ze.isFunction(r))return r.call(this,n,t);if(a&&(n=t),!!ze.isString(n)){if(ze.isString(r))return n.indexOf(r)!==-1;if(ze.isRegExp(r))return r.test(n)}}function m7(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}function g7(e,n){const t=ze.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(a,s,l){return this[r].call(this,n,a,s,l)},configurable:!0})})}let oa=class{constructor(n){n&&this.set(n)}set(n,t,r){const a=this;function s(f,u,d){const h=Um(u);if(!h)throw new Error("header name must be a non-empty string");const g=ze.findKey(a,h);(!g||a[g]===void 0||d===!0||d===void 0&&a[g]!==!1)&&(a[g||u]=ib(f))}const l=(f,u)=>ze.forEach(f,(d,h)=>s(d,h,u));if(ze.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(ze.isString(n)&&(n=n.trim())&&!p7(n))l(f7(n),t);else if(ze.isHeaders(n))for(const[f,u]of n.entries())s(u,f,r);else n!=null&&s(t,n,r);return this}get(n,t){if(n=Um(n),n){const r=ze.findKey(this,n);if(r){const a=this[r];if(!t)return a;if(t===!0)return h7(a);if(ze.isFunction(t))return t.call(this,a,r);if(ze.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=Um(n),n){const r=ze.findKey(this,n);return!!(r&&this[r]!==void 0&&(!t||Ev(this,this[r],r,t)))}return!1}delete(n,t){const r=this;let a=!1;function s(l){if(l=Um(l),l){const f=ze.findKey(r,l);f&&(!t||Ev(r,r[f],f,t))&&(delete r[f],a=!0)}}return ze.isArray(n)?n.forEach(s):s(n),a}clear(n){const t=Object.keys(this);let r=t.length,a=!1;for(;r--;){const s=t[r];(!n||Ev(this,this[s],s,n,!0))&&(delete this[s],a=!0)}return a}normalize(n){const t=this,r={};return ze.forEach(this,(a,s)=>{const l=ze.findKey(r,s);if(l){t[l]=ib(a),delete t[s];return}const f=n?m7(s):String(s).trim();f!==s&&delete t[s],t[f]=ib(a),r[f]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return ze.forEach(this,(r,a)=>{r!=null&&r!==!1&&(t[a]=n&&ze.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(a=>r.set(a)),r}static accessor(n){const r=(this[ej]=this[ej]={accessors:{}}).accessors,a=this.prototype;function s(l){const f=Um(l);r[f]||(g7(a,l),r[f]=!0)}return ze.isArray(n)?n.forEach(s):s(n),this}};oa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ze.reduceDescriptors(oa.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[t]=r}}});ze.freezeMethods(oa);function Tv(e,n){const t=this||Cg,r=n||t,a=oa.from(r.headers);let s=r.data;return ze.forEach(e,function(f){s=f.call(t,s,a.normalize(),n?n.status:void 0)}),a.normalize(),s}function gE(e){return!!(e&&e.__CANCEL__)}function Kh(e,n,t){zt.call(this,e??"canceled",zt.ERR_CANCELED,n,t),this.name="CanceledError"}ze.inherits(Kh,zt,{__CANCEL__:!0});function yE(e,n,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):n(new zt("Request failed with status code "+t.status,[zt.ERR_BAD_REQUEST,zt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function y7(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function x7(e,n){e=e||10;const t=new Array(e),r=new Array(e);let a=0,s=0,l;return n=n!==void 0?n:1e3,function(u){const d=Date.now(),h=r[s];l||(l=d),t[a]=u,r[a]=d;let g=s,b=0;for(;g!==a;)b+=t[g++],g=g%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),d-l<n)return;const v=h&&d-h;return v?Math.round(b*1e3/v):void 0}}function b7(e,n){let t=0,r=1e3/n,a,s;const l=(d,h=Date.now())=>{t=h,a=null,s&&(clearTimeout(s),s=null),e.apply(null,d)};return[(...d)=>{const h=Date.now(),g=h-t;g>=r?l(d,h):(a=d,s||(s=setTimeout(()=>{s=null,l(a)},r-g)))},()=>a&&l(a)]}const kb=(e,n,t=3)=>{let r=0;const a=x7(50,250);return b7(s=>{const l=s.loaded,f=s.lengthComputable?s.total:void 0,u=l-r,d=a(u),h=l<=f;r=l;const g={loaded:l,total:f,progress:f?l/f:void 0,bytes:u,rate:d||void 0,estimated:d&&f&&h?(f-l)/d:void 0,event:s,lengthComputable:f!=null,[n?"download":"upload"]:!0};e(g)},t)},tj=(e,n)=>{const t=e!=null;return[r=>n[0]({lengthComputable:t,total:e,loaded:r}),n[1]]},nj=e=>(...n)=>ze.asap(()=>e(...n)),v7=_i.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,_i.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(_i.origin),_i.navigator&&/(msie|trident)/i.test(_i.navigator.userAgent)):()=>!0,w7=_i.hasStandardBrowserEnv?{write(e,n,t,r,a,s){const l=[e+"="+encodeURIComponent(n)];ze.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),ze.isString(r)&&l.push("path="+r),ze.isString(a)&&l.push("domain="+a),s===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function S7(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function N7(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function xE(e,n,t){let r=!S7(n);return e&&(r||t==!1)?N7(e,n):n}const rj=e=>e instanceof oa?{...e}:e;function Gd(e,n){n=n||{};const t={};function r(d,h,g,b){return ze.isPlainObject(d)&&ze.isPlainObject(h)?ze.merge.call({caseless:b},d,h):ze.isPlainObject(h)?ze.merge({},h):ze.isArray(h)?h.slice():h}function a(d,h,g,b){if(ze.isUndefined(h)){if(!ze.isUndefined(d))return r(void 0,d,g,b)}else return r(d,h,g,b)}function s(d,h){if(!ze.isUndefined(h))return r(void 0,h)}function l(d,h){if(ze.isUndefined(h)){if(!ze.isUndefined(d))return r(void 0,d)}else return r(void 0,h)}function f(d,h,g){if(g in n)return r(d,h);if(g in e)return r(void 0,d)}const u={url:s,method:s,data:s,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:f,headers:(d,h,g)=>a(rj(d),rj(h),g,!0)};return ze.forEach(Object.keys(Object.assign({},e,n)),function(h){const g=u[h]||a,b=g(e[h],n[h],h);ze.isUndefined(b)&&g!==f||(t[h]=b)}),t}const bE=e=>{const n=Gd({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:s,headers:l,auth:f}=n;n.headers=l=oa.from(l),n.url=hE(xE(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),f&&l.set("Authorization","Basic "+btoa((f.username||"")+":"+(f.password?unescape(encodeURIComponent(f.password)):"")));let u;if(ze.isFormData(t)){if(_i.hasStandardBrowserEnv||_i.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((u=l.getContentType())!==!1){const[d,...h]=u?u.split(";").map(g=>g.trim()).filter(Boolean):[];l.setContentType([d||"multipart/form-data",...h].join("; "))}}if(_i.hasStandardBrowserEnv&&(r&&ze.isFunction(r)&&(r=r(n)),r||r!==!1&&v7(n.url))){const d=a&&s&&w7.read(s);d&&l.set(a,d)}return n},C7=typeof XMLHttpRequest<"u",j7=C7&&function(e){return new Promise(function(t,r){const a=bE(e);let s=a.data;const l=oa.from(a.headers).normalize();let{responseType:f,onUploadProgress:u,onDownloadProgress:d}=a,h,g,b,v,S;function k(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let E=new XMLHttpRequest;E.open(a.method.toUpperCase(),a.url,!0),E.timeout=a.timeout;function T(){if(!E)return;const D=oa.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),F={data:!f||f==="text"||f==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:D,config:e,request:E};yE(function(B){t(B),k()},function(B){r(B),k()},F),E=null}"onloadend"in E?E.onloadend=T:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(T)},E.onabort=function(){E&&(r(new zt("Request aborted",zt.ECONNABORTED,e,E)),E=null)},E.onerror=function(){r(new zt("Network Error",zt.ERR_NETWORK,e,E)),E=null},E.ontimeout=function(){let q=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const F=a.transitional||pE;a.timeoutErrorMessage&&(q=a.timeoutErrorMessage),r(new zt(q,F.clarifyTimeoutError?zt.ETIMEDOUT:zt.ECONNABORTED,e,E)),E=null},s===void 0&&l.setContentType(null),"setRequestHeader"in E&&ze.forEach(l.toJSON(),function(q,F){E.setRequestHeader(F,q)}),ze.isUndefined(a.withCredentials)||(E.withCredentials=!!a.withCredentials),f&&f!=="json"&&(E.responseType=a.responseType),d&&([b,S]=kb(d,!0),E.addEventListener("progress",b)),u&&E.upload&&([g,v]=kb(u),E.upload.addEventListener("progress",g),E.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(h=D=>{E&&(r(!D||D.type?new Kh(null,e,E):D),E.abort(),E=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const I=y7(a.url);if(I&&_i.protocols.indexOf(I)===-1){r(new zt("Unsupported protocol "+I+":",zt.ERR_BAD_REQUEST,e));return}E.send(s||null)})},_7=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let r=new AbortController,a;const s=function(d){if(!a){a=!0,f();const h=d instanceof Error?d:this.reason;r.abort(h instanceof zt?h:new Kh(h instanceof Error?h.message:h))}};let l=n&&setTimeout(()=>{l=null,s(new zt(`timeout ${n} of ms exceeded`,zt.ETIMEDOUT))},n);const f=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(s):d.removeEventListener("abort",s)}),e=null)};e.forEach(d=>d.addEventListener("abort",s));const{signal:u}=r;return u.unsubscribe=()=>ze.asap(f),u}},k7=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let r=0,a;for(;r<t;)a=r+n,yield e.slice(r,a),r=a},E7=async function*(e,n){for await(const t of T7(e))yield*k7(t,n)},T7=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:r}=await n.read();if(t)break;yield r}}finally{await n.cancel()}},ij=(e,n,t,r)=>{const a=E7(e,n);let s=0,l,f=u=>{l||(l=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:d,value:h}=await a.next();if(d){f(),u.close();return}let g=h.byteLength;if(t){let b=s+=g;t(b)}u.enqueue(new Uint8Array(h))}catch(d){throw f(d),d}},cancel(u){return f(u),a.return()}},{highWaterMark:2})},r0=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",vE=r0&&typeof ReadableStream=="function",A7=r0&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),wE=(e,...n)=>{try{return!!e(...n)}catch{return!1}},P7=vE&&wE(()=>{let e=!1;const n=new Request(_i.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),aj=64*1024,z1=vE&&wE(()=>ze.isReadableStream(new Response("").body)),Eb={stream:z1&&(e=>e.body)};r0&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!Eb[n]&&(Eb[n]=ze.isFunction(e[n])?t=>t[n]():(t,r)=>{throw new zt(`Response type '${n}' is not supported`,zt.ERR_NOT_SUPPORT,r)})})})(new Response);const D7=async e=>{if(e==null)return 0;if(ze.isBlob(e))return e.size;if(ze.isSpecCompliantForm(e))return(await new Request(_i.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ze.isArrayBufferView(e)||ze.isArrayBuffer(e))return e.byteLength;if(ze.isURLSearchParams(e)&&(e=e+""),ze.isString(e))return(await A7(e)).byteLength},I7=async(e,n)=>{const t=ze.toFiniteNumber(e.getContentLength());return t??D7(n)},M7=r0&&(async e=>{let{url:n,method:t,data:r,signal:a,cancelToken:s,timeout:l,onDownloadProgress:f,onUploadProgress:u,responseType:d,headers:h,withCredentials:g="same-origin",fetchOptions:b}=bE(e);d=d?(d+"").toLowerCase():"text";let v=_7([a,s&&s.toAbortSignal()],l),S;const k=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let E;try{if(u&&P7&&t!=="get"&&t!=="head"&&(E=await I7(h,r))!==0){let F=new Request(n,{method:"POST",body:r,duplex:"half"}),$;if(ze.isFormData(r)&&($=F.headers.get("content-type"))&&h.setContentType($),F.body){const[B,z]=tj(E,kb(nj(u)));r=ij(F.body,aj,B,z)}}ze.isString(g)||(g=g?"include":"omit");const T="credentials"in Request.prototype;S=new Request(n,{...b,signal:v,method:t.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:T?g:void 0});let I=await fetch(S);const D=z1&&(d==="stream"||d==="response");if(z1&&(f||D&&k)){const F={};["status","statusText","headers"].forEach(U=>{F[U]=I[U]});const $=ze.toFiniteNumber(I.headers.get("content-length")),[B,z]=f&&tj($,kb(nj(f),!0))||[];I=new Response(ij(I.body,aj,B,()=>{z&&z(),k&&k()}),F)}d=d||"text";let q=await Eb[ze.findKey(Eb,d)||"text"](I,e);return!D&&k&&k(),await new Promise((F,$)=>{yE(F,$,{data:q,headers:oa.from(I.headers),status:I.status,statusText:I.statusText,config:e,request:S})})}catch(T){throw k&&k(),T&&T.name==="TypeError"&&/fetch/i.test(T.message)?Object.assign(new zt("Network Error",zt.ERR_NETWORK,e,S),{cause:T.cause||T}):zt.from(T,T&&T.code,e,S)}}),B1={http:Q9,xhr:j7,fetch:M7};ze.forEach(B1,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const sj=e=>`- ${e}`,R7=e=>ze.isFunction(e)||e===null||e===!1,SE={getAdapter:e=>{e=ze.isArray(e)?e:[e];const{length:n}=e;let t,r;const a={};for(let s=0;s<n;s++){t=e[s];let l;if(r=t,!R7(t)&&(r=B1[(l=String(t)).toLowerCase()],r===void 0))throw new zt(`Unknown adapter '${l}'`);if(r)break;a[l||"#"+s]=r}if(!r){const s=Object.entries(a).map(([f,u])=>`adapter ${f} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=n?s.length>1?`since :
`+s.map(sj).join(`
`):" "+sj(s[0]):"as no adapter specified";throw new zt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:B1};function Av(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Kh(null,e)}function oj(e){return Av(e),e.headers=oa.from(e.headers),e.data=Tv.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),SE.getAdapter(e.adapter||Cg.adapter)(e).then(function(r){return Av(e),r.data=Tv.call(e,e.transformResponse,r),r.headers=oa.from(r.headers),r},function(r){return gE(r)||(Av(e),r&&r.response&&(r.response.data=Tv.call(e,e.transformResponse,r.response),r.response.headers=oa.from(r.response.headers))),Promise.reject(r)})}const NE="1.8.4",i0={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{i0[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const lj={};i0.transitional=function(n,t,r){function a(s,l){return"[Axios v"+NE+"] Transitional option '"+s+"'"+l+(r?". "+r:"")}return(s,l,f)=>{if(n===!1)throw new zt(a(l," has been removed"+(t?" in "+t:"")),zt.ERR_DEPRECATED);return t&&!lj[l]&&(lj[l]=!0,console.warn(a(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(s,l,f):!0}};i0.spelling=function(n){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function O7(e,n,t){if(typeof e!="object")throw new zt("options must be an object",zt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const s=r[a],l=n[s];if(l){const f=e[s],u=f===void 0||l(f,s,e);if(u!==!0)throw new zt("option "+s+" must be "+u,zt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new zt("Unknown option "+s,zt.ERR_BAD_OPTION)}}const ab={assertOptions:O7,validators:i0},Oo=ab.validators;let Bd=class{constructor(n){this.defaults=n,this.interceptors={request:new ZC,response:new ZC}}async request(n,t){try{return await this._request(n,t)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=Gd(this.defaults,t);const{transitional:r,paramsSerializer:a,headers:s}=t;r!==void 0&&ab.assertOptions(r,{silentJSONParsing:Oo.transitional(Oo.boolean),forcedJSONParsing:Oo.transitional(Oo.boolean),clarifyTimeoutError:Oo.transitional(Oo.boolean)},!1),a!=null&&(ze.isFunction(a)?t.paramsSerializer={serialize:a}:ab.assertOptions(a,{encode:Oo.function,serialize:Oo.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),ab.assertOptions(t,{baseUrl:Oo.spelling("baseURL"),withXsrfToken:Oo.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=s&&ze.merge(s.common,s[t.method]);s&&ze.forEach(["delete","get","head","post","put","patch","common"],S=>{delete s[S]}),t.headers=oa.concat(l,s);const f=[];let u=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(u=u&&k.synchronous,f.unshift(k.fulfilled,k.rejected))});const d=[];this.interceptors.response.forEach(function(k){d.push(k.fulfilled,k.rejected)});let h,g=0,b;if(!u){const S=[oj.bind(this),void 0];for(S.unshift.apply(S,f),S.push.apply(S,d),b=S.length,h=Promise.resolve(t);g<b;)h=h.then(S[g++],S[g++]);return h}b=f.length;let v=t;for(g=0;g<b;){const S=f[g++],k=f[g++];try{v=S(v)}catch(E){k.call(this,E);break}}try{h=oj.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,b=d.length;g<b;)h=h.then(d[g++],d[g++]);return h}getUri(n){n=Gd(this.defaults,n);const t=xE(n.baseURL,n.url,n.allowAbsoluteUrls);return hE(t,n.params,n.paramsSerializer)}};ze.forEach(["delete","get","head","options"],function(n){Bd.prototype[n]=function(t,r){return this.request(Gd(r||{},{method:n,url:t,data:(r||{}).data}))}});ze.forEach(["post","put","patch"],function(n){function t(r){return function(s,l,f){return this.request(Gd(f||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:l}))}}Bd.prototype[n]=t(),Bd.prototype[n+"Form"]=t(!0)});let L7=class CE{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const r=this;this.promise.then(a=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](a);r._listeners=null}),this.promise.then=a=>{let s;const l=new Promise(f=>{r.subscribe(f),s=f}).then(a);return l.cancel=function(){r.unsubscribe(s)},l},n(function(s,l,f){r.reason||(r.reason=new Kh(s,l,f),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=r=>{n.abort(r)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new CE(function(a){n=a}),cancel:n}}};function F7(e){return function(t){return e.apply(null,t)}}function $7(e){return ze.isObject(e)&&e.isAxiosError===!0}const U1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(U1).forEach(([e,n])=>{U1[n]=e});function jE(e){const n=new Bd(e),t=nE(Bd.prototype.request,n);return ze.extend(t,Bd.prototype,n,{allOwnKeys:!0}),ze.extend(t,n,null,{allOwnKeys:!0}),t.create=function(a){return jE(Gd(e,a))},t}const yr=jE(Cg);yr.Axios=Bd;yr.CanceledError=Kh;yr.CancelToken=L7;yr.isCancel=gE;yr.VERSION=NE;yr.toFormData=n0;yr.AxiosError=zt;yr.Cancel=yr.CanceledError;yr.all=function(n){return Promise.all(n)};yr.spread=F7;yr.isAxiosError=$7;yr.mergeConfig=Gd;yr.AxiosHeaders=oa;yr.formToJSON=e=>mE(ze.isHTMLForm(e)?new FormData(e):e);yr.getAdapter=SE.getAdapter;yr.HttpStatusCode=U1;yr.default=yr;const{Axios:Yie,AxiosError:Wie,CanceledError:Qie,isCancel:Jie,CancelToken:Kie,VERSION:Xie,all:Zie,Cancel:eae,isAxiosError:tae,spread:nae,toFormData:rae,AxiosHeaders:iae,HttpStatusCode:aae,formToJSON:sae,getAdapter:oae,mergeConfig:lae}=yr;function z7(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(u=>u.addEventListener("ended",f)),()=>{e.getTracks().forEach(u=>u.removeEventListener("ended",f))}},[e]),{type:"screen",start:async()=>{const f=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function B7(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(u=>u.addEventListener("ended",f)),()=>{e.getTracks().forEach(u=>u.removeEventListener("ended",f))}},[e]),{type:"webcam",start:async()=>{const f=await navigator.mediaDevices.getUserMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class U7 extends Zk{constructor(t){super();Ln(this,"client");Ln(this,"_status","disconnected");Ln(this,"_session",null);Ln(this,"_model",null);Ln(this,"config",null);this.client=new Jk(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(s){return console.error("Error connecting to GenAI Live:",s),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let s=((r=a.modelTurn)==null?void 0:r.parts)||[];const l=s.filter(h=>{var g;return h.inlineData&&((g=h.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),f=l.map(h=>{var g;return(g=h.inlineData)==null?void 0:g.data}),u=tE.difference(s,l);if(f.forEach(h=>{if(h){const g=t9(h);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!u.length)return;s=u;const d={modelTurn:{parts:s}};this.emit("content",d),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let r=!1,a=!1;for(const f of t)if((l=this.session)==null||l.sendRealtimeInput({media:f}),f.mimeType.includes("audio")&&(r=!0),f.mimeType.includes("image")&&(a=!0),r&&a)break;const s=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",s)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function q7(e){const n=w.useMemo(()=>new U7(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[s,l]=w.useState({}),[f,u]=w.useState(!1),[d,h]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||Kk({id:"audio-out"}).then(k=>{t.current=new u9(k),t.current.addWorklet("vumeter-out",Xk,E=>{h(E.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{u(!0)},E=()=>{u(!1)},T=F=>{console.error("error",F)},I=()=>{var F;return(F=t.current)==null?void 0:F.stop()},D=F=>{var $;return($=t.current)==null?void 0:$.addPCM16(new Uint8Array(F))},q=F=>{if(console.log("Received content event:",F),F.modelTurn&&F.modelTurn.parts){const $=F.modelTurn.parts.filter(B=>"text"in B&&B.text);if($.length>0){const B=$.map(z=>z.text).join(" ");b(B),console.log("AI Summary received:",B)}}};return n.on("error",T).on("open",k).on("close",E).on("interrupted",I).on("audio",D).on("content",q),()=>{n.off("error",T).off("open",k).off("close",E).off("interrupted",I).off("audio",D).off("content",q).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!s)throw new Error("config has not been set");n.disconnect(),await n.connect(r,s)},[n,s,r]),S=w.useCallback(async()=>{n.disconnect(),u(!1)},[u,n]);return{client:n,config:s,setConfig:l,model:r,setModel:a,connected:f,connect:v,disconnect:S,volume:d,aiSummary:g}}const _E=w.createContext(void 0),Kw=({options:e,children:n})=>{const t=q7(e);return i.jsx(_E.Provider,{value:t,children:n})},ru=()=>{const e=w.useContext(_E);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function V7(){const{config:e,setConfig:n}=ru(),[t,r]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(s=>{n({...e,responseModalities:[s==="audio"?Xc.AUDIO:Xc.TEXT]})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),i.jsx(Ik,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:s=>{r(s),s&&(s.value==="audio"||s.value==="text")&&a(s.value)}})]})}const cj=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function H7(){const{config:e,setConfig:n}=ru();w.useEffect(()=>{var f,u,d;const s=((d=(u=(f=e.speechConfig)==null?void 0:f.voiceConfig)==null?void 0:u.prebuiltVoiceConfig)==null?void 0:d.voiceName)||"Atari02";r({value:s,label:s})},[e]);const[t,r]=w.useState(cj[5]),a=w.useCallback(s=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:s}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(Ik,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:cj,onChange:s=>{r(s),s&&a(s.value)}})]})}function G7(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=ru(),s=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(d=>Array.isArray(d.functionDeclarations)).map(d=>d.functionDeclarations).filter(d=>!!d).flat():[],[t]),l=w.useMemo(()=>{var d;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(h=>typeof h=="string"?h:h.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((d=t.systemInstruction.parts)==null?void 0:d.map(h=>h.text).join(`
`))||"":""},[t]),f=w.useCallback(d=>{const h={...t,systemInstruction:d.target.value};r(h)},[t,r]),u=w.useCallback((d,h)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===d?{...k,description:h}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsxs("div",{className:"mode-selectors",children:[i.jsx(V7,{}),i.jsx(H7,{})]}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:f,value:l}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:s.map((d,h)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:d.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=d.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:d.description,onBlur:b=>u(d.name,b.target.value)},`fd-${d.description}`)]},`function-${h}`)})})})]})})]})}const uj=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function Y7({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const s=[B7(),z7()],[l,f]=w.useState(null),[u,d]=s,[h,g]=w.useState(0),[b]=w.useState(()=>new eE),[v,S]=w.useState(!1),k=w.useRef(null),E=w.useRef(null),{client:T,connected:I,connect:D,disconnect:q,volume:F}=ru();w.useEffect(()=>{!I&&E.current&&E.current.focus()},[I]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(h*200,8))}px`)},[h]),w.useEffect(()=>{const B=z=>{T.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:z}])};return I&&!v&&b?b.on("data",B).on("volume",g).start():b.stop(),()=>{b.off("data",B).off("volume",g)}},[I,T,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let B=-1;function z(){const U=e.current,L=k.current;if(!U||!L)return;const R=L.getContext("2d");if(L.width=U.videoWidth*.25,L.height=U.videoHeight*.25,L.width+L.height>0){R.drawImage(U,0,0,L.width,L.height);const G=L.toDataURL("image/jpeg",1),ee=G.slice(G.indexOf(",")+1,1/0);T.sendRealtimeInput([{mimeType:"image/jpeg",data:ee}])}I&&(B=window.setTimeout(z,1e3/.5))}return I&&l!==null&&requestAnimationFrame(z),()=>{clearTimeout(B)}},[I,l,T,e]);const $=B=>async()=>{if(B){const z=await B.start();f(z),t(z)}else f(null),t(null);s.filter(z=>z!==B).forEach(z=>z.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:Kc("actions-nav",{disabled:!I}),children:[i.jsx("button",{className:Kc("action-button mic-button",{recording:!v&&I}),onClick:()=>S(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(o9,{volume:F,active:I,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(uj,{isStreaming:d.isStreaming,start:$(d),stop:$(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(uj,{isStreaming:u.isStreaming,start:$(u),stop:$(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:Kc("connection-container",{connected:I}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:E,className:Kc("action-button connect-toggle",{connected:I}),onClick:I?q:D,children:i.jsx("span",{className:"material-symbols-outlined filled",children:I?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(G7,{}):""]})}const dj={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Uh.OBJECT,properties:{summary:{type:Uh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},W7=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:s,setModel:l}=ru();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),s({responseModalities:[Xc.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[dj]}]})},[s,l]),w.useEffect(()=>{const f=u=>{if(!u.functionCalls)return;const d=u.functionCalls.find(h=>h.name===dj.name);if(d){const h=d.args.summary;r(h)}u.functionCalls.length&&setTimeout(()=>{var h;return a.sendToolResponse({functionResponses:(h=u.functionCalls)==null?void 0:h.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",f),()=>{a.off("toolcall",f)}},[a]),w.useEffect(()=>{if(t){const f=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${f}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${f}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})},fj="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes";async function Q7(){const e=R2();if(!e)return console.warn("No auth token found, using default Live API key."),fj;try{const t=(await yr.get("/api/clinics/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).data.geminiApiKey;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Live API key:",n)}return console.warn("Clinic-specific Live API key not found or failed to fetch, using default."),fj}function J7(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await Q7();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(Kw,{options:r,children:i.jsx(K7,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const K7=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[s,l]=w.useState(null),{connected:f,client:u,connect:d,config:h,model:g}=ru(),[b,v]=w.useState(""),S=w.useRef(null),[k,E]=w.useState(!1);w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),D=q=>{document.documentElement.setAttribute("data-theme",q.matches?"dark":"light")};return D(I),I.addEventListener("change",D),()=>I.removeEventListener("change",D)},[]),w.useEffect(()=>{const I=new URLSearchParams(window.location.search),D={};for(const[q,F]of I.entries())q==="token_number"?l(F):D[q]=F;a(D)},[]),w.useEffect(()=>{Object.keys(h).length>0&&g&&d()},[d,h,g]),w.useEffect(()=>{if(f&&r&&!k){const I=JSON.stringify(r,null,2);u.send([{text:I}]),v(""),E(!0)}},[f,r,u,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const T=()=>{u.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(W7,{patientData:r,tokenNumber:s}),i.jsx("video",{className:Kc("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:Kc("input-container",{disabled:!f}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:S,onKeyDown:I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),I.stopPropagation(),T())},onChange:I=>v(I.target.value),value:b}),i.jsx("span",{className:Kc("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:T,children:"send"})]})}),i.jsx(Y7,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},hj="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",X7=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},Z7=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},s)=>{var $;const{connected:l,connect:f,disconnect:u,client:d,volume:h}=ru(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,E]=w.useState(!1),[T]=w.useState(()=>new eE),I=async()=>{l?await u():(await f(),r.trim()&&a())};w.useEffect(()=>{const B=z=>{d.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:z}])};return l&&!g?T.on("data",B).start():T.stop(),()=>{T.off("data",B),T.stop()}},[l,d,g,T]);const D=w.useCallback(async()=>{if(v)F==null||F.getTracks().forEach(B=>B.stop()),t(null),S(!1);else try{const B=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),S(!0)}catch(B){console.error("Error accessing webcam:",B),S(!1)}},[v,t,e]),q=w.useCallback(async()=>{if(k)F==null||F.getTracks().forEach(B=>B.stop()),t(null),E(!1);else try{const B=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),E(!0)}catch(B){console.error("Error accessing screen share:",B),E(!1)}},[k,t,e]),F=($=e.current)==null?void 0:$.srcObject;return w.useEffect(()=>()=>{F&&F.getTracks().forEach(B=>B.stop())},[F]),w.useImperativeHandle(s,()=>({handleConnect:I})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(RM,{className:"w-5 h-5"}):i.jsx(T2,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(X7,{volume:h,active:l})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:q,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(FM,{className:"w-5 h-5"})}),i.jsx("button",{onClick:D,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(DR,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:I,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx(YM,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(ZM,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),eq=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:r})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:r.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[r," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",r," Reception Assistant"]})]}),n&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:n})]}),e?i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"Patient Information"}),i.jsx("div",{className:"hospital-reception-patient-info-content",children:i.jsx("pre",{className:"hospital-reception-patient-info-pre",children:JSON.stringify(e,null,2)})})]}):i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"New Case"}),i.jsx("p",{className:"hospital-reception-patient-info-pre",children:"No patient data provided. This is a new case."})]}),t&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),pj={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Uh.OBJECT,properties:{summary:{type:Uh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},tq=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a,aiLanguage:s})=>{const l=w.useRef(null),f=w.useRef(null),[u,d]=w.useState(null),[h,g]=w.useState("hi"),{client:b,connected:v,aiSummary:S,setConfig:k,setModel:E,disconnect:T}=ru(),[I,D]=w.useState(null),q=w.useMemo(()=>{let B=`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, and sex(dont ask for sex ,detect automatically through voice recognition).

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in ${s||"English"}.dont write the ${s||"English"} words in english.donot use function calls in the middle of the conversation`;return n&&(B+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[Xc.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:B}]},tools:[{functionDeclarations:[pj]}]}},[n,s]);w.useEffect(()=>{E("models/gemini-2.5-flash-native-audio-preview-09-2025"),k(q);const B=setTimeout(()=>{f.current&&!v&&f.current.handleConnect()},2e3);return()=>clearTimeout(B)},[k,E,q,v]),w.useEffect(()=>()=>{v&&T()},[v,T]),w.useEffect(()=>{r(S)},[S,r]),w.useEffect(()=>{const B=z=>{if(z.modelTurn&&z.modelTurn.parts){for(const U of z.modelTurn.parts)if(U.executableCode){const L=U.executableCode.code,R=/summary=["'](.*?)["']/.exec(L);if(R&&R[1]){const G=R[1];D(G),r(G)}}}};return b.on("content",B),()=>{b.off("content",B)}},[b,r]),w.useEffect(()=>{const B=z=>{if(!z.functionCalls)return;const U=z.functionCalls.find(L=>L.name===pj.name);if(U){const L=U.args.summary;r(L)}z.functionCalls.length&&setTimeout(()=>{var L;return b.sendToolResponse({functionResponses:(L=z.functionCalls)==null?void 0:L.map(R=>({response:{output:{success:!0}},id:R.id,name:R.name}))})},200)};return b.on("toolcall",B),()=>{b.off("toolcall",B)}},[b,r]);const F=()=>{h.trim()&&(b.send([{text:h}]),g(""))},$=B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),F())};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(Kn,{className:"w-6 h-6"})})})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(eq,{patientData:n,tokenNumber:t,aiSummary:I??S,clinicName:a}),u&&i.jsx("video",{ref:l,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:h,onChange:B=>g(B.target.value),onKeyDown:$,placeholder:"Type your message here...",disabled:!v,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:F,disabled:!v||!h.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(sR,{className:"w-5 h-5"})})]})}),i.jsx(Z7,{ref:f,videoRef:l,supportsVideo:!0,onVideoStreamChange:d,textInput:h,onSubmitTextInput:F})]})})]})})},kE=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,s]=w.useState(null),[l,f]=w.useState("Newtons Ai"),[u,d]=w.useState(""),[h,g]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{const k=await(await ge("/api/clinics/settings")).json();k.gemini_api_key?s(k.gemini_api_key):s(hj),k.name&&k.name!==""?f(k.name):f("Newtons Ai"),d(k.aiLanguage||"")}catch(S){console.error("Failed to fetch clinic settings, using default API key and unknown clinic name:",S),s(hj),f("Newtons Ai"),d("")}finally{g(!1)}})()},[]),h)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Loading API Key and Clinic Name..."})})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const b={apiKey:a};return i.jsx(Kw,{options:b,children:i.jsx(tq,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:l,aiLanguage:u})})},nq=({onClose:e})=>{const n=yt(),t=()=>{e(),n("/start-clinic-subscription")};return i.jsx("div",{className:"go-pro-modal-overlay",children:i.jsxs("div",{className:"go-pro-modal-content",children:[i.jsx("button",{onClick:e,className:"go-pro-modal-close-button",children:i.jsx(Kn,{size:24})}),i.jsx("h2",{className:"go-pro-modal-title",children:"Voice AI Agent for Pro Members Only"}),i.jsx("p",{className:"go-pro-modal-message",children:"Unlock the full potential of our Voice AI Agent by upgrading to a Pro subscription. Enjoy advanced features and seamless patient interactions."}),i.jsx("button",{onClick:t,className:"go-pro-button",children:"Go Pro Now"})]})})},rq="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",iq={apiKey:rq},Ph=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,s]=w.useState([]),[l,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState(null),[S,k]=w.useState(!1),[E,T]=w.useState(null),I=w.useRef(null),[D,q]=w.useState(!1),[F,$]=w.useState(!1),[B,z]=w.useState(null),[U,L]=w.useState(null),[R,G]=w.useState(null),[ee,te]=w.useState(!1),oe=yt(),K=oi();w.useEffect(()=>{(async()=>{try{const Se=await V2();G(Se.hasProPlan)}catch(Se){console.error("Error fetching pro status:",Se),G(!1)}})(),V()},[]);const V=async()=>{try{const de=new URLSearchParams({page:"1",limit:"4",sortBy:"created_at",sortOrder:"desc"}),Se=await ge(`/api/patients?${de.toString()}`);if(Se.ok){const fe=await Se.json();s(fe.patients)}}catch(de){console.error("Error fetching recent patients:",de)}},J=w.useCallback(async de=>{const Se=de||e;if(!Se.trim()){T("Please enter complaint details.");return}k(!0),T(null);try{const fe=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!fe.ok){const Ve=await fe.json().catch(()=>({message:"Failed to create patient"}));if(fe.status===403&&Ve.message.includes("Patient limit")){oe("/start-clinic-subscription",{state:{errorMessage:Ve.message}});return}throw new Error(Ve.message||`Failed to create patient: ${fe.statusText}`)}const we=await fe.json();if(!we||!we.id)throw new Error("Failed to create new patient or retrieve patient ID.");const ie=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:we.id,complaint:Se})});if(!ie.ok){const Ve=await ie.text();throw new Error(`Failed to create queue entry: ${Ve||ie.statusText}`)}const _e=await ie.json();if(!_e||!_e.id)throw new Error("Failed to create new complaint record or retrieve record ID.");oe(`/dashboard/edit-complaint/${_e.id}`,{state:{initialComplaint:Se,patientId:we.id}})}catch(fe){console.error("Error starting new complaint:",fe),fe.message.includes("Patient limit")?(T(`Error: ${fe.message}. Please upgrade your plan.`),oe("/start-clinic-subscription")):T(`Error: ${fe.message||"Failed to start new complaint process."}`)}finally{k(!1)}},[e,oe]);w.useEffect(()=>{const de=I.current;de&&(de.style.height="auto",de.style.height=`${de.scrollHeight}px`);const fe=new URLSearchParams(K.search).get("caseDetails");if(fe){const we=decodeURIComponent(fe);we!==e&&(n(we),q(!0))}},[K.search,e]),w.useEffect(()=>{D&&e.trim()&&(oe(K.pathname,{replace:!0}),J(e),q(!1))},[D,e,J,oe,K.pathname]),w.useEffect(()=>{const de=I.current;de&&(de.style.height="auto",de.style.height=`${de.scrollHeight}px`)},[e]),w.useEffect(()=>{B&&(n(B),$(!1),J(B),z(null))},[B,J]);const ne=()=>{if(R===!1){te(!0);return}L({id:null,token:null,name:"New Case",age:null,gender:null}),$(!0)},A=w.useMemo(()=>qb(async de=>{const Se=de.trim(),fe=/^\d+$/.test(Se),we=Se.split(/\s+/).length;if(Se.length<2||fe&&Se.length>10||!fe&&we>2){r([]),f(!1),d(null);return}f(!0),d(null);try{const ie=new URLSearchParams({search:encodeURIComponent(de),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),_e=await ge(`/api/patients?${ie.toString()}`);if(!_e.ok){const tt=await _e.text();throw new Error(`API Error (${_e.status}): ${tt||_e.statusText}`)}const Ve=await _e.json();r(Ve.patients)}catch(ie){console.error("Error searching patients:",ie),d(ie.message||"Failed to search patients."),r([])}finally{f(!1)}},300),[]),ae=de=>{const Se=de.target.value;n(Se);const fe=Se.trim(),we=/^\d+$/.test(fe),ie=fe.split(/\s+/).length;fe.length>=2&&!(we&&fe.length>10||!we&&ie>2)?f(!0):(f(!1),r([])),A(Se)},ce=de=>{de.key==="Enter"&&!de.shiftKey&&(de.preventDefault(),t.length>0&&!l?M(t[0]):e.trim()&&!l&&J(e))},M=async de=>{r([]),n(""),g(!0),v(null);try{const Se=await ge(`/api/queue/patient/${de.id}/latest`);if(Se.ok){const ie=await Se.json();if(ie!=null&&ie._id){if(ie!=null&&ie._id){oe(`/dashboard/edit-complaint/${ie._id}`,{state:{patientId:de.id}}),g(!1);return}g(!1);return}}else if(Se.status!==404){const ie=await Se.text();throw new Error(`Failed to fetch queue entry: ${ie||Se.statusText} (${Se.status})`)}const fe=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:de.id})});if(!fe.ok){const ie=await fe.text();throw new Error(`Failed to create queue entry: ${ie||fe.statusText} (${fe.status})`)}const we=await fe.json();if(we!=null&&we.id)oe(`/dashboard/edit-complaint/${we.id}`,{state:{patientId:de.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(Se){console.error("Error processing patient selection:",Se),v(Se.message||"An error occurred while processing the selection.")}finally{g(!1)}};return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>oe("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsxs("button",{onClick:()=>oe(-1),className:"patient-search-button patient-search-button-back",children:[i.jsx(Lt,{size:16}),"Back"]})]}),i.jsxs("div",{className:"patient-search-content-box",children:[u&&i.jsx("p",{className:"patient-search-error",children:u}),b&&i.jsx("p",{className:"patient-search-error",children:b}),E&&i.jsx("p",{className:"patient-search-error",children:E})]}),!e&&a.length>0&&i.jsxs("div",{className:"recent-patients-section",children:[i.jsx("div",{className:"recent-patients-grid",children:a.map(de=>i.jsxs("div",{onClick:()=>M(de),className:"recent-patient-card",children:[i.jsxs("div",{className:"recent-patient-info",children:[i.jsx("span",{className:"recent-patient-name",children:de.name}),i.jsxs("span",{className:"recent-patient-details",children:[de.age?`${de.age} yrs`:"",de.age&&de.gender?" / ":"",de.gender||""]})]}),i.jsxs("div",{className:"recent-patient-token",children:["#",de.token]})]},de.id))}),i.jsx("h2",{className:"recent-patients-title",children:"Newly Registered"})]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&!h&&!S&&i.jsx("ul",{className:"patient-search-results-list",children:t.map(de=>i.jsxs("li",{onClick:()=>M(de),className:"patient-search-result-item",children:[i.jsxs("div",{className:"patient-search-result-item-name-container",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["[#",de.token,"]"]}),i.jsx("span",{className:"patient-search-result-item-name",children:de.name})]}),i.jsxs("div",{className:"patient-search-result-item-details",children:[de.age?`${de.age} yrs`:"",de.age&&de.gender?" / ":"",de.gender||"N/A"]})]},de.id))}),e.length>=2&&!l&&t.length===0&&!u&&!h&&i.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),i.jsxs("div",{className:"chat-input-controls",children:[i.jsx("textarea",{ref:I,placeholder:"Search by Name/Phone/Token or Enter New Case: Name, Age, Sex, Complaint...",value:e,onChange:ae,onKeyDown:ce,className:"chat-input",autoFocus:!0,disabled:h||S,rows:1}),i.jsx("button",{onClick:e.trim()?()=>J(e):ne,className:`chat-submit-button ${S||l?"opacity-50":""}`,disabled:S||l||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:S||l?i.jsxs("div",{className:"spinner-dots",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}):e.trim()?i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),F&&i.jsx(Kw,{options:iq,children:i.jsx(kE,{onClose:()=>$(!1),patientData:U,tokenNumber:null,onAiSummaryChange:z})}),ee&&i.jsx(nq,{onClose:()=>te(!1)})]})},aq=()=>{const e=yt(),[n,t]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[r,a]=w.useState(!0),[s,l]=w.useState(!1),[f,u]=w.useState(null),[d,h]=w.useState(null);w.useEffect(()=>{(async()=>{a(!0),u(null);try{const S=await ge("/api/clinics/settings");if(!S.ok){const E=await S.json();throw new Error(E.message||"Failed to fetch clinic settings.")}const k=await S.json();t({admissionCharge:parseFloat(k.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(k.perDayCharge||0).toFixed(2),otherCharges:parseFloat(k.otherCharges||0).toFixed(2),aiMemory:k.aiMemory||"",clinicWideSystemPrompt:k.clinicWideSystemPrompt||"",gemini_api_key:k.gemini_api_key||"",low_stock_threshold:k.low_stock_threshold!==void 0&&k.low_stock_threshold!==null?String(k.low_stock_threshold):"10",aiLanguage:k.aiLanguage||"",name:k.name||"",logoUrl:k.logoUrl||"",upi_id:k.upi_id||"",address:k.address||"",notes:k.notes||""})}catch(S){console.error("Error fetching settings:",S),u(`Failed to load settings: ${S.message}`),t({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"Unknown Clinic",logoUrl:"",upi_id:"",address:"",notes:""})}finally{a(!1)}})()},[]);const g=v=>{const{name:S,value:k}=v.target;t(E=>({...E,[S]:k}))},b=async v=>{v.preventDefault(),u(null),h(null),l(!0);const S=parseFloat(n.admissionCharge),k=parseFloat(n.perDayCharge),E=parseFloat(n.otherCharges),T=parseInt(n.low_stock_threshold);if(isNaN(S)||S<0||isNaN(k)||k<0||isNaN(E)||E<0){u("Invalid charge amount. Please enter non-negative numbers for all fields."),l(!1);return}if(isNaN(T)||T<0){u("Invalid low stock threshold. Please enter a non-negative number."),l(!1);return}try{const I=await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:n.name,admissionCharge:S,perDayCharge:k,otherCharges:E,aiMemory:n.aiMemory,clinicWideSystemPrompt:n.clinicWideSystemPrompt,gemini_api_key:n.gemini_api_key,low_stock_threshold:T,aiLanguage:n.aiLanguage,logoUrl:n.logoUrl,upi_id:n.upi_id,address:n.address,notes:n.notes})});if(!I.ok){const q=await I.json();throw new Error(q.message||"Failed to update settings.")}const D=await I.json();t({admissionCharge:parseFloat(D.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(D.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(D.settings.otherCharges).toFixed(2),aiMemory:D.settings.aiMemory||"",clinicWideSystemPrompt:D.settings.clinicWideSystemPrompt||"",gemini_api_key:D.settings.gemini_api_key||"",low_stock_threshold:D.settings.low_stock_threshold!==void 0&&D.settings.low_stock_threshold!==null?String(D.settings.low_stock_threshold):"10",aiLanguage:D.settings.aiLanguage||"",name:D.settings.name||"",logoUrl:D.settings.logoUrl||"",upi_id:D.settings.upi_id||"",address:D.settings.address||"",notes:D.settings.notes||""}),h("Clinic settings updated successfully!"),setTimeout(()=>h(null),3e3)}catch(I){console.error("Error updating settings:",I),u(`Update failed: ${I.message}`)}finally{l(!1)}};return r?i.jsxs("div",{className:"loading-animation-container",children:[i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"loading-text",children:"Loading settings..."})]}):i.jsxs("div",{className:"clinic-settings-container",children:[i.jsxs("div",{className:"clinic-settings-header-container",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",children:i.jsx(Lt,{size:24})}),i.jsxs("h3",{className:"clinic-settings-header",children:[i.jsx(vg,{size:24}),"Clinic Settings"]})]}),f&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-error",role:"alert",children:f}),d&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-success",role:"alert",children:d}),i.jsxs("form",{onSubmit:b,className:"clinic-settings-form",children:[i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"name",className:"clinic-settings-label",children:"Clinic Name"}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:g,className:"clinic-settings-input",disabled:s,placeholder:"e.g., My Awesome Clinic"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"admissionCharge",className:"clinic-settings-label",children:[i.jsx($d,{size:16})," Admission Charge ()"]}),i.jsx("input",{type:"number",id:"admissionCharge",name:"admissionCharge",value:n.admissionCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:s,placeholder:"e.g., 500.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"perDayCharge",className:"clinic-settings-label",children:[i.jsx($d,{size:16})," Per Day Charge ()"]}),i.jsx("input",{type:"number",id:"perDayCharge",name:"perDayCharge",value:n.perDayCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:s,placeholder:"e.g., 1000.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"otherCharges",className:"clinic-settings-label",children:[i.jsx($d,{size:16})," Other Charges (Default/Misc.) ()"]}),i.jsx("input",{type:"number",id:"otherCharges",name:"otherCharges",value:n.otherCharges,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:s,placeholder:"e.g., 50.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"low_stock_threshold",className:"clinic-settings-label",children:[i.jsx($I,{size:16})," Low Stock Notification Threshold"]}),i.jsx("input",{type:"number",id:"low_stock_threshold",name:"low_stock_threshold",value:n.low_stock_threshold,onChange:g,className:"clinic-settings-input",min:"0",required:!0,disabled:s,placeholder:"e.g., 10"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Set the minimum quantity of a drug to trigger a low stock notification."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"aiMemory",className:"clinic-settings-label",children:[i.jsx(m1,{size:16})," AI Memory (Plain Text)"]}),i.jsx("textarea",{id:"aiMemory",name:"aiMemory",value:n.aiMemory,onChange:g,className:"clinic-settings-textarea",disabled:s,placeholder:"Enter any clinic-wide notes or context for the AI..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter clinic-wide AI memory data as plain text."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"clinicWideSystemPrompt",className:"clinic-settings-label",children:[i.jsx(IM,{size:16})," Clinic-Wide AI System Prompt"]}),i.jsx("textarea",{id:"clinicWideSystemPrompt",name:"clinicWideSystemPrompt",value:n.clinicWideSystemPrompt,onChange:g,className:"clinic-settings-textarea",disabled:s,placeholder:"Enter the system prompt for the AI that will apply to all interactions within this clinic..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"This prompt will be used as the base instruction for the AI across the clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"aiLanguage",className:"clinic-settings-label",children:"AI Language"}),i.jsxs("select",{id:"aiLanguage",name:"aiLanguage",value:n.aiLanguage,onChange:g,className:"clinic-settings-input",disabled:s,children:[i.jsx("option",{value:"",children:"Select Language"}),i.jsx("option",{value:"English",children:"English"}),i.jsx("option",{value:"Hindi",children:"Hindi"}),i.jsx("option",{value:"Telugu",children:"Telugu"}),i.jsx("option",{value:"Tamil",children:"Tamil"}),i.jsx("option",{value:"Kannada",children:"Kannada"}),i.jsx("option",{value:"Malayalam",children:"Malayalam"}),i.jsx("option",{value:"Bengali",children:"Bengali"}),i.jsx("option",{value:"Gujarati",children:"Gujarati"}),i.jsx("option",{value:"Marathi",children:"Marathi"}),i.jsx("option",{value:"Punjabi",children:"Punjabi"})]}),i.jsx("p",{className:"clinic-settings-help-text",children:"Specify the language for AI interactions."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"logoUrl",className:"clinic-settings-label",children:"Clinic Logo URL"}),i.jsx("input",{type:"url",id:"logoUrl",name:"logoUrl",value:n.logoUrl,onChange:g,className:"clinic-settings-input",disabled:s,placeholder:"e.g., https://example.com/logo.png"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the URL for your clinic's logo."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"upi_id",className:"clinic-settings-label",children:"UPI ID"}),i.jsx("input",{type:"text",id:"upi_id",name:"upi_id",value:n.upi_id,onChange:g,className:"clinic-settings-input",disabled:s,placeholder:"e.g., yourclinic@upi"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your clinic's UPI ID for payments."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"address",className:"clinic-settings-label",children:"Clinic Address"}),i.jsx("textarea",{id:"address",name:"address",value:n.address,onChange:g,className:"clinic-settings-textarea",disabled:s,placeholder:"Enter your clinic's full address"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the physical address of your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"notes",className:"clinic-settings-label",children:"Other Clinic Details/Notes"}),i.jsx("textarea",{id:"notes",name:"notes",value:n.notes,onChange:g,className:"clinic-settings-textarea",disabled:s,placeholder:"Enter any other relevant clinic details or notes"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Add any additional information or notes about your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"gemini_api_key",className:"clinic-settings-label",children:[i.jsx(m1,{size:16})," Gemini API Key"]}),i.jsx("input",{type:"text",id:"gemini_api_key",name:"gemini_api_key",value:n.gemini_api_key,onChange:g,className:"clinic-settings-input",disabled:s,placeholder:"Enter your Gemini API key"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your Gemini API key to enable AI features."})]}),i.jsx("div",{className:"clinic-settings-button-container",children:i.jsxs("button",{type:"submit",className:"clinic-settings-button",disabled:s,children:[i.jsx(qd,{size:18})," ",s?"Saving...":"Save Settings"]})})]})]})},sq=({})=>{const e=yt(),[n,t]=w.useState("patientSearch"),[r]=w.useState(!1),[a,s]=w.useState(null),[l,f]=w.useState(null);return w.useEffect(()=>{if(l){const u=setTimeout(()=>f(null),5e3);return()=>clearTimeout(u)}},[l]),r?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",l&&i.jsxs("div",{className:`alert-box ${l.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:l.type==="success"?i.jsx(Ba,{size:18}):i.jsx(rr,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:l.message})}),i.jsx("button",{onClick:()=>f(null),className:"alert-box-close",children:i.jsx(Kn,{size:16})})]}),a&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(rr,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:a})}),i.jsx("button",{onClick:()=>s(null),className:"alert-box-close",children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[i.jsx(E2,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/staff"),className:"admin-nav-button",children:[i.jsx(Fh,{})," Staff"]}),i.jsx("button",{onClick:()=>t("moneyFlow"),className:`admin-nav-button ${n==="moneyFlow"?"active":""}`,children:"Money"}),i.jsx("button",{onClick:()=>t("inventory"),className:`admin-nav-button ${n==="inventory"?"active":""}`,children:"Inventory"}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>t("clinicSettings"),className:`admin-nav-button ${n==="clinicSettings"?"active":""}`,children:[i.jsx(vg,{})," Settings"]}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(j2,{})," Patient Subscriptions"]}),i.jsxs("button",{onClick:()=>e("/dashboard/add-pharmacy-order"),className:"admin-nav-button",children:[i.jsx(Ll,{})," Order Meds"]}),i.jsx("button",{onClick:()=>e("/dashboard/recurring-medications"),className:"admin-nav-button",children:"Daily Meds"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(C2,{})," Order Tests"]}),i.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-nav-button",children:[i.jsx(Fh,{})," All Patients"]})]}),i.jsxs("div",{className:"space-y-6",children:[" ",n==="patientSearch"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(Ph,{})}),n==="moneyFlow"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(f4,{})}),n==="inventory"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(x1,{})}),n==="clinicSettings"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(aq,{})})]})]})},Vc=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},oq=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},Nh=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:s,noDataText:l})=>{const f=w.useMemo(()=>{const u={};t.forEach(h=>{if(isNaN(h.date.getTime())){u["Unknown Date"]||(u["Unknown Date"]=[]),u["Unknown Date"].push(h);return}const g=oq(h.originalDateString);u[g]||(u[g]=[]),u[g].push(h)});const d=Object.keys(u);return d.sort((h,g)=>{if(h==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const E=k.split(" ");if(E.length===3){const I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(E[1]);if(I!==-1)return new Date(parseInt(E[2]),I,parseInt(E[0]))}return new Date(k)},v=b(h),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(h)}),d.map(h=>({date:h,items:u[h]}))},[t]);return i.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded-md border border-gray-200",children:[i.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 border-b border-gray-300 pb-1 flex items-center",children:[" ",n&&i.jsx(n,{size:14,className:"mr-1.5 text-indigo-600"})," ",e]}),a&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:s}),!a&&t.length===0&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:l}),!a&&t.length>0&&i.jsxs("div",{className:"space-y-2",children:[" ",f.map(({date:u,items:d})=>i.jsxs("div",{className:"pl-0.5",children:[" ",i.jsxs("h5",{className:"text-[11px] font-medium text-indigo-700 mb-1 bg-indigo-50 px-1 py-0.5 rounded-sm inline-block",children:[" ",u]}),i.jsx("div",{className:"space-y-1 pl-1.5 border-l-2 border-indigo-200 ml-0.5",children:d.map((h,g)=>i.jsxs("div",{className:"text-xs py-0 flex items-start",children:[" ",i.jsx("div",{className:"flex-grow mr-1",children:r(h)})," "]},`${h.type}-${h.originalDateString}-${g}`))})]},u))]})]})},Pv=()=>{var oe,K;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,s]=w.useState(null),[l,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[E,T]=w.useState(null),{patientId:I}=Ti(),D=yt(),q=w.useCallback(async V=>{g(null),f(null),d(null),k(!0),T(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const J=await ge(`/api/patients/${V}`);if(!J.ok)throw new Error(`Patient details fetch failed (${J.status})`);const ne=await J.json();f(ne);const A=await ge(`/api/queue/patient/${V}/latest`);if(!A.ok&&A.status!==404)throw new Error(`Queue entry fetch failed (${A.status})`);if(A.ok){const ae=await A.json();d(ae)}await F(V)}catch(J){console.error("Error fetching specific patient data:",J),g(J.message||"Failed to load patient data."),T(J.message||"Failed to load patient history.")}finally{k(!1)}},[]),F=w.useCallback(async V=>{k(!0),T(null);try{const[J,ne,A,ae]=await Promise.all([ge(`/api/queue/patient/${V}/complaints`),ge(`/api/lab/patient/${V}`),ge(`/api/lab/orders/patient/${V}?status=pending`),ge(`/api/pharmacy-orders/patient/${V}`)]),ce=J.ok?await J.json():[],M=ne.ok?await ne.json():[],de=A.ok?await A.json():[],Se=ae.ok?await ae.json():[];v({pastComplaints:ce||[],labReports:M||[],pendingLabOrders:de||[],pharmacyOrders:Se||[]})}catch(J){console.error("Error fetching patient history:",J),T(J.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),$=w.useCallback(async()=>{r(!0),s(null);try{const V=await ge("/api/queue/doctor");if(!V.ok){const ne=await V.text();throw new Error(`API Error (${V.status}): ${ne||V.statusText}`)}const J=await V.json();if(J===null||typeof J!="object"||typeof J.waitingCount!="number")throw console.error("Invalid queue data format:",J),new Error("Invalid queue data format received");n({currentPatient:J.currentPatient||null,nextPatient:J.nextPatient||null,waitingCount:J.waitingCount})}catch(V){console.error("Error fetching queue data:",V),s(V.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let V=null;return I?(q(I),n({currentPatient:null,nextPatient:null,waitingCount:0})):($(),V=setInterval($,1e4),f(null),d(null)),()=>{V&&clearInterval(V)}},[I,q,$]),w.useEffect(()=>{var V;!I&&((V=e.currentPatient)!=null&&V.patientId)?F(e.currentPatient.patientId):!I&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),T(null))},[I,(oe=e.currentPatient)==null?void 0:oe.patientId,F]);const B=((K=e.currentPatient)==null?void 0:K.patientId)||(I?parseInt(I,10):null),z=w.useMemo(()=>{if(!B||!b.pastComplaints)return[];const V=b.pastComplaints.map(J=>({date:new Date(J.createdAt),type:"Complaint",data:J,originalDateString:J.createdAt})).filter(J=>!isNaN(J.date.getTime()));return V.sort((J,ne)=>ne.date.getTime()-J.date.getTime()),V},[B,b.pastComplaints]),U=w.useMemo(()=>{if(!B)return[];const V=[];return(b.pendingLabOrders??[]).forEach(J=>{const ne=new Date(J.createdAt);isNaN(ne.getTime())||V.push({date:ne,type:"Lab Order (Pending)",data:J,originalDateString:J.createdAt})}),(b.labReports??[]).forEach(J=>{const ne=J.reportCreatedAt?new Date(J.reportCreatedAt):null;ne&&!isNaN(ne.getTime())&&V.push({date:ne,type:"Lab Report",data:J,originalDateString:J.reportCreatedAt})}),V.sort((J,ne)=>ne.date.getTime()-J.date.getTime()),V},[B,b.pendingLabOrders,b.labReports]),L=w.useMemo(()=>{if(!B||!b.pharmacyOrders)return[];const V=b.pharmacyOrders.map(J=>({date:new Date(J.date),type:"Pharmacy Order",data:J,originalDateString:J.date})).filter(J=>!isNaN(J.date.getTime()));return V.sort((J,ne)=>ne.date.getTime()-J.date.getTime()),V},[B,b.pharmacyOrders]),R=async()=>{r(!0),s(null);try{await ge("/api/queue/doctor/next",{method:"POST"}),await $()}catch(V){console.error("Error calling next patient:",V),s(V.message||"Failed to call next patient.")}finally{r(!1)}},G=async()=>{if(!(!e.currentPatient||I)){r(!0),s(null);try{await ge(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await $(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),T(null)}catch(V){console.error("Error completing consultation:",V),s(V.message||"Failed to complete consultation.")}finally{r(!1)}}},ee=V=>{switch(V){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return V}};let te=null;return e.currentPatient&&(te=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-teal-500",children:[i.jsx("h2",{className:"text-xl text-teal-700 font-semibold mb-3",children:"NOW SEEING:"}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:"flex-grow md:w-1/2",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-1",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600",children:[i.jsx("span",{className:"font-bold",children:e.currentPatient.age})," | ",i.jsx("span",{className:"font-bold",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0",children:[i.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-700 mb-1",children:e.currentPatient.token}),i.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:ee(e.currentPatient.status)})]})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex justify-end space-x-3 border-t pt-4",children:[i.jsx("button",{onClick:()=>{var J;const V=(J=e.currentPatient)==null?void 0:J._id;V&&D(`/dashboard/edit-complaint/${V}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Edit Complaint / AI"}),i.jsx("button",{onClick:G,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success disabled:opacity-50 disabled:cursor-not-allowed",children:"Complete Consultation"})]})]})," ",i.jsxs("div",{className:"complaint-section md:w-1/2 mt-4 md:mt-0 border-t md:border-t-0 md:border-l md:pl-6 pt-4 md:pt-0",children:[i.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-2",children:"Context & History:"}),E&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:E}),i.jsxs("div",{className:"space-y-2 pr-2",children:[i.jsx(Nh,{title:"Complaints History",icon:us,items:z,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:V=>i.jsxs("span",{className:"block text-xs",children:[V.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(V.originalDateString),")"]})]})}),i.jsx(Nh,{title:"Lab History (Orders & Reports)",icon:fb,items:U,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:V=>V.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(tN,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",V.data.tests.map(J=>J.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",V.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(V.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(nN,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",V.data.testName," - ",V.data.reportFindings.substring(0,50),V.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(V.originalDateString),")"]})]})]})}),i.jsx(Nh,{title:"Pharmacy Order History",icon:Ud,items:L,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:V=>i.jsxs("span",{className:"block text-xs",children:[V.data.medications.map(J=>`${J.name} (Qty: ${J.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",V.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(V.originalDateString),")"]})]})}),z.length===0&&U.length===0&&L.length===0&&!S&&i.jsx("p",{className:"text-gray-500 italic text-xs mt-2 px-1",children:"No history found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>D(-1),className:"back-button mr-4",children:i.jsx(Lt,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),I?i.jsxs(i.Fragment,{children:[h&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:h}),l&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-purple-500",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold",children:"Patient Record:"}),i.jsx("button",{onClick:()=>D("/dashboard/doctor"),className:"text-sm text-blue-600 hover:underline",children:"Back to Queue"})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-1 md:mb-2",children:l.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600 mb-3 md:mb-4",children:["Age: ",l.age??"N/A"," | ",l.gender??"N/A"]}),i.jsxs("div",{className:"mt-3 md:mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[i.jsx("label",{className:"font-medium block mb-1 text-sm text-gray-600",children:"Latest Queue Entry:"}),u?i.jsxs("div",{className:"space-y-2",children:[" ",i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words",children:[i.jsxs("span",{className:"font-medium text-gray-700",children:["(",u.age," / ",u.gender,")"]}),": ",u.complaint||i.jsx("span",{className:"text-gray-400 italic",children:"No complaint"}),i.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${u.status==="consulting"?"bg-teal-100 text-teal-800":u.status==="seen"?"bg-green-100 text-green-800":u.status==="waiting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:ee(u.status)})]}),u.status==="consulting"&&u._id&&i.jsx("button",{onClick:()=>D(`/dashboard/edit-complaint/${u._id}`),className:"ml-4 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded flex-shrink-0",children:"Edit"})]}),u.case_summary&&i.jsxs("p",{className:"text-xs text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",u.case_summary]})]}):i.jsx("p",{className:"text-gray-500 italic text-sm",children:"No queue entry found for this patient today."})]}),i.jsxs("div",{className:"mt-4 border-t pt-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Patient History:"}),E&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:E}),i.jsx(Nh,{title:"Complaints History",icon:us,items:z,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:V=>i.jsxs("span",{className:"block text-xs",children:[" ",V.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(V.originalDateString),")"]})]})}),i.jsx(Nh,{title:"Lab History (Orders & Reports)",icon:fb,items:U,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:V=>V.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(tN,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",V.data.tests.map(J=>J.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",V.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(V.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(nN,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",V.data.testName," - ",V.data.reportFindings.substring(0,50),V.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(V.originalDateString),")"]})]})]})}),i.jsx(Nh,{title:"Pharmacy Order History",icon:Ud,items:L,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:V=>i.jsxs("span",{className:"block text-xs",children:[" ",V.data.medications.map(J=>`${J.name} (Qty: ${J.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",V.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(V.originalDateString),")"]})]})}),z.length===0&&U.length===0&&L.length===0&&!S&&i.jsx("p",{className:"text-gray-500 italic text-sm mt-2",children:"No history found."})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>D("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx(I2,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>D("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:te||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:ee(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:R,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},EE=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,s]=w.useState(null),[l,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[E,T]=w.useState(null),I=yt(),D=w.useCallback(tE.debounce(async L=>{if(L.trim().length<2){r([]),k(!1);return}k(!0),T(null);try{const R=new URLSearchParams({search:encodeURIComponent(L),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),G=await ge(`/api/patients?${R.toString()}`);if(!G.ok){const te=await G.text();throw new Error(`API Error (${G.status}): ${te||G.statusText||"Failed to fetch patients"}`)}const ee=await G.json();r(ee.patients)}catch(R){T(R instanceof Error?R.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),D(e)):(r([]),D.cancel()),()=>{D.cancel()}),[e,D]);const q=L=>{s(L),n(""),r([]),T(null),f(null),d(null),g(null),v(!1)},F=async()=>{if(!a){T("No patient selected.");return}T(null),k(!0);try{const L=await ge(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!L.ok){const G=await L.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(G.message||"Failed to admit patient")}const R=await L.json();alert(R.message||"Patient admitted successfully!"),R.bill&&R.bill.id?I(`/patient/${a.id}/admission-bill/${R.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),T("Admission successful, but couldn't navigate to billing."),s(R.patient))}catch(L){T(L instanceof Error?L.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){f(null),g(null);return}v(!0),d(null),f(null),g(null);try{const R=await ge(`/api/patients/${a.id}/active-bill?type=admission`);if(!R.ok)throw R.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const G=await R.json(),ee=G==null?void 0:G.id;if(!ee)throw new Error("Active admission bill ID not found in response.");f(ee);const te=await ge(`/api/bills/${ee}`);if(!te.ok)throw new Error(`Failed to fetch bill details (ID: ${ee}). Status: ${te.status}`);const oe=await te.json();if(oe&&oe.calculated)g(oe.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",oe),new Error("Fetched bill details are incomplete (missing calculated data).")}catch(R){d(R instanceof Error?R.message:"An unknown error occurred while fetching bill details."),f(null),g(null)}finally{v(!1)}})()},[a]);const $=async()=>{if(!a){T("No patient selected.");return}if(!a.admission_date||a.discharge_date){T("Patient is not currently admitted.");return}T(null),k(!0);try{const L=await ge(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!L.ok){const G=await L.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(G.message||"Failed to discharge patient")}const R=await L.json();alert(R.message||"Patient discharged successfully!"),R.patient?s(R.patient):(console.error("Discharge successful, but updated patient info missing in response."),s(null),T("Discharge successful, but couldn't update patient details locally."))}catch(L){T(L instanceof Error?L.message:"Failed to discharge patient")}finally{k(!1)}},B=()=>{if(!a||!l){T("Cannot navigate to billing: Patient or Bill ID missing.");return}I(`/patient/${a.id}/admission-bill/${l}`)};let z="",U=null;if(a){const L=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,R=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(z=`Patient admitted on: ${L}`,U=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",u&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:u})," ",!b&&h&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(h.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(h.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(h.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:B,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!u?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:$,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(z=`Patient admitted on ${L} and discharged on ${R}.`,U=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(z="Patient is not admitted.",U=i.jsx("button",{onClick:F,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>I(-1),className:"back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:L=>n(L.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(L=>i.jsxs("li",{onClick:()=>q(L),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",L.name," (Token: ",L.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[L.admission_date?`Admitted: ${new Date(L.admission_date).toLocaleDateString()}`:"Not Admitted",L.discharge_date?`, Discharged: ${new Date(L.discharge_date).toLocaleDateString()}`:""]})]},L.id))]}),t.length===0&&e&&!S&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>s(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:z})," ",E&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:E})," ",U]})]})},Dv=15,q1=()=>{const e=yt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[s,l]=w.useState(null),[f,u]=w.useState(""),[d,h]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,E]=w.useState("created_at"),[T,I]=w.useState("desc"),[D,q]=w.useState(""),[F,$]=w.useState(!1),[B,z]=w.useState(null),[U,L]=w.useState([]),[R,G]=w.useState(""),[ee,te]=w.useState(!1),[oe,K]=w.useState(null),[V,J]=w.useState(null),[ne,A]=w.useState(!0),[ae,ce]=w.useState(null),[M,de]=w.useState(f);w.useEffect(()=>{const xe=setTimeout(()=>{de(f),h(1)},500);return()=>{clearTimeout(xe)}},[f]);const Se=w.useCallback(async()=>{A(!0),ce(null);try{const xe=await ge("/api/subscriptions");if(!xe.ok){let ve=`Failed to fetch subscription plans (${xe.status})`;try{ve=(await xe.json()).message||ve}catch{}throw new Error(ve)}const Me=await xe.json();L(Me)}catch(xe){console.error("Error fetching subscription plans:",xe),ce(xe.message||"An unknown error occurred while fetching plans."),L([])}finally{A(!1)}},[]),fe=w.useCallback(async(xe,Me,ve,Ee,Pe)=>{a(!0),l(null);try{const rt=new URLSearchParams({page:xe.toString(),limit:Dv.toString(),sortBy:ve,sortOrder:Ee});Me&&rt.append("search",Me),Pe&&rt.append("gender",Pe);const lt=await ge(`/api/patients?${rt.toString()}`);if(!lt.ok){const Rt=await lt.json();throw new Error(Rt.message||"Failed to fetch patients")}const Ze=await lt.json();t(Ze.patients),S(Ze.totalCount),h(Ze.currentPage),b(Ze.totalPages)}catch(rt){console.error("Error fetching patients:",rt),l(`Failed to load patients: ${rt.message}`),t([]),S(0),h(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{fe(d,M,k,T,D),Se()},[d,M,k,T,D,fe,Se]);const we=xe=>{const Me=k===xe&&T==="asc"?"desc":"asc";E(xe),I(Me),h(1)},ie=xe=>{try{return new Date(xe).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},_e=()=>{$(!1),z(null),G(""),K(null),te(!1)},Ve=async(xe,Me)=>{t(ve=>ve.map(Ee=>Ee.id===xe?{...Ee,insurance_type:Me}:Ee));try{const ve=await ge(`/api/patients/${xe}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Me})});if(!ve.ok){const Ee=await ve.json();throw new Error(Ee.message||"Failed to update insurance type")}}catch(ve){console.error("Error updating insurance type:",ve),fe(d,M,k,T,D)}},tt=(xe,Me)=>{const ve=new Date(xe),Ee=Me.interval||1;switch(Me.period){case"daily":ve.setDate(xe.getDate()+Ee);break;case"weekly":ve.setDate(xe.getDate()+Ee*7);break;case"monthly":ve.setMonth(xe.getMonth()+Ee);break;case"yearly":ve.setFullYear(xe.getFullYear()+Ee);break;default:console.warn(`Unknown subscription period: ${Me.period}. Defaulting to 1 month.`),ve.setMonth(xe.getMonth()+1)}return ve},Ke=async()=>{if(!B||!R){K("Please select a subscription plan.");return}const xe=U.find(Me=>Me.id===R);if(!xe){K("Selected plan details not found.");return}te(!0),K(null);try{const Me=new Date,ve=tt(Me,xe),Ee={subscription_plan_id:R,subscription_status:"active",subscription_start_date:Me.toISOString(),subscription_end_date:ve.toISOString(),subscription_payment_method:"manual"},Pe=await ge(`/api/patients/${B.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)});if(!Pe.ok){const rt=await Pe.json();throw new Error(rt.message||"Failed to update patient subscription")}_e(),fe(d,M,k,T,D)}catch(Me){console.error("Error starting subscription:",Me),K(`Failed to start subscription: ${Me.message}`)}finally{te(!1)}},Oe=async xe=>{if(!V){J(xe.id);try{const Me=await ge(`/api/queue/patient/${xe.id}/latest`);if(Me.ok){const Pe=await Me.json();if(Pe!=null&&Pe._id){e(`/dashboard/edit-complaint/${Pe._id}`,{state:{patientId:xe.id}});return}}else if(Me.status!==404){const Pe=await Me.text();throw new Error(`Failed to fetch queue entry: ${Pe||Me.statusText}`)}const ve=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:xe.id})});if(!ve.ok){const Pe=await ve.text();throw new Error(`Failed to create queue entry: ${Pe||ve.statusText}`)}const Ee=await ve.json();if(Ee!=null&&Ee.id)e(`/dashboard/edit-complaint/${Ee.id}`,{state:{patientId:xe.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(Me){console.error("Error processing patient selection:",Me),alert(Me.message||"An error occurred while processing the selection.")}finally{J(null)}}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(Vs,{size:28}),"All Registered Patients"]}),s&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:s})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:ne?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):ae?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",ae]}):U.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:U.map(xe=>i.jsxs("li",{children:[i.jsx("strong",{children:xe.name}),": ",xe.price," / ",xe.interval," ",xe.period,xe.interval>1?"s":"",xe.description&&i.jsx("span",{className:"plan-description",children:xe.description})]},xe.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:f,onChange:xe=>u(xe.target.value)}),i.jsx(jr,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(k2,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:D,onChange:xe=>q(xe.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:M?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>we("name"),children:["Name",k==="name"&&(T==="asc"?i.jsx(Pl,{size:14,className:"sort-icon"}):i.jsx(Yc,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>we("created_at"),children:["Registered On",k==="created_at"&&(T==="asc"?i.jsx(Pl,{size:14,className:"sort-icon"}):i.jsx(Yc,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(xe=>i.jsxs("tr",{onClick:()=>Oe(xe),className:`patient-row ${V===xe.id?"navigating":""}`,style:{cursor:"pointer",opacity:V===xe.id?.7:1},children:[i.jsx("td",{children:xe.token??"-"}),i.jsx("td",{className:"patient-name",children:xe.name}),i.jsx("td",{children:xe.age??"-"}),i.jsx("td",{children:xe.gender??"-"}),i.jsx("td",{children:xe.phone??"-"}),i.jsx("td",{children:xe.address??"-"}),i.jsx("td",{children:ie(xe.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${xe.subscription_status==="active"?"active":xe.subscription_status==="cancelled"||xe.subscription_status==="expired"?"inactive":"none"}`,children:xe.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:xe.insurance_type,onChange:Me=>Ve(xe.id,Me.target.value),onClick:Me=>Me.stopPropagation(),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:Me=>{Me.stopPropagation(),e(`/start-subscription/${xe.id}`)},className:"action-button",children:"Start Sub"})})]},xe.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(d-1)*Dv+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(d*Dv,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>h(xe=>Math.max(xe-1,1)),disabled:d===1||r,className:"pagination-button",children:[i.jsx(Bb,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:d})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>h(xe=>Math.min(xe+1,g)),disabled:d===g||r,className:"pagination-button",children:["Next",i.jsx(bg,{size:16,className:"next-icon"})]})]})]})]}),F&&B&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",B.name]}),i.jsx("button",{onClick:_e,className:"subscription-modal-close-button",children:i.jsx(Kn,{size:24})})]}),oe&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:oe})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:R,onChange:xe=>G(xe.target.value),className:"form-select",disabled:ee||ne||ae!==null||U.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),ne?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):ae?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):U.length>0?U.map(xe=>i.jsxs("option",{value:xe.id,children:[xe.name," - ",xe.price," (",xe.interval," ",xe.period,xe.interval>1?"s":"",")"]},xe.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),ae&&i.jsx("p",{className:"error-message",children:ae}),U.length===0&&!ne&&!ae&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:_e,disabled:ee,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:Ke,disabled:!R||ee,className:"subscription-modal-button submit",children:ee?"Starting...":"Start Subscription"})]})]})})]})},TE=()=>{const e=yt(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,s]=w.useState([]),[l,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>qb(async T=>{if(T.trim().length<2){s([]),f(!1),d(null);return}f(!0),d(null);try{const I=new URLSearchParams({search:encodeURIComponent(T),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),D=await ge(`/api/patients?${I.toString()}`);if(!D.ok){const F=await D.text();throw new Error(`API Error (${D.status}): ${F||D.statusText}`)}const q=await D.json();s(q.patients)}catch(I){console.error("Error searching patients:",I),d(I.message||"Failed to search patients."),s([])}finally{f(!1)}},300),[]),S=T=>{const I=T.target.value;r(I),g(b.test(I)),f(!0),v(I)},k=w.useCallback(T=>{e("/billing",{state:{patientId:T.id,patientName:T.name}})},[e]),E=w.useCallback(async()=>{if(!t||!h){d("Invalid phone number to create a new patient.");return}f(!0),d(null);try{const I=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!I.ok){const q=await I.json();throw new Error(q.message||`Failed to create patient: ${I.statusText}`)}const D=await I.json();alert(`New patient "direct pharmacy" created with phone ${D.phone}.`),k(D)}catch(T){console.error("Error creating new patient:",T),d(T.message||"Failed to create new patient.")}finally{f(!1)}},[t,h,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(Lt,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),u&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:u}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(T=>i.jsxs("li",{onClick:()=>k({id:T.id,name:T.name,token:T.token,age:T.age,gender:T.gender,phone:T.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",T.token]}),T.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[T.age?`${T.age} yrs`:"Age N/A",T.gender?` / ${T.gender}`:" / Gender N/A",T.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",T.phone]})]})]}),T.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",T.phone]})]},T.id))})}),t.length>=2&&!l&&a.length===0&&!u&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),h&&i.jsx("button",{type:"button",onClick:E,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},AE=({currentUser:e})=>{const n=yt(),[t,r]=w.useState("select_patient"),[a,s]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,f]=w.useState(null),[u,d]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[E,T]=w.useState(""),[I,D]=w.useState([]),[q,F]=w.useState(!1),[$,B]=w.useState(null),[z,U]=w.useState(null),[L,R]=w.useState(null),[G,ee]=w.useState(!1),[te,oe]=w.useState(!1),[K,V]=w.useState(!1),J=/^\+?[0-9\s\-().]{7,20}$/,ne=/^[a-zA-Z\s'-]{2,}$/,A=w.useCallback(async()=>{if(!(u.length>0)){ee(!0),R(null);try{const Oe=await ge("/api/lab-tests");if(!Oe.ok)throw new Error("Failed to fetch lab tests");const xe=await Oe.json();d(xe)}catch(Oe){console.error("Failed to fetch available lab tests:",Oe),R("Could not load lab test list: "+Oe.message),d([])}finally{ee(!1)}}},[u.length]);w.useEffect(()=>{if(!b){k([]);return}const Oe=b.toLowerCase();k(u.filter(xe=>xe.name.toLowerCase().includes(Oe)||xe.description&&xe.description.toLowerCase().includes(Oe)).slice(0,10))},[b,u]);const ae=w.useCallback(Oe=>{const xe={id:Oe.id,name:Oe.name,token:Oe.token,age:Oe.age,gender:Oe.gender,phone:Oe.phone};f(xe),r("create_order"),g([]),v(""),k([]),R(null),A()},[A]),ce=w.useMemo(()=>qb(async Oe=>{if(Oe.trim().length<2){D([]),F(!1),B(null);return}F(!0),B(null);try{const xe=new URLSearchParams({search:encodeURIComponent(Oe),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Me=await ge(`/api/patients?${xe.toString()}`);if(!Me.ok){const Ee=await Me.text();throw new Error(`API Error (${Me.status}): ${Ee||Me.statusText}`)}const ve=await Me.json();D(ve.patients)}catch(xe){console.error("Error searching lab patients:",xe),B(xe.message||"Failed to search lab patients."),D([])}finally{F(!1)}},300),[J,ne]),M=Oe=>{const xe=Oe.target.value;T(xe),oe(J.test(xe)),V(ne.test(xe)&&!J.test(xe)),F(!0),ce(xe)},de=w.useCallback(async Oe=>{if(!E||Oe==="phone"&&!te||Oe==="name"&&!K){B(`Invalid ${Oe} to create a new patient.`);return}F(!0),B(null);try{const ve=await(await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Oe==="name"?E:"direct lab",phone:Oe==="phone"?E:null,age:null,gender:null,token:null})})).json();alert(`New patient "${ve.name}" created with ${Oe==="phone"?`phone ${ve.phone}`:`name ${ve.name}`}.`),ae({id:ve.id,name:ve.name,token:ve.token??null,age:ve.age??null,gender:ve.gender??null,phone:ve.phone})}catch(xe){console.error("Error creating new patient:",xe);const Me=xe.message||"";if(Me.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:Me}});return}B(Me||"Failed to create new patient.")}finally{F(!1)}},[E,te,K,ae]),Se=()=>{s({name:"",age:void 0,gender:null,phone:"",address:""}),U(null),r("create_patient"),f(null)},fe=()=>{r("select_patient"),f(null),T(""),D([]),B(null)},we=Oe=>{const{name:xe,value:Me}=Oe.target;s(ve=>({...ve,[xe]:xe==="age"?Me?parseInt(Me,10):void 0:Me}))},ie=async Oe=>{if(Oe.preventDefault(),U(null),!a.name){U("Patient Name is required.");return}const xe={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const ve=await(await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)})).json();ae({id:ve.id,name:ve.name,token:ve.token??null,age:ve.age??null,gender:ve.gender??null,phone:ve.phone})}catch(Me){console.error("Failed to create patient:",Me);const ve=Me.message||"";if(ve.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:ve}});return}U(ve||"Failed to create patient. Please try again.")}},_e=Oe=>{if(h.some(xe=>xe.id===Oe.id)){R(`${Oe.name} is already in the order.`),setTimeout(()=>R(null),3e3),v(""),k([]);return}g(xe=>[...xe,{...Oe}]),v(""),k([])},Ve=Oe=>{g(xe=>xe.filter(Me=>Me.id!==Oe))},tt=async Oe=>{if(Oe.preventDefault(),R(null),!l){R("No patient selected.");return}if(h.length===0){R("No lab tests selected.");return}const xe={patient_id:l.id,tests:h.map(Me=>({id:Me.id,name:Me.name,price:Me.price}))};try{const Me=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)});if(!Me.ok){const Ee=await Me.json();throw new Error(Ee.message||`Failed to create lab order: ${Me.statusText}`)}await Me.json();let ve=l.queueId;if(!ve){const Ee=await ge(`/api/queue/patient/${l.id}/latest`);if(Ee.ok){const Pe=await Ee.json();Pe!=null&&Pe._id&&(ve=Pe._id)}}if(!ve){const Ee=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!Ee.ok){const rt=await Ee.text();throw new Error(`Failed to create queue entry for redirection: ${rt||Ee.statusText}`)}const Pe=await Ee.json();Pe!=null&&Pe.id&&(ve=Pe.id)}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${ve}`,{state:{patientId:l.id}})}catch(Me){console.error("Failed to create lab order:",Me),R(Me.message||"Failed to create lab order.")}};w.useEffect(()=>{A()},[A]);const Ke=()=>h.reduce((Oe,xe)=>Oe+parseFloat(xe.price),0).toFixed(2);return i.jsxs("div",{className:"create-lab-order-page",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:i.jsx(Lt,{size:20})}),i.jsx("h1",{children:"Create New Lab Order"}),i.jsx("div",{className:"w-10"})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"patient-selection-container",children:[t==="select_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",style:{justifyContent:"center"},children:"Select Patient"}),i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(jr,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token, or Phone...",value:E,onChange:M,className:"custom-text-input",autoFocus:!0})]}),q&&i.jsx("div",{className:"loading-text",style:{marginTop:"1rem"},children:"detail..."}),$&&i.jsx("div",{className:"error-text",children:$}),I.length>0&&i.jsx("div",{className:"search-results-dropdown",style:{position:"relative",boxShadow:"none",borderTop:"none",maxHeight:"40vh"},children:I.map(Oe=>i.jsxs("div",{onClick:()=>ae(Oe),className:"search-result-item",children:[i.jsxs("div",{children:[Oe.token&&i.jsxs("span",{className:"token-badge",children:["#",Oe.token]}),i.jsx("span",{style:{fontWeight:500},children:Oe.name})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"var(--text-secondary)"},children:[Oe.age?`${Oe.age}y`:"",Oe.gender?` / ${Oe.gender}`:"",Oe.phone?` / ${Oe.phone}`:""]})]},Oe.id))}),E.length>=2&&!q&&I.length===0&&!$&&i.jsxs("div",{style:{marginTop:"1.5rem"},children:[i.jsxs("p",{className:"no-data",children:['No patients found matching "',E,'".']}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginTop:"10px"},children:[te&&i.jsxs("button",{type:"button",onClick:()=>de("phone"),className:"btn-primary",children:["Create Patient with Phone ",E]}),K&&i.jsxs("button",{type:"button",onClick:()=>de("name"),className:"btn-primary",children:['Create Patient with Name "',E,'"']})]})]}),i.jsx("div",{className:"or-divider",children:"OR"}),i.jsxs("button",{onClick:Se,className:"btn-secondary",style:{width:"100%"},children:[i.jsx(Fl,{size:18,style:{marginRight:"8px",verticalAlign:"text-bottom"}}),"Register New Patient manually"]})]}),t==="create_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",style:{justifyContent:"space-between"},children:[i.jsx("span",{children:"Register New Patient"}),i.jsx("button",{onClick:fe,className:"action-link-btn",children:"Back to Search"})]}),z&&i.jsx("div",{className:"error-text",children:z}),i.jsxs("form",{onSubmit:ie,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-name",children:"Name *"}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:we,className:"form-input",placeholder:"Patient Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:we,className:"form-input",placeholder:"Age"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:we,className:"form-select",children:[i.jsx("option",{value:"",children:"Select..."})," ",i.jsx("option",{value:"M",children:"Male"})," ",i.jsx("option",{value:"F",children:"Female"})," ",i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-phone",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:we,className:"form-input",placeholder:"Phone Number"})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-address",children:"Address"}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:we,className:"form-textarea",placeholder:"Address (Optional)"})]})]}),i.jsxs("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[i.jsx("button",{type:"button",onClick:fe,className:"btn-secondary",children:" Cancel "}),i.jsx("button",{type:"submit",className:"btn-primary",children:" Create & Proceed "})]})]})]})]}),t==="create_order"&&l&&i.jsxs("div",{className:"lab-order-grid",children:[i.jsx("div",{className:"left-column",children:i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",children:"Add Lab Tests"}),i.jsxs("div",{className:"search-input-wrapper",style:{marginBottom:"1.5rem"},children:[i.jsx(jr,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search available lab tests...",value:b,onChange:Oe=>v(Oe.target.value),className:"custom-text-input",disabled:G,autoFocus:!0}),G&&i.jsx("span",{style:{position:"absolute",right:"15px",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Loading..."}),b&&S.length>0&&i.jsx("div",{className:"search-results-dropdown",children:S.map(Oe=>i.jsxs("div",{onClick:()=>_e(Oe),className:"search-result-item",children:[i.jsx("span",{children:Oe.name}),i.jsxs("span",{style:{fontWeight:600,color:"var(--primary-color)"},children:["",parseFloat(Oe.price).toFixed(2)]})]},Oe.id))}),b&&S.length===0&&!G&&i.jsx("div",{className:"search-results-dropdown",style:{padding:"1rem",color:"var(--text-secondary)",textAlign:"center"},children:"No tests found."})]}),L&&i.jsxs("div",{className:"error-text",style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(rr,{size:18})," ",L]}),i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Test Name"}),i.jsx("th",{style:{width:"100px",textAlign:"right"},children:"Price"}),i.jsx("th",{style:{width:"60px",textAlign:"center"},children:"Action"})]})}),i.jsx("tbody",{children:h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"no-data",children:"No tests added yet. Search above to add."})}):h.map(Oe=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("span",{style:{fontWeight:500},children:Oe.name})}),i.jsxs("td",{style:{textAlign:"right",fontWeight:600},children:["",parseFloat(Oe.price).toFixed(2)]}),i.jsx("td",{style:{textAlign:"center"},children:i.jsx("button",{type:"button",onClick:()=>Ve(Oe.id),className:"delete-btn",title:"Remove",children:i.jsx(Fr,{size:16})})})]},Oe.id))})]})})]})}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"patient-card",children:[i.jsx("div",{className:"patient-avatar",children:i.jsx(Vs,{size:32})}),i.jsx("h3",{className:"patient-name",children:l.name}),i.jsxs("div",{className:"patient-info-text",children:[l.age?`${l.age} yrs`:"",l.gender?`  ${l.gender}`:""]}),l.phone&&i.jsx("div",{className:"patient-info-text",style:{marginTop:"4px"},children:l.phone}),i.jsx("button",{onClick:fe,className:"change-patient-btn",children:"Change Patient"})]}),i.jsxs("div",{className:"order-summary-container",children:[i.jsx("h3",{className:"section-title",style:{marginBottom:"1rem"},children:"Order Summary"}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Tests"}),i.jsx("span",{children:h.length})]}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Total Amount"}),i.jsxs("span",{className:"total-value",children:["",Ke()]})]}),i.jsx("button",{onClick:tt,disabled:h.length===0,className:"create-order-btn",children:"Confirm Order"}),i.jsx("button",{type:"button",onClick:()=>n(-1),className:"btn-secondary",style:{width:"100%",marginTop:"1rem",border:"none",color:"var(--text-secondary)"},children:"Cancel"})]})]})]})]})},lq=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[s,l]=w.useState([]),[f,u]=w.useState(!0),[d,h]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,E]=w.useState(null),T=yt(),I=async()=>{u(!0),E(null);let U=[];try{const L=await ge("/api/queue");if(!L.ok){const ee=await L.json();throw new Error(ee.message||"Failed to fetch queue")}U=await L.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(U,null,2));const R=U.map(async ee=>{if(!ee.patient_id)return console.warn(`Queue entry ${ee.id} has no patient_id.`),ee;try{const te=await ge(`/api/patients/${ee.patient_id}`);if(!te.ok)return console.error(`Failed to fetch patient details for ${ee.patient_id}: ${te.status}`),ee;const oe=await te.json();return{...ee,Patient:{...ee.Patient??{},...oe}}}catch(te){return console.error(`Error fetching patient details for ${ee.patient_id}:`,te),ee}}),G=await Promise.all(R);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(G,null,2)),G.sort((ee,te)=>{var ne,A;const oe=((ne=ee.Patient)==null?void 0:ne.subscription_status)==="active",K=((A=te.Patient)==null?void 0:A.subscription_status)==="active";if(oe&&!K)return-1;if(!oe&&K)return 1;const V=ee.created_at?new Date(ee.created_at).getTime():0,J=te.created_at?new Date(te.created_at).getTime():0;return V-J}),console.log("Sorted Queue Data:",JSON.stringify(G,null,2)),l(G)}catch(L){console.error("Error in fetchQueue process:",L),E(`Failed to load queue: ${L.message}`),l(U)}finally{u(!1)}},D=async()=>{b(!0),E(null);try{const U=await ge("/api/staff?role=doctor");if(!U.ok){const R=await U.json();throw new Error(R.message||"Failed to fetch doctors")}const L=await U.json();h(L.filter(R=>R.active))}catch(U){console.error("Error fetching doctors:",U),E(`Failed to fetch doctors: ${U.message}`)}finally{b(!1)}};w.useEffect(()=>{n==="queue"&&(I(),D()),S(null)},[n]);const q=w.useCallback(async(U,L)=>{if(console.log(`Attempting to assign doctor ${L} to queue ${U}`),E(null),S(null),!L){console.log("No doctor ID provided, skipping assignment.");return}const R=s.find(te=>te.id===U);if(!R){console.error(`Queue entry ${U} not found in local state.`),E("Queue entry not found.");return}if(R.doctor_id===L){console.log(`Queue ${U} already assigned to doctor ${L}. Skipping.`);return}const G=async te=>{if(!te||!te.id||!te.name){E("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",te);return}const oe=async()=>{try{const K={status:"waiting",doctorId:L},V=await ge(`/api/queue/${U}/status`,{method:"PATCH",body:JSON.stringify(K)}),J=await V.json();if(!V.ok)throw new Error(J.message||`HTTP error! status: ${V.status}`);const ne=d.find(A=>A.id===L);return console.log(`Successfully assigned doctor ${ne==null?void 0:ne.name} to queue ${U}.`),l(A=>A.map(ae=>ae.id===U?{...ae,doctor_id:L,status:J.status||ae.status,User:ne?{name:ne.name}:null,Patient:te}:ae)),!0}catch(K){return console.error(`Error assigning doctor for queue ${U}:`,K),E(`Failed to assign doctor: ${K.message}`),!1}};te.subscription_status==="active"?(console.log(`Patient ${te.name} (ID: ${te.id}) has active subscription. Assigning doctor directly.`),await oe()):(console.log(`Patient ${te.name} (ID: ${te.id}) does not have active subscription (Status: ${te.subscription_status}). Assigning doctor and proceeding to billing.`),await oe()?(console.log(`Navigating to billing for patient ${te.name} (ID: ${te.id}), queue ID: ${U}, doctor ID: ${L}`),T("/billing",{state:{patientId:te.id,queueId:U,patientName:te.name,doctorId:L,billType:"consultation"}})):console.log(`Assignment failed for patient ${te.name}, skipping navigation.`))},ee=R.Patient;if(ee&&ee.id&&ee.name)console.log("Patient details found in state. Proceeding with assignment."),await G(ee);else{console.warn(`Patient details missing for queue entry ${U}. Fetching patient ${R.patient_id}...`);try{const te=await ge(`/api/patients/${R.patient_id}`);if(!te.ok){const K=await te.json().catch(()=>({}));throw new Error(K.message||`Failed to fetch patient details (status ${te.status})`)}const oe=await te.json();console.log("Successfully fetched patient details:",oe),await G(oe)}catch(te){console.error(`Failed to fetch patient details for patient ID ${R.patient_id}:`,te),E(`Failed to fetch required patient details: ${te.message}`)}}},[d,s,T]),F=async(U,L)=>{E(null);const R=L==="consulting"?"start consultation":"complete visit";try{const G=s.find(K=>K.id===U);if(!G&&L==="consulting")throw new Error("Queue entry not found to start consultation.");let ee={status:L};if(L==="consulting"){if(!(G!=null&&G.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");ee.doctorId=G.doctor_id}const te=await ge(`/api/queue/${U}/status`,{method:"PATCH",body:JSON.stringify(ee)}),oe=await te.json();if(!te.ok)throw new Error(oe.message||`HTTP error! status: ${te.status}`);l(K=>K.map(V=>V.id===U?{...V,status:L}:V))}catch(G){console.error(`Error trying to ${R}:`,G),E(`Failed to ${R}: ${G.message}`)}},$=[{id:"queue",label:"Queue",icon:i.jsx(Fh,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(jr,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(LI,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(TM,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(C2,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(Il,{size:20})}],B=U=>{try{return new Date(U).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},z=s.filter(U=>{var L,R;return(R=(L=U.Patient)==null?void 0:L.name)==null?void 0:R.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",$.map(U=>i.jsxs("button",{className:`reception-tab-button ${n===U.id?"active":""}`,onClick:()=>t(U.id),children:[i.jsx("span",{children:U.icon}),U.label]},U.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:U=>a(U.target.value)}),i.jsx(jr,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:s.filter(U=>U.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:s.filter(U=>U.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:s.filter(U=>U.status==="seen").length})," "]})]})]}),f?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):z.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:z.map(U=>{var L,R,G,ee,te,oe,K,V,J,ne,A;return i.jsxs("tr",{onClick:()=>T(`/dashboard/edit-complaint/${U.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",U.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:((L=U.Patient)==null?void 0:L.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[(R=U.Patient)!=null&&R.age?`${U.Patient.age} yrs, `:"",((G=U.Patient)==null?void 0:G.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((ee=U.Patient)==null?void 0:ee.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:U.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((te=U.Patient)==null?void 0:te.subscription_status)==="active"?"status-active":((oe=U.Patient)==null?void 0:oe.subscription_status)==="cancelled"||((K=U.Patient)==null?void 0:K.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((V=U.Patient)==null?void 0:V.subscription_status)??"None"}),U.Patient&&U.Patient.id&&U.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:ae=>{ae.stopPropagation(),U.Patient&&T(`/start-subscription/${U.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:B(U.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===U.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:ae=>ae.stopPropagation(),children:i.jsxs("select",{value:"",onChange:ae=>q(U.id,ae.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):d.length>0?d.map(ae=>i.jsx("option",{value:ae.id,children:ae.name},ae.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:ae=>ae.stopPropagation(),children:[" ",U.status==="waiting"&&i.jsx(i.Fragment,{children:(J=U.User)!=null&&J.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:U.User.name}),i.jsx("button",{onClick:()=>F(U.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):d.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):d.length===1?i.jsxs("button",{onClick:()=>q(U.id,d[0].id),className:"action-button btn-assign",children:["Assign ",d[0].name]}):i.jsx("button",{onClick:()=>S(U.id),className:"action-button btn-assign",children:"Assign"})}),U.status==="consulting"&&i.jsxs(i.Fragment,{children:[((ne=U.User)==null?void 0:ne.name)&&i.jsx("span",{className:"doctor-name-display",children:U.User.name}),i.jsx("button",{onClick:()=>F(U.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),U.status==="seen"&&i.jsxs(i.Fragment,{children:[((A=U.User)==null?void 0:A.name)&&i.jsx("span",{className:"doctor-name-display",children:U.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),U.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},U.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(AE,{currentUser:e}),i.jsxs("button",{onClick:()=>T("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(jr,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(Ph,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(EE,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(q1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(TE,{})})]})})},cq=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([s,l])=>{var h;const f=(h=r.default_parameters)==null?void 0:h.find(g=>g.name===s);let u=String(l),d="";if(f){const g=f.unit?` _${f.unit}_`:"";if(f.type==="boolean"){const b=l===!0||l==="true";u=b?"*Reactive*":"Non-Reactive",b||(d="`Normal: Non-Reactive`")}else if(f.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(f.lower_limit!=null||f.upper_limit!=null){let v=[];f.lower_limit!=null&&v.push(`${f.lower_limit}`),f.upper_limit!=null&&v.push(`${f.upper_limit}`),d=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(f.lower_limit!=null&&b<f.lower_limit||f.upper_limit!=null&&b>f.upper_limit)&&(u=`*${u}*`)}}f.unit&&(u+=g)}n+=`${s}: ${u}
`,d&&((f==null?void 0:f.type)==="boolean"&&(l===!0||l==="true")||(n+=`${d}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},Xw=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=cq(e),r=`Hello ${n},

Your lab report is ready.

${t}`,s=`https://wa.me/${uq(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(s,"_blank")},uq=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},dq=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,s]=w.useState(!0),[l,f]=w.useState(null),[u,d]=w.useState("orders"),[h,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),E=w.useCallback(async(z=1,U="")=>{s(!0),f(null);try{const L=new URLSearchParams({page:String(z),limit:String(b)});U&&L.append("search",U);const R=await ge(`/api/lab?${L.toString()}`);if(!R.ok)throw new Error(`HTTP error! status: ${R.status}`);const G=await R.json(),ee=G.orders.map(te=>{var oe,K;return{id:te.id,labTokenNumber:String(te.lab_token_number??"N/A"),patientName:((oe=te.Patient)==null?void 0:oe.name)||"N/A",patientId:te.patient_id,patientTokenNumber:String(((K=te.Patient)==null?void 0:K.patient_token_number)??"N/A"),tests:(te.tests||[]).map(V=>V.name||"Unknown Test"),date:$h(new Date(te.createdAt),"yyyy-MM-dd"),status:te.status,reportId:te.reportId,billId:te.billId}});n(ee),S(G.totalCount),g(z)}catch(L){console.error("Failed to fetch lab orders:",L),f(L instanceof Error?L.message:"An unknown error occurred"),n([]),S(0)}finally{s(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${h}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),E(h,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[E,h,t]),w.useEffect(()=>{const z=setTimeout(()=>{t.length>=2?h!==1&&g(1):t.length<2&&h!==1&&g(1)},1e3);return()=>{clearTimeout(z)}},[t]);const T=async(z,U)=>{console.log(`Updating order ${z} to status ${U}`);try{const L=await ge(`/api/lab/${z}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:U})});if(!L.ok){const R=await L.json();throw new Error(R.message||`Failed to update status: ${L.status}`)}if(U==="completed"){const R=await ge(`/api/lab/orders/${z}/report`);if(R.ok){const G=await R.json();Xw(G)}}await E(h,t),console.log(`Order ${z} status updated to ${U}, refetching page ${h}`)}catch(L){console.error("Error updating status:",L),alert(`Failed to update status: ${L instanceof Error?L.message:"Unknown error"}`)}},I=yt(),D=z=>{if(!z){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}z.billId?(console.log(`Navigating to existing bill for Bill ID: ${z.billId}, Patient: ${z.patientName}`),I("/billing",{state:{billId:z.billId,patientId:z.patientId,patientName:z.patientName,billType:"lab"}})):(console.log(`Navigating to create new bill for Lab Order ID: ${z.id}, Patient: ${z.patientName}`),I("/lab-billing",{state:{labOrderId:z.id}}))},q=z=>{z&&z.id?I(`/lab/report/${z.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},F=z=>{switch(z){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:z,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(rr,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:l}),i.jsx("button",{onClick:()=>E(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const $=()=>{h>1&&g(z=>z-1)},B=()=>{h<k&&g(z=>z+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>I(-1),className:"back-button mr-4",children:i.jsx(Lt,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>d("orders"),className:`lab-inventory-button ${u==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(E2,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>I("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>d("inventory"),className:`lab-inventory-button ${u==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(Pw,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),u==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:z=>r(z.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(jr,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map(z=>{const U=F(z.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:z.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",z.patientTokenNumber]})]}),i.jsx("td",{children:z.tests.map((L,R)=>i.jsx("div",{children:L},R))}),i.jsx("td",{className:"hidden md:table-cell",children:z.date}),i.jsx("td",{children:i.jsx("span",{className:U.className,children:U.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[z.status==="pending"&&i.jsx("button",{onClick:()=>D(z),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),z.status==="billed"&&i.jsx("button",{onClick:()=>T(z.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),z.status==="collected"&&i.jsx("button",{onClick:()=>T(z.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(z.status==="processing"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>q(z),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>T(z.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(z.status==="completed"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>{z.id?I(`/lab/view-report/${z.id}`):(console.error("Attempted to view report for an order with no ID:",z),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},z.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map(z=>{const U=F(z.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:z.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",z.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:z.date})]}),i.jsx("span",{className:`${U.className} lab-card-status-pill`,children:U.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),z.tests.map((L,R)=>i.jsx("div",{className:"lab-card-test-item",children:L},R)),z.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[z.status==="pending"&&i.jsx("button",{onClick:()=>D(z),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),z.status==="billed"&&i.jsx("button",{onClick:()=>T(z.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),z.status==="collected"&&i.jsx("button",{onClick:()=>T(z.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(z.status==="processing"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>q(z),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>T(z.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(z.status==="completed"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>{z.id?I(`/lab/view-report/${z.id}`):(console.error("Attempted to view report for an order with no ID:",z),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},z.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(h-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(h*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:$,disabled:h===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(Bb,{size:18})}),i.jsxs("span",{children:["Page ",h," of ",k]}),i.jsx("button",{onClick:B,disabled:h===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(bg,{size:18})})]})]})]}),u==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(Iw,{})]})]})]})},fq=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,s]=w.useState(!0),[l,f]=w.useState(null),u=yt(),d=w.useRef(null),[h,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),E=10,T=w.useCallback(async(B,z,U)=>{s(!0),f(null);try{let L=`/api/pharmacy-orders?page=${B}&limit=${z}`;U&&U.trim()!==""&&(L+=`&search=${encodeURIComponent(U.trim())}`);const R=await ge(L);if(!R.ok)throw new Error(`Failed to fetch orders: ${R.statusText} (${R.status})`);const G=await R.json();if(G&&Array.isArray(G.orders)&&typeof G.totalOrders=="number"&&typeof G.totalPages=="number")console.log("Fetched pharmacy orders data:",G.orders),n(G.orders),k(G.totalOrders),v(G.totalPages),g(G.currentPage||B);else throw console.error("Received data does not match expected paginated structure:",G),new Error("Invalid data format received from API")}catch(L){console.error("Failed to fetch pharmacy orders:",L),f(L.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{s(!1)}},[]);w.useEffect(()=>(d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{const B=t===""?h:1;t!==""&&h!==1&&g(1),T(B,E,t)},500),()=>{d.current&&clearTimeout(d.current)}),[t,h,T,E]);const I=B=>{u(`/dashboard/edit-pharmacy-order/${B}`)},D=B=>{f(null),console.log(`Preparing billing navigation for order: ${B}`);const z=e.find(U=>U.id===B);if(z){const U=z.medications.map(L=>{const R=L.price??0;return(L.price===void 0||L.price===null)&&console.warn(`Medication "${L.name}" in order ${B} is missing a price. Defaulting to 0.`),{name:L.name,pack_quantity:L.pack_quantity,loose_quantity:L.loose_quantity,price:R,pack_price:L.pack_price,loose_price:L.loose_price,total_price:L.total_price,isLoose:L.isLoose,unit:L.unit,drug_id:L.drug_id?String(L.drug_id):null,tabletsPerDay:L.tabletsPerDay,numberOfDays:L.numberOfDays,directions_to_use:L.directions_to_use,discount_percentage:0,batch:L.batch,expiry_date:L.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:U}),u(`/dashboard/pharmacy-billing/${B}`,{state:{initialItems:U}})}else console.error(`Order with ID ${B} not found.`),f(`Order with ID ${B} not found.`),alert(`Error: Could not find order ${B} to bill.`)},q=async(B,z)=>{f(null);const U=e.find(R=>R.id===B);if(!U){f(`Order with ID ${B} not found.`);return}const L={status:z,medications:U.medications};try{const R=await ge(`/api/pharmacy-orders/${B}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!R.ok){const ee=await R.text();throw new Error(`Failed to update status: ${R.statusText} (${R.status}) - ${ee}`)}const G=await R.json();n(ee=>ee.map(te=>te.id===G.id?{...te,status:G.status}:te))}catch(R){console.error("Failed to update order status:",R),f(R.message||`Failed to update status for order ${B}.`),alert(`Error updating status for order ${B}: ${R.message||"Please try again."}`)}},F=B=>{switch(B){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},$=B=>{u(`/dashboard/orders/${B.id}`)};return a&&e.length===0&&!l?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>u("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(Il,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>u("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx(Ud,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>u("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(m1,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>u("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx(Ud,{size:16}),"Distributors"]}),i.jsxs("button",{onClick:()=>u("/dashboard/recurring-medications"),className:"pharmacy-action-button btn-refill-reminders",title:"View Recurring Medications",children:[i.jsx(BI,{size:16}),"Recurring Meds"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:B=>r(B.target.value),className:"pharmacy-search-input"}),i.jsx(jr,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(B=>i.jsxs("tr",{onClick:()=>$(B),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:B.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:B.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[B.medications.map((z,U)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[z.name," (Packs: ",z.pack_quantity,", Loose: ",z.loose_quantity,", ",z.tabletsPerDay??"N/A","x",z.numberOfDays??"N/A","d)",z.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",z.box_number,")"]})]}),z.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",z.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[z.pack_price!==void 0&&`Pack Price: ${Number(z.pack_price).toFixed(2)}`,z.loose_price!==void 0&&` | Loose Price: ${Number(z.loose_price).toFixed(2)}`,z.total_price!==void 0&&` | Item Total: ${Number(z.total_price).toFixed(2)}`]})]},U)),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(B.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(B.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:F(B.status),children:B.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:z=>{z.stopPropagation(),I(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Vd,{size:14})," Edit"]}),i.jsxs("button",{onClick:z=>{z.stopPropagation(),D(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx($d,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:z=>{z.stopPropagation(),q(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ba,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:z=>{z.stopPropagation(),q(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:z=>{z.stopPropagation(),$(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},B.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(B=>{const z=F(B.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>$(B),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:B.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:["Token: ",B.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(B.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:z,children:B.status}),B.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(B.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[B.medications.slice(0,2).map((U,L)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${U.name} (Packs: ${U.pack_quantity}, Loose: ${U.loose_quantity}, ${U.tabletsPerDay??"N/A"}x${U.numberOfDays??"N/A"}d)`,children:[U.name," (Packs: ",U.pack_quantity,", Loose: ",U.loose_quantity,", ",U.tabletsPerDay??"N/A","x",U.numberOfDays??"N/A","d)",U.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",U.box_number,")"]})]}),U.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${U.directions_to_use}`,children:["Directions: ",U.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[U.pack_price!==void 0&&`Pack Price: ${Number(U.pack_price).toFixed(2)}`,U.loose_price!==void 0&&` | Loose Price: ${Number(U.loose_price).toFixed(2)}`,U.total_price!==void 0&&` | Item Total: ${Number(U.total_price).toFixed(2)}`]})]},L)),B.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",B.medications.length-2," more"]}),B.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:U=>{U.stopPropagation(),I(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Vd,{size:14})," Edit"]}),i.jsxs("button",{onClick:U=>{U.stopPropagation(),D(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx($d,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:U=>{U.stopPropagation(),q(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ba,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:U=>{U.stopPropagation(),q(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:U=>{U.stopPropagation(),$(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},B.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(h-1)*E+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(h*E,S)})," ","of ",i.jsx("span",{className:"font-medium",children:S})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(Bb,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",h," of ",b]}),i.jsxs("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(bg,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},hq=()=>{const e=yt();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},pq=()=>{const{id:e}=Ti(),n=yt(),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){f("Drug ID is missing."),s(!1);return}s(!0),f(null);try{const D=await ge(`/api/drugs/${e}`);if(!D.ok){const F=await D.json();throw new Error(F.message||`Failed to fetch drug: ${D.statusText}`)}let q=await D.json();q={...q,name:q.name||"",brand_name:q.brand_name||"",price:parseFloat(String(q.price))||0,buying_price:q.buying_price!==null&&q.buying_price!==void 0?parseFloat(String(q.buying_price)):null,quantity_in_stock:parseInt(String(q.quantity_in_stock),10)||0,gst:q.gst!==null&&q.gst!==void 0?parseFloat(String(q.gst)):null,margin:q.margin!==null&&q.margin!==void 0?parseFloat(String(q.margin)):null,discount:q.discount!==null&&q.discount!==void 0?parseFloat(String(q.discount)):null,batch:q.batch||"",hsn_code:q.hsn_code||"",mfg:q.mfg||"",loose:q.loose!==null&&q.loose!==void 0?parseInt(String(q.loose),10):null},r(q)}catch(D){console.error("Failed to fetch drug:",D),f(D.message||"Failed to load drug data. Please try again.")}finally{s(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const D=F=>{F.key==="Tab"&&v.current===document.activeElement&&(h||(g(!0),setTimeout(()=>{var $;($=S.current)==null||$.focus()},0),F.preventDefault()))},q=F=>{b.current&&!b.current.contains(F.target)&&g(!1)};return document.addEventListener("keydown",D),document.addEventListener("mousedown",q),()=>{document.removeEventListener("keydown",D),document.removeEventListener("mousedown",q)}},[h]);const E=D=>{const{name:q,value:F,type:$}=D.target;r(B=>B?{...B,[q]:$==="number"?parseFloat(F)||null:F}:null)},T=()=>{n(-1)},I=async D=>{if(D.preventDefault(),f(null),d(!0),!t||!t.id){f("Cannot edit drug: No drug data available."),d(!1);return}if(t.price===void 0||t.quantity_in_stock===void 0){f("Price and Stock Quantity are required."),d(!1);return}const q={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,buying_price:t.buying_price===0?null:t.buying_price,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const F=await ge(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});if(!F.ok){const B=await F.json();throw new Error(B.message||`Failed to update drug: ${F.statusText}`)}const $=await F.json();alert(`Drug "${$.name}" updated successfully!`),n(-1)}catch(F){console.error("Failed to update drug:",F),f(F.message||"Failed to update drug. Please try again.")}finally{d(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:T,className:"cancel-button",title:"Go Back",children:i.jsx(Kn,{size:24})})]}),l&&i.jsx("div",{className:"error-message-submit",children:l}),i.jsxs("form",{onSubmit:I,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Uo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:E,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Uo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:E,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Uo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"edit-price",required:!0,step:"0.01",min:"0",value:t.price,onChange:E,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Uo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"edit-quantity_in_stock",required:!0,step:"1",min:"0",value:t.quantity_in_stock,onChange:E,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"edit-unit",value:t.unit||"",onChange:E,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:E,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:E,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!h),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),h&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:E,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:E,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"edit-buying_price",step:"0.01",min:"0",value:t.buying_price??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:E,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:E,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:E,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:T,disabled:u,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:u,className:"form-button submit-form-button",tabIndex:20,children:u?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},V1=()=>{const e=yt(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,E]=w.useState(!1),[T,I]=w.useState([]),[D,q]=w.useState(!0);w.useEffect(()=>{(async()=>{q(!0);try{const R=await ge("/api/staff?role=doctor");if(!R.ok)throw new Error("Failed to fetch doctors");const G=await R.json();I(G),G.length>0&&t(ee=>({...ee,doctorId:""}))}catch(R){console.error("Error fetching doctors:",R),l(`Failed to load doctors: ${R.message}`)}finally{q(!1)}})()},[]);const F=w.useCallback(async()=>{if(d.trim()){E(!0),l(null),b([]);try{const L=encodeURIComponent(d.trim()),R=await ge(`/api/patients?search=${L}&limit=10`);if(!R.ok){const ee=await R.json().catch(()=>({message:"Failed to search patients"}));throw new Error(ee.message||"Failed to search patients")}const G=await R.json();G&&Array.isArray(G.patients)?b(G.patients):(console.error("Unexpected response format from patient search:",G),b([]))}catch(L){console.error("Error searching patients:",L),l(`Search failed: ${L.message}`)}finally{E(!1)}}},[d]);w.useEffect(()=>{if(d.trim().length<2){b([]),l(null);return}const L=setTimeout(()=>{F()},300);return()=>clearTimeout(L)},[d,F]);const $=L=>{S(L),h(""),b([]),l(null),t(R=>({...R,name:"",age:"",gender:"",phone:""}))},B=()=>{S(null),h(""),b([]),l(null),t(L=>({...L,name:"",age:"",gender:"",phone:""}))},z=L=>{const{name:R,value:G}=L.target;t(ee=>({...ee,[R]:G}))},U=async L=>{var R;L.preventDefault(),l(null),u(null),a(!0);try{let G,ee;if(v)G=v.id,ee=v.name,console.log(`Adding existing patient ${G} to queue.`);else{console.log("Registering new patient...");const V=await ge("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!V.ok){const ne=await V.json();if(V.status===403&&ne.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:ne.message}});return}throw new Error(ne.message||"Failed to register patient")}const J=await V.json();G=J.id,ee=J.name,console.log(`New patient ${G} registered.`)}const te=n.doctorId||null;console.log(`Adding patient ${G} to queue for doctor ${te||"Unassigned"}`);const oe=await ge("/api/queue",{method:"POST",body:JSON.stringify({patientId:G,complaint:n.complaint||null,doctorId:te})});if(!oe.ok){const V=await oe.json();throw new Error(V.message||"Failed to add patient to queue")}const K=await oe.json();if(console.log(`Patient added to queue, entry ID: ${K.id}`),S(null),h(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),te){const V=((R=T.find(ne=>ne.id===te))==null?void 0:R.name)||"Selected Doctor",J=v?`Existing patient "${ee}" added to queue for Dr. ${V}. Redirecting to billing...`:`Patient "${ee}" registered and added to queue for Dr. ${V}. Redirecting to billing...`;u(J),e("/billing",{state:{patientId:G,queueId:K.id,patientName:ee,doctorId:te,billType:"consultation"}})}else{const V=v?`Existing patient "${ee}" added to the general queue.`:`Patient "${ee}" registered and added to the general queue.`;u(V)}}catch(G){console.error("Error in add/queue process:",G),G.message.includes("Patient limit")?(l(`Operation failed: ${G.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${G.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[i.jsx(Lt,{size:20,className:"btn-icon"})," Back"]})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx(I2,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:d,onChange:L=>h(L.target.value),className:"form-input",disabled:r||!!v}),i.jsx(jr,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:B,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(Kn,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map(L=>i.jsxs("li",{onClick:()=>$(L),children:[L.name," (ID: ",L.id,", Phone: ",L.phone||"N/A",")"]},L.id))}),d.length>=2&&g.length===0&&!k&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',d,'". You can register them below.']}),k&&d.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),s&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:s})]}),f&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:f})]}),i.jsxs("form",{onSubmit:U,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:z,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:z,className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:z,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:z,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:z,className:`form-select ${D?"opacity-50":""}`,disabled:r||D,children:[i.jsx("option",{value:"",children:D?"Loading doctors...":T.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),T.map(L=>i.jsx("option",{value:L.id,children:L.name},L.id))]}),T.length===0&&!D&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:z,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("button",{type:"submit",className:`btn btn-primary floating-action-btn ${r||D?"disabled":""}`,disabled:r||D,children:[i.jsx(D2,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})},mq=({clinicId:e})=>{const n=yt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,s]=w.useState(null),[l,f]=w.useState(!1);w.useEffect(()=>{s(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const u=g=>{const{name:b,value:v}=g.target;r(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},d=async g=>{if(g.preventDefault(),s(null),!t.name||!t.email||!t.role||!t.password){s("Name, Email, Role, and Password are required.");return}if(!e){s("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){s("Invalid OPD Fee format. Please enter a number.");return}f(!0);try{const v=await ge("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){s(`Failed to add staff: ${v.message}`)}finally{f(!1)}},h=()=>{n(-1)};return i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:h,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(Lt,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{children:"Add New Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(rr,{size:18,className:"mr-2 text-red-500"}),a]}),i.jsxs("form",{onSubmit:d,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:u,required:!0,disabled:l||!e,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:u,required:!0,disabled:l||!e,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:u,required:!0,disabled:l||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:u,required:!0,disabled:l||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:u,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:l||!e}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),i.jsxs("button",{type:"submit",disabled:l||!e,children:[l?i.jsx(zd,{size:18,className:"animate-spin mr-2"}):i.jsx(Fl,{size:18,className:"mr-2"}),l?"Adding...":"Add Staff Member"]})]})]})},gq=()=>{const{id:e}=Ti(),n=yt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,s]=w.useState(""),[l,f]=w.useState(!0),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),f(!1);return}f(!0),g(null),v(null);try{const I=await ge(`/staff/${e}`);if(!I.ok){const q=await I.json();throw new Error(q.message||`HTTP error! status: ${I.status}`)}const D=await I.json();r({name:D.name,email:D.email,role:D.role,opd_fee:D.opd_fee??"",active:D.active})}catch(I){g(`Failed to load staff details: ${I.message}`)}finally{f(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=I=>{const{name:D,value:q,type:F}=I.target;if(F==="checkbox"){const{checked:$}=I.target;r(B=>({...B,[D]:$}))}else r($=>({...$,[D]:q}))},E=I=>{s(I.target.value)},T=async I=>{if(I.preventDefault(),!e){g("Staff ID is missing.");return}d(!0),g(null),v(null);const D={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const q=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(q!==null&&isNaN(q)){g("OPD Fee must be a valid number."),d(!1);return}D.opd_fee=q}else D.opd_fee=null;a.trim()!==""&&(D.password=a.trim());try{const q=await ge(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!q.ok){const F=await q.json();throw new Error(F.message||`HTTP error! status: ${q.status}`)}v("Staff details updated successfully!"),s(""),setTimeout(()=>n(-1),1500)}catch(q){g(`Failed to update staff: ${q.message}`)}finally{d(!1)}};return l?i.jsxs("div",{className:"flex justify-center items-center h-screen",children:[i.jsx(zd,{className:"h-12 w-12 animate-spin text-teal-600"}),i.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(Lt,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),h&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(rr,{size:18,className:"mr-2 text-red-500"}),h,i.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&i.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[i.jsx(Ba,{size:18,className:"mr-2 text-green-500"}),b,i.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),i.jsxs("form",{onSubmit:T,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"role",children:["Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),i.jsxs("div",{className:"form-group checkbox-group",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:E,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),i.jsx("button",{type:"submit",disabled:u,children:u?i.jsxs(i.Fragment,{children:[i.jsx(zd,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(qd,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})};function yq(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const xq=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,bq=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,vq={};function mj(e,n){return(vq.jsx?bq:xq).test(e)}const wq=/[ \t\n\f\r]/g;function Sq(e){return typeof e=="object"?e.type==="text"?gj(e.value):!1:gj(e)}function gj(e){return e.replace(wq,"")===""}let jg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};jg.prototype.normal={};jg.prototype.property={};jg.prototype.space=void 0;function PE(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new jg(t,r,n)}function H1(e){return e.toLowerCase()}let ua=class{constructor(n,t){this.attribute=t,this.property=n}};ua.prototype.attribute="";ua.prototype.booleanish=!1;ua.prototype.boolean=!1;ua.prototype.commaOrSpaceSeparated=!1;ua.prototype.commaSeparated=!1;ua.prototype.defined=!1;ua.prototype.mustUseProperty=!1;ua.prototype.number=!1;ua.prototype.overloadedBoolean=!1;ua.prototype.property="";ua.prototype.spaceSeparated=!1;ua.prototype.space=void 0;let Nq=0;const $t=Jd(),Pr=Jd(),DE=Jd(),it=Jd(),Qn=Jd(),Mh=Jd(),Ma=Jd();function Jd(){return 2**++Nq}const G1=Object.freeze(Object.defineProperty({__proto__:null,boolean:$t,booleanish:Pr,commaOrSpaceSeparated:Ma,commaSeparated:Mh,number:it,overloadedBoolean:DE,spaceSeparated:Qn},Symbol.toStringTag,{value:"Module"})),Iv=Object.keys(G1);let Zw=class extends ua{constructor(n,t,r,a){let s=-1;if(super(n,t),yj(this,"space",a),typeof r=="number")for(;++s<Iv.length;){const l=Iv[s];yj(this,Iv[s],(r&G1[l])===G1[l])}}};Zw.prototype.defined=!0;function yj(e,n,t){t&&(e[n]=t)}function Xh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const s=new Zw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),n[r]=s,t[H1(r)]=r,t[H1(s.attribute)]=r}return new jg(n,t,e.space)}const IE=Xh({properties:{ariaActiveDescendant:null,ariaAtomic:Pr,ariaAutoComplete:null,ariaBusy:Pr,ariaChecked:Pr,ariaColCount:it,ariaColIndex:it,ariaColSpan:it,ariaControls:Qn,ariaCurrent:null,ariaDescribedBy:Qn,ariaDetails:null,ariaDisabled:Pr,ariaDropEffect:Qn,ariaErrorMessage:null,ariaExpanded:Pr,ariaFlowTo:Qn,ariaGrabbed:Pr,ariaHasPopup:null,ariaHidden:Pr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Qn,ariaLevel:it,ariaLive:null,ariaModal:Pr,ariaMultiLine:Pr,ariaMultiSelectable:Pr,ariaOrientation:null,ariaOwns:Qn,ariaPlaceholder:null,ariaPosInSet:it,ariaPressed:Pr,ariaReadOnly:Pr,ariaRelevant:null,ariaRequired:Pr,ariaRoleDescription:Qn,ariaRowCount:it,ariaRowIndex:it,ariaRowSpan:it,ariaSelected:Pr,ariaSetSize:it,ariaSort:null,ariaValueMax:it,ariaValueMin:it,ariaValueNow:it,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function ME(e,n){return n in e?e[n]:n}function RE(e,n){return ME(e,n.toLowerCase())}const Cq=Xh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Mh,acceptCharset:Qn,accessKey:Qn,action:null,allow:null,allowFullScreen:$t,allowPaymentRequest:$t,allowUserMedia:$t,alt:null,as:null,async:$t,autoCapitalize:null,autoComplete:Qn,autoFocus:$t,autoPlay:$t,blocking:Qn,capture:null,charSet:null,checked:$t,cite:null,className:Qn,cols:it,colSpan:null,content:null,contentEditable:Pr,controls:$t,controlsList:Qn,coords:it|Mh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:$t,defer:$t,dir:null,dirName:null,disabled:$t,download:DE,draggable:Pr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:$t,formTarget:null,headers:Qn,height:it,hidden:$t,high:it,href:null,hrefLang:null,htmlFor:Qn,httpEquiv:Qn,id:null,imageSizes:null,imageSrcSet:null,inert:$t,inputMode:null,integrity:null,is:null,isMap:$t,itemId:null,itemProp:Qn,itemRef:Qn,itemScope:$t,itemType:Qn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:$t,low:it,manifest:null,max:null,maxLength:it,media:null,method:null,min:null,minLength:it,multiple:$t,muted:$t,name:null,nonce:null,noModule:$t,noValidate:$t,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:$t,optimum:it,pattern:null,ping:Qn,placeholder:null,playsInline:$t,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:$t,referrerPolicy:null,rel:Qn,required:$t,reversed:$t,rows:it,rowSpan:it,sandbox:Qn,scope:null,scoped:$t,seamless:$t,selected:$t,shadowRootClonable:$t,shadowRootDelegatesFocus:$t,shadowRootMode:null,shape:null,size:it,sizes:null,slot:null,span:it,spellCheck:Pr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:it,step:null,style:null,tabIndex:it,target:null,title:null,translate:null,type:null,typeMustMatch:$t,useMap:null,value:Pr,width:it,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Qn,axis:null,background:null,bgColor:null,border:it,borderColor:null,bottomMargin:it,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:$t,declare:$t,event:null,face:null,frame:null,frameBorder:null,hSpace:it,leftMargin:it,link:null,longDesc:null,lowSrc:null,marginHeight:it,marginWidth:it,noResize:$t,noHref:$t,noShade:$t,noWrap:$t,object:null,profile:null,prompt:null,rev:null,rightMargin:it,rules:null,scheme:null,scrolling:Pr,standby:null,summary:null,text:null,topMargin:it,valueType:null,version:null,vAlign:null,vLink:null,vSpace:it,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:$t,disableRemotePlayback:$t,prefix:null,property:null,results:it,security:null,unselectable:null},space:"html",transform:RE}),jq=Xh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ma,accentHeight:it,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:it,amplitude:it,arabicForm:null,ascent:it,attributeName:null,attributeType:null,azimuth:it,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:it,by:null,calcMode:null,capHeight:it,className:Qn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:it,diffuseConstant:it,direction:null,display:null,dur:null,divisor:it,dominantBaseline:null,download:$t,dx:null,dy:null,edgeMode:null,editable:null,elevation:it,enableBackground:null,end:null,event:null,exponent:it,externalResourcesRequired:null,fill:null,fillOpacity:it,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Mh,g2:Mh,glyphName:Mh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:it,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:it,horizOriginX:it,horizOriginY:it,id:null,ideographic:it,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:it,k:it,k1:it,k2:it,k3:it,k4:it,kernelMatrix:Ma,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:it,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:it,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:it,overlineThickness:it,paintOrder:null,panose1:null,path:null,pathLength:it,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Qn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:it,pointsAtY:it,pointsAtZ:it,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ma,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ma,rev:Ma,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ma,requiredFeatures:Ma,requiredFonts:Ma,requiredFormats:Ma,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:it,specularExponent:it,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:it,strikethroughThickness:it,string:null,stroke:null,strokeDashArray:Ma,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:it,strokeOpacity:it,strokeWidth:null,style:null,surfaceScale:it,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ma,tabIndex:it,tableValues:null,target:null,targetX:it,targetY:it,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ma,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:it,underlineThickness:it,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:it,values:null,vAlphabetic:it,vMathematical:it,vectorEffect:null,vHanging:it,vIdeographic:it,version:null,vertAdvY:it,vertOriginX:it,vertOriginY:it,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:it,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:ME}),OE=Xh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),LE=Xh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:RE}),FE=Xh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),_q={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},kq=/[A-Z]/g,xj=/-[a-z]/g,Eq=/^data[-\w.:]+$/i;function Tq(e,n){const t=H1(n);let r=n,a=ua;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&Eq.test(n)){if(n.charAt(4)==="-"){const s=n.slice(5).replace(xj,Pq);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=n.slice(4);if(!xj.test(s)){let l=s.replace(kq,Aq);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=Zw}return new a(r,n)}function Aq(e){return"-"+e.toLowerCase()}function Pq(e){return e.charAt(1).toUpperCase()}const Dq=PE([IE,Cq,OE,LE,FE],"html"),eS=PE([IE,jq,OE,LE,FE],"svg");function Iq(e){return e.join(" ").trim()}var Ch={},Mv,bj;function Mq(){if(bj)return Mv;bj=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,f=/^\s+|\s+$/g,u=`
`,d="/",h="*",g="",b="comment",v="declaration";Mv=function(k,E){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];E=E||{};var T=1,I=1;function D(ee){var te=ee.match(n);te&&(T+=te.length);var oe=ee.lastIndexOf(u);I=~oe?ee.length-oe:I+ee.length}function q(){var ee={line:T,column:I};return function(te){return te.position=new F(ee),z(),te}}function F(ee){this.start=ee,this.end={line:T,column:I},this.source=E.source}F.prototype.content=k;function $(ee){var te=new Error(E.source+":"+T+":"+I+": "+ee);if(te.reason=ee,te.filename=E.source,te.line=T,te.column=I,te.source=k,!E.silent)throw te}function B(ee){var te=ee.exec(k);if(te){var oe=te[0];return D(oe),k=k.slice(oe.length),te}}function z(){B(t)}function U(ee){var te;for(ee=ee||[];te=L();)te!==!1&&ee.push(te);return ee}function L(){var ee=q();if(!(d!=k.charAt(0)||h!=k.charAt(1))){for(var te=2;g!=k.charAt(te)&&(h!=k.charAt(te)||d!=k.charAt(te+1));)++te;if(te+=2,g===k.charAt(te-1))return $("End of comment missing");var oe=k.slice(2,te-2);return I+=2,D(oe),k=k.slice(te),I+=2,ee({type:b,comment:oe})}}function R(){var ee=q(),te=B(r);if(te){if(L(),!B(a))return $("property missing ':'");var oe=B(s),K=ee({type:v,property:S(te[0].replace(e,g)),value:oe?S(oe[0].replace(e,g)):g});return B(l),K}}function G(){var ee=[];U(ee);for(var te;te=R();)te!==!1&&(ee.push(te),U(ee));return ee}return z(),G()};function S(k){return k?k.replace(f,g):g}return Mv}var vj;function Rq(){if(vj)return Ch;vj=1;var e=Ch&&Ch.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ch,"__esModule",{value:!0}),Ch.default=t;var n=e(Mq());function t(r,a){var s=null;if(!r||typeof r!="string")return s;var l=(0,n.default)(r),f=typeof a=="function";return l.forEach(function(u){if(u.type==="declaration"){var d=u.property,h=u.value;f?a(d,h,u):h&&(s=s||{},s[d]=h)}}),s}return Ch}var qm={},wj;function Oq(){if(wj)return qm;wj=1,Object.defineProperty(qm,"__esModule",{value:!0}),qm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,s=function(d){return!d||t.test(d)||e.test(d)},l=function(d,h){return h.toUpperCase()},f=function(d,h){return"".concat(h,"-")},u=function(d,h){return h===void 0&&(h={}),s(d)?d:(d=d.toLowerCase(),h.reactCompat?d=d.replace(a,f):d=d.replace(r,f),d.replace(n,l))};return qm.camelCase=u,qm}var Vm,Sj;function Lq(){if(Sj)return Vm;Sj=1;var e=Vm&&Vm.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(Rq()),t=Oq();function r(a,s){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(f,u){f&&u&&(l[(0,t.camelCase)(f,s)]=u)}),l}return r.default=r,Vm=r,Vm}var Fq=Lq();const $q=Qd(Fq),$E=zE("end"),tS=zE("start");function zE(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function zq(e){const n=tS(e),t=$E(e);if(n&&t)return{start:n,end:t}}function eg(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Nj(e.position):"start"in e||"end"in e?Nj(e):"line"in e||"column"in e?Y1(e):""}function Y1(e){return Cj(e&&e.line)+":"+Cj(e&&e.column)}function Nj(e){return Y1(e&&e.start)+"-"+Y1(e&&e.end)}function Cj(e){return e&&typeof e=="number"?e:1}let Ai=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",s={},l=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof n=="string"?a=n:!s.cause&&n&&(l=!0,a=n.message,s.cause=n),!s.ruleId&&!s.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?s.ruleId=r:(s.source=r.slice(0,u),s.ruleId=r.slice(u+1))}if(!s.place&&s.ancestors&&s.ancestors){const u=s.ancestors[s.ancestors.length-1];u&&(s.place=u.position)}const f=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=f?f.line:void 0,this.name=eg(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=l&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual,this.expected,this.note,this.url}};Ai.prototype.file="";Ai.prototype.name="";Ai.prototype.reason="";Ai.prototype.message="";Ai.prototype.stack="";Ai.prototype.column=void 0;Ai.prototype.line=void 0;Ai.prototype.ancestors=void 0;Ai.prototype.cause=void 0;Ai.prototype.fatal=void 0;Ai.prototype.place=void 0;Ai.prototype.ruleId=void 0;Ai.prototype.source=void 0;const nS={}.hasOwnProperty,Bq=new Map,Uq=/[A-Z]/g,qq=new Set(["table","tbody","thead","tfoot","tr"]),Vq=new Set(["td","th"]),BE="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Hq(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=Zq(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=Xq(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?eS:Dq,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},s=UE(a,e,void 0);return s&&typeof s!="string"?s:a.create(e,a.Fragment,{children:s||void 0},void 0)}function UE(e,n,t){if(n.type==="element")return Gq(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return Yq(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return Qq(e,n,t);if(n.type==="mdxjsEsm")return Wq(e,n);if(n.type==="root")return Jq(e,n,t);if(n.type==="text")return Kq(e,n)}function Gq(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=eS,e.schema=a),e.ancestors.push(n);const s=VE(e,n.tagName,!1),l=eV(e,n);let f=iS(e,n);return qq.has(n.tagName)&&(f=f.filter(function(u){return typeof u=="string"?!Sq(u):!0})),qE(e,l,s,n),rS(l,f),e.ancestors.pop(),e.schema=r,e.create(n,s,l,t)}function Yq(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}pg(e,n.position)}function Wq(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);pg(e,n.position)}function Qq(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=eS,e.schema=a),e.ancestors.push(n);const s=n.name===null?e.Fragment:VE(e,n.name,!0),l=tV(e,n),f=iS(e,n);return qE(e,l,s,n),rS(l,f),e.ancestors.pop(),e.schema=r,e.create(n,s,l,t)}function Jq(e,n,t){const r={};return rS(r,iS(e,n)),e.create(n,e.Fragment,r,t)}function Kq(e,n){return n.value}function qE(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function rS(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function Xq(e,n,t){return r;function r(a,s,l,f){const d=Array.isArray(l.children)?t:n;return f?d(s,l,f):d(s,l)}}function Zq(e,n){return t;function t(r,a,s,l){const f=Array.isArray(s.children),u=tS(r);return n(a,s,l,f,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function eV(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&nS.call(n.properties,a)){const s=nV(e,a,n.properties[a]);if(s){const[l,f]=s;e.tableCellAlignToStyle&&l==="align"&&typeof f=="string"&&Vq.has(n.tagName)?r=f:t[l]=f}}if(r){const s=t.style||(t.style={});s[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function tV(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const s=r.data.estree.body[0];s.type;const l=s.expression;l.type;const f=l.properties[0];f.type,Object.assign(t,e.evaluater.evaluateExpression(f.argument))}else pg(e,n.position);else{const a=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const f=r.value.data.estree.body[0];f.type,s=e.evaluater.evaluateExpression(f.expression)}else pg(e,n.position);else s=r.value===null?!0:r.value;t[a]=s}return t}function iS(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:Bq;for(;++r<n.children.length;){const s=n.children[r];let l;if(e.passKeys){const u=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(u){const d=a.get(u)||0;l=u+"-"+d,a.set(u,d+1)}}const f=UE(e,s,l);f!==void 0&&t.push(f)}return t}function nV(e,n,t){const r=Tq(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?yq(t):Iq(t)),r.property==="style"){let a=typeof t=="object"?t:rV(e,String(t));return e.stylePropertyNameCase==="css"&&(a=iV(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?_q[r.property]||r.property:r.attribute,t]}}function rV(e,n){try{return $q(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new Ai("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=BE+"#cannot-parse-style-attribute",a}}function VE(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let s=-1,l;for(;++s<a.length;){const f=mj(a[s])?{type:"Identifier",name:a[s]}:{type:"Literal",value:a[s]};l=l?{type:"MemberExpression",object:l,property:f,computed:!!(s&&f.type==="Literal"),optional:!1}:f}r=l}else r=mj(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return nS.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);pg(e)}function pg(e,n){const t=new Ai("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=BE+"#cannot-handle-mdx-estrees-without-createevaluater",t}function iV(e){const n={};let t;for(t in e)nS.call(e,t)&&(n[aV(t)]=e[t]);return n}function aV(e){let n=e.replace(Uq,sV);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function sV(e){return"-"+e.toLowerCase()}const Rv={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},oV={};function aS(e,n){const t=oV,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return HE(e,r,a)}function HE(e,n,t){if(lV(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return jj(e.children,n,t)}return Array.isArray(e)?jj(e,n,t):""}function jj(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=HE(e[a],n,t);return r.join("")}function lV(e){return!!(e&&typeof e=="object")}const _j=document.createElement("i");function sS(e){const n="&"+e+";";_j.innerHTML=n;const t=_j.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function za(e,n,t,r){const a=e.length;let s=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);s<r.length;)l=r.slice(s,s+1e4),l.unshift(n,0),e.splice(...l),s+=1e4,n+=1e4}function os(e,n){return e.length>0?(za(e,e.length,0,n),e):n}const kj={}.hasOwnProperty;function GE(e){const n={};let t=-1;for(;++t<e.length;)cV(n,e[t]);return n}function cV(e,n){let t;for(t in n){const a=(kj.call(e,t)?e[t]:void 0)||(e[t]={}),s=n[t];let l;if(s)for(l in s){kj.call(a,l)||(a[l]=[]);const f=s[l];uV(a[l],Array.isArray(f)?f:f?[f]:[])}}}function uV(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);za(e,0,0,r)}function YE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Us(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const zi=iu(/[A-Za-z]/),ki=iu(/[\dA-Za-z]/),dV=iu(/[#-'*+\--9=?A-Z^-~]/);function Tb(e){return e!==null&&(e<32||e===127)}const W1=iu(/\d/),fV=iu(/[\dA-Fa-f]/),hV=iu(/[!-/:-@[-`{-~]/);function _t(e){return e!==null&&e<-2}function qn(e){return e!==null&&(e<0||e===32)}function sn(e){return e===-2||e===-1||e===32}const a0=iu(new RegExp("\\p{P}|\\p{S}","u")),Yd=iu(/\s/);function iu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Zh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const s=e.charCodeAt(t);let l="";if(s===37&&ki(e.charCodeAt(t+1))&&ki(e.charCodeAt(t+2)))a=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(l=String.fromCharCode(s));else if(s>55295&&s<57344){const f=e.charCodeAt(t+1);s<56320&&f>56319&&f<57344?(l=String.fromCharCode(s,f),a=1):l=""}else l=String.fromCharCode(s);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function hn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let s=0;return l;function l(u){return sn(u)?(e.enter(t),f(u)):n(u)}function f(u){return sn(u)&&s++<a?(e.consume(u),f):(e.exit(t),n(u))}}const pV={tokenize:mV};function mV(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),hn(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),s(f)}function s(f){const u=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=u),t=u,l(f)}function l(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return _t(f)?(e.consume(f),e.exit("chunkText"),s):(e.consume(f),l)}}const gV={tokenize:yV},Ej={tokenize:xV};function yV(e){const n=this,t=[];let r=0,a,s,l;return f;function f(D){if(r<t.length){const q=t[r];return n.containerState=q[1],e.attempt(q[0].continuation,u,d)(D)}return d(D)}function u(D){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&I();const q=n.events.length;let F=q,$;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){$=n.events[F][1].end;break}T(r);let B=q;for(;B<n.events.length;)n.events[B][1].end={...$},B++;return za(n.events,F+1,0,n.events.slice(q)),n.events.length=B,d(D)}return f(D)}function d(D){if(r===t.length){if(!a)return b(D);if(a.currentConstruct&&a.currentConstruct.concrete)return S(D);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(Ej,h,g)(D)}function h(D){return a&&I(),T(r),b(D)}function g(D){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(D)}function b(D){return n.containerState={},e.attempt(Ej,v,S)(D)}function v(D){return r++,t.push([n.currentConstruct,n.containerState]),b(D)}function S(D){if(D===null){a&&I(),T(0),e.consume(D);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:s}),k(D)}function k(D){if(D===null){E(e.exit("chunkFlow"),!0),T(0),e.consume(D);return}return _t(D)?(e.consume(D),E(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(D),k)}function E(D,q){const F=n.sliceStream(D);if(q&&F.push(null),D.previous=s,s&&(s.next=D),s=D,a.defineSkip(D.start),a.write(F),n.parser.lazy[D.start.line]){let $=a.events.length;for(;$--;)if(a.events[$][1].start.offset<l&&(!a.events[$][1].end||a.events[$][1].end.offset>l))return;const B=n.events.length;let z=B,U,L;for(;z--;)if(n.events[z][0]==="exit"&&n.events[z][1].type==="chunkFlow"){if(U){L=n.events[z][1].end;break}U=!0}for(T(r),$=B;$<n.events.length;)n.events[$][1].end={...L},$++;za(n.events,z+1,0,n.events.slice(B)),n.events.length=$}}function T(D){let q=t.length;for(;q-- >D;){const F=t[q];n.containerState=F[1],F[0].exit.call(n,e)}t.length=D}function I(){a.write([null]),s=void 0,a=void 0,n.containerState._closeFlow=void 0}}function xV(e,n,t){return hn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function qh(e){if(e===null||qn(e)||Yd(e))return 1;if(a0(e))return 2}function s0(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const s=e[a].resolveAll;s&&!r.includes(s)&&(n=s(n,t),r.push(s))}return n}const Q1={name:"attention",resolveAll:bV,tokenize:vV};function bV(e,n){let t=-1,r,a,s,l,f,u,d,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;u=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};Tj(g,-u),Tj(b,u),l={type:u>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:u>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},s={type:u>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:u>1?"strong":"emphasis",start:{...l.start},end:{...f.end}},e[r][1].end={...l.start},e[t][1].start={...f.end},d=[],e[r][1].end.offset-e[r][1].start.offset&&(d=os(d,[["enter",e[r][1],n],["exit",e[r][1],n]])),d=os(d,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",s,n]]),d=os(d,s0(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),d=os(d,[["exit",s,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,d=os(d,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,za(e,r-1,t-r+3,d),t=r+d.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function vV(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=qh(r);let s;return l;function l(u){return s=u,e.enter("attentionSequence"),f(u)}function f(u){if(u===s)return e.consume(u),f;const d=e.exit("attentionSequence"),h=qh(u),g=!h||h===2&&a||t.includes(u),b=!a||a===2&&h||t.includes(r);return d._open=!!(s===42?g:g&&(a||!b)),d._close=!!(s===42?b:b&&(h||!g)),n(u)}}function Tj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const wV={name:"autolink",tokenize:SV};function SV(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s}function s(v){return zi(v)?(e.consume(v),l):v===64?t(v):d(v)}function l(v){return v===43||v===45||v===46||ki(v)?(r=1,f(v)):d(v)}function f(v){return v===58?(e.consume(v),r=0,u):(v===43||v===45||v===46||ki(v))&&r++<32?(e.consume(v),f):(r=0,d(v))}function u(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||Tb(v)?t(v):(e.consume(v),u)}function d(v){return v===64?(e.consume(v),h):dV(v)?(e.consume(v),d):t(v)}function h(v){return ki(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||ki(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const _g={partial:!0,tokenize:NV};function NV(e,n,t){return r;function r(s){return sn(s)?hn(e,a,"linePrefix")(s):a(s)}function a(s){return s===null||_t(s)?n(s):t(s)}}const WE={continuation:{tokenize:jV},exit:_V,name:"blockQuote",tokenize:CV};function CV(e,n,t){const r=this;return a;function a(l){if(l===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),s}return t(l)}function s(l){return sn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function jV(e,n,t){const r=this;return a;function a(l){return sn(l)?hn(e,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):s(l)}function s(l){return e.attempt(WE,n,t)(l)}}function _V(e){e.exit("blockQuote")}const QE={name:"characterEscape",tokenize:kV};function kV(e,n,t){return r;function r(s){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(s),e.exit("escapeMarker"),a}function a(s){return hV(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(s)}}const JE={name:"characterReference",tokenize:EV};function EV(e,n,t){const r=this;let a=0,s,l;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),u}function u(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),s=31,l=ki,h(g))}function d(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,l=fV,h):(e.enter("characterReferenceValue"),s=7,l=W1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===ki&&!sS(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<s?(e.consume(g),h):t(g)}}const Aj={partial:!0,tokenize:AV},Pj={concrete:!0,name:"codeFenced",tokenize:TV};function TV(e,n,t){const r=this,a={partial:!0,tokenize:F};let s=0,l=0,f;return u;function u($){return d($)}function d($){const B=r.events[r.events.length-1];return s=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,f=$,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h($)}function h($){return $===f?(l++,e.consume($),h):l<3?t($):(e.exit("codeFencedFenceSequence"),sn($)?hn(e,g,"whitespace")($):g($))}function g($){return $===null||_t($)?(e.exit("codeFencedFence"),r.interrupt?n($):e.check(Aj,k,q)($)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b($))}function b($){return $===null||_t($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g($)):sn($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),hn(e,v,"whitespace")($)):$===96&&$===f?t($):(e.consume($),b)}function v($){return $===null||_t($)?g($):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S($))}function S($){return $===null||_t($)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g($)):$===96&&$===f?t($):(e.consume($),S)}function k($){return e.attempt(a,q,E)($)}function E($){return e.enter("lineEnding"),e.consume($),e.exit("lineEnding"),T}function T($){return s>0&&sn($)?hn(e,I,"linePrefix",s+1)($):I($)}function I($){return $===null||_t($)?e.check(Aj,k,q)($):(e.enter("codeFlowValue"),D($))}function D($){return $===null||_t($)?(e.exit("codeFlowValue"),I($)):(e.consume($),D)}function q($){return e.exit("codeFenced"),n($)}function F($,B,z){let U=0;return L;function L(oe){return $.enter("lineEnding"),$.consume(oe),$.exit("lineEnding"),R}function R(oe){return $.enter("codeFencedFence"),sn(oe)?hn($,G,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(oe):G(oe)}function G(oe){return oe===f?($.enter("codeFencedFenceSequence"),ee(oe)):z(oe)}function ee(oe){return oe===f?(U++,$.consume(oe),ee):U>=l?($.exit("codeFencedFenceSequence"),sn(oe)?hn($,te,"whitespace")(oe):te(oe)):z(oe)}function te(oe){return oe===null||_t(oe)?($.exit("codeFencedFence"),B(oe)):z(oe)}}}function AV(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s)}function s(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const Ov={name:"codeIndented",tokenize:DV},PV={partial:!0,tokenize:IV};function DV(e,n,t){const r=this;return a;function a(d){return e.enter("codeIndented"),hn(e,s,"linePrefix",5)(d)}function s(d){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(d):t(d)}function l(d){return d===null?u(d):_t(d)?e.attempt(PV,l,u)(d):(e.enter("codeFlowValue"),f(d))}function f(d){return d===null||_t(d)?(e.exit("codeFlowValue"),l(d)):(e.consume(d),f)}function u(d){return e.exit("codeIndented"),n(d)}}function IV(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):_t(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):hn(e,s,"linePrefix",5)(l)}function s(l){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(l):_t(l)?a(l):t(l)}}const MV={name:"codeText",previous:OV,resolve:RV,tokenize:LV};function RV(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function OV(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function LV(e,n,t){let r=0,a,s;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),u(g))}function u(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),u):g===96?(s=e.enter("codeTextSequence"),a=0,h(g)):_t(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),u):(e.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||_t(g)?(e.exit("codeTextData"),u(g)):(e.consume(g),d)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(s.type="codeTextData",d(g))}}let FV=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const s=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Hm(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Hm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Hm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Hm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Hm(this.left,t.reverse())}}};function Hm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function KE(e){const n={};let t=-1,r,a,s,l,f,u,d;const h=new FV(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,s=0,s<u.length&&u[s][1].type==="lineEndingBlank"&&(s+=2),s<u.length&&u[s][1].type==="content"))for(;++s<u.length&&u[s][1].type!=="content";)u[s][1].type==="chunkText"&&(u[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,$V(h,t)),t=n[t],d=!0);else if(r[1]._container){for(s=t,a=void 0;s--;)if(l=h.get(s),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=s);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return za(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!d}function $V(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const s=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const f=l.events,u=[],d={};let h,g,b=-1,v=t,S=0,k=0;const E=[k];for(;v;){for(;e.get(++a)[1]!==v;);s.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(k=b+1,E.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):E.pop(),b=E.length;b--;){const T=f.slice(E[b],E[b+1]),I=s.pop();u.push([I,I+T.length-1]),e.splice(I,2,T)}for(u.reverse(),b=-1;++b<u.length;)d[S+u[b][0]]=S+u[b][1],S+=u[b][1]-u[b][0]-1;return d}const zV={resolve:UV,tokenize:qV},BV={partial:!0,tokenize:VV};function UV(e){return KE(e),e}function qV(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?s(f):_t(f)?e.check(BV,l,s)(f):(e.consume(f),a)}function s(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function l(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function VV(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),hn(e,s,"linePrefix")}function s(l){if(l===null||_t(l))return t(l);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function XE(e,n,t,r,a,s,l,f,u){const d=u||Number.POSITIVE_INFINITY;let h=0;return g;function g(T){return T===60?(e.enter(r),e.enter(a),e.enter(s),e.consume(T),e.exit(s),b):T===null||T===32||T===41||Tb(T)?t(T):(e.enter(r),e.enter(l),e.enter(f),e.enter("chunkString",{contentType:"string"}),k(T))}function b(T){return T===62?(e.enter(s),e.consume(T),e.exit(s),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(T))}function v(T){return T===62?(e.exit("chunkString"),e.exit(f),b(T)):T===null||T===60||_t(T)?t(T):(e.consume(T),T===92?S:v)}function S(T){return T===60||T===62||T===92?(e.consume(T),v):v(T)}function k(T){return!h&&(T===null||T===41||qn(T))?(e.exit("chunkString"),e.exit(f),e.exit(l),e.exit(r),n(T)):h<d&&T===40?(e.consume(T),h++,k):T===41?(e.consume(T),h--,k):T===null||T===32||T===40||Tb(T)?t(T):(e.consume(T),T===92?E:k)}function E(T){return T===40||T===41||T===92?(e.consume(T),k):k(T)}}function ZE(e,n,t,r,a,s){const l=this;let f=0,u;return d;function d(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(s),h}function h(v){return f>999||v===null||v===91||v===93&&!u||v===94&&!f&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(s),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):_t(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||_t(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),u||(u=!sn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function eT(e,n,t,r,a,s){let l;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,u):t(b)}function u(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(s),d(b))}function d(b){return b===l?(e.exit(s),u(l)):b===null?t(b):_t(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),hn(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||_t(b)?(e.exit("chunkString"),d(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function tg(e,n){let t;return r;function r(a){return _t(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):sn(a)?hn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const HV={name:"definition",tokenize:YV},GV={partial:!0,tokenize:WV};function YV(e,n,t){const r=this;let a;return s;function s(v){return e.enter("definition"),l(v)}function l(v){return ZE.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=Us(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),u):t(v)}function u(v){return qn(v)?tg(e,d)(v):d(v)}function d(v){return XE(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(GV,g,g)(v)}function g(v){return sn(v)?hn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||_t(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function WV(e,n,t){return r;function r(f){return qn(f)?tg(e,a)(f):t(f)}function a(f){return eT(e,s,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function s(f){return sn(f)?hn(e,l,"whitespace")(f):l(f)}function l(f){return f===null||_t(f)?n(f):t(f)}}const QV={name:"hardBreakEscape",tokenize:JV};function JV(e,n,t){return r;function r(s){return e.enter("hardBreakEscape"),e.consume(s),a}function a(s){return _t(s)?(e.exit("hardBreakEscape"),n(s)):t(s)}}const KV={name:"headingAtx",resolve:XV,tokenize:ZV};function XV(e,n){let t=e.length-2,r=3,a,s;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},s={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},za(e,r,t-r+1,[["enter",a,n],["enter",s,n],["exit",s,n],["exit",a,n]])),e}function ZV(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),s(h)}function s(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||qn(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),u(h)):h===null||_t(h)?(e.exit("atxHeading"),n(h)):sn(h)?hn(e,f,"whitespace")(h):(e.enter("atxHeadingText"),d(h))}function u(h){return h===35?(e.consume(h),u):(e.exit("atxHeadingSequence"),f(h))}function d(h){return h===null||h===35||qn(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),d)}}const eH=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Dj=["pre","script","style","textarea"],tH={concrete:!0,name:"htmlFlow",resolveTo:iH,tokenize:aH},nH={partial:!0,tokenize:oH},rH={partial:!0,tokenize:sH};function iH(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function aH(e,n,t){const r=this;let a,s,l,f,u;return d;function d(M){return h(M)}function h(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),s=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:A):zi(M)?(e.consume(M),l=String.fromCharCode(M),E):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,f=0,S):zi(M)?(e.consume(M),a=4,r.interrupt?n:A):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:A):t(M)}function S(M){const de="CDATA[";return M===de.charCodeAt(f++)?(e.consume(M),f===de.length?r.interrupt?n:G:S):t(M)}function k(M){return zi(M)?(e.consume(M),l=String.fromCharCode(M),E):t(M)}function E(M){if(M===null||M===47||M===62||qn(M)){const de=M===47,Se=l.toLowerCase();return!de&&!s&&Dj.includes(Se)?(a=1,r.interrupt?n(M):G(M)):eH.includes(l.toLowerCase())?(a=6,de?(e.consume(M),T):r.interrupt?n(M):G(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):s?I(M):D(M))}return M===45||ki(M)?(e.consume(M),l+=String.fromCharCode(M),E):t(M)}function T(M){return M===62?(e.consume(M),r.interrupt?n:G):t(M)}function I(M){return sn(M)?(e.consume(M),I):L(M)}function D(M){return M===47?(e.consume(M),L):M===58||M===95||zi(M)?(e.consume(M),q):sn(M)?(e.consume(M),D):L(M)}function q(M){return M===45||M===46||M===58||M===95||ki(M)?(e.consume(M),q):F(M)}function F(M){return M===61?(e.consume(M),$):sn(M)?(e.consume(M),F):D(M)}function $(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),u=M,B):sn(M)?(e.consume(M),$):z(M)}function B(M){return M===u?(e.consume(M),u=null,U):M===null||_t(M)?t(M):(e.consume(M),B)}function z(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||qn(M)?F(M):(e.consume(M),z)}function U(M){return M===47||M===62||sn(M)?D(M):t(M)}function L(M){return M===62?(e.consume(M),R):t(M)}function R(M){return M===null||_t(M)?G(M):sn(M)?(e.consume(M),R):t(M)}function G(M){return M===45&&a===2?(e.consume(M),K):M===60&&a===1?(e.consume(M),V):M===62&&a===4?(e.consume(M),ae):M===63&&a===3?(e.consume(M),A):M===93&&a===5?(e.consume(M),ne):_t(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(nH,ce,ee)(M)):M===null||_t(M)?(e.exit("htmlFlowData"),ee(M)):(e.consume(M),G)}function ee(M){return e.check(rH,te,ce)(M)}function te(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),oe}function oe(M){return M===null||_t(M)?ee(M):(e.enter("htmlFlowData"),G(M))}function K(M){return M===45?(e.consume(M),A):G(M)}function V(M){return M===47?(e.consume(M),l="",J):G(M)}function J(M){if(M===62){const de=l.toLowerCase();return Dj.includes(de)?(e.consume(M),ae):G(M)}return zi(M)&&l.length<8?(e.consume(M),l+=String.fromCharCode(M),J):G(M)}function ne(M){return M===93?(e.consume(M),A):G(M)}function A(M){return M===62?(e.consume(M),ae):M===45&&a===2?(e.consume(M),A):G(M)}function ae(M){return M===null||_t(M)?(e.exit("htmlFlowData"),ce(M)):(e.consume(M),ae)}function ce(M){return e.exit("htmlFlow"),n(M)}}function sH(e,n,t){const r=this;return a;function a(l){return _t(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s):t(l)}function s(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function oH(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(_g,n,t)}}const lH={name:"htmlText",tokenize:cH};function cH(e,n,t){const r=this;let a,s,l;return f;function f(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),u}function u(A){return A===33?(e.consume(A),d):A===47?(e.consume(A),F):A===63?(e.consume(A),D):zi(A)?(e.consume(A),z):t(A)}function d(A){return A===45?(e.consume(A),h):A===91?(e.consume(A),s=0,S):zi(A)?(e.consume(A),I):t(A)}function h(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):_t(A)?(l=g,V(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?K(A):A===45?b(A):g(A)}function S(A){const ae="CDATA[";return A===ae.charCodeAt(s++)?(e.consume(A),s===ae.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),E):_t(A)?(l=k,V(A)):(e.consume(A),k)}function E(A){return A===93?(e.consume(A),T):k(A)}function T(A){return A===62?K(A):A===93?(e.consume(A),T):k(A)}function I(A){return A===null||A===62?K(A):_t(A)?(l=I,V(A)):(e.consume(A),I)}function D(A){return A===null?t(A):A===63?(e.consume(A),q):_t(A)?(l=D,V(A)):(e.consume(A),D)}function q(A){return A===62?K(A):D(A)}function F(A){return zi(A)?(e.consume(A),$):t(A)}function $(A){return A===45||ki(A)?(e.consume(A),$):B(A)}function B(A){return _t(A)?(l=B,V(A)):sn(A)?(e.consume(A),B):K(A)}function z(A){return A===45||ki(A)?(e.consume(A),z):A===47||A===62||qn(A)?U(A):t(A)}function U(A){return A===47?(e.consume(A),K):A===58||A===95||zi(A)?(e.consume(A),L):_t(A)?(l=U,V(A)):sn(A)?(e.consume(A),U):K(A)}function L(A){return A===45||A===46||A===58||A===95||ki(A)?(e.consume(A),L):R(A)}function R(A){return A===61?(e.consume(A),G):_t(A)?(l=R,V(A)):sn(A)?(e.consume(A),R):U(A)}function G(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ee):_t(A)?(l=G,V(A)):sn(A)?(e.consume(A),G):(e.consume(A),te)}function ee(A){return A===a?(e.consume(A),a=void 0,oe):A===null?t(A):_t(A)?(l=ee,V(A)):(e.consume(A),ee)}function te(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||qn(A)?U(A):(e.consume(A),te)}function oe(A){return A===47||A===62||qn(A)?U(A):t(A)}function K(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function V(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),J}function J(A){return sn(A)?hn(e,ne,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):ne(A)}function ne(A){return e.enter("htmlTextData"),l(A)}}const oS={name:"labelEnd",resolveAll:hH,resolveTo:pH,tokenize:mH},uH={tokenize:gH},dH={tokenize:yH},fH={tokenize:xH};function hH(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&za(e,0,e.length,t),e}function pH(e,n){let t=e.length,r=0,a,s,l,f;for(;t--;)if(a=e[t][1],s){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(s=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const u={type:e[s][1].type==="labelLink"?"link":"image",start:{...e[s][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[s][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[s+r+2][1].end},end:{...e[l-2][1].start}};return f=[["enter",u,n],["enter",d,n]],f=os(f,e.slice(s+1,s+r+3)),f=os(f,[["enter",h,n]]),f=os(f,s0(n.parser.constructs.insideSpan.null,e.slice(s+r+4,l-3),n)),f=os(f,[["exit",h,n],e[l-2],e[l-1],["exit",d,n]]),f=os(f,e.slice(l+1)),f=os(f,[["exit",u,n]]),za(e,s,e.length,f),e}function mH(e,n,t){const r=this;let a=r.events.length,s,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){s=r.events[a][1];break}return f;function f(b){return s?s._inactive?g(b):(l=r.parser.defined.includes(Us(r.sliceSerialize({start:s.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),u):t(b)}function u(b){return b===40?e.attempt(uH,h,l?h:g)(b):b===91?e.attempt(dH,h,l?d:g)(b):l?h(b):g(b)}function d(b){return e.attempt(fH,h,g)(b)}function h(b){return n(b)}function g(b){return s._balanced=!0,t(b)}}function gH(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return qn(g)?tg(e,s)(g):s(g)}function s(g){return g===41?h(g):XE(e,l,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return qn(g)?tg(e,u)(g):h(g)}function f(g){return t(g)}function u(g){return g===34||g===39||g===40?eT(e,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function d(g){return qn(g)?tg(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function yH(e,n,t){const r=this;return a;function a(f){return ZE.call(r,e,s,l,"reference","referenceMarker","referenceString")(f)}function s(f){return r.parser.defined.includes(Us(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function l(f){return t(f)}}function xH(e,n,t){return r;function r(s){return e.enter("reference"),e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),a}function a(s){return s===93?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),n):t(s)}}const bH={name:"labelStartImage",resolveAll:oS.resolveAll,tokenize:vH};function vH(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),s}function s(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),l):t(f)}function l(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const wH={name:"labelStartLink",resolveAll:oS.resolveAll,tokenize:SH};function SH(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),s}function s(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const Lv={name:"lineEnding",tokenize:NH};function NH(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),hn(e,n,"linePrefix")}}const sb={name:"thematicBreak",tokenize:CH};function CH(e,n,t){let r=0,a;return s;function s(d){return e.enter("thematicBreak"),l(d)}function l(d){return a=d,f(d)}function f(d){return d===a?(e.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||_t(d))?(e.exit("thematicBreak"),n(d)):t(d)}function u(d){return d===a?(e.consume(d),r++,u):(e.exit("thematicBreakSequence"),sn(d)?hn(e,f,"whitespace")(d):f(d))}}const ia={continuation:{tokenize:EH},exit:AH,name:"list",tokenize:kH},jH={partial:!0,tokenize:PH},_H={partial:!0,tokenize:TH};function kH(e,n,t){const r=this,a=r.events[r.events.length-1];let s=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return f;function f(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:W1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(sb,t,d)(v):d(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(v)}return t(v)}function u(v){return W1(v)&&++l<10?(e.consume(v),u):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),d(v)):t(v)}function d(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(_g,r.interrupt?t:h,e.attempt(jH,b,g))}function h(v){return r.containerState.initialBlankLine=!0,s++,b(v)}function g(v){return sn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=s+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function EH(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(_g,a,s);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,hn(e,n,"listItemIndent",r.containerState.size+1)(f)}function s(f){return r.containerState.furtherBlankLines||!sn(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(_H,n,l)(f))}function l(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,hn(e,e.attempt(ia,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function TH(e,n,t){const r=this;return hn(e,a,"listItemIndent",r.containerState.size+1);function a(s){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(s):t(s)}}function AH(e){e.exit(this.containerState.type)}function PH(e,n,t){const r=this;return hn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(s){const l=r.events[r.events.length-1];return!sn(s)&&l&&l[1].type==="listItemPrefixWhitespace"?n(s):t(s)}}const Ij={name:"setextUnderline",resolveTo:DH,tokenize:IH};function DH(e,n){let t=e.length,r,a,s;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!s&&e[t][1].type==="definition"&&(s=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",s?(e.splice(a,0,["enter",l,n]),e.splice(s+1,0,["exit",e[r][1],n]),e[r][1].end={...e[s][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function IH(e,n,t){const r=this;let a;return s;function s(d){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=d,l(d)):t(d)}function l(d){return e.enter("setextHeadingLineSequence"),f(d)}function f(d){return d===a?(e.consume(d),f):(e.exit("setextHeadingLineSequence"),sn(d)?hn(e,u,"lineSuffix")(d):u(d))}function u(d){return d===null||_t(d)?(e.exit("setextHeadingLine"),n(d)):t(d)}}const MH={tokenize:RH};function RH(e){const n=this,t=e.attempt(_g,r,e.attempt(this.parser.constructs.flowInitial,a,hn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(zV,a)),"linePrefix")));return t;function r(s){if(s===null){e.consume(s);return}return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const OH={resolveAll:nT()},LH=tT("string"),FH=tT("text");function tT(e){return{resolveAll:nT(e==="text"?$H:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],s=t.attempt(a,l,f);return l;function l(h){return d(h)?s(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),u}function u(h){return d(h)?(t.exit("data"),s(h)):(t.consume(h),u)}function d(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function nT(e){return n;function n(t,r){let a=-1,s;for(;++a<=t.length;)s===void 0?t[a]&&t[a][1].type==="data"&&(s=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==s+2&&(t[s][1].end=t[a-1][1].end,t.splice(s+2,a-s-2),a=s+2),s=void 0);return e?e(t,r):t}}function $H(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let s=a.length,l=-1,f=0,u;for(;s--;){const d=a[s];if(typeof d=="string"){for(l=d.length;d.charCodeAt(l-1)===32;)f++,l--;if(l)break;l=-1}else if(d===-2)u=!0,f++;else if(d!==-1){s++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const d={type:t===e.length||u||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?l:r.start._bufferIndex+l,_index:r.start._index+s,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(e.splice(t,0,["enter",d,n],["exit",d,n]),t+=2)}t++}return e}const zH={42:ia,43:ia,45:ia,48:ia,49:ia,50:ia,51:ia,52:ia,53:ia,54:ia,55:ia,56:ia,57:ia,62:WE},BH={91:HV},UH={[-2]:Ov,[-1]:Ov,32:Ov},qH={35:KV,42:sb,45:[Ij,sb],60:tH,61:Ij,95:sb,96:Pj,126:Pj},VH={38:JE,92:QE},HH={[-5]:Lv,[-4]:Lv,[-3]:Lv,33:bH,38:JE,42:Q1,60:[wV,lH],91:wH,92:[QV,QE],93:oS,95:Q1,96:MV},GH={null:[Q1,OH]},YH={null:[42,95]},WH={null:[]},QH=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:YH,contentInitial:BH,disable:WH,document:zH,flow:qH,flowInitial:UH,insideSpan:GH,string:VH,text:HH},Symbol.toStringTag,{value:"Module"}));function JH(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},s=[];let l=[],f=[];const u={attempt:B(F),check:B($),consume:I,enter:D,exit:q,interrupt:B($,{interrupt:!0})},d={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(d,u);return n.resolveAll&&s.push(n),d;function g(R){return l=os(l,R),E(),l[l.length-1]!==null?[]:(z(n,0),d.events=s0(s,d.events,d),d.events)}function b(R,G){return XH(v(R),G)}function v(R){return KH(l,R)}function S(){const{_bufferIndex:R,_index:G,line:ee,column:te,offset:oe}=r;return{_bufferIndex:R,_index:G,line:ee,column:te,offset:oe}}function k(R){a[R.line]=R.column,L()}function E(){let R;for(;r._index<l.length;){const G=l[r._index];if(typeof G=="string")for(R=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===R&&r._bufferIndex<G.length;)T(G.charCodeAt(r._bufferIndex));else T(G)}}function T(R){h=h(R)}function I(R){_t(R)?(r.line++,r.column=1,r.offset+=R===-3?2:1,L()):R!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=R}function D(R,G){const ee=G||{};return ee.type=R,ee.start=S(),d.events.push(["enter",ee,d]),f.push(ee),ee}function q(R){const G=f.pop();return G.end=S(),d.events.push(["exit",G,d]),G}function F(R,G){z(R,G.from)}function $(R,G){G.restore()}function B(R,G){return ee;function ee(te,oe,K){let V,J,ne,A;return Array.isArray(te)?ce(te):"tokenize"in te?ce([te]):ae(te);function ae(fe){return we;function we(ie){const _e=ie!==null&&fe[ie],Ve=ie!==null&&fe.null,tt=[...Array.isArray(_e)?_e:_e?[_e]:[],...Array.isArray(Ve)?Ve:Ve?[Ve]:[]];return ce(tt)(ie)}}function ce(fe){return V=fe,J=0,fe.length===0?K:M(fe[J])}function M(fe){return we;function we(ie){return A=U(),ne=fe,fe.partial||(d.currentConstruct=fe),fe.name&&d.parser.constructs.disable.null.includes(fe.name)?Se():fe.tokenize.call(G?Object.assign(Object.create(d),G):d,u,de,Se)(ie)}}function de(fe){return R(ne,A),oe}function Se(fe){return A.restore(),++J<V.length?M(V[J]):K}}}function z(R,G){R.resolveAll&&!s.includes(R)&&s.push(R),R.resolve&&za(d.events,G,d.events.length-G,R.resolve(d.events.slice(G),d)),R.resolveTo&&(d.events=R.resolveTo(d.events,d))}function U(){const R=S(),G=d.previous,ee=d.currentConstruct,te=d.events.length,oe=Array.from(f);return{from:te,restore:K};function K(){r=R,d.previous=G,d.currentConstruct=ee,d.events.length=te,f=oe,L()}}function L(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function KH(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,s=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,s)];else{if(l=e.slice(t,a),r>-1){const f=l[0];typeof f=="string"?l[0]=f.slice(r):l.shift()}s>0&&l.push(e[a].slice(0,s))}return l}function XH(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const s=e[t];let l;if(typeof s=="string")l=s;else switch(s){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(s)}a=s===-2,r.push(l)}return r.join("")}function ZH(e){const r={constructs:GE([QH,...(e||{}).extensions||[]]),content:a(pV),defined:[],document:a(gV),flow:a(MH),lazy:{},string:a(LH),text:a(FH)};return r;function a(s){return l;function l(f){return JH(r,s,f)}}}function eG(e){for(;!KE(e););return e}const Mj=/[\0\t\n\r]/g;function tG(){let e=1,n="",t=!0,r;return a;function a(s,l,f){const u=[];let d,h,g,b,v;for(s=n+(typeof s=="string"?s.toString():new TextDecoder(l||void 0).decode(s)),g=0,n="",t&&(s.charCodeAt(0)===65279&&g++,t=void 0);g<s.length;){if(Mj.lastIndex=g,d=Mj.exec(s),b=d&&d.index!==void 0?d.index:s.length,v=s.charCodeAt(b),!d){n=s.slice(g);break}if(v===10&&g===b&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),g<b&&(u.push(s.slice(g,b)),e+=b-g),v){case 0:{u.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,u.push(-2);e++<h;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&u.push(-5),n&&u.push(n),u.push(null)),u}}const nG=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function rG(e){return e.replace(nG,iG)}function iG(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),s=a===120||a===88;return YE(t.slice(s?2:1),s?16:10)}return sS(t)||e}const rT={}.hasOwnProperty;function aG(e,n,t){return typeof n!="string"&&(t=n,n=void 0),sG(t)(eG(ZH(t).document().write(tG()(e,n,!0))))}function sG(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(rt),autolinkProtocol:U,autolinkEmail:U,atxHeading:s(Me),blockQuote:s(Ve),characterEscape:U,characterReference:U,codeFenced:s(tt),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:s(tt,l),codeText:s(Ke,l),codeTextData:U,data:U,codeFlowValue:U,definition:s(Oe),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:s(xe),hardBreakEscape:s(ve),hardBreakTrailing:s(ve),htmlFlow:s(Ee,l),htmlFlowData:U,htmlText:s(Ee,l),htmlTextData:U,image:s(Pe),label:l,link:s(rt),listItem:s(Ze),listItemValue:b,listOrdered:s(lt,g),listUnordered:s(lt),paragraph:s(Rt),reference:M,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:s(Me),strong:s(kt),thematicBreak:s(se)},exit:{atxHeading:u(),atxHeadingSequence:F,autolink:u(),autolinkEmail:_e,autolinkProtocol:ie,blockQuote:u(),characterEscapeValue:L,characterReferenceMarkerHexadecimal:Se,characterReferenceMarkerNumeric:Se,characterReferenceValue:fe,characterReference:we,codeFenced:u(E),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:L,codeIndented:u(T),codeText:u(oe),codeTextData:L,data:L,definition:u(),definitionDestinationString:q,definitionLabelString:I,definitionTitleString:D,emphasis:u(),hardBreakEscape:u(G),hardBreakTrailing:u(G),htmlFlow:u(ee),htmlFlowData:L,htmlText:u(te),htmlTextData:L,image:u(V),label:ne,labelText:J,lineEnding:R,link:u(K),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:de,resourceDestinationString:A,resourceTitleString:ae,resource:ce,setextHeading:u(z),setextHeadingLineSequence:B,setextHeadingText:$,strong:u(),thematicBreak:u()}};iT(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(Q){let re={type:"root",children:[]};const je={stack:[re],tokenStack:[],config:n,enter:f,exit:d,buffer:l,resume:h,data:t},Ae=[];let Ue=-1;for(;++Ue<Q.length;)if(Q[Ue][1].type==="listOrdered"||Q[Ue][1].type==="listUnordered")if(Q[Ue][0]==="enter")Ae.push(Ue);else{const ot=Ae.pop();Ue=a(Q,ot,Ue)}for(Ue=-1;++Ue<Q.length;){const ot=n[Q[Ue][0]];rT.call(ot,Q[Ue][1].type)&&ot[Q[Ue][1].type].call(Object.assign({sliceSerialize:Q[Ue][2].sliceSerialize},je),Q[Ue][1])}if(je.tokenStack.length>0){const ot=je.tokenStack[je.tokenStack.length-1];(ot[1]||Rj).call(je,void 0,ot[0])}for(re.position={start:Hc(Q.length>0?Q[0][1].start:{line:1,column:1,offset:0}),end:Hc(Q.length>0?Q[Q.length-2][1].end:{line:1,column:1,offset:0})},Ue=-1;++Ue<n.transforms.length;)re=n.transforms[Ue](re)||re;return re}function a(Q,re,je){let Ae=re-1,Ue=-1,ot=!1,mt,ft,Be,Xe;for(;++Ae<=je;){const Fe=Q[Ae];switch(Fe[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Fe[0]==="enter"?Ue++:Ue--,Xe=void 0;break}case"lineEndingBlank":{Fe[0]==="enter"&&(mt&&!Xe&&!Ue&&!Be&&(Be=Ae),Xe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Xe=void 0}if(!Ue&&Fe[0]==="enter"&&Fe[1].type==="listItemPrefix"||Ue===-1&&Fe[0]==="exit"&&(Fe[1].type==="listUnordered"||Fe[1].type==="listOrdered")){if(mt){let st=Ae;for(ft=void 0;st--;){const Je=Q[st];if(Je[1].type==="lineEnding"||Je[1].type==="lineEndingBlank"){if(Je[0]==="exit")continue;ft&&(Q[ft][1].type="lineEndingBlank",ot=!0),Je[1].type="lineEnding",ft=st}else if(!(Je[1].type==="linePrefix"||Je[1].type==="blockQuotePrefix"||Je[1].type==="blockQuotePrefixWhitespace"||Je[1].type==="blockQuoteMarker"||Je[1].type==="listItemIndent"))break}Be&&(!ft||Be<ft)&&(mt._spread=!0),mt.end=Object.assign({},ft?Q[ft][1].start:Fe[1].end),Q.splice(ft||Ae,0,["exit",mt,Fe[2]]),Ae++,je++}if(Fe[1].type==="listItemPrefix"){const st={type:"listItem",_spread:!1,start:Object.assign({},Fe[1].start),end:void 0};mt=st,Q.splice(Ae,0,["enter",st,Fe[2]]),Ae++,je++,Be=void 0,Xe=!0}}}return Q[re][1]._spread=ot,je}function s(Q,re){return je;function je(Ae){f.call(this,Q(Ae),Ae),re&&re.call(this,Ae)}}function l(){this.stack.push({type:"fragment",children:[]})}function f(Q,re,je){this.stack[this.stack.length-1].children.push(Q),this.stack.push(Q),this.tokenStack.push([re,je||void 0]),Q.position={start:Hc(re.start),end:void 0}}function u(Q){return re;function re(je){Q&&Q.call(this,je),d.call(this,je)}}function d(Q,re){const je=this.stack.pop(),Ae=this.tokenStack.pop();if(Ae)Ae[0].type!==Q.type&&(re?re.call(this,Q,Ae[0]):(Ae[1]||Rj).call(this,Q,Ae[0]));else throw new Error("Cannot close `"+Q.type+"` ("+eg({start:Q.start,end:Q.end})+"): its not open");je.position.end=Hc(Q.end)}function h(){return aS(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(Q){if(this.data.expectingFirstListItemValue){const re=this.stack[this.stack.length-2];re.start=Number.parseInt(this.sliceSerialize(Q),10),this.data.expectingFirstListItemValue=void 0}}function v(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.lang=Q}function S(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.meta=Q}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function T(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q.replace(/(\r?\n|\r)$/g,"")}function I(Q){const re=this.resume(),je=this.stack[this.stack.length-1];je.label=re,je.identifier=Us(this.sliceSerialize(Q)).toLowerCase()}function D(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.title=Q}function q(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.url=Q}function F(Q){const re=this.stack[this.stack.length-1];if(!re.depth){const je=this.sliceSerialize(Q).length;re.depth=je}}function $(){this.data.setextHeadingSlurpLineEnding=!0}function B(Q){const re=this.stack[this.stack.length-1];re.depth=this.sliceSerialize(Q).codePointAt(0)===61?1:2}function z(){this.data.setextHeadingSlurpLineEnding=void 0}function U(Q){const je=this.stack[this.stack.length-1].children;let Ae=je[je.length-1];(!Ae||Ae.type!=="text")&&(Ae=on(),Ae.position={start:Hc(Q.start),end:void 0},je.push(Ae)),this.stack.push(Ae)}function L(Q){const re=this.stack.pop();re.value+=this.sliceSerialize(Q),re.position.end=Hc(Q.end)}function R(Q){const re=this.stack[this.stack.length-1];if(this.data.atHardBreak){const je=re.children[re.children.length-1];je.position.end=Hc(Q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(re.type)&&(U.call(this,Q),L.call(this,Q))}function G(){this.data.atHardBreak=!0}function ee(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q}function te(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q}function oe(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q}function K(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const re=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=re,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function V(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const re=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=re,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function J(Q){const re=this.sliceSerialize(Q),je=this.stack[this.stack.length-2];je.label=rG(re),je.identifier=Us(re).toLowerCase()}function ne(){const Q=this.stack[this.stack.length-1],re=this.resume(),je=this.stack[this.stack.length-1];if(this.data.inReference=!0,je.type==="link"){const Ae=Q.children;je.children=Ae}else je.alt=re}function A(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.url=Q}function ae(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.title=Q}function ce(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function de(Q){const re=this.resume(),je=this.stack[this.stack.length-1];je.label=re,je.identifier=Us(this.sliceSerialize(Q)).toLowerCase(),this.data.referenceType="full"}function Se(Q){this.data.characterReferenceType=Q.type}function fe(Q){const re=this.sliceSerialize(Q),je=this.data.characterReferenceType;let Ae;je?(Ae=YE(re,je==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ae=sS(re);const Ue=this.stack[this.stack.length-1];Ue.value+=Ae}function we(Q){const re=this.stack.pop();re.position.end=Hc(Q.end)}function ie(Q){L.call(this,Q);const re=this.stack[this.stack.length-1];re.url=this.sliceSerialize(Q)}function _e(Q){L.call(this,Q);const re=this.stack[this.stack.length-1];re.url="mailto:"+this.sliceSerialize(Q)}function Ve(){return{type:"blockquote",children:[]}}function tt(){return{type:"code",lang:null,meta:null,value:""}}function Ke(){return{type:"inlineCode",value:""}}function Oe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function xe(){return{type:"emphasis",children:[]}}function Me(){return{type:"heading",depth:0,children:[]}}function ve(){return{type:"break"}}function Ee(){return{type:"html",value:""}}function Pe(){return{type:"image",title:null,url:"",alt:null}}function rt(){return{type:"link",title:null,url:"",children:[]}}function lt(Q){return{type:"list",ordered:Q.type==="listOrdered",start:null,spread:Q._spread,children:[]}}function Ze(Q){return{type:"listItem",spread:Q._spread,checked:null,children:[]}}function Rt(){return{type:"paragraph",children:[]}}function kt(){return{type:"strong",children:[]}}function on(){return{type:"text",value:""}}function se(){return{type:"thematicBreak"}}}function Hc(e){return{line:e.line,column:e.column,offset:e.offset}}function iT(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?iT(e,r):oG(e,r)}}function oG(e,n){let t;for(t in n)if(rT.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function Rj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+eg({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+eg({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+eg({start:n.start,end:n.end})+") is still open")}function lG(e){const n=this;n.parser=t;function t(r){return aG(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function cG(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function uG(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function dG(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function fG(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function hG(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function pG(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Zh(r.toLowerCase()),s=e.footnoteOrder.indexOf(r);let l,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=s+1,f+=1,e.footnoteCounts.set(r,f);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(n,d),e.applyData(n,d)}function mG(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function gG(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function aT(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),s=a[0];s&&s.type==="text"?s.value="["+s.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function yG(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return aT(e,n);const a={src:Zh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,s),e.applyData(n,s)}function xG(e,n){const t={src:Zh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function bG(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function vG(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return aT(e,n);const a={href:Zh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,s),e.applyData(n,s)}function wG(e,n){const t={href:Zh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function SG(e,n,t){const r=e.all(n),a=t?NG(t):sT(n),s={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const u=r[r.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&l.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:s,children:l};return e.patch(n,d),e.applyData(n,d)}function NG(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=sT(t[r])}return n}function sT(e){const n=e.spread;return n??e.children.length>1}function CG(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,s),e.applyData(n,s)}function jG(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function _G(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function kG(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function EG(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=tS(n.children[1]),u=$E(n.children[n.children.length-1]);f&&u&&(l.position={start:f,end:u}),a.push(l)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,s),e.applyData(n,s)}function TG(e,n,t){const r=t?t.children:void 0,s=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,f=l?l.length:n.children.length;let u=-1;const d=[];for(;++u<f;){const g=n.children[u],b={},v=l?l[u]:void 0;v&&(b.align=v);let S={type:"element",tagName:s,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),d.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(n,h),e.applyData(n,h)}function AG(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Oj=9,Lj=32;function PG(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const s=[];for(;r;)s.push(Fj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return s.push(Fj(n.slice(a),a>0,!1)),s.join("")}function Fj(e,n,t){let r=0,a=e.length;if(n){let s=e.codePointAt(r);for(;s===Oj||s===Lj;)r++,s=e.codePointAt(r)}if(t){let s=e.codePointAt(a-1);for(;s===Oj||s===Lj;)a--,s=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function DG(e,n){const t={type:"text",value:PG(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function IG(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const MG={blockquote:cG,break:uG,code:dG,delete:fG,emphasis:hG,footnoteReference:pG,heading:mG,html:gG,imageReference:yG,image:xG,inlineCode:bG,linkReference:vG,link:wG,listItem:SG,list:CG,paragraph:jG,root:_G,strong:kG,table:EG,tableCell:AG,tableRow:TG,text:DG,thematicBreak:IG,toml:Lx,yaml:Lx,definition:Lx,footnoteDefinition:Lx};function Lx(){}const oT=-1,o0=0,ng=1,Ab=2,lS=3,cS=4,uS=5,dS=6,lT=7,cT=8,$j=typeof self=="object"?self:globalThis,RG=(e,n)=>{const t=(a,s)=>(e.set(s,a),a),r=a=>{if(e.has(a))return e.get(a);const[s,l]=n[a];switch(s){case o0:case oT:return t(l,a);case ng:{const f=t([],a);for(const u of l)f.push(r(u));return f}case Ab:{const f=t({},a);for(const[u,d]of l)f[r(u)]=r(d);return f}case lS:return t(new Date(l),a);case cS:{const{source:f,flags:u}=l;return t(new RegExp(f,u),a)}case uS:{const f=t(new Map,a);for(const[u,d]of l)f.set(r(u),r(d));return f}case dS:{const f=t(new Set,a);for(const u of l)f.add(r(u));return f}case lT:{const{name:f,message:u}=l;return t(new $j[f](u),a)}case cT:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:f}=new Uint8Array(l);return t(new DataView(f),l)}}return t(new $j[s](l),a)};return r},zj=e=>RG(new Map,e)(0),jh="",{toString:OG}={},{keys:LG}=Object,Gm=e=>{const n=typeof e;if(n!=="object"||!e)return[o0,n];const t=OG.call(e).slice(8,-1);switch(t){case"Array":return[ng,jh];case"Object":return[Ab,jh];case"Date":return[lS,jh];case"RegExp":return[cS,jh];case"Map":return[uS,jh];case"Set":return[dS,jh];case"DataView":return[ng,t]}return t.includes("Array")?[ng,t]:t.includes("Error")?[lT,t]:[Ab,t]},Fx=([e,n])=>e===o0&&(n==="function"||n==="symbol"),FG=(e,n,t,r)=>{const a=(l,f)=>{const u=r.push(l)-1;return t.set(f,u),u},s=l=>{if(t.has(l))return t.get(l);let[f,u]=Gm(l);switch(f){case o0:{let h=l;switch(u){case"bigint":f=cT,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);h=null;break;case"undefined":return a([oT],l)}return a([f,h],l)}case ng:{if(u){let b=l;return u==="DataView"?b=new Uint8Array(l.buffer):u==="ArrayBuffer"&&(b=new Uint8Array(l)),a([u,[...b]],l)}const h=[],g=a([f,h],l);for(const b of l)h.push(s(b));return g}case Ab:{if(u)switch(u){case"BigInt":return a([u,l.toString()],l);case"Boolean":case"Number":case"String":return a([u,l.valueOf()],l)}if(n&&"toJSON"in l)return s(l.toJSON());const h=[],g=a([f,h],l);for(const b of LG(l))(e||!Fx(Gm(l[b])))&&h.push([s(b),s(l[b])]);return g}case lS:return a([f,l.toISOString()],l);case cS:{const{source:h,flags:g}=l;return a([f,{source:h,flags:g}],l)}case uS:{const h=[],g=a([f,h],l);for(const[b,v]of l)(e||!(Fx(Gm(b))||Fx(Gm(v))))&&h.push([s(b),s(v)]);return g}case dS:{const h=[],g=a([f,h],l);for(const b of l)(e||!Fx(Gm(b)))&&h.push(s(b));return g}}const{message:d}=l;return a([f,{name:u,message:d}],l)};return s},Bj=(e,{json:n,lossy:t}={})=>{const r=[];return FG(!(n||t),!!n,new Map,r)(e),r},Pb=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?zj(Bj(e,n)):structuredClone(e):(e,n)=>zj(Bj(e,n));function $G(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function zG(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function BG(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||$G,r=e.options.footnoteBackLabel||zG,a=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let u=-1;for(;++u<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[u]);if(!d)continue;const h=e.all(d),g=String(d.identifier).toUpperCase(),b=Zh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let I=typeof t=="string"?t:t(u,v);typeof I=="string"&&(I={type:"text",value:I}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,v),className:["data-footnote-backref"]},children:Array.isArray(I)?I:[I]})}const E=h[h.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const I=E.children[E.children.length-1];I&&I.type==="text"?I.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...S)}else h.push(...S);const T={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(d,T),f.push(T)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...Pb(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const l0=function(e){if(e==null)return HG;if(typeof e=="function")return c0(e);if(typeof e=="object")return Array.isArray(e)?UG(e):qG(e);if(typeof e=="string")return VG(e);throw new Error("Expected function, string, or object as test")};function UG(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=l0(e[t]);return c0(r);function r(...a){let s=-1;for(;++s<n.length;)if(n[s].apply(this,a))return!0;return!1}}function qG(e){const n=e;return c0(t);function t(r){const a=r;let s;for(s in e)if(a[s]!==n[s])return!1;return!0}}function VG(e){return c0(n);function n(t){return t&&t.type===e}}function c0(e){return n;function n(t,r,a){return!!(GG(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function HG(){return!0}function GG(e){return e!==null&&typeof e=="object"&&"type"in e}const uT=[],YG=!0,J1=!1,WG="skip";function dT(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const s=l0(a),l=r?-1:1;f(e,void 0,[])();function f(u,d,h){const g=u&&typeof u=="object"?u:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(u.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=uT,S,k,E;if((!n||s(u,d,h[h.length-1]||void 0))&&(v=QG(t(u,h)),v[0]===J1))return v;if("children"in u&&u.children){const T=u;if(T.children&&v[0]!==WG)for(k=(r?T.children.length:-1)+l,E=h.concat(T);k>-1&&k<T.children.length;){const I=T.children[k];if(S=f(I,k,E)(),S[0]===J1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function QG(e){return Array.isArray(e)?e:typeof e=="number"?[YG,e]:e==null?uT:[e]}function fS(e,n,t,r){let a,s,l;typeof n=="function"?(s=void 0,l=n,a=t):(s=n,l=t,a=r),dT(e,s,f,a);function f(u,d){const h=d[d.length-1],g=h?h.children.indexOf(u):void 0;return l(u,g,h)}}const K1={}.hasOwnProperty,JG={};function KG(e,n){const t=n||JG,r=new Map,a=new Map,s=new Map,l={...MG,...t.handlers},f={all:d,applyData:ZG,definitionById:r,footnoteById:a,footnoteCounts:s,footnoteOrder:[],handlers:l,one:u,options:t,patch:XG,wrap:tY};return fS(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function u(h,g){const b=h.type,v=f.handlers[b];if(K1.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:k,...E}=h,T=Pb(E);return T.children=f.all(h),T}return Pb(h)}return(f.options.unknownHandler||eY)(f,h,g)}function d(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=f.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Uj(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=Uj(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function XG(e,n){e.position&&(n.position=zq(e))}function ZG(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,s=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&s&&Object.assign(t.properties,Pb(s)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function eY(e,n){const t=n.data||{},r="value"in n&&!(K1.call(t,"hProperties")||K1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function tY(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Uj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function qj(e,n){const t=KG(e,n),r=t.one(e,void 0),a=BG(t),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&s.children.push({type:"text",value:`
`},a),s}function nY(e,n){return e&&"run"in e?async function(t,r){const a=qj(t,{file:r,...n});await e.run(a,r)}:function(t,r){return qj(t,{file:r,...e||n})}}function Vj(e){if(e)throw e}var Fv,Hj;function rY(){if(Hj)return Fv;Hj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):n.call(d)==="[object Array]"},s=function(d){if(!d||n.call(d)!=="[object Object]")return!1;var h=e.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&e.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!h&&!g)return!1;var b;for(b in d);return typeof b>"u"||e.call(d,b)},l=function(d,h){t&&h.name==="__proto__"?t(d,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):d[h.name]=h.newValue},f=function(d,h){if(h==="__proto__")if(e.call(d,h)){if(r)return r(d,h).value}else return;return d[h]};return Fv=function u(){var d,h,g,b,v,S,k=arguments[0],E=1,T=arguments.length,I=!1;for(typeof k=="boolean"&&(I=k,k=arguments[1]||{},E=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});E<T;++E)if(d=arguments[E],d!=null)for(h in d)g=f(k,h),b=f(d,h),k!==b&&(I&&b&&(s(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&s(g)?g:{},l(k,{name:h,newValue:u(I,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},Fv}var iY=rY();const $v=Qd(iY);function X1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function aY(){const e=[],n={run:t,use:r};return n;function t(...a){let s=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);f(null,...a);function f(u,...d){const h=e[++s];let g=-1;if(u){l(u);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,h?sY(h,f)(...d):l(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function sY(e,n){let t;return r;function r(...l){const f=e.length>l.length;let u;f&&l.push(a);try{u=e.apply(this,l)}catch(d){const h=d;if(f&&t)throw h;return a(h)}f||(u&&u.then&&typeof u.then=="function"?u.then(s,a):u instanceof Error?a(u):s(u))}function a(l,...f){t||(t=!0,n(l,...f))}function s(l){a(null,l)}}const Lo={basename:oY,dirname:lY,extname:cY,join:uY,sep:"/"};function oY(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');kg(e);let t=0,r=-1,a=e.length,s;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(s){t=a+1;break}}else r<0&&(s=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(s){t=a+1;break}}else l<0&&(s=!0,l=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function lY(e){if(kg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function cY(e){kg(e);let n=e.length,t=-1,r=0,a=-1,s=0,l;for(;n--;){const f=e.codePointAt(n);if(f===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),f===46?a<0?a=n:s!==1&&(s=1):a>-1&&(s=-1)}return a<0||t<0||s===0||s===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function uY(...e){let n=-1,t;for(;++n<e.length;)kg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":dY(t)}function dY(e){kg(e);const n=e.codePointAt(0)===47;let t=fY(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function fY(e,n){let t="",r=0,a=-1,s=0,l=-1,f,u;for(;++l<=e.length;){if(l<e.length)f=e.codePointAt(l);else{if(f===47)break;f=47}if(f===47){if(!(a===l-1||s===1))if(a!==l-1&&s===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),a=l,s=0;continue}}else if(t.length>0){t="",r=0,a=l,s=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,s=0}else f===46&&s>-1?s++:s=-1}return t}function kg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const hY={cwd:pY};function pY(){return"/"}function Z1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function mY(e){if(typeof e=="string")e=new URL(e);else if(!Z1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return gY(e)}function gY(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const zv=["history","path","basename","stem","extname","dirname"];let fT=class{constructor(n){let t;n?Z1(n)?t={path:n}:typeof n=="string"||yY(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":hY.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<zv.length;){const s=zv[r];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let a;for(a in t)zv.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Lo.basename(this.path):void 0}set basename(n){Uv(n,"basename"),Bv(n,"basename"),this.path=Lo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Lo.dirname(this.path):void 0}set dirname(n){Gj(this.basename,"dirname"),this.path=Lo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Lo.extname(this.path):void 0}set extname(n){if(Bv(n,"extname"),Gj(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Lo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){Z1(n)&&(n=mY(n)),Uv(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Lo.basename(this.path,this.extname):void 0}set stem(n){Uv(n,"stem"),Bv(n,"stem"),this.path=Lo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Ai(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function Bv(e,n){if(e&&e.includes(Lo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Lo.sep+"`")}function Uv(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function Gj(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function yY(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const xY=function(e){const r=this.constructor.prototype,a=r[e],s=function(){return a.apply(s,arguments)};return Object.setPrototypeOf(s,r),s},bY={}.hasOwnProperty;let vY=class hT extends xY{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=aY()}copy(){const n=new hT;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data($v(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(Hv("data",this.frozen),this.namespace[n]=t,this):bY.call(this.namespace,n)&&this.namespace[n]||void 0:n?(Hv("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=$x(n),r=this.parser||this.Parser;return qv("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),qv("process",this.parser||this.Parser),Vv("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(s,l){const f=$x(n),u=r.parse(f);r.run(u,f,function(h,g,b){if(h||!g||!b)return d(h);const v=g,S=r.stringify(v,b);NY(S)?b.value=S:b.result=S,d(h,b)});function d(h,g){h||!g?l(h):s?s(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),qv("processSync",this.parser||this.Parser),Vv("processSync",this.compiler||this.Compiler),this.process(n,a),Wj("processSync","process",t),r;function a(s,l){t=!0,Vj(s),r=l}}run(n,t,r){Yj(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?s(void 0,r):new Promise(s);function s(l,f){const u=$x(t);a.run(n,u,d);function d(h,g,b){const v=g||n;h?f(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,s),Wj("runSync","run",r),a;function s(l,f){Vj(l),a=f,r=!0}}stringify(n,t){this.freeze();const r=$x(t),a=this.compiler||this.Compiler;return Vv("stringify",a),Yj(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(Hv("use",this.frozen),n!=null)if(typeof n=="function")u(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function s(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[h,...g]=d;u(h,g)}else l(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function l(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(d.plugins),d.settings&&(a.settings=$v(!0,a.settings,d.settings))}function f(d){let h=-1;if(d!=null)if(Array.isArray(d))for(;++h<d.length;){const g=d[h];s(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===d){b=g;break}if(b===-1)r.push([d,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];X1(k)&&X1(v)&&(v=$v(!0,k,v)),r[b]=[d,v,...S]}}}};const wY=new vY().freeze();function qv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Vv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Hv(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Yj(e){if(!X1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Wj(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function $x(e){return SY(e)?e:new fT(e)}function SY(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function NY(e){return typeof e=="string"||CY(e)}function CY(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const jY="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Qj=[],Jj={allowDangerousHtml:!0},_Y=/^(https?|ircs?|mailto|xmpp)$/i,kY=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Qc(e){const n=EY(e),t=TY(e);return AY(n.runSync(n.parse(t),t),e)}function EY(e){const n=e.rehypePlugins||Qj,t=e.remarkPlugins||Qj,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Jj}:Jj;return wY().use(lG).use(t).use(nY,r).use(n)}function TY(e){const n=e.children||"",t=new fT;return typeof n=="string"&&(t.value=n),t}function AY(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,s=n.disallowedElements,l=n.skipHtml,f=n.unwrapDisallowed,u=n.urlTransform||PY;for(const h of kY)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+jY+h.id,void 0);return fS(e,d),Hq(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function d(h,g,b){if(h.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let v;for(v in Rv)if(Object.hasOwn(Rv,v)&&Object.hasOwn(h.properties,v)){const S=h.properties[v],k=Rv[v];(k===null||k.includes(h.tagName))&&(h.properties[v]=u(String(S||""),v,h))}}if(h.type==="element"){let v=t?!t.includes(h.tagName):s?s.includes(h.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(h,g,b)),v&&b&&typeof g=="number")return f&&h.children?b.children.splice(g,1,...h.children):b.children.splice(g,1),g}}}function PY(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||_Y.test(e.slice(0,n))?e:""}function Kj(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function DY(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function IY(e,n,t){const a=l0((t||{}).ignore||[]),s=MY(n);let l=-1;for(;++l<s.length;)dT(e,"text",f);function f(d,h){let g=-1,b;for(;++g<h.length;){const v=h[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return u(d,h)}function u(d,h){const g=h[h.length-1],b=s[l][0],v=s[l][1];let S=0;const E=g.children.indexOf(d);let T=!1,I=[];b.lastIndex=0;let D=b.exec(d.value);for(;D;){const q=D.index,F={index:D.index,input:D.input,stack:[...h,d]};let $=v(...D,F);if(typeof $=="string"&&($=$.length>0?{type:"text",value:$}:void 0),$===!1?b.lastIndex=q+1:(S!==q&&I.push({type:"text",value:d.value.slice(S,q)}),Array.isArray($)?I.push(...$):$&&I.push($),S=q+D[0].length,T=!0),!b.global)break;D=b.exec(d.value)}return T?(S<d.value.length&&I.push({type:"text",value:d.value.slice(S)}),g.children.splice(E,1,...I)):I=[d],E+I.length}}function MY(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([RY(a[0]),OY(a[1])])}return n}function RY(e){return typeof e=="string"?new RegExp(DY(e),"g"):e}function OY(e){return typeof e=="function"?e:function(){return e}}const Gv="phrasing",Yv=["autolink","link","image","label"];function LY(){return{transforms:[VY],enter:{literalAutolink:$Y,literalAutolinkEmail:Wv,literalAutolinkHttp:Wv,literalAutolinkWww:Wv},exit:{literalAutolink:qY,literalAutolinkEmail:UY,literalAutolinkHttp:zY,literalAutolinkWww:BY}}}function FY(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Gv,notInConstruct:Yv},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Gv,notInConstruct:Yv},{character:":",before:"[ps]",after:"\\/",inConstruct:Gv,notInConstruct:Yv}]}}function $Y(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function Wv(e){this.config.enter.autolinkProtocol.call(this,e)}function zY(e){this.config.exit.autolinkProtocol.call(this,e)}function BY(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function UY(e){this.config.exit.autolinkEmail.call(this,e)}function qY(e){this.exit(e)}function VY(e){IY(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,HY],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),GY]],{ignore:["link","linkReference"]})}function HY(e,n,t,r,a){let s="";if(!pT(a)||(/^w/i.test(n)&&(t=n+t,n="",s="http://"),!YY(t)))return!1;const l=WY(t+r);if(!l[0])return!1;const f={type:"link",title:null,url:s+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[f,{type:"text",value:l[1]}]:f}function GY(e,n,t,r){return!pT(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function YY(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function WY(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=Kj(e,"(");let s=Kj(e,")");for(;r!==-1&&a>s;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),s++;return[e,t]}function pT(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||Yd(t)||a0(t))&&(!n||t!==47)}mT.peek=rW;function QY(){this.buffer()}function JY(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function KY(){this.buffer()}function XY(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function ZY(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Us(this.sliceSerialize(e)).toLowerCase(),t.label=n}function eW(e){this.exit(e)}function tW(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Us(this.sliceSerialize(e)).toLowerCase(),t.label=n}function nW(e){this.exit(e)}function rW(){return"["}function mT(e,n,t,r){const a=t.createTracker(r);let s=a.move("[^");const l=t.enter("footnoteReference"),f=t.enter("reference");return s+=a.move(t.safe(t.associationId(e),{after:"]",before:s})),f(),l(),s+=a.move("]"),s}function iW(){return{enter:{gfmFootnoteCallString:QY,gfmFootnoteCall:JY,gfmFootnoteDefinitionLabelString:KY,gfmFootnoteDefinition:XY},exit:{gfmFootnoteCallString:ZY,gfmFootnoteCall:eW,gfmFootnoteDefinitionLabelString:tW,gfmFootnoteDefinition:nW}}}function aW(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:mT},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,s,l){const f=s.createTracker(l);let u=f.move("[^");const d=s.enter("footnoteDefinition"),h=s.enter("label");return u+=f.move(s.safe(s.associationId(r),{before:u,after:"]"})),h(),u+=f.move("]:"),r.children&&r.children.length>0&&(f.shift(4),u+=f.move((n?`
`:" ")+s.indentLines(s.containerFlow(r,f.current()),n?gT:sW))),d(),u}}function sW(e,n,t){return n===0?e:gT(e,n,t)}function gT(e,n,t){return(t?"":"    ")+e}const oW=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];yT.peek=fW;function lW(){return{canContainEols:["delete"],enter:{strikethrough:uW},exit:{strikethrough:dW}}}function cW(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:oW}],handlers:{delete:yT}}}function uW(e){this.enter({type:"delete",children:[]},e)}function dW(e){this.exit(e)}function yT(e,n,t,r){const a=t.createTracker(r),s=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),s(),l}function fW(){return"~"}function hW(e){return e.length}function pW(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||hW,s=[],l=[],f=[],u=[];let d=0,h=-1;for(;++h<e.length;){const k=[],E=[];let T=-1;for(e[h].length>d&&(d=e[h].length);++T<e[h].length;){const I=mW(e[h][T]);if(t.alignDelimiters!==!1){const D=a(I);E[T]=D,(u[T]===void 0||D>u[T])&&(u[T]=D)}k.push(I)}l[h]=k,f[h]=E}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<d;)s[g]=Xj(r[g]);else{const k=Xj(r);for(;++g<d;)s[g]=k}g=-1;const b=[],v=[];for(;++g<d;){const k=s[g];let E="",T="";k===99?(E=":",T=":"):k===108?E=":":k===114&&(T=":");let I=t.alignDelimiters===!1?1:Math.max(1,u[g]-E.length-T.length);const D=E+"-".repeat(I)+T;t.alignDelimiters!==!1&&(I=E.length+I+T.length,I>u[g]&&(u[g]=I),v[g]=I),b[g]=D}l.splice(1,0,b),f.splice(1,0,v),h=-1;const S=[];for(;++h<l.length;){const k=l[h],E=f[h];g=-1;const T=[];for(;++g<d;){const I=k[g]||"";let D="",q="";if(t.alignDelimiters!==!1){const F=u[g]-(E[g]||0),$=s[g];$===114?D=" ".repeat(F):$===99?F%2?(D=" ".repeat(F/2+.5),q=" ".repeat(F/2-.5)):(D=" ".repeat(F/2),q=D):q=" ".repeat(F)}t.delimiterStart!==!1&&!g&&T.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&I==="")&&(t.delimiterStart!==!1||g)&&T.push(" "),t.alignDelimiters!==!1&&T.push(D),T.push(I),t.alignDelimiters!==!1&&T.push(q),t.padding!==!1&&T.push(" "),(t.delimiterEnd!==!1||g!==d-1)&&T.push("|")}S.push(t.delimiterEnd===!1?T.join("").replace(/ +$/,""):T.join(""))}return S.join(`
`)}function mW(e){return e==null?"":String(e)}function Xj(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function gW(e,n,t,r){const a=t.enter("blockquote"),s=t.createTracker(r);s.move("> "),s.shift(2);const l=t.indentLines(t.containerFlow(e,s.current()),yW);return a(),l}function yW(e,n,t){return">"+(t?"":" ")+e}function xW(e,n){return Zj(e,n.inConstruct,!0)&&!Zj(e,n.notInConstruct,!1)}function Zj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function e_(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&xW(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function bW(e,n){const t=String(e);let r=t.indexOf(n),a=r,s=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++s>l&&(l=s):s=1,a=r+n.length,r=t.indexOf(n,a);return l}function vW(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function wW(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function SW(e,n,t,r){const a=wW(t),s=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(vW(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(s,NW);return g(),b}const f=t.createTracker(r),u=a.repeat(Math.max(bW(s,a)+1,3)),d=t.enter("codeFenced");let h=f.move(u);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),s&&(h+=f.move(s+`
`)),h+=f.move(u),d(),h}function NW(e,n,t){return(t?"":"    ")+e}function hS(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function CW(e,n,t,r){const a=hS(t),s=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("[");return d+=u.move(t.safe(t.associationId(e),{before:d,after:"]",...u.current()})),d+=u.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":`
`,...u.current()}))),f(),e.title&&(f=t.enter(`title${s}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),l(),d}function jW(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function mg(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Db(e,n,t){const r=qh(e),a=qh(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}xT.peek=_W;function xT(e,n,t,r){const a=jW(t),s=t.enter("emphasis"),l=t.createTracker(r),f=l.move(a);let u=l.move(t.containerPhrasing(e,{after:a,before:f,...l.current()}));const d=u.charCodeAt(0),h=Db(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=mg(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=Db(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+mg(g));const v=l.move(a);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function _W(e,n,t){return t.options.emphasis||"*"}function kW(e,n){let t=!1;return fS(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,J1}),!!((!e.depth||e.depth<3)&&aS(e)&&(n.options.setext||t))}function EW(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),s=t.createTracker(r);if(kW(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...s.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),f=t.enter("headingAtx"),u=t.enter("phrasing");s.move(l+" ");let d=t.containerPhrasing(e,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(d)&&(d=mg(d.charCodeAt(0))+d.slice(1)),d=d?l+" "+d:l,t.options.closeAtx&&(d+=" "+l),u(),f(),d}bT.peek=TW;function bT(e){return e.value||""}function TW(){return"<"}vT.peek=AW;function vT(e,n,t,r){const a=hS(t),s=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("![");return d+=u.move(t.safe(e.alt,{before:d,after:"]",...u.current()})),d+=u.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":")",...u.current()}))),f(),e.title&&(f=t.enter(`title${s}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),d+=u.move(")"),l(),d}function AW(){return"!"}wT.peek=PW;function wT(e,n,t,r){const a=e.referenceType,s=t.enter("imageReference");let l=t.enter("label");const f=t.createTracker(r);let u=f.move("![");const d=t.safe(e.alt,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return l(),t.stack=h,s(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function PW(){return"!"}ST.peek=DW;function ST(e,n,t){let r=e.value||"",a="`",s=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++s<t.unsafe.length;){const l=t.unsafe[s],f=t.compilePattern(l);let u;if(l.atBreak)for(;u=f.exec(r);){let d=u.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(u.index+1)}}return a+r+a}function DW(){return"`"}function NT(e,n){const t=aS(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}CT.peek=IW;function CT(e,n,t,r){const a=hS(t),s=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let f,u;if(NT(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),f(),t.stack=h,g}f=t.enter("link"),u=t.enter("label");let d=l.move("[");return d+=l.move(t.containerPhrasing(e,{before:d,after:"](",...l.current()})),d+=l.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=t.enter("destinationLiteral"),d+=l.move("<"),d+=l.move(t.safe(e.url,{before:d,after:">",...l.current()})),d+=l.move(">")):(u=t.enter("destinationRaw"),d+=l.move(t.safe(e.url,{before:d,after:e.title?" ":")",...l.current()}))),u(),e.title&&(u=t.enter(`title${s}`),d+=l.move(" "+a),d+=l.move(t.safe(e.title,{before:d,after:a,...l.current()})),d+=l.move(a),u()),d+=l.move(")"),f(),d}function IW(e,n,t){return NT(e,t)?"<":"["}jT.peek=MW;function jT(e,n,t,r){const a=e.referenceType,s=t.enter("linkReference");let l=t.enter("label");const f=t.createTracker(r);let u=f.move("[");const d=t.containerPhrasing(e,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return l(),t.stack=h,s(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function MW(){return"["}function pS(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function RW(e){const n=pS(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function OW(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function _T(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function LW(e,n,t,r){const a=t.enter("list"),s=t.bulletCurrent;let l=e.ordered?OW(t):pS(t);const f=e.ordered?l==="."?")":".":RW(t);let u=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(u=!0),_T(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(l=f),t.bulletCurrent=l;const d=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=s,a(),d}function FW(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function $W(e,n,t,r){const a=FW(t);let s=t.bulletCurrent||pS(t);n&&n.type==="list"&&n.ordered&&(s=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+s);let l=s.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const f=t.createTracker(r);f.move(s+" ".repeat(l-s.length)),f.shift(l);const u=t.enter("listItem"),d=t.indentLines(t.containerFlow(e,f.current()),h);return u(),d;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?s:s+" ".repeat(l-s.length))+g}}function zW(e,n,t,r){const a=t.enter("paragraph"),s=t.enter("phrasing"),l=t.containerPhrasing(e,r);return s(),a(),l}const BW=l0(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function UW(e,n,t,r){return(e.children.some(function(l){return BW(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function qW(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}kT.peek=VW;function kT(e,n,t,r){const a=qW(t),s=t.enter("strong"),l=t.createTracker(r),f=l.move(a+a);let u=l.move(t.containerPhrasing(e,{after:a,before:f,...l.current()}));const d=u.charCodeAt(0),h=Db(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=mg(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=Db(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+mg(g));const v=l.move(a+a);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function VW(e,n,t){return t.options.strong||"*"}function HW(e,n,t,r){return t.safe(e.value,r)}function GW(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function YW(e,n,t){const r=(_T(t)+(t.options.ruleSpaces?" ":"")).repeat(GW(t));return t.options.ruleSpaces?r.slice(0,-1):r}const ET={blockquote:gW,break:e_,code:SW,definition:CW,emphasis:xT,hardBreak:e_,heading:EW,html:bT,image:vT,imageReference:wT,inlineCode:ST,link:CT,linkReference:jT,list:LW,listItem:$W,paragraph:zW,root:UW,strong:kT,text:HW,thematicBreak:YW};function WW(){return{enter:{table:QW,tableData:t_,tableHeader:t_,tableRow:KW},exit:{codeText:XW,table:JW,tableData:Qv,tableHeader:Qv,tableRow:Qv}}}function QW(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function JW(e){this.exit(e),this.data.inTable=void 0}function KW(e){this.enter({type:"tableRow",children:[]},e)}function Qv(e){this.exit(e)}function t_(e){this.enter({type:"tableCell",children:[]},e)}function XW(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,ZW));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function ZW(e,n){return n==="|"?n:e}function eQ(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,s=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:u,tableRow:f}};function l(v,S,k,E){return d(h(v,k,E),v.align)}function f(v,S,k,E){const T=g(v,k,E),I=d([T]);return I.slice(0,I.indexOf(`
`))}function u(v,S,k,E){const T=k.enter("tableCell"),I=k.enter("phrasing"),D=k.containerPhrasing(v,{...E,before:s,after:s});return I(),T(),D}function d(v,S){return pW(v,{align:S,alignDelimiters:r,padding:t,stringLength:a})}function h(v,S,k){const E=v.children;let T=-1;const I=[],D=S.enter("table");for(;++T<E.length;)I[T]=g(E[T],S,k);return D(),I}function g(v,S,k){const E=v.children;let T=-1;const I=[],D=S.enter("tableRow");for(;++T<E.length;)I[T]=u(E[T],v,S,k);return D(),I}function b(v,S,k){let E=ET.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(E=E.replace(/\|/g,"\\$&")),E}}function tQ(){return{exit:{taskListCheckValueChecked:n_,taskListCheckValueUnchecked:n_,paragraph:rQ}}}function nQ(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:iQ}}}function n_(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function rQ(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let s=-1,l;for(;++s<a.length;){const f=a[s];if(f.type==="paragraph"){l=f;break}}l===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function iQ(e,n,t,r){const a=e.children[0],s=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",f=t.createTracker(r);s&&f.move(l);let u=ET.listItem(e,n,t,{...r,...f.current()});return s&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),u;function d(h){return h+l}}function aQ(){return[LY(),iW(),lW(),WW(),tQ()]}function sQ(e){return{extensions:[FY(),aW(e),cW(),eQ(e),nQ()]}}const oQ={tokenize:hQ,partial:!0},TT={tokenize:pQ,partial:!0},AT={tokenize:mQ,partial:!0},PT={tokenize:gQ,partial:!0},lQ={tokenize:yQ,partial:!0},DT={name:"wwwAutolink",tokenize:dQ,previous:MT},IT={name:"protocolAutolink",tokenize:fQ,previous:RT},Ul={name:"emailAutolink",tokenize:uQ,previous:OT},Go={};function cQ(){return{text:Go}}let Ad=48;for(;Ad<123;)Go[Ad]=Ul,Ad++,Ad===58?Ad=65:Ad===91&&(Ad=97);Go[43]=Ul;Go[45]=Ul;Go[46]=Ul;Go[95]=Ul;Go[72]=[Ul,IT];Go[104]=[Ul,IT];Go[87]=[Ul,DT];Go[119]=[Ul,DT];function uQ(e,n,t){const r=this;let a,s;return l;function l(g){return!ew(g)||!OT.call(r,r.previous)||mS(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),f(g))}function f(g){return ew(g)?(e.consume(g),f):g===64?(e.consume(g),u):t(g)}function u(g){return g===46?e.check(lQ,h,d)(g):g===45||g===95||ki(g)?(s=!0,e.consume(g),u):h(g)}function d(g){return e.consume(g),a=!0,u}function h(g){return s&&a&&zi(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function dQ(e,n,t){const r=this;return a;function a(l){return l!==87&&l!==119||!MT.call(r,r.previous)||mS(r.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(oQ,e.attempt(TT,e.attempt(AT,s),t),t)(l))}function s(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function fQ(e,n,t){const r=this;let a="",s=!1;return l;function l(g){return(g===72||g===104)&&RT.call(r,r.previous)&&!mS(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),f):t(g)}function f(g){if(zi(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),f;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),u}return t(g)}function u(g){return g===47?(e.consume(g),s?d:(s=!0,u)):t(g)}function d(g){return g===null||Tb(g)||qn(g)||Yd(g)||a0(g)?t(g):e.attempt(TT,e.attempt(AT,h),t)(g)}function h(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function hQ(e,n,t){let r=0;return a;function a(l){return(l===87||l===119)&&r<3?(r++,e.consume(l),a):l===46&&r===3?(e.consume(l),s):t(l)}function s(l){return l===null?t(l):n(l)}}function pQ(e,n,t){let r,a,s;return l;function l(d){return d===46||d===95?e.check(PT,u,f)(d):d===null||qn(d)||Yd(d)||d!==45&&a0(d)?u(d):(s=!0,e.consume(d),l)}function f(d){return d===95?r=!0:(a=r,r=void 0),e.consume(d),l}function u(d){return a||r||!s?t(d):n(d)}}function mQ(e,n){let t=0,r=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&r<t?s(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(PT,n,s)(l):l===null||qn(l)||Yd(l)?n(l):(e.consume(l),a)}function s(l){return l===41&&r++,e.consume(l),a}}function gQ(e,n,t){return r;function r(f){return f===33||f===34||f===39||f===41||f===42||f===44||f===46||f===58||f===59||f===63||f===95||f===126?(e.consume(f),r):f===38?(e.consume(f),s):f===93?(e.consume(f),a):f===60||f===null||qn(f)||Yd(f)?n(f):t(f)}function a(f){return f===null||f===40||f===91||qn(f)||Yd(f)?n(f):r(f)}function s(f){return zi(f)?l(f):t(f)}function l(f){return f===59?(e.consume(f),r):zi(f)?(e.consume(f),l):t(f)}}function yQ(e,n,t){return r;function r(s){return e.consume(s),a}function a(s){return ki(s)?t(s):n(s)}}function MT(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||qn(e)}function RT(e){return!zi(e)}function OT(e){return!(e===47||ew(e))}function ew(e){return e===43||e===45||e===46||e===95||ki(e)}function mS(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const xQ={tokenize:_Q,partial:!0};function bQ(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:NQ,continuation:{tokenize:CQ},exit:jQ}},text:{91:{name:"gfmFootnoteCall",tokenize:SQ},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:vQ,resolveTo:wQ}}}}function vQ(e,n,t){const r=this;let a=r.events.length;const s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l;for(;a--;){const u=r.events[a][1];if(u.type==="labelImage"){l=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return f;function f(u){if(!l||!l._balanced)return t(u);const d=Us(r.sliceSerialize({start:l.end,end:r.now()}));return d.codePointAt(0)!==94||!s.includes(d.slice(1))?t(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),n(u))}}function wQ(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},f=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",s,n],["enter",l,n],["exit",l,n],["exit",s,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...f),e}function SQ(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s=0,l;return f;function f(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),u}function u(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",d)}function d(g){if(s>999||g===93&&!l||g===null||g===91||qn(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(Us(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return qn(g)||(l=!0),s++,e.consume(g),g===92?h:d}function h(g){return g===91||g===92||g===93?(e.consume(g),s++,d):d(g)}}function NQ(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s,l=0,f;return u;function u(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):t(S)}function h(S){if(l>999||S===93&&!f||S===null||S===91||qn(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return s=Us(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return qn(S)||(f=!0),l++,e.consume(S),S===92?g:h}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,h):h(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(s)||a.push(s),hn(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function CQ(e,n,t){return e.check(_g,n,e.attempt(xQ,n,t))}function jQ(e){e.exit("gfmFootnoteDefinition")}function _Q(e,n,t){const r=this;return hn(e,a,"gfmFootnoteDefinitionIndent",5);function a(s){const l=r.events[r.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(s):t(s)}}function kQ(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:s,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(l,f){let u=-1;for(;++u<l.length;)if(l[u][0]==="enter"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._close){let d=u;for(;d--;)if(l[d][0]==="exit"&&l[d][1].type==="strikethroughSequenceTemporary"&&l[d][1]._open&&l[u][1].end.offset-l[u][1].start.offset===l[d][1].end.offset-l[d][1].start.offset){l[u][1].type="strikethroughSequence",l[d][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},l[d][1].start),end:Object.assign({},l[u][1].end)},g={type:"strikethroughText",start:Object.assign({},l[d][1].end),end:Object.assign({},l[u][1].start)},b=[["enter",h,f],["enter",l[d][1],f],["exit",l[d][1],f],["enter",g,f]],v=f.parser.constructs.insideSpan.null;v&&za(b,b.length,0,s0(v,l.slice(d+1,u),f)),za(b,b.length,0,[["exit",g,f],["enter",l[u][1],f],["exit",l[u][1],f],["exit",h,f]]),za(l,d-1,u-d+3,b),u=d+b.length-2;break}}for(u=-1;++u<l.length;)l[u][1].type==="strikethroughSequenceTemporary"&&(l[u][1].type="data");return l}function s(l,f,u){const d=this.previous,h=this.events;let g=0;return b;function b(S){return d===126&&h[h.length-1][1].type!=="characterEscape"?u(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=qh(d);if(S===126)return g>1?u(S):(l.consume(S),g++,v);if(g<2&&!t)return u(S);const E=l.exit("strikethroughSequenceTemporary"),T=qh(S);return E._open=!T||T===2&&!!k,E._close=!k||k===2&&!!T,f(S)}}}class EQ{constructor(){this.map=[]}add(n,t,r){TQ(this,n,t,r)}consume(n){if(this.map.sort(function(s,l){return s[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const s of a)n.push(s);a=r.pop()}this.map.length=0}}function TQ(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function AQ(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const s=r.length-1;r[s]=r[s]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function PQ(){return{flow:{null:{name:"table",tokenize:DQ,resolveAll:IQ}}}}function DQ(e,n,t){const r=this;let a=0,s=0,l;return f;function f(L){let R=r.events.length-1;for(;R>-1;){const te=r.events[R][1].type;if(te==="lineEnding"||te==="linePrefix")R--;else break}const G=R>-1?r.events[R][1].type:null,ee=G==="tableHead"||G==="tableRow"?$:u;return ee===$&&r.parser.lazy[r.now().line]?t(L):ee(L)}function u(L){return e.enter("tableHead"),e.enter("tableRow"),d(L)}function d(L){return L===124||(l=!0,s+=1),h(L)}function h(L){return L===null?t(L):_t(L)?s>1?(s=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),v):t(L):sn(L)?hn(e,h,"whitespace")(L):(s+=1,l&&(l=!1,a+=1),L===124?(e.enter("tableCellDivider"),e.consume(L),e.exit("tableCellDivider"),l=!0,h):(e.enter("data"),g(L)))}function g(L){return L===null||L===124||qn(L)?(e.exit("data"),h(L)):(e.consume(L),L===92?b:g)}function b(L){return L===92||L===124?(e.consume(L),g):g(L)}function v(L){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(L):(e.enter("tableDelimiterRow"),l=!1,sn(L)?hn(e,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(L):S(L))}function S(L){return L===45||L===58?E(L):L===124?(l=!0,e.enter("tableCellDivider"),e.consume(L),e.exit("tableCellDivider"),k):F(L)}function k(L){return sn(L)?hn(e,E,"whitespace")(L):E(L)}function E(L){return L===58?(s+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(L),e.exit("tableDelimiterMarker"),T):L===45?(s+=1,T(L)):L===null||_t(L)?q(L):F(L)}function T(L){return L===45?(e.enter("tableDelimiterFiller"),I(L)):F(L)}function I(L){return L===45?(e.consume(L),I):L===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(L),e.exit("tableDelimiterMarker"),D):(e.exit("tableDelimiterFiller"),D(L))}function D(L){return sn(L)?hn(e,q,"whitespace")(L):q(L)}function q(L){return L===124?S(L):L===null||_t(L)?!l||a!==s?F(L):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(L)):F(L)}function F(L){return t(L)}function $(L){return e.enter("tableRow"),B(L)}function B(L){return L===124?(e.enter("tableCellDivider"),e.consume(L),e.exit("tableCellDivider"),B):L===null||_t(L)?(e.exit("tableRow"),n(L)):sn(L)?hn(e,B,"whitespace")(L):(e.enter("data"),z(L))}function z(L){return L===null||L===124||qn(L)?(e.exit("data"),B(L)):(e.consume(L),L===92?U:z)}function U(L){return L===92||L===124?(e.consume(L),z):z(L)}}function IQ(e,n){let t=-1,r=!0,a=0,s=[0,0,0,0],l=[0,0,0,0],f=!1,u=0,d,h,g;const b=new EQ;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(f=!1,u!==0&&(r_(b,n,u,d,h),h=void 0,u=0),d={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",d,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(r=!0,g=void 0,s=[0,0,0,0],l=[0,t+1,0,0],f&&(f=!1,h={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",h,n]])),a=S.type==="tableDelimiterRow"?2:h?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(r=!1,l[2]===0&&(s[1]!==0&&(l[0]=l[1],g=zx(b,n,s,a,void 0,g),s=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(r?r=!1:(s[1]!==0&&(l[0]=l[1],g=zx(b,n,s,a,void 0,g)),s=l,l=[s[1],t,0,0])):S.type==="tableHead"?(f=!0,u=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(u=t,s[1]!==0?(l[0]=l[1],g=zx(b,n,s,a,t,g)):l[1]!==0&&(g=zx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(u!==0&&r_(b,n,u,d,h),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=AQ(n.events,t))}return e}function zx(e,n,t,r,a,s){const l=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",f="tableContent";t[0]!==0&&(s.end=Object.assign({},Ah(n.events,t[0])),e.add(t[0],0,[["exit",s,n]]));const u=Ah(n.events,t[1]);if(s={type:l,start:Object.assign({},u),end:Object.assign({},u)},e.add(t[1],0,[["enter",s,n]]),t[2]!==0){const d=Ah(n.events,t[2]),h=Ah(n.events,t[3]),g={type:f,start:Object.assign({},d),end:Object.assign({},h)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(s.end=Object.assign({},Ah(n.events,a)),e.add(a,0,[["exit",s,n]]),s=void 0),s}function r_(e,n,t,r,a){const s=[],l=Ah(n.events,t);a&&(a.end=Object.assign({},l),s.push(["exit",a,n])),r.end=Object.assign({},l),s.push(["exit",r,n]),e.add(t+1,0,s)}function Ah(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const MQ={name:"tasklistCheck",tokenize:OQ};function RQ(){return{text:{91:MQ}}}function OQ(e,n,t){const r=this;return a;function a(u){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),s)}function s(u){return qn(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),l):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),l):t(u)}function l(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),f):t(u)}function f(u){return _t(u)?n(u):sn(u)?e.check({tokenize:LQ},n,t)(u):t(u)}}function LQ(e,n,t){return hn(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function FQ(e){return GE([cQ(),bQ(),kQ(e),PQ(),RQ()])}const $Q={};function Dl(e){const n=this,t=e||$Q,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),s=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),l=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(FQ(t)),s.push(aQ()),l.push(sQ(t))}const zQ=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},BQ=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},Jv=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,noDataText:s,onDeleteItem:l,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:d,onLabOrderTestChange:h,onLabOrderStatusChange:g,onEditPharmacyOrder:b,onPrintUnavailablePrescription:v,onBillLabOrder:S,onUpdateLabOrderStatus:k,onEnterLabReport:E,onViewLabReport:T,onMarkAsRecurring:I,labInventory:D=[],isSavingLabOrder:q=!1,expandedLabReports:F={},toggleLabReport:$=()=>{}})=>{const B=w.useMemo(()=>{const U={};n.forEach(R=>{if(isNaN(R.date.getTime())){U["Unknown Date"]||(U["Unknown Date"]=[]),U["Unknown Date"].push(R);return}const G=zQ(R.originalDateString);U[G]||(U[G]=[]),U[G].push(R)});const L=Object.keys(U);return L.sort((R,G)=>{if(R==="Unknown Date")return 1;if(G==="Unknown Date")return-1;try{const ee=new Date(R.split(" ").reverse().join(" ")),te=new Date(G.split(" ").reverse().join(" "));if(!isNaN(ee.getTime())&&!isNaN(te.getTime()))return te.getTime()-ee.getTime()}catch{}return G.localeCompare(R)}),L.map(R=>({date:R,items:U[R]}))},[n]),z=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:s}),a&&i.jsx("div",{className:"space-y-3",children:[1,2,3].map(U=>i.jsx("div",{className:"skeleton-block",style:{height:"80px"}},U))}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:B.map(({date:U,items:L})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:U}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:L.map((R,G)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(R,G,F,$)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[R.type==="Lab Order"&&!R.data.isEditing&&f&&i.jsx("button",{onClick:()=>f(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:q,children:i.jsx(Md,{size:14})}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>u&&u(R.data.id,R.data.editedTests,R.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:q,children:i.jsx(qd,{size:14})}),i.jsx("button",{onClick:()=>d&&d(R.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:q,children:i.jsx(Fr,{size:14})})]}),R.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[R.data.status==="pending"&&S&&(()=>{const ee=R.data.tests.reduce((te,oe)=>te+(Number(oe.price)||0),0).toFixed(2);return i.jsxs("button",{onClick:()=>S(R.data),className:"lab-action-button btn-bill",title:`Pay total of ${ee}`,children:["Pay (",ee,")"]})})(),R.data.status==="billed"&&k&&i.jsx("button",{onClick:()=>k(R.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),R.data.status==="collected"&&k&&i.jsx("button",{onClick:()=>k(R.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(R.data.status==="processing"||R.data.status==="report_ready"||R.data.status==="reported")&&E&&i.jsx("button",{onClick:()=>E(R.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(R.data.status==="report_ready"||R.data.status==="reported")&&k&&i.jsx("button",{onClick:()=>k(R.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(R.data.status==="completed"||R.data.status==="report_ready"||R.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T(R.data),className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&b&&i.jsx("button",{onClick:()=>b(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:q,children:i.jsx(Md,{size:14})}),R.type==="Pharmacy Order"&&R.data.prescriptionForUnavailableDrugs&&v&&i.jsx("button",{onClick:()=>v(R.data.prescriptionForUnavailableDrugs,`Prescription for Order ${R.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:q,children:i.jsx(Bs,{size:14})}),R.type==="Pharmacy Order"&&I&&i.jsx("button",{onClick:()=>I(R.data.id),className:"text-teal-600 hover:text-teal-800 p-1 rounded hover:bg-teal-100 focus:outline-none focus:ring-1 focus:ring-teal-400",title:"Mark as Recurring Medication",disabled:q,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[i.jsx("path",{d:"m17 2 4 4-4 4"}),i.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),i.jsx("path",{d:"m7 22-4-4 4-4"}),i.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]})}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&l&&i.jsx("button",{onClick:()=>l({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:q,children:i.jsx(Fr,{size:14})}),l&&["Complaint","Lab Order","Lab Report"].includes(R.type)&&i.jsx("button",{onClick:()=>l({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${R.type.toLowerCase()}`,disabled:q,children:i.jsx(Fr,{size:14})})]})]}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:R.data.editedStatus||R.data.status,onChange:ee=>g&&g(R.data.id,ee.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:q,children:z.map(ee=>i.jsx("option",{value:ee,children:ee.replace(/_/g," ")},ee))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),R.data.editedTests.map((ee,te)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:ee.id,onChange:oe=>{const K=D.find(V=>String(V.id)===oe.target.value);K&&(h&&h(R.data.id,te,"id",K.id),h&&h(R.data.id,te,"name",K.name),h&&h(R.data.id,te,"price",K.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:q,children:[i.jsx("option",{value:"",children:"Select Test"}),D.map(oe=>i.jsxs("option",{value:oe.id,children:[oe.name," (",oe.price,")"]},oe.id))]}),i.jsx("button",{onClick:()=>{const oe=R.data.editedTests.filter((K,V)=>V!==te);h&&h(R.data.id,-1,"remove",oe)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:q,children:i.jsx(Fr,{size:14})})]},te)),i.jsx("button",{onClick:()=>{h&&h(R.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:q,children:"Add Test"})]})]},`${R.type}-${R.originalDateString}-${G}`))})]},U))})]})},UQ="_modalOverlay_1yna4_3",qQ="_modalContent_1yna4_29",VQ="_modalHeader_1yna4_57",HQ="_modalTitle_1yna4_75",GQ="_modalCloseButton_1yna4_87",YQ="_modalBody_1yna4_115",WQ="_errorText_1yna4_129",QQ="_formGroup_1yna4_147",JQ="_inputField_1yna4_171",KQ="_searchResultsCard_1yna4_213",XQ="_searchResultsList_1yna4_241",ZQ="_searchResultItem_1yna4_253",eJ="_searchResultPrice_1yna4_289",tJ="_selectedTestsCard_1yna4_299",nJ="_selectedTestsHeader_1yna4_319",rJ="_noTestsMessage_1yna4_335",iJ="_selectedTestsList_1yna4_351",aJ="_selectedTestItem_1yna4_363",sJ="_selectedTestName_1yna4_387",oJ="_selectedTestPrice_1yna4_399",lJ="_removeTestButton_1yna4_411",cJ="_totalAmount_1yna4_437",uJ="_modalFooter_1yna4_455",dJ="_button_1yna4_473",fJ="_buttonPrimary_1yna4_491",hJ="_buttonSecondary_1yna4_513",Fn={modalOverlay:UQ,modalContent:qQ,modalHeader:VQ,modalTitle:HQ,modalCloseButton:GQ,modalBody:YQ,errorText:WQ,formGroup:QQ,inputField:JQ,searchResultsCard:KQ,searchResultsList:XQ,searchResultItem:ZQ,searchResultPrice:eJ,selectedTestsCard:tJ,selectedTestsHeader:nJ,noTestsMessage:rJ,selectedTestsList:iJ,selectedTestItem:aJ,selectedTestName:sJ,selectedTestPrice:oJ,removeTestButton:lJ,totalAmount:cJ,modalFooter:uJ,button:dJ,buttonPrimary:fJ,buttonSecondary:hJ},pJ=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[s,l]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!f){h([]);return}const I=f.toLowerCase();h(r.filter(D=>D.name.toLowerCase().includes(I)||D.description&&D.description.toLowerCase().includes(I)).slice(0,10))},[f,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(s.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const I={patient_id:t,tests:s.map(q=>({id:q.id,name:q.name,price:q.price}))},D=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!D.ok){const q=await D.json().catch(()=>({}));throw new Error(q.message||`Failed to create lab order: ${D.statusText}`)}await D.json(),a(t),n(),l([]),u("")}catch(I){b(`Lab Order Creation Error: ${I.message}`)}finally{S(!1)}},E=I=>{if(s.some(D=>D.id===I.id)){b(`${I.name} is already in the order.`),setTimeout(()=>b(null),3e3),u(""),h([]);return}l(D=>[...D,{...I}]),u(""),h([])},T=I=>{l(D=>D.filter(q=>q.id!==I))};return e?i.jsx("div",{className:Fn.modalOverlay,children:i.jsxs("div",{className:Fn.modalContent,children:[i.jsxs("div",{className:Fn.modalHeader,children:[i.jsx("h3",{className:Fn.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:Fn.modalCloseButton,children:i.jsx(Kn,{size:20})})]}),i.jsxs("div",{className:Fn.modalBody,children:[g&&i.jsx("div",{className:Fn.errorText,children:g}),i.jsxs("div",{className:Fn.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:f,onChange:I=>u(I.target.value),className:Fn.inputField}),f&&d.length>0&&i.jsx("div",{className:Fn.searchResultsCard,children:i.jsx("ul",{className:Fn.searchResultsList,children:d.map(I=>i.jsxs("li",{onClick:()=>E(I),className:Fn.searchResultItem,children:[i.jsx("span",{children:I.name}),i.jsxs("span",{className:Fn.searchResultPrice,children:["(",parseFloat(String(I.price)).toFixed(2),")"]})]},I.id))})})]}),i.jsxs("div",{className:Fn.selectedTestsCard,children:[i.jsx("h4",{className:Fn.selectedTestsHeader,children:"Selected Tests"}),s.length===0?i.jsx("p",{className:Fn.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:Fn.selectedTestsList,children:s.map(I=>i.jsxs("li",{className:Fn.selectedTestItem,children:[i.jsx("span",{className:Fn.selectedTestName,children:I.name}),i.jsxs("span",{className:Fn.selectedTestPrice,children:["",parseFloat(String(I.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>T(String(I.id)),className:Fn.removeTestButton,title:"Remove Test",children:i.jsx(Fr,{size:16})})]},I.id))})]}),s.length>0&&i.jsxs("div",{className:Fn.totalAmount,children:["Total: ",s.reduce((I,D)=>I+parseFloat(String(D.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:Fn.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Fn.button} ${Fn.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:s.length===0||v,className:`${Fn.button} ${Fn.buttonPrimary} ${s.length===0||v?Fn.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},mJ="_modalOverlay_7kwn4_3",gJ="_modalContent_7kwn4_29",yJ="_modalHeader_7kwn4_61",xJ="_modalTitle_7kwn4_79",bJ="_modalCloseButton_7kwn4_93",vJ="_modalBody_7kwn4_129",wJ="_errorText_7kwn4_141",SJ="_formGroup_7kwn4_161",NJ="_stickySearchHeader_7kwn4_173",CJ="_inputField_7kwn4_211",jJ="_searchResultsCard_7kwn4_253",_J="_searchResultsList_7kwn4_281",kJ="_searchResultItem_7kwn4_293",EJ="_searchResultPrice_7kwn4_323",TJ="_selectedTestsCard_7kwn4_335",AJ="_selectedTestsHeader_7kwn4_351",PJ="_noTestsMessage_7kwn4_375",DJ="_selectedTestsList_7kwn4_395",IJ="_selectedTestItem_7kwn4_413",MJ="_selectedTestHeader_7kwn4_441",RJ="_selectedTestName_7kwn4_457",OJ="_selectedTestInputs_7kwn4_469",LJ="_inputGroup_7kwn4_481",FJ="_quantityInput_7kwn4_503",$J="_removeTestButton_7kwn4_523",zJ="_textareaField_7kwn4_559",BJ="_modalFooter_7kwn4_573",UJ="_button_7kwn4_591",qJ="_buttonPrimary_7kwn4_615",VJ="_buttonSecondary_7kwn4_637",HJ="_buttonDisabled_7kwn4_659",rn={modalOverlay:mJ,modalContent:gJ,modalHeader:yJ,modalTitle:xJ,modalCloseButton:bJ,modalBody:vJ,errorText:wJ,formGroup:SJ,stickySearchHeader:NJ,inputField:CJ,searchResultsCard:jJ,searchResultsList:_J,searchResultItem:kJ,searchResultPrice:EJ,selectedTestsCard:TJ,selectedTestsHeader:AJ,noTestsMessage:PJ,selectedTestsList:DJ,selectedTestItem:IJ,selectedTestHeader:MJ,selectedTestName:RJ,selectedTestInputs:OJ,inputGroup:LJ,quantityInput:FJ,removeTestButton:$J,textareaField:zJ,modalFooter:BJ,button:UJ,buttonPrimary:qJ,buttonSecondary:VJ,buttonDisabled:HJ},GJ=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[s,l]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1),[k,E]=w.useState(""),T=w.useRef(null);w.useEffect(()=>{if(!f){h([]);return}const z=f.toLowerCase();h(r.filter(U=>U.name.toLowerCase().includes(z)).slice(0,10))},[f,r]),w.useEffect(()=>{T.current&&(T.current.style.height="auto",T.current.style.height=`${T.current.scrollHeight}px`)},[k]);const I=z=>{if(!z)return null;const U=z.match(/(?:\d+x)?(\d+)/);return U?parseInt(U[1],10):null},D=An.useMemo(()=>s.reduce((z,U)=>{const L=U.pack_price||0,R=U.loose_price||0,G=(U.pack_quantity||0)*L,ee=(U.loose_quantity||0)*R;return z+G+ee},0),[s]),q=async()=>{if(!t){b("Patient ID is missing.");return}if(s.length===0&&!k.trim()){b("Please select at least one medication or provide a prescription.");return}S(!0),b(null);try{const z={patient_id:t,items:s.map(L=>({drug_id:L.drug_id,name:L.name,pack_quantity:L.pack_quantity||0,loose_quantity:L.loose_quantity||0,price:L.price,pack_price:L.pack_price||0,loose_price:L.loose_price||0,total_price:(L.pack_quantity||0)*(L.pack_price||0)+(L.loose_quantity||0)*(L.loose_price||0),unit:L.unit})),prescription_for_unavailable_drugs:k,status:"pending",date:new Date().toISOString(),order_total:D},U=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!U.ok){const L=await U.json().catch(()=>({}));throw new Error(L.message||`Failed to create pharmacy order: ${U.statusText}`)}await U.json(),a(t),n(),l([]),u(""),E("")}catch(z){b(`Pharmacy Order Creation Error: ${z.message}`)}finally{S(!1)}},F=z=>{if(s.some(G=>G.drug_id===z.id)){b(`${z.name} is already in the order.`),setTimeout(()=>b(null),3e3),u(""),h([]);return}const U=I(z.unit),L=Number(z.price)||0,R=L/(U||1);l(G=>[...G,{drug_id:z.id,name:z.name,price:z.price,pack_price:L,loose_price:R,pack_quantity:1,loose_quantity:0,unit:z.unit}]),u(""),h([])},$=z=>{l(U=>U.filter(L=>L.drug_id!==z))},B=(z,U,L)=>{l(R=>R.map(G=>G.drug_id===z?{...G,[U]:L}:G))};return e?i.jsx("div",{className:rn.modalOverlay,children:i.jsxs("div",{className:rn.modalContent,children:[i.jsxs("div",{className:rn.modalHeader,children:[i.jsx("h3",{className:rn.modalTitle,children:"Create New Pharmacy Order"}),i.jsx("button",{onClick:n,className:rn.modalCloseButton,children:i.jsx(Kn,{size:20})})]}),i.jsxs("div",{className:rn.modalBody,children:[i.jsxs("div",{className:`${rn.formGroup} ${rn.stickySearchHeader}`,children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Medication"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:f,onChange:z=>u(z.target.value),className:rn.inputField}),f&&d.length>0&&i.jsx("div",{className:rn.searchResultsCard,children:i.jsx("ul",{className:rn.searchResultsList,children:d.map(z=>i.jsxs("li",{onClick:()=>F(z),className:rn.searchResultItem,children:[i.jsx("span",{children:z.name}),i.jsxs("span",{className:rn.searchResultPrice,children:["(",parseFloat(String(z.price)).toFixed(2),")"]})]},z.id))})})]}),g&&i.jsx("div",{className:rn.errorText,children:g}),i.jsxs("div",{className:rn.selectedTestsCard,children:[i.jsx("h4",{className:rn.selectedTestsHeader,children:"Selected Medications"}),s.length===0?i.jsx("p",{className:rn.noTestsMessage,children:"No medications added yet."}):i.jsx("ul",{className:rn.selectedTestsList,children:s.map(z=>i.jsxs("li",{className:rn.selectedTestItem,children:[i.jsxs("div",{className:rn.selectedTestHeader,children:[i.jsx("span",{className:rn.selectedTestName,children:z.name}),i.jsx("button",{type:"button",onClick:()=>$(z.drug_id),className:rn.removeTestButton,title:"Remove Medication",children:i.jsx(Fr,{size:16})})]}),i.jsxs("div",{className:rn.selectedTestInputs,children:[i.jsxs("div",{className:rn.inputGroup,children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:z.pack_quantity,onChange:U=>B(z.drug_id,"pack_quantity",parseInt(U.target.value)||0),className:rn.quantityInput})]}),i.jsxs("div",{className:rn.inputGroup,children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:z.loose_quantity,onChange:U=>B(z.drug_id,"loose_quantity",parseInt(U.target.value)||0),className:rn.quantityInput})]})]})]},z.drug_id))})]}),s.length>0&&i.jsxs("div",{className:rn.totalAmount,children:["Total: ",D.toFixed(2)]}),i.jsxs("div",{className:rn.formGroup,style:{marginTop:"20px"},children:[i.jsx("label",{htmlFor:"prescription-notes",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-notes",ref:T,rows:1,value:k,onChange:z=>E(z.target.value),placeholder:"Enter any additional notes or prescription details...",className:`${rn.inputField} ${rn.textareaField}`})]})]}),i.jsxs("div",{className:rn.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${rn.button} ${rn.buttonSecondary}`,children:" Cancel "}),i.jsx("button",{type:"button",onClick:q,disabled:s.length===0&&!k.trim()||v,className:`${rn.button} ${rn.buttonPrimary} ${s.length===0&&!k.trim()||v?rn.buttonDisabled:""}`,children:v?"Saving...":"Create Order"})]})]})}):null},Bx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},Zm=(e,n)=>{if(!e||!n||n.length===0)return;const t=Bx(e);let r=n.find(l=>Bx(l.name)===t);if(r)return r;let a=n.find(l=>Bx(l.name).includes(t));if(a)return a;let s=n.find(l=>t.includes(Bx(l.name)));if(s)return s},YJ=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's unit/pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this *separate* tool format (a single JSON object, NOT inside the array) only when you need clarification or missing information that prevents you from completing the assessment or required actions.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"] // Optional: Provide 2-5 choices
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,i_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",WJ="gemini-2.5-flash";async function QJ(){const e=R2();if(!e)return console.warn("No auth token found, using default Gemini API key."),i_;try{const t=(await yr.get("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).data.gemini_api_key;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Gemini API key:",n)}return console.warn("Clinic-specific Gemini API key not found or failed to fetch, using default."),i_}let Kv=null;async function JJ(){if(!Kv){const e=await QJ();Kv=new Jk({apiKey:e})}return Kv}async function KJ(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:s,patientGender:l,case_summary:f,case_summary_last_updated:u,clinic_ai_memory:d,clinic_ai_memory_last_updated:h,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,pharmacyInventory:k,labInventory:E}=e;let T=`Patient Complaint: ${t}`;if(f&&(T+=`

--- Case Summary (Provided by Doctor) ---
${f}`,u))try{const L=new Date(u).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});T+=`
(Last Updated: ${L})`}catch{console.warn(`Could not format case_summary_last_updated: ${u}`),T+=`
(Last Updated: ${u})`}if(a&&(T+=`

Patient Name: ${a}`),s!=null&&(T+=`
Patient Age: ${s}`),l&&(T+=`
Patient Gender: ${l}`),r)try{const L=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});T+=`

Current Interaction Time: ${L}`}catch{console.warn(`Could not format currentDateTime: ${r}`),T+=`

Current Interaction Time: ${r}`}if(d&&(T+=`

--- Clinic-wide AI Memory/Context ---
${d}`,h))try{const L=new Date(h).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});T+=`
(Last Updated: ${L})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${h}`),T+=`
(Last Updated: ${h})`}let I="";b&&Array.isArray(b)&&b.length>0&&(I=`

--- Lab History (Orders & Reports) ---
`,b.forEach(L=>{let R="Unknown Date";try{R=new Date(L.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${L.orderDate}`)}if(I+=`
Order #${L.serialNumber} Date: ${R} (Status: ${L.status})
`,I+=`Tests: ${L.tests.map(G=>G.name).join(", ")}
`,L.report){let G="Unknown Date";try{G=new Date(L.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${L.report.reportDate}`)}I+=`  -> Report Date: ${G}
`,L.report.tests&&Array.isArray(L.report.tests)?(I+=`     Findings:
`,L.report.tests.forEach(ee=>{I+=`       - Test: ${ee.testName}
`,ee.parameters&&Array.isArray(ee.parameters)&&ee.parameters.forEach(te=>{I+=`         - ${te.name}: ${te.value} (Normal: ${te.normal_range})
`})})):(I+=`     Findings: ${L.report.reportContent||"N/A"}
`,L.report.error&&(I+=`     Note: ${L.report.error}
`))}I+=`---
`}),T+=I);let D="";v&&Array.isArray(v)&&v.length>0&&(D=`

--- Recent Pharmacy Orders ---
`,v.forEach(L=>{let R="Unknown Date/Time";try{R=new Date(L.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${L.date}`)}D+=`
Order #${L.serialNumber} Date/Time: ${R} (Status: ${L.status})
`,D+=`Prescribed By: ${L.prescribedBy||"N/A"}
`,L.dispensedBy&&(D+=`Dispensed By: ${L.dispensedBy}
`),D+=`Medications:
`,L.medications.forEach(G=>{D+=`  - ${G.name} (Qty: ${G.quantity}`,G.tabletsPerDay&&(D+=`, ${G.tabletsPerDay}/day`),G.numberOfDays&&(D+=` for ${G.numberOfDays} days`),D+=`)
`}),L.prescriptionForUnavailableDrugs&&(D+=`  Prescription for Unavailable Drugs: ${L.prescriptionForUnavailableDrugs}
`),D+=`---
`}),T+=D);let q="";S&&Array.isArray(S)&&S.length>0&&(q=`

--- Past Complaints History ---
`,S.forEach(L=>{let R="Unknown Date/Time";try{R=new Date(L.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${L.createdAt}`)}q+=`
Date/Time: ${R}
Complaint: ${L.complaint||"N/A"}
---
`}),T+=q);let F="";k&&Array.isArray(k)&&k.length>0&&(F=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(L=>{F+=`- ${L.name} (Pack: ${L.unit??"N/A"}): ${L.quantity_in_stock??"N/A"}
`}),T+=F);let $="";E&&Array.isArray(E)&&E.length>0&&($=`

--- Available Lab Tests ---
`,E.forEach(L=>{$+=`- ${L.name} (Price: ${L.price??"N/A"})
`}),T+=$);const B=[{text:YJ}];g&&g.trim()!==""&&B.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const z=[{text:T}];if(n){const L=new FileReader,R=await new Promise((G,ee)=>{L.onloadend=()=>{typeof L.result=="string"?G(L.result.split(",")[1]):ee(new Error("Failed to read image file as base64."))},L.onerror=ee,L.readAsDataURL(n)});z.push({inlineData:{mimeType:n.type,data:R}})}const U=[];B.length>0&&U.push({role:"user",parts:B}),U.push({role:"user",parts:z});try{const L={model:WJ,contents:U,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},G=await(await JJ()).models.generateContentStream(L);let ee="";for await(const te of G)if(te&&typeof te.text=="function"){const oe=te.text;oe&&(ee+=oe)}else te&&te.candidates&&te.candidates[0]&&te.candidates[0].content&&te.candidates[0].content.parts&&te.candidates[0].content.parts[0]&&te.candidates[0].content.parts[0].text&&(ee+=te.candidates[0].content.parts[0].text);if(ee&&ee.trim()!=="")return ee.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(L){console.error("Error calling Gemini API:",L);let R="Failed to get suggestion from Gemini.";throw L.message&&(R=`Error processing Gemini request: ${L.message}`),new Error(R)}}const a_=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},XJ=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:s,userMessages:l,selectedImageFile:f,pendingLabOrders:u,labReports:d,pastComplaints:h,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,setCurrentComplaint:S,setAiResponse:k,setAiResponseText:E,setAiResponseJsonString:T,setShowAiJsonDetails:I,setIsLoadingAi:D,setAiError:q,setIsSubmittingAiOrder:F,setAiOrderSubmissionStatus:$,setIsSubmittingAiLabOrder:B,setAiLabOrderSubmissionStatus:z,setIsSubmittingAiComplaint:U,setAiComplaintSubmissionStatus:L,setIsUpdatingCaseSummary:R,setAiCaseSummaryUpdateStatus:G,setCaseSummary:ee,setCaseSummaryUpdatedAt:te,setIsUpdatingAiMemoryByAI:oe,setAiMemoryUpdateByAIStatus:K,setFollowUpQuestion:V,setFollowUpOptions:J,setError:ne,setIsSavingAiResponse:A,setSaveAiResponseError:ae,fetchPharmacyOrdersData:ce,fetchPendingLabOrdersData:M,fetchLabReportsData:de,fetchPastComplaintsData:Se,fetchPatientDetails:fe,setClinicSettings:we,setEditedAiMemory:ie,handleDeleteItem:_e},Ve)=>{let tt;const Ke=async(Me,ve,Ee,Pe=0)=>{let rt;const Ze=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(Rt=>{var kt;return(kt=ve.message)==null?void 0:kt.includes(Rt)});Ee&&Ze?rt=`AI Error: ${ve.message}

${Ee}`:(rt=`I encountered a frontend error while trying to execute the '${Me}' function. The error message is: "${ve.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(Me==="create_pharmacy_order"||Me==="edit_pharmacy_order")&&(rt+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),Ee&&(rt+=`

The original AI response that caused the error was:
\`\`\`
${Ee}
\`\`\``)),await tt(rt,Pe+1)},Oe=async(Me,ve)=>{$(null),z(null),L(null),G(null),K(null),V(null),J([]),ne(null);let Ee=!1,Pe=null;const rt=/```json\s*([\s\S]*?)\s*```/,lt=Me.match(rt);if(lt&&lt[1])Pe=lt[1];else{const Ze=Me.trim();if(Ze.startsWith("{")&&Ze.endsWith("}"))Pe=Ze;else if(Ze.startsWith("[")&&Ze.endsWith("]"))Pe=Ze;else throw new Error("AI response did not contain a recognized function call.")}if(Pe)try{const Ze=JSON.parse(Pe),Rt=Array.isArray(Ze)?Ze:[Ze],kt=[];let on=null;for(const se of Rt){if(se.action==="ask_followup_question"){on=se,Ee=!0;continue}se.action==="update_clinic_ai_memory"&&typeof se.memory_content=="string"?(Ee=!0,kt.push((async()=>{oe(!0),K("Processing AI mem...");try{if(!s)throw new Error("Clinic settings not loaded, cannot update AI memory.");const Q={...s,aiMemory:se.memory_content.trim(),admissionCharge:s.admissionCharge,perDayCharge:s.perDayCharge,otherCharges:s.otherCharges,clinicWideSystemPrompt:s.clinicWideSystemPrompt},re=await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Q)});if(!re.ok){const Ae=await re.json().catch(()=>({}));throw new Error(Ae.message||`AI-triggered clinic memory update failed: ${re.statusText}`)}const je=await re.json();we({admissionCharge:parseFloat(je.settings.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(je.settings.perDayCharge||0).toFixed(2),otherCharges:parseFloat(je.settings.otherCharges||0).toFixed(2),aiMemory:je.settings.aiMemory||"",aiMemoryUpdatedAt:je.settings.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:je.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:je.settings.clinicWideSystemPromptUpdatedAt||null}),ie(je.settings.aiMemory||""),K("AI mem updated!")}catch(Q){await Ke(se.action,Q,Me,ve)}finally{oe(!1)}})())):se.action==="create_pharmacy_order"&&(Array.isArray(se.items)||se.prescription_for_unavailable_drugs&&se.prescription_for_unavailable_drugs.trim()!=="")?(Ee=!0,kt.push((async()=>{F(!0),$("Processing order...");try{if(!n)throw new Error("Missing patient ID for pharmacy order.");const Q=[];let re=null;if(Array.isArray(se.items))for(const ot of se.items){const{pack_price:mt,loose_price:ft,total_price:Be,price:Xe,...Fe}=ot;let st;if(Fe.drug_id?st=b.find(Pi=>Pi.id===Fe.drug_id):Fe.name&&(st=Zm(Fe.name,b)),!st){re=`Drug "${Fe.name||Fe.drug_id||"Unknown"}" not found or no close match.`;break}let Je;const xt=Fe.tabletsPerDay;if(xt&&Number(xt)>0){const Pi=Number(xt);Number.isInteger(Pi)?Je=Pi:Je=null}else Je=1;const Vn=Number(Fe.numberOfDays)||1,$n=Number(Fe.pack_quantity)||0,_n=Number(Fe.loose_quantity)||0;if($n<=0&&_n<=0){re=`Invalid quantity for ${st.name}. Pack quantity or loose quantity must be greater than 0.`;break}const yn=st.unit,fn=a_(yn),_r=Number(st.price),Wr=_r,li=fn>0?_r/fn:0,ha=$n*Wr+_n*li;Q.push({drug_id:st.id?String(st.id):null,name:st.name,pack_quantity:$n,loose_quantity:_n,tabletsPerDay:Je,numberOfDays:Vn,price:_r,directions_to_use:Fe.directions_to_use||void 0,box_number:Fe.box_number||void 0,isLoose:Fe.isLoose||void 0,unit:yn||void 0,pack_price:parseFloat(Wr.toFixed(2)),loose_price:parseFloat(li.toFixed(2)),total_price:parseFloat(ha.toFixed(2))})}if(re)throw new Error(re);const je=Q.reduce((ot,mt)=>ot+mt.total_price,0),Ae={patient_id:n,items:Q.map(({drug_id:ot,name:mt,pack_quantity:ft,loose_quantity:Be,tabletsPerDay:Xe,numberOfDays:Fe,directions_to_use:st,box_number:Je,isLoose:xt,unit:Vn,pack_price:$n,loose_price:_n,total_price:yn})=>({drug_id:ot,name:mt,pack_quantity:ft,loose_quantity:Be,tabletsPerDay:Xe,numberOfDays:Fe,directions_to_use:st,box_number:Je,isLoose:xt,unit:Vn,pack_price:$n,loose_price:_n,total_price:yn})),prescription_for_unavailable_drugs:se.prescription_for_unavailable_drugs||null,order_total:parseFloat(je.toFixed(2))},Ue=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ae)});if(!Ue.ok){const ot=await Ue.json().catch(()=>({}));throw new Error(ot.message||`AI order creation failed: ${Ue.statusText}`)}$("Order created!"),n&&ce(n)}catch(Q){await Ke(se.action,Q,Me,ve)}finally{F(!1)}})())):se.action==="update_patient_details"?(Ee=!0,kt.push((async()=>{D(!0),ne(null);try{if(!n)throw new Error("Missing patient ID for updating details.");const Q={};let re=!1;if(se.name!==void 0&&typeof se.name=="string"&&(Q.name=se.name,re=!0),se.age!==void 0&&typeof se.age=="number"&&(Q.age=se.age,re=!0),se.gender!==void 0&&typeof se.gender=="string"){if(!["M","F","O",null,""].includes(se.gender))throw new Error(`Invalid gender specified: "${se.gender}". Use M, F, or O.`);Q.gender=se.gender===""?null:se.gender,re=!0}if(se.phone_number!==void 0&&(typeof se.phone_number=="string"||se.phone_number===null)&&(Q.phone_number=se.phone_number,re=!0),!re)throw new Error("No valid patient details provided for update.");const je=await ge(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!je.ok){const Ae=await je.json().catch(()=>({}));throw new Error(Ae.message||`AI patient update failed: ${je.statusText}`)}await je.json(),fe(n)}catch(Q){await Ke(se.action,Q,Me,ve)}finally{D(!1)}})())):se.action==="create_lab_order"&&Array.isArray(se.tests)&&se.tests.length>0?(Ee=!0,kt.push((async()=>{B(!0),z("Processing lab...");try{if(!n)throw new Error("Missing patient ID for lab order.");const Q=[];let re=null;for(const Ue of se.tests){let ot;if(Ue.id?ot=v.find(ft=>String(ft.id)===String(Ue.id)):Ue.name&&(ot=Zm(Ue.name,v)),!ot){re=`Lab test "${Ue.name||Ue.id||"Unknown"}" not found or no close match.`;break}const mt=typeof ot.price=="string"?parseFloat(ot.price):ot.price;Q.push({id:ot.id,name:ot.name,price:mt,description:ot.description,default_parameters:ot.default_parameters})}if(re)throw new Error(re);const je={patient_id:n,tests:Q.map(Ue=>({id:Ue.id,name:Ue.name,price:Ue.price}))},Ae=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(je)});if(!Ae.ok){const Ue=await Ae.json().catch(()=>({}));throw new Error(Ue.message||`AI lab order creation failed: ${Ae.statusText}`)}await Ae.json(),z("Success: Lab order created!"),n&&M(n)}catch(Q){await Ke(se.action,Q,Me,ve)}finally{B(!1)}})())):se.action==="edit_pharmacy_order"?(Ee=!0,kt.push((async()=>{F(!0),$("Processing pharmacy order edit...");try{const Q=se.serialNumber;let re;if(Q?re=[...g].sort((Be,Xe)=>{const Fe=new Date(Be.date).getTime(),st=new Date(Xe.date).getTime();return Fe-st})[Q-1]:re=g.sort((ft,Be)=>new Date(ft.date).getTime()-new Date(Be.date).getTime()).find(ft=>ft.status==="pending"),!re)throw new Error(`Pharmacy order with serial number ${Q} not found, or no pending order to edit.`);const je=re.id,Ae=se.items,Ue=se.items_to_remove,ot=se.status,mt=se.prescription_for_unavailable_drugs;if((!Ae||Array.isArray(Ae)&&Ae.length===0)&&!Ue&&!ot&&(!mt||mt.trim()===""))throw new Error("No items, items to remove, status, or unavailable drugs prescription provided for pharmacy order edit.");if(ot==="cancelled")await _e({type:"Pharmacy Order",data:re}),$("Success: Pharmacy order cancelled and deleted!");else{let ft=[...re.medications];if(Array.isArray(Ue)&&Ue.length>0&&(ft=ft.filter(Je=>{const xt=Je.name.toLowerCase().replace(/\s+/g," ").trim();return!Ue.some(Vn=>{if(Vn.drug_id&&String(Je.drug_id)===String(Vn.drug_id))return!0;if(Vn.name){const $n=Vn.name.toLowerCase().replace(/\s+/g," ").trim();return xt===$n}return!1})})),Array.isArray(Ae)&&Ae.length>0)for(const Je of Ae){const{pack_price:xt,loose_price:Vn,total_price:$n,price:_n,...yn}=Je;let fn;if(yn.drug_id?fn=b.find(zn=>zn.id===String(yn.drug_id)):yn.name&&(fn=Zm(yn.name,b)),!fn)throw new Error(`Drug "${yn.name||yn.drug_id||"Unknown"}" not found or no close match for update.`);let _r;const Wr=yn.tabletsPerDay;if(Wr&&Number(Wr)>0){const zn=Number(Wr);Number.isInteger(zn)?_r=zn:_r=null}else _r=1;const li=Number(yn.numberOfDays)||1,ha=Number(yn.pack_quantity)||0,Pi=Number(yn.loose_quantity)||0,ir=ft.findIndex(zn=>zn.drug_id&&zn.drug_id===(fn==null?void 0:fn.id)||zn.name.toLowerCase()===(fn==null?void 0:fn.name.toLowerCase()));if(ha<=0&&Pi<=0){ir!==-1&&ft.splice(ir,1);continue}const Zn={drug_id:fn.id?String(fn.id):null,name:fn.name,pack_quantity:ha,loose_quantity:Pi,tabletsPerDay:_r,numberOfDays:li,price:fn.price,directions_to_use:yn.directions_to_use||void 0,box_number:yn.box_number||void 0,isLoose:yn.isLoose||void 0,unit:fn.unit||void 0};ir!==-1?ft[ir]={...ft[ir],...Zn}:ft.push(Zn)}const Be=ft.map(Je=>{const xt=b.find(_r=>_r.id===Je.drug_id),Vn=xt?a_(xt.unit):1,$n=Number(xt==null?void 0:xt.price)||0,_n=$n,yn=Vn>0?$n/Vn:0,fn=(Je.pack_quantity||0)*_n+(Je.loose_quantity||0)*yn;return{...Je,pack_price:parseFloat(_n.toFixed(2)),loose_price:parseFloat(yn.toFixed(2)),total_price:parseFloat(fn.toFixed(2))}}),Xe=Be.reduce((Je,xt)=>Je+xt.total_price,0),Fe={};if(Be.length>0?Fe.items=Be.map(({drug_id:Je,name:xt,pack_quantity:Vn,loose_quantity:$n,tabletsPerDay:_n,numberOfDays:yn,directions_to_use:fn,box_number:_r,isLoose:Wr,unit:li,pack_price:ha,loose_price:Pi,total_price:ir})=>({drug_id:Je,name:xt,pack_quantity:Vn,loose_quantity:$n,tabletsPerDay:_n===null?null:_n,numberOfDays:yn,directions_to_use:fn,box_number:_r,isLoose:Wr,unit:li,pack_price:ha,loose_price:Pi,total_price:ir})):Ae&&Ae.length>0&&(Fe.items=[]),mt!==void 0&&(Fe.prescription_for_unavailable_drugs=mt),Fe.order_total=parseFloat(Xe.toFixed(2)),ot){if(!["pending","billed","dispensed","cancelled"].includes(ot))throw new Error(`Invalid status for pharmacy order: ${ot}.`);Fe.status=ot}const st=await ge(`/api/pharmacy-orders/${je}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});if(!st.ok){const Je=await st.json().catch(()=>({}));throw new Error(Je.message||`AI pharmacy order edit failed: ${st.statusText}`)}$("Success: Pharmacy order updated!"),n&&ce(n)}}catch(Q){await Ke(se.action,Q,Me,ve)}finally{F(!1)}})())):se.action==="edit_lab_order"?(Ee=!0,kt.push((async()=>{B(!0),z("Processing lab order edit...");try{const Q=u.sort((ot,mt)=>new Date(mt.createdAt).getTime()-new Date(ot.createdAt).getTime()).find(ot=>ot.status==="pending");if(!Q)throw new Error("No pending lab orders found to edit.");const re=Q.id,je=se.tests,Ae=se.items_to_remove,Ue=se.status;if(!je&&!Ae&&!Ue)throw new Error("No tests, items to remove, or status provided for lab order edit.");if(Ue==="cancelled"){if(Q.report)throw new Error("Cannot delete lab order with an associated report. Please delete the report first.");await _e({type:"Lab Order",data:Q}),z("Success: Lab order cancelled and deleted!")}else{let ot=[...Q.tests];if(Array.isArray(Ae)&&Ae.length>0&&(ot=ot.filter(Be=>!Ae.some(Xe=>!!(Xe.id&&String(Be.id)===String(Xe.id)||Xe.name&&Be.name.toLowerCase()===Xe.name.toLowerCase())))),Array.isArray(je)&&je.length>0)for(const Be of je){let Xe;if(Be.id?Xe=v.find(xt=>String(xt.id)===String(Be.id)):Be.name&&(Xe=Zm(Be.name,v)),!Xe)throw new Error(`Lab test "${Be.name||Be.id||"Unknown"}" not found or no close match for update.`);const Fe=typeof Xe.price=="string"?parseFloat(Xe.price):Xe.price,st=ot.findIndex(xt=>xt.id&&String(xt.id)===String(Xe==null?void 0:Xe.id)||xt.name.toLowerCase()===(Xe==null?void 0:Xe.name.toLowerCase())),Je={id:Xe.id,name:Xe.name,price:Fe};st!==-1?ot[st]={...ot[st],...Je}:ot.push(Je)}const mt={};if(ot.length>0?mt.tests=ot:je&&je.length>0&&(mt.tests=[]),Ue){if(!["pending","billed","collected","processing","report_ready","completed","cancelled","reported"].includes(Ue))throw new Error(`Invalid status for lab order: ${Ue}.`);mt.status=Ue}const ft=await ge(`/api/lab/orders/${re}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(mt)});if(!ft.ok){const Be=await ft.json().catch(()=>({}));throw new Error(Be.message||`AI lab order edit failed: ${ft.statusText}`)}z("Success: Lab order updated!"),n&&(M(n),de(n))}}catch(Q){await Ke(se.action,Q,Me,ve)}finally{B(!1)}})())):se.action==="add_complaint_history"&&se.complaint?(Ee=!0,kt.push((async()=>{U(!0),L("Processing Hx...");try{if(!e)throw new Error("Missing Record ID for complaint history.");if(!se.complaint||typeof se.complaint!="string")throw new Error("Invalid AI complaint text.");const Q={complaint:se.complaint.trim()},re=await ge(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!re.ok){const je=await re.json().catch(()=>({}));throw new Error(je.message||`AI complaint add failed: ${re.statusText}`)}S(Q.complaint),L("Hx updated!"),n&&Se(n)}catch(Q){await Ke(se.action,Q,Me,ve)}finally{U(!1)}})())):se.action==="update_case_summary"&&se.summary?(Ee=!0,kt.push((async()=>{R(!0),G("Processing summary...");try{if(!e)throw new Error("Missing Record ID for case summary update.");if(typeof se.summary!="string")throw new Error("Invalid AI case summary text.");const Q={case_summary:se.summary.trim()},re=await ge(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!re.ok){const Ae=await re.json().catch(()=>({}));throw new Error(Ae.message||`AI case summary update failed: ${re.statusText}`)}const je=await re.json();ee(je.case_summary),te(je.updatedAt),G("Summary updated!")}catch(Q){await Ke(se.action,Q,Me,ve)}finally{R(!1)}})())):se.action&&console.warn(`Unrecognized AI action: ${se.action}`)}if(await Promise.allSettled(kt),on)typeof on.question=="string"?(V(on.question),J(Array.isArray(on.options)?on.options:[])):console.warn("Invalid 'ask_followup_question' format.");else if(!Ee)throw new Error("AI response did not result in a recognized or performed function call.")}catch(Ze){await Ke("parse_json_actions",Ze,Me,ve)}else throw new Error("AI response did not contain a recognized function call.")};tt=async(Me,ve=0)=>{if(ve>1){q("AI call failed after multiple retries. Please try a different prompt."),D(!1);return}D(!0),q(null);let Ee;const rt=[...l,Me].join(`

`);try{const lt=new Map;(u??[]).forEach(re=>{lt.set(re.id,{...re})}),(d??[]).forEach(re=>{if(!lt.has(re.id))lt.set(re.id,{id:re.id,patient_id:re.patient_id,tests:re.tests,status:re.status,createdAt:re.createdAt,report:re});else{const je=lt.get(re.id);je&&(je.report=re,je.status=re.status)}});const Ze=Array.from(lt.values());Ze.sort((re,je)=>new Date(je.createdAt).getTime()-new Date(re.createdAt).getTime());const Rt=Ze.map((re,je)=>{let Ae=null;if(re.report)try{const Ue=typeof re.report.report_content=="string"?re.report.report_content:JSON.stringify(re.report.report_content||{}),ot=JSON.parse(Ue||"{}"),mt=(re.report.tests||[]).map(ft=>{const Be=ot[ft.id]||{},Xe=Fe=>({name:Fe.name,value:Be[Fe.name]!==void 0?String(Be[Fe.name]):String(Fe.defaultValue),normal_range:Fe.normal_range||"N/A"});return{testId:ft.id,testName:ft.name,parameters:(ft.default_parameters||[]).map(Xe)}});Ae={reportId:re.report.reportId,reportDate:re.report.report_date,tests:mt}}catch{Ae={reportId:re.report.reportId,reportDate:re.report.report_date,reportContent:typeof re.report.report_content=="string"?re.report.report_content:JSON.stringify(re.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:Ze.length-je,orderId:re.id,orderDate:isNaN(new Date(re.createdAt).getTime())?re.createdAt:new Date(re.createdAt).toISOString(),tests:re.tests.map(Ue=>({id:Ue.id,name:Ue.name,price:Ue.price})),status:re.status,report:Ae}}),kt=h.map(re=>{try{return{...re,createdAt:isNaN(new Date(re.createdAt).getTime())?re.createdAt:new Date(re.createdAt).toISOString()}}catch{return re}}),se=[...g].sort((re,je)=>{const Ae=new Date(re.date).getTime(),Ue=new Date(je.date).getTime();return Ae-Ue}).map((re,je)=>{try{return{serialNumber:je+1,...re,date:re.date&&!isNaN(new Date(re.date).getTime())?new Date(re.date).toISOString():re.date}}catch{return{serialNumber:je+1,...re}}}),Q={query:rt,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(s==null?void 0:s.aiMemory)||"",clinic_ai_memory_last_updated:s!=null&&s.aiMemoryUpdatedAt?new Date(s.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(s==null?void 0:s.clinicWideSystemPrompt)||"",labHistory:Rt,pharmacyOrders:se,pastComplaints:kt,pharmacyInventory:b,labInventory:v};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(Q,null,2)),Ee=await KJ(Q,f),Ee){k(Ee);const re=/```json\s*([\s\S]*?)\s*```/,je=Ee.match(re);if(je&&je[1])E(Ee.replace(re,"").trim()),T(je[1].trim());else{const Ae=Ee.trim();if(Ae.startsWith("{")&&Ae.endsWith("}"))try{JSON.parse(Ae),E(""),T(Ae)}catch{E(Ae),T(null)}else if(Ae.startsWith("[")&&Ae.endsWith("]"))try{JSON.parse(Ae),E(""),T(Ae)}catch{E(Ae),T(null)}else E(Ae),T(null)}I(!1),n&&Ee&&await xe(n,Ee),await Oe(Ee,ve),S("")}else throw new Error("Invalid AI response format.")}catch(lt){await Ke("call_generative_api",lt,Ee,ve)}finally{D(!1)}};const xe=async(Me,ve)=>{A(!0),ae(null);try{const Ee={ai_response:ve},Pe=await ge(`/api/patients/${Me}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)});if(!Pe.ok){const rt=await Pe.json().catch(()=>({}));throw new Error(rt.message||`Failed to save AI response to patient: ${Pe.statusText}`)}}catch(Ee){ae(`AI Response Save Error: ${Ee.message}`)}finally{A(!1)}};return w.useImperativeHandle(Ve,()=>({callGenerativeApi:tt})),null}),ZJ={};function gS(e,n){const t=ZJ,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return LT(e,r,a)}function LT(e,n,t){if(eK(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return s_(e.children,n,t)}return Array.isArray(e)?s_(e,n,t):""}function s_(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=LT(e[a],n,t);return r.join("")}function eK(e){return!!(e&&typeof e=="object")}const o_=document.createElement("i");function yS(e){const n="&"+e+";";o_.innerHTML=n;const t=o_.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Ho(e,n,t,r){const a=e.length;let s=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);s<r.length;)l=r.slice(s,s+1e4),l.unshift(n,0),e.splice(...l),s+=1e4,n+=1e4}function ls(e,n){return e.length>0?(Ho(e,e.length,0,n),e):n}const l_={}.hasOwnProperty;function tK(e){const n={};let t=-1;for(;++t<e.length;)nK(n,e[t]);return n}function nK(e,n){let t;for(t in n){const a=(l_.call(e,t)?e[t]:void 0)||(e[t]={}),s=n[t];let l;if(s)for(l in s){l_.call(a,l)||(a[l]=[]);const f=s[l];rK(a[l],Array.isArray(f)?f:f?[f]:[])}}}function rK(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Ho(e,0,0,r)}function FT(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Rh(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Bo=au(/[A-Za-z]/),La=au(/[\dA-Za-z]/),iK=au(/[#-'*+\--9=?A-Z^-~]/);function tw(e){return e!==null&&(e<32||e===127)}const nw=au(/\d/),aK=au(/[\dA-Fa-f]/),sK=au(/[!-/:-@[-`{-~]/);function Mt(e){return e!==null&&e<-2}function la(e){return e!==null&&(e<0||e===32)}function jn(e){return e===-2||e===-1||e===32}const oK=au(new RegExp("\\p{P}|\\p{S}","u")),lK=au(/\s/);function au(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function ep(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const s=e.charCodeAt(t);let l="";if(s===37&&La(e.charCodeAt(t+1))&&La(e.charCodeAt(t+2)))a=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(l=String.fromCharCode(s));else if(s>55295&&s<57344){const f=e.charCodeAt(t+1);s<56320&&f>56319&&f<57344?(l=String.fromCharCode(s,f),a=1):l=""}else l=String.fromCharCode(s);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function Xn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let s=0;return l;function l(u){return jn(u)?(e.enter(t),f(u)):n(u)}function f(u){return jn(u)&&s++<a?(e.consume(u),f):(e.exit(t),n(u))}}const cK={tokenize:uK};function uK(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Xn(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),s(f)}function s(f){const u=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=u),t=u,l(f)}function l(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return Mt(f)?(e.consume(f),e.exit("chunkText"),s):(e.consume(f),l)}}const dK={tokenize:fK},c_={tokenize:hK};function fK(e){const n=this,t=[];let r=0,a,s,l;return f;function f(D){if(r<t.length){const q=t[r];return n.containerState=q[1],e.attempt(q[0].continuation,u,d)(D)}return d(D)}function u(D){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&I();const q=n.events.length;let F=q,$;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){$=n.events[F][1].end;break}T(r);let B=q;for(;B<n.events.length;)n.events[B][1].end={...$},B++;return Ho(n.events,F+1,0,n.events.slice(q)),n.events.length=B,d(D)}return f(D)}function d(D){if(r===t.length){if(!a)return b(D);if(a.currentConstruct&&a.currentConstruct.concrete)return S(D);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(c_,h,g)(D)}function h(D){return a&&I(),T(r),b(D)}function g(D){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(D)}function b(D){return n.containerState={},e.attempt(c_,v,S)(D)}function v(D){return r++,t.push([n.currentConstruct,n.containerState]),b(D)}function S(D){if(D===null){a&&I(),T(0),e.consume(D);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:s}),k(D)}function k(D){if(D===null){E(e.exit("chunkFlow"),!0),T(0),e.consume(D);return}return Mt(D)?(e.consume(D),E(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(D),k)}function E(D,q){const F=n.sliceStream(D);if(q&&F.push(null),D.previous=s,s&&(s.next=D),s=D,a.defineSkip(D.start),a.write(F),n.parser.lazy[D.start.line]){let $=a.events.length;for(;$--;)if(a.events[$][1].start.offset<l&&(!a.events[$][1].end||a.events[$][1].end.offset>l))return;const B=n.events.length;let z=B,U,L;for(;z--;)if(n.events[z][0]==="exit"&&n.events[z][1].type==="chunkFlow"){if(U){L=n.events[z][1].end;break}U=!0}for(T(r),$=B;$<n.events.length;)n.events[$][1].end={...L},$++;Ho(n.events,z+1,0,n.events.slice(B)),n.events.length=$}}function T(D){let q=t.length;for(;q-- >D;){const F=t[q];n.containerState=F[1],F[0].exit.call(n,e)}t.length=D}function I(){a.write([null]),s=void 0,a=void 0,n.containerState._closeFlow=void 0}}function hK(e,n,t){return Xn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Ib(e){if(e===null||la(e)||lK(e))return 1;if(oK(e))return 2}function xS(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const s=e[a].resolveAll;s&&!r.includes(s)&&(n=s(n,t),r.push(s))}return n}const rw={name:"attention",resolveAll:pK,tokenize:mK};function pK(e,n){let t=-1,r,a,s,l,f,u,d,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;u=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};u_(g,-u),u_(b,u),l={type:u>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:u>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},s={type:u>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:u>1?"strong":"emphasis",start:{...l.start},end:{...f.end}},e[r][1].end={...l.start},e[t][1].start={...f.end},d=[],e[r][1].end.offset-e[r][1].start.offset&&(d=ls(d,[["enter",e[r][1],n],["exit",e[r][1],n]])),d=ls(d,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",s,n]]),d=ls(d,xS(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),d=ls(d,[["exit",s,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,d=ls(d,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,Ho(e,r-1,t-r+3,d),t=r+d.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function mK(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Ib(r);let s;return l;function l(u){return s=u,e.enter("attentionSequence"),f(u)}function f(u){if(u===s)return e.consume(u),f;const d=e.exit("attentionSequence"),h=Ib(u),g=!h||h===2&&a||t.includes(u),b=!a||a===2&&h||t.includes(r);return d._open=!!(s===42?g:g&&(a||!b)),d._close=!!(s===42?b:b&&(h||!g)),n(u)}}function u_(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const gK={name:"autolink",tokenize:yK};function yK(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s}function s(v){return Bo(v)?(e.consume(v),l):v===64?t(v):d(v)}function l(v){return v===43||v===45||v===46||La(v)?(r=1,f(v)):d(v)}function f(v){return v===58?(e.consume(v),r=0,u):(v===43||v===45||v===46||La(v))&&r++<32?(e.consume(v),f):(r=0,d(v))}function u(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||tw(v)?t(v):(e.consume(v),u)}function d(v){return v===64?(e.consume(v),h):iK(v)?(e.consume(v),d):t(v)}function h(v){return La(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||La(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const u0={partial:!0,tokenize:xK};function xK(e,n,t){return r;function r(s){return jn(s)?Xn(e,a,"linePrefix")(s):a(s)}function a(s){return s===null||Mt(s)?n(s):t(s)}}const $T={continuation:{tokenize:vK},exit:wK,name:"blockQuote",tokenize:bK};function bK(e,n,t){const r=this;return a;function a(l){if(l===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),s}return t(l)}function s(l){return jn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function vK(e,n,t){const r=this;return a;function a(l){return jn(l)?Xn(e,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):s(l)}function s(l){return e.attempt($T,n,t)(l)}}function wK(e){e.exit("blockQuote")}const zT={name:"characterEscape",tokenize:SK};function SK(e,n,t){return r;function r(s){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(s),e.exit("escapeMarker"),a}function a(s){return sK(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(s)}}const BT={name:"characterReference",tokenize:NK};function NK(e,n,t){const r=this;let a=0,s,l;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),u}function u(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),s=31,l=La,h(g))}function d(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,l=aK,h):(e.enter("characterReferenceValue"),s=7,l=nw,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===La&&!yS(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<s?(e.consume(g),h):t(g)}}const d_={partial:!0,tokenize:jK},f_={concrete:!0,name:"codeFenced",tokenize:CK};function CK(e,n,t){const r=this,a={partial:!0,tokenize:F};let s=0,l=0,f;return u;function u($){return d($)}function d($){const B=r.events[r.events.length-1];return s=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,f=$,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h($)}function h($){return $===f?(l++,e.consume($),h):l<3?t($):(e.exit("codeFencedFenceSequence"),jn($)?Xn(e,g,"whitespace")($):g($))}function g($){return $===null||Mt($)?(e.exit("codeFencedFence"),r.interrupt?n($):e.check(d_,k,q)($)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b($))}function b($){return $===null||Mt($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g($)):jn($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Xn(e,v,"whitespace")($)):$===96&&$===f?t($):(e.consume($),b)}function v($){return $===null||Mt($)?g($):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S($))}function S($){return $===null||Mt($)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g($)):$===96&&$===f?t($):(e.consume($),S)}function k($){return e.attempt(a,q,E)($)}function E($){return e.enter("lineEnding"),e.consume($),e.exit("lineEnding"),T}function T($){return s>0&&jn($)?Xn(e,I,"linePrefix",s+1)($):I($)}function I($){return $===null||Mt($)?e.check(d_,k,q)($):(e.enter("codeFlowValue"),D($))}function D($){return $===null||Mt($)?(e.exit("codeFlowValue"),I($)):(e.consume($),D)}function q($){return e.exit("codeFenced"),n($)}function F($,B,z){let U=0;return L;function L(oe){return $.enter("lineEnding"),$.consume(oe),$.exit("lineEnding"),R}function R(oe){return $.enter("codeFencedFence"),jn(oe)?Xn($,G,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(oe):G(oe)}function G(oe){return oe===f?($.enter("codeFencedFenceSequence"),ee(oe)):z(oe)}function ee(oe){return oe===f?(U++,$.consume(oe),ee):U>=l?($.exit("codeFencedFenceSequence"),jn(oe)?Xn($,te,"whitespace")(oe):te(oe)):z(oe)}function te(oe){return oe===null||Mt(oe)?($.exit("codeFencedFence"),B(oe)):z(oe)}}}function jK(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s)}function s(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const Xv={name:"codeIndented",tokenize:kK},_K={partial:!0,tokenize:EK};function kK(e,n,t){const r=this;return a;function a(d){return e.enter("codeIndented"),Xn(e,s,"linePrefix",5)(d)}function s(d){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(d):t(d)}function l(d){return d===null?u(d):Mt(d)?e.attempt(_K,l,u)(d):(e.enter("codeFlowValue"),f(d))}function f(d){return d===null||Mt(d)?(e.exit("codeFlowValue"),l(d)):(e.consume(d),f)}function u(d){return e.exit("codeIndented"),n(d)}}function EK(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Mt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):Xn(e,s,"linePrefix",5)(l)}function s(l){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(l):Mt(l)?a(l):t(l)}}const TK={name:"codeText",previous:PK,resolve:AK,tokenize:DK};function AK(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function PK(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function DK(e,n,t){let r=0,a,s;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),u(g))}function u(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),u):g===96?(s=e.enter("codeTextSequence"),a=0,h(g)):Mt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),u):(e.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||Mt(g)?(e.exit("codeTextData"),u(g)):(e.consume(g),d)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(s.type="codeTextData",d(g))}}class IK{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const s=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Ym(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Ym(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Ym(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Ym(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Ym(this.left,t.reverse())}}}function Ym(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function UT(e){const n={};let t=-1,r,a,s,l,f,u,d;const h=new IK(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,s=0,s<u.length&&u[s][1].type==="lineEndingBlank"&&(s+=2),s<u.length&&u[s][1].type==="content"))for(;++s<u.length&&u[s][1].type!=="content";)u[s][1].type==="chunkText"&&(u[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,MK(h,t)),t=n[t],d=!0);else if(r[1]._container){for(s=t,a=void 0;s--;)if(l=h.get(s),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=s);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return Ho(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!d}function MK(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const s=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const f=l.events,u=[],d={};let h,g,b=-1,v=t,S=0,k=0;const E=[k];for(;v;){for(;e.get(++a)[1]!==v;);s.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(k=b+1,E.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):E.pop(),b=E.length;b--;){const T=f.slice(E[b],E[b+1]),I=s.pop();u.push([I,I+T.length-1]),e.splice(I,2,T)}for(u.reverse(),b=-1;++b<u.length;)d[S+u[b][0]]=S+u[b][1],S+=u[b][1]-u[b][0]-1;return d}const RK={resolve:LK,tokenize:FK},OK={partial:!0,tokenize:$K};function LK(e){return UT(e),e}function FK(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?s(f):Mt(f)?e.check(OK,l,s)(f):(e.consume(f),a)}function s(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function l(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function $K(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Xn(e,s,"linePrefix")}function s(l){if(l===null||Mt(l))return t(l);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function qT(e,n,t,r,a,s,l,f,u){const d=u||Number.POSITIVE_INFINITY;let h=0;return g;function g(T){return T===60?(e.enter(r),e.enter(a),e.enter(s),e.consume(T),e.exit(s),b):T===null||T===32||T===41||tw(T)?t(T):(e.enter(r),e.enter(l),e.enter(f),e.enter("chunkString",{contentType:"string"}),k(T))}function b(T){return T===62?(e.enter(s),e.consume(T),e.exit(s),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(T))}function v(T){return T===62?(e.exit("chunkString"),e.exit(f),b(T)):T===null||T===60||Mt(T)?t(T):(e.consume(T),T===92?S:v)}function S(T){return T===60||T===62||T===92?(e.consume(T),v):v(T)}function k(T){return!h&&(T===null||T===41||la(T))?(e.exit("chunkString"),e.exit(f),e.exit(l),e.exit(r),n(T)):h<d&&T===40?(e.consume(T),h++,k):T===41?(e.consume(T),h--,k):T===null||T===32||T===40||tw(T)?t(T):(e.consume(T),T===92?E:k)}function E(T){return T===40||T===41||T===92?(e.consume(T),k):k(T)}}function VT(e,n,t,r,a,s){const l=this;let f=0,u;return d;function d(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(s),h}function h(v){return f>999||v===null||v===91||v===93&&!u||v===94&&!f&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(s),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Mt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Mt(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),u||(u=!jn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function HT(e,n,t,r,a,s){let l;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,u):t(b)}function u(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(s),d(b))}function d(b){return b===l?(e.exit(s),u(l)):b===null?t(b):Mt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),Xn(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||Mt(b)?(e.exit("chunkString"),d(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function rg(e,n){let t;return r;function r(a){return Mt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):jn(a)?Xn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const zK={name:"definition",tokenize:UK},BK={partial:!0,tokenize:qK};function UK(e,n,t){const r=this;let a;return s;function s(v){return e.enter("definition"),l(v)}function l(v){return VT.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=Rh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),u):t(v)}function u(v){return la(v)?rg(e,d)(v):d(v)}function d(v){return qT(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(BK,g,g)(v)}function g(v){return jn(v)?Xn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Mt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function qK(e,n,t){return r;function r(f){return la(f)?rg(e,a)(f):t(f)}function a(f){return HT(e,s,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function s(f){return jn(f)?Xn(e,l,"whitespace")(f):l(f)}function l(f){return f===null||Mt(f)?n(f):t(f)}}const VK={name:"hardBreakEscape",tokenize:HK};function HK(e,n,t){return r;function r(s){return e.enter("hardBreakEscape"),e.consume(s),a}function a(s){return Mt(s)?(e.exit("hardBreakEscape"),n(s)):t(s)}}const GK={name:"headingAtx",resolve:YK,tokenize:WK};function YK(e,n){let t=e.length-2,r=3,a,s;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},s={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Ho(e,r,t-r+1,[["enter",a,n],["enter",s,n],["exit",s,n],["exit",a,n]])),e}function WK(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),s(h)}function s(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||la(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),u(h)):h===null||Mt(h)?(e.exit("atxHeading"),n(h)):jn(h)?Xn(e,f,"whitespace")(h):(e.enter("atxHeadingText"),d(h))}function u(h){return h===35?(e.consume(h),u):(e.exit("atxHeadingSequence"),f(h))}function d(h){return h===null||h===35||la(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),d)}}const QK=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],h_=["pre","script","style","textarea"],JK={concrete:!0,name:"htmlFlow",resolveTo:ZK,tokenize:eX},KK={partial:!0,tokenize:nX},XK={partial:!0,tokenize:tX};function ZK(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function eX(e,n,t){const r=this;let a,s,l,f,u;return d;function d(M){return h(M)}function h(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),s=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:A):Bo(M)?(e.consume(M),l=String.fromCharCode(M),E):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,f=0,S):Bo(M)?(e.consume(M),a=4,r.interrupt?n:A):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:A):t(M)}function S(M){const de="CDATA[";return M===de.charCodeAt(f++)?(e.consume(M),f===de.length?r.interrupt?n:G:S):t(M)}function k(M){return Bo(M)?(e.consume(M),l=String.fromCharCode(M),E):t(M)}function E(M){if(M===null||M===47||M===62||la(M)){const de=M===47,Se=l.toLowerCase();return!de&&!s&&h_.includes(Se)?(a=1,r.interrupt?n(M):G(M)):QK.includes(l.toLowerCase())?(a=6,de?(e.consume(M),T):r.interrupt?n(M):G(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):s?I(M):D(M))}return M===45||La(M)?(e.consume(M),l+=String.fromCharCode(M),E):t(M)}function T(M){return M===62?(e.consume(M),r.interrupt?n:G):t(M)}function I(M){return jn(M)?(e.consume(M),I):L(M)}function D(M){return M===47?(e.consume(M),L):M===58||M===95||Bo(M)?(e.consume(M),q):jn(M)?(e.consume(M),D):L(M)}function q(M){return M===45||M===46||M===58||M===95||La(M)?(e.consume(M),q):F(M)}function F(M){return M===61?(e.consume(M),$):jn(M)?(e.consume(M),F):D(M)}function $(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),u=M,B):jn(M)?(e.consume(M),$):z(M)}function B(M){return M===u?(e.consume(M),u=null,U):M===null||Mt(M)?t(M):(e.consume(M),B)}function z(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||la(M)?F(M):(e.consume(M),z)}function U(M){return M===47||M===62||jn(M)?D(M):t(M)}function L(M){return M===62?(e.consume(M),R):t(M)}function R(M){return M===null||Mt(M)?G(M):jn(M)?(e.consume(M),R):t(M)}function G(M){return M===45&&a===2?(e.consume(M),K):M===60&&a===1?(e.consume(M),V):M===62&&a===4?(e.consume(M),ae):M===63&&a===3?(e.consume(M),A):M===93&&a===5?(e.consume(M),ne):Mt(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(KK,ce,ee)(M)):M===null||Mt(M)?(e.exit("htmlFlowData"),ee(M)):(e.consume(M),G)}function ee(M){return e.check(XK,te,ce)(M)}function te(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),oe}function oe(M){return M===null||Mt(M)?ee(M):(e.enter("htmlFlowData"),G(M))}function K(M){return M===45?(e.consume(M),A):G(M)}function V(M){return M===47?(e.consume(M),l="",J):G(M)}function J(M){if(M===62){const de=l.toLowerCase();return h_.includes(de)?(e.consume(M),ae):G(M)}return Bo(M)&&l.length<8?(e.consume(M),l+=String.fromCharCode(M),J):G(M)}function ne(M){return M===93?(e.consume(M),A):G(M)}function A(M){return M===62?(e.consume(M),ae):M===45&&a===2?(e.consume(M),A):G(M)}function ae(M){return M===null||Mt(M)?(e.exit("htmlFlowData"),ce(M)):(e.consume(M),ae)}function ce(M){return e.exit("htmlFlow"),n(M)}}function tX(e,n,t){const r=this;return a;function a(l){return Mt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s):t(l)}function s(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function nX(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(u0,n,t)}}const rX={name:"htmlText",tokenize:iX};function iX(e,n,t){const r=this;let a,s,l;return f;function f(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),u}function u(A){return A===33?(e.consume(A),d):A===47?(e.consume(A),F):A===63?(e.consume(A),D):Bo(A)?(e.consume(A),z):t(A)}function d(A){return A===45?(e.consume(A),h):A===91?(e.consume(A),s=0,S):Bo(A)?(e.consume(A),I):t(A)}function h(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):Mt(A)?(l=g,V(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?K(A):A===45?b(A):g(A)}function S(A){const ae="CDATA[";return A===ae.charCodeAt(s++)?(e.consume(A),s===ae.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),E):Mt(A)?(l=k,V(A)):(e.consume(A),k)}function E(A){return A===93?(e.consume(A),T):k(A)}function T(A){return A===62?K(A):A===93?(e.consume(A),T):k(A)}function I(A){return A===null||A===62?K(A):Mt(A)?(l=I,V(A)):(e.consume(A),I)}function D(A){return A===null?t(A):A===63?(e.consume(A),q):Mt(A)?(l=D,V(A)):(e.consume(A),D)}function q(A){return A===62?K(A):D(A)}function F(A){return Bo(A)?(e.consume(A),$):t(A)}function $(A){return A===45||La(A)?(e.consume(A),$):B(A)}function B(A){return Mt(A)?(l=B,V(A)):jn(A)?(e.consume(A),B):K(A)}function z(A){return A===45||La(A)?(e.consume(A),z):A===47||A===62||la(A)?U(A):t(A)}function U(A){return A===47?(e.consume(A),K):A===58||A===95||Bo(A)?(e.consume(A),L):Mt(A)?(l=U,V(A)):jn(A)?(e.consume(A),U):K(A)}function L(A){return A===45||A===46||A===58||A===95||La(A)?(e.consume(A),L):R(A)}function R(A){return A===61?(e.consume(A),G):Mt(A)?(l=R,V(A)):jn(A)?(e.consume(A),R):U(A)}function G(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ee):Mt(A)?(l=G,V(A)):jn(A)?(e.consume(A),G):(e.consume(A),te)}function ee(A){return A===a?(e.consume(A),a=void 0,oe):A===null?t(A):Mt(A)?(l=ee,V(A)):(e.consume(A),ee)}function te(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||la(A)?U(A):(e.consume(A),te)}function oe(A){return A===47||A===62||la(A)?U(A):t(A)}function K(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function V(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),J}function J(A){return jn(A)?Xn(e,ne,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):ne(A)}function ne(A){return e.enter("htmlTextData"),l(A)}}const bS={name:"labelEnd",resolveAll:lX,resolveTo:cX,tokenize:uX},aX={tokenize:dX},sX={tokenize:fX},oX={tokenize:hX};function lX(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Ho(e,0,e.length,t),e}function cX(e,n){let t=e.length,r=0,a,s,l,f;for(;t--;)if(a=e[t][1],s){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(s=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const u={type:e[s][1].type==="labelLink"?"link":"image",start:{...e[s][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[s][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[s+r+2][1].end},end:{...e[l-2][1].start}};return f=[["enter",u,n],["enter",d,n]],f=ls(f,e.slice(s+1,s+r+3)),f=ls(f,[["enter",h,n]]),f=ls(f,xS(n.parser.constructs.insideSpan.null,e.slice(s+r+4,l-3),n)),f=ls(f,[["exit",h,n],e[l-2],e[l-1],["exit",d,n]]),f=ls(f,e.slice(l+1)),f=ls(f,[["exit",u,n]]),Ho(e,s,e.length,f),e}function uX(e,n,t){const r=this;let a=r.events.length,s,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){s=r.events[a][1];break}return f;function f(b){return s?s._inactive?g(b):(l=r.parser.defined.includes(Rh(r.sliceSerialize({start:s.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),u):t(b)}function u(b){return b===40?e.attempt(aX,h,l?h:g)(b):b===91?e.attempt(sX,h,l?d:g)(b):l?h(b):g(b)}function d(b){return e.attempt(oX,h,g)(b)}function h(b){return n(b)}function g(b){return s._balanced=!0,t(b)}}function dX(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return la(g)?rg(e,s)(g):s(g)}function s(g){return g===41?h(g):qT(e,l,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return la(g)?rg(e,u)(g):h(g)}function f(g){return t(g)}function u(g){return g===34||g===39||g===40?HT(e,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function d(g){return la(g)?rg(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function fX(e,n,t){const r=this;return a;function a(f){return VT.call(r,e,s,l,"reference","referenceMarker","referenceString")(f)}function s(f){return r.parser.defined.includes(Rh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function l(f){return t(f)}}function hX(e,n,t){return r;function r(s){return e.enter("reference"),e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),a}function a(s){return s===93?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),n):t(s)}}const pX={name:"labelStartImage",resolveAll:bS.resolveAll,tokenize:mX};function mX(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),s}function s(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),l):t(f)}function l(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const gX={name:"labelStartLink",resolveAll:bS.resolveAll,tokenize:yX};function yX(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),s}function s(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const Zv={name:"lineEnding",tokenize:xX};function xX(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Xn(e,n,"linePrefix")}}const ob={name:"thematicBreak",tokenize:bX};function bX(e,n,t){let r=0,a;return s;function s(d){return e.enter("thematicBreak"),l(d)}function l(d){return a=d,f(d)}function f(d){return d===a?(e.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||Mt(d))?(e.exit("thematicBreak"),n(d)):t(d)}function u(d){return d===a?(e.consume(d),r++,u):(e.exit("thematicBreakSequence"),jn(d)?Xn(e,f,"whitespace")(d):f(d))}}const aa={continuation:{tokenize:NX},exit:jX,name:"list",tokenize:SX},vX={partial:!0,tokenize:_X},wX={partial:!0,tokenize:CX};function SX(e,n,t){const r=this,a=r.events[r.events.length-1];let s=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return f;function f(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:nw(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(ob,t,d)(v):d(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(v)}return t(v)}function u(v){return nw(v)&&++l<10?(e.consume(v),u):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),d(v)):t(v)}function d(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(u0,r.interrupt?t:h,e.attempt(vX,b,g))}function h(v){return r.containerState.initialBlankLine=!0,s++,b(v)}function g(v){return jn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=s+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function NX(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(u0,a,s);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Xn(e,n,"listItemIndent",r.containerState.size+1)(f)}function s(f){return r.containerState.furtherBlankLines||!jn(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(wX,n,l)(f))}function l(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,Xn(e,e.attempt(aa,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function CX(e,n,t){const r=this;return Xn(e,a,"listItemIndent",r.containerState.size+1);function a(s){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(s):t(s)}}function jX(e){e.exit(this.containerState.type)}function _X(e,n,t){const r=this;return Xn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(s){const l=r.events[r.events.length-1];return!jn(s)&&l&&l[1].type==="listItemPrefixWhitespace"?n(s):t(s)}}const p_={name:"setextUnderline",resolveTo:kX,tokenize:EX};function kX(e,n){let t=e.length,r,a,s;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!s&&e[t][1].type==="definition"&&(s=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",s?(e.splice(a,0,["enter",l,n]),e.splice(s+1,0,["exit",e[r][1],n]),e[r][1].end={...e[s][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function EX(e,n,t){const r=this;let a;return s;function s(d){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=d,l(d)):t(d)}function l(d){return e.enter("setextHeadingLineSequence"),f(d)}function f(d){return d===a?(e.consume(d),f):(e.exit("setextHeadingLineSequence"),jn(d)?Xn(e,u,"lineSuffix")(d):u(d))}function u(d){return d===null||Mt(d)?(e.exit("setextHeadingLine"),n(d)):t(d)}}const TX={tokenize:AX};function AX(e){const n=this,t=e.attempt(u0,r,e.attempt(this.parser.constructs.flowInitial,a,Xn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(RK,a)),"linePrefix")));return t;function r(s){if(s===null){e.consume(s);return}return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const PX={resolveAll:YT()},DX=GT("string"),IX=GT("text");function GT(e){return{resolveAll:YT(e==="text"?MX:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],s=t.attempt(a,l,f);return l;function l(h){return d(h)?s(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),u}function u(h){return d(h)?(t.exit("data"),s(h)):(t.consume(h),u)}function d(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function YT(e){return n;function n(t,r){let a=-1,s;for(;++a<=t.length;)s===void 0?t[a]&&t[a][1].type==="data"&&(s=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==s+2&&(t[s][1].end=t[a-1][1].end,t.splice(s+2,a-s-2),a=s+2),s=void 0);return e?e(t,r):t}}function MX(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let s=a.length,l=-1,f=0,u;for(;s--;){const d=a[s];if(typeof d=="string"){for(l=d.length;d.charCodeAt(l-1)===32;)f++,l--;if(l)break;l=-1}else if(d===-2)u=!0,f++;else if(d!==-1){s++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const d={type:t===e.length||u||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?l:r.start._bufferIndex+l,_index:r.start._index+s,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(e.splice(t,0,["enter",d,n],["exit",d,n]),t+=2)}t++}return e}const RX={42:aa,43:aa,45:aa,48:aa,49:aa,50:aa,51:aa,52:aa,53:aa,54:aa,55:aa,56:aa,57:aa,62:$T},OX={91:zK},LX={[-2]:Xv,[-1]:Xv,32:Xv},FX={35:GK,42:ob,45:[p_,ob],60:JK,61:p_,95:ob,96:f_,126:f_},$X={38:BT,92:zT},zX={[-5]:Zv,[-4]:Zv,[-3]:Zv,33:pX,38:BT,42:rw,60:[gK,rX],91:gX,92:[VK,zT],93:bS,95:rw,96:TK},BX={null:[rw,PX]},UX={null:[42,95]},qX={null:[]},VX=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:UX,contentInitial:OX,disable:qX,document:RX,flow:FX,flowInitial:LX,insideSpan:BX,string:$X,text:zX},Symbol.toStringTag,{value:"Module"}));function HX(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},s=[];let l=[],f=[];const u={attempt:B(F),check:B($),consume:I,enter:D,exit:q,interrupt:B($,{interrupt:!0})},d={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(d,u);return n.resolveAll&&s.push(n),d;function g(R){return l=ls(l,R),E(),l[l.length-1]!==null?[]:(z(n,0),d.events=xS(s,d.events,d),d.events)}function b(R,G){return YX(v(R),G)}function v(R){return GX(l,R)}function S(){const{_bufferIndex:R,_index:G,line:ee,column:te,offset:oe}=r;return{_bufferIndex:R,_index:G,line:ee,column:te,offset:oe}}function k(R){a[R.line]=R.column,L()}function E(){let R;for(;r._index<l.length;){const G=l[r._index];if(typeof G=="string")for(R=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===R&&r._bufferIndex<G.length;)T(G.charCodeAt(r._bufferIndex));else T(G)}}function T(R){h=h(R)}function I(R){Mt(R)?(r.line++,r.column=1,r.offset+=R===-3?2:1,L()):R!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=R}function D(R,G){const ee=G||{};return ee.type=R,ee.start=S(),d.events.push(["enter",ee,d]),f.push(ee),ee}function q(R){const G=f.pop();return G.end=S(),d.events.push(["exit",G,d]),G}function F(R,G){z(R,G.from)}function $(R,G){G.restore()}function B(R,G){return ee;function ee(te,oe,K){let V,J,ne,A;return Array.isArray(te)?ce(te):"tokenize"in te?ce([te]):ae(te);function ae(fe){return we;function we(ie){const _e=ie!==null&&fe[ie],Ve=ie!==null&&fe.null,tt=[...Array.isArray(_e)?_e:_e?[_e]:[],...Array.isArray(Ve)?Ve:Ve?[Ve]:[]];return ce(tt)(ie)}}function ce(fe){return V=fe,J=0,fe.length===0?K:M(fe[J])}function M(fe){return we;function we(ie){return A=U(),ne=fe,fe.partial||(d.currentConstruct=fe),fe.name&&d.parser.constructs.disable.null.includes(fe.name)?Se():fe.tokenize.call(G?Object.assign(Object.create(d),G):d,u,de,Se)(ie)}}function de(fe){return R(ne,A),oe}function Se(fe){return A.restore(),++J<V.length?M(V[J]):K}}}function z(R,G){R.resolveAll&&!s.includes(R)&&s.push(R),R.resolve&&Ho(d.events,G,d.events.length-G,R.resolve(d.events.slice(G),d)),R.resolveTo&&(d.events=R.resolveTo(d.events,d))}function U(){const R=S(),G=d.previous,ee=d.currentConstruct,te=d.events.length,oe=Array.from(f);return{from:te,restore:K};function K(){r=R,d.previous=G,d.currentConstruct=ee,d.events.length=te,f=oe,L()}}function L(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function GX(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,s=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,s)];else{if(l=e.slice(t,a),r>-1){const f=l[0];typeof f=="string"?l[0]=f.slice(r):l.shift()}s>0&&l.push(e[a].slice(0,s))}return l}function YX(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const s=e[t];let l;if(typeof s=="string")l=s;else switch(s){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(s)}a=s===-2,r.push(l)}return r.join("")}function WX(e){const r={constructs:tK([VX,...(e||{}).extensions||[]]),content:a(cK),defined:[],document:a(dK),flow:a(TX),lazy:{},string:a(DX),text:a(IX)};return r;function a(s){return l;function l(f){return HX(r,s,f)}}}function QX(e){for(;!UT(e););return e}const m_=/[\0\t\n\r]/g;function JX(){let e=1,n="",t=!0,r;return a;function a(s,l,f){const u=[];let d,h,g,b,v;for(s=n+(typeof s=="string"?s.toString():new TextDecoder(l||void 0).decode(s)),g=0,n="",t&&(s.charCodeAt(0)===65279&&g++,t=void 0);g<s.length;){if(m_.lastIndex=g,d=m_.exec(s),b=d&&d.index!==void 0?d.index:s.length,v=s.charCodeAt(b),!d){n=s.slice(g);break}if(v===10&&g===b&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),g<b&&(u.push(s.slice(g,b)),e+=b-g),v){case 0:{u.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,u.push(-2);e++<h;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&u.push(-5),n&&u.push(n),u.push(null)),u}}const KX=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function WT(e){return e.replace(KX,XX)}function XX(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),s=a===120||a===88;return FT(t.slice(s?2:1),s?16:10)}return yS(t)||e}function ig(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?g_(e.position):"start"in e||"end"in e?g_(e):"line"in e||"column"in e?iw(e):""}function iw(e){return y_(e&&e.line)+":"+y_(e&&e.column)}function g_(e){return iw(e&&e.start)+"-"+iw(e&&e.end)}function y_(e){return e&&typeof e=="number"?e:1}const QT={}.hasOwnProperty;function ZX(e,n,t){return typeof n!="string"&&(t=n,n=void 0),eZ(t)(QX(WX(t).document().write(JX()(e,n,!0))))}function eZ(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(rt),autolinkProtocol:U,autolinkEmail:U,atxHeading:s(Me),blockQuote:s(Ve),characterEscape:U,characterReference:U,codeFenced:s(tt),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:s(tt,l),codeText:s(Ke,l),codeTextData:U,data:U,codeFlowValue:U,definition:s(Oe),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:s(xe),hardBreakEscape:s(ve),hardBreakTrailing:s(ve),htmlFlow:s(Ee,l),htmlFlowData:U,htmlText:s(Ee,l),htmlTextData:U,image:s(Pe),label:l,link:s(rt),listItem:s(Ze),listItemValue:b,listOrdered:s(lt,g),listUnordered:s(lt),paragraph:s(Rt),reference:M,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:s(Me),strong:s(kt),thematicBreak:s(se)},exit:{atxHeading:u(),atxHeadingSequence:F,autolink:u(),autolinkEmail:_e,autolinkProtocol:ie,blockQuote:u(),characterEscapeValue:L,characterReferenceMarkerHexadecimal:Se,characterReferenceMarkerNumeric:Se,characterReferenceValue:fe,characterReference:we,codeFenced:u(E),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:L,codeIndented:u(T),codeText:u(oe),codeTextData:L,data:L,definition:u(),definitionDestinationString:q,definitionLabelString:I,definitionTitleString:D,emphasis:u(),hardBreakEscape:u(G),hardBreakTrailing:u(G),htmlFlow:u(ee),htmlFlowData:L,htmlText:u(te),htmlTextData:L,image:u(V),label:ne,labelText:J,lineEnding:R,link:u(K),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:de,resourceDestinationString:A,resourceTitleString:ae,resource:ce,setextHeading:u(z),setextHeadingLineSequence:B,setextHeadingText:$,strong:u(),thematicBreak:u()}};JT(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(Q){let re={type:"root",children:[]};const je={stack:[re],tokenStack:[],config:n,enter:f,exit:d,buffer:l,resume:h,data:t},Ae=[];let Ue=-1;for(;++Ue<Q.length;)if(Q[Ue][1].type==="listOrdered"||Q[Ue][1].type==="listUnordered")if(Q[Ue][0]==="enter")Ae.push(Ue);else{const ot=Ae.pop();Ue=a(Q,ot,Ue)}for(Ue=-1;++Ue<Q.length;){const ot=n[Q[Ue][0]];QT.call(ot,Q[Ue][1].type)&&ot[Q[Ue][1].type].call(Object.assign({sliceSerialize:Q[Ue][2].sliceSerialize},je),Q[Ue][1])}if(je.tokenStack.length>0){const ot=je.tokenStack[je.tokenStack.length-1];(ot[1]||x_).call(je,void 0,ot[0])}for(re.position={start:Gc(Q.length>0?Q[0][1].start:{line:1,column:1,offset:0}),end:Gc(Q.length>0?Q[Q.length-2][1].end:{line:1,column:1,offset:0})},Ue=-1;++Ue<n.transforms.length;)re=n.transforms[Ue](re)||re;return re}function a(Q,re,je){let Ae=re-1,Ue=-1,ot=!1,mt,ft,Be,Xe;for(;++Ae<=je;){const Fe=Q[Ae];switch(Fe[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Fe[0]==="enter"?Ue++:Ue--,Xe=void 0;break}case"lineEndingBlank":{Fe[0]==="enter"&&(mt&&!Xe&&!Ue&&!Be&&(Be=Ae),Xe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Xe=void 0}if(!Ue&&Fe[0]==="enter"&&Fe[1].type==="listItemPrefix"||Ue===-1&&Fe[0]==="exit"&&(Fe[1].type==="listUnordered"||Fe[1].type==="listOrdered")){if(mt){let st=Ae;for(ft=void 0;st--;){const Je=Q[st];if(Je[1].type==="lineEnding"||Je[1].type==="lineEndingBlank"){if(Je[0]==="exit")continue;ft&&(Q[ft][1].type="lineEndingBlank",ot=!0),Je[1].type="lineEnding",ft=st}else if(!(Je[1].type==="linePrefix"||Je[1].type==="blockQuotePrefix"||Je[1].type==="blockQuotePrefixWhitespace"||Je[1].type==="blockQuoteMarker"||Je[1].type==="listItemIndent"))break}Be&&(!ft||Be<ft)&&(mt._spread=!0),mt.end=Object.assign({},ft?Q[ft][1].start:Fe[1].end),Q.splice(ft||Ae,0,["exit",mt,Fe[2]]),Ae++,je++}if(Fe[1].type==="listItemPrefix"){const st={type:"listItem",_spread:!1,start:Object.assign({},Fe[1].start),end:void 0};mt=st,Q.splice(Ae,0,["enter",st,Fe[2]]),Ae++,je++,Be=void 0,Xe=!0}}}return Q[re][1]._spread=ot,je}function s(Q,re){return je;function je(Ae){f.call(this,Q(Ae),Ae),re&&re.call(this,Ae)}}function l(){this.stack.push({type:"fragment",children:[]})}function f(Q,re,je){this.stack[this.stack.length-1].children.push(Q),this.stack.push(Q),this.tokenStack.push([re,je||void 0]),Q.position={start:Gc(re.start),end:void 0}}function u(Q){return re;function re(je){Q&&Q.call(this,je),d.call(this,je)}}function d(Q,re){const je=this.stack.pop(),Ae=this.tokenStack.pop();if(Ae)Ae[0].type!==Q.type&&(re?re.call(this,Q,Ae[0]):(Ae[1]||x_).call(this,Q,Ae[0]));else throw new Error("Cannot close `"+Q.type+"` ("+ig({start:Q.start,end:Q.end})+"): its not open");je.position.end=Gc(Q.end)}function h(){return gS(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(Q){if(this.data.expectingFirstListItemValue){const re=this.stack[this.stack.length-2];re.start=Number.parseInt(this.sliceSerialize(Q),10),this.data.expectingFirstListItemValue=void 0}}function v(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.lang=Q}function S(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.meta=Q}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function T(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q.replace(/(\r?\n|\r)$/g,"")}function I(Q){const re=this.resume(),je=this.stack[this.stack.length-1];je.label=re,je.identifier=Rh(this.sliceSerialize(Q)).toLowerCase()}function D(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.title=Q}function q(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.url=Q}function F(Q){const re=this.stack[this.stack.length-1];if(!re.depth){const je=this.sliceSerialize(Q).length;re.depth=je}}function $(){this.data.setextHeadingSlurpLineEnding=!0}function B(Q){const re=this.stack[this.stack.length-1];re.depth=this.sliceSerialize(Q).codePointAt(0)===61?1:2}function z(){this.data.setextHeadingSlurpLineEnding=void 0}function U(Q){const je=this.stack[this.stack.length-1].children;let Ae=je[je.length-1];(!Ae||Ae.type!=="text")&&(Ae=on(),Ae.position={start:Gc(Q.start),end:void 0},je.push(Ae)),this.stack.push(Ae)}function L(Q){const re=this.stack.pop();re.value+=this.sliceSerialize(Q),re.position.end=Gc(Q.end)}function R(Q){const re=this.stack[this.stack.length-1];if(this.data.atHardBreak){const je=re.children[re.children.length-1];je.position.end=Gc(Q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(re.type)&&(U.call(this,Q),L.call(this,Q))}function G(){this.data.atHardBreak=!0}function ee(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q}function te(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q}function oe(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.value=Q}function K(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const re=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=re,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function V(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const re=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=re,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function J(Q){const re=this.sliceSerialize(Q),je=this.stack[this.stack.length-2];je.label=WT(re),je.identifier=Rh(re).toLowerCase()}function ne(){const Q=this.stack[this.stack.length-1],re=this.resume(),je=this.stack[this.stack.length-1];if(this.data.inReference=!0,je.type==="link"){const Ae=Q.children;je.children=Ae}else je.alt=re}function A(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.url=Q}function ae(){const Q=this.resume(),re=this.stack[this.stack.length-1];re.title=Q}function ce(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function de(Q){const re=this.resume(),je=this.stack[this.stack.length-1];je.label=re,je.identifier=Rh(this.sliceSerialize(Q)).toLowerCase(),this.data.referenceType="full"}function Se(Q){this.data.characterReferenceType=Q.type}function fe(Q){const re=this.sliceSerialize(Q),je=this.data.characterReferenceType;let Ae;je?(Ae=FT(re,je==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ae=yS(re);const Ue=this.stack[this.stack.length-1];Ue.value+=Ae}function we(Q){const re=this.stack.pop();re.position.end=Gc(Q.end)}function ie(Q){L.call(this,Q);const re=this.stack[this.stack.length-1];re.url=this.sliceSerialize(Q)}function _e(Q){L.call(this,Q);const re=this.stack[this.stack.length-1];re.url="mailto:"+this.sliceSerialize(Q)}function Ve(){return{type:"blockquote",children:[]}}function tt(){return{type:"code",lang:null,meta:null,value:""}}function Ke(){return{type:"inlineCode",value:""}}function Oe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function xe(){return{type:"emphasis",children:[]}}function Me(){return{type:"heading",depth:0,children:[]}}function ve(){return{type:"break"}}function Ee(){return{type:"html",value:""}}function Pe(){return{type:"image",title:null,url:"",alt:null}}function rt(){return{type:"link",title:null,url:"",children:[]}}function lt(Q){return{type:"list",ordered:Q.type==="listOrdered",start:null,spread:Q._spread,children:[]}}function Ze(Q){return{type:"listItem",spread:Q._spread,checked:null,children:[]}}function Rt(){return{type:"paragraph",children:[]}}function kt(){return{type:"strong",children:[]}}function on(){return{type:"text",value:""}}function se(){return{type:"thematicBreak"}}}function Gc(e){return{line:e.line,column:e.column,offset:e.offset}}function JT(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?JT(e,r):tZ(e,r)}}function tZ(e,n){let t;for(t in n)if(QT.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function x_(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+ig({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+ig({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+ig({start:n.start,end:n.end})+") is still open")}function nZ(e){const n=this;n.parser=t;function t(r){return ZX(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const b_={}.hasOwnProperty;function KT(e,n){const t=n||{};function r(a,...s){let l=r.invalid;const f=r.handlers;if(a&&b_.call(a,e)){const u=String(a[e]);l=b_.call(f,u)?f[u]:r.unknown}if(l)return l.call(this,a,...s)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const rZ={}.hasOwnProperty;function XT(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)XT(e,n.extensions[t]);for(r in n)if(rZ.call(n,r))switch(r){case"extensions":break;case"unsafe":{v_(e[r],n[r]);break}case"join":{v_(e[r],n[r]);break}case"handlers":{iZ(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function v_(e,n){n&&e.push(...n)}function iZ(e,n){n&&Object.assign(e,n)}function aZ(e,n,t,r){const a=t.enter("blockquote"),s=t.createTracker(r);s.move("> "),s.shift(2);const l=t.indentLines(t.containerFlow(e,s.current()),sZ);return a(),l}function sZ(e,n,t){return">"+(t?"":" ")+e}function ZT(e,n){return w_(e,n.inConstruct,!0)&&!w_(e,n.notInConstruct,!1)}function w_(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function S_(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&ZT(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function oZ(e,n){const t=String(e);let r=t.indexOf(n),a=r,s=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++s>l&&(l=s):s=1,a=r+n.length,r=t.indexOf(n,a);return l}function aw(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function lZ(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function cZ(e,n,t,r){const a=lZ(t),s=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(aw(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(s,uZ);return g(),b}const f=t.createTracker(r),u=a.repeat(Math.max(oZ(s,a)+1,3)),d=t.enter("codeFenced");let h=f.move(u);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),s&&(h+=f.move(s+`
`)),h+=f.move(u),d(),h}function uZ(e,n,t){return(t?"":"    ")+e}function vS(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function dZ(e,n,t,r){const a=vS(t),s=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("[");return d+=u.move(t.safe(t.associationId(e),{before:d,after:"]",...u.current()})),d+=u.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":`
`,...u.current()}))),f(),e.title&&(f=t.enter(`title${s}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),l(),d}function fZ(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function Zc(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Mb(e,n,t){const r=Ib(e),a=Ib(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}eA.peek=hZ;function eA(e,n,t,r){const a=fZ(t),s=t.enter("emphasis"),l=t.createTracker(r),f=l.move(a);let u=l.move(t.containerPhrasing(e,{after:a,before:f,...l.current()}));const d=u.charCodeAt(0),h=Mb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=Zc(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=Mb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+Zc(g));const v=l.move(a);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function hZ(e,n,t){return t.options.emphasis||"*"}const wS=function(e){if(e==null)return yZ;if(typeof e=="function")return d0(e);if(typeof e=="object")return Array.isArray(e)?pZ(e):mZ(e);if(typeof e=="string")return gZ(e);throw new Error("Expected function, string, or object as test")};function pZ(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=wS(e[t]);return d0(r);function r(...a){let s=-1;for(;++s<n.length;)if(n[s].apply(this,a))return!0;return!1}}function mZ(e){const n=e;return d0(t);function t(r){const a=r;let s;for(s in e)if(a[s]!==n[s])return!1;return!0}}function gZ(e){return d0(n);function n(t){return t&&t.type===e}}function d0(e){return n;function n(t,r,a){return!!(xZ(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function yZ(){return!0}function xZ(e){return e!==null&&typeof e=="object"&&"type"in e}const tA=[],bZ=!0,sw=!1,vZ="skip";function wZ(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const s=wS(a),l=r?-1:1;f(e,void 0,[])();function f(u,d,h){const g=u&&typeof u=="object"?u:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(u.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=tA,S,k,E;if((!n||s(u,d,h[h.length-1]||void 0))&&(v=SZ(t(u,h)),v[0]===sw))return v;if("children"in u&&u.children){const T=u;if(T.children&&v[0]!==vZ)for(k=(r?T.children.length:-1)+l,E=h.concat(T);k>-1&&k<T.children.length;){const I=T.children[k];if(S=f(I,k,E)(),S[0]===sw)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function SZ(e){return Array.isArray(e)?e:typeof e=="number"?[bZ,e]:e==null?tA:[e]}function nA(e,n,t,r){let a,s,l;typeof n=="function"?(s=void 0,l=n,a=t):(s=n,l=t,a=r),wZ(e,s,f,a);function f(u,d){const h=d[d.length-1],g=h?h.children.indexOf(u):void 0;return l(u,g,h)}}function rA(e,n){let t=!1;return nA(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,sw}),!!((!e.depth||e.depth<3)&&gS(e)&&(n.options.setext||t))}function NZ(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),s=t.createTracker(r);if(rA(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...s.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),f=t.enter("headingAtx"),u=t.enter("phrasing");s.move(l+" ");let d=t.containerPhrasing(e,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(d)&&(d=Zc(d.charCodeAt(0))+d.slice(1)),d=d?l+" "+d:l,t.options.closeAtx&&(d+=" "+l),u(),f(),d}iA.peek=CZ;function iA(e){return e.value||""}function CZ(){return"<"}aA.peek=jZ;function aA(e,n,t,r){const a=vS(t),s=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("![");return d+=u.move(t.safe(e.alt,{before:d,after:"]",...u.current()})),d+=u.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":")",...u.current()}))),f(),e.title&&(f=t.enter(`title${s}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),d+=u.move(")"),l(),d}function jZ(){return"!"}sA.peek=_Z;function sA(e,n,t,r){const a=e.referenceType,s=t.enter("imageReference");let l=t.enter("label");const f=t.createTracker(r);let u=f.move("![");const d=t.safe(e.alt,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return l(),t.stack=h,s(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function _Z(){return"!"}oA.peek=kZ;function oA(e,n,t){let r=e.value||"",a="`",s=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++s<t.unsafe.length;){const l=t.unsafe[s],f=t.compilePattern(l);let u;if(l.atBreak)for(;u=f.exec(r);){let d=u.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(u.index+1)}}return a+r+a}function kZ(){return"`"}function lA(e,n){const t=gS(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}cA.peek=EZ;function cA(e,n,t,r){const a=vS(t),s=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let f,u;if(lA(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),f(),t.stack=h,g}f=t.enter("link"),u=t.enter("label");let d=l.move("[");return d+=l.move(t.containerPhrasing(e,{before:d,after:"](",...l.current()})),d+=l.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=t.enter("destinationLiteral"),d+=l.move("<"),d+=l.move(t.safe(e.url,{before:d,after:">",...l.current()})),d+=l.move(">")):(u=t.enter("destinationRaw"),d+=l.move(t.safe(e.url,{before:d,after:e.title?" ":")",...l.current()}))),u(),e.title&&(u=t.enter(`title${s}`),d+=l.move(" "+a),d+=l.move(t.safe(e.title,{before:d,after:a,...l.current()})),d+=l.move(a),u()),d+=l.move(")"),f(),d}function EZ(e,n,t){return lA(e,t)?"<":"["}uA.peek=TZ;function uA(e,n,t,r){const a=e.referenceType,s=t.enter("linkReference");let l=t.enter("label");const f=t.createTracker(r);let u=f.move("[");const d=t.containerPhrasing(e,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return l(),t.stack=h,s(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function TZ(){return"["}function SS(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function AZ(e){const n=SS(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function PZ(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function dA(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function DZ(e,n,t,r){const a=t.enter("list"),s=t.bulletCurrent;let l=e.ordered?PZ(t):SS(t);const f=e.ordered?l==="."?")":".":AZ(t);let u=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(u=!0),dA(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(l=f),t.bulletCurrent=l;const d=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=s,a(),d}function IZ(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function MZ(e,n,t,r){const a=IZ(t);let s=t.bulletCurrent||SS(t);n&&n.type==="list"&&n.ordered&&(s=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+s);let l=s.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const f=t.createTracker(r);f.move(s+" ".repeat(l-s.length)),f.shift(l);const u=t.enter("listItem"),d=t.indentLines(t.containerFlow(e,f.current()),h);return u(),d;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?s:s+" ".repeat(l-s.length))+g}}function RZ(e,n,t,r){const a=t.enter("paragraph"),s=t.enter("phrasing"),l=t.containerPhrasing(e,r);return s(),a(),l}const OZ=wS(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function LZ(e,n,t,r){return(e.children.some(function(l){return OZ(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function FZ(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}fA.peek=$Z;function fA(e,n,t,r){const a=FZ(t),s=t.enter("strong"),l=t.createTracker(r),f=l.move(a+a);let u=l.move(t.containerPhrasing(e,{after:a,before:f,...l.current()}));const d=u.charCodeAt(0),h=Mb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=Zc(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=Mb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+Zc(g));const v=l.move(a+a);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function $Z(e,n,t){return t.options.strong||"*"}function zZ(e,n,t,r){return t.safe(e.value,r)}function BZ(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function UZ(e,n,t){const r=(dA(t)+(t.options.ruleSpaces?" ":"")).repeat(BZ(t));return t.options.ruleSpaces?r.slice(0,-1):r}const qZ={blockquote:aZ,break:S_,code:cZ,definition:dZ,emphasis:eA,hardBreak:S_,heading:NZ,html:iA,image:aA,imageReference:sA,inlineCode:oA,link:cA,linkReference:uA,list:DZ,listItem:MZ,paragraph:RZ,root:LZ,strong:fA,text:zZ,thematicBreak:UZ},VZ=[HZ];function HZ(e,n,t,r){if(n.type==="code"&&aw(n,r)&&(e.type==="list"||e.type===n.type&&aw(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&rA(n,r))?void 0:t.spread?1:0}const Pd=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],GZ=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Pd},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Pd},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Pd},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Pd},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Pd},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Pd},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Pd},{atBreak:!0,character:"~"}];function YZ(e){return e.label||!e.identifier?e.label||"":WT(e.identifier)}function WZ(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function QZ(e,n,t){const r=n.indexStack,a=e.children||[],s=[];let l=-1,f=t.before,u;r.push(-1);let d=n.createTracker(t);for(;++l<a.length;){const h=a[l];let g;if(r[r.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...d.current()}).charAt(0):""}else g=t.after;s.length>0&&(f==="\r"||f===`
`)&&h.type==="html"&&(s[s.length-1]=s[s.length-1].replace(/(\r?\n|\r)$/," "),f=" ",d=n.createTracker(t),d.move(s.join("")));let b=n.handle(h,e,n,{...d.current(),after:g,before:f});u&&u===b.slice(0,1)&&(b=Zc(u.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,u=void 0,v&&(s.length>0&&v.before&&f===s[s.length-1].slice(-1)&&(s[s.length-1]=s[s.length-1].slice(0,-1)+Zc(f.charCodeAt(0))),v.after&&(u=g)),d.move(b),s.push(b),f=b.slice(-1)}return r.pop(),s.join("")}function JZ(e,n,t){const r=n.indexStack,a=e.children||[],s=n.createTracker(t),l=[];let f=-1;for(r.push(-1);++f<a.length;){const u=a[f];r[r.length-1]=f,l.push(s.move(n.handle(u,e,n,{before:`
`,after:`
`,...s.current()}))),u.type!=="list"&&(n.bulletLastUsed=void 0),f<a.length-1&&l.push(s.move(KZ(u,a[f+1],e,n)))}return r.pop(),l.join("")}function KZ(e,n,t,r){let a=r.join.length;for(;a--;){const s=r.join[a](e,n,t,r);if(s===!0||s===1)break;if(typeof s=="number")return`
`.repeat(1+s);if(s===!1)return`

<!---->

`}return`

`}const XZ=/\r?\n|\r/g;function ZZ(e,n){const t=[];let r=0,a=0,s;for(;s=XZ.exec(e);)l(e.slice(r,s.index)),t.push(s[0]),r=s.index+s[0].length,a++;return l(e.slice(r)),t.join("");function l(f){t.push(n(f,a,!f))}}function eee(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],s=[],l={};let f=-1;for(;++f<e.unsafe.length;){const h=e.unsafe[f];if(!ZT(e.stack,h))continue;const g=e.compilePattern(h);let b;for(;b=g.exec(r);){const v="before"in h||!!h.atBreak,S="after"in h,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(tee);let u=t.before?t.before.length:0;const d=r.length-(t.after?t.after.length:0);for(f=-1;++f<a.length;){const h=a[f];h<u||h>=d||h+1<d&&a[f+1]===h+1&&l[h].after&&!l[h+1].before&&!l[h+1].after||a[f-1]===h-1&&l[h].before&&!l[h-1].before&&!l[h-1].after||(u!==h&&s.push(N_(r.slice(u,h),"\\")),u=h,/[!-/:-@[-`{-~]/.test(r.charAt(h))&&(!t.encode||!t.encode.includes(r.charAt(h)))?s.push("\\"):(s.push(Zc(r.charCodeAt(h))),u++))}return s.push(N_(r.slice(u,d),t.after)),s.join("")}function tee(e,n){return e-n}function N_(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],s=e+n;let l=-1,f=0,u;for(;u=t.exec(s);)r.push(u.index);for(;++l<r.length;)f!==r[l]&&a.push(e.slice(f,r[l])),a.push("\\"),f=r[l];return a.push(e.slice(f)),a.join("")}function nee(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,s=t.column||1;return{move:u,current:l,shift:f};function l(){return{now:{line:a,column:s},lineShift:r}}function f(d){r+=d}function u(d){const h=d||"",g=h.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,s=g.length===1?s+b.length:1+b.length+r,h}}function ree(e,n){const t=n||{},r={associationId:YZ,containerPhrasing:oee,containerFlow:lee,createTracker:nee,compilePattern:WZ,enter:s,handlers:{...qZ},handle:void 0,indentLines:ZZ,indexStack:[],join:[...VZ],options:{},safe:cee,stack:[],unsafe:[...GZ]};XT(r,t),r.options.tightDefinitions&&r.join.push(see),r.handle=KT("type",{invalid:iee,unknown:aee,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function s(l){return r.stack.push(l),f;function f(){r.stack.pop()}}}function iee(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function aee(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function see(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function oee(e,n){return QZ(e,this,n)}function lee(e,n){return JZ(e,this,n)}function cee(e,n){return eee(this,e,n)}function uee(e){const n=this;n.compiler=t;function t(r){return ree(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function C_(e){if(e)throw e}var e1,j_;function dee(){if(j_)return e1;j_=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):n.call(d)==="[object Array]"},s=function(d){if(!d||n.call(d)!=="[object Object]")return!1;var h=e.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&e.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!h&&!g)return!1;var b;for(b in d);return typeof b>"u"||e.call(d,b)},l=function(d,h){t&&h.name==="__proto__"?t(d,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):d[h.name]=h.newValue},f=function(d,h){if(h==="__proto__")if(e.call(d,h)){if(r)return r(d,h).value}else return;return d[h]};return e1=function u(){var d,h,g,b,v,S,k=arguments[0],E=1,T=arguments.length,I=!1;for(typeof k=="boolean"&&(I=k,k=arguments[1]||{},E=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});E<T;++E)if(d=arguments[E],d!=null)for(h in d)g=f(k,h),b=f(d,h),k!==b&&(I&&b&&(s(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&s(g)?g:{},l(k,{name:h,newValue:u(I,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},e1}var fee=dee();const t1=Qd(fee);function ow(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function hee(){const e=[],n={run:t,use:r};return n;function t(...a){let s=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);f(null,...a);function f(u,...d){const h=e[++s];let g=-1;if(u){l(u);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,h?pee(h,f)(...d):l(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function pee(e,n){let t;return r;function r(...l){const f=e.length>l.length;let u;f&&l.push(a);try{u=e.apply(this,l)}catch(d){const h=d;if(f&&t)throw h;return a(h)}f||(u&&u.then&&typeof u.then=="function"?u.then(s,a):u instanceof Error?a(u):s(u))}function a(l,...f){t||(t=!0,n(l,...f))}function s(l){a(null,l)}}class da extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",s={},l=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof n=="string"?a=n:!s.cause&&n&&(l=!0,a=n.message,s.cause=n),!s.ruleId&&!s.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?s.ruleId=r:(s.source=r.slice(0,u),s.ruleId=r.slice(u+1))}if(!s.place&&s.ancestors&&s.ancestors){const u=s.ancestors[s.ancestors.length-1];u&&(s.place=u.position)}const f=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=f?f.line:void 0,this.name=ig(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=l&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}da.prototype.file="";da.prototype.name="";da.prototype.reason="";da.prototype.message="";da.prototype.stack="";da.prototype.column=void 0;da.prototype.line=void 0;da.prototype.ancestors=void 0;da.prototype.cause=void 0;da.prototype.fatal=void 0;da.prototype.place=void 0;da.prototype.ruleId=void 0;da.prototype.source=void 0;const Fo={basename:mee,dirname:gee,extname:yee,join:xee,sep:"/"};function mee(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');Eg(e);let t=0,r=-1,a=e.length,s;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(s){t=a+1;break}}else r<0&&(s=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(s){t=a+1;break}}else l<0&&(s=!0,l=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function gee(e){if(Eg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function yee(e){Eg(e);let n=e.length,t=-1,r=0,a=-1,s=0,l;for(;n--;){const f=e.codePointAt(n);if(f===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),f===46?a<0?a=n:s!==1&&(s=1):a>-1&&(s=-1)}return a<0||t<0||s===0||s===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function xee(...e){let n=-1,t;for(;++n<e.length;)Eg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":bee(t)}function bee(e){Eg(e);const n=e.codePointAt(0)===47;let t=vee(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function vee(e,n){let t="",r=0,a=-1,s=0,l=-1,f,u;for(;++l<=e.length;){if(l<e.length)f=e.codePointAt(l);else{if(f===47)break;f=47}if(f===47){if(!(a===l-1||s===1))if(a!==l-1&&s===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),a=l,s=0;continue}}else if(t.length>0){t="",r=0,a=l,s=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,s=0}else f===46&&s>-1?s++:s=-1}return t}function Eg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const wee={cwd:See};function See(){return"/"}function lw(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function Nee(e){if(typeof e=="string")e=new URL(e);else if(!lw(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return Cee(e)}function Cee(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const n1=["history","path","basename","stem","extname","dirname"];class jee{constructor(n){let t;n?lw(n)?t={path:n}:typeof n=="string"||_ee(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":wee.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<n1.length;){const s=n1[r];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let a;for(a in t)n1.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Fo.basename(this.path):void 0}set basename(n){i1(n,"basename"),r1(n,"basename"),this.path=Fo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Fo.dirname(this.path):void 0}set dirname(n){__(this.basename,"dirname"),this.path=Fo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Fo.extname(this.path):void 0}set extname(n){if(r1(n,"extname"),__(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Fo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){lw(n)&&(n=Nee(n)),i1(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Fo.basename(this.path,this.extname):void 0}set stem(n){i1(n,"stem"),r1(n,"stem"),this.path=Fo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new da(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function r1(e,n){if(e&&e.includes(Fo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Fo.sep+"`")}function i1(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function __(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function _ee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const kee=function(e){const r=this.constructor.prototype,a=r[e],s=function(){return a.apply(s,arguments)};return Object.setPrototypeOf(s,r),s},Eee={}.hasOwnProperty;class NS extends kee{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=hee()}copy(){const n=new NS;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(t1(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(o1("data",this.frozen),this.namespace[n]=t,this):Eee.call(this.namespace,n)&&this.namespace[n]||void 0:n?(o1("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Ux(n),r=this.parser||this.Parser;return a1("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),a1("process",this.parser||this.Parser),s1("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(s,l){const f=Ux(n),u=r.parse(f);r.run(u,f,function(h,g,b){if(h||!g||!b)return d(h);const v=g,S=r.stringify(v,b);Pee(S)?b.value=S:b.result=S,d(h,b)});function d(h,g){h||!g?l(h):s?s(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),a1("processSync",this.parser||this.Parser),s1("processSync",this.compiler||this.Compiler),this.process(n,a),E_("processSync","process",t),r;function a(s,l){t=!0,C_(s),r=l}}run(n,t,r){k_(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?s(void 0,r):new Promise(s);function s(l,f){const u=Ux(t);a.run(n,u,d);function d(h,g,b){const v=g||n;h?f(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,s),E_("runSync","run",r),a;function s(l,f){C_(l),a=f,r=!0}}stringify(n,t){this.freeze();const r=Ux(t),a=this.compiler||this.Compiler;return s1("stringify",a),k_(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(o1("use",this.frozen),n!=null)if(typeof n=="function")u(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function s(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[h,...g]=d;u(h,g)}else l(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function l(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(d.plugins),d.settings&&(a.settings=t1(!0,a.settings,d.settings))}function f(d){let h=-1;if(d!=null)if(Array.isArray(d))for(;++h<d.length;){const g=d[h];s(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===d){b=g;break}if(b===-1)r.push([d,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];ow(k)&&ow(v)&&(v=t1(!0,k,v)),r[b]=[d,v,...S]}}}}const Tee=new NS().freeze();function a1(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function s1(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function o1(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function k_(e){if(!ow(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function E_(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Ux(e){return Aee(e)?e:new jee(e)}function Aee(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function Pee(e){return typeof e=="string"||Dee(e)}function Dee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const Iee=Tee().use(nZ).use(uee).freeze(),hA=-1,f0=0,ag=1,Rb=2,CS=3,jS=4,_S=5,kS=6,pA=7,mA=8,T_=typeof self=="object"?self:globalThis,Mee=(e,n)=>{const t=(a,s)=>(e.set(s,a),a),r=a=>{if(e.has(a))return e.get(a);const[s,l]=n[a];switch(s){case f0:case hA:return t(l,a);case ag:{const f=t([],a);for(const u of l)f.push(r(u));return f}case Rb:{const f=t({},a);for(const[u,d]of l)f[r(u)]=r(d);return f}case CS:return t(new Date(l),a);case jS:{const{source:f,flags:u}=l;return t(new RegExp(f,u),a)}case _S:{const f=t(new Map,a);for(const[u,d]of l)f.set(r(u),r(d));return f}case kS:{const f=t(new Set,a);for(const u of l)f.add(r(u));return f}case pA:{const{name:f,message:u}=l;return t(new T_[f](u),a)}case mA:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:f}=new Uint8Array(l);return t(new DataView(f),l)}}return t(new T_[s](l),a)};return r},A_=e=>Mee(new Map,e)(0),_h="",{toString:Ree}={},{keys:Oee}=Object,Wm=e=>{const n=typeof e;if(n!=="object"||!e)return[f0,n];const t=Ree.call(e).slice(8,-1);switch(t){case"Array":return[ag,_h];case"Object":return[Rb,_h];case"Date":return[CS,_h];case"RegExp":return[jS,_h];case"Map":return[_S,_h];case"Set":return[kS,_h];case"DataView":return[ag,t]}return t.includes("Array")?[ag,t]:t.includes("Error")?[pA,t]:[Rb,t]},qx=([e,n])=>e===f0&&(n==="function"||n==="symbol"),Lee=(e,n,t,r)=>{const a=(l,f)=>{const u=r.push(l)-1;return t.set(f,u),u},s=l=>{if(t.has(l))return t.get(l);let[f,u]=Wm(l);switch(f){case f0:{let h=l;switch(u){case"bigint":f=mA,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);h=null;break;case"undefined":return a([hA],l)}return a([f,h],l)}case ag:{if(u){let b=l;return u==="DataView"?b=new Uint8Array(l.buffer):u==="ArrayBuffer"&&(b=new Uint8Array(l)),a([u,[...b]],l)}const h=[],g=a([f,h],l);for(const b of l)h.push(s(b));return g}case Rb:{if(u)switch(u){case"BigInt":return a([u,l.toString()],l);case"Boolean":case"Number":case"String":return a([u,l.valueOf()],l)}if(n&&"toJSON"in l)return s(l.toJSON());const h=[],g=a([f,h],l);for(const b of Oee(l))(e||!qx(Wm(l[b])))&&h.push([s(b),s(l[b])]);return g}case CS:return a([f,l.toISOString()],l);case jS:{const{source:h,flags:g}=l;return a([f,{source:h,flags:g}],l)}case _S:{const h=[],g=a([f,h],l);for(const[b,v]of l)(e||!(qx(Wm(b))||qx(Wm(v))))&&h.push([s(b),s(v)]);return g}case kS:{const h=[],g=a([f,h],l);for(const b of l)(e||!qx(Wm(b)))&&h.push(s(b));return g}}const{message:d}=l;return a([f,{name:u,message:d}],l)};return s},P_=(e,{json:n,lossy:t}={})=>{const r=[];return Lee(!(n||t),!!n,new Map,r)(e),r},gg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?A_(P_(e,n)):structuredClone(e):(e,n)=>A_(P_(e,n)),gA=xA("end"),yA=xA("start");function xA(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function bA(e){const n=yA(e),t=gA(e);if(n&&t)return{start:n,end:t}}const Dd=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],D_={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Dd,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Dd],h2:[["className","sr-only"]],img:[...Dd,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Dd,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Dd],table:[...Dd],ul:[...Dd,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},Wc={}.hasOwnProperty;function Fee(e,n){let t={type:"root",children:[]};const r={schema:n?{...D_,...n}:D_,stack:[]},a=vA(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function vA(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return $ee(e,t);case"doctype":return zee(e,t);case"element":return Bee(e,t);case"root":return Uee(e,t);case"text":return qee(e,t)}}}function $ee(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),s={type:"comment",value:r<0?t:t.slice(0,r)};return Tg(s,n),s}}function zee(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return Tg(t,n),t}}function Bee(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=wA(e,n.children),a=Vee(e,n.properties);e.stack.pop();let s=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(s=!0,e.schema.ancestors&&Wc.call(e.schema.ancestors,t))){const f=e.schema.ancestors[t];let u=-1;for(s=!1;++u<f.length;)e.stack.includes(f[u])&&(s=!0)}if(!s)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const l={type:"element",tagName:t,properties:a,children:r};return Tg(l,n),l}function Uee(e,n){const r={type:"root",children:wA(e,n.children)};return Tg(r,n),r}function qee(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return Tg(r,n),r}function wA(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const s=vA(e,r[a]);s&&(Array.isArray(s)?t.push(...s):t.push(s))}}return t}function Vee(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,s=r&&Wc.call(r,t)?r[t]:void 0,l=r&&Wc.call(r,"*")?r["*"]:void 0,f=n&&typeof n=="object"?n:{},u={};let d;for(d in f)if(Wc.call(f,d)){const h=f[d];let g=I_(e,M_(s,d),d,h);g==null&&(g=I_(e,M_(l,d),d,h)),g!=null&&(u[d]=g)}if(a&&Wc.call(a,t)){const h=a[t];for(d in h)Wc.call(h,d)&&!Wc.call(u,d)&&(u[d]=h[d])}return u}function I_(e,n,t,r){return n?Array.isArray(r)?Hee(e,n,t,r):SA(e,n,t,r):void 0}function Hee(e,n,t,r){let a=-1;const s=[];for(;++a<r.length;){const l=SA(e,n,t,r[a]);(typeof l=="number"||typeof l=="string")&&s.push(l)}return s}function SA(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&Gee(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,s=0;for(;++s<n.length;){const l=n[s];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(r))){a=!0;break}}else if(l===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function Gee(e,n,t){const r=e.schema.protocols&&Wc.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),s=a.indexOf(":"),l=a.indexOf("?"),f=a.indexOf("#"),u=a.indexOf("/");if(s<0||u>-1&&s>u||l>-1&&s>l||f>-1&&s>f)return!0;let d=-1;for(;++d<r.length;){const h=r[d];if(s===h.length&&a.slice(0,h.length)===h)return!0}return!1}function Tg(e,n){const t=bA(n);n.data&&(e.data=gg(n.data)),t&&(e.position=t)}function M_(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],s=typeof a=="string"?a:a[0];if(s===n)return a;s==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function Yee(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function Wee(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function Qee(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function Jee(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Kee(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Xee(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=ep(r.toLowerCase()),s=e.footnoteOrder.indexOf(r);let l,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=s+1,f+=1,e.footnoteCounts.set(r,f);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(n,d),e.applyData(n,d)}function Zee(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function ete(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function NA(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),s=a[0];s&&s.type==="text"?s.value="["+s.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function tte(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return NA(e,n);const a={src:ep(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,s),e.applyData(n,s)}function nte(e,n){const t={src:ep(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function rte(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function ite(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return NA(e,n);const a={href:ep(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,s),e.applyData(n,s)}function ate(e,n){const t={href:ep(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function ste(e,n,t){const r=e.all(n),a=t?ote(t):CA(n),s={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const u=r[r.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&l.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:s,children:l};return e.patch(n,d),e.applyData(n,d)}function ote(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=CA(t[r])}return n}function CA(e){const n=e.spread;return n??e.children.length>1}function lte(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,s),e.applyData(n,s)}function cte(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function ute(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function dte(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function fte(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=yA(n.children[1]),u=gA(n.children[n.children.length-1]);f&&u&&(l.position={start:f,end:u}),a.push(l)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,s),e.applyData(n,s)}function hte(e,n,t){const r=t?t.children:void 0,s=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,f=l?l.length:n.children.length;let u=-1;const d=[];for(;++u<f;){const g=n.children[u],b={},v=l?l[u]:void 0;v&&(b.align=v);let S={type:"element",tagName:s,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),d.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(n,h),e.applyData(n,h)}function pte(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const R_=9,O_=32;function mte(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const s=[];for(;r;)s.push(L_(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return s.push(L_(n.slice(a),a>0,!1)),s.join("")}function L_(e,n,t){let r=0,a=e.length;if(n){let s=e.codePointAt(r);for(;s===R_||s===O_;)r++,s=e.codePointAt(r)}if(t){let s=e.codePointAt(a-1);for(;s===R_||s===O_;)a--,s=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function gte(e,n){const t={type:"text",value:mte(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function yte(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const xte={blockquote:Yee,break:Wee,code:Qee,delete:Jee,emphasis:Kee,footnoteReference:Xee,heading:Zee,html:ete,imageReference:tte,image:nte,inlineCode:rte,linkReference:ite,link:ate,listItem:ste,list:lte,paragraph:cte,root:ute,strong:dte,table:fte,tableCell:pte,tableRow:hte,text:gte,thematicBreak:yte,toml:Vx,yaml:Vx,definition:Vx,footnoteDefinition:Vx};function Vx(){}function bte(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function vte(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function wte(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||bte,r=e.options.footnoteBackLabel||vte,a=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let u=-1;for(;++u<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[u]);if(!d)continue;const h=e.all(d),g=String(d.identifier).toUpperCase(),b=ep(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let I=typeof t=="string"?t:t(u,v);typeof I=="string"&&(I={type:"text",value:I}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,v),className:["data-footnote-backref"]},children:Array.isArray(I)?I:[I]})}const E=h[h.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const I=E.children[E.children.length-1];I&&I.type==="text"?I.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...S)}else h.push(...S);const T={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(d,T),f.push(T)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...gg(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const cw={}.hasOwnProperty,Ste={};function Nte(e,n){const t=n||Ste,r=new Map,a=new Map,s=new Map,l={...xte,...t.handlers},f={all:d,applyData:jte,definitionById:r,footnoteById:a,footnoteCounts:s,footnoteOrder:[],handlers:l,one:u,options:t,patch:Cte,wrap:kte};return nA(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function u(h,g){const b=h.type,v=f.handlers[b];if(cw.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:k,...E}=h,T=gg(E);return T.children=f.all(h),T}return gg(h)}return(f.options.unknownHandler||_te)(f,h,g)}function d(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=f.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=F_(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=F_(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function Cte(e,n){e.position&&(n.position=bA(e))}function jte(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,s=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&s&&Object.assign(t.properties,gg(s)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function _te(e,n){const t=n.data||{},r="value"in n&&!(cw.call(t,"hProperties")||cw.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function kte(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function F_(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function Ete(e,n){const t=Nte(e,n),r=t.one(e,void 0),a=wte(t),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&s.children.push({type:"text",value:`
`},a),s}const Tte=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class Ag{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}Ag.prototype.normal={};Ag.prototype.property={};Ag.prototype.space=void 0;function jA(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new Ag(t,r,n)}function uw(e){return e.toLowerCase()}class fa{constructor(n,t){this.attribute=t,this.property=n}}fa.prototype.attribute="";fa.prototype.booleanish=!1;fa.prototype.boolean=!1;fa.prototype.commaOrSpaceSeparated=!1;fa.prototype.commaSeparated=!1;fa.prototype.defined=!1;fa.prototype.mustUseProperty=!1;fa.prototype.number=!1;fa.prototype.overloadedBoolean=!1;fa.prototype.property="";fa.prototype.spaceSeparated=!1;fa.prototype.space=void 0;let Ate=0;const Vt=Kd(),Dr=Kd(),dw=Kd(),at=Kd(),Jn=Kd(),Oh=Kd(),Ra=Kd();function Kd(){return 2**++Ate}const fw=Object.freeze(Object.defineProperty({__proto__:null,boolean:Vt,booleanish:Dr,commaOrSpaceSeparated:Ra,commaSeparated:Oh,number:at,overloadedBoolean:dw,spaceSeparated:Jn},Symbol.toStringTag,{value:"Module"})),l1=Object.keys(fw);class ES extends fa{constructor(n,t,r,a){let s=-1;if(super(n,t),$_(this,"space",a),typeof r=="number")for(;++s<l1.length;){const l=l1[s];$_(this,l1[s],(r&fw[l])===fw[l])}}}ES.prototype.defined=!0;function $_(e,n,t){t&&(e[n]=t)}function tp(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const s=new ES(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),n[r]=s,t[uw(r)]=r,t[uw(s.attribute)]=r}return new Ag(n,t,e.space)}const _A=tp({properties:{ariaActiveDescendant:null,ariaAtomic:Dr,ariaAutoComplete:null,ariaBusy:Dr,ariaChecked:Dr,ariaColCount:at,ariaColIndex:at,ariaColSpan:at,ariaControls:Jn,ariaCurrent:null,ariaDescribedBy:Jn,ariaDetails:null,ariaDisabled:Dr,ariaDropEffect:Jn,ariaErrorMessage:null,ariaExpanded:Dr,ariaFlowTo:Jn,ariaGrabbed:Dr,ariaHasPopup:null,ariaHidden:Dr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Jn,ariaLevel:at,ariaLive:null,ariaModal:Dr,ariaMultiLine:Dr,ariaMultiSelectable:Dr,ariaOrientation:null,ariaOwns:Jn,ariaPlaceholder:null,ariaPosInSet:at,ariaPressed:Dr,ariaReadOnly:Dr,ariaRelevant:null,ariaRequired:Dr,ariaRoleDescription:Jn,ariaRowCount:at,ariaRowIndex:at,ariaRowSpan:at,ariaSelected:Dr,ariaSetSize:at,ariaSort:null,ariaValueMax:at,ariaValueMin:at,ariaValueNow:at,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function kA(e,n){return n in e?e[n]:n}function EA(e,n){return kA(e,n.toLowerCase())}const Pte=tp({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Oh,acceptCharset:Jn,accessKey:Jn,action:null,allow:null,allowFullScreen:Vt,allowPaymentRequest:Vt,allowUserMedia:Vt,alt:null,as:null,async:Vt,autoCapitalize:null,autoComplete:Jn,autoFocus:Vt,autoPlay:Vt,blocking:Jn,capture:null,charSet:null,checked:Vt,cite:null,className:Jn,cols:at,colSpan:null,content:null,contentEditable:Dr,controls:Vt,controlsList:Jn,coords:at|Oh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Vt,defer:Vt,dir:null,dirName:null,disabled:Vt,download:dw,draggable:Dr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Vt,formTarget:null,headers:Jn,height:at,hidden:dw,high:at,href:null,hrefLang:null,htmlFor:Jn,httpEquiv:Jn,id:null,imageSizes:null,imageSrcSet:null,inert:Vt,inputMode:null,integrity:null,is:null,isMap:Vt,itemId:null,itemProp:Jn,itemRef:Jn,itemScope:Vt,itemType:Jn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Vt,low:at,manifest:null,max:null,maxLength:at,media:null,method:null,min:null,minLength:at,multiple:Vt,muted:Vt,name:null,nonce:null,noModule:Vt,noValidate:Vt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Vt,optimum:at,pattern:null,ping:Jn,placeholder:null,playsInline:Vt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Vt,referrerPolicy:null,rel:Jn,required:Vt,reversed:Vt,rows:at,rowSpan:at,sandbox:Jn,scope:null,scoped:Vt,seamless:Vt,selected:Vt,shadowRootClonable:Vt,shadowRootDelegatesFocus:Vt,shadowRootMode:null,shape:null,size:at,sizes:null,slot:null,span:at,spellCheck:Dr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:at,step:null,style:null,tabIndex:at,target:null,title:null,translate:null,type:null,typeMustMatch:Vt,useMap:null,value:Dr,width:at,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Jn,axis:null,background:null,bgColor:null,border:at,borderColor:null,bottomMargin:at,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Vt,declare:Vt,event:null,face:null,frame:null,frameBorder:null,hSpace:at,leftMargin:at,link:null,longDesc:null,lowSrc:null,marginHeight:at,marginWidth:at,noResize:Vt,noHref:Vt,noShade:Vt,noWrap:Vt,object:null,profile:null,prompt:null,rev:null,rightMargin:at,rules:null,scheme:null,scrolling:Dr,standby:null,summary:null,text:null,topMargin:at,valueType:null,version:null,vAlign:null,vLink:null,vSpace:at,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Vt,disableRemotePlayback:Vt,prefix:null,property:null,results:at,security:null,unselectable:null},space:"html",transform:EA}),Dte=tp({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ra,accentHeight:at,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:at,amplitude:at,arabicForm:null,ascent:at,attributeName:null,attributeType:null,azimuth:at,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:at,by:null,calcMode:null,capHeight:at,className:Jn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:at,diffuseConstant:at,direction:null,display:null,dur:null,divisor:at,dominantBaseline:null,download:Vt,dx:null,dy:null,edgeMode:null,editable:null,elevation:at,enableBackground:null,end:null,event:null,exponent:at,externalResourcesRequired:null,fill:null,fillOpacity:at,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Oh,g2:Oh,glyphName:Oh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:at,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:at,horizOriginX:at,horizOriginY:at,id:null,ideographic:at,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:at,k:at,k1:at,k2:at,k3:at,k4:at,kernelMatrix:Ra,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:at,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:at,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:at,overlineThickness:at,paintOrder:null,panose1:null,path:null,pathLength:at,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Jn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:at,pointsAtY:at,pointsAtZ:at,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ra,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ra,rev:Ra,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ra,requiredFeatures:Ra,requiredFonts:Ra,requiredFormats:Ra,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:at,specularExponent:at,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:at,strikethroughThickness:at,string:null,stroke:null,strokeDashArray:Ra,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:at,strokeOpacity:at,strokeWidth:null,style:null,surfaceScale:at,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ra,tabIndex:at,tableValues:null,target:null,targetX:at,targetY:at,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ra,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:at,underlineThickness:at,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:at,values:null,vAlphabetic:at,vMathematical:at,vectorEffect:null,vHanging:at,vIdeographic:at,version:null,vertAdvY:at,vertOriginX:at,vertOriginY:at,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:at,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:kA}),TA=tp({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),AA=tp({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:EA}),PA=tp({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),Ite=/[A-Z]/g,z_=/-[a-z]/g,Mte=/^data[-\w.:]+$/i;function Rte(e,n){const t=uw(n);let r=n,a=fa;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&Mte.test(n)){if(n.charAt(4)==="-"){const s=n.slice(5).replace(z_,Lte);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=n.slice(4);if(!z_.test(s)){let l=s.replace(Ite,Ote);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=ES}return new a(r,n)}function Ote(e){return"-"+e.toLowerCase()}function Lte(e){return e.charAt(1).toUpperCase()}const Fte=jA([_A,Pte,TA,AA,PA],"html"),DA=jA([_A,Dte,TA,AA,PA],"svg"),$te=/["&'<>`]/g,zte=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Bte=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,Ute=/[|\\{}()[\]^$+*?.]/g,B_=new WeakMap;function qte(e,n){if(e=e.replace(n.subset?Vte(n.subset):$te,r),n.subset||n.escapeOnly)return e;return e.replace(zte,t).replace(Bte,r);function t(a,s,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(s+2),n)}function r(a,s,l){return n.format(a.charCodeAt(0),l.charCodeAt(s+1),n)}}function Vte(e){let n=B_.get(e);return n||(n=Hte(e),B_.set(e,n)),n}function Hte(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(Ute,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const Gte=/[\dA-Fa-f]/;function Yte(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!Gte.test(String.fromCharCode(n))?r:r+";"}const Wte=/\d/;function Qte(e,n,t){const r="&#"+String(e);return t&&n&&!Wte.test(String.fromCharCode(n))?r:r+";"}const Jte=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],c1={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},Kte=["cent","copy","divide","gt","lt","not","para","times"],IA={}.hasOwnProperty,hw={};let Hx;for(Hx in c1)IA.call(c1,Hx)&&(hw[c1[Hx]]=Hx);const Xte=/[^\dA-Za-z]/;function Zte(e,n,t,r){const a=String.fromCharCode(e);if(IA.call(hw,a)){const s=hw[a],l="&"+s;return t&&Jte.includes(s)&&!Kte.includes(s)&&(!r||n&&n!==61&&Xte.test(String.fromCharCode(n)))?l:l+";"}return""}function ene(e,n,t){let r=Yte(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=Zte(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const s=Qte(e,n,t.omitOptionalSemicolons);s.length<r.length&&(r=s)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function Lh(e,n){return qte(e,Object.assign({format:ene},n))}const tne=/^>|^->|<!--|-->|--!>|<!-$/g,nne=[">"],rne=["<",">"];function ine(e,n,t,r){return r.settings.bogusComments?"<?"+Lh(e.value,Object.assign({},r.settings.characterReferences,{subset:nne}))+">":"<!--"+e.value.replace(tne,a)+"-->";function a(s){return Lh(s,Object.assign({},r.settings.characterReferences,{subset:rne}))}}function ane(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function U_(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function sne(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function one(e){return e.join(" ").trim()}const lne=/[ \t\n\f\r]/g;function TS(e){return typeof e=="object"?e.type==="text"?q_(e.value):!1:q_(e)}function q_(e){return e.replace(lne,"")===""}const $r=RA(1),MA=RA(-1),cne=[];function RA(e){return n;function n(t,r,a){const s=t?t.children:cne;let l=(r||0)+e,f=s[l];if(!a)for(;f&&TS(f);)l+=e,f=s[l];return f}}const une={}.hasOwnProperty;function OA(e){return n;function n(t,r,a){return une.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const AS=OA({body:fne,caption:u1,colgroup:u1,dd:gne,dt:mne,head:u1,html:dne,li:pne,optgroup:yne,option:xne,p:hne,rp:V_,rt:V_,tbody:vne,td:H_,tfoot:wne,th:H_,thead:bne,tr:Sne});function u1(e,n,t){const r=$r(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&TS(r.value.charAt(0)))}function dne(e,n,t){const r=$r(t,n);return!r||r.type!=="comment"}function fne(e,n,t){const r=$r(t,n);return!r||r.type!=="comment"}function hne(e,n,t){const r=$r(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function pne(e,n,t){const r=$r(t,n);return!r||r.type==="element"&&r.tagName==="li"}function mne(e,n,t){const r=$r(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function gne(e,n,t){const r=$r(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function V_(e,n,t){const r=$r(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function yne(e,n,t){const r=$r(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function xne(e,n,t){const r=$r(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function bne(e,n,t){const r=$r(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function vne(e,n,t){const r=$r(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function wne(e,n,t){return!$r(t,n)}function Sne(e,n,t){const r=$r(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function H_(e,n,t){const r=$r(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const Nne=OA({body:_ne,colgroup:kne,head:jne,html:Cne,tbody:Ene});function Cne(e){const n=$r(e,-1);return!n||n.type!=="comment"}function jne(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function _ne(e){const n=$r(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&TS(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function kne(e,n,t){const r=MA(t,n),a=$r(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&AS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function Ene(e,n,t){const r=MA(t,n),a=$r(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&AS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Gx={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function Tne(e,n,t,r){const a=r.schema,s=a.space==="svg"?!1:r.settings.omitOptionalTags;let l=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const f=[];let u;a.space==="html"&&e.tagName==="svg"&&(r.schema=DA);const d=Ane(r,e.properties),h=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,h&&(l=!1),(d||!s||!Nne(e,n,t))&&(f.push("<",e.tagName,d?" "+d:""),l&&(a.space==="svg"||r.settings.closeSelfClosing)&&(u=d.charAt(d.length-1),(!r.settings.tightSelfClosing||u==="/"||u&&u!=='"'&&u!=="'")&&f.push(" "),f.push("/")),f.push(">")),f.push(h),!l&&(!s||!AS(e,n,t))&&f.push("</"+e.tagName+">"),f.join("")}function Ane(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const s=Pne(e,a,n[a]);s&&t.push(s)}}for(;++r<t.length;){const s=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&s!=='"'&&s!=="'"&&(t[r]+=" ")}return t.join("")}function Pne(e,n,t){const r=Rte(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,s=e.settings.allowDangerousCharacters?0:1;let l=e.quote,f;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const u=Lh(r.attribute,Object.assign({},e.settings.characterReferences,{subset:Gx.name[a][s]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?sne:one)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?u:(e.settings.preferUnquoted&&(f=Lh(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Gx.unquoted[a][s]}))),f!==t&&(e.settings.quoteSmart&&U_(t,l)>U_(t,e.alternative)&&(l=e.alternative),f=l+Lh(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?Gx.single:Gx.double)[a][s],attribute:!0}))+l),u+(f&&"="+f))}const Dne=["<","&"];function LA(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Lh(e.value,Object.assign({},r.settings.characterReferences,{subset:Dne}))}function Ine(e,n,t,r){return r.settings.allowDangerousHtml?e.value:LA(e,n,t,r)}function Mne(e,n,t,r){return r.all(e)}const Rne=KT("type",{invalid:One,unknown:Lne,handlers:{comment:ine,doctype:ane,element:Tne,raw:Ine,root:Mne,text:LA}});function One(e){throw new Error("Expected node, not `"+e+"`")}function Lne(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const Fne={},$ne={},zne=[];function Bne(e,n){const t=n||Fne,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:Une,all:qne,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||Tte,characterReferences:t.characterReferences||$ne,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?DA:Fte,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function Une(e,n,t){return Rne(e,n,t,this)}function qne(e){const n=[],t=e&&e.children||zne;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const Vne={};function Hne(e){const n=this,{handlers:t,sanitize:r,...a}=e||Vne;let s=!1,l;typeof r=="boolean"?s=!r:r&&(l=r),n.compiler=f;function f(u,d){const h=Ete(u,{handlers:t,allowDangerousHtml:s}),g=s?h:Fee(h,l),b=Bne(g,{...a,allowDangerousHtml:s});return d.extname&&(d.extname=".html"),u&&u.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const Gne=()=>{var Cu,lc,cf;const{recordId:e}=Ti(),n=yt(),t=oi(),[r,a]=w.useState(""),[s]=w.useState([]),[l,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(void 0),[b,v]=w.useState(void 0),[S,k]=w.useState(null),[E,T]=w.useState(!1),[I,D]=w.useState(""),[q,F]=w.useState(!1),[$,B]=w.useState(null),[z,U]=w.useState(null),[L,R]=w.useState(!1),[G,ee]=w.useState(!1),[te,oe]=w.useState(null),[K,V]=w.useState(""),[J,ne]=w.useState(""),[A,ae]=w.useState(null),[ce,M]=w.useState(!1),[de,Se]=w.useState(!1),[fe,we]=w.useState(null),[ie,_e]=w.useState(!1),[Ve,tt]=w.useState(null),[Ke,Oe]=w.useState(window.innerHeight),[xe,Me]=w.useState([]),[ve,Ee]=w.useState(!1),[Pe,rt]=w.useState(null),[lt,Ze]=w.useState([]),[Rt,kt]=w.useState([]),[on,se]=w.useState(!1),[Q,re]=w.useState(null),je=w.useRef(null),Ae=w.useRef(null),Ue=w.useRef(!1),ot=w.useRef(null),mt=w.useRef(null),[ft,Be]=w.useState(33.33),[Xe,Fe]=w.useState(!1),st=w.useRef(null),Je=w.useRef(null),xt=150,[Vn,$n]=w.useState([]),[_n,yn]=w.useState([]),[fn,_r]=w.useState(!1),[Wr,li]=w.useState(null),[ha,Pi]=w.useState(!1),[ir,Zn]=w.useState(null),[zn,Ua]=w.useState(!1),[fs,rp]=w.useState(null),[ip,Xd]=w.useState(!1),[hs,ou]=w.useState(null),[Qs,Js]=w.useState(!1),[qa,Ks]=w.useState(null),[dr,Zd]=w.useState(!1),[ql,ps]=w.useState(null),[Va,Qr]=w.useState([]),[Xs,Ha]=w.useState(!1),[ef,Yo]=w.useState(null),[Zs,ci]=w.useState(!1),[Wo,Vl]=w.useState(null),[pa,lu]=w.useState({}),[cu,tf]=w.useState(!1),[uu,zr]=w.useState(!1),[eo,Hl]=w.useState(!1),[ms,Gl]=w.useState(!1),[Bi,du]=w.useState(!1),[Mr,Qo]=w.useState(!1),[to,no]=w.useState(!1),[ma,ro]=w.useState(!1),gs=w.useMemo(()=>(u==null?void 0:u.admission_date)&&!(u!=null&&u.discharge_date),[u]),[ga,ya]=w.useState(!1),[Jo,Ko]=w.useState(""),[Xo,Yl]=w.useState(void 0),[Wl,ys]=w.useState(void 0),[io,Zo]=w.useState(void 0),[Br,Ga]=w.useState(!1),[Ql,xa]=w.useState(null),[ao,el]=w.useState(!1),ui=w.useRef(null),[so,xs]=w.useState(null),[Ui,Jl]=w.useState(null),bs=w.useRef(null),[nf]=w.useState("Loading..."),[xn,cn]=w.useState(!1),[Kl,Rr]=w.useState(!1),[Kt,oo]=w.useState(null),[Ya,fu]=w.useState(""),[Wa,vs]=w.useState(""),[er,ws]=w.useState(!0),[Jr,hu]=w.useState(!1),[tl,Or]=w.useState(!1),[ba,pu]=w.useState(!1),Xl=w.useRef(null),Ss=async he=>{try{const be=await ge(`/api/patients/${he}`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`Failed to fetch patient details: ${be.status}`)}const W=await be.json();if(d(W),g(W.age),v(W.gender),V(W.ai_response||""),d(ue=>ue?{...ue,current_status:W.current_status,admission_date:W.admission_date,discharge_date:W.discharge_date}:{...W,current_status:W.current_status,admission_date:W.admission_date,discharge_date:W.discharge_date}),W.insurance_type&&d(ue=>ue?{...ue,insurance_type:W.insurance_type}:{...W}),nl(he),W.ai_response){const ue=/```json\s*([\s\S]*?)\s*```/,me=W.ai_response.match(ue);if(me&&me[1])ne(W.ai_response.replace(ue,"").trim()),ae(me[1].trim());else{const $e=W.ai_response.trim();if($e.startsWith("{")&&$e.endsWith("}"))try{JSON.parse($e),ne(""),ae($e)}catch{ne($e),ae(null)}else if($e.startsWith("[")&&$e.endsWith("]"))try{JSON.parse($e),ne(""),ae($e)}catch{ne($e),ae(null)}else ne($e),ae(null)}}else ne(""),ae(null)}catch{d(null),V(""),ne(""),ae(null)}},rf=async(he,be)=>{d(W=>W?{...W,insurance_type:be}:null);try{const W=await ge(`/api/patients/${he}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:be})});if(!W.ok){const ue=await W.json();throw new Error(ue.message||"Failed to update insurance type")}}catch(W){console.error("Error updating insurance type:",W),he&&Ss(he)}},mu=async he=>{se(!0),re(null),kt([]);try{const be=await ge(`/api/queue/patient/${he}/complaints`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`HTTP error! status: ${be.status}`)}const W=await be.json();kt(W||[])}catch(be){re(`Past complaints error: ${be.message}`)}finally{se(!1)}},fr=async he=>{Ze([]);try{const be=await ge(`/api/pharmacy-orders/patient/${he}`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`HTTP error! status: ${be.status}`)}const W=await be.json();Ze(W||[])}catch{}},Zl=async he=>{Ha(!0),Yo(null),Qr([]);try{const be=await ge(`/api/lab/orders/patient/${he}`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`HTTP error! status: ${be.status}`)}const W=await be.json();Qr(W||[])}catch(be){Yo(`Pending labs error: ${be.message}`)}finally{Ha(!1)}},Ur=async he=>{Ee(!0),rt(null),Me([]);try{const be=await ge(`/api/lab/patient/${he}`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`HTTP error! status: ${be.status}`)}const W=await be.json();Me(W||[])}catch(be){rt(`Lab reports error: ${be.message}`)}finally{Ee(!1)}},ap=async he=>{R(!0),se(!0),Ha(!0),Ee(!0),Ze([]);try{const be=await ge(`/api/patients/${he}/context`);if(!be.ok){const me=await be.json().catch(()=>({}));throw new Error(me.message||`Failed to fetch patient context: ${be.status}`)}const W=await be.json(),ue=W.patient;if(d(ue),g(ue.age),v(ue.gender),V(ue.ai_response||""),nl(he),ue.ai_response){const me=/```json\s*([\s\S]*?)\s*```/,$e=ue.ai_response.match(me);if($e&&$e[1])ne(ue.ai_response.replace(me,"").trim()),ae($e[1].trim());else{const Qe=ue.ai_response.trim();if(Qe.startsWith("{")&&Qe.endsWith("}"))try{JSON.parse(Qe),ne(""),ae(Qe)}catch{ne(Qe),ae(null)}else if(Qe.startsWith("[")&&Qe.endsWith("]"))try{JSON.parse(Qe),ne(""),ae(Qe)}catch{ne(Qe),ae(null)}else ne(Qe),ae(null)}}else ne(""),ae(null);kt(W.pastComplaints||[]),Ze(W.pharmacyOrders||[]),Qr(W.labOrders||[]),Me(W.labReports||[])}catch(be){console.error("Error fetching patient context:",be),oe(be.message),d(null),V(""),ne(""),ae(null),kt([]),Ze([]),Qr([]),Me([])}finally{R(!1),se(!1),Ha(!1),Ee(!1)}},nl=async he=>{try{const be=await ge(`/api/queue/patient/${he}/latest`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`Failed to fetch queue status: ${be.status}`)}const W=await be.json();if(W){const ue=new Date(W.createdAt),me=new Date,$e=ue.getDate()===me.getDate()&&ue.getMonth()===me.getMonth()&&ue.getFullYear()===me.getFullYear(),Qe=["waiting","consulting"].includes(W.status);ro($e&&Qe)}else ro(!1)}catch(be){console.error("Error checking patient queue status:",be),ro(!1)}},qi=he=>{n(`/dashboard/edit-pharmacy-order/${he}`)},ec=he=>{oe(null),console.log(`Preparing billing navigation for order: ${he}`);const be=lt.find(W=>W.id===he);if(be){const W=be.medications.map(ue=>{const me=ue.price??0;return(ue.price===void 0||ue.price===null)&&console.warn(`Medication "${ue.name}" in order ${he} is missing a price. Defaulting to 0.`),{name:ue.name,pack_quantity:ue.pack_quantity,loose_quantity:ue.loose_quantity,price:me,pack_price:ue.pack_price,loose_price:ue.loose_price,total_price:Number(ue.total_price)||0,isLoose:ue.isLoose,unit:ue.unit,drug_id:ue.drug_id?String(ue.drug_id):null,tabletsPerDay:ue.tabletsPerDay,numberOfDays:ue.numberOfDays,directions_to_use:ue.directions_to_use,discount_percentage:ue.discount_percentage??0,batch:ue.batch,expiry_date:ue.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:W}),n(`/dashboard/pharmacy-billing/${he}`,{state:{initialItems:W}})}else console.error(`Order with ID ${he} not found.`),oe(`Order with ID ${he} not found.`),alert(`Error: Could not find order ${he} to bill.`)},gu=async(he,be)=>{oe(null);const W=lt.find(me=>me.id===he);if(!W){oe(`Order with ID ${he} not found.`);return}const ue={status:be,medications:W.medications};try{const me=await ge(`/api/pharmacy-orders/${he}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ue)});if(!me.ok){const Qe=await me.text();throw new Error(`Failed to update status: ${me.statusText} (${me.status}) - ${Qe}`)}const $e=await me.json();Ze(Qe=>Qe.map(nt=>nt.id===$e.id?$e:nt)),l&&fr(l)}catch(me){console.error("Failed to update order status:",me),oe(me.message||`Failed to update status for order ${he}.`),alert(`Error updating status for order ${he}: ${me.message||"Please try again."}`)}},Rn=async he=>{oe(null);try{const be=await ge(`/api/pharmacy-orders/${he}/recurring`,{method:"POST"});if(!be.ok){const W=await be.json().catch(()=>({}));throw new Error(W.message||"Failed to mark order as recurring")}alert("Order marked as recurring successfully!")}catch(be){console.error("Failed to mark order as recurring:",be),oe(be.message||`Failed to mark order ${he} as recurring.`),alert(`Error: ${be.message||"Please try again."}`)}},va=he=>{Qr(be=>be.map(W=>W.id===he?{...W,isEditing:!0,editedTests:[...W.tests],editedStatus:W.status}:{...W,isEditing:!1}))},yu=he=>{Qr(be=>be.map(W=>W.id===he?{...W,isEditing:!1,editedTests:void 0,editedStatus:void 0}:W))},sp=(he,be,W,ue)=>{Qr(me=>me.map($e=>{if($e.id===he){const Qe=$e.editedTests?[...$e.editedTests]:[...$e.tests];if(W==="add")return{...$e,editedTests:[...Qe,{id:"",name:"",price:0}]};if(W==="remove")return{...$e,editedTests:ue};if(be!==-1){const nt={...Qe[be],[W]:ue};return Qe[be]=nt,{...$e,editedTests:Qe}}}return $e}))},xu=(he,be)=>{Qr(W=>W.map(ue=>ue.id===he?{...ue,editedStatus:be}:ue))},op=he=>{if(!he||!he.id){console.error("Cannot navigate to billing: Lab Order data or ID is missing."),alert("Could not open billing page: Lab Order information is missing.");return}n("/lab-billing",{state:{labOrderId:he.id}})},af=he=>{he&&he.id?n(`/lab/report/${he.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the lab report page: Lab Order information is missing."))},lp=async(he,be,W)=>{Hl(!0),oe(null);try{if(!be||be.length===0)throw new Error("Lab order must have at least one test.");for(const $e of be)if(!$e.id||!$e.name||isNaN($e.price)||$e.price<0)throw new Error(`Invalid test data: ${JSON.stringify($e)}. Each test must have id, name, and a valid price.`);const ue={tests:be,status:W},me=await ge(`/api/lab/orders/${he}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ue)});if(!me.ok){const $e=await me.json().catch(()=>({}));throw new Error($e.message||`Failed to update lab order: ${me.statusText}`)}l&&Zl(l),Qr($e=>$e.map(Qe=>Qe.id===he?{...Qe,isEditing:!1,editedTests:void 0,editedStatus:void 0}:Qe))}catch(ue){oe(`Lab Order Save Error: ${ue.message}`)}finally{Hl(!1)}},rl=async he=>{if(!window.confirm(`Are you sure you want to delete this ${he.type.toLowerCase()} record? This action cannot be undone.`))return;ci(!0),Vl(null);let W=null,ue;const me=he.type;try{switch(me){case"Complaint":if(ue=he.data.id,!ue)throw new Error("Complaint ID is missing.");W=`/api/patients/complaints/${ue}`;break;case"Lab Order":if(ue=he.data.id,!ue)throw new Error("Lab Order ID is missing.");W=`/api/lab/orders/${ue}`;break;case"Lab Report":if(ue=he.data.reportId,!ue)throw new Error("Lab Report ID is missing.");W=`/api/lab/reports/${ue}`;break;case"Pharmacy Order":if(ue=he.data.id,!ue)throw new Error("Pharmacy Order ID is missing.");W=`/api/pharmacy-orders/${ue}`;break;default:throw new Error(`Deletion not supported for item type: ${me}`)}if(!W)throw new Error(`Could not determine delete URL for type: ${me}`);const $e=await ge(W,{method:"DELETE"});if(!$e.ok){const Qe=await $e.json().catch(()=>({}));throw new Error(Qe.message||`Failed to delete ${me}: ${$e.statusText}`)}l&&(me==="Complaint"?mu(l):me==="Lab Order"?(Zl(l),Ur(l)):me==="Lab Report"?Ur(l):me==="Pharmacy Order"&&fr(l))}catch($e){Vl(`Delete Error (${me}): ${$e.message}`),Zs&&ci(!1)}finally{ci(!1)}},tc=async()=>{if(!l)return;if(lt.filter(be=>be.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Rr(!0);try{const be=await ge(`/api/pharmacy-orders/patient/${l}/merge-pending`,{method:"POST"});if(!be.ok){const W=await be.json().catch(()=>({}));throw new Error(W.message||"Failed to merge orders")}fr(l)}catch(be){oe(`Merge Error: ${be.message}`)}finally{Rr(!1)}},Kr=w.useMemo(()=>{if(!l||!Rt)return[];const he=Rt.map(be=>({date:new Date(be.createdAt),type:"Complaint",data:be,originalDateString:be.createdAt})).filter(be=>!isNaN(be.date.getTime()));return he.sort((be,W)=>W.date.getTime()-be.date.getTime()),he},[l,Rt]),Vi=w.useMemo(()=>{if(!l)return[];const he=new Map;(Va??[]).forEach(W=>{he.set(W.id,{...W})}),(xe??[]).forEach(W=>{if(!he.has(W.id))he.set(W.id,{id:W.id,patient_id:W.patient_id,tests:W.tests,status:W.status,createdAt:W.createdAt,report:W});else{const ue=he.get(W.id);ue&&(ue.report=W,ue.status=W.status)}});let be=Array.from(he.values());return be.sort((W,ue)=>new Date(W.createdAt).getTime()-new Date(ue.createdAt).getTime()),be=be.map((W,ue)=>({...W,serialNumber:ue+1})),be.map(W=>({date:new Date(W.createdAt),type:"Lab Order",data:W,originalDateString:W.createdAt}))},[l,Va,xe]),qr=w.useMemo(()=>{if(!l||!lt)return[];const he=lt.map(be=>({date:new Date(be.date),type:"Pharmacy Order",data:be,originalDateString:be.date})).filter(be=>!isNaN(be.date.getTime()));return he.sort((be,W)=>W.date.getTime()-be.date.getTime()),he},[l,lt]),[bu,il]=w.useState(null),[al,nc]=w.useState([]),[rc,sl]=w.useState(""),wa=(he,be)=>{if(!he||!he.report_content||!be)return"";try{const W=JSON.parse(he.report_content||"{}");if(typeof W!="object"||W===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${he.report_content}</pre>`;let ue="";return be.forEach(me=>{W[me.id]?(ue+=`<h5 class="font-semibold text-sm mt-2 mb-1">${me.name}</h5>`,ue+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(W[me.id]).map(([$e,Qe])=>{var Ht;const nt=(Ht=me.default_parameters)==null?void 0:Ht.find(fo=>fo.name===$e);let Xt="N/A";nt&&nt.type==="number"&&(nt.lower_limit!=null||nt.upper_limit!=null)?(Xt="",nt.lower_limit!=null&&(Xt+=` > ${nt.lower_limit}`),nt.lower_limit!=null&&nt.upper_limit!=null&&(Xt+=" - "),nt.upper_limit!=null&&(Xt+=` < ${nt.upper_limit}`),Xt=Xt.trim()||"N/A"):(nt==null?void 0:nt.type)==="boolean"?Xt="N/A":nt!=null&&nt.normal_range&&(Xt=nt.normal_range),ue+=`<tr><td>${$e}</td><td>${String(Qe)} ${(nt==null?void 0:nt.unit)||""}</td><td>${Xt}</td></tr>`}),ue+="</tbody></table>"):ue+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${me.name}.</p>`}),ue}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${he.report_content}</pre>`}};w.useEffect(()=>{const he=()=>{Oe(window.innerHeight)};return window.addEventListener("resize",he),he(),()=>window.removeEventListener("resize",he)},[]),w.useEffect(()=>{const he=W=>{if(!Xe||!Je.current||!st.current)return;const ue=st.current.getBoundingClientRect(),$e=W.clientX-Je.current.x;let Qe=Je.current.initialWidth-$e;const nt=ue.width-xt-10;Qe=Math.max(xt,Qe),Qe=Math.min(Qe,nt);const Xt=Qe/ue.width*100;Be(Xt)},be=()=>{Fe(!1),Je.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return Xe&&(window.addEventListener("mousemove",he),window.addEventListener("mouseup",be),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",he),window.removeEventListener("mouseup",be),document.body.style.cursor="",document.body.style.userSelect=""}},[Xe]);const cp=he=>{if(!st.current)return;he.preventDefault();const be=st.current.querySelector(".edit-complaint-context-column");be&&(Je.current={x:he.clientX,initialWidth:be.offsetWidth},Fe(!0))},vu=w.useCallback(async()=>{ee(!0),oe(null);try{const he=await ge("/api/queue/doctor/new",{method:"POST"});if(!he.ok){const W=await he.json().catch(()=>({}));throw new Error(W.message||`Failed to create record: ${he.statusText}`)}const be=await he.json();if(!be.recordId)throw new Error("New record ID not received from server.");n(`/edit-complaint/${be.recordId}`,{replace:!0})}catch(he){oe(`Failed to create new complaint record: ${he.message}`)}finally{ee(!1)}},[n]);w.useEffect(()=>{(async()=>{ws(!0);try{const be=await ge("/api/clinics/settings");if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||"Failed to fetch clinic settings.")}const W=await be.json();oo({admissionCharge:parseFloat(W.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(W.perDayCharge||0).toFixed(2),otherCharges:parseFloat(W.otherCharges||0).toFixed(2),aiMemory:W.aiMemory||"",aiMemoryUpdatedAt:W.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:W.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:W.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:W.gemini_api_key||""}),fu(W.aiMemory||""),vs(W.clinicWideSystemPrompt||"")}catch{}finally{ws(!1)}})()},[]),w.useEffect(()=>{var be,W;(be=t.state)!=null&&be.patientId&&f(Number(t.state.patientId)),(W=t.state)!=null&&W.initialComplaint&&a(t.state.initialComplaint),e?(async ue=>{var me;R(!0),oe(null);try{const $e=await ge(`/api/queue/doctor/complaint/${ue}`);if(!$e.ok){const nt=await $e.json().catch(()=>({}));throw new Error(nt.message||`HTTP error! status: ${$e.status}`)}const Qe=await $e.json();f(nt=>nt===Qe.patientId?nt:Qe.patientId),g(Qe.age),v(Qe.gender),k(Qe.case_summary||null),U(Qe.updatedAt||null)}catch{oe("Failed to load current complaint details."),(me=t.state)!=null&&me.patientId||f(null),g(void 0),v(void 0),k(null),U(null)}finally{R(!1)}})(e):vu()},[e,vu,(Cu=t.state)==null?void 0:Cu.initialComplaint,(lc=t.state)==null?void 0:lc.patientId]),w.useEffect(()=>{l?ap(l):(d(null),kt([]),Ze([]),Qr([]),Me([]),U(null),ro(!1))},[l]),w.useEffect(()=>{var W;const he=(W=t.state)==null?void 0:W.initialComplaint;he&&e&&(!L&&!on&&!Xs&&!ve&&!fn)&&!Ue.current&&r===he&&(Ue.current=!0,Sa(),n(t.pathname,{replace:!0,state:{}}))},[(cf=t.state)==null?void 0:cf.initialComplaint,e,r,L,on,Xs,ve,fn,n]);const Xr=()=>{D(S||""),T(!0),B(null)},ic=()=>{T(!1),D(""),B(null)},lo=async()=>{if(!e){B("Missing Record ID.");return}F(!0),B(null);try{const he=await ge(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:I.trim()})});if(!he.ok){const W=await he.json().catch(()=>({}));throw new Error(W.message||`Failed to save case summary: ${he.statusText}`)}const be=await he.json();k(be.case_summary||I.trim()),U(be.updatedAt||null),T(!1)}catch(he){B(`Save Error: ${he.message}`)}finally{F(!1)}};w.useEffect(()=>{(async()=>{_r(!0),li(null);try{const[be,W]=await Promise.all([ge("/api/drugs"),ge("/api/lab-tests")]);if(!be.ok)throw new Error(`Pharmacy inventory error! status: ${be.status}`);const ue=await be.json();if($n(ue||[]),!W.ok)throw new Error(`Lab inventory error! status: ${W.status}`);const me=await W.json();yn(me||[])}catch(be){li(be.message)}finally{_r(!1)}})()},[]);const co=async()=>{if(!Kt)return;if(Ya===Kt.aiMemory&&Wa===Kt.clinicWideSystemPrompt){Or(!1);return}const he=Ya!==Kt.aiMemory,be=Wa!==Kt.clinicWideSystemPrompt;he&&hu(!0),be&&pu(!0);try{const W={...Kt};he&&(W.aiMemory=Ya),be&&(W.clinicWideSystemPrompt=Wa);const ue=await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify(W)});if(!ue.ok){const $e=await ue.json().catch(()=>({}));throw new Error($e.message||"Failed to update clinic settings.")}const me=await ue.json();oo({admissionCharge:parseFloat(me.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(me.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(me.settings.otherCharges).toFixed(2),aiMemory:me.settings.aiMemory||"",aiMemoryUpdatedAt:me.settings.aiMemoryUpdatedAt||(Kt==null?void 0:Kt.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:me.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:me.settings.clinicWideSystemPromptUpdatedAt||(Kt==null?void 0:Kt.clinicWideSystemPromptUpdatedAt)||null}),he&&fu(me.settings.aiMemory||""),be&&(vs(me.settings.clinicWideSystemPrompt||""),Or(!1))}catch{}finally{he&&hu(!1),be&&pu(!1)}},uo=()=>{Kt&&(vs(Kt.clinicWideSystemPrompt||""),Or(!0))},up=()=>{Or(!1),Kt&&vs(Kt.clinicWideSystemPrompt||"")},Sa=async he=>{const be=he??r;Xl.current&&await Xl.current.callGenerativeApi(be)},sf=he=>{navigator.clipboard.writeText(he).then(()=>{}).catch(be=>{console.error("Failed to copy text: ",be)})},ac=(he,be)=>{const W=window.open("","_blank");W&&(W.document.write(`
        <html>
          <head>
            <title>${be}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${be}</h2>
            <div id="print-content">${he}</div>
          </body>
        </html>
      `),W.document.close(),W.print())},wu=()=>{if(K){const he=Iee().use(Dl).use(Hne).processSync(J).toString();ac(`<div class="prose">${he}</div>`,"AI Response")}};w.useEffect(()=>{if(u){let he=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${u.name||"N/A"}</p>
          <p><strong>Token:</strong> ${u.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${u.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${u.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${u.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${u.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${u.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${u.admission_date?new Date(u.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${u.discharge_date?new Date(u.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${S||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${Kr.length>0?`
            <ul>
              ${Kr.map(be=>`<li>${new Date(be.originalDateString).toLocaleDateString()}: ${be.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${qr.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${qr.map(be=>be.data.medications.map((W,ue)=>`
                    <tr>
                      ${ue===0?`<td rowspan="${be.data.medications.length}">${new Date(be.originalDateString).toLocaleDateString()}</td>`:""}
                      ${ue===0?`<td rowspan="${be.data.medications.length}">${be.data.status}</td>`:""}
                      <td><strong>${W.name}</strong></td>
                      <td>
                        ${W.pack_quantity!==void 0&&W.pack_quantity>0?`Packs: ${W.pack_quantity}`:""}
                        ${W.pack_quantity!==void 0&&W.pack_quantity>0&&W.loose_quantity!==void 0&&W.loose_quantity>0?", ":""}
                        ${W.loose_quantity!==void 0&&W.loose_quantity>0?`Loose: ${W.loose_quantity}`:""}
                      </td>
                      <td>${W.tabletsPerDay&&W.numberOfDays?`${W.tabletsPerDay} tab/day for ${W.numberOfDays} days`:"N/A"}</td>
                      <td>${W.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${Vi.length>0?`
            ${Vi.map(be=>{const W=be.data.tests.map(me=>me.name).join(", ");let ue="";return be.data.report&&(ue=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(be.data.report.report_date).toLocaleDateString()})</h4>
                    ${wa(be.data.report,be.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(be.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${be.data.status}</p>
                  <p><strong>Tests:</strong> ${W}</p>
                  ${ue}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;sl(he)}else sl("")},[u,S,Kr,qr,Vi,wa]);const Qa=()=>{rc&&ac(rc,`Patient Details - ${u==null?void 0:u.name}`)},of=he=>{a(he),il(null),nc([]),setTimeout(()=>{Sa(he)},0)},Hi=L||de||ie||G||Br||eo||Zs||ms||Bi||Mr||to||Kl,sc=()=>{a("reports came,please anaylse"),setTimeout(()=>{Sa()},0)},Su=he=>{lu(be=>({...be,[he]:!be[he]}))},Ja=he=>{he.key==="Enter"&&!he.shiftKey&&(he.preventDefault(),!Hi&&!fn&&!G&&r.trim()&&e&&Sa())};w.useEffect(()=>{const he=window.SpeechRecognition||window.webkitSpeechRecognition;if(!he){xs("Speech recognition not supported in this browser.");return}const be=new he;return be.continuous=!0,be.interimResults=!0,be.lang="en-US",be.onresult=W=>{let ue="";for(let me=W.resultIndex;me<W.results.length;++me)W.results[me].isFinal&&(ue+=W.results[me][0].transcript);ue&&a(me=>me+(me.endsWith(" ")||me===""?"":" ")+ue)},be.onerror=W=>{xs(`Speech error: ${W.error}`),el(!1)},be.onend=()=>{},ui.current=be,()=>{ui.current&&ui.current.stop()}},[]);const oc=async()=>{if(l)if(gs){du(!0);try{const he=await ge(`/api/patients/${l}/discharge`,{method:"POST"});if(!he.ok){const be=await he.json().catch(()=>({}));throw new Error(be.message||`Failed to discharge patient: ${he.status}`)}Ss(l)}catch(he){oe(`Discharge Error: ${he.message}`)}finally{du(!1)}}else{Gl(!0);try{const he=await ge(`/api/patients/${l}/admit`,{method:"POST"});if(!he.ok){const be=await he.json().catch(()=>({}));throw new Error(be.message||`Failed to admit patient: ${he.status}`)}Ss(l)}catch(he){oe(`Admit Error: ${he.message}`)}finally{Gl(!1)}}},dp=async he=>{if(l){Qo(!0);try{const W=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l})});if(!W.ok){const ue=await W.json().catch(()=>({}));throw new Error(ue.message||`Failed to add patient to ${he} queue: ${W.status}`)}alert(`Patient added to ${he} queue successfully!`),l&&(Ss(l),nl(l))}catch(be){oe(`Add to Queue Error: ${be.message}`)}finally{Qo(!1)}}},fp=async()=>{if(e){no(!0),oe(null);try{const he=await ge(`/api/queue/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!he.ok){const be=await he.json().catch(()=>({}));throw new Error(be.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),l&&(Ss(l),nl(l))}catch(he){oe(`Error completing consultation: ${he.message}`)}finally{no(!1)}}},Zr=async()=>{if(!l){xa("Missing Patient ID.");return}if(!u){xa("Patient details not loaded.");return}Ga(!0),xa(null);try{const he={};let be=!1;if(Jo!==u.name&&(he.name=Jo,be=!0),Xo!==u.age&&(he.age=Xo,be=!0),Wl!==u.gender&&(he.gender=Wl,be=!0),io!==u.phone&&(he.phone=io,be=!0),!be){xa("No changes detected."),Ga(!1),ya(!1);return}const W=await ge(`/api/patients/${l}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)});if(!W.ok){const me=await W.json().catch(()=>({}));throw new Error(me.message||`Failed to update patient details: ${W.statusText}`)}const ue=await W.json();d(ue),g(ue.age),v(ue.gender),Ko(ue.name),Yl(ue.age),ys(ue.gender),Zo(ue.phone),ya(!1)}catch(he){xa(`Save Error: ${he.message}`)}finally{Ga(!1)}},Gi=w.useCallback(()=>{if(!u)return null;const he={token_number:u.patient_token_number||"N/A",name:u.name||"N/A",age:u.age||"N/A",gender:u.gender||"N/A",phone:u.phone||"N/A"};return Kr.length>0?he.complaints_history=Kr.map(be=>`${be.data.complaint} (${new Date(be.originalDateString).toLocaleDateString()})`).join("; "):he.complaints_history="No past complaints.",qr.length>0?he.pharmacy_orders_history=qr.map(be=>`Order: ${be.data.medications.map(ue=>{let me=`${ue.name}`;return ue.pack_quantity!==void 0&&ue.pack_quantity>0&&(me+=` Packs: ${ue.pack_quantity}`),ue.loose_quantity!==void 0&&ue.loose_quantity>0&&(me+=` Loose: ${ue.loose_quantity}`),me}).join(", ")} (${be.data.status}, ${new Date(be.originalDateString).toLocaleDateString()})`).join("; "):he.pharmacy_orders_history="No pharmacy orders.",Vi.length>0?he.lab_orders_history=Vi.map(be=>{let ue=`Lab Order: ${be.data.tests.map(me=>me.name).join(", ")} (${be.data.status}, ${new Date(be.originalDateString).toLocaleDateString()})`;return be.data.report&&(ue+=` - Report: ${be.data.report.report_content} (${new Date(be.data.report.report_date).toLocaleDateString()})`),ue}).join("; "):he.lab_orders_history="No lab history.",he},[u,Kr,qr,Vi]),di=()=>{if(!u){xs("Patient details are required to use the Live API.");return}cn(!0)},Nu=()=>{var he;(he=bs.current)==null||he.click()},lf=he=>{var W;const be=(W=he.target.files)==null?void 0:W[0];be&&Jl(be)};return i.jsxs("div",{className:"edit-complaint-page",style:{height:`${Ke}px`},children:[i.jsx(XJ,{ref:Xl,recordId:e,patientId:l,patientDetails:u,caseSummary:S,caseSummaryUpdatedAt:z,clinicSettings:Kt,userMessages:s,selectedImageFile:Ui,pendingLabOrders:Va,labReports:xe,pastComplaints:Rt,pharmacyOrders:lt,pharmacyInventory:Vn,labInventory:_n,setCurrentComplaint:a,setAiResponse:V,setAiResponseText:ne,setAiResponseJsonString:ae,setShowAiJsonDetails:M,setIsLoadingAi:Se,setAiError:we,setIsSubmittingAiOrder:Pi,setAiOrderSubmissionStatus:Zn,setIsSubmittingAiLabOrder:Ua,setAiLabOrderSubmissionStatus:rp,setIsSubmittingAiComplaint:Xd,setAiComplaintSubmissionStatus:ou,setIsUpdatingCaseSummary:Js,setAiCaseSummaryUpdateStatus:Ks,setCaseSummary:k,setCaseSummaryUpdatedAt:U,setIsUpdatingAiMemoryByAI:Zd,setAiMemoryUpdateByAIStatus:ps,setFollowUpQuestion:il,setFollowUpOptions:nc,setError:oe,setIsSavingAiResponse:_e,setSaveAiResponseError:tt,fetchPharmacyOrdersData:fr,fetchPendingLabOrdersData:Zl,fetchLabReportsData:Ur,fetchPastComplaintsData:mu,fetchPatientDetails:Ss,setClinicSettings:oo,setEditedAiMemory:fu,handleDeleteItem:rl}),xn&&u&&i.jsx(kE,{onClose:()=>cn(!1),patientData:Gi(),tokenNumber:u.patient_token_number?String(u.patient_token_number):null,onAiSummaryChange:he=>{he&&(a(he),Sa(he),cn(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>n(-1),disabled:Hi,className:"back-button",title:"Go Back",children:i.jsx(Lt,{size:18})}),i.jsx("span",{ref:mt,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),L&&!u&&i.jsx("div",{className:"edit-complaint-patient-details skeleton",style:{width:"300px",height:"2.5rem"}}),u&&i.jsx("div",{className:"edit-complaint-patient-details",children:u&&!ga?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{ya(!0),Ko(u.name||""),Yl(u.age),ys(u.gender),Zo(u.phone),xa(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:Br,children:i.jsx(Md,{size:14})}),u.name??"N/A",u.patient_token_number!==null&&u.patient_token_number!==void 0&&` (${u.patient_token_number})`," - ",u.age??"N/A"," / ",u.gender??"N/A",u.phone&&` / ${u.phone}`]}):u&&ga?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:Jo,onChange:he=>Ko(he.target.value),placeholder:"Name",className:"edit-input",disabled:Br}),i.jsx("input",{type:"number",value:Xo??"",onChange:he=>Yl(he.target.value?parseInt(he.target.value):null),placeholder:"Age",className:"edit-input",disabled:Br}),i.jsxs("select",{value:Wl??"",onChange:he=>ys(he.target.value||null),className:"edit-input",disabled:Br,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:io??"",onChange:he=>Zo(he.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Br}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{ya(!1),xa(null)},className:"button-secondary",disabled:Br,children:"Cancel"}),i.jsx("button",{onClick:Zr,className:"button-primary blue",disabled:Br,children:Br?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]}),Ql&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:Ql})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[h??"N/A"," / ",b??"N/A"]})}),!u&&h!==void 0&&b!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[h??"N/A"," / ",b??"N/A"]}),i.jsx("div",{style:{width:"64px"}})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:st,children:[i.jsxs("div",{className:"edit-complaint-main-column",style:{flexBasis:`calc(${100-ft}% - 5px)`},children:[te&&i.jsxs("div",{className:"general-error-message",children:["Error: ",te]}),G&&i.jsx("div",{className:"ai-function-status info text-center",children:"Creating record..."}),de&&i.jsxs("div",{className:"loading-animation-container",children:[i.jsx("div",{className:"spinner"}),i.jsx("div",{className:"loading-text loading-dots",children:nf})]}),fe&&i.jsx("div",{className:"ai-error-message",children:fe}),ir&&i.jsxs("div",{className:`ai-function-status ${ir.toLowerCase().includes("error:")?"error":ir.toLowerCase().startsWith("order created")||ir.toLowerCase().startsWith("success:")?"success":"info"}`,children:[ha&&i.jsx("span",{className:"animate-spin",role:"status"}),ir]}),fs&&i.jsxs("div",{className:`ai-function-status ${fs.toLowerCase().includes("error:")?"error":fs.toLowerCase().startsWith("success:")||fs.toLowerCase().startsWith("lab order created")?"success":"info"}`,children:[zn&&i.jsx("span",{className:"animate-spin",role:"status"}),fs]}),hs&&i.jsxs("div",{className:`ai-function-status ${hs.toLowerCase().includes("error:")?"error":"info"}`,children:[ip&&i.jsx("span",{className:"animate-spin",role:"status"}),hs]}),qa&&i.jsxs("div",{className:`ai-function-status ${qa.toLowerCase().includes("error:")?"error":"info"}`,children:[Qs&&i.jsx("span",{className:"animate-spin",role:"status"}),qa]}),ql&&i.jsxs("div",{className:`ai-function-status ${ql.toLowerCase().includes("error:")?"error":"info"}`,children:[dr&&i.jsx("span",{className:"animate-spin",role:"status"}),ql]}),Ve&&i.jsxs("div",{className:"general-error-message",children:["Error saving AI response: ",Ve]}),ie&&i.jsx("div",{className:"ai-function-status info text-center",children:"Saving AI response..."}),(J||A)&&i.jsxs("div",{ref:je,className:`${A?"ai-function-call-block":"ai-response-container"} group`,children:[J&&i.jsx(Qc,{remarkPlugins:[Dl],children:J}),A&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>M(!ce),className:"ai-json-toggle-button",children:[ce?i.jsx(g1,{size:14,className:"mr-1"}):i.jsx(db,{size:14,className:"mr-1"}),ce?"Hide":"Show"," AI Function Call Details"]}),ce&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(A),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>sf(K),disabled:!K,title:"Copy Full AI Response",children:i.jsx(mM,{size:12})}),i.jsx("button",{onClick:wu,disabled:!K,title:"Print AI Response",children:i.jsx(Bs,{size:12})})]})]})]}),i.jsx("div",{className:"draggable-divider",onMouseDown:cp}),i.jsx("div",{className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-ft}% - 5px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsxs("h3",{className:"ai-context-header",children:[i.jsx("span",{children:"AI Context:"}),i.jsx("div",{className:"ai-context-actions-top",children:i.jsxs("button",{onClick:Qa,disabled:!rc,title:"Print All Patient Details",className:"context-action-button",children:[i.jsx(Bs,{size:14})," Print"]})}),(u==null?void 0:u.insurance_type)&&i.jsx("div",{className:"insurance-type-container mt-2",children:i.jsxs("select",{ref:ot,value:u.insurance_type,onChange:he=>rf(u.id,he.target.value),className:"insurance-type-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),L&&!u?i.jsxs("div",{className:"space-y-2 mt-2",children:[i.jsx("div",{className:"skeleton-text"}),i.jsx("div",{className:"skeleton-text short"})]}):i.jsxs(i.Fragment,{children:[(u==null?void 0:u.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(u.admission_date).toLocaleDateString()]}),(u==null?void 0:u.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(u.discharge_date).toLocaleDateString()]}),(u==null?void 0:u.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:u.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsxs("button",{onClick:oc,className:`admit-discharge-button ${gs?"discharge":"admit"}`,title:gs?"Discharge Patient":"Admit Patient",disabled:!l||ms||Bi,children:[(ms||Bi)&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),ms?"Admitting...":Bi?"Discharging...":gs?"Discharge":"Admit"]}),i.jsxs("button",{onClick:()=>dp("doctor"),className:`queue-status-button ${ma?"in-queue":"add-to-queue"}`,title:ma?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!l||Mr||ma,children:[Mr&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),Mr?"Adding...":ma?"In Queue":"Add to Queue"]}),i.jsxs("button",{onClick:fp,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:to,children:[to&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),to?"Completing...":"Complete Consultation"]})]})]})]}),i.jsx(Jv,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:tc,className:"button-primary blue text-xs px-2 py-1",disabled:Kl||lt.filter(he=>he.status==="pending").length<2,title:"Merge all pending orders into one",children:Kl?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Merging..."]}):"Merge Orders"}),i.jsxs("button",{onClick:()=>zr(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!l,children:[i.jsx(Fl,{size:12,className:"mr-1"})," Add Pharmacy Order"]})]}),items:qr,onMarkAsRecurring:Rn,isLoading:L,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(he,be)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",qr.length-be,". Order Status: (",he.data.status,")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.originalDateString).toLocaleDateString(),")"]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>qi(he.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(Md,{size:12})}),he.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>ac(he.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(Bs,{size:12})}),i.jsx("button",{onClick:()=>rl({type:"Pharmacy Order",data:he.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(Fr,{size:12})}),he.data.status==="pending"&&i.jsx("button",{onClick:()=>ec(he.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:eo,children:i.jsx($d,{size:12})}),he.data.status==="billed"&&i.jsx("button",{onClick:()=>gu(he.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:eo,children:i.jsx(Ba,{size:12})}),he.data.status==="dispensed"&&i.jsx("button",{onClick:async()=>{var W;try{const ue=await ge(`/api/bills?patientId=${he.data.patientId}`);if(!ue.ok)throw new Error("Failed to fetch bills");const $e=(W=(await ue.json()).bills)==null?void 0:W.find(Qe=>Qe.related_id===he.data.id&&Qe.type==="pharmacy");$e?n(`/dashboard/bills/${$e.id}`):alert("Bill not found for this order.")}catch(ue){console.error("Error fetching bill:",ue),alert("Failed to fetch bill. Please try again.")}},className:"icon-button small",title:"View Bill",children:i.jsx(_2,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:he.data.medications.map((W,ue)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:W.name})}),i.jsxs("td",{className:"py-1 px-2",children:[W.pack_quantity!==void 0&&W.pack_quantity>0&&`Packs: ${W.pack_quantity}`,W.pack_quantity!==void 0&&W.pack_quantity>0&&W.loose_quantity!==void 0&&W.loose_quantity>0&&", ",W.loose_quantity!==void 0&&W.loose_quantity>0&&`Loose: ${W.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:W.tabletsPerDay&&W.numberOfDays?`${W.tabletsPerDay} tab/day for ${W.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:W.directions_to_use||"N/A"})]},W.drug_id||W.name||ue))})]})}),he.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",he.data.prescriptionForUnavailableDrugs]})]})}),i.jsx(GJ,{isOpen:uu,onClose:()=>zr(!1),patientId:l,pharmacyInventory:Vn,fetchPharmacyOrdersData:fr}),i.jsx(Jv,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:sc,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:Hi,children:"Analyse Reports"}),i.jsxs("button",{onClick:()=>tf(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!l,children:[i.jsx(Fl,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:Vi,onSaveLabOrder:lp,onCancelEditLabOrder:yu,onLabOrderTestChange:sp,onLabOrderStatusChange:xu,onBillLabOrder:op,labInventory:_n,isSavingLabOrder:eo,isLoading:Xs||ve,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:pa,toggleLabReport:Su,renderItemContent:(he,be)=>{const W=BQ(he.data.report?he.data.report.status:he.data.status);return i.jsxs("div",{className:"ai-context-text",children:[i.jsxs("span",{onClick:()=>af(he.data),style:{cursor:"pointer"},className:"hover:text-blue-600",title:"Click to open lab report",children:[he.data.serialNumber,". ",i.jsx("span",{className:"font-medium",children:"[Order]"})," ",he.data.tests&&he.data.tests.length>0?he.data.tests.map(ue=>i.jsxs("strong",{children:[ue.name," (",ue.price,")"]},ue.id||ue.name)).reduce((ue,me)=>[ue,", ",me]):i.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",he.data.tests&&he.data.tests.length>0&&i.jsxs("span",{className:"font-bold ml-2",children:["Total: ",he.data.tests.reduce((ue,me)=>ue+(Number(me.price)||0),0).toFixed(2)]}),"(",i.jsx("span",{className:W.className,children:W.text}),")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.originalDateString).toLocaleDateString(),")"]})]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[i.jsx("button",{onClick:()=>af(he.data),className:"icon-button small",title:"Manage Lab Report",children:i.jsx(us,{size:12})}),i.jsx("button",{onClick:()=>va(he.data.id),className:"icon-button small",title:"Edit Order Details",children:i.jsx(Md,{size:12})}),i.jsx("button",{onClick:()=>rl({type:"Lab Order",data:he.data}),className:"icon-button small text-red-500",title:"Delete Lab Order",children:i.jsx(Fr,{size:12})})]}),he.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.data.report.report_date).toLocaleDateString(),")"]}),i.jsx("button",{onClick:()=>Su(he.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:pa[he.data.report.reportId]?"Collapse Report":"Expand Report",children:pa[he.data.report.reportId]?i.jsx(g1,{size:14}):i.jsx(db,{size:14})})]}),pa[he.data.report.reportId]&&(()=>{try{const ue=JSON.parse(he.data.report.report_content||"{}");return typeof ue=="object"&&ue!==null&&he.data.report.tests?he.data.report.tests.map(me=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:me.name}),ue[me.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(ue[me.id]).map(([$e,Qe])=>{var ju;const nt=(ju=me.default_parameters)==null?void 0:ju.find(hr=>hr.name===$e),Xt=typeof Qe=="string"?parseFloat(Qe):typeof Qe=="number"?Qe:NaN,Ht=(nt==null?void 0:nt.type)==="number"&&!isNaN(Xt)&&Qe!==""&&Qe!==null&&Qe!==void 0&&(nt.lower_limit!=null&&Xt<nt.lower_limit||nt.upper_limit!=null&&Xt>nt.upper_limit),fo=(nt==null?void 0:nt.type)==="boolean"&&(Qe===!0||Qe==="true");return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:$e}),i.jsxs("td",{className:`py-1 px-2 ${Ht?"abnormal-result":""} ${fo?"reactive-result":""}`,children:[String(Qe)," ",(nt==null?void 0:nt.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(nt&&nt.type==="number"&&(nt.lower_limit!=null||nt.upper_limit!=null)){let hr="";return nt.lower_limit!=null&&(hr+=` > ${nt.lower_limit}`),nt.lower_limit!=null&&nt.upper_limit!=null&&(hr+=" - "),nt.upper_limit!=null&&(hr+=` < ${nt.upper_limit}`),hr.trim()||"N/A"}else if((nt==null?void 0:nt.type)==="boolean")return"Non-Reactive";return(nt==null?void 0:nt.normal_range)||"N/A"})()})]},$e)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},me.id)):i.jsx(Qc,{remarkPlugins:[Dl],children:he.data.report.report_content})}catch{return i.jsx(Qc,{remarkPlugins:[Dl],children:he.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(pJ,{isOpen:cu,onClose:()=>tf(!1),patientId:l,labInventory:_n,fetchPendingLabOrdersData:Zl}),i.jsx(Jv,{title:"Complaints History",items:Kr,isLoading:on,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(he,be)=>i.jsxs("span",{className:"ai-context-text",children:[he.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:rl}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(vg,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!tl&&i.jsx("button",{onClick:uo,className:"edit-button",title:"Edit System Prompt",disabled:er||Jr||ba,children:i.jsx(Md,{size:14})})]}),tl&&Kt?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:Wa,onChange:he=>vs(he.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:Jr||ba}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:up,disabled:Jr||ba,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:co,disabled:Jr||ba||Ya===Kt.aiMemory&&Wa===Kt.clinicWideSystemPrompt,className:"button-primary purple",children:[ba||Jr?i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}):i.jsx(qd,{size:14,className:"mr-1"}),ba||Jr?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:Kt!=null&&Kt.clinicWideSystemPrompt?i.jsx(Qc,{remarkPlugins:[Dl],children:Kt.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!tl&&(Kt==null?void 0:Kt.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(Kt.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!E&&i.jsx("button",{onClick:Xr,className:"edit-button",title:"Edit Case Summary",disabled:L||q,children:i.jsx(Md,{size:14})})]}),E?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:I,onChange:he=>D(he.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:q}),$&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:$}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:ic,disabled:q,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:lo,disabled:q||I===S,className:"button-primary blue",children:q?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:S?i.jsx(Qc,{remarkPlugins:[Dl],components:{},children:S}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),z&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(z).toLocaleDateString()]})]})]}),Kr.length===0&&Vi.length===0&&qr.length===0&&!(on||Xs||ve)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),Zs&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),Wo&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:Wo})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsxs("div",{className:"status-messages-container",children:[Pe&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Pe}),on&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading past complaints..."})}),Q&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Q}),Xs&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading pending lab orders..."})}),ef&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:ef}),fn&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading inventory..."})}),Wr&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Wr}),L&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading..."})})]}),e&&!G&&i.jsxs(w.Fragment,{children:[bu&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:bu}),al.length>0&&i.jsx("div",{className:"options-grid",children:al.map((he,be)=>i.jsx("button",{onClick:()=>of(he),className:"option-button",children:he},be))})]}),so&&i.jsx("div",{className:"speech-error-display",children:so}),Ui&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",Ui.name]}),i.jsx("button",{onClick:()=>{Jl(null),bs.current&&(bs.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:bs,onChange:lf,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:Ae,className:"complaint-textarea",value:r,onChange:he=>a(he.target.value),onKeyDown:Ja,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:Hi||!e||ao}),i.jsxs("div",{className:"chat-input-actions-container",children:[l&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>n(`/patient/${l}/lab-reports`),disabled:ve||!l,className:"icon-button",title:"View Lab Reports",children:i.jsx(us,{size:14})}),i.jsx("button",{onClick:()=>n("/inventory"),disabled:fn,className:"icon-button",title:"View Inventory",children:i.jsx(Ud,{size:14})})]}),i.jsx("button",{type:"button",onClick:Nu,disabled:Hi||!e||ao,className:"icon-button",title:"Attach Image",children:i.jsx(HM,{size:14})}),i.jsx("button",{type:"button",onClick:di,disabled:Hi||!e||!ui.current,className:`mic-button ${ao?"listening":""}`,title:ao?"Stop":"Mic",children:i.jsx(T2,{size:14})}),i.jsx("button",{onClick:()=>Sa(),disabled:Hi||fn||G||!r.trim()||!e||ao,className:"send-button",title:Hi||fn||G?"Processing...":"Save & Ask AI",children:Hi?i.jsx("span",{className:"animate-spin",role:"status","aria-label":"loading"}):i.jsx(Pl,{size:14})})]})]})})]})]})]})},Yne=()=>{const{patientId:e}=Ti(),n=yt(),[t,r]=w.useState([]),[a,s]=w.useState(null),[l,f]=w.useState(!1),[u,d]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided.");return}f(!0),d(null);try{const b=await ge(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();s({name:v.name,age:v.age,gender:v.gender});const S=await ge(`/api/patients/${e}/complaints`);if(S.ok){const E=(await S.json()).sort((T,I)=>new Date(I.createdAt).getTime()-new Date(T.createdAt).getTime());r(E)}else if(S.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),d(`Failed to load data. ${b.message}`),r([]),s(null)}finally{f(!1)}})()},[e]);const h=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),u&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",u]}),l&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!u&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>h(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Yx=500,G_="defaultConsultationFee",Wne=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:s=[],billType:l="other",relatedId:f,initialStatus:u="pending",initialDiscountPercentage:d=0,readOnlyMode:h=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[E,T]=w.useState([]),I=w.useRef([]),[D,q]=w.useState(""),[F,$]=w.useState(""),[B,z]=w.useState(1),[U,L]=w.useState(d),[R,G]=w.useState("cash"),[ee,te]=w.useState(!1),[oe,K]=w.useState(null),[V,J]=w.useState(!1),[ne,A]=w.useState(!1),[ae,ce]=w.useState(!1),[M,de]=w.useState(null),[,Se]=w.useState([]),[fe,we]=w.useState(null),[ie,_e]=w.useState(""),[Ve,tt]=w.useState("cash"),[Ke,Oe]=w.useState(!1),[xe,Me]=w.useState(Yx),[ve,Ee]=w.useState(Yx.toString()),Pe=n?"view_pay":"create";w.useEffect(()=>{const Be=localStorage.getItem(G_),Xe=Be?parseFloat(Be):Yx;isNaN(Xe)||(Me(Xe),Ee(Xe.toString()))},[]);const rt=s.length===0;w.useEffect(()=>{e?(async()=>{te(!0),K(null);try{const Xe=await ge(`/api/patients/${e}`);if(!Xe.ok){const st=await Xe.json().catch(()=>({}));throw new Error(st.message||"Failed to fetch patient details")}const Fe=await Xe.json();k(Fe)}catch(Xe){K(`Failed to load patient details: ${Xe.message}`),k(null)}finally{te(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{ce(!0),K(null),de(null),Se([]),we(null);try{const Xe=await ge(`/api/bills/${n}`);if(!Xe.ok){const st=await Xe.json().catch(()=>({}));throw new Error(st.message||"Failed to fetch bill details")}const Fe=await Xe.json();if(!Fe.bill||!Fe.payments||!Fe.calculated)throw new Error("Invalid bill details structure.");de(Fe.bill),Se(Fe.payments),we(Fe.calculated),L(Fe.bill.discount_percentage!==void 0&&Fe.bill.discount_percentage!==null?parseFloat(Fe.bill.discount_percentage.toString()):0),!S&&Fe.bill.patient_id&&lt(Fe.bill.patient_id.toString())}catch(Xe){K(`Failed to load bill details: ${Xe.message}`),de(null),Se([]),we(null)}finally{ce(!1)}})():(de(null),Se([]),we(null))},[n]);const lt=async Be=>{te(!0);try{const Xe=await ge(`/api/patients/${Be}`);if(!Xe.ok)throw new Error("Failed to fetch patient");const Fe=await Xe.json();k(Fe)}catch(Xe){console.error("Error fetching patient details:",Xe),k(null)}finally{te(!1)}},Ze=w.useCallback(async Be=>{A(!0),K(null);const Xe=Be.filter(Fe=>Fe.drug_id!=null).map(async Fe=>{try{const st=await ge(`/api/drugs/${Fe.drug_id}`);if(!st.ok)throw new Error(`Drug ${Fe.drug_id} not found.`);const Je=await st.json();return{...Fe,price:Je.price,total:Je.price*Fe.quantity}}catch{return K(Je=>`${Je?Je+"; ":""}Failed to fetch price for ${Fe.name}`),Fe}});try{const Fe=await Promise.all(Xe);T(st=>{const Je=new Map(Fe.map(xt=>[xt.id,xt]));return st.map(xt=>Je.get(xt.id)||xt)})}catch{}finally{A(!1)}},[ge]);w.useEffect(()=>{if(n){T([]),I.current=[];return}JSON.stringify(s)===JSON.stringify(I.current)||(async()=>{let Fe=[];if(s&&s.length>0)Fe=s.map((st,Je)=>({...st,id:`initial-${Je}-${Date.now()}`})),G(u==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),L(d),l==="pharmacy"&&!h&&await Ze(Fe);else if(e&&rt&&l==="consultation"){let st=xe;if(g)try{const Je=await ge(`/api/staff/${g}`);if(!Je.ok){const Vn=await Je.json().catch(()=>({}));throw new Error(Vn.message||"Doctor not found or error fetching fee")}const xt=await Je.json();xt.opd_fee!=null&&!isNaN(parseFloat(String(xt.opd_fee)))&&parseFloat(String(xt.opd_fee))>=0&&(st=parseFloat(String(xt.opd_fee)))}catch(Je){K(xt=>`${xt?xt+"; ":""}Could not fetch doctor's fee, using default. (${Je.message})`)}Fe=[{id:Date.now(),name:"Consultation Fee",price:st,quantity:1,total:st*1,drug_id:null}],G(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else Fe=[],G(v==="no_cash_insurance"?"no_cash_insurance":"cash");T(Fe),I.current=s})()},[n,e,g,s,l,xe,rt,u,h,Ze,d,v]);const Rt=()=>{const Be=parseFloat(F);if(!h)if(D&&!isNaN(Be)&&Be>=0&&B>0){if(D.trim().toLowerCase()==="consultation fee"&&E.some(Fe=>Fe.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Xe={id:Date.now(),name:D.trim(),price:Be,quantity:B,total:Be*B,drug_id:null};T([...E,Xe]),q(""),$(""),z(1)}else alert("Invalid item details.")},kt=Be=>{h||T(E.filter(Xe=>Xe.id!==Be))},on=w.useMemo(()=>{let Be=E.reduce((Xe,Fe)=>Xe+Fe.total,0);return Pe==="create"&&U>0&&(Be=Be*(1-U/100)),(fe==null?void 0:fe.totalDue)!==void 0&&(fe==null?void 0:fe.totalDue)!==null?fe.totalDue:Be},[E,fe,U,Pe]),se=w.useMemo(()=>(fe==null?void 0:fe.totalPaid)??0,[fe]),Q=w.useMemo(()=>(fe==null?void 0:fe.balance)!==void 0&&(fe==null?void 0:fe.balance)!==null?fe.balance:on-se,[fe,on,se]),re=()=>{const Be=parseFloat(ve);!isNaN(Be)&&Be>=0?(Me(Be),localStorage.setItem(G_,Be.toString()),alert(`Default Fee set to ${Be.toFixed(2)}`)):alert("Invalid fee amount.")},je=async(Be,Xe)=>{J(!0),K(null);try{const Fe=await ge("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Xe,billId:Be})}),st=await Fe.json();if(!Fe.ok||!st.order)throw new Error(st.message||"Failed to create Razorpay order.");const{key_id:Je,order:xt}=st,Vn={key:Je,amount:xt.amount,currency:xt.currency,name:"Newtons OPD Zero Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:xt.id,handler:async function($n){try{const _n=await ge("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:$n.razorpay_payment_id,razorpay_order_id:$n.razorpay_order_id,razorpay_signature:$n.razorpay_signature,billId:Be})}),yn=await _n.json();if(_n.ok&&yn.success)alert("Payment Successful!"),r&&r(Be),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(yn.message||"Payment verification failed.")}catch(_n){K(`Payment verification failed: ${_n.message}. Contact support.`)}finally{J(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:Be,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){K("Payment cancelled."),J(!1)}}};if(window.Razorpay)new window.Razorpay(Vn).open();else throw new Error("Razorpay SDK not loaded.")}catch(Fe){K(`Failed to initiate online payment: ${Fe.message}`),J(!1)}},Ae=async()=>{if(!n){K("Bill ID is missing.");return}if(!ie||isNaN(parseFloat(ie))||parseFloat(ie)<=0){K("Please enter a valid positive payment amount.");return}Oe(!0),K(null);const Be={amount_paid:parseFloat(ie),payment_mode:Ve};try{const Xe=await ge(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)}),Fe=await Xe.json();if(!Xe.ok)throw new Error(Fe.message||`Failed to record payment (Status: ${Xe.status})`);alert(`Payment of ${Be.amount_paid.toFixed(2)} recorded.`),_e(""),a?a():console.log("Payment recorded.")}catch(Xe){K(`Failed to record payment: ${Xe.message}`)}finally{Oe(!1)}},Ue=async()=>{if(Pe==="view_pay")return;if(!e){K("Patient ID is missing for creating a bill.");return}if(E.length===0){K("Cannot finalize an empty bill.");return}J(!0),K(null);const Be=on,Xe=E.map(({id:Fe,...st})=>st);if(R==="online"){const Fe={patientId:e,queueId:t||null,items:Xe,amount:Be,paymentMode:"online",type:l,related_id:f||b||null,status:"pending",discountPercentage:U,labOrderId:b||null};try{const st=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)}),Je=await st.json();if(!st.ok)throw new Error(Je.message||"Failed to create pending bill.");je(Je.id,Math.round(Be*100))}catch(st){K(`Failed to create pending bill: ${st.message}`),J(!1)}}else{const Fe="paid";if(!R){K("Payment mode required."),J(!1);return}const st={patientId:e,queueId:t||null,items:Xe,amount:Be,paymentMode:R,type:l,related_id:f||b||null,status:Fe,discountPercentage:U,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const Je=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(st)}),xt=await Je.json();if(!Je.ok)throw new Error(xt.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(xt.id),J(!1)}catch(Je){K(`Failed to process bill: ${Je.message}`),J(!1)}}},ot=(M==null?void 0:M.type)??l,mt=(M==null?void 0:M.status)??u,ft=Pe==="view_pay"&&M&&mt==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):ee||Pe==="view_pay"&&ae?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):Pe==="view_pay"&&!M&&!ae&&oe?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",oe]}):Pe==="create"&&!S&&!ee&&oe?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",oe]}):i.jsxs("div",{className:"billing-component-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:Pe==="create"?"Create Bill":"Bill Details"}),Pe==="create"&&l==="consultation"&&!h&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),i.jsx("input",{id:"defaultFee",type:"number",value:ve,onChange:Be=>Ee(Be.target.value),className:"",placeholder:Yx.toString(),disabled:h}),i.jsx("button",{onClick:re,title:"Set Default Fee",className:"",disabled:h,children:i.jsx(qd,{size:16})})]})]}),oe&&!ae&&!Ke&&i.jsxs("div",{className:"error-message",role:"alert",children:[i.jsx("strong",{children:"Error: "}),oe]}),S&&i.jsxs("div",{className:"patient-details-section",children:[i.jsx("h3",{children:"Patient Details"}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",S.id]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",S.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",i.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),i.jsxs("div",{className:"bill-items-summary-section",children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:Pe==="create"?"Bill Items":"Billing Summary"}),Pe==="create"&&l==="pharmacy"&&!h&&E.some(Be=>Be.drug_id!=null)&&i.jsxs("button",{onClick:()=>Ze(E),disabled:ne,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[i.jsx(hb,{size:14,className:`lucide ${ne?"animate-spin":""}`}),ne?"Refreshing...":"Refresh"]})]}),Pe==="view_pay"&&M&&i.jsxs("div",{className:"bill-info-bar",children:[i.jsxs("span",{children:["Bill ID: ",i.jsx("strong",{children:M.id})]}),i.jsxs("span",{children:["Type: ",i.jsx("strong",{className:"capitalize",children:ot})]}),i.jsxs("span",{children:["Status: ",i.jsx("strong",{className:`capitalize ${mt==="paid"?"status-paid":"status-pending"}`,children:mt})]})]}),(Pe==="create"||Pe==="view_pay"&&M)&&i.jsxs("div",{className:"bill-items-list",children:[Pe==="create"&&ne&&E.length>0&&i.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),Pe==="create"&&!ne&&E.map((Be,Xe)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Xe+1,". ",Be.name]}),Be.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",Be.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",Be.total.toFixed(2)]}),Pe==="create"&&typeof Be.id=="number"&&!h&&i.jsxs("button",{onClick:()=>kt(Be.id),className:"remove-item-button",title:"Remove",children:[" ",i.jsx(Kn,{size:16})," "]}),(typeof Be.id!="number"||h||Be.name==="Consultation Fee")&&i.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",i.jsx(rN,{size:14})," "]})]})]},Be.id)),Pe==="view_pay"&&M&&M.items.map((Be,Xe)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Xe+1,". ",Be.name]}),Be.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",Be.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",(Be.total??Be.price*Be.quantity).toFixed(2)]}),i.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",i.jsx(rN,{size:14})," "]})]})]},Xe)),Pe==="create"&&E.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items added."}),Pe==="view_pay"&&M&&M.items.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),Pe==="create"&&!h&&i.jsxs("div",{className:"add-item-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Item"}),i.jsx("input",{type:"text",value:D,onChange:Be=>q(Be.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:B,onChange:Be=>z(parseInt(Be.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[i.jsx("label",{children:"Price ()"}),i.jsx("input",{type:"number",value:F,onChange:Be=>$(Be.target.value),placeholder:"0.00",className:"custom-text-input"})]}),i.jsx("button",{onClick:Rt,className:"add-item-button",children:"Add"})]})]})," ",i.jsxs("div",{className:"billing-footer",children:[i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),i.jsxs("span",{className:"total-amount-value",children:["",typeof on=="number"?on.toFixed(2):"0.00"]}),Pe==="create"&&!h&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),i.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:U,onChange:Be=>L(parseFloat(Be.target.value)||0),className:"",disabled:h||V})]}),Pe==="view_pay"&&M&&(M.status==="pending"||M.status==="paid")&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),i.jsxs("span",{className:"discount-value",children:[U.toFixed(2),"%"]})]})]}),Pe==="view_pay"&&fe&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),i.jsxs("span",{className:"total-amount-value",children:["",se.toFixed(2)]})]}),Pe==="view_pay"&&fe&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),i.jsxs("span",{className:"total-amount-value",children:["",Q.toFixed(2)]})]}),i.jsxs("div",{className:"footer-actions",children:[Pe==="create"&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:R,onChange:Be=>G(Be.target.value),className:"custom-select-input",disabled:h||V,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("button",{onClick:Ue,disabled:V||E.length===0||h,className:"finalize-button",children:V?"Processing...":"Finalize Bill"})]}),Pe==="view_pay"&&ft&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Record Payment Amount ()"}),i.jsx("input",{type:"number",value:ie,onChange:Be=>_e(Be.target.value),placeholder:`Max: ${Q.toFixed(2)}`,className:"custom-text-input",disabled:Ke})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:Ve,onChange:Be=>tt(Be.target.value),className:"custom-select-input",disabled:Ke,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{onClick:Ae,disabled:Ke||!ie||parseFloat(ie)<=0||parseFloat(ie)>Q,className:"record-payment-button",children:Ke?"Recording...":"Record Payment"})]}),Pe==="create"&&h&&E.length>0&&i.jsx("div",{className:"status-message read-only",children:"Read-only."}),Pe==="view_pay"&&mt==="paid"&&i.jsx("div",{className:"status-message paid",children:"PAID."}),Pe==="view_pay"&&mt==="cancelled"&&i.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},Qne=()=>{const e=yt(),n=oi(),{patientId:t,queueId:r,patientName:a,initialItems:s,billType:l,relatedId:f,initialStatus:u,initialDiscountPercentage:d,doctorId:h,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,E]=w.useState(null),[T,I]=w.useState(null),[D,q]=w.useState(null),[F,$]=w.useState(null),[B,z]=w.useState(null),[U,L]=w.useState(null),[R,G]=w.useState(null),[ee,te]=w.useState(!0),[oe,K]=w.useState(null),[V,J]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{te(!0),K(null);try{let de=t,Se=s||null,fe=u||null,we=l||null,ie=f||null,_e=d!==void 0?parseFloat(d):null,Ve=a||null,tt=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Ke=await ge(`/api/bills/${g}`);if(!Ke.ok){const xe=await Ke.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(xe.message||`Failed to fetch bill details (Status: ${Ke.status})`)}const Oe=await Ke.json();if(console.log("Fetched Bill Data:",Oe),Se=Oe.bill.items||[],fe=Oe.bill.status||"pending",we=Oe.bill.type||null,ie=Oe.bill.related_id||null,_e=Oe.bill.discount_percentage!==void 0&&Oe.bill.discount_percentage!==null?parseFloat(Oe.bill.discount_percentage):0,de=Oe.bill.patient_id,q(Se),$(fe),z(we),L(ie),G(_e),de){const xe=await ge(`/api/patients/${de}`);if(xe.ok){const Me=await xe.json();Ve=Me.name,tt=Me.phone??null,I(Me.insurance_type??null),J(Ve),E(tt)}else console.warn(`Could not fetch patient details for ID ${de} from bill.`),J("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),J("Patient (Unknown)")}else if(l==="consultation"&&h){console.log(`Creating consultation bill for doctor ID: ${h}`);const Ke=await ge(`/api/staff/${h}`);if(!Ke.ok){const Me=await Ke.json().catch(()=>({}));throw new Error(Me.message||`Failed to fetch doctor details (status ${Ke.status})`)}const Oe=await Ke.json();console.log("Fetched Doctor Data:",Oe);const xe=Oe.opd_fee?parseFloat(String(Oe.opd_fee)):0;if(xe>0?Se=[{drug_id:h,name:`Consultation Fee - Dr. ${Oe.name}`,price:xe,quantity:1,total:xe}]:Se=[],fe="pending",we="consultation",ie=r,q(Se),$(fe),z(we),L(ie),de){const Me=await ge(`/api/patients/${de}`);if(Me.ok){const ve=await Me.json();E(ve.phone??null),I(ve.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${de}.`)}}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Ke=await ge(`/api/lab/${b}`);if(!Ke.ok){let xe=`Failed to fetch lab order details (Status: ${Ke.status} ${Ke.statusText})`;try{xe=(await Ke.json()).message||xe}catch{console.error("Response was not valid JSON:",await Ke.text())}throw new Error(xe)}const Oe=await Ke.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(Oe,null,2)),Se=(Oe.tests||[]).filter(xe=>xe&&typeof xe.name=="string"&&xe.price!==void 0&&xe.id!==void 0).map(xe=>{const Me=parseFloat(xe.price||"0"),ve=!isNaN(Me)&&isFinite(Me)?Me:0;return{drug_id:xe.id,name:xe.name,price:ve,quantity:1,total:ve*1,type:"lab_test"}}),Se&&Se.length===0&&(Oe.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",Oe.tests),K(xe=>`${xe?xe+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),fe="pending",we="lab",ie=b,de=Oe.patient_id,q(Se),$(fe),z(we),L(ie),de){const xe=await ge(`/api/patients/${de}`);if(xe.ok){const Me=await xe.json();Ve=Me.name,tt=Me.phone??null,I(Me.insurance_type??null),J(Ve),E(tt)}else console.warn(`Could not fetch patient details for ID ${de} from lab order.`),J("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),J("Patient (Unknown)")}else if(q(s||null),$(u||null),z(l||null),L(f||null),G(d!==void 0?parseFloat(d):null),J(a||`ID ${t}`),de){const Ke=await ge(`/api/patients/${de}`);if(Ke.ok){const Oe=await Ke.json();E(Oe.phone??null),I(Oe.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${de}.`)}if(r){const Ke=await ge(`/api/queue/${r}`);if(Ke.ok){const Oe=await Ke.json();S(Oe.token_number)}else console.warn(`Could not fetch queue details for ID ${r}.`)}}catch(de){console.error("Error fetching billing page details:",de),K(`Failed to load details: ${de.message}`),q(null),$(null),z(null),L(null),J(a||""),E(null),S(null)}finally{te(!1)}})()},[t,g,b,r,e]);const ne=M=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${M}`),e(-1)},A=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(pb,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(ee)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(oe)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(pb,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:oe}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const ce=(F??u)==="paid";return i.jsxs("div",{className:"billing-page-container",children:[i.jsx("div",{className:"back-button-container",children:i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(Lt,{size:20,className:"lucide"})," Back"]})}),i.jsxs("div",{className:"billing-content-wrapper",children:[i.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",V||`ID ${t}`]}),i.jsxs("div",{className:"patient-info-bar",children:[v!==null&&i.jsxs("span",{children:[i.jsx(Od,{size:14,className:"lucide"})," Token: ",v]}),k&&i.jsxs("span",{children:[i.jsx(JM,{size:14,className:"lucide"})," Phone: ",k]}),b&&i.jsxs("span",{className:"lab-order-info",children:[i.jsx(fb,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),T&&i.jsxs("span",{className:"insurance-info",children:[i.jsx(dR,{size:14,className:"lucide"})," Insurance: ",T.replace(/_/g," ").replace(/\b\w/g,M=>M.toUpperCase())]}),!k&&v===null&&!b&&!T&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),i.jsx(Wne,{patientId:t,labOrderId:b,queueId:r,onBillCreated:ne,onBillUpdated:A,initialItems:D??s,billType:B??l,relatedId:U??f,initialStatus:F??u,initialDiscountPercentage:R??d,readOnlyMode:ce,doctorId:h,patientInsuranceType:T??void 0})]})]})},Jne=({patientId:e,labOrderId:n,onBillingSuccess:t,initialItems:r,patientName:a})=>{const[s]=w.useState(r),[l,f]=w.useState(0),[u,d]=w.useState("cash"),[h,g]=w.useState(null),[b,v]=w.useState(!1),S=w.useMemo(()=>s.reduce((T,I)=>T+I.total,0)*(1-l/100),[s,l]),k=async()=>{if(s.length===0){g("Cannot finalize an empty bill.");return}v(!0),g(null);const E={patientId:e,items:s,amount:S,paymentMode:u,type:"lab",related_id:n,status:"paid",discountPercentage:l,labOrderId:n};try{const T=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),I=await T.json();if(!T.ok)throw new Error(I.message||"Failed to create bill.");alert("Bill created successfully!");const D=window.open("","_blank");if(D){const q=`
                    <html>
                        <head>
                            <title>Lab Bill</title>
                            <style>
                                body { font-family: sans-serif; }
                                .bill-container { max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc; }
                                .bill-header { text-align: center; margin-bottom: 20px; }
                                .bill-item { display: flex; justify-content: space-between; padding: 5px 0; }
                                .bill-total { text-align: right; margin-top: 20px; font-weight: bold; }
                            </style>
                        </head>
                        <body>
                            <div class="bill-container">
                                <div class="bill-header">
                                    <h2>Lab Bill for ${a}</h2>
                                </div>
                                <div class="bill-items-list">
                                    ${s.map(F=>`
                                        <div class="bill-item">
                                            <span>${F.name}</span>
                                            <span>${F.total.toFixed(2)}</span>
                                        </div>
                                    `).join("")}
                                </div>
                                <div class="bill-total">
                                    Total: ${S.toFixed(2)}
                                </div>
                            </div>
                        </body>
                    </html>
                `;D.document.write(q),D.document.close(),D.print()}t()}catch(T){g(`Failed to process bill: ${T.message}`)}finally{v(!1)}};return i.jsxs("div",{className:"billing-layout",children:[i.jsx("main",{className:"order-content",children:i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),s.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PRICE"})]})}),i.jsx("tbody",{children:s.map((E,T)=>i.jsxs("tr",{children:[i.jsx("td",{children:T+1}),i.jsx("td",{children:E.name}),i.jsx("td",{children:E.total.toFixed(2)})]},T))})]}):i.jsx("p",{children:"No lab tests in this order."})]})}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",s.reduce((E,T)=>E+T.total,0).toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:l,onChange:E=>f(parseFloat(E.target.value)||0),min:"0",max:"100",className:"discount-input-total",disabled:b}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",S.toFixed(2)]})]}),h&&i.jsx("p",{className:"error-message",style:{color:"red",textAlign:"center"},children:h}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:u,onChange:E=>d(E.target.value),className:"payment-mode-select",disabled:b,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("div",{className:"bill-actions",children:i.jsx("button",{onClick:k,className:"primary-button",disabled:b||s.length===0,children:b?"Processing...":"Finalise and Bill"})})]})})]})},Kne=()=>{const e=yt(),n=oi(),{labOrderId:t}=n.state||{},[r,a]=w.useState(null),[s,l]=w.useState(""),[f,u]=w.useState(null),[d,h]=w.useState(null),[g,b]=w.useState(null),[v,S]=w.useState(!0),[k,E]=w.useState(null);w.useEffect(()=>{if(!t){console.error("LabBillingPage loaded without a labOrderId."),e("/");return}(async()=>{S(!0),E(null);try{const D=await ge(`/api/lab/${t}`);if(!D.ok){const $=await D.json().catch(()=>({}));throw new Error($.message||`Failed to fetch lab order details (Status: ${D.status})`)}const q=await D.json(),F=(q.tests||[]).filter($=>$&&typeof $.name=="string"&&$.price!==void 0&&$.id!==void 0).map($=>{const B=parseFloat($.price||"0"),z=!isNaN(B)&&isFinite(B)?B:0;return{drug_id:$.id,name:$.name,price:z,quantity:1,total:z,type:"lab_test"}});if(b(F),q.patient_id){a(q.patient_id);const $=await ge(`/api/patients/${q.patient_id}`);if($.ok){const B=await $.json();l(B.name),u(B.phone??null),h(B.insurance_type??null)}else l("Patient (Not Found)")}else throw new Error("Lab order does not have an associated patient.")}catch(D){console.error("Error fetching lab billing details:",D),E(`Failed to load details: ${D.message}`)}finally{S(!1)}})()},[t,e]);const T=()=>{console.log(`Lab billing process completed for Lab Order ID: ${t}`),e(-1)};return t?v?i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Lab Bill..."})}):k?i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(pb,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Lab Bill"}),i.jsx("p",{className:"text-sm text-center mb-4",children:k}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]}):i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Lt,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsx("div",{className:"billing-layout",children:i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," ",s]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Phone:"})," ",f||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Lab Order ID:"})," ",t]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Insurance:"})," ",d?d.replace(/_/g," "):"N/A"]})]})]}),r&&g&&i.jsx(Jne,{patientId:r,labOrderId:t,onBillingSuccess:T,initialItems:g,patientInsuranceType:d,patientName:s})]})})]})}):i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(pb,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Lab Order Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the lab billing page without a lab order ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]})},Xne=()=>{const{patientId:e}=Ti(),n=yt(),[t,r]=w.useState([]),[a,s]=w.useState(!1),[l,f]=w.useState(null),[u,d]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){f("Patient ID not provided in URL.");return}s(!0),f(null),r([]);try{try{const v=await ge(`/api/patients/${e}`);if(v.ok){const S=await v.json();d(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await ge(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),f(`Failed to load pharmacy orders: ${g.message}`)}finally{s(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(Lt,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(Ud,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",u&&`for ${u}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(h=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(h.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",h.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",h.prescribedBy||"N/A"]}),h.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",h.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:h.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},h.id))})]})},Y_=()=>{const e=yt(),n=oi(),[t,r]=w.useState(null),[a,s]=w.useState([]),[l,f]=w.useState([]),[u,d]=w.useState(""),[h,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[E,T]=w.useState(null),[I,D]=w.useState(!0),[q,F]=w.useState(""),[$,B]=w.useState([]),[z,U]=w.useState(!1),[L,R]=w.useState(null),[G,ee]=w.useState(!1),[te,oe]=w.useState(!1),[K,V]=w.useState([]),J=/^\+?[0-9\s\-().]{7,20}$/,ne=/^[a-zA-Z\s'-]{2,}$/,A=w.useCallback(async()=>{try{const ve=await ge("/api/drugs");if(!ve.ok)throw new Error("Failed to fetch drugs");const Ee=await ve.json();s(Ee)}catch(ve){console.error("Failed to fetch available drugs:",ve),v("Could not load drug list. "+ve.message)}},[]),ae=w.useCallback(async ve=>{try{const Ee=await ge(`/api/pharmacy-orders/patient/${ve}`);if(!Ee.ok){const rt=await Ee.json().catch(()=>({}));throw new Error(rt.message||`HTTP error! status: ${Ee.status}`)}const Pe=await Ee.json();V(Pe||[])}catch(Ee){console.error("Failed to fetch previous pharmacy orders:",Ee)}finally{}},[]);w.useEffect(()=>{var ve;A(),(ve=n.state)!=null&&ve.patient?de(n.state.patient):D(!0)},[A,n.state]),w.useEffect(()=>{t!=null&&t.id?ae(t.id):V([])},[t,ae]),w.useEffect(()=>{if(!u){g([]);return}const ve=u.toLowerCase();g(a.filter(Ee=>{const Pe=Ee.name&&Ee.name.toLowerCase().includes(ve),rt=Ee.brand_name&&Ee.brand_name.toLowerCase().includes(ve);return Pe||rt}).slice(0,10))},[u,a]);const ce=w.useMemo(()=>qb(async ve=>{if(ve.trim().length<2){B([]),U(!1),R(null);return}U(!0),R(null);try{const Ee=new URLSearchParams({search:encodeURIComponent(ve),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Pe=await ge(`/api/patients?${Ee.toString()}`);if(!Pe.ok)throw new Error("API Error");const rt=await Pe.json();B(rt.patients)}catch(Ee){console.error("Error searching patients:",Ee),R(Ee.message||"Failed to search patients."),B([])}finally{U(!1)}},300),[J]),M=ve=>{const Ee=ve.target.value;F(Ee),ee(J.test(Ee)),oe(ne.test(Ee)&&!J.test(Ee)),U(!0),ce(Ee)},de=w.useCallback(ve=>{r(ve),D(!1),F(""),B([]),R(null)},[]),Se=w.useCallback(async ve=>{if(!q||ve==="phone"&&!G||ve==="name"&&!te){R(`Invalid ${ve} to create a new patient.`);return}U(!0),R(null);try{const rt=await(await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ve==="name"?q:"direct pharmacy",phone:ve==="phone"?q:null,age:null,gender:null,token:null})})).json();de(rt)}catch(Ee){const Pe=Ee.message||"";if(Pe.toLowerCase().includes("patient limit")){e("/start-clinic-subscription",{state:{errorMessage:Pe}});return}R(Pe||"Failed to create new patient.")}finally{U(!1)}},[q,G,te,de]),fe=()=>{r(null),D(!0),f([]),v(null),V([])},we=ve=>{if(!ve)return null;const Ee=ve.match(/(?:\d+x)?(\d+)/);return Ee?parseInt(Ee[1],10):null},ie=ve=>{if(l.some(Ee=>Ee.drug_id===ve.id)){v(`${ve.name||ve.brand_name} is already in the order.`),setTimeout(()=>v(null),3e3),d(""),g([]);return}f(Ee=>[...Ee,{drug_id:ve.id,name:ve.name||ve.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,price:Number(ve.price)||0,originalPrice:Number(ve.price)||0,stock:ve.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(ve.price)||0)/(we(ve.unit)||1),unit:ve.unit}]),d(""),g([])},_e=()=>{const ve=u.trim();ve&&e("/dashboard/inventory/add",{state:{initialDrugName:ve}})},Ve=ve=>{f(Ee=>Ee.filter(Pe=>(Pe.drug_id??Pe.name)!==ve))},tt=(ve,Ee)=>{f(Pe=>Pe.map(rt=>{if((rt.drug_id??rt.name)===ve&&rt.isLoose){const lt=we(rt.unit),Ze=Math.max(0,Ee),Rt=Ze*(lt??1)+(rt.looseUnits??0);return{...rt,loosePacks:Ze,looseQuantity:Rt}}return rt}))},Ke=(ve,Ee)=>{f(Pe=>Pe.map(rt=>{if((rt.drug_id??rt.name)===ve&&rt.isLoose){const lt=we(rt.unit),Ze=Math.max(0,Ee),Rt=(rt.loosePacks??0)*(lt??1)+Ze;return{...rt,looseUnits:Ze,looseQuantity:Rt}}return rt}))},Oe=ve=>{const Ee=[];ve.medications.forEach(Pe=>{if(!l.find(lt=>lt.drug_id&&Pe.drug_id&&lt.drug_id===Pe.drug_id||lt.name.toLowerCase()===Pe.name.toLowerCase())){let lt=Pe.drug_id,Ze=Pe.drug_id?a.find(Rt=>Rt.id===Pe.drug_id):void 0;if(!Ze&&Pe.name){const Rt=a.find(kt=>kt.name&&kt.name.toLowerCase()===Pe.name.toLowerCase());Rt?(lt=Rt.id,Ze=Rt):lt&&(lt=null)}Ee.push({drug_id:lt,name:Pe.name,pack_quantity:Pe.pack_quantity??0,loose_quantity:Pe.loose_quantity??0,directions_to_use:Pe.directions_to_use,tabletsPerDay:Pe.tabletsPerDay??1,numberOfDays:Pe.numberOfDays??1,price:Ze?Ze.price:Pe.price,stock:Ze?Ze.quantity_in_stock:Pe.stock,isLoose:!0,loosePacks:0,looseUnits:(Pe.pack_quantity??0)*(we((Ze==null?void 0:Ze.unit)||Pe.unit)??1)+(Pe.loose_quantity??0),looseQuantity:(Pe.pack_quantity??0)*(we((Ze==null?void 0:Ze.unit)||Pe.unit)??1)+(Pe.loose_quantity??0),pricePerLooseUnit:(Ze?Number(Ze.price):Number(Pe.price)||0)/(we((Ze==null?void 0:Ze.unit)||Pe.unit)||1),unit:(Ze==null?void 0:Ze.unit)||Pe.unit})}}),f(Pe=>[...Pe,...Ee]),ve.prescriptionForUnavailableDrugs&&(!E||!E.includes(ve.prescriptionForUnavailableDrugs))&&T(Pe=>Pe?`${Pe}

-- From previous order --
${ve.prescriptionForUnavailableDrugs}`:ve.prescriptionForUnavailableDrugs),v("Medications from previous order added."),setTimeout(()=>v(null),3e3)},xe=async ve=>{if(ve.preventDefault(),v(null),k(!0),!t){v("No patient selected."),k(!1);return}if(l.length===0&&!(E!=null&&E.trim())){v("Add medication or prescription notes."),k(!1);return}const Ee={patient_id:t.id,items:l.map(Pe=>{const rt=Number(Pe.price??0),lt=Number(Pe.pricePerLooseUnit??0),Ze=Number((lt*(Pe.looseQuantity??0)).toFixed(2));return{drug_id:Pe.drug_id||null,name:Pe.name,pack_quantity:Pe.loosePacks??0,loose_quantity:Pe.looseUnits??0,pack_price:rt,loose_price:lt,total_price:Ze,price:Number(Pe.originalPrice??0),directions_to_use:Pe.directions_to_use??null,tabletsPerDay:Number(Pe.tabletsPerDay??1),numberOfDays:Number(Pe.numberOfDays??1)}}),order_total:Me,prescription_for_unavailable_drugs:E};try{const Pe=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)});if(!Pe.ok)throw new Error("Order creation failed");await Pe.json(),alert(`Order created successfully for ${t.name}!`);let rt=t.queueId;if(!rt)try{const lt=await ge(`/api/queue/patient/${t.id}/latest`);if(lt.ok){const Ze=await lt.json();Ze!=null&&Ze._id&&(rt=Ze._id)}}catch(lt){console.error("Error checking queue:",lt)}if(!rt)try{const lt=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:t.id})});if(lt.ok){const Ze=await lt.json();Ze!=null&&Ze.id&&(rt=Ze.id)}}catch(lt){console.error("Error creating queue:",lt)}rt?e(`/dashboard/edit-complaint/${rt}`,{state:{patientId:t.id}}):e(-1)}catch(Pe){v(Pe.message||"Failed to create order.")}finally{k(!1)}},Me=w.useMemo(()=>l.reduce((ve,Ee)=>{const Pe=Ee.isLoose?Ee.pricePerLooseUnit??0:Ee.price??0,rt=Ee.isLoose?Ee.looseQuantity??0:Ee.quantity??0;return ve+Pe*rt},0),[l]);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-8 max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:i.jsx(Lt,{size:20})}),i.jsx("h2",{children:"Create Pharmacy Order"})]})}),b&&i.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-4 rounded-xl mb-6 flex items-start gap-3 animate-fade-in",children:[i.jsx(rr,{className:"shrink-0 mt-0.5",size:18}),i.jsx("span",{children:b})]}),I&&i.jsx("div",{className:"max-w-2xl mx-auto mt-10",children:i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Vs,{size:20,className:"text-indigo-400"})," Select Patient"]}),i.jsxs("div",{className:"patient-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(jr,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token # or Phone...",value:q,onChange:M,className:"custom-text-input",autoFocus:!0}),z&&i.jsx("div",{className:"pr-4 text-xs text-indigo-400 animate-pulse",children:"Searching..."})]}),L&&i.jsx("p",{className:"text-red-400 text-sm mt-2 pl-1 animate-fadeIn",children:L}),$.length>0&&i.jsx("div",{className:"search-results-dropdown",children:$.map(ve=>i.jsxs("div",{onClick:()=>de(ve),className:"search-result-item",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("span",{className:"text-white font-medium flex items-center",children:[i.jsxs("span",{className:"token-badge",children:["#",ve.token]}),ve.name]}),i.jsxs("span",{className:"text-xs text-gray-400 mt-1 pl-1",children:[ve.gender,"  ",ve.age," yrs  ",ve.phone||"No phone"]})]}),i.jsx(db,{size:16,className:"text-gray-600 -rotate-90"})]},ve.id))}),!z&&q.length>2&&$.length===0&&i.jsxs("div",{className:"mt-4 p-4 bg-zinc-800/50 rounded-lg text-center border border-dashed border-zinc-700",children:[i.jsxs("p",{className:"text-gray-400 mb-3 text-sm",children:['No patient found matching "',q,'"']}),i.jsxs("div",{className:"flex justify-center gap-3",children:[G&&i.jsx("button",{onClick:()=>Se("phone"),className:"px-4 py-2 bg-green-600/20 text-green-400 border border-green-600/50 rounded-lg text-sm hover:bg-green-600/30 transition-colors",children:"Create with Phone"}),te&&i.jsx("button",{onClick:()=>Se("name"),className:"px-4 py-2 bg-indigo-600/20 text-indigo-400 border border-indigo-600/50 rounded-lg text-sm hover:bg-indigo-600/30 transition-colors",children:"Create with Name"})]})]})]})]})}),!I&&t&&i.jsxs("form",{onSubmit:xe,className:"pharmacy-order-grid animate-fade-in",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel mb-6",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(jr,{size:18,className:"text-indigo-400"})," Add Medication"]}),i.jsxs("div",{className:"relative drug-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(jr,{className:"search-icon",size:18}),i.jsx("input",{type:"text",placeholder:"Search for drugs...",value:u,onChange:ve=>d(ve.target.value),className:"custom-text-input"})]}),h.length>0&&i.jsx("div",{className:"search-results-dropdown",children:h.map(ve=>i.jsx("div",{onClick:()=>ie(ve),className:"search-result-item",children:i.jsxs("div",{className:"flex justify-between w-full",children:[i.jsxs("div",{children:[i.jsx("span",{className:"drug-name",children:ve.name||ve.brand_name}),i.jsxs("span",{className:"drug-meta text-xs",children:["Stock: ",ve.quantity_in_stock]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("span",{className:"text-indigo-300 font-mono",children:["",Number(ve.price).toFixed(2)]})})]})},ve.id))}),u&&h.length===0&&!a.find(ve=>{var Ee;return((Ee=ve.name)==null?void 0:Ee.toLowerCase())===u.toLowerCase()})&&i.jsx("div",{className:"search-results-dropdown p-2",children:i.jsxs("button",{type:"button",onClick:_e,className:"w-full text-left px-4 py-2 text-indigo-400 hover:bg-zinc-800 rounded-lg text-sm transition-colors",children:['+ Add "',u,'" to Inventory']})})]})]}),i.jsxs("div",{className:"content-panel min-h-[400px]",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ll,{size:18,className:"text-indigo-400"})," Order Items (",l.length,")"]}),l.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx(Ll,{size:48,className:"empty-icon mx-auto",strokeWidth:1}),i.jsx("p",{className:"empty-text",children:"No medications added yet"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Search above to add items to the order"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"30%"},children:"Drug Name"}),i.jsx("th",{children:"Dosage / Directions"}),i.jsx("th",{children:"Qty (Packs/Loose)"}),i.jsx("th",{children:"Price"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:l.map((ve,Ee)=>{const Pe=ve.drug_id??ve.name,rt=(ve.pricePerLooseUnit??0)*(ve.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsxs("td",{children:[i.jsx("span",{className:"drug-name",children:ve.name}),i.jsxs("span",{className:"drug-meta",children:["Stock: ",ve.stock,"  Box of ",we(ve.unit)||1]})]}),i.jsx("td",{children:i.jsx("div",{className:"flex flex-col gap-2",children:i.jsx("input",{type:"text",placeholder:"Directions...",value:ve.directions_to_use||"",onChange:lt=>{const Ze=lt.target.value;f(Rt=>Rt.map(kt=>(kt.drug_id??kt.name)===Pe?{...kt,directions_to_use:Ze}:kt))},className:"table-input w-full"})})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Pks:"}),i.jsx("input",{type:"number",min:"0",value:ve.loosePacks,onChange:lt=>tt(Pe,parseInt(lt.target.value,10)),className:"table-input medium"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Unit:"}),i.jsx("input",{type:"number",min:"0",value:ve.looseUnits,onChange:lt=>Ke(Pe,parseInt(lt.target.value,10)),className:"table-input medium"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono text-sm",children:["",rt.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>Ve(Pe),className:"delete-btn opacity-0 group-hover:opacity-100",title:"Remove Item",children:i.jsx(Fr,{size:16})})})]},`${Pe}-${Ee}`)})})]})})]}),i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(us,{size:18,className:"text-indigo-400"})," Additional Notes / Prescription"]}),i.jsx("textarea",{value:E??"",onChange:ve=>T(ve.target.value||null),placeholder:"Enter notes for unavailable drugs or special instructions...",className:"custom-text-input bg-zinc-900/50 min-h-[100px] border border-zinc-800 rounded-lg resize-y"})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"patient-card mb-6",children:[i.jsx("div",{className:"patient-avatar",children:t.name.charAt(0).toUpperCase()}),i.jsx("h3",{className:"patient-name",children:t.name}),i.jsx("div",{className:"patient-meta",children:i.jsxs("span",{children:["Token: #",t.token]})}),i.jsxs("div",{className:"patient-detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Age / Gender"}),i.jsxs("p",{children:[t.age||"--"," / ",t.gender||"--"]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Phone"}),i.jsx("p",{children:t.phone||"--"})]})]}),i.jsx("button",{type:"button",onClick:fe,className:"change-patient-btn",children:"Change Patient"})]}),K.length>0&&i.jsxs("div",{className:"content-panel mb-6 p-4",children:[i.jsxs("div",{className:"section-title text-sm mb-3",children:[i.jsx(hM,{size:16,className:"text-indigo-400"})," Recent Orders"]}),i.jsx("div",{className:"max-h-[200px] overflow-y-auto pr-1 custom-scrollbar",children:K.map(ve=>i.jsxs("div",{className:`prev-order-item status-${ve.status}`,children:[i.jsxs("div",{className:"prev-order-header",children:[i.jsx("span",{className:"prev-order-date",children:new Date(ve.date).toLocaleDateString()}),i.jsx("span",{className:`status-badge ${ve.status}`,children:ve.status})]}),i.jsx("div",{className:"text-xs text-gray-500 mb-2 truncate",children:ve.medications.map(Ee=>Ee.name).join(", ")}),i.jsx("button",{type:"button",onClick:()=>Oe(ve),className:"add-prev-btn",children:"+ Add items"})]},ve.id))})]}),i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(M2,{size:18,className:"text-indigo-400"})," Summary"]}),i.jsx("div",{className:"summary-details",children:i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Items"}),i.jsx("span",{children:l.length})]})}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",Me.toFixed(2)]})]}),i.jsxs("button",{type:"submit",disabled:S||l.length===0&&!E,className:"create-order-btn",children:[S?i.jsx("div",{className:"spinner"}):i.jsx(Dw,{size:20}),S?"Processing...":"Create Order"]})]})]})]})]})},FA=()=>{var K;const{orderId:e}=Ti(),n=yt(),[t,r]=w.useState(null),[a,s]=w.useState(null),[l,f]=w.useState([]),[u,d]=w.useState([]),[h,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[E,T]=w.useState(!1),[I,D]=w.useState(null),[q,F]=w.useState(!0),$=V=>{if(!V)return null;const J=V.match(/(?:\d+x)?(\d+)/);return J?parseInt(J[1],10):null},B=w.useCallback(async()=>{F(!0);try{const V=await ge(`/api/pharmacy-orders/${e}`);if(!V.ok)throw new Error("Failed to fetch order details");const J=await V.json();r(J),s({id:J.patientId,name:J.patientName||"N/A",token:J.patientTokenNumber}),D(J.prescriptionForUnavailableDrugs);const ne=J.medications.map(A=>{const ae=$(A.unit),ce=A.pack_quantity*(ae??1)+A.loose_quantity;return{...A,isLoose:!0,loosePacks:A.pack_quantity,looseUnits:A.loose_quantity,looseQuantity:ce,pack_price:A.pack_price,loose_price:A.loose_price,total_price:A.total_price,pricePerLooseUnit:A.loose_price,originalPrice:A.pack_price,box_number:A.box_number,unit:A.unit,batch:A.batch,expiry_date:A.expiry_date,discount_percentage:A.discount_percentage}});d(ne)}catch(V){k("Could not load order details. "+V.message)}finally{F(!1)}},[e]),z=w.useCallback(async()=>{try{const V=await ge("/api/drugs");if(!V.ok)throw new Error("Failed to fetch drugs");const J=await V.json();f(J)}catch(V){k("Could not load drug list. "+V.message)}},[]);w.useEffect(()=>{B(),z()},[B,z]),w.useEffect(()=>{if(!h){v([]);return}const V=h.toLowerCase();v(l.filter(J=>{const ne=J.name&&J.name.toLowerCase().includes(V),A=J.brand_name&&J.brand_name.toLowerCase().includes(V);return ne||A}).slice(0,10))},[h,l]);const U=V=>{if(u.some(J=>J.drug_id===V.id)){k(`${V.name||V.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}d(J=>[...J,{drug_id:V.id,name:V.name||V.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(V.price)||0,loose_price:(Number(V.price)||0)/($(V.unit)||1),total_price:(Number(V.price)||0)/($(V.unit)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:V.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(V.price)||0)/($(V.unit)||1),originalPrice:Number(V.price)||0,unit:V.unit}]),g(""),v([])},L=V=>{d(J=>J.filter(ne=>(ne.drug_id??ne.name)!==V))},R=(V,J)=>{d(ne=>ne.map(A=>{if((A.drug_id??A.name)===V&&A.isLoose){const ae=$(A.unit),ce=Math.max(0,J),M=ce*(ae??1)+(A.looseUnits??0);return{...A,loosePacks:ce,looseQuantity:M,pack_quantity:ce}}return A}))},G=(V,J)=>{d(ne=>ne.map(A=>{if((A.drug_id??A.name)===V&&A.isLoose){const ae=$(A.unit),ce=Math.max(0,J),M=(A.loosePacks??0)*(ae??1)+ce;return{...A,looseUnits:ce,looseQuantity:M,loose_quantity:ce}}return A}))},ee=w.useMemo(()=>u.reduce((V,J)=>{const ne=J.loose_price??0,A=J.looseQuantity??0;return V+ne*A},0),[u]),te=(Number(ee)||0).toFixed(2),oe=async V=>{if(V.preventDefault(),k(null),T(!0),u.length===0&&!(I!=null&&I.trim())){k("Please add at least one medication or provide a prescription."),T(!1);return}const J={items:u.map(ne=>({drug_id:ne.drug_id??null,name:ne.name,pack_quantity:ne.loosePacks??0,loose_quantity:ne.looseUnits??0,pack_price:ne.pack_price??0,loose_price:ne.loose_price??0,total_price:(ne.loose_price??0)*(ne.looseQuantity??0),discount_percentage:ne.discount_percentage??0,directions_to_use:ne.directions_to_use??null,tabletsPerDay:ne.tabletsPerDay??1,numberOfDays:ne.numberOfDays??1})),prescription_for_unavailable_drugs:I,order_total:ee};try{if(!(await ge(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)})).ok)throw new Error("Failed to update order");alert("Pharmacy order updated successfully!"),n(-1)}catch(ne){k(ne.message||"Failed to update order.")}finally{T(!1)}};return q?i.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading order details..."}):t?i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-8 max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(Lt,{size:20})}),i.jsxs("div",{children:[i.jsx("h2",{children:"Edit Order"}),i.jsxs("span",{className:"text-sm text-gray-500 font-mono",children:["#",t.id.substring(0,8)]})]})]})}),i.jsxs("form",{onSubmit:oe,className:"pharmacy-order-grid animate-fade-in",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel mb-6",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(jr,{size:18,className:"text-indigo-400"})," Add Medication"]}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(jr,{className:"search-icon",size:18}),i.jsx("input",{type:"text",placeholder:"Search for drugs...",value:h,onChange:V=>g(V.target.value),className:"custom-text-input"})]}),b.length>0&&i.jsx("div",{className:"search-results-dropdown",children:b.map(V=>i.jsx("div",{onClick:()=>U(V),className:"search-result-item",children:i.jsxs("div",{className:"flex justify-between w-full",children:[i.jsxs("div",{children:[i.jsx("span",{className:"drug-name",children:V.name||V.brand_name}),i.jsxs("span",{className:"drug-meta text-xs",children:["Stock: ",V.quantity_in_stock]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("span",{className:"text-indigo-300 font-mono",children:["",Number(V.price).toFixed(2)]})})]})},V.id))})]})]}),i.jsxs("div",{className:"content-panel min-h-[400px]",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ll,{size:18,className:"text-indigo-400"})," Order Items (",u.length,")"]}),u.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx(Ll,{size:48,className:"empty-icon mx-auto",strokeWidth:1}),i.jsx("p",{className:"empty-text",children:"No medications in order"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"30%"},children:"Drug Name"}),i.jsx("th",{children:"Directions"}),i.jsx("th",{children:"Qty (Packs/Loose)"}),i.jsx("th",{children:"Price"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:u.map((V,J)=>{const ne=V.drug_id??V.name,A=(V.loose_price??0)*(V.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsxs("td",{children:[i.jsx("span",{className:"drug-name",children:V.name}),i.jsxs("span",{className:"drug-meta",children:["Stock: ",V.stock,"  Box of ",$(V.unit)||1]})]}),i.jsx("td",{children:i.jsx("input",{type:"text",placeholder:"Directions...",value:V.directions_to_use||"",onChange:ae=>{const ce=ae.target.value;d(M=>M.map(de=>(de.drug_id??de.name)===ne?{...de,directions_to_use:ce}:de))},className:"table-input w-full"})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Pks:"}),i.jsx("input",{type:"number",min:"0",value:V.loosePacks,onChange:ae=>R(ne,parseInt(ae.target.value,10)),className:"table-input medium"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Unit:"}),i.jsx("input",{type:"number",min:"0",value:V.looseUnits,onChange:ae=>G(ne,parseInt(ae.target.value,10)),className:"table-input medium"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono text-sm",children:["",A.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>L(ne),className:"delete-btn opacity-0 group-hover:opacity-100",title:"Remove Item",children:i.jsx(Fr,{size:16})})})]},`${ne}-${J}`)})})]})})]}),i.jsxs("div",{className:"content-section mt-6",children:[i.jsx("label",{className:"text-sm font-medium text-gray-400 mb-2 block",children:"Prescription Notes"}),i.jsx("textarea",{rows:3,value:I??"",onChange:V=>D(V.target.value||null),placeholder:"Additional notes...",className:"custom-text-input bg-zinc-900/50 border border-zinc-800 rounded-lg w-full resize-none"})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"patient-card mb-6",children:[i.jsx("div",{className:"patient-avatar",children:((K=a==null?void 0:a.name)==null?void 0:K.charAt(0).toUpperCase())||i.jsx(Vs,{})}),i.jsx("h3",{className:"patient-name",children:a==null?void 0:a.name}),i.jsx("div",{className:"patient-meta",children:i.jsxs("span",{children:["Token: #",(a==null?void 0:a.token)||"N/A"]})}),i.jsxs("div",{className:"flex justify-between border-t border-gray-700 pt-3 mt-3 px-2",children:[i.jsxs("span",{className:"text-sm text-gray-400 flex items-center gap-1",children:[i.jsx(og,{size:14})," Date"]}),i.jsx("span",{className:"text-sm text-white",children:new Date(t.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex justify-between pt-2 px-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:"Status"}),i.jsx("span",{className:`status-badge ${t.status}`,children:t.status})]})]}),i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(M2,{size:18,className:"text-indigo-400"})," Summary"]}),i.jsx("div",{className:"summary-details",children:i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Item Count"}),i.jsx("span",{children:u.length})]})}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",te]})]}),S&&i.jsxs("div",{className:"p-3 bg-red-900/20 border border-red-500/50 rounded-lg flex items-start gap-2 text-sm text-red-200",children:[i.jsx(rr,{size:16,className:"shrink-0 mt-0.5"}),i.jsx("span",{children:S})]}),i.jsxs("button",{type:"submit",disabled:E,className:"create-order-btn",children:[E?i.jsx("div",{className:"spinner"}):i.jsx(Dw,{size:20}),E?"Updating...":"Update Order"]})]})]})]})]}):i.jsx("div",{className:"p-8 text-center text-red-400",children:"Order not found."})},Zne=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},ere=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},tre=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},nre=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},rre=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},ire=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},W_=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),Q_=()=>{var te,oe,K;const{orderId:e}=Ti(),n=yt(),[t,r]=w.useState(null),[a,s]=w.useState({}),[l,f]=w.useState(!0),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[E,T]=w.useState({}),[I,D]=w.useState(null),q=V=>{const J=document.querySelector(`[data-test-id='${V}']`);J&&(document.body.classList.add("printing-single-test"),J.classList.add("printing"),window.print())};w.useEffect(()=>{const V=()=>{document.body.classList.remove("printing-single-test");const J=document.querySelector(".printing");J&&J.classList.remove("printing")};return window.addEventListener("afterprint",V),()=>{window.removeEventListener("afterprint",V)}},[]);const F=()=>{t&&Xw(t)},$=w.useCallback(async V=>{var J;try{const ne=await ge(`/api/patients/${V}`);if(!ne.ok)throw new Error(`Failed to fetch patient details: ${ne.status}`);const A=await ne.json();v(A.age),k(((J=A.sex)==null?void 0:J.toLowerCase())==="female"?"female":"male")}catch(ne){console.error("Error fetching patient details:",ne),v(null),k(null)}},[]),B=w.useCallback(async()=>{if(e){f(!0),g(null);try{const V=await ge(`/api/lab/${e}`);if(!V.ok){const A=await V.json().catch(()=>({message:`HTTP error! status: ${V.status}`}));throw new Error(A.message||`HTTP error! status: ${V.status}`)}const J=await V.json();r(J),J.patient_id&&$(J.patient_id);const ne={};if(J.tests&&J.tests.forEach(A=>{ne[A.id]={},A.default_parameters&&A.default_parameters.length>0?A.default_parameters.forEach(ae=>{ne[A.id][ae.name]=ae.defaultValue}):ne[A.id].report_content=""}),J.report_content)try{const A=JSON.parse(J.report_content);if(typeof A=="object"&&A!==null&&!Array.isArray(A)){const ae={...ne};Object.keys(A).forEach(ce=>{ae[ce]?ae[ce]={...ae[ce],...A[ce]}:ae[ce]=A[ce]}),s(ae)}else console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),s(ne)}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),s(ne)}else s(ne)}catch(V){console.error("Failed to fetch lab order details:",V),g(V instanceof Error?V.message:"An unknown error occurred while fetching order details.")}finally{f(!1)}}},[e,$]);w.useEffect(()=>{e?B():(g("No Order ID provided in the URL."),f(!1))},[e,B]);const z=(V,J,ne)=>{s(A=>{var Ee,Pe,rt,lt,Ze,Rt,kt,on,se,Q,re,je,Ae,Ue,ot,mt,ft,Be,Xe;const ae={...A,[V]:{...A[V],[J]:ne}},ce=parseFloat((Ee=ae[V])==null?void 0:Ee.Creatinine),M=b,de=S;if(J==="Creatinine"&&!isNaN(ce)&&M!==null&&de!==null){const Fe=Zne(ce,M,de);Fe!==null&&((Pe=t==null?void 0:t.tests.find(Je=>Je.id===V))!=null&&Pe.default_parameters.find(Je=>Je.name==="eGFR"))&&(ae[V].eGFR=Fe)}const Se=parseFloat((rt=ae[V])==null?void 0:rt["Total Cholesterol"]),fe=parseFloat((lt=ae[V])==null?void 0:lt["HDL Cholesterol"]),we=parseFloat((Ze=ae[V])==null?void 0:Ze.Triglycerides);if((J==="Total Cholesterol"||J==="HDL Cholesterol"||J==="Triglycerides")&&!isNaN(Se)&&!isNaN(fe)&&!isNaN(we)){const Fe=ere(Se,fe,we);Fe!==null&&((Rt=t==null?void 0:t.tests.find(Je=>Je.id===V))!=null&&Rt.default_parameters.find(Je=>Je.name==="LDL Cholesterol"))&&(ae[V]["LDL Cholesterol"]=Fe)}const ie=parseFloat((kt=ae[V])==null?void 0:kt["Total Bilirubin"]),_e=parseFloat((on=ae[V])==null?void 0:on["Direct Bilirubin"]);if((J==="Total Bilirubin"||J==="Direct Bilirubin")&&!isNaN(ie)&&!isNaN(_e)){const Fe=tre(ie,_e);Fe!==null&&((se=t==null?void 0:t.tests.find(Je=>Je.id===V))!=null&&se.default_parameters.find(Je=>Je.name==="Indirect Bilirubin"))&&(ae[V]["Indirect Bilirubin"]=Fe)}const Ve=parseFloat((Q=ae[V])==null?void 0:Q["Total Protein"]),tt=parseFloat((re=ae[V])==null?void 0:re.Albumin);if((J==="Total Protein"||J==="Albumin")&&!isNaN(Ve)&&!isNaN(tt)){const Fe=nre(Ve,tt);Fe!==null&&((je=t==null?void 0:t.tests.find(Je=>Je.id===V))!=null&&je.default_parameters.find(Je=>Je.name==="Globulin"))&&(ae[V].Globulin=Fe)}const Ke=parseFloat((Ae=ae[V])==null?void 0:Ae.Sodium),Oe=parseFloat((Ue=ae[V])==null?void 0:Ue.Chloride),xe=parseFloat((ot=ae[V])==null?void 0:ot.Bicarbonate);if((J==="Sodium"||J==="Chloride"||J==="Bicarbonate")&&!isNaN(Ke)&&!isNaN(Oe)&&!isNaN(xe)){const Fe=rre(Ke,Oe,xe);Fe!==null&&((mt=t==null?void 0:t.tests.find(Je=>Je.id===V))!=null&&mt.default_parameters.find(Je=>Je.name==="Anion Gap"))&&(ae[V]["Anion Gap"]=Fe)}const Me=parseFloat((ft=ae[V])==null?void 0:ft.Glucose),ve=parseFloat((Be=ae[V])==null?void 0:Be.BUN);if((J==="Sodium"||J==="Glucose"||J==="BUN")&&!isNaN(Ke)&&!isNaN(Me)&&!isNaN(ve)){const Fe=ire(Ke,Me,ve);Fe!==null&&((Xe=t==null?void 0:t.tests.find(Je=>Je.id===V))!=null&&Xe.default_parameters.find(Je=>Je.name==="Osmolality"))&&(ae[V].Osmolality=Fe)}return ae})},U=async(V,J)=>{if(!e){alert("Cannot submit report without an Order ID.");return}if(!a[V]||Object.keys(a[V]).length===0){alert(`Please enter data for ${J} before saving.`);return}D(V),g(null);try{const A={...t!=null&&t.report_content?JSON.parse(t.report_content):{}};A[V]=a[V];const ae=await ge(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(A)})});if(!ae.ok){const ce=await ae.json().catch(()=>({message:`Submission failed: ${ae.status}`}));throw new Error(ce.message||`Submission failed: ${ae.status}`)}t&&r({...t,report_content:JSON.stringify(A)}),alert(`Report for ${J} saved successfully!`)}catch(ne){console.error(`Error submitting report for ${J}:`,ne),alert(`Failed to save report for ${J}: ${ne instanceof Error?ne.message:"Unknown error"}`)}finally{D(null)}},L=async()=>{if(Object.keys(a).length===0){alert("Report content cannot be empty.");return}if(!e){alert("Cannot submit report without an Order ID.");return}d(!0),g(null);try{const V=await ge(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(a)})});if(!V.ok){const J=await V.json().catch(()=>({message:`Submission failed: ${V.status}`}));throw new Error(J.message||`Submission failed: ${V.status}`)}alert("Report submitted successfully!"),n(-1)}catch(V){console.error("Error submitting report:",V),g(V instanceof Error?V.message:"An unknown error occurred during submission.")}finally{d(!1)}};if(l)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(zd,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(h&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(rr,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:h}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Uo,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const R=(te=t==null?void 0:t.Patient)==null?void 0:te.name,G=(oe=t==null?void 0:t.Patient)==null?void 0:oe.patient_token_number,ee=`Enter Report for Order #${(t==null?void 0:t.lab_token_number)??e}`;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:ee})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button",disabled:u,"aria-label":"Print report",children:[i.jsx(Bs,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:F,className:"lab-inventory-button",disabled:u||!((K=t==null?void 0:t.Patient)!=null&&K.phone)||!(t!=null&&t.report_content),"aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(A2,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:u,children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),t&&i.jsxs("div",{className:"lab-inventory-card printable-section patient-info-section",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(Uo,{size:18,className:"no-print",style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(Vs,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",R??"N/A"," (Token: ",G??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(us,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Token:"})," ",t.lab_token_number??"N/A"]}),i.jsxs("div",{children:[i.jsx(GI,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",$h(new Date(t.createdAt),"PPpp")]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(kM,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(V=>V.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:sre(t.status),children:are(t.status)})]})]})]}),i.jsxs("div",{className:"printable-section",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(us,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),"Lab Report"]}),t==null?void 0:t.tests.map(V=>{var J;return i.jsxs("div",{"data-test-id":V.id,className:"lab-inventory-card test-report-container",style:{marginBottom:"15px"},children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:V.name}),i.jsx("div",{className:"no-print",style:{display:"flex",gap:"10px"},children:i.jsx("button",{onClick:()=>q(V.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${V.name}`,children:i.jsx(Bs,{size:16})})})]}),V.default_parameters&&V.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:V.default_parameters.map(ne=>{var de,Se,fe;const A=(de=a[V.id])==null?void 0:de[ne.name],ae=typeof A=="string"?parseFloat(A):typeof A=="number"?A:NaN,ce=ne.type==="number"&&!isNaN(ae)&&A!==""&&A!==null&&A!==void 0&&(ne.lower_limit!=null&&ae<ne.lower_limit||ne.upper_limit!=null&&ae>ne.upper_limit),M=ne.type==="boolean"&&(A===!0||A==="true");return i.jsxs("tr",{children:[i.jsxs("td",{style:{fontWeight:"500"},children:[ne.name,ne.unit&&i.jsxs("span",{style:{color:"#6b7280",fontSize:"0.9em"},children:[" (",ne.unit,")"]})]}),i.jsxs("td",{className:`${ce?"abnormal-result":""} ${M?"reactive-result":""}`,children:[i.jsxs("div",{className:"no-print",children:[ne.type==="boolean"?i.jsxs("select",{id:`${V.id}-${ne.name}`,value:(A==null?void 0:A.toString())??"false",onChange:we=>z(V.id,ne.name,we.target.value==="true"),className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:u,children:[i.jsx("option",{value:"false",children:"Non-Reactive"}),i.jsx("option",{value:"true",children:"Reactive"})]}):i.jsx("input",{id:`${V.id}-${ne.name}`,type:ne.type==="number"?"number":"text",value:A??"",onChange:we=>{const ie=ne.type==="number"&&we.target.value===""?0:we.target.value;z(V.id,ne.name,ie)},className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:u||W_(ne.name)&&!((Se=E[V.id])!=null&&Se[ne.name]),placeholder:`Enter ${ne.name.toLowerCase()}`}),W_(ne.name)&&i.jsx("button",{type:"button",onClick:()=>T(we=>{var ie;return{...we,[V.id]:{...we[V.id]||{},[ne.name]:!((ie=we[V.id])!=null&&ie[ne.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.75em",padding:"3px 8px",marginTop:"5px"},disabled:u,children:(fe=E[V.id])!=null&&fe[ne.name]?"Lock":"Edit"})]}),i.jsx("span",{className:"print-only",children:ne.type==="boolean"?A===!0||A==="true"?"Reactive":"Non-Reactive":`${A??""} ${ne.unit??""}`})]}),i.jsx("td",{style:{color:"#6b7280",fontSize:"0.9em"},children:ne.type==="number"&&(ne.lower_limit!==null||ne.upper_limit!==null)?i.jsxs(i.Fragment,{children:[ne.lower_limit!=null&&`> ${ne.lower_limit}`,ne.lower_limit!=null&&ne.upper_limit!=null&&" - ",ne.upper_limit!=null&&`< ${ne.upper_limit}`,ne.unit&&` ${ne.unit}`]}):ne.type==="boolean"?"Non-Reactive":"N/A"})]},ne.name)})})]})}):i.jsxs("div",{className:"lab-inventory-form-group no-print",children:[i.jsx("label",{htmlFor:`${V.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${V.id}-report_content`,value:((J=a[V.id])==null?void 0:J.report_content)??"",onChange:ne=>z(V.id,"report_content",ne.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${V.name}...`,disabled:u})]}),i.jsx("div",{className:"no-print",style:{marginTop:"15px",textAlign:"right"},children:i.jsx("button",{type:"button",onClick:()=>U(V.id,V.name),disabled:u||I===V.id,className:"lab-inventory-button",style:{fontSize:"0.9em",padding:"8px 16px"},children:I===V.id?i.jsxs(i.Fragment,{children:[i.jsx(zd,{className:"animate-spin mr-2",size:14})," Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(qd,{size:14,style:{marginRight:"5px"}})," Save ",V.name]})})})]},V.id)}),h&&i.jsxs("p",{className:"error-text no-print",style:{marginTop:"10px"},children:[i.jsx(rr,{size:15,className:"inline mr-1"}),h]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:u,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:L,disabled:u||Object.keys(a).length===0,className:"lab-inventory-button",children:u?i.jsxs(i.Fragment,{children:[i.jsx(zd,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(qd,{size:16,style:{marginRight:"5px"}})," Submit All Reports"]})})]})]})})},are=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",sre=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},ore=()=>{const{orderId:e}=Ti(),n=yt(),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),u=w.useCallback(async g=>{if(!g){f("No Order ID specified in the URL."),s(!1),r(null);return}s(!0),f(null),r(null);try{console.log(`Fetching order details for ID: ${g}`);const b=await ge(`/api/lab/orders/${g}/report`);if(!b.ok){let S;try{S=await b.json()}catch{S={message:`Server returned status ${b.status}`}}throw console.error("Fetch order details error response:",S),new Error(S.message||`Failed to fetch order details: ${b.status}`)}const v=await b.json();if(console.log("Received order data:",v),!v)throw console.error("Invalid order data structure:",v),new Error("Invalid order data received from server.");r(v)}catch(b){console.error("Error fetching order details:",b),f(b instanceof Error?b.message:"An unknown error occurred while fetching the order details")}finally{s(!1)}},[ge]);w.useEffect(()=>{u(e)},[e,u]);const d=g=>{const b=document.querySelector(`[data-test-id='${g}']`);b&&(document.body.classList.add("printing-single-test"),b.classList.add("printing"),window.print())};w.useEffect(()=>{const g=()=>{document.body.classList.remove("printing-single-test");const b=document.querySelector(".printing");b&&b.classList.remove("printing")};return window.addEventListener("afterprint",g),()=>{window.removeEventListener("afterprint",g)}},[]);const h=()=>{t&&Xw(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(cs,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(jr,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(Bs,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:h,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(A2,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(rr,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:l}),e&&i.jsx("button",{onClick:()=>u(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Vs,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(us,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const g=JSON.parse(t.report_content||"{}");return typeof g=="object"&&g!==null&&t.tests?t.tests.map(b=>i.jsxs("div",{"data-test-id":b.id,className:"test-report-container",style:{marginBottom:"20px"},children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:b.name}),i.jsx("button",{onClick:()=>d(b.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${b.name}`,children:i.jsx(Bs,{size:16})})]}),g[b.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(g[b.id]).map(([v,S])=>{var q;const k=(q=b.default_parameters)==null?void 0:q.find(F=>F.name===v),E=typeof S=="string"?parseFloat(S):typeof S=="number"?S:NaN,T=(k==null?void 0:k.type)==="number"&&!isNaN(E)&&(k.lower_limit!=null&&E<k.lower_limit||k.upper_limit!=null&&E>k.upper_limit),I=(k==null?void 0:k.type)==="boolean"?S===!0||S==="true"?"Reactive":"Non-Reactive":String(S),D=(k==null?void 0:k.type)==="boolean"&&(S===!0||S==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:v}),i.jsxs("td",{className:`${T?"abnormal-result":""} ${D?"reactive-result":""}`,children:[I," ",k==null?void 0:k.unit]}),i.jsx("td",{children:k&&k.type==="number"&&(k.lower_limit!==null||k.upper_limit!==null)?i.jsxs(i.Fragment,{children:[k.lower_limit!=null&&` > ${k.lower_limit}`,k.lower_limit!=null&&k.upper_limit!=null&&" - ",k.upper_limit!=null&&` < ${k.upper_limit}`,k.unit&&` ${k.unit}`]}):((k==null?void 0:k.type)==="boolean","N/A")})]},v)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},b.id)):i.jsx(Qc,{remarkPlugins:[Dl],children:t.report_content})}catch{return i.jsx(Qc,{remarkPlugins:[Dl],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(cs,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},lre=()=>{const e=yt(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[s,l]=w.useState([]),[f,u]=w.useState(null),[d,h]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{h(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[d]);const g=async()=>{const k=n.trim();if(!k){l([]),u(null);return}a(!0),u(null),l([]),console.log(`Searching for: ${k}`);try{const E=await ge("/api/lab");if(!E.ok){let $;try{$=await E.json()}catch{$={message:`Server returned status ${E.status}`}}throw console.error("Search fetch error response:",$),new Error($.message||`HTTP error! status: ${E.status}`)}const{orders:T}=await E.json();console.log("Received lab orders for search:",T);const D=T.filter($=>!!$.report_content).map($=>{var B,z;return{id:$.id,labTokenNumber:String($.lab_token_number??"N/A"),patientName:((B=$.Patient)==null?void 0:B.name)||"N/A",patientId:$.patient_id,patientTokenNumber:String(((z=$.Patient)==null?void 0:z.patient_token_number)??"N/A"),tests:($.tests||[]).map(U=>U.name||"Unknown Test"),date:$h(new Date($.createdAt),"yyyy-MM-dd"),status:$.status}}),q=n.toLowerCase(),F=D.filter($=>{var U,L,R,G,ee;const B=String($.labTokenNumber).toLowerCase(),z=String($.patientTokenNumber).toLowerCase();return(((U=$.patientName)==null?void 0:U.toLowerCase())||"").includes(q)||B.includes(q)||z.includes(q)||(((R=(L=$.tests)==null?void 0:L.join(" "))==null?void 0:R.toLowerCase())||"").includes(q)||(((G=$.id)==null?void 0:G.toLowerCase())||"").includes(q)||(((ee=$.patientId)==null?void 0:ee.toLowerCase())||"").includes(q)});console.log("Filtered search results:",F),l(F),F.length===0&&k?u(`No matching reports found for "${k}".`):u(null)}catch(E){console.error("Failed to search lab reports:",E),u(E instanceof Error?E.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(jr,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),f&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(rr,{size:20,className:"inline mr-2"})," ",f]}),s.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:s.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(cM,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:S(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(us,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(vR,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(WI,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&s.length===0&&!f&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&s.length===0&&!f&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},cre=()=>{const{patientId:e}=Ti(),n=yt(),[t,r]=w.useState([]),[a,s]=w.useState(!0),[l,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){f("Patient ID is missing from the URL."),s(!1);return}s(!0),f(null),r([]),g(null);try{const S=await ge(`/api/patients/${e}`);if(S.ok){const T=await S.json();g(T.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await ge(`/api/lab/patient/${e}`);if(!k.ok){const T=await k.json().catch(()=>({}));throw new Error(T.message||`HTTP error! status: ${k.status}`)}const E=await k.json();r(E||[])}catch(S){console.error("Error fetching data:",S),f(`Failed to load data: ${S.message}`)}finally{s(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",h?`for ${h}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await ge("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(Il,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(zd,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(P2,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:l})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(us,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(cs,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):u?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",u.report_date?$h(new Date(u.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>d(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(u.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(Qc,{remarkPlugins:[Dl],children:u.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(us,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",$h(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:dre(v.status),children:ure(v.status)}),i.jsx(bg,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},ure=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},dre=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},$A=()=>{const e=yt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[s,l]=w.useState(!1),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState("all"),v=10,S=1;w.useEffect(()=>{(async()=>{l(!0),u(null);try{console.log("Fetching pharmacy inventory for view page...");const T=await ge("/api/drugs");if(!T.ok)throw new Error(`HTTP error! status: ${T.status}`);const I=await T.json();console.log("Fetched Pharmacy Inventory for view page:",I),t(I||[])}catch(T){console.error("Error fetching pharmacy inventory:",T),u("Failed to load pharmacy inventory.")}finally{}})()},[]),w.useEffect(()=>{(async()=>{try{console.log("Fetching lab inventory for view page...");const T=await ge("/api/lab-tests");if(!T.ok)throw new Error(`HTTP error! status: ${T.status}`);const I=await T.json();console.log("Fetched Lab Inventory for view page:",I),a(I||[])}catch(T){console.error("Error fetching lab inventory:",T),u(I=>I?`${I} & Failed to load lab inventory.`:"Failed to load lab inventory.")}finally{l(!1)}})()},[]);const k=w.useMemo(()=>{let E=n;return d&&(E=E.filter(T=>T.name.toLowerCase().includes(d.toLowerCase()))),g!=="all"&&(E=E.filter(T=>{const I=(T.quantity_in_stock??1/0)<=v;let D=!1,q=!1;if(T.expiry_date)try{const F=gb(T.expiry_date);if(cg(F)){const $=y1(new Date,S),B=new Date;B.setHours(0,0,0,0),q=Ld(F,B),D=!q&&Ld(F,$)}}catch(F){console.error("Error parsing expiry date for filter:",T.expiry_date,F),D=!0}else D=!0;switch(g){case"low-stock":return I;case"near-expiry":return D;case"expired":return q;default:return!0}})),E},[n,d,g]);return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"lab-inventory-header",children:[i.jsx("h1",{children:"Inventory Overview"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary",title:"Go Back",children:[i.jsx(Lt,{size:18,style:{marginRight:"5px"}})," Back"]})]}),s&&i.jsx("p",{className:"loading-text",children:"Loading inventory..."}),f&&i.jsx("p",{className:"error-text",children:f}),!s&&!f&&i.jsxs("div",{className:"inventory-sections-container",children:[i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("div",{className:"inventory-section__header-bar",children:[i.jsxs("h2",{className:"lab-inventory-header",children:[i.jsx(Ll,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Pharmacy Inventory"]}),i.jsxs("div",{className:"inventory-section__controls",children:[" ",i.jsxs("div",{className:"inventory-section__search-area",children:[i.jsx("input",{type:"text",placeholder:"Search drugs...",value:d,onChange:E=>h(E.target.value),className:"lab-inventory-input",style:{marginRight:"5px",marginBottom:"0"}}),i.jsx(jr,{size:18,style:{color:"#777"}})]}),i.jsxs("div",{className:"inventory-section__filter-area",children:[" ",i.jsxs("select",{value:g,onChange:E=>b(E.target.value),className:"lab-inventory-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]})]}),k.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Stock"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Buying Price"}),i.jsx("th",{children:"Selling Price"})]})}),i.jsx("tbody",{children:k.map(E=>{let T="N/A",I="";const D=(E.quantity_in_stock??1/0)<=v;if(E.expiry_date)try{const q=gb(E.expiry_date);if(cg(q)){T=$h(q,"dd/MM/yyyy");const F=y1(new Date,1),$=new Date;$.setHours(0,0,0,0),Ld(q,$)?I="highlight-expired":Ld(q,F)&&(I="highlight-near-expiry")}else T="Invalid Date",I="highlight-near-expiry"}catch(q){console.error("Error parsing expiry date:",E.expiry_date,q),T="Error Parsing",I="highlight-near-expiry"}else I="highlight-near-expiry";return i.jsxs("tr",{children:[i.jsx("td",{children:E.name}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${D?"highlight-low-stock":""}`,children:E.quantity_in_stock??"N/A"})}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${I}`,children:T})}),i.jsx("td",{className:"price-text",children:E.buying_price?`${E.buying_price}`:"N/A"}),i.jsx("td",{className:"price-text",children:E.price?`${E.price}`:"N/A"})]},E.id)})})]})]})]}):i.jsx("p",{className:"no-data-message",children:d?`No drugs found matching "${d}".`:"No pharmacy inventory data available."})]}),i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("h2",{className:"lab-inventory-header inventory-section__lab-title",children:[i.jsx(Pw,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Lab Test Inventory"]}),r.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"})]})}),i.jsx("tbody",{children:r.map(E=>i.jsxs("tr",{children:[i.jsx("td",{children:E.name}),i.jsx("td",{className:"price-text",children:E.price?`${E.price}`:"N/A"})]},E.id))})]})]})]}):i.jsx("p",{className:"no-data-message",children:"No lab test inventory data available."})]})]})]})},fre=({fetchWithAuth:e})=>{const n=yt(),[t,r]=w.useState(!0),[a,s]=w.useState([]),[l,f]=w.useState(null),[u,d]=w.useState(null),h=w.useCallback(async()=>{r(!0),f(null);try{const S=await(await e("/staff")).json();s(S.map(k=>({...k,id:k._id||k.id})))}catch(v){f(`Failed to load staff data: ${v.message}`),s([])}finally{r(!1)}},[e]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{if(u){const v=setTimeout(()=>d(null),5e3);return()=>clearTimeout(v)}},[u]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return i.jsx(gR,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return i.jsx(D2,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return i.jsx(Ll,{size:16,className:"mr-2 text-purple-600"});case"lab":return i.jsx(fb,{size:16,className:"mr-2 text-yellow-600"});case"admin":return i.jsx(vg,{size:16,className:"mr-2 text-teal-600"});default:return i.jsx(Fh,{size:16,className:"mr-2 text-gray-500"})}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",i.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[u&&i.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${u.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[u.type==="success"?i.jsx(Ba,{size:18,className:"mr-2"}):i.jsx(rr,{size:18,className:"mr-2"}),i.jsx("span",{children:u.message}),i.jsx("button",{onClick:()=>d(null),className:"ml-auto text-xl font-bold",children:""})]}),l&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[i.jsx(rr,{size:18,className:"mr-2 text-red-500"}),l,i.jsx("button",{onClick:()=>f(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(Lt,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[i.jsx(Fl,{size:16,className:"mr-2"})," Add New Staff"]})]}),i.jsx("div",{className:"staff-table-container",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),i.jsx("th",{className:"hidden md:table-cell",children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:a.length===0&&!t?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>i.jsxs("tr",{children:[i.jsx("td",{children:v.name}),i.jsx("td",{className:"hidden md:table-cell",children:v.email}),i.jsx("td",{children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),i.jsx("td",{className:"hidden md:table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"actions",children:i.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[i.jsx(Vd,{size:16})," Edit"]})})]},v.id))})]})})]})},hre=()=>{var k,E,T,I,D,q,F,$,B,z,U,L,R,G;const{patientId:e,billId:n}=Ti(),t=yt(),[r,a]=w.useState(null),[s,l]=w.useState(!0),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),u(null);try{const te=await ge(`/api/bills/${n}`);if(!te.ok)throw new Error(`HTTP error! status: ${te.status}`);const oe=await te.json();if(!oe||!oe.bill||!oe.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(oe.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",oe.bill.type),new Error(`Unexpected bill type received: ${oe.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(oe,null,2));const K=Array.isArray(oe.admissionPayments)?oe.admissionPayments:[];console.log("Processed admissionPaymentsData:",K);const V={...oe.bill,amount:oe.bill.amount,AdmissionPayments:K,calculated:oe.calculated,patient:oe.bill.Patient?{id:oe.bill.Patient.id,name:oe.bill.Patient.name,admission_date:oe.bill.Patient.admission_date,discharge_date:oe.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(V,null,2)),a(V)}catch(te){console.error("Failed to fetch admission bill details:",te),u(te instanceof Error?te.message:"An unknown error occurred")}finally{l(!1)}})():(u("Bill ID is missing."),l(!1))},[n,e]);const S=async ee=>{var te;if(ee.preventDefault(),!e||!d||isNaN(parseFloat(d))||parseFloat(d)<=0||parseFloat(d)>(((te=r==null?void 0:r.calculated)==null?void 0:te.balance)??0)){u("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}u(null);try{const oe=await ge(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(d),payment_mode:g})});if(!oe.ok){const J=await oe.json();throw new Error(J.message||`HTTP error! status: ${oe.status}`)}const V=await(await ge(`/api/bills/${n}`)).json();if(V&&V.bill&&V.calculated&&V.admissionPayments)a({...V.bill,amount:parseFloat(V.bill.amount),AdmissionPayments:V.admissionPayments,calculated:V.calculated,patient:V.bill.Patient?{id:V.bill.Patient.id,name:V.bill.Patient.name,admission_date:V.bill.Patient.admission_date,discharge_date:V.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");h("")}catch(oe){console.error("Failed to submit payment:",oe),u(oe instanceof Error?oe.message:"Failed to record payment")}};return s?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):f?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",f]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((E=r.patient)==null?void 0:E.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(T=r.patient)!=null&&T.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((I=r.patient)==null?void 0:I.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((D=r.status)==null?void 0:D.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((q=r==null?void 0:r.calculated)==null?void 0:q.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number((F=r==null?void 0:r.calculated)==null?void 0:F.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number(($=r==null?void 0:r.calculated)==null?void 0:$.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((B=r==null?void 0:r.calculated)==null?void 0:B.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((z=r==null?void 0:r.calculated)==null?void 0:z.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:d,onChange:ee=>h(ee.target.value),placeholder:`Max ${(Number((U=r==null?void 0:r.calculated)==null?void 0:U.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((L=r==null?void 0:r.calculated)==null?void 0:L.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:ee=>b(ee.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:s||!d||parseFloat(d)<=0||parseFloat(d)>(Number((R=r==null?void 0:r.calculated)==null?void 0:R.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(G=r==null?void 0:r.AdmissionPayments)==null?void 0:G.map(ee=>{if(!ee||typeof ee!="object")return null;let te="Invalid Date";try{ee.payment_date&&!isNaN(new Date(ee.payment_date).getTime())&&(te=new Date(ee.payment_date).toLocaleString())}catch(oe){console.error("Error formatting payment date:",ee.payment_date,oe)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ee.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(ee.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:ee.payment_mode??"N/A"})]},ee.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var pre=Object.defineProperty,Ob=Object.getOwnPropertySymbols,zA=Object.prototype.hasOwnProperty,BA=Object.prototype.propertyIsEnumerable,J_=(e,n,t)=>n in e?pre(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,pw=(e,n)=>{for(var t in n||(n={}))zA.call(n,t)&&J_(e,t,n[t]);if(Ob)for(var t of Ob(n))BA.call(n,t)&&J_(e,t,n[t]);return e},mw=(e,n)=>{var t={};for(var r in e)zA.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&Ob)for(var r of Ob(e))n.indexOf(r)<0&&BA.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Wd;(e=>{const n=class an{constructor(u,d,h,g){if(this.version=u,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],u<an.MIN_VERSION||u>an.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=u*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(h);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const E=this.getPenaltyScore();E<S&&(g=k,S=E),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(u,d){const h=e.QrSegment.makeSegments(u);return an.encodeSegments(h,d)}static encodeBinary(u,d){const h=e.QrSegment.makeBytes(u);return an.encodeSegments([h],d)}static encodeSegments(u,d,h=1,g=40,b=-1,v=!0){if(!(an.MIN_VERSION<=h&&h<=g&&g<=an.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=h;;S++){const D=an.getNumDataCodewords(S,d)*8,q=l.getTotalBits(u,S);if(q<=D){k=q;break}if(S>=g)throw new RangeError("Data too long")}for(const D of[an.Ecc.MEDIUM,an.Ecc.QUARTILE,an.Ecc.HIGH])v&&k<=an.getNumDataCodewords(S,D)*8&&(d=D);let E=[];for(const D of u){t(D.mode.modeBits,4,E),t(D.numChars,D.mode.numCharCountBits(S),E);for(const q of D.getData())E.push(q)}a(E.length==k);const T=an.getNumDataCodewords(S,d)*8;a(E.length<=T),t(0,Math.min(4,T-E.length),E),t(0,(8-E.length%8)%8,E),a(E.length%8==0);for(let D=236;E.length<T;D^=253)t(D,8,E);let I=[];for(;I.length*8<E.length;)I.push(0);return E.forEach((D,q)=>I[q>>>3]|=D<<7-(q&7)),new an(S,d,I,b)}getModule(u,d){return 0<=u&&u<this.size&&0<=d&&d<this.size&&this.modules[d][u]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const u=this.getAlignmentPatternPositions(),d=u.length;for(let h=0;h<d;h++)for(let g=0;g<d;g++)h==0&&g==0||h==0&&g==d-1||h==d-1&&g==0||this.drawAlignmentPattern(u[h],u[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(u){const d=this.errorCorrectionLevel.formatBits<<3|u;let h=d;for(let b=0;b<10;b++)h=h<<1^(h>>>9)*1335;const g=(d<<10|h)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let u=this.version;for(let h=0;h<12;h++)u=u<<1^(u>>>11)*7973;const d=this.version<<12|u;a(d>>>18==0);for(let h=0;h<18;h++){const g=r(d,h),b=this.size-11+h%3,v=Math.floor(h/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(u,d){for(let h=-4;h<=4;h++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(h)),v=u+g,S=d+h;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(u,d){for(let h=-2;h<=2;h++)for(let g=-2;g<=2;g++)this.setFunctionModule(u+g,d+h,Math.max(Math.abs(g),Math.abs(h))!=1)}setFunctionModule(u,d,h){this.modules[d][u]=h,this.isFunction[d][u]=!0}addEccAndInterleave(u){const d=this.version,h=this.errorCorrectionLevel;if(u.length!=an.getNumDataCodewords(d,h))throw new RangeError("Invalid argument");const g=an.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][d],b=an.ECC_CODEWORDS_PER_BLOCK[h.ordinal][d],v=Math.floor(an.getNumRawDataModules(d)/8),S=g-v%g,k=Math.floor(v/g);let E=[];const T=an.reedSolomonComputeDivisor(b);for(let D=0,q=0;D<g;D++){let F=u.slice(q,q+k-b+(D<S?0:1));q+=F.length;const $=an.reedSolomonComputeRemainder(F,T);D<S&&F.push(0),E.push(F.concat($))}let I=[];for(let D=0;D<E[0].length;D++)E.forEach((q,F)=>{(D!=k-b||F>=S)&&I.push(q[D])});return a(I.length==v),I}drawCodewords(u){if(u.length!=Math.floor(an.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=h-b,k=(h+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&d<u.length*8&&(this.modules[k][v]=r(u[d>>>3],7-(d&7)),d++)}}a(d==u.length*8)}applyMask(u){if(u<0||u>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let h=0;h<this.size;h++){let g;switch(u){case 0:g=(h+d)%2==0;break;case 1:g=d%2==0;break;case 2:g=h%3==0;break;case 3:g=(h+d)%3==0;break;case 4:g=(Math.floor(h/3)+Math.floor(d/2))%2==0;break;case 5:g=h*d%2+h*d%3==0;break;case 6:g=(h*d%2+h*d%3)%2==0;break;case 7:g=((h+d)%2+h*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][h]&&g&&(this.modules[d][h]=!this.modules[d][h])}}getPenaltyScore(){let u=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let E=0;E<this.size;E++)this.modules[b][E]==v?(S++,S==5?u+=an.PENALTY_N1:S>5&&u++):(this.finderPenaltyAddHistory(S,k),v||(u+=this.finderPenaltyCountPatterns(k)*an.PENALTY_N3),v=this.modules[b][E],S=1);u+=this.finderPenaltyTerminateAndCount(v,S,k)*an.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let E=0;E<this.size;E++)this.modules[E][b]==v?(S++,S==5?u+=an.PENALTY_N1:S>5&&u++):(this.finderPenaltyAddHistory(S,k),v||(u+=this.finderPenaltyCountPatterns(k)*an.PENALTY_N3),v=this.modules[E][b],S=1);u+=this.finderPenaltyTerminateAndCount(v,S,k)*an.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(u+=an.PENALTY_N2)}let d=0;for(const b of this.modules)d=b.reduce((v,S)=>v+(S?1:0),d);const h=this.size*this.size,g=Math.ceil(Math.abs(d*20-h*10)/h)-1;return a(0<=g&&g<=9),u+=g*an.PENALTY_N4,a(0<=u&&u<=2568888),u}getAlignmentPatternPositions(){if(this.version==1)return[];{const u=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(u*2-2))*2;let h=[6];for(let g=this.size-7;h.length<u;g-=d)h.splice(1,0,g);return h}}static getNumRawDataModules(u){if(u<an.MIN_VERSION||u>an.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*u+128)*u+64;if(u>=2){const h=Math.floor(u/7)+2;d-=(25*h-10)*h-55,u>=7&&(d-=36)}return a(208<=d&&d<=29648),d}static getNumDataCodewords(u,d){return Math.floor(an.getNumRawDataModules(u)/8)-an.ECC_CODEWORDS_PER_BLOCK[d.ordinal][u]*an.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][u]}static reedSolomonComputeDivisor(u){if(u<1||u>255)throw new RangeError("Degree out of range");let d=[];for(let g=0;g<u-1;g++)d.push(0);d.push(1);let h=1;for(let g=0;g<u;g++){for(let b=0;b<d.length;b++)d[b]=an.reedSolomonMultiply(d[b],h),b+1<d.length&&(d[b]^=d[b+1]);h=an.reedSolomonMultiply(h,2)}return d}static reedSolomonComputeRemainder(u,d){let h=d.map(g=>0);for(const g of u){const b=g^h.shift();h.push(0),d.forEach((v,S)=>h[S]^=an.reedSolomonMultiply(v,b))}return h}static reedSolomonMultiply(u,d){if(u>>>8||d>>>8)throw new RangeError("Byte out of range");let h=0;for(let g=7;g>=0;g--)h=h<<1^(h>>>7)*285,h^=(d>>>g&1)*u;return a(h>>>8==0),h}finderPenaltyCountPatterns(u){const d=u[1];a(d<=this.size*3);const h=d>0&&u[2]==d&&u[3]==d*3&&u[4]==d&&u[5]==d;return(h&&u[0]>=d*4&&u[6]>=d?1:0)+(h&&u[6]>=d*4&&u[0]>=d?1:0)}finderPenaltyTerminateAndCount(u,d,h){return u&&(this.finderPenaltyAddHistory(d,h),d=0),d+=this.size,this.finderPenaltyAddHistory(d,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(u,d){d[0]==0&&(u+=this.size),d.pop(),d.unshift(u)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(f,u,d){if(u<0||u>31||f>>>u)throw new RangeError("Value out of range");for(let h=u-1;h>=0;h--)d.push(f>>>h&1)}function r(f,u){return(f>>>u&1)!=0}function a(f){if(!f)throw new Error("Assertion error")}const s=class mr{constructor(u,d,h){if(this.mode=u,this.numChars=d,this.bitData=h,d<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(u){let d=[];for(const h of u)t(h,8,d);return new mr(mr.Mode.BYTE,u.length,d)}static makeNumeric(u){if(!mr.isNumeric(u))throw new RangeError("String contains non-numeric characters");let d=[];for(let h=0;h<u.length;){const g=Math.min(u.length-h,3);t(parseInt(u.substring(h,h+g),10),g*3+1,d),h+=g}return new mr(mr.Mode.NUMERIC,u.length,d)}static makeAlphanumeric(u){if(!mr.isAlphanumeric(u))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],h;for(h=0;h+2<=u.length;h+=2){let g=mr.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h))*45;g+=mr.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h+1)),t(g,11,d)}return h<u.length&&t(mr.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h)),6,d),new mr(mr.Mode.ALPHANUMERIC,u.length,d)}static makeSegments(u){return u==""?[]:mr.isNumeric(u)?[mr.makeNumeric(u)]:mr.isAlphanumeric(u)?[mr.makeAlphanumeric(u)]:[mr.makeBytes(mr.toUtf8ByteArray(u))]}static makeEci(u){let d=[];if(u<0)throw new RangeError("ECI assignment value out of range");if(u<128)t(u,8,d);else if(u<16384)t(2,2,d),t(u,14,d);else if(u<1e6)t(6,3,d),t(u,21,d);else throw new RangeError("ECI assignment value out of range");return new mr(mr.Mode.ECI,0,d)}static isNumeric(u){return mr.NUMERIC_REGEX.test(u)}static isAlphanumeric(u){return mr.ALPHANUMERIC_REGEX.test(u)}getData(){return this.bitData.slice()}static getTotalBits(u,d){let h=0;for(const g of u){const b=g.mode.numCharCountBits(d);if(g.numChars>=1<<b)return 1/0;h+=4+b+g.bitData.length}return h}static toUtf8ByteArray(u){u=encodeURI(u);let d=[];for(let h=0;h<u.length;h++)u.charAt(h)!="%"?d.push(u.charCodeAt(h)):(d.push(parseInt(u.substring(h+1,h+3),16)),h+=2);return d}};s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=s;e.QrSegment=s})(Wd||(Wd={}));(e=>{(n=>{const t=class{constructor(a,s){this.ordinal=a,this.formatBits=s}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(Wd||(Wd={}));(e=>{(n=>{const t=class{constructor(a,s){this.modeBits=a,this.numBitsCharCount=s}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Wd||(Wd={}));var Dh=Wd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var mre={L:Dh.QrCode.Ecc.LOW,M:Dh.QrCode.Ecc.MEDIUM,Q:Dh.QrCode.Ecc.QUARTILE,H:Dh.QrCode.Ecc.HIGH},UA=128,qA="L",VA="#FFFFFF",HA="#000000",GA=!1,YA=1,gre=4,yre=0,xre=.1;function WA(e,n=0){const t=[];return e.forEach(function(r,a){let s=null;r.forEach(function(l,f){if(!l&&s!==null){t.push(`M${s+n} ${a+n}h${f-s}v1H${s+n}z`),s=null;return}if(f===r.length-1){if(!l)return;s===null?t.push(`M${f+n},${a+n} h1v1H${f+n}z`):t.push(`M${s+n},${a+n} h${f+1-s}v1H${s+n}z`);return}l&&s===null&&(s=f)})}),t.join("")}function QA(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,s)=>s<n.x||s>=n.x+n.w?a:!1))}function bre(e,n,t,r){if(r==null)return null;const a=e.length+t*2,s=Math.floor(n*xre),l=a/n,f=(r.width||s)*l,u=(r.height||s)*l,d=r.x==null?e.length/2-f/2:r.x*l,h=r.y==null?e.length/2-u/2:r.y*l,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let S=Math.floor(d),k=Math.floor(h),E=Math.ceil(f+d-S),T=Math.ceil(u+h-k);b={x:S,y:k,w:E,h:T}}const v=r.crossOrigin;return{x:d,y:h,h:u,w:f,excavation:b,opacity:g,crossOrigin:v}}function vre(e,n){return n!=null?Math.max(Math.floor(n),0):e?gre:yre}function JA({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:s,size:l,boostLevel:f}){let u=An.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,E)=>(k.push(...Dh.QrSegment.makeSegments(E)),k),[]);return Dh.QrCode.encodeSegments(S,mre[n],t,void 0,void 0,f)},[e,n,t,f]);const{cells:d,margin:h,numCells:g,calculatedImageSettings:b}=An.useMemo(()=>{let v=u.getModules();const S=vre(r,a),k=v.length+S*2,E=bre(v,l,S,s);return{cells:v,margin:S,numCells:k,calculatedImageSettings:E}},[u,l,s,r,a]);return{qrcode:u,margin:h,cells:d,numCells:g,calculatedImageSettings:b}}var wre=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Vh=An.forwardRef(function(n,t){const r=n,{value:a,size:s=UA,level:l=qA,bgColor:f=VA,fgColor:u=HA,includeMargin:d=GA,minVersion:h=YA,boostLevel:g,marginSize:b,imageSettings:v}=r,k=mw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:E}=k,T=mw(k,["style"]),I=v==null?void 0:v.src,D=An.useRef(null),q=An.useRef(null),F=An.useCallback(te=>{D.current=te,typeof t=="function"?t(te):t&&(t.current=te)},[t]),[$,B]=An.useState(!1),{margin:z,cells:U,numCells:L,calculatedImageSettings:R}=JA({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:d,marginSize:b,imageSettings:v,size:s});An.useEffect(()=>{if(D.current!=null){const te=D.current,oe=te.getContext("2d");if(!oe)return;let K=U;const V=q.current,J=R!=null&&V!==null&&V.complete&&V.naturalHeight!==0&&V.naturalWidth!==0;J&&R.excavation!=null&&(K=QA(U,R.excavation));const ne=window.devicePixelRatio||1;te.height=te.width=s*ne;const A=s/L*ne;oe.scale(A,A),oe.fillStyle=f,oe.fillRect(0,0,L,L),oe.fillStyle=u,wre?oe.fill(new Path2D(WA(K,z))):U.forEach(function(ae,ce){ae.forEach(function(M,de){M&&oe.fillRect(de+z,ce+z,1,1)})}),R&&(oe.globalAlpha=R.opacity),J&&oe.drawImage(V,R.x+z,R.y+z,R.w,R.h)}}),An.useEffect(()=>{B(!1)},[I]);const G=pw({height:s,width:s},E);let ee=null;return I!=null&&(ee=An.createElement("img",{src:I,key:I,style:{display:"none"},onLoad:()=>{B(!0)},ref:q,crossOrigin:R==null?void 0:R.crossOrigin})),An.createElement(An.Fragment,null,An.createElement("canvas",pw({style:G,height:s,width:s,ref:F,role:"img"},T)),ee)});Vh.displayName="QRCodeCanvas";var Sre=An.forwardRef(function(n,t){const r=n,{value:a,size:s=UA,level:l=qA,bgColor:f=VA,fgColor:u=HA,includeMargin:d=GA,minVersion:h=YA,boostLevel:g,title:b,marginSize:v,imageSettings:S}=r,k=mw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:E,cells:T,numCells:I,calculatedImageSettings:D}=JA({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:d,marginSize:v,imageSettings:S,size:s});let q=T,F=null;S!=null&&D!=null&&(D.excavation!=null&&(q=QA(T,D.excavation)),F=An.createElement("image",{href:S.src,height:D.h,width:D.w,x:D.x+E,y:D.y+E,preserveAspectRatio:"none",opacity:D.opacity,crossOrigin:D.crossOrigin}));const $=WA(q,E);return An.createElement("svg",pw({height:s,width:s,viewBox:`0 0 ${I} ${I}`,ref:t,role:"img"},k),!!b&&An.createElement("title",null,b),An.createElement("path",{fill:f,d:`M0,0 h${I}v${I}H0z`,shapeRendering:"crispEdges"}),An.createElement("path",{fill:u,d:$,shapeRendering:"crispEdges"}),F)});Sre.displayName="QRCodeSVG";const Nre=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},Cre=()=>{const{orderId:e}=Ti(),n=yt(),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[E,T]=w.useState("cash"),I=w.useMemo(()=>(t==null?void 0:t.medications.reduce((R,G)=>{const ee=G.total_price??0,te=ee*(G.discount_percentage??0)/100;return R+ee-te},0))??0,[t==null?void 0:t.medications]),D=5,q=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce((R,G,ee)=>{var ne,A;const te=G.drug_id??`index-${ee}`,oe=((ne=h[te])==null?void 0:ne.pack)||0,K=((A=h[te])==null?void 0:A.loose)||0,V=G.pack_price??0,J=G.loose_price??0;return R+oe*V+K*J},0),[t,h]),F=w.useCallback(async()=>{if(!e){f("Order ID is missing."),s(!1);return}s(!0),f(null);try{const R=await ge(`/api/pharmacy-orders/${e}`);if(!R.ok)throw R.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${R.statusText} (${R.status})`);const G=await R.json();console.log("Fetched order data after return:",G);const te=G.medications.map(K=>K.pack_price&&K.loose_price&&K.loose_price>0?{...K,unitsPerPack:Math.round(K.pack_price/K.loose_price)}:{...K,unitsPerPack:0}).map(K=>({...K,discount_percentage:K.discount_percentage??0}));r({...G,medications:te});const oe={};te.forEach((K,V)=>{const J=K.drug_id??`index-${V}`;oe[J]={pack:0,loose:0}}),g(oe)}catch(R){console.error("Failed to fetch order details:",R),f(R.message||"Failed to load order details.")}finally{s(!1)}},[e]);w.useEffect(()=>{F()},[F]),w.useEffect(()=>{(async()=>{try{const G=await ge("/api/clinics/settings");if(!G.ok)throw new Error("Failed to fetch clinic settings");const ee=await G.json();console.log("Fetched clinic settings:",ee),v(ee.upi_id||"")}catch(G){console.error("Error fetching clinic settings:",G)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const R=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k(R)}else k("")},[t==null?void 0:t.order_total,b]);const $=(R,G)=>{r(ee=>{if(!ee)return null;const te=ee.medications.map((K,V)=>(K.drug_id??`index-${V}`)===R?{...K,discount_percentage:isNaN(G)?0:G}:K),oe=te.reduce((K,V)=>{const J=V.total_price??0,ne=J*(V.discount_percentage??0)/100;return K+J-ne},0);return{...ee,medications:te,order_total:oe}})},B=(R,G,ee)=>{g(te=>{const oe=ee.unitsPerPack||0,V=ee.pack_quantity*oe+ee.loose_quantity,J=Math.max(0,Math.min(G,V));let ne=0,A=J;return oe>0&&(ne=Math.floor(J/oe),A=J%oe),{...te,[R]:{pack:ne,loose:A}}})},z=async()=>{const R=t==null?void 0:t.medications.map((G,ee)=>{var V,J;const te=G.drug_id??`index-${ee}`,oe=((V=h[te])==null?void 0:V.pack)||0,K=((J=h[te])==null?void 0:J.loose)||0;return oe>0||K>0?{drug_id:G.drug_id,name:G.name,pack_quantity:G.pack_quantity,loose_quantity:G.loose_quantity,returnPackQuantity:oe,returnLooseQuantity:K}:null}).filter(G=>G!==null);if(!R||R.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!R){alert("Could not prepare items for return.");return}d(!0),f(null);try{const G=await ge(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:R})}),ee=await G.json();if(!G.ok)throw new Error(ee.message||`Failed to process return: ${G.statusText}`);alert("Return processed successfully! Stock has been updated.");const te={};t==null||t.medications.forEach((oe,K)=>{const V=oe.drug_id??`index-${K}`;te[V]={pack:0,loose:0}}),g(te),F()}catch(G){console.error("Failed to process return:",G),f(G.message||"An error occurred while processing the return."),alert(`Error processing return: ${G.message||"Unknown error"}`)}finally{d(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(Lt,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(Lt,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const U=()=>{window.print()},L=Nre(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(Lt,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:U,className:"print-button",children:[i.jsx(Bs,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${L.text} ${L.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map((R,G)=>{var ne,A,ae,ce,M,de;const ee=R.drug_id??`index-${G}`,te=R.total_price??0,oe=te*(R.discount_percentage??0)/100,K=te-oe,V=((ne=h[ee])==null?void 0:ne.pack)||0,J=((A=h[ee])==null?void 0:A.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:R.name}),i.jsx("td",{children:R.pack_quantity??0}),i.jsx("td",{children:((ae=R.pack_price)==null?void 0:ae.toFixed(2))??"N/A"}),i.jsx("td",{children:R.loose_quantity??0}),i.jsx("td",{children:((ce=R.loose_price)==null?void 0:ce.toFixed(2))??"N/A"}),i.jsx("td",{children:((M=R.price)==null?void 0:M.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((de=R.price)==null?void 0:de.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:R.discount_percentage??0,onChange:Se=>$(ee,parseFloat(Se.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[R.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[D.toFixed(1),"%"]}),i.jsx("td",{children:K.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:R.pack_quantity,value:V,onChange:Se=>{const we=(parseInt(Se.target.value,10)||0)*(R.unitsPerPack||0)+J;B(ee,we,R)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:R.loose_quantity+R.pack_quantity*(R.unitsPerPack||0)-V*(R.unitsPerPack||0),value:J,onChange:Se=>{const fe=parseInt(Se.target.value,10)||0,we=V*(R.unitsPerPack||0)+fe;B(ee,we,R)},className:"return-quantity-input"})})]})]},ee)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",I.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",I.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:E,onChange:R=>T(R.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Vh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[q>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",q.toFixed(2)]}),i.jsx("button",{onClick:z,disabled:Object.values(h).every(R=>R.pack===0&&R.loose===0)||u,className:"process-return-button",children:u?i.jsxs(i.Fragment,{children:[i.jsx(hb,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(hb,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},jre=async()=>{const e=await ge("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},_re=async e=>{const n=await ge(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},kre=async e=>{const n=await ge("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},Ere=async(e,n)=>{const t=await ge(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},Tre=async e=>{const n=await ge(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},Are=async(e,n)=>{const t=await ge("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},Pre=()=>{const e=yt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,u]=w.useState(null),d=w.useCallback(async()=>{a(!0),l(null);try{const g=await jre();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),u({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{d()},[d]),w.useEffect(()=>{if(f){const g=setTimeout(()=>u(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(u(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),u(null);try{await Tre(g),u({type:"success",message:"Plan deactivated successfully!"}),d()}catch(b){l(b.message||"Failed to deactivate plan."),u({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ba,{size:18,className:"mr-2 text-green-500"}):i.jsx(rr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(Fl,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&s&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:s}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Vd,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Fr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!s&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},Dre=()=>{const e=yt(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,u]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>u(null),5e3);return()=>clearTimeout(b)}},[f]);const d=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),u(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await kre(n),u({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),u({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ba,{size:18,className:"mr-2 text-green-500"}):i.jsx(rr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),s&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:s}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:d})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:d,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:d,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:d})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Ire=()=>{const{id:e}=Ti(),n=yt(),[t,r]=w.useState(null),[a,s]=w.useState({}),[l,f]=w.useState(!1),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),d(!1);return}d(!0),g(null);try{const I=await _re(e);r(I),s({name:I.name,description:I.description||"",price:I.price,period:I.period,interval:I.interval,razorpay_plan_id:I.razorpay_plan_id||"",status:I.status})}catch(I){g(I.message||"Failed to fetch plan details."),v({type:"error",message:I.message||"Failed to fetch plan details."})}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const I=setTimeout(()=>v(null),5e3);return()=>clearTimeout(I)}},[b]);const k=I=>{const{name:D,value:q}=I.target;s(F=>({...F,[D]:q}))},E=async I=>{if(I.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await Ere(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(D){const q=D.message||"Failed to update plan.";g(q),v({type:"error",message:q})}finally{f(!1)}},T=()=>{n(-1)};return u?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ba,{size:18,className:"mr-2"}):i.jsx(rr,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:T,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},Mre=()=>{const{patientId:e}=Ti(),n=yt(),[t,r]=w.useState(null),[a,s]=w.useState([]),[l,f]=w.useState(""),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[E,T]=w.useState(null),I=w.useCallback(async()=>{d(!0),g(null);try{const F=await ge(`/api/patients/${e}`);if(!F.ok){const U=await F.json();throw new Error(U.message||"Failed to fetch patient details")}const $=await F.json();r($);const B=await ge("/api/subscriptions");if(!B.ok){const U=await B.json();throw new Error(U.message||"Failed to fetch subscription plans")}const z=await B.json();s(z.filter(U=>U.status==="active"))}catch(F){console.error("Error fetching data:",F),g(`Failed to load data: ${F.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{e?I():(g("Patient ID is missing."),d(!1))},[e,I]);const D=(F,$)=>{const B=new Date(F),z=$.interval||1;switch($.period){case"daily":B.setDate(F.getDate()+z);break;case"weekly":B.setDate(F.getDate()+z*7);break;case"monthly":B.setMonth(F.getMonth()+z);break;case"yearly":B.setFullYear(F.getFullYear()+z);break;default:console.warn(`Unknown subscription period: ${$.period}. Defaulting to 1 month.`),B.setMonth(F.getMonth()+1)}return B},q=async()=>{if(!e||!l){T("Please select a subscription plan.");return}const F=a.find($=>$.id===l);if(!F){T("Selected plan details not found.");return}k(!0),T(null);try{const $=new Date,B=D($,F);if(b==="manual"){const z={subscription_plan_id:l,subscription_status:"active",subscription_start_date:$.toISOString(),subscription_end_date:B.toISOString(),subscription_payment_method:"manual"},U=await ge(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!U.ok){const L=await U.json();throw new Error(L.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",F);const z=await Are(e,l);if(z&&z.short_url)window.location.href=z.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch($){console.error("Error starting subscription:",$),T(`Failed to start subscription: ${$.message}`),k(!1)}};return u?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):h?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:h})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(Vs,{size:28})," ","Start Subscription for ",t.name]}),E&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:E})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map(F=>i.jsxs("div",{className:`subscription-plan-card ${l===F.id?"selected-plan":""}`,onClick:()=>f(F.id),children:[i.jsx("h3",{children:F.name}),i.jsxs("p",{className:"price",children:["",F.price]}),i.jsxs("p",{className:"duration",children:["Every ",F.interval," ",F.period,F.interval>1?"s":""]}),F.description&&i.jsx("p",{children:F.description})]},F.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:q,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16}),"Back"]})]})},Rre=()=>{const e=yt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,u]=w.useState(null),d=w.useCallback(async()=>{a(!0),l(null);try{const g=await Mw();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),u({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{d()},[d]),w.useEffect(()=>{if(f){const g=setTimeout(()=>u(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(u(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),u(null);try{await dL(g),u({type:"success",message:"Clinic plan deactivated successfully!"}),d()}catch(b){l(b.message||"Failed to deactivate clinic plan."),u({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ba,{size:18,className:"mr-2 text-green-500"}):i.jsx(rr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(Lt,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(Fl,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&s&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:s}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Vd,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Fr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!s&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},Ore=()=>{const e=yt(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,u]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>u(null),5e3);return()=>clearTimeout(b)}},[f]);const d=b=>{const{name:v,value:S,type:k}=b.target;t(E=>({...E,[v]:k==="number"?parseFloat(S):S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),u(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await cL(n),u({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),u({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ba,{size:18,className:"mr-2 text-green-500"}):i.jsx(rr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),s&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:s}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:d})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:d,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:d,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:d})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Lre=()=>{const{id:e}=Ti(),n=yt(),[t,r]=w.useState(null),[a,s]=w.useState({}),[l,f]=w.useState(!1),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),d(!1);return}d(!0),g(null);try{const I=await lL(e);r(I),s({name:I.name,description:I.description||"",price:Number(I.price),period:I.period,interval:Number(I.interval),razorpay_plan_id:I.razorpay_plan_id||"",status:I.status})}catch(I){g(I.message||"Failed to fetch clinic plan details."),v({type:"error",message:I.message||"Failed to fetch plan details."})}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const I=setTimeout(()=>v(null),5e3);return()=>clearTimeout(I)}},[b]);const k=I=>{const{name:D,value:q,type:F}=I.target;s($=>({...$,[D]:F==="number"?parseFloat(q):q}))},E=async I=>{if(I.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await uL(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(D){const q=D.message||"Failed to update clinic plan.";g(q),v({type:"error",message:q})}finally{f(!1)}},T=()=>{n(-1)};return u?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ba,{size:18,className:"mr-2"}):i.jsx(rr,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:T,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},Fre=()=>{const e=yt(),[n,t]=w.useState([]),[r,a]=w.useState(""),[s,l]=w.useState(!0),[f,u]=w.useState(null),[d,h]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{u(null);try{const E=(await Mw()).filter(T=>T.status==="active");t(E),E.length>0&&!r&&a(E[0].id)}catch(k){console.error("Error fetching plans:",k),u(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const E=await hL();if(E&&E.short_url){window.location.href=E.short_url,u("You have a pending subscription. Redirecting to payment...");return}await v()}catch(E){console.error("Error during initial page load:",E),u(`An unexpected error occurred: ${E.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(E=>E.id===r);if(!k){b("Selected plan details not found.");return}h(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const E=await fL(r);if(E&&E.short_url)window.location.href=E.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(E){console.error("Error starting clinic subscription:",E),b(`Failed to start clinic subscription: ${E.message}`),h(!1)}};return s?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):f?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:f})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(VI,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:S,disabled:!r||d||n.length===0,className:"subscription-btn",children:[d&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),d?"Initiating Payment...":"Buy Pro Plan"]})})]})},$re=()=>{const e=yt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[s,l]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,E]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[T,I]=w.useState(""),[D,q]=w.useState(""),[F,$]=w.useState({}),[B,z]=w.useState(!1),[U,L]=w.useState(null),[R,G]=w.useState([]),[ee,te]=w.useState(""),[oe,K]=w.useState(!1),[V,J]=w.useState(null);w.useEffect(()=>{const ie=setTimeout(()=>{q(T)},500);return()=>{clearTimeout(ie)}},[T]),w.useEffect(()=>{ne(D)},[D]);const ne=async(ie="")=>{a(!0);try{const _e=ie?`/api/users?search=${encodeURIComponent(ie)}`:"/api/users",tt=await(await ge(_e)).json();if(t(tt),tt.length>0){const Ke=[...new Set(tt.map(xe=>xe.clinic_id).filter(xe=>!!xe))],Oe={};await Promise.all(Ke.map(async xe=>{try{const Me=await oL(xe);Oe[xe]=Me}catch(Me){console.error(`Failed to fetch subscription status for clinic ${xe}`,Me),Oe[xe]={hasProPlan:!1}}})),$(Oe)}l(null)}catch(_e){l("Failed to fetch users."),console.error(_e)}finally{a(!1)}},A=async ie=>{ie.preventDefault();try{await ge("/users",{method:"POST",body:JSON.stringify(v)}),u(!1),S({name:"",email:"",password:"",role:"user"}),ne()}catch(_e){l("Failed to add user."),console.error(_e)}},ae=async ie=>{if(ie.preventDefault(),!g)return;const{password:_e,confirmPassword:Ve,...tt}=k,Ke={...tt};if(_e){if(_e.length<6){l("Password must be at least 6 characters long.");return}if(_e!==Ve){l("Passwords do not match.");return}Ke.password=_e}try{await ge(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Ke)}),h(!1),b(null),E({...k,password:"",confirmPassword:""}),ne()}catch(Oe){l("Failed to update user."),console.error(Oe)}},ce=async ie=>{if(window.confirm("Are you sure you want to delete this user?"))try{await ge(`/users/${ie}`,{method:"DELETE"}),ne()}catch(_e){l("Failed to delete user."),console.error(_e)}},M=ie=>{b(ie),E({name:ie.name,email:ie.email,role:ie.role,password:"",confirmPassword:""}),h(!0)},de=async()=>{K(!0);try{const ie=await Mw();G(ie),ie.length>0&&te(ie[0].id),J(null)}catch(ie){J("Failed to fetch subscription plans."),console.error(ie)}finally{K(!1)}},Se=ie=>{L(ie),z(!0),de()},fe=async ie=>{if(ie.preventDefault(),!U||!ee){l("Please select a clinic and a plan.");return}try{await ge("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:U,planId:ee})}),z(!1),L(null),te(""),ne(),l(null)}catch(_e){l("Failed to manually activate clinic subscription."),console.error(_e)}},we=async ie=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await sL(ie),ne(),l(null)}catch(_e){l("Failed to cancel subscription."),console.error(_e)}};return r?i.jsx("div",{children:"Loading users..."}):s?i.jsx("div",{className:"error-message",children:s}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:T,onChange:ie=>I(ie.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>u(!0),className:"add-user-button",children:"Add New User"})]}),f&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>u(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:A,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:ie=>S({...v,name:ie.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:ie=>S({...v,email:ie.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:ie=>S({...v,password:ie.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:ie=>S({...v,role:ie.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),d&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>h(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:ae,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:ie=>E({...k,name:ie.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:ie=>E({...k,email:ie.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:ie=>E({...k,role:ie.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:ie=>E({...k,password:ie.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:ie=>E({...k,confirmPassword:ie.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),B&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>z(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),oe&&i.jsx("div",{children:"Loading plans..."}),V&&i.jsx("div",{className:"error-message",children:V}),!oe&&!V&&R.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!oe&&!V&&R.length>0&&i.jsxs("form",{onSubmit:fe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:ee,onChange:ie=>te(ie.target.value),required:!0,children:R.map(ie=>i.jsxs("option",{value:ie.id,children:[ie.name," - $",ie.price,"/",ie.interval," ",ie.period]},ie.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(ie=>{const _e=ie.clinic_id||"N/A",Ve=_e!=="N/A"?F[_e]:null,tt=(Ve==null?void 0:Ve.hasProPlan)??!1,Ke=tt?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:ie.name}),i.jsx("td",{children:ie.email}),i.jsx("td",{children:ie.role}),i.jsx("td",{children:_e}),i.jsx("td",{children:_e!=="N/A"?i.jsx("span",{className:tt?"pro-badge":"standard-badge",children:Ke}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>M(ie),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>ce(ie.id),className:"delete-button",children:"Delete"}),ie.clinic_id&&!tt&&i.jsx("button",{onClick:()=>Se(ie.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),ie.clinic_id&&tt&&i.jsx("button",{onClick:()=>we(ie.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},ie.id)})})]})]})},zre=()=>i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(vg,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(cs,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx($d,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(cs,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(Fh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]})]})]}),Qm="tutorialCurrentStep",KA=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[r,a]=w.useState(""),[s,l]=w.useState(""),[f,u]=w.useState(""),[d,h]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!r||!s||!f){e(!1,"Please fill all fields.");return}h(!0);try{const v=await ge("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:s,role:g,password:f})});if(v.ok)e(!0,`Successfully added "${r}" as a ${g}!`),a(""),l(""),u(""),n&&n(g);else{const S=await v.json();e(!1,`Failed to add staff: ${S.message||v.statusText}`)}}catch(v){console.error("Error adding staff:",v),e(!1,`Error adding staff: ${v instanceof Error?v.message:String(v)}`)}finally{h(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Add a New Staff Member"}),i.jsx("input",{type:"text",placeholder:"Staff Name",value:r,onChange:v=>a(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"email",placeholder:"Email",value:s,onChange:v=>l(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"password",placeholder:"Password",value:f,onChange:v=>u(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"text",placeholder:"Role",value:g==="lab"?"Lab Technician":g==="pharmacy"?"Pharmacist":"Receptionist",className:"tutorial-input",disabled:!0}),i.jsx("button",{onClick:b,className:"tutorial-button primary",disabled:d,children:d?"Adding...":"Add Staff"})]})},Bre=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[s,l]=w.useState(!1),f=async()=>{t(!0);try{const u=await ge("/api/drugs/import-defaults",{method:"POST"});if(u.ok){const d=await u.json(),h=d.drugs?d.drugs.map(g=>g.name):[];a(h),l(!0),e(!0,`Default medications imported: Added ${d.details.added}, Updated ${d.details.updated}.`,"pharmacyImport")}else{const d=await u.json();e(!1,`Failed to import default medications: ${d.message||u.statusText}`)}}catch(u){console.error("Error importing default medications:",u),e(!1,`Error importing default medications: ${u instanceof Error?u.message:String(u)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Medications"}),i.jsx("p",{children:"Click the button below to populate your pharmacy inventory with a list of common medications."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-pills"})," Import Default Drugs"]})}),s&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Medications Imported:"}),i.jsx("ul",{children:r.map((u,d)=>i.jsx("li",{children:u},d))})]})]})},Ure=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[s,l]=w.useState(!1),f=async()=>{t(!0);try{const u=await ge("/api/lab-tests/import-defaults",{method:"POST"});if(u.ok){const d=await u.json(),h=d.tests?d.tests.map(g=>g.name):[];a(h),l(!0),e(!0,`Default lab tests imported: Added ${d.details.added}, Updated ${d.details.updated}.`,"labImport")}else{const d=await u.json();e(!1,`Failed to import default lab tests: ${d.message||u.statusText}`)}}catch(u){console.error("Error importing default lab tests:",u),e(!1,`Error importing default lab tests: ${u instanceof Error?u.message:String(u)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Lab Tests"}),i.jsx("p",{children:"Click the button below to populate your lab test inventory with a list of common tests."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-flask"})," Import Default Lab Tests"]})}),s&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Tests Imported:"}),i.jsx("ul",{children:r.map((u,d)=>i.jsx("li",{children:u},d))})]})]})},Jm=[{title:"Welcome to Your Admin Dashboard!",description:"This quick tour will guide you through essential features to get your clinic set up.",actionText:"Let's Start!",actionPath:null,component:null},{title:"Step 1: Manage Pharmacy Inventory",description:"Set up your pharmacy by adding drugs, managing stock levels, and importing default drug lists. This ensures smooth prescription fulfillment. Import default medications now!",actionText:"Go to Pharmacy Inventory",actionPath:"/dashboard/inventory",component:Bre},{title:"Step 2: Manage Lab Test Inventory",description:"Configure your laboratory by adding available lab tests and importing default test lists. This is crucial for accurate diagnostics. Import default lab tests now!",actionText:"Go to Lab Test Inventory",actionPath:"/lab-inventory",component:Ure},{title:"Step 3: Add Staff Members (Optional)",description:"You can add your clinic's staff, including doctors, receptionists, lab technicians, and pharmacists. Each role has specific permissions. You can skip this step for now.",actionText:"Go to Staff Management",actionPath:null,component:KA},{title:"You're All Set!",description:"You've completed the basic setup tour. Now, try out the AI-powered complaint analysis feature!",actionText:"Try the AI!",actionPath:"/edit-complaints",component:null}],qre=({onClose:e,onMarkAsSeen:n})=>{const[t,r]=w.useState(()=>{const F=localStorage.getItem(Qm);return F?parseInt(F,10):0}),[a,s]=w.useState(null),[l,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(4),S=yt();w.useEffect(()=>{if(localStorage.setItem(Qm,t.toString()),s(null),f(null),t===0){v(4);const F=setTimeout(()=>{r(B=>B+1)},4e3),$=setInterval(()=>{v(B=>B-1)},1e3);return()=>{clearTimeout(F),clearInterval($)}}},[t]);const k=(F,$,B)=>{f(F),s($),F&&(B==="pharmacyImport"||B==="labImport")&&r(z=>z+1)},E=()=>{},T=()=>{n(),e(),localStorage.removeItem(Qm)},I=async()=>{const F=Jm[t];if(q&&F.actionPath==="/edit-complaints"){d(!0),g(null);try{const $=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - AI Entry",age:null,gender:null,phone:null,address:null})});if(!$.ok){const G=await $.text();throw new Error(`Failed to create patient: ${G||$.statusText} (${$.status})`)}const B=await $.json();if(!B||!B.id)throw new Error("Failed to create new patient or retrieve patient ID.");const z=B.id,U=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:z,complaint:""})});if(!U.ok){const G=await U.text();throw new Error(`Failed to create queue entry: ${G||U.statusText} (${U.status})`)}const L=await U.json();if(!L||!L.id)throw new Error("Failed to create new complaint record or retrieve record ID.");const R=L.id;S(`/dashboard/edit-complaint/${R}`),e(),n(),localStorage.removeItem(Qm)}catch($){console.error("Error starting new AI complaint:",$);const B=`Error: ${$.message||"Failed to start new AI complaint process."}`;g(B)}finally{d(!1)}}else F.actionPath&&(S(F.actionPath),e(),t===Jm.length-1&&(n(),localStorage.removeItem(Qm)))},D=Jm[t],q=t===Jm.length-1;return i.jsx("div",{className:"tutorial-modal-overlay",children:i.jsxs("div",{className:"tutorial-modal-content",children:[i.jsx("h2",{children:D.title}),i.jsx("p",{children:D.description}),D.component&&i.jsxs("div",{className:"tutorial-interactive-area",children:[t===3?i.jsx(KA,{onActionComplete:k,onStaffAdded:E,requiredRole:null}):i.jsx(D.component,{onActionComplete:k}),a&&i.jsx("p",{className:`tutorial-message ${l?"success":"error"}`,children:a})]}),h&&i.jsx("p",{className:"tutorial-message error",children:h})," ",i.jsxs("div",{className:"tutorial-modal-actions",children:[D.actionPath&&i.jsx("button",{onClick:I,className:"tutorial-button action",disabled:u,children:u?"Creating AI Patient...":D.actionText}),t===3&&i.jsx("button",{onClick:()=>r(t+1),className:"tutorial-button secondary",children:"Next Step"}),i.jsx("button",{onClick:T,className:"tutorial-button secondary",disabled:u,children:"Skip Tutorial"})]}),t===0&&i.jsxs("div",{className:"tutorial-countdown-indicator",children:["Next step in ",b," seconds..."]}),i.jsxs("div",{className:"tutorial-step-indicator",children:["Step ",t+1," of ",Jm.length]})]})})},Vre=(e,n,t)=>{const r=Math.abs(e.getTime()-n.getTime());return Math.ceil(r/(1e3*60*60*24))<=t},K_=e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/))return new Date(e);const n=e.split("/");if(n.length===3){const t=parseInt(n[0],10),r=parseInt(n[1],10)-1,a=parseInt(n[2],10),s=new Date(a,r,t),l=parseInt(n[0],10)-1,f=parseInt(n[1],10),u=parseInt(n[2],10),d=new Date(u,l,f),h=!isNaN(s.getTime()),g=!isNaN(d.getTime());if(h&&g)return s;if(h)return s;if(g)return d}return new Date(e)},XA=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,s]=w.useState(null),[l,f]=w.useState(""),[u,d]=w.useState(""),[h,g]=w.useState(1),[b]=w.useState(10),v=new Date,S=yt();w.useEffect(()=>{(async()=>{r(!0);try{const L=await ge("/api/pharmacy-orders/refill-reminders");if(L.ok){const R=await L.json();n(R)}else s("Failed to fetch refill reminders.")}catch{s("An error occurred while fetching data.")}finally{r(!1)}})()},[]);const k=z=>{f(z.target.value),g(1)},E=z=>{d(z.target.value),g(1)},T=e.filter(z=>{const U=l?z.medicationRefillDates.some(R=>{const G=K_(R.refillDate);return!isNaN(G.getTime())&&G.toISOString().split("T")[0]===l}):!0,L=u?z.patientName.toLowerCase().includes(u.toLowerCase())||z.patientPhoneNumber.includes(u)||z.items.some(R=>R.name.toLowerCase().includes(u.toLowerCase())):!0;return U&&L}),I=h*b,D=I-b,q=T.slice(D,I),F=Math.ceil(T.length/b),$=z=>g(z),B=async z=>{try{const U=await ge(`/api/queue/patient/${z}/latest`);if(U.ok){const R=await U.json();if(R!=null&&R._id){S(`/dashboard/edit-complaint/${R._id}`,{state:{patientId:z}});return}}const L=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:z})});if(L.ok){const R=await L.json();R!=null&&R.id&&S(`/dashboard/edit-complaint/${R.id}`,{state:{patientId:z}})}}catch(U){console.error("Error handling row click:",U),s("Failed to navigate to patient complaint.")}};return t?i.jsx("div",{children:"Loading..."}):a?i.jsx("div",{children:a}):i.jsxs("div",{className:"refill-reminders-container",children:[i.jsx("h1",{children:"Refill Reminders"}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"filter-container",children:[i.jsx("label",{htmlFor:"refillDate",children:"Filter by Refill Date: "}),i.jsx("input",{type:"date",id:"refillDate",value:l,onChange:k})]}),i.jsxs("div",{className:"search-container",children:[i.jsx("label",{htmlFor:"search",children:"Search: "}),i.jsx("input",{type:"text",id:"search",placeholder:"Search by patient name, phone, or medication",value:u,onChange:E})]})]}),i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Patient Phone Number"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{children:"Refill Dates"})]})}),i.jsx("tbody",{children:q.length>0?q.map(z=>i.jsxs("tr",{onClick:()=>B(z.patientId),style:{cursor:"pointer"},children:[i.jsx("td",{children:z.patientName}),i.jsx("td",{children:z.patientPhoneNumber}),i.jsxs("td",{children:[i.jsx("ul",{children:z.items.map((U,L)=>i.jsxs("li",{children:[U.name," (Qty: ",U.quantity,")",U.tabletsPerDay&&i.jsxs("span",{children:[" - ",U.tabletsPerDay," / day"]}),U.numberOfDays&&i.jsxs("span",{children:[" for ",U.numberOfDays," days"]})]},L))}),i.jsxs("div",{children:["Last Updated: ",new Date(z.updatedAt).toLocaleDateString()]}),z.prescription_for_unavailable_drugs&&i.jsxs("div",{className:"unavailable-prescription",children:[i.jsx("strong",{children:"Unavailable:"})," ",z.prescription_for_unavailable_drugs]})]}),i.jsx("td",{children:i.jsx("ul",{children:z.medicationRefillDates.map((U,L)=>{const R=K_(U.refillDate),G=!isNaN(R.getTime())&&Vre(R,v,2);return i.jsxs("li",{className:G?"highlight-refill-date":"",children:[U.name,": ",isNaN(R.getTime())?"Invalid Date":R.toLocaleDateString()]},L)})})})]},z.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:"No refill reminders found."})})})]}),i.jsxs("div",{className:"pagination-container",children:[i.jsx("button",{onClick:()=>$(h-1),disabled:h===1,children:"Previous"}),Array.from({length:F},(z,U)=>i.jsx("button",{onClick:()=>$(U+1),className:h===U+1?"active":"",children:U+1},U+1)),i.jsx("button",{onClick:()=>$(h+1),disabled:h===F,children:"Next"})]})]})},Hre=()=>{const e=yt(),n=oi();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const l=await ge(`/api/patients?search=${r}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const u=(await l.json()).patients[0];if(!u)throw new Error("Patient with the given token not found");const d=await ge(`/api/queue/patient/${u.id}/latest`);if(d.ok){const b=await d.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a,patientId:u.id}});return}}const h=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:u.id,complaint:a})});if(!h.ok)throw new Error("Failed to create queue entry");const g=await h.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a,patientId:u.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},Gre=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,s]=w.useState(null),l=w.useCallback(async()=>{r(!0),s(null);try{const d=await ge("/api/notifications?all=true");if(d.ok){const g=(await d.json()).sort((b,v)=>{const S={expired_drug:1,near_expiry_drug:2,low_stock:3},k=S[b.type]||99,E=S[v.type]||99;return k!==E?k-E:new Date(v.created_at).getTime()-new Date(b.created_at).getTime()});n(g)}else s("Failed to fetch notifications."),console.error("Failed to fetch notifications:",d.statusText)}catch(d){s("Error fetching notifications."),console.error("Error fetching notifications:",d)}finally{r(!1)}},[]);w.useEffect(()=>{l()},[l]);const f=async d=>{try{const h=await ge(`/api/notifications/${d}/read`,{method:"PUT"});h.ok?n(g=>g.map(b=>b.id===d?{...b,is_read:!0}:b)):console.error("Failed to mark notification as read:",h.statusText)}catch(h){console.error("Error marking notification as read:",h)}},u=async()=>{try{const d=e.filter(g=>!g.is_read).map(g=>g.id);if(d.length===0)return;const h=await ge("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:d})});h.ok?n(g=>g.map(b=>({...b,is_read:!0}))):console.error("Failed to mark all notifications as read:",h.statusText)}catch(d){console.error("Error marking all notifications as read:",d)}};return t?i.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?i.jsx("div",{className:"notifications-page-container error-message",children:a}):i.jsxs("div",{className:"notifications-page-container",children:[i.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),i.jsx("div",{className:"notifications-actions",children:i.jsx("button",{onClick:u,disabled:e.every(d=>d.is_read),className:"mark-all-read-button",children:"Mark All As Read"})}),e.length===0?i.jsx("p",{className:"no-notifications-message",children:"No notifications to display."}):i.jsx("ul",{className:"notifications-list",children:e.map(d=>i.jsxs("li",{className:`notification-item ${d.is_read?"read":"unread"}`,children:[i.jsxs("div",{className:"notification-content",children:[i.jsxs("span",{className:"notification-type",children:[d.type.replace(/_/g," "),": "]}),d.message]}),i.jsxs("div",{className:"notification-meta",children:[i.jsx("span",{className:"notification-timestamp",children:new Date(d.created_at).toLocaleString()}),!d.is_read&&i.jsx("button",{onClick:()=>f(d.id),className:"mark-read-button",children:"Mark as Read"})]})]},d.id))})]})},X_=()=>{const e=yt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[s,l]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,E]=w.useState(!1),[T,I]=w.useState(null),[D,q]=w.useState([]),[F,$]=w.useState(null),[B,z]=w.useState(""),[U,L]=w.useState(""),[R,G]=w.useState(""),[ee,te]=w.useState(""),[oe,K]=w.useState(""),[V,J]=w.useState(""),[ne,A]=w.useState(""),[ae,ce]=w.useState(""),[M,de]=w.useState(""),[Se,fe]=w.useState(""),[we,ie]=w.useState(""),_e=w.useCallback(async()=>{a(!0),l(null);try{const se=await ge("/api/distributors");if(!se.ok)throw new Error(`Failed to fetch distributors: ${se.statusText}`);const Q=await se.json();t(Q)}catch(se){console.error("Failed to fetch distributors:",se),l(se.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{_e()},[_e]);const Ve=async se=>{se.preventDefault(),l(null);try{const Q=await ge("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:U,phone:R,email:ee,address:oe,gst_number:V,drug_license_number:ne})});if(!Q.ok){const re=await Q.json();throw new Error(re.message||"Failed to add distributor.")}alert("Distributor added successfully!"),ve(),_e()}catch(Q){console.error("Error adding distributor:",Q),l(Q.message||"Failed to add distributor.")}},tt=async se=>{if(se.preventDefault(),l(null),!!T)try{const Q=await ge(`/api/distributors/${T.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:U,phone:R,email:ee,address:oe,gst_number:V,drug_license_number:ne})});if(!Q.ok){const re=await Q.json();throw new Error(re.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),Pe(),_e()}catch(Q){console.error("Error updating distributor:",Q),l(Q.message||"Failed to update distributor.")}},Ke=async()=>{if(l(null),!!T)try{const se=await ge(`/api/distributors/${T.id}`,{method:"DELETE"});if(!se.ok){const Q=await se.json();throw new Error(Q.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),lt(),_e()}catch(se){console.error("Error deleting distributor:",se),l(se.message||"Failed to delete distributor.")}},Oe=w.useCallback(async se=>{l(null);try{const Q=await ge(`/api/distributors/${se}/payments`);if(!Q.ok)throw new Error(`Failed to fetch payments: ${Q.statusText}`);const je=(await Q.json()).map(ot=>({...ot,order_value:parseFloat(ot.order_value),amount_paid:parseFloat(ot.amount_paid),balance_remaining:parseFloat(ot.balance_remaining)}));q(je);const Ae=await ge(`/api/distributors/${se}/balance`);if(!Ae.ok)throw new Error(`Failed to fetch balance: ${Ae.statusText}`);const Ue=await Ae.json();$({totalOrderValue:parseFloat(Ue.totalOrderValue),totalAmountPaid:parseFloat(Ue.totalAmountPaid),remainingBalance:parseFloat(Ue.remainingBalance)})}catch(Q){console.error("Error fetching payments/balance:",Q),l(Q.message||"Failed to load payments or balance.")}},[]),xe=async se=>{if(se.preventDefault(),l(null),!!T)try{const Q=await ge(`/api/distributors/${T.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:ae,order_value:parseFloat(M||"0"),amount_paid:parseFloat(Se||"0"),notes:we})});if(!Q.ok){const re=await Q.json();throw new Error(re.message||"Failed to add payment.")}alert("Payment added successfully!"),on(),Oe(T.id)}catch(Q){console.error("Error adding payment:",Q),l(Q.message||"Failed to add payment.")}},Me=()=>{z(""),L(""),G(""),te(""),K(""),J(""),A(""),l(null),u(!0)},ve=()=>{u(!1)},Ee=se=>{I(se),z(se.name),L(se.contact_person||""),G(se.phone||""),te(se.email||""),K(se.address||""),J(se.gst_number||""),A(se.drug_license_number||""),l(null),h(!0)},Pe=()=>{h(!1),I(null)},rt=se=>{I(se),l(null),b(!0)},lt=()=>{b(!1),I(null)},Ze=se=>{I(se),Oe(se.id),l(null),S(!0)},Rt=()=>{S(!1),I(null),q([]),$(null)},kt=se=>{I(se),ce(new Date().toISOString().split("T")[0]),de("0"),fe("0"),ie(""),l(null),E(!0)},on=()=>{E(!1),I(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):s?i.jsxs("div",{className:"error-indicator",children:["Error: ",s]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(Lt,{size:24})," Back"]}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const se=n.reduce((re,je)=>re+parseFloat(je.remainingBalance||"0"),0),Q=se>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${Q}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",se.toFixed(2)]})})(),i.jsxs("button",{onClick:Me,className:"add-distributor-button",children:[i.jsx(Il,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(se=>i.jsxs("tr",{children:[i.jsx("td",{children:se.name}),i.jsx("td",{children:se.contact_person||"-"}),i.jsx("td",{children:se.phone||"-"}),i.jsx("td",{children:se.email||"-"}),i.jsx("td",{children:se.address||"-"}),i.jsx("td",{children:se.gst_number||"-"})," ",i.jsx("td",{children:se.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(se.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",se.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>Ze(se),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(_2,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>kt(se),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(Il,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>Ee(se),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(Vd,{size:16})}),i.jsx("button",{onClick:()=>rt(se),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(Fr,{size:16})})]})})]},se.id))})]})}),f&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ve,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),s&&i.jsx("div",{className:"modal-error-message",children:s}),i.jsxs("form",{onSubmit:Ve,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:B,onChange:se=>z(se.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:U,onChange:se=>L(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:R,onChange:se=>G(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:ee,onChange:se=>te(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:oe,onChange:se=>K(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:V,onChange:se=>J(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:ne,onChange:se=>A(se.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ve,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),d&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Pe,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),s&&i.jsx("div",{className:"modal-error-message",children:s}),i.jsxs("form",{onSubmit:tt,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:B,onChange:se=>z(se.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:U,onChange:se=>L(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:R,onChange:se=>G(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:ee,onChange:se=>te(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:oe,onChange:se=>K(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:V,onChange:se=>J(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:ne,onChange:se=>A(se.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Pe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:lt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',T.name,'"?']}),s&&i.jsx("div",{className:"modal-error-message",children:s}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:lt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ke,className:"button-delete",children:"Delete"})]})]})}),v&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:Rt,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",T.name]}),s&&i.jsx("div",{className:"modal-error-message",children:s}),F&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",F.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",F.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",F.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),D.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:D.map(se=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(se.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",se.order_value.toFixed(2)]}),i.jsxs("td",{children:["",se.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",se.balance_remaining.toFixed(2)]}),i.jsx("td",{children:se.notes||"-"})]},se.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:Rt,className:"button-cancel",children:"Close"})})]})}),k&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:on,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",T.name]}),s&&i.jsx("div",{className:"modal-error-message",children:s}),i.jsxs("form",{onSubmit:xe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:ae,onChange:se=>ce(se.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:M,onChange:se=>de(se.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:Se,onChange:se=>fe(se.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:we,onChange:se=>ie(se.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:on,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},Yre=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[s,l]=w.useState({});if(w.useEffect(()=>{e&&u()},[e,t,a]),!e)return null;const f=(h,g)=>{l(b=>({...b,[h]:g}))},u=()=>{const h={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=Zm(g,b);v&&(h[g]=v.name)}),l(h)},d=()=>{const h={};for(const g in s)s[g]&&s[g]!=="none"&&(h[g]=s[g]);r(h),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:u,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((h,g)=>i.jsxs(An.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:h}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:s[h]||"",onChange:b=>f(h,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:d,className:"button-submit",children:"Confirm Mapping"})]})]})})},Wre=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[s,l]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),u(!1),h(!1))},[e]),w.useEffect(()=>{const E=I=>{I.key==="Tab"&&b.current===document.activeElement&&(d||(h(!0),setTimeout(()=>{var D;(D=v.current)==null||D.focus()},0),I.preventDefault()))},T=I=>{g.current&&!g.current.contains(I.target)&&h(!1)};return document.addEventListener("keydown",E),document.addEventListener("mousedown",T),()=>{document.removeEventListener("keydown",E),document.removeEventListener("mousedown",T)}},[d]);const S=E=>{const{name:T,value:I,type:D}=E.target;a(q=>({...q,[T]:D==="number"?parseFloat(I)||null:I}))},k=E=>{if(E.preventDefault(),l(null),u(!0),r.price===void 0||r.quantity_in_stock===void 0){l("MRP and Stock Quantity are required."),u(!1);return}const T={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,buying_price:r.buying_price===0?null:r.buying_price,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(T),u(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(Kn,{size:24})})]}),s&&i.jsx("div",{className:"error-message",children:s}),i.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Uo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Uo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Uo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"price",required:!0,step:"0.01",min:"0",value:r.price,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Uo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"quantity_in_stock",required:!0,step:"1",min:"0",value:r.quantity_in_stock,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"unit",value:r.unit||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>h(!d),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),d&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"buying_price",step:"0.01",min:"0",value:r.buying_price??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:f,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:f?"Adding...":"Add Drug"})]})]})]})}):null},Qre=e=>{if(!e)return null;const n=String(e).trim().toLowerCase();if(!n)return null;const t={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12",january:"01",february:"02",march:"03",april:"04",june:"06",july:"07",august:"08",september:"09",october:"10",november:"11",december:"12"};let r,a,s;const l=n.match(/^(\d{1,2})[\s\-./]*([a-z]{3})[a-z]*[\s\-./]*(\d{2,4})$/),f=n.match(/^([a-z]{3})[a-z]*[\s\-./]*(\d{1,2})[\s\-./]*(\d{2,4})$/),u=n.match(/^(\d{1,2})[\s\-./]+(\d{1,2})[\s\-./]+(\d{2,4})$/);if(l)r=l[1],a=t[l[2].substring(0,3)],s=l[3];else if(f)a=t[f[1].substring(0,3)],r=f[2],s=f[3];else if(u)r=u[1],a=u[2],s=u[3];else{const h=Date.parse(n);return isNaN(h)?null:new Date(h).toISOString().split("T")[0]}if(!r||!a||!s)return null;s.length===2&&(s=(parseInt(s)<50?"20":"19")+s),r=r.padStart(2,"0"),a=a.padStart(2,"0");const d=new Date(parseInt(s),parseInt(a)-1,parseInt(r));return d.getFullYear()===parseInt(s)&&d.getMonth()===parseInt(a)-1&&d.getDate()===parseInt(r)?`${s}-${a}-${r}`:null},Jre=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r,lastAddMethod:a})=>{const s=w.useRef(new Map),[l,f]=w.useState(e.length);w.useEffect(()=>{var d;if(e.length>l&&a==="manual"){const h=e.length-1;(d=s.current.get(`${h}-name`))==null||d.focus()}f(e.length)},[e.length,l,a]);const u=(d,h,g)=>{const b=h===e.length-1;b&&d.key==="Enter"&&(d.preventDefault(),r()),b&&d.key==="Tab"&&g==="box_number"&&!d.shiftKey&&(d.preventDefault(),r())};return i.jsxs("table",{className:"data-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"40px"},children:"#"}),i.jsx("th",{style:{minWidth:"180px"},children:"Drug Name"}),i.jsx("th",{style:{minWidth:"120px"},children:"Brand"}),i.jsx("th",{style:{minWidth:"100px"},children:"Batch"}),i.jsx("th",{style:{minWidth:"130px"},children:"Expiry"}),i.jsx("th",{style:{minWidth:"70px"},children:"Qty"}),i.jsx("th",{style:{minWidth:"70px"},children:"Free"}),i.jsx("th",{style:{minWidth:"70px"},children:"Unit"}),i.jsx("th",{style:{minWidth:"90px"},children:"Buy "}),i.jsx("th",{style:{minWidth:"90px"},children:"MRP "}),i.jsx("th",{style:{minWidth:"60px"},children:"Disc%"}),i.jsx("th",{style:{minWidth:"60px"},children:"GST%"}),i.jsx("th",{style:{minWidth:"70px"},children:"Mrgn%"}),i.jsx("th",{style:{minWidth:"80px"},children:"HSN"}),i.jsx("th",{style:{minWidth:"80px"},children:"Mfg"}),i.jsx("th",{style:{minWidth:"80px"},children:"Rack"}),i.jsx("th",{className:"sticky-col-right",style:{width:"50px",textAlign:"center"},children:i.jsx(Fr,{size:16})})]})}),i.jsx("tbody",{children:e.map((d,h)=>i.jsxs("tr",{children:[i.jsx("td",{style:{textAlign:"center",color:"var(--text-tertiary)",fontWeight:600,fontSize:"0.85rem"},children:h+1}),i.jsx("td",{children:i.jsx("input",{ref:g=>{s.current.set(`${h}-name`,g)},className:"table-input",value:d.name||"",placeholder:"Name",onChange:g=>n(g,d.id||"","name"),onKeyDown:g=>u(g,h,"name"),autoComplete:"off"})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.brand_name||"",placeholder:"Brand",onChange:g=>n(g,d.id||"","brand_name"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.batch||"",placeholder:"Batch",onChange:g=>n(g,d.id||"","batch"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"date",className:"table-input",value:d.expiry_date||"",onChange:g=>n(g,d.id||"","expiry_date"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.quantity_in_stock||"",placeholder:"0",onChange:g=>n(g,d.id||"","quantity_in_stock"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.loose||"",placeholder:"0",onChange:g=>n(g,d.id||"","loose"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.unit||"",placeholder:"Tab/Strip",onChange:g=>n(g,d.id||"","unit"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.buying_price||"",placeholder:"0.00",onChange:g=>n(g,d.id||"","buying_price"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.price||"",placeholder:"0.00",onChange:g=>n(g,d.id||"","price"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.discount||"",placeholder:"0",onChange:g=>n(g,d.id||"","discount"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.gst||"",placeholder:"5",onChange:g=>n(g,d.id||"","gst"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.margin||"",placeholder:"0",onChange:g=>n(g,d.id||"","margin"),onKeyDown:g=>u(g,h),readOnly:!0,style:{color:"var(--secondary)",fontWeight:"bold",cursor:"default"}})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.hsn_code||"",placeholder:"HSN",onChange:g=>n(g,d.id||"","hsn_code"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.mfg||"",placeholder:"Mfg",onChange:g=>n(g,d.id||"","mfg"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.box_number||"",placeholder:"Rack",onChange:g=>n(g,d.id||"","box_number"),onKeyDown:g=>u(g,h,"box_number")})}),i.jsx("td",{className:"sticky-col-right",style:{textAlign:"center"},children:i.jsx("button",{onClick:()=>t(d.id||""),className:"delete-row-btn",tabIndex:-1,title:"Remove Row",children:i.jsx(Fr,{size:16})})})]},d.id))})]})},Z_=()=>{const e=yt(),[n,t]=w.useState(()=>{const we=localStorage.getItem("theme");return we||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});w.useEffect(()=>{document.documentElement.setAttribute("data-theme",n)},[n]),w.useEffect(()=>{const we=window.matchMedia("(prefers-color-scheme: dark)"),ie=_e=>{localStorage.getItem("theme")||t(_e.matches?"dark":"light")};return we.addEventListener("change",ie),()=>we.removeEventListener("change",ie)},[]);const r=()=>t(we=>{const ie=we==="light"?"dark":"light";return localStorage.setItem("theme",ie),ie}),[,a]=w.useState(!1),s=w.useRef(null),[l,f]=w.useState(""),[u,d]=w.useState([]),[h,g]=w.useState(null),[b,v]=w.useState(!1),S=w.useRef(null),[k,E]=w.useState(!1),[T,I]=w.useState(!1),[D,q]=w.useState([]),[F,$]=w.useState(null),[B,z]=w.useState(null),[U,L]=w.useState(0),[R,G]=w.useState([]),[ee,te]=w.useState("manual"),oe=["name","description","price","quantity_in_stock","unit","supplier","expiry_date","buying_price","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],K=w.useCallback((we,ie="manual")=>{const _e=we||(h?h.name:"");te(ie),G(Ve=>[...Ve,{id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",supplier:_e,expiry_date:"",buying_price:0,box_number:"",gst:5,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""}])},[h]),V=we=>G(ie=>ie.filter(_e=>_e.id!==we)),J=(we,ie,_e)=>{const{value:Ve}=we.target;G(tt=>(tt.findIndex(Oe=>Oe.id===ie)===tt.length-1&&Ve.trim()!==""&&setTimeout(()=>K(void 0,"auto"),0),tt.map(Oe=>{if(Oe.id===ie){let xe=Ve;["price","quantity_in_stock","buying_price","gst","margin","discount","loose"].includes(_e)?(xe=parseFloat(Ve),isNaN(xe)&&(xe=null)):_e==="expiry_date"&&(xe=Ve.trim()===""?null:Ve);const Me={...Oe,[_e]:xe};if(h&&(Me.supplier=h.name),["buying_price","price","gst"].includes(_e)){const ve=_e==="buying_price"?xe:Me.buying_price,Ee=_e==="price"?xe:Me.price,Pe=_e==="gst"?xe:Me.gst;if(Ee&&Ee>0&&ve!==void 0&&ve!==null){const rt=ve*(1+(Pe||0)/100);Me.margin=parseFloat(((Ee-rt)/Ee*100).toFixed(2))}}return Me}return Oe})))},ne=w.useCallback(()=>R.reduce((we,ie)=>{const _e=ie.quantity_in_stock||0,Ve=ie.buying_price||0,tt=ie.gst||0,Ke=ie.discount||0;let Oe=Ve*(1-Ke/100),xe=_e*Oe;return xe+=xe*(tt/100),we+xe},0),[R]),A=async()=>{if(!h){z("Select a distributor.");return}const we=R.filter(ie=>ie.name&&ie.name.trim()!==""||ie.buying_price&&ie.buying_price>0);if(we.length===0){z("No valid items.");return}a(!0),z(null),zs.addRequest();try{for(const Ve of we){const tt={...Ve,supplier:h.name,expiry_date:Ve.expiry_date||null,distributorId:h.id};if(!(await ge("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(tt)})).ok)throw new Error(`Failed to add ${Ve.name}`)}const ie=ne();if(!(await ge(`/api/distributors/${h.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:new Date().toISOString().split("T")[0],order_value:ie,amount_paid:U,notes:`Purchase - ${we.length} items`})})).ok)throw new Error("Payment record failed.");G([]),g(null),f(""),L(0),alert("Success!"),e("/dashboard/inventory")}catch(ie){z(ie.message||"Failed.")}finally{a(!1),zs.removeRequest()}},ae=async we=>{var Ve,tt;const ie=(Ve=we.target.files)==null?void 0:Ve[0];if(!ie)return;a(!0),zs.addRequest(),z(null),$(ie);const _e=(tt=ie.name.split(".").pop())==null?void 0:tt.toLowerCase();if(["xlsx","xls","csv"].includes(_e||"")){const Ke=new FormData;Ke.append("inventoryFile",ie);try{const Oe=await ge("/api/drugs/get-file-headers",{method:"POST",body:Ke});if(!Oe.ok)throw new Error("Failed headers");const{headers:xe}=await Oe.json();q(xe),E(!0)}catch(Oe){z(Oe.message),$(null)}finally{a(!1),zs.removeRequest()}}else if(["pdf","png","jpg","jpeg"].includes(_e||"")){const Ke=new FormData;Ke.append("file",ie),Ke.append("output_type","csv");const Oe="00841ac4-b279-11f0-ab55-0a3a41e3fad1";try{const xe=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:{Authorization:`Bearer ${Oe}`},body:Ke});if(!xe.ok)throw new Error("OCR Failed");const Me=await xe.json();if(!Me.success||!Me.content)throw new Error("No data from OCR");let ve=Me.content.split(`
`).filter(Ze=>!Ze.startsWith("#")&&Ze.trim()).join(`
`);const Ee=new File([ve],"ocr.csv",{type:"text/csv"}),Pe=new FormData;Pe.append("inventoryFile",Ee);const rt=await ge("/api/drugs/get-file-headers",{method:"POST",body:Pe});if(!rt.ok)throw new Error("Failed parsing OCR CSV");const{headers:lt}=await rt.json();q(lt),$(Ee),E(!0)}catch(xe){z(xe.message),$(null)}finally{a(!1),zs.removeRequest()}}else z("Unsupported file"),a(!1),zs.removeRequest()},ce=async we=>{if(!F)return;a(!0),zs.addRequest();const ie=new FormData;ie.append("inventoryFile",F),ie.append("columnMapping",JSON.stringify(we));try{const _e=await ge("/api/drugs/parse-excel",{method:"POST",body:ie});if(!_e.ok)throw new Error("Parse Failed");const tt=(await _e.json()).map(Ke=>({...Ke,id:Date.now().toString()+Math.random(),supplier:(h==null?void 0:h.name)||Ke.supplier,expiry_date:Qre(Ke.expiry_date)}));G(Ke=>[...Ke,...tt])}catch(_e){z(_e.message)}finally{a(!1),zs.removeRequest(),E(!1),s.current&&(s.current.value="")}},M=w.useCallback(async we=>{const ie=we.trim()===""?"/api/distributors":`/api/distributors?search=${encodeURIComponent(we)}`;try{const _e=await ge(ie);if(_e.ok){const Ve=await _e.json();d(we.trim()===""?Ve.slice(0,4):Ve)}}catch(_e){console.error(_e)}},[]),de=we=>{const ie=we.target.value;f(ie),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{M(ie),v(!0)},300)},Se=()=>{l.trim()===""&&M(""),v(!0)},fe=we=>{g(we),f(""),v(!1),d([]),G(ie=>ie.map(_e=>({..._e,supplier:we.name}))),R.length===0&&K(we.name,"manual")};return i.jsxs("div",{className:"purchase-page",children:[i.jsxs("div",{className:"purchase-header",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>e(-1),className:"icon-btn",children:i.jsx(Lt,{size:20})}),i.jsx("h2",{className:"purchase-page-title",children:"New Purchase"})]}),i.jsx("button",{onClick:r,className:"icon-btn",title:"Toggle Theme",children:n==="light"?i.jsx(zM,{size:20}):i.jsx(xR,{size:20})})]}),B&&i.jsxs("div",{className:"error-banner",style:{background:"var(--danger-bg)",color:"var(--danger)",padding:"12px",borderRadius:"8px",marginBottom:"20px",display:"flex",gap:"10px"},children:[i.jsx(rr,{size:20}),i.jsx("span",{children:B})]}),i.jsxs("div",{className:"purchase-controls-grid",children:[i.jsxs("div",{className:"control-card",children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("h3",{children:[i.jsx(CR,{size:20,className:"card-icon"})," Distributor"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"icon-btn",style:{width:"auto",borderRadius:"6px",fontSize:"0.8rem",padding:"6px 12px"},children:[i.jsx(Fh,{size:16})," Manage"]})]}),h?i.jsxs("div",{className:"selected-distributor-card",children:[i.jsxs("div",{children:[i.jsx("strong",{children:h.name}),i.jsx("br",{}),i.jsx("span",{style:{opacity:.8},children:h.contact_person})]}),i.jsx("button",{onClick:()=>g(null),style:{background:"none",border:"none",color:"var(--primary)",fontWeight:"bold",cursor:"pointer"},children:"Change"})]}):i.jsxs("div",{className:"distributor-search-wrapper",children:[i.jsxs("div",{className:"search-input-group",children:[i.jsx(jr,{size:18,className:"search-input-icon"}),i.jsx("input",{className:"distributor-input",placeholder:"Search...",value:l,onChange:de,onFocus:Se})]}),b&&u.length>0&&i.jsx("ul",{className:"search-dropdown",children:u.map(we=>i.jsx("li",{onClick:()=>fe(we),children:we.name},we.id))})]})]}),i.jsxs("div",{className:"control-card",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[i.jsx(_R,{size:20,className:"card-icon"})," Import & Actions"]})}),i.jsxs("div",{className:"action-buttons-row",children:[i.jsx("input",{ref:s,type:"file",hidden:!0,accept:".xlsx,.xls,.csv,.pdf,.png,.jpg",onChange:ae}),i.jsxs("button",{onClick:()=>{var we;return(we=s.current)==null?void 0:we.click()},disabled:!h,className:"btn-base btn-primary",children:[i.jsx(us,{size:18})," Import File"]}),i.jsxs("button",{onClick:()=>I(!0),disabled:!h,className:"btn-base btn-manual",children:[i.jsx(Fl,{size:18})," Manual"]})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",marginTop:"8px",textAlign:"center"},children:"Supports Excel, CSV, PDF, Images"})]})]}),i.jsx(Yre,{isOpen:k,onClose:()=>E(!1),excelHeaders:D,onConfirm:ce,availableFields:oe}),T&&i.jsx(Wre,{isOpen:T,onClose:()=>I(!1),onDrugAddedToPurchase:we=>{G(ie=>[...ie,{...we,id:Date.now().toString(),supplier:(h==null?void 0:h.name)||""}]),I(!1)}}),i.jsxs("div",{className:"table-container",children:[i.jsx("div",{className:"table-header-title",children:i.jsxs("h3",{children:["Items (",R.length,")"]})}),i.jsx("div",{className:"table-scroll-wrapper",children:i.jsx(Jre,{purchaseRows:R,onCellChange:J,onRemoveDrug:V,onAddEmptyRow:()=>K(void 0,"manual"),lastAddMethod:ee})}),R.length===0&&i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"var(--text-tertiary)"},children:"Select distributor to start."})]}),i.jsxs("div",{className:"purchase-footer",children:[i.jsxs("button",{onClick:()=>K(void 0,"manual"),className:"btn-base btn-secondary",style:{width:"auto",flex:0},children:[i.jsx(Fl,{size:16})," Add Row"]}),i.jsxs("div",{className:"footer-right",children:[i.jsxs("div",{className:"financial-input-group",children:[i.jsx("label",{children:"Paid:"}),i.jsx("input",{type:"number",value:U,onChange:we=>L(parseFloat(we.target.value)||0),className:"amount-paid-input"})]}),i.jsxs("div",{className:"total-display",children:[i.jsx("span",{children:"Total"}),i.jsxs("span",{className:"total-value",children:["",ne().toFixed(2)]})]}),i.jsx("button",{onClick:A,className:"submit-btn",disabled:R.length===0,children:"Submit"})]})]})]})},Kre=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},Xre=()=>{const e=yt(),n=oi(),[t,r]=w.useState(null),[a,s]=w.useState([]),[l,f]=w.useState(!0),[u,d]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[E,T]=w.useState(""),[I,D]=w.useState(""),[q,F]=w.useState(""),[$,B]=w.useState(""),[z,U]=w.useState(0),L=w.useRef(!1),R=ne=>{const A=Math.max(0,Math.min(100,isNaN(ne)?0:ne));L.current=!0,U(A);const ae=a.map(ce=>({...ce,discount_percentage:A}));s(ae)},G=(ne,A)=>{const ae=[...a];ae[ne].discount_percentage=isNaN(A)?0:A,s(ae)};w.useEffect(()=>{if(L.current){L.current=!1;return}const ne=a.reduce((ce,M)=>ce+(M.total_price??0),0);if(ne===0){U(0);return}const ae=a.reduce((ce,M)=>{const Se=(M.total_price??0)*((M.discount_percentage??0)/100);return ce+Se},0)/ne*100;U(ce=>Math.abs(ce-ae)>.01?ae:ce)},[a]);const ee=async()=>{if(!t)return d("No order data available to bill."),null;if(a.length===0)return d("Cannot bill an empty order."),null;g(!0),d(null);try{const ne=a.map(de=>{const Se=(de.pricePerLooseUnit??0)*(de.looseQuantity??0),fe=Se*((de.discount_percentage??0)/100),we=Se-fe;return{name:de.name,pack_quantity:de.loosePacks??0,loose_quantity:de.looseUnits??0,price:de.originalPrice??0,pack_price:de.originalPrice??0,loose_price:de.pricePerLooseUnit??0,total:we,drug_id:de.drug_id,discount_percentage:de.discount_percentage??0,batch:de.batch,expiry_date:de.expiry_date}}),A={patientId:t.patientId,queueId:t.id,items:ne,amount:J,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:z},ae=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),ce=await ae.json();if(!ae.ok||!ce.id)throw new Error(ce.message||"Failed to create bill.");const M=await ge(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ce.id,medications:a})});if(!M.ok){const de=await M.text();throw new Error(`Failed to update pharmacy order status: ${M.statusText} - ${de}`)}return r(de=>de?{...de,status:"billed",bill_id:ce.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${ce.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:ce.id},initialItems:a}}),ce.id}catch(ne){return console.error("Billing process failed:",ne),d(ne.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},te=()=>{window.print()},oe=async()=>{await ee()&&(window.print(),e(-1))};w.useEffect(()=>{const ne=n.pathname.split("/"),A=ne[ne.length-1];A?(async()=>{try{const ce=await ge(`/api/pharmacy-orders/${A}`);if(!ce.ok)throw new Error("Failed to fetch pharmacy order details");const M=await ce.json();r(M);const de=M.medications.map(Se=>{const fe=Kre(Se.unit),we=(Se.pack_quantity??0)*fe+(Se.loose_quantity??0);return{...Se,isLoose:!0,loosePacks:Se.pack_quantity??0,looseUnits:Se.loose_quantity??0,looseQuantity:we,pack_price:Number(Se.pack_price)||0,loose_price:Number(Se.loose_price)||0,total_price:Number(Se.total_price)||0,pricePerLooseUnit:Number(Se.loose_price)||0,originalPrice:Number(Se.pack_price)||0,discount_percentage:Number(Se.discount_percentage)??0,directions_to_use:Se.directions_to_use,tabletsPerDay:Se.tabletsPerDay,numberOfDays:Se.numberOfDays,batch:Se.batch,expiry_date:Se.expiry_date}});s(de)}catch(ce){console.error("Failed to fetch order:",ce),d(ce.message||"Failed to load order details.")}finally{f(!1)}})():(d("No pharmacy order ID provided."),f(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const A=await ge("/api/clinics/settings");if(!A.ok)throw new Error("Failed to fetch clinic settings");const ae=await A.json();T(ae.upi_id||""),D(ae.name||""),F(ae.address||""),B(ae.notes||"")}catch(A){console.error("Error fetching clinic settings:",A)}})()},[]);const K=w.useMemo(()=>a.reduce((ne,A)=>ne+(A.total_price??0),0),[a]),V=w.useMemo(()=>a.reduce((ne,A)=>{const ce=(A.total_price??0)*(A.discount_percentage??0)/100;return ne+ce},0),[a]),J=w.useMemo(()=>K-V,[K,V]);return w.useEffect(()=>{if(J>0&&E){const ne=`upi://pay?pa=${E}&pn=ClinicName&am=${J.toFixed(2)}&cu=INR`;k(ne)}else k("")},[J,E]),l?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):u?i.jsxs("div",{className:"error-message-box",children:["Error: ",u]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:I?`${I} Pharmacy`:"Pharmacy Bill"}),(q||$)&&i.jsxs("div",{className:"clinic-details-print",children:[q&&i.jsx("span",{className:"small-text clinic-address",children:q}),$&&i.jsx("span",{className:"small-text clinic-notes",children:$})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Vs,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Od,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(og,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Lt,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Vs,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Od,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(Ll,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(og,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((ne,A)=>{var Se,fe;const ae=ne.total_price??0,ce=ae*(ne.discount_percentage??0)/100,M=ae-ce;return i.jsxs("tr",{children:[i.jsx("td",{children:A+1}),i.jsx("td",{children:ne.name}),i.jsx("td",{children:ne.batch||"N/A"}),i.jsx("td",{children:ne.expiry_date?new Date(ne.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",ne.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",ne.looseUnits??0]})]}),i.jsx("td",{children:((Se=ne.originalPrice)==null?void 0:Se.toFixed(2))??"N/A"}),i.jsx("td",{children:((fe=ne.pricePerLooseUnit)==null?void 0:fe.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:ne.discount_percentage??0,onChange:we=>G(A,parseFloat(we.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:M.toFixed(2)})]},A)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Vh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",K.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",z.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",V.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(J*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",J.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",K.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",V.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:z,onChange:ne=>R(parseFloat(ne.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:h||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",J.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Vh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:ne=>v(ne.target.value),className:"payment-mode-select",disabled:h||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:te,className:"secondary-button print-preview-button no-print",disabled:h||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:oe,className:"primary-button",disabled:h||a.length===0,children:h?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},Zre=()=>{var q,F,$,B,z;const{billId:e}=Ti(),n=yt(),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),[u,d]=w.useState(""),[h,g]=w.useState(""),[b,v]=w.useState(""),[S,k]=w.useState("");w.useEffect(()=>{(async()=>{try{if(!e)throw new Error("Bill ID is missing");const L=await ge(`/api/bills/${e}`);if(!L.ok)throw new Error("Failed to fetch bill details");const R=await L.json();r(R.bill);const G=await ge("/api/clinics/settings");if(G.ok){const ee=await G.json();if(d(ee.name||""),g(ee.address||""),v(ee.notes||""),ee.upi_id&&R.amount>0){const te=`upi://pay?pa=${ee.upi_id}&pn=${encodeURIComponent(ee.name||"Clinic")}&am=${Number(R.amount).toFixed(2)}&cu=INR`;k(te)}}}catch(L){console.error("Error fetching data:",L),f(L.message||"Failed to load bill details.")}finally{s(!1)}})()},[e]);const E=()=>{window.print()};if(a)return i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."});if(l)return i.jsxs("div",{className:"error-message-box",children:["Error: ",l]});if(!t)return i.jsx("div",{className:"error-message-box",children:"No bill found."});const T=(t.items||[]).reduce((U,L)=>{const R=(Number(L.pack_price)||0)*(Number(L.pack_quantity)||0),G=(Number(L.loose_price)||0)*(Number(L.loose_quantity)||0);return U+R+G},0),I=T-Number(t.amount),D=Number(t.amount)*.05;return i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:u?`${u} Pharmacy`:"Pharmacy Bill"}),(h||b)&&i.jsxs("div",{className:"clinic-details-print",children:[h&&i.jsx("span",{className:"small-text clinic-address",children:h}),b&&i.jsx("span",{className:"small-text clinic-notes",children:b})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Vs,{size:16})," Patient Name"]})," ",((q=t.Patient)==null?void 0:q.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Od,{size:16})," Token"]})," ",((F=t.Patient)==null?void 0:F.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(og,{size:16})," Bill Date"]})," ",new Date(t.createdAt).toLocaleDateString()]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Od,{size:16})," Bill No"]})," ",(($=t.id)==null?void 0:$.slice(0,8).toUpperCase())||"N/A"]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(Lt,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"View Bill"}),i.jsxs("button",{onClick:E,className:"primary-button",style:{marginLeft:"auto",width:"auto",padding:"0.5rem 1rem"},children:[i.jsx(Bs,{size:16,style:{marginRight:"8px"}})," Print"]})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Bill Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Vs,{size:16})," Patient Name"]})," ",((B=t.Patient)==null?void 0:B.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Od,{size:16})," Token"]})," ",((z=t.Patient)==null?void 0:z.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Od,{size:16})," Bill ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(og,{size:16})," Date"]})," ",new Date(t.createdAt).toLocaleString()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Status"})," ",i.jsx("span",{className:"status-badge status-billed",children:t.status})]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Items"})}),t.items&&t.items.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:t.items.map((U,L)=>{const R=Number(U.total)||0,G=5;let ee="N/A";if(U.expiry_date)try{ee=new Date(U.expiry_date).toLocaleDateString()}catch{}return i.jsxs("tr",{children:[i.jsx("td",{children:L+1}),i.jsx("td",{children:U.name}),i.jsx("td",{children:U.batch||"N/A"}),i.jsx("td",{children:ee}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",U.pack_quantity??0]}),i.jsxs("div",{children:["Loose: ",U.loose_quantity??0]})]}),i.jsx("td",{children:Number(U.pack_price||0).toFixed(2)}),i.jsx("td",{children:Number(U.loose_price||0).toFixed(2)}),i.jsxs("td",{children:[Number(U.discount_percentage||0),"%"]}),i.jsxs("td",{children:[G.toFixed(1),"%"]}),i.jsx("td",{children:R.toFixed(2)})]},L)})})]}):i.jsx("p",{children:"No items in this bill."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:"qr-code-container qr-code-printable-section",children:[i.jsx(Vh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",T.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Discount"}),i.jsxs("span",{children:["- ",I.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",D.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",Number(t.amount).toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Payment Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",T.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",I.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",Number(t.amount).toFixed(2)]})]}),i.jsxs("div",{className:"payment-mode-section",style:{marginTop:"1rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px"},children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Mode:"})," ",(t.payment_mode||"N/A").toUpperCase()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Status:"})," ",(t.status||"N/A").toUpperCase()]})]}),i.jsx("div",{className:"qr-code-container",children:S&&i.jsxs(i.Fragment,{children:[i.jsx(Vh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})}),i.jsx("div",{className:"bill-actions",children:i.jsxs("button",{onClick:E,className:"primary-button",style:{width:"100%"},children:[i.jsx(Bs,{size:16,style:{marginRight:"8px"}})," Print Bill"]})})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})})};function zl(e){return Array.isArray?Array.isArray(e):tP(e)==="[object Array]"}function eie(e){if(typeof e=="string")return e;let n=e+"";return n=="0"&&1/e==-1/0?"-0":n}function tie(e){return e==null?"":eie(e)}function qo(e){return typeof e=="string"}function ZA(e){return typeof e=="number"}function nie(e){return e===!0||e===!1||rie(e)&&tP(e)=="[object Boolean]"}function eP(e){return typeof e=="object"}function rie(e){return eP(e)&&e!==null}function Oa(e){return e!=null}function d1(e){return!e.trim().length}function tP(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const iie="Incorrect 'index' type",aie=e=>`Invalid value for key ${e}`,sie=e=>`Pattern length exceeds max of ${e}.`,oie=e=>`Missing ${e} property in key`,lie=e=>`Property 'weight' in key '${e}' must be a positive integer`,e2=Object.prototype.hasOwnProperty;class cie{constructor(n){this._keys=[],this._keyMap={};let t=0;n.forEach(r=>{let a=nP(r);this._keys.push(a),this._keyMap[a.id]=a,t+=a.weight}),this._keys.forEach(r=>{r.weight/=t})}get(n){return this._keyMap[n]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function nP(e){let n=null,t=null,r=null,a=1,s=null;if(qo(e)||zl(e))r=e,n=t2(e),t=gw(e);else{if(!e2.call(e,"name"))throw new Error(oie("name"));const l=e.name;if(r=l,e2.call(e,"weight")&&(a=e.weight,a<=0))throw new Error(lie(l));n=t2(l),t=gw(l),s=e.getFn}return{path:n,id:t,weight:a,src:r,getFn:s}}function t2(e){return zl(e)?e:e.split(".")}function gw(e){return zl(e)?e.join("."):e}function uie(e,n){let t=[],r=!1;const a=(s,l,f)=>{if(Oa(s))if(!l[f])t.push(s);else{let u=l[f];const d=s[u];if(!Oa(d))return;if(f===l.length-1&&(qo(d)||ZA(d)||nie(d)))t.push(tie(d));else if(zl(d)){r=!0;for(let h=0,g=d.length;h<g;h+=1)a(d[h],l,f+1)}else l.length&&a(d,l,f+1)}};return a(e,qo(n)?n.split("."):n,0),r?t:t[0]}const die={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},fie={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,n)=>e.score===n.score?e.idx<n.idx?-1:1:e.score<n.score?-1:1},hie={location:0,threshold:.6,distance:100},pie={useExtendedSearch:!1,getFn:uie,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Dt={...fie,...die,...hie,...pie};const mie=/[^ ]+/g;function gie(e=1,n=3){const t=new Map,r=Math.pow(10,n);return{get(a){const s=a.match(mie).length;if(t.has(s))return t.get(s);const l=1/Math.pow(s,.5*e),f=parseFloat(Math.round(l*r)/r);return t.set(s,f),f},clear(){t.clear()}}}class PS{constructor({getFn:n=Dt.getFn,fieldNormWeight:t=Dt.fieldNormWeight}={}){this.norm=gie(t,3),this.getFn=n,this.isCreated=!1,this.setIndexRecords()}setSources(n=[]){this.docs=n}setIndexRecords(n=[]){this.records=n}setKeys(n=[]){this.keys=n,this._keysMap={},n.forEach((t,r)=>{this._keysMap[t.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,qo(this.docs[0])?this.docs.forEach((n,t)=>{this._addString(n,t)}):this.docs.forEach((n,t)=>{this._addObject(n,t)}),this.norm.clear())}add(n){const t=this.size();qo(n)?this._addString(n,t):this._addObject(n,t)}removeAt(n){this.records.splice(n,1);for(let t=n,r=this.size();t<r;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(n,t){return n[this._keysMap[t]]}size(){return this.records.length}_addString(n,t){if(!Oa(n)||d1(n))return;let r={v:n,i:t,n:this.norm.get(n)};this.records.push(r)}_addObject(n,t){let r={i:t,$:{}};this.keys.forEach((a,s)=>{let l=a.getFn?a.getFn(n):this.getFn(n,a.path);if(Oa(l)){if(zl(l)){let f=[];const u=[{nestedArrIndex:-1,value:l}];for(;u.length;){const{nestedArrIndex:d,value:h}=u.pop();if(Oa(h))if(qo(h)&&!d1(h)){let g={v:h,i:d,n:this.norm.get(h)};f.push(g)}else zl(h)&&h.forEach((g,b)=>{u.push({nestedArrIndex:b,value:g})})}r.$[s]=f}else if(qo(l)&&!d1(l)){let f={v:l,n:this.norm.get(l)};r.$[s]=f}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function rP(e,n,{getFn:t=Dt.getFn,fieldNormWeight:r=Dt.fieldNormWeight}={}){const a=new PS({getFn:t,fieldNormWeight:r});return a.setKeys(e.map(nP)),a.setSources(n),a.create(),a}function yie(e,{getFn:n=Dt.getFn,fieldNormWeight:t=Dt.fieldNormWeight}={}){const{keys:r,records:a}=e,s=new PS({getFn:n,fieldNormWeight:t});return s.setKeys(r),s.setIndexRecords(a),s}function Wx(e,{errors:n=0,currentLocation:t=0,expectedLocation:r=0,distance:a=Dt.distance,ignoreLocation:s=Dt.ignoreLocation}={}){const l=n/e.length;if(s)return l;const f=Math.abs(r-t);return a?l+f/a:f?1:l}function xie(e=[],n=Dt.minMatchCharLength){let t=[],r=-1,a=-1,s=0;for(let l=e.length;s<l;s+=1){let f=e[s];f&&r===-1?r=s:!f&&r!==-1&&(a=s-1,a-r+1>=n&&t.push([r,a]),r=-1)}return e[s-1]&&s-r>=n&&t.push([r,s-1]),t}const Rd=32;function bie(e,n,t,{location:r=Dt.location,distance:a=Dt.distance,threshold:s=Dt.threshold,findAllMatches:l=Dt.findAllMatches,minMatchCharLength:f=Dt.minMatchCharLength,includeMatches:u=Dt.includeMatches,ignoreLocation:d=Dt.ignoreLocation}={}){if(n.length>Rd)throw new Error(sie(Rd));const h=n.length,g=e.length,b=Math.max(0,Math.min(r,g));let v=s,S=b;const k=f>1||u,E=k?Array(g):[];let T;for(;(T=e.indexOf(n,S))>-1;){let B=Wx(n,{currentLocation:T,expectedLocation:b,distance:a,ignoreLocation:d});if(v=Math.min(B,v),S=T+h,k){let z=0;for(;z<h;)E[T+z]=1,z+=1}}S=-1;let I=[],D=1,q=h+g;const F=1<<h-1;for(let B=0;B<h;B+=1){let z=0,U=q;for(;z<U;)Wx(n,{errors:B,currentLocation:b+U,expectedLocation:b,distance:a,ignoreLocation:d})<=v?z=U:q=U,U=Math.floor((q-z)/2+z);q=U;let L=Math.max(1,b-U+1),R=l?g:Math.min(b+U,g)+h,G=Array(R+2);G[R+1]=(1<<B)-1;for(let te=R;te>=L;te-=1){let oe=te-1,K=t[e.charAt(oe)];if(k&&(E[oe]=+!!K),G[te]=(G[te+1]<<1|1)&K,B&&(G[te]|=(I[te+1]|I[te])<<1|1|I[te+1]),G[te]&F&&(D=Wx(n,{errors:B,currentLocation:oe,expectedLocation:b,distance:a,ignoreLocation:d}),D<=v)){if(v=D,S=oe,S<=b)break;L=Math.max(1,2*b-S)}}if(Wx(n,{errors:B+1,currentLocation:b,expectedLocation:b,distance:a,ignoreLocation:d})>v)break;I=G}const $={isMatch:S>=0,score:Math.max(.001,D)};if(k){const B=xie(E,f);B.length?u&&($.indices=B):$.isMatch=!1}return $}function vie(e){let n={};for(let t=0,r=e.length;t<r;t+=1){const a=e.charAt(t);n[a]=(n[a]||0)|1<<r-t-1}return n}const Lb=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class iP{constructor(n,{location:t=Dt.location,threshold:r=Dt.threshold,distance:a=Dt.distance,includeMatches:s=Dt.includeMatches,findAllMatches:l=Dt.findAllMatches,minMatchCharLength:f=Dt.minMatchCharLength,isCaseSensitive:u=Dt.isCaseSensitive,ignoreDiacritics:d=Dt.ignoreDiacritics,ignoreLocation:h=Dt.ignoreLocation}={}){if(this.options={location:t,threshold:r,distance:a,includeMatches:s,findAllMatches:l,minMatchCharLength:f,isCaseSensitive:u,ignoreDiacritics:d,ignoreLocation:h},n=u?n:n.toLowerCase(),n=d?Lb(n):n,this.pattern=n,this.chunks=[],!this.pattern.length)return;const g=(v,S)=>{this.chunks.push({pattern:v,alphabet:vie(v),startIndex:S})},b=this.pattern.length;if(b>Rd){let v=0;const S=b%Rd,k=b-S;for(;v<k;)g(this.pattern.substr(v,Rd),v),v+=Rd;if(S){const E=b-Rd;g(this.pattern.substr(E),E)}}else g(this.pattern,0)}searchIn(n){const{isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a}=this.options;if(n=t?n:n.toLowerCase(),n=r?Lb(n):n,this.pattern===n){let k={isMatch:!0,score:0};return a&&(k.indices=[[0,n.length-1]]),k}const{location:s,distance:l,threshold:f,findAllMatches:u,minMatchCharLength:d,ignoreLocation:h}=this.options;let g=[],b=0,v=!1;this.chunks.forEach(({pattern:k,alphabet:E,startIndex:T})=>{const{isMatch:I,score:D,indices:q}=bie(n,k,E,{location:s+T,distance:l,threshold:f,findAllMatches:u,minMatchCharLength:d,includeMatches:a,ignoreLocation:h});I&&(v=!0),b+=D,I&&q&&(g=[...g,...q])});let S={isMatch:v,score:v?b/this.chunks.length:1};return v&&a&&(S.indices=g),S}}class su{constructor(n){this.pattern=n}static isMultiMatch(n){return n2(n,this.multiRegex)}static isSingleMatch(n){return n2(n,this.singleRegex)}search(){}}function n2(e,n){const t=e.match(n);return t?t[1]:null}class wie extends su{constructor(n){super(n)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(n){const t=n===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Sie extends su{constructor(n){super(n)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(n){const r=n.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,n.length-1]}}}class Nie extends su{constructor(n){super(n)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(n){const t=n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Cie extends su{constructor(n){super(n)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(n){const t=!n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class jie extends su{constructor(n){super(n)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(n){const t=n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[n.length-this.pattern.length,n.length-1]}}}class _ie extends su{constructor(n){super(n)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(n){const t=!n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class aP extends su{constructor(n,{location:t=Dt.location,threshold:r=Dt.threshold,distance:a=Dt.distance,includeMatches:s=Dt.includeMatches,findAllMatches:l=Dt.findAllMatches,minMatchCharLength:f=Dt.minMatchCharLength,isCaseSensitive:u=Dt.isCaseSensitive,ignoreDiacritics:d=Dt.ignoreDiacritics,ignoreLocation:h=Dt.ignoreLocation}={}){super(n),this._bitapSearch=new iP(n,{location:t,threshold:r,distance:a,includeMatches:s,findAllMatches:l,minMatchCharLength:f,isCaseSensitive:u,ignoreDiacritics:d,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(n){return this._bitapSearch.searchIn(n)}}class sP extends su{constructor(n){super(n)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(n){let t=0,r;const a=[],s=this.pattern.length;for(;(r=n.indexOf(this.pattern,t))>-1;)t=r+s,a.push([r,t-1]);const l=!!a.length;return{isMatch:l,score:l?0:1,indices:a}}}const yw=[wie,sP,Nie,Cie,_ie,jie,Sie,aP],r2=yw.length,kie=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Eie="|";function Tie(e,n={}){return e.split(Eie).map(t=>{let r=t.trim().split(kie).filter(s=>s&&!!s.trim()),a=[];for(let s=0,l=r.length;s<l;s+=1){const f=r[s];let u=!1,d=-1;for(;!u&&++d<r2;){const h=yw[d];let g=h.isMultiMatch(f);g&&(a.push(new h(g,n)),u=!0)}if(!u)for(d=-1;++d<r2;){const h=yw[d];let g=h.isSingleMatch(f);if(g){a.push(new h(g,n));break}}}return a})}const Aie=new Set([aP.type,sP.type]);class Pie{constructor(n,{isCaseSensitive:t=Dt.isCaseSensitive,ignoreDiacritics:r=Dt.ignoreDiacritics,includeMatches:a=Dt.includeMatches,minMatchCharLength:s=Dt.minMatchCharLength,ignoreLocation:l=Dt.ignoreLocation,findAllMatches:f=Dt.findAllMatches,location:u=Dt.location,threshold:d=Dt.threshold,distance:h=Dt.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a,minMatchCharLength:s,findAllMatches:f,ignoreLocation:l,location:u,threshold:d,distance:h},n=t?n:n.toLowerCase(),n=r?Lb(n):n,this.pattern=n,this.query=Tie(this.pattern,this.options)}static condition(n,t){return t.useExtendedSearch}searchIn(n){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:a,ignoreDiacritics:s}=this.options;n=a?n:n.toLowerCase(),n=s?Lb(n):n;let l=0,f=[],u=0;for(let d=0,h=t.length;d<h;d+=1){const g=t[d];f.length=0,l=0;for(let b=0,v=g.length;b<v;b+=1){const S=g[b],{isMatch:k,indices:E,score:T}=S.search(n);if(k){if(l+=1,u+=T,r){const I=S.constructor.type;Aie.has(I)?f=[...f,...E]:f.push(E)}}else{u=0,l=0,f.length=0;break}}if(l){let b={isMatch:!0,score:u/l};return r&&(b.indices=f),b}}return{isMatch:!1,score:1}}}const xw=[];function Die(...e){xw.push(...e)}function bw(e,n){for(let t=0,r=xw.length;t<r;t+=1){let a=xw[t];if(a.condition(e,n))return new a(e,n)}return new iP(e,n)}const Fb={AND:"$and",OR:"$or"},vw={PATH:"$path",PATTERN:"$val"},ww=e=>!!(e[Fb.AND]||e[Fb.OR]),Iie=e=>!!e[vw.PATH],Mie=e=>!zl(e)&&eP(e)&&!ww(e),i2=e=>({[Fb.AND]:Object.keys(e).map(n=>({[n]:e[n]}))});function oP(e,n,{auto:t=!0}={}){const r=a=>{let s=Object.keys(a);const l=Iie(a);if(!l&&s.length>1&&!ww(a))return r(i2(a));if(Mie(a)){const u=l?a[vw.PATH]:s[0],d=l?a[vw.PATTERN]:a[u];if(!qo(d))throw new Error(aie(u));const h={keyId:gw(u),pattern:d};return t&&(h.searcher=bw(d,n)),h}let f={children:[],operator:s[0]};return s.forEach(u=>{const d=a[u];zl(d)&&d.forEach(h=>{f.children.push(r(h))})}),f};return ww(e)||(e=i2(e)),r(e)}function Rie(e,{ignoreFieldNorm:n=Dt.ignoreFieldNorm}){e.forEach(t=>{let r=1;t.matches.forEach(({key:a,norm:s,score:l})=>{const f=a?a.weight:null;r*=Math.pow(l===0&&f?Number.EPSILON:l,(f||1)*(n?1:s))}),t.score=r})}function Oie(e,n){const t=e.matches;n.matches=[],Oa(t)&&t.forEach(r=>{if(!Oa(r.indices)||!r.indices.length)return;const{indices:a,value:s}=r;let l={indices:a,value:s};r.key&&(l.key=r.key.src),r.idx>-1&&(l.refIndex=r.idx),n.matches.push(l)})}function Lie(e,n){n.score=e.score}function Fie(e,n,{includeMatches:t=Dt.includeMatches,includeScore:r=Dt.includeScore}={}){const a=[];return t&&a.push(Oie),r&&a.push(Lie),e.map(s=>{const{idx:l}=s,f={item:n[l],refIndex:l};return a.length&&a.forEach(u=>{u(s,f)}),f})}class np{constructor(n,t={},r){this.options={...Dt,...t},this.options.useExtendedSearch,this._keyStore=new cie(this.options.keys),this.setCollection(n,r)}setCollection(n,t){if(this._docs=n,t&&!(t instanceof PS))throw new Error(iie);this._myIndex=t||rP(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(n){Oa(n)&&(this._docs.push(n),this._myIndex.add(n))}remove(n=()=>!1){const t=[];for(let r=0,a=this._docs.length;r<a;r+=1){const s=this._docs[r];n(s,r)&&(this.removeAt(r),r-=1,a-=1,t.push(s))}return t}removeAt(n){this._docs.splice(n,1),this._myIndex.removeAt(n)}getIndex(){return this._myIndex}search(n,{limit:t=-1}={}){const{includeMatches:r,includeScore:a,shouldSort:s,sortFn:l,ignoreFieldNorm:f}=this.options;let u=qo(n)?qo(this._docs[0])?this._searchStringList(n):this._searchObjectList(n):this._searchLogical(n);return Rie(u,{ignoreFieldNorm:f}),s&&u.sort(l),ZA(t)&&t>-1&&(u=u.slice(0,t)),Fie(u,this._docs,{includeMatches:r,includeScore:a})}_searchStringList(n){const t=bw(n,this.options),{records:r}=this._myIndex,a=[];return r.forEach(({v:s,i:l,n:f})=>{if(!Oa(s))return;const{isMatch:u,score:d,indices:h}=t.searchIn(s);u&&a.push({item:s,idx:l,matches:[{score:d,value:s,norm:f,indices:h}]})}),a}_searchLogical(n){const t=oP(n,this.options),r=(f,u,d)=>{if(!f.children){const{keyId:g,searcher:b}=f,v=this._findMatches({key:this._keyStore.get(g),value:this._myIndex.getValueForItemAtKeyId(u,g),searcher:b});return v&&v.length?[{idx:d,item:u,matches:v}]:[]}const h=[];for(let g=0,b=f.children.length;g<b;g+=1){const v=f.children[g],S=r(v,u,d);if(S.length)h.push(...S);else if(f.operator===Fb.AND)return[]}return h},a=this._myIndex.records,s={},l=[];return a.forEach(({$:f,i:u})=>{if(Oa(f)){let d=r(t,f,u);d.length&&(s[u]||(s[u]={idx:u,item:f,matches:[]},l.push(s[u])),d.forEach(({matches:h})=>{s[u].matches.push(...h)}))}}),l}_searchObjectList(n){const t=bw(n,this.options),{keys:r,records:a}=this._myIndex,s=[];return a.forEach(({$:l,i:f})=>{if(!Oa(l))return;let u=[];r.forEach((d,h)=>{u.push(...this._findMatches({key:d,value:l[h],searcher:t}))}),u.length&&s.push({idx:f,item:l,matches:u})}),s}_findMatches({key:n,value:t,searcher:r}){if(!Oa(t))return[];let a=[];if(zl(t))t.forEach(({v:s,i:l,n:f})=>{if(!Oa(s))return;const{isMatch:u,score:d,indices:h}=r.searchIn(s);u&&a.push({score:d,key:n,value:s,idx:l,norm:f,indices:h})});else{const{v:s,n:l}=t,{isMatch:f,score:u,indices:d}=r.searchIn(s);f&&a.push({score:u,key:n,value:s,norm:l,indices:d})}return a}}np.version="7.1.0";np.createIndex=rP;np.parseIndex=yie;np.config=Dt;np.parseQuery=oP;Die(Pie);const $ie=({isOpen:e,onClose:n,recurringItems:t,inventory:r,onCreateOrder:a})=>{const[s,l]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState(null),[g,b]=w.useState([]),v=w.useMemo(()=>new np(r,{keys:["name","composition"],threshold:.4,includeScore:!0}),[r]);w.useEffect(()=>{if(e&&t.length>0&&r.length>0){const T=t.map(I=>{const D=v.search(I.name);let q=null,F="none";if(D.length>0){q=D[0].item;const $=D[0].score||1;$<.1?F="high":$<.4?F="medium":F="low"}return{original:I,matchedDrug:q,confidence:F}});l(T)}},[e,t,r,v]),w.useEffect(()=>{if(f){const T=v.search(f).map(I=>I.item);b(T.slice(0,10))}else b([])},[f,v]);const S=(T,I)=>{l(D=>{const q=[...D];return q[T]={...q[T],matchedDrug:I,confidence:"high"},q}),h(null),u("")},k=()=>{const T=s.filter(I=>I.matchedDrug).map(I=>{const D=Number(I.matchedDrug.price),q=E(I.matchedDrug.unit),F=D/(q||1),$=I.original.pack_quantity||0,B=I.original.loose_quantity||0,z=$*D+B*F;return{drug_id:I.matchedDrug.id,name:I.matchedDrug.name,pack_quantity:$,loose_quantity:B,pack_price:D,loose_price:F,total_price:z,unit:I.matchedDrug.unit}});a(T)},E=T=>{if(!T)return 1;const I=T.match(/(?:\d+x)?(\d+)/);return I?parseInt(I[1],10):1};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-container",children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{className:"modal-title",children:"Review Recurring Order Items"}),i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(Kn,{size:24})})]}),i.jsx("div",{className:"modal-content",children:i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:s.map((T,I)=>i.jsx("div",{className:`modal-item-card ${T.confidence==="high"?"high-confidence":T.confidence==="medium"?"medium-confidence":"low-confidence"}`,children:i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"#6b7280"},children:"Recurring Item"}),i.jsx("p",{style:{fontSize:"1.125rem",fontWeight:600,color:"#1f2937"},children:T.original.name}),i.jsxs("p",{style:{fontSize:"0.875rem",color:"#4b5563"},children:["Qty: ",T.original.pack_quantity?`${T.original.pack_quantity} packs`:"",T.original.loose_quantity?` ${T.original.loose_quantity} loose`:""]})]}),i.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 1rem"},children:T.confidence==="high"?i.jsx(Dw,{style:{color:"#22c55e"}}):i.jsx(P2,{style:{color:"#eab308"}})}),i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"#6b7280"},children:"Matched Inventory Item"}),d===I?i.jsxs("div",{style:{position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:"#ffffff"},children:[i.jsx(jr,{size:16,style:{marginLeft:"0.5rem",color:"#9ca3af"}}),i.jsx("input",{type:"text",value:f,onChange:D=>u(D.target.value),placeholder:"Search inventory...",style:{width:"100%",padding:"0.5rem",outline:"none",fontSize:"0.875rem",border:"none"},autoFocus:!0}),i.jsx("button",{onClick:()=>h(null),style:{padding:"0.5rem",color:"#9ca3af",background:"transparent",border:"none",cursor:"pointer"},children:i.jsx(Kn,{size:16})})]}),g.length>0&&i.jsx("div",{style:{position:"absolute",zIndex:10,width:"100%",marginTop:"0.25rem",backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"0.375rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",maxHeight:"12rem",overflowY:"auto"},children:g.map(D=>i.jsxs("div",{onClick:()=>S(I,D),style:{padding:"0.5rem",cursor:"pointer",fontSize:"0.875rem"},onMouseEnter:q=>q.currentTarget.style.backgroundColor="#f3f4f6",onMouseLeave:q=>q.currentTarget.style.backgroundColor="transparent",children:[i.jsx("div",{style:{fontWeight:500},children:D.name}),i.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Stock: ",D.quantity_in_stock," | ",D.price]})]},D.id))})]}):i.jsx("div",{onClick:()=>{h(I),u("")},style:{cursor:"pointer",padding:"0.5rem",borderRadius:"0.375rem",border:"1px solid transparent",transition:"all 0.2s"},onMouseEnter:D=>{D.currentTarget.style.backgroundColor="#ffffff",D.currentTarget.style.borderColor="#d1d5db"},onMouseLeave:D=>{D.currentTarget.style.backgroundColor="transparent",D.currentTarget.style.borderColor="transparent"},children:T.matchedDrug?i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:600,color:"#1f2937"},children:T.matchedDrug.name}),i.jsxs("p",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Stock: ",T.matchedDrug.quantity_in_stock," | ",T.matchedDrug.price]})]}):i.jsx("p",{style:{color:"#ef4444",fontWeight:500},children:"No match found. Click to search."})})]})]})},I))})}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{onClick:n,className:"recurring-medications-button recurring-medications-button-secondary",children:"Cancel"}),i.jsx("button",{onClick:k,disabled:s.some(T=>!T.matchedDrug),className:"recurring-medications-button recurring-medications-button-primary",style:{opacity:s.some(T=>!T.matchedDrug)?.5:1,cursor:s.some(T=>!T.matchedDrug)?"not-allowed":"pointer"},children:"Create Order"})]})]})}):null},f1=15,zie=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,s]=w.useState(null),[l,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(30),E=yt(),[T,I]=w.useState(""),[D,q]=w.useState(""),[F,$]=w.useState(1),[B,z]=w.useState(1),[U,L]=w.useState(0),[R,G]=w.useState("next_delivery_date"),[ee,te]=w.useState("asc"),[oe,K]=w.useState("");w.useEffect(()=>{const ie=setTimeout(()=>{q(T),$(1)},500);return()=>{clearTimeout(ie)}},[T]);const V=w.useCallback(async(ie,_e,Ve,tt,Ke)=>{r(!0),s(null);try{const Oe=new URLSearchParams({page:ie.toString(),limit:f1.toString(),sortBy:Ve,sortOrder:tt});_e&&Oe.append("search",_e),Ke&&Oe.append("status",Ke);const xe=await ge(`/api/recurring-medications?${Oe.toString()}`);if(!xe.ok){const ve=await xe.json().catch(()=>({}));throw new Error(ve.message||"Failed to fetch recurring medications")}const Me=await xe.json();n(Me.recurringMedications),L(Me.totalCount),$(Me.currentPage),z(Me.totalPages)}catch(Oe){s(Oe.message),n([]),L(0),$(1),z(1)}finally{r(!1)}},[]),J=async()=>{try{const ie=await ge("/api/drugs");if(ie.ok){const _e=await ie.json();g(_e)}}catch(ie){console.error("Failed to fetch inventory:",ie)}};w.useEffect(()=>{V(F,D,R,ee,oe),J()},[F,D,R,ee,oe,V]);const ne=ie=>{const _e=R===ie&&ee==="asc"?"desc":"asc";G(ie),te(_e),$(1)},A=async(ie,_e)=>{try{if(!(await ge(`/api/recurring-medications/${ie}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:_e})})).ok)throw new Error("Failed to update status");V(F,D,R,ee,oe)}catch(Ve){alert(`Error updating status: ${Ve.message}`)}},ae=(ie,_e)=>{v(ie),k(_e)},ce=async ie=>{if(S<1||S>365){alert("Frequency must be between 1 and 365 days");return}try{const _e=await ge(`/api/recurring-medications/${ie}/frequency`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({frequency_days:S})});if(!_e.ok){const Ve=await _e.json().catch(()=>({}));throw new Error(Ve.message||"Failed to update frequency")}v(null),V(F,D,R,ee,oe)}catch(_e){alert(`Error updating frequency: ${_e.message}`)}},M=()=>{v(null)},de=ie=>{d(ie),f(!0)},Se=async ie=>{if(u)try{const _e={patient_id:u.patient_id,items:ie,prescription_for_unavailable_drugs:"",status:"pending",date:new Date().toISOString(),order_total:ie.reduce((tt,Ke)=>tt+(Ke.total_price||Ke.pack_quantity*Ke.pack_price+Ke.loose_quantity*Ke.loose_price),0),recurring_medication_id:u.id},Ve=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_e)});if(!Ve.ok){const tt=await Ve.json().catch(()=>({}));throw new Error(tt.message||"Failed to create order")}alert("Order created successfully!"),f(!1),d(null),V(F,D,R,ee,oe)}catch(_e){alert(`Failed to create order: ${_e.message}`)}},fe=(ie,_e)=>{const Ve=_e.map(tt=>({name:tt.name,pack_quantity:tt.pack_quantity,loose_quantity:tt.loose_quantity,price:tt.price,pack_price:tt.pack_price,loose_price:tt.loose_price,total_price:Number(tt.total_price)||0,isLoose:tt.isLoose,unit:tt.unit,drug_id:tt.drug_id?String(tt.drug_id):null,tabletsPerDay:tt.tabletsPerDay,numberOfDays:tt.numberOfDays,directions_to_use:tt.directions_to_use,discount_percentage:tt.discount_percentage??0,batch:tt.batch,expiry_date:tt.expiry_date}));E(`/dashboard/pharmacy-billing/${ie}`,{state:{initialItems:Ve}})},we=async(ie,_e)=>{try{const Ve=await ge(`/api/pharmacy-orders/${ie}`);if(!Ve.ok)throw new Error("Failed to fetch order details");const tt=await Ve.json(),Ke={status:_e,medications:tt.medications},Oe=await ge(`/api/pharmacy-orders/${ie}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ke)});if(!Oe.ok){const xe=await Oe.text();throw new Error(`Failed to update status: ${Oe.statusText} (${Oe.status}) - ${xe}`)}V(F,D,R,ee,oe),alert(`Order marked as ${_e} successfully!`)}catch(Ve){console.error("Failed to update order status:",Ve),alert(`Error updating status: ${Ve.message}`)}};return i.jsxs("div",{className:"recurring-medications-page-container",children:[i.jsxs("div",{className:"recurring-medications-header",children:[i.jsxs("div",{className:"recurring-medications-header-left",children:[i.jsxs("button",{onClick:()=>E(-1),className:"recurring-medications-button recurring-medications-button-back",children:[i.jsx(Lt,{size:20}),"Back"]}),i.jsx("h1",{className:"recurring-medications-page-title",children:"Recurring Medications"})]}),i.jsxs("button",{onClick:()=>V(F,D,R,ee,oe),className:"recurring-medications-button recurring-medications-button-primary",children:[i.jsx(hb,{size:18}),"Refresh"]})]}),i.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[i.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 300px",position:"relative"},children:[i.jsx("input",{type:"text",placeholder:"Search by name, phone, or token...",value:T,onChange:ie=>I(ie.target.value),style:{width:"100%",padding:"0.75rem 3rem 0.75rem 1rem",border:"2px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"0.95rem",transition:"all 0.2s ease",outline:"none"},onFocus:ie=>ie.target.style.borderColor="#6d28d9",onBlur:ie=>ie.target.style.borderColor="#e5e7eb"}),i.jsx(jr,{size:20,style:{position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",border:"2px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.75rem 1rem",backgroundColor:"#ffffff"},children:[i.jsx(k2,{size:18,style:{color:"#6b7280"}}),i.jsxs("select",{id:"statusFilter",value:oe,onChange:ie=>K(ie.target.value),style:{border:"none",outline:"none",fontSize:"0.95rem",backgroundColor:"transparent",cursor:"pointer",fontWeight:500,color:"#374151"},children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),!t&&U>0&&i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280",fontWeight:500},children:["Found ",i.jsx("span",{style:{color:"#6d28d9",fontWeight:700},children:U})," recurring medication",U!==1?"s":"",(D||oe)&&" matching your criteria"]})]}),i.jsxs("div",{className:"recurring-medications-content-box",children:[a&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem 1.25rem",backgroundColor:"#fee2e2",border:"2px solid #fca5a5",borderRadius:"0.75rem",color:"#991b1b",marginBottom:"1.5rem",boxShadow:"0 2px 4px rgba(239, 68, 68, 0.1)"},children:[i.jsx(rr,{size:24,style:{flexShrink:0}}),i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"Error Loading Data"}),i.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:a})]})]}),t?i.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"20rem",gap:"1rem"},children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem",fontWeight:500},children:"Loading recurring medications..."})]}):e.length===0?i.jsxs("div",{style:{textAlign:"center",padding:"4rem 2rem",background:"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",borderRadius:"1rem",border:"2px dashed #d1d5db",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[i.jsx("div",{style:{width:"4rem",height:"4rem",margin:"0 auto 1.5rem",borderRadius:"50%",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(rr,{size:32,style:{color:"#3b82f6"}})}),i.jsx("p",{style:{color:"#1f2937",fontSize:"1.125rem",fontWeight:600,marginBottom:"0.5rem"},children:D||oe?"No matches found":"No recurring medications"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem"},children:D||oe?"Try adjusting your search or filter criteria":"Recurring medications will appear here once created"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"recurring-medications-table-container",children:i.jsxs("table",{className:"recurring-medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>ne("patient_name"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Name"}),R==="patient_name"&&(ee==="asc"?i.jsx(Pl,{size:12}):i.jsx(Yc,{size:12}))]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem",fontSize:"0.75rem",color:"#6b7280"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>ne("patient_phone"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Phone"}),R==="patient_phone"&&(ee==="asc"?i.jsx(Pl,{size:10}):i.jsx(Yc,{size:10}))]}),i.jsx("span",{children:"|"}),i.jsxs("div",{className:"sortable-header",onClick:()=>ne("patient_token"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Token"}),R==="patient_token"&&(ee==="asc"?i.jsx(Pl,{size:10}):i.jsx(Yc,{size:10}))]})]})]})}),i.jsx("th",{children:"Medications"}),i.jsxs("th",{className:"sortable-header",onClick:()=>ne("next_delivery_date"),style:{cursor:"pointer",userSelect:"none"},children:["Next Delivery",R==="next_delivery_date"&&(ee==="asc"?i.jsx(Pl,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(Yc,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>ne("frequency_days"),style:{cursor:"pointer",userSelect:"none"},children:["Frequency",R==="frequency_days"&&(ee==="asc"?i.jsx(Pl,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(Yc,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>ne("status"),style:{cursor:"pointer",userSelect:"none"},children:["Status",R==="status"&&(ee==="asc"?i.jsx(Pl,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(Yc,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsx("th",{children:"Last Order"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(ie=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{style:{fontWeight:500,color:"#1f2937"},children:ie.patient_name}),i.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:ie.patient_phone}),i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Token: ",ie.patient_token]})]}),i.jsx("td",{children:i.jsx("ul",{style:{listStyleType:"disc",paddingLeft:"1.25rem",fontSize:"0.875rem",color:"#4b5563"},children:ie.medications.map((_e,Ve)=>i.jsxs("li",{children:[_e.name,_e.pack_quantity?` (${_e.pack_quantity} packs)`:"",_e.loose_quantity?` (${_e.loose_quantity} loose)`:""]},Ve))})}),i.jsx("td",{children:i.jsx("div",{style:{fontSize:"0.875rem"},children:new Date(ie.next_delivery_date).toLocaleDateString()})}),i.jsx("td",{children:b===ie.id?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsx("input",{type:"number",min:"1",max:"365",value:S,onChange:_e=>k(parseInt(_e.target.value,10)||1),style:{width:"4rem",padding:"0.25rem 0.5rem",border:"2px solid #6d28d9",borderRadius:"0.375rem",fontSize:"0.875rem",outline:"none"},autoFocus:!0,onKeyDown:_e=>{_e.key==="Enter"&&ce(ie.id),_e.key==="Escape"&&M()}}),i.jsx("span",{style:{fontSize:"0.875rem",color:"#4b5563"},children:"days"}),i.jsx("button",{onClick:()=>ce(ie.id),style:{padding:"0.25rem 0.5rem",backgroundColor:"#22c55e",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Save (Enter)",children:""}),i.jsx("button",{onClick:M,style:{padding:"0.25rem 0.5rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Cancel (Esc)",children:""})]}):i.jsxs("div",{onClick:()=>ae(ie.id,ie.frequency_days||30),style:{fontSize:"0.875rem",color:"#4b5563",cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.375rem",transition:"all 0.2s ease",display:"inline-block"},onMouseEnter:_e=>{_e.currentTarget.style.backgroundColor="#f3f4f6",_e.currentTarget.style.color="#6d28d9"},onMouseLeave:_e=>{_e.currentTarget.style.backgroundColor="transparent",_e.currentTarget.style.color="#4b5563"},title:"Click to edit frequency",children:["Every ",ie.frequency_days||30," days "]})}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${ie.status}`,children:ie.status})}),i.jsx("td",{children:ie.last_order?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[i.jsxs("div",{style:{fontSize:"0.875rem"},children:[i.jsx("span",{style:{fontWeight:500},children:"Status: "}),i.jsx("span",{className:`status-badge ${ie.last_order.status}`,children:ie.last_order.status})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:new Date(ie.last_order.date).toLocaleDateString()}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[ie.last_order.status==="pending"&&i.jsxs("button",{onClick:()=>fe(ie.last_order.id,ie.medications),className:"small-action-button bill",children:[i.jsx(j2,{size:12})," Bill"]}),ie.last_order.status==="billed"&&i.jsxs("button",{onClick:()=>we(ie.last_order.id,"dispensed"),className:"small-action-button dispense",children:[i.jsx(Ud,{size:12})," Dispense"]}),ie.last_order.status==="dispensed"&&i.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#16a34a"},children:[i.jsx(Ba,{size:12})," Complete"]})]})]}):i.jsx("span",{style:{fontSize:"0.875rem",color:"#9ca3af"},children:"No recent order"})}),i.jsx("td",{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("select",{value:ie.status,onChange:_e=>A(ie.id,_e.target.value),style:{fontSize:"0.875rem",borderColor:"#d1d5db",borderRadius:"0.375rem",padding:"0.25rem 0.5rem"},children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]}),i.jsx("button",{onClick:()=>de(ie),className:"action-button",title:"Create Order",children:i.jsx(hR,{size:18})})]})})]},ie.id))})]})}),B>1&&i.jsxs("div",{className:"pagination-controls",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1.5rem",padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem"},children:[i.jsxs("div",{className:"pagination-info",style:{fontSize:"0.875rem",color:"#6b7280"},children:["Showing"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:(F-1)*f1+1})," ","to"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:Math.min(F*f1,U)})," ","of"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:U})," results"]}),i.jsxs("div",{className:"pagination-buttons",style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[i.jsxs("button",{onClick:()=>$(ie=>Math.max(ie-1,1)),disabled:F===1||t,className:"pagination-button",style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:F===1?"#f3f4f6":"#fff",cursor:F===1?"not-allowed":"pointer",fontSize:"0.875rem"},children:[i.jsx(Bb,{size:16}),"Previous"]}),i.jsxs("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Page ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:F})," of ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:B})]}),i.jsxs("button",{onClick:()=>$(ie=>Math.min(ie+1,B)),disabled:F===B||t,className:"pagination-button",style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:F===B?"#f3f4f6":"#fff",cursor:F===B?"not-allowed":"pointer",fontSize:"0.875rem"},children:["Next",i.jsx(bg,{size:16})]})]})]})]})]}),u&&i.jsx($ie,{isOpen:l,onClose:()=>f(!1),recurringItems:u.medications,inventory:h,onCreateOrder:Se})]})},Bie=({isOpen:e,onClose:n,userRole:t})=>{const[r,a]=w.useState(""),s=yt(),l=w.useMemo(()=>(Aw[t]||[]).flatMap(h=>h.links),[t]),f=w.useMemo(()=>r?l.filter(d=>d.name.toLowerCase().includes(r.toLowerCase())):[],[r,l]);w.useEffect(()=>{e&&a("")},[e]);const u=d=>{s(d),n()};return e?i.jsx("div",{className:"search-modal-overlay",onClick:n,children:i.jsxs("div",{className:"search-modal-content",onClick:d=>d.stopPropagation(),children:[i.jsx("div",{className:"search-modal-header",children:i.jsx("input",{type:"text",placeholder:"Search for pages...",className:"search-modal-input",value:r,onChange:d=>a(d.target.value),autoFocus:!0})}),i.jsx("div",{className:"search-modal-results",children:f.length>0?i.jsx("ul",{children:f.map(d=>i.jsx("li",{onClick:()=>u(d.path),children:d.name},d.path))}):r&&i.jsx("p",{children:"No results found"})})]})}):null};function Uie(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),[u,d]=w.useState(!1),h=I=>{r(I),n(!0),I.role==="admin"&&!I.has_seen_tutorial&&d(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const I=localStorage.getItem("authToken"),D=localStorage.getItem("currentUser");if(I&&D)try{const q=JSON.parse(D);r(q),n(!0),q.role==="admin"&&!q.has_seen_tutorial&&d(!0)}catch(q){console.error("Error parsing stored user data:",q),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}s(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const D=await V2();f(D)}catch(D){console.error("Error fetching clinic pro plan status:",D),f({hasProPlan:!1})}else f(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const I=D=>{D.preventDefault(),v(D),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",I),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",I)}},[]),w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),D=()=>{I.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return D(),I.addEventListener("change",D),()=>{I.removeEventListener("change",D),document.body.classList.remove("dark-mode")}},[]);const E=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const I=b;I.prompt();const{outcome:D}=await I.userChoice;console.log(`User response to the install prompt: ${D}`),v(null),k(!1)},[b]),T=async()=>{if(t)try{(await ge(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(D=>D?{...D,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),d(!1)):console.error("Failed to update tutorial status on backend.")}catch(I){console.error("Error marking tutorial as seen:",I)}};return a?i.jsx("div",{className:"initial-app-loading-screen",children:i.jsx("img",{src:"/logo.png",alt:"Loading App",className:"initial-app-loader-logo"})}):i.jsxs(tI,{children:[i.jsx(fI,{children:i.jsxs(kh,{children:[i.jsx(ut,{path:"/login",element:e?i.jsx(gn,{to:"/dashboard"}):i.jsx(gI,{onLoginSuccess:h})}),i.jsx(ut,{path:"/register",element:e?i.jsx(gn,{to:"/dashboard"}):i.jsx(yI,{})}),i.jsx(ut,{path:"/handle-complaint-url",element:e?i.jsx(Hre,{}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/live-api",element:e?i.jsx(J7,{}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/create-lab-order",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(AE,{currentUser:t})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/manage-admission",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(EE,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/lab/report/:orderId",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Q_,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Q_,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/add-patient",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(V1,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/billing",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Qne,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/lab-billing",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Kne,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(Gne,{}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(FA,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/*",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:qie(t.role,t,ge)}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(ore,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/lab/search-report",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(lre,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(cre,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Xne,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/inventory",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx($A,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/lab-inventory",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Iw,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Yne,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(hre,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Mre,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/start-clinic-subscription",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Fre,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/refill-reminders",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(XA,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/notifications",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Gre,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/create-custom-bill",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(TE,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Xre,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/bills/:billId",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Zre,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/recurring-medications",element:e&&t?i.jsx(nr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(zie,{})}):i.jsx(gn,{to:"/login"})}),i.jsx(ut,{path:"*",element:i.jsx(gn,{to:e?"/dashboard":"/login"})})]})}),u&&i.jsx(qre,{onClose:()=>d(!1),onMarkAsSeen:T})]})}const qie=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(kh,{children:[i.jsx(ut,{index:!0,element:i.jsx(zre,{})}),i.jsx(ut,{path:"clinic-subscriptions",element:i.jsx(Rre,{})}),i.jsx(ut,{path:"clinic-subscriptions/add",element:i.jsx(Ore,{})}),i.jsx(ut,{path:"clinic-subscriptions/edit/:id",element:i.jsx(Lre,{})}),i.jsx(ut,{path:"users",element:i.jsx($re,{})})," ",i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(kh,{children:[i.jsx(ut,{index:!0,element:i.jsx(sq,{fetchWithAuth:t})}),i.jsx(ut,{path:"staff",element:i.jsx(fre,{fetchWithAuth:t})}),i.jsx(ut,{path:"staff/add",element:i.jsx(mq,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(ut,{path:"staff/edit/:id",element:i.jsx(gq,{})}),i.jsx(ut,{path:"patients/add",element:i.jsx(V1,{})}),i.jsx(ut,{path:"search-patient",element:i.jsx(Ph,{})}),i.jsx(ut,{path:"patients",element:i.jsx(q1,{})}),i.jsx(ut,{path:"analysis",element:i.jsx(x1,{})}),i.jsx(ut,{path:"inventory",element:i.jsx(q2,{})}),i.jsx(ut,{path:"inventory/edit/:id",element:i.jsx(pq,{})}),i.jsx(ut,{path:"distributors",element:i.jsx(X_,{})}),i.jsx(ut,{path:"purchase",element:i.jsx(Z_,{})})," ",i.jsx(ut,{path:"queue",element:i.jsx(Pv,{})}),i.jsx(ut,{path:"subscriptions",element:i.jsx(Pre,{})}),i.jsx(ut,{path:"subscriptions/add",element:i.jsx(Dre,{})}),i.jsx(ut,{path:"subscriptions/edit/:id",element:i.jsx(Ire,{})}),i.jsx(ut,{path:"add-pharmacy-order",element:i.jsx(Y_,{})}),i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(kh,{children:[i.jsx(ut,{index:!0,element:i.jsx(gn,{to:"search-patient",replace:!0})}),i.jsx(ut,{path:"search-patient",element:i.jsx(Ph,{})}),i.jsx(ut,{path:"queue",element:i.jsx(Pv,{})}),i.jsx(ut,{path:":patientId",element:i.jsx(Pv,{})}),i.jsx(ut,{path:"add-patient",element:i.jsx(V1,{})}),i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(kh,{children:[i.jsx(ut,{index:!0,element:i.jsx(lq,{currentUser:n})}),i.jsx(ut,{path:"all-patients",element:i.jsx(q1,{})}),i.jsx(ut,{path:"search-patient",element:i.jsx(Ph,{})}),i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(dq,{});case"pharmacy":return i.jsxs(kh,{children:[i.jsx(ut,{index:!0,element:i.jsx(fq,{})}),i.jsx(ut,{path:"inventory",element:i.jsx($A,{})}),i.jsx(ut,{path:"settings",element:i.jsx(hq,{})}),i.jsx(ut,{path:"add-order",element:i.jsx(Y_,{})}),i.jsx(ut,{path:"edit-pharmacy-order/:orderId",element:i.jsx(FA,{})}),i.jsx(ut,{path:"analysis",element:i.jsx(x1,{})}),i.jsx(ut,{path:"orders/:orderId",element:i.jsx(Cre,{})}),i.jsx(ut,{path:"search-patient-records",element:i.jsx(Ph,{})}),i.jsx(ut,{path:"distributors",element:i.jsx(X_,{})}),i.jsx(ut,{path:"purchase",element:i.jsx(Z_,{})})," ",i.jsx(ut,{path:"refill-reminders",element:i.jsx(XA,{})})," ",i.jsx(ut,{path:"*",element:i.jsx(gn,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},nr=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:s})=>{const l=yt(),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(window.innerWidth<=768),[v,S]=w.useState(!1),[k,E]=w.useState([]),[T,I]=w.useState(0),[D,q]=w.useState(!1),[F,$]=w.useState("Newtons Ai"),[B,z]=w.useState(null),[U,L]=w.useState(!1),R=w.useRef(null);w.useEffect(()=>{const J=()=>{b(window.innerWidth<=768)};return window.addEventListener("resize",J),()=>window.removeEventListener("resize",J)},[]),w.useEffect(()=>zs.subscribe(ne=>{L(ne)}),[]);const G=w.useCallback(async()=>{try{const J=await ge("/api/notifications");if(J.ok){const ae=(await J.json()).reduce((ce,M)=>{const de=ce.find(Se=>Se.message===M.message);return de?new Date(M.created_at)>new Date(de.created_at)?ce.map(Se=>Se.message===M.message?M:Se):ce:[...ce,M]},[]).sort((ce,M)=>{const de={expired_drug:1,near_expiry_drug:2,low_stock:3},Se=de[ce.type]||99,fe=de[M.type]||99;return Se!==fe?Se-fe:new Date(M.created_at).getTime()-new Date(ce.created_at).getTime()});E(ae),I(ae.filter(ce=>!ce.is_read).length)}else console.error("Failed to fetch notifications:",J.statusText)}catch(J){console.error("Error fetching notifications:",J)}},[]);w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const ne=await ge("/api/clinics/settings");if(ne.ok){const A=await ne.json();A.name===""?$("Newtons Ai"):$(A.name),z(A.logoUrl)}else console.error("Failed to fetch clinic details for display:",ne.statusText),$("Newtons Ai"),z(null)}catch(ne){console.error("Error fetching clinic details for display:",ne),$("Newtons Ai"),z(null)}else $("Newtons Ai"),z(null)})()},[e==null?void 0:e.clinic_id]),w.useEffect(()=>{if(e!=null&&e.clinic_id){G();const J=setInterval(G,5*60*1e3);return()=>clearInterval(J)}},[e==null?void 0:e.clinic_id,G]);const ee=()=>{u(!f),f||(h(!1),S(!1))},te=()=>{h(!d),d||(u(!1),S(!1))},oe=()=>{S(!v),v||(u(!1),h(!1))};w.useEffect(()=>{const J=ne=>{R.current&&!R.current.contains(ne.target)&&v&&S(!1)};return v&&document.addEventListener("mousedown",J),()=>{document.removeEventListener("mousedown",J)}},[v]);const K=async J=>{try{const ne=await ge(`/api/notifications/${J}/read`,{method:"PUT"});ne.ok?G():console.error("Failed to mark notification as read:",ne.statusText)}catch(ne){console.error("Error marking notification as read:",ne)}},V=async()=>{q(!0);try{const J=await ge("/api/notifications/trigger-all",{method:"POST"});J.ok?(console.log("Notification checks triggered successfully."),await G()):console.error("Failed to trigger notification checks:",J.statusText)}catch(J){console.error("Error triggering notification checks:",J)}finally{q(!1)}};return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[g&&U?i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}):i.jsx("a",{href:"#",onClick:J=>{J.preventDefault(),l("/dashboard")},className:"logo-container",children:i.jsx("img",{src:B||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:F}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[!g&&U&&i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}),r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),s&&(s.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),!g&&i.jsx("button",{className:"header-search-button",onClick:te,"aria-label":"Search pages",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsxs("div",{className:"notifications-section",ref:R,children:[" ",i.jsxs("button",{className:"notification-icon","aria-label":"Notifications",onClick:oe,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),T>0&&i.jsx("span",{className:"notification-count",children:T})]}),v&&i.jsxs("div",{className:"notifications-dropdown",children:[i.jsx("div",{className:"dropdown-header",children:"Notifications"}),i.jsx("ul",{className:"dropdown-list",children:k.length>0?k.map(J=>i.jsxs("li",{className:`dropdown-item ${J.is_read?"read":"unread"}`,onClick:()=>K(J.id),children:[J.message,i.jsx("span",{className:"notification-timestamp",children:new Date(J.created_at).toLocaleString()})]},J.id)):i.jsx("li",{className:"dropdown-item",children:"No new notifications"})}),i.jsxs("div",{className:"dropdown-footer",children:[i.jsx("button",{onClick:()=>l("/dashboard/notifications"),children:"View All"}),(e.role==="admin"||e.role==="superadmin")&&i.jsx("button",{onClick:V,className:"fetch-all-button",disabled:D,children:D?"Fetching...":"Fetch All"})]})]})]}),i.jsx("button",{className:"hamburger-icon",onClick:ee,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),i.jsx("main",{className:"main-content",children:t}),g?i.jsx(kI,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:ee,roleNavigation:Aw}):i.jsx(_I,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:ee}),!g&&f&&i.jsx("div",{className:"side-panel-overlay",onClick:ee}),i.jsx(Bie,{isOpen:d,onClose:()=>h(!1),userRole:e.role})]})};BP.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(Uie,{})}));
