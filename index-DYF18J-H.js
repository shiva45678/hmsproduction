var hP=Object.defineProperty;var pP=(e,n,t)=>n in e?hP(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Qn=(e,n,t)=>pP(e,typeof n!="symbol"?n+"":n,t);function mP(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var au=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Vv={exports:{}},Sm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NS;function gP(){if(NS)return Sm;NS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var d in a)d!=="key"&&(o[d]=a[d])}else o=a;return a=o.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:o}}return Sm.Fragment=n,Sm.jsx=t,Sm.jsxs=t,Sm}var CS;function yP(){return CS||(CS=1,Vv.exports=gP()),Vv.exports}var i=yP(),Hv={exports:{}},Xt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _S;function xP(){if(_S)return Xt;_S=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function b(E){return E===null||typeof E!="object"?null:(E=g&&E[g]||E["@@iterator"],typeof E=="function"?E:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function T(E,de,he){this.props=E,this.context=de,this.refs=k,this.updater=he||v}T.prototype.isReactComponent={},T.prototype.setState=function(E,de){if(typeof E!="object"&&typeof E!="function"&&E!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,E,de,"setState")},T.prototype.forceUpdate=function(E){this.updater.enqueueForceUpdate(this,E,"forceUpdate")};function P(){}P.prototype=T.prototype;function M(E,de,he){this.props=E,this.context=de,this.refs=k,this.updater=he||v}var R=M.prototype=new P;R.constructor=M,S(R,T.prototype),R.isPureReactComponent=!0;var z=Array.isArray,$={H:null,A:null,T:null,S:null,V:null},L=Object.prototype.hasOwnProperty;function U(E,de,he,D,pe,Ne){return he=Ne.ref,{$$typeof:e,type:E,key:de,ref:he!==void 0?he:null,props:Ne}}function B(E,de){return U(E.type,de,void 0,void 0,void 0,E.props)}function W(E){return typeof E=="object"&&E!==null&&E.$$typeof===e}function I(E){var de={"=":"=0",":":"=2"};return"$"+E.replace(/[=:]/g,function(he){return de[he]})}var F=/\/+/g;function V(E,de){return typeof E=="object"&&E!==null&&E.key!=null?I(""+E.key):de.toString(36)}function re(){}function ie(E){switch(E.status){case"fulfilled":return E.value;case"rejected":throw E.reason;default:switch(typeof E.status=="string"?E.then(re,re):(E.status="pending",E.then(function(de){E.status==="pending"&&(E.status="fulfilled",E.value=de)},function(de){E.status==="pending"&&(E.status="rejected",E.reason=de)})),E.status){case"fulfilled":return E.value;case"rejected":throw E.reason}}throw E}function G(E,de,he,D,pe){var Ne=typeof E;(Ne==="undefined"||Ne==="boolean")&&(E=null);var te=!1;if(E===null)te=!0;else switch(Ne){case"bigint":case"string":case"number":te=!0;break;case"object":switch(E.$$typeof){case e:case n:te=!0;break;case h:return te=E._init,G(te(E._payload),de,he,D,pe)}}if(te)return pe=pe(E),te=D===""?"."+V(E,0):D,z(pe)?(he="",te!=null&&(he=te.replace(F,"$&/")+"/"),G(pe,de,he,"",function(ye){return ye})):pe!=null&&(W(pe)&&(pe=B(pe,he+(pe.key==null||E&&E.key===pe.key?"":(""+pe.key).replace(F,"$&/")+"/")+te)),de.push(pe)),1;te=0;var K=D===""?".":D+":";if(z(E))for(var J=0;J<E.length;J++)D=E[J],Ne=K+V(D,J),te+=G(D,de,he,Ne,pe);else if(J=b(E),typeof J=="function")for(E=J.call(E),J=0;!(D=E.next()).done;)D=D.value,Ne=K+V(D,J++),te+=G(D,de,he,Ne,pe);else if(Ne==="object"){if(typeof E.then=="function")return G(ie(E),de,he,D,pe);throw de=String(E),Error("Objects are not valid as a React child (found: "+(de==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":de)+"). If you meant to render a collection of children, use an array instead.")}return te}function Y(E,de,he){if(E==null)return E;var D=[],pe=0;return G(E,D,"","",function(Ne){return de.call(he,Ne,pe++)}),D}function ne(E){if(E._status===-1){var de=E._result;de=de(),de.then(function(he){(E._status===0||E._status===-1)&&(E._status=1,E._result=he)},function(he){(E._status===0||E._status===-1)&&(E._status=2,E._result=he)}),E._status===-1&&(E._status=0,E._result=de)}if(E._status===1)return E._result.default;throw E._result}var le=typeof reportError=="function"?reportError:function(E){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var de=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof E=="object"&&E!==null&&typeof E.message=="string"?String(E.message):String(E),error:E});if(!window.dispatchEvent(de))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",E);return}console.error(E)};function oe(){}return Xt.Children={map:Y,forEach:function(E,de,he){Y(E,function(){de.apply(this,arguments)},he)},count:function(E){var de=0;return Y(E,function(){de++}),de},toArray:function(E){return Y(E,function(de){return de})||[]},only:function(E){if(!W(E))throw Error("React.Children.only expected to receive a single React element child.");return E}},Xt.Component=T,Xt.Fragment=t,Xt.Profiler=a,Xt.PureComponent=M,Xt.StrictMode=r,Xt.Suspense=f,Xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,Xt.__COMPILER_RUNTIME={__proto__:null,c:function(E){return $.H.useMemoCache(E)}},Xt.cache=function(E){return function(){return E.apply(null,arguments)}},Xt.cloneElement=function(E,de,he){if(E==null)throw Error("The argument must be a React element, but you passed "+E+".");var D=S({},E.props),pe=E.key,Ne=void 0;if(de!=null)for(te in de.ref!==void 0&&(Ne=void 0),de.key!==void 0&&(pe=""+de.key),de)!L.call(de,te)||te==="key"||te==="__self"||te==="__source"||te==="ref"&&de.ref===void 0||(D[te]=de[te]);var te=arguments.length-2;if(te===1)D.children=he;else if(1<te){for(var K=Array(te),J=0;J<te;J++)K[J]=arguments[J+2];D.children=K}return U(E.type,pe,void 0,void 0,Ne,D)},Xt.createContext=function(E){return E={$$typeof:l,_currentValue:E,_currentValue2:E,_threadCount:0,Provider:null,Consumer:null},E.Provider=E,E.Consumer={$$typeof:o,_context:E},E},Xt.createElement=function(E,de,he){var D,pe={},Ne=null;if(de!=null)for(D in de.key!==void 0&&(Ne=""+de.key),de)L.call(de,D)&&D!=="key"&&D!=="__self"&&D!=="__source"&&(pe[D]=de[D]);var te=arguments.length-2;if(te===1)pe.children=he;else if(1<te){for(var K=Array(te),J=0;J<te;J++)K[J]=arguments[J+2];pe.children=K}if(E&&E.defaultProps)for(D in te=E.defaultProps,te)pe[D]===void 0&&(pe[D]=te[D]);return U(E,Ne,void 0,void 0,null,pe)},Xt.createRef=function(){return{current:null}},Xt.forwardRef=function(E){return{$$typeof:d,render:E}},Xt.isValidElement=W,Xt.lazy=function(E){return{$$typeof:h,_payload:{_status:-1,_result:E},_init:ne}},Xt.memo=function(E,de){return{$$typeof:u,type:E,compare:de===void 0?null:de}},Xt.startTransition=function(E){var de=$.T,he={};$.T=he;try{var D=E(),pe=$.S;pe!==null&&pe(he,D),typeof D=="object"&&D!==null&&typeof D.then=="function"&&D.then(oe,le)}catch(Ne){le(Ne)}finally{$.T=de}},Xt.unstable_useCacheRefresh=function(){return $.H.useCacheRefresh()},Xt.use=function(E){return $.H.use(E)},Xt.useActionState=function(E,de,he){return $.H.useActionState(E,de,he)},Xt.useCallback=function(E,de){return $.H.useCallback(E,de)},Xt.useContext=function(E){return $.H.useContext(E)},Xt.useDebugValue=function(){},Xt.useDeferredValue=function(E,de){return $.H.useDeferredValue(E,de)},Xt.useEffect=function(E,de,he){var D=$.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return D.useEffect(E,de)},Xt.useId=function(){return $.H.useId()},Xt.useImperativeHandle=function(E,de,he){return $.H.useImperativeHandle(E,de,he)},Xt.useInsertionEffect=function(E,de){return $.H.useInsertionEffect(E,de)},Xt.useLayoutEffect=function(E,de){return $.H.useLayoutEffect(E,de)},Xt.useMemo=function(E,de){return $.H.useMemo(E,de)},Xt.useOptimistic=function(E,de){return $.H.useOptimistic(E,de)},Xt.useReducer=function(E,de,he){return $.H.useReducer(E,de,he)},Xt.useRef=function(E){return $.H.useRef(E)},Xt.useState=function(E){return $.H.useState(E)},Xt.useSyncExternalStore=function(E,de,he){return $.H.useSyncExternalStore(E,de,he)},Xt.useTransition=function(){return $.H.useTransition()},Xt.version="19.1.0",Xt}var jS;function uw(){return jS||(jS=1,Hv.exports=xP()),Hv.exports}var w=uw();const kn=Hd(w),kS=mP({__proto__:null,default:kn},[w]);var Gv={exports:{}},Nm={},Yv={exports:{}},Wv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TS;function bP(){return TS||(TS=1,function(e){function n(Y,ne){var le=Y.length;Y.push(ne);e:for(;0<le;){var oe=le-1>>>1,E=Y[oe];if(0<a(E,ne))Y[oe]=ne,Y[le]=E,le=oe;else break e}}function t(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var ne=Y[0],le=Y.pop();if(le!==ne){Y[0]=le;e:for(var oe=0,E=Y.length,de=E>>>1;oe<de;){var he=2*(oe+1)-1,D=Y[he],pe=he+1,Ne=Y[pe];if(0>a(D,le))pe<E&&0>a(Ne,D)?(Y[oe]=Ne,Y[pe]=le,oe=pe):(Y[oe]=D,Y[he]=le,oe=he);else if(pe<E&&0>a(Ne,le))Y[oe]=Ne,Y[pe]=le,oe=pe;else break e}}return ne}function a(Y,ne){var le=Y.sortIndex-ne.sortIndex;return le!==0?le:Y.id-ne.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var f=[],u=[],h=1,g=null,b=3,v=!1,S=!1,k=!1,T=!1,P=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function z(Y){for(var ne=t(u);ne!==null;){if(ne.callback===null)r(u);else if(ne.startTime<=Y)r(u),ne.sortIndex=ne.expirationTime,n(f,ne);else break;ne=t(u)}}function $(Y){if(k=!1,z(Y),!S)if(t(f)!==null)S=!0,L||(L=!0,V());else{var ne=t(u);ne!==null&&G($,ne.startTime-Y)}}var L=!1,U=-1,B=5,W=-1;function I(){return T?!0:!(e.unstable_now()-W<B)}function F(){if(T=!1,L){var Y=e.unstable_now();W=Y;var ne=!0;try{e:{S=!1,k&&(k=!1,M(U),U=-1),v=!0;var le=b;try{t:{for(z(Y),g=t(f);g!==null&&!(g.expirationTime>Y&&I());){var oe=g.callback;if(typeof oe=="function"){g.callback=null,b=g.priorityLevel;var E=oe(g.expirationTime<=Y);if(Y=e.unstable_now(),typeof E=="function"){g.callback=E,z(Y),ne=!0;break t}g===t(f)&&r(f),z(Y)}else r(f);g=t(f)}if(g!==null)ne=!0;else{var de=t(u);de!==null&&G($,de.startTime-Y),ne=!1}}break e}finally{g=null,b=le,v=!1}ne=void 0}}finally{ne?V():L=!1}}}var V;if(typeof R=="function")V=function(){R(F)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,ie=re.port2;re.port1.onmessage=F,V=function(){ie.postMessage(null)}}else V=function(){P(F,0)};function G(Y,ne){U=P(function(){Y(e.unstable_now())},ne)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(Y){switch(b){case 1:case 2:case 3:var ne=3;break;default:ne=b}var le=b;b=ne;try{return Y()}finally{b=le}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(Y,ne){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var le=b;b=Y;try{return ne()}finally{b=le}},e.unstable_scheduleCallback=function(Y,ne,le){var oe=e.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?oe+le:oe):le=oe,Y){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=le+E,Y={id:h++,callback:ne,priorityLevel:Y,startTime:le,expirationTime:E,sortIndex:-1},le>oe?(Y.sortIndex=le,n(u,Y),t(f)===null&&Y===t(u)&&(k?(M(U),U=-1):k=!0,G($,le-oe))):(Y.sortIndex=E,n(f,Y),S||v||(S=!0,L||(L=!0,V()))),Y},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(Y){var ne=b;return function(){var le=b;b=ne;try{return Y.apply(this,arguments)}finally{b=le}}}}(Wv)),Wv}var ES;function vP(){return ES||(ES=1,Yv.exports=bP()),Yv.exports}var Qv={exports:{}},Pi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AS;function wP(){if(AS)return Pi;AS=1;var e=uw();function n(f){var u="https://react.dev/errors/"+f;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+f+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,u,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:f,containerInfo:u,implementation:h}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,u){if(f==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Pi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Pi.createPortal=function(f,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(n(299));return o(f,u,null,h)},Pi.flushSync=function(f){var u=l.T,h=r.p;try{if(l.T=null,r.p=2,f)return f()}finally{l.T=u,r.p=h,r.d.f()}},Pi.preconnect=function(f,u){typeof f=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(f,u))},Pi.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Pi.preinit=function(f,u){if(typeof f=="string"&&u&&typeof u.as=="string"){var h=u.as,g=d(h,u.crossOrigin),b=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?r.d.S(f,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):h==="script"&&r.d.X(f,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Pi.preinitModule=function(f,u){if(typeof f=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=d(u.as,u.crossOrigin);r.d.M(f,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(f)},Pi.preload=function(f,u){if(typeof f=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,g=d(h,u.crossOrigin);r.d.L(f,h,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Pi.preloadModule=function(f,u){if(typeof f=="string")if(u){var h=d(u.as,u.crossOrigin);r.d.m(f,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(f)},Pi.requestFormReset=function(f){r.d.r(f)},Pi.unstable_batchedUpdates=function(f,u){return f(u)},Pi.useFormState=function(f,u,h){return l.H.useFormState(f,u,h)},Pi.useFormStatus=function(){return l.H.useHostTransitionStatus()},Pi.version="19.1.0",Pi}var PS;function Yj(){if(PS)return Qv.exports;PS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Qv.exports=wP(),Qv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DS;function SP(){if(DS)return Nm;DS=1;var e=vP(),n=uw(),t=Yj();function r(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var c=s,p=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(p=c.return),s=c.return;while(s)}return c.tag===3?p:null}function l(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function d(s){if(o(s)!==s)throw Error(r(188))}function f(s){var c=s.alternate;if(!c){if(c=o(s),c===null)throw Error(r(188));return c!==s?null:s}for(var p=s,x=c;;){var N=p.return;if(N===null)break;var A=N.alternate;if(A===null){if(x=N.return,x!==null){p=x;continue}break}if(N.child===A.child){for(A=N.child;A;){if(A===p)return d(N),s;if(A===x)return d(N),c;A=A.sibling}throw Error(r(188))}if(p.return!==x.return)p=N,x=A;else{for(var q=!1,ee=N.child;ee;){if(ee===p){q=!0,p=N,x=A;break}if(ee===x){q=!0,x=N,p=A;break}ee=ee.sibling}if(!q){for(ee=A.child;ee;){if(ee===p){q=!0,p=A,x=N;break}if(ee===x){q=!0,x=A,p=N;break}ee=ee.sibling}if(!q)throw Error(r(189))}}if(p.alternate!==x)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:c}function u(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=u(s),c!==null)return c;s=s.sibling}return null}var h=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),R=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),W=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function V(s){return s===null||typeof s!="object"?null:(s=F&&s[F]||s["@@iterator"],typeof s=="function"?s:null)}var re=Symbol.for("react.client.reference");function ie(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===re?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case $:return"Suspense";case L:return"SuspenseList";case W:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case R:return(s.displayName||"Context")+".Provider";case M:return(s._context.displayName||"Context")+".Consumer";case z:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case U:return c=s.displayName||null,c!==null?c:ie(s.type)||"Memo";case B:c=s._payload,s=s._init;try{return ie(s(c))}catch{}}return null}var G=Array.isArray,Y=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},oe=[],E=-1;function de(s){return{current:s}}function he(s){0>E||(s.current=oe[E],oe[E]=null,E--)}function D(s,c){E++,oe[E]=s.current,s.current=c}var pe=de(null),Ne=de(null),te=de(null),K=de(null);function J(s,c){switch(D(te,c),D(Ne,s),D(pe,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?sr(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=sr(c),s=dr(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}he(pe),D(pe,s)}function ye(){he(pe),he(Ne),he(te)}function He(s){s.memoizedState!==null&&D(K,s);var c=pe.current,p=dr(c,s.type);c!==p&&(D(Ne,s),D(pe,p))}function Q(s){Ne.current===s&&(he(pe),he(Ne)),K.current===s&&(he(K),Xc._currentValue=le)}var Pe=Object.prototype.hasOwnProperty,Re=e.unstable_scheduleCallback,Le=e.unstable_cancelCallback,_e=e.unstable_shouldYield,Ke=e.unstable_requestPaint,Ye=e.unstable_now,it=e.unstable_getCurrentPriorityLevel,xt=e.unstable_ImmediatePriority,Nt=e.unstable_UserBlockingPriority,ue=e.unstable_NormalPriority,Ae=e.unstable_LowPriority,ke=e.unstable_IdlePriority,Se=e.log,ve=e.unstable_setDisableYieldValue,X=null,fe=null;function Ge(s){if(typeof Se=="function"&&ve(s),fe&&typeof fe.setStrictMode=="function")try{fe.setStrictMode(X,s)}catch{}}var Je=Math.clz32?Math.clz32:Ht,ct=Math.log,wt=Math.LN2;function Ht(s){return s>>>=0,s===0?32:31-(ct(s)/wt|0)|0}var Ce=256,be=4194304;function Fe(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ie(s,c,p){var x=s.pendingLanes;if(x===0)return 0;var N=0,A=s.suspendedLanes,q=s.pingedLanes;s=s.warmLanes;var ee=x&134217727;return ee!==0?(x=ee&~A,x!==0?N=Fe(x):(q&=ee,q!==0?N=Fe(q):p||(p=ee&~s,p!==0&&(N=Fe(p))))):(ee=x&~A,ee!==0?N=Fe(ee):q!==0?N=Fe(q):p||(p=x&~s,p!==0&&(N=Fe(p)))),N===0?0:c!==0&&c!==N&&(c&A)===0&&(A=N&-N,p=c&-c,A>=p||A===32&&(p&4194048)!==0)?c:N}function Ve(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function st(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mt(){var s=Ce;return Ce<<=1,(Ce&4194048)===0&&(Ce=256),s}function Ct(){var s=be;return be<<=1,(be&62914560)===0&&(be=4194304),s}function ln(s){for(var c=[],p=0;31>p;p++)c.push(s);return c}function dn(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function vn(s,c,p,x,N,A){var q=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ee=s.entanglements,we=s.expirationTimes,ze=s.hiddenUpdates;for(p=q&~p;0<p;){var Xe=31-Je(p),nt=1<<Xe;ee[Xe]=0,we[Xe]=-1;var Be=ze[Xe];if(Be!==null)for(ze[Xe]=null,Xe=0;Xe<Be.length;Xe++){var Ue=Be[Xe];Ue!==null&&(Ue.lane&=-536870913)}p&=~nt}x!==0&&kt(s,x,0),A!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=A&~(q&~c))}function kt(s,c,p){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-Je(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|p&4194090}function bt(s,c){var p=s.entangledLanes|=c;for(s=s.entanglements;p;){var x=31-Je(p),N=1<<x;N&c|s[x]&c&&(s[x]|=c),p&=~N}}function Yt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function It(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Jn(){var s=ne.p;return s!==0?s:(s=window.event,s===void 0?32:ax(s.type))}function Vr(s,c){var p=ne.p;try{return ne.p=s,c()}finally{ne.p=p}}var fr=Math.random().toString(36).slice(2),En="__reactFiber$"+fr,wr="__reactProps$"+fr,Jr="__reactContainer$"+fr,ws="__reactEvents$"+fr,Qd="__reactListeners$"+fr,Jd="__reactHandles$"+fr,Kd="__reactResources$"+fr,Ss="__reactMarker$"+fr;function gu(s){delete s[En],delete s[wr],delete s[ws],delete s[Qd],delete s[Jd]}function ba(s){var c=s[En];if(c)return c;for(var p=s.parentNode;p;){if(c=p[Jr]||p[En]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(s=Yy(s);s!==null;){if(p=s[En])return p;s=Yy(s)}return c}s=p,p=s.parentNode}return null}function Ns(s){if(s=s[En]||s[Jr]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function Cs(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(r(33))}function _s(s){var c=s[Kd];return c||(c=s[Kd]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Sr(s){s[Ss]=!0}var Xd=new Set,Zd={};function js(s,c){ao(s,c),ao(s+"Capture",c)}function ao(s,c){for(Zd[s]=c,s=0;s<c.length;s++)Xd.add(c[s])}var Kl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ef={},il={};function ep(s){return Pe.call(il,s)?!0:Pe.call(ef,s)?!1:Kl.test(s)?il[s]=!0:(ef[s]=!0,!1)}function Xl(s,c,p){if(ep(c))if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+p)}}function so(s,c,p){if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+p)}}function vr(s,c,p,x){if(x===null)s.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(p);return}s.setAttributeNS(c,p,""+x)}}var Ya,Zl;function ks(s){if(Ya===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);Ya=c&&c[1]||"",Zl=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ya+s+Zl}var ec=!1;function al(s,c){if(!s||ec)return"";ec=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var nt=function(){throw Error()};if(Object.defineProperty(nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(nt,[])}catch(Ue){var Be=Ue}Reflect.construct(s,[],nt)}else{try{nt.call()}catch(Ue){Be=Ue}s.call(nt.prototype)}}else{try{throw Error()}catch(Ue){Be=Ue}(nt=s())&&typeof nt.catch=="function"&&nt.catch(function(){})}}catch(Ue){if(Ue&&Be&&typeof Ue.stack=="string")return[Ue.stack,Be.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=x.DetermineComponentFrameRoot(),q=A[0],ee=A[1];if(q&&ee){var we=q.split(`
`),ze=ee.split(`
`);for(N=x=0;x<we.length&&!we[x].includes("DetermineComponentFrameRoot");)x++;for(;N<ze.length&&!ze[N].includes("DetermineComponentFrameRoot");)N++;if(x===we.length||N===ze.length)for(x=we.length-1,N=ze.length-1;1<=x&&0<=N&&we[x]!==ze[N];)N--;for(;1<=x&&0<=N;x--,N--)if(we[x]!==ze[N]){if(x!==1||N!==1)do if(x--,N--,0>N||we[x]!==ze[N]){var Xe=`
`+we[x].replace(" at new "," at ");return s.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",s.displayName)),Xe}while(1<=x&&0<=N);break}}}finally{ec=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?ks(p):""}function yu(s){switch(s.tag){case 26:case 27:case 5:return ks(s.type);case 16:return ks("Lazy");case 13:return ks("Suspense");case 19:return ks("SuspenseList");case 0:case 15:return al(s.type,!1);case 11:return al(s.type.render,!1);case 1:return al(s.type,!0);case 31:return ks("Activity");default:return""}}function tc(s){try{var c="";do c+=yu(s),s=s.return;while(s);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function Kr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function oo(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function xu(s){var c=oo(s)?"checked":"value",p=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,A=p.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return N.call(this)},set:function(q){x=""+q,A.call(this,q)}}),Object.defineProperty(s,c,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(q){x=""+q},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function nc(s){s._valueTracker||(s._valueTracker=xu(s))}function rc(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var p=c.getValue(),x="";return s&&(x=oo(s)?s.checked?"true":"false":s.value),s=x,s!==p?(c.setValue(s),!0):!1}function Wa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var bu=/[\n"\\]/g;function ci(s){return s.replace(bu,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function sl(s,c,p,x,N,A,q,ee){s.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?s.type=q:s.removeAttribute("type"),c!=null?q==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+Kr(c)):s.value!==""+Kr(c)&&(s.value=""+Kr(c)):q!=="submit"&&q!=="reset"||s.removeAttribute("value"),c!=null?ol(s,q,Kr(c)):p!=null?ol(s,q,Kr(p)):x!=null&&s.removeAttribute("value"),N==null&&A!=null&&(s.defaultChecked=!!A),N!=null&&(s.checked=N&&typeof N!="function"&&typeof N!="symbol"),ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?s.name=""+Kr(ee):s.removeAttribute("name")}function vu(s,c,p,x,N,A,q,ee){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.type=A),c!=null||p!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;p=p!=null?""+Kr(p):"",c=c!=null?""+Kr(c):p,ee||c===s.value||(s.value=c),s.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=ee?s.checked:!!x,s.defaultChecked=!!x,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(s.name=q)}function ol(s,c,p){c==="number"&&Wa(s.ownerDocument)===s||s.defaultValue===""+p||(s.defaultValue=""+p)}function va(s,c,p,x){if(s=s.options,c){c={};for(var N=0;N<p.length;N++)c["$"+p[N]]=!0;for(p=0;p<s.length;p++)N=c.hasOwnProperty("$"+s[p].value),s[p].selected!==N&&(s[p].selected=N),N&&x&&(s[p].defaultSelected=!0)}else{for(p=""+Kr(p),c=null,N=0;N<s.length;N++){if(s[N].value===p){s[N].selected=!0,x&&(s[N].defaultSelected=!0);return}c!==null||s[N].disabled||(c=s[N])}c!==null&&(c.selected=!0)}}function ic(s,c,p){if(c!=null&&(c=""+Kr(c),c!==s.value&&(s.value=c),p==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=p!=null?""+Kr(p):""}function lo(s,c,p,x){if(c==null){if(x!=null){if(p!=null)throw Error(r(92));if(G(x)){if(1<x.length)throw Error(r(93));x=x[0]}p=x}p==null&&(p=""),c=p}p=Kr(c),s.defaultValue=p,x=s.textContent,x===p&&x!==""&&x!==null&&(s.value=x)}function wa(s,c){if(c){var p=s.firstChild;if(p&&p===s.lastChild&&p.nodeType===3){p.nodeValue=c;return}}s.textContent=c}var Qa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ac(s,c,p){var x=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,p):typeof p!="number"||p===0||Qa.has(c)?c==="float"?s.cssFloat=p:s[c]=(""+p).trim():s[c]=p+"px"}function ll(s,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(s=s.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&p[N]!==x&&ac(s,N,x)}else for(var A in c)c.hasOwnProperty(A)&&ac(s,A,c[A])}function sc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var oc=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ja(s){return wu.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Ka=null;function co(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ts=null,Sa=null;function Su(s){var c=Ns(s);if(c&&(s=c.stateNode)){var p=s[wr]||null;e:switch(s=c.stateNode,c.type){case"input":if(sl(s,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+ci(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var x=p[c];if(x!==s&&x.form===s.form){var N=x[wr]||null;if(!N)throw Error(r(90));sl(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<p.length;c++)x=p[c],x.form===s.form&&rc(x)}break e;case"textarea":ic(s,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&va(s,!!p.multiple,c,!1)}}}var cl=!1;function lc(s,c,p){if(cl)return s(c,p);cl=!0;try{var x=s(c);return x}finally{if(cl=!1,(Ts!==null||Sa!==null)&&(Wf(),Ts&&(c=Ts,s=Sa,Sa=Ts=null,Su(c),s)))for(c=0;c<s.length;c++)Su(s[c])}}function Es(s,c){var p=s.stateNode;if(p===null)return null;var x=p[wr]||null;if(x===null)return null;p=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var Fi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),As=!1;if(Fi)try{var Ps={};Object.defineProperty(Ps,"passive",{get:function(){As=!0}}),window.addEventListener("test",Ps,Ps),window.removeEventListener("test",Ps,Ps)}catch{As=!1}var Xi=null,ul=null,uo=null;function Zi(){if(uo)return uo;var s,c=ul,p=c.length,x,N="value"in Xi?Xi.value:Xi.textContent,A=N.length;for(s=0;s<p&&c[s]===N[s];s++);var q=p-s;for(x=1;x<=q&&c[p-x]===N[A-x];x++);return uo=N.slice(s,1<x?1-x:void 0)}function _n(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function jn(){return!0}function Xa(){return!1}function Xr(s){function c(p,x,N,A,q){this._reactName=p,this._targetInst=N,this.type=x,this.nativeEvent=A,this.target=q,this.currentTarget=null;for(var ee in s)s.hasOwnProperty(ee)&&(p=s[ee],this[ee]=p?p(A):A[ee]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?jn:Xa,this.isPropagationStopped=Xa,this}return h(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=jn)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=jn)},persist:function(){},isPersistent:jn}),c}var Na={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cc=Xr(Na),Ds=h({},Na,{view:0,detail:0}),dl=Xr(Ds),uc,fo,tr,Za=h({},Ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ti,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==tr&&(tr&&s.type==="mousemove"?(uc=s.screenX-tr.screenX,fo=s.screenY-tr.screenY):fo=uc=0,tr=s),uc)},movementY:function(s){return"movementY"in s?s.movementY:fo}}),Ca=Xr(Za),Nu=h({},Za,{dataTransfer:0}),dc=Xr(Nu),Zr=h({},Ds,{relatedTarget:0}),fl=Xr(Zr),hl=h({},Na,{animationName:0,elapsedTime:0,pseudoElement:0}),pl=Xr(hl),tf=h({},Na,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),fc=Xr(tf),hc=h({},Na,{data:0}),Hr=Xr(hc),Pn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ei={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mc(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=pc[s])?!!c[s]:!1}function ti(){return mc}var es=h({},Ds,{key:function(s){if(s.key){var c=Pn[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=_n(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ei[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ti,charCode:function(s){return s.type==="keypress"?_n(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?_n(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Cu=Xr(es),qn=h({},Za,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ni=Xr(qn),gc=h({},Ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ti}),_u=Xr(gc),ho=h({},Na,{propertyName:0,elapsedTime:0,pseudoElement:0}),po=Xr(ho),nf=h({},Za,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),tp=Xr(nf),ju=h({},Na,{newState:0,oldState:0}),ts=Xr(ju),mo=[9,13,27,32],ns=Fi&&"CompositionEvent"in window,go=null;Fi&&"documentMode"in document&&(go=document.documentMode);var ku=Fi&&"TextEvent"in window&&!go,_a=Fi&&(!ns||go&&8<go&&11>=go),ja=" ",Is=!1;function Tu(s,c){switch(s){case"keyup":return mo.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yo(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ka=!1;function yc(s,c){switch(s){case"compositionend":return yo(c);case"keypress":return c.which!==32?null:(Is=!0,ja);case"textInput":return s=c.data,s===ja&&Is?null:s;default:return null}}function Eu(s,c){if(ka)return s==="compositionend"||!ns&&Tu(s,c)?(s=Zi(),uo=ul=Xi=null,ka=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return _a&&c.locale!=="ko"?null:c.data;default:return null}}var ui={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xc(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!ui[s.type]:c==="textarea"}function xo(s,c,p,x){Ts?Sa?Sa.push(x):Sa=[x]:Ts=x,c=th(c,"onChange"),0<c.length&&(p=new cc("onChange","change",null,p,x),s.push({event:p,listeners:c}))}var bo=null,vo=null;function np(s){$y(s,0)}function bc(s){var c=Cs(s);if(rc(c))return s}function rf(s,c){if(s==="change")return c}var af=!1;if(Fi){var vc;if(Fi){var rs="oninput"in document;if(!rs){var ml=document.createElement("div");ml.setAttribute("oninput","return;"),rs=typeof ml.oninput=="function"}vc=rs}else vc=!1;af=vc&&(!document.documentMode||9<document.documentMode)}function sf(){bo&&(bo.detachEvent("onpropertychange",$i),vo=bo=null)}function $i(s){if(s.propertyName==="value"&&bc(vo)){var c=[];xo(c,vo,s,co(s)),lc(np,c)}}function Ta(s,c,p){s==="focusin"?(sf(),bo=c,vo=p,bo.attachEvent("onpropertychange",$i)):s==="focusout"&&sf()}function Mr(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return bc(vo)}function gl(s,c){if(s==="click")return bc(c)}function of(s,c){if(s==="input"||s==="change")return bc(c)}function lf(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var ri=typeof Object.is=="function"?Object.is:lf;function ii(s,c){if(ri(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var p=Object.keys(s),x=Object.keys(c);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var N=p[x];if(!Pe.call(c,N)||!ri(s[N],c[N]))return!1}return!0}function di(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function wc(s,c){var p=di(s);s=0;for(var x;p;){if(p.nodeType===3){if(x=s+p.textContent.length,s<=c&&x>=c)return{node:p,offset:c-s};s=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=di(p)}}function cf(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?cf(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function Au(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=Wa(s.document);c instanceof s.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)s=c.contentWindow;else break;c=Wa(s.document)}return c}function Pu(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var rp=Fi&&"documentMode"in document&&11>=document.documentMode,wo=null,is=null,De=null,Qe=!1;function qe(s,c,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Qe||wo==null||wo!==Wa(x)||(x=wo,"selectionStart"in x&&Pu(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),De&&ii(De,x)||(De=x,x=th(is,"onSelect"),0<x.length&&(c=new cc("onSelect","select",null,c,p),s.push({event:c,listeners:x}),c.target=wo)))}function ft(s,c){var p={};return p[s.toLowerCase()]=c.toLowerCase(),p["Webkit"+s]="webkit"+c,p["Moz"+s]="moz"+c,p}var Pt={animationend:ft("Animation","AnimationEnd"),animationiteration:ft("Animation","AnimationIteration"),animationstart:ft("Animation","AnimationStart"),transitionrun:ft("Transition","TransitionRun"),transitionstart:ft("Transition","TransitionStart"),transitioncancel:ft("Transition","TransitionCancel"),transitionend:ft("Transition","TransitionEnd")},fn={},nr={};Fi&&(nr=document.createElement("div").style,"AnimationEvent"in window||(delete Pt.animationend.animation,delete Pt.animationiteration.animation,delete Pt.animationstart.animation),"TransitionEvent"in window||delete Pt.transitionend.transition);function hn(s){if(fn[s])return fn[s];if(!Pt[s])return s;var c=Pt[s],p;for(p in c)if(c.hasOwnProperty(p)&&p in nr)return fn[s]=c[p];return s}var fi=hn("animationend"),uf=hn("animationiteration"),hi=hn("animationstart"),yl=hn("transitionrun"),ip=hn("transitionstart"),So=hn("transitioncancel"),xl=hn("transitionend"),bl=new Map,wn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wn.push("scrollEnd");function zi(s,c){bl.set(s,c),js(c,[s])}var Du=new WeakMap;function Gr(s,c){if(typeof s=="object"&&s!==null){var p=Du.get(s);return p!==void 0?p:(c={value:s,source:c,stack:tc(c)},Du.set(s,c),c)}return{value:s,source:c,stack:tc(c)}}var vi=[],Rs=0,Sc=0;function as(){for(var s=Rs,c=Sc=Rs=0;c<s;){var p=vi[c];vi[c++]=null;var x=vi[c];vi[c++]=null;var N=vi[c];vi[c++]=null;var A=vi[c];if(vi[c++]=null,x!==null&&N!==null){var q=x.pending;q===null?N.next=N:(N.next=q.next,q.next=N),x.pending=N}A!==0&&Te(p,N,A)}}function ae(s,c,p,x){vi[Rs++]=s,vi[Rs++]=c,vi[Rs++]=p,vi[Rs++]=x,Sc|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function ge(s,c,p,x){return ae(s,c,p,x),et(s)}function ce(s,c){return ae(s,null,null,c),et(s)}function Te(s,c,p){s.lanes|=p;var x=s.alternate;x!==null&&(x.lanes|=p);for(var N=!1,A=s.return;A!==null;)A.childLanes|=p,x=A.alternate,x!==null&&(x.childLanes|=p),A.tag===22&&(s=A.stateNode,s===null||s._visibility&1||(N=!0)),s=A,A=A.return;return s.tag===3?(A=s.stateNode,N&&c!==null&&(N=31-Je(p),s=A.hiddenUpdates,x=s[N],x===null?s[N]=[c]:x.push(c),c.lane=p|536870912),A):null}function et(s){if(50<Vc)throw Vc=0,Xp=null,Error(r(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var dt={};function _t(s,c,p,x){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yt(s,c,p,x){return new _t(s,c,p,x)}function hr(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Kn(s,c){var p=s.alternate;return p===null?(p=yt(s.tag,c,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=c,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,c=s.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function vl(s,c){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,c=p.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function df(s,c,p,x,N,A){var q=0;if(x=s,typeof s=="function")hr(s)&&(q=1);else if(typeof s=="string")q=Av(s,p,pe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case W:return s=yt(31,p,c,N),s.elementType=W,s.lanes=A,s;case S:return wl(p.children,N,A,c);case k:q=8,N|=24;break;case T:return s=yt(12,p,c,N|2),s.elementType=T,s.lanes=A,s;case $:return s=yt(13,p,c,N),s.elementType=$,s.lanes=A,s;case L:return s=yt(19,p,c,N),s.elementType=L,s.lanes=A,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case P:case R:q=10;break e;case M:q=9;break e;case z:q=11;break e;case U:q=14;break e;case B:q=16,x=null;break e}q=29,p=Error(r(130,s===null?"null":typeof s,"")),x=null}return c=yt(q,p,c,N),c.elementType=s,c.type=x,c.lanes=A,c}function wl(s,c,p,x){return s=yt(7,s,x,c),s.lanes=p,s}function ap(s,c,p){return s=yt(6,s,null,c),s.lanes=p,s}function Nc(s,c,p){return c=yt(4,s.children!==null?s.children:[],s.key,c),c.lanes=p,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var Ms=[],No=0,ff=null,Iu=0,ea=[],ta=0,Xn=null,rr=1,Os="";function Sl(s,c){Ms[No++]=Iu,Ms[No++]=ff,ff=s,Iu=c}function sp(s,c,p){ea[ta++]=rr,ea[ta++]=Os,ea[ta++]=Xn,Xn=s;var x=rr;s=Os;var N=32-Je(x)-1;x&=~(1<<N),p+=1;var A=32-Je(c)+N;if(30<A){var q=N-N%5;A=(x&(1<<q)-1).toString(32),x>>=q,N-=q,rr=1<<32-Je(c)+N|p<<N|x,Os=A+s}else rr=1<<A|p<<N|x,Os=s}function op(s){s.return!==null&&(Sl(s,1),sp(s,1,0))}function Ru(s){for(;s===ff;)ff=Ms[--No],Ms[No]=null,Iu=Ms[--No],Ms[No]=null;for(;s===Xn;)Xn=ea[--ta],ea[ta]=null,Os=ea[--ta],ea[ta]=null,rr=ea[--ta],ea[ta]=null}var jr=null,ir=null,cn=!1,Ea=null,wi=!1,Cc=Error(r(519));function na(s){var c=Error(r(418,""));throw Co(Gr(c,s)),Cc}function bg(s){var c=s.stateNode,p=s.type,x=s.memoizedProps;switch(c[En]=s,c[wr]=x,p){case"dialog":on("cancel",c),on("close",c);break;case"iframe":case"object":case"embed":on("load",c);break;case"video":case"audio":for(p=0;p<Sd.length;p++)on(Sd[p],c);break;case"source":on("error",c);break;case"img":case"image":case"link":on("error",c),on("load",c);break;case"details":on("toggle",c);break;case"input":on("invalid",c),vu(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),nc(c);break;case"select":on("invalid",c);break;case"textarea":on("invalid",c),lo(c,x.value,x.defaultValue,x.children),nc(c)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||x.suppressHydrationWarning===!0||By(c.textContent,p)?(x.popover!=null&&(on("beforetoggle",c),on("toggle",c)),x.onScroll!=null&&on("scroll",c),x.onScrollEnd!=null&&on("scrollend",c),x.onClick!=null&&(c.onclick=nh),c=!0):c=!1,c||na(s)}function vg(s){for(jr=s.return;jr;)switch(jr.tag){case 5:case 13:wi=!1;return;case 27:case 3:wi=!0;return;default:jr=jr.return}}function Mu(s){if(s!==jr)return!1;if(!cn)return vg(s),cn=!0,!1;var c=s.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=s.type,p=!(p!=="form"&&p!=="button")||ih(s.type,s.memoizedProps)),p=!p),p&&ir&&na(s),vg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(p=s.data,p==="/$"){if(c===0){ir=Ma(s.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++;s=s.nextSibling}ir=null}}else c===27?(c=ir,la(s.type)?(s=fm,fm=null,ir=s):ir=c):ir=jr?Ma(s.stateNode.nextSibling):null;return!0}function Ou(){ir=jr=null,cn=!1}function wg(){var s=Ea;return s!==null&&(Ei===null?Ei=s:Ei.push.apply(Ei,s),Ea=null),s}function Co(s){Ea===null?Ea=[s]:Ea.push(s)}var Nl=de(null),_o=null,Z=null;function Ui(s,c,p){D(Nl,c._currentValue),c._currentValue=p}function ra(s){s._currentValue=Nl.current,he(Nl)}function Si(s,c,p){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===p)break;s=s.return}}function tn(s,c,p,x){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var A=N.dependencies;if(A!==null){var q=N.child;A=A.firstContext;e:for(;A!==null;){var ee=A;A=N;for(var we=0;we<c.length;we++)if(ee.context===c[we]){A.lanes|=p,ee=A.alternate,ee!==null&&(ee.lanes|=p),Si(A.return,p,s),x||(q=null);break e}A=ee.next}}else if(N.tag===18){if(q=N.return,q===null)throw Error(r(341));q.lanes|=p,A=q.alternate,A!==null&&(A.lanes|=p),Si(q,p,s),q=null}else q=N.child;if(q!==null)q.return=N;else for(q=N;q!==null;){if(q===s){q=null;break}if(N=q.sibling,N!==null){N.return=q.return,q=N;break}q=q.return}N=q}}function Lu(s,c,p,x){s=null;for(var N=c,A=!1;N!==null;){if(!A){if((N.flags&524288)!==0)A=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var q=N.alternate;if(q===null)throw Error(r(387));if(q=q.memoizedProps,q!==null){var ee=N.type;ri(N.pendingProps.value,q.value)||(s!==null?s.push(ee):s=[ee])}}else if(N===K.current){if(q=N.alternate,q===null)throw Error(r(387));q.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(Xc):s=[Xc])}N=N.return}s!==null&&tn(c,s,p,x),c.flags|=262144}function hf(s){for(s=s.firstContext;s!==null;){if(!ri(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Cl(s){_o=s,Z=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function pr(s){return Sg(_o,s)}function pf(s,c){return _o===null&&Cl(s),Sg(s,c)}function Sg(s,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},Z===null){if(s===null)throw Error(r(308));Z=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else Z=Z.next=c;return p}var ev=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(p,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(p){return p()})}},tv=e.unstable_scheduleCallback,nv=e.unstable_NormalPriority,Vn={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lp(){return{controller:new ev,data:new Map,refCount:0}}function Fu(s){s.refCount--,s.refCount===0&&tv(nv,function(){s.controller.abort()})}var $u=null,cp=0,_c=0,Ni=null;function rv(s,c){if($u===null){var p=$u=[];cp=0,_c=eh(),Ni={status:"pending",value:void 0,then:function(x){p.push(x)}}}return cp++,c.then(Ng,Ng),c}function Ng(){if(--cp===0&&$u!==null){Ni!==null&&(Ni.status="fulfilled");var s=$u;$u=null,_c=0,Ni=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function iv(s,c){var p=[],x={status:"pending",value:null,reason:null,then:function(N){p.push(N)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<p.length;N++)(0,p[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<p.length;N++)(0,p[N])(void 0)}),x}var Cg=Y.S;Y.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&rv(s,c),Cg!==null&&Cg(s,c)};var _l=de(null);function Ls(){var s=_l.current;return s!==null?s:Wn.pooledCache}function mf(s,c){c===null?D(_l,_l.current):D(_l,c.pool)}function _g(){var s=Ls();return s===null?null:{parent:Vn._currentValue,pool:s}}var pi=Error(r(460)),jg=Error(r(474)),gf=Error(r(542)),up={then:function(){}};function kg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function yf(){}function dp(s,c,p){switch(p=s[p],p===void 0?s.push(c):p!==c&&(c.then(yf,yf),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Eg(s),s;default:if(typeof c.status=="string")c.then(yf,yf);else{if(s=Wn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Eg(s),s}throw jc=c,pi}}var jc=null;function Tg(){if(jc===null)throw Error(r(459));var s=jc;return jc=null,s}function Eg(s){if(s===pi||s===gf)throw Error(r(483))}var ss=!1;function jl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kc(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function jo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Fs(s,c,p){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Rn&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=et(s),Te(s,null,p),c}return ae(s,x,c,p),et(s)}function zu(s,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,bt(s,p)}}function Aa(s,c){var p=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var N=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var q={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};A===null?N=A=q:A=A.next=q,p=p.next}while(p!==null);A===null?N=A=c:A=A.next=c}else N=A=c;p={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:A,shared:x.shared,callbacks:x.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=c:s.next=c,p.lastBaseUpdate=c}var Uu=!1;function Pa(){if(Uu){var s=Ni;if(s!==null)throw s}}function ai(s,c,p,x){Uu=!1;var N=s.updateQueue;ss=!1;var A=N.firstBaseUpdate,q=N.lastBaseUpdate,ee=N.shared.pending;if(ee!==null){N.shared.pending=null;var we=ee,ze=we.next;we.next=null,q===null?A=ze:q.next=ze,q=we;var Xe=s.alternate;Xe!==null&&(Xe=Xe.updateQueue,ee=Xe.lastBaseUpdate,ee!==q&&(ee===null?Xe.firstBaseUpdate=ze:ee.next=ze,Xe.lastBaseUpdate=we))}if(A!==null){var nt=N.baseState;q=0,Xe=ze=we=null,ee=A;do{var Be=ee.lane&-536870913,Ue=Be!==ee.lane;if(Ue?(xn&Be)===Be:(x&Be)===Be){Be!==0&&Be===_c&&(Uu=!0),Xe!==null&&(Xe=Xe.next={lane:0,tag:ee.tag,payload:ee.payload,callback:null,next:null});e:{var Mt=s,Rt=ee;Be=c;var zn=p;switch(Rt.tag){case 1:if(Mt=Rt.payload,typeof Mt=="function"){nt=Mt.call(zn,nt,Be);break e}nt=Mt;break e;case 3:Mt.flags=Mt.flags&-65537|128;case 0:if(Mt=Rt.payload,Be=typeof Mt=="function"?Mt.call(zn,nt,Be):Mt,Be==null)break e;nt=h({},nt,Be);break e;case 2:ss=!0}}Be=ee.callback,Be!==null&&(s.flags|=64,Ue&&(s.flags|=8192),Ue=N.callbacks,Ue===null?N.callbacks=[Be]:Ue.push(Be))}else Ue={lane:Be,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},Xe===null?(ze=Xe=Ue,we=nt):Xe=Xe.next=Ue,q|=Be;if(ee=ee.next,ee===null){if(ee=N.shared.pending,ee===null)break;Ue=ee,ee=Ue.next,Ue.next=null,N.lastBaseUpdate=Ue,N.shared.pending=null}}while(!0);Xe===null&&(we=nt),N.baseState=we,N.firstBaseUpdate=ze,N.lastBaseUpdate=Xe,A===null&&(N.shared.lanes=0),Mo|=q,s.lanes=q,s.memoizedState=nt}}function Ag(s,c){if(typeof s!="function")throw Error(r(191,s));s.call(c)}function fp(s,c){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Ag(p[s],c)}var kl=de(null),ko=de(0);function $s(s,c){s=Ws,D(ko,s),D(kl,c),Ws=s|c.baseLanes}function xf(){D(ko,Ws),D(kl,kl.current)}function hp(){Ws=ko.current,he(kl),he(ko)}var Da=0,Kt=null,In=null,un=null,Tc=!1,Tl=!1,si=!1,Ec=0,To=0,ia=null,Pg=0;function pn(){throw Error(r(321))}function Bu(s,c){if(c===null)return!1;for(var p=0;p<c.length&&p<s.length;p++)if(!ri(s[p],c[p]))return!1;return!0}function pp(s,c,p,x,N,A){return Da=A,Kt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Y.H=s===null||s.memoizedState===null?Vg:Dp,si=!1,A=p(x,N),si=!1,Tl&&(A=Ig(c,p,x,N)),Dg(s),A}function Dg(s){Y.H=Zu;var c=In!==null&&In.next!==null;if(Da=0,un=In=Kt=null,Tc=!1,To=0,ia=null,c)throw Error(r(300));s===null||Or||(s=s.dependencies,s!==null&&hf(s)&&(Or=!0))}function Ig(s,c,p,x){Kt=s;var N=0;do{if(Tl&&(ia=null),To=0,Tl=!1,25<=N)throw Error(r(301));if(N+=1,un=In=null,s.updateQueue!=null){var A=s.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}Y.H=Hg,A=c(p,x)}while(Tl);return A}function mp(){var s=Y.H,c=s.useState()[0];return c=typeof c.then=="function"?qu(c):c,s=s.useState()[0],(In!==null?In.memoizedState:null)!==s&&(Kt.flags|=1024),c}function gp(){var s=Ec!==0;return Ec=0,s}function El(s,c,p){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~p}function bf(s){if(Tc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}Tc=!1}Da=0,un=In=Kt=null,Tl=!1,To=Ec=0,ia=null}function Ci(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return un===null?Kt.memoizedState=un=s:un=un.next=s,un}function Nr(){if(In===null){var s=Kt.alternate;s=s!==null?s.memoizedState:null}else s=In.next;var c=un===null?Kt.memoizedState:un.next;if(c!==null)un=c,In=s;else{if(s===null)throw Kt.alternate===null?Error(r(467)):Error(r(310));In=s,s={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},un===null?Kt.memoizedState=un=s:un=un.next=s}return un}function Al(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function qu(s){var c=To;return To+=1,ia===null&&(ia=[]),s=dp(ia,s,c),c=Kt,(un===null?c.memoizedState:un.next)===null&&(c=c.alternate,Y.H=c===null||c.memoizedState===null?Vg:Dp),s}function vf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return qu(s);if(s.$$typeof===R)return pr(s)}throw Error(r(438,String(s)))}function Vu(s){var c=null,p=Kt.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var x=Kt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=Al(),Kt.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(s),x=0;x<s;x++)p[x]=I;return c.index++,p}function os(s,c){return typeof c=="function"?c(s):c}function wf(s){var c=Nr();return yp(c,In,s)}function yp(s,c,p){var x=s.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=p;var N=s.baseQueue,A=x.pending;if(A!==null){if(N!==null){var q=N.next;N.next=A.next,A.next=q}c.baseQueue=N=A,x.pending=null}if(A=s.baseState,N===null)s.memoizedState=A;else{c=N.next;var ee=q=null,we=null,ze=c,Xe=!1;do{var nt=ze.lane&-536870913;if(nt!==ze.lane?(xn&nt)===nt:(Da&nt)===nt){var Be=ze.revertLane;if(Be===0)we!==null&&(we=we.next={lane:0,revertLane:0,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null}),nt===_c&&(Xe=!0);else if((Da&Be)===Be){ze=ze.next,Be===_c&&(Xe=!0);continue}else nt={lane:0,revertLane:ze.revertLane,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},we===null?(ee=we=nt,q=A):we=we.next=nt,Kt.lanes|=Be,Mo|=Be;nt=ze.action,si&&p(A,nt),A=ze.hasEagerState?ze.eagerState:p(A,nt)}else Be={lane:nt,revertLane:ze.revertLane,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},we===null?(ee=we=Be,q=A):we=we.next=Be,Kt.lanes|=nt,Mo|=nt;ze=ze.next}while(ze!==null&&ze!==c);if(we===null?q=A:we.next=ee,!ri(A,s.memoizedState)&&(Or=!0,Xe&&(p=Ni,p!==null)))throw p;s.memoizedState=A,s.baseState=q,s.baseQueue=we,x.lastRenderedState=A}return N===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function xp(s){var c=Nr(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var x=p.dispatch,N=p.pending,A=c.memoizedState;if(N!==null){p.pending=null;var q=N=N.next;do A=s(A,q.action),q=q.next;while(q!==N);ri(A,c.memoizedState)||(Or=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),p.lastRenderedState=A}return[A,x]}function bp(s,c,p){var x=Kt,N=Nr(),A=cn;if(A){if(p===void 0)throw Error(r(407));p=p()}else p=c();var q=!ri((In||N).memoizedState,p);q&&(N.memoizedState=p,Or=!0),N=N.queue;var ee=Nf.bind(null,x,N,s);if(Yu(2048,8,ee,[s]),N.getSnapshot!==c||q||un!==null&&un.memoizedState.tag&1){if(x.flags|=2048,Ac(9,Tf(),Rg.bind(null,x,N,p,c),null),Wn===null)throw Error(r(349));A||(Da&124)!==0||Sf(x,c,p)}return p}function Sf(s,c,p){s.flags|=16384,s={getSnapshot:c,value:p},c=Kt.updateQueue,c===null?(c=Al(),Kt.updateQueue=c,c.stores=[s]):(p=c.stores,p===null?c.stores=[s]:p.push(s))}function Rg(s,c,p,x){c.value=p,c.getSnapshot=x,vp(c)&&wp(s)}function Nf(s,c,p){return p(function(){vp(c)&&wp(s)})}function vp(s){var c=s.getSnapshot;s=s.value;try{var p=c();return!ri(s,p)}catch{return!0}}function wp(s){var c=ce(s,2);c!==null&&Gi(c,s,2)}function Cf(s){var c=Ci();if(typeof s=="function"){var p=s;if(s=p(),si){Ge(!0);try{p()}finally{Ge(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:s},c}function Hu(s,c,p,x){return s.baseState=p,yp(s,In,typeof x=="function"?x:os)}function av(s,c,p,x,N){if(Df(s))throw Error(r(485));if(s=c.action,s!==null){var A={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){A.listeners.push(q)}};Y.T!==null?p(!0):A.isTransition=!1,x(A),p=c.pending,p===null?(A.next=c.pending=A,Sp(c,A)):(A.next=p.next,c.pending=p.next=A)}}function Sp(s,c){var p=c.action,x=c.payload,N=s.state;if(c.isTransition){var A=Y.T,q={};Y.T=q;try{var ee=p(N,x),we=Y.S;we!==null&&we(q,ee),Np(s,c,ee)}catch(ze){_f(s,c,ze)}finally{Y.T=A}}else try{A=p(N,x),Np(s,c,A)}catch(ze){_f(s,c,ze)}}function Np(s,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Mg(s,c,x)},function(x){return _f(s,c,x)}):Mg(s,c,p)}function Mg(s,c,p){c.status="fulfilled",c.value=p,Og(c),s.state=p,c=s.pending,c!==null&&(p=c.next,p===c?s.pending=null:(p=p.next,c.next=p,Sp(s,p)))}function _f(s,c,p){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=p,Og(c),c=c.next;while(c!==x)}s.action=null}function Og(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function jf(s,c){return c}function Cp(s,c){if(cn){var p=Wn.formState;if(p!==null){e:{var x=Kt;if(cn){if(ir){t:{for(var N=ir,A=wi;N.nodeType!==8;){if(!A){N=null;break t}if(N=Ma(N.nextSibling),N===null){N=null;break t}}A=N.data,N=A==="F!"||A==="F"?N:null}if(N){ir=Ma(N.nextSibling),x=N.data==="F!";break e}}na(x)}x=!1}x&&(c=p[0])}}return p=Ci(),p.memoizedState=p.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jf,lastRenderedState:c},p.queue=x,p=Ep.bind(null,Kt,x),x.dispatch=p,x=Cf(!1),A=Ap.bind(null,Kt,!1,x.queue),x=Ci(),N={state:c,dispatch:null,action:s,pending:null},x.queue=N,p=av.bind(null,Kt,N,A,p),N.dispatch=p,x.memoizedState=s,[c,p,!1]}function kf(s){var c=Nr();return Lg(c,In,s)}function Lg(s,c,p){if(c=yp(s,c,jf)[0],s=wf(os)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=qu(c)}catch(q){throw q===pi?gf:q}else x=c;c=Nr();var N=c.queue,A=N.dispatch;return p!==c.memoizedState&&(Kt.flags|=2048,Ac(9,Tf(),_p.bind(null,N,p),null)),[x,A,s]}function _p(s,c){s.action=c}function Wt(s){var c=Nr(),p=In;if(p!==null)return Lg(c,p,s);Nr(),c=c.memoizedState,p=Nr();var x=p.queue.dispatch;return p.memoizedState=s,[c,x,!1]}function Ac(s,c,p,x){return s={tag:s,create:p,deps:x,inst:c,next:null},c=Kt.updateQueue,c===null&&(c=Al(),Kt.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=s.next=s:(x=p.next,p.next=s,s.next=x,c.lastEffect=s),s}function Tf(){return{destroy:void 0,resource:void 0}}function Pc(){return Nr().memoizedState}function Gu(s,c,p,x){var N=Ci();x=x===void 0?null:x,Kt.flags|=s,N.memoizedState=Ac(1|c,Tf(),p,x)}function Yu(s,c,p,x){var N=Nr();x=x===void 0?null:x;var A=N.memoizedState.inst;In!==null&&x!==null&&Bu(x,In.memoizedState.deps)?N.memoizedState=Ac(c,A,p,x):(Kt.flags|=s,N.memoizedState=Ac(1|c,A,p,x))}function Fg(s,c){Gu(8390656,8,s,c)}function Bi(s,c){Yu(2048,8,s,c)}function $g(s,c){return Yu(4,2,s,c)}function Wu(s,c){return Yu(4,4,s,c)}function Ef(s,c){if(typeof c=="function"){s=s();var p=c(s);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function jp(s,c,p){p=p!=null?p.concat([s]):null,Yu(4,4,Ef.bind(null,c,s),p)}function Af(){}function _i(s,c){var p=Nr();c=c===void 0?null:c;var x=p.memoizedState;return c!==null&&Bu(c,x[1])?x[0]:(p.memoizedState=[s,c],s)}function zs(s,c){var p=Nr();c=c===void 0?null:c;var x=p.memoizedState;if(c!==null&&Bu(c,x[1]))return x[0];if(x=s(),si){Ge(!0);try{s()}finally{Ge(!1)}}return p.memoizedState=[x,c],x}function Qu(s,c,p){return p===void 0||(Da&1073741824)!==0?s.memoizedState=c:(s.memoizedState=p,s=xy(),Kt.lanes|=s,Mo|=s,p)}function kp(s,c,p,x){return ri(p,c)?p:kl.current!==null?(s=Qu(s,p,x),ri(s,c)||(Or=!0),s):(Da&42)===0?(Or=!0,s.memoizedState=p):(s=xy(),Kt.lanes|=s,Mo|=s,c)}function Ju(s,c,p,x,N){var A=ne.p;ne.p=A!==0&&8>A?A:8;var q=Y.T,ee={};Y.T=ee,Ap(s,!1,c,p);try{var we=N(),ze=Y.S;if(ze!==null&&ze(ee,we),we!==null&&typeof we=="object"&&typeof we.then=="function"){var Xe=iv(we,x);Pl(s,c,Xe,li(s))}else Pl(s,c,x,li(s))}catch(nt){Pl(s,c,{then:function(){},status:"rejected",reason:nt},li())}finally{ne.p=A,Y.T=q}}function zg(){}function Ku(s,c,p,x){if(s.tag!==5)throw Error(r(476));var N=Tp(s).queue;Ju(s,N,c,le,p===null?zg:function(){return Pf(s),p(x)})}function Tp(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:le},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:p},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function Pf(s){var c=Tp(s).next.queue;Pl(s,c,{},li())}function Xu(){return pr(Xc)}function Us(){return Nr().memoizedState}function Ug(){return Nr().memoizedState}function Eo(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var p=li();s=jo(p);var x=Fs(c,s,p);x!==null&&(Gi(x,c,p),zu(x,c,p)),c={cache:lp()},s.payload=c;return}c=c.return}}function Bg(s,c,p){var x=li();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Df(s)?qg(c,p):(p=ge(s,c,p,x),p!==null&&(Gi(p,s,x),Pp(p,c,x)))}function Ep(s,c,p){var x=li();Pl(s,c,p,x)}function Pl(s,c,p,x){var N={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Df(s))qg(c,N);else{var A=s.alternate;if(s.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var q=c.lastRenderedState,ee=A(q,p);if(N.hasEagerState=!0,N.eagerState=ee,ri(ee,q))return ae(s,c,N,0),Wn===null&&as(),!1}catch{}finally{}if(p=ge(s,c,N,x),p!==null)return Gi(p,s,x),Pp(p,c,x),!0}return!1}function Ap(s,c,p,x){if(x={lane:2,revertLane:eh(),action:x,hasEagerState:!1,eagerState:null,next:null},Df(s)){if(c)throw Error(r(479))}else c=ge(s,p,x,2),c!==null&&Gi(c,s,2)}function Df(s){var c=s.alternate;return s===Kt||c!==null&&c===Kt}function qg(s,c){Tl=Tc=!0;var p=s.pending;p===null?c.next=c:(c.next=p.next,p.next=c),s.pending=c}function Pp(s,c,p){if((p&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,bt(s,p)}}var Zu={readContext:pr,use:vf,useCallback:pn,useContext:pn,useEffect:pn,useImperativeHandle:pn,useLayoutEffect:pn,useInsertionEffect:pn,useMemo:pn,useReducer:pn,useRef:pn,useState:pn,useDebugValue:pn,useDeferredValue:pn,useTransition:pn,useSyncExternalStore:pn,useId:pn,useHostTransitionStatus:pn,useFormState:pn,useActionState:pn,useOptimistic:pn,useMemoCache:pn,useCacheRefresh:pn},Vg={readContext:pr,use:vf,useCallback:function(s,c){return Ci().memoizedState=[s,c===void 0?null:c],s},useContext:pr,useEffect:Fg,useImperativeHandle:function(s,c,p){p=p!=null?p.concat([s]):null,Gu(4194308,4,Ef.bind(null,c,s),p)},useLayoutEffect:function(s,c){return Gu(4194308,4,s,c)},useInsertionEffect:function(s,c){Gu(4,2,s,c)},useMemo:function(s,c){var p=Ci();c=c===void 0?null:c;var x=s();if(si){Ge(!0);try{s()}finally{Ge(!1)}}return p.memoizedState=[x,c],x},useReducer:function(s,c,p){var x=Ci();if(p!==void 0){var N=p(c);if(si){Ge(!0);try{p(c)}finally{Ge(!1)}}}else N=c;return x.memoizedState=x.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},x.queue=s,s=s.dispatch=Bg.bind(null,Kt,s),[x.memoizedState,s]},useRef:function(s){var c=Ci();return s={current:s},c.memoizedState=s},useState:function(s){s=Cf(s);var c=s.queue,p=Ep.bind(null,Kt,c);return c.dispatch=p,[s.memoizedState,p]},useDebugValue:Af,useDeferredValue:function(s,c){var p=Ci();return Qu(p,s,c)},useTransition:function(){var s=Cf(!1);return s=Ju.bind(null,Kt,s.queue,!0,!1),Ci().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,p){var x=Kt,N=Ci();if(cn){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),Wn===null)throw Error(r(349));(xn&124)!==0||Sf(x,c,p)}N.memoizedState=p;var A={value:p,getSnapshot:c};return N.queue=A,Fg(Nf.bind(null,x,A,s),[s]),x.flags|=2048,Ac(9,Tf(),Rg.bind(null,x,A,p,c),null),p},useId:function(){var s=Ci(),c=Wn.identifierPrefix;if(cn){var p=Os,x=rr;p=(x&~(1<<32-Je(x)-1)).toString(32)+p,c=""+c+"R"+p,p=Ec++,0<p&&(c+="H"+p.toString(32)),c+=""}else p=Pg++,c=""+c+"r"+p.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Xu,useFormState:Cp,useActionState:Cp,useOptimistic:function(s){var c=Ci();c.memoizedState=c.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=Ap.bind(null,Kt,!0,p),p.dispatch=c,[s,c]},useMemoCache:Vu,useCacheRefresh:function(){return Ci().memoizedState=Eo.bind(null,Kt)}},Dp={readContext:pr,use:vf,useCallback:_i,useContext:pr,useEffect:Bi,useImperativeHandle:jp,useInsertionEffect:$g,useLayoutEffect:Wu,useMemo:zs,useReducer:wf,useRef:Pc,useState:function(){return wf(os)},useDebugValue:Af,useDeferredValue:function(s,c){var p=Nr();return kp(p,In.memoizedState,s,c)},useTransition:function(){var s=wf(os)[0],c=Nr().memoizedState;return[typeof s=="boolean"?s:qu(s),c]},useSyncExternalStore:bp,useId:Us,useHostTransitionStatus:Xu,useFormState:kf,useActionState:kf,useOptimistic:function(s,c){var p=Nr();return Hu(p,In,s,c)},useMemoCache:Vu,useCacheRefresh:Ug},Hg={readContext:pr,use:vf,useCallback:_i,useContext:pr,useEffect:Bi,useImperativeHandle:jp,useInsertionEffect:$g,useLayoutEffect:Wu,useMemo:zs,useReducer:xp,useRef:Pc,useState:function(){return xp(os)},useDebugValue:Af,useDeferredValue:function(s,c){var p=Nr();return In===null?Qu(p,s,c):kp(p,In.memoizedState,s,c)},useTransition:function(){var s=xp(os)[0],c=Nr().memoizedState;return[typeof s=="boolean"?s:qu(s),c]},useSyncExternalStore:bp,useId:Us,useHostTransitionStatus:Xu,useFormState:Wt,useActionState:Wt,useOptimistic:function(s,c){var p=Nr();return In!==null?Hu(p,In,s,c):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:Vu,useCacheRefresh:Ug},kr=null,ji=0;function If(s){var c=ji;return ji+=1,kr===null&&(kr=[]),dp(kr,s,c)}function ed(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function Dl(s,c){throw c.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function Il(s){var c=s._init;return c(s._payload)}function Ip(s){function c(Me,Ee){if(s){var $e=Me.deletions;$e===null?(Me.deletions=[Ee],Me.flags|=16):$e.push(Ee)}}function p(Me,Ee){if(!s)return null;for(;Ee!==null;)c(Me,Ee),Ee=Ee.sibling;return null}function x(Me){for(var Ee=new Map;Me!==null;)Me.key!==null?Ee.set(Me.key,Me):Ee.set(Me.index,Me),Me=Me.sibling;return Ee}function N(Me,Ee){return Me=Kn(Me,Ee),Me.index=0,Me.sibling=null,Me}function A(Me,Ee,$e){return Me.index=$e,s?($e=Me.alternate,$e!==null?($e=$e.index,$e<Ee?(Me.flags|=67108866,Ee):$e):(Me.flags|=67108866,Ee)):(Me.flags|=1048576,Ee)}function q(Me){return s&&Me.alternate===null&&(Me.flags|=67108866),Me}function ee(Me,Ee,$e,Ze){return Ee===null||Ee.tag!==6?(Ee=ap($e,Me.mode,Ze),Ee.return=Me,Ee):(Ee=N(Ee,$e),Ee.return=Me,Ee)}function we(Me,Ee,$e,Ze){var gt=$e.type;return gt===S?Xe(Me,Ee,$e.props.children,Ze,$e.key):Ee!==null&&(Ee.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===B&&Il(gt)===Ee.type)?(Ee=N(Ee,$e.props),ed(Ee,$e),Ee.return=Me,Ee):(Ee=df($e.type,$e.key,$e.props,null,Me.mode,Ze),ed(Ee,$e),Ee.return=Me,Ee)}function ze(Me,Ee,$e,Ze){return Ee===null||Ee.tag!==4||Ee.stateNode.containerInfo!==$e.containerInfo||Ee.stateNode.implementation!==$e.implementation?(Ee=Nc($e,Me.mode,Ze),Ee.return=Me,Ee):(Ee=N(Ee,$e.children||[]),Ee.return=Me,Ee)}function Xe(Me,Ee,$e,Ze,gt){return Ee===null||Ee.tag!==7?(Ee=wl($e,Me.mode,Ze,gt),Ee.return=Me,Ee):(Ee=N(Ee,$e),Ee.return=Me,Ee)}function nt(Me,Ee,$e){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return Ee=ap(""+Ee,Me.mode,$e),Ee.return=Me,Ee;if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case b:return $e=df(Ee.type,Ee.key,Ee.props,null,Me.mode,$e),ed($e,Ee),$e.return=Me,$e;case v:return Ee=Nc(Ee,Me.mode,$e),Ee.return=Me,Ee;case B:var Ze=Ee._init;return Ee=Ze(Ee._payload),nt(Me,Ee,$e)}if(G(Ee)||V(Ee))return Ee=wl(Ee,Me.mode,$e,null),Ee.return=Me,Ee;if(typeof Ee.then=="function")return nt(Me,If(Ee),$e);if(Ee.$$typeof===R)return nt(Me,pf(Me,Ee),$e);Dl(Me,Ee)}return null}function Be(Me,Ee,$e,Ze){var gt=Ee!==null?Ee.key:null;if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return gt!==null?null:ee(Me,Ee,""+$e,Ze);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case b:return $e.key===gt?we(Me,Ee,$e,Ze):null;case v:return $e.key===gt?ze(Me,Ee,$e,Ze):null;case B:return gt=$e._init,$e=gt($e._payload),Be(Me,Ee,$e,Ze)}if(G($e)||V($e))return gt!==null?null:Xe(Me,Ee,$e,Ze,null);if(typeof $e.then=="function")return Be(Me,Ee,If($e),Ze);if($e.$$typeof===R)return Be(Me,Ee,pf(Me,$e),Ze);Dl(Me,$e)}return null}function Ue(Me,Ee,$e,Ze,gt){if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return Me=Me.get($e)||null,ee(Ee,Me,""+Ze,gt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case b:return Me=Me.get(Ze.key===null?$e:Ze.key)||null,we(Ee,Me,Ze,gt);case v:return Me=Me.get(Ze.key===null?$e:Ze.key)||null,ze(Ee,Me,Ze,gt);case B:var nn=Ze._init;return Ze=nn(Ze._payload),Ue(Me,Ee,$e,Ze,gt)}if(G(Ze)||V(Ze))return Me=Me.get($e)||null,Xe(Ee,Me,Ze,gt,null);if(typeof Ze.then=="function")return Ue(Me,Ee,$e,If(Ze),gt);if(Ze.$$typeof===R)return Ue(Me,Ee,$e,pf(Ee,Ze),gt);Dl(Ee,Ze)}return null}function Mt(Me,Ee,$e,Ze){for(var gt=null,nn=null,St=Ee,Ot=Ee=0,$r=null;St!==null&&Ot<$e.length;Ot++){St.index>Ot?($r=St,St=null):$r=St.sibling;var Sn=Be(Me,St,$e[Ot],Ze);if(Sn===null){St===null&&(St=$r);break}s&&St&&Sn.alternate===null&&c(Me,St),Ee=A(Sn,Ee,Ot),nn===null?gt=Sn:nn.sibling=Sn,nn=Sn,St=$r}if(Ot===$e.length)return p(Me,St),cn&&Sl(Me,Ot),gt;if(St===null){for(;Ot<$e.length;Ot++)St=nt(Me,$e[Ot],Ze),St!==null&&(Ee=A(St,Ee,Ot),nn===null?gt=St:nn.sibling=St,nn=St);return cn&&Sl(Me,Ot),gt}for(St=x(St);Ot<$e.length;Ot++)$r=Ue(St,Me,Ot,$e[Ot],Ze),$r!==null&&(s&&$r.alternate!==null&&St.delete($r.key===null?Ot:$r.key),Ee=A($r,Ee,Ot),nn===null?gt=$r:nn.sibling=$r,nn=$r);return s&&St.forEach(function(Ho){return c(Me,Ho)}),cn&&Sl(Me,Ot),gt}function Rt(Me,Ee,$e,Ze){if($e==null)throw Error(r(151));for(var gt=null,nn=null,St=Ee,Ot=Ee=0,$r=null,Sn=$e.next();St!==null&&!Sn.done;Ot++,Sn=$e.next()){St.index>Ot?($r=St,St=null):$r=St.sibling;var Ho=Be(Me,St,Sn.value,Ze);if(Ho===null){St===null&&(St=$r);break}s&&St&&Ho.alternate===null&&c(Me,St),Ee=A(Ho,Ee,Ot),nn===null?gt=Ho:nn.sibling=Ho,nn=Ho,St=$r}if(Sn.done)return p(Me,St),cn&&Sl(Me,Ot),gt;if(St===null){for(;!Sn.done;Ot++,Sn=$e.next())Sn=nt(Me,Sn.value,Ze),Sn!==null&&(Ee=A(Sn,Ee,Ot),nn===null?gt=Sn:nn.sibling=Sn,nn=Sn);return cn&&Sl(Me,Ot),gt}for(St=x(St);!Sn.done;Ot++,Sn=$e.next())Sn=Ue(St,Me,Ot,Sn.value,Ze),Sn!==null&&(s&&Sn.alternate!==null&&St.delete(Sn.key===null?Ot:Sn.key),Ee=A(Sn,Ee,Ot),nn===null?gt=Sn:nn.sibling=Sn,nn=Sn);return s&&St.forEach(function(Uv){return c(Me,Uv)}),cn&&Sl(Me,Ot),gt}function zn(Me,Ee,$e,Ze){if(typeof $e=="object"&&$e!==null&&$e.type===S&&$e.key===null&&($e=$e.props.children),typeof $e=="object"&&$e!==null){switch($e.$$typeof){case b:e:{for(var gt=$e.key;Ee!==null;){if(Ee.key===gt){if(gt=$e.type,gt===S){if(Ee.tag===7){p(Me,Ee.sibling),Ze=N(Ee,$e.props.children),Ze.return=Me,Me=Ze;break e}}else if(Ee.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===B&&Il(gt)===Ee.type){p(Me,Ee.sibling),Ze=N(Ee,$e.props),ed(Ze,$e),Ze.return=Me,Me=Ze;break e}p(Me,Ee);break}else c(Me,Ee);Ee=Ee.sibling}$e.type===S?(Ze=wl($e.props.children,Me.mode,Ze,$e.key),Ze.return=Me,Me=Ze):(Ze=df($e.type,$e.key,$e.props,null,Me.mode,Ze),ed(Ze,$e),Ze.return=Me,Me=Ze)}return q(Me);case v:e:{for(gt=$e.key;Ee!==null;){if(Ee.key===gt)if(Ee.tag===4&&Ee.stateNode.containerInfo===$e.containerInfo&&Ee.stateNode.implementation===$e.implementation){p(Me,Ee.sibling),Ze=N(Ee,$e.children||[]),Ze.return=Me,Me=Ze;break e}else{p(Me,Ee);break}else c(Me,Ee);Ee=Ee.sibling}Ze=Nc($e,Me.mode,Ze),Ze.return=Me,Me=Ze}return q(Me);case B:return gt=$e._init,$e=gt($e._payload),zn(Me,Ee,$e,Ze)}if(G($e))return Mt(Me,Ee,$e,Ze);if(V($e)){if(gt=V($e),typeof gt!="function")throw Error(r(150));return $e=gt.call($e),Rt(Me,Ee,$e,Ze)}if(typeof $e.then=="function")return zn(Me,Ee,If($e),Ze);if($e.$$typeof===R)return zn(Me,Ee,pf(Me,$e),Ze);Dl(Me,$e)}return typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint"?($e=""+$e,Ee!==null&&Ee.tag===6?(p(Me,Ee.sibling),Ze=N(Ee,$e),Ze.return=Me,Me=Ze):(p(Me,Ee),Ze=ap($e,Me.mode,Ze),Ze.return=Me,Me=Ze),q(Me)):p(Me,Ee)}return function(Me,Ee,$e,Ze){try{ji=0;var gt=zn(Me,Ee,$e,Ze);return kr=null,gt}catch(St){if(St===pi||St===gf)throw St;var nn=yt(29,St,null,Me.mode);return nn.lanes=Ze,nn.return=Me,nn}finally{}}}var Rl=Ip(!0),Gg=Ip(!1),qi=de(null),mi=null;function aa(s){var c=s.alternate;D(mr,mr.current&1),D(qi,s),mi===null&&(c===null||kl.current!==null||c.memoizedState!==null)&&(mi=s)}function Yg(s){if(s.tag===22){if(D(mr,mr.current),D(qi,s),mi===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(mi=s)}}else Bs()}function Bs(){D(mr,mr.current),D(qi,qi.current)}function ls(s){he(qi),mi===s&&(mi=null),he(mr)}var mr=de(0);function td(s){for(var c=s;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||yi(p)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Dc(s,c,p,x){c=s.memoizedState,p=p(x,c),p=p==null?c:h({},c,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}var nd={enqueueSetState:function(s,c,p){s=s._reactInternals;var x=li(),N=jo(x);N.payload=c,p!=null&&(N.callback=p),c=Fs(s,N,x),c!==null&&(Gi(c,s,x),zu(c,s,x))},enqueueReplaceState:function(s,c,p){s=s._reactInternals;var x=li(),N=jo(x);N.tag=1,N.payload=c,p!=null&&(N.callback=p),c=Fs(s,N,x),c!==null&&(Gi(c,s,x),zu(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var p=li(),x=jo(p);x.tag=2,c!=null&&(x.callback=c),c=Fs(s,x,p),c!==null&&(Gi(c,s,p),zu(c,s,p))}};function rd(s,c,p,x,N,A,q){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,A,q):c.prototype&&c.prototype.isPureReactComponent?!ii(p,x)||!ii(N,A):!0}function Wg(s,c,p,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,x),c.state!==s&&nd.enqueueReplaceState(c,c.state,null)}function Ao(s,c){var p=c;if("ref"in c){p={};for(var x in c)x!=="ref"&&(p[x]=c[x])}if(s=s.defaultProps){p===c&&(p=h({},p));for(var N in s)p[N]===void 0&&(p[N]=s[N])}return p}var Ml=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Rp(s){Ml(s)}function Rf(s){console.error(s)}function Qg(s){Ml(s)}function id(s,c){try{var p=s.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function cs(s,c,p){try{var x=s.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Mf(s,c,p){return p=jo(p),p.tag=3,p.payload={element:null},p.callback=function(){id(s,c)},p}function Mp(s){return s=jo(s),s.tag=3,s}function Jg(s,c,p,x){var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var A=x.value;s.payload=function(){return N(A)},s.callback=function(){cs(c,p,x)}}var q=p.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(s.callback=function(){cs(c,p,x),typeof N!="function"&&(Oo===null?Oo=new Set([this]):Oo.add(this));var ee=x.stack;this.componentDidCatch(x.value,{componentStack:ee!==null?ee:""})})}function Kg(s,c,p,x,N){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=p.alternate,c!==null&&Lu(c,p,N,!0),p=qi.current,p!==null){switch(p.tag){case 13:return mi===null?em():p.alternate===null&&gr===0&&(gr=3),p.flags&=-257,p.flags|=65536,p.lanes=N,x===up?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([x]):c.add(x),rm(s,x,N)),!1;case 22:return p.flags|=65536,x===up?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([x]):p.add(x)),rm(s,x,N)),!1}throw Error(r(435,p.tag))}return rm(s,x,N),em(),!1}if(cn)return c=qi.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==Cc&&(s=Error(r(422),{cause:x}),Co(Gr(s,p)))):(x!==Cc&&(c=Error(r(423),{cause:x}),Co(Gr(c,p))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,x=Gr(x,p),N=Mf(s.stateNode,x,N),Aa(s,N),gr!==4&&(gr=2)),!1;var A=Error(r(520),{cause:x});if(A=Gr(A,p),pd===null?pd=[A]:pd.push(A),gr!==4&&(gr=2),c===null)return!0;x=Gr(x,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,s=N&-N,p.lanes|=s,s=Mf(p.stateNode,x,s),Aa(p,s),!1;case 1:if(c=p.type,A=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Oo===null||!Oo.has(A))))return p.flags|=65536,N&=-N,p.lanes|=N,N=Mp(N),Jg(N,s,p,x),Aa(p,N),!1}p=p.return}while(p!==null);return!1}var Xg=Error(r(461)),Or=!1;function Zn(s,c,p,x){c.child=s===null?Gg(c,null,p,x):Rl(c,s.child,p,x)}function Of(s,c,p,x,N){p=p.render;var A=c.ref;if("ref"in x){var q={};for(var ee in x)ee!=="ref"&&(q[ee]=x[ee])}else q=x;return Cl(c),x=pp(s,c,p,q,A,N),ee=gp(),s!==null&&!Or?(El(s,c,N),qs(s,c,N)):(cn&&ee&&op(c),c.flags|=1,Zn(s,c,x,N),c.child)}function Lf(s,c,p,x,N){if(s===null){var A=p.type;return typeof A=="function"&&!hr(A)&&A.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=A,Ff(s,c,A,x,N)):(s=df(p.type,null,x,c,c.mode,N),s.ref=c.ref,s.return=c,c.child=s)}if(A=s.child,!Ia(s,N)){var q=A.memoizedProps;if(p=p.compare,p=p!==null?p:ii,p(q,x)&&s.ref===c.ref)return qs(s,c,N)}return c.flags|=1,s=Kn(A,x),s.ref=c.ref,s.return=c,c.child=s}function Ff(s,c,p,x,N){if(s!==null){var A=s.memoizedProps;if(ii(A,x)&&s.ref===c.ref)if(Or=!1,c.pendingProps=x=A,Ia(s,N))(s.flags&131072)!==0&&(Or=!0);else return c.lanes=s.lanes,qs(s,c,N)}return Ic(s,c,p,x,N)}function ad(s,c,p){var x=c.pendingProps,N=x.children,A=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=A!==null?A.baseLanes|p:p,s!==null){for(N=c.child=s.child,A=0;N!==null;)A=A|N.lanes|N.childLanes,N=N.sibling;c.childLanes=A&~x}else c.childLanes=0,c.child=null;return Ol(s,c,x,p)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&mf(c,A!==null?A.cachePool:null),A!==null?$s(c,A):xf(),Yg(c);else return c.lanes=c.childLanes=536870912,Ol(s,c,A!==null?A.baseLanes|p:p,p)}else A!==null?(mf(c,A.cachePool),$s(c,A),Bs(),c.memoizedState=null):(s!==null&&mf(c,null),xf(),Bs());return Zn(s,c,N,p),c.child}function Ol(s,c,p,x){var N=Ls();return N=N===null?null:{parent:Vn._currentValue,pool:N},c.memoizedState={baseLanes:p,cachePool:N},s!==null&&mf(c,null),xf(),Yg(c),s!==null&&Lu(s,c,x,!0),null}function Tt(s,c){var p=c.ref;if(p===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(c.flags|=4194816)}}function Ic(s,c,p,x,N){return Cl(c),p=pp(s,c,p,x,void 0,N),x=gp(),s!==null&&!Or?(El(s,c,N),qs(s,c,N)):(cn&&x&&op(c),c.flags|=1,Zn(s,c,p,N),c.child)}function $f(s,c,p,x,N,A){return Cl(c),c.updateQueue=null,p=Ig(c,x,p,N),Dg(s),x=gp(),s!==null&&!Or?(El(s,c,A),qs(s,c,A)):(cn&&x&&op(c),c.flags|=1,Zn(s,c,p,A),c.child)}function Po(s,c,p,x,N){if(Cl(c),c.stateNode===null){var A=dt,q=p.contextType;typeof q=="object"&&q!==null&&(A=pr(q)),A=new p(x,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=nd,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=x,A.state=c.memoizedState,A.refs={},jl(c),q=p.contextType,A.context=typeof q=="object"&&q!==null?pr(q):dt,A.state=c.memoizedState,q=p.getDerivedStateFromProps,typeof q=="function"&&(Dc(c,p,q,x),A.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(q=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),q!==A.state&&nd.enqueueReplaceState(A,A.state,null),ai(c,x,A,N),Pa(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){A=c.stateNode;var ee=c.memoizedProps,we=Ao(p,ee);A.props=we;var ze=A.context,Xe=p.contextType;q=dt,typeof Xe=="object"&&Xe!==null&&(q=pr(Xe));var nt=p.getDerivedStateFromProps;Xe=typeof nt=="function"||typeof A.getSnapshotBeforeUpdate=="function",ee=c.pendingProps!==ee,Xe||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(ee||ze!==q)&&Wg(c,A,x,q),ss=!1;var Be=c.memoizedState;A.state=Be,ai(c,x,A,N),Pa(),ze=c.memoizedState,ee||Be!==ze||ss?(typeof nt=="function"&&(Dc(c,p,nt,x),ze=c.memoizedState),(we=ss||rd(c,p,we,x,Be,ze,q))?(Xe||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=ze),A.props=x,A.state=ze,A.context=q,x=we):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{A=c.stateNode,kc(s,c),q=c.memoizedProps,Xe=Ao(p,q),A.props=Xe,nt=c.pendingProps,Be=A.context,ze=p.contextType,we=dt,typeof ze=="object"&&ze!==null&&(we=pr(ze)),ee=p.getDerivedStateFromProps,(ze=typeof ee=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(q!==nt||Be!==we)&&Wg(c,A,x,we),ss=!1,Be=c.memoizedState,A.state=Be,ai(c,x,A,N),Pa();var Ue=c.memoizedState;q!==nt||Be!==Ue||ss||s!==null&&s.dependencies!==null&&hf(s.dependencies)?(typeof ee=="function"&&(Dc(c,p,ee,x),Ue=c.memoizedState),(Xe=ss||rd(c,p,Xe,x,Be,Ue,we)||s!==null&&s.dependencies!==null&&hf(s.dependencies))?(ze||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(x,Ue,we),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(x,Ue,we)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||q===s.memoizedProps&&Be===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&Be===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Ue),A.props=x,A.state=Ue,A.context=we,x=Xe):(typeof A.componentDidUpdate!="function"||q===s.memoizedProps&&Be===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&Be===s.memoizedState||(c.flags|=1024),x=!1)}return A=x,Tt(s,c),x=(c.flags&128)!==0,A||x?(A=c.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,s!==null&&x?(c.child=Rl(c,s.child,null,N),c.child=Rl(c,null,p,N)):Zn(s,c,p,N),c.memoizedState=A.state,s=c.child):s=qs(s,c,N),s}function Zg(s,c,p,x){return Ou(),c.flags|=256,Zn(s,c,p,x),c.child}var sd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zf(s){return{baseLanes:s,cachePool:_g()}}function Lr(s,c,p){return s=s!==null?s.childLanes&~p:0,c&&(s|=oa),s}function ey(s,c,p){var x=c.pendingProps,N=!1,A=(c.flags&128)!==0,q;if((q=A)||(q=s!==null&&s.memoizedState===null?!1:(mr.current&2)!==0),q&&(N=!0,c.flags&=-129),q=(c.flags&32)!==0,c.flags&=-33,s===null){if(cn){if(N?aa(c):Bs(),cn){var ee=ir,we;if(we=ee){e:{for(we=ee,ee=wi;we.nodeType!==8;){if(!ee){ee=null;break e}if(we=Ma(we.nextSibling),we===null){ee=null;break e}}ee=we}ee!==null?(c.memoizedState={dehydrated:ee,treeContext:Xn!==null?{id:rr,overflow:Os}:null,retryLane:536870912,hydrationErrors:null},we=yt(18,null,null,0),we.stateNode=ee,we.return=c,c.child=we,jr=c,ir=null,we=!0):we=!1}we||na(c)}if(ee=c.memoizedState,ee!==null&&(ee=ee.dehydrated,ee!==null))return yi(ee)?c.lanes=32:c.lanes=536870912,null;ls(c)}return ee=x.children,x=x.fallback,N?(Bs(),N=c.mode,ee=od({mode:"hidden",children:ee},N),x=wl(x,N,p,null),ee.return=c,x.return=c,ee.sibling=x,c.child=ee,N=c.child,N.memoizedState=zf(p),N.childLanes=Lr(s,q,p),c.memoizedState=sd,x):(aa(c),Op(c,ee))}if(we=s.memoizedState,we!==null&&(ee=we.dehydrated,ee!==null)){if(A)c.flags&256?(aa(c),c.flags&=-257,c=Lp(s,c,p)):c.memoizedState!==null?(Bs(),c.child=s.child,c.flags|=128,c=null):(Bs(),N=x.fallback,ee=c.mode,x=od({mode:"visible",children:x.children},ee),N=wl(N,ee,p,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,Rl(c,s.child,null,p),x=c.child,x.memoizedState=zf(p),x.childLanes=Lr(s,q,p),c.memoizedState=sd,c=N);else if(aa(c),yi(ee)){if(q=ee.nextSibling&&ee.nextSibling.dataset,q)var ze=q.dgst;q=ze,x=Error(r(419)),x.stack="",x.digest=q,Co({value:x,source:null,stack:null}),c=Lp(s,c,p)}else if(Or||Lu(s,c,p,!1),q=(p&s.childLanes)!==0,Or||q){if(q=Wn,q!==null&&(x=p&-p,x=(x&42)!==0?1:Yt(x),x=(x&(q.suspendedLanes|p))!==0?0:x,x!==0&&x!==we.retryLane))throw we.retryLane=x,ce(s,x),Gi(q,s,x),Xg;ee.data==="$?"||em(),c=Lp(s,c,p)}else ee.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=we.treeContext,ir=Ma(ee.nextSibling),jr=c,cn=!0,Ea=null,wi=!1,s!==null&&(ea[ta++]=rr,ea[ta++]=Os,ea[ta++]=Xn,rr=s.id,Os=s.overflow,Xn=c),c=Op(c,x.children),c.flags|=4096);return c}return N?(Bs(),N=x.fallback,ee=c.mode,we=s.child,ze=we.sibling,x=Kn(we,{mode:"hidden",children:x.children}),x.subtreeFlags=we.subtreeFlags&65011712,ze!==null?N=Kn(ze,N):(N=wl(N,ee,p,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,ee=s.child.memoizedState,ee===null?ee=zf(p):(we=ee.cachePool,we!==null?(ze=Vn._currentValue,we=we.parent!==ze?{parent:ze,pool:ze}:we):we=_g(),ee={baseLanes:ee.baseLanes|p,cachePool:we}),N.memoizedState=ee,N.childLanes=Lr(s,q,p),c.memoizedState=sd,x):(aa(c),p=s.child,s=p.sibling,p=Kn(p,{mode:"visible",children:x.children}),p.return=c,p.sibling=null,s!==null&&(q=c.deletions,q===null?(c.deletions=[s],c.flags|=16):q.push(s)),c.child=p,c.memoizedState=null,p)}function Op(s,c){return c=od({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function od(s,c){return s=yt(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Lp(s,c,p){return Rl(c,s.child,null,p),s=Op(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Fp(s,c,p){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),Si(s.return,c,p)}function $p(s,c,p,x,N){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:N}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=x,A.tail=p,A.tailMode=N)}function ty(s,c,p){var x=c.pendingProps,N=x.revealOrder,A=x.tail;if(Zn(s,c,x.children,p),x=mr.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Fp(s,p,c);else if(s.tag===19)Fp(s,p,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(D(mr,x),N){case"forwards":for(p=c.child,N=null;p!==null;)s=p.alternate,s!==null&&td(s)===null&&(N=p),p=p.sibling;p=N,p===null?(N=c.child,c.child=null):(N=p.sibling,p.sibling=null),$p(c,!1,N,p,A);break;case"backwards":for(p=null,N=c.child,c.child=null;N!==null;){if(s=N.alternate,s!==null&&td(s)===null){c.child=N;break}s=N.sibling,N.sibling=p,p=N,N=s}$p(c,!0,p,null,A);break;case"together":$p(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function qs(s,c,p){if(s!==null&&(c.dependencies=s.dependencies),Mo|=c.lanes,(p&c.childLanes)===0)if(s!==null){if(Lu(s,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,p=Kn(s,s.pendingProps),c.child=p,p.return=c;s.sibling!==null;)s=s.sibling,p=p.sibling=Kn(s,s.pendingProps),p.return=c;p.sibling=null}return c.child}function Ia(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&hf(s)))}function gi(s,c,p){switch(c.tag){case 3:J(c,c.stateNode.containerInfo),Ui(c,Vn,s.memoizedState.cache),Ou();break;case 27:case 5:He(c);break;case 4:J(c,c.stateNode.containerInfo);break;case 10:Ui(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(aa(c),c.flags|=128,null):(p&c.child.childLanes)!==0?ey(s,c,p):(aa(c),s=qs(s,c,p),s!==null?s.sibling:null);aa(c);break;case 19:var N=(s.flags&128)!==0;if(x=(p&c.childLanes)!==0,x||(Lu(s,c,p,!1),x=(p&c.childLanes)!==0),N){if(x)return ty(s,c,p);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),D(mr,mr.current),x)break;return null;case 22:case 23:return c.lanes=0,ad(s,c,p);case 24:Ui(c,Vn,s.memoizedState.cache)}return qs(s,c,p)}function Uf(s,c,p){if(s!==null)if(s.memoizedProps!==c.pendingProps)Or=!0;else{if(!Ia(s,p)&&(c.flags&128)===0)return Or=!1,gi(s,c,p);Or=(s.flags&131072)!==0}else Or=!1,cn&&(c.flags&1048576)!==0&&sp(c,Iu,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")hr(x)?(s=Ao(x,s),c.tag=1,c=Po(null,c,x,s,p)):(c.tag=0,c=Ic(null,c,x,s,p));else{if(x!=null){if(N=x.$$typeof,N===z){c.tag=11,c=Of(null,c,x,s,p);break e}else if(N===U){c.tag=14,c=Lf(null,c,x,s,p);break e}}throw c=ie(x)||x,Error(r(306,c,""))}}return c;case 0:return Ic(s,c,c.type,c.pendingProps,p);case 1:return x=c.type,N=Ao(x,c.pendingProps),Po(s,c,x,N,p);case 3:e:{if(J(c,c.stateNode.containerInfo),s===null)throw Error(r(387));x=c.pendingProps;var A=c.memoizedState;N=A.element,kc(s,c),ai(c,x,null,p);var q=c.memoizedState;if(x=q.cache,Ui(c,Vn,x),x!==A.cache&&tn(c,[Vn],p,!0),Pa(),x=q.element,A.isDehydrated)if(A={element:x,isDehydrated:!1,cache:q.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=Zg(s,c,x,p);break e}else if(x!==N){N=Gr(Error(r(424)),c),Co(N),c=Zg(s,c,x,p);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ir=Ma(s.firstChild),jr=c,cn=!0,Ea=null,wi=!0,p=Gg(c,null,x,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Ou(),x===N){c=qs(s,c,p);break e}Zn(s,c,x,p)}c=c.child}return c;case 26:return Tt(s,c),s===null?(p=Ky(c.type,null,c.pendingProps,null))?c.memoizedState=p:cn||(p=c.type,s=c.pendingProps,x=$l(te.current).createElement(p),x[En]=c,x[wr]=s,Ar(x,p,s),Sr(x),c.stateNode=x):c.memoizedState=Ky(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return He(c),s===null&&cn&&(x=c.stateNode=Wy(c.type,c.pendingProps,te.current),jr=c,wi=!0,N=ir,la(c.type)?(fm=N,ir=Ma(x.firstChild)):ir=N),Zn(s,c,c.pendingProps.children,p),Tt(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&cn&&((N=x=ir)&&(x=Gy(x,c.type,c.pendingProps,wi),x!==null?(c.stateNode=x,jr=c,ir=Ma(x.firstChild),wi=!1,N=!0):N=!1),N||na(c)),He(c),N=c.type,A=c.pendingProps,q=s!==null?s.memoizedProps:null,x=A.children,ih(N,A)?x=null:q!==null&&ih(N,q)&&(c.flags|=32),c.memoizedState!==null&&(N=pp(s,c,mp,null,null,p),Xc._currentValue=N),Tt(s,c),Zn(s,c,x,p),c.child;case 6:return s===null&&cn&&((s=p=ir)&&(p=sh(p,c.pendingProps,wi),p!==null?(c.stateNode=p,jr=c,ir=null,s=!0):s=!1),s||na(c)),null;case 13:return ey(s,c,p);case 4:return J(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=Rl(c,null,x,p):Zn(s,c,x,p),c.child;case 11:return Of(s,c,c.type,c.pendingProps,p);case 7:return Zn(s,c,c.pendingProps,p),c.child;case 8:return Zn(s,c,c.pendingProps.children,p),c.child;case 12:return Zn(s,c,c.pendingProps.children,p),c.child;case 10:return x=c.pendingProps,Ui(c,c.type,x.value),Zn(s,c,x.children,p),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,Cl(c),N=pr(N),x=x(N),c.flags|=1,Zn(s,c,x,p),c.child;case 14:return Lf(s,c,c.type,c.pendingProps,p);case 15:return Ff(s,c,c.type,c.pendingProps,p);case 19:return ty(s,c,p);case 31:return x=c.pendingProps,p=c.mode,x={mode:x.mode,children:x.children},s===null?(p=od(x,p),p.ref=c.ref,c.child=p,p.return=c,c=p):(p=Kn(s.child,x),p.ref=c.ref,c.child=p,p.return=c,c=p),c;case 22:return ad(s,c,p);case 24:return Cl(c),x=pr(Vn),s===null?(N=Ls(),N===null&&(N=Wn,A=lp(),N.pooledCache=A,A.refCount++,A!==null&&(N.pooledCacheLanes|=p),N=A),c.memoizedState={parent:x,cache:N},jl(c),Ui(c,Vn,N)):((s.lanes&p)!==0&&(kc(s,c),ai(c,null,null,p),Pa()),N=s.memoizedState,A=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),Ui(c,Vn,x)):(x=A.cache,Ui(c,Vn,x),x!==N.cache&&tn(c,[Vn],p,!0))),Zn(s,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Vs(s){s.flags|=4}function Bf(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Pr(c)){if(c=qi.current,c!==null&&((xn&4194048)===xn?mi!==null:(xn&62914560)!==xn&&(xn&536870912)===0||c!==mi))throw jc=up,jg;s.flags|=8192}}function qf(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?Ct():536870912,s.lanes|=c,zc|=c)}function ld(s,c){if(!cn)switch(s.tailMode){case"hidden":c=s.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Hn(s){var c=s.alternate!==null&&s.alternate.child===s.child,p=0,x=0;if(c)for(var N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=x,s.childLanes=p,c}function ny(s,c,p){var x=c.pendingProps;switch(Ru(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(c),null;case 1:return Hn(c),null;case 3:return p=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),ra(Vn),ye(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Mu(c)?Vs(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,wg())),Hn(c),null;case 26:return p=c.memoizedState,s===null?(Vs(c),p!==null?(Hn(c),Bf(c,p)):(Hn(c),c.flags&=-16777217)):p?p!==s.memoizedState?(Vs(c),Hn(c),Bf(c,p)):(Hn(c),c.flags&=-16777217):(s.memoizedProps!==x&&Vs(c),Hn(c),c.flags&=-16777217),null;case 27:Q(c),p=te.current;var N=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Vs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Hn(c),null}s=pe.current,Mu(c)?bg(c):(s=Wy(N,x,p),c.stateNode=s,Vs(c))}return Hn(c),null;case 5:if(Q(c),p=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Vs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Hn(c),null}if(s=pe.current,Mu(c))bg(c);else{switch(N=$l(te.current),s){case 1:s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?N.createElement(p,{is:x.is}):N.createElement(p)}}s[En]=c,s[wr]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)s.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=s;e:switch(Ar(s,p,x),p){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Vs(c)}}return Hn(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&Vs(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(s=te.current,Mu(c)){if(s=c.stateNode,p=c.memoizedProps,x=null,N=jr,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}s[En]=c,s=!!(s.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||By(s.nodeValue,p)),s||na(c)}else s=$l(s).createTextNode(x),s[En]=c,c.stateNode=s}return Hn(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=Mu(c),x!==null&&x.dehydrated!==null){if(s===null){if(!N)throw Error(r(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[En]=c}else Ou(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Hn(c),N=!1}else N=wg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(ls(c),c):(ls(c),null)}if(ls(c),(c.flags&128)!==0)return c.lanes=p,c;if(p=x!==null,s=s!==null&&s.memoizedState!==null,p){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var A=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(A=x.memoizedState.cachePool.pool),A!==N&&(x.flags|=2048)}return p!==s&&p&&(c.child.flags|=8192),qf(c,c.updateQueue),Hn(c),null;case 4:return ye(),s===null&&lm(c.stateNode.containerInfo),Hn(c),null;case 10:return ra(c.type),Hn(c),null;case 19:if(he(mr),N=c.memoizedState,N===null)return Hn(c),null;if(x=(c.flags&128)!==0,A=N.rendering,A===null)if(x)ld(N,!1);else{if(gr!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(A=td(s),A!==null){for(c.flags|=128,ld(N,!1),s=A.updateQueue,c.updateQueue=s,qf(c,s),c.subtreeFlags=0,s=p,p=c.child;p!==null;)vl(p,s),p=p.sibling;return D(mr,mr.current&1|2),c.child}s=s.sibling}N.tail!==null&&Ye()>Uc&&(c.flags|=128,x=!0,ld(N,!1),c.lanes=4194304)}else{if(!x)if(s=td(A),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,qf(c,s),ld(N,!0),N.tail===null&&N.tailMode==="hidden"&&!A.alternate&&!cn)return Hn(c),null}else 2*Ye()-N.renderingStartTime>Uc&&p!==536870912&&(c.flags|=128,x=!0,ld(N,!1),c.lanes=4194304);N.isBackwards?(A.sibling=c.child,c.child=A):(s=N.last,s!==null?s.sibling=A:c.child=A,N.last=A)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=Ye(),c.sibling=null,s=mr.current,D(mr,x?s&1|2:s&1),c):(Hn(c),null);case 22:case 23:return ls(c),hp(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(p&536870912)!==0&&(c.flags&128)===0&&(Hn(c),c.subtreeFlags&6&&(c.flags|=8192)):Hn(c),p=c.updateQueue,p!==null&&qf(c,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==p&&(c.flags|=2048),s!==null&&he(_l),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),ra(Vn),Hn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function ry(s,c){switch(Ru(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return ra(Vn),ye(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return Q(c),null;case 13:if(ls(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Ou()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return he(mr),null;case 4:return ye(),null;case 10:return ra(c.type),null;case 22:case 23:return ls(c),hp(),s!==null&&he(_l),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return ra(Vn),null;case 25:return null;default:return null}}function iy(s,c){switch(Ru(c),c.tag){case 3:ra(Vn),ye();break;case 26:case 27:case 5:Q(c);break;case 4:ye();break;case 13:ls(c);break;case 19:he(mr);break;case 10:ra(c.type);break;case 22:case 23:ls(c),hp(),s!==null&&he(_l);break;case 24:ra(Vn)}}function cd(s,c){try{var p=c.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var N=x.next;p=N;do{if((p.tag&s)===s){x=void 0;var A=p.create,q=p.inst;x=A(),q.destroy=x}p=p.next}while(p!==N)}}catch(ee){Gn(c,c.return,ee)}}function Do(s,c,p){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var A=N.next;x=A;do{if((x.tag&s)===s){var q=x.inst,ee=q.destroy;if(ee!==void 0){q.destroy=void 0,N=c;var we=p,ze=ee;try{ze()}catch(Xe){Gn(N,we,Xe)}}}x=x.next}while(x!==A)}}catch(Xe){Gn(c,c.return,Xe)}}function ay(s){var c=s.updateQueue;if(c!==null){var p=s.stateNode;try{fp(c,p)}catch(x){Gn(s,s.return,x)}}}function zp(s,c,p){p.props=Ao(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(x){Gn(s,c,x)}}function Rc(s,c){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof p=="function"?s.refCleanup=p(x):p.current=x}}catch(N){Gn(s,c,N)}}function us(s,c){var p=s.ref,x=s.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(N){Gn(s,c,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(N){Gn(s,c,N)}else p.current=null}function Vf(s){var c=s.type,p=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(N){Gn(s,s.return,N)}}function Hf(s,c,p){try{var x=s.stateNode;vv(x,s.type,p,c),x[wr]=c}catch(N){Gn(s,s.return,N)}}function Mc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&la(s.type)||s.tag===4}function ud(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Mc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&la(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Gf(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(s,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(s),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=nh));else if(x!==4&&(x===27&&la(s.type)&&(p=s.stateNode,c=null),s=s.child,s!==null))for(Gf(s,c,p),s=s.sibling;s!==null;)Gf(s,c,p),s=s.sibling}function dd(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?p.insertBefore(s,c):p.appendChild(s);else if(x!==4&&(x===27&&la(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(dd(s,c,p),s=s.sibling;s!==null;)dd(s,c,p),s=s.sibling}function fd(s){var c=s.stateNode,p=s.memoizedProps;try{for(var x=s.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);Ar(c,x,p),c[En]=s,c[wr]=p}catch(A){Gn(s,s.return,A)}}var ds=!1,Dn=!1,Hs=!1,sy=typeof WeakSet=="function"?WeakSet:Set,Tr=null;function sv(s,c){if(s=s.containerInfo,Ra=uh,s=Au(s),Pu(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var N=x.anchorOffset,A=x.focusNode;x=x.focusOffset;try{p.nodeType,A.nodeType}catch{p=null;break e}var q=0,ee=-1,we=-1,ze=0,Xe=0,nt=s,Be=null;t:for(;;){for(var Ue;nt!==p||N!==0&&nt.nodeType!==3||(ee=q+N),nt!==A||x!==0&&nt.nodeType!==3||(we=q+x),nt.nodeType===3&&(q+=nt.nodeValue.length),(Ue=nt.firstChild)!==null;)Be=nt,nt=Ue;for(;;){if(nt===s)break t;if(Be===p&&++ze===N&&(ee=q),Be===A&&++Xe===x&&(we=q),(Ue=nt.nextSibling)!==null)break;nt=Be,Be=nt.parentNode}nt=Ue}p=ee===-1||we===-1?null:{start:ee,end:we}}else p=null}p=p||{start:0,end:0}}else p=null;for(rh={focusedElem:s,selectionRange:p},uh=!1,Tr=c;Tr!==null;)if(c=Tr,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,Tr=s;else for(;Tr!==null;){switch(c=Tr,A=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&A!==null){s=void 0,p=c,N=A.memoizedProps,A=A.memoizedState,x=p.stateNode;try{var Mt=Ao(p.type,N,p.elementType===p.type);s=x.getSnapshotBeforeUpdate(Mt,A),x.__reactInternalSnapshotBeforeUpdate=s}catch(Rt){Gn(p,p.return,Rt)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,p=s.nodeType,p===9)dm(s);else if(p===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":dm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=c.sibling,s!==null){s.return=c.return,Tr=s;break}Tr=c.return}}function oy(s,c,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:Io(s,p),x&4&&cd(5,p);break;case 1:if(Io(s,p),x&4)if(s=p.stateNode,c===null)try{s.componentDidMount()}catch(q){Gn(p,p.return,q)}else{var N=Ao(p.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(N,c,s.__reactInternalSnapshotBeforeUpdate)}catch(q){Gn(p,p.return,q)}}x&64&&ay(p),x&512&&Rc(p,p.return);break;case 3:if(Io(s,p),x&64&&(s=p.updateQueue,s!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{fp(s,c)}catch(q){Gn(p,p.return,q)}}break;case 27:c===null&&x&4&&fd(p);case 26:case 5:Io(s,p),c===null&&x&4&&Vf(p),x&512&&Rc(p,p.return);break;case 12:Io(s,p);break;case 13:Io(s,p),x&4&&uy(s,p),x&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Kf.bind(null,p),Yc(s,p))));break;case 22:if(x=p.memoizedState!==null||ds,!x){c=c!==null&&c.memoizedState!==null||Dn,N=ds;var A=Dn;ds=x,(Dn=c)&&!A?Ys(s,p,(p.subtreeFlags&8772)!==0):Io(s,p),ds=N,Dn=A}break;case 30:break;default:Io(s,p)}}function ly(s){var c=s.alternate;c!==null&&(s.alternate=null,ly(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&gu(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ar=null,ki=!1;function Gs(s,c,p){for(p=p.child;p!==null;)cy(s,c,p),p=p.sibling}function cy(s,c,p){if(fe&&typeof fe.onCommitFiberUnmount=="function")try{fe.onCommitFiberUnmount(X,p)}catch{}switch(p.tag){case 26:Dn||us(p,c),Gs(s,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Dn||us(p,c);var x=ar,N=ki;la(p.type)&&(ar=p.stateNode,ki=!1),Gs(s,c,p),Nd(p.stateNode),ar=x,ki=N;break;case 5:Dn||us(p,c);case 6:if(x=ar,N=ki,ar=null,Gs(s,c,p),ar=x,ki=N,ar!==null)if(ki)try{(ar.nodeType===9?ar.body:ar.nodeName==="HTML"?ar.ownerDocument.body:ar).removeChild(p.stateNode)}catch(A){Gn(p,c,A)}else try{ar.removeChild(p.stateNode)}catch(A){Gn(p,c,A)}break;case 18:ar!==null&&(ki?(s=ar,ah(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,p.stateNode),Pd(s)):ah(ar,p.stateNode));break;case 4:x=ar,N=ki,ar=p.stateNode.containerInfo,ki=!0,Gs(s,c,p),ar=x,ki=N;break;case 0:case 11:case 14:case 15:Dn||Do(2,p,c),Dn||Do(4,p,c),Gs(s,c,p);break;case 1:Dn||(us(p,c),x=p.stateNode,typeof x.componentWillUnmount=="function"&&zp(p,c,x)),Gs(s,c,p);break;case 21:Gs(s,c,p);break;case 22:Dn=(x=Dn)||p.memoizedState!==null,Gs(s,c,p),Dn=x;break;default:Gs(s,c,p)}}function uy(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Pd(s)}catch(p){Gn(c,c.return,p)}}function ov(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new sy),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new sy),c;default:throw Error(r(435,s.tag))}}function Up(s,c){var p=ov(s);c.forEach(function(x){var N=hv.bind(null,s,x);p.has(x)||(p.add(x),x.then(N,N))})}function Vi(s,c){var p=c.deletions;if(p!==null)for(var x=0;x<p.length;x++){var N=p[x],A=s,q=c,ee=q;e:for(;ee!==null;){switch(ee.tag){case 27:if(la(ee.type)){ar=ee.stateNode,ki=!1;break e}break;case 5:ar=ee.stateNode,ki=!1;break e;case 3:case 4:ar=ee.stateNode.containerInfo,ki=!0;break e}ee=ee.return}if(ar===null)throw Error(r(160));cy(A,q,N),ar=null,ki=!1,A=N.alternate,A!==null&&(A.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Bp(c,s),c=c.sibling}var sa=null;function Bp(s,c){var p=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Vi(c,s),Ti(s),x&4&&(Do(3,s,s.return),cd(3,s),Do(5,s,s.return));break;case 1:Vi(c,s),Ti(s),x&512&&(Dn||p===null||us(p,p.return)),x&64&&ds&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var N=sa;if(Vi(c,s),Ti(s),x&512&&(Dn||p===null||us(p,p.return)),x&4){var A=p!==null?p.memoizedState:null;if(x=s.memoizedState,p===null)if(x===null)if(s.stateNode===null){e:{x=s.type,p=s.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":A=N.getElementsByTagName("title")[0],(!A||A[Ss]||A[En]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=N.createElement(x),N.head.insertBefore(A,N.querySelector("head > title"))),Ar(A,x,p),A[En]=s,Sr(A),x=A;break e;case"link":var q=ex("link","href",N).get(x+(p.href||""));if(q){for(var ee=0;ee<q.length;ee++)if(A=q[ee],A.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&A.getAttribute("rel")===(p.rel==null?null:p.rel)&&A.getAttribute("title")===(p.title==null?null:p.title)&&A.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){q.splice(ee,1);break t}}A=N.createElement(x),Ar(A,x,p),N.head.appendChild(A);break;case"meta":if(q=ex("meta","content",N).get(x+(p.content||""))){for(ee=0;ee<q.length;ee++)if(A=q[ee],A.getAttribute("content")===(p.content==null?null:""+p.content)&&A.getAttribute("name")===(p.name==null?null:p.name)&&A.getAttribute("property")===(p.property==null?null:p.property)&&A.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&A.getAttribute("charset")===(p.charSet==null?null:p.charSet)){q.splice(ee,1);break t}}A=N.createElement(x),Ar(A,x,p),N.head.appendChild(A);break;default:throw Error(r(468,x))}A[En]=s,Sr(A),x=A}s.stateNode=x}else tx(N,s.type,s.stateNode);else s.stateNode=Zy(N,x,s.memoizedProps);else A!==x?(A===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):A.count--,x===null?tx(N,s.type,s.stateNode):Zy(N,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Hf(s,s.memoizedProps,p.memoizedProps)}break;case 27:Vi(c,s),Ti(s),x&512&&(Dn||p===null||us(p,p.return)),p!==null&&x&4&&Hf(s,s.memoizedProps,p.memoizedProps);break;case 5:if(Vi(c,s),Ti(s),x&512&&(Dn||p===null||us(p,p.return)),s.flags&32){N=s.stateNode;try{wa(N,"")}catch(Ue){Gn(s,s.return,Ue)}}x&4&&s.stateNode!=null&&(N=s.memoizedProps,Hf(s,N,p!==null?p.memoizedProps:N)),x&1024&&(Hs=!0);break;case 6:if(Vi(c,s),Ti(s),x&4){if(s.stateNode===null)throw Error(r(162));x=s.memoizedProps,p=s.stateNode;try{p.nodeValue=x}catch(Ue){Gn(s,s.return,Ue)}}break;case 3:if(Kc=null,N=sa,sa=Gt(c.containerInfo),Vi(c,s),sa=N,Ti(s),x&4&&p!==null&&p.memoizedState.isDehydrated)try{Pd(c.containerInfo)}catch(Ue){Gn(s,s.return,Ue)}Hs&&(Hs=!1,dy(s));break;case 4:x=sa,sa=Gt(s.stateNode.containerInfo),Vi(c,s),Ti(s),sa=x;break;case 12:Vi(c,s),Ti(s);break;case 13:Vi(c,s),Ti(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Qp=Ye()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Up(s,x)));break;case 22:N=s.memoizedState!==null;var we=p!==null&&p.memoizedState!==null,ze=ds,Xe=Dn;if(ds=ze||N,Dn=Xe||we,Vi(c,s),Dn=Xe,ds=ze,Ti(s),x&8192)e:for(c=s.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(p===null||we||ds||Dn||Ll(s)),p=null,c=s;;){if(c.tag===5||c.tag===26){if(p===null){we=p=c;try{if(A=we.stateNode,N)q=A.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{ee=we.stateNode;var nt=we.memoizedProps.style,Be=nt!=null&&nt.hasOwnProperty("display")?nt.display:null;ee.style.display=Be==null||typeof Be=="boolean"?"":(""+Be).trim()}}catch(Ue){Gn(we,we.return,Ue)}}}else if(c.tag===6){if(p===null){we=c;try{we.stateNode.nodeValue=N?"":we.memoizedProps}catch(Ue){Gn(we,we.return,Ue)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Up(s,p))));break;case 19:Vi(c,s),Ti(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Up(s,x)));break;case 30:break;case 21:break;default:Vi(c,s),Ti(s)}}function Ti(s){var c=s.flags;if(c&2){try{for(var p,x=s.return;x!==null;){if(Mc(x)){p=x;break}x=x.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var N=p.stateNode,A=ud(s);dd(s,A,N);break;case 5:var q=p.stateNode;p.flags&32&&(wa(q,""),p.flags&=-33);var ee=ud(s);dd(s,ee,q);break;case 3:case 4:var we=p.stateNode.containerInfo,ze=ud(s);Gf(s,ze,we);break;default:throw Error(r(161))}}catch(Xe){Gn(s,s.return,Xe)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function dy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;dy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function Io(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)oy(s,c.alternate,c),c=c.sibling}function Ll(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:Do(4,c,c.return),Ll(c);break;case 1:us(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&zp(c,c.return,p),Ll(c);break;case 27:Nd(c.stateNode);case 26:case 5:us(c,c.return),Ll(c);break;case 22:c.memoizedState===null&&Ll(c);break;case 30:Ll(c);break;default:Ll(c)}s=s.sibling}}function Ys(s,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=s,A=c,q=A.flags;switch(A.tag){case 0:case 11:case 15:Ys(N,A,p),cd(4,A);break;case 1:if(Ys(N,A,p),x=A,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(ze){Gn(x,x.return,ze)}if(x=A,N=x.updateQueue,N!==null){var ee=x.stateNode;try{var we=N.shared.hiddenCallbacks;if(we!==null)for(N.shared.hiddenCallbacks=null,N=0;N<we.length;N++)Ag(we[N],ee)}catch(ze){Gn(x,x.return,ze)}}p&&q&64&&ay(A),Rc(A,A.return);break;case 27:fd(A);case 26:case 5:Ys(N,A,p),p&&x===null&&q&4&&Vf(A),Rc(A,A.return);break;case 12:Ys(N,A,p);break;case 13:Ys(N,A,p),p&&q&4&&uy(N,A);break;case 22:A.memoizedState===null&&Ys(N,A,p),Rc(A,A.return);break;case 30:break;default:Ys(N,A,p)}c=c.sibling}}function qp(s,c){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&Fu(p))}function Vp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Fu(s))}function fs(s,c,p,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)fy(s,c,p,x),c=c.sibling}function fy(s,c,p,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:fs(s,c,p,x),N&2048&&cd(9,c);break;case 1:fs(s,c,p,x);break;case 3:fs(s,c,p,x),N&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Fu(s)));break;case 12:if(N&2048){fs(s,c,p,x),s=c.stateNode;try{var A=c.memoizedProps,q=A.id,ee=A.onPostCommit;typeof ee=="function"&&ee(q,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(we){Gn(c,c.return,we)}}else fs(s,c,p,x);break;case 13:fs(s,c,p,x);break;case 23:break;case 22:A=c.stateNode,q=c.alternate,c.memoizedState!==null?A._visibility&2?fs(s,c,p,x):hd(s,c):A._visibility&2?fs(s,c,p,x):(A._visibility|=2,Oc(s,c,p,x,(c.subtreeFlags&10256)!==0)),N&2048&&qp(q,c);break;case 24:fs(s,c,p,x),N&2048&&Vp(c.alternate,c);break;default:fs(s,c,p,x)}}function Oc(s,c,p,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=s,q=c,ee=p,we=x,ze=q.flags;switch(q.tag){case 0:case 11:case 15:Oc(A,q,ee,we,N),cd(8,q);break;case 23:break;case 22:var Xe=q.stateNode;q.memoizedState!==null?Xe._visibility&2?Oc(A,q,ee,we,N):hd(A,q):(Xe._visibility|=2,Oc(A,q,ee,we,N)),N&&ze&2048&&qp(q.alternate,q);break;case 24:Oc(A,q,ee,we,N),N&&ze&2048&&Vp(q.alternate,q);break;default:Oc(A,q,ee,we,N)}c=c.sibling}}function hd(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=s,x=c,N=x.flags;switch(x.tag){case 22:hd(p,x),N&2048&&qp(x.alternate,x);break;case 24:hd(p,x),N&2048&&Vp(x.alternate,x);break;default:hd(p,x)}c=c.sibling}}var oi=8192;function Lc(s){if(s.subtreeFlags&oi)for(s=s.child;s!==null;)hy(s),s=s.sibling}function hy(s){switch(s.tag){case 26:Lc(s),s.flags&oi&&s.memoizedState!==null&&Dv(sa,s.memoizedState,s.memoizedProps);break;case 5:Lc(s);break;case 3:case 4:var c=sa;sa=Gt(s.stateNode.containerInfo),Lc(s),sa=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=oi,oi=16777216,Lc(s),oi=c):Lc(s));break;default:Lc(s)}}function py(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Fc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Tr=x,gy(x,s)}py(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)my(s),s=s.sibling}function my(s){switch(s.tag){case 0:case 11:case 15:Fc(s),s.flags&2048&&Do(9,s,s.return);break;case 3:Fc(s);break;case 12:Fc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,Yf(s)):Fc(s);break;default:Fc(s)}}function Yf(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Tr=x,gy(x,s)}py(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:Do(8,c,c.return),Yf(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,Yf(c));break;default:Yf(c)}s=s.sibling}}function gy(s,c){for(;Tr!==null;){var p=Tr;switch(p.tag){case 0:case 11:case 15:Do(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Fu(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,Tr=x;else e:for(p=s;Tr!==null;){x=Tr;var N=x.sibling,A=x.return;if(ly(x),x===p){Tr=null;break e}if(N!==null){N.return=A,Tr=N;break e}Tr=A}}}var lv={getCacheForType:function(s){var c=pr(Vn),p=c.data.get(s);return p===void 0&&(p=s(),c.data.set(s,p)),p}},Hp=typeof WeakMap=="function"?WeakMap:Map,Rn=0,Wn=null,sn=null,xn=0,Mn=0,Hi=null,Ro=!1,$c=!1,Gp=!1,Ws=0,gr=0,Mo=0,Fl=0,Yp=0,oa=0,zc=0,pd=null,Ei=null,Wp=!1,Qp=0,Uc=1/0,md=null,Oo=null,Yr=0,Lo=null,Bc=null,qc=0,Jp=0,Kp=null,yy=null,Vc=0,Xp=null;function li(){if((Rn&2)!==0&&xn!==0)return xn&-xn;if(Y.T!==null){var s=_c;return s!==0?s:eh()}return Jn()}function xy(){oa===0&&(oa=(xn&536870912)===0||cn?mt():536870912);var s=qi.current;return s!==null&&(s.flags|=32),oa}function Gi(s,c,p){(s===Wn&&(Mn===2||Mn===9)||s.cancelPendingCommit!==null)&&(Hc(s,0),Fo(s,xn,oa,!1)),dn(s,p),((Rn&2)===0||s!==Wn)&&(s===Wn&&((Rn&2)===0&&(Fl|=p),gr===4&&Fo(s,xn,oa,!1)),hs(s))}function by(s,c,p){if((Rn&6)!==0)throw Error(r(327));var x=!p&&(c&124)===0&&(c&s.expiredLanes)===0||Ve(s,c),N=x?dv(s,c):tm(s,c,!0),A=x;do{if(N===0){$c&&!x&&Fo(s,c,0,!1);break}else{if(p=s.current.alternate,A&&!cv(p)){N=tm(s,c,!1),A=!1;continue}if(N===2){if(A=c,s.errorRecoveryDisabledLanes&A)var q=0;else q=s.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){c=q;e:{var ee=s;N=pd;var we=ee.current.memoizedState.isDehydrated;if(we&&(Hc(ee,q).flags|=256),q=tm(ee,q,!1),q!==2){if(Gp&&!we){ee.errorRecoveryDisabledLanes|=A,Fl|=A,N=4;break e}A=Ei,Ei=N,A!==null&&(Ei===null?Ei=A:Ei.push.apply(Ei,A))}N=q}if(A=!1,N!==2)continue}}if(N===1){Hc(s,0),Fo(s,c,0,!0);break}e:{switch(x=s,A=N,A){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Fo(x,c,oa,!Ro);break e;case 2:Ei=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(N=Qp+300-Ye(),10<N)){if(Fo(x,c,oa,!Ro),Ie(x,0,!0)!==0)break e;x.timeoutHandle=qy(vy.bind(null,x,p,Ei,md,Wp,c,oa,Fl,zc,Ro,A,2,-0,0),N);break e}vy(x,p,Ei,md,Wp,c,oa,Fl,zc,Ro,A,0,-0,0)}}break}while(!0);hs(s)}function vy(s,c,p,x,N,A,q,ee,we,ze,Xe,nt,Be,Ue){if(s.timeoutHandle=-1,nt=c.subtreeFlags,(nt&8192||(nt&16785408)===16785408)&&(Fr={stylesheets:null,count:0,unsuspend:Pv},hy(c),nt=Iv(),nt!==null)){s.cancelPendingCommit=nt(gd.bind(null,s,c,A,p,x,N,q,ee,we,Xe,1,Be,Ue)),Fo(s,A,q,!ze);return}gd(s,c,A,p,x,N,q,ee,we)}function cv(s){for(var c=s;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var N=p[x],A=N.getSnapshot;N=N.value;try{if(!ri(A(),N))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Fo(s,c,p,x){c&=~Yp,c&=~Fl,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var N=c;0<N;){var A=31-Je(N),q=1<<A;x[A]=-1,N&=~q}p!==0&&kt(s,p,c)}function Wf(){return(Rn&6)===0?(bd(0),!1):!0}function Zp(){if(sn!==null){if(Mn===0)var s=sn.return;else s=sn,Z=_o=null,bf(s),kr=null,ji=0,s=sn;for(;s!==null;)iy(s.alternate,s),s=s.return;sn=null}}function Hc(s,c){var p=s.timeoutHandle;p!==-1&&(s.timeoutHandle=-1,Sv(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Zp(),Wn=s,sn=p=Kn(s.current,null),xn=c,Mn=0,Hi=null,Ro=!1,$c=Ve(s,c),Gp=!1,zc=oa=Yp=Fl=Mo=gr=0,Ei=pd=null,Wp=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var N=31-Je(x),A=1<<N;c|=s[N],x&=~A}return Ws=c,as(),p}function wy(s,c){Kt=null,Y.H=Zu,c===pi||c===gf?(c=Tg(),Mn=3):c===jg?(c=Tg(),Mn=4):Mn=c===Xg?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Hi=c,sn===null&&(gr=1,id(s,Gr(c,s.current)))}function Sy(){var s=Y.H;return Y.H=Zu,s===null?Zu:s}function Ny(){var s=Y.A;return Y.A=lv,s}function em(){gr=4,Ro||(xn&4194048)!==xn&&qi.current!==null||($c=!0),(Mo&134217727)===0&&(Fl&134217727)===0||Wn===null||Fo(Wn,xn,oa,!1)}function tm(s,c,p){var x=Rn;Rn|=2;var N=Sy(),A=Ny();(Wn!==s||xn!==c)&&(md=null,Hc(s,c)),c=!1;var q=gr;e:do try{if(Mn!==0&&sn!==null){var ee=sn,we=Hi;switch(Mn){case 8:Zp(),q=6;break e;case 3:case 2:case 9:case 6:qi.current===null&&(c=!0);var ze=Mn;if(Mn=0,Hi=null,Gc(s,ee,we,ze),p&&$c){q=0;break e}break;default:ze=Mn,Mn=0,Hi=null,Gc(s,ee,we,ze)}}uv(),q=gr;break}catch(Xe){wy(s,Xe)}while(!0);return c&&s.shellSuspendCounter++,Z=_o=null,Rn=x,Y.H=N,Y.A=A,sn===null&&(Wn=null,xn=0,as()),q}function uv(){for(;sn!==null;)nm(sn)}function dv(s,c){var p=Rn;Rn|=2;var x=Sy(),N=Ny();Wn!==s||xn!==c?(md=null,Uc=Ye()+500,Hc(s,c)):$c=Ve(s,c);e:do try{if(Mn!==0&&sn!==null){c=sn;var A=Hi;t:switch(Mn){case 1:Mn=0,Hi=null,Gc(s,c,A,1);break;case 2:case 9:if(kg(A)){Mn=0,Hi=null,_y(c);break}c=function(){Mn!==2&&Mn!==9||Wn!==s||(Mn=7),hs(s)},A.then(c,c);break e;case 3:Mn=7;break e;case 4:Mn=5;break e;case 7:kg(A)?(Mn=0,Hi=null,_y(c)):(Mn=0,Hi=null,Gc(s,c,A,7));break;case 5:var q=null;switch(sn.tag){case 26:q=sn.memoizedState;case 5:case 27:var ee=sn;if(!q||Pr(q)){Mn=0,Hi=null;var we=ee.sibling;if(we!==null)sn=we;else{var ze=ee.return;ze!==null?(sn=ze,Qf(ze)):sn=null}break t}}Mn=0,Hi=null,Gc(s,c,A,5);break;case 6:Mn=0,Hi=null,Gc(s,c,A,6);break;case 8:Zp(),gr=6;break e;default:throw Error(r(462))}}Cy();break}catch(Xe){wy(s,Xe)}while(!0);return Z=_o=null,Y.H=x,Y.A=N,Rn=p,sn!==null?0:(Wn=null,xn=0,as(),gr)}function Cy(){for(;sn!==null&&!_e();)nm(sn)}function nm(s){var c=Uf(s.alternate,s,Ws);s.memoizedProps=s.pendingProps,c===null?Qf(s):sn=c}function _y(s){var c=s,p=c.alternate;switch(c.tag){case 15:case 0:c=$f(p,c,c.pendingProps,c.type,void 0,xn);break;case 11:c=$f(p,c,c.pendingProps,c.type.render,c.ref,xn);break;case 5:bf(c);default:iy(p,c),c=sn=vl(c,Ws),c=Uf(p,c,Ws)}s.memoizedProps=s.pendingProps,c===null?Qf(s):sn=c}function Gc(s,c,p,x){Z=_o=null,bf(c),kr=null,ji=0;var N=c.return;try{if(Kg(s,N,c,p,xn)){gr=1,id(s,Gr(p,s.current)),sn=null;return}}catch(A){if(N!==null)throw sn=N,A;gr=1,id(s,Gr(p,s.current)),sn=null;return}c.flags&32768?(cn||x===1?s=!0:$c||(xn&536870912)!==0?s=!1:(Ro=s=!0,(x===2||x===9||x===3||x===6)&&(x=qi.current,x!==null&&x.tag===13&&(x.flags|=16384))),jy(c,s)):Qf(c)}function Qf(s){var c=s;do{if((c.flags&32768)!==0){jy(c,Ro);return}s=c.return;var p=ny(c.alternate,c,Ws);if(p!==null){sn=p;return}if(c=c.sibling,c!==null){sn=c;return}sn=c=s}while(c!==null);gr===0&&(gr=5)}function jy(s,c){do{var p=ry(s.alternate,s);if(p!==null){p.flags&=32767,sn=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(s=s.sibling,s!==null)){sn=s;return}sn=s=p}while(s!==null);gr=6,sn=null}function gd(s,c,p,x,N,A,q,ee,we){s.cancelPendingCommit=null;do Jf();while(Yr!==0);if((Rn&6)!==0)throw Error(r(327));if(c!==null){if(c===s.current)throw Error(r(177));if(A=c.lanes|c.childLanes,A|=Sc,vn(s,p,A,q,ee,we),s===Wn&&(sn=Wn=null,xn=0),Bc=c,Lo=s,qc=p,Jp=A,Kp=N,yy=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ry(ue,function(){return Py(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=Y.T,Y.T=null,N=ne.p,ne.p=2,q=Rn,Rn|=4;try{sv(s,c,p)}finally{Rn=q,ne.p=N,Y.T=x}}Yr=1,ky(),Ty(),Ey()}}function ky(){if(Yr===1){Yr=0;var s=Lo,c=Bc,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=Y.T,Y.T=null;var x=ne.p;ne.p=2;var N=Rn;Rn|=4;try{Bp(c,s);var A=rh,q=Au(s.containerInfo),ee=A.focusedElem,we=A.selectionRange;if(q!==ee&&ee&&ee.ownerDocument&&cf(ee.ownerDocument.documentElement,ee)){if(we!==null&&Pu(ee)){var ze=we.start,Xe=we.end;if(Xe===void 0&&(Xe=ze),"selectionStart"in ee)ee.selectionStart=ze,ee.selectionEnd=Math.min(Xe,ee.value.length);else{var nt=ee.ownerDocument||document,Be=nt&&nt.defaultView||window;if(Be.getSelection){var Ue=Be.getSelection(),Mt=ee.textContent.length,Rt=Math.min(we.start,Mt),zn=we.end===void 0?Rt:Math.min(we.end,Mt);!Ue.extend&&Rt>zn&&(q=zn,zn=Rt,Rt=q);var Me=wc(ee,Rt),Ee=wc(ee,zn);if(Me&&Ee&&(Ue.rangeCount!==1||Ue.anchorNode!==Me.node||Ue.anchorOffset!==Me.offset||Ue.focusNode!==Ee.node||Ue.focusOffset!==Ee.offset)){var $e=nt.createRange();$e.setStart(Me.node,Me.offset),Ue.removeAllRanges(),Rt>zn?(Ue.addRange($e),Ue.extend(Ee.node,Ee.offset)):($e.setEnd(Ee.node,Ee.offset),Ue.addRange($e))}}}}for(nt=[],Ue=ee;Ue=Ue.parentNode;)Ue.nodeType===1&&nt.push({element:Ue,left:Ue.scrollLeft,top:Ue.scrollTop});for(typeof ee.focus=="function"&&ee.focus(),ee=0;ee<nt.length;ee++){var Ze=nt[ee];Ze.element.scrollLeft=Ze.left,Ze.element.scrollTop=Ze.top}}uh=!!Ra,rh=Ra=null}finally{Rn=N,ne.p=x,Y.T=p}}s.current=c,Yr=2}}function Ty(){if(Yr===2){Yr=0;var s=Lo,c=Bc,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=Y.T,Y.T=null;var x=ne.p;ne.p=2;var N=Rn;Rn|=4;try{oy(s,c.alternate,c)}finally{Rn=N,ne.p=x,Y.T=p}}Yr=3}}function Ey(){if(Yr===4||Yr===3){Yr=0,Ke();var s=Lo,c=Bc,p=qc,x=yy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Yr=5:(Yr=0,Bc=Lo=null,Ay(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(Oo=null),It(p),c=c.stateNode,fe&&typeof fe.onCommitFiberRoot=="function")try{fe.onCommitFiberRoot(X,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=Y.T,N=ne.p,ne.p=2,Y.T=null;try{for(var A=s.onRecoverableError,q=0;q<x.length;q++){var ee=x[q];A(ee.value,{componentStack:ee.stack})}}finally{Y.T=c,ne.p=N}}(qc&3)!==0&&Jf(),hs(s),N=s.pendingLanes,(p&4194090)!==0&&(N&42)!==0?s===Xp?Vc++:(Vc=0,Xp=s):Vc=0,bd(0)}}function Ay(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,Fu(c)))}function Jf(s){return ky(),Ty(),Ey(),Py()}function Py(){if(Yr!==5)return!1;var s=Lo,c=Jp;Jp=0;var p=It(qc),x=Y.T,N=ne.p;try{ne.p=32>p?32:p,Y.T=null,p=Kp,Kp=null;var A=Lo,q=qc;if(Yr=0,Bc=Lo=null,qc=0,(Rn&6)!==0)throw Error(r(331));var ee=Rn;if(Rn|=4,my(A.current),fy(A,A.current,q,p),Rn=ee,bd(0,!1),fe&&typeof fe.onPostCommitFiberRoot=="function")try{fe.onPostCommitFiberRoot(X,A)}catch{}return!0}finally{ne.p=N,Y.T=x,Ay(s,c)}}function Dy(s,c,p){c=Gr(p,c),c=Mf(s.stateNode,c,2),s=Fs(s,c,2),s!==null&&(dn(s,2),hs(s))}function Gn(s,c,p){if(s.tag===3)Dy(s,s,p);else for(;c!==null;){if(c.tag===3){Dy(c,s,p);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Oo===null||!Oo.has(x))){s=Gr(p,s),p=Mp(2),x=Fs(c,p,2),x!==null&&(Jg(p,x,c,s),dn(x,2),hs(x));break}}c=c.return}}function rm(s,c,p){var x=s.pingCache;if(x===null){x=s.pingCache=new Hp;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(p)||(Gp=!0,N.add(p),s=fv.bind(null,s,c,p),c.then(s,s))}function fv(s,c,p){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,Wn===s&&(xn&p)===p&&(gr===4||gr===3&&(xn&62914560)===xn&&300>Ye()-Qp?(Rn&2)===0&&Hc(s,0):Yp|=p,zc===xn&&(zc=0)),hs(s)}function Iy(s,c){c===0&&(c=Ct()),s=ce(s,c),s!==null&&(dn(s,c),hs(s))}function Kf(s){var c=s.memoizedState,p=0;c!==null&&(p=c.retryLane),Iy(s,p)}function hv(s,c){var p=0;switch(s.tag){case 13:var x=s.stateNode,N=s.memoizedState;N!==null&&(p=N.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),Iy(s,p)}function Ry(s,c){return Re(s,c)}var yd=null,$o=null,Xf=!1,xd=!1,Zf=!1,zo=0;function hs(s){s!==$o&&s.next===null&&($o===null?yd=$o=s:$o=$o.next=s),xd=!0,Xf||(Xf=!0,im())}function bd(s,c){if(!Zf&&xd){Zf=!0;do for(var p=!1,x=yd;x!==null;){if(s!==0){var N=x.pendingLanes;if(N===0)var A=0;else{var q=x.suspendedLanes,ee=x.pingedLanes;A=(1<<31-Je(42|s)+1)-1,A&=N&~(q&~ee),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(p=!0,Oy(x,A))}else A=xn,A=Ie(x,x===Wn?A:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(A&3)===0||Ve(x,A)||(p=!0,Oy(x,A));x=x.next}while(p);Zf=!1}}function pv(){vd()}function vd(){xd=Xf=!1;var s=0;zo!==0&&(wv()&&(s=zo),zo=0);for(var c=Ye(),p=null,x=yd;x!==null;){var N=x.next,A=wd(x,c);A===0?(x.next=null,p===null?yd=N:p.next=N,N===null&&($o=p)):(p=x,(s!==0||(A&3)!==0)&&(xd=!0)),x=N}bd(s)}function wd(s,c){for(var p=s.suspendedLanes,x=s.pingedLanes,N=s.expirationTimes,A=s.pendingLanes&-62914561;0<A;){var q=31-Je(A),ee=1<<q,we=N[q];we===-1?((ee&p)===0||(ee&x)!==0)&&(N[q]=st(ee,c)):we<=c&&(s.expiredLanes|=ee),A&=~ee}if(c=Wn,p=xn,p=Ie(s,s===c?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,p===0||s===c&&(Mn===2||Mn===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&Le(x),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||Ve(s,p)){if(c=p&-p,c===s.callbackPriority)return c;switch(x!==null&&Le(x),It(p)){case 2:case 8:p=Nt;break;case 32:p=ue;break;case 268435456:p=ke;break;default:p=ue}return x=My.bind(null,s),p=Re(p,x),s.callbackPriority=c,s.callbackNode=p,c}return x!==null&&x!==null&&Le(x),s.callbackPriority=2,s.callbackNode=null,2}function My(s,c){if(Yr!==0&&Yr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(Jf()&&s.callbackNode!==p)return null;var x=xn;return x=Ie(s,s===Wn?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(by(s,x,c),wd(s,Ye()),s.callbackNode!=null&&s.callbackNode===p?My.bind(null,s):null)}function Oy(s,c){if(Jf())return null;by(s,c,!0)}function im(){Nv(function(){(Rn&6)!==0?Re(xt,pv):vd()})}function eh(){return zo===0&&(zo=mt()),zo}function Ly(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ja(""+s)}function Fy(s,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,s.id&&p.setAttribute("form",s.id),c.parentNode.insertBefore(p,c),s=new FormData(s),p.parentNode.removeChild(p),s}function mv(s,c,p,x,N){if(c==="submit"&&p&&p.stateNode===N){var A=Ly((N[wr]||null).action),q=x.submitter;q&&(c=(c=q[wr]||null)?Ly(c.formAction):q.getAttribute("formAction"),c!==null&&(A=c,q=null));var ee=new cc("action","action",null,x,N);s.push({event:ee,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(zo!==0){var we=q?Fy(N,q):new FormData(N);Ku(p,{pending:!0,data:we,method:N.method,action:A},null,we)}}else typeof A=="function"&&(ee.preventDefault(),we=q?Fy(N,q):new FormData(N),Ku(p,{pending:!0,data:we,method:N.method,action:A},A,we))},currentTarget:N}]})}}for(var am=0;am<wn.length;am++){var sm=wn[am],gv=sm.toLowerCase(),yv=sm[0].toUpperCase()+sm.slice(1);zi(gv,"on"+yv)}zi(fi,"onAnimationEnd"),zi(uf,"onAnimationIteration"),zi(hi,"onAnimationStart"),zi("dblclick","onDoubleClick"),zi("focusin","onFocus"),zi("focusout","onBlur"),zi(yl,"onTransitionRun"),zi(ip,"onTransitionStart"),zi(So,"onTransitionCancel"),zi(xl,"onTransitionEnd"),ao("onMouseEnter",["mouseout","mouseover"]),ao("onMouseLeave",["mouseout","mouseover"]),ao("onPointerEnter",["pointerout","pointerover"]),ao("onPointerLeave",["pointerout","pointerover"]),js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),js("onBeforeInput",["compositionend","keypress","textInput","paste"]),js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sd));function $y(s,c){c=(c&4)!==0;for(var p=0;p<s.length;p++){var x=s[p],N=x.event;x=x.listeners;e:{var A=void 0;if(c)for(var q=x.length-1;0<=q;q--){var ee=x[q],we=ee.instance,ze=ee.currentTarget;if(ee=ee.listener,we!==A&&N.isPropagationStopped())break e;A=ee,N.currentTarget=ze;try{A(N)}catch(Xe){Ml(Xe)}N.currentTarget=null,A=we}else for(q=0;q<x.length;q++){if(ee=x[q],we=ee.instance,ze=ee.currentTarget,ee=ee.listener,we!==A&&N.isPropagationStopped())break e;A=ee,N.currentTarget=ze;try{A(N)}catch(Xe){Ml(Xe)}N.currentTarget=null,A=we}}}}function on(s,c){var p=c[ws];p===void 0&&(p=c[ws]=new Set);var x=s+"__bubble";p.has(x)||(zy(c,s,2,!1),p.add(x))}function om(s,c,p){var x=0;c&&(x|=4),zy(p,s,x,c)}var Ai="_reactListening"+Math.random().toString(36).slice(2);function lm(s){if(!s[Ai]){s[Ai]=!0,Xd.forEach(function(p){p!=="selectionchange"&&(xv.has(p)||om(p,!1,s),om(p,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[Ai]||(c[Ai]=!0,om("selectionchange",!1,c))}}function zy(s,c,p,x){switch(ax(c)){case 2:var N=Ov;break;case 8:N=Zc;break;default:N=xm}p=N.bind(null,c,p,s),N=void 0,!As||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?s.addEventListener(c,p,{capture:!0,passive:N}):s.addEventListener(c,p,!0):N!==void 0?s.addEventListener(c,p,{passive:N}):s.addEventListener(c,p,!1)}function Qs(s,c,p,x,N){var A=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var q=x.tag;if(q===3||q===4){var ee=x.stateNode.containerInfo;if(ee===N)break;if(q===4)for(q=x.return;q!==null;){var we=q.tag;if((we===3||we===4)&&q.stateNode.containerInfo===N)return;q=q.return}for(;ee!==null;){if(q=ba(ee),q===null)return;if(we=q.tag,we===5||we===6||we===26||we===27){x=A=q;continue e}ee=ee.parentNode}}x=x.return}lc(function(){var ze=A,Xe=co(p),nt=[];e:{var Be=bl.get(s);if(Be!==void 0){var Ue=cc,Mt=s;switch(s){case"keypress":if(_n(p)===0)break e;case"keydown":case"keyup":Ue=Cu;break;case"focusin":Mt="focus",Ue=fl;break;case"focusout":Mt="blur",Ue=fl;break;case"beforeblur":case"afterblur":Ue=fl;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=Ca;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=dc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=_u;break;case fi:case uf:case hi:Ue=pl;break;case xl:Ue=po;break;case"scroll":case"scrollend":Ue=dl;break;case"wheel":Ue=tp;break;case"copy":case"cut":case"paste":Ue=fc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=ni;break;case"toggle":case"beforetoggle":Ue=ts}var Rt=(c&4)!==0,zn=!Rt&&(s==="scroll"||s==="scrollend"),Me=Rt?Be!==null?Be+"Capture":null:Be;Rt=[];for(var Ee=ze,$e;Ee!==null;){var Ze=Ee;if($e=Ze.stateNode,Ze=Ze.tag,Ze!==5&&Ze!==26&&Ze!==27||$e===null||Me===null||(Ze=Es(Ee,Me),Ze!=null&&Rt.push(Bt(Ee,Ze,$e))),zn)break;Ee=Ee.return}0<Rt.length&&(Be=new Ue(Be,Mt,null,p,Xe),nt.push({event:Be,listeners:Rt}))}}if((c&7)===0){e:{if(Be=s==="mouseover"||s==="pointerover",Ue=s==="mouseout"||s==="pointerout",Be&&p!==Ka&&(Mt=p.relatedTarget||p.fromElement)&&(ba(Mt)||Mt[Jr]))break e;if((Ue||Be)&&(Be=Xe.window===Xe?Xe:(Be=Xe.ownerDocument)?Be.defaultView||Be.parentWindow:window,Ue?(Mt=p.relatedTarget||p.toElement,Ue=ze,Mt=Mt?ba(Mt):null,Mt!==null&&(zn=o(Mt),Rt=Mt.tag,Mt!==zn||Rt!==5&&Rt!==27&&Rt!==6)&&(Mt=null)):(Ue=null,Mt=ze),Ue!==Mt)){if(Rt=Ca,Ze="onMouseLeave",Me="onMouseEnter",Ee="mouse",(s==="pointerout"||s==="pointerover")&&(Rt=ni,Ze="onPointerLeave",Me="onPointerEnter",Ee="pointer"),zn=Ue==null?Be:Cs(Ue),$e=Mt==null?Be:Cs(Mt),Be=new Rt(Ze,Ee+"leave",Ue,p,Xe),Be.target=zn,Be.relatedTarget=$e,Ze=null,ba(Xe)===ze&&(Rt=new Rt(Me,Ee+"enter",Mt,p,Xe),Rt.target=$e,Rt.relatedTarget=zn,Ze=Rt),zn=Ze,Ue&&Mt)t:{for(Rt=Ue,Me=Mt,Ee=0,$e=Rt;$e;$e=Er($e))Ee++;for($e=0,Ze=Me;Ze;Ze=Er(Ze))$e++;for(;0<Ee-$e;)Rt=Er(Rt),Ee--;for(;0<$e-Ee;)Me=Er(Me),$e--;for(;Ee--;){if(Rt===Me||Me!==null&&Rt===Me.alternate)break t;Rt=Er(Rt),Me=Er(Me)}Rt=null}else Rt=null;Ue!==null&&yr(nt,Be,Ue,Rt,!1),Mt!==null&&zn!==null&&yr(nt,zn,Mt,Rt,!0)}}e:{if(Be=ze?Cs(ze):window,Ue=Be.nodeName&&Be.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Be.type==="file")var gt=rf;else if(xc(Be))if(af)gt=of;else{gt=Mr;var nn=Ta}else Ue=Be.nodeName,!Ue||Ue.toLowerCase()!=="input"||Be.type!=="checkbox"&&Be.type!=="radio"?ze&&sc(ze.elementType)&&(gt=rf):gt=gl;if(gt&&(gt=gt(s,ze))){xo(nt,gt,p,Xe);break e}nn&&nn(s,Be,ze),s==="focusout"&&ze&&Be.type==="number"&&ze.memoizedProps.value!=null&&ol(Be,"number",Be.value)}switch(nn=ze?Cs(ze):window,s){case"focusin":(xc(nn)||nn.contentEditable==="true")&&(wo=nn,is=ze,De=null);break;case"focusout":De=is=wo=null;break;case"mousedown":Qe=!0;break;case"contextmenu":case"mouseup":case"dragend":Qe=!1,qe(nt,p,Xe);break;case"selectionchange":if(rp)break;case"keydown":case"keyup":qe(nt,p,Xe)}var St;if(ns)e:{switch(s){case"compositionstart":var Ot="onCompositionStart";break e;case"compositionend":Ot="onCompositionEnd";break e;case"compositionupdate":Ot="onCompositionUpdate";break e}Ot=void 0}else ka?Tu(s,p)&&(Ot="onCompositionEnd"):s==="keydown"&&p.keyCode===229&&(Ot="onCompositionStart");Ot&&(_a&&p.locale!=="ko"&&(ka||Ot!=="onCompositionStart"?Ot==="onCompositionEnd"&&ka&&(St=Zi()):(Xi=Xe,ul="value"in Xi?Xi.value:Xi.textContent,ka=!0)),nn=th(ze,Ot),0<nn.length&&(Ot=new Hr(Ot,s,null,p,Xe),nt.push({event:Ot,listeners:nn}),St?Ot.data=St:(St=yo(p),St!==null&&(Ot.data=St)))),(St=ku?yc(s,p):Eu(s,p))&&(Ot=th(ze,"onBeforeInput"),0<Ot.length&&(nn=new Hr("onBeforeInput","beforeinput",null,p,Xe),nt.push({event:nn,listeners:Ot}),nn.data=St)),mv(nt,s,ze,p,Xe)}$y(nt,c)})}function Bt(s,c,p){return{instance:s,listener:c,currentTarget:p}}function th(s,c){for(var p=c+"Capture",x=[];s!==null;){var N=s,A=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||A===null||(N=Es(s,p),N!=null&&x.unshift(Bt(s,N,A)),N=Es(s,c),N!=null&&x.push(Bt(s,N,A))),s.tag===3)return x;s=s.return}return[]}function Er(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function yr(s,c,p,x,N){for(var A=c._reactName,q=[];p!==null&&p!==x;){var ee=p,we=ee.alternate,ze=ee.stateNode;if(ee=ee.tag,we!==null&&we===x)break;ee!==5&&ee!==26&&ee!==27||ze===null||(we=ze,N?(ze=Es(p,A),ze!=null&&q.unshift(Bt(p,ze,we))):N||(ze=Es(p,A),ze!=null&&q.push(Bt(p,ze,we)))),p=p.return}q.length!==0&&s.push({event:c,listeners:q})}var bv=/\r\n?/g,Uo=/\u0000|\uFFFD/g;function Uy(s){return(typeof s=="string"?s:""+s).replace(bv,`
`).replace(Uo,"")}function By(s,c){return c=Uy(c),Uy(s)===c}function nh(){}function $n(s,c,p,x,N,A){switch(p){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||wa(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&wa(s,""+x);break;case"className":so(s,"class",x);break;case"tabIndex":so(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":so(s,p,x);break;case"style":ll(s,x,A);break;case"data":if(c!=="object"){so(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||p!=="href")){s.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=Ja(""+x),s.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(p==="formAction"?(c!=="input"&&$n(s,c,"name",N.name,N,null),$n(s,c,"formEncType",N.formEncType,N,null),$n(s,c,"formMethod",N.formMethod,N,null),$n(s,c,"formTarget",N.formTarget,N,null)):($n(s,c,"encType",N.encType,N,null),$n(s,c,"method",N.method,N,null),$n(s,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=Ja(""+x),s.setAttribute(p,x);break;case"onClick":x!=null&&(s.onclick=nh);break;case"onScroll":x!=null&&on("scroll",s);break;case"onScrollEnd":x!=null&&on("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}p=Ja(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""+x):s.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""):s.removeAttribute(p);break;case"capture":case"download":x===!0?s.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,x):s.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(p,x):s.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(p):s.setAttribute(p,x);break;case"popover":on("beforetoggle",s),on("toggle",s),Xl(s,"popover",x);break;case"xlinkActuate":vr(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":vr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":vr(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":vr(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":vr(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":vr(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":vr(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":vr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":vr(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Xl(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=oc.get(p)||p,Xl(s,p,x))}}function cm(s,c,p,x,N,A){switch(p){case"style":ll(s,x,A);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"children":typeof x=="string"?wa(s,x):(typeof x=="number"||typeof x=="bigint")&&wa(s,""+x);break;case"onScroll":x!=null&&on("scroll",s);break;case"onScrollEnd":x!=null&&on("scrollend",s);break;case"onClick":x!=null&&(s.onclick=nh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Zd.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(N=p.endsWith("Capture"),c=p.slice(2,N?p.length-7:void 0),A=s[wr]||null,A=A!=null?A[p]:null,typeof A=="function"&&s.removeEventListener(c,A,N),typeof x=="function")){typeof A!="function"&&A!==null&&(p in s?s[p]=null:s.hasAttribute(p)&&s.removeAttribute(p)),s.addEventListener(c,x,N);break e}p in s?s[p]=x:x===!0?s.setAttribute(p,""):Xl(s,p,x)}}}function Ar(s,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":on("error",s),on("load",s);var x=!1,N=!1,A;for(A in p)if(p.hasOwnProperty(A)){var q=p[A];if(q!=null)switch(A){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:$n(s,c,A,q,p,null)}}N&&$n(s,c,"srcSet",p.srcSet,p,null),x&&$n(s,c,"src",p.src,p,null);return;case"input":on("invalid",s);var ee=A=q=N=null,we=null,ze=null;for(x in p)if(p.hasOwnProperty(x)){var Xe=p[x];if(Xe!=null)switch(x){case"name":N=Xe;break;case"type":q=Xe;break;case"checked":we=Xe;break;case"defaultChecked":ze=Xe;break;case"value":A=Xe;break;case"defaultValue":ee=Xe;break;case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(r(137,c));break;default:$n(s,c,x,Xe,p,null)}}vu(s,A,ee,we,ze,q,N,!1),nc(s);return;case"select":on("invalid",s),x=q=A=null;for(N in p)if(p.hasOwnProperty(N)&&(ee=p[N],ee!=null))switch(N){case"value":A=ee;break;case"defaultValue":q=ee;break;case"multiple":x=ee;default:$n(s,c,N,ee,p,null)}c=A,p=q,s.multiple=!!x,c!=null?va(s,!!x,c,!1):p!=null&&va(s,!!x,p,!0);return;case"textarea":on("invalid",s),A=N=x=null;for(q in p)if(p.hasOwnProperty(q)&&(ee=p[q],ee!=null))switch(q){case"value":x=ee;break;case"defaultValue":N=ee;break;case"children":A=ee;break;case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(91));break;default:$n(s,c,q,ee,p,null)}lo(s,x,N,A),nc(s);return;case"option":for(we in p)if(p.hasOwnProperty(we)&&(x=p[we],x!=null))switch(we){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:$n(s,c,we,x,p,null)}return;case"dialog":on("beforetoggle",s),on("toggle",s),on("cancel",s),on("close",s);break;case"iframe":case"object":on("load",s);break;case"video":case"audio":for(x=0;x<Sd.length;x++)on(Sd[x],s);break;case"image":on("error",s),on("load",s);break;case"details":on("toggle",s);break;case"embed":case"source":case"link":on("error",s),on("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ze in p)if(p.hasOwnProperty(ze)&&(x=p[ze],x!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:$n(s,c,ze,x,p,null)}return;default:if(sc(c)){for(Xe in p)p.hasOwnProperty(Xe)&&(x=p[Xe],x!==void 0&&cm(s,c,Xe,x,p,void 0));return}}for(ee in p)p.hasOwnProperty(ee)&&(x=p[ee],x!=null&&$n(s,c,ee,x,p,null))}function vv(s,c,p,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,A=null,q=null,ee=null,we=null,ze=null,Xe=null;for(Ue in p){var nt=p[Ue];if(p.hasOwnProperty(Ue)&&nt!=null)switch(Ue){case"checked":break;case"value":break;case"defaultValue":we=nt;default:x.hasOwnProperty(Ue)||$n(s,c,Ue,null,x,nt)}}for(var Be in x){var Ue=x[Be];if(nt=p[Be],x.hasOwnProperty(Be)&&(Ue!=null||nt!=null))switch(Be){case"type":A=Ue;break;case"name":N=Ue;break;case"checked":ze=Ue;break;case"defaultChecked":Xe=Ue;break;case"value":q=Ue;break;case"defaultValue":ee=Ue;break;case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(r(137,c));break;default:Ue!==nt&&$n(s,c,Be,Ue,x,nt)}}sl(s,q,ee,we,ze,Xe,A,N);return;case"select":Ue=q=ee=Be=null;for(A in p)if(we=p[A],p.hasOwnProperty(A)&&we!=null)switch(A){case"value":break;case"multiple":Ue=we;default:x.hasOwnProperty(A)||$n(s,c,A,null,x,we)}for(N in x)if(A=x[N],we=p[N],x.hasOwnProperty(N)&&(A!=null||we!=null))switch(N){case"value":Be=A;break;case"defaultValue":ee=A;break;case"multiple":q=A;default:A!==we&&$n(s,c,N,A,x,we)}c=ee,p=q,x=Ue,Be!=null?va(s,!!p,Be,!1):!!x!=!!p&&(c!=null?va(s,!!p,c,!0):va(s,!!p,p?[]:"",!1));return;case"textarea":Ue=Be=null;for(ee in p)if(N=p[ee],p.hasOwnProperty(ee)&&N!=null&&!x.hasOwnProperty(ee))switch(ee){case"value":break;case"children":break;default:$n(s,c,ee,null,x,N)}for(q in x)if(N=x[q],A=p[q],x.hasOwnProperty(q)&&(N!=null||A!=null))switch(q){case"value":Be=N;break;case"defaultValue":Ue=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==A&&$n(s,c,q,N,x,A)}ic(s,Be,Ue);return;case"option":for(var Mt in p)if(Be=p[Mt],p.hasOwnProperty(Mt)&&Be!=null&&!x.hasOwnProperty(Mt))switch(Mt){case"selected":s.selected=!1;break;default:$n(s,c,Mt,null,x,Be)}for(we in x)if(Be=x[we],Ue=p[we],x.hasOwnProperty(we)&&Be!==Ue&&(Be!=null||Ue!=null))switch(we){case"selected":s.selected=Be&&typeof Be!="function"&&typeof Be!="symbol";break;default:$n(s,c,we,Be,x,Ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Rt in p)Be=p[Rt],p.hasOwnProperty(Rt)&&Be!=null&&!x.hasOwnProperty(Rt)&&$n(s,c,Rt,null,x,Be);for(ze in x)if(Be=x[ze],Ue=p[ze],x.hasOwnProperty(ze)&&Be!==Ue&&(Be!=null||Ue!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":if(Be!=null)throw Error(r(137,c));break;default:$n(s,c,ze,Be,x,Ue)}return;default:if(sc(c)){for(var zn in p)Be=p[zn],p.hasOwnProperty(zn)&&Be!==void 0&&!x.hasOwnProperty(zn)&&cm(s,c,zn,void 0,x,Be);for(Xe in x)Be=x[Xe],Ue=p[Xe],!x.hasOwnProperty(Xe)||Be===Ue||Be===void 0&&Ue===void 0||cm(s,c,Xe,Be,x,Ue);return}}for(var Me in p)Be=p[Me],p.hasOwnProperty(Me)&&Be!=null&&!x.hasOwnProperty(Me)&&$n(s,c,Me,null,x,Be);for(nt in x)Be=x[nt],Ue=p[nt],!x.hasOwnProperty(nt)||Be===Ue||Be==null&&Ue==null||$n(s,c,nt,Be,x,Ue)}var Ra=null,rh=null;function $l(s){return s.nodeType===9?s:s.ownerDocument}function sr(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function dr(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function ih(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var um=null;function wv(){var s=window.event;return s&&s.type==="popstate"?s===um?!1:(um=s,!0):(um=null,!1)}var qy=typeof setTimeout=="function"?setTimeout:void 0,Sv=typeof clearTimeout=="function"?clearTimeout:void 0,Vy=typeof Promise=="function"?Promise:void 0,Nv=typeof queueMicrotask=="function"?queueMicrotask:typeof Vy<"u"?function(s){return Vy.resolve(null).then(s).catch(Hy)}:qy;function Hy(s){setTimeout(function(){throw s})}function la(s){return s==="head"}function ah(s,c){var p=c,x=0,N=0;do{var A=p.nextSibling;if(s.removeChild(p),A&&A.nodeType===8)if(p=A.data,p==="/$"){if(0<x&&8>x){p=x;var q=s.ownerDocument;if(p&1&&Nd(q.documentElement),p&2&&Nd(q.body),p&4)for(p=q.head,Nd(p),q=p.firstChild;q;){var ee=q.nextSibling,we=q.nodeName;q[Ss]||we==="SCRIPT"||we==="STYLE"||we==="LINK"&&q.rel.toLowerCase()==="stylesheet"||p.removeChild(q),q=ee}}if(N===0){s.removeChild(A),Pd(c);return}N--}else p==="$"||p==="$?"||p==="$!"?N++:x=p.charCodeAt(0)-48;else x=0;p=A}while(p);Pd(c)}function dm(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":dm(p),gu(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}s.removeChild(p)}}function Gy(s,c,p,x){for(;s.nodeType===1;){var N=p;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[Ss])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(A=s.getAttribute("rel"),A==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(A!==N.rel||s.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||s.getAttribute("title")!==(N.title==null?null:N.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(A=s.getAttribute("src"),(A!==(N.src==null?null:N.src)||s.getAttribute("type")!==(N.type==null?null:N.type)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&A&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var A=N.name==null?null:""+N.name;if(N.type==="hidden"&&s.getAttribute("name")===A)return s}else return s;if(s=Ma(s.nextSibling),s===null)break}return null}function sh(s,c,p){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!p||(s=Ma(s.nextSibling),s===null))return null;return s}function yi(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Yc(s,c){var p=s.ownerDocument;if(s.data!=="$?"||p.readyState==="complete")c();else{var x=function(){c(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Ma(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var fm=null;function Yy(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var p=s.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return s;c--}else p==="/$"&&c++}s=s.previousSibling}return null}function Wy(s,c,p){switch(c=$l(p),s){case"html":if(s=c.documentElement,!s)throw Error(r(452));return s;case"head":if(s=c.head,!s)throw Error(r(453));return s;case"body":if(s=c.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Nd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);gu(s)}var Yi=new Map,ps=new Set;function Gt(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ms=ne.d;ne.d={f:ca,r:Qy,D:Cv,C:Jy,L:oh,m:_v,X:kv,S:jv,M:Tv};function ca(){var s=ms.f(),c=Wf();return s||c}function Qy(s){var c=Ns(s);c!==null&&c.tag===5&&c.type==="form"?Pf(c):ms.r(s)}var Wc=typeof document>"u"?null:document;function An(s,c,p){var x=Wc;if(x&&typeof c=="string"&&c){var N=ci(c);N='link[rel="'+s+'"][href="'+N+'"]',typeof p=="string"&&(N+='[crossorigin="'+p+'"]'),ps.has(N)||(ps.add(N),s={rel:s,crossOrigin:p,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),Ar(c,"link",s),Sr(c),x.head.appendChild(c)))}}function Cv(s){ms.D(s),An("dns-prefetch",s,null)}function Jy(s,c){ms.C(s,c),An("preconnect",s,c)}function oh(s,c,p){ms.L(s,c,p);var x=Wc;if(x&&s&&c){var N='link[rel="preload"][as="'+ci(c)+'"]';c==="image"&&p&&p.imageSrcSet?(N+='[imagesrcset="'+ci(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(N+='[imagesizes="'+ci(p.imageSizes)+'"]')):N+='[href="'+ci(s)+'"]';var A=N;switch(c){case"style":A=Qc(s);break;case"script":A=Jc(s)}Yi.has(A)||(s=h({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:s,as:c},p),Yi.set(A,s),x.querySelector(N)!==null||c==="style"&&x.querySelector(Cd(A))||c==="script"&&x.querySelector(_d(A))||(c=x.createElement("link"),Ar(c,"link",s),Sr(c),x.head.appendChild(c)))}}function _v(s,c){ms.m(s,c);var p=Wc;if(p&&s){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+ci(x)+'"][href="'+ci(s)+'"]',A=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Jc(s)}if(!Yi.has(A)&&(s=h({rel:"modulepreload",href:s},c),Yi.set(A,s),p.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(_d(A)))return}x=p.createElement("link"),Ar(x,"link",s),Sr(x),p.head.appendChild(x)}}}function jv(s,c,p){ms.S(s,c,p);var x=Wc;if(x&&s){var N=_s(x).hoistableStyles,A=Qc(s);c=c||"default";var q=N.get(A);if(!q){var ee={loading:0,preload:null};if(q=x.querySelector(Cd(A)))ee.loading=5;else{s=h({rel:"stylesheet",href:s,"data-precedence":c},p),(p=Yi.get(A))&&jd(s,p);var we=q=x.createElement("link");Sr(we),Ar(we,"link",s),we._p=new Promise(function(ze,Xe){we.onload=ze,we.onerror=Xe}),we.addEventListener("load",function(){ee.loading|=1}),we.addEventListener("error",function(){ee.loading|=2}),ee.loading|=4,lh(q,c,x)}q={type:"stylesheet",instance:q,count:1,state:ee},N.set(A,q)}}}function kv(s,c){ms.X(s,c);var p=Wc;if(p&&s){var x=_s(p).hoistableScripts,N=Jc(s),A=x.get(N);A||(A=p.querySelector(_d(N)),A||(s=h({src:s,async:!0},c),(c=Yi.get(N))&&hm(s,c),A=p.createElement("script"),Sr(A),Ar(A,"link",s),p.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function Tv(s,c){ms.M(s,c);var p=Wc;if(p&&s){var x=_s(p).hoistableScripts,N=Jc(s),A=x.get(N);A||(A=p.querySelector(_d(N)),A||(s=h({src:s,async:!0,type:"module"},c),(c=Yi.get(N))&&hm(s,c),A=p.createElement("script"),Sr(A),Ar(A,"link",s),p.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function Ky(s,c,p,x){var N=(N=te.current)?Gt(N):null;if(!N)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=Qc(p.href),p=_s(N).hoistableStyles,x=p.get(c),x||(x={type:"style",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){s=Qc(p.href);var A=_s(N).hoistableStyles,q=A.get(s);if(q||(N=N.ownerDocument||N,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(s,q),(A=N.querySelector(Cd(s)))&&!A._p&&(q.instance=A,q.state.loading=5),Yi.has(s)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Yi.set(s,p),A||Ev(N,s,p,q.state))),c&&x===null)throw Error(r(528,""));return q}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Jc(p),p=_s(N).hoistableScripts,x=p.get(c),x||(x={type:"script",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Qc(s){return'href="'+ci(s)+'"'}function Cd(s){return'link[rel="stylesheet"]['+s+"]"}function Xy(s){return h({},s,{"data-precedence":s.precedence,precedence:null})}function Ev(s,c,p,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),Ar(c,"link",p),Sr(c),s.head.appendChild(c))}function Jc(s){return'[src="'+ci(s)+'"]'}function _d(s){return"script[async]"+s}function Zy(s,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+ci(p.href)+'"]');if(x)return c.instance=x,Sr(x),x;var N=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),Sr(x),Ar(x,"style",N),lh(x,p.precedence,s),c.instance=x;case"stylesheet":N=Qc(p.href);var A=s.querySelector(Cd(N));if(A)return c.state.loading|=4,c.instance=A,Sr(A),A;x=Xy(p),(N=Yi.get(N))&&jd(x,N),A=(s.ownerDocument||s).createElement("link"),Sr(A);var q=A;return q._p=new Promise(function(ee,we){q.onload=ee,q.onerror=we}),Ar(A,"link",x),c.state.loading|=4,lh(A,p.precedence,s),c.instance=A;case"script":return A=Jc(p.src),(N=s.querySelector(_d(A)))?(c.instance=N,Sr(N),N):(x=p,(N=Yi.get(A))&&(x=h({},p),hm(x,N)),s=s.ownerDocument||s,N=s.createElement("script"),Sr(N),Ar(N,"link",x),s.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,lh(x,p.precedence,s));return c.instance}function lh(s,c,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,A=N,q=0;q<x.length;q++){var ee=x[q];if(ee.dataset.precedence===c)A=ee;else if(A!==N)break}A?A.parentNode.insertBefore(s,A.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(s,c.firstChild))}function jd(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function hm(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var Kc=null;function ex(s,c,p){if(Kc===null){var x=new Map,N=Kc=new Map;N.set(p,x)}else N=Kc,x=N.get(p),x||(x=new Map,N.set(p,x));if(x.has(s))return x;for(x.set(s,null),p=p.getElementsByTagName(s),N=0;N<p.length;N++){var A=p[N];if(!(A[Ss]||A[En]||s==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var q=A.getAttribute(c)||"";q=s+q;var ee=x.get(q);ee?ee.push(A):x.set(q,[A])}}return x}function tx(s,c,p){s=s.ownerDocument||s,s.head.insertBefore(p,c==="title"?s.querySelector("head > title"):null)}function Av(s,c,p){if(p===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Pr(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Fr=null;function Pv(){}function Dv(s,c,p){if(Fr===null)throw Error(r(475));var x=Fr;if(c.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=Qc(p.href),A=s.querySelector(Cd(N));if(A){s=A._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=kd.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=A,Sr(A);return}A=s.ownerDocument||s,p=Xy(p),(N=Yi.get(N))&&jd(p,N),A=A.createElement("link"),Sr(A);var q=A;q._p=new Promise(function(ee,we){q.onload=ee,q.onerror=we}),Ar(A,"link",p),c.instance=A}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=kd.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function Iv(){if(Fr===null)throw Error(r(475));var s=Fr;return s.stylesheets&&s.count===0&&pm(s,s.stylesheets),0<s.count?function(c){var p=setTimeout(function(){if(s.stylesheets&&pm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(p)}}:null}function kd(){if(this.count--,this.count===0){if(this.stylesheets)pm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var ch=null;function pm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,ch=new Map,c.forEach(Rv,s),ch=null,kd.call(s))}function Rv(s,c){if(!(c.state.loading&4)){var p=ch.get(s);if(p)var x=p.get(null);else{p=new Map,ch.set(s,p);for(var N=s.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<N.length;A++){var q=N[A];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(p.set(q.dataset.precedence,q),x=q)}x&&p.set(null,x)}N=c.instance,q=N.getAttribute("data-precedence"),A=p.get(q)||x,A===x&&p.set(null,N),p.set(q,N),this.count++,x=kd.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),A?A.parentNode.insertBefore(N,A.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(N,s.firstChild)),c.state.loading|=4}}var Xc={$$typeof:R,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function Mv(s,c,p,x,N,A,q,ee){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ln(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ln(0),this.hiddenUpdates=ln(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=A,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map}function nx(s,c,p,x,N,A,q,ee,we,ze,Xe,nt){return s=new Mv(s,c,p,q,ee,we,ze,nt),c=1,A===!0&&(c|=24),A=yt(3,null,null,c),s.current=A,A.stateNode=s,c=lp(),c.refCount++,s.pooledCache=c,c.refCount++,A.memoizedState={element:x,isDehydrated:p,cache:c},jl(A),s}function rx(s){return s?(s=dt,s):dt}function mm(s,c,p,x,N,A){N=rx(N),x.context===null?x.context=N:x.pendingContext=N,x=jo(c),x.payload={element:p},A=A===void 0?null:A,A!==null&&(x.callback=A),p=Fs(s,x,c),p!==null&&(Gi(p,s,c),zu(p,s,c))}function gm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<c?p:c}}function ym(s,c){gm(s,c),(s=s.alternate)&&gm(s,c)}function ix(s){if(s.tag===13){var c=ce(s,67108864);c!==null&&Gi(c,s,67108864),ym(s,67108864)}}var uh=!0;function Ov(s,c,p,x){var N=Y.T;Y.T=null;var A=ne.p;try{ne.p=2,xm(s,c,p,x)}finally{ne.p=A,Y.T=N}}function Zc(s,c,p,x){var N=Y.T;Y.T=null;var A=ne.p;try{ne.p=8,xm(s,c,p,x)}finally{ne.p=A,Y.T=N}}function xm(s,c,p,x){if(uh){var N=bm(x);if(N===null)Qs(s,c,x,dh,p),sx(s,x);else if(Fv(N,s,c,p,x))x.stopPropagation();else if(sx(s,x),c&4&&-1<Lv.indexOf(s)){for(;N!==null;){var A=Ns(N);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var q=Fe(A.pendingLanes);if(q!==0){var ee=A;for(ee.pendingLanes|=2,ee.entangledLanes|=2;q;){var we=1<<31-Je(q);ee.entanglements[1]|=we,q&=~we}hs(A),(Rn&6)===0&&(Uc=Ye()+500,bd(0))}}break;case 13:ee=ce(A,2),ee!==null&&Gi(ee,A,2),Wf(),ym(A,2)}if(A=bm(x),A===null&&Qs(s,c,x,dh,p),A===N)break;N=A}N!==null&&x.stopPropagation()}else Qs(s,c,x,null,p)}}function bm(s){return s=co(s),vm(s)}var dh=null;function vm(s){if(dh=null,s=ba(s),s!==null){var c=o(s);if(c===null)s=null;else{var p=c.tag;if(p===13){if(s=l(c),s!==null)return s;s=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return dh=s,null}function ax(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(it()){case xt:return 2;case Nt:return 8;case ue:case Ae:return 32;case ke:return 268435456;default:return 32}default:return 32}}var fh=!1,Js=null,Bo=null,qo=null,Td=new Map,Ed=new Map,Vo=[],Lv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sx(s,c){switch(s){case"focusin":case"focusout":Js=null;break;case"dragenter":case"dragleave":Bo=null;break;case"mouseover":case"mouseout":qo=null;break;case"pointerover":case"pointerout":Td.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ed.delete(c.pointerId)}}function Ad(s,c,p,x,N,A){return s===null||s.nativeEvent!==A?(s={blockedOn:c,domEventName:p,eventSystemFlags:x,nativeEvent:A,targetContainers:[N]},c!==null&&(c=Ns(c),c!==null&&ix(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),s)}function Fv(s,c,p,x,N){switch(c){case"focusin":return Js=Ad(Js,s,c,p,x,N),!0;case"dragenter":return Bo=Ad(Bo,s,c,p,x,N),!0;case"mouseover":return qo=Ad(qo,s,c,p,x,N),!0;case"pointerover":var A=N.pointerId;return Td.set(A,Ad(Td.get(A)||null,s,c,p,x,N)),!0;case"gotpointercapture":return A=N.pointerId,Ed.set(A,Ad(Ed.get(A)||null,s,c,p,x,N)),!0}return!1}function ox(s){var c=ba(s.target);if(c!==null){var p=o(c);if(p!==null){if(c=p.tag,c===13){if(c=l(p),c!==null){s.blockedOn=c,Vr(s.priority,function(){if(p.tag===13){var x=li();x=Yt(x);var N=ce(p,x);N!==null&&Gi(N,p,x),ym(p,x)}});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){s.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}s.blockedOn=null}function hh(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var p=bm(s.nativeEvent);if(p===null){p=s.nativeEvent;var x=new p.constructor(p.type,p);Ka=x,p.target.dispatchEvent(x),Ka=null}else return c=Ns(p),c!==null&&ix(c),s.blockedOn=p,!1;c.shift()}return!0}function lx(s,c,p){hh(s)&&p.delete(c)}function $v(){fh=!1,Js!==null&&hh(Js)&&(Js=null),Bo!==null&&hh(Bo)&&(Bo=null),qo!==null&&hh(qo)&&(qo=null),Td.forEach(lx),Ed.forEach(lx)}function ph(s,c){s.blockedOn===c&&(s.blockedOn=null,fh||(fh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$v)))}var mh=null;function cx(s){mh!==s&&(mh=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){mh===s&&(mh=null);for(var c=0;c<s.length;c+=3){var p=s[c],x=s[c+1],N=s[c+2];if(typeof x!="function"){if(vm(x||p)===null)continue;break}var A=Ns(p);A!==null&&(s.splice(c,3),c-=3,Ku(A,{pending:!0,data:N,method:p.method,action:x},x,N))}}))}function Pd(s){function c(we){return ph(we,s)}Js!==null&&ph(Js,s),Bo!==null&&ph(Bo,s),qo!==null&&ph(qo,s),Td.forEach(c),Ed.forEach(c);for(var p=0;p<Vo.length;p++){var x=Vo[p];x.blockedOn===s&&(x.blockedOn=null)}for(;0<Vo.length&&(p=Vo[0],p.blockedOn===null);)ox(p),p.blockedOn===null&&Vo.shift();if(p=(s.ownerDocument||s).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var N=p[x],A=p[x+1],q=N[wr]||null;if(typeof A=="function")q||cx(p);else if(q){var ee=null;if(A&&A.hasAttribute("formAction")){if(N=A,q=A[wr]||null)ee=q.formAction;else if(vm(N)!==null)continue}else ee=q.action;typeof ee=="function"?p[x+1]=ee:(p.splice(x,3),x-=3),cx(p)}}}function wm(s){this._internalRoot=s}gh.prototype.render=wm.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,x=li();mm(p,x,s,c,null,null)},gh.prototype.unmount=wm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;mm(s.current,2,null,s,null,null),Wf(),c[Jr]=null}};function gh(s){this._internalRoot=s}gh.prototype.unstable_scheduleHydration=function(s){if(s){var c=Jn();s={blockedOn:null,target:s,priority:c};for(var p=0;p<Vo.length&&c!==0&&c<Vo[p].priority;p++);Vo.splice(p,0,s),p===0&&ox(s)}};var ux=n.version;if(ux!=="19.1.0")throw Error(r(527,ux,"19.1.0"));ne.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=f(c),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var zv={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{X=yh.inject(zv),fe=yh}catch{}}return Nm.createRoot=function(s,c){if(!a(s))throw Error(r(299));var p=!1,x="",N=Rp,A=Rf,q=Qg,ee=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(q=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(ee=c.unstable_transitionCallbacks)),c=nx(s,1,!1,null,null,p,x,N,A,q,ee,null),s[Jr]=c.current,lm(s),new wm(c)},Nm.hydrateRoot=function(s,c,p){if(!a(s))throw Error(r(299));var x=!1,N="",A=Rp,q=Rf,ee=Qg,we=null,ze=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onUncaughtError!==void 0&&(A=p.onUncaughtError),p.onCaughtError!==void 0&&(q=p.onCaughtError),p.onRecoverableError!==void 0&&(ee=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(we=p.unstable_transitionCallbacks),p.formState!==void 0&&(ze=p.formState)),c=nx(s,1,!0,c,p??null,x,N,A,q,ee,we,ze),c.context=rx(null),p=c.current,x=li(),x=Yt(x),N=jo(x),N.callback=null,Fs(p,N,x),p=x,c.current.lanes=p,dn(c,p),hs(c),s[Jr]=c.current,lm(s),new gh(c)},Nm.version="19.1.0",Nm}var IS;function NP(){if(IS)return Gv.exports;IS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Gv.exports=SP(),Gv.exports}var CP=NP();const _P=({message:e="Newtons Ai HMS"})=>i.jsx("div",{className:"loading-container",children:i.jsxs("div",{className:"loading-content",children:[i.jsxs("div",{className:"spinner-ring",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}),i.jsx("div",{className:"loading-title",children:e}),i.jsx("div",{className:"loading-subtitle",children:"Loading your workspace..."})]})});function jP(e={}){const{nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a}=e,[o,l]=w.useState(!1),d=w.useRef(r);d.current=r;const f=w.useRef(a);return f.current=a,w.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",t&&(u.src+=`?hl=${t}`),u.async=!0,u.defer=!0,u.nonce=n,u.onload=()=>{var h;l(!0),(h=d.current)===null||h===void 0||h.call(d)},u.onerror=()=>{var h;l(!1),(h=f.current)===null||h===void 0||h.call(f)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[n]),o}const Wj=w.createContext(null);function kP({clientId:e,nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a,children:o}){const l=jP({nonce:n,onScriptLoadSuccess:r,onScriptLoadError:a,locale:t}),d=w.useMemo(()=>({locale:t,clientId:e,scriptLoadedSuccessfully:l}),[e,l]);return kn.createElement(Wj.Provider,{value:d},o)}function TP(){const e=w.useContext(Wj);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function EP(e){var n;return(n=e==null?void 0:e.clientId)!==null&&n!==void 0?n:e==null?void 0:e.client_id}const AP={large:40,medium:32,small:20};function PP({onSuccess:e,onError:n,useOneTap:t,promptMomentNotification:r,type:a="standard",theme:o="outline",size:l="large",text:d,shape:f,logo_alignment:u,width:h,click_listener:g,state:b,containerProps:v,...S}){const k=w.useRef(null),{clientId:T,locale:P,scriptLoadedSuccessfully:M}=TP(),R=w.useRef(e);R.current=e;const z=w.useRef(n);z.current=n;const $=w.useRef(r);return $.current=r,w.useEffect(()=>{var L,U,B,W,I,F,V,re,ie;if(M)return(B=(U=(L=window==null?void 0:window.google)===null||L===void 0?void 0:L.accounts)===null||U===void 0?void 0:U.id)===null||B===void 0||B.initialize({client_id:T,callback:G=>{var Y;if(!(G!=null&&G.credential))return(Y=z.current)===null||Y===void 0?void 0:Y.call(z);const{credential:ne,select_by:le}=G;R.current({credential:ne,clientId:EP(G),select_by:le})},...S}),(F=(I=(W=window==null?void 0:window.google)===null||W===void 0?void 0:W.accounts)===null||I===void 0?void 0:I.id)===null||F===void 0||F.renderButton(k.current,{type:a,theme:o,size:l,text:d,shape:f,logo_alignment:u,width:h,locale:P,click_listener:g,state:b}),t&&((ie=(re=(V=window==null?void 0:window.google)===null||V===void 0?void 0:V.accounts)===null||re===void 0?void 0:re.id)===null||ie===void 0||ie.prompt($.current)),()=>{var G,Y,ne;t&&((ne=(Y=(G=window==null?void 0:window.google)===null||G===void 0?void 0:G.accounts)===null||Y===void 0?void 0:Y.id)===null||ne===void 0||ne.cancel())}},[T,M,t,a,o,l,d,f,u,h,P]),kn.createElement("div",{...v,ref:k,style:{height:AP[l],...v==null?void 0:v.style}})}var Cm={},RS;function DP(){if(RS)return Cm;RS=1,Object.defineProperty(Cm,"__esModule",{value:!0}),Cm.parse=l,Cm.serialize=u;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new o,k=b.length;if(k<2)return S;const T=(v==null?void 0:v.decode)||h;let P=0;do{const M=b.indexOf("=",P);if(M===-1)break;const R=b.indexOf(";",P),z=R===-1?k:R;if(M>z){P=b.lastIndexOf(";",M-1)+1;continue}const $=d(b,P,M),L=f(b,M,$),U=b.slice($,L);if(S[U]===void 0){let B=d(b,M+1,z),W=f(b,z,B);const I=T(b.slice(B,W));S[U]=I}P=z+1}while(P<k);return S}function d(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function f(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function u(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let P=b+"="+T;if(!S)return P;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);P+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);P+="; Domain="+S.domain}if(S.path){if(!r.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);P+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);P+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(P+="; HttpOnly"),S.secure&&(P+="; Secure"),S.partitioned&&(P+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":P+="; Priority=Low";break;case"medium":P+="; Priority=Medium";break;case"high":P+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":P+="; SameSite=Strict";break;case"lax":P+="; SameSite=Lax";break;case"none":P+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return P}function h(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Cm}DP();var MS="popstate";function IP(e={}){function n(r,a){let{pathname:o,search:l,hash:d}=r.location;return i1("",{pathname:o,search:l,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Wm(a)}return MP(n,t,null,e)}function xr(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Zs(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function RP(){return Math.random().toString(36).substring(2,10)}function OS(e,n){return{usr:e.state,key:e.key,idx:n}}function i1(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Bh(n):n,state:t,key:n&&n.key||r||RP()}}function Wm({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Bh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function MP(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,l=a.history,d="POP",f=null,u=h();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function h(){return(l.state||{idx:null}).idx}function g(){d="POP";let T=h(),P=T==null?null:T-u;u=T,f&&f({action:d,location:k.location,delta:P})}function b(T,P){d="PUSH";let M=i1(k.location,T,P);u=h()+1;let R=OS(M,u),z=k.createHref(M);try{l.pushState(R,"",z)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;a.location.assign(z)}o&&f&&f({action:d,location:k.location,delta:1})}function v(T,P){d="REPLACE";let M=i1(k.location,T,P);u=h();let R=OS(M,u),z=k.createHref(M);l.replaceState(R,"",z),o&&f&&f({action:d,location:k.location,delta:0})}function S(T){return OP(T)}let k={get action(){return d},get location(){return e(a,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(MS,g),f=T,()=>{a.removeEventListener(MS,g),f=null}},createHref(T){return n(a,T)},createURL:S,encodeLocation(T){let P=S(T);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:b,replace:v,go(T){return l.go(T)}};return k}function OP(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),xr(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Wm(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function Qj(e,n,t="/"){return LP(e,n,t,!1)}function LP(e,n,t,r){let a=typeof n=="string"?Bh(n):n,o=Vl(a.pathname||"/",t);if(o==null)return null;let l=Jj(e);FP(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let u=QP(o);d=YP(l[f],u,r)}return d}function Jj(e,n=[],t=[],r=""){let a=(o,l,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(xr(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length));let u=Bl([r,f.relativePath]),h=t.concat(f);o.children&&o.children.length>0&&(xr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),Jj(o.children,n,h,u)),!(o.path==null&&!o.index)&&n.push({path:u,score:HP(u,o.index),routesMeta:h})};return e.forEach((o,l)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))a(o,l);else for(let f of Kj(o.path))a(o,l,f)}),n}function Kj(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let l=Kj(r.join("/")),d=[];return d.push(...l.map(f=>f===""?o:[o,f].join("/"))),a&&d.push(...l),d.map(f=>e.startsWith("/")&&f===""?"/":f)}function FP(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:GP(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var $P=/^:[\w-]+$/,zP=3,UP=2,BP=1,qP=10,VP=-2,LS=e=>e==="*";function HP(e,n){let t=e.split("/"),r=t.length;return t.some(LS)&&(r+=VP),n&&(r+=UP),t.filter(a=>!LS(a)).reduce((a,o)=>a+($P.test(o)?zP:o===""?BP:qP),r)}function GP(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function YP(e,n,t=!1){let{routesMeta:r}=e,a={},o="/",l=[];for(let d=0;d<r.length;++d){let f=r[d],u=d===r.length-1,h=o==="/"?n:n.slice(o.length)||"/",g=Qx({path:f.relativePath,caseSensitive:f.caseSensitive,end:u},h),b=f.route;if(!g&&u&&t&&!r[r.length-1].route.index&&(g=Qx({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},h)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:Bl([o,g.pathname]),pathnameBase:ZP(Bl([o,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(o=Bl([o,g.pathnameBase]))}return l}function Qx(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=WP(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:r.reduce((u,{paramName:h,isOptional:g},b)=>{if(h==="*"){let S=d[b]||"";l=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const v=d[b];return g&&!v?u[h]=void 0:u[h]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:l,pattern:e}}function WP(e,n=!1,t=!0){Zs(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function QP(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Zs(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Vl(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function JP(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Bh(e):e;return{pathname:t?t.startsWith("/")?t:KP(t,n):n,search:eD(r),hash:tD(a)}}function KP(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Jv(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function XP(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function dw(e){let n=XP(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function fw(e,n,t,r=!1){let a;typeof e=="string"?a=Bh(e):(a={...e},xr(!a.pathname||!a.pathname.includes("?"),Jv("?","pathname","search",a)),xr(!a.pathname||!a.pathname.includes("#"),Jv("#","pathname","hash",a)),xr(!a.search||!a.search.includes("#"),Jv("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,d;if(l==null)d=t;else{let g=n.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}d=g>=0?n[g]:"/"}let f=JP(a,d),u=l&&l!=="/"&&l.endsWith("/"),h=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(u||h)&&(f.pathname+="/"),f}var Bl=e=>e.join("/").replace(/\/\/+/g,"/"),ZP=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),eD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,tD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function nD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Xj=["POST","PUT","PATCH","DELETE"];new Set(Xj);var rD=["GET",...Xj];new Set(rD);var qh=w.createContext(null);qh.displayName="DataRouter";var wb=w.createContext(null);wb.displayName="DataRouterState";var Zj=w.createContext({isTransitioning:!1});Zj.displayName="ViewTransition";var iD=w.createContext(new Map);iD.displayName="Fetchers";var aD=w.createContext(null);aD.displayName="Await";var no=w.createContext(null);no.displayName="Navigation";var ag=w.createContext(null);ag.displayName="Location";var ro=w.createContext({outlet:null,matches:[],isDataRoute:!1});ro.displayName="Route";var hw=w.createContext(null);hw.displayName="RouteError";function sD(e,{relative:n}={}){xr(Vh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(no),{hash:a,pathname:o,search:l}=sg(e,{relative:n}),d=o;return t!=="/"&&(d=o==="/"?t:Bl([t,o])),r.createHref({pathname:d,search:l,hash:a})}function Vh(){return w.useContext(ag)!=null}function qr(){return xr(Vh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(ag).location}var ek="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function tk(e){w.useContext(no).static||w.useLayoutEffect(e)}function At(){let{isDataRoute:e}=w.useContext(ro);return e?bD():oD()}function oD(){xr(Vh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(qh),{basename:n,navigator:t}=w.useContext(no),{matches:r}=w.useContext(ro),{pathname:a}=qr(),o=JSON.stringify(dw(r)),l=w.useRef(!1);return tk(()=>{l.current=!0}),w.useCallback((f,u={})=>{if(Zs(l.current,ek),!l.current)return;if(typeof f=="number"){t.go(f);return}let h=fw(f,JSON.parse(o),a,u.relative==="path");e==null&&n!=="/"&&(h.pathname=h.pathname==="/"?n:Bl([n,h.pathname])),(u.replace?t.replace:t.push)(h,u.state,u)},[n,t,o,a,e])}w.createContext(null);function Ki(){let{matches:e}=w.useContext(ro),n=e[e.length-1];return n?n.params:{}}function sg(e,{relative:n}={}){let{matches:t}=w.useContext(ro),{pathname:r}=qr(),a=JSON.stringify(dw(t));return w.useMemo(()=>fw(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function lD(e,n){return nk(e,n)}function nk(e,n,t,r){var M;xr(Vh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=w.useContext(no),{matches:l}=w.useContext(ro),d=l[l.length-1],f=d?d.params:{},u=d?d.pathname:"/",h=d?d.pathnameBase:"/",g=d&&d.route;{let R=g&&g.path||"";rk(u,!g||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let b=qr(),v;if(n){let R=typeof n=="string"?Bh(n):n;xr(h==="/"||((M=R.pathname)==null?void 0:M.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${R.pathname}" was given in the \`location\` prop.`),v=R}else v=b;let S=v.pathname||"/",k=S;if(h!=="/"){let R=h.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(R.length).join("/")}let T=!o&&t&&t.matches&&t.matches.length>0?t.matches:Qj(e,{pathname:k});Zs(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Zs(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let P=hD(T&&T.map(R=>Object.assign({},R,{params:Object.assign({},f,R.params),pathname:Bl([h,a.encodeLocation?a.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?h:Bl([h,a.encodeLocation?a.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),l,t,r);return n&&P?w.createElement(ag.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},P):P}function cD(){let e=xD(),n=nD(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:o},"ErrorBoundary")," or"," ",w.createElement("code",{style:o},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var uD=w.createElement(cD,null),dD=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(ro.Provider,{value:this.props.routeContext},w.createElement(hw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function fD({routeContext:e,match:n,children:t}){let r=w.useContext(qh);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(ro.Provider,{value:e},t)}function hD(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,o=t==null?void 0:t.errors;if(o!=null){let f=a.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);xr(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,d=-1;if(t)for(let f=0;f<a.length;f++){let u=a[f];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=f),u.route.id){let{loaderData:h,errors:g}=t,b=u.route.loader&&!h.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||b){l=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,u,h)=>{let g,b=!1,v=null,S=null;t&&(g=o&&u.route.id?o[u.route.id]:void 0,v=u.route.errorElement||uD,l&&(d<0&&h===0?(rk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):d===h&&(b=!0,S=u.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,h+1)),T=()=>{let P;return g?P=v:b?P=S:u.route.Component?P=w.createElement(u.route.Component,null):u.route.element?P=u.route.element:P=f,w.createElement(fD,{match:u,routeContext:{outlet:f,matches:k,isDataRoute:t!=null},children:P})};return t&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?w.createElement(dD,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function pw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pD(e){let n=w.useContext(qh);return xr(n,pw(e)),n}function mD(e){let n=w.useContext(wb);return xr(n,pw(e)),n}function gD(e){let n=w.useContext(ro);return xr(n,pw(e)),n}function mw(e){let n=gD(e),t=n.matches[n.matches.length-1];return xr(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function yD(){return mw("useRouteId")}function xD(){var r;let e=w.useContext(hw),n=mD("useRouteError"),t=mw("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function bD(){let{router:e}=pD("useNavigate"),n=mw("useNavigate"),t=w.useRef(!1);return tk(()=>{t.current=!0}),w.useCallback(async(a,o={})=>{Zs(t.current,ek),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...o}))},[e,n])}var FS={};function rk(e,n,t){!n&&!FS[e]&&(FS[e]=!0,Zs(!1,t))}w.memo(vD);function vD({routes:e,future:n,state:t}){return nk(e,void 0,t,n)}function Cn({to:e,replace:n,state:t,relative:r}){xr(Vh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(no);Zs(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=w.useContext(ro),{pathname:l}=qr(),d=At(),f=fw(e,dw(o),l,r==="path"),u=JSON.stringify(f);return w.useEffect(()=>{d(JSON.parse(u),{replace:n,state:t,relative:r})},[d,u,r,n,t]),null}function ht(e){xr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function wD({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:o=!1}){xr(!Vh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=Bh(t));let{pathname:f="/",search:u="",hash:h="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=Vl(f,l);return S==null?null:{location:{pathname:S,search:u,hash:h,state:g,key:b},navigationType:r}},[l,f,u,h,g,b,r]);return Zs(v!=null,`<Router basename="${l}"> is not able to match the URL "${f}${u}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(no.Provider,{value:d},w.createElement(ag.Provider,{children:n,value:v}))}function _h({children:e,location:n}){return lD(a1(e),n)}function a1(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let o=[...n,a];if(r.type===w.Fragment){t.push.apply(t,a1(r.props.children,o));return}xr(r.type===ht,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=a1(r.props.children,o)),t.push(l)}),t}var Ox="get",Lx="application/x-www-form-urlencoded";function Sb(e){return e!=null&&typeof e.tagName=="string"}function SD(e){return Sb(e)&&e.tagName.toLowerCase()==="button"}function ND(e){return Sb(e)&&e.tagName.toLowerCase()==="form"}function CD(e){return Sb(e)&&e.tagName.toLowerCase()==="input"}function _D(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jD(e,n){return e.button===0&&(!n||n==="_self")&&!_D(e)}var dx=null;function kD(){if(dx===null)try{new FormData(document.createElement("form"),0),dx=!1}catch{dx=!0}return dx}var TD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kv(e){return e!=null&&!TD.has(e)?(Zs(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Lx}"`),null):e}function ED(e,n){let t,r,a,o,l;if(ND(e)){let d=e.getAttribute("action");r=d?Vl(d,n):null,t=e.getAttribute("method")||Ox,a=Kv(e.getAttribute("enctype"))||Lx,o=new FormData(e)}else if(SD(e)||CD(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||d.getAttribute("action");if(r=f?Vl(f,n):null,t=e.getAttribute("formmethod")||d.getAttribute("method")||Ox,a=Kv(e.getAttribute("formenctype"))||Kv(d.getAttribute("enctype"))||Lx,o=new FormData(d,e),!kD()){let{name:u,type:h,value:g}=e;if(h==="image"){let b=u?`${u}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else u&&o.append(u,g)}}else{if(Sb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Ox,r=null,a=Lx,l=e}return o&&a==="text/plain"&&(l=o,o=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:o,body:l}}function gw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function AD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function PD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function DD(e,n,t){let r=await Promise.all(e.map(async a=>{let o=n.routes[a.route.id];if(o){let l=await AD(o,t);return l.links?l.links():[]}return[]}));return OD(r.flat(1).filter(PD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function $S(e,n,t,r,a,o){let l=(f,u)=>t[u]?f.route.id!==t[u].route.id:!0,d=(f,u)=>{var h;return t[u].pathname!==f.pathname||((h=t[u].route.path)==null?void 0:h.endsWith("*"))&&t[u].params["*"]!==f.params["*"]};return o==="assets"?n.filter((f,u)=>l(f,u)||d(f,u)):o==="data"?n.filter((f,u)=>{var g;let h=r.routes[f.route.id];if(!h||!h.hasLoader)return!1;if(l(f,u)||d(f,u))return!0;if(f.route.shouldRevalidate){let b=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function ID(e,n,{includeHydrateFallback:t}={}){return RD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function RD(e){return[...new Set(e)]}function MD(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function OD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let o=JSON.stringify(MD(a));return t.has(o)||(t.add(o),r.push({key:o,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var LD=new Set([100,101,204,205]);function FD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Vl(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function ik(){let e=w.useContext(qh);return gw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function $D(){let e=w.useContext(wb);return gw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var yw=w.createContext(void 0);yw.displayName="FrameworkContext";function ak(){let e=w.useContext(yw);return gw(e,"You must render this element inside a <HydratedRouter> element"),e}function zD(e,n){let t=w.useContext(yw),[r,a]=w.useState(!1),[o,l]=w.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:u,onMouseLeave:h,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=P=>{P.forEach(M=>{l(M.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[o,b,{}]:[o,b,{onFocus:_m(d,v),onBlur:_m(f,S),onMouseEnter:_m(u,v),onMouseLeave:_m(h,S),onTouchStart:_m(g,v)}]:[!1,b,{}]}function _m(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function UD({page:e,...n}){let{router:t}=ik(),r=w.useMemo(()=>Qj(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(qD,{page:e,matches:r,...n}):null}function BD(e){let{manifest:n,routeModules:t}=ak(),[r,a]=w.useState([]);return w.useEffect(()=>{let o=!1;return DD(e,n,t).then(l=>{o||a(l)}),()=>{o=!0}},[e,n,t]),r}function qD({page:e,matches:n,...t}){let r=qr(),{manifest:a,routeModules:o}=ak(),{basename:l}=ik(),{loaderData:d,matches:f}=$D(),u=w.useMemo(()=>$S(e,n,f,a,r,"data"),[e,n,f,a,r]),h=w.useMemo(()=>$S(e,n,f,a,r,"assets"),[e,n,f,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let S=new Set,k=!1;if(n.forEach(P=>{var R;let M=a.routes[P.route.id];!M||!M.hasLoader||(!u.some(z=>z.route.id===P.route.id)&&P.route.id in d&&((R=o[P.route.id])!=null&&R.shouldRevalidate)||M.hasClientLoader?k=!0:S.add(P.route.id))}),S.size===0)return[];let T=FD(e,l);return k&&S.size>0&&T.searchParams.set("_routes",n.filter(P=>S.has(P.route.id)).map(P=>P.route.id).join(",")),[T.pathname+T.search]},[l,d,r,a,u,n,e,o]),b=w.useMemo(()=>ID(h,a),[h,a]),v=BD(h);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function VD(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var sk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{sk&&(window.__reactRouterVersion="7.6.0")}catch{}function HD({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=IP({window:t,v5Compat:!0}));let a=r.current,[o,l]=w.useState({action:a.action,location:a.location}),d=w.useCallback(f=>{w.startTransition(()=>l(f))},[l]);return w.useLayoutEffect(()=>a.listen(d),[a,d]),w.createElement(wD,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}var ok=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bs=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:o,replace:l,state:d,target:f,to:u,preventScrollReset:h,viewTransition:g,...b},v){let{basename:S}=w.useContext(no),k=typeof u=="string"&&ok.test(u),T,P=!1;if(typeof u=="string"&&k&&(T=u,sk))try{let W=new URL(window.location.href),I=u.startsWith("//")?new URL(W.protocol+u):new URL(u),F=Vl(I.pathname,S);I.origin===W.origin&&F!=null?u=F+I.search+I.hash:P=!0}catch{Zs(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=sD(u,{relative:a}),[R,z,$]=zD(r,b),L=QD(u,{replace:l,state:d,target:f,preventScrollReset:h,relative:a,viewTransition:g});function U(W){n&&n(W),W.defaultPrevented||L(W)}let B=w.createElement("a",{...b,...$,href:T||M,onClick:P||o?n:U,ref:VD(v,z),target:f,"data-discover":!k&&t==="render"?"true":void 0});return R&&!k?w.createElement(w.Fragment,null,B,w.createElement(UD,{page:M})):B});bs.displayName="Link";var GD=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:o,to:l,viewTransition:d,children:f,...u},h){let g=sg(l,{relative:u.relative}),b=qr(),v=w.useContext(wb),{navigator:S,basename:k}=w.useContext(no),T=v!=null&&eI(g)&&d===!0,P=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,M=b.pathname,R=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(M=M.toLowerCase(),R=R?R.toLowerCase():null,P=P.toLowerCase()),R&&k&&(R=Vl(R,k)||R);const z=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let $=M===P||!a&&M.startsWith(P)&&M.charAt(z)==="/",L=R!=null&&(R===P||!a&&R.startsWith(P)&&R.charAt(P.length)==="/"),U={isActive:$,isPending:L,isTransitioning:T},B=$?n:void 0,W;typeof r=="function"?W=r(U):W=[r,$?"active":null,L?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let I=typeof o=="function"?o(U):o;return w.createElement(bs,{...u,"aria-current":B,className:W,ref:h,style:I,to:l,viewTransition:d},typeof f=="function"?f(U):f)});GD.displayName="NavLink";var YD=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:o,method:l=Ox,action:d,onSubmit:f,relative:u,preventScrollReset:h,viewTransition:g,...b},v)=>{let S=XD(),k=ZD(d,{relative:u}),T=l.toLowerCase()==="get"?"get":"post",P=typeof d=="string"&&ok.test(d),M=R=>{if(f&&f(R),R.defaultPrevented)return;R.preventDefault();let z=R.nativeEvent.submitter,$=(z==null?void 0:z.getAttribute("formmethod"))||l;S(z||R.currentTarget,{fetcherKey:n,method:$,navigate:t,replace:a,state:o,relative:u,preventScrollReset:h,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:r?f:M,...b,"data-discover":!P&&e==="render"?"true":void 0})});YD.displayName="Form";function WD(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lk(e){let n=w.useContext(qh);return xr(n,WD(e)),n}function QD(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:o,viewTransition:l}={}){let d=At(),f=qr(),u=sg(e,{relative:o});return w.useCallback(h=>{if(jD(h,n)){h.preventDefault();let g=t!==void 0?t:Wm(f)===Wm(u);d(e,{replace:g,state:r,preventScrollReset:a,relative:o,viewTransition:l})}},[f,d,u,t,r,n,e,a,o,l])}var JD=0,KD=()=>`__${String(++JD)}__`;function XD(){let{router:e}=lk("useSubmit"),{basename:n}=w.useContext(no),t=yD();return w.useCallback(async(r,a={})=>{let{action:o,method:l,encType:d,formData:f,body:u}=ED(r,n);if(a.navigate===!1){let h=a.fetcherKey||KD();await e.fetch(h,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function ZD(e,{relative:n}={}){let{basename:t}=w.useContext(no),r=w.useContext(ro);xr(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...sg(e||".",{relative:n})},l=qr();if(e==null){o.search=l.search;let d=new URLSearchParams(o.search),f=d.getAll("index");if(f.some(h=>h==="")){d.delete("index"),f.filter(g=>g).forEach(g=>d.append("index",g));let h=d.toString();o.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Bl([t,o.pathname])),Wm(o)}function eI(e,n={}){let t=w.useContext(Zj);xr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=lk("useViewTransitionState"),a=sg(e,{relative:n.relative});if(!t.isTransitioning)return!1;let o=Vl(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=Vl(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Qx(a.pathname,l)!=null||Qx(a.pathname,o)!=null}[...LD];var tI=Yj();class nI extends w.Component{constructor(){super(...arguments);Qn(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}const ck=w.createContext(void 0),rI=({children:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState({startDate:null,endDate:null}),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(()=>t(!0),[]),h=w.useCallback(()=>t(!1),[]),g=w.useCallback(()=>t(M=>!M),[]),b=w.useCallback(M=>{f(()=>M)},[]),v=w.useCallback(M=>{d?d(M):console.warn("Analysis navigator not registered")},[d]),[S,k]=w.useState(null),T=w.useCallback(M=>{k(()=>M)},[]),P=w.useCallback(async()=>S?await S():(console.warn("Analysis refresher not registered"),null),[S]);return i.jsx(ck.Provider,{value:{isOpen:n,openAssistant:u,closeAssistant:h,toggleAssistant:g,analysisDateRange:r,setAnalysisDateRange:a,analysisData:o,setAnalysisData:l,analysisNavigate:v,registerAnalysisNavigator:b,refreshAnalysis:P,registerAnalysisRefresher:T},children:e})},xw=()=>{const e=w.useContext(ck);if(e===void 0)throw new Error("useClinicAssistantContext must be used within a ClinicAssistantProvider");return e},uk=w.createContext(void 0),iI=({children:e})=>{const[n,t]=w.useState([]),[r,a]=w.useState(null),[o,l]=w.useState(""),[d,f]=w.useState(0),[u,h]=w.useState([]),g=w.useCallback(k=>{t(T=>[...T,k])},[]),b=w.useCallback((k,T)=>{t(P=>P.map(M=>M.id===k?{...M,...T}:M))},[]),v=w.useCallback(k=>{t(T=>T.filter(P=>P.id!==k))},[]),S=w.useCallback(()=>{t([]),a(null),l(""),f(0),h([])},[]);return i.jsx(uk.Provider,{value:{purchaseRows:n,setPurchaseRows:t,selectedDistributor:r,setSelectedDistributor:a,searchTerm:o,setSearchTerm:l,amountPaidToDistributor:d,setAmountPaidToDistributor:f,distributors:u,setDistributors:h,addPurchaseRow:g,updatePurchaseRow:b,removePurchaseRow:v,resetPurchase:S},children:e})},dk=()=>{const e=w.useContext(uk);if(!e)throw new Error("usePurchaseContext must be used within a PurchaseProvider");return e},fk=w.createContext(void 0),aI=({children:e})=>{const[n,t]=w.useState(!1),r=w.useCallback(()=>t(!0),[]),a=w.useCallback(()=>t(!1),[]),o=w.useCallback(()=>t(l=>!l),[]);return w.useEffect(()=>{const l=d=>{(d.ctrlKey||d.metaKey)&&d.key==="k"&&(d.preventDefault(),o()),d.key==="Escape"&&n&&a()};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[n,o,a]),i.jsx(fk.Provider,{value:{isOpen:n,openCommandBar:r,closeCommandBar:a,toggleCommandBar:o},children:e})},Nb=()=>{const e=w.useContext(fk);if(e===void 0)throw new Error("useCommandBar must be used within a CommandBarProvider");return e};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let sI,oI;function lI(){return{geminiUrl:sI,vertexUrl:oI}}function cI(e,n,t){var r,a,o;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=lI();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(o=l.geminiUrl)!==null&&o!==void 0?o:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class og{}function qt(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const o=n[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function _(e,n,t){for(let o=0;o<n.length-1;o++){const l=n[o];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in e))if(Array.isArray(t))e[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[d])){const f=e[d];if(Array.isArray(t))for(let u=0;u<f.length;u++){const h=f[u];_(h,n.slice(o+1),t[u])}else for(const u of f)_(u,n.slice(o+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in e||(e[d]=[{}]);const f=e[d];_(f[0],n.slice(o+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const o=e[a];return Array.isArray(o)?o.map(l=>C(l,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function br(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function hk(e,n){const t=br(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function pk(e,n){return Array.isArray(n)?n.map(t=>Jx(e,t)):[Jx(e,n)]}function Jx(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function uI(e,n){const t=Jx(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function dI(e,n){const t=Jx(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function zS(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function mk(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>zS(e,t)):[zS(e,n)]}function s1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function US(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function BS(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function fa(e,n){if(n==null)throw new Error("ContentUnion is required");return s1(n)?n:{role:"user",parts:mk(e,n)}}function gk(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=fa(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=fa(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>fa(e,t)):[fa(e,n)]}function uu(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(US(n)||BS(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[fa(e,n)]}const t=[],r=[],a=s1(n[0]);for(const o of n){const l=s1(o);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(o);else{if(US(o)||BS(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(o)}}return a||t.push({role:"user",parts:mk(e,r)}),t}function yk(e,n){return n}function xk(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Cb(e,n){return n}function _b(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function fI(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function du(e,n){if(typeof n!="string")throw new Error("name must be a string");return fI(e,n,"cachedContents")}function bk(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function fu(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function hI(e){return e!=null&&typeof e=="object"&&"name"in e}function pI(e){return e!=null&&typeof e=="object"&&"video"in e}function mI(e){return e!=null&&typeof e=="object"&&"uri"in e}function vk(e,n){var t;let r;if(hI(n)&&(r=n.name),!(mI(n)&&(r=n.uri,r===void 0))&&!(pI(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const o=r.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${r}`);r=o[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function wk(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function Sk(e,n){for(const t of["models","tunedModels","publisherModels"])if(gI(n,t))return n[t];return[]}function gI(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yI(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function xI(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],yI(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function qS(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>xI(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function bI(){return{}}function vI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function wI(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],vI(e,r)),t}function SI(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],bI());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],wI(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function NI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function CI(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],NI(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function _I(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=uu(e,d);Array.isArray(g)&&(g=g.map(b=>qS(e,b))),_(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&_(t,["systemInstruction"],qS(e,fa(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>SI(e,b))),_(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&_(t,["toolConfig"],CI(e,h)),r}function jI(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],hk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],_I(e,a,t)),t}function kI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],du(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function TI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],du(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function EI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function AI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],du(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],EI(e,a,t)),t}function PI(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function DI(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],PI(e,r,t)),t}function II(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function RI(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],II(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function VS(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>RI(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function MI(){return{}}function OI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function LI(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],OI(e,r)),t}function FI(){return{}}function $I(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function zI(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],$I(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function UI(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],zI(e,r)),t}function BI(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],MI());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],LI(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],FI());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],UI(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function qI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function VI(e,n){const t={},r=C(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function HI(e,n){const t={},r=C(n,["latLng"]);return r!=null&&_(t,["latLng"],VI(e,r)),t}function GI(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],qI(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],HI(e,a)),t}function YI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=uu(e,d);Array.isArray(g)&&(g=g.map(b=>VS(e,b))),_(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&_(t,["systemInstruction"],VS(e,fa(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>BI(e,b))),_(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&_(t,["toolConfig"],GI(e,h)),r}function WI(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],hk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],YI(e,a,t)),t}function QI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],du(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function JI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],du(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function KI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function XI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],du(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],KI(e,a,t)),t}function ZI(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function eR(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],ZI(e,r,t)),t}function Fx(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["model"]);o!=null&&_(t,["model"],o);const l=C(n,["createTime"]);l!=null&&_(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&_(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function tR(){return{}}function nR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Fx(e,l))),_(t,["cachedContents"],o)}return t}function $x(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["model"]);o!=null&&_(t,["model"],o);const l=C(n,["createTime"]);l!=null&&_(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&_(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function rR(){return{}}function iR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>$x(e,l))),_(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Oh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Oh||(Oh={}));class jb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,o;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var HS;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(HS||(HS={}));var GS;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(GS||(GS={}));var YS;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(YS||(YS={}));var WS;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(WS||(WS={}));var QS;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(QS||(QS={}));var JS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(JS||(JS={}));var KS;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(KS||(KS={}));var Lh;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Lh||(Lh={}));var XS;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(XS||(XS={}));var ZS;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(ZS||(ZS={}));var eN;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(eN||(eN={}));var tN;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(tN||(tN={}));var nN;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(nN||(nN={}));var ou;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(ou||(ou={}));var rN;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(rN||(rN={}));var o1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(o1||(o1={}));var iN;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(iN||(iN={}));var aN;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(aN||(aN={}));var sN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(sN||(sN={}));var oN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(oN||(oN={}));var lN;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(lN||(lN={}));var cN;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(cN||(cN={}));var uN;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(uN||(uN={}));var dN;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(dN||(dN={}));var fN;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(fN||(fN={}));var hN;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(hN||(hN={}));var pN;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(pN||(pN={}));var mN;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(mN||(mN={}));var gN;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(gN||(gN={}));var yN;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(yN||(yN={}));var xN;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(xN||(xN={}));var bN;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(bN||(bN={}));var vN;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(vN||(vN={}));var wN;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(wN||(wN={}));class fx{get text(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",h=!1;const g=[];for(const b of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;h=!0,u+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?u:void 0}get data(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const h=[];for(const g of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&h.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(u+=atob(g.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.output}}class SN{}class NN{}class aR{}class sR{}class CN{}class _N{}class jN{}class oR{}class kN{}class TN{}class EN{}class lR{}class l1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class cR{}class uR{}class dR{get text(){var n,t,r;let a="",o=!1;const l=[];for(const d of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,u]of Object.entries(d))f!=="text"&&f!=="thought"&&u!==null&&l.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;o=!0,a+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var n,t,r;let a="";const o=[];for(const l of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(l))d!=="inlineData"&&f!==null&&o.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fR extends og{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new jb(Oh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=WI(this.apiClient,n);return d=qt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>$x(this.apiClient,h))}else{const u=jI(this.apiClient,n);return d=qt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>Fx(this.apiClient,h))}}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=QI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>$x(this.apiClient,h))}else{const u=kI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>Fx(this.apiClient,h))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=JI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=rR(),g=new TN;return Object.assign(g,h),g})}else{const u=TI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(()=>{const h=tR(),g=new TN;return Object.assign(g,h),g})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=XI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>$x(this.apiClient,h))}else{const u=AI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>Fx(this.apiClient,h))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=eR(this.apiClient,n);return d=qt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=iR(this.apiClient,h),b=new EN;return Object.assign(b,g),b})}else{const u=DI(this.apiClient,n);return d=qt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=nR(this.apiClient,h),b=new EN;return Object.assign(b,g),b})}}}function AN(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ii(e){return this instanceof Ii?(this.v=e,this):new Ii(e)}function Kx(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function d(v,S){r[v]&&(a[v]=function(k){return new Promise(function(T,P){o.push([v,k,T,P])>1||f(v,k)})},S&&(a[v]=S(a[v])))}function f(v,S){try{u(r[v](S))}catch(k){b(o[0][3],k)}}function u(v){v.value instanceof Ii?Promise.resolve(v.value.v).then(h,g):b(o[0][2],v)}function h(v){f("next",v)}function g(v){f("throw",v)}function b(v,S){v(S),o.shift(),o.length&&f(o[0][0],o[0][1])}}function c1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof AN=="function"?AN(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=e[o]&&function(l){return new Promise(function(d,f){l=e[o](l),a(d,f,l.done,l.value)})}}function a(o,l,d,f){Promise.resolve(f).then(function(u){o({value:u,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hR(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:Nk(t)}function Nk(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function pR(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function mR(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const o=[];let l=!0;for(;r<t&&e[r].role==="model";)o.push(e[r]),l&&!Nk(e[r])&&(l=!1),r++;l&&(n.push(a),n.push(...o))}return n}class gR{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new yR(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class yR{constructor(n,t,r,a={},o=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),pR(o)}async sendMessage(n){var t;await this.sendPromise;const r=fa(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l;const f=(l=(o=(await a).candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,u=f?[f]:[];this.recordHistory(r,u)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=fa(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,r)}getHistory(n=!1){return n?mR(this.history):this.history}processStreamResponse(n,t){var r,a;return Kx(this,arguments,function*(){var l,d,f,u;const h=[];try{for(var g=!0,b=c1(n),v;v=yield Ii(b.next()),l=v.done,!l;g=!0){u=v.value,g=!1;const S=u;if(hR(S)){const k=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&h.push(k)}yield yield Ii(S)}}catch(S){d={error:S}}finally{try{!g&&!l&&(f=b.return)&&(yield Ii(f.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,h)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xR(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function bR(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],xR(e,r,t)),t}function vR(e,n){const t={},r=C(n,["details"]);r!=null&&_(t,["details"],r);const a=C(n,["message"]);a!=null&&_(t,["message"],a);const o=C(n,["code"]);return o!=null&&_(t,["code"],o),t}function wR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&_(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&_(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const h=C(n,["sha256Hash"]);h!=null&&_(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&_(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&_(t,["state"],v);const S=C(n,["source"]);S!=null&&_(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&_(t,["error"],vR(e,T)),t}function SR(e,n){const t={},r=C(n,["file"]);r!=null&&_(t,["file"],wR(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function NR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","file"],vk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function CR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","file"],vk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function _R(e,n){const t={},r=C(n,["details"]);r!=null&&_(t,["details"],r);const a=C(n,["message"]);a!=null&&_(t,["message"],a);const o=C(n,["code"]);return o!=null&&_(t,["code"],o),t}function u1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&_(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&_(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const h=C(n,["sha256Hash"]);h!=null&&_(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&_(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&_(t,["state"],v);const S=C(n,["source"]);S!=null&&_(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&_(t,["error"],_R(e,T)),t}function jR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["files"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>u1(e,l))),_(t,["files"],o)}return t}function kR(){return{}}function TR(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ER extends og{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new jb(Oh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>u1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=bR(this.apiClient,n);return o=qt("files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=jR(this.apiClient,f),h=new lR;return Object.assign(h,u),h})}}async createInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=SR(this.apiClient,n);return o=qt("upload/v1beta/files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=kR(),u=new cR;return Object.assign(u,f),u})}}async get(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=NR(this.apiClient,n);return o=qt("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>u1(this.apiClient,f))}}async delete(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=CR(this.apiClient,n);return o=qt("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=TR(),u=new uR;return Object.assign(u,f),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AR(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function PR(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function DR(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],AR(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function IR(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],PR(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function RR(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>DR(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function MR(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>IR(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function OR(){return{}}function LR(){return{}}function FR(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function $R(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function zR(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],FR(e,r)),t}function UR(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],$R(e,r)),t}function BR(){return{}}function qR(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function VR(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],qR(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function HR(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],VR(e,r)),t}function GR(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],OR());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],zR(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function YR(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],LR());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],UR(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],BR());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],HR(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function WR(e,n){const t={},r=C(n,["handle"]);if(r!=null&&_(t,["handle"],r),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function QR(e,n){const t={},r=C(n,["handle"]);r!=null&&_(t,["handle"],r);const a=C(n,["transparent"]);return a!=null&&_(t,["transparent"],a),t}function PN(){return{}}function DN(){return{}}function JR(e,n){const t={},r=C(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&_(t,["silenceDurationMs"],d),t}function KR(e,n){const t={},r=C(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&_(t,["silenceDurationMs"],d),t}function XR(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],JR(e,r));const a=C(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function ZR(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],KR(e,r));const a=C(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function eM(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function tM(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function nM(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],eM(e,a)),t}function rM(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],tM(e,a)),t}function iM(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],RR(e,fa(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let z=_b(e,S);Array.isArray(z)&&(z=z.map($=>GR(e,Cb(e,$)))),_(t,["setup","tools"],z)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],WR(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],PN());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&_(t,["setup","outputAudioTranscription"],PN());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&_(t,["setup","realtimeInputConfig"],XR(e,M));const R=C(n,["contextWindowCompression"]);return t!==void 0&&R!=null&&_(t,["setup","contextWindowCompression"],nM(e,R)),r}function aM(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],MR(e,fa(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let z=_b(e,S);Array.isArray(z)&&(z=z.map($=>YR(e,Cb(e,$)))),_(t,["setup","tools"],z)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],QR(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],DN());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&_(t,["setup","outputAudioTranscription"],DN());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&_(t,["setup","realtimeInputConfig"],ZR(e,M));const R=C(n,["contextWindowCompression"]);return t!==void 0&&R!=null&&_(t,["setup","contextWindowCompression"],rM(e,R)),r}function sM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["setup","model"],br(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],iM(e,a,t)),t}function oM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["setup","model"],br(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],aM(e,a,t)),t}function lM(){return{}}function cM(){return{}}function uM(){return{}}function dM(){return{}}function fM(e,n){const t={},r=C(n,["media"]);r!=null&&_(t,["mediaChunks"],pk(e,r));const a=C(n,["audio"]);a!=null&&_(t,["audio"],dI(e,a));const o=C(n,["audioStreamEnd"]);o!=null&&_(t,["audioStreamEnd"],o);const l=C(n,["video"]);l!=null&&_(t,["video"],uI(e,l));const d=C(n,["text"]);return d!=null&&_(t,["text"],d),C(n,["activityStart"])!=null&&_(t,["activityStart"],lM()),C(n,["activityEnd"])!=null&&_(t,["activityEnd"],uM()),t}function hM(e,n){const t={},r=C(n,["media"]);if(r!=null&&_(t,["mediaChunks"],pk(e,r)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&_(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&_(t,["activityStart"],cM()),C(n,["activityEnd"])!=null&&_(t,["activityEnd"],dM()),t}function pM(){return{}}function mM(){return{}}function gM(e,n){const t={},r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function yM(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function xM(e,n){const t={},r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],gM(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function bM(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],yM(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function vM(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>xM(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function wM(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>bM(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function IN(e,n){const t={},r=C(n,["text"]);r!=null&&_(t,["text"],r);const a=C(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function RN(e,n){const t={},r=C(n,["text"]);r!=null&&_(t,["text"],r);const a=C(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function SM(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],vM(e,r));const a=C(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&_(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&_(t,["inputTranscription"],IN(e,f));const u=C(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],IN(e,u)),t}function NM(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],wM(e,r));const a=C(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&_(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&_(t,["inputTranscription"],RN(e,f));const u=C(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],RN(e,u)),t}function CM(e,n){const t={},r=C(n,["id"]);r!=null&&_(t,["id"],r);const a=C(n,["args"]);a!=null&&_(t,["args"],a);const o=C(n,["name"]);return o!=null&&_(t,["name"],o),t}function _M(e,n){const t={},r=C(n,["args"]);r!=null&&_(t,["args"],r);const a=C(n,["name"]);return a!=null&&_(t,["name"],a),t}function jM(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>CM(e,o))),_(t,["functionCalls"],a)}return t}function kM(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>_M(e,o))),_(t,["functionCalls"],a)}return t}function TM(e,n){const t={},r=C(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function EM(e,n){const t={},r=C(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function hx(e,n){const t={},r=C(n,["modality"]);r!=null&&_(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function px(e,n){const t={},r=C(n,["modality"]);r!=null&&_(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function AM(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=C(n,["responseTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&_(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&_(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(S=>hx(e,S))),_(t,["promptTokensDetails"],v)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(S=>hx(e,S))),_(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>hx(e,S))),_(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>hx(e,S))),_(t,["toolUsePromptTokensDetails"],v)}return t}function PM(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=C(n,["candidatesTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&_(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&_(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(k=>px(e,k))),_(t,["promptTokensDetails"],S)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(k=>px(e,k))),_(t,["cacheTokensDetails"],S)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>px(e,k))),_(t,["responseTokensDetails"],S)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>px(e,k))),_(t,["toolUsePromptTokensDetails"],S)}const v=C(n,["trafficType"]);return v!=null&&_(t,["trafficType"],v),t}function DM(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function IM(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function RM(e,n){const t={},r=C(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function MM(e,n){const t={},r=C(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function OM(e,n){const t={};C(n,["setupComplete"])!=null&&_(t,["setupComplete"],pM());const a=C(n,["serverContent"]);a!=null&&_(t,["serverContent"],SM(e,a));const o=C(n,["toolCall"]);o!=null&&_(t,["toolCall"],jM(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],TM(e,l));const d=C(n,["usageMetadata"]);d!=null&&_(t,["usageMetadata"],AM(e,d));const f=C(n,["goAway"]);f!=null&&_(t,["goAway"],DM(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],RM(e,u)),t}function LM(e,n){const t={};C(n,["setupComplete"])!=null&&_(t,["setupComplete"],mM());const a=C(n,["serverContent"]);a!=null&&_(t,["serverContent"],NM(e,a));const o=C(n,["toolCall"]);o!=null&&_(t,["toolCall"],kM(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],EM(e,l));const d=C(n,["usageMetadata"]);d!=null&&_(t,["usageMetadata"],PM(e,d));const f=C(n,["goAway"]);f!=null&&_(t,["goAway"],IM(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],MM(e,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FM(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function $M(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],FM(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function kb(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>$M(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function zM(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=C(n,["category"]);r!=null&&_(t,["category"],r);const a=C(n,["threshold"]);return a!=null&&_(t,["threshold"],a),t}function UM(){return{}}function BM(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function qM(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],BM(e,r)),t}function VM(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],UM());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],qM(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function HM(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function GM(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],HM(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function YM(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function WM(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],YM(e,r)),t}function QM(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],WM(e,r));const a=C(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function JM(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function KM(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],kb(e,fa(e,a)));const o=C(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&_(r,["topP"],l);const d=C(n,["topK"]);d!=null&&_(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&_(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const h=C(n,["stopSequences"]);h!=null&&_(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&_(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const P=C(n,["responseSchema"]);if(P!=null&&_(r,["responseSchema"],yk(e,P)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=C(n,["safetySettings"]);if(t!==void 0&&M!=null){let I=M;Array.isArray(I)&&(I=I.map(F=>zM(e,F))),_(t,["safetySettings"],I)}const R=C(n,["tools"]);if(t!==void 0&&R!=null){let I=_b(e,R);Array.isArray(I)&&(I=I.map(F=>VM(e,Cb(e,F)))),_(t,["tools"],I)}const z=C(n,["toolConfig"]);if(t!==void 0&&z!=null&&_(t,["toolConfig"],GM(e,z)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const $=C(n,["cachedContent"]);t!==void 0&&$!=null&&_(t,["cachedContent"],du(e,$));const L=C(n,["responseModalities"]);L!=null&&_(r,["responseModalities"],L);const U=C(n,["mediaResolution"]);U!=null&&_(r,["mediaResolution"],U);const B=C(n,["speechConfig"]);if(B!=null&&_(r,["speechConfig"],QM(e,xk(e,B))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const W=C(n,["thinkingConfig"]);return W!=null&&_(r,["thinkingConfig"],JM(e,W)),r}function MN(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["contents"]);if(a!=null){let l=uu(e,a);Array.isArray(l)&&(l=l.map(d=>kb(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["generationConfig"],KM(e,o,t)),t}function XM(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&_(t,["requests[]","taskType"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&_(t,["requests[]","title"],o);const l=C(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&_(t,["requests[]","outputDimensionality"],l),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function ZM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["contents"]);a!=null&&_(t,["requests[]","content"],gk(e,a));const o=C(n,["config"]);o!=null&&_(t,["config"],XM(e,o,t));const l=C(n,["model"]);return l!==void 0&&_(t,["requests[]","model"],br(e,l)),t}function e4(e,n,t){const r={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=C(n,["aspectRatio"]);t!==void 0&&o!=null&&_(t,["parameters","aspectRatio"],o);const l=C(n,["guidanceScale"]);if(t!==void 0&&l!=null&&_(t,["parameters","guidanceScale"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=C(n,["safetyFilterLevel"]);t!==void 0&&d!=null&&_(t,["parameters","safetySetting"],d);const f=C(n,["personGeneration"]);t!==void 0&&f!=null&&_(t,["parameters","personGeneration"],f);const u=C(n,["includeSafetyAttributes"]);t!==void 0&&u!=null&&_(t,["parameters","includeSafetyAttributes"],u);const h=C(n,["includeRaiReason"]);t!==void 0&&h!=null&&_(t,["parameters","includeRaiReason"],h);const g=C(n,["language"]);t!==void 0&&g!=null&&_(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&_(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&_(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function t4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],e4(e,o,t)),t}function n4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],br(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function r4(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&_(t,["_url","models_url"],wk(e,d)),r}function i4(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],r4(e,r,t)),t}function a4(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function s4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],br(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a4(e,a,t)),t}function o4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],br(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function l4(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function c4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["contents"]);if(a!=null){let l=uu(e,a);Array.isArray(l)&&(l=l.map(d=>kb(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],l4(e,o)),t}function u4(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["imageBytes"]);r!=null&&_(t,["bytesBase64Encoded"],fu(e,r));const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function d4(e,n,t){const r={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=C(n,["durationSeconds"]);if(t!==void 0&&o!=null&&_(t,["parameters","durationSeconds"],o),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=C(n,["aspectRatio"]);if(t!==void 0&&l!=null&&_(t,["parameters","aspectRatio"],l),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const d=C(n,["personGeneration"]);if(t!==void 0&&d!=null&&_(t,["parameters","personGeneration"],d),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=C(n,["negativePrompt"]);if(t!==void 0&&f!=null&&_(t,["parameters","negativePrompt"],f),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function f4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&_(t,["instances[0]","image"],u4(e,o));const l=C(n,["config"]);return l!=null&&_(t,["config"],d4(e,l,t)),t}function h4(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function p4(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],h4(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function Hh(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>p4(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function m4(e,n){const t={},r=C(n,["featureSelectionPreference"]);return r!=null&&_(t,["featureSelectionPreference"],r),t}function g4(e,n){const t={},r=C(n,["method"]);r!=null&&_(t,["method"],r);const a=C(n,["category"]);a!=null&&_(t,["category"],a);const o=C(n,["threshold"]);return o!=null&&_(t,["threshold"],o),t}function y4(){return{}}function x4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function b4(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],x4(e,r)),t}function v4(){return{}}function w4(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function S4(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],w4(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function N4(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],S4(e,r)),t}function Ck(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],y4());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],b4(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],v4());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],N4(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function C4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function _4(e,n){const t={},r=C(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function j4(e,n){const t={},r=C(n,["latLng"]);return r!=null&&_(t,["latLng"],_4(e,r)),t}function k4(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],C4(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],j4(e,a)),t}function T4(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function E4(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],T4(e,r)),t}function A4(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],E4(e,r));const a=C(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function P4(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function D4(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Hh(e,fa(e,a)));const o=C(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&_(r,["topP"],l);const d=C(n,["topK"]);d!=null&&_(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&_(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const h=C(n,["stopSequences"]);h!=null&&_(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&_(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const P=C(n,["responseSchema"]);P!=null&&_(r,["responseSchema"],yk(e,P));const M=C(n,["routingConfig"]);M!=null&&_(r,["routingConfig"],M);const R=C(n,["modelSelectionConfig"]);R!=null&&_(r,["modelConfig"],m4(e,R));const z=C(n,["safetySettings"]);if(t!==void 0&&z!=null){let ie=z;Array.isArray(ie)&&(ie=ie.map(G=>g4(e,G))),_(t,["safetySettings"],ie)}const $=C(n,["tools"]);if(t!==void 0&&$!=null){let ie=_b(e,$);Array.isArray(ie)&&(ie=ie.map(G=>Ck(e,Cb(e,G)))),_(t,["tools"],ie)}const L=C(n,["toolConfig"]);t!==void 0&&L!=null&&_(t,["toolConfig"],k4(e,L));const U=C(n,["labels"]);t!==void 0&&U!=null&&_(t,["labels"],U);const B=C(n,["cachedContent"]);t!==void 0&&B!=null&&_(t,["cachedContent"],du(e,B));const W=C(n,["responseModalities"]);W!=null&&_(r,["responseModalities"],W);const I=C(n,["mediaResolution"]);I!=null&&_(r,["mediaResolution"],I);const F=C(n,["speechConfig"]);F!=null&&_(r,["speechConfig"],A4(e,xk(e,F)));const V=C(n,["audioTimestamp"]);V!=null&&_(r,["audioTimestamp"],V);const re=C(n,["thinkingConfig"]);return re!=null&&_(r,["thinkingConfig"],P4(e,re)),r}function ON(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["contents"]);if(a!=null){let l=uu(e,a);Array.isArray(l)&&(l=l.map(d=>Hh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["generationConfig"],D4(e,o,t)),t}function I4(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&_(t,["instances[]","task_type"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&_(t,["instances[]","title"],o);const l=C(n,["outputDimensionality"]);t!==void 0&&l!=null&&_(t,["parameters","outputDimensionality"],l);const d=C(n,["mimeType"]);t!==void 0&&d!=null&&_(t,["instances[]","mimeType"],d);const f=C(n,["autoTruncate"]);return t!==void 0&&f!=null&&_(t,["parameters","autoTruncate"],f),r}function R4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["contents"]);a!=null&&_(t,["instances[]","content"],gk(e,a));const o=C(n,["config"]);return o!=null&&_(t,["config"],I4(e,o,t)),t}function M4(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&_(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&_(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&_(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["addWatermark"]);t!==void 0&&P!=null&&_(t,["parameters","addWatermark"],P);const M=C(n,["enhancePrompt"]);return t!==void 0&&M!=null&&_(t,["parameters","enhancePrompt"],M),r}function O4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],M4(e,o,t)),t}function bw(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=C(n,["imageBytes"]);a!=null&&_(t,["bytesBase64Encoded"],fu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function L4(e,n){const t={},r=C(n,["maskMode"]);r!=null&&_(t,["maskMode"],r);const a=C(n,["segmentationClasses"]);a!=null&&_(t,["maskClasses"],a);const o=C(n,["maskDilation"]);return o!=null&&_(t,["dilation"],o),t}function F4(e,n){const t={},r=C(n,["controlType"]);r!=null&&_(t,["controlType"],r);const a=C(n,["enableControlImageComputation"]);return a!=null&&_(t,["computeControl"],a),t}function $4(e,n){const t={},r=C(n,["styleDescription"]);return r!=null&&_(t,["styleDescription"],r),t}function z4(e,n){const t={},r=C(n,["subjectType"]);r!=null&&_(t,["subjectType"],r);const a=C(n,["subjectDescription"]);return a!=null&&_(t,["subjectDescription"],a),t}function U4(e,n){const t={},r=C(n,["referenceImage"]);r!=null&&_(t,["referenceImage"],bw(e,r));const a=C(n,["referenceId"]);a!=null&&_(t,["referenceId"],a);const o=C(n,["referenceType"]);o!=null&&_(t,["referenceType"],o);const l=C(n,["maskImageConfig"]);l!=null&&_(t,["maskImageConfig"],L4(e,l));const d=C(n,["controlImageConfig"]);d!=null&&_(t,["controlImageConfig"],F4(e,d));const f=C(n,["styleImageConfig"]);f!=null&&_(t,["styleImageConfig"],$4(e,f));const u=C(n,["subjectImageConfig"]);return u!=null&&_(t,["subjectImageConfig"],z4(e,u)),t}function B4(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&_(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&_(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&_(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["editMode"]);t!==void 0&&P!=null&&_(t,["parameters","editMode"],P);const M=C(n,["baseSteps"]);return t!==void 0&&M!=null&&_(t,["parameters","editConfig","baseSteps"],M),r}function q4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["referenceImages"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>U4(e,f))),_(t,["instances[0]","referenceImages"],d)}const l=C(n,["config"]);return l!=null&&_(t,["config"],B4(e,l,t)),t}function V4(e,n,t){const r={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&_(t,["parameters","includeRaiReason"],a);const o=C(n,["outputMimeType"]);t!==void 0&&o!=null&&_(t,["parameters","outputOptions","mimeType"],o);const l=C(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&_(t,["parameters","outputOptions","compressionQuality"],l);const d=C(n,["numberOfImages"]);t!==void 0&&d!=null&&_(t,["parameters","sampleCount"],d);const f=C(n,["mode"]);return t!==void 0&&f!=null&&_(t,["parameters","mode"],f),r}function H4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["image"]);a!=null&&_(t,["instances[0]","image"],bw(e,a));const o=C(n,["upscaleFactor"]);o!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=C(n,["config"]);return l!=null&&_(t,["config"],V4(e,l,t)),t}function G4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],br(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function Y4(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&_(t,["_url","models_url"],wk(e,d)),r}function W4(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],Y4(e,r,t)),t}function Q4(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function J4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],Q4(e,a,t)),t}function K4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],br(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function X4(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Hh(e,fa(e,a)));const o=C(n,["tools"]);if(t!==void 0&&o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>Ck(e,f))),_(t,["tools"],d)}const l=C(n,["generationConfig"]);return t!==void 0&&l!=null&&_(t,["generationConfig"],l),r}function Z4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["contents"]);if(a!=null){let l=uu(e,a);Array.isArray(l)&&(l=l.map(d=>Hh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],X4(e,o,t)),t}function eO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["contents"]);if(a!=null){let l=uu(e,a);Array.isArray(l)&&(l=l.map(d=>Hh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],o),t}function tO(e,n,t){const r={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=C(n,["outputGcsUri"]);t!==void 0&&o!=null&&_(t,["parameters","storageUri"],o);const l=C(n,["fps"]);t!==void 0&&l!=null&&_(t,["parameters","fps"],l);const d=C(n,["durationSeconds"]);t!==void 0&&d!=null&&_(t,["parameters","durationSeconds"],d);const f=C(n,["seed"]);t!==void 0&&f!=null&&_(t,["parameters","seed"],f);const u=C(n,["aspectRatio"]);t!==void 0&&u!=null&&_(t,["parameters","aspectRatio"],u);const h=C(n,["resolution"]);t!==void 0&&h!=null&&_(t,["parameters","resolution"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&_(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&_(t,["parameters","negativePrompt"],v);const S=C(n,["enhancePrompt"]);return t!==void 0&&S!=null&&_(t,["parameters","enhancePrompt"],S),r}function nO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],br(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&_(t,["instances[0]","image"],bw(e,o));const l=C(n,["config"]);return l!=null&&_(t,["config"],tO(e,l,t)),t}function rO(e,n){const t={},r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function iO(e,n){const t={},r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],rO(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function aO(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>iO(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function sO(e,n){const t={},r=C(n,["citationSources"]);return r!=null&&_(t,["citations"],r),t}function oO(e,n){const t={},r=C(n,["content"]);r!=null&&_(t,["content"],aO(e,r));const a=C(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],sO(e,a));const o=C(n,["tokenCount"]);o!=null&&_(t,["tokenCount"],o);const l=C(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&_(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&_(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&_(t,["index"],u);const h=C(n,["logprobsResult"]);h!=null&&_(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function LN(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(f=>oO(e,f))),_(t,["candidates"],d)}const a=C(n,["modelVersion"]);a!=null&&_(t,["modelVersion"],a);const o=C(n,["promptFeedback"]);o!=null&&_(t,["promptFeedback"],o);const l=C(n,["usageMetadata"]);return l!=null&&_(t,["usageMetadata"],l),t}function lO(e,n){const t={},r=C(n,["values"]);return r!=null&&_(t,["values"],r),t}function cO(){return{}}function uO(e,n){const t={},r=C(n,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>lO(e,l))),_(t,["embeddings"],o)}return C(n,["metadata"])!=null&&_(t,["metadata"],cO()),t}function dO(e,n){const t={},r=C(n,["bytesBase64Encoded"]);r!=null&&_(t,["imageBytes"],fu(e,r));const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function _k(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function fO(e,n){const t={},r=C(n,["_self"]);r!=null&&_(t,["image"],dO(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=C(n,["_self"]);return o!=null&&_(t,["safetyAttributes"],_k(e,o)),t}function hO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>fO(e,l))),_(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],_k(e,a)),t}function pO(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function d1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);o!=null&&_(t,["description"],o);const l=C(n,["version"]);l!=null&&_(t,["version"],l);const d=C(n,["_self"]);d!=null&&_(t,["tunedModelInfo"],pO(e,d));const f=C(n,["inputTokenLimit"]);f!=null&&_(t,["inputTokenLimit"],f);const u=C(n,["outputTokenLimit"]);u!=null&&_(t,["outputTokenLimit"],u);const h=C(n,["supportedGenerationMethods"]);return h!=null&&_(t,["supportedActions"],h),t}function mO(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=Sk(e,a);Array.isArray(o)&&(o=o.map(l=>d1(e,l))),_(t,["models"],o)}return t}function gO(){return{}}function yO(e,n){const t={},r=C(n,["totalTokens"]);r!=null&&_(t,["totalTokens"],r);const a=C(n,["cachedContentTokenCount"]);return a!=null&&_(t,["cachedContentTokenCount"],a),t}function xO(e,n){const t={},r=C(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],fu(e,a));const o=C(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function bO(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],xO(e,r)),t}function vO(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>bO(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function wO(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&_(t,["response"],vO(e,d)),t}function SO(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function NO(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],SO(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function CO(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>NO(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function _O(e,n){const t={},r=C(n,["citations"]);return r!=null&&_(t,["citations"],r),t}function jO(e,n){const t={},r=C(n,["content"]);r!=null&&_(t,["content"],CO(e,r));const a=C(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],_O(e,a));const o=C(n,["finishMessage"]);o!=null&&_(t,["finishMessage"],o);const l=C(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&_(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&_(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&_(t,["index"],u);const h=C(n,["logprobsResult"]);h!=null&&_(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function FN(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>jO(e,h))),_(t,["candidates"],u)}const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["responseId"]);o!=null&&_(t,["responseId"],o);const l=C(n,["modelVersion"]);l!=null&&_(t,["modelVersion"],l);const d=C(n,["promptFeedback"]);d!=null&&_(t,["promptFeedback"],d);const f=C(n,["usageMetadata"]);return f!=null&&_(t,["usageMetadata"],f),t}function kO(e,n){const t={},r=C(n,["truncated"]);r!=null&&_(t,["truncated"],r);const a=C(n,["token_count"]);return a!=null&&_(t,["tokenCount"],a),t}function TO(e,n){const t={},r=C(n,["values"]);r!=null&&_(t,["values"],r);const a=C(n,["statistics"]);return a!=null&&_(t,["statistics"],kO(e,a)),t}function EO(e,n){const t={},r=C(n,["billableCharacterCount"]);return r!=null&&_(t,["billableCharacterCount"],r),t}function AO(e,n){const t={},r=C(n,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>TO(e,l))),_(t,["embeddings"],o)}const a=C(n,["metadata"]);return a!=null&&_(t,["metadata"],EO(e,a)),t}function PO(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["imageBytes"],fu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function jk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function vw(e,n){const t={},r=C(n,["_self"]);r!=null&&_(t,["image"],PO(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=C(n,["_self"]);o!=null&&_(t,["safetyAttributes"],jk(e,o));const l=C(n,["prompt"]);return l!=null&&_(t,["enhancedPrompt"],l),t}function DO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>vw(e,l))),_(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],jk(e,a)),t}function IO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>vw(e,o))),_(t,["generatedImages"],a)}return t}function RO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>vw(e,o))),_(t,["generatedImages"],a)}return t}function MO(e,n){const t={},r=C(n,["endpoint"]);r!=null&&_(t,["name"],r);const a=C(n,["deployedModelId"]);return a!=null&&_(t,["deployedModelId"],a),t}function OO(e,n){const t={},r=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function LO(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=C(n,["step"]);return o!=null&&_(t,["step"],o),t}function f1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);o!=null&&_(t,["description"],o);const l=C(n,["versionId"]);l!=null&&_(t,["version"],l);const d=C(n,["deployedModels"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(v=>MO(e,v))),_(t,["endpoints"],b)}const f=C(n,["labels"]);f!=null&&_(t,["labels"],f);const u=C(n,["_self"]);u!=null&&_(t,["tunedModelInfo"],OO(e,u));const h=C(n,["defaultCheckpointId"]);h!=null&&_(t,["defaultCheckpointId"],h);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>LO(e,v))),_(t,["checkpoints"],b)}return t}function FO(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=Sk(e,a);Array.isArray(o)&&(o=o.map(l=>f1(e,l))),_(t,["models"],o)}return t}function $O(){return{}}function zO(e,n){const t={},r=C(n,["totalTokens"]);return r!=null&&_(t,["totalTokens"],r),t}function UO(e,n){const t={},r=C(n,["tokensInfo"]);return r!=null&&_(t,["tokensInfo"],r),t}function BO(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],fu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function qO(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],BO(e,r)),t}function VO(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>qO(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function HO(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response"]);return d!=null&&_(t,["response"],VO(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GO="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function YO(e,n,t){const r=new dR;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const o=LM(e,a);Object.assign(r,o)}else{const o=OM(e,a);Object.assign(r,o)}n(r)}class WO{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,o;const l=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const u=XO(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const z=this.apiClient.getApiKey();f=`${l}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${z}`}let h=()=>{};const g=new Promise(z=>{h=z}),b=n.callbacks,v=function(){var z;(z=b==null?void 0:b.onopen)===null||z===void 0||z.call(b),h({})},S=this.apiClient,k={onopen:v,onmessage:z=>{YO(S,b.onmessage,z)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(z){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(z){}},T=this.webSocketFactory.create(f,KO(u),k);T.connect(),await g;let P=br(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const z=this.apiClient.getProject(),$=this.apiClient.getLocation();P=`projects/${z}/locations/${$}/`+P}let M={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[ou.AUDIO]}:n.config.responseModalities=[ou.AUDIO]),!((o=n.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const R={model:P,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?M=oM(this.apiClient,R):M=sM(this.apiClient,R),delete M.config,T.send(JSON.stringify(M)),new JO(T,this.apiClient)}}const QO={turnComplete:!0};class JO{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=uu(n,t.turns),n.isVertexAI()?r=r.map(a=>Hh(n,a)):r=r.map(a=>kb(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!n.isVertexAI()&&!("id"in o))throw new Error(GO)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},QO),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:hM(this.apiClient,n)}:t={realtimeInput:fM(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function KO(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function XO(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZO extends og{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let o;const l=[];if(r!=null&&r.generatedImages)for(const f of r.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((a=f==null?void 0:f.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=f==null?void 0:f.safetyAttributes:l.push(f);let d;return o?d={generatedImages:l,positivePromptSafetyAttributes:o}:d={generatedImages:l},d}),this.list=async t=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new jb(Oh.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=ON(this.apiClient,n);return d=qt("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=FN(this.apiClient,h),b=new fx;return Object.assign(b,g),b})}else{const u=MN(this.apiClient,n);return d=qt("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=LN(this.apiClient,h),b=new fx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=ON(this.apiClient,n);d=qt("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const h=this.apiClient;return l=h.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(g){return Kx(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=c1(g),M;M=yield Ii(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const z=FN(h,yield Ii(k.json())),$=new fx;Object.assign($,z),yield yield Ii($)}}catch(R){v={error:R}}finally{try{!T&&!b&&(S=P.return)&&(yield Ii(S.call(P)))}finally{if(v)throw v.error}}})})}else{const u=MN(this.apiClient,n);d=qt("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const h=this.apiClient;return l=h.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(g){return Kx(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=c1(g),M;M=yield Ii(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const z=LN(h,yield Ii(k.json())),$=new fx;Object.assign($,z),yield yield Ii($)}}catch(R){v={error:R}}finally{try{!T&&!b&&(S=P.return)&&(yield Ii(S.call(P)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=R4(this.apiClient,n);return d=qt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=AO(this.apiClient,h),b=new SN;return Object.assign(b,g),b})}else{const u=ZM(this.apiClient,n);return d=qt("{model}:batchEmbedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=uO(this.apiClient,h),b=new SN;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=O4(this.apiClient,n);return d=qt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=DO(this.apiClient,h),b=new NN;return Object.assign(b,g),b})}else{const u=t4(this.apiClient,n);return d=qt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=hO(this.apiClient,h),b=new NN;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=q4(this.apiClient,n);return o=qt("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=IO(this.apiClient,f),h=new aR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=H4(this.apiClient,n);return o=qt("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=RO(this.apiClient,f),h=new sR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=G4(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>f1(this.apiClient,h))}else{const u=n4(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>d1(this.apiClient,h))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=W4(this.apiClient,n);return d=qt("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=FO(this.apiClient,h),b=new CN;return Object.assign(b,g),b})}else{const u=i4(this.apiClient,n);return d=qt("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=mO(this.apiClient,h),b=new CN;return Object.assign(b,g),b})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=J4(this.apiClient,n);return d=qt("{model}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>f1(this.apiClient,h))}else{const u=s4(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>d1(this.apiClient,h))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=K4(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=$O(),g=new _N;return Object.assign(g,h),g})}else{const u=o4(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(()=>{const h=gO(),g=new _N;return Object.assign(g,h),g})}}async countTokens(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=Z4(this.apiClient,n);return d=qt("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=zO(this.apiClient,h),b=new jN;return Object.assign(b,g),b})}else{const u=c4(this.apiClient,n);return d=qt("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=yO(this.apiClient,h),b=new jN;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=eO(this.apiClient,n);return o=qt("{model}:computeTokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=UO(this.apiClient,f),h=new oR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=nO(this.apiClient,n);return d=qt("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>HO(this.apiClient,h))}else{const u=f4(this.apiClient,n);return d=qt("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>wO(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eL(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function tL(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function nL(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["operationName"],r);const a=C(n,["resourceName"]);a!=null&&_(t,["_url","resourceName"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],o),t}function rL(e,n){const t={},r=C(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],fu(e,a));const o=C(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function iL(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],rL(e,r)),t}function aL(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>iL(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function sL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&_(t,["response"],aL(e,d)),t}function oL(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],fu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function lL(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],oL(e,r)),t}function cL(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>lL(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function $N(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response"]);return d!=null&&_(t,["response"],cL(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uL extends og{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let o;return r&&"httpOptions"in r&&(o=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=tL(this.apiClient,n);return d=qt("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>$N(this.apiClient,h))}else{const u=eL(this.apiClient,n);return d=qt("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>sL(this.apiClient,h))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=nL(this.apiClient,n);return o=qt("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>$N(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dL="Content-Type",fL="X-Server-Timeout",hL="User-Agent",pL="x-goog-api-client",mL="0.14.1",gL=`google-genai-sdk/${mL}`,yL="v1beta1",xL="v1beta",zN=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class kk extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class h1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class bL{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:yL,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:xL,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[l,d]of Object.entries(n.queryParams))a.searchParams.append(l,String(d));let o={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=n.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.unaryApiCall(a,o,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,o]of Object.entries(t))typeof o=="object"?r[a]=Object.assign(Object.assign({},r[a]),o):o!==void 0&&(r[a]=o);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=n.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.streamApiCall(a,o,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,o=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=o}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await UN(a),new l1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await UN(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return Kx(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:d,value:f}=yield Ii(a.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(f);try{const g=JSON.parse(u);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new kk(k);if(S>=500&&S<600)throw new h1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=u;let h=l.match(zN);for(;h;){const g=h[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Ii(new l1(b)),l=l.slice(h[0].length),h=l.match(zN)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=gL+" "+this.clientOptions.userAgentExtra;return n[hL]=t,n[pL]=t,n[dL]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(fL,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,l=await o.stat(n);a.sizeBytes=String(l.size);const d=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=d;const f=await this.fetchUploadUrl(a,t);return o.upload(n,f,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const o={file:n},l=await this.request({path:qt("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function UN(e){var n;if(e===void 0)throw new h1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new kk(o):t>=500&&t<600?new h1(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function wL(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function SL(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],wL(e,r,t)),t}function NL(e,n){const t={},r=C(n,["textInput"]);r!=null&&_(t,["textInput"],r);const a=C(n,["output"]);return a!=null&&_(t,["output"],a),t}function CL(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>NL(e,o))),_(t,["examples","examples"],a)}return t}function _L(e,n,t){const r={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&_(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=C(n,["epochCount"]);t!==void 0&&o!=null&&_(t,["tuningTask","hyperparameters","epochCount"],o);const l=C(n,["learningRateMultiplier"]);if(l!=null&&_(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=C(n,["batchSize"]);t!==void 0&&d!=null&&_(t,["tuningTask","hyperparameters","batchSize"],d);const f=C(n,["learningRate"]);return t!==void 0&&f!=null&&_(t,["tuningTask","hyperparameters","learningRate"],f),r}function jL(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&_(t,["tuningTask","trainingData"],CL(e,a));const o=C(n,["config"]);return o!=null&&_(t,["config"],_L(e,o,t)),t}function kL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function TL(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function EL(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],TL(e,r,t)),t}function AL(e,n,t){const r={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function PL(e,n){const t={},r=C(n,["gcsUri"]);return r!=null&&_(t,["validationDatasetUri"],r),t}function DL(e,n,t){const r={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&_(t,["supervisedTuningSpec"],PL(e,a));const o=C(n,["tunedModelDisplayName"]);t!==void 0&&o!=null&&_(t,["tunedModelDisplayName"],o);const l=C(n,["description"]);t!==void 0&&l!=null&&_(t,["description"],l);const d=C(n,["epochCount"]);t!==void 0&&d!=null&&_(t,["supervisedTuningSpec","hyperParameters","epochCount"],d);const f=C(n,["learningRateMultiplier"]);t!==void 0&&f!=null&&_(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const u=C(n,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&_(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const h=C(n,["adapterSize"]);if(t!==void 0&&h!=null&&_(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function IL(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],AL(e,a,t));const o=C(n,["config"]);return o!=null&&_(t,["config"],DL(e,o,t)),t}function RL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["model"],r);const a=C(n,["name"]);return a!=null&&_(t,["endpoint"],a),t}function Tk(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["state"]);a!=null&&_(t,["state"],bk(e,a));const o=C(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=C(n,["tuningTask","startTime"]);l!=null&&_(t,["startTime"],l);const d=C(n,["tuningTask","completeTime"]);d!=null&&_(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=C(n,["description"]);u!=null&&_(t,["description"],u);const h=C(n,["baseModel"]);h!=null&&_(t,["baseModel"],h);const g=C(n,["_self"]);g!=null&&_(t,["tunedModel"],RL(e,g));const b=C(n,["distillationSpec"]);b!=null&&_(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&_(t,["experiment"],v);const S=C(n,["labels"]);S!=null&&_(t,["labels"],S);const k=C(n,["pipelineJob"]);k!=null&&_(t,["pipelineJob"],k);const T=C(n,["tunedModelDisplayName"]);return T!=null&&_(t,["tunedModelDisplayName"],T),t}function ML(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["tunedModels"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Tk(e,l))),_(t,["tuningJobs"],o)}return t}function OL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);return l!=null&&_(t,["error"],l),t}function LL(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=C(n,["step"]);o!=null&&_(t,["step"],o);const l=C(n,["endpoint"]);return l!=null&&_(t,["endpoint"],l),t}function FL(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],r);const a=C(n,["endpoint"]);a!=null&&_(t,["endpoint"],a);const o=C(n,["checkpoints"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>LL(e,d))),_(t,["checkpoints"],l)}return t}function p1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["state"]);a!=null&&_(t,["state"],bk(e,a));const o=C(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=C(n,["startTime"]);l!=null&&_(t,["startTime"],l);const d=C(n,["endTime"]);d!=null&&_(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=C(n,["error"]);u!=null&&_(t,["error"],u);const h=C(n,["description"]);h!=null&&_(t,["description"],h);const g=C(n,["baseModel"]);g!=null&&_(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&_(t,["tunedModel"],FL(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&_(t,["supervisedTuningSpec"],v);const S=C(n,["tuningDataStats"]);S!=null&&_(t,["tuningDataStats"],S);const k=C(n,["encryptionSpec"]);k!=null&&_(t,["encryptionSpec"],k);const T=C(n,["partnerModelTuningSpec"]);T!=null&&_(t,["partnerModelTuningSpec"],T);const P=C(n,["distillationSpec"]);P!=null&&_(t,["distillationSpec"],P);const M=C(n,["experiment"]);M!=null&&_(t,["experiment"],M);const R=C(n,["labels"]);R!=null&&_(t,["labels"],R);const z=C(n,["pipelineJob"]);z!=null&&_(t,["pipelineJob"],z);const $=C(n,["tunedModelDisplayName"]);return $!=null&&_(t,["tunedModelDisplayName"],$),t}function $L(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["tuningJobs"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>p1(e,l))),_(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zL extends og{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new jb(Oh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:o1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=kL(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>p1(this.apiClient,h))}else{const u=vL(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>Tk(this.apiClient,h))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=EL(this.apiClient,n);return d=qt("tuningJobs",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=$L(this.apiClient,h),b=new kN;return Object.assign(b,g),b})}else{const u=SL(this.apiClient,n);return d=qt("tunedModels",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=ML(this.apiClient,h),b=new kN;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=IL(this.apiClient,n);return o=qt("tuningJobs",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>p1(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=jL(this.apiClient,n);return o=qt("tunedModels",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>OL(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UL{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const BL=1024*1024*8,qL=3,VL=1e3,HL=2,Xv="x-goog-upload-status";async function GL(e,n,t){var r,a,o;let l=0,d=0,f=new l1(new Response),u="upload";for(l=e.size;d<l;){const g=Math.min(BL,l-d),b=e.slice(d,d+g);d+g>=l&&(u+=", finalize");let v=0,S=VL;for(;v<qL&&(f=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(d),"Content-Length":String(g)}}}),!(!((r=f==null?void 0:f.headers)===null||r===void 0)&&r[Xv]));)v++,await WL(S),S=S*HL;if(d+=g,((a=f==null?void 0:f.headers)===null||a===void 0?void 0:a[Xv])!=="active")break;if(l<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(f==null?void 0:f.json());if(((o=f==null?void 0:f.headers)===null||o===void 0?void 0:o[Xv])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function YL(e){return{size:e.size,type:e.type}}function WL(e){return new Promise(n=>setTimeout(n,e))}class QL{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await GL(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await YL(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JL{create(n,t,r){return new KL(n,t,r)}}class KL{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const BN="x-goog-api-key";class XL{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(BN)===null&&n.append(BN,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZL="gl-node/";class ww{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=cI(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new XL(this.apiKey);this.apiClient=new bL({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:ZL+"web",uploader:new QL,downloader:new UL}),this.models=new ZO(this.apiClient),this.live=new WO(this.apiClient,a,new JL),this.chats=new gR(this.models,this.apiClient),this.caches=new fR(this.apiClient),this.files=new ER(this.apiClient),this.operations=new uL(this.apiClient),this.tunings=new zL(this.apiClient)}}const e3=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},Sw=()=>localStorage.getItem("authToken");class t3{constructor(){Qn(this,"listeners",[]);Qn(this,"activeRequests",0)}subscribe(n){return this.listeners.push(n),n(this.activeRequests>0),()=>this.unsubscribe(n)}unsubscribe(n){this.listeners=this.listeners.filter(t=>t!==n)}notify(n){n?this.activeRequests++:this.activeRequests=Math.max(0,this.activeRequests-1);const t=this.activeRequests>0;this.listeners.forEach(r=>r(t))}}const m1=new t3,n3="https://backend.newtons.in",r3=()=>localStorage.getItem("authToken"),me=async(e,n={})=>{const t=r3(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let o=e.startsWith("/")?e:`/${e}`;o.startsWith("/api/")||(o=`/api${o}`);const l=`${n3}${o}`;m1.notify(!0);try{console.log(`Making API call to: ${l}`);const d=await fetch(l,{...n,headers:a});if(d.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!d.ok){let f=`HTTP error! status: ${d.status}`;try{const u=await d.json();f=(u==null?void 0:u.message)||(u==null?void 0:u.error)||f}catch{}throw console.error(`API Error: ${d.status} ${d.statusText} - ${f}`),new Error(f)}return d}catch(d){throw d instanceof TypeError&&d.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",d):console.error("API Fetch Error:",d),d}finally{m1.notify(!1)}},Zv="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",i3="models/gemini-3-flash-preview",a3=`You are an intelligent Clinic Hub Assistant for a Clinic Management System. Your role is to help the Clinic Administrator or Doctor manage their clinic ecosystem efficiently.

You have access to the current state of the clinic settings and the staff list. You can perform actions to update these settings or manage staff members.

**Capabilities:**
1.  **View Settings & Staff:** User can ask about current charges, clinic details, or staff members. Answer based on the provided context.
2.  **Update Settings:** Change fees, clinic name, address, etc.
3.  **Manage Staff:** Add new staff members or update existing ones.
4.  **Analyze Financials & Inventory:** Access the Analysis Dashboard to view revenue, expenses, and inventory movement. Set date ranges to filter data.
5.  **Manage Inventory:** Update pharmacy tokens (drugs) and lab tests. You will reference items by their **Serial Number** as provided in the context.
6.  **Purchase Management:** Search for distributors, select one, and build a purchase order by adding items. You can add multiple items at once. Editing items uses Serial Numbers.
7.  **Looping & Reasoning:** You should think step-by-step. If a user request involves multiple steps or if you need to check something after an action, you can continue the loop.
8.  **Follow-up:** If critical information is missing, ask the user.

**Interpretation Rules:**
- **Analysis Dates:** When the user asks for analysis (financial or inventory) for a specific time range (e.g., "last month", "yesterday"), you **MUST** include \`startDate\` and \`endDate\` in the \`navigate_to\` action for \`/dashboard/analysis\`.
- If the user says "add drug", "buy medicine", or "new stock", they **usually mean "Add Item to Purchase Order"** (use \`add_purchase_items\` or navigate to \`/dashboard/purchase\`).
- **Prerequisite:** If you are using ANY purchase tools (\`add_purchase_items\`, \`search_distributor_purchase\`, \`set_distributor_purchase\`, \`edit_purchase_items\`), you **MUST** include a \`navigate_to\` action with \`page: "/dashboard/purchase"\` as the **FIRST** action in your list, unless you are already on that page.
- **ONLY** use \`update_drug\` (create) if the user explicitly says "create new drug definition" or "add to master inventory".
- The correct route for purchasing is \`/dashboard/purchase\`.

**Action Tools:**
You can perform the following actions. Return a JSON array of actions.

\`\`\`json
[
  {
    "action": "update_clinic_settings",
    "updates": {
       "admissionCharge": "number string",
       "perDayCharge": "number string",
       "otherCharges": "number string",
       "name": "string",
       "address": "string",
       "notes": "string",
       "logoUrl": "string",
       "upi_id": "string",
       "low_stock_threshold": number,
        "clinicWideSystemPrompt": "string",
        "aiMemory": "string",
        "gemini_api_key": "string"
    }
  },
  {
    "action": "create_staff_member",
    "staff": {
       "name": "string",
       "email": "string",
       "role": "doctor" | "receptionist" | "pharmacy" | "lab",
       "password": "string",
       "opd_fee": number | null
    }
  },
  {
    "action": "update_staff_member",
    "id": "string | number", 
    "updates": {
       "name": "string",
       "email": "string",
       "role": "doctor" | "receptionist" | "pharmacy" | "lab",
       "password": "string",
       "opd_fee": number | null,
       "active": boolean
    }
  },
  {
    "action": "set_analysis_dates",
    "startDate": "YYYY-MM-DD",
    "endDate": "YYYY-MM-DD"
  },
  {
    "action": "navigate_to",
    "page": "/dashboard/inventory" | "/lab-inventory" | "/dashboard/queue" | "/dashboard/staff" | "/dashboard/purchase" | "/dashboard/analysis" | "/dashboard/clinic-hub" | "/billing" | "/dashboard/patients",
    "section": "financial" | "inventory" | "string (optional)",
    "startDate": "YYYY-MM-DD (optional, for analysis page)",
    "endDate": "YYYY-MM-DD (optional, for analysis page)"
  },
  {
    "action": "highlight_section",
    "elementId": "string"
  },
  {
    "action": "refresh_analysis"
  },
  {
    "action": "ask_followup_question",
    "question": "string"
  },
  {
    "action": "search_pharmacy_inventory",
    "query": "string (name, brand, or composition)"
  },
  {
    "action": "update_drug",
    "id": "number",
    "updates": {
       "name": "string",
       "brand_name": "string",
       "description": "string",
       "mrp": "number (MRP)",
       "stock": "number",
       "pack": "string (e.g. strip, bottle)",
       "supplier": "string",
       "expiry_date": "YYYY-MM-DD",
       "rate": "number",
       "box_number": "string",
       "gst": "number",
       "margin": "number",
       "discount": "number",
       "batch": "string",
       "hsn_code": "string",
       "mfg": "string",
       "loose": "number"
    }
  },
  {
    "action": "update_lab_test",
    "serial_number": 1,
    "updates": {
       "name": "string",
       "price": "number",
       "description": "string",
       "default_parameters": "array of objects { name, type, defaultValue, unit, lower_limit, upper_limit }"
    }
  },
  {
    "action": "search_distributor_purchase",
    "query": "string"
  },
  {
    "action": "set_distributor_purchase",
    "distributorId": "string"
  },
  {
    "action": "add_purchase_items",
    "items": [
        {
            "name": "string",
            "stock": "number (quantity)",
            "rate": "number (buying price)",
            "mrp": "number",
             "pack": "string", 
             "expiry_date": "YYYY-MM-DD",
             "batch": "string",
             "discount": "number",
             "gst": "number"
        }
    ]
  },
  {
    "action": "edit_purchase_items",
     "updates": [
         {
             "serial_number": "number (The Row # from context)",
             "field": "string (name, stock, rate, etc.)",
             "value": "string | number"
         }
     ]
  },
  {
    "action": "end_task",
    "summary": "string"
  },
  {
    "action": "open_new_case",
    "name": "string (Patient Name)",
    "age": "number (optional)",
    "gender": "M | F | O (optional)",
    "phone": "string (optional)",
    "complaint": "string (The medical complaint/reason)"
  }
]
\`\`\`

**Navigation Reference:**
- **Pharmacy Inventory:** \`/dashboard/inventory\`
- **Lab Inventory:** \`/lab-inventory\`
- **Doctor Queue:** \`/dashboard/queue\`
- **Staff Management:** \`/dashboard/staff\`
- **All Patients:** \`/dashboard/patients\`
- **Billing:** \`/billing\`
- **Purchase Page:** \`/dashboard/purchase\`
- **Analysis:** \`/dashboard/analysis\`
- **Clinic Hub:** \`/dashboard/clinic-hub\`
\`\`\`

**Rules:**
-   **Always** return a JSON array as the last part of your response.
-   If the user's request is satisfied, use the \`end_task\` action with a summary of what was done.
-   If you need more info, use \`ask_followup_question\`.
-   If you perform an action (like updating settings), and there's nothing else to do *immediately* but you want to confirm it's done, you can return the action. The system will execute it and call you back with the result. Then you can \`end_task\`.
-   For \`create_staff_member\`, if password is not provided by user, generate a secure random password and mention it in the summary.
-   Update numeric strings as strings (e.g., "500.00").
-   **CRITICAL DO's and DON'Ts:**
    -   **DO NOT** fill in empty fields (like \`gemini_api_key\`, \`logoUrl\`, \`upi_id\`, etc.) with fake, placeholder, or example data.
    -   **ONLY** update fields that the user *intentionally* asked to change.
    -   **PRESERVE** existing values for any fields not explicitly mentioned in the user's request.
    -   If a field is empty and the user didn't ask to set it, **leave it empty**.
    -   Do not invent values.
`;async function s3(){var t;if(!Sw()&&Zv)return Zv;let n=null;try{const r=await me("/api/clinics/settings");if(r.ok){const a=await r.json();(t=a.gemini_api_key)!=null&&t.trim()&&(n=a.gemini_api_key.trim())}}catch(r){console.warn("Error fetching updated key",r)}if(n)return n;try{const r=await me("/api/global-settings/app_gemini_api_key");if(r.ok){const o=(await r.json()).value;if(o&&o.trim()!=="")return o.trim()}}catch(r){console.warn("Could not fetch global API key.",r)}return Zv}let e0=null;async function o3(){if(!e0){const e=await s3();e0=new ww({apiKey:e})}return e0}async function l3(e,n,t=[],r){var u,h,g,b,v;const a=await o3(),o=[];o.push({role:"user",parts:[{text:a3}]}),o.push({role:"model",parts:[{text:"Understood. I am ready to assist with Clinic Hub management."}]}),t.forEach(S=>{o.push({role:S.role,parts:[{text:S.text}]})});const f=[{text:`
    Context:
    ${`
    --- Current Clinic Context ---
    Settings: ${JSON.stringify(n.settings,null,2)}
    
    Staff List: ${JSON.stringify(n.staffList.map(S=>({id:S.id||S._id,name:S.name,role:S.role,email:S.email,active:S.active,opd_fee:S.opd_fee})),null,2)}
    
    Previous Action Results (if any): ${JSON.stringify(n.actionResults||[],null,2)}

    Analysis Data (if active): ${JSON.stringify(n.analysisData||{},null,2)}

    Pharmacy Inventory: ${n.pharmacyInventory?JSON.stringify(n.pharmacyInventory,null,2):"Not loaded. Use 'search_pharmacy_inventory' to find items."}

    Lab Tests Inventory: ${JSON.stringify((n.labInventory||[]).map(S=>({serial:S.serial_number,name:S.name,price:S.price,description:S.description,default_parameters:S.default_parameters})),null,2)}

    Current Purchase Page Rows: ${JSON.stringify((n.purchaseRows||[]).map((S,k)=>({serial_number:k+1,name:S.name,stock:S.stock,rate:S.rate,mrp:S.mrp,net_value:(S.stock*S.rate).toFixed(2)})),null,2)}
    `}

    User Query/Input:
    ${e}
    `}];if(r){const S=r.replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"");f.push({inlineData:{data:S,mimeType:"image/jpeg"}})}o.push({role:"user",parts:f});try{const S={model:i3,contents:o,generationConfig:{temperature:.7,maxOutputTokens:2048,responseMimeType:"text/plain"}},k=await a.models.generateContentStream(S);let T="";for await(const P of k){const M=P;M.text&&typeof M.text=="function"?T+=M.text():(v=(b=(g=(h=(u=M.candidates)==null?void 0:u[0])==null?void 0:h.content)==null?void 0:g.parts)==null?void 0:b[0])!=null&&v.text&&(T+=M.candidates[0].content.parts[0].text)}if(!T)throw new Error("Empty response from AI");return T}catch(S){throw console.error("Gemini Interaction Error:",S),new Error("Failed to communicate with AI Assistant.")}}const Nw=({settings:e,staffList:n,onSettingsUpdate:t,onStaffUpdate:r,onHighlight:a})=>{const o=At(),{setAnalysisDateRange:l,analysisData:d,analysisNavigate:f,refreshAnalysis:u}=xw(),{setDistributors:h,setSelectedDistributor:g,setSearchTerm:b,addPurchaseRow:v,updatePurchaseRow:S,distributors:k,purchaseRows:T}=dk(),[P,M]=w.useState(""),R=w.useRef(d),z=w.useRef(T);w.useEffect(()=>{R.current=d},[d]),w.useEffect(()=>{z.current=T},[T]);const[$,L]=w.useState([]),[U,B]=w.useState(!1),[W,I]=w.useState(null),F=w.useRef(!1),V=w.useRef(0),re=5,ie=()=>{F.current=!1,B(!1),L(E=>[...E,{role:"system",text:" Task stopped by user."}])},G=E=>{const de=new FileReader;de.onloadend=()=>{I(de.result)},de.readAsDataURL(E)},Y=()=>{I(null)},ne=async(E,de,he=[],D)=>{var pe,Ne,te;if(F.current){if(V.current+=1,V.current>re){L(K=>[...K,{role:"system",text:" Task limit reached. Stopping automatically."}]),B(!1),F.current=!1;return}try{let K=e,J=n,ye=[],He=[];try{const[ue,Ae]=await Promise.all([me("/api/clinics/settings"),me("/staff")]);if(ue.ok&&Ae.ok){const ke=await ue.json(),Se=await Ae.json(),[ve,X]=await Promise.all([me("/api/drugs"),me("/api/lab-tests")]);if(ve.ok){const fe=await ve.json();ye=fe.drugs||fe||[]}X.ok&&(He=(await X.json()).map((Ge,Je)=>({...Ge,serial_number:Je+1}))),K={...ke,admissionCharge:parseFloat(ke.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(ke.perDayCharge||0).toFixed(2),otherCharges:parseFloat(ke.otherCharges||0).toFixed(2),aiMemory:ke.aiMemory||"",clinicWideSystemPrompt:ke.clinicWideSystemPrompt||"",gemini_api_key:ke.gemini_api_key||"",low_stock_threshold:ke.low_stock_threshold!==void 0&&ke.low_stock_threshold!==null?String(ke.low_stock_threshold):"10",name:ke.name||"",logoUrl:ke.logoUrl||"",upi_id:ke.upi_id||"",address:ke.address||"",notes:ke.notes||"",clinic_id:ke.clinic_id},J=Se.map(fe=>({...fe,id:fe._id||fe.id}))}}catch(ue){console.warn("Failed to fetch fresh context for AI loop, falling back to props",ue)}const Q={settings:K,staffList:J,analysisData:R.current,pharmacyInventory:ye.length>50?void 0:ye,labInventory:He,purchaseRows:z.current,actionResults:he},Pe=de.filter(ue=>ue.role!=="system"),Re=await l3(E,Q,Pe,D);if(!F.current)return;let Le=[];try{const ue=Re.match(/\[[\s\S]*\]/);if(ue)Le=JSON.parse(ue[0]);else{L(Ae=>[...Ae,{role:"model",text:Re}]),B(!1),F.current=!1;return}}catch(ue){console.error("Failed to parse AI response",ue),L(Ae=>[...Ae,{role:"model",text:"I'm having trouble processing that. Please try again."}]),B(!1),F.current=!1;return}const _e=[];let Ke=[],Ye=[];for(const ue of Le){if(!F.current)break;if(ue.action==="end_task"){L(Ae=>[...Ae,{role:"model",text:ue.summary}]),B(!1),F.current=!1;return}if(ue.action==="ask_followup_question"){L(Ae=>[...Ae,{role:"model",text:ue.question}]),B(!1),F.current=!1;return}try{if(ue.action==="update_clinic_settings"){const Ae=ue.updates;Object.keys(Ae).forEach(ve=>Ke.push(`setting-${ve}`));const ke={...K,...Ae},Se={...ke,admissionCharge:parseFloat(ke.admissionCharge),perDayCharge:parseFloat(ke.perDayCharge),otherCharges:parseFloat(ke.otherCharges),low_stock_threshold:parseInt(ke.low_stock_threshold)};await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Se)}),t&&t(),_e.push({action:"update_clinic_settings",status:"success"}),Ye.push({role:"system",text:" Updated clinic settings"})}if(ue.action==="create_staff_member"&&(await me("/api/staff",{method:"POST",body:JSON.stringify({...ue.staff,clinic_id:K.clinic_id})}),r&&r(),_e.push({action:"create_staff_member",status:"success",name:ue.staff.name}),Ye.push({role:"system",text:` Created staff member: ${ue.staff.name}`})),ue.action==="update_staff_member"){const Ae=ue.id;await me(`/api/staff/${Ae}`,{method:"PUT",body:JSON.stringify(ue.updates)}),r&&r(),Ke.push(`staff-member-${Ae}`),_e.push({action:"update_staff_member",status:"success",id:Ae}),Ye.push({role:"system",text:" Updated staff member details"})}if(ue.action==="set_analysis_dates"){const{startDate:Ae,endDate:ke}=ue;l({startDate:new Date(Ae),endDate:new Date(ke)}),_e.push({action:"set_analysis_dates",status:"success",startDate:Ae,endDate:ke}),Ye.push({role:"system",text:` Set analysis dates: ${Ae} to ${ke}`})}if(ue.action==="navigate_to"){let Ae=ue.page;if(ue.page&&ue.page.includes("analysis")&&ue.startDate&&ue.endDate){const ke=Ae.includes("?")?"&":"?";Ae=`${Ae}${ke}startDate=${ue.startDate}&endDate=${ue.endDate}`}else ue.page&&ue.page.includes("analysis")&&((pe=R.current)!=null&&pe.startDate)&&((Ne=R.current)!=null&&Ne.endDate);o(Ae),ue.section&&setTimeout(()=>f(ue.section),500),_e.push({action:"navigate_to",status:"success",page:Ae}),Ye.push({role:"system",text:` Navigated to ${Ae}`})}if(ue.action==="highlight_section"&&(Ke.push(ue.elementId),_e.push({action:"highlight_section",status:"success",id:ue.elementId})),ue.action==="refresh_analysis"){Ye.push({role:"system",text:" Refreshing analysis data..."});const Ae=await u();Ae?(R.current=Ae,_e.push({action:"refresh_analysis",status:"success",summary:"Data refreshed successfully"}),Ye.push({role:"system",text:" Analysis data refreshed"})):(_e.push({action:"refresh_analysis",status:"error",error:"No data returned"}),Ye.push({role:"system",text:" Failed to refresh analysis data"}))}if(ue.action==="search_pharmacy_inventory"){const Ae=ue.query.toLowerCase(),ke=ye.filter(ve=>ve.name&&ve.name.toLowerCase().includes(Ae)||ve.brand_name&&ve.brand_name.toLowerCase().includes(Ae)||ve.description&&ve.description.toLowerCase().includes(Ae)),Se=ke.slice(0,10);_e.push({action:"search_pharmacy_inventory",status:"success",count:ke.length,results:Se}),ke.length>0?Ye.push({role:"system",text:` Found ${ke.length} matches for "${ue.query}". Showing top ${Se.length}.`}):Ye.push({role:"system",text:` No matches found for "${ue.query}"`})}if(ue.action==="update_drug"){const Ae=ue.id;try{const ke=ye.find(ve=>ve.id===Ae);if(!ke)throw new Error(`Drug with ID ${Ae} not found.`);const Se={...ke,...ue.updates};await me(`/api/drugs/${Ae}`,{method:"PUT",body:JSON.stringify(Se)}),_e.push({action:"update_drug",status:"success",id:Ae,updates:ue.updates}),Ye.push({role:"system",text:` Updated drug: ${ke.name}`})}catch(ke){_e.push({action:"update_drug",status:"error",error:ke.message}),Ye.push({role:"system",text:` Failed to update drug: ${ke.message}`})}}if(ue.action==="update_lab_test"){const Ae=He.find(ke=>ke.serial_number===ue.serial_number);if(Ae){const ke={...Ae,...ue.updates};await me(`/api/lab-tests/${Ae.id}`,{method:"PUT",body:JSON.stringify(ke)}),_e.push({action:"update_lab_test",status:"success",item:Ae.name}),Ye.push({role:"system",text:` Updated lab test: ${Ae.name}`})}else _e.push({action:"update_lab_test",status:"error",error:`Test with serial ${ue.serial_number} not found`}),Ye.push({role:"system",text:` Lab test with serial ${ue.serial_number} not found`})}if(ue.action==="search_distributor_purchase"){const Ae=ue.query,ke=await me(`/api/distributors?search=${encodeURIComponent(Ae)}`);if(ke.ok){const Se=await ke.json();h(Se),b(Ae),_e.push({action:"search_distributor_purchase",status:"success",count:Se.length,results:Se}),Ye.push({role:"system",text:` Found ${Se.length} distributors for "${Ae}"`})}else _e.push({action:"search_distributor_purchase",status:"error",error:ke.statusText}),Ye.push({role:"system",text:" Failed to search distributors"})}if(ue.action==="set_distributor_purchase"){const Ae=ue.distributorId;let ke=k.find(Se=>Se.id===Ae);ke?(g(ke),b(ke.name),_e.push({action:"set_distributor_purchase",status:"success",distributor:ke.name}),Ye.push({role:"system",text:` Selected distributor: ${ke.name}`})):(_e.push({action:"set_distributor_purchase",status:"error",error:"Distributor not found in current search results. Please search first."}),Ye.push({role:"system",text:" Distributor not found. Please search first."}))}if(ue.action==="add_purchase_items"){const Ae=ue.items;let ke=0;Ae.forEach(Se=>{const X={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:Se.name||"",composition:Se.composition||"",description:Se.description||"",mrp:Se.mrp||0,stock:Se.stock||0,pack:Se.pack||"",supplier:"",expiry_date:Se.expiry_date||"",rate:Se.rate||0,box_number:Se.box_number||"",gst:Se.gst||0,margin:Se.margin||0,discount:Se.discount||0,brand_name:Se.brand_name||"",batch:Se.batch||"",hsn_code:Se.hsn_code||"",mfg:Se.mfg||"",loose:Se.loose||0,last_updated:"",created_at:""};v(X),ke++}),_e.push({action:"add_purchase_items",status:"success",count:ke}),Ye.push({role:"system",text:` Added ${ke} items to purchase list`})}if(ue.action==="edit_purchase_items"){const Ae=ue.updates;let ke=0;const Se=z.current||[];Ae.forEach(ve=>{if(ve.serial_number){const X=ve.serial_number-1,fe=Se[X];fe&&fe.id?(S(fe.id,{[ve.field]:ve.value}),ke++):(console.warn(`Row with serial number ${ve.serial_number} not found.`),Ye.push({role:"system",text:` Row #${ve.serial_number} not found.`}))}}),_e.push({action:"edit_purchase_items",status:"success",count:ke}),Ye.push({role:"system",text:` Updated ${ke} items`})}if(ue.action==="open_new_case"){const{name:Ae,age:ke,gender:Se,complaint:ve,phone:X}=ue;try{const fe=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Ae||"New Patient",age:ke||null,gender:Se||null,phone:X||null,address:null})});if(!fe.ok){const wt=await fe.json().catch(()=>({}));throw fe.status===403&&((te=wt.message)!=null&&te.includes("Patient limit"))?new Error(`Patient limit reached: ${wt.message}`):new Error(wt.message||"Failed to create patient")}const Ge=await fe.json();if(!Ge||!Ge.id)throw new Error("Created patient has no ID");const Je=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:Ge.id,complaint:ve||"New Case"})});if(!Je.ok)throw new Error("Failed to create queue entry");const ct=await Je.json();o(`/dashboard/edit-complaint/${ct.id}`,{state:{initialComplaint:ve}}),_e.push({action:"open_new_case",status:"success",patientId:Ge.id,queueId:ct.id}),Ye.push({role:"system",text:` Opened new case for ${Ae}`}),B(!1),F.current=!1;return}catch(fe){fe.message.includes("Patient limit")&&(o("/start-clinic-subscription"),Ye.push({role:"system",text:" Patient limit reached. Redirecting to subscription."})),_e.push({action:"open_new_case",status:"error",error:fe.message}),Ye.push({role:"system",text:` Failed to open new case: ${fe.message}`})}}}catch(Ae){console.error("Action execution failed",ue,Ae),_e.push({action:ue.action,status:"error",error:Ae.message}),Ye.push({role:"system",text:` Failed to execute action: ${ue.action}`})}}Ke.length>0&&a&&setTimeout(()=>a(Ke),500),Ye.length>0&&L(ue=>[...ue,...Ye]);const it=[...he,..._e],xt=`Reflecting on previous actions: ${JSON.stringify(_e)}. What is the next step? If done, call end_task.`,Nt=[...de,...Ye,{role:"model",text:Re},{role:"user",text:xt}];await ne(xt,Nt,it,void 0)}catch(K){console.error(K),L(J=>[...J,{role:"model",text:"Something went wrong."}]),B(!1),F.current=!1}}};return{chatQuery:P,setChatQuery:M,chatHistory:$,isProcessing:U,handleSendMessage:E=>{const de=E!==void 0?E:P;if(!de.trim()&&!W)return;F.current=!0,B(!0),V.current=0;const he={role:"user",text:de};W&&(he.text+=" [Image Attached]"),L(pe=>[...pe,he]);const D=W||void 0;M(""),I(null),ne(de,$,[],D)},refreshChat:()=>{L([]),M(""),B(!1),F.current=!1,V.current=0,I(null)},stopGeneration:ie,selectedImage:W,handleImageSelect:G,clearImage:Y}};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),u3=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),qN=e=>{const n=u3(e);return n.charAt(0).toUpperCase()+n.slice(1)},Ek=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...d},f)=>w.createElement("svg",{ref:f,...d3,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:Ek("lucide",a),...d},[...l.map(([u,h])=>w.createElement(u,h)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=(e,n)=>{const t=w.forwardRef(({className:r,...a},o)=>w.createElement(f3,{ref:o,iconNode:n,className:Ek(`lucide-${c3(qN(e))}`,`lucide-${e}`,r),...a}));return t.displayName=qN(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],VN=ut("arrow-down",h3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],an=ut("arrow-left",p3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],g1=ut("arrow-up",m3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],y3=ut("beaker",g3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],b3=ut("bed-double",x3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Xx=ut("bot",v3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],S3=ut("brain-circuit",w3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],Ak=ut("brain",N3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],_3=ut("building",C3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],HN=ut("calendar-check-2",j3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],T3=ut("calendar-days",k3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Qm=ut("calendar",E3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Zx=ut("check",A3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],y1=ut("chevron-down",P3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Tb=ut("chevron-left",D3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Gd=ut("chevron-right",I3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],x1=ut("chevron-up",R3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ir=ut("circle-alert",M3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],vs=ut("circle-check-big",O3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],F3=ut("circle-minus",L3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Ua=ut("circle-plus",$3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],U3=ut("circle-user",z3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Cw=ut("clipboard-list",B3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],b1=ut("clipboard",q3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],H3=ut("clock",V3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Y3=ut("copy",G3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Q3=ut("credit-card",W3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Fh=ut("dollar-sign",J3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],X3=ut("eye",K3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],eF=ut("file-check",Z3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],lu=ut("file-text",tF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Hl=ut("flask-conical",nF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],iF=ut("funnel",rF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Jm=ut("hash",aF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Pk=ut("house",sF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Zo=ut("info",oF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Dk=ut("key",lF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Ik=ut("layout-grid",cF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],dF=ut("list-ordered",uF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],hF=ut("list",fF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Gl=ut("loader-circle",pF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],GN=ut("lock",mF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Rk=ut("map-pin",gF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],xF=ut("maximize-2",yF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],vF=ut("mic-off",bF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],Eb=ut("mic",wF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],NF=ut("minimize-2",SF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],_F=ut("monitor",CF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],kF=ut("package-open",jF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],$d=ut("package",TF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],Ab=ut("paperclip",EF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],PF=ut("pause",AF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],t0=ut("pen",DF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Ul=ut("pencil",IF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],Mk=ut("phone",RF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],lg=ut("pill",MF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],LF=ut("play",OF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],tl=ut("plus",FF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Ko=ut("printer",$F);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],v1=ut("refresh-cw",zF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],BF=ut("rotate-ccw",UF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Ok=ut("rotate-cw",qF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],zd=ut("save",VF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HF=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],bi=ut("search",HF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Pb=ut("send",GF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],YN=ut("server-crash",YF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Db=ut("settings",WF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Lk=ut("share-2",QF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],KF=ut("shield-check",JF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],ZF=ut("shopping-cart",XF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],t6=ut("sparkles",e6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Yl=ut("square-pen",n6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],i6=ut("square",r6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a6=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],Fk=ut("stethoscope",a6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],o6=ut("table",s6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l6=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],c6=ut("tag",l6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Wr=ut("trash-2",u6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d6=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],f6=ut("triangle-alert",d6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],p6=ut("truck",h6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m6=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],WN=ut("upload",m6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],_w=ut("user-check",g6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],$k=ut("user-plus",y6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x6=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],eo=ut("user",x6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Gh=ut("users",b6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v6=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],w6=ut("video",v6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],bn=ut("x",S6);function N6(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const C6=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,_6=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,j6={};function QN(e,n){return(j6.jsx?_6:C6).test(e)}const k6=/[ \t\n\f\r]/g;function T6(e){return typeof e=="object"?e.type==="text"?JN(e.value):!1:JN(e)}function JN(e){return e.replace(k6,"")===""}let cg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};cg.prototype.normal={};cg.prototype.property={};cg.prototype.space=void 0;function zk(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new cg(t,r,n)}function w1(e){return e.toLowerCase()}let ga=class{constructor(n,t){this.attribute=t,this.property=n}};ga.prototype.attribute="";ga.prototype.booleanish=!1;ga.prototype.boolean=!1;ga.prototype.commaOrSpaceSeparated=!1;ga.prototype.commaSeparated=!1;ga.prototype.defined=!1;ga.prototype.mustUseProperty=!1;ga.prototype.number=!1;ga.prototype.overloadedBoolean=!1;ga.prototype.property="";ga.prototype.spaceSeparated=!1;ga.prototype.space=void 0;let E6=0;const Qt=Yd(),zr=Yd(),Uk=Yd(),ot=Yd(),lr=Yd(),Ph=Yd(),Fa=Yd();function Yd(){return 2**++E6}const S1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Qt,booleanish:zr,commaOrSpaceSeparated:Fa,commaSeparated:Ph,number:ot,overloadedBoolean:Uk,spaceSeparated:lr},Symbol.toStringTag,{value:"Module"})),n0=Object.keys(S1);let jw=class extends ga{constructor(n,t,r,a){let o=-1;if(super(n,t),KN(this,"space",a),typeof r=="number")for(;++o<n0.length;){const l=n0[o];KN(this,n0[o],(r&S1[l])===S1[l])}}};jw.prototype.defined=!0;function KN(e,n,t){t&&(e[n]=t)}function Yh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new jw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[w1(r)]=r,t[w1(o.attribute)]=r}return new cg(n,t,e.space)}const Bk=Yh({properties:{ariaActiveDescendant:null,ariaAtomic:zr,ariaAutoComplete:null,ariaBusy:zr,ariaChecked:zr,ariaColCount:ot,ariaColIndex:ot,ariaColSpan:ot,ariaControls:lr,ariaCurrent:null,ariaDescribedBy:lr,ariaDetails:null,ariaDisabled:zr,ariaDropEffect:lr,ariaErrorMessage:null,ariaExpanded:zr,ariaFlowTo:lr,ariaGrabbed:zr,ariaHasPopup:null,ariaHidden:zr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:lr,ariaLevel:ot,ariaLive:null,ariaModal:zr,ariaMultiLine:zr,ariaMultiSelectable:zr,ariaOrientation:null,ariaOwns:lr,ariaPlaceholder:null,ariaPosInSet:ot,ariaPressed:zr,ariaReadOnly:zr,ariaRelevant:null,ariaRequired:zr,ariaRoleDescription:lr,ariaRowCount:ot,ariaRowIndex:ot,ariaRowSpan:ot,ariaSelected:zr,ariaSetSize:ot,ariaSort:null,ariaValueMax:ot,ariaValueMin:ot,ariaValueNow:ot,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function qk(e,n){return n in e?e[n]:n}function Vk(e,n){return qk(e,n.toLowerCase())}const A6=Yh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ph,acceptCharset:lr,accessKey:lr,action:null,allow:null,allowFullScreen:Qt,allowPaymentRequest:Qt,allowUserMedia:Qt,alt:null,as:null,async:Qt,autoCapitalize:null,autoComplete:lr,autoFocus:Qt,autoPlay:Qt,blocking:lr,capture:null,charSet:null,checked:Qt,cite:null,className:lr,cols:ot,colSpan:null,content:null,contentEditable:zr,controls:Qt,controlsList:lr,coords:ot|Ph,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Qt,defer:Qt,dir:null,dirName:null,disabled:Qt,download:Uk,draggable:zr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Qt,formTarget:null,headers:lr,height:ot,hidden:Qt,high:ot,href:null,hrefLang:null,htmlFor:lr,httpEquiv:lr,id:null,imageSizes:null,imageSrcSet:null,inert:Qt,inputMode:null,integrity:null,is:null,isMap:Qt,itemId:null,itemProp:lr,itemRef:lr,itemScope:Qt,itemType:lr,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Qt,low:ot,manifest:null,max:null,maxLength:ot,media:null,method:null,min:null,minLength:ot,multiple:Qt,muted:Qt,name:null,nonce:null,noModule:Qt,noValidate:Qt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Qt,optimum:ot,pattern:null,ping:lr,placeholder:null,playsInline:Qt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Qt,referrerPolicy:null,rel:lr,required:Qt,reversed:Qt,rows:ot,rowSpan:ot,sandbox:lr,scope:null,scoped:Qt,seamless:Qt,selected:Qt,shadowRootClonable:Qt,shadowRootDelegatesFocus:Qt,shadowRootMode:null,shape:null,size:ot,sizes:null,slot:null,span:ot,spellCheck:zr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ot,step:null,style:null,tabIndex:ot,target:null,title:null,translate:null,type:null,typeMustMatch:Qt,useMap:null,value:zr,width:ot,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:lr,axis:null,background:null,bgColor:null,border:ot,borderColor:null,bottomMargin:ot,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Qt,declare:Qt,event:null,face:null,frame:null,frameBorder:null,hSpace:ot,leftMargin:ot,link:null,longDesc:null,lowSrc:null,marginHeight:ot,marginWidth:ot,noResize:Qt,noHref:Qt,noShade:Qt,noWrap:Qt,object:null,profile:null,prompt:null,rev:null,rightMargin:ot,rules:null,scheme:null,scrolling:zr,standby:null,summary:null,text:null,topMargin:ot,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ot,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Qt,disableRemotePlayback:Qt,prefix:null,property:null,results:ot,security:null,unselectable:null},space:"html",transform:Vk}),P6=Yh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Fa,accentHeight:ot,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ot,amplitude:ot,arabicForm:null,ascent:ot,attributeName:null,attributeType:null,azimuth:ot,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ot,by:null,calcMode:null,capHeight:ot,className:lr,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ot,diffuseConstant:ot,direction:null,display:null,dur:null,divisor:ot,dominantBaseline:null,download:Qt,dx:null,dy:null,edgeMode:null,editable:null,elevation:ot,enableBackground:null,end:null,event:null,exponent:ot,externalResourcesRequired:null,fill:null,fillOpacity:ot,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ph,g2:Ph,glyphName:Ph,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ot,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ot,horizOriginX:ot,horizOriginY:ot,id:null,ideographic:ot,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ot,k:ot,k1:ot,k2:ot,k3:ot,k4:ot,kernelMatrix:Fa,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ot,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ot,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ot,overlineThickness:ot,paintOrder:null,panose1:null,path:null,pathLength:ot,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:lr,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ot,pointsAtY:ot,pointsAtZ:ot,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Fa,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Fa,rev:Fa,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Fa,requiredFeatures:Fa,requiredFonts:Fa,requiredFormats:Fa,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ot,specularExponent:ot,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ot,strikethroughThickness:ot,string:null,stroke:null,strokeDashArray:Fa,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ot,strokeOpacity:ot,strokeWidth:null,style:null,surfaceScale:ot,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Fa,tabIndex:ot,tableValues:null,target:null,targetX:ot,targetY:ot,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Fa,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ot,underlineThickness:ot,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ot,values:null,vAlphabetic:ot,vMathematical:ot,vectorEffect:null,vHanging:ot,vIdeographic:ot,version:null,vertAdvY:ot,vertOriginX:ot,vertOriginY:ot,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ot,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:qk}),Hk=Yh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),Gk=Yh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:Vk}),Yk=Yh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),D6={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},I6=/[A-Z]/g,XN=/-[a-z]/g,R6=/^data[-\w.:]+$/i;function M6(e,n){const t=w1(n);let r=n,a=ga;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&R6.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(XN,L6);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!XN.test(o)){let l=o.replace(I6,O6);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=jw}return new a(r,n)}function O6(e){return"-"+e.toLowerCase()}function L6(e){return e.charAt(1).toUpperCase()}const F6=zk([Bk,A6,Hk,Gk,Yk],"html"),kw=zk([Bk,P6,Hk,Gk,Yk],"svg");function $6(e){return e.join(" ").trim()}var xh={},r0,ZN;function z6(){if(ZN)return r0;ZN=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,d=/^\s+|\s+$/g,f=`
`,u="/",h="*",g="",b="comment",v="declaration";r0=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var P=1,M=1;function R(re){var ie=re.match(n);ie&&(P+=ie.length);var G=re.lastIndexOf(f);M=~G?re.length-G:M+re.length}function z(){var re={line:P,column:M};return function(ie){return ie.position=new $(re),B(),ie}}function $(re){this.start=re,this.end={line:P,column:M},this.source=T.source}$.prototype.content=k;function L(re){var ie=new Error(T.source+":"+P+":"+M+": "+re);if(ie.reason=re,ie.filename=T.source,ie.line=P,ie.column=M,ie.source=k,!T.silent)throw ie}function U(re){var ie=re.exec(k);if(ie){var G=ie[0];return R(G),k=k.slice(G.length),ie}}function B(){U(t)}function W(re){var ie;for(re=re||[];ie=I();)ie!==!1&&re.push(ie);return re}function I(){var re=z();if(!(u!=k.charAt(0)||h!=k.charAt(1))){for(var ie=2;g!=k.charAt(ie)&&(h!=k.charAt(ie)||u!=k.charAt(ie+1));)++ie;if(ie+=2,g===k.charAt(ie-1))return L("End of comment missing");var G=k.slice(2,ie-2);return M+=2,R(G),k=k.slice(ie),M+=2,re({type:b,comment:G})}}function F(){var re=z(),ie=U(r);if(ie){if(I(),!U(a))return L("property missing ':'");var G=U(o),Y=re({type:v,property:S(ie[0].replace(e,g)),value:G?S(G[0].replace(e,g)):g});return U(l),Y}}function V(){var re=[];W(re);for(var ie;ie=F();)ie!==!1&&(re.push(ie),W(re));return re}return B(),V()};function S(k){return k?k.replace(d,g):g}return r0}var eC;function U6(){if(eC)return xh;eC=1;var e=xh&&xh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xh,"__esModule",{value:!0}),xh.default=t;var n=e(z6());function t(r,a){var o=null;if(!r||typeof r!="string")return o;var l=(0,n.default)(r),d=typeof a=="function";return l.forEach(function(f){if(f.type==="declaration"){var u=f.property,h=f.value;d?a(u,h,f):h&&(o=o||{},o[u]=h)}}),o}return xh}var jm={},tC;function B6(){if(tC)return jm;tC=1,Object.defineProperty(jm,"__esModule",{value:!0}),jm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,o=function(u){return!u||t.test(u)||e.test(u)},l=function(u,h){return h.toUpperCase()},d=function(u,h){return"".concat(h,"-")},f=function(u,h){return h===void 0&&(h={}),o(u)?u:(u=u.toLowerCase(),h.reactCompat?u=u.replace(a,d):u=u.replace(r,d),u.replace(n,l))};return jm.camelCase=f,jm}var km,nC;function q6(){if(nC)return km;nC=1;var e=km&&km.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(U6()),t=B6();function r(a,o){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(d,f){d&&f&&(l[(0,t.camelCase)(d,o)]=f)}),l}return r.default=r,km=r,km}var V6=q6();const H6=Hd(V6),Wk=Qk("end"),Tw=Qk("start");function Qk(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function G6(e){const n=Tw(e),t=Wk(e);if(n&&t)return{start:n,end:t}}function Bm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?rC(e.position):"start"in e||"end"in e?rC(e):"line"in e||"column"in e?N1(e):""}function N1(e){return iC(e&&e.line)+":"+iC(e&&e.column)}function rC(e){return N1(e&&e.start)+"-"+N1(e&&e.end)}function iC(e){return e&&typeof e=="number"?e:1}let Li=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=d?d.line:void 0,this.name=Bm(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}};Li.prototype.file="";Li.prototype.name="";Li.prototype.reason="";Li.prototype.message="";Li.prototype.stack="";Li.prototype.column=void 0;Li.prototype.line=void 0;Li.prototype.ancestors=void 0;Li.prototype.cause=void 0;Li.prototype.fatal=void 0;Li.prototype.place=void 0;Li.prototype.ruleId=void 0;Li.prototype.source=void 0;const Ew={}.hasOwnProperty,Y6=new Map,W6=/[A-Z]/g,Q6=new Set(["table","tbody","thead","tfoot","tr"]),J6=new Set(["td","th"]),Jk="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function K6(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=a$(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=i$(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?kw:F6,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=Kk(a,e,void 0);return o&&typeof o!="string"?o:a.create(e,a.Fragment,{children:o||void 0},void 0)}function Kk(e,n,t){if(n.type==="element")return X6(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return Z6(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return t$(e,n,t);if(n.type==="mdxjsEsm")return e$(e,n);if(n.type==="root")return n$(e,n,t);if(n.type==="text")return r$(e,n)}function X6(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=kw,e.schema=a),e.ancestors.push(n);const o=Zk(e,n.tagName,!1),l=s$(e,n);let d=Pw(e,n);return Q6.has(n.tagName)&&(d=d.filter(function(f){return typeof f=="string"?!T6(f):!0})),Xk(e,l,o,n),Aw(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function Z6(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}Km(e,n.position)}function e$(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);Km(e,n.position)}function t$(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=kw,e.schema=a),e.ancestors.push(n);const o=n.name===null?e.Fragment:Zk(e,n.name,!0),l=o$(e,n),d=Pw(e,n);return Xk(e,l,o,n),Aw(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function n$(e,n,t){const r={};return Aw(r,Pw(e,n)),e.create(n,e.Fragment,r,t)}function r$(e,n){return n.value}function Xk(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function Aw(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function i$(e,n,t){return r;function r(a,o,l,d){const u=Array.isArray(l.children)?t:n;return d?u(o,l,d):u(o,l)}}function a$(e,n){return t;function t(r,a,o,l){const d=Array.isArray(o.children),f=Tw(r);return n(a,o,l,d,{columnNumber:f?f.column-1:void 0,fileName:e,lineNumber:f?f.line:void 0},void 0)}}function s$(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&Ew.call(n.properties,a)){const o=l$(e,a,n.properties[a]);if(o){const[l,d]=o;e.tableCellAlignToStyle&&l==="align"&&typeof d=="string"&&J6.has(n.tagName)?r=d:t[l]=d}}if(r){const o=t.style||(t.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function o$(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const o=r.data.estree.body[0];o.type;const l=o.expression;l.type;const d=l.properties[0];d.type,Object.assign(t,e.evaluater.evaluateExpression(d.argument))}else Km(e,n.position);else{const a=r.name;let o;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const d=r.value.data.estree.body[0];d.type,o=e.evaluater.evaluateExpression(d.expression)}else Km(e,n.position);else o=r.value===null?!0:r.value;t[a]=o}return t}function Pw(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:Y6;for(;++r<n.children.length;){const o=n.children[r];let l;if(e.passKeys){const f=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(f){const u=a.get(f)||0;l=f+"-"+u,a.set(f,u+1)}}const d=Kk(e,o,l);d!==void 0&&t.push(d)}return t}function l$(e,n,t){const r=M6(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?N6(t):$6(t)),r.property==="style"){let a=typeof t=="object"?t:c$(e,String(t));return e.stylePropertyNameCase==="css"&&(a=u$(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?D6[r.property]||r.property:r.attribute,t]}}function c$(e,n){try{return H6(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new Li("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=Jk+"#cannot-parse-style-attribute",a}}function Zk(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let o=-1,l;for(;++o<a.length;){const d=QN(a[o])?{type:"Identifier",name:a[o]}:{type:"Literal",value:a[o]};l=l?{type:"MemberExpression",object:l,property:d,computed:!!(o&&d.type==="Literal"),optional:!1}:d}r=l}else r=QN(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return Ew.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);Km(e)}function Km(e,n){const t=new Li("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=Jk+"#cannot-handle-mdx-estrees-without-createevaluater",t}function u$(e){const n={};let t;for(t in e)Ew.call(e,t)&&(n[d$(t)]=e[t]);return n}function d$(e){let n=e.replace(W6,f$);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function f$(e){return"-"+e.toLowerCase()}const i0={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},h$={};function Dw(e,n){const t=h$,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return e2(e,r,a)}function e2(e,n,t){if(p$(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return aC(e.children,n,t)}return Array.isArray(e)?aC(e,n,t):""}function aC(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=e2(e[a],n,t);return r.join("")}function p$(e){return!!(e&&typeof e=="object")}const sC=document.createElement("i");function Iw(e){const n="&"+e+";";sC.innerHTML=n;const t=sC.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function qa(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function gs(e,n){return e.length>0?(qa(e,e.length,0,n),e):n}const oC={}.hasOwnProperty;function t2(e){const n={};let t=-1;for(;++t<e.length;)m$(n,e[t]);return n}function m$(e,n){let t;for(t in n){const a=(oC.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){oC.call(a,l)||(a[l]=[]);const d=o[l];g$(a[l],Array.isArray(d)?d:d?[d]:[])}}}function g$(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);qa(e,0,0,r)}function n2(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Xs(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Ji=hu(/[A-Za-z]/),Mi=hu(/[\dA-Za-z]/),y$=hu(/[#-'*+\--9=?A-Z^-~]/);function eb(e){return e!==null&&(e<32||e===127)}const C1=hu(/\d/),x$=hu(/[\dA-Fa-f]/),b$=hu(/[!-/:-@[-`{-~]/);function Lt(e){return e!==null&&e<-2}function er(e){return e!==null&&(e<0||e===32)}function yn(e){return e===-2||e===-1||e===32}const Ib=hu(new RegExp("\\p{P}|\\p{S}","u")),Ud=hu(/\s/);function hu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Wh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Mi(e.charCodeAt(t+1))&&Mi(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function Tn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return yn(f)?(e.enter(t),d(f)):n(f)}function d(f){return yn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const v$={tokenize:w$};function w$(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),Tn(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Lt(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const S$={tokenize:N$},lC={tokenize:C$};function N$(e){const n=this,t=[];let r=0,a,o,l;return d;function d(R){if(r<t.length){const z=t[r];return n.containerState=z[1],e.attempt(z[0].continuation,f,u)(R)}return u(R)}function f(R){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const z=n.events.length;let $=z,L;for(;$--;)if(n.events[$][0]==="exit"&&n.events[$][1].type==="chunkFlow"){L=n.events[$][1].end;break}P(r);let U=z;for(;U<n.events.length;)n.events[U][1].end={...L},U++;return qa(n.events,$+1,0,n.events.slice(z)),n.events.length=U,u(R)}return d(R)}function u(R){if(r===t.length){if(!a)return b(R);if(a.currentConstruct&&a.currentConstruct.concrete)return S(R);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(lC,h,g)(R)}function h(R){return a&&M(),P(r),b(R)}function g(R){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(R)}function b(R){return n.containerState={},e.attempt(lC,v,S)(R)}function v(R){return r++,t.push([n.currentConstruct,n.containerState]),b(R)}function S(R){if(R===null){a&&M(),P(0),e.consume(R);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(R)}function k(R){if(R===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(R);return}return Lt(R)?(e.consume(R),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(R),k)}function T(R,z){const $=n.sliceStream(R);if(z&&$.push(null),R.previous=o,o&&(o.next=R),o=R,a.defineSkip(R.start),a.write($),n.parser.lazy[R.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const U=n.events.length;let B=U,W,I;for(;B--;)if(n.events[B][0]==="exit"&&n.events[B][1].type==="chunkFlow"){if(W){I=n.events[B][1].end;break}W=!0}for(P(r),L=U;L<n.events.length;)n.events[L][1].end={...I},L++;qa(n.events,B+1,0,n.events.slice(U)),n.events.length=L}}function P(R){let z=t.length;for(;z-- >R;){const $=t[z];n.containerState=$[1],$[0].exit.call(n,e)}t.length=R}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function C$(e,n,t){return Tn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function $h(e){if(e===null||er(e)||Ud(e))return 1;if(Ib(e))return 2}function Rb(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const _1={name:"attention",resolveAll:_$,tokenize:j$};function _$(e,n){let t=-1,r,a,o,l,d,f,u,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};cC(g,-f),cC(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=gs(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=gs(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=gs(u,Rb(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=gs(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,u=gs(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,qa(e,r-1,t-r+3,u),t=r+u.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function j$(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=$h(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),h=$h(f),g=!h||h===2&&a||t.includes(f),b=!a||a===2&&h||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(h||!g)),n(f)}}function cC(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const k$={name:"autolink",tokenize:T$};function T$(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Ji(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Mi(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||Mi(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||eb(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),h):y$(v)?(e.consume(v),u):t(v)}function h(v){return Mi(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Mi(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const ug={partial:!0,tokenize:E$};function E$(e,n,t){return r;function r(o){return yn(o)?Tn(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Lt(o)?n(o):t(o)}}const r2={continuation:{tokenize:P$},exit:D$,name:"blockQuote",tokenize:A$};function A$(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return yn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function P$(e,n,t){const r=this;return a;function a(l){return yn(l)?Tn(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(r2,n,t)(l)}}function D$(e){e.exit("blockQuote")}const i2={name:"characterEscape",tokenize:I$};function I$(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return b$(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const a2={name:"characterReference",tokenize:R$};function R$(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Mi,h(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=x$,h):(e.enter("characterReferenceValue"),o=7,l=C1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Mi&&!Iw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),h):t(g)}}const uC={partial:!0,tokenize:O$},dC={concrete:!0,name:"codeFenced",tokenize:M$};function M$(e,n,t){const r=this,a={partial:!0,tokenize:$};let o=0,l=0,d;return f;function f(L){return u(L)}function u(L){const U=r.events[r.events.length-1];return o=U&&U[1].type==="linePrefix"?U[2].sliceSerialize(U[1],!0).length:0,d=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(L)}function h(L){return L===d?(l++,e.consume(L),h):l<3?t(L):(e.exit("codeFencedFenceSequence"),yn(L)?Tn(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Lt(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(uC,k,z)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Lt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):yn(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Tn(e,v,"whitespace")(L)):L===96&&L===d?t(L):(e.consume(L),b)}function v(L){return L===null||Lt(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Lt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===d?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,z,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),P}function P(L){return o>0&&yn(L)?Tn(e,M,"linePrefix",o+1)(L):M(L)}function M(L){return L===null||Lt(L)?e.check(uC,k,z)(L):(e.enter("codeFlowValue"),R(L))}function R(L){return L===null||Lt(L)?(e.exit("codeFlowValue"),M(L)):(e.consume(L),R)}function z(L){return e.exit("codeFenced"),n(L)}function $(L,U,B){let W=0;return I;function I(G){return L.enter("lineEnding"),L.consume(G),L.exit("lineEnding"),F}function F(G){return L.enter("codeFencedFence"),yn(G)?Tn(L,V,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(G):V(G)}function V(G){return G===d?(L.enter("codeFencedFenceSequence"),re(G)):B(G)}function re(G){return G===d?(W++,L.consume(G),re):W>=l?(L.exit("codeFencedFenceSequence"),yn(G)?Tn(L,ie,"whitespace")(G):ie(G)):B(G)}function ie(G){return G===null||Lt(G)?(L.exit("codeFencedFence"),U(G)):B(G)}}}function O$(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const a0={name:"codeIndented",tokenize:F$},L$={partial:!0,tokenize:$$};function F$(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),Tn(e,o,"linePrefix",5)(u)}function o(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Lt(u)?e.attempt(L$,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Lt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function $$(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Lt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):Tn(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Lt(l)?a(l):t(l)}}const z$={name:"codeText",previous:B$,resolve:U$,tokenize:q$};function U$(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function B$(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function q$(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,h(g)):Lt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Lt(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}let V$=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Tm(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Tm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Tm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Tm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Tm(this.left,t.reverse())}}};function Tm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function s2(e){const n={};let t=-1,r,a,o,l,d,f,u;const h=new V$(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,H$(h,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=h.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},d=h.slice(a,t),d.unshift(r),h.splice(a,t-a+1,d))}}return qa(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function H$(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let h,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const G$={resolve:W$,tokenize:Q$},Y$={partial:!0,tokenize:J$};function W$(e){return s2(e),e}function Q$(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Lt(d)?e.check(Y$,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function J$(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Tn(e,o,"linePrefix")}function o(l){if(l===null||Lt(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function o2(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let h=0;return g;function g(P){return P===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||eb(P)?t(P):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||Lt(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!h&&(P===null||P===41||er(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(P)):h<u&&P===40?(e.consume(P),h++,k):P===41?(e.consume(P),h--,k):P===null||P===32||P===40||eb(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function l2(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),h}function h(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Lt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Lt(v)||d++>999?(e.exit("chunkString"),h(v)):(e.consume(v),f||(f=!yn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function c2(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Lt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),Tn(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||Lt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function qm(e,n){let t;return r;function r(a){return Lt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):yn(a)?Tn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const K$={name:"definition",tokenize:Z$},X$={partial:!0,tokenize:e5};function Z$(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return l2.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=Xs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return er(v)?qm(e,u)(v):u(v)}function u(v){return o2(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(X$,g,g)(v)}function g(v){return yn(v)?Tn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Lt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function e5(e,n,t){return r;function r(d){return er(d)?qm(e,a)(d):t(d)}function a(d){return c2(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return yn(d)?Tn(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Lt(d)?n(d):t(d)}}const t5={name:"hardBreakEscape",tokenize:n5};function n5(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Lt(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const r5={name:"headingAtx",resolve:i5,tokenize:a5};function i5(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},qa(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function a5(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),o(h)}function o(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||er(h)?(e.exit("atxHeadingSequence"),d(h)):t(h)}function d(h){return h===35?(e.enter("atxHeadingSequence"),f(h)):h===null||Lt(h)?(e.exit("atxHeading"),n(h)):yn(h)?Tn(e,d,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function f(h){return h===35?(e.consume(h),f):(e.exit("atxHeadingSequence"),d(h))}function u(h){return h===null||h===35||er(h)?(e.exit("atxHeadingText"),d(h)):(e.consume(h),u)}}const s5=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],fC=["pre","script","style","textarea"],o5={concrete:!0,name:"htmlFlow",resolveTo:u5,tokenize:d5},l5={partial:!0,tokenize:h5},c5={partial:!0,tokenize:f5};function u5(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function d5(e,n,t){const r=this;let a,o,l,d,f;return u;function u(D){return h(D)}function h(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,r.interrupt?n:E):Ji(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):Ji(D)?(e.consume(D),a=4,r.interrupt?n:E):t(D)}function v(D){return D===45?(e.consume(D),r.interrupt?n:E):t(D)}function S(D){const pe="CDATA[";return D===pe.charCodeAt(d++)?(e.consume(D),d===pe.length?r.interrupt?n:V:S):t(D)}function k(D){return Ji(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||er(D)){const pe=D===47,Ne=l.toLowerCase();return!pe&&!o&&fC.includes(Ne)?(a=1,r.interrupt?n(D):V(D)):s5.includes(l.toLowerCase())?(a=6,pe?(e.consume(D),P):r.interrupt?n(D):V(D)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(D):o?M(D):R(D))}return D===45||Mi(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),r.interrupt?n:V):t(D)}function M(D){return yn(D)?(e.consume(D),M):I(D)}function R(D){return D===47?(e.consume(D),I):D===58||D===95||Ji(D)?(e.consume(D),z):yn(D)?(e.consume(D),R):I(D)}function z(D){return D===45||D===46||D===58||D===95||Mi(D)?(e.consume(D),z):$(D)}function $(D){return D===61?(e.consume(D),L):yn(D)?(e.consume(D),$):R(D)}function L(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,U):yn(D)?(e.consume(D),L):B(D)}function U(D){return D===f?(e.consume(D),f=null,W):D===null||Lt(D)?t(D):(e.consume(D),U)}function B(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||er(D)?$(D):(e.consume(D),B)}function W(D){return D===47||D===62||yn(D)?R(D):t(D)}function I(D){return D===62?(e.consume(D),F):t(D)}function F(D){return D===null||Lt(D)?V(D):yn(D)?(e.consume(D),F):t(D)}function V(D){return D===45&&a===2?(e.consume(D),Y):D===60&&a===1?(e.consume(D),ne):D===62&&a===4?(e.consume(D),de):D===63&&a===3?(e.consume(D),E):D===93&&a===5?(e.consume(D),oe):Lt(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(l5,he,re)(D)):D===null||Lt(D)?(e.exit("htmlFlowData"),re(D)):(e.consume(D),V)}function re(D){return e.check(c5,ie,he)(D)}function ie(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),G}function G(D){return D===null||Lt(D)?re(D):(e.enter("htmlFlowData"),V(D))}function Y(D){return D===45?(e.consume(D),E):V(D)}function ne(D){return D===47?(e.consume(D),l="",le):V(D)}function le(D){if(D===62){const pe=l.toLowerCase();return fC.includes(pe)?(e.consume(D),de):V(D)}return Ji(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),le):V(D)}function oe(D){return D===93?(e.consume(D),E):V(D)}function E(D){return D===62?(e.consume(D),de):D===45&&a===2?(e.consume(D),E):V(D)}function de(D){return D===null||Lt(D)?(e.exit("htmlFlowData"),he(D)):(e.consume(D),de)}function he(D){return e.exit("htmlFlow"),n(D)}}function f5(e,n,t){const r=this;return a;function a(l){return Lt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function h5(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(ug,n,t)}}const p5={name:"htmlText",tokenize:m5};function m5(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),$):E===63?(e.consume(E),R):Ji(E)?(e.consume(E),B):t(E)}function u(E){return E===45?(e.consume(E),h):E===91?(e.consume(E),o=0,S):Ji(E)?(e.consume(E),M):t(E)}function h(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Lt(E)?(l=g,ne(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?Y(E):E===45?b(E):g(E)}function S(E){const de="CDATA[";return E===de.charCodeAt(o++)?(e.consume(E),o===de.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Lt(E)?(l=k,ne(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),P):k(E)}function P(E){return E===62?Y(E):E===93?(e.consume(E),P):k(E)}function M(E){return E===null||E===62?Y(E):Lt(E)?(l=M,ne(E)):(e.consume(E),M)}function R(E){return E===null?t(E):E===63?(e.consume(E),z):Lt(E)?(l=R,ne(E)):(e.consume(E),R)}function z(E){return E===62?Y(E):R(E)}function $(E){return Ji(E)?(e.consume(E),L):t(E)}function L(E){return E===45||Mi(E)?(e.consume(E),L):U(E)}function U(E){return Lt(E)?(l=U,ne(E)):yn(E)?(e.consume(E),U):Y(E)}function B(E){return E===45||Mi(E)?(e.consume(E),B):E===47||E===62||er(E)?W(E):t(E)}function W(E){return E===47?(e.consume(E),Y):E===58||E===95||Ji(E)?(e.consume(E),I):Lt(E)?(l=W,ne(E)):yn(E)?(e.consume(E),W):Y(E)}function I(E){return E===45||E===46||E===58||E===95||Mi(E)?(e.consume(E),I):F(E)}function F(E){return E===61?(e.consume(E),V):Lt(E)?(l=F,ne(E)):yn(E)?(e.consume(E),F):W(E)}function V(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,re):Lt(E)?(l=V,ne(E)):yn(E)?(e.consume(E),V):(e.consume(E),ie)}function re(E){return E===a?(e.consume(E),a=void 0,G):E===null?t(E):Lt(E)?(l=re,ne(E)):(e.consume(E),re)}function ie(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||er(E)?W(E):(e.consume(E),ie)}function G(E){return E===47||E===62||er(E)?W(E):t(E)}function Y(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function ne(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),le}function le(E){return yn(E)?Tn(e,oe,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):oe(E)}function oe(E){return e.enter("htmlTextData"),l(E)}}const Rw={name:"labelEnd",resolveAll:b5,resolveTo:v5,tokenize:w5},g5={tokenize:S5},y5={tokenize:N5},x5={tokenize:C5};function b5(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&qa(e,0,e.length,t),e}function v5(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=gs(d,e.slice(o+1,o+r+3)),d=gs(d,[["enter",h,n]]),d=gs(d,Rb(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=gs(d,[["exit",h,n],e[l-2],e[l-1],["exit",u,n]]),d=gs(d,e.slice(l+1)),d=gs(d,[["exit",f,n]]),qa(e,o,e.length,d),e}function w5(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(Xs(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(g5,h,l?h:g)(b):b===91?e.attempt(y5,h,l?u:g)(b):l?h(b):g(b)}function u(b){return e.attempt(x5,h,g)(b)}function h(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function S5(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return er(g)?qm(e,o)(g):o(g)}function o(g){return g===41?h(g):o2(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return er(g)?qm(e,f)(g):h(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?c2(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function u(g){return er(g)?qm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function N5(e,n,t){const r=this;return a;function a(d){return l2.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes(Xs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function C5(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const _5={name:"labelStartImage",resolveAll:Rw.resolveAll,tokenize:j5};function j5(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const k5={name:"labelStartLink",resolveAll:Rw.resolveAll,tokenize:T5};function T5(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const s0={name:"lineEnding",tokenize:E5};function E5(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Tn(e,n,"linePrefix")}}const zx={name:"thematicBreak",tokenize:A5};function A5(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Lt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),yn(u)?Tn(e,d,"whitespace")(u):d(u))}}const ua={continuation:{tokenize:R5},exit:O5,name:"list",tokenize:I5},P5={partial:!0,tokenize:L5},D5={partial:!0,tokenize:M5};function I5(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:C1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(zx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return C1(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(ug,r.interrupt?t:h,e.attempt(P5,b,g))}function h(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return yn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function R5(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(ug,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Tn(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!yn(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(D5,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,Tn(e,e.attempt(ua,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function M5(e,n,t){const r=this;return Tn(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function O5(e){e.exit(this.containerState.type)}function L5(e,n,t){const r=this;return Tn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!yn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const hC={name:"setextUnderline",resolveTo:F5,tokenize:$5};function F5(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function $5(e,n,t){const r=this;let a;return o;function o(u){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),yn(u)?Tn(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Lt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const z5={tokenize:U5};function U5(e){const n=this,t=e.attempt(ug,r,e.attempt(this.parser.constructs.flowInitial,a,Tn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(G$,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const B5={resolveAll:d2()},q5=u2("string"),V5=u2("text");function u2(e){return{resolveAll:d2(e==="text"?H5:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(h){return u(h)?o(h):d(h)}function d(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),f}function f(h){return u(h)?(t.exit("data"),o(h)):(t.consume(h),f)}function u(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function d2(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function H5(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const G5={42:ua,43:ua,45:ua,48:ua,49:ua,50:ua,51:ua,52:ua,53:ua,54:ua,55:ua,56:ua,57:ua,62:r2},Y5={91:K$},W5={[-2]:a0,[-1]:a0,32:a0},Q5={35:r5,42:zx,45:[hC,zx],60:o5,61:hC,95:zx,96:dC,126:dC},J5={38:a2,92:i2},K5={[-5]:s0,[-4]:s0,[-3]:s0,33:_5,38:a2,42:_1,60:[k$,p5],91:k5,92:[t5,i2],93:Rw,95:_1,96:z$},X5={null:[_1,B5]},Z5={null:[42,95]},ez={null:[]},tz=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Z5,contentInitial:Y5,disable:ez,document:G5,flow:Q5,flowInitial:W5,insideSpan:X5,string:J5,text:K5},Symbol.toStringTag,{value:"Module"}));function nz(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:U($),check:U(L),consume:M,enter:R,exit:z,interrupt:U(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(F){return l=gs(l,F),T(),l[l.length-1]!==null?[]:(B(n,0),u.events=Rb(o,u.events,u),u.events)}function b(F,V){return iz(v(F),V)}function v(F){return rz(l,F)}function S(){const{_bufferIndex:F,_index:V,line:re,column:ie,offset:G}=r;return{_bufferIndex:F,_index:V,line:re,column:ie,offset:G}}function k(F){a[F.line]=F.column,I()}function T(){let F;for(;r._index<l.length;){const V=l[r._index];if(typeof V=="string")for(F=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===F&&r._bufferIndex<V.length;)P(V.charCodeAt(r._bufferIndex));else P(V)}}function P(F){h=h(F)}function M(F){Lt(F)?(r.line++,r.column=1,r.offset+=F===-3?2:1,I()):F!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=F}function R(F,V){const re=V||{};return re.type=F,re.start=S(),u.events.push(["enter",re,u]),d.push(re),re}function z(F){const V=d.pop();return V.end=S(),u.events.push(["exit",V,u]),V}function $(F,V){B(F,V.from)}function L(F,V){V.restore()}function U(F,V){return re;function re(ie,G,Y){let ne,le,oe,E;return Array.isArray(ie)?he(ie):"tokenize"in ie?he([ie]):de(ie);function de(te){return K;function K(J){const ye=J!==null&&te[J],He=J!==null&&te.null,Q=[...Array.isArray(ye)?ye:ye?[ye]:[],...Array.isArray(He)?He:He?[He]:[]];return he(Q)(J)}}function he(te){return ne=te,le=0,te.length===0?Y:D(te[le])}function D(te){return K;function K(J){return E=W(),oe=te,te.partial||(u.currentConstruct=te),te.name&&u.parser.constructs.disable.null.includes(te.name)?Ne():te.tokenize.call(V?Object.assign(Object.create(u),V):u,f,pe,Ne)(J)}}function pe(te){return F(oe,E),G}function Ne(te){return E.restore(),++le<ne.length?D(ne[le]):Y}}}function B(F,V){F.resolveAll&&!o.includes(F)&&o.push(F),F.resolve&&qa(u.events,V,u.events.length-V,F.resolve(u.events.slice(V),u)),F.resolveTo&&(u.events=F.resolveTo(u.events,u))}function W(){const F=S(),V=u.previous,re=u.currentConstruct,ie=u.events.length,G=Array.from(d);return{from:ie,restore:Y};function Y(){r=F,u.previous=V,u.currentConstruct=re,u.events.length=ie,d=G,I()}}function I(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function rz(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function iz(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function az(e){const r={constructs:t2([tz,...(e||{}).extensions||[]]),content:a(v$),defined:[],document:a(S$),flow:a(z5),lazy:{},string:a(q5),text:a(V5)};return r;function a(o){return l;function l(d){return nz(r,o,d)}}}function sz(e){for(;!s2(e););return e}const pC=/[\0\t\n\r]/g;function oz(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,h,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(pC.lastIndex=g,u=pC.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,f.push(-2);e++<h;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const lz=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function cz(e){return e.replace(lz,uz)}function uz(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return n2(t.slice(o?2:1),o?16:10)}return Iw(t)||e}const f2={}.hasOwnProperty;function dz(e,n,t){return typeof n!="string"&&(t=n,n=void 0),fz(t)(sz(az(t).document().write(oz()(e,n,!0))))}function fz(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(xt),autolinkProtocol:W,autolinkEmail:W,atxHeading:o(_e),blockQuote:o(He),characterEscape:W,characterReference:W,codeFenced:o(Q),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Q,l),codeText:o(Pe,l),codeTextData:W,data:W,codeFlowValue:W,definition:o(Re),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Le),hardBreakEscape:o(Ke),hardBreakTrailing:o(Ke),htmlFlow:o(Ye,l),htmlFlowData:W,htmlText:o(Ye,l),htmlTextData:W,image:o(it),label:l,link:o(xt),listItem:o(ue),listItemValue:b,listOrdered:o(Nt,g),listUnordered:o(Nt),paragraph:o(Ae),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(_e),strong:o(ke),thematicBreak:o(ve)},exit:{atxHeading:f(),atxHeadingSequence:$,autolink:f(),autolinkEmail:ye,autolinkProtocol:J,blockQuote:f(),characterEscapeValue:I,characterReferenceMarkerHexadecimal:Ne,characterReferenceMarkerNumeric:Ne,characterReferenceValue:te,characterReference:K,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:I,codeIndented:f(P),codeText:f(G),codeTextData:I,data:I,definition:f(),definitionDestinationString:z,definitionLabelString:M,definitionTitleString:R,emphasis:f(),hardBreakEscape:f(V),hardBreakTrailing:f(V),htmlFlow:f(re),htmlFlowData:I,htmlText:f(ie),htmlTextData:I,image:f(ne),label:oe,labelText:le,lineEnding:F,link:f(Y),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:pe,resourceDestinationString:E,resourceTitleString:de,resource:he,setextHeading:f(B),setextHeadingLineSequence:U,setextHeadingText:L,strong:f(),thematicBreak:f()}};h2(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(X){let fe={type:"root",children:[]};const Ge={stack:[fe],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:h,data:t},Je=[];let ct=-1;for(;++ct<X.length;)if(X[ct][1].type==="listOrdered"||X[ct][1].type==="listUnordered")if(X[ct][0]==="enter")Je.push(ct);else{const wt=Je.pop();ct=a(X,wt,ct)}for(ct=-1;++ct<X.length;){const wt=n[X[ct][0]];f2.call(wt,X[ct][1].type)&&wt[X[ct][1].type].call(Object.assign({sliceSerialize:X[ct][2].sliceSerialize},Ge),X[ct][1])}if(Ge.tokenStack.length>0){const wt=Ge.tokenStack[Ge.tokenStack.length-1];(wt[1]||mC).call(Ge,void 0,wt[0])}for(fe.position={start:eu(X.length>0?X[0][1].start:{line:1,column:1,offset:0}),end:eu(X.length>0?X[X.length-2][1].end:{line:1,column:1,offset:0})},ct=-1;++ct<n.transforms.length;)fe=n.transforms[ct](fe)||fe;return fe}function a(X,fe,Ge){let Je=fe-1,ct=-1,wt=!1,Ht,Ce,be,Fe;for(;++Je<=Ge;){const Ie=X[Je];switch(Ie[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ie[0]==="enter"?ct++:ct--,Fe=void 0;break}case"lineEndingBlank":{Ie[0]==="enter"&&(Ht&&!Fe&&!ct&&!be&&(be=Je),Fe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Fe=void 0}if(!ct&&Ie[0]==="enter"&&Ie[1].type==="listItemPrefix"||ct===-1&&Ie[0]==="exit"&&(Ie[1].type==="listUnordered"||Ie[1].type==="listOrdered")){if(Ht){let Ve=Je;for(Ce=void 0;Ve--;){const st=X[Ve];if(st[1].type==="lineEnding"||st[1].type==="lineEndingBlank"){if(st[0]==="exit")continue;Ce&&(X[Ce][1].type="lineEndingBlank",wt=!0),st[1].type="lineEnding",Ce=Ve}else if(!(st[1].type==="linePrefix"||st[1].type==="blockQuotePrefix"||st[1].type==="blockQuotePrefixWhitespace"||st[1].type==="blockQuoteMarker"||st[1].type==="listItemIndent"))break}be&&(!Ce||be<Ce)&&(Ht._spread=!0),Ht.end=Object.assign({},Ce?X[Ce][1].start:Ie[1].end),X.splice(Ce||Je,0,["exit",Ht,Ie[2]]),Je++,Ge++}if(Ie[1].type==="listItemPrefix"){const Ve={type:"listItem",_spread:!1,start:Object.assign({},Ie[1].start),end:void 0};Ht=Ve,X.splice(Je,0,["enter",Ve,Ie[2]]),Je++,Ge++,be=void 0,Fe=!0}}}return X[fe][1]._spread=wt,Ge}function o(X,fe){return Ge;function Ge(Je){d.call(this,X(Je),Je),fe&&fe.call(this,Je)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(X,fe,Ge){this.stack[this.stack.length-1].children.push(X),this.stack.push(X),this.tokenStack.push([fe,Ge||void 0]),X.position={start:eu(fe.start),end:void 0}}function f(X){return fe;function fe(Ge){X&&X.call(this,Ge),u.call(this,Ge)}}function u(X,fe){const Ge=this.stack.pop(),Je=this.tokenStack.pop();if(Je)Je[0].type!==X.type&&(fe?fe.call(this,X,Je[0]):(Je[1]||mC).call(this,X,Je[0]));else throw new Error("Cannot close `"+X.type+"` ("+Bm({start:X.start,end:X.end})+"): its not open");Ge.position.end=eu(X.end)}function h(){return Dw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(X){if(this.data.expectingFirstListItemValue){const fe=this.stack[this.stack.length-2];fe.start=Number.parseInt(this.sliceSerialize(X),10),this.data.expectingFirstListItemValue=void 0}}function v(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.lang=X}function S(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.meta=X}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X.replace(/(\r?\n|\r)$/g,"")}function M(X){const fe=this.resume(),Ge=this.stack[this.stack.length-1];Ge.label=fe,Ge.identifier=Xs(this.sliceSerialize(X)).toLowerCase()}function R(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.title=X}function z(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.url=X}function $(X){const fe=this.stack[this.stack.length-1];if(!fe.depth){const Ge=this.sliceSerialize(X).length;fe.depth=Ge}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function U(X){const fe=this.stack[this.stack.length-1];fe.depth=this.sliceSerialize(X).codePointAt(0)===61?1:2}function B(){this.data.setextHeadingSlurpLineEnding=void 0}function W(X){const Ge=this.stack[this.stack.length-1].children;let Je=Ge[Ge.length-1];(!Je||Je.type!=="text")&&(Je=Se(),Je.position={start:eu(X.start),end:void 0},Ge.push(Je)),this.stack.push(Je)}function I(X){const fe=this.stack.pop();fe.value+=this.sliceSerialize(X),fe.position.end=eu(X.end)}function F(X){const fe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ge=fe.children[fe.children.length-1];Ge.position.end=eu(X.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(fe.type)&&(W.call(this,X),I.call(this,X))}function V(){this.data.atHardBreak=!0}function re(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X}function ie(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X}function G(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X}function Y(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=fe,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function ne(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=fe,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function le(X){const fe=this.sliceSerialize(X),Ge=this.stack[this.stack.length-2];Ge.label=cz(fe),Ge.identifier=Xs(fe).toLowerCase()}function oe(){const X=this.stack[this.stack.length-1],fe=this.resume(),Ge=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ge.type==="link"){const Je=X.children;Ge.children=Je}else Ge.alt=fe}function E(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.url=X}function de(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.title=X}function he(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function pe(X){const fe=this.resume(),Ge=this.stack[this.stack.length-1];Ge.label=fe,Ge.identifier=Xs(this.sliceSerialize(X)).toLowerCase(),this.data.referenceType="full"}function Ne(X){this.data.characterReferenceType=X.type}function te(X){const fe=this.sliceSerialize(X),Ge=this.data.characterReferenceType;let Je;Ge?(Je=n2(fe,Ge==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Je=Iw(fe);const ct=this.stack[this.stack.length-1];ct.value+=Je}function K(X){const fe=this.stack.pop();fe.position.end=eu(X.end)}function J(X){I.call(this,X);const fe=this.stack[this.stack.length-1];fe.url=this.sliceSerialize(X)}function ye(X){I.call(this,X);const fe=this.stack[this.stack.length-1];fe.url="mailto:"+this.sliceSerialize(X)}function He(){return{type:"blockquote",children:[]}}function Q(){return{type:"code",lang:null,meta:null,value:""}}function Pe(){return{type:"inlineCode",value:""}}function Re(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Le(){return{type:"emphasis",children:[]}}function _e(){return{type:"heading",depth:0,children:[]}}function Ke(){return{type:"break"}}function Ye(){return{type:"html",value:""}}function it(){return{type:"image",title:null,url:"",alt:null}}function xt(){return{type:"link",title:null,url:"",children:[]}}function Nt(X){return{type:"list",ordered:X.type==="listOrdered",start:null,spread:X._spread,children:[]}}function ue(X){return{type:"listItem",spread:X._spread,checked:null,children:[]}}function Ae(){return{type:"paragraph",children:[]}}function ke(){return{type:"strong",children:[]}}function Se(){return{type:"text",value:""}}function ve(){return{type:"thematicBreak"}}}function eu(e){return{line:e.line,column:e.column,offset:e.offset}}function h2(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?h2(e,r):hz(e,r)}}function hz(e,n){let t;for(t in n)if(f2.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function mC(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Bm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Bm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Bm({start:n.start,end:n.end})+") is still open")}function pz(e){const n=this;n.parser=t;function t(r){return dz(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function mz(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function gz(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function yz(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function xz(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function bz(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function vz(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Wh(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function wz(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Sz(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function p2(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function Nz(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return p2(e,n);const a={src:Wh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function Cz(e,n){const t={src:Wh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function _z(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function jz(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return p2(e,n);const a={href:Wh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function kz(e,n){const t={href:Wh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function Tz(e,n,t){const r=e.all(n),a=t?Ez(t):m2(n),o={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const h=r[d];(a||d!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function Ez(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=m2(t[r])}return n}function m2(e){const n=e.spread;return n??e.children.length>1}function Az(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function Pz(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Dz(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function Iz(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Rz(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=Tw(n.children[1]),f=Wk(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function Mz(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,h),e.applyData(n,h)}function Oz(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const gC=9,yC=32;function Lz(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(xC(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(xC(n.slice(a),a>0,!1)),o.join("")}function xC(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===gC||o===yC;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===gC||o===yC;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function Fz(e,n){const t={type:"text",value:Lz(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function $z(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const zz={blockquote:mz,break:gz,code:yz,delete:xz,emphasis:bz,footnoteReference:vz,heading:wz,html:Sz,imageReference:Nz,image:Cz,inlineCode:_z,linkReference:jz,link:kz,listItem:Tz,list:Az,paragraph:Pz,root:Dz,strong:Iz,table:Rz,tableCell:Oz,tableRow:Mz,text:Fz,thematicBreak:$z,toml:mx,yaml:mx,definition:mx,footnoteDefinition:mx};function mx(){}const g2=-1,Mb=0,Vm=1,tb=2,Mw=3,Ow=4,Lw=5,Fw=6,y2=7,x2=8,bC=typeof self=="object"?self:globalThis,Uz=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Mb:case g2:return t(l,a);case Vm:{const d=t([],a);for(const f of l)d.push(r(f));return d}case tb:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case Mw:return t(new Date(l),a);case Ow:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case Lw:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case Fw:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case y2:{const{name:d,message:f}=l;return t(new bC[d](f),a)}case x2:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new bC[o](l),a)};return r},vC=e=>Uz(new Map,e)(0),bh="",{toString:Bz}={},{keys:qz}=Object,Em=e=>{const n=typeof e;if(n!=="object"||!e)return[Mb,n];const t=Bz.call(e).slice(8,-1);switch(t){case"Array":return[Vm,bh];case"Object":return[tb,bh];case"Date":return[Mw,bh];case"RegExp":return[Ow,bh];case"Map":return[Lw,bh];case"Set":return[Fw,bh];case"DataView":return[Vm,t]}return t.includes("Array")?[Vm,t]:t.includes("Error")?[y2,t]:[tb,t]},gx=([e,n])=>e===Mb&&(n==="function"||n==="symbol"),Vz=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Em(l);switch(d){case Mb:{let h=l;switch(f){case"bigint":d=x2,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);h=null;break;case"undefined":return a([g2],l)}return a([d,h],l)}case Vm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const h=[],g=a([d,h],l);for(const b of l)h.push(o(b));return g}case tb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const h=[],g=a([d,h],l);for(const b of qz(l))(e||!gx(Em(l[b])))&&h.push([o(b),o(l[b])]);return g}case Mw:return a([d,l.toISOString()],l);case Ow:{const{source:h,flags:g}=l;return a([d,{source:h,flags:g}],l)}case Lw:{const h=[],g=a([d,h],l);for(const[b,v]of l)(e||!(gx(Em(b))||gx(Em(v))))&&h.push([o(b),o(v)]);return g}case Fw:{const h=[],g=a([d,h],l);for(const b of l)(e||!gx(Em(b)))&&h.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},wC=(e,{json:n,lossy:t}={})=>{const r=[];return Vz(!(n||t),!!n,new Map,r)(e),r},nb=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?vC(wC(e,n)):structuredClone(e):(e,n)=>vC(wC(e,n));function Hz(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function Gz(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function Yz(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||Hz,r=e.options.footnoteBackLabel||Gz,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const h=e.all(u),g=String(u.identifier).toUpperCase(),b=Wh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else h.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...nb(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const Ob=function(e){if(e==null)return Kz;if(typeof e=="function")return Lb(e);if(typeof e=="object")return Array.isArray(e)?Wz(e):Qz(e);if(typeof e=="string")return Jz(e);throw new Error("Expected function, string, or object as test")};function Wz(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Ob(e[t]);return Lb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function Qz(e){const n=e;return Lb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function Jz(e){return Lb(n);function n(t){return t&&t.type===e}}function Lb(e){return n;function n(t,r,a){return!!(Xz(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function Kz(){return!0}function Xz(e){return e!==null&&typeof e=="object"&&"type"in e}const b2=[],Zz=!0,j1=!1,e8="skip";function v2(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=Ob(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,h){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=b2,S,k,T;if((!n||o(f,u,h[h.length-1]||void 0))&&(v=t8(t(f,h)),v[0]===j1))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==e8)for(k=(r?P.children.length:-1)+l,T=h.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===j1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function t8(e){return Array.isArray(e)?e:typeof e=="number"?[Zz,e]:e==null?b2:[e]}function $w(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),v2(e,o,d,a);function d(f,u){const h=u[u.length-1],g=h?h.children.indexOf(f):void 0;return l(f,g,h)}}const k1={}.hasOwnProperty,n8={};function r8(e,n){const t=n||n8,r=new Map,a=new Map,o=new Map,l={...zz,...t.handlers},d={all:u,applyData:a8,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:i8,wrap:o8};return $w(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),d;function f(h,g){const b=h.type,v=d.handlers[b];if(k1.call(d.handlers,b)&&v)return v(d,h,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,P=nb(T);return P.children=d.all(h),P}return nb(h)}return(d.options.unknownHandler||s8)(d,h,g)}function u(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=SC(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=SC(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function i8(e,n){e.position&&(n.position=G6(e))}function a8(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,nb(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function s8(e,n){const t=n.data||{},r="value"in n&&!(k1.call(t,"hProperties")||k1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function o8(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function SC(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function NC(e,n){const t=r8(e,n),r=t.one(e,void 0),a=Yz(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}function l8(e,n){return e&&"run"in e?async function(t,r){const a=NC(t,{file:r,...n});await e.run(a,r)}:function(t,r){return NC(t,{file:r,...e||n})}}function CC(e){if(e)throw e}var o0,_C;function c8(){if(_C)return o0;_C=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var h=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!h&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,h){t&&h.name==="__proto__"?t(u,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):u[h.name]=h.newValue},d=function(u,h){if(h==="__proto__")if(e.call(u,h)){if(r)return r(u,h).value}else return;return u[h]};return o0=function f(){var u,h,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(h in u)g=d(k,h),b=d(u,h),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:h,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},o0}var u8=c8();const l0=Hd(u8);function T1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function d8(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const h=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,h?f8(h,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function f8(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const h=u;if(d&&t)throw h;return a(h)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}const Yo={basename:h8,dirname:p8,extname:m8,join:g8,sep:"/"};function h8(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');dg(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function p8(e){if(dg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function m8(e){dg(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function g8(...e){let n=-1,t;for(;++n<e.length;)dg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":y8(t)}function y8(e){dg(e);const n=e.codePointAt(0)===47;let t=x8(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function x8(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function dg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const b8={cwd:v8};function v8(){return"/"}function E1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function w8(e){if(typeof e=="string")e=new URL(e);else if(!E1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return S8(e)}function S8(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const c0=["history","path","basename","stem","extname","dirname"];let w2=class{constructor(n){let t;n?E1(n)?t={path:n}:typeof n=="string"||N8(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":b8.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<c0.length;){const o=c0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)c0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Yo.basename(this.path):void 0}set basename(n){d0(n,"basename"),u0(n,"basename"),this.path=Yo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Yo.dirname(this.path):void 0}set dirname(n){jC(this.basename,"dirname"),this.path=Yo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Yo.extname(this.path):void 0}set extname(n){if(u0(n,"extname"),jC(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Yo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){E1(n)&&(n=w8(n)),d0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Yo.basename(this.path,this.extname):void 0}set stem(n){d0(n,"stem"),u0(n,"stem"),this.path=Yo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Li(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function u0(e,n){if(e&&e.includes(Yo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Yo.sep+"`")}function d0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function jC(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function N8(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const C8=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},_8={}.hasOwnProperty;let j8=class S2 extends C8{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=d8()}copy(){const n=new S2;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(l0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(p0("data",this.frozen),this.namespace[n]=t,this):_8.call(this.namespace,n)&&this.namespace[n]||void 0:n?(p0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=yx(n),r=this.parser||this.Parser;return f0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),f0("process",this.parser||this.Parser),h0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=yx(n),f=r.parse(d);r.run(f,d,function(h,g,b){if(h||!g||!b)return u(h);const v=g,S=r.stringify(v,b);E8(S)?b.value=S:b.result=S,u(h,b)});function u(h,g){h||!g?l(h):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),f0("processSync",this.parser||this.Parser),h0("processSync",this.compiler||this.Compiler),this.process(n,a),TC("processSync","process",t),r;function a(o,l){t=!0,CC(o),r=l}}run(n,t,r){kC(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=yx(t);a.run(n,f,u);function u(h,g,b){const v=g||n;h?d(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),TC("runSync","run",r),a;function o(l,d){CC(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=yx(t),a=this.compiler||this.Compiler;return h0("stringify",a),kC(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(p0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...g]=u;f(h,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=l0(!0,a.settings,u.settings))}function d(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const g=u[h];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];T1(k)&&T1(v)&&(v=l0(!0,k,v)),r[b]=[u,v,...S]}}}};const k8=new j8().freeze();function f0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function h0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function p0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function kC(e){if(!T1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function TC(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function yx(e){return T8(e)?e:new w2(e)}function T8(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function E8(e){return typeof e=="string"||A8(e)}function A8(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const P8="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",EC=[],AC={allowDangerousHtml:!0},D8=/^(https?|ircs?|mailto|xmpp)$/i,I8=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function xs(e){const n=R8(e),t=M8(e);return O8(n.runSync(n.parse(t),t),e)}function R8(e){const n=e.rehypePlugins||EC,t=e.remarkPlugins||EC,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...AC}:AC;return k8().use(pz).use(t).use(l8,r).use(n)}function M8(e){const n=e.children||"",t=new w2;return typeof n=="string"&&(t.value=n),t}function O8(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,o=n.disallowedElements,l=n.skipHtml,d=n.unwrapDisallowed,f=n.urlTransform||L8;for(const h of I8)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+P8+h.id,void 0);return $w(e,u),K6(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function u(h,g,b){if(h.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let v;for(v in i0)if(Object.hasOwn(i0,v)&&Object.hasOwn(h.properties,v)){const S=h.properties[v],k=i0[v];(k===null||k.includes(h.tagName))&&(h.properties[v]=f(String(S||""),v,h))}}if(h.type==="element"){let v=t?!t.includes(h.tagName):o?o.includes(h.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(h,g,b)),v&&b&&typeof g=="number")return d&&h.children?b.children.splice(g,1,...h.children):b.children.splice(g,1),g}}}function L8(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||D8.test(e.slice(0,n))?e:""}function PC(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function F8(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function $8(e,n,t){const a=Ob((t||{}).ignore||[]),o=z8(n);let l=-1;for(;++l<o.length;)v2(e,"text",d);function d(u,h){let g=-1,b;for(;++g<h.length;){const v=h[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return f(u,h)}function f(u,h){const g=h[h.length-1],b=o[l][0],v=o[l][1];let S=0;const T=g.children.indexOf(u);let P=!1,M=[];b.lastIndex=0;let R=b.exec(u.value);for(;R;){const z=R.index,$={index:R.index,input:R.input,stack:[...h,u]};let L=v(...R,$);if(typeof L=="string"&&(L=L.length>0?{type:"text",value:L}:void 0),L===!1?b.lastIndex=z+1:(S!==z&&M.push({type:"text",value:u.value.slice(S,z)}),Array.isArray(L)?M.push(...L):L&&M.push(L),S=z+R[0].length,P=!0),!b.global)break;R=b.exec(u.value)}return P?(S<u.value.length&&M.push({type:"text",value:u.value.slice(S)}),g.children.splice(T,1,...M)):M=[u],T+M.length}}function z8(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([U8(a[0]),B8(a[1])])}return n}function U8(e){return typeof e=="string"?new RegExp(F8(e),"g"):e}function B8(e){return typeof e=="function"?e:function(){return e}}const m0="phrasing",g0=["autolink","link","image","label"];function q8(){return{transforms:[J8],enter:{literalAutolink:H8,literalAutolinkEmail:y0,literalAutolinkHttp:y0,literalAutolinkWww:y0},exit:{literalAutolink:Q8,literalAutolinkEmail:W8,literalAutolinkHttp:G8,literalAutolinkWww:Y8}}}function V8(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:m0,notInConstruct:g0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:m0,notInConstruct:g0},{character:":",before:"[ps]",after:"\\/",inConstruct:m0,notInConstruct:g0}]}}function H8(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function y0(e){this.config.enter.autolinkProtocol.call(this,e)}function G8(e){this.config.exit.autolinkProtocol.call(this,e)}function Y8(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function W8(e){this.config.exit.autolinkEmail.call(this,e)}function Q8(e){this.exit(e)}function J8(e){$8(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,K8],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),X8]],{ignore:["link","linkReference"]})}function K8(e,n,t,r,a){let o="";if(!N2(a)||(/^w/i.test(n)&&(t=n+t,n="",o="http://"),!Z8(t)))return!1;const l=eU(t+r);if(!l[0])return!1;const d={type:"link",title:null,url:o+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[d,{type:"text",value:l[1]}]:d}function X8(e,n,t,r){return!N2(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function Z8(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function eU(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=PC(e,"(");let o=PC(e,")");for(;r!==-1&&a>o;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),o++;return[e,t]}function N2(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||Ud(t)||Ib(t))&&(!n||t!==47)}C2.peek=cU;function tU(){this.buffer()}function nU(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function rU(){this.buffer()}function iU(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function aU(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Xs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function sU(e){this.exit(e)}function oU(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Xs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function lU(e){this.exit(e)}function cU(){return"["}function C2(e,n,t,r){const a=t.createTracker(r);let o=a.move("[^");const l=t.enter("footnoteReference"),d=t.enter("reference");return o+=a.move(t.safe(t.associationId(e),{after:"]",before:o})),d(),l(),o+=a.move("]"),o}function uU(){return{enter:{gfmFootnoteCallString:tU,gfmFootnoteCall:nU,gfmFootnoteDefinitionLabelString:rU,gfmFootnoteDefinition:iU},exit:{gfmFootnoteCallString:aU,gfmFootnoteCall:sU,gfmFootnoteDefinitionLabelString:oU,gfmFootnoteDefinition:lU}}}function dU(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:C2},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,o,l){const d=o.createTracker(l);let f=d.move("[^");const u=o.enter("footnoteDefinition"),h=o.enter("label");return f+=d.move(o.safe(o.associationId(r),{before:f,after:"]"})),h(),f+=d.move("]:"),r.children&&r.children.length>0&&(d.shift(4),f+=d.move((n?`
`:" ")+o.indentLines(o.containerFlow(r,d.current()),n?_2:fU))),u(),f}}function fU(e,n,t){return n===0?e:_2(e,n,t)}function _2(e,n,t){return(t?"":"    ")+e}const hU=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];j2.peek=xU;function pU(){return{canContainEols:["delete"],enter:{strikethrough:gU},exit:{strikethrough:yU}}}function mU(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:hU}],handlers:{delete:j2}}}function gU(e){this.enter({type:"delete",children:[]},e)}function yU(e){this.exit(e)}function j2(e,n,t,r){const a=t.createTracker(r),o=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),o(),l}function xU(){return"~"}function bU(e){return e.length}function vU(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||bU,o=[],l=[],d=[],f=[];let u=0,h=-1;for(;++h<e.length;){const k=[],T=[];let P=-1;for(e[h].length>u&&(u=e[h].length);++P<e[h].length;){const M=wU(e[h][P]);if(t.alignDelimiters!==!1){const R=a(M);T[P]=R,(f[P]===void 0||R>f[P])&&(f[P]=R)}k.push(M)}l[h]=k,d[h]=T}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<u;)o[g]=DC(r[g]);else{const k=DC(r);for(;++g<u;)o[g]=k}g=-1;const b=[],v=[];for(;++g<u;){const k=o[g];let T="",P="";k===99?(T=":",P=":"):k===108?T=":":k===114&&(P=":");let M=t.alignDelimiters===!1?1:Math.max(1,f[g]-T.length-P.length);const R=T+"-".repeat(M)+P;t.alignDelimiters!==!1&&(M=T.length+M+P.length,M>f[g]&&(f[g]=M),v[g]=M),b[g]=R}l.splice(1,0,b),d.splice(1,0,v),h=-1;const S=[];for(;++h<l.length;){const k=l[h],T=d[h];g=-1;const P=[];for(;++g<u;){const M=k[g]||"";let R="",z="";if(t.alignDelimiters!==!1){const $=f[g]-(T[g]||0),L=o[g];L===114?R=" ".repeat($):L===99?$%2?(R=" ".repeat($/2+.5),z=" ".repeat($/2-.5)):(R=" ".repeat($/2),z=R):z=" ".repeat($)}t.delimiterStart!==!1&&!g&&P.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&M==="")&&(t.delimiterStart!==!1||g)&&P.push(" "),t.alignDelimiters!==!1&&P.push(R),P.push(M),t.alignDelimiters!==!1&&P.push(z),t.padding!==!1&&P.push(" "),(t.delimiterEnd!==!1||g!==u-1)&&P.push("|")}S.push(t.delimiterEnd===!1?P.join("").replace(/ +$/,""):P.join(""))}return S.join(`
`)}function wU(e){return e==null?"":String(e)}function DC(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function SU(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),NU);return a(),l}function NU(e,n,t){return">"+(t?"":" ")+e}function CU(e,n){return IC(e,n.inConstruct,!0)&&!IC(e,n.notInConstruct,!1)}function IC(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function RC(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&CU(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function _U(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function jU(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function kU(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function TU(e,n,t,r){const a=kU(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(jU(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,EU);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(_U(o,a)+1,3)),u=t.enter("codeFenced");let h=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=d.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=d.move(" "),h+=d.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...d.current()})),g()}return h+=d.move(`
`),o&&(h+=d.move(o+`
`)),h+=d.move(f),u(),h}function EU(e,n,t){return(t?"":"    ")+e}function zw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function AU(e,n,t,r){const a=zw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function PU(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function Xm(e){return"&#x"+e.toString(16).toUpperCase()+";"}function rb(e,n,t){const r=$h(e),a=$h(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}k2.peek=DU;function k2(e,n,t,r){const a=PU(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=rb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=Xm(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=rb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+Xm(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function DU(e,n,t){return t.options.emphasis||"*"}function IU(e,n){let t=!1;return $w(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,j1}),!!((!e.depth||e.depth<3)&&Dw(e)&&(n.options.setext||t))}function RU(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(IU(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=Xm(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}T2.peek=MU;function T2(e){return e.value||""}function MU(){return"<"}E2.peek=OU;function E2(e,n,t,r){const a=zw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function OU(){return"!"}A2.peek=LU;function A2(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function LU(){return"!"}P2.peek=FU;function P2(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function FU(){return"`"}function D2(e,n){const t=Dw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}I2.peek=$U;function I2(e,n,t,r){const a=zw(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(D2(e,t)){const h=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=h,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function $U(e,n,t){return D2(e,t)?"<":"["}R2.peek=zU;function R2(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function zU(){return"["}function Uw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function UU(e){const n=Uw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function BU(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function M2(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function qU(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?BU(t):Uw(t);const d=e.ordered?l==="."?")":".":UU(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),M2(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function VU(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function HU(e,n,t,r){const a=VU(t);let o=t.bulletCurrent||Uw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),h);return f(),u;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function GU(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const YU=Ob(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function WU(e,n,t,r){return(e.children.some(function(l){return YU(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function QU(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}O2.peek=JU;function O2(e,n,t,r){const a=QU(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=rb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=Xm(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=rb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+Xm(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function JU(e,n,t){return t.options.strong||"*"}function KU(e,n,t,r){return t.safe(e.value,r)}function XU(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function ZU(e,n,t){const r=(M2(t)+(t.options.ruleSpaces?" ":"")).repeat(XU(t));return t.options.ruleSpaces?r.slice(0,-1):r}const L2={blockquote:SU,break:RC,code:TU,definition:AU,emphasis:k2,hardBreak:RC,heading:RU,html:T2,image:E2,imageReference:A2,inlineCode:P2,link:I2,linkReference:R2,list:qU,listItem:HU,paragraph:GU,root:WU,strong:O2,text:KU,thematicBreak:ZU};function eB(){return{enter:{table:tB,tableData:MC,tableHeader:MC,tableRow:rB},exit:{codeText:iB,table:nB,tableData:x0,tableHeader:x0,tableRow:x0}}}function tB(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function nB(e){this.exit(e),this.data.inTable=void 0}function rB(e){this.enter({type:"tableRow",children:[]},e)}function x0(e){this.exit(e)}function MC(e){this.enter({type:"tableCell",children:[]},e)}function iB(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,aB));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function aB(e,n){return n==="|"?n:e}function sB(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,o=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:f,tableRow:d}};function l(v,S,k,T){return u(h(v,k,T),v.align)}function d(v,S,k,T){const P=g(v,k,T),M=u([P]);return M.slice(0,M.indexOf(`
`))}function f(v,S,k,T){const P=k.enter("tableCell"),M=k.enter("phrasing"),R=k.containerPhrasing(v,{...T,before:o,after:o});return M(),P(),R}function u(v,S){return vU(v,{align:S,alignDelimiters:r,padding:t,stringLength:a})}function h(v,S,k){const T=v.children;let P=-1;const M=[],R=S.enter("table");for(;++P<T.length;)M[P]=g(T[P],S,k);return R(),M}function g(v,S,k){const T=v.children;let P=-1;const M=[],R=S.enter("tableRow");for(;++P<T.length;)M[P]=f(T[P],v,S,k);return R(),M}function b(v,S,k){let T=L2.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function oB(){return{exit:{taskListCheckValueChecked:OC,taskListCheckValueUnchecked:OC,paragraph:cB}}}function lB(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:uB}}}function OC(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function cB(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let o=-1,l;for(;++o<a.length;){const d=a[o];if(d.type==="paragraph"){l=d;break}}l===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function uB(e,n,t,r){const a=e.children[0],o=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",d=t.createTracker(r);o&&d.move(l);let f=L2.listItem(e,n,t,{...r,...d.current()});return o&&(f=f.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),f;function u(h){return h+l}}function dB(){return[q8(),uU(),pU(),eB(),oB()]}function fB(e){return{extensions:[V8(),dU(e),mU(),sB(e),lB()]}}const hB={tokenize:bB,partial:!0},F2={tokenize:vB,partial:!0},$2={tokenize:wB,partial:!0},z2={tokenize:SB,partial:!0},pB={tokenize:NB,partial:!0},U2={name:"wwwAutolink",tokenize:yB,previous:q2},B2={name:"protocolAutolink",tokenize:xB,previous:V2},Ql={name:"emailAutolink",tokenize:gB,previous:H2},rl={};function mB(){return{text:rl}}let Dd=48;for(;Dd<123;)rl[Dd]=Ql,Dd++,Dd===58?Dd=65:Dd===91&&(Dd=97);rl[43]=Ql;rl[45]=Ql;rl[46]=Ql;rl[95]=Ql;rl[72]=[Ql,B2];rl[104]=[Ql,B2];rl[87]=[Ql,U2];rl[119]=[Ql,U2];function gB(e,n,t){const r=this;let a,o;return l;function l(g){return!A1(g)||!H2.call(r,r.previous)||Bw(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),d(g))}function d(g){return A1(g)?(e.consume(g),d):g===64?(e.consume(g),f):t(g)}function f(g){return g===46?e.check(pB,h,u)(g):g===45||g===95||Mi(g)?(o=!0,e.consume(g),f):h(g)}function u(g){return e.consume(g),a=!0,f}function h(g){return o&&a&&Ji(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function yB(e,n,t){const r=this;return a;function a(l){return l!==87&&l!==119||!q2.call(r,r.previous)||Bw(r.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(hB,e.attempt(F2,e.attempt($2,o),t),t)(l))}function o(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function xB(e,n,t){const r=this;let a="",o=!1;return l;function l(g){return(g===72||g===104)&&V2.call(r,r.previous)&&!Bw(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),d):t(g)}function d(g){if(Ji(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),d;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),f}return t(g)}function f(g){return g===47?(e.consume(g),o?u:(o=!0,f)):t(g)}function u(g){return g===null||eb(g)||er(g)||Ud(g)||Ib(g)?t(g):e.attempt(F2,e.attempt($2,h),t)(g)}function h(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function bB(e,n,t){let r=0;return a;function a(l){return(l===87||l===119)&&r<3?(r++,e.consume(l),a):l===46&&r===3?(e.consume(l),o):t(l)}function o(l){return l===null?t(l):n(l)}}function vB(e,n,t){let r,a,o;return l;function l(u){return u===46||u===95?e.check(z2,f,d)(u):u===null||er(u)||Ud(u)||u!==45&&Ib(u)?f(u):(o=!0,e.consume(u),l)}function d(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),l}function f(u){return a||r||!o?t(u):n(u)}}function wB(e,n){let t=0,r=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&r<t?o(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(z2,n,o)(l):l===null||er(l)||Ud(l)?n(l):(e.consume(l),a)}function o(l){return l===41&&r++,e.consume(l),a}}function SB(e,n,t){return r;function r(d){return d===33||d===34||d===39||d===41||d===42||d===44||d===46||d===58||d===59||d===63||d===95||d===126?(e.consume(d),r):d===38?(e.consume(d),o):d===93?(e.consume(d),a):d===60||d===null||er(d)||Ud(d)?n(d):t(d)}function a(d){return d===null||d===40||d===91||er(d)||Ud(d)?n(d):r(d)}function o(d){return Ji(d)?l(d):t(d)}function l(d){return d===59?(e.consume(d),r):Ji(d)?(e.consume(d),l):t(d)}}function NB(e,n,t){return r;function r(o){return e.consume(o),a}function a(o){return Mi(o)?t(o):n(o)}}function q2(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||er(e)}function V2(e){return!Ji(e)}function H2(e){return!(e===47||A1(e))}function A1(e){return e===43||e===45||e===46||e===95||Mi(e)}function Bw(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const CB={tokenize:DB,partial:!0};function _B(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:EB,continuation:{tokenize:AB},exit:PB}},text:{91:{name:"gfmFootnoteCall",tokenize:TB},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:jB,resolveTo:kB}}}}function jB(e,n,t){const r=this;let a=r.events.length;const o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l;for(;a--;){const f=r.events[a][1];if(f.type==="labelImage"){l=f;break}if(f.type==="gfmFootnoteCall"||f.type==="labelLink"||f.type==="label"||f.type==="image"||f.type==="link")break}return d;function d(f){if(!l||!l._balanced)return t(f);const u=Xs(r.sliceSerialize({start:l.end,end:r.now()}));return u.codePointAt(0)!==94||!o.includes(u.slice(1))?t(f):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(f),e.exit("gfmFootnoteCallLabelMarker"),n(f))}}function kB(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},d=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",o,n],["enter",l,n],["exit",l,n],["exit",o,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...d),e}function TB(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o=0,l;return d;function d(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),f}function f(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(g){if(o>999||g===93&&!l||g===null||g===91||er(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(Xs(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return er(g)||(l=!0),o++,e.consume(g),g===92?h:u}function h(g){return g===91||g===92||g===93?(e.consume(g),o++,u):u(g)}}function EB(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o,l=0,d;return f;function f(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):t(S)}function h(S){if(l>999||S===93&&!d||S===null||S===91||er(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return o=Xs(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return er(S)||(d=!0),l++,e.consume(S),S===92?g:h}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,h):h(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(o)||a.push(o),Tn(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function AB(e,n,t){return e.check(ug,n,e.attempt(CB,n,t))}function PB(e){e.exit("gfmFootnoteDefinition")}function DB(e,n,t){const r=this;return Tn(e,a,"gfmFootnoteDefinitionIndent",5);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(o):t(o)}}function IB(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:o,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(l,d){let f=-1;for(;++f<l.length;)if(l[f][0]==="enter"&&l[f][1].type==="strikethroughSequenceTemporary"&&l[f][1]._close){let u=f;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[f][1].end.offset-l[f][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[f][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[f][1].end)},g={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[f][1].start)},b=[["enter",h,d],["enter",l[u][1],d],["exit",l[u][1],d],["enter",g,d]],v=d.parser.constructs.insideSpan.null;v&&qa(b,b.length,0,Rb(v,l.slice(u+1,f),d)),qa(b,b.length,0,[["exit",g,d],["enter",l[f][1],d],["exit",l[f][1],d],["exit",h,d]]),qa(l,u-1,f-u+3,b),f=u+b.length-2;break}}for(f=-1;++f<l.length;)l[f][1].type==="strikethroughSequenceTemporary"&&(l[f][1].type="data");return l}function o(l,d,f){const u=this.previous,h=this.events;let g=0;return b;function b(S){return u===126&&h[h.length-1][1].type!=="characterEscape"?f(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=$h(u);if(S===126)return g>1?f(S):(l.consume(S),g++,v);if(g<2&&!t)return f(S);const T=l.exit("strikethroughSequenceTemporary"),P=$h(S);return T._open=!P||P===2&&!!k,T._close=!k||k===2&&!!P,d(S)}}}class RB{constructor(){this.map=[]}add(n,t,r){MB(this,n,t,r)}consume(n){if(this.map.sort(function(o,l){return o[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const o of a)n.push(o);a=r.pop()}this.map.length=0}}function MB(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function OB(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const o=r.length-1;r[o]=r[o]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function LB(){return{flow:{null:{name:"table",tokenize:FB,resolveAll:$B}}}}function FB(e,n,t){const r=this;let a=0,o=0,l;return d;function d(I){let F=r.events.length-1;for(;F>-1;){const ie=r.events[F][1].type;if(ie==="lineEnding"||ie==="linePrefix")F--;else break}const V=F>-1?r.events[F][1].type:null,re=V==="tableHead"||V==="tableRow"?L:f;return re===L&&r.parser.lazy[r.now().line]?t(I):re(I)}function f(I){return e.enter("tableHead"),e.enter("tableRow"),u(I)}function u(I){return I===124||(l=!0,o+=1),h(I)}function h(I){return I===null?t(I):Lt(I)?o>1?(o=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),v):t(I):yn(I)?Tn(e,h,"whitespace")(I):(o+=1,l&&(l=!1,a+=1),I===124?(e.enter("tableCellDivider"),e.consume(I),e.exit("tableCellDivider"),l=!0,h):(e.enter("data"),g(I)))}function g(I){return I===null||I===124||er(I)?(e.exit("data"),h(I)):(e.consume(I),I===92?b:g)}function b(I){return I===92||I===124?(e.consume(I),g):g(I)}function v(I){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(I):(e.enter("tableDelimiterRow"),l=!1,yn(I)?Tn(e,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(I):S(I))}function S(I){return I===45||I===58?T(I):I===124?(l=!0,e.enter("tableCellDivider"),e.consume(I),e.exit("tableCellDivider"),k):$(I)}function k(I){return yn(I)?Tn(e,T,"whitespace")(I):T(I)}function T(I){return I===58?(o+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(I),e.exit("tableDelimiterMarker"),P):I===45?(o+=1,P(I)):I===null||Lt(I)?z(I):$(I)}function P(I){return I===45?(e.enter("tableDelimiterFiller"),M(I)):$(I)}function M(I){return I===45?(e.consume(I),M):I===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(I),e.exit("tableDelimiterMarker"),R):(e.exit("tableDelimiterFiller"),R(I))}function R(I){return yn(I)?Tn(e,z,"whitespace")(I):z(I)}function z(I){return I===124?S(I):I===null||Lt(I)?!l||a!==o?$(I):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(I)):$(I)}function $(I){return t(I)}function L(I){return e.enter("tableRow"),U(I)}function U(I){return I===124?(e.enter("tableCellDivider"),e.consume(I),e.exit("tableCellDivider"),U):I===null||Lt(I)?(e.exit("tableRow"),n(I)):yn(I)?Tn(e,U,"whitespace")(I):(e.enter("data"),B(I))}function B(I){return I===null||I===124||er(I)?(e.exit("data"),U(I)):(e.consume(I),I===92?W:B)}function W(I){return I===92||I===124?(e.consume(I),B):B(I)}}function $B(e,n){let t=-1,r=!0,a=0,o=[0,0,0,0],l=[0,0,0,0],d=!1,f=0,u,h,g;const b=new RB;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(d=!1,f!==0&&(LC(b,n,f,u,h),h=void 0,f=0),u={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",u,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(r=!0,g=void 0,o=[0,0,0,0],l=[0,t+1,0,0],d&&(d=!1,h={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",h,n]])),a=S.type==="tableDelimiterRow"?2:h?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(r=!1,l[2]===0&&(o[1]!==0&&(l[0]=l[1],g=xx(b,n,o,a,void 0,g),o=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(r?r=!1:(o[1]!==0&&(l[0]=l[1],g=xx(b,n,o,a,void 0,g)),o=l,l=[o[1],t,0,0])):S.type==="tableHead"?(d=!0,f=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(f=t,o[1]!==0?(l[0]=l[1],g=xx(b,n,o,a,t,g)):l[1]!==0&&(g=xx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(f!==0&&LC(b,n,f,u,h),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=OB(n.events,t))}return e}function xx(e,n,t,r,a,o){const l=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",d="tableContent";t[0]!==0&&(o.end=Object.assign({},jh(n.events,t[0])),e.add(t[0],0,[["exit",o,n]]));const f=jh(n.events,t[1]);if(o={type:l,start:Object.assign({},f),end:Object.assign({},f)},e.add(t[1],0,[["enter",o,n]]),t[2]!==0){const u=jh(n.events,t[2]),h=jh(n.events,t[3]),g={type:d,start:Object.assign({},u),end:Object.assign({},h)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(o.end=Object.assign({},jh(n.events,a)),e.add(a,0,[["exit",o,n]]),o=void 0),o}function LC(e,n,t,r,a){const o=[],l=jh(n.events,t);a&&(a.end=Object.assign({},l),o.push(["exit",a,n])),r.end=Object.assign({},l),o.push(["exit",r,n]),e.add(t+1,0,o)}function jh(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const zB={name:"tasklistCheck",tokenize:BB};function UB(){return{text:{91:zB}}}function BB(e,n,t){const r=this;return a;function a(f){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(f):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),o)}function o(f){return er(f)?(e.enter("taskListCheckValueUnchecked"),e.consume(f),e.exit("taskListCheckValueUnchecked"),l):f===88||f===120?(e.enter("taskListCheckValueChecked"),e.consume(f),e.exit("taskListCheckValueChecked"),l):t(f)}function l(f){return f===93?(e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),d):t(f)}function d(f){return Lt(f)?n(f):yn(f)?e.check({tokenize:qB},n,t)(f):t(f)}}function qB(e,n,t){return Tn(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function VB(e){return t2([mB(),_B(),IB(e),LB(),UB()])}const HB={};function za(e){const n=this,t=e||HB,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),o=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),l=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(VB(t)),o.push(dB()),l.push(fB(t))}const GB="_container_plki7_3",YB="_header_plki7_21",WB="_titleGroup_plki7_41",QB="_title_plki7_41",JB="_closeButton_plki7_59",KB="_messageList_plki7_79",XB="_emptyState_plki7_108",ZB="_emptyStateIcon_plki7_119",e9="_exampleContainer_plki7_145",t9="_exampleChip_plki7_153",n9="_messageRow_plki7_176",r9="_messageRowUser_plki7_194",i9="_messageRowModel_plki7_198",a9="_messageRowSystem_plki7_202",s9="_bubble_plki7_208",o9="_bubbleUser_plki7_224",l9="_bubbleModel_plki7_234",c9="_bubbleSystem_plki7_247",u9="_processingIndicator_plki7_330",d9="_spin_plki7_343",f9="_inputArea_plki7_358",h9="_imagePreviewContainer_plki7_365",p9="_inputContainer_plki7_376",m9="_inputField_plki7_393",g9="_sendButton_plki7_407",Un={container:GB,header:YB,titleGroup:WB,title:QB,closeButton:JB,messageList:KB,emptyState:XB,emptyStateIcon:ZB,exampleContainer:e9,exampleChip:t9,messageRow:n9,messageRowUser:r9,messageRowModel:i9,messageRowSystem:a9,bubble:s9,bubbleUser:o9,bubbleModel:l9,bubbleSystem:c9,processingIndicator:u9,spin:d9,inputArea:f9,imagePreviewContainer:h9,inputContainer:p9,inputField:m9,sendButton:g9},G2=({onClose:e,settings:n,staffList:t,onSettingsUpdate:r,onStaffUpdate:a,onHighlight:o})=>{const{chatQuery:l,setChatQuery:d,chatHistory:f,isProcessing:u,handleSendMessage:h,refreshChat:g,stopGeneration:b,selectedImage:v,handleImageSelect:S,clearImage:k}=Nw({settings:n,staffList:t,onSettingsUpdate:r,onStaffUpdate:a,onHighlight:o}),T=w.useRef(null),P=w.useRef(null),M=()=>{var L;(L=T.current)==null||L.scrollIntoView({behavior:"smooth"})};w.useEffect(()=>{M()},[f,u]);const R=L=>{var B;const U=(B=L.target.files)==null?void 0:B[0];U&&S(U)},z=["Check Paracetamol stock","Go to Pharmacy","Analysis for last month","Add nurse Sarah"],$=L=>{d(L)};return i.jsxs("div",{className:Un.container,children:[i.jsxs("header",{className:Un.header,children:[i.jsxs("div",{className:Un.titleGroup,children:[i.jsx(Xx,{size:20,className:"text-violet-600"}),i.jsx("h3",{className:Un.title,children:"Clinic Assistant"})]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[i.jsx("button",{onClick:g,className:Un.closeButton,title:"Refresh Chat",children:i.jsx(Ok,{size:18})}),i.jsx("button",{onClick:e,className:Un.closeButton,title:"Close",children:i.jsx(bn,{size:20})})]})]}),i.jsxs("div",{className:Un.messageList,children:[f.length===0&&i.jsxs("div",{className:Un.emptyState,children:[i.jsx(Xx,{size:48,className:Un.emptyStateIcon}),i.jsx("p",{children:"How can I help you manage the clinic today?"}),i.jsx("div",{className:Un.exampleContainer,children:z.map((L,U)=>i.jsx("button",{className:Un.exampleChip,onClick:()=>$(L),children:L},U))})]}),f.map((L,U)=>i.jsx("div",{className:`${Un.messageRow} ${L.role==="user"?Un.messageRowUser:L.role==="model"?Un.messageRowModel:Un.messageRowSystem}`,children:i.jsx("div",{className:`${Un.bubble} ${L.role==="user"?Un.bubbleUser:L.role==="model"?Un.bubbleModel:Un.bubbleSystem}`,children:L.role==="user"||L.role==="system"?L.text:i.jsx(xs,{remarkPlugins:[za],children:L.text})})},U)),u&&i.jsx("div",{className:`${Un.messageRow} ${Un.messageRowModel}`,children:i.jsxs("div",{className:Un.processingIndicator,children:[i.jsx(Gl,{size:14,className:Un.spin}),"Thinking..."]})}),i.jsx("div",{ref:T})]}),i.jsxs("div",{className:Un.inputArea,children:[v&&i.jsxs("div",{className:Un.imagePreviewContainer,style:{marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("div",{style:{position:"relative",width:"60px",height:"60px",border:"1px solid #e5e7eb",borderRadius:"4px",overflow:"hidden"},children:[i.jsx("img",{src:v,alt:"Selected",style:{width:"100%",height:"100%",objectFit:"cover"}}),i.jsx("button",{onClick:k,style:{position:"absolute",top:0,right:0,background:"rgba(0,0,0,0.5)",color:"white",border:"none",cursor:"pointer",padding:"1px"},children:i.jsx(bn,{size:12})})]}),i.jsx("span",{style:{fontSize:"0.8rem",color:"#6b7280"},children:"Image attached"})]}),i.jsxs("div",{className:Un.inputContainer,children:[i.jsx("input",{type:"file",ref:P,onChange:R,accept:"image/*",style:{display:"none"}}),i.jsx("button",{className:Un.sendButton,onClick:()=>{var L;return(L=P.current)==null?void 0:L.click()},disabled:u,title:"Attach Image",style:{marginRight:"0.5rem",color:"#6b7280"},children:i.jsx(Ab,{size:18})}),i.jsx("input",{type:"text",className:Un.inputField,placeholder:"Type your request...",value:l,onChange:L=>d(L.target.value),onKeyDown:L=>L.key==="Enter"&&!u&&h(),disabled:u,autoFocus:!0}),u?i.jsx("button",{className:Un.sendButton,onClick:b,title:"Stop Generating",style:{color:"#ef4444"},children:i.jsx(i6,{size:18,fill:"currentColor"})}):i.jsx("button",{className:Un.sendButton,onClick:()=>h(),disabled:!l.trim()&&!v,children:i.jsx(Pb,{size:18})})]})]})]})};var b0,FC;function y9(){if(FC)return b0;FC=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,f=typeof au=="object"&&au&&au.Object===Object&&au,u=typeof self=="object"&&self&&self.Object===Object&&self,h=f||u||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return h.Date.now()};function T($,L,U){var B,W,I,F,V,re,ie=0,G=!1,Y=!1,ne=!0;if(typeof $!="function")throw new TypeError(e);L=z(L)||0,P(U)&&(G=!!U.leading,Y="maxWait"in U,I=Y?v(z(U.maxWait)||0,L):I,ne="trailing"in U?!!U.trailing:ne);function le(K){var J=B,ye=W;return B=W=void 0,ie=K,F=$.apply(ye,J),F}function oe(K){return ie=K,V=setTimeout(he,L),G?le(K):F}function E(K){var J=K-re,ye=K-ie,He=L-J;return Y?S(He,I-ye):He}function de(K){var J=K-re,ye=K-ie;return re===void 0||J>=L||J<0||Y&&ye>=I}function he(){var K=k();if(de(K))return D(K);V=setTimeout(he,E(K))}function D(K){return V=void 0,ne&&B?le(K):(B=W=void 0,F)}function pe(){V!==void 0&&clearTimeout(V),ie=0,B=re=W=V=void 0}function Ne(){return V===void 0?F:D(k())}function te(){var K=k(),J=de(K);if(B=arguments,W=this,re=K,J){if(V===void 0)return oe(re);if(Y)return V=setTimeout(he,L),le(re)}return V===void 0&&(V=setTimeout(he,L)),F}return te.cancel=pe,te.flush=Ne,te}function P($){var L=typeof $;return!!$&&(L=="object"||L=="function")}function M($){return!!$&&typeof $=="object"}function R($){return typeof $=="symbol"||M($)&&b.call($)==t}function z($){if(typeof $=="number")return $;if(R($))return n;if(P($)){var L=typeof $.valueOf=="function"?$.valueOf():$;$=P(L)?L+"":L}if(typeof $!="string")return $===0?$:+$;$=$.replace(r,"");var U=o.test($);return U||l.test($)?d($.slice(2),U?2:8):a.test($)?n:+$}return b0=T,b0}var x9=y9();const fg=Hd(x9);var v0={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var $C;function b9(){return $C||($C=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var d=arguments[l];d&&(o=a(o,r(d)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var d in o)n.call(o,d)&&o[d]&&(l=a(l,d));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(v0)),v0.exports}var v9=b9();const su=Hd(v9);function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Bd(e)}function w9(e,n){if(Bd(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(Bd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Y2(e){var n=w9(e,"string");return Bd(n)=="symbol"?n:n+""}function $m(e,n,t){return(n=Y2(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function zC(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Ft(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?zC(Object(t),!0).forEach(function(r){$m(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):zC(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function S9(e){if(Array.isArray(e))return e}function N9(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,o,l,d=[],f=!0,u=!1;try{if(o=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;f=!1}else for(;!(f=(r=o.call(t)).done)&&(d.push(r.value),d.length!==n);f=!0);}catch(h){u=!0,a=h}finally{try{if(!f&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return d}}function P1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function W2(e,n){if(e){if(typeof e=="string")return P1(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?P1(e,n):void 0}}function C9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ql(e,n){return S9(e)||N9(e,n)||W2(e,n)||C9()}function _9(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Jl(e,n){if(e==null)return{};var t,r,a=_9(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var j9=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function k9(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,o=e.defaultValue,l=o===void 0?null:o,d=e.inputValue,f=e.menuIsOpen,u=e.onChange,h=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=Jl(e,j9),k=w.useState(d!==void 0?d:t),T=ql(k,2),P=T[0],M=T[1],R=w.useState(f!==void 0?f:a),z=ql(R,2),$=z[0],L=z[1],U=w.useState(v!==void 0?v:l),B=ql(U,2),W=B[0],I=B[1],F=w.useCallback(function(le,oe){typeof u=="function"&&u(le,oe),I(le)},[u]),V=w.useCallback(function(le,oe){var E;typeof h=="function"&&(E=h(le,oe)),M(E!==void 0?E:le)},[h]),re=w.useCallback(function(){typeof b=="function"&&b(),L(!0)},[b]),ie=w.useCallback(function(){typeof g=="function"&&g(),L(!1)},[g]),G=d!==void 0?d:P,Y=f!==void 0?f:$,ne=v!==void 0?v:W;return Ft(Ft({},S),{},{inputValue:G,menuIsOpen:Y,onChange:F,onInputChange:V,onMenuClose:ie,onMenuOpen:re,value:ne})}function Ut(){return Ut=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Ut.apply(null,arguments)}function T9(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function UC(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y2(r.key),r)}}function E9(e,n,t){return n&&UC(e.prototype,n),t&&UC(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function D1(e,n){return D1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},D1(e,n)}function A9(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&D1(e,n)}function ib(e){return ib=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ib(e)}function Q2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q2=function(){return!!e})()}function P9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D9(e,n){if(n&&(Bd(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P9(e)}function I9(e){var n=Q2();return function(){var t,r=ib(e);if(n){var a=ib(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return D9(this,t)}}function R9(e){if(Array.isArray(e))return P1(e)}function M9(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function O9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qw(e){return R9(e)||M9(e)||W2(e)||O9()}function L9(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function F9(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var $9=function(){function e(t){var r=this;this._insertTag=function(a){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,o),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(F9(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var o=L9(a);try{o.insertRule(r,o.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Di="-ms-",ab="-moz-",On="-webkit-",J2="comm",Vw="rule",Hw="decl",z9="@import",K2="@keyframes",U9="@layer",B9=Math.abs,Fb=String.fromCharCode,q9=Object.assign;function V9(e,n){return xi(e,0)^45?(((n<<2^xi(e,0))<<2^xi(e,1))<<2^xi(e,2))<<2^xi(e,3):0}function X2(e){return e.trim()}function H9(e,n){return(e=n.exec(e))?e[0]:e}function Ln(e,n,t){return e.replace(n,t)}function I1(e,n){return e.indexOf(n)}function xi(e,n){return e.charCodeAt(n)|0}function Zm(e,n,t){return e.slice(n,t)}function Qo(e){return e.length}function Gw(e){return e.length}function bx(e,n){return n.push(e),e}function G9(e,n){return e.map(n).join("")}var $b=1,zh=1,Z2=0,ma=0,Br=0,Qh="";function zb(e,n,t,r,a,o,l){return{value:e,root:n,parent:t,type:r,props:a,children:o,line:$b,column:zh,length:l,return:""}}function Am(e,n){return q9(zb("",null,null,"",null,null,0),e,{length:-e.length},n)}function Y9(){return Br}function W9(){return Br=ma>0?xi(Qh,--ma):0,zh--,Br===10&&(zh=1,$b--),Br}function Va(){return Br=ma<Z2?xi(Qh,ma++):0,zh++,Br===10&&(zh=1,$b++),Br}function el(){return xi(Qh,ma)}function Ux(){return ma}function hg(e,n){return Zm(Qh,e,n)}function eg(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function eT(e){return $b=zh=1,Z2=Qo(Qh=e),ma=0,[]}function tT(e){return Qh="",e}function Bx(e){return X2(hg(ma-1,R1(e===91?e+2:e===40?e+1:e)))}function Q9(e){for(;(Br=el())&&Br<33;)Va();return eg(e)>2||eg(Br)>3?"":" "}function J9(e,n){for(;--n&&Va()&&!(Br<48||Br>102||Br>57&&Br<65||Br>70&&Br<97););return hg(e,Ux()+(n<6&&el()==32&&Va()==32))}function R1(e){for(;Va();)switch(Br){case e:return ma;case 34:case 39:e!==34&&e!==39&&R1(Br);break;case 40:e===41&&R1(e);break;case 92:Va();break}return ma}function K9(e,n){for(;Va()&&e+Br!==57;)if(e+Br===84&&el()===47)break;return"/*"+hg(n,ma-1)+"*"+Fb(e===47?e:Va())}function X9(e){for(;!eg(el());)Va();return hg(e,ma)}function Z9(e){return tT(qx("",null,null,null,[""],e=eT(e),0,[0],e))}function qx(e,n,t,r,a,o,l,d,f){for(var u=0,h=0,g=l,b=0,v=0,S=0,k=1,T=1,P=1,M=0,R="",z=a,$=o,L=r,U=R;T;)switch(S=M,M=Va()){case 40:if(S!=108&&xi(U,g-1)==58){I1(U+=Ln(Bx(M),"&","&\f"),"&\f")!=-1&&(P=-1);break}case 34:case 39:case 91:U+=Bx(M);break;case 9:case 10:case 13:case 32:U+=Q9(S);break;case 92:U+=J9(Ux()-1,7);continue;case 47:switch(el()){case 42:case 47:bx(eq(K9(Va(),Ux()),n,t),f);break;default:U+="/"}break;case 123*k:d[u++]=Qo(U)*P;case 125*k:case 59:case 0:switch(M){case 0:case 125:T=0;case 59+h:P==-1&&(U=Ln(U,/\f/g,"")),v>0&&Qo(U)-g&&bx(v>32?qC(U+";",r,t,g-1):qC(Ln(U," ","")+";",r,t,g-2),f);break;case 59:U+=";";default:if(bx(L=BC(U,n,t,u,h,a,d,R,z=[],$=[],g),o),M===123)if(h===0)qx(U,n,L,L,z,o,g,d,$);else switch(b===99&&xi(U,3)===110?100:b){case 100:case 108:case 109:case 115:qx(e,L,L,r&&bx(BC(e,L,L,0,0,a,d,R,a,z=[],g),$),a,$,g,d,r?z:$);break;default:qx(U,L,L,L,[""],$,0,d,$)}}u=h=v=0,k=P=1,R=U="",g=l;break;case 58:g=1+Qo(U),v=S;default:if(k<1){if(M==123)--k;else if(M==125&&k++==0&&W9()==125)continue}switch(U+=Fb(M),M*k){case 38:P=h>0?1:(U+="\f",-1);break;case 44:d[u++]=(Qo(U)-1)*P,P=1;break;case 64:el()===45&&(U+=Bx(Va())),b=el(),h=g=Qo(R=U+=X9(Ux())),M++;break;case 45:S===45&&Qo(U)==2&&(k=0)}}return o}function BC(e,n,t,r,a,o,l,d,f,u,h){for(var g=a-1,b=a===0?o:[""],v=Gw(b),S=0,k=0,T=0;S<r;++S)for(var P=0,M=Zm(e,g+1,g=B9(k=l[S])),R=e;P<v;++P)(R=X2(k>0?b[P]+" "+M:Ln(M,/&\f/g,b[P])))&&(f[T++]=R);return zb(e,n,t,a===0?Vw:d,f,u,h)}function eq(e,n,t){return zb(e,n,t,J2,Fb(Y9()),Zm(e,2,-2),0)}function qC(e,n,t,r){return zb(e,n,t,Hw,Zm(e,0,r),Zm(e,r+1,-1),r)}function Dh(e,n){for(var t="",r=Gw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function tq(e,n,t,r){switch(e.type){case U9:if(e.children.length)break;case z9:case Hw:return e.return=e.return||e.value;case J2:return"";case K2:return e.return=e.value+"{"+Dh(e.children,r)+"}";case Vw:e.value=e.props.join(",")}return Qo(t=Dh(e.children,r))?e.return=e.value+"{"+t+"}":""}function nq(e){var n=Gw(e);return function(t,r,a,o){for(var l="",d=0;d<n;d++)l+=e[d](t,r,a,o)||"";return l}}function rq(e){return function(n){n.root||(n=n.return)&&e(n)}}function iq(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var aq=function(n,t,r){for(var a=0,o=0;a=o,o=el(),a===38&&o===12&&(t[r]=1),!eg(o);)Va();return hg(n,ma)},sq=function(n,t){var r=-1,a=44;do switch(eg(a)){case 0:a===38&&el()===12&&(t[r]=1),n[r]+=aq(ma-1,t,r);break;case 2:n[r]+=Bx(a);break;case 4:if(a===44){n[++r]=el()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Fb(a)}while(a=Va());return n},oq=function(n,t){return tT(sq(eT(n),t))},VC=new WeakMap,lq=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!VC.get(r))&&!a){VC.set(n,!0);for(var o=[],l=oq(t,o),d=r.props,f=0,u=0;f<l.length;f++)for(var h=0;h<d.length;h++,u++)n.props[u]=o[f]?l[f].replace(/&\f/g,d[h]):d[h]+" "+l[f]}}},cq=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function nT(e,n){switch(V9(e,n)){case 5103:return On+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return On+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return On+e+ab+e+Di+e+e;case 6828:case 4268:return On+e+Di+e+e;case 6165:return On+e+Di+"flex-"+e+e;case 5187:return On+e+Ln(e,/(\w+).+(:[^]+)/,On+"box-$1$2"+Di+"flex-$1$2")+e;case 5443:return On+e+Di+"flex-item-"+Ln(e,/flex-|-self/,"")+e;case 4675:return On+e+Di+"flex-line-pack"+Ln(e,/align-content|flex-|-self/,"")+e;case 5548:return On+e+Di+Ln(e,"shrink","negative")+e;case 5292:return On+e+Di+Ln(e,"basis","preferred-size")+e;case 6060:return On+"box-"+Ln(e,"-grow","")+On+e+Di+Ln(e,"grow","positive")+e;case 4554:return On+Ln(e,/([^-])(transform)/g,"$1"+On+"$2")+e;case 6187:return Ln(Ln(Ln(e,/(zoom-|grab)/,On+"$1"),/(image-set)/,On+"$1"),e,"")+e;case 5495:case 3959:return Ln(e,/(image-set\([^]*)/,On+"$1$`$1");case 4968:return Ln(Ln(e,/(.+:)(flex-)?(.*)/,On+"box-pack:$3"+Di+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+On+e+e;case 4095:case 3583:case 4068:case 2532:return Ln(e,/(.+)-inline(.+)/,On+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Qo(e)-1-n>6)switch(xi(e,n+1)){case 109:if(xi(e,n+4)!==45)break;case 102:return Ln(e,/(.+:)(.+)-([^]+)/,"$1"+On+"$2-$3$1"+ab+(xi(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~I1(e,"stretch")?nT(Ln(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(xi(e,n+1)!==115)break;case 6444:switch(xi(e,Qo(e)-3-(~I1(e,"!important")&&10))){case 107:return Ln(e,":",":"+On)+e;case 101:return Ln(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+On+(xi(e,14)===45?"inline-":"")+"box$3$1"+On+"$2$3$1"+Di+"$2box$3")+e}break;case 5936:switch(xi(e,n+11)){case 114:return On+e+Di+Ln(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return On+e+Di+Ln(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return On+e+Di+Ln(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return On+e+Di+e+e}return e}var uq=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case Hw:n.return=nT(n.value,n.length);break;case K2:return Dh([Am(n,{value:Ln(n.value,"@","@"+On)})],a);case Vw:if(n.length)return G9(n.props,function(o){switch(H9(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Dh([Am(n,{props:[Ln(o,/:(read-\w+)/,":"+ab+"$1")]})],a);case"::placeholder":return Dh([Am(n,{props:[Ln(o,/:(plac\w+)/,":"+On+"input-$1")]}),Am(n,{props:[Ln(o,/:(plac\w+)/,":"+ab+"$1")]}),Am(n,{props:[Ln(o,/:(plac\w+)/,Di+"input-$1")]})],a)}return""})}},dq=[uq],fq=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||dq,o={},l,d=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),P=1;P<T.length;P++)o[T[P]]=!0;d.push(k)});var f,u=[lq,cq];{var h,g=[tq,rq(function(k){h.insert(k)})],b=nq(u.concat(a,g)),v=function(T){return Dh(Z9(T),b)};f=function(T,P,M,R){h=M,v(T?T+"{"+P.styles+"}":P.styles),R&&(S.inserted[P.name]=!0)}}var S={key:t,sheet:new $9({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:o,registered:{},insert:f};return S.sheet.hydrate(d),S},w0={exports:{}},Bn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HC;function hq(){if(HC)return Bn;HC=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,P=e?Symbol.for("react.responder"):60118,M=e?Symbol.for("react.scope"):60119;function R($){if(typeof $=="object"&&$!==null){var L=$.$$typeof;switch(L){case n:switch($=$.type,$){case f:case u:case r:case o:case a:case g:return $;default:switch($=$&&$.$$typeof,$){case d:case h:case S:case v:case l:return $;default:return L}}case t:return L}}}function z($){return R($)===u}return Bn.AsyncMode=f,Bn.ConcurrentMode=u,Bn.ContextConsumer=d,Bn.ContextProvider=l,Bn.Element=n,Bn.ForwardRef=h,Bn.Fragment=r,Bn.Lazy=S,Bn.Memo=v,Bn.Portal=t,Bn.Profiler=o,Bn.StrictMode=a,Bn.Suspense=g,Bn.isAsyncMode=function($){return z($)||R($)===f},Bn.isConcurrentMode=z,Bn.isContextConsumer=function($){return R($)===d},Bn.isContextProvider=function($){return R($)===l},Bn.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===n},Bn.isForwardRef=function($){return R($)===h},Bn.isFragment=function($){return R($)===r},Bn.isLazy=function($){return R($)===S},Bn.isMemo=function($){return R($)===v},Bn.isPortal=function($){return R($)===t},Bn.isProfiler=function($){return R($)===o},Bn.isStrictMode=function($){return R($)===a},Bn.isSuspense=function($){return R($)===g},Bn.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===r||$===u||$===o||$===a||$===g||$===b||typeof $=="object"&&$!==null&&($.$$typeof===S||$.$$typeof===v||$.$$typeof===l||$.$$typeof===d||$.$$typeof===h||$.$$typeof===T||$.$$typeof===P||$.$$typeof===M||$.$$typeof===k)},Bn.typeOf=R,Bn}var GC;function pq(){return GC||(GC=1,w0.exports=hq()),w0.exports}var S0,YC;function mq(){if(YC)return S0;YC=1;var e=pq(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[e.ForwardRef]=r,o[e.Memo]=a;function l(S){return e.isMemo(S)?a:o[S.$$typeof]||n}var d=Object.defineProperty,f=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,T){if(typeof k!="string"){if(b){var P=g(k);P&&P!==b&&v(S,P,T)}var M=f(k);u&&(M=M.concat(u(k)));for(var R=l(S),z=l(k),$=0;$<M.length;++$){var L=M[$];if(!t[L]&&!(T&&T[L])&&!(z&&z[L])&&!(R&&R[L])){var U=h(k,L);try{d(S,L,U)}catch{}}}}return S}return S0=v,S0}mq();var gq=!0;function yq(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var rT=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||gq===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},xq=function(n,t,r){rT(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var o=t;do n.insert(t===o?"."+a:"",o,n.sheet,!0),o=o.next;while(o!==void 0)}};function bq(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var vq={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},wq=/[A-Z]|^ms/g,Sq=/_EMO_([^_]+?)_([^]*?)_EMO_/g,iT=function(n){return n.charCodeAt(1)===45},WC=function(n){return n!=null&&typeof n!="boolean"},N0=iq(function(e){return iT(e)?e:e.replace(wq,"-$&").toLowerCase()}),QC=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(Sq,function(r,a,o){return Jo={name:a,styles:o,next:Jo},a})}return vq[n]!==1&&!iT(n)&&typeof t=="number"&&t!==0?t+"px":t};function tg(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return Jo={name:a.name,styles:a.styles,next:Jo},a.name;var o=t;if(o.styles!==void 0){var l=o.next;if(l!==void 0)for(;l!==void 0;)Jo={name:l.name,styles:l.styles,next:Jo},l=l.next;var d=o.styles+";";return d}return Nq(e,n,t)}case"function":{if(e!==void 0){var f=Jo,u=t(e);return Jo=f,tg(e,n,u)}break}}var h=t;return h}function Nq(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=tg(e,n,t[a])+";";else for(var o in t){var l=t[o];if(typeof l!="object"){var d=l;WC(d)&&(r+=N0(o)+":"+QC(o,d)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var f=0;f<l.length;f++)WC(l[f])&&(r+=N0(o)+":"+QC(o,l[f])+";");else{var u=tg(e,n,l);switch(o){case"animation":case"animationName":{r+=N0(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var JC=/label:\s*([^\s;{]+)\s*(;|$)/g,Jo;function aT(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";Jo=void 0;var o=e[0];if(o==null||o.raw===void 0)r=!1,a+=tg(t,n,o);else{var l=o;a+=l[0]}for(var d=1;d<e.length;d++)if(a+=tg(t,n,e[d]),r){var f=o;a+=f[d]}JC.lastIndex=0;for(var u="",h;(h=JC.exec(a))!==null;)u+="-"+h[1];var g=bq(a)+u;return{name:g,styles:a,next:Jo}}var Cq=function(n){return n()},_q=kS.useInsertionEffect?kS.useInsertionEffect:!1,jq=_q||Cq,sT=w.createContext(typeof HTMLElement<"u"?fq({key:"css"}):null);sT.Provider;var kq=function(n){return w.forwardRef(function(t,r){var a=w.useContext(sT);return n(t,a,r)})},Tq=w.createContext({}),Yw={}.hasOwnProperty,M1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Eq=function(n,t){var r={};for(var a in t)Yw.call(t,a)&&(r[a]=t[a]);return r[M1]=n,r},Aq=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return rT(t,r,a),jq(function(){return xq(t,r,a)}),null},Pq=kq(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[M1],o=[r],l="";typeof e.className=="string"?l=yq(n.registered,o,e.className):e.className!=null&&(l=e.className+" ");var d=aT(o,void 0,w.useContext(Tq));l+=n.key+"-"+d.name;var f={};for(var u in e)Yw.call(e,u)&&u!=="css"&&u!==M1&&(f[u]=e[u]);return f.className=l,t&&(f.ref=t),w.createElement(w.Fragment,null,w.createElement(Aq,{cache:n,serialized:d,isStringTag:typeof a=="string"}),w.createElement(a,f))}),Dq=Pq,Dt=function(n,t){var r=arguments;if(t==null||!Yw.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,o=new Array(a);o[0]=Dq,o[1]=Eq(n,t);for(var l=2;l<a;l++)o[l]=r[l];return w.createElement.apply(null,o)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(Dt||(Dt={}));function Ww(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return aT(n)}function Iq(){var e=Ww.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function Rq(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const Mq=Math.min,Oq=Math.max,sb=Math.round,vx=Math.floor,ob=e=>({x:e,y:e});function Lq(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function Ub(){return typeof window<"u"}function oT(e){return cT(e)?(e.nodeName||"").toLowerCase():"#document"}function Wl(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function lT(e){var n;return(n=(cT(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function cT(e){return Ub()?e instanceof Node||e instanceof Wl(e).Node:!1}function Fq(e){return Ub()?e instanceof Element||e instanceof Wl(e).Element:!1}function Qw(e){return Ub()?e instanceof HTMLElement||e instanceof Wl(e).HTMLElement:!1}function KC(e){return!Ub()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Wl(e).ShadowRoot}const $q=new Set(["inline","contents"]);function uT(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Jw(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!$q.has(a)}function zq(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Uq=new Set(["html","body","#document"]);function Bq(e){return Uq.has(oT(e))}function Jw(e){return Wl(e).getComputedStyle(e)}function qq(e){if(oT(e)==="html")return e;const n=e.assignedSlot||e.parentNode||KC(e)&&e.host||lT(e);return KC(n)?n.host:n}function dT(e){const n=qq(e);return Bq(n)?e.ownerDocument?e.ownerDocument.body:e.body:Qw(n)&&uT(n)?n:dT(n)}function lb(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=dT(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Wl(a);if(o){const d=O1(l);return n.concat(l,l.visualViewport||[],uT(a)?a:[],d&&t?lb(d):[])}return n.concat(a,lb(a,[],t))}function O1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Vq(e){const n=Jw(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Qw(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,d=sb(t)!==o||sb(r)!==l;return d&&(t=o,r=l),{width:t,height:r,$:d}}function Kw(e){return Fq(e)?e:e.contextElement}function XC(e){const n=Kw(e);if(!Qw(n))return ob(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=Vq(n);let l=(o?sb(t.width):t.width)/r,d=(o?sb(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!d||!Number.isFinite(d))&&(d=1),{x:l,y:d}}const Hq=ob(0);function Gq(e){const n=Wl(e);return!zq()||!n.visualViewport?Hq:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function Yq(e,n,t){return!1}function ZC(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=Kw(e);let l=ob(1);n&&(l=XC(e));const d=Yq()?Gq(o):ob(0);let f=(a.left+d.x)/l.x,u=(a.top+d.y)/l.y,h=a.width/l.x,g=a.height/l.y;if(o){const b=Wl(o),v=r;let S=b,k=O1(S);for(;k&&r&&v!==S;){const T=XC(k),P=k.getBoundingClientRect(),M=Jw(k),R=P.left+(k.clientLeft+parseFloat(M.paddingLeft))*T.x,z=P.top+(k.clientTop+parseFloat(M.paddingTop))*T.y;f*=T.x,u*=T.y,h*=T.x,g*=T.y,f+=R,u+=z,S=Wl(k),k=O1(S)}}return Lq({width:h,height:g,x:f,y:u})}function fT(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function Wq(e,n){let t=null,r;const a=lT(e);function o(){var d;clearTimeout(r),(d=t)==null||d.disconnect(),t=null}function l(d,f){d===void 0&&(d=!1),f===void 0&&(f=1),o();const u=e.getBoundingClientRect(),{left:h,top:g,width:b,height:v}=u;if(d||n(),!b||!v)return;const S=vx(g),k=vx(a.clientWidth-(h+b)),T=vx(a.clientHeight-(g+v)),P=vx(h),R={rootMargin:-S+"px "+-k+"px "+-T+"px "+-P+"px",threshold:Oq(0,Mq(1,f))||1};let z=!0;function $(L){const U=L[0].intersectionRatio;if(U!==f){if(!z)return l();U?l(!1,U):r=setTimeout(()=>{l(!1,1e-7)},1e3)}U===1&&!fT(u,e.getBoundingClientRect())&&l(),z=!1}try{t=new IntersectionObserver($,{...R,root:a.ownerDocument})}catch{t=new IntersectionObserver($,R)}t.observe(e)}return l(!0),o}function Qq(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,u=Kw(e),h=a||o?[...u?lb(u):[],...lb(n)]:[];h.forEach(P=>{a&&P.addEventListener("scroll",t,{passive:!0}),o&&P.addEventListener("resize",t)});const g=u&&d?Wq(u,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(P=>{let[M]=P;M&&M.target===u&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var R;(R=v)==null||R.observe(n)})),t()}),u&&!f&&v.observe(u),v.observe(n));let S,k=f?ZC(e):null;f&&T();function T(){const P=ZC(e);k&&!fT(k,P)&&t(),k=P,S=requestAnimationFrame(T)}return t(),()=>{var P;h.forEach(M=>{a&&M.removeEventListener("scroll",t),o&&M.removeEventListener("resize",t)}),g==null||g(),(P=v)==null||P.disconnect(),v=null,f&&cancelAnimationFrame(S)}}var L1=w.useLayoutEffect,Jq=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],cb=function(){};function Kq(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function Xq(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var o=[].concat(r);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&o.push("".concat(Kq(e,l)));return o.filter(function(d){return d}).map(function(d){return String(d).trim()}).join(" ")}var e_=function(n){return o7(n)?n.filter(Boolean):Bd(n)==="object"&&n!==null?[n]:[]},hT=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=Jl(n,Jq);return Ft({},t)},_r=function(n,t,r){var a=n.cx,o=n.getStyles,l=n.getClassNames,d=n.className;return{css:o(t,n),className:a(r??{},l(t,n),d)}};function Bb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function Zq(e){return Bb(e)?window.innerHeight:e.clientHeight}function pT(e){return Bb(e)?window.pageYOffset:e.scrollTop}function ub(e,n){if(Bb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function e7(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function t7(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function wx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:cb,a=pT(e),o=n-a,l=10,d=0;function f(){d+=l;var u=t7(d,a,o,t);ub(e,u),d<t?window.requestAnimationFrame(f):r(e)}f()}function t_(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?ub(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&ub(e,Math.max(n.offsetTop-a,0))}function n7(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function n_(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function r7(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var mT=!1,i7={get passive(){return mT=!0}},Sx=typeof window<"u"?window:{};Sx.addEventListener&&Sx.removeEventListener&&(Sx.addEventListener("p",cb,i7),Sx.removeEventListener("p",cb,!1));var a7=mT;function s7(e){return e!=null}function o7(e){return Array.isArray(e)}function Nx(e,n,t){return e?n:t}var l7=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var o=Object.entries(n).filter(function(l){var d=ql(l,1),f=d[0];return!r.includes(f)});return o.reduce(function(l,d){var f=ql(d,2),u=f[0],h=f[1];return l[u]=h,l},{})},c7=["children","innerProps"],u7=["children","innerProps"];function d7(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,o=e.shouldScroll,l=e.isFixedPosition,d=e.controlHeight,f=e7(t),u={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return u;var h=f.getBoundingClientRect(),g=h.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),P=T.top,M=l?window.innerHeight:Zq(f),R=pT(f),z=parseInt(getComputedStyle(t).marginBottom,10),$=parseInt(getComputedStyle(t).marginTop,10),L=P-$,U=M-k,B=L+R,W=g-R-k,I=v-M+R+z,F=R+k-$,V=160;switch(a){case"auto":case"bottom":if(U>=S)return{placement:"bottom",maxHeight:n};if(W>=S&&!l)return o&&wx(f,I,V),{placement:"bottom",maxHeight:n};if(!l&&W>=r||l&&U>=r){o&&wx(f,I,V);var re=l?U-z:W-z;return{placement:"bottom",maxHeight:re}}if(a==="auto"||l){var ie=n,G=l?L:B;return G>=r&&(ie=Math.min(G-z-d,n)),{placement:"top",maxHeight:ie}}if(a==="bottom")return o&&ub(f,I),{placement:"bottom",maxHeight:n};break;case"top":if(L>=S)return{placement:"top",maxHeight:n};if(B>=S&&!l)return o&&wx(f,F,V),{placement:"top",maxHeight:n};if(!l&&B>=r||l&&L>=r){var Y=n;return(!l&&B>=r||l&&L>=r)&&(Y=l?L-$:B-$),o&&wx(f,F,V),{placement:"top",maxHeight:Y}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return u}function f7(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var gT=function(n){return n==="auto"?"bottom":n},h7=function(n,t){var r,a=n.placement,o=n.theme,l=o.borderRadius,d=o.spacing,f=o.colors;return Ft((r={label:"menu"},$m(r,f7(a),"100%"),$m(r,"position","absolute"),$m(r,"width","100%"),$m(r,"zIndex",1),r),t?{}:{backgroundColor:f.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:d.menuGutter,marginTop:d.menuGutter})},yT=w.createContext(null),p7=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,o=n.menuPlacement,l=n.menuPosition,d=n.menuShouldScrollIntoView,f=n.theme,u=w.useContext(yT)||{},h=u.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=ql(b,2),S=v[0],k=v[1],T=w.useState(null),P=ql(T,2),M=P[0],R=P[1],z=f.spacing.controlHeight;return L1(function(){var $=g.current;if($){var L=l==="fixed",U=d&&!L,B=d7({maxHeight:a,menuEl:$,minHeight:r,placement:o,shouldScroll:U,isFixedPosition:L,controlHeight:z});k(B.maxHeight),R(B.placement),h==null||h(B.placement)}},[a,o,l,d,r,h,z]),t({ref:g,placerProps:Ft(Ft({},n),{},{placement:M||gT(o),maxHeight:S})})},m7=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return Dt("div",Ut({},_r(n,"menu",{menu:!0}),{ref:r},a),t)},g7=m7,y7=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return Ft({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},x7=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,o=n.isMulti;return Dt("div",Ut({},_r(n,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:a},r),t)},xT=function(n,t){var r=n.theme,a=r.spacing.baseUnit,o=r.colors;return Ft({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},b7=xT,v7=xT,w7=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,o=Jl(n,c7);return Dt("div",Ut({},_r(Ft(Ft({},o),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},S7=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,o=Jl(n,u7);return Dt("div",Ut({},_r(Ft(Ft({},o),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},N7=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},C7=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,o=n.innerProps,l=n.menuPlacement,d=n.menuPosition,f=w.useRef(null),u=w.useRef(null),h=w.useState(gT(l)),g=ql(h,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=ql(k,2),P=T[0],M=T[1],R=w.useCallback(function(){if(a){var U=n7(a),B=d==="fixed"?0:window.pageYOffset,W=U[b]+B;(W!==(P==null?void 0:P.offset)||U.left!==(P==null?void 0:P.rect.left)||U.width!==(P==null?void 0:P.rect.width))&&M({offset:W,rect:U})}},[a,d,b,P==null?void 0:P.offset,P==null?void 0:P.rect.left,P==null?void 0:P.rect.width]);L1(function(){R()},[R]);var z=w.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),a&&f.current&&(u.current=Qq(a,f.current,R,{elementResize:"ResizeObserver"in window}))},[a,R]);L1(function(){z()},[z]);var $=w.useCallback(function(U){f.current=U,z()},[z]);if(!t&&d!=="fixed"||!P)return null;var L=Dt("div",Ut({ref:$},_r(Ft(Ft({},n),{},{offset:P.offset,position:d,rect:P.rect}),"menuPortal",{"menu-portal":!0}),o),r);return Dt(yT.Provider,{value:S},t?tI.createPortal(L,t):L)},_7=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},j7=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,o=n.isRtl;return Dt("div",Ut({},_r(n,"container",{"--is-disabled":a,"--is-rtl":o}),r),t)},k7=function(n,t){var r=n.theme.spacing,a=n.isMulti,o=n.hasValue,l=n.selectProps.controlShouldRenderValue;return Ft({alignItems:"center",display:a&&o&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},T7=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,o=n.hasValue;return Dt("div",Ut({},_r(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":o}),r),t)},E7=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},A7=function(n){var t=n.children,r=n.innerProps;return Dt("div",Ut({},_r(n,"indicatorsContainer",{indicators:!0}),r),t)},r_,P7=["size"],D7=["innerProps","isRtl","size"],I7={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},bT=function(n){var t=n.size,r=Jl(n,P7);return Dt("svg",Ut({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:I7},r))},Xw=function(n){return Dt(bT,Ut({size:20},n),Dt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},vT=function(n){return Dt(bT,Ut({size:20},n),Dt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},wT=function(n,t){var r=n.isFocused,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Ft({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?l.neutral60:l.neutral20,padding:o*2,":hover":{color:r?l.neutral80:l.neutral40}})},R7=wT,M7=function(n){var t=n.children,r=n.innerProps;return Dt("div",Ut({},_r(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||Dt(vT,null))},O7=wT,L7=function(n){var t=n.children,r=n.innerProps;return Dt("div",Ut({},_r(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||Dt(Xw,null))},F7=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Ft({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?l.neutral10:l.neutral20,marginBottom:o*2,marginTop:o*2})},$7=function(n){var t=n.innerProps;return Dt("span",Ut({},t,_r(n,"indicatorSeparator",{"indicator-separator":!0})))},z7=Iq(r_||(r_=Rq([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),U7=function(n,t){var r=n.isFocused,a=n.size,o=n.theme,l=o.colors,d=o.spacing.baseUnit;return Ft({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?l.neutral60:l.neutral20,padding:d*2})},C0=function(n){var t=n.delay,r=n.offset;return Dt("span",{css:Ww({animation:"".concat(z7," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},B7=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,o=a===void 0?4:a,l=Jl(n,D7);return Dt("div",Ut({},_r(Ft(Ft({},l),{},{innerProps:t,isRtl:r,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Dt(C0,{delay:0,offset:r}),Dt(C0,{delay:160,offset:!0}),Dt(C0,{delay:320,offset:!r}))},q7=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.theme,l=o.colors,d=o.borderRadius,f=o.spacing;return Ft({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:f.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?l.neutral5:l.neutral0,borderColor:r?l.neutral10:a?l.primary:l.neutral20,borderRadius:d,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},V7=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.innerRef,l=n.innerProps,d=n.menuIsOpen;return Dt("div",Ut({ref:o},_r(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":d}),l,{"aria-disabled":r||void 0}),t)},H7=V7,G7=["data"],Y7=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},W7=function(n){var t=n.children,r=n.cx,a=n.getStyles,o=n.getClassNames,l=n.Heading,d=n.headingProps,f=n.innerProps,u=n.label,h=n.theme,g=n.selectProps;return Dt("div",Ut({},_r(n,"group",{group:!0}),f),Dt(l,Ut({},d,{selectProps:g,theme:h,getStyles:a,getClassNames:o,cx:r}),u),Dt("div",null,t))},Q7=function(n,t){var r=n.theme,a=r.colors,o=r.spacing;return Ft({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},J7=function(n){var t=hT(n);t.data;var r=Jl(t,G7);return Dt("div",Ut({},_r(n,"groupHeading",{"group-heading":!0}),r))},K7=W7,X7=["innerRef","isDisabled","isHidden","inputClassName"],Z7=function(n,t){var r=n.isDisabled,a=n.value,o=n.theme,l=o.spacing,d=o.colors;return Ft(Ft({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},eV),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:d.neutral80})},ST={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},eV={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Ft({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},ST)},tV=function(n){return Ft({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},ST)},nV=function(n){var t=n.cx,r=n.value,a=hT(n),o=a.innerRef,l=a.isDisabled,d=a.isHidden,f=a.inputClassName,u=Jl(a,X7);return Dt("div",Ut({},_r(n,"input",{"input-container":!0}),{"data-value":r||""}),Dt("input",Ut({className:t({input:!0},f),ref:o,style:tV(d),disabled:l},u)))},rV=nV,iV=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors;return Ft({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:o/2,margin:a.baseUnit/2})},aV=function(n,t){var r=n.theme,a=r.borderRadius,o=r.colors,l=n.cropWithEllipsis;return Ft({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},sV=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors,d=n.isFocused;return Ft({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:d?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},NT=function(n){var t=n.children,r=n.innerProps;return Dt("div",r,t)},oV=NT,lV=NT;function cV(e){var n=e.children,t=e.innerProps;return Dt("div",Ut({role:"button"},t),n||Dt(Xw,{size:14}))}var uV=function(n){var t=n.children,r=n.components,a=n.data,o=n.innerProps,l=n.isDisabled,d=n.removeProps,f=n.selectProps,u=r.Container,h=r.Label,g=r.Remove;return Dt(u,{data:a,innerProps:Ft(Ft({},_r(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),o),selectProps:f},Dt(h,{data:a,innerProps:Ft({},_r(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:f},t),Dt(g,{data:a,innerProps:Ft(Ft({},_r(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},d),selectProps:f}))},dV=uV,fV=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.theme,d=l.spacing,f=l.colors;return Ft({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?f.primary:a?f.primary25:"transparent",color:r?f.neutral20:o?f.neutral0:"inherit",padding:"".concat(d.baseUnit*2,"px ").concat(d.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:o?f.primary:f.primary50}})},hV=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.innerRef,d=n.innerProps;return Dt("div",Ut({},_r(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":o}),{ref:l,"aria-disabled":r},d),t)},pV=hV,mV=function(n,t){var r=n.theme,a=r.spacing,o=r.colors;return Ft({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},gV=function(n){var t=n.children,r=n.innerProps;return Dt("div",Ut({},_r(n,"placeholder",{placeholder:!0}),r),t)},yV=gV,xV=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing,l=a.colors;return Ft({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?l.neutral40:l.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},bV=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return Dt("div",Ut({},_r(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},vV=bV,wV={ClearIndicator:L7,Control:H7,DropdownIndicator:M7,DownChevron:vT,CrossIcon:Xw,Group:K7,GroupHeading:J7,IndicatorsContainer:A7,IndicatorSeparator:$7,Input:rV,LoadingIndicator:B7,Menu:g7,MenuList:x7,MenuPortal:C7,LoadingMessage:S7,NoOptionsMessage:w7,MultiValue:dV,MultiValueContainer:oV,MultiValueLabel:lV,MultiValueRemove:cV,Option:pV,Placeholder:yV,SelectContainer:j7,SingleValue:vV,ValueContainer:T7},SV=function(n){return Ft(Ft({},wV),n.components)},i_=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function NV(e,n){return!!(e===n||i_(e)&&i_(n))}function CV(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!NV(e[t],n[t]))return!1;return!0}function _V(e,n){n===void 0&&(n=CV);var t=null;function r(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return r.clear=function(){t=null},r}var jV={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},kV=function(n){return Dt("span",Ut({css:jV},n))},a_=kV,TV={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,o=n.context,l=n.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,o=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,o=n.label,l=o===void 0?"":o,d=n.selectValue,f=n.isDisabled,u=n.isSelected,h=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&d)return"value ".concat(l," focused, ").concat(g(d,r),".");if(t==="menu"&&h){var b=f?" disabled":"",v="".concat(u?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},EV=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,o=n.focusableOptions,l=n.isFocused,d=n.selectValue,f=n.selectProps,u=n.id,h=n.isAppleDevice,g=f.ariaLiveMessages,b=f.getOptionLabel,v=f.inputValue,S=f.isMulti,k=f.isOptionDisabled,T=f.isSearchable,P=f.menuIsOpen,M=f.options,R=f.screenReaderStatus,z=f.tabSelectsValue,$=f.isLoading,L=f["aria-label"],U=f["aria-live"],B=w.useMemo(function(){return Ft(Ft({},TV),g||{})},[g]),W=w.useMemo(function(){var G="";if(t&&B.onChange){var Y=t.option,ne=t.options,le=t.removedValue,oe=t.removedValues,E=t.value,de=function(J){return Array.isArray(J)?null:J},he=le||Y||de(E),D=he?b(he):"",pe=ne||oe||void 0,Ne=pe?pe.map(b):[],te=Ft({isDisabled:he&&k(he,d),label:D,labels:Ne},t);G=B.onChange(te)}return G},[t,B,k,d,b]),I=w.useMemo(function(){var G="",Y=r||a,ne=!!(r&&d&&d.includes(r));if(Y&&B.onFocus){var le={focused:Y,label:b(Y),isDisabled:k(Y,d),isSelected:ne,options:o,context:Y===r?"menu":"value",selectValue:d,isAppleDevice:h};G=B.onFocus(le)}return G},[r,a,b,k,B,o,d,h]),F=w.useMemo(function(){var G="";if(P&&M.length&&!$&&B.onFilter){var Y=R({count:o.length});G=B.onFilter({inputValue:v,resultsMessage:Y})}return G},[o,v,P,B,M,R,$]),V=(t==null?void 0:t.action)==="initial-input-focus",re=w.useMemo(function(){var G="";if(B.guidance){var Y=a?"value":P?"menu":"input";G=B.guidance({"aria-label":L,context:Y,isDisabled:r&&k(r,d),isMulti:S,isSearchable:T,tabSelectsValue:z,isInitialFocus:V})}return G},[L,r,a,S,k,T,P,B,d,z,V]),ie=Dt(w.Fragment,null,Dt("span",{id:"aria-selection"},W),Dt("span",{id:"aria-focused"},I),Dt("span",{id:"aria-results"},F),Dt("span",{id:"aria-guidance"},re));return Dt(w.Fragment,null,Dt(a_,{id:u},V&&ie),Dt(a_,{"aria-live":U,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!V&&ie))},AV=EV,F1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],PV=new RegExp("["+F1.map(function(e){return e.letters}).join("")+"]","g"),CT={};for(var _0=0;_0<F1.length;_0++)for(var j0=F1[_0],k0=0;k0<j0.letters.length;k0++)CT[j0.letters[k0]]=j0.base;var _T=function(n){return n.replace(PV,function(t){return CT[t]})},DV=_V(_T),s_=function(n){return n.replace(/^\s+|\s+$/g,"")},IV=function(n){return"".concat(n.label," ").concat(n.value)},RV=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=Ft({ignoreCase:!0,ignoreAccents:!0,stringify:IV,trim:!0,matchFrom:"any"},n),o=a.ignoreCase,l=a.ignoreAccents,d=a.stringify,f=a.trim,u=a.matchFrom,h=f?s_(r):r,g=f?s_(d(t)):d(t);return o&&(h=h.toLowerCase(),g=g.toLowerCase()),l&&(h=DV(h),g=_T(g)),u==="start"?g.substr(0,h.length)===h:g.indexOf(h)>-1}},MV=["innerRef"];function OV(e){var n=e.innerRef,t=Jl(e,MV),r=l7(t,"onExited","in","enter","exit","appear");return Dt("input",Ut({ref:n},r,{css:Ww({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var LV=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function FV(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,o=e.onTopLeave,l=w.useRef(!1),d=w.useRef(!1),f=w.useRef(0),u=w.useRef(null),h=w.useCallback(function(T,P){if(u.current!==null){var M=u.current,R=M.scrollTop,z=M.scrollHeight,$=M.clientHeight,L=u.current,U=P>0,B=z-$-R,W=!1;B>P&&l.current&&(r&&r(T),l.current=!1),U&&d.current&&(o&&o(T),d.current=!1),U&&P>B?(t&&!l.current&&t(T),L.scrollTop=z,W=!0,l.current=!0):!U&&-P>R&&(a&&!d.current&&a(T),L.scrollTop=0,W=!0,d.current=!0),W&&LV(T)}},[t,r,a,o]),g=w.useCallback(function(T){h(T,T.deltaY)},[h]),b=w.useCallback(function(T){f.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var P=f.current-T.changedTouches[0].clientY;h(T,P)},[h]),S=w.useCallback(function(T){if(T){var P=a7?{passive:!1}:!1;T.addEventListener("wheel",g,P),T.addEventListener("touchstart",b,P),T.addEventListener("touchmove",v,P)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=u.current;return S(T),function(){k(T)}}},[n,S,k]),function(T){u.current=T}}var o_=["boxSizing","height","overflow","paddingRight","position"],l_={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function c_(e){e.cancelable&&e.preventDefault()}function u_(e){e.stopPropagation()}function d_(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function f_(){return"ontouchstart"in window||navigator.maxTouchPoints}var h_=!!(typeof window<"u"&&window.document&&window.document.createElement),Pm=0,vh={capture:!1,passive:!1};function $V(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),o=w.useRef(null),l=w.useCallback(function(f){if(h_){var u=document.body,h=u&&u.style;if(r&&o_.forEach(function(S){var k=h&&h[S];a.current[S]=k}),r&&Pm<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(l_).forEach(function(S){var k=l_[S];h&&(h[S]=k)}),h&&(h.paddingRight="".concat(v,"px"))}u&&f_()&&(u.addEventListener("touchmove",c_,vh),f&&(f.addEventListener("touchstart",d_,vh),f.addEventListener("touchmove",u_,vh))),Pm+=1}},[r]),d=w.useCallback(function(f){if(h_){var u=document.body,h=u&&u.style;Pm=Math.max(Pm-1,0),r&&Pm<1&&o_.forEach(function(g){var b=a.current[g];h&&(h[g]=b)}),u&&f_()&&(u.removeEventListener("touchmove",c_,vh),f&&(f.removeEventListener("touchstart",d_,vh),f.removeEventListener("touchmove",u_,vh)))}},[r]);return w.useEffect(function(){if(n){var f=o.current;return l(f),function(){d(f)}}},[n,l,d]),function(f){o.current=f}}var zV=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},UV={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function BV(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,o=e.onBottomArrive,l=e.onBottomLeave,d=e.onTopArrive,f=e.onTopLeave,u=FV({isEnabled:a,onBottomArrive:o,onBottomLeave:l,onTopArrive:d,onTopLeave:f}),h=$V({isEnabled:t}),g=function(v){u(v),h(v)};return Dt(w.Fragment,null,t&&Dt("div",{onClick:zV,css:UV}),n(g))}var qV={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},VV=function(n){var t=n.name,r=n.onFocus;return Dt("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:qV,value:"",onChange:function(){}})},HV=VV;function Zw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function GV(){return Zw(/^iPhone/i)}function jT(){return Zw(/^Mac/i)}function YV(){return Zw(/^iPad/i)||jT()&&navigator.maxTouchPoints>1}function WV(){return GV()||YV()}function QV(){return jT()||WV()}var JV=function(n){return n.label},KV=function(n){return n.label},XV=function(n){return n.value},ZV=function(n){return!!n.isDisabled},eH={clearIndicator:O7,container:_7,control:q7,dropdownIndicator:R7,group:Y7,groupHeading:Q7,indicatorsContainer:E7,indicatorSeparator:F7,input:Z7,loadingIndicator:U7,loadingMessage:v7,menu:h7,menuList:y7,menuPortal:N7,multiValue:iV,multiValueLabel:aV,multiValueRemove:sV,noOptionsMessage:b7,option:fV,placeholder:mV,singleValue:xV,valueContainer:k7},tH={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},nH=4,kT=4,rH=38,iH=kT*2,aH={baseUnit:kT,controlHeight:rH,menuGutter:iH},T0={borderRadius:nH,colors:tH,spacing:aH},sH={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:n_(),captureMenuScroll:!n_(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:RV(),formatGroupLabel:JV,getOptionLabel:KV,getOptionValue:XV,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:ZV,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!r7(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function p_(e,n,t,r){var a=AT(e,n,t),o=PT(e,n,t),l=ET(e,n),d=db(e,n);return{type:"option",data:n,isDisabled:a,isSelected:o,label:l,value:d,index:r}}function Vx(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(l,d){return p_(e,l,n,d)}).filter(function(l){return g_(e,l)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var o=p_(e,t,n,r);return g_(e,o)?o:void 0}).filter(s7)}function TT(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,qw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function m_(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,qw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function oH(e,n){return TT(Vx(e,n))}function g_(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,o=n.isSelected,l=n.label,d=n.value;return(!IT(e)||!o)&&DT(e,{label:l,value:d,data:a},r)}function lH(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var o=n.indexOf(t);if(o>-1)return t;if(a<n.length)return n[a]}return null}function cH(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var E0=function(n,t){var r,a=(r=n.find(function(o){return o.data===t}))===null||r===void 0?void 0:r.id;return a||null},ET=function(n,t){return n.getOptionLabel(t)},db=function(n,t){return n.getOptionValue(t)};function AT(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function PT(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=db(e,n);return t.some(function(a){return db(e,a)===r})}function DT(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var IT=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},uH=1,RT=function(e){A9(t,e);var n=I9(t);function t(r){var a;if(T9(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(f){a.controlRef=f},a.focusedOptionRef=null,a.getFocusedOptionRef=function(f){a.focusedOptionRef=f},a.menuListRef=null,a.getMenuListRef=function(f){a.menuListRef=f},a.inputRef=null,a.getInputRef=function(f){a.inputRef=f},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(f,u){var h=a.props,g=h.onChange,b=h.name;u.name=b,a.ariaOnChange(f,u),g(f,u)},a.setValue=function(f,u,h){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(f,{action:u,option:h})},a.selectOption=function(f){var u=a.props,h=u.blurInputOnSelect,g=u.isMulti,b=u.name,v=a.state.selectValue,S=g&&a.isOptionSelected(f,v),k=a.isOptionDisabled(f,v);if(S){var T=a.getOptionValue(f);a.setValue(v.filter(function(P){return a.getOptionValue(P)!==T}),"deselect-option",f)}else if(!k)g?a.setValue([].concat(qw(v),[f]),"select-option",f):a.setValue(f,"select-option");else{a.ariaOnChange(f,{action:"select-option",option:f,name:b});return}h&&a.blurInput()},a.removeValue=function(f){var u=a.props.isMulti,h=a.state.selectValue,g=a.getOptionValue(f),b=h.filter(function(S){return a.getOptionValue(S)!==g}),v=Nx(u,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:f}),a.focusInput()},a.clearValue=function(){var f=a.state.selectValue;a.onChange(Nx(a.props.isMulti,[],null),{action:"clear",removedValues:f})},a.popValue=function(){var f=a.props.isMulti,u=a.state.selectValue,h=u[u.length-1],g=u.slice(0,u.length-1),b=Nx(f,g,g[0]||null);h&&a.onChange(b,{action:"pop-value",removedValue:h})},a.getFocusedOptionId=function(f){return E0(a.state.focusableOptionsWithIds,f)},a.getFocusableOptionsWithIds=function(){return m_(Vx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var f=arguments.length,u=new Array(f),h=0;h<f;h++)u[h]=arguments[h];return Xq.apply(void 0,[a.props.classNamePrefix].concat(u))},a.getOptionLabel=function(f){return ET(a.props,f)},a.getOptionValue=function(f){return db(a.props,f)},a.getStyles=function(f,u){var h=a.props.unstyled,g=eH[f](u,h);g.boxSizing="border-box";var b=a.props.styles[f];return b?b(g,u):g},a.getClassNames=function(f,u){var h,g;return(h=(g=a.props.classNames)[f])===null||h===void 0?void 0:h.call(g,u)},a.getElementId=function(f){return"".concat(a.state.instancePrefix,"-").concat(f)},a.getComponents=function(){return SV(a.props)},a.buildCategorizedOptions=function(){return Vx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return TT(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(f,u){a.setState({ariaSelection:Ft({value:f},u)})},a.onMenuMouseDown=function(f){f.button===0&&(f.stopPropagation(),f.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(f){a.blockOptionHover=!1},a.onControlMouseDown=function(f){if(!f.defaultPrevented){var u=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&a.onMenuClose():u&&a.openMenu("first"):(u&&(a.openAfterFocus=!0),a.focusInput()),f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&f.preventDefault()}},a.onDropdownIndicatorMouseDown=function(f){if(!(f&&f.type==="mousedown"&&f.button!==0)&&!a.props.isDisabled){var u=a.props,h=u.isMulti,g=u.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!h}),a.onMenuClose()):a.openMenu("first"),f.preventDefault()}},a.onClearIndicatorMouseDown=function(f){f&&f.type==="mousedown"&&f.button!==0||(a.clearValue(),f.preventDefault(),a.openAfterFocus=!1,f.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(f){typeof a.props.closeMenuOnScroll=="boolean"?f.target instanceof HTMLElement&&Bb(f.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(f)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(f){var u=f.touches,h=u&&u.item(0);h&&(a.initialTouchX=h.clientX,a.initialTouchY=h.clientY,a.userIsDragging=!1)},a.onTouchMove=function(f){var u=f.touches,h=u&&u.item(0);if(h){var g=Math.abs(h.clientX-a.initialTouchX),b=Math.abs(h.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(f){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(f.target)&&a.menuListRef&&!a.menuListRef.contains(f.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(f){a.userIsDragging||a.onControlMouseDown(f)},a.onClearIndicatorTouchEnd=function(f){a.userIsDragging||a.onClearIndicatorMouseDown(f)},a.onDropdownIndicatorTouchEnd=function(f){a.userIsDragging||a.onDropdownIndicatorMouseDown(f)},a.handleInputChange=function(f){var u=a.props.inputValue,h=f.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(h,{action:"input-change",prevInputValue:u}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(f){a.props.onFocus&&a.props.onFocus(f),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(f){var u=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(f),a.onInputChange("",{action:"input-blur",prevInputValue:u}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(f){if(!(a.blockOptionHover||a.state.focusedOption===f)){var u=a.getFocusableOptions(),h=u.indexOf(f);a.setState({focusedOption:f,focusedOptionId:h>-1?a.getFocusedOptionId(f):null})}},a.shouldHideSelectedOptions=function(){return IT(a.props)},a.onValueInputFocus=function(f){f.preventDefault(),f.stopPropagation(),a.focus()},a.onKeyDown=function(f){var u=a.props,h=u.isMulti,g=u.backspaceRemovesValue,b=u.escapeClearsValue,v=u.inputValue,S=u.isClearable,k=u.isDisabled,T=u.menuIsOpen,P=u.onKeyDown,M=u.tabSelectsValue,R=u.openMenuOnFocus,z=a.state,$=z.focusedOption,L=z.focusedValue,U=z.selectValue;if(!k&&!(typeof P=="function"&&(P(f),f.defaultPrevented))){switch(a.blockOptionHover=!0,f.key){case"ArrowLeft":if(!h||v)return;a.focusValue("previous");break;case"ArrowRight":if(!h||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if(L)a.removeValue(L);else{if(!g)return;h?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||f.shiftKey||!T||!M||!$||R&&a.isOptionSelected($,U))return;a.selectOption($);break;case"Enter":if(f.keyCode===229)break;if(T){if(!$||a.isComposing)return;a.selectOption($);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!$)return;a.selectOption($);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}f.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++uH),a.state.selectValue=e_(r.value),r.menuIsOpen&&a.state.selectValue.length){var o=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),d=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=o,a.state.focusedOption=l[d],a.state.focusedOptionId=E0(o,l[d])}return a}return E9(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&t_(this.menuListRef,this.focusedOptionRef),QV()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var o=this.props,l=o.isDisabled,d=o.menuIsOpen,f=this.state.isFocused;(f&&!l&&a.isDisabled||f&&d&&!a.menuIsOpen)&&this.focusInput(),f&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!f&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(t_(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,o){this.props.onInputChange(a,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var o=this,l=this.state,d=l.selectValue,f=l.isFocused,u=this.buildFocusableOptions(),h=a==="first"?0:u.length-1;if(!this.props.isMulti){var g=u.indexOf(d[0]);g>-1&&(h=g)}this.scrollToFocusedOptionOnUpdate=!(f&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[h],focusedOptionId:this.getFocusedOptionId(u[h])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(a){var o=this.state,l=o.selectValue,d=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var f=l.indexOf(d);d||(f=-1);var u=l.length-1,h=-1;if(l.length){switch(a){case"previous":f===0?h=0:f===-1?h=u:h=f-1;break;case"next":f>-1&&f<u&&(h=f+1);break}this.setState({inputIsHidden:h!==-1,focusedValue:l[h]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,d=this.getFocusableOptions();if(d.length){var f=0,u=d.indexOf(l);l||(u=-1),a==="up"?f=u>0?u-1:d.length-1:a==="down"?f=(u+1)%d.length:a==="pageup"?(f=u-o,f<0&&(f=0)):a==="pagedown"?(f=u+o,f>d.length-1&&(f=d.length-1)):a==="last"&&(f=d.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:d[f],focusedValue:null,focusedOptionId:this.getFocusedOptionId(d[f])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(T0):Ft(Ft({},T0),this.props.theme):T0}},{key:"getCommonProps",value:function(){var a=this.clearValue,o=this.cx,l=this.getStyles,d=this.getClassNames,f=this.getValue,u=this.selectOption,h=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:o,getStyles:l,getClassNames:d,getValue:f,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:u,selectProps:g,setValue:h,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,o=a.isClearable,l=a.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(a,o){return AT(this.props,a,o)}},{key:"isOptionSelected",value:function(a,o){return PT(this.props,a,o)}},{key:"filterOption",value:function(a,o){return DT(this.props,a,o)}},{key:"formatOptionLabel",value:function(a,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,d=this.state.selectValue;return this.props.formatOptionLabel(a,{context:o,inputValue:l,selectValue:d})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,o=a.isDisabled,l=a.isSearchable,d=a.inputId,f=a.inputValue,u=a.tabIndex,h=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,T=k.inputIsHidden,P=k.ariaSelection,M=this.commonProps,R=d||this.getElementId("input"),z=Ft(Ft(Ft({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(P==null?void 0:P.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,Ut({},M,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:R,innerRef:this.getInputRef,isDisabled:o,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:h,type:"text",value:f},z)):w.createElement(OV,Ut({id:R,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:cb,onFocus:this.onInputFocus,disabled:o,tabIndex:u,inputMode:"none",form:h,value:""},z))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,o=this.getComponents(),l=o.MultiValue,d=o.MultiValueContainer,f=o.MultiValueLabel,u=o.MultiValueRemove,h=o.SingleValue,g=o.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,P=v.inputValue,M=v.placeholder,R=this.state,z=R.selectValue,$=R.focusedValue,L=R.isFocused;if(!this.hasValue()||!S)return P?null:w.createElement(g,Ut({},b,{key:"placeholder",isDisabled:k,isFocused:L,innerProps:{id:this.getElementId("placeholder")}}),M);if(T)return z.map(function(B,W){var I=B===$,F="".concat(a.getOptionLabel(B),"-").concat(a.getOptionValue(B));return w.createElement(l,Ut({},b,{components:{Container:d,Label:f,Remove:u},isFocused:I,isDisabled:k,key:F,index:W,removeProps:{onClick:function(){return a.removeValue(B)},onTouchEnd:function(){return a.removeValue(B)},onMouseDown:function(re){re.preventDefault()}},data:B}),a.formatOptionLabel(B,"value"))});if(P)return null;var U=z[0];return w.createElement(h,Ut({},b,{data:U,isDisabled:k}),this.formatOptionLabel(U,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),o=a.ClearIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,h=this.state.isFocused;if(!this.isClearable()||!o||f||!this.hasValue()||u)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:g,isFocused:h}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),o=a.LoadingIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,h=this.state.isFocused;if(!o||!u)return null;var g={"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:g,isDisabled:f,isFocused:h}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator,l=a.IndicatorSeparator;if(!o||!l)return null;var d=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused;return w.createElement(l,Ut({},d,{isDisabled:f,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator;if(!o)return null;var l=this.commonProps,d=this.props.isDisabled,f=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:u,isDisabled:d,isFocused:f}))}},{key:"renderMenu",value:function(){var a=this,o=this.getComponents(),l=o.Group,d=o.GroupHeading,f=o.Menu,u=o.MenuList,h=o.MenuPortal,g=o.LoadingMessage,b=o.NoOptionsMessage,v=o.Option,S=this.commonProps,k=this.state.focusedOption,T=this.props,P=T.captureMenuScroll,M=T.inputValue,R=T.isLoading,z=T.loadingMessage,$=T.minMenuHeight,L=T.maxMenuHeight,U=T.menuIsOpen,B=T.menuPlacement,W=T.menuPosition,I=T.menuPortalTarget,F=T.menuShouldBlockScroll,V=T.menuShouldScrollIntoView,re=T.noOptionsMessage,ie=T.onMenuScrollToTop,G=T.onMenuScrollToBottom;if(!U)return null;var Y=function(D,pe){var Ne=D.type,te=D.data,K=D.isDisabled,J=D.isSelected,ye=D.label,He=D.value,Q=k===te,Pe=K?void 0:function(){return a.onOptionHover(te)},Re=K?void 0:function(){return a.selectOption(te)},Le="".concat(a.getElementId("option"),"-").concat(pe),_e={id:Le,onClick:Re,onMouseMove:Pe,onMouseOver:Pe,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:J};return w.createElement(v,Ut({},S,{innerProps:_e,data:te,isDisabled:K,isSelected:J,key:Le,label:ye,type:Ne,value:He,isFocused:Q,innerRef:Q?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(D.data,"menu"))},ne;if(this.hasOptions())ne=this.getCategorizedOptions().map(function(he){if(he.type==="group"){var D=he.data,pe=he.options,Ne=he.index,te="".concat(a.getElementId("group"),"-").concat(Ne),K="".concat(te,"-heading");return w.createElement(l,Ut({},S,{key:te,data:D,options:pe,Heading:d,headingProps:{id:K,data:he.data},label:a.formatGroupLabel(he.data)}),he.options.map(function(J){return Y(J,"".concat(Ne,"-").concat(J.index))}))}else if(he.type==="option")return Y(he,"".concat(he.index))});else if(R){var le=z({inputValue:M});if(le===null)return null;ne=w.createElement(g,S,le)}else{var oe=re({inputValue:M});if(oe===null)return null;ne=w.createElement(b,S,oe)}var E={minMenuHeight:$,maxMenuHeight:L,menuPlacement:B,menuPosition:W,menuShouldScrollIntoView:V},de=w.createElement(p7,Ut({},S,E),function(he){var D=he.ref,pe=he.placerProps,Ne=pe.placement,te=pe.maxHeight;return w.createElement(f,Ut({},S,E,{innerRef:D,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:R,placement:Ne}),w.createElement(BV,{captureEnabled:P,onTopArrive:ie,onBottomArrive:G,lockEnabled:F},function(K){return w.createElement(u,Ut({},S,{innerRef:function(ye){a.getMenuListRef(ye),K(ye)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:R,maxHeight:te,focusedOption:k}),ne)}))});return I||W==="fixed"?w.createElement(h,Ut({},S,{appendTo:I,controlElement:this.controlRef,menuPlacement:B,menuPosition:W}),de):de}},{key:"renderFormField",value:function(){var a=this,o=this.props,l=o.delimiter,d=o.isDisabled,f=o.isMulti,u=o.name,h=o.required,g=this.state.selectValue;if(h&&!this.hasValue()&&!d)return w.createElement(HV,{name:u,onFocus:this.onValueInputFocus});if(!(!u||d))if(f)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:u,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:u,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:u,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:u,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,o=this.state,l=o.ariaSelection,d=o.focusedOption,f=o.focusedValue,u=o.isFocused,h=o.selectValue,g=this.getFocusableOptions();return w.createElement(AV,Ut({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:d,focusedValue:f,isFocused:u,selectValue:h,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),o=a.Control,l=a.IndicatorsContainer,d=a.SelectContainer,f=a.ValueContainer,u=this.props,h=u.className,g=u.id,b=u.isDisabled,v=u.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(d,Ut({},k,{className:h,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(o,Ut({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(f,Ut({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,Ut({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,o){var l=o.prevProps,d=o.clearFocusValueOnUpdate,f=o.inputIsHiddenAfterUpdate,u=o.ariaSelection,h=o.isFocused,g=o.prevWasFocused,b=o.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,T=a.inputValue,P=a.isMulti,M=e_(S),R={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||T!==l.inputValue)){var z=k?oH(a,M):[],$=k?m_(Vx(a,M),"".concat(b,"-option")):[],L=d?lH(o,M):null,U=cH(o,z),B=E0($,U);R={selectValue:M,focusedOption:U,focusedOptionId:B,focusableOptionsWithIds:$,focusedValue:L,clearFocusValueOnUpdate:!1}}var W=f!=null&&a!==l?{inputIsHidden:f,inputIsHiddenAfterUpdate:void 0}:{},I=u,F=h&&g;return h&&!F&&(I={value:Nx(P,M,M[0]||null),options:M,action:"initial-input-focus"},F=!g),(u==null?void 0:u.action)==="initial-input-focus"&&(I=null),Ft(Ft(Ft({},R),W),{},{prevProps:a,ariaSelection:I,prevWasFocused:F})}}]),t}(w.Component);RT.defaultProps=sH;var dH=w.forwardRef(function(e,n){var t=k9(e);return w.createElement(RT,Ut({ref:n},t))}),MT=dH;const wh=new Map,OT=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&wh.has(n.id)){const a=wh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&wh.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&wh.has(n.id)){const a=wh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&wh.set(n.id,r),r}}})();function fH(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const hH=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,LT=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,Cx=new Map,$1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var A0={exports:{}},y_;function pH(){return y_||(y_=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(f,u,h){this.fn=f,this.context=u,this.once=h||!1}function o(f,u,h,g,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,g||f,b),S=t?t+u:u;return f._events[S]?f._events[S].fn?f._events[S]=[f._events[S],v]:f._events[S].push(v):(f._events[S]=v,f._eventsCount++),f}function l(f,u){--f._eventsCount===0?f._events=new r:delete f._events[u]}function d(){this._events=new r,this._eventsCount=0}d.prototype.eventNames=function(){var u=[],h,g;if(this._eventsCount===0)return u;for(g in h=this._events)n.call(h,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},d.prototype.listeners=function(u){var h=t?t+u:u,g=this._events[h];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},d.prototype.listenerCount=function(u){var h=t?t+u:u,g=this._events[h];return g?g.fn?1:g.length:0},d.prototype.emit=function(u,h,g,b,v,S){var k=t?t+u:u;if(!this._events[k])return!1;var T=this._events[k],P=arguments.length,M,R;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),P){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,h),!0;case 3:return T.fn.call(T.context,h,g),!0;case 4:return T.fn.call(T.context,h,g,b),!0;case 5:return T.fn.call(T.context,h,g,b,v),!0;case 6:return T.fn.call(T.context,h,g,b,v,S),!0}for(R=1,M=new Array(P-1);R<P;R++)M[R-1]=arguments[R];T.fn.apply(T.context,M)}else{var z=T.length,$;for(R=0;R<z;R++)switch(T[R].once&&this.removeListener(u,T[R].fn,void 0,!0),P){case 1:T[R].fn.call(T[R].context);break;case 2:T[R].fn.call(T[R].context,h);break;case 3:T[R].fn.call(T[R].context,h,g);break;case 4:T[R].fn.call(T[R].context,h,g,b);break;default:if(!M)for($=1,M=new Array(P-1);$<P;$++)M[$-1]=arguments[$];T[R].fn.apply(T[R].context,M)}}return!0},d.prototype.on=function(u,h,g){return o(this,u,h,g,!1)},d.prototype.once=function(u,h,g){return o(this,u,h,g,!0)},d.prototype.removeListener=function(u,h,g,b){var v=t?t+u:u;if(!this._events[v])return this;if(!h)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===h&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,T=[],P=S.length;k<P;k++)(S[k].fn!==h||b&&!S[k].once||g&&S[k].context!==g)&&T.push(S[k]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},d.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&l(this,h)):(this._events=new r,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=t,d.EventEmitter=d,e.exports=d}(A0)),A0.exports}var mH=pH();const FT=Hd(mH);function gH(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class $T extends FT{constructor(t=16e3){super();Qn(this,"stream");Qn(this,"audioContext");Qn(this,"source");Qn(this,"recording",!1);Qn(this,"recordingWorklet");Qn(this,"vuWorklet");Qn(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await OT({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=$1(r,hH);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async l=>{const d=l.data.data.int16arrayBuffer;if(d){const f=gH(d);this.emit("data",f)}},this.source.connect(this.recordingWorklet);const o="vu-meter";await this.audioContext.audioWorklet.addModule($1(o,LT)),this.vuWorklet=new AudioWorkletNode(this.audioContext,o),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(o=>o.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const yH=3,xH=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const o=()=>{r.current.forEach((l,d)=>{l&&(l.style.height=`${Math.min(24,4+n*(d===1?400:60))}px`)}),a=window.setTimeout(o,100)};return o(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:su("audioPulse",{active:e,hover:t}),children:Array(yH).fill(null).map((a,o)=>i.jsx("div",{ref:l=>{r.current[o]=l},style:{animationDelay:`${o*133}ms`}},o))})};var zm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var bH=zm.exports,x_;function vH(){return x_||(x_=1,function(e,n){(function(){var t,r="4.17.21",a=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",u=500,h="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,T=1,P=2,M=4,R=8,z=16,$=32,L=64,U=128,B=256,W=512,I=30,F="...",V=800,re=16,ie=1,G=2,Y=3,ne=1/0,le=9007199254740991,oe=17976931348623157e292,E=NaN,de=4294967295,he=de-1,D=de>>>1,pe=[["ary",U],["bind",T],["bindKey",P],["curry",R],["curryRight",z],["flip",W],["partial",$],["partialRight",L],["rearg",B]],Ne="[object Arguments]",te="[object Array]",K="[object AsyncFunction]",J="[object Boolean]",ye="[object Date]",He="[object DOMException]",Q="[object Error]",Pe="[object Function]",Re="[object GeneratorFunction]",Le="[object Map]",_e="[object Number]",Ke="[object Null]",Ye="[object Object]",it="[object Promise]",xt="[object Proxy]",Nt="[object RegExp]",ue="[object Set]",Ae="[object String]",ke="[object Symbol]",Se="[object Undefined]",ve="[object WeakMap]",X="[object WeakSet]",fe="[object ArrayBuffer]",Ge="[object DataView]",Je="[object Float32Array]",ct="[object Float64Array]",wt="[object Int8Array]",Ht="[object Int16Array]",Ce="[object Int32Array]",be="[object Uint8Array]",Fe="[object Uint8ClampedArray]",Ie="[object Uint16Array]",Ve="[object Uint32Array]",st=/\b__p \+= '';/g,mt=/\b(__p \+=) '' \+/g,Ct=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ln=/&(?:amp|lt|gt|quot|#39);/g,dn=/[&<>"']/g,vn=RegExp(ln.source),kt=RegExp(dn.source),bt=/<%-([\s\S]+?)%>/g,Yt=/<%([\s\S]+?)%>/g,It=/<%=([\s\S]+?)%>/g,Jn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Vr=/^\w*$/,fr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,En=/[\\^$.*+?()[\]{}|]/g,wr=RegExp(En.source),Jr=/^\s+/,ws=/\s/,Qd=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Jd=/\{\n\/\* \[wrapped with (.+)\] \*/,Kd=/,? & /,Ss=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,gu=/[()=,{}\[\]\/\s]/,ba=/\\(\\)?/g,Ns=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Cs=/\w*$/,_s=/^[-+]0x[0-9a-f]+$/i,Sr=/^0b[01]+$/i,Xd=/^\[object .+?Constructor\]$/,Zd=/^0o[0-7]+$/i,js=/^(?:0|[1-9]\d*)$/,ao=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Kl=/($^)/,ef=/['\n\r\u2028\u2029\\]/g,il="\\ud800-\\udfff",ep="\\u0300-\\u036f",Xl="\\ufe20-\\ufe2f",so="\\u20d0-\\u20ff",vr=ep+Xl+so,Ya="\\u2700-\\u27bf",Zl="a-z\\xdf-\\xf6\\xf8-\\xff",ks="\\xac\\xb1\\xd7\\xf7",ec="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",al="\\u2000-\\u206f",yu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",tc="A-Z\\xc0-\\xd6\\xd8-\\xde",Kr="\\ufe0e\\ufe0f",oo=ks+ec+al+yu,xu="[']",nc="["+il+"]",rc="["+oo+"]",Wa="["+vr+"]",bu="\\d+",ci="["+Ya+"]",sl="["+Zl+"]",vu="[^"+il+oo+bu+Ya+Zl+tc+"]",ol="\\ud83c[\\udffb-\\udfff]",va="(?:"+Wa+"|"+ol+")",ic="[^"+il+"]",lo="(?:\\ud83c[\\udde6-\\uddff]){2}",wa="[\\ud800-\\udbff][\\udc00-\\udfff]",Qa="["+tc+"]",ac="\\u200d",ll="(?:"+sl+"|"+vu+")",sc="(?:"+Qa+"|"+vu+")",oc="(?:"+xu+"(?:d|ll|m|re|s|t|ve))?",wu="(?:"+xu+"(?:D|LL|M|RE|S|T|VE))?",Ja=va+"?",Ka="["+Kr+"]?",co="(?:"+ac+"(?:"+[ic,lo,wa].join("|")+")"+Ka+Ja+")*",Ts="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Sa="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Su=Ka+Ja+co,cl="(?:"+[ci,lo,wa].join("|")+")"+Su,lc="(?:"+[ic+Wa+"?",Wa,lo,wa,nc].join("|")+")",Es=RegExp(xu,"g"),Fi=RegExp(Wa,"g"),As=RegExp(ol+"(?="+ol+")|"+lc+Su,"g"),Ps=RegExp([Qa+"?"+sl+"+"+oc+"(?="+[rc,Qa,"$"].join("|")+")",sc+"+"+wu+"(?="+[rc,Qa+ll,"$"].join("|")+")",Qa+"?"+ll+"+"+oc,Qa+"+"+wu,Sa,Ts,bu,cl].join("|"),"g"),Xi=RegExp("["+ac+il+vr+Kr+"]"),ul=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,uo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Zi=-1,_n={};_n[Je]=_n[ct]=_n[wt]=_n[Ht]=_n[Ce]=_n[be]=_n[Fe]=_n[Ie]=_n[Ve]=!0,_n[Ne]=_n[te]=_n[fe]=_n[J]=_n[Ge]=_n[ye]=_n[Q]=_n[Pe]=_n[Le]=_n[_e]=_n[Ye]=_n[Nt]=_n[ue]=_n[Ae]=_n[ve]=!1;var jn={};jn[Ne]=jn[te]=jn[fe]=jn[Ge]=jn[J]=jn[ye]=jn[Je]=jn[ct]=jn[wt]=jn[Ht]=jn[Ce]=jn[Le]=jn[_e]=jn[Ye]=jn[Nt]=jn[ue]=jn[Ae]=jn[ke]=jn[be]=jn[Fe]=jn[Ie]=jn[Ve]=!0,jn[Q]=jn[Pe]=jn[ve]=!1;var Xa={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Xr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Na={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},cc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ds=parseFloat,dl=parseInt,uc=typeof au=="object"&&au&&au.Object===Object&&au,fo=typeof self=="object"&&self&&self.Object===Object&&self,tr=uc||fo||Function("return this")(),Za=n&&!n.nodeType&&n,Ca=Za&&!0&&e&&!e.nodeType&&e,Nu=Ca&&Ca.exports===Za,dc=Nu&&uc.process,Zr=function(){try{var De=Ca&&Ca.require&&Ca.require("util").types;return De||dc&&dc.binding&&dc.binding("util")}catch{}}(),fl=Zr&&Zr.isArrayBuffer,hl=Zr&&Zr.isDate,pl=Zr&&Zr.isMap,tf=Zr&&Zr.isRegExp,fc=Zr&&Zr.isSet,hc=Zr&&Zr.isTypedArray;function Hr(De,Qe,qe){switch(qe.length){case 0:return De.call(Qe);case 1:return De.call(Qe,qe[0]);case 2:return De.call(Qe,qe[0],qe[1]);case 3:return De.call(Qe,qe[0],qe[1],qe[2])}return De.apply(Qe,qe)}function Pn(De,Qe,qe,ft){for(var Pt=-1,fn=De==null?0:De.length;++Pt<fn;){var nr=De[Pt];Qe(ft,nr,qe(nr),De)}return ft}function ei(De,Qe){for(var qe=-1,ft=De==null?0:De.length;++qe<ft&&Qe(De[qe],qe,De)!==!1;);return De}function pc(De,Qe){for(var qe=De==null?0:De.length;qe--&&Qe(De[qe],qe,De)!==!1;);return De}function mc(De,Qe){for(var qe=-1,ft=De==null?0:De.length;++qe<ft;)if(!Qe(De[qe],qe,De))return!1;return!0}function ti(De,Qe){for(var qe=-1,ft=De==null?0:De.length,Pt=0,fn=[];++qe<ft;){var nr=De[qe];Qe(nr,qe,De)&&(fn[Pt++]=nr)}return fn}function es(De,Qe){var qe=De==null?0:De.length;return!!qe&&mo(De,Qe,0)>-1}function Cu(De,Qe,qe){for(var ft=-1,Pt=De==null?0:De.length;++ft<Pt;)if(qe(Qe,De[ft]))return!0;return!1}function qn(De,Qe){for(var qe=-1,ft=De==null?0:De.length,Pt=Array(ft);++qe<ft;)Pt[qe]=Qe(De[qe],qe,De);return Pt}function ni(De,Qe){for(var qe=-1,ft=Qe.length,Pt=De.length;++qe<ft;)De[Pt+qe]=Qe[qe];return De}function gc(De,Qe,qe,ft){var Pt=-1,fn=De==null?0:De.length;for(ft&&fn&&(qe=De[++Pt]);++Pt<fn;)qe=Qe(qe,De[Pt],Pt,De);return qe}function _u(De,Qe,qe,ft){var Pt=De==null?0:De.length;for(ft&&Pt&&(qe=De[--Pt]);Pt--;)qe=Qe(qe,De[Pt],Pt,De);return qe}function ho(De,Qe){for(var qe=-1,ft=De==null?0:De.length;++qe<ft;)if(Qe(De[qe],qe,De))return!0;return!1}var po=_a("length");function nf(De){return De.split("")}function tp(De){return De.match(Ss)||[]}function ju(De,Qe,qe){var ft;return qe(De,function(Pt,fn,nr){if(Qe(Pt,fn,nr))return ft=fn,!1}),ft}function ts(De,Qe,qe,ft){for(var Pt=De.length,fn=qe+(ft?1:-1);ft?fn--:++fn<Pt;)if(Qe(De[fn],fn,De))return fn;return-1}function mo(De,Qe,qe){return Qe===Qe?lf(De,Qe,qe):ts(De,go,qe)}function ns(De,Qe,qe,ft){for(var Pt=qe-1,fn=De.length;++Pt<fn;)if(ft(De[Pt],Qe))return Pt;return-1}function go(De){return De!==De}function ku(De,Qe){var qe=De==null?0:De.length;return qe?yo(De,Qe)/qe:E}function _a(De){return function(Qe){return Qe==null?t:Qe[De]}}function ja(De){return function(Qe){return De==null?t:De[Qe]}}function Is(De,Qe,qe,ft,Pt){return Pt(De,function(fn,nr,hn){qe=ft?(ft=!1,fn):Qe(qe,fn,nr,hn)}),qe}function Tu(De,Qe){var qe=De.length;for(De.sort(Qe);qe--;)De[qe]=De[qe].value;return De}function yo(De,Qe){for(var qe,ft=-1,Pt=De.length;++ft<Pt;){var fn=Qe(De[ft]);fn!==t&&(qe=qe===t?fn:qe+fn)}return qe}function ka(De,Qe){for(var qe=-1,ft=Array(De);++qe<De;)ft[qe]=Qe(qe);return ft}function yc(De,Qe){return qn(Qe,function(qe){return[qe,De[qe]]})}function Eu(De){return De&&De.slice(0,wc(De)+1).replace(Jr,"")}function ui(De){return function(Qe){return De(Qe)}}function xc(De,Qe){return qn(Qe,function(qe){return De[qe]})}function xo(De,Qe){return De.has(Qe)}function bo(De,Qe){for(var qe=-1,ft=De.length;++qe<ft&&mo(Qe,De[qe],0)>-1;);return qe}function vo(De,Qe){for(var qe=De.length;qe--&&mo(Qe,De[qe],0)>-1;);return qe}function np(De,Qe){for(var qe=De.length,ft=0;qe--;)De[qe]===Qe&&++ft;return ft}var bc=ja(Xa),rf=ja(Xr);function af(De){return"\\"+cc[De]}function vc(De,Qe){return De==null?t:De[Qe]}function rs(De){return Xi.test(De)}function ml(De){return ul.test(De)}function sf(De){for(var Qe,qe=[];!(Qe=De.next()).done;)qe.push(Qe.value);return qe}function $i(De){var Qe=-1,qe=Array(De.size);return De.forEach(function(ft,Pt){qe[++Qe]=[Pt,ft]}),qe}function Ta(De,Qe){return function(qe){return De(Qe(qe))}}function Mr(De,Qe){for(var qe=-1,ft=De.length,Pt=0,fn=[];++qe<ft;){var nr=De[qe];(nr===Qe||nr===h)&&(De[qe]=h,fn[Pt++]=qe)}return fn}function gl(De){var Qe=-1,qe=Array(De.size);return De.forEach(function(ft){qe[++Qe]=ft}),qe}function of(De){var Qe=-1,qe=Array(De.size);return De.forEach(function(ft){qe[++Qe]=[ft,ft]}),qe}function lf(De,Qe,qe){for(var ft=qe-1,Pt=De.length;++ft<Pt;)if(De[ft]===Qe)return ft;return-1}function ri(De,Qe,qe){for(var ft=qe+1;ft--;)if(De[ft]===Qe)return ft;return ft}function ii(De){return rs(De)?Au(De):po(De)}function di(De){return rs(De)?Pu(De):nf(De)}function wc(De){for(var Qe=De.length;Qe--&&ws.test(De.charAt(Qe)););return Qe}var cf=ja(Na);function Au(De){for(var Qe=As.lastIndex=0;As.test(De);)++Qe;return Qe}function Pu(De){return De.match(As)||[]}function rp(De){return De.match(Ps)||[]}var wo=function De(Qe){Qe=Qe==null?tr:is.defaults(tr.Object(),Qe,is.pick(tr,uo));var qe=Qe.Array,ft=Qe.Date,Pt=Qe.Error,fn=Qe.Function,nr=Qe.Math,hn=Qe.Object,fi=Qe.RegExp,uf=Qe.String,hi=Qe.TypeError,yl=qe.prototype,ip=fn.prototype,So=hn.prototype,xl=Qe["__core-js_shared__"],bl=ip.toString,wn=So.hasOwnProperty,zi=0,Du=function(){var m=/[^.]+$/.exec(xl&&xl.keys&&xl.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Gr=So.toString,vi=bl.call(hn),Rs=tr._,Sc=fi("^"+bl.call(wn).replace(En,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),as=Nu?Qe.Buffer:t,ae=Qe.Symbol,ge=Qe.Uint8Array,ce=as?as.allocUnsafe:t,Te=Ta(hn.getPrototypeOf,hn),et=hn.create,dt=So.propertyIsEnumerable,_t=yl.splice,yt=ae?ae.isConcatSpreadable:t,hr=ae?ae.iterator:t,Kn=ae?ae.toStringTag:t,vl=function(){try{var m=Po(hn,"defineProperty");return m({},"",{}),m}catch{}}(),df=Qe.clearTimeout!==tr.clearTimeout&&Qe.clearTimeout,wl=ft&&ft.now!==tr.Date.now&&ft.now,ap=Qe.setTimeout!==tr.setTimeout&&Qe.setTimeout,Nc=nr.ceil,Ms=nr.floor,No=hn.getOwnPropertySymbols,ff=as?as.isBuffer:t,Iu=Qe.isFinite,ea=yl.join,ta=Ta(hn.keys,hn),Xn=nr.max,rr=nr.min,Os=ft.now,Sl=Qe.parseInt,sp=nr.random,op=yl.reverse,Ru=Po(Qe,"DataView"),jr=Po(Qe,"Map"),ir=Po(Qe,"Promise"),cn=Po(Qe,"Set"),Ea=Po(Qe,"WeakMap"),wi=Po(hn,"create"),Cc=Ea&&new Ea,na={},bg=Hs(Ru),vg=Hs(jr),Mu=Hs(ir),Ou=Hs(cn),wg=Hs(Ea),Co=ae?ae.prototype:t,Nl=Co?Co.valueOf:t,_o=Co?Co.toString:t;function Z(m){if(dr(m)&&!Bt(m)&&!(m instanceof tn)){if(m instanceof Si)return m;if(wn.call(m,"__wrapped__"))return Tr(m)}return new Si(m)}var Ui=function(){function m(){}return function(y){if(!sr(y))return{};if(et)return et(y);m.prototype=y;var j=new m;return m.prototype=t,j}}();function ra(){}function Si(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}Z.templateSettings={escape:bt,evaluate:Yt,interpolate:It,variable:"",imports:{_:Z}},Z.prototype=ra.prototype,Z.prototype.constructor=Z,Si.prototype=Ui(ra.prototype),Si.prototype.constructor=Si;function tn(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=de,this.__views__=[]}function Lu(){var m=new tn(this.__wrapped__);return m.__actions__=kr(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=kr(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=kr(this.__views__),m}function hf(){if(this.__filtered__){var m=new tn(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function Cl(){var m=this.__wrapped__.value(),y=this.__dir__,j=Bt(m),O=y<0,H=j?m.length:0,se=ey(0,H,this.__views__),xe=se.start,je=se.end,Oe=je-xe,tt=O?je:xe-1,rt=this.__iteratees__,at=rt.length,pt=0,vt=rr(Oe,this.__takeCount__);if(!j||!O&&H==Oe&&vt==Oe)return zg(m,this.__actions__);var $t=[];e:for(;Oe--&&pt<vt;){tt+=y;for(var rn=-1,zt=m[tt];++rn<at;){var mn=rt[rn],Nn=mn.iteratee,Oa=mn.type,Wi=Nn(zt);if(Oa==G)zt=Wi;else if(!Wi){if(Oa==ie)continue e;break e}}$t[pt++]=zt}return $t}tn.prototype=Ui(ra.prototype),tn.prototype.constructor=tn;function pr(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function pf(){this.__data__=wi?wi(null):{},this.size=0}function Sg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function ev(m){var y=this.__data__;if(wi){var j=y[m];return j===f?t:j}return wn.call(y,m)?y[m]:t}function tv(m){var y=this.__data__;return wi?y[m]!==t:wn.call(y,m)}function nv(m,y){var j=this.__data__;return this.size+=this.has(m)?0:1,j[m]=wi&&y===t?f:y,this}pr.prototype.clear=pf,pr.prototype.delete=Sg,pr.prototype.get=ev,pr.prototype.has=tv,pr.prototype.set=nv;function Vn(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function lp(){this.__data__=[],this.size=0}function Fu(m){var y=this.__data__,j=kc(y,m);if(j<0)return!1;var O=y.length-1;return j==O?y.pop():_t.call(y,j,1),--this.size,!0}function $u(m){var y=this.__data__,j=kc(y,m);return j<0?t:y[j][1]}function cp(m){return kc(this.__data__,m)>-1}function _c(m,y){var j=this.__data__,O=kc(j,m);return O<0?(++this.size,j.push([m,y])):j[O][1]=y,this}Vn.prototype.clear=lp,Vn.prototype.delete=Fu,Vn.prototype.get=$u,Vn.prototype.has=cp,Vn.prototype.set=_c;function Ni(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function rv(){this.size=0,this.__data__={hash:new pr,map:new(jr||Vn),string:new pr}}function Ng(m){var y=Ic(this,m).delete(m);return this.size-=y?1:0,y}function iv(m){return Ic(this,m).get(m)}function Cg(m){return Ic(this,m).has(m)}function _l(m,y){var j=Ic(this,m),O=j.size;return j.set(m,y),this.size+=j.size==O?0:1,this}Ni.prototype.clear=rv,Ni.prototype.delete=Ng,Ni.prototype.get=iv,Ni.prototype.has=Cg,Ni.prototype.set=_l;function Ls(m){var y=-1,j=m==null?0:m.length;for(this.__data__=new Ni;++y<j;)this.add(m[y])}function mf(m){return this.__data__.set(m,f),this}function _g(m){return this.__data__.has(m)}Ls.prototype.add=Ls.prototype.push=mf,Ls.prototype.has=_g;function pi(m){var y=this.__data__=new Vn(m);this.size=y.size}function jg(){this.__data__=new Vn,this.size=0}function gf(m){var y=this.__data__,j=y.delete(m);return this.size=y.size,j}function up(m){return this.__data__.get(m)}function kg(m){return this.__data__.has(m)}function yf(m,y){var j=this.__data__;if(j instanceof Vn){var O=j.__data__;if(!jr||O.length<a-1)return O.push([m,y]),this.size=++j.size,this;j=this.__data__=new Ni(O)}return j.set(m,y),this.size=j.size,this}pi.prototype.clear=jg,pi.prototype.delete=gf,pi.prototype.get=up,pi.prototype.has=kg,pi.prototype.set=yf;function dp(m,y){var j=Bt(m),O=!j&&Qs(m),H=!j&&!O&&Uo(m),se=!j&&!O&&!H&&Yc(m),xe=j||O||H||se,je=xe?ka(m.length,uf):[],Oe=je.length;for(var tt in m)(y||wn.call(m,tt))&&!(xe&&(tt=="length"||H&&(tt=="offset"||tt=="parent")||se&&(tt=="buffer"||tt=="byteLength"||tt=="byteOffset")||Ia(tt,Oe)))&&je.push(tt);return je}function jc(m){var y=m.length;return y?m[kf(0,y-1)]:t}function Tg(m,y){return fd(kr(m),Pa(y,0,m.length))}function Eg(m){return fd(kr(m))}function ss(m,y,j){(j!==t&&!Ai(m[y],j)||j===t&&!(y in m))&&Aa(m,y,j)}function jl(m,y,j){var O=m[y];(!(wn.call(m,y)&&Ai(O,j))||j===t&&!(y in m))&&Aa(m,y,j)}function kc(m,y){for(var j=m.length;j--;)if(Ai(m[j][0],y))return j;return-1}function jo(m,y,j,O){return $s(m,function(H,se,xe){y(O,H,j(H),xe)}),O}function Fs(m,y){return m&&ji(y,Pr(y),m)}function zu(m,y){return m&&ji(y,Fr(y),m)}function Aa(m,y,j){y=="__proto__"&&vl?vl(m,y,{configurable:!0,enumerable:!0,value:j,writable:!0}):m[y]=j}function Uu(m,y){for(var j=-1,O=y.length,H=qe(O),se=m==null;++j<O;)H[j]=se?t:jd(m,y[j]);return H}function Pa(m,y,j){return m===m&&(j!==t&&(m=m<=j?m:j),y!==t&&(m=m>=y?m:y)),m}function ai(m,y,j,O,H,se){var xe,je=y&g,Oe=y&b,tt=y&v;if(j&&(xe=H?j(m,O,H,se):j(m)),xe!==t)return xe;if(!sr(m))return m;var rt=Bt(m);if(rt){if(xe=Lp(m),!je)return kr(m,xe)}else{var at=Lr(m),pt=at==Pe||at==Re;if(Uo(m))return Ep(m,je);if(at==Ye||at==Ne||pt&&!H){if(xe=Oe||pt?{}:Fp(m),!je)return Oe?ed(m,zu(xe,m)):If(m,Fs(xe,m))}else{if(!jn[at])return H?m:{};xe=$p(m,at,je)}}se||(se=new pi);var vt=se.get(m);if(vt)return vt;se.set(m,xe),Gy(m)?m.forEach(function(zt){xe.add(ai(zt,y,j,zt,m,se))}):ih(m)&&m.forEach(function(zt,mn){xe.set(mn,ai(zt,y,j,mn,m,se))});var $t=tt?Oe?Lf:Of:Oe?Fr:Pr,rn=rt?t:$t(m);return ei(rn||m,function(zt,mn){rn&&(mn=zt,zt=m[mn]),jl(xe,mn,ai(zt,y,j,mn,m,se))}),xe}function Ag(m){var y=Pr(m);return function(j){return fp(j,m,y)}}function fp(m,y,j){var O=j.length;if(m==null)return!O;for(m=hn(m);O--;){var H=j[O],se=y[H],xe=m[H];if(xe===t&&!(H in m)||!se(xe))return!1}return!0}function kl(m,y,j){if(typeof m!="function")throw new hi(l);return Mc(function(){m.apply(t,j)},y)}function ko(m,y,j,O){var H=-1,se=es,xe=!0,je=m.length,Oe=[],tt=y.length;if(!je)return Oe;j&&(y=qn(y,ui(j))),O?(se=Cu,xe=!1):y.length>=a&&(se=xo,xe=!1,y=new Ls(y));e:for(;++H<je;){var rt=m[H],at=j==null?rt:j(rt);if(rt=O||rt!==0?rt:0,xe&&at===at){for(var pt=tt;pt--;)if(y[pt]===at)continue e;Oe.push(rt)}else se(y,at,O)||Oe.push(rt)}return Oe}var $s=Ip(si),xf=Ip(Ec,!0);function hp(m,y){var j=!0;return $s(m,function(O,H,se){return j=!!y(O,H,se),j}),j}function Da(m,y,j){for(var O=-1,H=m.length;++O<H;){var se=m[O],xe=y(se);if(xe!=null&&(je===t?xe===xe&&!yi(xe):j(xe,je)))var je=xe,Oe=se}return Oe}function Kt(m,y,j,O){var H=m.length;for(j=Gt(j),j<0&&(j=-j>H?0:H+j),O=O===t||O>H?H:Gt(O),O<0&&(O+=H),O=j>O?0:ms(O);j<O;)m[j++]=y;return m}function In(m,y){var j=[];return $s(m,function(O,H,se){y(O,H,se)&&j.push(O)}),j}function un(m,y,j,O,H){var se=-1,xe=m.length;for(j||(j=qs),H||(H=[]);++se<xe;){var je=m[se];y>0&&j(je)?y>1?un(je,y-1,j,O,H):ni(H,je):O||(H[H.length]=je)}return H}var Tc=Rl(),Tl=Rl(!0);function si(m,y){return m&&Tc(m,y,Pr)}function Ec(m,y){return m&&Tl(m,y,Pr)}function To(m,y){return ti(y,function(j){return Ra(m[j])})}function ia(m,y){y=Us(y,m);for(var j=0,O=y.length;m!=null&&j<O;)m=m[Dn(y[j++])];return j&&j==O?m:t}function Pg(m,y,j){var O=y(m);return Bt(m)?O:ni(O,j(m))}function pn(m){return m==null?m===t?Se:Ke:Kn&&Kn in hn(m)?Zg(m):ay(m)}function Bu(m,y){return m>y}function pp(m,y){return m!=null&&wn.call(m,y)}function Dg(m,y){return m!=null&&y in hn(m)}function Ig(m,y,j){return m>=rr(y,j)&&m<Xn(y,j)}function mp(m,y,j){for(var O=j?Cu:es,H=m[0].length,se=m.length,xe=se,je=qe(se),Oe=1/0,tt=[];xe--;){var rt=m[xe];xe&&y&&(rt=qn(rt,ui(y))),Oe=rr(rt.length,Oe),je[xe]=!j&&(y||H>=120&&rt.length>=120)?new Ls(xe&&rt):t}rt=m[0];var at=-1,pt=je[0];e:for(;++at<H&&tt.length<Oe;){var vt=rt[at],$t=y?y(vt):vt;if(vt=j||vt!==0?vt:0,!(pt?xo(pt,$t):O(tt,$t,j))){for(xe=se;--xe;){var rn=je[xe];if(!(rn?xo(rn,$t):O(m[xe],$t,j)))continue e}pt&&pt.push($t),tt.push(vt)}}return tt}function gp(m,y,j,O){return si(m,function(H,se,xe){y(O,j(H),se,xe)}),O}function El(m,y,j){y=Us(y,m),m=Rc(m,y);var O=m==null?m:m[Dn(oi(y))];return O==null?t:Hr(O,m,j)}function bf(m){return dr(m)&&pn(m)==Ne}function Ci(m){return dr(m)&&pn(m)==fe}function Nr(m){return dr(m)&&pn(m)==ye}function Al(m,y,j,O,H){return m===y?!0:m==null||y==null||!dr(m)&&!dr(y)?m!==m&&y!==y:qu(m,y,j,O,Al,H)}function qu(m,y,j,O,H,se){var xe=Bt(m),je=Bt(y),Oe=xe?te:Lr(m),tt=je?te:Lr(y);Oe=Oe==Ne?Ye:Oe,tt=tt==Ne?Ye:tt;var rt=Oe==Ye,at=tt==Ye,pt=Oe==tt;if(pt&&Uo(m)){if(!Uo(y))return!1;xe=!0,rt=!1}if(pt&&!rt)return se||(se=new pi),xe||Yc(m)?Kg(m,y,j,O,H,se):Xg(m,y,Oe,j,O,H,se);if(!(j&S)){var vt=rt&&wn.call(m,"__wrapped__"),$t=at&&wn.call(y,"__wrapped__");if(vt||$t){var rn=vt?m.value():m,zt=$t?y.value():y;return se||(se=new pi),H(rn,zt,j,O,se)}}return pt?(se||(se=new pi),Or(m,y,j,O,H,se)):!1}function vf(m){return dr(m)&&Lr(m)==Le}function Vu(m,y,j,O){var H=j.length,se=H,xe=!O;if(m==null)return!se;for(m=hn(m);H--;){var je=j[H];if(xe&&je[2]?je[1]!==m[je[0]]:!(je[0]in m))return!1}for(;++H<se;){je=j[H];var Oe=je[0],tt=m[Oe],rt=je[1];if(xe&&je[2]){if(tt===t&&!(Oe in m))return!1}else{var at=new pi;if(O)var pt=O(tt,rt,Oe,m,y,at);if(!(pt===t?Al(rt,tt,S|k,O,at):pt))return!1}}return!0}function os(m){if(!sr(m)||qf(m))return!1;var y=Ra(m)?Sc:Xd;return y.test(Hs(m))}function wf(m){return dr(m)&&pn(m)==Nt}function yp(m){return dr(m)&&Lr(m)==ue}function xp(m){return dr(m)&&$l(m.length)&&!!_n[pn(m)]}function bp(m){return typeof m=="function"?m:m==null?Ue:typeof m=="object"?Bt(m)?Cf(m[0],m[1]):wp(m):Sn(m)}function Sf(m){if(!Hn(m))return ta(m);var y=[];for(var j in hn(m))wn.call(m,j)&&j!="constructor"&&y.push(j);return y}function Rg(m){if(!sr(m))return Do(m);var y=Hn(m),j=[];for(var O in m)O=="constructor"&&(y||!wn.call(m,O))||j.push(O);return j}function Nf(m,y){return m<y}function vp(m,y){var j=-1,O=Er(m)?qe(m.length):[];return $s(m,function(H,se,xe){O[++j]=y(H,se,xe)}),O}function wp(m){var y=$f(m);return y.length==1&&y[0][2]?ry(y[0][0],y[0][1]):function(j){return j===m||Vu(j,m,y)}}function Cf(m,y){return Uf(m)&&ny(y)?ry(Dn(m),y):function(j){var O=jd(j,m);return O===t&&O===y?Kc(j,m):Al(y,O,S|k)}}function Hu(m,y,j,O,H){m!==y&&Tc(y,function(se,xe){if(H||(H=new pi),sr(se))av(m,y,xe,j,Hu,O,H);else{var je=O?O(Vf(m,xe),se,xe+"",m,y,H):t;je===t&&(je=se),ss(m,xe,je)}},Fr)}function av(m,y,j,O,H,se,xe){var je=Vf(m,j),Oe=Vf(y,j),tt=xe.get(Oe);if(tt){ss(m,j,tt);return}var rt=se?se(je,Oe,j+"",m,y,xe):t,at=rt===t;if(at){var pt=Bt(Oe),vt=!pt&&Uo(Oe),$t=!pt&&!vt&&Yc(Oe);rt=Oe,pt||vt||$t?Bt(je)?rt=je:yr(je)?rt=kr(je):vt?(at=!1,rt=Ep(Oe,!0)):$t?(at=!1,rt=Pp(Oe,!0)):rt=[]:la(Oe)||Qs(Oe)?(rt=je,Qs(je)?rt=Qy(je):(!sr(je)||Ra(je))&&(rt=Fp(Oe))):at=!1}at&&(xe.set(Oe,rt),H(rt,Oe,O,se,xe),xe.delete(Oe)),ss(m,j,rt)}function Sp(m,y){var j=m.length;if(j)return y+=y<0?j:0,Ia(y,j)?m[y]:t}function Np(m,y,j){y.length?y=qn(y,function(se){return Bt(se)?function(xe){return ia(xe,se.length===1?se[0]:se)}:se}):y=[Ue];var O=-1;y=qn(y,ui(Tt()));var H=vp(m,function(se,xe,je){var Oe=qn(y,function(tt){return tt(se)});return{criteria:Oe,index:++O,value:se}});return Tu(H,function(se,xe){return Vg(se,xe,j)})}function Mg(m,y){return _f(m,y,function(j,O){return Kc(m,O)})}function _f(m,y,j){for(var O=-1,H=y.length,se={};++O<H;){var xe=y[O],je=ia(m,xe);j(je,xe)&&Pc(se,Us(xe,m),je)}return se}function Og(m){return function(y){return ia(y,m)}}function jf(m,y,j,O){var H=O?ns:mo,se=-1,xe=y.length,je=m;for(m===y&&(y=kr(y)),j&&(je=qn(m,ui(j)));++se<xe;)for(var Oe=0,tt=y[se],rt=j?j(tt):tt;(Oe=H(je,rt,Oe,O))>-1;)je!==m&&_t.call(je,Oe,1),_t.call(m,Oe,1);return m}function Cp(m,y){for(var j=m?y.length:0,O=j-1;j--;){var H=y[j];if(j==O||H!==se){var se=H;Ia(H)?_t.call(m,H,1):Qu(m,H)}}return m}function kf(m,y){return m+Ms(sp()*(y-m+1))}function Lg(m,y,j,O){for(var H=-1,se=Xn(Nc((y-m)/(j||1)),0),xe=qe(se);se--;)xe[O?se:++H]=m,m+=j;return xe}function _p(m,y){var j="";if(!m||y<1||y>le)return j;do y%2&&(j+=m),y=Ms(y/2),y&&(m+=m);while(y);return j}function Wt(m,y){return ud(zp(m,y,Ue),m+"")}function Ac(m){return jc(Zc(m))}function Tf(m,y){var j=Zc(m);return fd(j,Pa(y,0,j.length))}function Pc(m,y,j,O){if(!sr(m))return m;y=Us(y,m);for(var H=-1,se=y.length,xe=se-1,je=m;je!=null&&++H<se;){var Oe=Dn(y[H]),tt=j;if(Oe==="__proto__"||Oe==="constructor"||Oe==="prototype")return m;if(H!=xe){var rt=je[Oe];tt=O?O(rt,Oe,je):t,tt===t&&(tt=sr(rt)?rt:Ia(y[H+1])?[]:{})}jl(je,Oe,tt),je=je[Oe]}return m}var Gu=Cc?function(m,y){return Cc.set(m,y),m}:Ue,Yu=vl?function(m,y){return vl(m,"toString",{configurable:!0,enumerable:!1,value:ze(y),writable:!0})}:Ue;function Fg(m){return fd(Zc(m))}function Bi(m,y,j){var O=-1,H=m.length;y<0&&(y=-y>H?0:H+y),j=j>H?H:j,j<0&&(j+=H),H=y>j?0:j-y>>>0,y>>>=0;for(var se=qe(H);++O<H;)se[O]=m[O+y];return se}function $g(m,y){var j;return $s(m,function(O,H,se){return j=y(O,H,se),!j}),!!j}function Wu(m,y,j){var O=0,H=m==null?O:m.length;if(typeof y=="number"&&y===y&&H<=D){for(;O<H;){var se=O+H>>>1,xe=m[se];xe!==null&&!yi(xe)&&(j?xe<=y:xe<y)?O=se+1:H=se}return H}return Ef(m,y,Ue,j)}function Ef(m,y,j,O){var H=0,se=m==null?0:m.length;if(se===0)return 0;y=j(y);for(var xe=y!==y,je=y===null,Oe=yi(y),tt=y===t;H<se;){var rt=Ms((H+se)/2),at=j(m[rt]),pt=at!==t,vt=at===null,$t=at===at,rn=yi(at);if(xe)var zt=O||$t;else tt?zt=$t&&(O||pt):je?zt=$t&&pt&&(O||!vt):Oe?zt=$t&&pt&&!vt&&(O||!rn):vt||rn?zt=!1:zt=O?at<=y:at<y;zt?H=rt+1:se=rt}return rr(se,he)}function jp(m,y){for(var j=-1,O=m.length,H=0,se=[];++j<O;){var xe=m[j],je=y?y(xe):xe;if(!j||!Ai(je,Oe)){var Oe=je;se[H++]=xe===0?0:xe}}return se}function Af(m){return typeof m=="number"?m:yi(m)?E:+m}function _i(m){if(typeof m=="string")return m;if(Bt(m))return qn(m,_i)+"";if(yi(m))return _o?_o.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function zs(m,y,j){var O=-1,H=es,se=m.length,xe=!0,je=[],Oe=je;if(j)xe=!1,H=Cu;else if(se>=a){var tt=y?null:Qg(m);if(tt)return gl(tt);xe=!1,H=xo,Oe=new Ls}else Oe=y?[]:je;e:for(;++O<se;){var rt=m[O],at=y?y(rt):rt;if(rt=j||rt!==0?rt:0,xe&&at===at){for(var pt=Oe.length;pt--;)if(Oe[pt]===at)continue e;y&&Oe.push(at),je.push(rt)}else H(Oe,at,j)||(Oe!==je&&Oe.push(at),je.push(rt))}return je}function Qu(m,y){return y=Us(y,m),m=Rc(m,y),m==null||delete m[Dn(oi(y))]}function kp(m,y,j,O){return Pc(m,y,j(ia(m,y)),O)}function Ju(m,y,j,O){for(var H=m.length,se=O?H:-1;(O?se--:++se<H)&&y(m[se],se,m););return j?Bi(m,O?0:se,O?se+1:H):Bi(m,O?se+1:0,O?H:se)}function zg(m,y){var j=m;return j instanceof tn&&(j=j.value()),gc(y,function(O,H){return H.func.apply(H.thisArg,ni([O],H.args))},j)}function Ku(m,y,j){var O=m.length;if(O<2)return O?zs(m[0]):[];for(var H=-1,se=qe(O);++H<O;)for(var xe=m[H],je=-1;++je<O;)je!=H&&(se[H]=ko(se[H]||xe,m[je],y,j));return zs(un(se,1),y,j)}function Tp(m,y,j){for(var O=-1,H=m.length,se=y.length,xe={};++O<H;){var je=O<se?y[O]:t;j(xe,m[O],je)}return xe}function Pf(m){return yr(m)?m:[]}function Xu(m){return typeof m=="function"?m:Ue}function Us(m,y){return Bt(m)?m:Uf(m,y)?[m]:ds(An(m))}var Ug=Wt;function Eo(m,y,j){var O=m.length;return j=j===t?O:j,!y&&j>=O?m:Bi(m,y,j)}var Bg=df||function(m){return tr.clearTimeout(m)};function Ep(m,y){if(y)return m.slice();var j=m.length,O=ce?ce(j):new m.constructor(j);return m.copy(O),O}function Pl(m){var y=new m.constructor(m.byteLength);return new ge(y).set(new ge(m)),y}function Ap(m,y){var j=y?Pl(m.buffer):m.buffer;return new m.constructor(j,m.byteOffset,m.byteLength)}function Df(m){var y=new m.constructor(m.source,Cs.exec(m));return y.lastIndex=m.lastIndex,y}function qg(m){return Nl?hn(Nl.call(m)):{}}function Pp(m,y){var j=y?Pl(m.buffer):m.buffer;return new m.constructor(j,m.byteOffset,m.length)}function Zu(m,y){if(m!==y){var j=m!==t,O=m===null,H=m===m,se=yi(m),xe=y!==t,je=y===null,Oe=y===y,tt=yi(y);if(!je&&!tt&&!se&&m>y||se&&xe&&Oe&&!je&&!tt||O&&xe&&Oe||!j&&Oe||!H)return 1;if(!O&&!se&&!tt&&m<y||tt&&j&&H&&!O&&!se||je&&j&&H||!xe&&H||!Oe)return-1}return 0}function Vg(m,y,j){for(var O=-1,H=m.criteria,se=y.criteria,xe=H.length,je=j.length;++O<xe;){var Oe=Zu(H[O],se[O]);if(Oe){if(O>=je)return Oe;var tt=j[O];return Oe*(tt=="desc"?-1:1)}}return m.index-y.index}function Dp(m,y,j,O){for(var H=-1,se=m.length,xe=j.length,je=-1,Oe=y.length,tt=Xn(se-xe,0),rt=qe(Oe+tt),at=!O;++je<Oe;)rt[je]=y[je];for(;++H<xe;)(at||H<se)&&(rt[j[H]]=m[H]);for(;tt--;)rt[je++]=m[H++];return rt}function Hg(m,y,j,O){for(var H=-1,se=m.length,xe=-1,je=j.length,Oe=-1,tt=y.length,rt=Xn(se-je,0),at=qe(rt+tt),pt=!O;++H<rt;)at[H]=m[H];for(var vt=H;++Oe<tt;)at[vt+Oe]=y[Oe];for(;++xe<je;)(pt||H<se)&&(at[vt+j[xe]]=m[H++]);return at}function kr(m,y){var j=-1,O=m.length;for(y||(y=qe(O));++j<O;)y[j]=m[j];return y}function ji(m,y,j,O){var H=!j;j||(j={});for(var se=-1,xe=y.length;++se<xe;){var je=y[se],Oe=O?O(j[je],m[je],je,j,m):t;Oe===t&&(Oe=m[je]),H?Aa(j,je,Oe):jl(j,je,Oe)}return j}function If(m,y){return ji(m,sd(m),y)}function ed(m,y){return ji(m,zf(m),y)}function Dl(m,y){return function(j,O){var H=Bt(j)?Pn:jo,se=y?y():{};return H(j,m,Tt(O,2),se)}}function Il(m){return Wt(function(y,j){var O=-1,H=j.length,se=H>1?j[H-1]:t,xe=H>2?j[2]:t;for(se=m.length>3&&typeof se=="function"?(H--,se):t,xe&&gi(j[0],j[1],xe)&&(se=H<3?t:se,H=1),y=hn(y);++O<H;){var je=j[O];je&&m(y,je,O,se)}return y})}function Ip(m,y){return function(j,O){if(j==null)return j;if(!Er(j))return m(j,O);for(var H=j.length,se=y?H:-1,xe=hn(j);(y?se--:++se<H)&&O(xe[se],se,xe)!==!1;);return j}}function Rl(m){return function(y,j,O){for(var H=-1,se=hn(y),xe=O(y),je=xe.length;je--;){var Oe=xe[m?je:++H];if(j(se[Oe],Oe,se)===!1)break}return y}}function Gg(m,y,j){var O=y&T,H=aa(m);function se(){var xe=this&&this!==tr&&this instanceof se?H:m;return xe.apply(O?j:this,arguments)}return se}function qi(m){return function(y){y=An(y);var j=rs(y)?di(y):t,O=j?j[0]:y.charAt(0),H=j?Eo(j,1).join(""):y.slice(1);return O[m]()+H}}function mi(m){return function(y){return gc(N(Js(y).replace(Es,"")),m,"")}}function aa(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var j=Ui(m.prototype),O=m.apply(j,y);return sr(O)?O:j}}function Yg(m,y,j){var O=aa(m);function H(){for(var se=arguments.length,xe=qe(se),je=se,Oe=Ol(H);je--;)xe[je]=arguments[je];var tt=se<3&&xe[0]!==Oe&&xe[se-1]!==Oe?[]:Mr(xe,Oe);if(se-=tt.length,se<j)return Rp(m,y,mr,H.placeholder,t,xe,tt,t,t,j-se);var rt=this&&this!==tr&&this instanceof H?O:m;return Hr(rt,this,xe)}return H}function Bs(m){return function(y,j,O){var H=hn(y);if(!Er(y)){var se=Tt(j,3);y=Pr(y),j=function(je){return se(H[je],je,H)}}var xe=m(y,j,O);return xe>-1?H[se?y[xe]:xe]:t}}function ls(m){return Zn(function(y){var j=y.length,O=j,H=Si.prototype.thru;for(m&&y.reverse();O--;){var se=y[O];if(typeof se!="function")throw new hi(l);if(H&&!xe&&ad(se)=="wrapper")var xe=new Si([],!0)}for(O=xe?O:j;++O<j;){se=y[O];var je=ad(se),Oe=je=="wrapper"?Ff(se):t;Oe&&Bf(Oe[0])&&Oe[1]==(U|R|$|B)&&!Oe[4].length&&Oe[9]==1?xe=xe[ad(Oe[0])].apply(xe,Oe[3]):xe=se.length==1&&Bf(se)?xe[je]():xe.thru(se)}return function(){var tt=arguments,rt=tt[0];if(xe&&tt.length==1&&Bt(rt))return xe.plant(rt).value();for(var at=0,pt=j?y[at].apply(this,tt):rt;++at<j;)pt=y[at].call(this,pt);return pt}})}function mr(m,y,j,O,H,se,xe,je,Oe,tt){var rt=y&U,at=y&T,pt=y&P,vt=y&(R|z),$t=y&W,rn=pt?t:aa(m);function zt(){for(var mn=arguments.length,Nn=qe(mn),Oa=mn;Oa--;)Nn[Oa]=arguments[Oa];if(vt)var Wi=Ol(zt),La=np(Nn,Wi);if(O&&(Nn=Dp(Nn,O,H,vt)),se&&(Nn=Hg(Nn,se,xe,vt)),mn-=La,vt&&mn<tt){var Dr=Mr(Nn,Wi);return Rp(m,y,mr,zt.placeholder,j,Nn,Dr,je,Oe,tt-mn)}var Ks=at?j:this,zl=pt?Ks[m]:m;return mn=Nn.length,je?Nn=us(Nn,je):$t&&mn>1&&Nn.reverse(),rt&&Oe<mn&&(Nn.length=Oe),this&&this!==tr&&this instanceof zt&&(zl=rn||aa(zl)),zl.apply(Ks,Nn)}return zt}function td(m,y){return function(j,O){return gp(j,m,y(O),{})}}function Dc(m,y){return function(j,O){var H;if(j===t&&O===t)return y;if(j!==t&&(H=j),O!==t){if(H===t)return O;typeof j=="string"||typeof O=="string"?(j=_i(j),O=_i(O)):(j=Af(j),O=Af(O)),H=m(j,O)}return H}}function nd(m){return Zn(function(y){return y=qn(y,ui(Tt())),Wt(function(j){var O=this;return m(y,function(H){return Hr(H,O,j)})})})}function rd(m,y){y=y===t?" ":_i(y);var j=y.length;if(j<2)return j?_p(y,m):y;var O=_p(y,Nc(m/ii(y)));return rs(y)?Eo(di(O),0,m).join(""):O.slice(0,m)}function Wg(m,y,j,O){var H=y&T,se=aa(m);function xe(){for(var je=-1,Oe=arguments.length,tt=-1,rt=O.length,at=qe(rt+Oe),pt=this&&this!==tr&&this instanceof xe?se:m;++tt<rt;)at[tt]=O[tt];for(;Oe--;)at[tt++]=arguments[++je];return Hr(pt,H?j:this,at)}return xe}function Ao(m){return function(y,j,O){return O&&typeof O!="number"&&gi(y,j,O)&&(j=O=t),y=ps(y),j===t?(j=y,y=0):j=ps(j),O=O===t?y<j?1:-1:ps(O),Lg(y,j,O,m)}}function Ml(m){return function(y,j){return typeof y=="string"&&typeof j=="string"||(y=ca(y),j=ca(j)),m(y,j)}}function Rp(m,y,j,O,H,se,xe,je,Oe,tt){var rt=y&R,at=rt?xe:t,pt=rt?t:xe,vt=rt?se:t,$t=rt?t:se;y|=rt?$:L,y&=~(rt?L:$),y&M||(y&=-4);var rn=[m,y,H,vt,at,$t,pt,je,Oe,tt],zt=j.apply(t,rn);return Bf(m)&&Hf(zt,rn),zt.placeholder=O,Gf(zt,m,y)}function Rf(m){var y=nr[m];return function(j,O){if(j=ca(j),O=O==null?0:rr(Gt(O),292),O&&Iu(j)){var H=(An(j)+"e").split("e"),se=y(H[0]+"e"+(+H[1]+O));return H=(An(se)+"e").split("e"),+(H[0]+"e"+(+H[1]-O))}return y(j)}}var Qg=cn&&1/gl(new cn([,-0]))[1]==ne?function(m){return new cn(m)}:gt;function id(m){return function(y){var j=Lr(y);return j==Le?$i(y):j==ue?of(y):yc(y,m(y))}}function cs(m,y,j,O,H,se,xe,je){var Oe=y&P;if(!Oe&&typeof m!="function")throw new hi(l);var tt=O?O.length:0;if(tt||(y&=-97,O=H=t),xe=xe===t?xe:Xn(Gt(xe),0),je=je===t?je:Gt(je),tt-=H?H.length:0,y&L){var rt=O,at=H;O=H=t}var pt=Oe?t:Ff(m),vt=[m,y,j,O,H,rt,at,se,xe,je];if(pt&&cd(vt,pt),m=vt[0],y=vt[1],j=vt[2],O=vt[3],H=vt[4],je=vt[9]=vt[9]===t?Oe?0:m.length:Xn(vt[9]-tt,0),!je&&y&(R|z)&&(y&=-25),!y||y==T)var $t=Gg(m,y,j);else y==R||y==z?$t=Yg(m,y,je):(y==$||y==(T|$))&&!H.length?$t=Wg(m,y,j,O):$t=mr.apply(t,vt);var rn=pt?Gu:Hf;return Gf(rn($t,vt),m,y)}function Mf(m,y,j,O){return m===t||Ai(m,So[j])&&!wn.call(O,j)?y:m}function Mp(m,y,j,O,H,se){return sr(m)&&sr(y)&&(se.set(y,m),Hu(m,y,t,Mp,se),se.delete(y)),m}function Jg(m){return la(m)?t:m}function Kg(m,y,j,O,H,se){var xe=j&S,je=m.length,Oe=y.length;if(je!=Oe&&!(xe&&Oe>je))return!1;var tt=se.get(m),rt=se.get(y);if(tt&&rt)return tt==y&&rt==m;var at=-1,pt=!0,vt=j&k?new Ls:t;for(se.set(m,y),se.set(y,m);++at<je;){var $t=m[at],rn=y[at];if(O)var zt=xe?O(rn,$t,at,y,m,se):O($t,rn,at,m,y,se);if(zt!==t){if(zt)continue;pt=!1;break}if(vt){if(!ho(y,function(mn,Nn){if(!xo(vt,Nn)&&($t===mn||H($t,mn,j,O,se)))return vt.push(Nn)})){pt=!1;break}}else if(!($t===rn||H($t,rn,j,O,se))){pt=!1;break}}return se.delete(m),se.delete(y),pt}function Xg(m,y,j,O,H,se,xe){switch(j){case Ge:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case fe:return!(m.byteLength!=y.byteLength||!se(new ge(m),new ge(y)));case J:case ye:case _e:return Ai(+m,+y);case Q:return m.name==y.name&&m.message==y.message;case Nt:case Ae:return m==y+"";case Le:var je=$i;case ue:var Oe=O&S;if(je||(je=gl),m.size!=y.size&&!Oe)return!1;var tt=xe.get(m);if(tt)return tt==y;O|=k,xe.set(m,y);var rt=Kg(je(m),je(y),O,H,se,xe);return xe.delete(m),rt;case ke:if(Nl)return Nl.call(m)==Nl.call(y)}return!1}function Or(m,y,j,O,H,se){var xe=j&S,je=Of(m),Oe=je.length,tt=Of(y),rt=tt.length;if(Oe!=rt&&!xe)return!1;for(var at=Oe;at--;){var pt=je[at];if(!(xe?pt in y:wn.call(y,pt)))return!1}var vt=se.get(m),$t=se.get(y);if(vt&&$t)return vt==y&&$t==m;var rn=!0;se.set(m,y),se.set(y,m);for(var zt=xe;++at<Oe;){pt=je[at];var mn=m[pt],Nn=y[pt];if(O)var Oa=xe?O(Nn,mn,pt,y,m,se):O(mn,Nn,pt,m,y,se);if(!(Oa===t?mn===Nn||H(mn,Nn,j,O,se):Oa)){rn=!1;break}zt||(zt=pt=="constructor")}if(rn&&!zt){var Wi=m.constructor,La=y.constructor;Wi!=La&&"constructor"in m&&"constructor"in y&&!(typeof Wi=="function"&&Wi instanceof Wi&&typeof La=="function"&&La instanceof La)&&(rn=!1)}return se.delete(m),se.delete(y),rn}function Zn(m){return ud(zp(m,t,Ti),m+"")}function Of(m){return Pg(m,Pr,sd)}function Lf(m){return Pg(m,Fr,zf)}var Ff=Cc?function(m){return Cc.get(m)}:gt;function ad(m){for(var y=m.name+"",j=na[y],O=wn.call(na,y)?j.length:0;O--;){var H=j[O],se=H.func;if(se==null||se==m)return H.name}return y}function Ol(m){var y=wn.call(Z,"placeholder")?Z:m;return y.placeholder}function Tt(){var m=Z.iteratee||Mt;return m=m===Mt?bp:m,arguments.length?m(arguments[0],arguments[1]):m}function Ic(m,y){var j=m.__data__;return Vs(y)?j[typeof y=="string"?"string":"hash"]:j.map}function $f(m){for(var y=Pr(m),j=y.length;j--;){var O=y[j],H=m[O];y[j]=[O,H,ny(H)]}return y}function Po(m,y){var j=vc(m,y);return os(j)?j:t}function Zg(m){var y=wn.call(m,Kn),j=m[Kn];try{m[Kn]=t;var O=!0}catch{}var H=Gr.call(m);return O&&(y?m[Kn]=j:delete m[Kn]),H}var sd=No?function(m){return m==null?[]:(m=hn(m),ti(No(m),function(y){return dt.call(m,y)}))}:Bv,zf=No?function(m){for(var y=[];m;)ni(y,sd(m)),m=Te(m);return y}:Bv,Lr=pn;(Ru&&Lr(new Ru(new ArrayBuffer(1)))!=Ge||jr&&Lr(new jr)!=Le||ir&&Lr(ir.resolve())!=it||cn&&Lr(new cn)!=ue||Ea&&Lr(new Ea)!=ve)&&(Lr=function(m){var y=pn(m),j=y==Ye?m.constructor:t,O=j?Hs(j):"";if(O)switch(O){case bg:return Ge;case vg:return Le;case Mu:return it;case Ou:return ue;case wg:return ve}return y});function ey(m,y,j){for(var O=-1,H=j.length;++O<H;){var se=j[O],xe=se.size;switch(se.type){case"drop":m+=xe;break;case"dropRight":y-=xe;break;case"take":y=rr(y,m+xe);break;case"takeRight":m=Xn(m,y-xe);break}}return{start:m,end:y}}function Op(m){var y=m.match(Jd);return y?y[1].split(Kd):[]}function od(m,y,j){y=Us(y,m);for(var O=-1,H=y.length,se=!1;++O<H;){var xe=Dn(y[O]);if(!(se=m!=null&&j(m,xe)))break;m=m[xe]}return se||++O!=H?se:(H=m==null?0:m.length,!!H&&$l(H)&&Ia(xe,H)&&(Bt(m)||Qs(m)))}function Lp(m){var y=m.length,j=new m.constructor(y);return y&&typeof m[0]=="string"&&wn.call(m,"index")&&(j.index=m.index,j.input=m.input),j}function Fp(m){return typeof m.constructor=="function"&&!Hn(m)?Ui(Te(m)):{}}function $p(m,y,j){var O=m.constructor;switch(y){case fe:return Pl(m);case J:case ye:return new O(+m);case Ge:return Ap(m,j);case Je:case ct:case wt:case Ht:case Ce:case be:case Fe:case Ie:case Ve:return Pp(m,j);case Le:return new O;case _e:case Ae:return new O(m);case Nt:return Df(m);case ue:return new O;case ke:return qg(m)}}function ty(m,y){var j=y.length;if(!j)return m;var O=j-1;return y[O]=(j>1?"& ":"")+y[O],y=y.join(j>2?", ":" "),m.replace(Qd,`{
/* [wrapped with `+y+`] */
`)}function qs(m){return Bt(m)||Qs(m)||!!(yt&&m&&m[yt])}function Ia(m,y){var j=typeof m;return y=y??le,!!y&&(j=="number"||j!="symbol"&&js.test(m))&&m>-1&&m%1==0&&m<y}function gi(m,y,j){if(!sr(j))return!1;var O=typeof y;return(O=="number"?Er(j)&&Ia(y,j.length):O=="string"&&y in j)?Ai(j[y],m):!1}function Uf(m,y){if(Bt(m))return!1;var j=typeof m;return j=="number"||j=="symbol"||j=="boolean"||m==null||yi(m)?!0:Vr.test(m)||!Jn.test(m)||y!=null&&m in hn(y)}function Vs(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Bf(m){var y=ad(m),j=Z[y];if(typeof j!="function"||!(y in tn.prototype))return!1;if(m===j)return!0;var O=Ff(j);return!!O&&m===O[0]}function qf(m){return!!Du&&Du in m}var ld=xl?Ra:qv;function Hn(m){var y=m&&m.constructor,j=typeof y=="function"&&y.prototype||So;return m===j}function ny(m){return m===m&&!sr(m)}function ry(m,y){return function(j){return j==null?!1:j[m]===y&&(y!==t||m in hn(j))}}function iy(m){var y=vd(m,function(O){return j.size===u&&j.clear(),O}),j=y.cache;return y}function cd(m,y){var j=m[1],O=y[1],H=j|O,se=H<(T|P|U),xe=O==U&&j==R||O==U&&j==B&&m[7].length<=y[8]||O==(U|B)&&y[7].length<=y[8]&&j==R;if(!(se||xe))return m;O&T&&(m[2]=y[2],H|=j&T?0:M);var je=y[3];if(je){var Oe=m[3];m[3]=Oe?Dp(Oe,je,y[4]):je,m[4]=Oe?Mr(m[3],h):y[4]}return je=y[5],je&&(Oe=m[5],m[5]=Oe?Hg(Oe,je,y[6]):je,m[6]=Oe?Mr(m[5],h):y[6]),je=y[7],je&&(m[7]=je),O&U&&(m[8]=m[8]==null?y[8]:rr(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=H,m}function Do(m){var y=[];if(m!=null)for(var j in hn(m))y.push(j);return y}function ay(m){return Gr.call(m)}function zp(m,y,j){return y=Xn(y===t?m.length-1:y,0),function(){for(var O=arguments,H=-1,se=Xn(O.length-y,0),xe=qe(se);++H<se;)xe[H]=O[y+H];H=-1;for(var je=qe(y+1);++H<y;)je[H]=O[H];return je[y]=j(xe),Hr(m,this,je)}}function Rc(m,y){return y.length<2?m:ia(m,Bi(y,0,-1))}function us(m,y){for(var j=m.length,O=rr(y.length,j),H=kr(m);O--;){var se=y[O];m[O]=Ia(se,j)?H[se]:t}return m}function Vf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Hf=dd(Gu),Mc=ap||function(m,y){return tr.setTimeout(m,y)},ud=dd(Yu);function Gf(m,y,j){var O=y+"";return ud(m,ty(O,sy(Op(O),j)))}function dd(m){var y=0,j=0;return function(){var O=Os(),H=re-(O-j);if(j=O,H>0){if(++y>=V)return arguments[0]}else y=0;return m.apply(t,arguments)}}function fd(m,y){var j=-1,O=m.length,H=O-1;for(y=y===t?O:y;++j<y;){var se=kf(j,H),xe=m[se];m[se]=m[j],m[j]=xe}return m.length=y,m}var ds=iy(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(fr,function(j,O,H,se){y.push(H?se.replace(ba,"$1"):O||j)}),y});function Dn(m){if(typeof m=="string"||yi(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Hs(m){if(m!=null){try{return bl.call(m)}catch{}try{return m+""}catch{}}return""}function sy(m,y){return ei(pe,function(j){var O="_."+j[0];y&j[1]&&!es(m,O)&&m.push(O)}),m.sort()}function Tr(m){if(m instanceof tn)return m.clone();var y=new Si(m.__wrapped__,m.__chain__);return y.__actions__=kr(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function sv(m,y,j){(j?gi(m,y,j):y===t)?y=1:y=Xn(Gt(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var H=0,se=0,xe=qe(Nc(O/y));H<O;)xe[se++]=Bi(m,H,H+=y);return xe}function oy(m){for(var y=-1,j=m==null?0:m.length,O=0,H=[];++y<j;){var se=m[y];se&&(H[O++]=se)}return H}function ly(){var m=arguments.length;if(!m)return[];for(var y=qe(m-1),j=arguments[0],O=m;O--;)y[O-1]=arguments[O];return ni(Bt(j)?kr(j):[j],un(y,1))}var ar=Wt(function(m,y){return yr(m)?ko(m,un(y,1,yr,!0)):[]}),ki=Wt(function(m,y){var j=oi(y);return yr(j)&&(j=t),yr(m)?ko(m,un(y,1,yr,!0),Tt(j,2)):[]}),Gs=Wt(function(m,y){var j=oi(y);return yr(j)&&(j=t),yr(m)?ko(m,un(y,1,yr,!0),t,j):[]});function cy(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Gt(y),Bi(m,y<0?0:y,O)):[]}function uy(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Gt(y),y=O-y,Bi(m,0,y<0?0:y)):[]}function ov(m,y){return m&&m.length?Ju(m,Tt(y,3),!0,!0):[]}function Up(m,y){return m&&m.length?Ju(m,Tt(y,3),!0):[]}function Vi(m,y,j,O){var H=m==null?0:m.length;return H?(j&&typeof j!="number"&&gi(m,y,j)&&(j=0,O=H),Kt(m,y,j,O)):[]}function sa(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var H=j==null?0:Gt(j);return H<0&&(H=Xn(O+H,0)),ts(m,Tt(y,3),H)}function Bp(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var H=O-1;return j!==t&&(H=Gt(j),H=j<0?Xn(O+H,0):rr(H,O-1)),ts(m,Tt(y,3),H,!0)}function Ti(m){var y=m==null?0:m.length;return y?un(m,1):[]}function dy(m){var y=m==null?0:m.length;return y?un(m,ne):[]}function Io(m,y){var j=m==null?0:m.length;return j?(y=y===t?1:Gt(y),un(m,y)):[]}function Ll(m){for(var y=-1,j=m==null?0:m.length,O={};++y<j;){var H=m[y];O[H[0]]=H[1]}return O}function Ys(m){return m&&m.length?m[0]:t}function qp(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var H=j==null?0:Gt(j);return H<0&&(H=Xn(O+H,0)),mo(m,y,H)}function Vp(m){var y=m==null?0:m.length;return y?Bi(m,0,-1):[]}var fs=Wt(function(m){var y=qn(m,Pf);return y.length&&y[0]===m[0]?mp(y):[]}),fy=Wt(function(m){var y=oi(m),j=qn(m,Pf);return y===oi(j)?y=t:j.pop(),j.length&&j[0]===m[0]?mp(j,Tt(y,2)):[]}),Oc=Wt(function(m){var y=oi(m),j=qn(m,Pf);return y=typeof y=="function"?y:t,y&&j.pop(),j.length&&j[0]===m[0]?mp(j,t,y):[]});function hd(m,y){return m==null?"":ea.call(m,y)}function oi(m){var y=m==null?0:m.length;return y?m[y-1]:t}function Lc(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var H=O;return j!==t&&(H=Gt(j),H=H<0?Xn(O+H,0):rr(H,O-1)),y===y?ri(m,y,H):ts(m,go,H,!0)}function hy(m,y){return m&&m.length?Sp(m,Gt(y)):t}var py=Wt(Fc);function Fc(m,y){return m&&m.length&&y&&y.length?jf(m,y):m}function my(m,y,j){return m&&m.length&&y&&y.length?jf(m,y,Tt(j,2)):m}function Yf(m,y,j){return m&&m.length&&y&&y.length?jf(m,y,t,j):m}var gy=Zn(function(m,y){var j=m==null?0:m.length,O=Uu(m,y);return Cp(m,qn(y,function(H){return Ia(H,j)?+H:H}).sort(Zu)),O});function lv(m,y){var j=[];if(!(m&&m.length))return j;var O=-1,H=[],se=m.length;for(y=Tt(y,3);++O<se;){var xe=m[O];y(xe,O,m)&&(j.push(xe),H.push(O))}return Cp(m,H),j}function Hp(m){return m==null?m:op.call(m)}function Rn(m,y,j){var O=m==null?0:m.length;return O?(j&&typeof j!="number"&&gi(m,y,j)?(y=0,j=O):(y=y==null?0:Gt(y),j=j===t?O:Gt(j)),Bi(m,y,j)):[]}function Wn(m,y){return Wu(m,y)}function sn(m,y,j){return Ef(m,y,Tt(j,2))}function xn(m,y){var j=m==null?0:m.length;if(j){var O=Wu(m,y);if(O<j&&Ai(m[O],y))return O}return-1}function Mn(m,y){return Wu(m,y,!0)}function Hi(m,y,j){return Ef(m,y,Tt(j,2),!0)}function Ro(m,y){var j=m==null?0:m.length;if(j){var O=Wu(m,y,!0)-1;if(Ai(m[O],y))return O}return-1}function $c(m){return m&&m.length?jp(m):[]}function Gp(m,y){return m&&m.length?jp(m,Tt(y,2)):[]}function Ws(m){var y=m==null?0:m.length;return y?Bi(m,1,y):[]}function gr(m,y,j){return m&&m.length?(y=j||y===t?1:Gt(y),Bi(m,0,y<0?0:y)):[]}function Mo(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Gt(y),y=O-y,Bi(m,y<0?0:y,O)):[]}function Fl(m,y){return m&&m.length?Ju(m,Tt(y,3),!1,!0):[]}function Yp(m,y){return m&&m.length?Ju(m,Tt(y,3)):[]}var oa=Wt(function(m){return zs(un(m,1,yr,!0))}),zc=Wt(function(m){var y=oi(m);return yr(y)&&(y=t),zs(un(m,1,yr,!0),Tt(y,2))}),pd=Wt(function(m){var y=oi(m);return y=typeof y=="function"?y:t,zs(un(m,1,yr,!0),t,y)});function Ei(m){return m&&m.length?zs(m):[]}function Wp(m,y){return m&&m.length?zs(m,Tt(y,2)):[]}function Qp(m,y){return y=typeof y=="function"?y:t,m&&m.length?zs(m,t,y):[]}function Uc(m){if(!(m&&m.length))return[];var y=0;return m=ti(m,function(j){if(yr(j))return y=Xn(j.length,y),!0}),ka(y,function(j){return qn(m,_a(j))})}function md(m,y){if(!(m&&m.length))return[];var j=Uc(m);return y==null?j:qn(j,function(O){return Hr(y,t,O)})}var Oo=Wt(function(m,y){return yr(m)?ko(m,y):[]}),Yr=Wt(function(m){return Ku(ti(m,yr))}),Lo=Wt(function(m){var y=oi(m);return yr(y)&&(y=t),Ku(ti(m,yr),Tt(y,2))}),Bc=Wt(function(m){var y=oi(m);return y=typeof y=="function"?y:t,Ku(ti(m,yr),t,y)}),qc=Wt(Uc);function Jp(m,y){return Tp(m||[],y||[],jl)}function Kp(m,y){return Tp(m||[],y||[],Pc)}var yy=Wt(function(m){var y=m.length,j=y>1?m[y-1]:t;return j=typeof j=="function"?(m.pop(),j):t,md(m,j)});function Vc(m){var y=Z(m);return y.__chain__=!0,y}function Xp(m,y){return y(m),m}function li(m,y){return y(m)}var xy=Zn(function(m){var y=m.length,j=y?m[0]:0,O=this.__wrapped__,H=function(se){return Uu(se,m)};return y>1||this.__actions__.length||!(O instanceof tn)||!Ia(j)?this.thru(H):(O=O.slice(j,+j+(y?1:0)),O.__actions__.push({func:li,args:[H],thisArg:t}),new Si(O,this.__chain__).thru(function(se){return y&&!se.length&&se.push(t),se}))});function Gi(){return Vc(this)}function by(){return new Si(this.value(),this.__chain__)}function vy(){this.__values__===t&&(this.__values__=Yi(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function cv(){return this}function Fo(m){for(var y,j=this;j instanceof ra;){var O=Tr(j);O.__index__=0,O.__values__=t,y?H.__wrapped__=O:y=O;var H=O;j=j.__wrapped__}return H.__wrapped__=m,y}function Wf(){var m=this.__wrapped__;if(m instanceof tn){var y=m;return this.__actions__.length&&(y=new tn(this)),y=y.reverse(),y.__actions__.push({func:li,args:[Hp],thisArg:t}),new Si(y,this.__chain__)}return this.thru(Hp)}function Zp(){return zg(this.__wrapped__,this.__actions__)}var Hc=Dl(function(m,y,j){wn.call(m,j)?++m[j]:Aa(m,j,1)});function wy(m,y,j){var O=Bt(m)?mc:hp;return j&&gi(m,y,j)&&(y=t),O(m,Tt(y,3))}function Sy(m,y){var j=Bt(m)?ti:In;return j(m,Tt(y,3))}var Ny=Bs(sa),em=Bs(Bp);function tm(m,y){return un(gd(m,y),1)}function uv(m,y){return un(gd(m,y),ne)}function dv(m,y,j){return j=j===t?1:Gt(j),un(gd(m,y),j)}function Cy(m,y){var j=Bt(m)?ei:$s;return j(m,Tt(y,3))}function nm(m,y){var j=Bt(m)?pc:xf;return j(m,Tt(y,3))}var _y=Dl(function(m,y,j){wn.call(m,j)?m[j].push(y):Aa(m,j,[y])});function Gc(m,y,j,O){m=Er(m)?m:Zc(m),j=j&&!O?Gt(j):0;var H=m.length;return j<0&&(j=Xn(H+j,0)),sh(m)?j<=H&&m.indexOf(y,j)>-1:!!H&&mo(m,y,j)>-1}var Qf=Wt(function(m,y,j){var O=-1,H=typeof y=="function",se=Er(m)?qe(m.length):[];return $s(m,function(xe){se[++O]=H?Hr(y,xe,j):El(xe,y,j)}),se}),jy=Dl(function(m,y,j){Aa(m,j,y)});function gd(m,y){var j=Bt(m)?qn:vp;return j(m,Tt(y,3))}function ky(m,y,j,O){return m==null?[]:(Bt(y)||(y=y==null?[]:[y]),j=O?t:j,Bt(j)||(j=j==null?[]:[j]),Np(m,y,j))}var Ty=Dl(function(m,y,j){m[j?0:1].push(y)},function(){return[[],[]]});function Ey(m,y,j){var O=Bt(m)?gc:Is,H=arguments.length<3;return O(m,Tt(y,4),j,H,$s)}function Ay(m,y,j){var O=Bt(m)?_u:Is,H=arguments.length<3;return O(m,Tt(y,4),j,H,xf)}function Jf(m,y){var j=Bt(m)?ti:In;return j(m,wd(Tt(y,3)))}function Py(m){var y=Bt(m)?jc:Ac;return y(m)}function Dy(m,y,j){(j?gi(m,y,j):y===t)?y=1:y=Gt(y);var O=Bt(m)?Tg:Tf;return O(m,y)}function Gn(m){var y=Bt(m)?Eg:Fg;return y(m)}function rm(m){if(m==null)return 0;if(Er(m))return sh(m)?ii(m):m.length;var y=Lr(m);return y==Le||y==ue?m.size:Sf(m).length}function fv(m,y,j){var O=Bt(m)?ho:$g;return j&&gi(m,y,j)&&(y=t),O(m,Tt(y,3))}var Iy=Wt(function(m,y){if(m==null)return[];var j=y.length;return j>1&&gi(m,y[0],y[1])?y=[]:j>2&&gi(y[0],y[1],y[2])&&(y=[y[0]]),Np(m,un(y,1),[])}),Kf=wl||function(){return tr.Date.now()};function hv(m,y){if(typeof y!="function")throw new hi(l);return m=Gt(m),function(){if(--m<1)return y.apply(this,arguments)}}function Ry(m,y,j){return y=j?t:y,y=m&&y==null?m.length:y,cs(m,U,t,t,t,t,y)}function yd(m,y){var j;if(typeof y!="function")throw new hi(l);return m=Gt(m),function(){return--m>0&&(j=y.apply(this,arguments)),m<=1&&(y=t),j}}var $o=Wt(function(m,y,j){var O=T;if(j.length){var H=Mr(j,Ol($o));O|=$}return cs(m,O,y,j,H)}),Xf=Wt(function(m,y,j){var O=T|P;if(j.length){var H=Mr(j,Ol(Xf));O|=$}return cs(y,O,m,j,H)});function xd(m,y,j){y=j?t:y;var O=cs(m,R,t,t,t,t,t,y);return O.placeholder=xd.placeholder,O}function Zf(m,y,j){y=j?t:y;var O=cs(m,z,t,t,t,t,t,y);return O.placeholder=Zf.placeholder,O}function zo(m,y,j){var O,H,se,xe,je,Oe,tt=0,rt=!1,at=!1,pt=!0;if(typeof m!="function")throw new hi(l);y=ca(y)||0,sr(j)&&(rt=!!j.leading,at="maxWait"in j,se=at?Xn(ca(j.maxWait)||0,y):se,pt="trailing"in j?!!j.trailing:pt);function vt(Dr){var Ks=O,zl=H;return O=H=t,tt=Dr,xe=m.apply(zl,Ks),xe}function $t(Dr){return tt=Dr,je=Mc(mn,y),rt?vt(Dr):xe}function rn(Dr){var Ks=Dr-Oe,zl=Dr-tt,SS=y-Ks;return at?rr(SS,se-zl):SS}function zt(Dr){var Ks=Dr-Oe,zl=Dr-tt;return Oe===t||Ks>=y||Ks<0||at&&zl>=se}function mn(){var Dr=Kf();if(zt(Dr))return Nn(Dr);je=Mc(mn,rn(Dr))}function Nn(Dr){return je=t,pt&&O?vt(Dr):(O=H=t,xe)}function Oa(){je!==t&&Bg(je),tt=0,O=Oe=H=je=t}function Wi(){return je===t?xe:Nn(Kf())}function La(){var Dr=Kf(),Ks=zt(Dr);if(O=arguments,H=this,Oe=Dr,Ks){if(je===t)return $t(Oe);if(at)return Bg(je),je=Mc(mn,y),vt(Oe)}return je===t&&(je=Mc(mn,y)),xe}return La.cancel=Oa,La.flush=Wi,La}var hs=Wt(function(m,y){return kl(m,1,y)}),bd=Wt(function(m,y,j){return kl(m,ca(y)||0,j)});function pv(m){return cs(m,W)}function vd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new hi(l);var j=function(){var O=arguments,H=y?y.apply(this,O):O[0],se=j.cache;if(se.has(H))return se.get(H);var xe=m.apply(this,O);return j.cache=se.set(H,xe)||se,xe};return j.cache=new(vd.Cache||Ni),j}vd.Cache=Ni;function wd(m){if(typeof m!="function")throw new hi(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function My(m){return yd(2,m)}var Oy=Ug(function(m,y){y=y.length==1&&Bt(y[0])?qn(y[0],ui(Tt())):qn(un(y,1),ui(Tt()));var j=y.length;return Wt(function(O){for(var H=-1,se=rr(O.length,j);++H<se;)O[H]=y[H].call(this,O[H]);return Hr(m,this,O)})}),im=Wt(function(m,y){var j=Mr(y,Ol(im));return cs(m,$,t,y,j)}),eh=Wt(function(m,y){var j=Mr(y,Ol(eh));return cs(m,L,t,y,j)}),Ly=Zn(function(m,y){return cs(m,B,t,t,t,y)});function Fy(m,y){if(typeof m!="function")throw new hi(l);return y=y===t?y:Gt(y),Wt(m,y)}function mv(m,y){if(typeof m!="function")throw new hi(l);return y=y==null?0:Xn(Gt(y),0),Wt(function(j){var O=j[y],H=Eo(j,0,y);return O&&ni(H,O),Hr(m,this,H)})}function am(m,y,j){var O=!0,H=!0;if(typeof m!="function")throw new hi(l);return sr(j)&&(O="leading"in j?!!j.leading:O,H="trailing"in j?!!j.trailing:H),zo(m,y,{leading:O,maxWait:y,trailing:H})}function sm(m){return Ry(m,1)}function gv(m,y){return im(Xu(y),m)}function yv(){if(!arguments.length)return[];var m=arguments[0];return Bt(m)?m:[m]}function Sd(m){return ai(m,v)}function xv(m,y){return y=typeof y=="function"?y:t,ai(m,v,y)}function $y(m){return ai(m,g|v)}function on(m,y){return y=typeof y=="function"?y:t,ai(m,g|v,y)}function om(m,y){return y==null||fp(m,y,Pr(y))}function Ai(m,y){return m===y||m!==m&&y!==y}var lm=Ml(Bu),zy=Ml(function(m,y){return m>=y}),Qs=bf(function(){return arguments}())?bf:function(m){return dr(m)&&wn.call(m,"callee")&&!dt.call(m,"callee")},Bt=qe.isArray,th=fl?ui(fl):Ci;function Er(m){return m!=null&&$l(m.length)&&!Ra(m)}function yr(m){return dr(m)&&Er(m)}function bv(m){return m===!0||m===!1||dr(m)&&pn(m)==J}var Uo=ff||qv,Uy=hl?ui(hl):Nr;function By(m){return dr(m)&&m.nodeType===1&&!la(m)}function nh(m){if(m==null)return!0;if(Er(m)&&(Bt(m)||typeof m=="string"||typeof m.splice=="function"||Uo(m)||Yc(m)||Qs(m)))return!m.length;var y=Lr(m);if(y==Le||y==ue)return!m.size;if(Hn(m))return!Sf(m).length;for(var j in m)if(wn.call(m,j))return!1;return!0}function $n(m,y){return Al(m,y)}function cm(m,y,j){j=typeof j=="function"?j:t;var O=j?j(m,y):t;return O===t?Al(m,y,t,j):!!O}function Ar(m){if(!dr(m))return!1;var y=pn(m);return y==Q||y==He||typeof m.message=="string"&&typeof m.name=="string"&&!la(m)}function vv(m){return typeof m=="number"&&Iu(m)}function Ra(m){if(!sr(m))return!1;var y=pn(m);return y==Pe||y==Re||y==K||y==xt}function rh(m){return typeof m=="number"&&m==Gt(m)}function $l(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=le}function sr(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function dr(m){return m!=null&&typeof m=="object"}var ih=pl?ui(pl):vf;function um(m,y){return m===y||Vu(m,y,$f(y))}function wv(m,y,j){return j=typeof j=="function"?j:t,Vu(m,y,$f(y),j)}function qy(m){return Hy(m)&&m!=+m}function Sv(m){if(ld(m))throw new Pt(o);return os(m)}function Vy(m){return m===null}function Nv(m){return m==null}function Hy(m){return typeof m=="number"||dr(m)&&pn(m)==_e}function la(m){if(!dr(m)||pn(m)!=Ye)return!1;var y=Te(m);if(y===null)return!0;var j=wn.call(y,"constructor")&&y.constructor;return typeof j=="function"&&j instanceof j&&bl.call(j)==vi}var ah=tf?ui(tf):wf;function dm(m){return rh(m)&&m>=-9007199254740991&&m<=le}var Gy=fc?ui(fc):yp;function sh(m){return typeof m=="string"||!Bt(m)&&dr(m)&&pn(m)==Ae}function yi(m){return typeof m=="symbol"||dr(m)&&pn(m)==ke}var Yc=hc?ui(hc):xp;function Ma(m){return m===t}function fm(m){return dr(m)&&Lr(m)==ve}function Yy(m){return dr(m)&&pn(m)==X}var Wy=Ml(Nf),Nd=Ml(function(m,y){return m<=y});function Yi(m){if(!m)return[];if(Er(m))return sh(m)?di(m):kr(m);if(hr&&m[hr])return sf(m[hr]());var y=Lr(m),j=y==Le?$i:y==ue?gl:Zc;return j(m)}function ps(m){if(!m)return m===0?m:0;if(m=ca(m),m===ne||m===-1/0){var y=m<0?-1:1;return y*oe}return m===m?m:0}function Gt(m){var y=ps(m),j=y%1;return y===y?j?y-j:y:0}function ms(m){return m?Pa(Gt(m),0,de):0}function ca(m){if(typeof m=="number")return m;if(yi(m))return E;if(sr(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=sr(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=Eu(m);var j=Sr.test(m);return j||Zd.test(m)?dl(m.slice(2),j?2:8):_s.test(m)?E:+m}function Qy(m){return ji(m,Fr(m))}function Wc(m){return m?Pa(Gt(m),-9007199254740991,le):m===0?m:0}function An(m){return m==null?"":_i(m)}var Cv=Il(function(m,y){if(Hn(y)||Er(y)){ji(y,Pr(y),m);return}for(var j in y)wn.call(y,j)&&jl(m,j,y[j])}),Jy=Il(function(m,y){ji(y,Fr(y),m)}),oh=Il(function(m,y,j,O){ji(y,Fr(y),m,O)}),_v=Il(function(m,y,j,O){ji(y,Pr(y),m,O)}),jv=Zn(Uu);function kv(m,y){var j=Ui(m);return y==null?j:Fs(j,y)}var Tv=Wt(function(m,y){m=hn(m);var j=-1,O=y.length,H=O>2?y[2]:t;for(H&&gi(y[0],y[1],H)&&(O=1);++j<O;)for(var se=y[j],xe=Fr(se),je=-1,Oe=xe.length;++je<Oe;){var tt=xe[je],rt=m[tt];(rt===t||Ai(rt,So[tt])&&!wn.call(m,tt))&&(m[tt]=se[tt])}return m}),Ky=Wt(function(m){return m.push(t,Mp),Hr(kd,t,m)});function Qc(m,y){return ju(m,Tt(y,3),si)}function Cd(m,y){return ju(m,Tt(y,3),Ec)}function Xy(m,y){return m==null?m:Tc(m,Tt(y,3),Fr)}function Ev(m,y){return m==null?m:Tl(m,Tt(y,3),Fr)}function Jc(m,y){return m&&si(m,Tt(y,3))}function _d(m,y){return m&&Ec(m,Tt(y,3))}function Zy(m){return m==null?[]:To(m,Pr(m))}function lh(m){return m==null?[]:To(m,Fr(m))}function jd(m,y,j){var O=m==null?t:ia(m,y);return O===t?j:O}function hm(m,y){return m!=null&&od(m,y,pp)}function Kc(m,y){return m!=null&&od(m,y,Dg)}var ex=td(function(m,y,j){y!=null&&typeof y.toString!="function"&&(y=Gr.call(y)),m[y]=j},ze(Ue)),tx=td(function(m,y,j){y!=null&&typeof y.toString!="function"&&(y=Gr.call(y)),wn.call(m,y)?m[y].push(j):m[y]=[j]},Tt),Av=Wt(El);function Pr(m){return Er(m)?dp(m):Sf(m)}function Fr(m){return Er(m)?dp(m,!0):Rg(m)}function Pv(m,y){var j={};return y=Tt(y,3),si(m,function(O,H,se){Aa(j,y(O,H,se),O)}),j}function Dv(m,y){var j={};return y=Tt(y,3),si(m,function(O,H,se){Aa(j,H,y(O,H,se))}),j}var Iv=Il(function(m,y,j){Hu(m,y,j)}),kd=Il(function(m,y,j,O){Hu(m,y,j,O)}),ch=Zn(function(m,y){var j={};if(m==null)return j;var O=!1;y=qn(y,function(se){return se=Us(se,m),O||(O=se.length>1),se}),ji(m,Lf(m),j),O&&(j=ai(j,g|b|v,Jg));for(var H=y.length;H--;)Qu(j,y[H]);return j});function pm(m,y){return Xc(m,wd(Tt(y)))}var Rv=Zn(function(m,y){return m==null?{}:Mg(m,y)});function Xc(m,y){if(m==null)return{};var j=qn(Lf(m),function(O){return[O]});return y=Tt(y),_f(m,j,function(O,H){return y(O,H[0])})}function Mv(m,y,j){y=Us(y,m);var O=-1,H=y.length;for(H||(H=1,m=t);++O<H;){var se=m==null?t:m[Dn(y[O])];se===t&&(O=H,se=j),m=Ra(se)?se.call(m):se}return m}function nx(m,y,j){return m==null?m:Pc(m,y,j)}function rx(m,y,j,O){return O=typeof O=="function"?O:t,m==null?m:Pc(m,y,j,O)}var mm=id(Pr),gm=id(Fr);function ym(m,y,j){var O=Bt(m),H=O||Uo(m)||Yc(m);if(y=Tt(y,4),j==null){var se=m&&m.constructor;H?j=O?new se:[]:sr(m)?j=Ra(se)?Ui(Te(m)):{}:j={}}return(H?ei:si)(m,function(xe,je,Oe){return y(j,xe,je,Oe)}),j}function ix(m,y){return m==null?!0:Qu(m,y)}function uh(m,y,j){return m==null?m:kp(m,y,Xu(j))}function Ov(m,y,j,O){return O=typeof O=="function"?O:t,m==null?m:kp(m,y,Xu(j),O)}function Zc(m){return m==null?[]:xc(m,Pr(m))}function xm(m){return m==null?[]:xc(m,Fr(m))}function bm(m,y,j){return j===t&&(j=y,y=t),j!==t&&(j=ca(j),j=j===j?j:0),y!==t&&(y=ca(y),y=y===y?y:0),Pa(ca(m),y,j)}function dh(m,y,j){return y=ps(y),j===t?(j=y,y=0):j=ps(j),m=ca(m),Ig(m,y,j)}function vm(m,y,j){if(j&&typeof j!="boolean"&&gi(m,y,j)&&(y=j=t),j===t&&(typeof y=="boolean"?(j=y,y=t):typeof m=="boolean"&&(j=m,m=t)),m===t&&y===t?(m=0,y=1):(m=ps(m),y===t?(y=m,m=0):y=ps(y)),m>y){var O=m;m=y,y=O}if(j||m%1||y%1){var H=sp();return rr(m+H*(y-m+Ds("1e-"+((H+"").length-1))),y)}return kf(m,y)}var ax=mi(function(m,y,j){return y=y.toLowerCase(),m+(j?fh(y):y)});function fh(m){return x(An(m).toLowerCase())}function Js(m){return m=An(m),m&&m.replace(ao,bc).replace(Fi,"")}function Bo(m,y,j){m=An(m),y=_i(y);var O=m.length;j=j===t?O:Pa(Gt(j),0,O);var H=j;return j-=y.length,j>=0&&m.slice(j,H)==y}function qo(m){return m=An(m),m&&kt.test(m)?m.replace(dn,rf):m}function Td(m){return m=An(m),m&&wr.test(m)?m.replace(En,"\\$&"):m}var Ed=mi(function(m,y,j){return m+(j?"-":"")+y.toLowerCase()}),Vo=mi(function(m,y,j){return m+(j?" ":"")+y.toLowerCase()}),Lv=qi("toLowerCase");function sx(m,y,j){m=An(m),y=Gt(y);var O=y?ii(m):0;if(!y||O>=y)return m;var H=(y-O)/2;return rd(Ms(H),j)+m+rd(Nc(H),j)}function Ad(m,y,j){m=An(m),y=Gt(y);var O=y?ii(m):0;return y&&O<y?m+rd(y-O,j):m}function Fv(m,y,j){m=An(m),y=Gt(y);var O=y?ii(m):0;return y&&O<y?rd(y-O,j)+m:m}function ox(m,y,j){return j||y==null?y=0:y&&(y=+y),Sl(An(m).replace(Jr,""),y||0)}function hh(m,y,j){return(j?gi(m,y,j):y===t)?y=1:y=Gt(y),_p(An(m),y)}function lx(){var m=arguments,y=An(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var $v=mi(function(m,y,j){return m+(j?"_":"")+y.toLowerCase()});function ph(m,y,j){return j&&typeof j!="number"&&gi(m,y,j)&&(y=j=t),j=j===t?de:j>>>0,j?(m=An(m),m&&(typeof y=="string"||y!=null&&!ah(y))&&(y=_i(y),!y&&rs(m))?Eo(di(m),0,j):m.split(y,j)):[]}var mh=mi(function(m,y,j){return m+(j?" ":"")+x(y)});function cx(m,y,j){return m=An(m),j=j==null?0:Pa(Gt(j),0,m.length),y=_i(y),m.slice(j,j+y.length)==y}function Pd(m,y,j){var O=Z.templateSettings;j&&gi(m,y,j)&&(y=t),m=An(m),y=oh({},y,O,Mf);var H=oh({},y.imports,O.imports,Mf),se=Pr(H),xe=xc(H,se),je,Oe,tt=0,rt=y.interpolate||Kl,at="__p += '",pt=fi((y.escape||Kl).source+"|"+rt.source+"|"+(rt===It?Ns:Kl).source+"|"+(y.evaluate||Kl).source+"|$","g"),vt="//# sourceURL="+(wn.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Zi+"]")+`
`;m.replace(pt,function(zt,mn,Nn,Oa,Wi,La){return Nn||(Nn=Oa),at+=m.slice(tt,La).replace(ef,af),mn&&(je=!0,at+=`' +
__e(`+mn+`) +
'`),Wi&&(Oe=!0,at+=`';
`+Wi+`;
__p += '`),Nn&&(at+=`' +
((__t = (`+Nn+`)) == null ? '' : __t) +
'`),tt=La+zt.length,zt}),at+=`';
`;var $t=wn.call(y,"variable")&&y.variable;if(!$t)at=`with (obj) {
`+at+`
}
`;else if(gu.test($t))throw new Pt(d);at=(Oe?at.replace(st,""):at).replace(mt,"$1").replace(Ct,"$1;"),at="function("+($t||"obj")+`) {
`+($t?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(je?", __e = _.escape":"")+(Oe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+at+`return __p
}`;var rn=A(function(){return fn(se,vt+"return "+at).apply(t,xe)});if(rn.source=at,Ar(rn))throw rn;return rn}function wm(m){return An(m).toLowerCase()}function gh(m){return An(m).toUpperCase()}function ux(m,y,j){if(m=An(m),m&&(j||y===t))return Eu(m);if(!m||!(y=_i(y)))return m;var O=di(m),H=di(y),se=bo(O,H),xe=vo(O,H)+1;return Eo(O,se,xe).join("")}function zv(m,y,j){if(m=An(m),m&&(j||y===t))return m.slice(0,wc(m)+1);if(!m||!(y=_i(y)))return m;var O=di(m),H=vo(O,di(y))+1;return Eo(O,0,H).join("")}function yh(m,y,j){if(m=An(m),m&&(j||y===t))return m.replace(Jr,"");if(!m||!(y=_i(y)))return m;var O=di(m),H=bo(O,di(y));return Eo(O,H).join("")}function s(m,y){var j=I,O=F;if(sr(y)){var H="separator"in y?y.separator:H;j="length"in y?Gt(y.length):j,O="omission"in y?_i(y.omission):O}m=An(m);var se=m.length;if(rs(m)){var xe=di(m);se=xe.length}if(j>=se)return m;var je=j-ii(O);if(je<1)return O;var Oe=xe?Eo(xe,0,je).join(""):m.slice(0,je);if(H===t)return Oe+O;if(xe&&(je+=Oe.length-je),ah(H)){if(m.slice(je).search(H)){var tt,rt=Oe;for(H.global||(H=fi(H.source,An(Cs.exec(H))+"g")),H.lastIndex=0;tt=H.exec(rt);)var at=tt.index;Oe=Oe.slice(0,at===t?je:at)}}else if(m.indexOf(_i(H),je)!=je){var pt=Oe.lastIndexOf(H);pt>-1&&(Oe=Oe.slice(0,pt))}return Oe+O}function c(m){return m=An(m),m&&vn.test(m)?m.replace(ln,cf):m}var p=mi(function(m,y,j){return m+(j?" ":"")+y.toUpperCase()}),x=qi("toUpperCase");function N(m,y,j){return m=An(m),y=j?t:y,y===t?ml(m)?rp(m):tp(m):m.match(y)||[]}var A=Wt(function(m,y){try{return Hr(m,t,y)}catch(j){return Ar(j)?j:new Pt(j)}}),q=Zn(function(m,y){return ei(y,function(j){j=Dn(j),Aa(m,j,$o(m[j],m))}),m});function ee(m){var y=m==null?0:m.length,j=Tt();return m=y?qn(m,function(O){if(typeof O[1]!="function")throw new hi(l);return[j(O[0]),O[1]]}):[],Wt(function(O){for(var H=-1;++H<y;){var se=m[H];if(Hr(se[0],this,O))return Hr(se[1],this,O)}})}function we(m){return Ag(ai(m,g))}function ze(m){return function(){return m}}function Xe(m,y){return m==null||m!==m?y:m}var nt=ls(),Be=ls(!0);function Ue(m){return m}function Mt(m){return bp(typeof m=="function"?m:ai(m,g))}function Rt(m){return wp(ai(m,g))}function zn(m,y){return Cf(m,ai(y,g))}var Me=Wt(function(m,y){return function(j){return El(j,m,y)}}),Ee=Wt(function(m,y){return function(j){return El(m,j,y)}});function $e(m,y,j){var O=Pr(y),H=To(y,O);j==null&&!(sr(y)&&(H.length||!O.length))&&(j=y,y=m,m=this,H=To(y,Pr(y)));var se=!(sr(j)&&"chain"in j)||!!j.chain,xe=Ra(m);return ei(H,function(je){var Oe=y[je];m[je]=Oe,xe&&(m.prototype[je]=function(){var tt=this.__chain__;if(se||tt){var rt=m(this.__wrapped__),at=rt.__actions__=kr(this.__actions__);return at.push({func:Oe,args:arguments,thisArg:m}),rt.__chain__=tt,rt}return Oe.apply(m,ni([this.value()],arguments))})}),m}function Ze(){return tr._===this&&(tr._=Rs),this}function gt(){}function nn(m){return m=Gt(m),Wt(function(y){return Sp(y,m)})}var St=nd(qn),Ot=nd(mc),$r=nd(ho);function Sn(m){return Uf(m)?_a(Dn(m)):Og(m)}function Ho(m){return function(y){return m==null?t:ia(m,y)}}var Uv=Ao(),HA=Ao(!0);function Bv(){return[]}function qv(){return!1}function GA(){return{}}function YA(){return""}function WA(){return!0}function QA(m,y){if(m=Gt(m),m<1||m>le)return[];var j=de,O=rr(m,de);y=Tt(y),m-=de;for(var H=ka(O,y);++j<m;)y(j);return H}function JA(m){return Bt(m)?qn(m,Dn):yi(m)?[m]:kr(ds(An(m)))}function KA(m){var y=++zi;return An(m)+y}var XA=Dc(function(m,y){return m+y},0),ZA=Rf("ceil"),eP=Dc(function(m,y){return m/y},1),tP=Rf("floor");function nP(m){return m&&m.length?Da(m,Ue,Bu):t}function rP(m,y){return m&&m.length?Da(m,Tt(y,2),Bu):t}function iP(m){return ku(m,Ue)}function aP(m,y){return ku(m,Tt(y,2))}function sP(m){return m&&m.length?Da(m,Ue,Nf):t}function oP(m,y){return m&&m.length?Da(m,Tt(y,2),Nf):t}var lP=Dc(function(m,y){return m*y},1),cP=Rf("round"),uP=Dc(function(m,y){return m-y},0);function dP(m){return m&&m.length?yo(m,Ue):0}function fP(m,y){return m&&m.length?yo(m,Tt(y,2)):0}return Z.after=hv,Z.ary=Ry,Z.assign=Cv,Z.assignIn=Jy,Z.assignInWith=oh,Z.assignWith=_v,Z.at=jv,Z.before=yd,Z.bind=$o,Z.bindAll=q,Z.bindKey=Xf,Z.castArray=yv,Z.chain=Vc,Z.chunk=sv,Z.compact=oy,Z.concat=ly,Z.cond=ee,Z.conforms=we,Z.constant=ze,Z.countBy=Hc,Z.create=kv,Z.curry=xd,Z.curryRight=Zf,Z.debounce=zo,Z.defaults=Tv,Z.defaultsDeep=Ky,Z.defer=hs,Z.delay=bd,Z.difference=ar,Z.differenceBy=ki,Z.differenceWith=Gs,Z.drop=cy,Z.dropRight=uy,Z.dropRightWhile=ov,Z.dropWhile=Up,Z.fill=Vi,Z.filter=Sy,Z.flatMap=tm,Z.flatMapDeep=uv,Z.flatMapDepth=dv,Z.flatten=Ti,Z.flattenDeep=dy,Z.flattenDepth=Io,Z.flip=pv,Z.flow=nt,Z.flowRight=Be,Z.fromPairs=Ll,Z.functions=Zy,Z.functionsIn=lh,Z.groupBy=_y,Z.initial=Vp,Z.intersection=fs,Z.intersectionBy=fy,Z.intersectionWith=Oc,Z.invert=ex,Z.invertBy=tx,Z.invokeMap=Qf,Z.iteratee=Mt,Z.keyBy=jy,Z.keys=Pr,Z.keysIn=Fr,Z.map=gd,Z.mapKeys=Pv,Z.mapValues=Dv,Z.matches=Rt,Z.matchesProperty=zn,Z.memoize=vd,Z.merge=Iv,Z.mergeWith=kd,Z.method=Me,Z.methodOf=Ee,Z.mixin=$e,Z.negate=wd,Z.nthArg=nn,Z.omit=ch,Z.omitBy=pm,Z.once=My,Z.orderBy=ky,Z.over=St,Z.overArgs=Oy,Z.overEvery=Ot,Z.overSome=$r,Z.partial=im,Z.partialRight=eh,Z.partition=Ty,Z.pick=Rv,Z.pickBy=Xc,Z.property=Sn,Z.propertyOf=Ho,Z.pull=py,Z.pullAll=Fc,Z.pullAllBy=my,Z.pullAllWith=Yf,Z.pullAt=gy,Z.range=Uv,Z.rangeRight=HA,Z.rearg=Ly,Z.reject=Jf,Z.remove=lv,Z.rest=Fy,Z.reverse=Hp,Z.sampleSize=Dy,Z.set=nx,Z.setWith=rx,Z.shuffle=Gn,Z.slice=Rn,Z.sortBy=Iy,Z.sortedUniq=$c,Z.sortedUniqBy=Gp,Z.split=ph,Z.spread=mv,Z.tail=Ws,Z.take=gr,Z.takeRight=Mo,Z.takeRightWhile=Fl,Z.takeWhile=Yp,Z.tap=Xp,Z.throttle=am,Z.thru=li,Z.toArray=Yi,Z.toPairs=mm,Z.toPairsIn=gm,Z.toPath=JA,Z.toPlainObject=Qy,Z.transform=ym,Z.unary=sm,Z.union=oa,Z.unionBy=zc,Z.unionWith=pd,Z.uniq=Ei,Z.uniqBy=Wp,Z.uniqWith=Qp,Z.unset=ix,Z.unzip=Uc,Z.unzipWith=md,Z.update=uh,Z.updateWith=Ov,Z.values=Zc,Z.valuesIn=xm,Z.without=Oo,Z.words=N,Z.wrap=gv,Z.xor=Yr,Z.xorBy=Lo,Z.xorWith=Bc,Z.zip=qc,Z.zipObject=Jp,Z.zipObjectDeep=Kp,Z.zipWith=yy,Z.entries=mm,Z.entriesIn=gm,Z.extend=Jy,Z.extendWith=oh,$e(Z,Z),Z.add=XA,Z.attempt=A,Z.camelCase=ax,Z.capitalize=fh,Z.ceil=ZA,Z.clamp=bm,Z.clone=Sd,Z.cloneDeep=$y,Z.cloneDeepWith=on,Z.cloneWith=xv,Z.conformsTo=om,Z.deburr=Js,Z.defaultTo=Xe,Z.divide=eP,Z.endsWith=Bo,Z.eq=Ai,Z.escape=qo,Z.escapeRegExp=Td,Z.every=wy,Z.find=Ny,Z.findIndex=sa,Z.findKey=Qc,Z.findLast=em,Z.findLastIndex=Bp,Z.findLastKey=Cd,Z.floor=tP,Z.forEach=Cy,Z.forEachRight=nm,Z.forIn=Xy,Z.forInRight=Ev,Z.forOwn=Jc,Z.forOwnRight=_d,Z.get=jd,Z.gt=lm,Z.gte=zy,Z.has=hm,Z.hasIn=Kc,Z.head=Ys,Z.identity=Ue,Z.includes=Gc,Z.indexOf=qp,Z.inRange=dh,Z.invoke=Av,Z.isArguments=Qs,Z.isArray=Bt,Z.isArrayBuffer=th,Z.isArrayLike=Er,Z.isArrayLikeObject=yr,Z.isBoolean=bv,Z.isBuffer=Uo,Z.isDate=Uy,Z.isElement=By,Z.isEmpty=nh,Z.isEqual=$n,Z.isEqualWith=cm,Z.isError=Ar,Z.isFinite=vv,Z.isFunction=Ra,Z.isInteger=rh,Z.isLength=$l,Z.isMap=ih,Z.isMatch=um,Z.isMatchWith=wv,Z.isNaN=qy,Z.isNative=Sv,Z.isNil=Nv,Z.isNull=Vy,Z.isNumber=Hy,Z.isObject=sr,Z.isObjectLike=dr,Z.isPlainObject=la,Z.isRegExp=ah,Z.isSafeInteger=dm,Z.isSet=Gy,Z.isString=sh,Z.isSymbol=yi,Z.isTypedArray=Yc,Z.isUndefined=Ma,Z.isWeakMap=fm,Z.isWeakSet=Yy,Z.join=hd,Z.kebabCase=Ed,Z.last=oi,Z.lastIndexOf=Lc,Z.lowerCase=Vo,Z.lowerFirst=Lv,Z.lt=Wy,Z.lte=Nd,Z.max=nP,Z.maxBy=rP,Z.mean=iP,Z.meanBy=aP,Z.min=sP,Z.minBy=oP,Z.stubArray=Bv,Z.stubFalse=qv,Z.stubObject=GA,Z.stubString=YA,Z.stubTrue=WA,Z.multiply=lP,Z.nth=hy,Z.noConflict=Ze,Z.noop=gt,Z.now=Kf,Z.pad=sx,Z.padEnd=Ad,Z.padStart=Fv,Z.parseInt=ox,Z.random=vm,Z.reduce=Ey,Z.reduceRight=Ay,Z.repeat=hh,Z.replace=lx,Z.result=Mv,Z.round=cP,Z.runInContext=De,Z.sample=Py,Z.size=rm,Z.snakeCase=$v,Z.some=fv,Z.sortedIndex=Wn,Z.sortedIndexBy=sn,Z.sortedIndexOf=xn,Z.sortedLastIndex=Mn,Z.sortedLastIndexBy=Hi,Z.sortedLastIndexOf=Ro,Z.startCase=mh,Z.startsWith=cx,Z.subtract=uP,Z.sum=dP,Z.sumBy=fP,Z.template=Pd,Z.times=QA,Z.toFinite=ps,Z.toInteger=Gt,Z.toLength=ms,Z.toLower=wm,Z.toNumber=ca,Z.toSafeInteger=Wc,Z.toString=An,Z.toUpper=gh,Z.trim=ux,Z.trimEnd=zv,Z.trimStart=yh,Z.truncate=s,Z.unescape=c,Z.uniqueId=KA,Z.upperCase=p,Z.upperFirst=x,Z.each=Cy,Z.eachRight=nm,Z.first=Ys,$e(Z,function(){var m={};return si(Z,function(y,j){wn.call(Z.prototype,j)||(m[j]=y)}),m}(),{chain:!1}),Z.VERSION=r,ei(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){Z[m].placeholder=Z}),ei(["drop","take"],function(m,y){tn.prototype[m]=function(j){j=j===t?1:Xn(Gt(j),0);var O=this.__filtered__&&!y?new tn(this):this.clone();return O.__filtered__?O.__takeCount__=rr(j,O.__takeCount__):O.__views__.push({size:rr(j,de),type:m+(O.__dir__<0?"Right":"")}),O},tn.prototype[m+"Right"]=function(j){return this.reverse()[m](j).reverse()}}),ei(["filter","map","takeWhile"],function(m,y){var j=y+1,O=j==ie||j==Y;tn.prototype[m]=function(H){var se=this.clone();return se.__iteratees__.push({iteratee:Tt(H,3),type:j}),se.__filtered__=se.__filtered__||O,se}}),ei(["head","last"],function(m,y){var j="take"+(y?"Right":"");tn.prototype[m]=function(){return this[j](1).value()[0]}}),ei(["initial","tail"],function(m,y){var j="drop"+(y?"":"Right");tn.prototype[m]=function(){return this.__filtered__?new tn(this):this[j](1)}}),tn.prototype.compact=function(){return this.filter(Ue)},tn.prototype.find=function(m){return this.filter(m).head()},tn.prototype.findLast=function(m){return this.reverse().find(m)},tn.prototype.invokeMap=Wt(function(m,y){return typeof m=="function"?new tn(this):this.map(function(j){return El(j,m,y)})}),tn.prototype.reject=function(m){return this.filter(wd(Tt(m)))},tn.prototype.slice=function(m,y){m=Gt(m);var j=this;return j.__filtered__&&(m>0||y<0)?new tn(j):(m<0?j=j.takeRight(-m):m&&(j=j.drop(m)),y!==t&&(y=Gt(y),j=y<0?j.dropRight(-y):j.take(y-m)),j)},tn.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},tn.prototype.toArray=function(){return this.take(de)},si(tn.prototype,function(m,y){var j=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),H=Z[O?"take"+(y=="last"?"Right":""):y],se=O||/^find/.test(y);H&&(Z.prototype[y]=function(){var xe=this.__wrapped__,je=O?[1]:arguments,Oe=xe instanceof tn,tt=je[0],rt=Oe||Bt(xe),at=function(mn){var Nn=H.apply(Z,ni([mn],je));return O&&pt?Nn[0]:Nn};rt&&j&&typeof tt=="function"&&tt.length!=1&&(Oe=rt=!1);var pt=this.__chain__,vt=!!this.__actions__.length,$t=se&&!pt,rn=Oe&&!vt;if(!se&&rt){xe=rn?xe:new tn(this);var zt=m.apply(xe,je);return zt.__actions__.push({func:li,args:[at],thisArg:t}),new Si(zt,pt)}return $t&&rn?m.apply(this,je):(zt=this.thru(at),$t?O?zt.value()[0]:zt.value():zt)})}),ei(["pop","push","shift","sort","splice","unshift"],function(m){var y=yl[m],j=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);Z.prototype[m]=function(){var H=arguments;if(O&&!this.__chain__){var se=this.value();return y.apply(Bt(se)?se:[],H)}return this[j](function(xe){return y.apply(Bt(xe)?xe:[],H)})}}),si(tn.prototype,function(m,y){var j=Z[y];if(j){var O=j.name+"";wn.call(na,O)||(na[O]=[]),na[O].push({name:y,func:j})}}),na[mr(t,P).name]=[{name:"wrapper",func:t}],tn.prototype.clone=Lu,tn.prototype.reverse=hf,tn.prototype.value=Cl,Z.prototype.at=xy,Z.prototype.chain=Gi,Z.prototype.commit=by,Z.prototype.next=vy,Z.prototype.plant=Fo,Z.prototype.reverse=Wf,Z.prototype.toJSON=Z.prototype.valueOf=Z.prototype.value=Zp,Z.prototype.first=Z.prototype.head,hr&&(Z.prototype[hr]=cv),Z},is=wo();Ca?((Ca.exports=is)._=is,Za._=is):tr._=is}).call(bH)}(zm,zm.exports)),zm.exports}var zT=vH();class wH{constructor(n){Qn(this,"sampleRate",24e3);Qn(this,"bufferSize",7680);Qn(this,"audioQueue",[]);Qn(this,"isPlaying",!1);Qn(this,"isStreamComplete",!1);Qn(this,"checkInterval",null);Qn(this,"scheduledTime",0);Qn(this,"initialBufferTime",.1);Qn(this,"gainNode");Qn(this,"source");Qn(this,"endOfQueueAudioSource",null);Qn(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=Cx.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(Cx.set(this.context,{}),a=Cx.get(this.context)),a[n]={handlers:[r]};const o=$1(n,t);await this.context.audioWorklet.addModule(o);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const o=r.getInt16(a*2,!0);t[a]=o/32768}catch(o){console.error(o)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const o=Cx.get(this.context);o&&Object.entries(o).forEach(([,d])=>{const{node:f,handlers:u}=d;f&&(a.connect(f),f.port.onmessage=function(h){u.forEach(g=>{g.call(f.port,h)})},f.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function UT(e,n){return function(){return e.apply(n,arguments)}}const{toString:SH}=Object.prototype,{getPrototypeOf:eS}=Object,qb=(e=>n=>{const t=SH.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),io=e=>(e=e.toLowerCase(),n=>qb(n)===e),Vb=e=>n=>typeof n===e,{isArray:Jh}=Array,ng=Vb("undefined");function NH(e){return e!==null&&!ng(e)&&e.constructor!==null&&!ng(e.constructor)&&Ha(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const BT=io("ArrayBuffer");function CH(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&BT(e.buffer),n}const _H=Vb("string"),Ha=Vb("function"),qT=Vb("number"),Hb=e=>e!==null&&typeof e=="object",jH=e=>e===!0||e===!1,Hx=e=>{if(qb(e)!=="object")return!1;const n=eS(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},kH=io("Date"),TH=io("File"),EH=io("Blob"),AH=io("FileList"),PH=e=>Hb(e)&&Ha(e.pipe),DH=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Ha(e.append)&&((n=qb(e))==="formdata"||n==="object"&&Ha(e.toString)&&e.toString()==="[object FormData]"))},IH=io("URLSearchParams"),[RH,MH,OH,LH]=["ReadableStream","Request","Response","Headers"].map(io),FH=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pg(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),Jh(e))for(r=0,a=e.length;r<a;r++)n.call(null,e[r],r,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let d;for(r=0;r<l;r++)d=o[r],n.call(null,e[d],d,e)}}function VT(e,n){n=n.toLowerCase();const t=Object.keys(e);let r=t.length,a;for(;r-- >0;)if(a=t[r],n===a.toLowerCase())return a;return null}const Od=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,HT=e=>!ng(e)&&e!==Od;function z1(){const{caseless:e}=HT(this)&&this||{},n={},t=(r,a)=>{const o=e&&VT(n,a)||a;Hx(n[o])&&Hx(r)?n[o]=z1(n[o],r):Hx(r)?n[o]=z1({},r):Jh(r)?n[o]=r.slice():n[o]=r};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&pg(arguments[r],t);return n}const $H=(e,n,t,{allOwnKeys:r}={})=>(pg(n,(a,o)=>{t&&Ha(a)?e[o]=UT(a,t):e[o]=a},{allOwnKeys:r}),e),zH=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),UH=(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},BH=(e,n,t,r)=>{let a,o,l;const d={};if(n=n||{},e==null)return n;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)l=a[o],(!r||r(l,e,n))&&!d[l]&&(n[l]=e[l],d[l]=!0);e=t!==!1&&eS(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},qH=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const r=e.indexOf(n,t);return r!==-1&&r===t},VH=e=>{if(!e)return null;if(Jh(e))return e;let n=e.length;if(!qT(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},HH=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&eS(Uint8Array)),GH=(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=r.next())&&!a.done;){const o=a.value;n.call(e,o[0],o[1])}},YH=(e,n)=>{let t;const r=[];for(;(t=e.exec(n))!==null;)r.push(t);return r},WH=io("HTMLFormElement"),QH=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,a){return r.toUpperCase()+a}),b_=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),JH=io("RegExp"),GT=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};pg(t,(a,o)=>{let l;(l=n(a,o,e))!==!1&&(r[o]=l||a)}),Object.defineProperties(e,r)},KH=e=>{GT(e,(n,t)=>{if(Ha(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if(Ha(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},XH=(e,n)=>{const t={},r=a=>{a.forEach(o=>{t[o]=!0})};return Jh(e)?r(e):r(String(e).split(n)),t},ZH=()=>{},eG=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function tG(e){return!!(e&&Ha(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const nG=e=>{const n=new Array(10),t=(r,a)=>{if(Hb(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[a]=r;const o=Jh(r)?[]:{};return pg(r,(l,d)=>{const f=t(l,a+1);!ng(f)&&(o[d]=f)}),n[a]=void 0,o}}return r};return t(e,0)},rG=io("AsyncFunction"),iG=e=>e&&(Hb(e)||Ha(e))&&Ha(e.then)&&Ha(e.catch),YT=((e,n)=>e?setImmediate:n?((t,r)=>(Od.addEventListener("message",({source:a,data:o})=>{a===Od&&o===t&&r.length&&r.shift()()},!1),a=>{r.push(a),Od.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Ha(Od.postMessage)),aG=typeof queueMicrotask<"u"?queueMicrotask.bind(Od):typeof process<"u"&&process.nextTick||YT,We={isArray:Jh,isArrayBuffer:BT,isBuffer:NH,isFormData:DH,isArrayBufferView:CH,isString:_H,isNumber:qT,isBoolean:jH,isObject:Hb,isPlainObject:Hx,isReadableStream:RH,isRequest:MH,isResponse:OH,isHeaders:LH,isUndefined:ng,isDate:kH,isFile:TH,isBlob:EH,isRegExp:JH,isFunction:Ha,isStream:PH,isURLSearchParams:IH,isTypedArray:HH,isFileList:AH,forEach:pg,merge:z1,extend:$H,trim:FH,stripBOM:zH,inherits:UH,toFlatObject:BH,kindOf:qb,kindOfTest:io,endsWith:qH,toArray:VH,forEachEntry:GH,matchAll:YH,isHTMLForm:WH,hasOwnProperty:b_,hasOwnProp:b_,reduceDescriptors:GT,freezeMethods:KH,toObjectSet:XH,toCamelCase:QH,noop:ZH,toFiniteNumber:eG,findKey:VT,global:Od,isContextDefined:HT,isSpecCompliantForm:tG,toJSONObject:nG,isAsyncFn:rG,isThenable:iG,setImmediate:YT,asap:aG};function Jt(e,n,t,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}We.inherits(Jt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:We.toJSONObject(this.config),code:this.code,status:this.status}}});const WT=Jt.prototype,QT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{QT[e]={value:e}});Object.defineProperties(Jt,QT);Object.defineProperty(WT,"isAxiosError",{value:!0});Jt.from=(e,n,t,r,a,o)=>{const l=Object.create(WT);return We.toFlatObject(e,l,function(f){return f!==Error.prototype},d=>d!=="isAxiosError"),Jt.call(l,e.message,n,t,r,a),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const sG=null;function U1(e){return We.isPlainObject(e)||We.isArray(e)}function JT(e){return We.endsWith(e,"[]")?e.slice(0,-2):e}function v_(e,n,t){return e?e.concat(n).map(function(a,o){return a=JT(a),!t&&o?"["+a+"]":a}).join(t?".":""):n}function oG(e){return We.isArray(e)&&!e.some(U1)}const lG=We.toFlatObject(We,{},null,function(n){return/^is[A-Z]/.test(n)});function Gb(e,n,t){if(!We.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=We.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,T){return!We.isUndefined(T[k])});const r=t.metaTokens,a=t.visitor||h,o=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&We.isSpecCompliantForm(n);if(!We.isFunction(a))throw new TypeError("visitor must be a function");function u(S){if(S===null)return"";if(We.isDate(S))return S.toISOString();if(!f&&We.isBlob(S))throw new Jt("Blob is not supported. Use a Buffer instead.");return We.isArrayBuffer(S)||We.isTypedArray(S)?f&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function h(S,k,T){let P=S;if(S&&!T&&typeof S=="object"){if(We.endsWith(k,"{}"))k=r?k:k.slice(0,-2),S=JSON.stringify(S);else if(We.isArray(S)&&oG(S)||(We.isFileList(S)||We.endsWith(k,"[]"))&&(P=We.toArray(S)))return k=JT(k),P.forEach(function(R,z){!(We.isUndefined(R)||R===null)&&n.append(l===!0?v_([k],z,o):l===null?k:k+"[]",u(R))}),!1}return U1(S)?!0:(n.append(v_(T,k,o),u(S)),!1)}const g=[],b=Object.assign(lG,{defaultVisitor:h,convertValue:u,isVisitable:U1});function v(S,k){if(!We.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+k.join("."));g.push(S),We.forEach(S,function(P,M){(!(We.isUndefined(P)||P===null)&&a.call(n,P,We.isString(M)?M.trim():M,k,b))===!0&&v(P,k?k.concat(M):[M])}),g.pop()}}if(!We.isObject(e))throw new TypeError("data must be an object");return v(e),n}function w_(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function tS(e,n){this._pairs=[],e&&Gb(e,this,n)}const KT=tS.prototype;KT.append=function(n,t){this._pairs.push([n,t])};KT.toString=function(n){const t=n?function(r){return n.call(this,r,w_)}:w_;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function cG(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function XT(e,n,t){if(!n)return e;const r=t&&t.encode||cG;We.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let o;if(a?o=a(n,t):o=We.isURLSearchParams(n)?n.toString():new tS(n,t).toString(r),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class S_{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){We.forEach(this.handlers,function(r){r!==null&&n(r)})}}const ZT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},uG=typeof URLSearchParams<"u"?URLSearchParams:tS,dG=typeof FormData<"u"?FormData:null,fG=typeof Blob<"u"?Blob:null,hG={isBrowser:!0,classes:{URLSearchParams:uG,FormData:dG,Blob:fG},protocols:["http","https","file","blob","url","data"]},nS=typeof window<"u"&&typeof document<"u",B1=typeof navigator=="object"&&navigator||void 0,pG=nS&&(!B1||["ReactNative","NativeScript","NS"].indexOf(B1.product)<0),mG=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",gG=nS&&window.location.href||"http://localhost",yG=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:nS,hasStandardBrowserEnv:pG,hasStandardBrowserWebWorkerEnv:mG,navigator:B1,origin:gG},Symbol.toStringTag,{value:"Module"})),Ri={...yG,...hG};function xG(e,n){return Gb(e,new Ri.classes.URLSearchParams,Object.assign({visitor:function(t,r,a,o){return Ri.isNode&&We.isBuffer(t)?(this.append(r,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function bG(e){return We.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function vG(e){const n={},t=Object.keys(e);let r;const a=t.length;let o;for(r=0;r<a;r++)o=t[r],n[o]=e[o];return n}function eE(e){function n(t,r,a,o){let l=t[o++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),f=o>=t.length;return l=!l&&We.isArray(a)?a.length:l,f?(We.hasOwnProp(a,l)?a[l]=[a[l],r]:a[l]=r,!d):((!a[l]||!We.isObject(a[l]))&&(a[l]=[]),n(t,r,a[l],o)&&We.isArray(a[l])&&(a[l]=vG(a[l])),!d)}if(We.isFormData(e)&&We.isFunction(e.entries)){const t={};return We.forEachEntry(e,(r,a)=>{n(bG(r),a,t,0)}),t}return null}function wG(e,n,t){if(We.isString(e))try{return(n||JSON.parse)(e),We.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const mg={transitional:ZT,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const r=t.getContentType()||"",a=r.indexOf("application/json")>-1,o=We.isObject(n);if(o&&We.isHTMLForm(n)&&(n=new FormData(n)),We.isFormData(n))return a?JSON.stringify(eE(n)):n;if(We.isArrayBuffer(n)||We.isBuffer(n)||We.isStream(n)||We.isFile(n)||We.isBlob(n)||We.isReadableStream(n))return n;if(We.isArrayBufferView(n))return n.buffer;if(We.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return xG(n,this.formSerializer).toString();if((d=We.isFileList(n))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Gb(d?{"files[]":n}:n,f&&new f,this.formSerializer)}}return o||a?(t.setContentType("application/json",!1),wG(n)):n}],transformResponse:[function(n){const t=this.transitional||mg.transitional,r=t&&t.forcedJSONParsing,a=this.responseType==="json";if(We.isResponse(n)||We.isReadableStream(n))return n;if(n&&We.isString(n)&&(r&&!this.responseType||a)){const l=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(n)}catch(d){if(l)throw d.name==="SyntaxError"?Jt.from(d,Jt.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ri.classes.FormData,Blob:Ri.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};We.forEach(["delete","get","head","post","put","patch"],e=>{mg.headers[e]={}});const SG=We.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),NG=e=>{const n={};let t,r,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),t=l.substring(0,a).trim().toLowerCase(),r=l.substring(a+1).trim(),!(!t||n[t]&&SG[t])&&(t==="set-cookie"?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n},N_=Symbol("internals");function Dm(e){return e&&String(e).trim().toLowerCase()}function Gx(e){return e===!1||e==null?e:We.isArray(e)?e.map(Gx):String(e)}function CG(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}const _G=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function P0(e,n,t,r,a){if(We.isFunction(r))return r.call(this,n,t);if(a&&(n=t),!!We.isString(n)){if(We.isString(r))return n.indexOf(r)!==-1;if(We.isRegExp(r))return r.test(n)}}function jG(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}function kG(e,n){const t=We.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(a,o,l){return this[r].call(this,n,a,o,l)},configurable:!0})})}let ha=class{constructor(n){n&&this.set(n)}set(n,t,r){const a=this;function o(d,f,u){const h=Dm(f);if(!h)throw new Error("header name must be a non-empty string");const g=We.findKey(a,h);(!g||a[g]===void 0||u===!0||u===void 0&&a[g]!==!1)&&(a[g||f]=Gx(d))}const l=(d,f)=>We.forEach(d,(u,h)=>o(u,h,f));if(We.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(We.isString(n)&&(n=n.trim())&&!_G(n))l(NG(n),t);else if(We.isHeaders(n))for(const[d,f]of n.entries())o(f,d,r);else n!=null&&o(t,n,r);return this}get(n,t){if(n=Dm(n),n){const r=We.findKey(this,n);if(r){const a=this[r];if(!t)return a;if(t===!0)return CG(a);if(We.isFunction(t))return t.call(this,a,r);if(We.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=Dm(n),n){const r=We.findKey(this,n);return!!(r&&this[r]!==void 0&&(!t||P0(this,this[r],r,t)))}return!1}delete(n,t){const r=this;let a=!1;function o(l){if(l=Dm(l),l){const d=We.findKey(r,l);d&&(!t||P0(r,r[d],d,t))&&(delete r[d],a=!0)}}return We.isArray(n)?n.forEach(o):o(n),a}clear(n){const t=Object.keys(this);let r=t.length,a=!1;for(;r--;){const o=t[r];(!n||P0(this,this[o],o,n,!0))&&(delete this[o],a=!0)}return a}normalize(n){const t=this,r={};return We.forEach(this,(a,o)=>{const l=We.findKey(r,o);if(l){t[l]=Gx(a),delete t[o];return}const d=n?jG(o):String(o).trim();d!==o&&delete t[o],t[d]=Gx(a),r[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return We.forEach(this,(r,a)=>{r!=null&&r!==!1&&(t[a]=n&&We.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(a=>r.set(a)),r}static accessor(n){const r=(this[N_]=this[N_]={accessors:{}}).accessors,a=this.prototype;function o(l){const d=Dm(l);r[d]||(kG(a,l),r[d]=!0)}return We.isArray(n)?n.forEach(o):o(n),this}};ha.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);We.reduceDescriptors(ha.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[t]=r}}});We.freezeMethods(ha);function D0(e,n){const t=this||mg,r=n||t,a=ha.from(r.headers);let o=r.data;return We.forEach(e,function(d){o=d.call(t,o,a.normalize(),n?n.status:void 0)}),a.normalize(),o}function tE(e){return!!(e&&e.__CANCEL__)}function Kh(e,n,t){Jt.call(this,e??"canceled",Jt.ERR_CANCELED,n,t),this.name="CanceledError"}We.inherits(Kh,Jt,{__CANCEL__:!0});function nE(e,n,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):n(new Jt("Request failed with status code "+t.status,[Jt.ERR_BAD_REQUEST,Jt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function TG(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function EG(e,n){e=e||10;const t=new Array(e),r=new Array(e);let a=0,o=0,l;return n=n!==void 0?n:1e3,function(f){const u=Date.now(),h=r[o];l||(l=u),t[a]=f,r[a]=u;let g=o,b=0;for(;g!==a;)b+=t[g++],g=g%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),u-l<n)return;const v=h&&u-h;return v?Math.round(b*1e3/v):void 0}}function AG(e,n){let t=0,r=1e3/n,a,o;const l=(u,h=Date.now())=>{t=h,a=null,o&&(clearTimeout(o),o=null),e.apply(null,u)};return[(...u)=>{const h=Date.now(),g=h-t;g>=r?l(u,h):(a=u,o||(o=setTimeout(()=>{o=null,l(a)},r-g)))},()=>a&&l(a)]}const fb=(e,n,t=3)=>{let r=0;const a=EG(50,250);return AG(o=>{const l=o.loaded,d=o.lengthComputable?o.total:void 0,f=l-r,u=a(f),h=l<=d;r=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:u||void 0,estimated:u&&d&&h?(d-l)/u:void 0,event:o,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(g)},t)},C_=(e,n)=>{const t=e!=null;return[r=>n[0]({lengthComputable:t,total:e,loaded:r}),n[1]]},__=e=>(...n)=>We.asap(()=>e(...n)),PG=Ri.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,Ri.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(Ri.origin),Ri.navigator&&/(msie|trident)/i.test(Ri.navigator.userAgent)):()=>!0,DG=Ri.hasStandardBrowserEnv?{write(e,n,t,r,a,o){const l=[e+"="+encodeURIComponent(n)];We.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),We.isString(r)&&l.push("path="+r),We.isString(a)&&l.push("domain="+a),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function IG(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function RG(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function rE(e,n,t){let r=!IG(n);return e&&(r||t==!1)?RG(e,n):n}const j_=e=>e instanceof ha?{...e}:e;function qd(e,n){n=n||{};const t={};function r(u,h,g,b){return We.isPlainObject(u)&&We.isPlainObject(h)?We.merge.call({caseless:b},u,h):We.isPlainObject(h)?We.merge({},h):We.isArray(h)?h.slice():h}function a(u,h,g,b){if(We.isUndefined(h)){if(!We.isUndefined(u))return r(void 0,u,g,b)}else return r(u,h,g,b)}function o(u,h){if(!We.isUndefined(h))return r(void 0,h)}function l(u,h){if(We.isUndefined(h)){if(!We.isUndefined(u))return r(void 0,u)}else return r(void 0,h)}function d(u,h,g){if(g in n)return r(u,h);if(g in e)return r(void 0,u)}const f={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(u,h,g)=>a(j_(u),j_(h),g,!0)};return We.forEach(Object.keys(Object.assign({},e,n)),function(h){const g=f[h]||a,b=g(e[h],n[h],h);We.isUndefined(b)&&g!==d||(t[h]=b)}),t}const iE=e=>{const n=qd({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:o,headers:l,auth:d}=n;n.headers=l=ha.from(l),n.url=XT(rE(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let f;if(We.isFormData(t)){if(Ri.hasStandardBrowserEnv||Ri.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((f=l.getContentType())!==!1){const[u,...h]=f?f.split(";").map(g=>g.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...h].join("; "))}}if(Ri.hasStandardBrowserEnv&&(r&&We.isFunction(r)&&(r=r(n)),r||r!==!1&&PG(n.url))){const u=a&&o&&DG.read(o);u&&l.set(a,u)}return n},MG=typeof XMLHttpRequest<"u",OG=MG&&function(e){return new Promise(function(t,r){const a=iE(e);let o=a.data;const l=ha.from(a.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:u}=a,h,g,b,v,S;function k(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let T=new XMLHttpRequest;T.open(a.method.toUpperCase(),a.url,!0),T.timeout=a.timeout;function P(){if(!T)return;const R=ha.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),$={data:!d||d==="text"||d==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:R,config:e,request:T};nE(function(U){t(U),k()},function(U){r(U),k()},$),T=null}"onloadend"in T?T.onloadend=P:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(P)},T.onabort=function(){T&&(r(new Jt("Request aborted",Jt.ECONNABORTED,e,T)),T=null)},T.onerror=function(){r(new Jt("Network Error",Jt.ERR_NETWORK,e,T)),T=null},T.ontimeout=function(){let z=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const $=a.transitional||ZT;a.timeoutErrorMessage&&(z=a.timeoutErrorMessage),r(new Jt(z,$.clarifyTimeoutError?Jt.ETIMEDOUT:Jt.ECONNABORTED,e,T)),T=null},o===void 0&&l.setContentType(null),"setRequestHeader"in T&&We.forEach(l.toJSON(),function(z,$){T.setRequestHeader($,z)}),We.isUndefined(a.withCredentials)||(T.withCredentials=!!a.withCredentials),d&&d!=="json"&&(T.responseType=a.responseType),u&&([b,S]=fb(u,!0),T.addEventListener("progress",b)),f&&T.upload&&([g,v]=fb(f),T.upload.addEventListener("progress",g),T.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(h=R=>{T&&(r(!R||R.type?new Kh(null,e,T):R),T.abort(),T=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const M=TG(a.url);if(M&&Ri.protocols.indexOf(M)===-1){r(new Jt("Unsupported protocol "+M+":",Jt.ERR_BAD_REQUEST,e));return}T.send(o||null)})},LG=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let r=new AbortController,a;const o=function(u){if(!a){a=!0,d();const h=u instanceof Error?u:this.reason;r.abort(h instanceof Jt?h:new Kh(h instanceof Error?h.message:h))}};let l=n&&setTimeout(()=>{l=null,o(new Jt(`timeout ${n} of ms exceeded`,Jt.ETIMEDOUT))},n);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),e=null)};e.forEach(u=>u.addEventListener("abort",o));const{signal:f}=r;return f.unsubscribe=()=>We.asap(d),f}},FG=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let r=0,a;for(;r<t;)a=r+n,yield e.slice(r,a),r=a},$G=async function*(e,n){for await(const t of zG(e))yield*FG(t,n)},zG=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:r}=await n.read();if(t)break;yield r}}finally{await n.cancel()}},k_=(e,n,t,r)=>{const a=$G(e,n);let o=0,l,d=f=>{l||(l=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:u,value:h}=await a.next();if(u){d(),f.close();return}let g=h.byteLength;if(t){let b=o+=g;t(b)}f.enqueue(new Uint8Array(h))}catch(u){throw d(u),u}},cancel(f){return d(f),a.return()}},{highWaterMark:2})},Yb=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",aE=Yb&&typeof ReadableStream=="function",UG=Yb&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),sE=(e,...n)=>{try{return!!e(...n)}catch{return!1}},BG=aE&&sE(()=>{let e=!1;const n=new Request(Ri.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),T_=64*1024,q1=aE&&sE(()=>We.isReadableStream(new Response("").body)),hb={stream:q1&&(e=>e.body)};Yb&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!hb[n]&&(hb[n]=We.isFunction(e[n])?t=>t[n]():(t,r)=>{throw new Jt(`Response type '${n}' is not supported`,Jt.ERR_NOT_SUPPORT,r)})})})(new Response);const qG=async e=>{if(e==null)return 0;if(We.isBlob(e))return e.size;if(We.isSpecCompliantForm(e))return(await new Request(Ri.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(We.isArrayBufferView(e)||We.isArrayBuffer(e))return e.byteLength;if(We.isURLSearchParams(e)&&(e=e+""),We.isString(e))return(await UG(e)).byteLength},VG=async(e,n)=>{const t=We.toFiniteNumber(e.getContentLength());return t??qG(n)},HG=Yb&&(async e=>{let{url:n,method:t,data:r,signal:a,cancelToken:o,timeout:l,onDownloadProgress:d,onUploadProgress:f,responseType:u,headers:h,withCredentials:g="same-origin",fetchOptions:b}=iE(e);u=u?(u+"").toLowerCase():"text";let v=LG([a,o&&o.toAbortSignal()],l),S;const k=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let T;try{if(f&&BG&&t!=="get"&&t!=="head"&&(T=await VG(h,r))!==0){let $=new Request(n,{method:"POST",body:r,duplex:"half"}),L;if(We.isFormData(r)&&(L=$.headers.get("content-type"))&&h.setContentType(L),$.body){const[U,B]=C_(T,fb(__(f)));r=k_($.body,T_,U,B)}}We.isString(g)||(g=g?"include":"omit");const P="credentials"in Request.prototype;S=new Request(n,{...b,signal:v,method:t.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:P?g:void 0});let M=await fetch(S);const R=q1&&(u==="stream"||u==="response");if(q1&&(d||R&&k)){const $={};["status","statusText","headers"].forEach(W=>{$[W]=M[W]});const L=We.toFiniteNumber(M.headers.get("content-length")),[U,B]=d&&C_(L,fb(__(d),!0))||[];M=new Response(k_(M.body,T_,U,()=>{B&&B(),k&&k()}),$)}u=u||"text";let z=await hb[We.findKey(hb,u)||"text"](M,e);return!R&&k&&k(),await new Promise(($,L)=>{nE($,L,{data:z,headers:ha.from(M.headers),status:M.status,statusText:M.statusText,config:e,request:S})})}catch(P){throw k&&k(),P&&P.name==="TypeError"&&/fetch/i.test(P.message)?Object.assign(new Jt("Network Error",Jt.ERR_NETWORK,e,S),{cause:P.cause||P}):Jt.from(P,P&&P.code,e,S)}}),V1={http:sG,xhr:OG,fetch:HG};We.forEach(V1,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const E_=e=>`- ${e}`,GG=e=>We.isFunction(e)||e===null||e===!1,oE={getAdapter:e=>{e=We.isArray(e)?e:[e];const{length:n}=e;let t,r;const a={};for(let o=0;o<n;o++){t=e[o];let l;if(r=t,!GG(t)&&(r=V1[(l=String(t)).toLowerCase()],r===void 0))throw new Jt(`Unknown adapter '${l}'`);if(r)break;a[l||"#"+o]=r}if(!r){const o=Object.entries(a).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(E_).join(`
`):" "+E_(o[0]):"as no adapter specified";throw new Jt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:V1};function I0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Kh(null,e)}function A_(e){return I0(e),e.headers=ha.from(e.headers),e.data=D0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),oE.getAdapter(e.adapter||mg.adapter)(e).then(function(r){return I0(e),r.data=D0.call(e,e.transformResponse,r),r.headers=ha.from(r.headers),r},function(r){return tE(r)||(I0(e),r&&r.response&&(r.response.data=D0.call(e,e.transformResponse,r.response),r.response.headers=ha.from(r.response.headers))),Promise.reject(r)})}const lE="1.8.4",Wb={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Wb[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const P_={};Wb.transitional=function(n,t,r){function a(o,l){return"[Axios v"+lE+"] Transitional option '"+o+"'"+l+(r?". "+r:"")}return(o,l,d)=>{if(n===!1)throw new Jt(a(l," has been removed"+(t?" in "+t:"")),Jt.ERR_DEPRECATED);return t&&!P_[l]&&(P_[l]=!0,console.warn(a(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,d):!0}};Wb.spelling=function(n){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function YG(e,n,t){if(typeof e!="object")throw new Jt("options must be an object",Jt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const o=r[a],l=n[o];if(l){const d=e[o],f=d===void 0||l(d,o,e);if(f!==!0)throw new Jt("option "+o+" must be "+f,Jt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Jt("Unknown option "+o,Jt.ERR_BAD_OPTION)}}const Yx={assertOptions:YG,validators:Wb},Go=Yx.validators;let Ld=class{constructor(n){this.defaults=n,this.interceptors={request:new S_,response:new S_}}async request(n,t){try{return await this._request(n,t)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=qd(this.defaults,t);const{transitional:r,paramsSerializer:a,headers:o}=t;r!==void 0&&Yx.assertOptions(r,{silentJSONParsing:Go.transitional(Go.boolean),forcedJSONParsing:Go.transitional(Go.boolean),clarifyTimeoutError:Go.transitional(Go.boolean)},!1),a!=null&&(We.isFunction(a)?t.paramsSerializer={serialize:a}:Yx.assertOptions(a,{encode:Go.function,serialize:Go.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Yx.assertOptions(t,{baseUrl:Go.spelling("baseURL"),withXsrfToken:Go.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&We.merge(o.common,o[t.method]);o&&We.forEach(["delete","get","head","post","put","patch","common"],S=>{delete o[S]}),t.headers=ha.concat(l,o);const d=[];let f=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(f=f&&k.synchronous,d.unshift(k.fulfilled,k.rejected))});const u=[];this.interceptors.response.forEach(function(k){u.push(k.fulfilled,k.rejected)});let h,g=0,b;if(!f){const S=[A_.bind(this),void 0];for(S.unshift.apply(S,d),S.push.apply(S,u),b=S.length,h=Promise.resolve(t);g<b;)h=h.then(S[g++],S[g++]);return h}b=d.length;let v=t;for(g=0;g<b;){const S=d[g++],k=d[g++];try{v=S(v)}catch(T){k.call(this,T);break}}try{h=A_.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,b=u.length;g<b;)h=h.then(u[g++],u[g++]);return h}getUri(n){n=qd(this.defaults,n);const t=rE(n.baseURL,n.url,n.allowAbsoluteUrls);return XT(t,n.params,n.paramsSerializer)}};We.forEach(["delete","get","head","options"],function(n){Ld.prototype[n]=function(t,r){return this.request(qd(r||{},{method:n,url:t,data:(r||{}).data}))}});We.forEach(["post","put","patch"],function(n){function t(r){return function(o,l,d){return this.request(qd(d||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}Ld.prototype[n]=t(),Ld.prototype[n+"Form"]=t(!0)});let WG=class cE{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const r=this;this.promise.then(a=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](a);r._listeners=null}),this.promise.then=a=>{let o;const l=new Promise(d=>{r.subscribe(d),o=d}).then(a);return l.cancel=function(){r.unsubscribe(o)},l},n(function(o,l,d){r.reason||(r.reason=new Kh(o,l,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=r=>{n.abort(r)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new cE(function(a){n=a}),cancel:n}}};function QG(e){return function(t){return e.apply(null,t)}}function JG(e){return We.isObject(e)&&e.isAxiosError===!0}const H1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(H1).forEach(([e,n])=>{H1[n]=e});function uE(e){const n=new Ld(e),t=UT(Ld.prototype.request,n);return We.extend(t,Ld.prototype,n,{allOwnKeys:!0}),We.extend(t,n,null,{allOwnKeys:!0}),t.create=function(a){return uE(qd(e,a))},t}const Rr=uE(mg);Rr.Axios=Ld;Rr.CanceledError=Kh;Rr.CancelToken=WG;Rr.isCancel=tE;Rr.VERSION=lE;Rr.toFormData=Gb;Rr.AxiosError=Jt;Rr.Cancel=Rr.CanceledError;Rr.all=function(n){return Promise.all(n)};Rr.spread=QG;Rr.isAxiosError=JG;Rr.mergeConfig=qd;Rr.AxiosHeaders=ha;Rr.formToJSON=e=>eE(We.isHTMLForm(e)?new FormData(e):e);Rr.getAdapter=oE.getAdapter;Rr.HttpStatusCode=H1;Rr.default=Rr;const{Axios:Gie,AxiosError:Yie,CanceledError:Wie,isCancel:Qie,CancelToken:Jie,VERSION:Kie,all:Xie,Cancel:Zie,isAxiosError:eae,spread:tae,toFormData:nae,AxiosHeaders:rae,HttpStatusCode:iae,formToJSON:aae,getAdapter:sae,mergeConfig:oae}=Rr;function KG(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"screen",start:async()=>{const d=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function XG(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"webcam",start:async()=>{const d=await navigator.mediaDevices.getUserMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class ZG extends FT{constructor(t){super();Qn(this,"client");Qn(this,"_status","disconnected");Qn(this,"_session",null);Qn(this,"_model",null);Qn(this,"config",null);this.client=new ww(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(o){return console.error("Error connecting to GenAI Live:",o),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let o=((r=a.modelTurn)==null?void 0:r.parts)||[];const l=o.filter(h=>{var g;return h.inlineData&&((g=h.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),d=l.map(h=>{var g;return(g=h.inlineData)==null?void 0:g.data}),f=zT.difference(o,l);if(d.forEach(h=>{if(h){const g=fH(h);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!f.length)return;o=f;const u={modelTurn:{parts:o}};this.emit("content",u),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let r=!1,a=!1;for(const d of t)if((l=this.session)==null||l.sendRealtimeInput({media:d}),d.mimeType.includes("audio")&&(r=!0),d.mimeType.includes("image")&&(a=!0),r&&a)break;const o=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",o)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function eY(e){const n=w.useMemo(()=>new ZG(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[o,l]=w.useState({}),[d,f]=w.useState(!1),[u,h]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||OT({id:"audio-out"}).then(k=>{t.current=new wH(k),t.current.addWorklet("vumeter-out",LT,T=>{h(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{f(!0)},T=()=>{f(!1)},P=$=>{console.error("error",$)},M=()=>{var $;return($=t.current)==null?void 0:$.stop()},R=$=>{var L;return(L=t.current)==null?void 0:L.addPCM16(new Uint8Array($))},z=$=>{if(console.log("Received content event:",$),$.modelTurn&&$.modelTurn.parts){const L=$.modelTurn.parts.filter(U=>"text"in U&&U.text);if(L.length>0){const U=L.map(B=>B.text).join(" ");b(U),console.log("AI Summary received:",U)}}};return n.on("error",P).on("open",k).on("close",T).on("interrupted",M).on("audio",R).on("content",z),()=>{n.off("error",P).off("open",k).off("close",T).off("interrupted",M).off("audio",R).off("content",z).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!o)throw new Error("config has not been set");n.disconnect(),await n.connect(r,o)},[n,o,r]),S=w.useCallback(async()=>{n.disconnect(),f(!1)},[f,n]);return{client:n,config:o,setConfig:l,model:r,setModel:a,connected:d,connect:v,disconnect:S,volume:u,aiSummary:g}}const dE=w.createContext(void 0),Qb=({options:e,children:n})=>{const t=eY(e);return i.jsx(dE.Provider,{value:t,children:n})},pu=()=>{const e=w.useContext(dE);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function tY(){const{config:e,setConfig:n}=pu(),[t,r]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(o=>{n({...e,responseModalities:[o==="audio"?ou.AUDIO:ou.TEXT]})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),i.jsx(MT,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:o=>{r(o),o&&(o.value==="audio"||o.value==="text")&&a(o.value)}})]})}const D_=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function nY(){const{config:e,setConfig:n}=pu();w.useEffect(()=>{var d,f,u;const o=((u=(f=(d=e.speechConfig)==null?void 0:d.voiceConfig)==null?void 0:f.prebuiltVoiceConfig)==null?void 0:u.voiceName)||"Atari02";r({value:o,label:o})},[e]);const[t,r]=w.useState(D_[5]),a=w.useCallback(o=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:o}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(MT,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:D_,onChange:o=>{r(o),o&&a(o.value)}})]})}function rY(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=pu(),o=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(u=>Array.isArray(u.functionDeclarations)).map(u=>u.functionDeclarations).filter(u=>!!u).flat():[],[t]),l=w.useMemo(()=>{var u;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(h=>typeof h=="string"?h:h.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((u=t.systemInstruction.parts)==null?void 0:u.map(h=>h.text).join(`
`))||"":""},[t]),d=w.useCallback(u=>{const h={...t,systemInstruction:u.target.value};r(h)},[t,r]),f=w.useCallback((u,h)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===u?{...k,description:h}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsxs("div",{className:"mode-selectors",children:[i.jsx(tY,{}),i.jsx(nY,{})]}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:d,value:l}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:o.map((u,h)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:u.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=u.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:u.description,onBlur:b=>f(u.name,b.target.value)},`fd-${u.description}`)]},`function-${h}`)})})})]})})]})}const I_=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function iY({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const o=[XG(),KG()],[l,d]=w.useState(null),[f,u]=o,[h,g]=w.useState(0),[b]=w.useState(()=>new $T),[v,S]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:P,connected:M,connect:R,disconnect:z,volume:$}=pu();w.useEffect(()=>{!M&&T.current&&T.current.focus()},[M]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(h*200,8))}px`)},[h]),w.useEffect(()=>{const U=B=>{P.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:B}])};return M&&!v&&b?b.on("data",U).on("volume",g).start():b.stop(),()=>{b.off("data",U).off("volume",g)}},[M,P,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let U=-1;function B(){const W=e.current,I=k.current;if(!W||!I)return;const F=I.getContext("2d");if(I.width=W.videoWidth*.25,I.height=W.videoHeight*.25,I.width+I.height>0){F.drawImage(W,0,0,I.width,I.height);const V=I.toDataURL("image/jpeg",1),re=V.slice(V.indexOf(",")+1,1/0);P.sendRealtimeInput([{mimeType:"image/jpeg",data:re}])}M&&(U=window.setTimeout(B,1e3/.5))}return M&&l!==null&&requestAnimationFrame(B),()=>{clearTimeout(U)}},[M,l,P,e]);const L=U=>async()=>{if(U){const B=await U.start();d(B),t(B)}else d(null),t(null);o.filter(B=>B!==U).forEach(B=>B.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:su("actions-nav",{disabled:!M}),children:[i.jsx("button",{className:su("action-button mic-button",{recording:!v&&M}),onClick:()=>S(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(xH,{volume:$,active:M,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(I_,{isStreaming:u.isStreaming,start:L(u),stop:L(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(I_,{isStreaming:f.isStreaming,start:L(f),stop:L(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:su("connection-container",{connected:M}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:T,className:su("action-button connect-toggle",{connected:M}),onClick:M?z:R,children:i.jsx("span",{className:"material-symbols-outlined filled",children:M?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(rY,{}):""]})}const R_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Lh.OBJECT,properties:{summary:{type:Lh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},aY=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:o,setModel:l}=pu();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),o({responseModalities:[ou.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[R_]}]})},[o,l]),w.useEffect(()=>{const d=f=>{if(!f.functionCalls)return;const u=f.functionCalls.find(h=>h.name===R_.name);if(u){const h=u.args.summary;r(h)}f.functionCalls.length&&setTimeout(()=>{var h;return a.sendToolResponse({functionResponses:(h=f.functionCalls)==null?void 0:h.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",d),()=>{a.off("toolcall",d)}},[a]),w.useEffect(()=>{if(t){const d=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${d}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${d}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})},M_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes";async function sY(){const e=Sw();if(!e)return console.warn("No auth token found, using default Live API key."),M_;try{const t=(await Rr.get("/api/clinics/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).data.geminiApiKey;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Live API key:",n)}return console.warn("Clinic-specific Live API key not found or failed to fetch, using default."),M_}function oY(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await sY();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(Qb,{options:r,children:i.jsx(lY,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const lY=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[o,l]=w.useState(null),{connected:d,client:f,connect:u,config:h,model:g}=pu(),[b,v]=w.useState(""),S=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const M=window.matchMedia("(prefers-color-scheme: dark)"),R=z=>{document.documentElement.setAttribute("data-theme",z.matches?"dark":"light")};return R(M),M.addEventListener("change",R),()=>M.removeEventListener("change",R)},[]),w.useEffect(()=>{const M=new URLSearchParams(window.location.search),R={};for(const[z,$]of M.entries())z==="token_number"?l($):R[z]=$;a(R)},[]),w.useEffect(()=>{Object.keys(h).length>0&&g&&u()},[u,h,g]),w.useEffect(()=>{if(d&&r&&!k){const M=JSON.stringify(r,null,2);f.send([{text:M}]),v(""),T(!0)}},[d,r,f,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const P=()=>{f.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(aY,{patientData:r,tokenNumber:o}),i.jsx("video",{className:su("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:su("input-container",{disabled:!d}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:S,onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),M.stopPropagation(),P())},onChange:M=>v(M.target.value),value:b}),i.jsx("span",{className:su("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:P,children:"send"})]})}),i.jsx(iY,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},O_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",cY=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},uY=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},o)=>{var L;const{connected:l,connect:d,disconnect:f,client:u,volume:h}=pu(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P]=w.useState(()=>new $T),M=async()=>{l?await f():(await d(),r.trim()&&a())};w.useEffect(()=>{const U=B=>{u.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:B}])};return l&&!g?P.on("data",U).start():P.stop(),()=>{P.off("data",U),P.stop()}},[l,u,g,P]);const R=w.useCallback(async()=>{if(v)$==null||$.getTracks().forEach(U=>U.stop()),t(null),S(!1);else try{const U=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=U),t(U),S(!0)}catch(U){console.error("Error accessing webcam:",U),S(!1)}},[v,t,e]),z=w.useCallback(async()=>{if(k)$==null||$.getTracks().forEach(U=>U.stop()),t(null),T(!1);else try{const U=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=U),t(U),T(!0)}catch(U){console.error("Error accessing screen share:",U),T(!1)}},[k,t,e]),$=(L=e.current)==null?void 0:L.srcObject;return w.useEffect(()=>()=>{$&&$.getTracks().forEach(U=>U.stop())},[$]),w.useImperativeHandle(o,()=>({handleConnect:M})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(vF,{className:"w-5 h-5"}):i.jsx(Eb,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(cY,{volume:h,active:l})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:z,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(_F,{className:"w-5 h-5"})}),i.jsx("button",{onClick:R,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(w6,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:M,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx(PF,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(LF,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),dY=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:r})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:r.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[r," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",r," Reception Assistant"]})]}),n&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:n})]}),e?i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"Patient Information"}),i.jsx("div",{className:"hospital-reception-patient-info-content",children:i.jsx("pre",{className:"hospital-reception-patient-info-pre",children:JSON.stringify(e,null,2)})})]}):i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"New Case"}),i.jsx("p",{className:"hospital-reception-patient-info-pre",children:"No patient data provided. This is a new case."})]}),t&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),L_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Lh.OBJECT,properties:{summary:{type:Lh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},fY=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a})=>{const o=w.useRef(null),l=w.useRef(null),[d,f]=w.useState(null),[u,h]=w.useState("hi"),{client:g,connected:b,setConfig:v,setModel:S,disconnect:k,connect:T}=pu(),P=w.useMemo(()=>{let U=`Your job is to:

If patient details like name, age, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (Name, Age) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's Name and Age only. Do not ask for their phone number.

    You should guess the patient's sex based on their voice or appearance.

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu. Dont write the telugu words in english.`;return n&&(U+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[ou.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:U}]},tools:[{functionDeclarations:[L_]}]}},[n]);w.useEffect(()=>{S("models/gemini-2.5-flash-native-audio-preview-12-2025"),v(P);const U=setTimeout(()=>{l.current&&!b&&l.current.handleConnect()},2e3);return()=>clearTimeout(U)},[v,S,P,b]),w.useEffect(()=>()=>{b&&k()},[b,k]);const[M,R]=w.useState(null);w.useEffect(()=>{const U=B=>{if(!B.functionCalls)return;const W=B.functionCalls.find(I=>I.name===L_.name);if(W){const I=W.args.summary;R(I),r(I)}B.functionCalls.length&&setTimeout(()=>{var I;return g.sendToolResponse({functionResponses:(I=B.functionCalls)==null?void 0:I.map(F=>({response:{output:{success:!0}},id:F.id,name:F.name}))})},200)};return g.on("toolcall",U),()=>{g.off("toolcall",U)}},[g,r]);const z=()=>{u.trim()&&(g.send([{text:u}]),h(""))},$=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),z())},L=async()=>{R(null),r(null),h("hi"),b?(k(),setTimeout(()=>{T()},500)):T()};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:L,className:"live-api-modal-close-button",title:"Refresh Session","aria-label":"Refresh session",children:i.jsx(Ok,{className:"w-6 h-6"})}),i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(bn,{className:"w-6 h-6"})})]})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(dY,{patientData:n,tokenNumber:t,aiSummary:M,clinicName:a}),d&&i.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:u,onChange:U=>h(U.target.value),onKeyDown:$,placeholder:"Type your message here...",disabled:!b,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:z,disabled:!b||!u.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(Pb,{className:"w-5 h-5"})})]})}),i.jsx(uY,{ref:l,videoRef:o,supportsVideo:!0,onVideoStreamChange:f,textInput:u,onSubmitTextInput:z})]})})]})})},rS=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,o]=w.useState(null),[l,d]=w.useState("Newtons Ai"),[f,u]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{let b=null,v="Newtons Ai";try{const S=await me("/api/clinics/settings");if(S.ok){const k=await S.json();k.name&&k.name!==""&&(v=k.name),k.gemini_api_key&&k.gemini_api_key.trim()!==""&&(b=k.gemini_api_key.trim())}}catch(S){console.warn("Failed to fetch clinic settings",S)}if(d(v),b)o(b);else{try{const S=await me("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();if(k.value&&k.value.trim()!==""){o(k.value.trim());return}}}catch(S){console.warn("Failed to fetch global key fallback",S)}o(O_)}}catch(b){console.error("Unexpected error in getSettings:",b),o(O_)}finally{u(!1)}})()},[]),f)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",style:{maxHeight:"200px",maxWidth:"400px",borderRadius:"1rem",justifyContent:"center"},children:i.jsxs("div",{className:"live-api-loading-container",children:[i.jsx("div",{className:"live-api-loading-spinner"}),i.jsx("div",{className:"live-api-loading-text",children:"Initializing AI Assistant..."})]})})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const h={apiKey:a};return i.jsx(Qb,{options:h,children:i.jsx(fY,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:l})})},hY="_overlay_dykuf_5",pY="_modal_dykuf_55",mY="_minimized_dykuf_87",gY="_contentWrapper_dykuf_97",yY="_header_dykuf_127",xY="_inputWrapper_dykuf_141",bY="_searchIcon_dykuf_161",vY="_input_dykuf_141",wY="_controlsGroup_dykuf_229",SY="_iconButton_dykuf_255",NY="_sendButton_dykuf_295",CY="_dragBar_dykuf_341",_Y="_dragBarControls_dykuf_369",jY="_windowControlBtn_dykuf_381",kY="_btnRed_dykuf_411",TY="_btnYellow_dykuf_421",EY="_content_dykuf_97",AY="_overlayContent_dykuf_503",PY="_section_dykuf_527",DY="_sectionTitle_dykuf_539",IY="_recentList_dykuf_559",RY="_recentPill_dykuf_583",MY="_recentName_dykuf_623",OY="_recentToken_dykuf_635",LY="_recentInfo_dykuf_653",FY="_examplesGrid_dykuf_665",$Y="_exampleCard_dykuf_677",zY="_exampleIcon_dykuf_713",UY="_exampleText_dykuf_721",BY="_chatSectionFill_dykuf_735",qY="_chatHeader_dykuf_751",VY="_chatTitle_dykuf_771",HY="_chatMessagesFill_dykuf_789",GY="_chatBubble_dykuf_807",YY="_chatBubbleUser_dykuf_827",WY="_chatBubbleModel_dykuf_841",QY="_chatBubbleSystem_dykuf_855",JY="_processing_dykuf_871",KY="_spinner_dykuf_889",XY="_resultItem_dykuf_911",ZY="_resultName_dykuf_939",eW="_resultToken_dykuf_949",tW="_resultDetails_dykuf_961",nW="_noResults_dykuf_971",rW="_collapsed_dykuf_1109",jt={overlay:hY,modal:pY,minimized:mY,contentWrapper:gY,header:yY,inputWrapper:xY,searchIcon:bY,input:vY,controlsGroup:wY,iconButton:SY,sendButton:NY,dragBar:CY,dragBarControls:_Y,windowControlBtn:jY,btnRed:kY,btnYellow:TY,content:EY,overlayContent:AY,section:PY,sectionTitle:DY,recentList:IY,recentPill:RY,recentName:MY,recentToken:OY,recentInfo:LY,examplesGrid:FY,exampleCard:$Y,exampleIcon:zY,exampleText:UY,chatSectionFill:BY,chatHeader:qY,chatTitle:VY,chatMessagesFill:HY,chatBubble:GY,chatBubbleUser:YY,chatBubbleModel:WY,chatBubbleSystem:QY,processing:JY,spinner:KY,resultItem:XY,resultName:ZY,resultToken:eW,resultDetails:tW,noResults:nW,collapsed:rW},fE="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",iW={apiKey:fE},aW=[{icon:"",text:"Check Paracetamol stock"},{icon:"",text:"Show last month analysis"},{icon:"",text:"Go to Pharmacy Inventory"},{icon:"",text:"Add new staff member"},{icon:"",text:"New patient: Fever case"},{icon:"",text:"Open OPD Queue"}],sW=()=>{const{isOpen:e,closeCommandBar:n}=Nb(),t=At(),r=qr(),a=w.useRef(null),[o,l]=w.useState(""),[d,f]=w.useState([]),[u,h]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(!0),[k,T]=w.useState(!1),[P,M]=w.useState(null),[R,z]=w.useState(!1),$=Nw({settings:{},staffList:[]}),{selectedImage:L,handleImageSelect:U,clearImage:B}=$,W=w.useRef(null),I=_e=>{var Ye;const Ke=(Ye=_e.target.files)==null?void 0:Ye[0];Ke&&U(Ke)},[F,V]=w.useState({x:0,y:0}),[re,ie]=w.useState(!1),G=w.useRef({x:0,y:0}),Y=w.useRef({x:0,y:0});w.useEffect(()=>{const _e=Ye=>{if(!re)return;const it=Ye.clientX-G.current.x,xt=Ye.clientY-G.current.y;V({x:Y.current.x+it,y:Y.current.y+xt})},Ke=()=>{ie(!1)};return re&&(window.addEventListener("mousemove",_e),window.addEventListener("mouseup",Ke)),()=>{window.removeEventListener("mousemove",_e),window.removeEventListener("mouseup",Ke)}},[re]);const ne=_e=>{_e.target.closest("input, button, .lucide")||(ie(!0),G.current={x:_e.clientX,y:_e.clientY},Y.current={...F})};w.useEffect(()=>{e&&S(!1)},[r.pathname]),w.useEffect(()=>{$.setChatQuery(o)},[o]),w.useEffect(()=>{e&&a.current&&a.current.focus()},[e]);const le=_e=>{!_e.trim()&&!L||(S(!0),$.handleSendMessage(_e),l(""),h([]))};w.useEffect(()=>{P&&(l(P),T(!1),setTimeout(()=>le(P),50),M(null))},[P]);const oe=()=>{T(!0)},E=()=>{l(""),h([]),$.refreshChat(),a.current&&a.current.focus()};w.useEffect(()=>{e&&(async()=>{try{const Ke=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),Ye=await me(`/api/patients?${Ke.toString()}`);if(Ye.ok){const it=await Ye.json();f(it.patients||[])}}catch(Ke){console.error("Error fetching recent patients:",Ke)}})()},[e]);const de=w.useMemo(()=>fg(async _e=>{const Ke=_e.trim(),Ye=/^\d+$/.test(Ke),it=Ke.split(/\s+/).length;if(Ke.length<2||Ye&&Ke.length>10||!Ye&&it>3){h([]),b(!1);return}b(!0);try{const xt=new URLSearchParams({search:encodeURIComponent(_e),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Nt=await me(`/api/patients?${xt.toString()}`);if(Nt.ok){const ue=await Nt.json();h(ue.patients||[])}}catch(xt){console.error("Search error:",xt)}finally{b(!1)}},300),[]),he=_e=>{const Ke=_e.target.value;l(Ke),de(Ke)},D=_e=>{_e.id&&t(`/dashboard/edit-complaint/patient/${_e.id}`)},pe=_e=>{l(_e),setTimeout(()=>le(_e),50)},Ne=_e=>{o.trim()&&le(o)},te=_e=>{_e.key==="Enter"&&!_e.shiftKey&&(_e.preventDefault(),Ne())},K=_e=>{_e.target===_e.currentTarget&&n()};if(!e)return null;const J=u.length>0&&!g,ye=o.length===0&&u.length===0,He=o.length>=3&&u.length===0&&!g,Q=$.chatHistory.length>0||$.isProcessing,Pe=!Q||J,Re=Q&&J,Le=Q&&!v&&!R&&!J;return i.jsxs("div",{className:jt.overlay,onClick:K,children:[i.jsxs("div",{className:`${jt.modal} ${R?jt.minimized:""} ${Le?jt.collapsed:""}`,style:{transform:`translate(${F.x}px, ${F.y}px)`,height:Le?"auto":void 0},onClick:()=>{Le&&S(!0)},children:[i.jsx("div",{className:jt.dragBar,onMouseDown:ne,onDoubleClick:()=>z(!R),children:i.jsxs("div",{className:jt.dragBarControls,children:[i.jsx("button",{className:`${jt.windowControlBtn} ${jt.btnRed}`,onClick:n,title:"Close",children:i.jsx(bn,{size:10,color:"#7f1d1d"})}),i.jsx("button",{className:`${jt.windowControlBtn} ${jt.btnYellow}`,onClick:()=>z(!R),title:R?"Maximize":"Minimize",children:R?i.jsx(xF,{size:10,color:"#713f12"}):i.jsx(NF,{size:10,color:"#713f12"})})]})}),i.jsxs("div",{className:jt.contentWrapper,children:[Q&&i.jsxs("div",{className:jt.chatSectionFill,children:[i.jsxs("div",{className:jt.chatHeader,onClick:()=>S(!v),children:[i.jsxs("div",{className:jt.chatTitle,children:[i.jsx(Xx,{size:16}),"AI Assistant"]}),v?i.jsx(y1,{size:16}):i.jsx(x1,{size:16})]}),v&&i.jsxs("div",{className:jt.chatMessagesFill,children:[$.chatHistory.map((_e,Ke)=>i.jsx("div",{className:`${jt.chatBubble} ${_e.role==="user"?jt.chatBubbleUser:_e.role==="model"?jt.chatBubbleModel:jt.chatBubbleSystem}`,children:_e.role==="model"?i.jsx(xs,{remarkPlugins:[za],children:_e.text}):_e.text},Ke)),$.isProcessing&&i.jsxs("div",{className:jt.processing,children:[i.jsx(Gl,{size:14,className:jt.spinner}),"Thinking..."]})]})]}),Pe&&i.jsxs("div",{className:Re?jt.overlayContent:jt.content,children:[d.length>0&&ye&&!Q&&i.jsxs("div",{className:jt.section,children:[i.jsx("div",{className:jt.sectionTitle,children:"Newly Registered"}),i.jsx("div",{className:jt.recentList,children:d.map(_e=>i.jsxs("div",{className:jt.recentPill,onClick:()=>D(_e),children:[i.jsx("span",{className:jt.recentName,children:_e.name||"Patient"}),i.jsxs("span",{className:jt.recentToken,children:["#",_e.token]}),i.jsxs("span",{className:jt.recentInfo,children:[_e.age?`${_e.age}y`:""," ",_e.gender||""]})]},_e.id))})]}),ye&&!Q&&i.jsxs("div",{className:jt.section,children:[i.jsx("div",{className:jt.sectionTitle,children:"Quick Commands"}),i.jsx("div",{className:jt.examplesGrid,children:aW.map((_e,Ke)=>i.jsxs("div",{className:jt.exampleCard,onClick:()=>pe(_e.text),children:[i.jsx("span",{className:jt.exampleIcon,children:_e.icon}),i.jsx("span",{className:jt.exampleText,children:_e.text})]},Ke))})]}),g&&i.jsx("div",{className:jt.section,children:i.jsxs("div",{className:jt.processing,children:[i.jsx(Gl,{size:16,className:jt.spinner}),"Searching..."]})}),J&&i.jsxs("div",{className:jt.section,children:[i.jsx("div",{className:jt.sectionTitle,children:"Patients Found"}),i.jsx("div",{className:jt.resultsList,children:u.map(_e=>i.jsxs("div",{className:jt.resultItem,onClick:()=>D(_e),children:[i.jsxs("div",{children:[i.jsxs("span",{className:jt.resultToken,children:["[#",_e.token,"]"]}),i.jsx("span",{className:jt.resultName,children:_e.name})]}),i.jsxs("span",{className:jt.resultDetails,children:[_e.age?`${_e.age} yrs`:"",_e.age&&_e.gender?" / ":"",_e.gender||""]})]},_e.id))})]}),He&&!Q&&i.jsx("div",{className:jt.section,children:i.jsxs("div",{className:jt.noResults,children:["Press ",i.jsx("strong",{children:"Enter"}),' to send "',o,'" to AI Assistant']})})]})]}),i.jsx("div",{className:jt.header,children:i.jsxs("div",{className:jt.inputWrapper,children:[i.jsx(bi,{size:18,className:jt.searchIcon}),i.jsx("textarea",{ref:_e=>{a.current=_e,_e&&(_e.style.height="auto",_e.style.height=Math.min(_e.scrollHeight,150)+"px")},className:jt.input,placeholder:R?"Type here...":"Search (Name/Token/Phone), Ask AI, or Enter New Case (Name Age Sex Complaint)...",value:o,onChange:_e=>{he(_e),_e.target.style.height="auto",_e.target.style.height=Math.min(_e.target.scrollHeight,150)+"px"},onKeyDown:te,rows:1,disabled:$.isProcessing}),L&&i.jsxs("div",{style:{position:"relative",marginRight:"0.5rem"},children:[i.jsx("img",{src:L,alt:"Selected",style:{width:"24px",height:"24px",objectFit:"cover",borderRadius:"4px",border:"1px solid #e2e8f0"}}),i.jsx("button",{onClick:B,style:{position:"absolute",top:-4,right:-4,background:"rgba(0,0,0,0.6)",color:"white",border:"none",borderRadius:"50%",padding:"1px",cursor:"pointer",display:"flex"},children:i.jsx(bn,{size:8})})]}),i.jsx("input",{type:"file",ref:W,onChange:I,accept:"image/*",style:{display:"none"}}),i.jsxs("div",{className:jt.controlsGroup,children:[i.jsx("button",{className:jt.iconButton,onClick:()=>{var _e;return(_e=W.current)==null?void 0:_e.click()},title:"Attach Image",children:i.jsx(Ab,{size:16})}),(o.trim().length>0||L)&&i.jsx("button",{className:`${jt.iconButton} ${jt.sendButton}`,onClick:()=>le(o),title:"Send to AI",children:i.jsx(Pb,{size:16})}),i.jsx("button",{className:jt.iconButton,onClick:E,title:"Reset Chat/Search",children:i.jsx(BF,{size:16})}),i.jsx("button",{className:jt.iconButton,onClick:oe,title:"Voice Input",children:i.jsx(Eb,{size:16})})]})]})})]}),k&&fE&&i.jsx(Qb,{options:iW,children:i.jsx(rS,{onClose:()=>T(!1),patientData:{id:null,token:null,name:"New Case",age:null,gender:null},tokenNumber:null,onAiSummaryChange:M})})]})},oW=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[o,l]=w.useState(null),[d,f]=w.useState(!1),u=At(),h=async v=>{v.preventDefault(),f(!0),l(null);try{const S=await me("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!S.ok){let T=`Login failed with status: ${S.status}`;try{T=(await S.json()).message||T}catch{try{const M=await S.text();M&&(T=`${T} - ${M}`)}catch{}}throw new Error(T)}const k=await S.json();console.log("Login successful:",k),localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Login failed:",S),l(S.message||"Login failed. Please check your credentials.")}finally{f(!1)}},g=async v=>{f(!0),l(null);try{const S=await me("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v.credential})});if(!S.ok)throw new Error("Google Sign-In failed");const k=await S.json();localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Google Login Error:",S),l("Google Sign-In failed. Please try again.")}finally{f(!1)}},b=()=>{console.error("Google Login Failed"),l("Google Sign-In was unsuccessful. Please try again.")};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Newtons AI HMS"}),i.jsx("p",{className:"auth-subtitle",children:"Sign in to continue"}),i.jsxs("form",{onSubmit:h,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:v=>t(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"email",children:"Email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:v=>a(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"password",children:"Password"})]}),o&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:o})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:d,className:"auth-submit-button",children:d?"Signing in...":"Sign In"})})]}),i.jsx("div",{className:"google-login-container",children:i.jsx(PP,{onSuccess:g,onError:b,useOneTap:!0})}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(bs,{to:"/register",className:"auth-navigation-link",children:"Create account"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},lW=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState(null),[h,g]=w.useState(!1),b=At(),v=async S=>{S.preventDefault(),g(!0),u(null);try{const k=await me("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),u(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>r(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>o(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>d(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),f&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:f})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:h,className:"auth-submit-button",children:h?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(bs,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var hE={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},F_=kn.createContext&&kn.createContext(hE),cW=["attr","size","title"];function uW(e,n){if(e==null)return{};var t=dW(e,n),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function dW(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function pb(){return pb=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},pb.apply(this,arguments)}function $_(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function mb(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?$_(Object(t),!0).forEach(function(r){fW(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$_(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function fW(e,n,t){return n=hW(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function hW(e){var n=pW(e,"string");return typeof n=="symbol"?n:n+""}function pW(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function pE(e){return e&&e.map((n,t)=>kn.createElement(n.tag,mb({key:t},n.attr),pE(n.child)))}function Ga(e){return n=>kn.createElement(mW,pb({attr:mb({},e.attr)},n),pE(e.child))}function mW(e){var n=t=>{var{attr:r,size:a,title:o}=e,l=uW(e,cW),d=a||t.size||"1em",f;return t.className&&(f=t.className),e.className&&(f=(f?f+" ":"")+e.className),kn.createElement("svg",pb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:f,style:mb(mb({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),o&&kn.createElement("title",null,o),e.children)};return F_!==void 0?kn.createElement(F_.Consumer,null,t=>n(t)):n(hE)}function R0(e){return Ga({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function z_(e){return Ga({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function U_(e){return Ga({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function kh(e){return Ga({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function _x(e){return Ga({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function jx(e){return Ga({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function kx(e){return Ga({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Th(e){return Ga({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function mE(e){return Ga({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function B_(e){return Ga({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function gW(e){return Ga({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function q_(e){return Ga({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Im(e){return Ga({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const gE={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:kh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:_x},{path:"/dashboard/users",name:"User Management",icon:Im}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:kh}]},{title:"Clinic Management",links:[{path:"/dashboard/clinic-hub",name:"Clinic Hub",icon:z_}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:_x},{path:"/dashboard/patients",name:"All Patients",icon:Im},{path:"/dashboard/patients/search",name:"Search Patient",icon:Th}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:R0},{path:"/dashboard/inventory",name:"Inventory Management",icon:kx},{path:"/dashboard/inventory/add",name:"Add Drug",icon:kx},{path:"/dashboard/distributors",name:"Distributor Management",icon:Im}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:B_},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:jx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:jx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:Th},{path:"/dashboard/add-patient",name:"Add Patient",icon:_x},{path:"/manage-admission",name:"Manage Admission",icon:q_}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:U_},{path:"/billing",name:"Billing",icon:jx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:B_}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:kh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:Im},{path:"/dashboard/patients/add",name:"Add Patient",icon:_x},{path:"/dashboard/patients/search",name:"Search Patient",icon:Th}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:jx},{path:"/manage-admission",name:"Manage Admission",icon:q_}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:kh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:U_},{path:"/lab/search-report",name:"Search Lab Report",icon:Th}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:kh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:kx},{path:"/dashboard/inventory/add",name:"Add Drug",icon:kx},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:R0},{path:"/dashboard/distributors",name:"Distributor Management",icon:Im}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:R0},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:z_},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:Th}]}]},yW=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const o=qr(),[l,d]=w.useState(""),f=gE[t]||[],[u,h]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(T=>{if(g.current){const P=window.innerWidth-T.clientX;P>250&&P<window.innerWidth*.8&&h(P)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=f.map(T=>({...T,links:T.links.filter(P=>P.name.toLowerCase().includes(l.toLowerCase()))})).filter(T=>T.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${u}px`,right:r?"0":`-${u}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(bs,{to:"/dashboard",className:"home-button",onClick:a,children:i.jsx(kh,{})}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx(Th,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:T=>d(T.target.value)})]}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:k.map((T,P)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:T.title}),i.jsx("ul",{className:"sub-page-list",children:T.links.map(M=>{const R=M.icon;return i.jsx("li",{children:i.jsxs(bs,{to:M.path,className:o.pathname===M.path?"active":"",onClick:a,children:[R&&i.jsx(R,{})," ",M.name]})},M.path)})})]},P))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(mE,{})," Logout"]})]})]})},xW=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:o})=>{const l=qr(),d=o[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"close-button",onClick:a,children:i.jsx(gW,{})})]}),i.jsx("nav",{children:d.map((f,u)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:f.title}),i.jsx("ul",{className:"sub-page-list",children:f.links.map(h=>{const g=h.icon;return i.jsx("li",{children:i.jsxs(bs,{to:h.path,className:l.pathname===h.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",h.name]})},h.path)})})]},u))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(mE,{})," Logout"]})]})]})]})},bW="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",vW={apiKey:bW},Eh=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(!1),[h,g]=w.useState(null),b=w.useRef(null),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[R,z]=w.useState(null),[$,L]=w.useState([]),[U,B]=w.useState(!1),W=At(),I=qr(),F=Nw({settings:{},staffList:[]}),{selectedImage:V,handleImageSelect:re,clearImage:ie}=F,G=w.useRef(null),Y=K=>{var ye;const J=(ye=K.target.files)==null?void 0:ye[0];J&&re(J)};w.useEffect(()=>{F.chatHistory.length>0&&U&&F.isProcessing},[F.chatHistory.length]),w.useEffect(()=>{(async()=>{try{const J=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),ye=await me(`/api/patients?${J.toString()}`);if(ye.ok){const He=await ye.json();L(He.patients||[])}}catch(J){console.error("Error fetching recent patients:",J)}})()},[]),w.useEffect(()=>{F.setChatQuery(e)},[e]);const ne=w.useCallback(async K=>{if(!(K||e).trim()){g("Please enter complaint details.");return}u(!0),g(null),K&&K!==F.chatQuery&&F.setChatQuery(K);try{F.handleSendMessage(),n("")}catch(ye){console.error("AI Error:",ye),g("AI failed to process. Try again."),u(!1)}},[e,F]);w.useEffect(()=>{!F.isProcessing&&f&&u(!1)},[F.isProcessing,f]),w.useEffect(()=>{const K=b.current;K&&(K.style.height="auto",K.style.height=`${K.scrollHeight}px`);const ye=new URLSearchParams(I.search).get("caseDetails");if(ye){const He=decodeURIComponent(ye);He!==e&&(n(He),S(!0))}},[I.search,e]),w.useEffect(()=>{v&&e.trim()&&(W(I.pathname,{replace:!0}),ne(e),S(!1))},[v,e,ne,W,I.pathname]),w.useEffect(()=>{const K=b.current;K&&(K.style.height="auto",K.style.height=`${K.scrollHeight}px`)},[e]),w.useEffect(()=>{P&&(n(P),T(!1),F.setChatQuery(P),setTimeout(()=>F.handleSendMessage(),0),M(null))},[P,F]);const le=()=>{z({id:null,token:null,name:"New Case",age:null,gender:null}),T(!0)},oe=w.useMemo(()=>fg(async K=>{const J=K.trim(),ye=/^\d+$/.test(J),He=J.split(/\s+/).length;if(J.length<2||ye&&J.length>10||!ye&&He>2){r([]),o(!1),d(null);return}o(!0),d(null);try{const Q=new URLSearchParams({search:encodeURIComponent(K),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),Pe=await me(`/api/patients?${Q.toString()}`);if(!Pe.ok){const Le=await Pe.text();throw new Error(`API Error (${Pe.status}): ${Le||Pe.statusText}`)}const Re=await Pe.json();r(Re.patients)}catch(Q){console.error("Error searching patients:",Q),d(Q.message||"Failed to search patients."),r([])}finally{o(!1)}},300),[]),E=K=>{const J=K.target.value;n(J);const ye=J.trim(),He=/^\d+$/.test(ye),Q=ye.split(/\s+/).length;ye.length>=2&&!(He&&ye.length>10||!He&&Q>2)?o(!0):(o(!1),r([])),oe(J)},de=K=>{K.key==="Enter"&&!K.shiftKey&&(K.preventDefault(),e.trim()&&!a&&te())},he=async K=>{K&&K.id&&W(`/dashboard/edit-complaint/patient/${K.id}`)},D=[{icon:"",title:"Example: Fever & Cold",description:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Example: Stomach Ache",description:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}],pe=K=>{n(K),setTimeout(()=>{F.handleSendMessage(K),n(""),r([])},50)},Ne=()=>{n(""),r([]),F.refreshChat()},te=()=>{!e.trim()&&!V||(oe.cancel(),F.handleSendMessage(e),n(""),r([]))};return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>W("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsx("button",{onClick:()=>W(-1),className:"patient-search-button patient-search-button-back",children:i.jsx(an,{size:16})})]}),i.jsxs("div",{className:"patient-search-content-box",children:[l&&i.jsx("p",{className:"patient-search-error",children:l}),h&&i.jsx("p",{className:"patient-search-error",children:h}),$.length>0&&i.jsxs("div",{className:"newly-registered-section",children:[i.jsx("div",{className:"recent-list",children:$.map(K=>i.jsxs("div",{className:"recent-patient-pill",onClick:()=>he(K),children:[i.jsxs("div",{className:"recent-name-container",children:[i.jsx("span",{className:"recent-name",children:K.name||"New Patient"}),i.jsxs("span",{className:"recent-token",children:["#",K.token]})]}),i.jsxs("div",{className:"recent-info",children:[K.age," yrs / ",K.gender]})]},K.id))}),i.jsx("div",{className:"newly-registered-label",children:"NEWLY REGISTERED"})]}),F.chatHistory.length===0&&t.length===0&&i.jsxs("div",{className:"example-cases-section",children:[i.jsxs("div",{className:"example-cases-header",children:[i.jsx("span",{className:"sparkles-icon",children:""}),i.jsx("h3",{children:"Try AI with Example Cases"})]}),i.jsx("div",{className:"example-cards-container",children:D.map((K,J)=>i.jsxs("div",{className:"example-case-card",onClick:()=>pe(K.text),children:[i.jsx("div",{className:"example-icon",children:K.icon}),i.jsxs("div",{className:"example-content",children:[i.jsx("div",{className:"example-title",children:K.title}),i.jsx("div",{className:"example-description",children:K.description})]})]},J))})]})]}),F.chatHistory.length>0&&!f&&i.jsxs("div",{className:`ai-chat-overlay ${U?"minimized":""}`,children:[i.jsxs("div",{className:"ai-chat-header",children:[i.jsx("span",{children:"AI Assistant"}),i.jsx("div",{className:"ai-chat-controls",children:i.jsx("button",{className:"icon-btn",onClick:()=>Ne(),title:"Clear Chat",children:i.jsx(bn,{size:16})})})]}),i.jsxs("div",{className:"ai-chat-messages",children:[F.chatHistory.map((K,J)=>i.jsx("div",{className:`chat-bubble ${K.role==="model"?"model":"user"}`,children:K.role==="system"?i.jsx("i",{children:K.text}):K.text},J)),F.isProcessing&&i.jsx("div",{className:"chat-bubble model",children:"Typing..."})]})]}),t.length>0&&!f&&i.jsxs("div",{className:"patient-search-results-overlay",children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingBottom:"0.5rem"},children:[i.jsx("div",{style:{fontWeight:600,color:"#64748b"},children:"Found Patients"}),i.jsx("button",{onClick:()=>r([]),style:{border:"none",background:"transparent",color:"#94a3b8",cursor:"pointer"},children:i.jsx(bn,{size:14})})]}),t.map(K=>i.jsxs("div",{onClick:()=>he(K),className:"patient-search-result-item",children:[i.jsxs("div",{className:"patient-search-result-item-name-container",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["[#",K.token,"]"]}),i.jsx("span",{className:"patient-search-result-item-name",children:K.name})]}),i.jsxs("div",{className:"patient-search-result-item-details",children:[K.age?`${K.age} yrs`:"",K.age&&K.gender?" / ":"",K.gender||"N/A"]})]},K.id))]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[i.jsxs("div",{className:"chat-input-controls",children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%"},children:[V&&i.jsxs("div",{style:{margin:"0 1rem 0.5rem 1rem",position:"relative",width:"fit-content",border:"1px solid #e2e8f0",borderRadius:"8px",overflow:"hidden"},children:[i.jsx("img",{src:V,alt:"Selected",style:{height:"60px",width:"auto",display:"block"}}),i.jsx("button",{onClick:ie,style:{position:"absolute",top:2,right:2,background:"rgba(0,0,0,0.6)",color:"white",border:"none",borderRadius:"50%",padding:"2px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(bn,{size:12})})]}),i.jsx("textarea",{ref:b,placeholder:"Search (Name/Token/Phone), Ask AI, or Enter New Case (Name Age Sex Complaint)...",value:e,onChange:E,onKeyDown:de,className:"chat-input",disabled:f||F.isProcessing,rows:1,style:{paddingRight:"6rem"}})]}),i.jsxs("div",{className:"action-buttons-container",children:[i.jsx("input",{type:"file",ref:G,onChange:Y,accept:"image/*",style:{display:"none"}}),(e.length>0||V)&&i.jsx("button",{className:"action-icon-btn send-btn-primary",onClick:te,title:"Send",children:i.jsx(Pb,{size:18})}),i.jsx("button",{className:"action-icon-btn",onClick:()=>{var K;return(K=G.current)==null?void 0:K.click()},title:"Attach Image",children:i.jsx(Ab,{size:18})}),i.jsx("button",{className:"action-icon-btn",onClick:Ne,title:"Reset",children:i.jsx(bn,{size:18})}),i.jsx("button",{className:"action-icon-btn",onClick:le,title:"Voice Input",children:i.jsx(Eb,{size:18})})]})]}),k&&i.jsx(Qb,{options:vW,children:i.jsx(rS,{onClose:()=>T(!1),patientData:R,tokenNumber:null,onAiSummaryChange:M})})]})]})},wW=({})=>{const e=At(),{openCommandBar:n}=Nb(),[t]=w.useState(!1),[r,a]=w.useState(null),[o,l]=w.useState(null);return w.useEffect(()=>{n()},[n]),w.useEffect(()=>{if(o){const d=setTimeout(()=>l(null),5e3);return()=>clearTimeout(d)}},[o]),t?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",o&&i.jsxs("div",{className:`alert-box ${o.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:o.type==="success"?i.jsx(vs,{size:18}):i.jsx(Ir,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:o.message})}),i.jsx("button",{onClick:()=>l(null),className:"alert-box-close",children:i.jsx(bn,{size:16})})]}),r&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(Ir,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:r})}),i.jsx("button",{onClick:()=>a(null),className:"alert-box-close",children:i.jsx(bn,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[i.jsx(Pk,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-hub"),className:"admin-nav-button",children:[i.jsx(Ik,{})," Clinic"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:"admin-nav-button",children:[i.jsx(lg,{})," Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/analysis"),className:"admin-nav-button",children:[i.jsx(b1,{})," Analysis"]}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(Q3,{})," Subscriptions"]}),i.jsx("button",{onClick:()=>e("/refill-reminders"),className:"admin-nav-button",children:"Refills"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(b1,{})," Labs"]}),i.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-nav-button",children:[i.jsx(Gh,{})," Patients"]})]}),i.jsx("div",{className:"admin-content-section",children:i.jsx(Eh,{})})]})},tu=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},SW=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},Sh=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:o,noDataText:l})=>{const d=w.useMemo(()=>{const f={};t.forEach(h=>{if(isNaN(h.date.getTime())){f["Unknown Date"]||(f["Unknown Date"]=[]),f["Unknown Date"].push(h);return}const g=SW(h.originalDateString);f[g]||(f[g]=[]),f[g].push(h)});const u=Object.keys(f);return u.sort((h,g)=>{if(h==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const T=k.split(" ");if(T.length===3){const M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(T[1]);if(M!==-1)return new Date(parseInt(T[2]),M,parseInt(T[0]))}return new Date(k)},v=b(h),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(h)}),u.map(h=>({date:h,items:f[h]}))},[t]);return i.jsxs("div",{className:"mb-2 bg-slate-50 rounded-lg border border-slate-200 overflow-hidden",children:[i.jsxs("h4",{className:"text-xs font-semibold text-slate-700 bg-slate-100 px-3 py-2 border-b border-slate-200 flex items-center",children:[n&&i.jsx(n,{size:14,className:"mr-2 text-indigo-600"}),e]}),i.jsxs("div",{className:"p-2",children:[a&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:o}),!a&&t.length===0&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:l}),!a&&t.length>0&&i.jsx("div",{className:"space-y-3",children:d.map(({date:f,items:u})=>i.jsxs("div",{children:[i.jsx("h5",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-1.5 px-1",children:f}),i.jsx("div",{className:"space-y-2 pl-2 border-l-2 border-slate-200 ml-1",children:u.map((h,g)=>i.jsx("div",{className:"flex items-start",children:i.jsx("div",{className:"flex-grow",children:r(h)})},`${h.type}-${h.originalDateString}-${g}`))})]},f))})]})]})},M0=()=>{var ne,le;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[T,P]=w.useState(null),{patientId:M}=Ki(),R=At(),z=w.useCallback(async oe=>{g(null),d(null),u(null),k(!0),P(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const E=await me(`/api/patients/${oe}`);if(!E.ok)throw new Error(`Patient details fetch failed (${E.status})`);const de=await E.json();d(de);const he=await me(`/api/queue/patient/${oe}/latest`);if(!he.ok&&he.status!==404)throw new Error(`Queue entry fetch failed (${he.status})`);if(he.ok){const D=await he.json();u(D)}await $(oe)}catch(E){console.error("Error fetching specific patient data:",E),g(E.message||"Failed to load patient data."),P(E.message||"Failed to load patient history.")}finally{k(!1)}},[]),$=w.useCallback(async oe=>{k(!0),P(null);try{const[E,de,he,D]=await Promise.all([me(`/api/queue/patient/${oe}/complaints`),me(`/api/lab/patient/${oe}`),me(`/api/lab/orders/patient/${oe}?status=pending`),me(`/api/pharmacy-orders/patient/${oe}`)]),pe=E.ok?await E.json():[],Ne=de.ok?await de.json():[],te=he.ok?await he.json():[],K=D.ok?await D.json():[];v({pastComplaints:pe||[],labReports:Ne||[],pendingLabOrders:te||[],pharmacyOrders:K||[]})}catch(E){console.error("Error fetching patient history:",E),P(E.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),L=w.useCallback(async()=>{r(!0),o(null);try{const oe=await me("/api/queue/doctor");if(!oe.ok){const de=await oe.text();throw new Error(`API Error (${oe.status}): ${de||oe.statusText}`)}const E=await oe.json();if(E===null||typeof E!="object"||typeof E.waitingCount!="number")throw console.error("Invalid queue data format:",E),new Error("Invalid queue data format received");n({currentPatient:E.currentPatient||null,nextPatient:E.nextPatient||null,waitingCount:E.waitingCount})}catch(oe){console.error("Error fetching queue data:",oe),o(oe.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let oe=null;return M?(z(M),n({currentPatient:null,nextPatient:null,waitingCount:0})):(L(),oe=setInterval(L,1e4),d(null),u(null)),()=>{oe&&clearInterval(oe)}},[M,z,L]),w.useEffect(()=>{var oe;!M&&((oe=e.currentPatient)!=null&&oe.patientId)?$(e.currentPatient.patientId):!M&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null))},[M,(ne=e.currentPatient)==null?void 0:ne.patientId,$]);const U=((le=e.currentPatient)==null?void 0:le.patientId)||(M?parseInt(M,10):null),B=w.useMemo(()=>{if(!U||!b.pastComplaints)return[];const oe=b.pastComplaints.map(E=>({date:new Date(E.createdAt),type:"Complaint",data:E,originalDateString:E.createdAt})).filter(E=>!isNaN(E.date.getTime()));return oe.sort((E,de)=>de.date.getTime()-E.date.getTime()),oe},[U,b.pastComplaints]),W=w.useMemo(()=>{if(!U)return[];const oe=[];return(b.pendingLabOrders??[]).forEach(E=>{const de=new Date(E.createdAt);isNaN(de.getTime())||oe.push({date:de,type:"Lab Order (Pending)",data:E,originalDateString:E.createdAt})}),(b.labReports??[]).forEach(E=>{const de=E.reportCreatedAt?new Date(E.reportCreatedAt):null;de&&!isNaN(de.getTime())&&oe.push({date:de,type:"Lab Report",data:E,originalDateString:E.reportCreatedAt})}),oe.sort((E,de)=>de.date.getTime()-E.date.getTime()),oe},[U,b.pendingLabOrders,b.labReports]),I=w.useMemo(()=>{if(!U||!b.pharmacyOrders)return[];const oe=b.pharmacyOrders.map(E=>({date:new Date(E.date),type:"Pharmacy Order",data:E,originalDateString:E.date})).filter(E=>!isNaN(E.date.getTime()));return oe.sort((E,de)=>de.date.getTime()-E.date.getTime()),oe},[U,b.pharmacyOrders]),F=async()=>{r(!0),o(null);try{await me("/api/queue/doctor/next",{method:"POST"}),await L()}catch(oe){console.error("Error calling next patient:",oe),o(oe.message||"Failed to call next patient.")}finally{r(!1)}},V=async()=>{if(!(!e.currentPatient||M)){r(!0),o(null);try{await me(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await L(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null)}catch(oe){console.error("Error completing consultation:",oe),o(oe.message||"Failed to complete consultation.")}finally{r(!1)}}},re=oe=>{switch(oe){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return oe}},[ie,G]=w.useState("info");let Y=null;return e.currentPatient&&(Y=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-teal-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${ie==="info"?"active":""}`,onClick:()=>G("info"),children:"Patient Details"}),i.jsx("button",{className:`mobile-tab-btn ${ie==="history"?"active":""}`,onClick:()=>G("history"),children:"History & Context"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${ie==="info"?"block":"hidden md:block"}`,children:[i.jsxs("h2",{className:"text-xl text-teal-700 font-semibold mb-3 flex items-center",children:["NOW SEEING",i.jsx("span",{className:"ml-2 text-xs font-normal text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:"Live Consultation"})]}),i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-3xl font-bold text-gray-800 mb-1 leading-tight",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg text-gray-600 flex items-center mt-1",children:[i.jsxs("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm mr-2",children:[e.currentPatient.age," Yrs"]}),i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0 flex flex-col items-end",children:[i.jsxs("div",{className:"text-2xl font-bold text-gray-700 mb-1",children:["#",e.currentPatient.token]}),i.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:re(e.currentPatient.status)})]})]}),e.currentPatient.case_summary&&i.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-100 rounded-md",children:[i.jsx("h4",{className:"text-xs font-bold text-amber-800 uppercase mb-1",children:"AI Brief"}),i.jsx("p",{className:"text-sm text-amber-900 leading-snug",children:e.currentPatient.case_summary})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex flex-col sm:flex-row justify-end gap-3 border-t pt-4",children:[i.jsxs("button",{onClick:()=>{var E;const oe=(E=e.currentPatient)==null?void 0:E._id;oe&&R(`/dashboard/edit-complaint/${oe}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary w-full sm:w-auto",children:[i.jsx(Cw,{size:16})," Open Consultation"]}),i.jsxs("button",{onClick:V,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success w-full sm:w-auto",children:[i.jsx(eF,{size:16})," Complete"]})]})]})," ",i.jsxs("div",{className:`complaint-section md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${ie==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-gray-800 mb-2 flex items-center justify-between",children:[i.jsx("span",{children:"History & Context"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Updating..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(Sh,{title:"Past Complaints",icon:lu,items:B,isLoading:S,loadingText:"Fetching...",noDataText:"No past complaints.",renderItemContent:oe=>i.jsxs("span",{className:"block text-xs",children:[oe.data.complaint,i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]})}),i.jsx(Sh,{title:"Lab Reports & Orders",icon:Hl,items:W,isLoading:S,loadingText:"Fetching...",noDataText:"No lab history.",renderItemContent:oe=>oe.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),oe.data.tests.map(E=>E.name).join(", "),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-green-700 mb-0.5",children:["Report: ",oe.data.testName]}),i.jsxs("div",{className:"text-gray-600 italic",children:['"',oe.data.reportFindings.substring(0,60),oe.data.reportFindings.length>60?"...":"",'"']}),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]})}),i.jsx(Sh,{title:"Medications",icon:$d,items:I,isLoading:S,loadingText:"Fetching...",noDataText:"No medication history.",renderItemContent:oe=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-gray-800",children:oe.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:[tu(oe.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:oe.data.status})]})]})}),B.length===0&&W.length===0&&I.length===0&&!S&&i.jsx("div",{className:"text-gray-400 text-center py-4 text-xs italic bg-gray-50 rounded border border-dashed border-gray-200",children:"No history records found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>R(-1),className:"back-button mr-4",children:i.jsx(an,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),M?i.jsxs(i.Fragment,{children:[h&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:h}),l&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-purple-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${ie==="info"?"active":""}`,onClick:()=>G("info"),children:"Patient Record"}),i.jsx("button",{className:`mobile-tab-btn ${ie==="history"?"active":""}`,onClick:()=>G("history"),children:"History"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${ie==="info"?"block":"hidden md:block"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold flex items-center gap-2",children:"Patient Record"}),i.jsxs("button",{onClick:()=>R("/dashboard/doctor"),className:"text-xs font-medium text-slate-500 hover:text-slate-800 flex items-center gap-1 transition-colors px-2 py-1 bg-slate-100 rounded",children:[i.jsx(an,{size:12})," Back to Queue"]})]}),i.jsx("div",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-700 to-indigo-600 mb-1 leading-tight",children:l.name}),i.jsxs("div",{className:"text-lg text-slate-600 mb-4 flex items-center gap-2",children:[i.jsxs("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:[l.age||"N/A"," Yrs"]}),i.jsx("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:l.gender||"N/A"})]}),i.jsxs("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-sm",children:[i.jsx("label",{className:"font-semibold block mb-2 text-xs uppercase tracking-wider text-slate-500",children:"Latest Activity"}),f?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words text-slate-700",children:[i.jsx("span",{className:"font-medium text-slate-900",children:"Complaint:"})," ",f.complaint||i.jsx("span",{className:"text-slate-400 italic",children:"None"}),i.jsx("div",{className:"mt-1",children:i.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${f.status==="consulting"?"bg-teal-100 text-teal-800":f.status==="seen"?"bg-emerald-100 text-emerald-800":f.status==="waiting"?"bg-blue-100 text-blue-800":"bg-slate-100 text-slate-800"}`,children:re(f.status)})})]}),f.status==="consulting"&&f._id&&i.jsx("button",{onClick:()=>R(`/dashboard/edit-complaint/${f._id}`),className:"ml-4 px-3 py-1.5 text-xs bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-md font-medium border border-indigo-200 transition-colors",children:"Resume"})]}),f.case_summary&&i.jsxs("div",{className:"text-xs text-slate-700 bg-amber-50 p-2.5 rounded border border-amber-100",children:[i.jsx("span",{className:"font-bold text-amber-800 uppercase text-[10px] block mb-1",children:"AI Summary"}),f.case_summary]})]}):i.jsx("p",{className:"text-slate-400 italic text-sm",children:"No queue entry found for this patient today."})]})]}),i.jsxs("div",{className:`md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${ie==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-slate-800 mb-3 flex items-center justify-between",children:[i.jsx("span",{children:"Patient History"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Loading..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(Sh,{title:"Past Complaints",icon:lu,items:B,isLoading:S,loadingText:"Loading...",noDataText:"No past complaints.",renderItemContent:oe=>i.jsxs("div",{className:"text-xs",children:[oe.data.complaint,i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]})}),i.jsx(Sh,{title:"Lab Reports",icon:Hl,items:W,isLoading:S,loadingText:"Loading...",noDataText:"No lab history.",renderItemContent:oe=>oe.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),i.jsx("div",{children:oe.data.tests.map(E=>E.name).join(", ")}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-emerald-700 mb-0.5",children:["Report: ",oe.data.testName]}),i.jsxs("div",{className:"text-slate-600 italic",children:['"',oe.data.reportFindings.substring(0,50),oe.data.reportFindings.length>50?"...":"",'"']}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]})}),i.jsx(Sh,{title:"Medications",icon:$d,items:I,isLoading:S,loadingText:"Loading...",noDataText:"No pharmacy history.",renderItemContent:oe=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-slate-800",children:oe.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:[tu(oe.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:oe.data.status})]})]})}),B.length===0&&W.length===0&&I.length===0&&!S&&i.jsx("div",{className:"text-slate-400 text-center py-4 text-xs italic bg-slate-50 rounded border border-dashed border-slate-200",children:"No history records found."})]})]})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>R("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx($k,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>R("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:Y||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:re(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:F,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},yE=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=At(),R=w.useCallback(zT.debounce(async I=>{if(I.trim().length<2){r([]),k(!1);return}k(!0),P(null);try{const F=new URLSearchParams({search:encodeURIComponent(I),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),V=await me(`/api/patients?${F.toString()}`);if(!V.ok){const ie=await V.text();throw new Error(`API Error (${V.status}): ${ie||V.statusText||"Failed to fetch patients"}`)}const re=await V.json();r(re.patients)}catch(F){P(F instanceof Error?F.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),R(e)):(r([]),R.cancel()),()=>{R.cancel()}),[e,R]);const z=I=>{o(I),n(""),r([]),P(null),d(null),u(null),g(null),v(!1)},$=async()=>{if(!a){P("No patient selected.");return}P(null),k(!0);try{const I=await me(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok){const V=await I.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(V.message||"Failed to admit patient")}const F=await I.json();alert(F.message||"Patient admitted successfully!"),F.bill&&F.bill.id?M(`/patient/${a.id}/admission-bill/${F.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),P("Admission successful, but couldn't navigate to billing."),o(F.patient))}catch(I){P(I instanceof Error?I.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){d(null),g(null);return}v(!0),u(null),d(null),g(null);try{const F=await me(`/api/patients/${a.id}/active-bill?type=admission`);if(!F.ok)throw F.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const V=await F.json(),re=V==null?void 0:V.id;if(!re)throw new Error("Active admission bill ID not found in response.");d(re);const ie=await me(`/api/bills/${re}`);if(!ie.ok)throw new Error(`Failed to fetch bill details (ID: ${re}). Status: ${ie.status}`);const G=await ie.json();if(G&&G.calculated)g(G.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",G),new Error("Fetched bill details are incomplete (missing calculated data).")}catch(F){u(F instanceof Error?F.message:"An unknown error occurred while fetching bill details."),d(null),g(null)}finally{v(!1)}})()},[a]);const L=async()=>{if(!a){P("No patient selected.");return}if(!a.admission_date||a.discharge_date){P("Patient is not currently admitted.");return}P(null),k(!0);try{const I=await me(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok){const V=await I.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(V.message||"Failed to discharge patient")}const F=await I.json();alert(F.message||"Patient discharged successfully!"),F.patient?o(F.patient):(console.error("Discharge successful, but updated patient info missing in response."),o(null),P("Discharge successful, but couldn't update patient details locally."))}catch(I){P(I instanceof Error?I.message:"Failed to discharge patient")}finally{k(!1)}},U=()=>{if(!a||!l){P("Cannot navigate to billing: Patient or Bill ID missing.");return}M(`/patient/${a.id}/admission-bill/${l}`)};let B="",W=null;if(a){const I=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,F=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(B=`Patient admitted on: ${I}`,W=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",f&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:f})," ",!b&&h&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(h.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(h.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(h.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:U,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!f?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:L,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(B=`Patient admitted on ${I} and discharged on ${F}.`,W=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(B="Patient is not admitted.",W=i.jsx("button",{onClick:$,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>M(-1),className:"back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:I=>n(I.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(I=>i.jsxs("li",{onClick:()=>z(I),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",I.name," (Token: ",I.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[I.admission_date?`Admitted: ${new Date(I.admission_date).toLocaleDateString()}`:"Not Admitted",I.discharge_date?`, Discharged: ${new Date(I.discharge_date).toLocaleDateString()}`:""]})]},I.id))]}),t.length===0&&e&&!S&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>o(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:B})," ",T&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",W]})]})},O0=15,G1=()=>{const e=At(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(""),[u,h]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,T]=w.useState("created_at"),[P,M]=w.useState("desc"),[R,z]=w.useState(""),[$,L]=w.useState(!1),[U,B]=w.useState(null),[W,I]=w.useState([]),[F,V]=w.useState(""),[re,ie]=w.useState(!1),[G,Y]=w.useState(null),[ne,le]=w.useState(!0),[oe,E]=w.useState(null),[de,he]=w.useState(d);w.useEffect(()=>{const Q=setTimeout(()=>{he(d),h(1)},500);return()=>{clearTimeout(Q)}},[d]);const D=w.useCallback(async()=>{le(!0),E(null);try{const Q=await me("/api/subscriptions");if(!Q.ok){let Re=`Failed to fetch subscription plans (${Q.status})`;try{Re=(await Q.json()).message||Re}catch{}throw new Error(Re)}const Pe=await Q.json();I(Pe)}catch(Q){console.error("Error fetching subscription plans:",Q),E(Q.message||"An unknown error occurred while fetching plans."),I([])}finally{le(!1)}},[]),pe=w.useCallback(async(Q,Pe,Re,Le,_e)=>{a(!0),l(null);try{const Ke=new URLSearchParams({page:Q.toString(),limit:O0.toString(),sortBy:Re,sortOrder:Le});Pe&&Ke.append("search",Pe),_e&&Ke.append("gender",_e);const Ye=await me(`/api/patients?${Ke.toString()}`);if(!Ye.ok){const xt=await Ye.json();throw new Error(xt.message||"Failed to fetch patients")}const it=await Ye.json();t(it.patients),S(it.totalCount),h(it.currentPage),b(it.totalPages)}catch(Ke){console.error("Error fetching patients:",Ke),l(`Failed to load patients: ${Ke.message}`),t([]),S(0),h(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{pe(u,de,k,P,R),D()},[u,de,k,P,R,pe,D]);const Ne=Q=>{const Pe=k===Q&&P==="asc"?"desc":"asc";T(Q),M(Pe),h(1)},te=Q=>{try{return new Date(Q).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},K=()=>{L(!1),B(null),V(""),Y(null),ie(!1)},J=async(Q,Pe)=>{t(Re=>Re.map(Le=>Le.id===Q?{...Le,insurance_type:Pe}:Le));try{const Re=await me(`/api/patients/${Q}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Pe})});if(!Re.ok){const Le=await Re.json();throw new Error(Le.message||"Failed to update insurance type")}}catch(Re){console.error("Error updating insurance type:",Re),pe(u,de,k,P,R)}},ye=(Q,Pe)=>{const Re=new Date(Q),Le=Pe.interval||1;switch(Pe.period){case"daily":Re.setDate(Q.getDate()+Le);break;case"weekly":Re.setDate(Q.getDate()+Le*7);break;case"monthly":Re.setMonth(Q.getMonth()+Le);break;case"yearly":Re.setFullYear(Q.getFullYear()+Le);break;default:console.warn(`Unknown subscription period: ${Pe.period}. Defaulting to 1 month.`),Re.setMonth(Q.getMonth()+1)}return Re},He=async()=>{if(!U||!F){Y("Please select a subscription plan.");return}const Q=W.find(Pe=>Pe.id===F);if(!Q){Y("Selected plan details not found.");return}ie(!0),Y(null);try{const Pe=new Date,Re=ye(Pe,Q),Le={subscription_plan_id:F,subscription_status:"active",subscription_start_date:Pe.toISOString(),subscription_end_date:Re.toISOString(),subscription_payment_method:"manual"},_e=await me(`/api/patients/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Le)});if(!_e.ok){const Ke=await _e.json();throw new Error(Ke.message||"Failed to update patient subscription")}K(),pe(u,de,k,P,R)}catch(Pe){console.error("Error starting subscription:",Pe),Y(`Failed to start subscription: ${Pe.message}`)}finally{ie(!1)}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(eo,{size:28}),"All Registered Patients"]}),o&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:ne?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):oe?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",oe]}):W.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:W.map(Q=>i.jsxs("li",{children:[i.jsx("strong",{children:Q.name}),": ",Q.price," / ",Q.interval," ",Q.period,Q.interval>1?"s":"",Q.description&&i.jsx("span",{className:"plan-description",children:Q.description})]},Q.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:d,onChange:Q=>f(Q.target.value)}),i.jsx(bi,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(iF,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:R,onChange:Q=>z(Q.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:de?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>Ne("name"),children:["Name",k==="name"&&(P==="asc"?i.jsx(g1,{size:14,className:"sort-icon"}):i.jsx(VN,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>Ne("created_at"),children:["Registered On",k==="created_at"&&(P==="asc"?i.jsx(g1,{size:14,className:"sort-icon"}):i.jsx(VN,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(Q=>i.jsxs("tr",{children:[i.jsx("td",{children:Q.token??"-"}),i.jsx("td",{className:"patient-name",children:Q.name}),i.jsx("td",{children:Q.age??"-"}),i.jsx("td",{children:Q.gender??"-"}),i.jsx("td",{children:Q.phone??"-"}),i.jsx("td",{children:Q.address??"-"}),i.jsx("td",{children:te(Q.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${Q.subscription_status==="active"?"active":Q.subscription_status==="cancelled"||Q.subscription_status==="expired"?"inactive":"none"}`,children:Q.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:Q.insurance_type,onChange:Pe=>J(Q.id,Pe.target.value),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>e(`/start-subscription/${Q.id}`),className:"action-button",children:"Start Sub"})})]},Q.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(u-1)*O0+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(u*O0,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>h(Q=>Math.max(Q-1,1)),disabled:u===1||r,className:"pagination-button",children:[i.jsx(Tb,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:u})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>h(Q=>Math.min(Q+1,g)),disabled:u===g||r,className:"pagination-button",children:["Next",i.jsx(Gd,{size:16,className:"next-icon"})]})]})]})]}),$&&U&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",U.name]}),i.jsx("button",{onClick:K,className:"subscription-modal-close-button",children:i.jsx(bn,{size:24})})]}),G&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:G})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:F,onChange:Q=>V(Q.target.value),className:"form-select",disabled:re||ne||oe!==null||W.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),ne?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):oe?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):W.length>0?W.map(Q=>i.jsxs("option",{value:Q.id,children:[Q.name," - ",Q.price," (",Q.interval," ",Q.period,Q.interval>1?"s":"",")"]},Q.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),oe&&i.jsx("p",{className:"error-message",children:oe}),W.length===0&&!ne&&!oe&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:K,disabled:re,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:He,disabled:!F||re,className:"subscription-modal-button submit",children:re?"Starting...":"Start Subscription"})]})]})})]})},xE=()=>{const e=At(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,o]=w.useState([]),[l,d]=w.useState(!1),[f,u]=w.useState(null),[h,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>fg(async P=>{if(P.trim().length<2){o([]),d(!1),u(null);return}d(!0),u(null);try{const M=new URLSearchParams({search:encodeURIComponent(P),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),R=await me(`/api/patients?${M.toString()}`);if(!R.ok){const $=await R.text();throw new Error(`API Error (${R.status}): ${$||R.statusText}`)}const z=await R.json();o(z.patients)}catch(M){console.error("Error searching patients:",M),u(M.message||"Failed to search patients."),o([])}finally{d(!1)}},300),[]),S=P=>{const M=P.target.value;r(M),g(b.test(M)),d(!0),v(M)},k=w.useCallback(P=>{e("/billing",{state:{patientId:P.id,patientName:P.name}})},[e]),T=w.useCallback(async()=>{if(!t||!h){u("Invalid phone number to create a new patient.");return}d(!0),u(null);try{const M=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!M.ok){const z=await M.json();throw new Error(z.message||`Failed to create patient: ${M.statusText}`)}const R=await M.json();alert(`New patient "direct pharmacy" created with phone ${R.phone}.`),k(R)}catch(P){console.error("Error creating new patient:",P),u(P.message||"Failed to create new patient.")}finally{d(!1)}},[t,h,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(an,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),f&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:f}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(P=>i.jsxs("li",{onClick:()=>k({id:P.id,name:P.name,token:P.token,age:P.age,gender:P.gender,phone:P.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",P.token]}),P.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[P.age?`${P.age} yrs`:"Age N/A",P.gender?` / ${P.gender}`:" / Gender N/A",P.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",P.phone]})]})]}),P.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",P.phone]})]},P.id))})}),t.length>=2&&!l&&a.length===0&&!f&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),h&&i.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},bE=({currentUser:e})=>{const n=At(),[t,r]=w.useState("select_patient"),[a,o]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,d]=w.useState(null),[f,u]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[T,P]=w.useState(""),[M,R]=w.useState([]),[z,$]=w.useState(!1),[L,U]=w.useState(null),[B,W]=w.useState(null),[I,F]=w.useState(null),[V,re]=w.useState(!1),[ie,G]=w.useState(!1),[Y,ne]=w.useState(!1),le=/^\+?[0-9\s\-().]{7,20}$/,oe=/^[a-zA-Z\s'-]{2,}$/,E=w.useCallback(async()=>{if(!(f.length>0)){re(!0),F(null);try{const Q=await me("/api/lab-tests");if(!Q.ok)throw new Error("Failed to fetch lab tests");const Pe=await Q.json();u(Pe)}catch(Q){console.error("Failed to fetch available lab tests:",Q),F("Could not load lab test list: "+Q.message),u([])}finally{re(!1)}}},[f.length]);w.useEffect(()=>{if(!b){k([]);return}const Q=b.toLowerCase();k(f.filter(Pe=>Pe.name.toLowerCase().includes(Q)||Pe.description&&Pe.description.toLowerCase().includes(Q)).slice(0,10))},[b,f]);const de=w.useCallback(Q=>{const Pe={id:Q.id,name:Q.name,token:Q.token,age:Q.age,gender:Q.gender,phone:Q.phone};d(Pe),r("create_order"),g([]),v(""),k([]),F(null),E()},[E]),he=w.useMemo(()=>fg(async Q=>{if(Q.trim().length<2){R([]),$(!1),U(null);return}$(!0),U(null);try{const Pe=new URLSearchParams({search:encodeURIComponent(Q),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Re=await me(`/api/patients?${Pe.toString()}`);if(!Re.ok){const _e=await Re.text();throw new Error(`API Error (${Re.status}): ${_e||Re.statusText}`)}const Le=await Re.json();R(Le.patients)}catch(Pe){console.error("Error searching lab patients:",Pe),U(Pe.message||"Failed to search lab patients."),R([])}finally{$(!1)}},300),[le,oe]),D=Q=>{const Pe=Q.target.value;P(Pe),G(le.test(Pe)),ne(oe.test(Pe)&&!le.test(Pe)),$(!0),he(Pe)},pe=w.useCallback(async Q=>{if(!T||Q==="phone"&&!ie||Q==="name"&&!Y){U(`Invalid ${Q} to create a new patient.`);return}$(!0),U(null);try{const Re=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Q==="name"?T:"direct lab",phone:Q==="phone"?T:null,age:null,gender:null,token:null})});if(!Re.ok){const _e=await Re.json();throw new Error(_e.message||`Failed to create patient: ${Re.statusText}`)}const Le=await Re.json();alert(`New patient "${Le.name}" created with ${Q==="phone"?`phone ${Le.phone}`:`name ${Le.name}`}.`),de({id:Le.id,name:Le.name,token:Le.token??null,age:Le.age??null,gender:Le.gender??null,phone:Le.phone})}catch(Pe){console.error("Error creating new patient:",Pe),U(Pe.message||"Failed to create new patient.")}finally{$(!1)}},[T,ie,Y,de]),Ne=()=>{r("select_patient"),d(null),P(""),R([]),U(null)},te=Q=>{const{name:Pe,value:Re}=Q.target;o(Le=>({...Le,[Pe]:Pe==="age"?Re?parseInt(Re,10):void 0:Re}))},K=async Q=>{if(Q.preventDefault(),W(null),!a.name){W("Patient Name is required.");return}const Pe={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const Re=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!Re.ok){const _e=await Re.json();throw new Error(_e.message||`Failed to create patient: ${Re.statusText}`)}const Le=await Re.json();alert(`Patient "${Le.name}" created successfully!`),de({id:Le.id,name:Le.name,token:Le.token??null,age:Le.age??null,gender:Le.gender??null,phone:Le.phone})}catch(Re){console.error("Failed to create patient:",Re),W(Re.message||"Failed to create patient. Please try again.")}},J=Q=>{if(h.some(Pe=>Pe.id===Q.id)){F(`${Q.name} is already in the order.`),setTimeout(()=>F(null),3e3),v(""),k([]);return}g(Pe=>[...Pe,{...Q}]),v(""),k([])},ye=Q=>{g(Pe=>Pe.filter(Re=>Re.id!==Q))},He=async Q=>{if(Q.preventDefault(),F(null),!l){F("No patient selected.");return}if(h.length===0){F("No lab tests selected.");return}const Pe={patient_id:l.id,tests:h.map(Re=>({id:Re.id,name:Re.name,price:Re.price}))};console.log("Submitting Lab Order:",Pe);try{const Re=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!Re.ok){const Ke=await Re.json();throw console.error("API Error Data:",Ke),new Error(Ke.message||`Failed to create lab order: ${Re.statusText}`)}const Le=await Re.json();console.log("Lab Order Creation Result:",Le);let _e=l.queueId;if(!_e){const Ke=await me(`/api/queue/patient/${l.id}/latest`);if(Ke.ok){const Ye=await Ke.json();Ye!=null&&Ye._id&&(_e=Ye._id)}}if(!_e){const Ke=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!Ke.ok){const it=await Ke.text();throw new Error(`Failed to create queue entry for redirection: ${it||Ke.statusText}`)}const Ye=await Ke.json();if(Ye!=null&&Ye.id)_e=Ye.id;else throw new Error("Failed to get ID from new queue entry for redirection.")}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${_e}`)}catch(Re){console.error("Failed to create lab order:",Re),F(Re.message||"Failed to create lab order.")}};return w.useEffect(()=>{E()},[E]),i.jsxs("div",{className:"create-lab-order-container",children:[i.jsxs("div",{className:"create-lab-order-header",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:[i.jsx(an,{size:20,style:{marginRight:"8px"}}),"Back"]}),i.jsx("h1",{className:"create-lab-order-title",children:"Create New Lab Order"}),i.jsx("div",{style:{width:"64px"}})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"glass-card",children:[t==="select_patient"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"header-with-action",children:i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Select Patient"})}),i.jsxs("div",{className:"search-container",children:[i.jsx(bi,{className:"search-icon",size:20}),i.jsx("input",{type:"text",id:"lab-patient-search",placeholder:"Search by Name, Token No, or Phone No...",value:T,onChange:D,className:"modern-input",autoFocus:!0,autoComplete:"off"}),z&&i.jsx("span",{className:"loading-text",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)",fontSize:"0.8rem"},children:"Searching..."})]}),L&&i.jsxs("div",{className:"error-message",children:[i.jsx(Ir,{size:18}),L]}),M.length>0&&i.jsx("ul",{className:"patient-list",children:M.map(Q=>i.jsxs("li",{onClick:()=>de(Q),className:"patient-list-item",children:[i.jsxs("div",{className:"patient-info",children:[i.jsx("strong",{children:Q.name}),i.jsxs("span",{className:"token-badge",children:["#",Q.token||"N/A"]})]}),i.jsxs("div",{className:"patient-details",children:[Q.age?`${Q.age} yrs`:"",Q.gender?` / ${Q.gender}`:"",Q.phone?`  ${Q.phone}`:""]})]},Q.id))}),T.length>=2&&!z&&M.length===0&&!L&&i.jsxs("div",{style:{textAlign:"center",marginTop:"20px"},children:[i.jsxs("p",{className:"no-data-message",style:{background:"none",border:"none",padding:0},children:['No patients found matching "',T,'".']}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"15px",marginTop:"15px"},children:[ie&&i.jsxs("button",{type:"button",onClick:()=>pe("phone"),className:"secondary-button",children:['Create "Direct Lab" Patient (Phone: ',T,")"]}),Y&&i.jsxs("button",{type:"button",onClick:()=>pe("name"),className:"secondary-button",children:["Create Patient (Name: ",T,")"]})]})]}),T.length<2&&!z&&i.jsx("div",{className:"info-message",children:"Start typing to search for a patient..."})]}),t==="create_patient"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"New Patient Registration"}),i.jsx("button",{onClick:Ne,className:"text-button",children:" Back to Search "})]}),B&&i.jsxs("div",{className:"error-message",children:[i.jsx(Ir,{size:18}),B]}),i.jsxs("form",{onSubmit:K,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-name",className:"form-label",children:"Patient Name *"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(eo,{className:"search-icon",size:18}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:te,className:"modern-input",placeholder:"Enter full name"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:te,className:"modern-input",style:{paddingLeft:"16px"},placeholder:"e.g. 30"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:te,className:"modern-input",style:{paddingLeft:"16px"},children:[i.jsx("option",{value:"",children:"Select Gender..."}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-phone",className:"form-label",children:"Phone Number"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Mk,{className:"search-icon",size:18}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:te,className:"modern-input",placeholder:"e.g. 9876543210"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-address",className:"form-label",children:"Address"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Rk,{className:"search-icon",size:18,style:{top:"20px"}}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:te,className:"modern-input",style:{resize:"none"},placeholder:"Enter address (optional)"})]})]})]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:Ne,className:"secondary-button",children:" Cancel "}),i.jsxs("button",{type:"submit",className:"primary-button",children:[i.jsx(tl,{size:18}),"Create & Proceed"]})]})]})]})]}),t==="create_order"&&l&&i.jsxs("div",{className:"glass-card",children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Create Lab Order"}),i.jsx("button",{onClick:Ne,className:"text-button",children:" Change Patient "})]}),i.jsxs("div",{className:"patient-summary",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(eo,{size:20,className:"highlight-primary"}),i.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"600"},children:l.name})]}),i.jsxs("div",{className:"patient-details",style:{marginLeft:"30px",marginTop:"4px"},children:[l.age?`${l.age} yrs`:"Age N/A",l.gender&&`  ${l.gender}`,l.phone&&`  ${l.phone}`]})]}),I&&i.jsxs("div",{className:"error-message",children:[i.jsx(Ir,{size:18}),I]}),i.jsxs("form",{onSubmit:He,children:[i.jsxs("div",{className:"form-group",style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",className:"form-label",children:"Add Lab Test"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(bi,{className:"search-icon",size:18}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search tests (e.g. CBC, Lipid Profile)...",value:b,onChange:Q=>v(Q.target.value),className:"modern-input",disabled:V,autoComplete:"off"}),V&&i.jsx("div",{className:"loading-spinner-small",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)"}})]}),b&&S.length>0&&i.jsx("div",{className:"search-results-dropdown",children:S.map(Q=>i.jsxs("div",{onClick:()=>J(Q),className:"search-result-item",children:[i.jsx("span",{style:{fontWeight:500},children:Q.name}),i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(Q.price).toFixed(2)]})]},Q.id))}),b&&S.length===0&&!V&&i.jsxs("div",{className:"no-data-message",style:{marginTop:"5px",padding:"10px",fontSize:"0.9rem"},children:['No tests found matching "',b,'".']})]}),i.jsxs("div",{style:{marginTop:"30px"},children:[i.jsxs("h4",{className:"card-title",style:{fontSize:"1.1rem"},children:["Selected Tests (",h.length,")"]}),h.length===0?i.jsx("div",{className:"info-message",children:"No tests added yet. Search above to add tests."}):i.jsx("div",{className:"selected-tests-list",children:h.map(Q=>i.jsxs("div",{className:"selected-test-item",children:[i.jsx("div",{style:{flex:1},children:i.jsx("div",{style:{fontWeight:500},children:Q.name})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(Q.price).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>ye(Q.id),className:"remove-button",title:"Remove Test",children:i.jsx(Wr,{size:18})})]})]},Q.id))})]}),h.length>0&&i.jsxs("div",{className:"total-price",children:["Total: ",h.reduce((Q,Pe)=>Q+parseFloat(Pe.price),0).toFixed(2)]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:Ne,className:"secondary-button",children:" Cancel Order "}),i.jsxs("button",{type:"submit",disabled:h.length===0,className:"primary-button",children:[i.jsx(ZF,{size:18}),"Create Lab Order"]})]})]})]})]})},NW=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[o,l]=w.useState([]),[d,f]=w.useState(!0),[u,h]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(null),P=At(),M=qr(),R=async()=>{f(!0),T(null);let I=[];try{const F=await me("/api/queue");if(!F.ok){const ie=await F.json();throw new Error(ie.message||"Failed to fetch queue")}I=await F.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(I,null,2));const V=I.map(async ie=>{if(!ie.patient_id)return console.warn(`Queue entry ${ie.id} has no patient_id.`),ie;try{const G=await me(`/api/patients/${ie.patient_id}`);if(!G.ok)return console.error(`Failed to fetch patient details for ${ie.patient_id}: ${G.status}`),ie;const Y=await G.json();return{...ie,Patient:{...ie.Patient??{},...Y}}}catch(G){return console.error(`Error fetching patient details for ${ie.patient_id}:`,G),ie}}),re=await Promise.all(V);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(re,null,2)),re.sort((ie,G)=>{var E,de;const Y=((E=ie.Patient)==null?void 0:E.subscription_status)==="active",ne=((de=G.Patient)==null?void 0:de.subscription_status)==="active";if(Y&&!ne)return-1;if(!Y&&ne)return 1;const le=ie.created_at?new Date(ie.created_at).getTime():0,oe=G.created_at?new Date(G.created_at).getTime():0;return le-oe}),console.log("Sorted Queue Data:",JSON.stringify(re,null,2)),l(re)}catch(F){console.error("Error in fetchQueue process:",F),T(`Failed to load queue: ${F.message}`),l(I)}finally{f(!1)}},z=async()=>{b(!0),T(null);try{const I=await me("/api/staff?role=doctor");if(!I.ok){const V=await I.json();throw new Error(V.message||"Failed to fetch doctors")}const F=await I.json();h(F.filter(V=>V.active))}catch(I){console.error("Error fetching doctors:",I),T(`Failed to fetch doctors: ${I.message}`)}finally{b(!1)}};w.useEffect(()=>{const F=new URLSearchParams(M.search).get("tab");F&&U.find(re=>re.id===F)&&t(F)},[M.search]),w.useEffect(()=>{n==="queue"&&(R(),z()),S(null)},[n]);const $=w.useCallback(async(I,F)=>{if(console.log(`Attempting to assign doctor ${F} to queue ${I}`),T(null),S(null),!F){console.log("No doctor ID provided, skipping assignment.");return}const V=o.find(G=>G.id===I);if(!V){console.error(`Queue entry ${I} not found in local state.`),T("Queue entry not found.");return}if(V.doctor_id===F){console.log(`Queue ${I} already assigned to doctor ${F}. Skipping.`);return}const re=async G=>{if(!G||!G.id||!G.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",G);return}const Y=async()=>{try{const ne={status:"waiting",doctorId:F},le=await me(`/api/queue/${I}/status`,{method:"PATCH",body:JSON.stringify(ne)}),oe=await le.json();if(!le.ok)throw new Error(oe.message||`HTTP error! status: ${le.status}`);const E=u.find(de=>de.id===F);return console.log(`Successfully assigned doctor ${E==null?void 0:E.name} to queue ${I}.`),l(de=>de.map(he=>he.id===I?{...he,doctor_id:F,status:oe.status||he.status,User:E?{name:E.name}:null,Patient:G}:he)),!0}catch(ne){return console.error(`Error assigning doctor for queue ${I}:`,ne),T(`Failed to assign doctor: ${ne.message}`),!1}};G.subscription_status==="active"?(console.log(`Patient ${G.name} (ID: ${G.id}) has active subscription. Assigning doctor directly.`),await Y()):(console.log(`Patient ${G.name} (ID: ${G.id}) does not have active subscription (Status: ${G.subscription_status}). Assigning doctor and proceeding to billing.`),await Y()?(console.log(`Navigating to billing for patient ${G.name} (ID: ${G.id}), queue ID: ${I}, doctor ID: ${F}`),P("/billing",{state:{patientId:G.id,queueId:I,patientName:G.name,doctorId:F,billType:"consultation"}})):console.log(`Assignment failed for patient ${G.name}, skipping navigation.`))},ie=V.Patient;if(ie&&ie.id&&ie.name)console.log("Patient details found in state. Proceeding with assignment."),await re(ie);else{console.warn(`Patient details missing for queue entry ${I}. Fetching patient ${V.patient_id}...`);try{const G=await me(`/api/patients/${V.patient_id}`);if(!G.ok){const ne=await G.json().catch(()=>({}));throw new Error(ne.message||`Failed to fetch patient details (status ${G.status})`)}const Y=await G.json();console.log("Successfully fetched patient details:",Y),await re(Y)}catch(G){console.error(`Failed to fetch patient details for patient ID ${V.patient_id}:`,G),T(`Failed to fetch required patient details: ${G.message}`)}}},[u,o,P]),L=async(I,F)=>{T(null);const V=F==="consulting"?"start consultation":"complete visit";try{const re=o.find(ne=>ne.id===I);if(!re&&F==="consulting")throw new Error("Queue entry not found to start consultation.");let ie={status:F};if(F==="consulting"){if(!(re!=null&&re.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");ie.doctorId=re.doctor_id}const G=await me(`/api/queue/${I}/status`,{method:"PATCH",body:JSON.stringify(ie)}),Y=await G.json();if(!G.ok)throw new Error(Y.message||`HTTP error! status: ${G.status}`);l(ne=>ne.map(le=>le.id===I?{...le,status:F}:le))}catch(re){console.error(`Error trying to ${V}:`,re),T(`Failed to ${V}: ${re.message}`)}},U=[{id:"queue",label:"Queue",icon:i.jsx(Gh,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(bi,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(b3,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(hF,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(b1,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(Ua,{size:20})}],B=I=>{try{return new Date(I).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},W=o.filter(I=>{var F,V;return(V=(F=I.Patient)==null?void 0:F.name)==null?void 0:V.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",U.map(I=>i.jsxs("button",{className:`reception-tab-button ${n===I.id?"active":""}`,onClick:()=>t(I.id),children:[i.jsx("span",{children:I.icon}),I.label]},I.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:I=>a(I.target.value)}),i.jsx(bi,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(I=>I.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(I=>I.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(I=>I.status==="seen").length})," "]})]})]}),d?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):W.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:W.map(I=>{var F,V,re,ie,G,Y,ne,le,oe,E,de;return i.jsxs("tr",{onClick:()=>P(`/dashboard/edit-complaint/${I.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",I.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:((F=I.Patient)==null?void 0:F.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[(V=I.Patient)!=null&&V.age?`${I.Patient.age} yrs, `:"",((re=I.Patient)==null?void 0:re.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((ie=I.Patient)==null?void 0:ie.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:I.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((G=I.Patient)==null?void 0:G.subscription_status)==="active"?"status-active":((Y=I.Patient)==null?void 0:Y.subscription_status)==="cancelled"||((ne=I.Patient)==null?void 0:ne.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((le=I.Patient)==null?void 0:le.subscription_status)??"None"}),I.Patient&&I.Patient.id&&I.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:he=>{he.stopPropagation(),I.Patient&&P(`/start-subscription/${I.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:B(I.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===I.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:he=>he.stopPropagation(),children:i.jsxs("select",{value:"",onChange:he=>$(I.id,he.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(he=>i.jsx("option",{value:he.id,children:he.name},he.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:he=>he.stopPropagation(),children:[" ",I.status==="waiting"&&i.jsx(i.Fragment,{children:(oe=I.User)!=null&&oe.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:I.User.name}),i.jsx("button",{onClick:()=>L(I.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):u.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?i.jsxs("button",{onClick:()=>$(I.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):i.jsx("button",{onClick:()=>S(I.id),className:"action-button btn-assign",children:"Assign"})}),I.status==="consulting"&&i.jsxs(i.Fragment,{children:[((E=I.User)==null?void 0:E.name)&&i.jsx("span",{className:"doctor-name-display",children:I.User.name}),i.jsx("button",{onClick:()=>L(I.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),I.status==="seen"&&i.jsxs(i.Fragment,{children:[((de=I.User)==null?void 0:de.name)&&i.jsx("span",{className:"doctor-name-display",children:I.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),I.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},I.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(bE,{currentUser:e}),i.jsxs("button",{onClick:()=>P("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(bi,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(Eh,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(yE,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(G1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(xE,{})})]})})},vE=6048e5,CW=864e5,wE=6e4,SE=36e5,V_=Symbol.for("constructDateFrom");function to(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&V_ in e?e[V_](n):e instanceof Date?new e.constructor(n):new Date(n)}function Oi(e,n){return to(n||e,e)}function _W(e,n,t){const r=Oi(e,t==null?void 0:t.in);if(isNaN(n))return to(e,NaN);const a=r.getDate(),o=to(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}let jW={};function Jb(){return jW}function rg(e,n){var d,f,u,h;const t=Jb(),r=(n==null?void 0:n.weekStartsOn)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??0,a=Oi(e,n==null?void 0:n.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function gb(e,n){return rg(e,{...n,weekStartsOn:1})}function NE(e,n){const t=Oi(e,n==null?void 0:n.in),r=t.getFullYear(),a=to(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=gb(a),l=to(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const d=gb(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function H_(e){const n=Oi(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function kW(e,...n){const t=to.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function G_(e,n){const t=Oi(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function TW(e,n,t){const[r,a]=kW(t==null?void 0:t.in,e,n),o=G_(r),l=G_(a),d=+o-H_(o),f=+l-H_(l);return Math.round((d-f)/CW)}function EW(e,n){const t=NE(e,n),r=to(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),gb(r)}function AW(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Y1(e){return!(!AW(e)&&typeof e!="number"||isNaN(+Oi(e)))}function PW(e,n){const t=Oi(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const DW={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},IW=(e,n,t)=>{let r;const a=DW[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function L0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const RW={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},MW={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},OW={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},LW={date:L0({formats:RW,defaultWidth:"full"}),time:L0({formats:MW,defaultWidth:"full"}),dateTime:L0({formats:OW,defaultWidth:"full"})},FW={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},$W=(e,n,t,r)=>FW[e];function Rm(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,d=t!=null&&t.width?String(t.width):l;a=e.formattingValues[d]||e.formattingValues[l]}else{const l=e.defaultWidth,d=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[d]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const zW={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},UW={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},BW={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},qW={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},VW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},HW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},GW=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},YW={ordinalNumber:GW,era:Rm({values:zW,defaultWidth:"wide"}),quarter:Rm({values:UW,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Rm({values:BW,defaultWidth:"wide"}),day:Rm({values:qW,defaultWidth:"wide"}),dayPeriod:Rm({values:VW,defaultWidth:"wide",formattingValues:HW,defaultFormattingWidth:"wide"})};function Mm(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],d=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(d)?QW(d,g=>g.test(l)):WW(d,g=>g.test(l));let u;u=e.valueCallback?e.valueCallback(f):f,u=t.valueCallback?t.valueCallback(u):u;const h=n.slice(l.length);return{value:u,rest:h}}}function WW(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function QW(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function JW(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const d=n.slice(a.length);return{value:l,rest:d}}}const KW=/^(\d+)(th|st|nd|rd)?/i,XW=/\d+/i,ZW={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},eQ={any:[/^b/i,/^(a|c)/i]},tQ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},nQ={any:[/1/i,/2/i,/3/i,/4/i]},rQ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},iQ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},aQ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},sQ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},oQ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},lQ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},cQ={ordinalNumber:JW({matchPattern:KW,parsePattern:XW,valueCallback:e=>parseInt(e,10)}),era:Mm({matchPatterns:ZW,defaultMatchWidth:"wide",parsePatterns:eQ,defaultParseWidth:"any"}),quarter:Mm({matchPatterns:tQ,defaultMatchWidth:"wide",parsePatterns:nQ,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Mm({matchPatterns:rQ,defaultMatchWidth:"wide",parsePatterns:iQ,defaultParseWidth:"any"}),day:Mm({matchPatterns:aQ,defaultMatchWidth:"wide",parsePatterns:sQ,defaultParseWidth:"any"}),dayPeriod:Mm({matchPatterns:oQ,defaultMatchWidth:"any",parsePatterns:lQ,defaultParseWidth:"any"})},uQ={code:"en-US",formatDistance:IW,formatLong:LW,formatRelative:$W,localize:YW,match:cQ,options:{weekStartsOn:0,firstWeekContainsDate:1}};function dQ(e,n){const t=Oi(e,n==null?void 0:n.in);return TW(t,PW(t))+1}function fQ(e,n){const t=Oi(e,n==null?void 0:n.in),r=+gb(t)-+EW(t);return Math.round(r/vE)+1}function CE(e,n){var h,g,b,v;const t=Oi(e,n==null?void 0:n.in),r=t.getFullYear(),a=Jb(),o=(n==null?void 0:n.firstWeekContainsDate)??((g=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=to((n==null?void 0:n.in)||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const d=rg(l,n),f=to((n==null?void 0:n.in)||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const u=rg(f,n);return+t>=+d?r+1:+t>=+u?r:r-1}function hQ(e,n){var d,f,u,h;const t=Jb(),r=(n==null?void 0:n.firstWeekContainsDate)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,a=CE(e,n),o=to((n==null?void 0:n.in)||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),rg(o,n)}function pQ(e,n){const t=Oi(e,n==null?void 0:n.in),r=+rg(t,n)-+hQ(t,n);return Math.round(r/vE)+1}function Yn(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const nu={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Yn(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Yn(t+1,2)},d(e,n){return Yn(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Yn(e.getHours()%12||12,n.length)},H(e,n){return Yn(e.getHours(),n.length)},m(e,n){return Yn(e.getMinutes(),n.length)},s(e,n){return Yn(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Yn(a,n.length)}},Nh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Y_={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return nu.y(e,n)},Y:function(e,n,t,r){const a=CE(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Yn(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Yn(o,n.length)},R:function(e,n){const t=NE(e);return Yn(t,n.length)},u:function(e,n){const t=e.getFullYear();return Yn(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Yn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Yn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return nu.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Yn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=pQ(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Yn(a,n.length)},I:function(e,n,t){const r=fQ(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Yn(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):nu.d(e,n)},D:function(e,n,t){const r=dQ(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Yn(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Yn(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Yn(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Yn(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Nh.noon:r===0?a=Nh.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Nh.evening:r>=12?a=Nh.afternoon:r>=4?a=Nh.morning:a=Nh.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return nu.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):nu.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Yn(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Yn(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):nu.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):nu.s(e,n)},S:function(e,n){return nu.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return Q_(r);case"XXXX":case"XX":return Md(r);case"XXXXX":case"XXX":default:return Md(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return Q_(r);case"xxxx":case"xx":return Md(r);case"xxxxx":case"xxx":default:return Md(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+W_(r,":");case"OOOO":default:return"GMT"+Md(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+W_(r,":");case"zzzz":default:return"GMT"+Md(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Yn(r,n.length)},T:function(e,n,t){return Yn(+e,n.length)}};function W_(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+Yn(o,2)}function Q_(e,n){return e%60===0?(e>0?"-":"+")+Yn(Math.abs(e)/60,2):Md(e,n)}function Md(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Yn(Math.trunc(r/60),2),o=Yn(r%60,2);return t+a+n+o}const J_=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},_E=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},mQ=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return J_(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",J_(r,n)).replace("{{time}}",_E(a,n))},gQ={p:_E,P:mQ},yQ=/^D+$/,xQ=/^Y+$/,bQ=["D","DD","YY","YYYY"];function vQ(e){return yQ.test(e)}function wQ(e){return xQ.test(e)}function SQ(e,n,t){const r=NQ(e,n,t);if(console.warn(r),bQ.includes(e))throw new RangeError(r)}function NQ(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const CQ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_Q=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,jQ=/^'([^]*?)'?$/,kQ=/''/g,TQ=/[a-zA-Z]/;function Fd(e,n,t){var h,g,b,v;const r=Jb(),a=r.locale??uQ,o=r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,l=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,d=Oi(e,t==null?void 0:t.in);if(!Y1(d))throw new RangeError("Invalid time value");let f=n.match(_Q).map(S=>{const k=S[0];if(k==="p"||k==="P"){const T=gQ[k];return T(S,a.formatLong)}return S}).join("").match(CQ).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:EQ(S)};if(Y_[k])return{isToken:!0,value:S};if(k.match(TQ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(f=a.localize.preprocessor(d,f));const u={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(S=>{if(!S.isToken)return S.value;const k=S.value;(wQ(k)||vQ(k))&&SQ(k,n,String(e));const T=Y_[k[0]];return T(d,k,a.localize,u)}).join("")}function EQ(e){const n=e.match(jQ);return n?n[1].replace(kQ,"'"):e}function F0(e,n){return+Oi(e)<+Oi(n)}function K_(e,n){const t=()=>to(n==null?void 0:n.in,NaN),a=IQ(e);let o;if(a.date){const u=RQ(a.date,2);o=MQ(u.restDateString,u.year)}if(!o||isNaN(+o))return t();const l=+o;let d=0,f;if(a.time&&(d=OQ(a.time),isNaN(d)))return t();if(a.timezone){if(f=LQ(a.timezone),isNaN(f))return t()}else{const u=new Date(l+d),h=Oi(0,n==null?void 0:n.in);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return Oi(l+d+f,n==null?void 0:n.in)}const Tx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},AQ=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,PQ=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,DQ=/^([+-])(\d{2})(?::?(\d{2}))?$/;function IQ(e){const n={},t=e.split(Tx.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],Tx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(Tx.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=Tx.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function RQ(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function MQ(e,n){if(n===null)return new Date(NaN);const t=e.match(AQ);if(!t)return new Date(NaN);const r=!!t[4],a=Om(t[1]),o=Om(t[2])-1,l=Om(t[3]),d=Om(t[4]),f=Om(t[5])-1;if(r)return BQ(n,d,f)?FQ(n,d,f):new Date(NaN);{const u=new Date(0);return!zQ(n,o,l)||!UQ(n,a)?new Date(NaN):(u.setUTCFullYear(n,o,Math.max(a,l)),u)}}function Om(e){return e?parseInt(e):1}function OQ(e){const n=e.match(PQ);if(!n)return NaN;const t=$0(n[1]),r=$0(n[2]),a=$0(n[3]);return qQ(t,r,a)?t*SE+r*wE+a*1e3:NaN}function $0(e){return e&&parseFloat(e.replace(",","."))||0}function LQ(e){if(e==="Z")return 0;const n=e.match(DQ);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return VQ(r,a)?t*(r*SE+a*wE):NaN}function FQ(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const $Q=[31,null,31,30,31,30,31,31,30,31,30,31];function jE(e){return e%400===0||e%4===0&&e%100!==0}function zQ(e,n,t){return n>=0&&n<=11&&t>=1&&t<=($Q[n]||(jE(e)?29:28))}function UQ(e,n){return n>=1&&n<=(jE(e)?366:365)}function BQ(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function qQ(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function VQ(e,n){return n>=0&&n<=59}const iS=({isEmbedded:e=!1})=>{const[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(null),g=w.useRef(null),[b,v]=w.useState(!1),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,R]=w.useState(!1),[z,$]=w.useState(null),[L,U]=w.useState({name:"",description:"",price:"",default_parameters:[]}),B=w.useCallback(async()=>{a(!0),l(null),h(null),k(null);try{const D=await me("/api/lab-tests");if(!D.ok)throw new Error(`HTTP error! status: ${D.status}`);const pe=await D.json();t(pe)}catch(D){console.error("Error fetching lab tests:",D),l(D.message||"Failed to fetch lab tests.")}finally{a(!1)}},[]);w.useEffect(()=>{B()},[B]);const W=D=>{const{name:pe,value:Ne}=D.target;U(te=>({...te,[pe]:Ne}))},I=(D,pe,Ne)=>{const te=[...L.default_parameters],K=te[D];if(pe==="type")switch(K.type=Ne,Ne){case"number":K.defaultValue=0,K.lower_limit=null,K.upper_limit=null,K.unit="";break;case"boolean":K.defaultValue=!1,K.lower_limit=void 0,K.upper_limit=void 0,K.unit=void 0;break;case"string":default:K.defaultValue="",K.lower_limit=void 0,K.upper_limit=void 0,K.unit=void 0;break}else pe==="defaultValue"?K.type==="number"?K.defaultValue=parseFloat(Ne)||0:(K.type,K.defaultValue=Ne):pe==="lower_limit"||pe==="upper_limit"?K[pe]=Ne===""?null:parseFloat(Ne):K[pe]=Ne;U(J=>({...J,default_parameters:te}))},F=()=>{U(D=>({...D,default_parameters:[...D.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},V=D=>{U(pe=>({...pe,default_parameters:pe.default_parameters.filter((Ne,te)=>te!==D)}))},re=async D=>{D.preventDefault(),a(!0),l(null);const pe=z!==null,Ne=pe?`/api/lab-tests/${z}`:"/api/lab-tests",te=pe?"PUT":"POST";try{const K=await me(Ne,{method:te,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:L.name,description:L.description,price:parseFloat(L.price),default_parameters:L.default_parameters})});if(!K.ok){const J=await K.json();throw new Error(J.message||`HTTP error! status: ${K.status}`)}R(!1),$(null),U({name:"",description:"",price:"",default_parameters:[]}),B()}catch(K){console.error(`Error ${pe?"updating":"adding"} lab test:`,K),l(K.message||`Failed to ${pe?"update":"add"} lab test.`)}finally{a(!1)}},ie=()=>{$(null),U({name:"",description:"",price:"",default_parameters:[]}),R(!0)},G=D=>{if(z===D.id)$(null);else{$(D.id);const pe=(D.default_parameters||[]).map(Ne=>({...Ne,unit:Ne.unit||"",lower_limit:Ne.lower_limit===void 0?null:Ne.lower_limit,upper_limit:Ne.upper_limit===void 0?null:Ne.upper_limit}));U({name:D.name,description:D.description||"",price:D.price,default_parameters:pe}),R(!1)}},Y=async D=>{if(window.confirm("Are you sure you want to delete this lab test?")){a(!0),l(null);try{const pe=await me(`/api/lab-tests/${D}`,{method:"DELETE"});if(!pe.ok){const Ne=await pe.json();throw new Error(Ne.message||`HTTP error! status: ${pe.status}`)}B()}catch(pe){console.error("Error deleting lab test:",pe),l(pe.message||"Failed to delete lab test.")}finally{a(!1)}}},ne=()=>{R(!1),$(null),l(null),U({name:"",description:"",price:"",default_parameters:[]})},le=async D=>{if(!D){h("No file selected.");return}f(!0),h(null),l(null);const pe=new FormData;pe.append("file",D);try{const Ne=await me("/api/lab-tests/import",{method:"POST",body:pe});if(!Ne.ok){const te=await Ne.json();throw new Error(te.message||`Import failed: ${Ne.statusText}`)}B()}catch(Ne){console.error("Error importing lab tests from Excel:",Ne),h(Ne.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},oe=async D=>{if(D.target.files&&D.target.files[0]){const pe=D.target.files[0];await le(pe),D.target&&(D.target.value="")}},E=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){v(!0),k(null),l(null);try{const D=await me("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!D.ok){const pe=await D.json();throw new Error(pe.message||`Default import failed: ${D.statusText}`)}B()}catch(D){console.error("Error importing default lab tests:",D),k(D.message||"Failed to import default lab tests.")}finally{v(!1)}}},de=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){P(!0),l(null),h(null),k(null);try{const D=await me("/api/lab-tests/all",{method:"DELETE"});if(!D.ok){const pe=await D.json();throw new Error(pe.message||`Delete all failed: ${D.statusText}`)}B()}catch(D){console.error("Error deleting all lab tests:",D),l(D.message||"Failed to delete all lab tests.")}finally{P(!1)}}},he=r||d||b||T;return i.jsxs("div",{className:`lab-inventory-card ${e?"embedded":""}`,style:e?{border:"none",boxShadow:"none",padding:0}:{},children:[!e&&i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:ie,className:"lab-inventory-button",disabled:he,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var D;return(D=g.current)==null?void 0:D.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:he,children:d?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:g,onChange:oe,accept:".xlsx, .xls",style:{display:"none"},disabled:d}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-secondary",disabled:he,children:b?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:de,className:"lab-inventory-button lab-inventory-button-danger",disabled:he,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:T?"Deleting All...":"Delete All Tests"})]}),o&&i.jsx("div",{className:"error-text mb-4",children:o}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),S&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",S]}),M&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:re,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:W,className:"lab-inventory-input",required:!0,disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:W,rows:3,className:"lab-inventory-input",disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price,onChange:W,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),L.default_parameters.map((D,pe)=>{var Ne,te;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:D.name,onChange:K=>I(pe,"name",K.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:D.type,onChange:K=>I(pe,"type",K.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),D.type==="boolean"?i.jsxs("select",{value:D.defaultValue.toString(),onChange:K=>I(pe,"defaultValue",K.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:D.type==="number"?"number":"text",placeholder:"Default Value",value:D.defaultValue.toString(),onChange:K=>I(pe,"defaultValue",K.target.value),className:"lab-inventory-input"}),D.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:D.lower_limit===null?"":((Ne=D.lower_limit)==null?void 0:Ne.toString())??"",onChange:K=>I(pe,"lower_limit",K.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:D.upper_limit===null?"":((te=D.upper_limit)==null?void 0:te.toString())??"",onChange:K=>I(pe,"upper_limit",K.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:D.unit||"",onChange:K=>I(pe,"unit",K.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>V(pe),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},pe)}),i.jsx("button",{type:"button",onClick:F,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:ne,className:"lab-inventory-button lab-inventory-button-secondary",disabled:he,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:he,children:r?"Saving...":"Add Test"})]})]})]}),he&&!M&&i.jsxs("p",{className:"loading-text",children:[" ",d?"Importing Excel data...":b?"Importing default data...":"Loading tests..."]}),!he&&n.length===0&&!o&&!u&&!S&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!he&&n.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:n.map(D=>{const pe=z===D.id,Ne=D.price&&typeof D.price=="string"?parseFloat(D.price):NaN,te=isNaN(Ne)?"0.00":Ne.toFixed(2);return i.jsxs(kn.Fragment,{children:[i.jsxs("tr",{onClick:()=>G(D),style:{cursor:"pointer"},children:[i.jsx("td",{children:D.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:D.description||"-"}),i.jsxs("td",{children:["",te]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:K=>{K.stopPropagation(),G(D)},className:"lab-inventory-link",disabled:he,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:K=>{K.stopPropagation(),Y(D.id)},className:"lab-inventory-link",disabled:he,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),pe&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:re,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:W,className:"lab-inventory-input",required:!0,disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:W,rows:3,className:"lab-inventory-input",disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price,onChange:W,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),L.default_parameters.map((K,J)=>{var ye,He;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:K.name,onChange:Q=>I(J,"name",Q.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:K.type,onChange:Q=>I(J,"type",Q.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),K.type==="boolean"?i.jsxs("select",{value:K.defaultValue.toString(),onChange:Q=>I(J,"defaultValue",Q.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:K.type==="number"?"number":"text",placeholder:"Default Value",value:K.defaultValue.toString(),onChange:Q=>I(J,"defaultValue",Q.target.value),className:"lab-inventory-input"}),K.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:K.lower_limit===null?"":((ye=K.lower_limit)==null?void 0:ye.toString())??"",onChange:Q=>I(J,"lower_limit",Q.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:K.upper_limit===null?"":((He=K.upper_limit)==null?void 0:He.toString())??"",onChange:Q=>I(J,"upper_limit",Q.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:K.unit||"",onChange:Q=>I(J,"unit",Q.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>V(J),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},J)}),i.jsx("button",{type:"button",onClick:F,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:ne,className:"lab-inventory-button lab-inventory-button-secondary",disabled:he,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:he,children:r?"Saving...":"Update Test"})]})]})]})})})]},D.id)})})]})]})]})},HQ=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([o,l])=>{var h;const d=(h=r.default_parameters)==null?void 0:h.find(g=>g.name===o);let f=String(l),u="";if(d){const g=d.unit?` _${d.unit}_`:"";if(d.type==="boolean"){const b=l===!0||l==="true";f=b?"*Reactive*":"Non-Reactive",b||(u="`Normal: Non-Reactive`")}else if(d.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(d.lower_limit!=null||d.upper_limit!=null){let v=[];d.lower_limit!=null&&v.push(`${d.lower_limit}`),d.upper_limit!=null&&v.push(`${d.upper_limit}`),u=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(d.lower_limit!=null&&b<d.lower_limit||d.upper_limit!=null&&b>d.upper_limit)&&(f=`*${f}*`)}}d.unit&&(f+=g)}n+=`${o}: ${f}
`,u&&((d==null?void 0:d.type)==="boolean"&&(l===!0||l==="true")||(n+=`${u}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},aS=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=HQ(e),r=`Hello ${n},

Your lab report is ready.

${t}`,o=`https://wa.me/${GQ(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(o,"_blank")},GQ=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},YQ=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState("orders"),[h,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async(B=1,W="")=>{o(!0),d(null);try{const I=new URLSearchParams({page:String(B),limit:String(b)});W&&I.append("search",W);const F=await me(`/api/lab?${I.toString()}`);if(!F.ok)throw new Error(`HTTP error! status: ${F.status}`);const V=await F.json(),re=V.orders.map(ie=>{var G,Y;return{id:ie.id,labTokenNumber:String(ie.lab_token_number??"N/A"),patientName:((G=ie.Patient)==null?void 0:G.name)||"N/A",patientId:ie.patient_id,patientTokenNumber:String(((Y=ie.Patient)==null?void 0:Y.patient_token_number)??"N/A"),tests:(ie.tests||[]).map(ne=>ne.name||"Unknown Test"),date:Fd(new Date(ie.createdAt),"yyyy-MM-dd"),status:ie.status,reportId:ie.reportId,billId:ie.billId}});n(re),S(V.totalCount),g(B)}catch(I){console.error("Failed to fetch lab orders:",I),d(I instanceof Error?I.message:"An unknown error occurred"),n([]),S(0)}finally{o(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${h}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(h,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,h,t]),w.useEffect(()=>{const B=setTimeout(()=>{t.length>=2?h!==1&&g(1):t.length<2&&h!==1&&g(1)},1e3);return()=>{clearTimeout(B)}},[t]);const P=async(B,W)=>{console.log(`Updating order ${B} to status ${W}`);try{const I=await me(`/api/lab/${B}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:W})});if(!I.ok){const F=await I.json();throw new Error(F.message||`Failed to update status: ${I.status}`)}if(W==="completed"){const F=await me(`/api/lab/orders/${B}/report`);if(F.ok){const V=await F.json();aS(V)}}await T(h,t),console.log(`Order ${B} status updated to ${W}, refetching page ${h}`)}catch(I){console.error("Error updating status:",I),alert(`Failed to update status: ${I instanceof Error?I.message:"Unknown error"}`)}},M=At(),R=B=>{if(!B){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}B.billId?(console.log(`Navigating to existing bill for Bill ID: ${B.billId}, Patient: ${B.patientName}`),M("/billing",{state:{billId:B.billId,patientId:B.patientId,patientName:B.patientName,billType:"lab"}})):(console.log(`Navigating to LabBillingPage for Order ID: ${B.id}`),M(`/dashboard/lab-billing/${B.id}`))},z=B=>{B&&B.id?M(`/lab/report/${B.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},$=B=>{switch(B){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:B,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(Ir,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:l}),i.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const L=()=>{h>1&&g(B=>B-1)},U=()=>{h<k&&g(B=>B+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>M(-1),className:"back-button mr-4",children:i.jsx(an,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>u("orders"),className:`lab-inventory-button ${f==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(Pk,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>M("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>u("inventory"),className:`lab-inventory-button ${f==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(y3,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),f==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:B=>r(B.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(bi,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map(B=>{const W=$(B.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:B.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",B.patientTokenNumber]})]}),i.jsx("td",{children:B.tests.map((I,F)=>i.jsx("div",{children:I},F))}),i.jsx("td",{className:"hidden md:table-cell",children:B.date}),i.jsx("td",{children:i.jsx("span",{className:W.className,children:W.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[B.status==="pending"&&i.jsx("button",{onClick:()=>R(B),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),B.status==="billed"&&i.jsx("button",{onClick:()=>P(B.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),B.status==="collected"&&i.jsx("button",{onClick:()=>P(B.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(B.status==="processing"||B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>z(B),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>P(B.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(B.status==="completed"||B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>{B.id?M(`/lab/view-report/${B.id}`):(console.error("Attempted to view report for an order with no ID:",B),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},B.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map(B=>{const W=$(B.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:B.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",B.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:B.date})]}),i.jsx("span",{className:`${W.className} lab-card-status-pill`,children:W.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),B.tests.map((I,F)=>i.jsx("div",{className:"lab-card-test-item",children:I},F)),B.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[B.status==="pending"&&i.jsx("button",{onClick:()=>R(B),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),B.status==="billed"&&i.jsx("button",{onClick:()=>P(B.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),B.status==="collected"&&i.jsx("button",{onClick:()=>P(B.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(B.status==="processing"||B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>z(B),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>P(B.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(B.status==="completed"||B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>{B.id?M(`/lab/view-report/${B.id}`):(console.error("Attempted to view report for an order with no ID:",B),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},B.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(h-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(h*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:L,disabled:h===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(Tb,{size:18})}),i.jsxs("span",{children:["Page ",h," of ",k]}),i.jsx("button",{onClick:U,disabled:h===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(Gd,{size:18})})]})]})]}),f==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(iS,{})]})]})]})},WQ=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=At(),u=w.useRef(null),[h,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),T=10,P=w.useCallback(async(U,B,W)=>{o(!0),d(null);try{let I=`/api/pharmacy-orders?page=${U}&limit=${B}`;W&&W.trim()!==""&&(I+=`&search=${encodeURIComponent(W.trim())}`);const F=await me(I);if(!F.ok)throw new Error(`Failed to fetch orders: ${F.statusText} (${F.status})`);const V=await F.json();if(V&&Array.isArray(V.orders)&&typeof V.totalOrders=="number"&&typeof V.totalPages=="number")console.log("Fetched pharmacy orders data:",V.orders),n(V.orders),k(V.totalOrders),v(V.totalPages),g(V.currentPage||U);else throw console.error("Received data does not match expected paginated structure:",V),new Error("Invalid data format received from API")}catch(I){console.error("Failed to fetch pharmacy orders:",I),d(I.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{o(!1)}},[]);w.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const U=t===""?h:1;t!==""&&h!==1&&g(1),P(U,T,t)},500),()=>{u.current&&clearTimeout(u.current)}),[t,h,P,T]);const M=U=>{f(`/dashboard/edit-pharmacy-order/${U}`)},R=U=>{d(null),console.log(`Preparing billing navigation for order: ${U}`);const B=e.find(W=>W.id===U);if(B){const W=B.medications.map(I=>{const F=I.price??0;return(I.price===void 0||I.price===null)&&console.warn(`Medication "${I.name}" in order ${U} is missing a price. Defaulting to 0.`),{name:I.name,pack_quantity:I.pack_quantity,loose_quantity:I.loose_quantity,price:F,pack_price:I.pack_price,loose_price:I.loose_price,total_price:I.total_price,isLoose:I.isLoose,unit:I.unit,drug_id:I.drug_id?String(I.drug_id):null,tabletsPerDay:I.tabletsPerDay,numberOfDays:I.numberOfDays,directions_to_use:I.directions_to_use,discount_percentage:0,batch:I.batch,expiry_date:I.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:W}),f(`/dashboard/pharmacy-billing/${U}`,{state:{initialItems:W}})}else console.error(`Order with ID ${U} not found.`),d(`Order with ID ${U} not found.`),alert(`Error: Could not find order ${U} to bill.`)},z=async(U,B)=>{d(null);const W=e.find(F=>F.id===U);if(!W){d(`Order with ID ${U} not found.`);return}const I={status:B,medications:W.medications};try{const F=await me(`/api/pharmacy-orders/${U}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!F.ok){const re=await F.text();throw new Error(`Failed to update status: ${F.statusText} (${F.status}) - ${re}`)}const V=await F.json();n(re=>re.map(ie=>ie.id===V.id?{...ie,status:V.status}:ie))}catch(F){console.error("Failed to update order status:",F),d(F.message||`Failed to update status for order ${U}.`),alert(`Error updating status for order ${U}: ${F.message||"Please try again."}`)}},$=U=>{switch(U){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},L=U=>{f(`/dashboard/orders/${U.id}`)};return a&&e.length===0&&!l?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>f("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(Ua,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>f("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx($d,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>f("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(Ak,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>f("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx($d,{size:16}),"Distributors"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:U=>r(U.target.value),className:"pharmacy-search-input"}),i.jsx(bi,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"})," ",i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(U=>i.jsxs("tr",{onClick:()=>L(U),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:U.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${U.patientTokenNumber}`,children:U.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[U.medications.map((B,W)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[B.name," (Packs: ",B.pack_quantity,", Loose: ",B.loose_quantity,", ",B.tabletsPerDay??"N/A","x",B.numberOfDays??"N/A","d)",B.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",B.box_number,")"]})]}),B.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",B.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[B.pack_price!==void 0&&`Pack Price: ${Number(B.pack_price).toFixed(2)}`,B.loose_price!==void 0&&` | Loose Price: ${Number(B.loose_price).toFixed(2)}`,B.total_price!==void 0&&` | Item Total: ${Number(B.total_price).toFixed(2)}`]})]},W)),U.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",U.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(U.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(U.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:$(U.status),children:U.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[U.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:B=>{B.stopPropagation(),M(U.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Yl,{size:14})," Edit"]}),i.jsxs("button",{onClick:B=>{B.stopPropagation(),R(U.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Fh,{size:14})," Bill"]})]}),U.status==="billed"&&i.jsxs("button",{onClick:B=>{B.stopPropagation(),z(U.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(vs,{size:14})," Dispense"]}),(U.status==="pending"||U.status==="billed")&&i.jsx("button",{onClick:B=>{B.stopPropagation(),z(U.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:B=>{B.stopPropagation(),L(U)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},U.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(U=>{const B=$(U.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>L(U),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:U.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${U.patientTokenNumber}`,children:["Token: ",U.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(U.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:B,children:U.status}),U.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(U.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[U.medications.slice(0,2).map((W,I)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${W.name} (Packs: ${W.pack_quantity}, Loose: ${W.loose_quantity}, ${W.tabletsPerDay??"N/A"}x${W.numberOfDays??"N/A"}d)`,children:[W.name," (Packs: ",W.pack_quantity,", Loose: ",W.loose_quantity,", ",W.tabletsPerDay??"N/A","x",W.numberOfDays??"N/A","d)",W.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",W.box_number,")"]})]}),W.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${W.directions_to_use}`,children:["Directions: ",W.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[W.pack_price!==void 0&&`Pack Price: ${Number(W.pack_price).toFixed(2)}`,W.loose_price!==void 0&&` | Loose Price: ${Number(W.loose_price).toFixed(2)}`,W.total_price!==void 0&&` | Item Total: ${Number(W.total_price).toFixed(2)}`]})]},I)),U.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",U.medications.length-2," more"]}),U.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),U.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",U.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[U.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:W=>{W.stopPropagation(),M(U.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Yl,{size:14})," Edit"]}),i.jsxs("button",{onClick:W=>{W.stopPropagation(),R(U.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Fh,{size:14})," Bill"]})]}),U.status==="billed"&&i.jsxs("button",{onClick:W=>{W.stopPropagation(),z(U.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(vs,{size:14})," Dispense"]}),(U.status==="pending"||U.status==="billed")&&i.jsx("button",{onClick:W=>{W.stopPropagation(),z(U.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:W=>{W.stopPropagation(),L(U)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},U.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(U=>Math.max(U-1,1)),disabled:h===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(U=>Math.min(U+1,b)),disabled:h===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(h-1)*T+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(h*T,S)})," ","of ",i.jsx("span",{className:"font-medium",children:S})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(U=>Math.max(U-1,1)),disabled:h===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(Tb,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",h," of ",b]}),i.jsxs("button",{onClick:()=>g(U=>Math.min(U+1,b)),disabled:h===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(Gd,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},X_=10,QQ=3,kE=({isEmbedded:e=!1})=>{const n=At(),[t,r]=w.useState([]),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(new Set),[S,k]=w.useState("all"),T=async()=>{try{const Ce=await me("/api/inventory/download-csv");if(!Ce.ok)throw new Error(`Failed to download CSV: ${Ce.statusText}`);const be=await Ce.blob(),Fe=window.URL.createObjectURL(be),Ie=document.createElement("a");Ie.href=Fe,Ie.download="pharmacy_inventory.csv",document.body.appendChild(Ie),Ie.click(),Ie.remove(),window.URL.revokeObjectURL(Fe)}catch(Ce){console.error("Failed to download CSV:",Ce),g(Ce.message||"Failed to download inventory CSV. Please try again.")}},[P,M]=w.useState(!1),[R,z]=w.useState(!1),[$,L]=w.useState(null),[U,B]=w.useState(!1),[W,I]=w.useState(new Set),[F,V]=w.useState(1),re=8,[ie,G]=w.useState(null),[Y,ne]=w.useState(0),[le,oe]=w.useState(!1),[E,de]=w.useState(null),[he,D]=w.useState(1),[pe,Ne]=w.useState(!1),te=F*re,K=te-re,J=a.slice(K,te),ye=Math.ceil(a.length/re);w.useEffect(()=>{V(1)},[l,S]);const He=w.useCallback(async()=>{u(!0),g(null);try{const Ce=await me("/api/drugs");if(!Ce.ok)throw new Error(`Failed to fetch drugs: ${Ce.statusText} (${Ce.status})`);const be=await Ce.json();let Fe=Array.isArray(be)?be:be.drugs||[];Fe=Fe.map(Ie=>({...Ie,mrp:parseFloat(String(Ie.mrp))||0,rate:Ie.rate!==null&&Ie.rate!==void 0?parseFloat(String(Ie.rate)):null,stock:parseInt(String(Ie.stock),10)||0,gst:Ie.gst!==null&&Ie.gst!==void 0?parseFloat(String(Ie.gst)):null,margin:Ie.margin!==null&&Ie.margin!==void 0?parseFloat(String(Ie.margin)):null,discount:Ie.discount!==null&&Ie.discount!==void 0?parseFloat(String(Ie.discount)):null})),r(Fe),o(Fe)}catch(Ce){console.error("Failed to fetch drugs:",Ce),g(Ce.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{He()},[He]),w.useEffect(()=>{const Ce=l.toLowerCase();let be=t.filter(Ve=>{var vn,kt,bt,Yt,It;const st=((vn=Ve.name)==null?void 0:vn.toLowerCase())||"",mt=((kt=Ve.description)==null?void 0:kt.toLowerCase())||"",Ct=((bt=Ve.supplier)==null?void 0:bt.toLowerCase())||"",ln=((Yt=Ve.box_number)==null?void 0:Yt.toLowerCase())||"",dn=((It=Ve.brand_name)==null?void 0:It.toLowerCase())||"";return st.includes(Ce)||mt.includes(Ce)||Ct.includes(Ce)||ln.includes(Ce)||dn.includes(Ce)});const Fe=new Date,Ie=_W(Fe,QQ);S==="low-stock"?be=be.filter(Ve=>Ve.stock<=X_):S==="near-expiry"?be=be.filter(Ve=>{if(!Ve.expiry_date)return!1;const st=K_(Ve.expiry_date);return Y1(st)&&F0(st,Ie)&&!F0(st,Fe)}):S==="expired"&&(be=be.filter(Ve=>{if(!Ve.expiry_date)return!1;const st=K_(Ve.expiry_date);return Y1(st)&&F0(st,Fe)})),o(be)},[l,t,S]);const Q=()=>{M(!1),G(null)},Pe=Ce=>{ne(parseInt(Ce.target.value,10)||0)},Re=async Ce=>{if(Ce.preventDefault(),g(null),!ie||!ie.id||Y===0){g("No drug selected or adjustment amount is zero.");return}try{const be=await me(`/api/drugs/${ie.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:Y})});if(!be.ok){const Ie=await be.json();throw new Error(Ie.message||`Failed to adjust stock: ${be.statusText}`)}const Fe=await be.json();r(Ie=>Ie.map(Ve=>Ve.id===Fe.id?Fe:Ve)),Q(),alert(`Stock for "${Fe.name}" adjusted successfully. New stock: ${Fe.stock}`)}catch(be){console.error("Failed to adjust stock:",be),g(be.message||"Failed to adjust stock. Please try again.")}},Le=Ce=>{L(Ce),z(!0)},_e=()=>{z(!1),L(null)},Ke=async()=>{if(!$||!$.id){g("No drug selected for deletion.");return}u(!0),g(null);try{const Ce=await me(`/api/drugs/${$.id}`,{method:"DELETE"});if(!Ce.ok){const be=await Ce.json();throw new Error(be.message||`Failed to delete drug: ${Ce.statusText}`)}alert(`Drug "${$.name}" deleted successfully.`),He(),_e()}catch(Ce){console.error("Failed to delete drug:",Ce),g(Ce.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},Ye=()=>{B(!0)},it=()=>{B(!1)},[xt,Nt]=w.useState(!1),ue=()=>{W.size>0&&Nt(!0)},Ae=()=>{Nt(!1)},ke=async()=>{if(W.size===0){g("No drugs selected for deletion.");return}u(!0),g(null);try{const Ce=await me("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(W)})});if(!Ce.ok){const be=await Ce.json();throw new Error(be.message||`Failed to delete selected drugs: ${Ce.statusText}`)}alert(`${W.size} drug(s) deleted successfully.`),He(),I(new Set),Ae()}catch(Ce){console.error("Failed to delete selected drugs:",Ce),g(Ce.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},Se=async()=>{u(!0),g(null);try{const Ce=await me("/api/drugs/all",{method:"DELETE"});if(!Ce.ok){const be=await Ce.json();throw new Error(be.message||`Failed to delete all drugs: ${Ce.statusText}`)}alert("All drugs deleted successfully."),He(),it()}catch(Ce){console.error("Failed to delete all drugs:",Ce),g(Ce.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},ve=Ce=>{if(!Ce)return null;const be=Ce.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return be?parseInt(be[1],10):null},X=Ce=>{de(Ce),D(1),oe(!0)},fe=()=>{oe(!1),de(null),D(1)},Ge=Ce=>{D(parseInt(Ce.target.value,10)||0)},Je=async Ce=>{if(Ce.preventDefault(),g(null),!E||!E.id||he<=0){g("No drug selected or invalid number of packs to convert.");return}const be=ve(E.pack);if(!be||be<=0){g(`Cannot convert "${E.name}" to loose. Invalid pack unit: ${E.pack||"N/A"}.`);return}if(he>(E.stock??0)){g(`Cannot convert ${he} packs. Only ${E.stock??0} packs are in stock.`);return}try{const Fe=await me(`/api/drugs/${E.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:he,packSize:be})});if(!Fe.ok){const Ve=await Fe.json();throw new Error(Ve.message||`Failed to convert to loose: ${Fe.statusText}`)}const Ie=await Fe.json();r(Ve=>Ve.map(st=>st.id===Ie.id?Ie:st)),fe(),alert(`Converted ${he} pack(s) of "${Ie.name}" to loose. New stock: ${Ie.stock} packs, ${Ie.loose??0} loose units.`)}catch(Fe){console.error("Failed to convert to loose:",Fe),g(Fe.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},ct=()=>{Ne(!0)},wt=()=>{Ne(!1)},Ht=async()=>{u(!0),g(null);try{const Ce=await me("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!Ce.ok){const be=await Ce.json();throw new Error(be.message||`Failed to add default medications: ${Ce.statusText}`)}alert("Default medications added successfully."),He(),wt()}catch(Ce){console.error("Failed to add default medications:",Ce),g(Ce.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):h?i.jsxs("div",{className:"error-indicator",children:["Error: ",h]}):i.jsxs("div",{className:`pharmacy-inventory-page ${e?"embedded":""}`,style:e?{minHeight:"auto",padding:"0",background:"transparent"}:{},children:[i.jsx("div",{className:"inventory-header-controls",style:{padding:"20px 20px 0 20px"},children:i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",style:{display:"flex",gap:"12px"},children:[i.jsxs("button",{onClick:()=>n("/dashboard/inventory/add"),className:"action-button-outline add-drug-button",children:[i.jsx(Ua,{size:18}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>n("/dashboard/purchase"),className:"action-button-outline",children:[i.jsx(Ua,{size:18}),"Purchase Page"]}),i.jsxs("button",{onClick:()=>n("/dashboard/distributors"),className:"action-button-outline",children:[i.jsx(Ua,{size:18}),"Distributors"]})]}),i.jsxs("div",{className:"action-group-right",style:{display:"flex",gap:"12px"},children:[i.jsx("button",{onClick:T,className:"action-button-outline",children:"Download CSV"}),i.jsxs("button",{onClick:ct,className:"action-button-outline",children:[i.jsx(Ua,{size:18}),"Import Defaults"]}),i.jsxs("button",{onClick:ue,className:"action-button-outline delete-button-outline",disabled:W.size===0,children:[i.jsx(Wr,{size:18}),"Delete (",W.size,")"]}),i.jsxs("button",{onClick:Ye,className:"action-button-outline delete-all-button-outline",children:[i.jsx(Wr,{size:18}),"Delete All"]})]})]})}),i.jsxs("div",{className:"search-bar-container",style:{padding:"0 20px 20px 20px",borderBottom:"1px solid var(--border-color)",marginBottom:"0"},children:[i.jsxs("div",{className:"search-input-wrapper",style:{maxWidth:"600px"},children:[i.jsx(bi,{size:20,className:"search-input-icon"}),i.jsx("input",{type:"text",placeholder:"Search drugs...",value:l,onChange:Ce=>d(Ce.target.value),className:"inventory-search-input"})]}),i.jsx("div",{className:"filter-dropdown-wrapper",children:i.jsxs("select",{value:S,onChange:Ce=>k(Ce.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:Ce=>{if(Ce.target.checked){const be=new Set(a.map(Fe=>Fe.id));I(be)}else I(new Set)},checked:W.size===a.length&&a.length>0,disabled:a.length===0})}),i.jsx("th",{className:"drug-name-header",children:"DRUG DETAILS"}),i.jsx("th",{className:"pack-header",children:"PACK"}),i.jsx("th",{className:"expiry-header",children:"EXPIRY"}),i.jsx("th",{className:"text-stock qty-header",children:"STOCK"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"RATE"}),i.jsx("th",{className:"box-number-header",children:"BOX"}),i.jsx("th",{className:"discount-header",children:"DISC %"}),i.jsx("th",{className:"margin-header",children:"MARGIN"}),i.jsx("th",{className:"actions-cell",children:"ACTIONS"})]})}),i.jsxs("tbody",{children:[a.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:11,children:"No drugs found matching your search."})}),J.map(Ce=>i.jsxs(kn.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const be=new Set(b);be.has(Ce.id)&&Ce.id!==void 0?be.delete(Ce.id):Ce.id!==void 0&&be.add(Ce.id),v(be)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:be=>be.stopPropagation(),checked:W.has(Ce.id),onChange:()=>{const be=new Set(W);be.has(Ce.id)?be.delete(Ce.id):be.add(Ce.id),I(be)}})}),i.jsx("td",{className:"drug-name-cell",children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:Ce.brand_name||Ce.name||"-"}),Ce.brand_name&&Ce.name&&Ce.brand_name!==Ce.name&&i.jsx("span",{className:"text-xs text-muted-foreground",style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:Ce.name})]})}),i.jsx("td",{className:"text-muted pack-cell",children:Ce.pack||"-"}),i.jsx("td",{className:"text-muted",children:Ce.expiry_date?new Date(Ce.expiry_date).toLocaleDateString("en-GB"):"-"}),i.jsxs("td",{className:`text-stock ${Ce.stock<=X_?"low-stock":""}`,children:[i.jsx("div",{style:{fontWeight:"bold"},children:Ce.stock}),i.jsx("div",{className:"loose-quantity",children:Ce.loose!==null&&Ce.loose!==void 0?`${Ce.loose} loose`:"0 loose"})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof Ce.mrp=="number"?Ce.mrp.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:Ce.rate!==null&&Ce.rate!==void 0?`${Ce.rate.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:Ce.box_number||"-"}),i.jsx("td",{className:"text-muted",children:Ce.discount!==null&&Ce.discount!==void 0?`${Ce.discount.toFixed(2)}%`:"0.00%"}),i.jsx("td",{className:"text-muted",children:(()=>{const be=Ce.mrp||0,Fe=Ce.rate||0,Ie=Ce.discount||0,Ve=Ce.gst||0,mt=Fe*(1-Ie/100)*(1+Ve/100),Ct=be-mt;return`${(be>0?Ct/be*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:be=>{be.stopPropagation(),n(`/dashboard/inventory/edit/${Ce.id}`)},className:"action-icon-button",title:"Edit Drug",children:i.jsx(Yl,{size:16})}),i.jsx("button",{onClick:be=>{be.stopPropagation(),Le(Ce)},className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(Wr,{size:16})}),i.jsx("button",{onClick:be=>{be.stopPropagation(),G(Ce),M(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(F3,{size:16})}),i.jsx("button",{onClick:be=>{be.stopPropagation(),X(Ce)},className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!Ce.pack||ve(Ce.pack)===null,children:i.jsx(kF,{size:16})})]})})]}),b.has(Ce.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:11,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",Ce.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",Ce.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",Ce.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",Ce.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",Ce.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const be=ve(Ce.pack);return be&&be>0&&typeof Ce.mrp=="number"?`${(Ce.mrp/be).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",Ce.gst!==null&&Ce.gst!==void 0?`${Ce.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(Ce.last_updated).toLocaleString()]})]})})})]},Ce.id))]})]})}),ye>1&&i.jsxs("div",{className:"pagination-controls",style:{padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"20px",backgroundColor:"var(--card-bg, #fff)",borderTop:"1px solid var(--border-color)"},children:[i.jsx("button",{onClick:()=>V(Ce=>Math.max(Ce-1,1)),disabled:F===1,className:"pagination-button",children:"Previous"}),i.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Page ",F," of ",ye]}),i.jsx("button",{onClick:()=>V(Ce=>Math.min(Ce+1,ye)),disabled:F===ye,className:"pagination-button",children:"Next"})]}),R&&$&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:_e,className:"modal-close-button",children:i.jsx(bn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:$.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:_e,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ke,className:"button-delete",children:"Delete"})]})]})}),P&&ie&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Q,className:"modal-close-button",children:i.jsx(bn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:ie.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",ie.stock]}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("form",{onSubmit:Re,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:Y,onChange:Pe,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Q,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),U&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:it,className:"modal-close-button",children:i.jsx(bn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:it,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Se,className:"button-delete",children:"Delete All"})]})]})}),xt&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ae,className:"modal-close-button",children:i.jsx(bn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:W.size})," selected drug(s)? This action cannot be undone."]}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ae,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:ke,className:"button-delete",children:"Delete Selected"})]})]})}),le&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:fe,className:"modal-close-button",children:i.jsx(bn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:E.name||"Unnamed Drug"}),i.jsx("br",{}),"Pack Size: ",E.pack,i.jsx("br",{}),"Current Stock: ",E.stock," packs, ",E.loose??0," loose units."]}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("form",{onSubmit:Je,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packsToConvert",className:"form-label",children:"Packs to Convert"}),i.jsx("input",{type:"number",name:"packsToConvert",id:"packsToConvert",required:!0,step:"1",min:"1",max:E.stock,value:he,onChange:Ge,className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["Converting ",he," pack(s) will add ",he*(ve(E.pack)||0)," loose units."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:fe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert"})]})]})]})}),pe&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:wt,className:"modal-close-button",children:i.jsx(bn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:wt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ht,className:"button-submit",children:"Add Defaults"})]})]})})]})},JQ=()=>{const e=At();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},TE=()=>{const{id:e}=Ki(),n=At(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[h,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){d("Drug ID is missing."),o(!1);return}o(!0),d(null);try{const R=await me(`/api/drugs/${e}`);if(!R.ok){const $=await R.json();throw new Error($.message||`Failed to fetch drug: ${R.statusText}`)}let z=await R.json();z={...z,name:z.name||"",brand_name:z.brand_name||"",mrp:parseFloat(String(z.mrp))||0,rate:z.rate!==null&&z.rate!==void 0?parseFloat(String(z.rate)):null,stock:parseInt(String(z.stock),10)||0,gst:z.gst!==null&&z.gst!==void 0?parseFloat(String(z.gst)):null,margin:z.margin!==null&&z.margin!==void 0?parseFloat(String(z.margin)):null,discount:z.discount!==null&&z.discount!==void 0?parseFloat(String(z.discount)):null,batch:z.batch||"",hsn_code:z.hsn_code||"",mfg:z.mfg||"",loose:z.loose!==null&&z.loose!==void 0?parseInt(String(z.loose),10):null},r(z)}catch(R){console.error("Failed to fetch drug:",R),d(R.message||"Failed to load drug data. Please try again.")}finally{o(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const R=$=>{$.key==="Tab"&&v.current===document.activeElement&&(h||(g(!0),setTimeout(()=>{var L;(L=S.current)==null||L.focus()},0),$.preventDefault()))},z=$=>{b.current&&!b.current.contains($.target)&&g(!1)};return document.addEventListener("keydown",R),document.addEventListener("mousedown",z),()=>{document.removeEventListener("keydown",R),document.removeEventListener("mousedown",z)}},[h]);const T=R=>{const{name:z,value:$,type:L}=R.target;r(U=>U?{...U,[z]:L==="number"?parseFloat($)||null:$}:null)},P=()=>{n(-1)},M=async R=>{if(R.preventDefault(),d(null),u(!0),!t||!t.id){d("Cannot edit drug: No drug data available."),u(!1);return}if(t.mrp===void 0||t.stock===void 0){d("MRP and Stock Quantity are required."),u(!1);return}const z={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,rate:t.rate===0?null:t.rate,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const $=await me(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!$.ok){const U=await $.json();throw new Error(U.message||`Failed to update drug: ${$.statusText}`)}const L=await $.json();alert(`Drug "${L.name}" updated successfully!`),n(-1)}catch($){console.error("Failed to update drug:",$),d($.message||"Failed to update drug. Please try again.")}finally{u(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:P,className:"cancel-button",title:"Go Back",children:i.jsx(bn,{size:24})})]}),l&&i.jsx("div",{className:"error-message-submit",children:l}),i.jsxs("form",{onSubmit:M,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Zo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Zo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-mrp",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Zo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"mrp",id:"edit-mrp",required:!0,step:"0.01",min:"0",value:t.mrp,onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Zo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"stock",id:"edit-stock",required:!0,step:"1",min:"0",value:t.stock,onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-pack",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"pack",id:"edit-pack",value:t.pack||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!h),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),h&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-rate",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"rate",id:"edit-rate",step:"0.01",min:"0",value:t.rate??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:P,disabled:f,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button",tabIndex:20,children:f?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},EE=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",mrp:0,stock:0,pack:"",expiry_date:"",rate:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",mrp:0,stock:0,pack:"",expiry_date:"",rate:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),f(!1),h(!1))},[e]),w.useEffect(()=>{const T=M=>{M.key==="Tab"&&b.current===document.activeElement&&(u||(h(!0),setTimeout(()=>{var R;(R=v.current)==null||R.focus()},0),M.preventDefault()))},P=M=>{g.current&&!g.current.contains(M.target)&&h(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",P),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",P)}},[u]);const S=T=>{const{name:P,value:M,type:R}=T.target;a(z=>({...z,[P]:R==="number"?parseFloat(M)||null:M}))},k=T=>{if(T.preventDefault(),l(null),f(!0),r.mrp===void 0||r.stock===void 0){l("MRP and Stock Quantity are required."),f(!1);return}const P={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,rate:r.rate===0?null:r.rate,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(P),f(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(bn,{size:24})})]}),o&&i.jsx("div",{className:"error-message",children:o}),i.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Zo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Zo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"mrp",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Zo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"mrp",id:"mrp",required:!0,step:"0.01",min:"0",value:r.mrp,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Zo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"stock",id:"stock",required:!0,step:"1",min:"0",value:r.stock,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"pack",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"pack",id:"pack",value:r.pack||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>h(!u),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),u&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"rate",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"rate",id:"rate",step:"0.01",min:"0",value:r.rate??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:d,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:d,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:d?"Adding...":"Add Drug"})]})]})]})}):null},KQ=()=>{const e=At(),n=async t=>{try{const r=await me("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const a=await r.json();throw new Error(a.message||"Failed to add drug")}e(-1)}catch(r){console.error("Error adding drug:",r),alert(`Failed to add drug: ${r.message}`)}};return i.jsx("div",{className:"add-drug-page-wrapper",style:{paddingTop:"2rem"},children:i.jsx(EE,{isOpen:!0,onClose:()=>e(-1),onDrugAddedToPurchase:n})})},W1=()=>{const e=At(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),[u,h]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,T]=w.useState(!1),[P,M]=w.useState([]),[R,z]=w.useState(!0);w.useEffect(()=>{(async()=>{z(!0);try{const F=await me("/api/staff?role=doctor");if(!F.ok)throw new Error("Failed to fetch doctors");const V=await F.json();M(V),V.length>0&&t(re=>({...re,doctorId:""}))}catch(F){console.error("Error fetching doctors:",F),l(`Failed to load doctors: ${F.message}`)}finally{z(!1)}})()},[]);const $=w.useCallback(async()=>{if(u.trim()){T(!0),l(null),b([]);try{const I=encodeURIComponent(u.trim()),F=await me(`/api/patients?search=${I}&limit=10`);if(!F.ok){const re=await F.json().catch(()=>({message:"Failed to search patients"}));throw new Error(re.message||"Failed to search patients")}const V=await F.json();V&&Array.isArray(V.patients)?b(V.patients):(console.error("Unexpected response format from patient search:",V),b([]))}catch(I){console.error("Error searching patients:",I),l(`Search failed: ${I.message}`)}finally{T(!1)}}},[u]);w.useEffect(()=>{if(u.trim().length<2){b([]),l(null);return}const I=setTimeout(()=>{$()},300);return()=>clearTimeout(I)},[u,$]);const L=I=>{S(I),h(""),b([]),l(null),t(F=>({...F,name:"",age:"",gender:"",phone:""}))},U=()=>{S(null),h(""),b([]),l(null),t(I=>({...I,name:"",age:"",gender:"",phone:""}))},B=I=>{const{name:F,value:V}=I.target;t(re=>({...re,[F]:V}))},W=async I=>{var F;I.preventDefault(),l(null),f(null),a(!0);try{let V,re;if(v)V=v.id,re=v.name,console.log(`Adding existing patient ${V} to queue.`);else{console.log("Registering new patient...");const ne=await me("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!ne.ok){const oe=await ne.json();if(ne.status===403&&oe.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:oe.message}});return}throw new Error(oe.message||"Failed to register patient")}const le=await ne.json();V=le.id,re=le.name,console.log(`New patient ${V} registered.`)}const ie=n.doctorId||null;console.log(`Adding patient ${V} to queue for doctor ${ie||"Unassigned"}`);const G=await me("/api/queue",{method:"POST",body:JSON.stringify({patientId:V,complaint:n.complaint||null,doctorId:ie})});if(!G.ok){const ne=await G.json();throw new Error(ne.message||"Failed to add patient to queue")}const Y=await G.json();if(console.log(`Patient added to queue, entry ID: ${Y.id}`),S(null),h(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),ie){const ne=((F=P.find(oe=>oe.id===ie))==null?void 0:F.name)||"Selected Doctor",le=v?`Existing patient "${re}" added to queue for Dr. ${ne}. Redirecting to billing...`:`Patient "${re}" registered and added to queue for Dr. ${ne}. Redirecting to billing...`;f(le),e("/billing",{state:{patientId:V,queueId:Y.id,patientName:re,doctorId:ie,billType:"consultation"}})}else{const ne=v?`Existing patient "${re}" added to the general queue.`:`Patient "${re}" registered and added to the general queue.`;f(ne)}}catch(V){console.error("Error in add/queue process:",V),V.message.includes("Patient limit")?(l(`Operation failed: ${V.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${V.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[i.jsx(an,{size:20,className:"btn-icon"})," Back"]})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx($k,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:u,onChange:I=>h(I.target.value),className:"form-input",disabled:r||!!v}),i.jsx(bi,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:U,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(bn,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map(I=>i.jsxs("li",{onClick:()=>L(I),children:[I.name," (ID: ",I.id,", Phone: ",I.phone||"N/A",")"]},I.id))}),u.length>=2&&g.length===0&&!k&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',u,'". You can register them below.']}),k&&u.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),o&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),d&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:d})]}),i.jsxs("form",{onSubmit:W,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:B,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:B,className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:B,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:B,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:B,className:`form-select ${R?"opacity-50":""}`,disabled:r||R,children:[i.jsx("option",{value:"",children:R?"Loading doctors...":P.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),P.map(I=>i.jsx("option",{value:I.id,children:I.name},I.id))]}),P.length===0&&!R&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:B,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("div",{className:"flex justify-end pt-2",children:[" ",i.jsxs("button",{type:"submit",className:`btn btn-primary ${r||R?"disabled":""}`,disabled:r||R,children:[i.jsx(_w,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})]})},XQ=({clinicId:e})=>{const n=At(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,o]=w.useState(null),[l,d]=w.useState(!1);w.useEffect(()=>{o(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const f=g=>{const{name:b,value:v}=g.target;r(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},u=async g=>{if(g.preventDefault(),o(null),!t.name||!t.email||!t.role||!t.password){o("Name, Email, Role, and Password are required.");return}if(!e){o("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){o("Invalid OPD Fee format. Please enter a number.");return}d(!0);try{const v=await me("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){o(`Failed to add staff: ${v.message}`)}finally{d(!1)}},h=()=>{n(-1)};return i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:h,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(an,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{children:"Add New Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Ir,{size:18,className:"mr-2 text-red-500"}),a]}),i.jsxs("form",{onSubmit:u,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:f,required:!0,disabled:l||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:f,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:l||!e}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),i.jsxs("button",{type:"submit",disabled:l||!e,children:[l?i.jsx(Gl,{size:18,className:"animate-spin mr-2"}):i.jsx(tl,{size:18,className:"mr-2"}),l?"Adding...":"Add Staff Member"]})]})]})},ZQ=()=>{const{id:e}=Ki(),n=At(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,o]=w.useState(""),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),d(!1);return}d(!0),g(null),v(null);try{const M=await me(`/staff/${e}`);if(!M.ok){const z=await M.json();throw new Error(z.message||`HTTP error! status: ${M.status}`)}const R=await M.json();r({name:R.name,email:R.email,role:R.role,opd_fee:R.opd_fee??"",active:R.active})}catch(M){g(`Failed to load staff details: ${M.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=M=>{const{name:R,value:z,type:$}=M.target;if($==="checkbox"){const{checked:L}=M.target;r(U=>({...U,[R]:L}))}else r(L=>({...L,[R]:z}))},T=M=>{o(M.target.value)},P=async M=>{if(M.preventDefault(),!e){g("Staff ID is missing.");return}u(!0),g(null),v(null);const R={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const z=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(z!==null&&isNaN(z)){g("OPD Fee must be a valid number."),u(!1);return}R.opd_fee=z}else R.opd_fee=null;a.trim()!==""&&(R.password=a.trim());try{const z=await me(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!z.ok){const $=await z.json();throw new Error($.message||`HTTP error! status: ${z.status}`)}v("Staff details updated successfully!"),o(""),setTimeout(()=>n(-1),1500)}catch(z){g(`Failed to update staff: ${z.message}`)}finally{u(!1)}};return l?i.jsxs("div",{className:"flex justify-center items-center h-screen",children:[i.jsx(Gl,{className:"h-12 w-12 animate-spin text-teal-600"}),i.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(an,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),h&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Ir,{size:18,className:"mr-2 text-red-500"}),h,i.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&i.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[i.jsx(vs,{size:18,className:"mr-2 text-green-500"}),b,i.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),i.jsxs("form",{onSubmit:P,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"role",children:["Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),i.jsxs("div",{className:"form-group checkbox-group",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),i.jsx("button",{type:"submit",disabled:f,children:f?i.jsxs(i.Fragment,{children:[i.jsx(Gl,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(zd,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})},eJ=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},tJ=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},z0=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,loadingText:o,noDataText:l,onDeleteItem:d,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:h,onLabOrderTestChange:g,onLabOrderStatusChange:b,onEditPharmacyOrder:v,onPrintUnavailablePrescription:S,onBillLabOrder:k,onUpdateLabOrderStatus:T,onEnterLabReport:P,labInventory:M=[],isSavingLabOrder:R=!1,expandedLabReports:z={},toggleLabReport:$=()=>{}})=>{const L=w.useMemo(()=>{const B={};n.forEach(I=>{if(isNaN(I.date.getTime())){B["Unknown Date"]||(B["Unknown Date"]=[]),B["Unknown Date"].push(I);return}const F=eJ(I.originalDateString);B[F]||(B[F]=[]),B[F].push(I)});const W=Object.keys(B);return W.sort((I,F)=>{if(I==="Unknown Date")return 1;if(F==="Unknown Date")return-1;try{const V=new Date(I.split(" ").reverse().join(" ")),re=new Date(F.split(" ").reverse().join(" "));if(!isNaN(V.getTime())&&!isNaN(re.getTime()))return re.getTime()-V.getTime()}catch{}return F.localeCompare(I)}),W.map(I=>({date:I,items:B[I]}))},[n]),U=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),a&&i.jsx("p",{className:"ai-context-text italic",children:o}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:l}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:L.map(({date:B,items:W})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:B}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:W.map((I,F)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(I,F,z,$)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[I.type==="Lab Order"&&!I.data.isEditing&&f&&i.jsx("button",{onClick:()=>f(I.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:R,children:i.jsx(Ul,{size:14})}),I.type==="Lab Order"&&I.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>u&&u(I.data.id,I.data.editedTests,I.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:R,children:i.jsx(zd,{size:14})}),i.jsx("button",{onClick:()=>h&&h(I.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:R,children:i.jsx(Wr,{size:14})})]}),I.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[I.data.status==="pending"&&k&&(()=>{const V=I.data.tests.reduce((re,ie)=>re+(Number(ie.price)||0),0).toFixed(2);return i.jsxs("button",{onClick:()=>k(I.data),className:"lab-action-button btn-bill",title:`Pay total of ${V}`,children:["Pay (",V,")"]})})(),I.data.status==="billed"&&T&&i.jsx("button",{onClick:()=>T(I.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),I.data.status==="collected"&&T&&i.jsx("button",{onClick:()=>T(I.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),["pending","billed","collected","processing","report_ready","reported","completed"].includes(I.data.status)&&P&&i.jsx("button",{onClick:()=>P(I.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(I.data.status==="report_ready"||I.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T(I.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"})]}),I.type==="Pharmacy Order"&&I.data.status==="pending"&&v&&i.jsx("button",{onClick:()=>v(I.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:R,children:i.jsx(Ul,{size:14})}),I.type==="Pharmacy Order"&&I.data.prescriptionForUnavailableDrugs&&S&&i.jsx("button",{onClick:()=>S(I.data.prescriptionForUnavailableDrugs,`Prescription for Order ${I.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:R,children:i.jsx(Ko,{size:14})}),I.type==="Pharmacy Order"&&I.data.status==="pending"&&d&&i.jsx("button",{onClick:()=>d({type:I.type,data:I.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:R,children:i.jsx(Wr,{size:14})}),d&&["Complaint","Lab Order","Lab Report"].includes(I.type)&&i.jsx("button",{onClick:()=>d({type:I.type,data:I.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${I.type.toLowerCase()}`,disabled:R,children:i.jsx(Wr,{size:14})})]})]}),I.type==="Lab Order"&&I.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:I.data.editedStatus||I.data.status,onChange:V=>b&&b(I.data.id,V.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:R,children:U.map(V=>i.jsx("option",{value:V,children:V.replace(/_/g," ")},V))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),I.data.editedTests.map((V,re)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:V.id,onChange:ie=>{const G=M.find(Y=>String(Y.id)===ie.target.value);G&&(g&&g(I.data.id,re,"id",G.id),g&&g(I.data.id,re,"name",G.name),g&&g(I.data.id,re,"price",G.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:R,children:[i.jsx("option",{value:"",children:"Select Test"}),M.map(ie=>i.jsxs("option",{value:ie.id,children:[ie.name," (",ie.price,")"]},ie.id))]}),i.jsx("button",{onClick:()=>{const ie=I.data.editedTests.filter((G,Y)=>Y!==re);g&&g(I.data.id,-1,"remove",ie)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:R,children:i.jsx(Wr,{size:14})})]},re)),i.jsx("button",{onClick:()=>{g&&g(I.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:R,children:"Add Test"})]})]},`${I.type}-${I.originalDateString}-${F}`))})]},B))})]})},nJ="_modalOverlay_1yna4_3",rJ="_modalContent_1yna4_29",iJ="_modalHeader_1yna4_57",aJ="_modalTitle_1yna4_75",sJ="_modalCloseButton_1yna4_87",oJ="_modalBody_1yna4_115",lJ="_errorText_1yna4_129",cJ="_formGroup_1yna4_147",uJ="_inputField_1yna4_171",dJ="_searchResultsCard_1yna4_213",fJ="_searchResultsList_1yna4_241",hJ="_searchResultItem_1yna4_253",pJ="_searchResultPrice_1yna4_289",mJ="_selectedTestsCard_1yna4_299",gJ="_selectedTestsHeader_1yna4_319",yJ="_noTestsMessage_1yna4_335",xJ="_selectedTestsList_1yna4_351",bJ="_selectedTestItem_1yna4_363",vJ="_selectedTestName_1yna4_387",wJ="_selectedTestPrice_1yna4_399",SJ="_removeTestButton_1yna4_411",NJ="_totalAmount_1yna4_437",CJ="_modalFooter_1yna4_455",_J="_button_1yna4_473",jJ="_buttonPrimary_1yna4_491",kJ="_buttonSecondary_1yna4_513",Et={modalOverlay:nJ,modalContent:rJ,modalHeader:iJ,modalTitle:aJ,modalCloseButton:sJ,modalBody:oJ,errorText:lJ,formGroup:cJ,inputField:uJ,searchResultsCard:dJ,searchResultsList:fJ,searchResultItem:hJ,searchResultPrice:pJ,selectedTestsCard:mJ,selectedTestsHeader:gJ,noTestsMessage:yJ,selectedTestsList:xJ,selectedTestItem:bJ,selectedTestName:vJ,selectedTestPrice:wJ,removeTestButton:SJ,totalAmount:NJ,modalFooter:CJ,button:_J,buttonPrimary:jJ,buttonSecondary:kJ},TJ=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){h([]);return}const M=d.toLowerCase();h(r.filter(R=>R.name.toLowerCase().includes(M)||R.description&&R.description.toLowerCase().includes(M)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const M={patient_id:t,tests:o.map(z=>({id:z.id,name:z.name,price:z.price}))},R=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!R.ok){const z=await R.json().catch(()=>({}));throw new Error(z.message||`Failed to create lab order: ${R.statusText}`)}await R.json(),a(t),n(),l([]),f("")}catch(M){b(`Lab Order Creation Error: ${M.message}`)}finally{S(!1)}},T=M=>{if(o.some(R=>R.id===M.id)){b(`${M.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),h([]);return}l(R=>[...R,{...M}]),f(""),h([])},P=M=>{l(R=>R.filter(z=>z.id!==M))};return e?i.jsx("div",{className:Et.modalOverlay,children:i.jsxs("div",{className:Et.modalContent,children:[i.jsxs("div",{className:Et.modalHeader,children:[i.jsx("h3",{className:Et.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:Et.modalCloseButton,children:i.jsx(bn,{size:20})})]}),i.jsxs("div",{className:Et.modalBody,children:[g&&i.jsx("div",{className:Et.errorText,children:g}),i.jsxs("div",{className:Et.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:d,onChange:M=>f(M.target.value),className:Et.inputField}),d&&u.length>0&&i.jsx("div",{className:Et.searchResultsCard,children:i.jsx("ul",{className:Et.searchResultsList,children:u.map(M=>i.jsxs("li",{onClick:()=>T(M),className:Et.searchResultItem,children:[i.jsx("span",{children:M.name}),i.jsxs("span",{className:Et.searchResultPrice,children:["(",parseFloat(String(M.price)).toFixed(2),")"]})]},M.id))})})]}),i.jsxs("div",{className:Et.selectedTestsCard,children:[i.jsx("h4",{className:Et.selectedTestsHeader,children:"Selected Tests"}),o.length===0?i.jsx("p",{className:Et.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:Et.selectedTestsList,children:o.map(M=>i.jsxs("li",{className:Et.selectedTestItem,children:[i.jsx("span",{className:Et.selectedTestName,children:M.name}),i.jsxs("span",{className:Et.selectedTestPrice,children:["",parseFloat(String(M.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>P(String(M.id)),className:Et.removeTestButton,title:"Remove Test",children:i.jsx(Wr,{size:16})})]},M.id))})]}),o.length>0&&i.jsxs("div",{className:Et.totalAmount,children:["Total: ",o.reduce((M,R)=>M+parseFloat(String(R.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:Et.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Et.button} ${Et.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${Et.button} ${Et.buttonPrimary} ${o.length===0||v?Et.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},Ex=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},Um=(e,n)=>{if(!e||!n||n.length===0)return;const t=Ex(e);let r=n.find(l=>Ex(l.name)===t);if(r)return r;let a=n.find(l=>Ex(l.name).includes(t));if(a)return a;let o=n.find(l=>t.includes(Ex(l.name)));if(o)return o},EJ=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
   - **Important: Preventing Loops** If you determine that no further actions are needed (e.g., you have already performed necessary actions, or the user's input does not require any specific action), you **MUST** use the \`end_task\` action. This explicitly signals that your task is complete and prevents the system from re-prompting you unnecessarily.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "create_lab_report", "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "edit_lab_report", "serialNumber": number, "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." },
  { "action": "end_task" }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Structure:**
     The AI response can be a flat array of actions OR a list of "function call" objects containing grouped actions.
     **Option 1: Flat Array (Simple)**
     \`\`\`json
     [
       { "action": "add_complaint_history", ... },
       { "action": "create_lab_order", ... }
     ]
     \`\`\`
     **Option 2: Grouped Function Calls (Complex)**
     You can group actions under logical "function calls" if needed.
     \`\`\`json
     [
       {
         "function_call": "assess_patient",
         "actions": [
           { "action": "ask_followup_question", "question": "..." }
         ]
       },
       {
         "function_call": "prescribe_treatment",
         "actions": [
            { "action": "create_pharmacy_order", "items": [...] },
            { "action": "create_lab_order", "tests": [...] }
         ]
       }
     ]
     \`\`\`

   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this action (either standalone or inside a group) only when you need clarification.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"]
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,Z_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",AJ="models/gemini-3-flash-preview";async function PJ(){if(!Sw())return console.warn("No auth token found, using default Gemini API key."),Z_;let n=null;try{const t=await me("/api/clinics/settings");if(t.ok){const r=await t.json();r.gemini_api_key&&r.gemini_api_key.trim()!==""&&(n=r.gemini_api_key.trim())}}catch(t){console.warn("Could not fetch clinic settings (or key missing), proceeding to global fallback.",t)}if(n)return n;try{const t=await me("/api/global-settings/app_gemini_api_key");if(t.ok){const a=(await t.json()).value;if(a&&a.trim()!=="")return a.trim()}}catch(t){console.warn("Could not fetch global API key.",t)}return console.warn("Clinic-specific and global Gemini API keys not found, using default env var."),Z_}let U0=null;async function DJ(){if(!U0){const e=await PJ();U0=new ww({apiKey:e})}return U0}async function IJ(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:o,patientGender:l,case_summary:d,case_summary_last_updated:f,clinic_ai_memory:u,clinic_ai_memory_last_updated:h,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,pharmacyInventory:k,labInventory:T}=e;let P=`Patient Complaint: ${t}`;if(d&&(P+=`

--- Case Summary (Provided by Doctor) ---
${d}`,f))try{const I=new Date(f).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${I})`}catch{console.warn(`Could not format case_summary_last_updated: ${f}`),P+=`
(Last Updated: ${f})`}if(a&&(P+=`

Patient Name: ${a}`),o!=null&&(P+=`
Patient Age: ${o}`),l&&(P+=`
Patient Gender: ${l}`),r)try{const I=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`

Current Interaction Time: ${I}`}catch{console.warn(`Could not format currentDateTime: ${r}`),P+=`

Current Interaction Time: ${r}`}if(u&&(P+=`

--- Clinic-wide AI Memory/Context ---
${u}`,h))try{const I=new Date(h).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${I})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${h}`),P+=`
(Last Updated: ${h})`}let M="";b&&Array.isArray(b)&&b.length>0&&(M=`

--- Lab History (Orders & Reports) ---
`,b.forEach(I=>{let F="Unknown Date";try{F=new Date(I.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${I.orderDate}`)}if(M+=`
Order #${I.serialNumber} Date: ${F} (Status: ${I.status})
`,M+=`Tests: ${I.tests.map(V=>V.name).join(", ")}
`,I.report){let V="Unknown Date";try{V=new Date(I.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${I.report.reportDate}`)}M+=`  -> Report Date: ${V}
`,I.report.tests&&Array.isArray(I.report.tests)?(M+=`     Findings:
`,I.report.tests.forEach(re=>{M+=`       - Test: ${re.testName}
`,re.parameters&&Array.isArray(re.parameters)&&re.parameters.forEach(ie=>{M+=`         - ${ie.name}: ${ie.value} (Normal: ${ie.normal_range})
`})})):(M+=`     Findings: ${I.report.reportContent||"N/A"}
`,I.report.error&&(M+=`     Note: ${I.report.error}
`))}M+=`---
`}),P+=M);let R="";v&&Array.isArray(v)&&v.length>0&&(R=`

--- Recent Pharmacy Orders ---
`,v.forEach(I=>{let F="Unknown Date/Time";try{F=new Date(I.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${I.date}`)}R+=`
Order #${I.serialNumber} Date/Time: ${F} (Status: ${I.status})
`,R+=`Prescribed By: ${I.prescribedBy||"N/A"}
`,I.dispensedBy&&(R+=`Dispensed By: ${I.dispensedBy}
`),R+=`Medications:
`,I.medications.forEach(V=>{R+=`  - ${V.name} (Qty: ${V.quantity}`,V.tabletsPerDay&&(R+=`, ${V.tabletsPerDay}/day`),V.numberOfDays&&(R+=` for ${V.numberOfDays} days`),R+=`)
`}),I.prescriptionForUnavailableDrugs&&(R+=`  Prescription for Unavailable Drugs: ${I.prescriptionForUnavailableDrugs}
`),R+=`---
`}),P+=R);let z="";S&&Array.isArray(S)&&S.length>0&&(z=`

--- Past Complaints History ---
`,S.forEach(I=>{let F="Unknown Date/Time";try{F=new Date(I.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${I.createdAt}`)}z+=`
Date/Time: ${F}
Complaint: ${I.complaint||"N/A"}
---
`}),P+=z);let $="";k&&Array.isArray(k)&&k.length>0&&($=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(I=>{let F=`${I.stock??0} packs`;I.loose!==void 0&&I.loose!==null&&I.loose>0&&(F+=`, ${I.loose} loose`);let V=`- ${I.name} (Pack: ${I.pack??"N/A"}): ${F}`;const re=[];I.brand_name&&re.push(`Brand: ${I.brand_name}`),I.batch&&re.push(`Batch: ${I.batch}`),I.expiry_date&&re.push(`Exp: ${I.expiry_date}`),re.length>0&&(V+=` [${re.join(", ")}]`),$+=`${V}
`}),P+=$);let L="";T&&Array.isArray(T)&&T.length>0&&(L=`

--- Available Lab Tests (with Parameters) ---
`,T.forEach(I=>{L+=`- ${I.name} (Price: ${I.price??"N/A"})
`,I.default_parameters&&Array.isArray(I.default_parameters)&&I.default_parameters.length>0&&I.default_parameters.forEach(F=>{let V=`    * ${F.name}`;F.unit&&(V+=` (${F.unit})`),F.normal_range?V+=` [Normal: ${F.normal_range}]`:F.lower_limit!==void 0&&F.upper_limit!==void 0&&F.lower_limit!==null&&F.upper_limit!==null&&(V+=` [Normal: ${F.lower_limit} - ${F.upper_limit}]`),L+=`${V}
`})}),P+=L);const U=[{text:EJ}];g&&g.trim()!==""&&U.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const B=[{text:P}];if(n){const I=new FileReader,F=await new Promise((V,re)=>{I.onloadend=()=>{typeof I.result=="string"?V(I.result.split(",")[1]):re(new Error("Failed to read image file as base64."))},I.onerror=re,I.readAsDataURL(n)});B.push({inlineData:{mimeType:n.type,data:F}})}const W=[];U.length>0&&W.push({role:"user",parts:U}),W.push({role:"user",parts:B});try{const I={model:AJ,contents:W,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},V=await(await DJ()).models.generateContentStream(I);let re="";for await(const ie of V)if(ie&&typeof ie.text=="function"){const G=ie.text;G&&(re+=G)}else ie&&ie.candidates&&ie.candidates[0]&&ie.candidates[0].content&&ie.candidates[0].content.parts&&ie.candidates[0].content.parts[0]&&ie.candidates[0].content.parts[0].text&&(re+=ie.candidates[0].content.parts[0].text);if(re&&re.trim()!=="")return re.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(I){console.error("Error calling Gemini API:",I);let F="Failed to get suggestion from Gemini.";throw I.message&&(F=`Error processing Gemini request: ${I.message}`),new Error(F)}}const RJ=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},MJ=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:o,userMessages:l,selectedImageFile:d,pendingLabOrders:f,labReports:u,pastComplaints:h,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,currentComplaint:S,setCurrentComplaint:k,setAiResponse:T,setAiResponseText:P,setAiResponseJsonString:M,setShowAiJsonDetails:R,setIsLoadingAi:z,setAiError:$,setIsSubmittingAiOrder:L,setAiOrderSubmissionStatus:U,setIsSubmittingAiLabOrder:B,setAiLabOrderSubmissionStatus:W,setIsSubmittingAiComplaint:I,setAiComplaintSubmissionStatus:F,setIsUpdatingCaseSummary:V,setAiCaseSummaryUpdateStatus:re,setCaseSummary:ie,setIsUpdatingAiMemoryByAI:G,setAiMemoryUpdateByAIStatus:Y,setFollowUpQuestion:ne,setFollowUpOptions:le,setError:oe,setIsSavingAiResponse:E,setSaveAiResponseError:de,fetchPharmacyOrdersData:he,fetchPendingLabOrdersData:D,fetchLabReportsData:pe,fetchPastComplaintsData:Ne,fetchPatientDetails:te,setClinicSettings:K,setEditedAiMemory:J,setCanUndo:ye,onAiActionSuccess:He,addMessage:Q},Pe)=>{const[Re,Le]=kn.useState(null);kn.useEffect(()=>{ye(!!Re)},[Re,ye]);let _e;const Ke=async(ue,Ae,ke,Se=0)=>{let ve;const fe=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(Ge=>{var Je;return(Je=Ae.message)==null?void 0:Je.includes(Ge)});ke&&fe?ve=`AI Error: ${Ae.message}

${ke}`:(ve=`I encountered a frontend error while trying to execute the '${ue}' function. The error message is: "${Ae.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(ue==="create_pharmacy_order"||ue==="edit_pharmacy_order")&&(ve+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),ke&&(ve+=`

The original AI response that caused the error was:
\`\`\`
${ke}
\`\`\``)),Q==null||Q({role:"system",type:"error",content:`AI Error: ${Ae.message}. Retrying...`}),await _e(ve,Se+1)},Ye=async ue=>{console.log("Executing Rollback for actions:",ue);for(const Ae of ue){const{actionType:ke,undoData:Se}=Ae;if(console.log(`Attempting to rollback ${ke}`,Se),!Se){console.warn(`No undoData found for action ${ke}, skipping.`);continue}try{if(ke==="create_pharmacy_order")Se!=null&&Se.orderId?(console.log(`Deleting pharmacy order ${Se.orderId}`),await me(`/api/pharmacy-orders/${Se.orderId}`,{method:"DELETE"}),he(n)):console.error("Missing orderId for create_pharmacy_order rollback");else if(ke==="create_lab_order")Se!=null&&Se.orderId?(console.log(`Deleting lab order ${Se.orderId}`),await me(`/api/lab/orders/${Se.orderId}`,{method:"DELETE"}),D(n)):console.error("Missing orderId for create_lab_order rollback");else if(ke==="update_patient_details")if(Se!=null&&Se.patientId&&(Se!=null&&Se.originalDetails)){console.log(`Reverting patient details for ${Se.patientId}`);const ve=Se.originalDetails,X={name:ve.name,age:ve.age,gender:ve.gender,phone:ve.phone,ai_response:ve.ai_response};await me(`/api/patients/${Se.patientId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)}),te(Se.patientId)}else console.error("Missing patientId or originalDetails for update_patient_details rollback");else if(ke==="add_complaint_history")Se!=null&&Se.recordId?(console.log(`Reverting complaint history for ${Se.recordId}`),await me(`/api/queue/doctor/complaint/${Se.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:Se.originalComplaint||""})}),k(Se.originalComplaint||"")):console.error("Missing recordId for add_complaint_history rollback");else if(ke==="update_case_summary")Se!=null&&Se.recordId?(console.log(`Reverting case summary for ${Se.recordId}`),await me(`/api/queue/doctor/complaint/${Se.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:Se.originalSummary||""})}),ie(Se.originalSummary||"")):console.error("Missing recordId for update_case_summary rollback");else if(ke==="update_clinic_ai_memory")(Se==null?void 0:Se.originalMemory)!==void 0?(console.log("Reverting AI memory"),await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify({...o,aiMemory:Se.originalMemory})}),J(Se.originalMemory)):console.error("Missing originalMemory for update_clinic_ai_memory rollback");else if(ke==="edit_pharmacy_order")if(Se!=null&&Se.orderId&&(Se!=null&&Se.originalState)){console.log(`Reverting pharmacy order ${Se.orderId}`);const ve={items:Se.originalState.medications||[],status:Se.originalState.status,prescription_for_unavailable_drugs:Se.originalState.prescription_for_unavailable_drugs,order_total:Se.originalState.order_total};await me(`/api/pharmacy-orders/${Se.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)}),he(n)}else console.error("Missing orderId or originalState for edit_pharmacy_order rollback");else if(ke==="edit_lab_order")if(Se!=null&&Se.orderId&&(Se!=null&&Se.originalState)){console.log(`Reverting lab order ${Se.orderId}`);const ve={tests:Se.originalState.tests,status:Se.originalState.status};await me(`/api/lab/orders/${Se.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)}),D(n)}else console.error("Missing orderId or originalState for edit_lab_order rollback");else console.warn(`Unknown action type for rollback: ${ke}`)}catch(ve){console.error(`Failed to rollback ${ke}:`,ve)}}},it=async()=>{!Re||!window.confirm("Are you sure you want to undo the last AI actions?")||(z(!0),await Ye([...Re].reverse()),Le(null),z(!1),$("Last actions undone successfully."))},xt=async(ue,Ae)=>{Le(null),U(null),W(null),F(null),re(null),Y(null),ne(null),le([]),oe(null);let ke=null;const Se=/```json\s*([\s\S]*?)\s*```/,ve=ue.match(Se);if(ve&&ve[1])ke=ve[1];else{const X=ue.trim();if(X.startsWith("{")&&X.endsWith("}"))ke=X;else if(X.startsWith("[")&&X.endsWith("]"))ke=X;else throw new Error("AI response did not contain a recognized function call.")}if(ke)try{const X=JSON.parse(ke),fe=be=>{const Fe=[],Ie=Array.isArray(be)?be:[be];for(const Ve of Ie)Ve&&(Ve.actions&&Array.isArray(Ve.actions)?Fe.push(...fe(Ve.actions)):Ve.sub_actions&&Array.isArray(Ve.sub_actions)?Fe.push(...fe(Ve.sub_actions)):Ve.function_calls&&Array.isArray(Ve.function_calls)?Fe.push(...fe(Ve.function_calls)):typeof Ve.action=="string"&&Fe.push(Ve));return Fe},Ge=fe(X),Je=[];let ct=null,wt=!1;for(const be of Ge){if(be.action==="ask_followup_question"){ct=be,wt=!0;continue}wt=!0;const Fe=be.action;Fe==="update_clinic_ai_memory"&&typeof be.memory_content=="string"?Je.push((async()=>{G(!0),Y("Processing AI mem..."),Q==null||Q({role:"system",type:"loading",content:"Processing AI memory..."});const Ie=(o==null?void 0:o.aiMemory)||"";try{if(!o)throw new Error("Clinic settings not loaded.");const Ve={...o,aiMemory:be.memory_content.trim(),admissionCharge:o.admissionCharge,perDayCharge:o.perDayCharge,otherCharges:o.otherCharges,clinicWideSystemPrompt:o.clinicWideSystemPrompt},st=await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Ve)});if(!st.ok){const Ct=await st.json().catch(()=>({}));throw new Error(Ct.message||`AI-triggered clinic memory update failed: ${st.statusText}`)}const mt=await st.json();return K(Ct=>Ct?{...Ct,aiMemory:mt.settings.aiMemory}:null),J(mt.settings.aiMemory||""),Y("AI mem updated!"),Q==null||Q({role:"system",type:"success",content:"AI memory updated successfully."}),{success:!0,actionType:Fe,undoData:{originalMemory:Ie}}}catch(Ve){return Y("Failed"),{success:!1,actionType:Fe,error:Ve,originalActionPayload:be}}finally{G(!1)}})()):Fe==="create_pharmacy_order"?Je.push((async()=>{var Ie,Ve;L(!0),U("Processing order..."),Q==null||Q({role:"system",type:"loading",content:"Processing pharmacy order..."});try{if(!n)throw new Error("Missing patient ID.");const st=[];let mt=null;if(Array.isArray(be.items))for(const kt of be.items){let bt;if(kt.drug_id?bt=b.find(Jr=>Jr.id===kt.drug_id):kt.name&&(bt=Um(kt.name,b)),!bt){mt=`Drug "${kt.name||kt.drug_id}" not found.`;break}const Yt=RJ(bt.pack),It=Number(bt.mrp),Jn=It,Vr=Yt>0?It/Yt:0,fr=Number(kt.pack_quantity)||0,En=Number(kt.loose_quantity)||0,wr=fr*Jn+En*Vr;st.push({drug_id:String(bt.id),name:bt.name,pack_quantity:fr,loose_quantity:En,tabletsPerDay:kt.tabletsPerDay,numberOfDays:kt.numberOfDays,directions_to_use:kt.directions_to_use,group_id:kt.group_id,pack_price:Jn,loose_price:Vr,total_price:wr,price:It,isLoose:kt.isLoose,unit:bt.pack})}if(mt)throw new Error(mt);const Ct=st.reduce((kt,bt)=>kt+bt.total_price,0),ln={patient_id:n,items:st,prescription_for_unavailable_drugs:be.prescription_for_unavailable_drugs,order_total:parseFloat(Ct.toFixed(2))},dn=await me("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ln)});if(!dn.ok){const kt=await dn.json().catch(()=>({}));throw new Error(kt.message||"Order creation failed.")}const vn=await dn.json();return U("Order created!"),he(n),Q==null||Q({role:"system",type:"success",content:"Pharmacy order created successfully."}),{success:!0,actionType:Fe,data:vn,undoData:{orderId:((Ve=(Ie=vn.orders)==null?void 0:Ie[0])==null?void 0:Ve.id)||vn.id}}}catch(st){return Q==null||Q({role:"system",type:"error",content:`Pharmacy order failed: ${st.message}`}),{success:!1,actionType:Fe,error:st,originalActionPayload:be}}finally{L(!1)}})()):Fe==="update_patient_details"?Je.push((async()=>{z(!0),Q==null||Q({role:"system",type:"loading",content:"Updating patient details..."});const Ie={...t};try{if(!n)throw new Error("Missing patient ID.");const Ve={};if(be.name&&(Ve.name=be.name),be.age&&(Ve.age=be.age),be.gender&&(Ve.gender=be.gender),be.phone_number!==void 0&&(Ve.phone_number=be.phone_number),!(await me(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ve)})).ok)throw new Error("Patient update failed.");return te(n),Q==null||Q({role:"system",type:"success",content:"Patient details updated."}),{success:!0,actionType:Fe,undoData:{patientId:n,originalDetails:Ie}}}catch(Ve){return{success:!1,actionType:Fe,error:Ve,originalActionPayload:be}}finally{z(!1)}})()):Fe==="create_lab_order"?Je.push((async()=>{B(!0),W("Processing lab..."),Q==null||Q({role:"system",type:"loading",content:"Processing lab order..."});try{if(!n)throw new Error("Missing patient ID.");const Ie=[];for(const mt of be.tests||[]){let Ct;if(mt.id?Ct=v.find(ln=>String(ln.id)===String(mt.id)):mt.name&&(Ct=Um(mt.name,v)),!Ct)throw new Error(`Lab test "${mt.name}" not found.`);Ie.push({id:Ct.id,name:Ct.name,price:Number(Ct.price)})}const Ve=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:Ie})});if(!Ve.ok)throw new Error("Lab order creation failed.");const st=await Ve.json();return W("Success!"),D(n),Q==null||Q({role:"system",type:"success",content:"Lab order created."}),{success:!0,actionType:Fe,data:st.labOrder,undoData:{orderId:st.labOrder.id}}}catch(Ie){return Q==null||Q({role:"system",type:"error",content:`Lab order failed: ${Ie.message}`}),{success:!1,actionType:Fe,error:Ie,originalActionPayload:be}}finally{B(!1)}})()):Fe==="create_lab_report"?Je.push((async()=>{B(!0),W("Creating Report..."),Q==null||Q({role:"system",type:"loading",content:"Creating lab report..."});try{if(!n)throw new Error("Missing patient ID.");const Ie=[],Ve=be.tests||[];for(const vn of Ve){let kt;if(vn.id?kt=v.find(bt=>String(bt.id)===String(vn.id)):vn.name&&(kt=Um(vn.name,v)),!kt)throw new Error(`Lab test "${vn.name}" not found.`);vn._matchedTest=kt,Ie.push({id:kt.id,name:kt.name,price:Number(kt.price)})}const st=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:Ie,status:"reported"})});if(!st.ok)throw new Error("Lab order creation failed during report generation.");const mt=await st.json(),Ct=mt.labOrder.id,ln={};if(Ve.forEach(vn=>{const kt=vn._matchedTest,bt=kt.id,Yt=vn.parameters||[],It={};kt.default_parameters&&kt.default_parameters.forEach(Jn=>{Jn.defaultValue!==void 0&&Jn.defaultValue!==null&&(It[Jn.name]=Jn.defaultValue)}),Yt.forEach(Jn=>{Jn.name&&Jn.value!==void 0&&(It[Jn.name]=Jn.value)}),ln[bt]=It}),!(await me(`/api/lab/${Ct}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(ln)})})).ok)throw new Error("Report submission failed.");return W("Report Created!"),D(n),pe(n),Q==null||Q({role:"system",type:"success",content:"Lab report created successfully."}),{success:!0,actionType:Fe,data:mt.labOrder,undoData:{orderId:Ct}}}catch(Ie){return Q==null||Q({role:"system",type:"error",content:`Lab report failed: ${Ie.message}`}),{success:!1,actionType:Fe,error:Ie,originalActionPayload:be}}finally{B(!1)}})()):Fe==="edit_lab_report"?Je.push((async()=>{B(!0),W("Updating Report...");try{const Ie=be.serialNumber;if(!Ie)throw new Error("Missing serial number for lab report edit.");const Ve=new Map;(f??[]).forEach(Yt=>Ve.set(Yt.id,{...Yt})),(u??[]).forEach(Yt=>{if(Ve.has(Yt.id)){const It=Ve.get(Yt.id);It.report=Yt,It.status=Yt.status}else Ve.set(Yt.id,{...Yt,createdAt:Yt.createdAt})});const st=Array.from(Ve.values());st.sort((Yt,It)=>new Date(It.createdAt).getTime()-new Date(Yt.createdAt).getTime());const mt=st.length-Ie,Ct=st[mt];if(!Ct)throw new Error(`Lab report #${Ie} not found.`);const ln=Ct.id;let dn={};if(Ct.report&&Ct.report.report_content)try{dn=typeof Ct.report.report_content=="string"?JSON.parse(Ct.report.report_content):Ct.report.report_content}catch{}const vn={...dn};if((be.tests||[]).forEach(Yt=>{let Jn=(Ct.tests||[]).find(En=>En.name.toLowerCase()===Yt.name.toLowerCase());if(!Jn)return;const Vr=Jn.id,fr=Yt.parameters||[];vn[Vr]||(vn[Vr]={}),fr.forEach(En=>{En.name&&En.value!==void 0&&(vn[Vr][En.name]=En.value)})}),!(await me(`/api/lab/${ln}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(vn)})})).ok)throw new Error("Report update failed.");return W("Report Updated!"),D(n),pe(n),Q==null||Q({role:"system",type:"success",content:"Lab report updated successfully."}),{success:!0,actionType:Fe,data:{orderId:ln},undoData:{orderId:ln}}}catch(Ie){return Q==null||Q({role:"system",type:"error",content:`Update report failed: ${Ie.message}`}),{success:!1,actionType:Fe,error:Ie,originalActionPayload:be}}finally{B(!1)}})()):Fe==="edit_pharmacy_order"?Je.push((async()=>{L(!0);try{const Ie=be.serialNumber;let Ve;if(Ie?Ve=[...g].sort((bt,Yt)=>new Date(bt.date).getTime()-new Date(Yt.date).getTime())[Ie-1]:Ve=g.find(kt=>kt.status==="pending"),!Ve)throw new Error("Order to edit not found.");const st=JSON.parse(JSON.stringify(Ve));let mt=[...Ve.medications];const Ct=be.items_to_remove,ln=be.items;if(Array.isArray(Ct)&&(mt=mt.filter(kt=>!Ct.some(bt=>bt.drug_id&&String(kt.drug_id)===String(bt.drug_id)||bt.name&&kt.name.toLowerCase()===bt.name.toLowerCase()))),Array.isArray(ln))for(const kt of ln){let bt;if(kt.drug_id?bt=b.find(Jn=>String(Jn.id)===String(kt.drug_id)):kt.name&&(bt=Um(kt.name,b)),!bt)throw new Error(`Drug ${kt.name} not found.`);const Yt=mt.findIndex(Jn=>Jn.drug_id===String(bt==null?void 0:bt.id)),It={drug_id:String(bt.id),name:bt.name,pack_quantity:kt.pack_quantity||0,loose_quantity:kt.loose_quantity||0,pack_price:Number(bt.mrp),loose_price:0,total_price:0,price:Number(bt.mrp)};Yt>=0?mt[Yt]={...mt[Yt],...It}:mt.push(It)}const dn={items:mt,status:be.status,prescription_for_unavailable_drugs:be.prescription_for_unavailable_drugs,order_total:0};if(!(await me(`/api/pharmacy-orders/${Ve.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(dn)})).ok)throw new Error("Order edit failed.");return he(n),{success:!0,actionType:Fe,undoData:{orderId:Ve.id,originalState:st}}}catch(Ie){return{success:!1,actionType:Fe,error:Ie,originalActionPayload:be}}finally{L(!1)}})()):Fe==="edit_lab_order"?Je.push((async()=>{B(!0);try{const Ie=f.sort((Ct,ln)=>new Date(ln.createdAt).getTime()-new Date(Ct.createdAt).getTime()).find(Ct=>Ct.status==="pending");if(!Ie)throw new Error("No pending lab order to edit.");const Ve=JSON.parse(JSON.stringify(Ie)),st={tests:[],status:be.status};if(!(await me(`/api/lab/orders/${Ie.id}`,{method:"PUT",body:JSON.stringify(st),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Lab edit failed.");return D(n),{success:!0,actionType:Fe,undoData:{orderId:Ie.id,originalState:Ve}}}catch(Ie){return{success:!1,actionType:Fe,error:Ie,originalActionPayload:be}}finally{B(!1)}})()):Fe==="add_complaint_history"?Je.push((async()=>{I(!0),Q==null||Q({role:"system",type:"loading",content:"Updating complaint history..."});const Ie=S;try{if(!e)throw new Error("No record ID.");if(!(await me(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({complaint:be.complaint}),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Complaint update failed.");return k(be.complaint),n&&Ne(n),Q==null||Q({role:"system",type:"success",content:"Complaint history updated."}),{success:!0,actionType:Fe,undoData:{recordId:e,originalComplaint:Ie}}}catch(Ve){return Q==null||Q({role:"system",type:"error",content:`Complaint history update failed: ${Ve.message}`}),{success:!1,actionType:Fe,error:Ve,originalActionPayload:be}}finally{I(!1)}})()):Fe==="update_case_summary"?Je.push((async()=>{V(!0),Q==null||Q({role:"system",type:"loading",content:"Updating case summary..."});const Ie=r;try{if(!e)throw new Error("No record ID.");const Ve=await me(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({case_summary:be.summary}),headers:{"Content-Type":"application/json"}});if(!Ve.ok)throw new Error("Summary update failed.");const st=await Ve.json();return ie(st.case_summary),Q==null||Q({role:"system",type:"success",content:"Case summary updated."}),{success:!0,actionType:Fe,undoData:{recordId:e,originalSummary:Ie}}}catch(Ve){return Q==null||Q({role:"system",type:"error",content:`Case summary update failed: ${Ve.message}`}),{success:!1,actionType:Fe,error:Ve,originalActionPayload:be}}finally{V(!1)}})()):Fe==="end_task"?Je.push((async()=>(Q==null||Q({role:"system",type:"success",content:"Task completed."}),{success:!0,actionType:Fe}))()):(console.warn(`Unknown action ${Fe}`),Je.push(Promise.resolve({success:!1,actionType:Fe,error:new Error(`Unknown action: ${Fe}`),originalActionPayload:be})))}const Ht=await Promise.all(Je),Ce=Ht.filter(be=>!be.success);if(Ce.length>0){console.log("AI Actions Failed. Initiating Rollback...",Ce);const be=Ht.filter(mt=>mt.success),Fe=[...be].reverse();await Ye(Fe);const Ie=Ce.map(mt=>{var Ct;return`${mt.actionType}: ${(Ct=mt.error)==null?void 0:Ct.message}`}).join("; "),Ve=be.length>0?` I successfully rolled back ${be.length} other actions that succeeded.`:"",st=`One or more actions failed: [${Ie}].${Ve} Please analyze the failure and try again.`;await Ke("multiple_actions",{message:st},ue,Ae)}else{const be=Ht.filter(Fe=>Fe.success);if(be.length>0&&(Le(be),He&&be.forEach(Fe=>He(Fe.actionType))),ct&&typeof ct.question=="string")ne(ct.question),le(Array.isArray(ct.options)?ct.options:[]);else if(!wt)throw new Error("AI response did not result in a recognized or performed function call.")}}catch(X){await Ke("parse_json_actions",X,ue,Ae)}else throw new Error("AI response did not contain a recognized function call.")};_e=async(ue,Ae=0)=>{if(Ae>1){$("AI call failed after multiple retries. Please try a different prompt."),z(!1);return}z(!0),$(null);let ke;const ve=[...l,ue].join(`

`);try{const X=new Map;(f??[]).forEach(Ce=>{X.set(Ce.id,{...Ce})}),(u??[]).forEach(Ce=>{if(!X.has(Ce.id))X.set(Ce.id,{id:Ce.id,patient_id:Ce.patient_id,tests:Ce.tests,status:Ce.status,createdAt:Ce.createdAt,report:Ce});else{const be=X.get(Ce.id);be&&(be.report=Ce,be.status=Ce.status)}});const fe=Array.from(X.values());fe.sort((Ce,be)=>new Date(be.createdAt).getTime()-new Date(Ce.createdAt).getTime());const Ge=fe.map((Ce,be)=>{let Fe=null;if(Ce.report)try{const Ie=typeof Ce.report.report_content=="string"?Ce.report.report_content:JSON.stringify(Ce.report.report_content||{}),Ve=JSON.parse(Ie||"{}"),st=(Ce.report.tests||[]).map(mt=>{const Ct=Ve[mt.id]||{},ln=dn=>({name:dn.name,value:Ct[dn.name]!==void 0?String(Ct[dn.name]):String(dn.defaultValue),normal_range:dn.normal_range||"N/A"});return{testId:mt.id,testName:mt.name,parameters:(mt.default_parameters||[]).map(ln)}});Fe={reportId:Ce.report.reportId,reportDate:Ce.report.report_date,tests:st}}catch{Fe={reportId:Ce.report.reportId,reportDate:Ce.report.report_date,reportContent:typeof Ce.report.report_content=="string"?Ce.report.report_content:JSON.stringify(Ce.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:fe.length-be,orderId:Ce.id,orderDate:isNaN(new Date(Ce.createdAt).getTime())?Ce.createdAt:new Date(Ce.createdAt).toISOString(),tests:Ce.tests.map(Ie=>({id:Ie.id,name:Ie.name,price:Ie.price})),status:Ce.status,report:Fe}}),Je=h.map(Ce=>{try{return{...Ce,createdAt:isNaN(new Date(Ce.createdAt).getTime())?Ce.createdAt:new Date(Ce.createdAt).toISOString()}}catch{return Ce}}),wt=[...g].sort((Ce,be)=>{const Fe=new Date(Ce.date).getTime(),Ie=new Date(be.date).getTime();return Fe-Ie}).map((Ce,be)=>{try{return{serialNumber:be+1,...Ce,date:Ce.date&&!isNaN(new Date(Ce.date).getTime())?new Date(Ce.date).toISOString():Ce.date}}catch{return{serialNumber:be+1,...Ce}}}),Ht={query:ve,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(o==null?void 0:o.aiMemory)||"",clinic_ai_memory_last_updated:o!=null&&o.aiMemoryUpdatedAt?new Date(o.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(o==null?void 0:o.clinicWideSystemPrompt)||"",labHistory:Ge,pharmacyOrders:wt,pastComplaints:Je,pharmacyInventory:b,labInventory:v};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(Ht,null,2)),ke=await IJ(Ht,d),ke){T(ke),Q==null||Q({role:"ai",content:ke});const Ce=/```json\s*([\s\S]*?)\s*```/,be=ke.match(Ce);if(be&&be[1])P(ke.replace(Ce,"").trim()),M(be[1].trim());else{const Fe=ke.trim();if(Fe.startsWith("{")&&Fe.endsWith("}"))try{JSON.parse(Fe),P(""),M(Fe)}catch{P(Fe),M(null)}else if(Fe.startsWith("[")&&Fe.endsWith("]"))try{JSON.parse(Fe),P(""),M(Fe)}catch{P(Fe),M(null)}else P(Fe),M(null)}R(!1),n&&ke&&await Nt(n,ke),await xt(ke,Ae),k("")}else throw new Error("Invalid AI response format.")}catch(X){await Ke("call_generative_api",X,ke,Ae)}finally{z(!1)}};const Nt=async(ue,Ae)=>{E(!0),de(null);try{const ke={ai_response:Ae},Se=await me(`/api/patients/${ue}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ke)});if(!Se.ok){const ve=await Se.json().catch(()=>({}));throw new Error(ve.message||`Failed to save AI response to patient: ${Se.statusText}`)}}catch(ke){de(`AI Response Save Error: ${ke.message}`),Q==null||Q({role:"system",type:"error",content:`AI Response Save Error: ${ke.message}`})}finally{E(!1)}};return w.useImperativeHandle(Pe,()=>({callGenerativeApi:_e,undoLastAction:it})),null}),OJ={};function sS(e,n){const t=OJ,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return AE(e,r,a)}function AE(e,n,t){if(LJ(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return ej(e.children,n,t)}return Array.isArray(e)?ej(e,n,t):""}function ej(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=AE(e[a],n,t);return r.join("")}function LJ(e){return!!(e&&typeof e=="object")}const tj=document.createElement("i");function oS(e){const n="&"+e+";";tj.innerHTML=n;const t=tj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function nl(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function ys(e,n){return e.length>0?(nl(e,e.length,0,n),e):n}const nj={}.hasOwnProperty;function FJ(e){const n={};let t=-1;for(;++t<e.length;)$J(n,e[t]);return n}function $J(e,n){let t;for(t in n){const a=(nj.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){nj.call(a,l)||(a[l]=[]);const d=o[l];zJ(a[l],Array.isArray(d)?d:d?[d]:[])}}}function zJ(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);nl(e,0,0,r)}function PE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Ih(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Xo=mu(/[A-Za-z]/),Ba=mu(/[\dA-Za-z]/),UJ=mu(/[#-'*+\--9=?A-Z^-~]/);function Q1(e){return e!==null&&(e<32||e===127)}const J1=mu(/\d/),BJ=mu(/[\dA-Fa-f]/),qJ=mu(/[!-/:-@[-`{-~]/);function Vt(e){return e!==null&&e<-2}function pa(e){return e!==null&&(e<0||e===32)}function Fn(e){return e===-2||e===-1||e===32}const VJ=mu(new RegExp("\\p{P}|\\p{S}","u")),HJ=mu(/\s/);function mu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Xh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Ba(e.charCodeAt(t+1))&&Ba(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function ur(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return Fn(f)?(e.enter(t),d(f)):n(f)}function d(f){return Fn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const GJ={tokenize:YJ};function YJ(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),ur(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Vt(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const WJ={tokenize:QJ},rj={tokenize:JJ};function QJ(e){const n=this,t=[];let r=0,a,o,l;return d;function d(R){if(r<t.length){const z=t[r];return n.containerState=z[1],e.attempt(z[0].continuation,f,u)(R)}return u(R)}function f(R){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const z=n.events.length;let $=z,L;for(;$--;)if(n.events[$][0]==="exit"&&n.events[$][1].type==="chunkFlow"){L=n.events[$][1].end;break}P(r);let U=z;for(;U<n.events.length;)n.events[U][1].end={...L},U++;return nl(n.events,$+1,0,n.events.slice(z)),n.events.length=U,u(R)}return d(R)}function u(R){if(r===t.length){if(!a)return b(R);if(a.currentConstruct&&a.currentConstruct.concrete)return S(R);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(rj,h,g)(R)}function h(R){return a&&M(),P(r),b(R)}function g(R){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(R)}function b(R){return n.containerState={},e.attempt(rj,v,S)(R)}function v(R){return r++,t.push([n.currentConstruct,n.containerState]),b(R)}function S(R){if(R===null){a&&M(),P(0),e.consume(R);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(R)}function k(R){if(R===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(R);return}return Vt(R)?(e.consume(R),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(R),k)}function T(R,z){const $=n.sliceStream(R);if(z&&$.push(null),R.previous=o,o&&(o.next=R),o=R,a.defineSkip(R.start),a.write($),n.parser.lazy[R.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const U=n.events.length;let B=U,W,I;for(;B--;)if(n.events[B][0]==="exit"&&n.events[B][1].type==="chunkFlow"){if(W){I=n.events[B][1].end;break}W=!0}for(P(r),L=U;L<n.events.length;)n.events[L][1].end={...I},L++;nl(n.events,B+1,0,n.events.slice(U)),n.events.length=L}}function P(R){let z=t.length;for(;z-- >R;){const $=t[z];n.containerState=$[1],$[0].exit.call(n,e)}t.length=R}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function JJ(e,n,t){return ur(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function yb(e){if(e===null||pa(e)||HJ(e))return 1;if(VJ(e))return 2}function lS(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const K1={name:"attention",resolveAll:KJ,tokenize:XJ};function KJ(e,n){let t=-1,r,a,o,l,d,f,u,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};ij(g,-f),ij(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=ys(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=ys(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=ys(u,lS(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=ys(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,u=ys(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,nl(e,r-1,t-r+3,u),t=r+u.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function XJ(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=yb(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),h=yb(f),g=!h||h===2&&a||t.includes(f),b=!a||a===2&&h||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(h||!g)),n(f)}}function ij(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const ZJ={name:"autolink",tokenize:eK};function eK(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Xo(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Ba(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||Ba(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||Q1(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),h):UJ(v)?(e.consume(v),u):t(v)}function h(v){return Ba(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Ba(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const Kb={partial:!0,tokenize:tK};function tK(e,n,t){return r;function r(o){return Fn(o)?ur(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Vt(o)?n(o):t(o)}}const DE={continuation:{tokenize:rK},exit:iK,name:"blockQuote",tokenize:nK};function nK(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return Fn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function rK(e,n,t){const r=this;return a;function a(l){return Fn(l)?ur(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(DE,n,t)(l)}}function iK(e){e.exit("blockQuote")}const IE={name:"characterEscape",tokenize:aK};function aK(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return qJ(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const RE={name:"characterReference",tokenize:sK};function sK(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Ba,h(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=BJ,h):(e.enter("characterReferenceValue"),o=7,l=J1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Ba&&!oS(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),h):t(g)}}const aj={partial:!0,tokenize:lK},sj={concrete:!0,name:"codeFenced",tokenize:oK};function oK(e,n,t){const r=this,a={partial:!0,tokenize:$};let o=0,l=0,d;return f;function f(L){return u(L)}function u(L){const U=r.events[r.events.length-1];return o=U&&U[1].type==="linePrefix"?U[2].sliceSerialize(U[1],!0).length:0,d=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(L)}function h(L){return L===d?(l++,e.consume(L),h):l<3?t(L):(e.exit("codeFencedFenceSequence"),Fn(L)?ur(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Vt(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(aj,k,z)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Vt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):Fn(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ur(e,v,"whitespace")(L)):L===96&&L===d?t(L):(e.consume(L),b)}function v(L){return L===null||Vt(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Vt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===d?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,z,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),P}function P(L){return o>0&&Fn(L)?ur(e,M,"linePrefix",o+1)(L):M(L)}function M(L){return L===null||Vt(L)?e.check(aj,k,z)(L):(e.enter("codeFlowValue"),R(L))}function R(L){return L===null||Vt(L)?(e.exit("codeFlowValue"),M(L)):(e.consume(L),R)}function z(L){return e.exit("codeFenced"),n(L)}function $(L,U,B){let W=0;return I;function I(G){return L.enter("lineEnding"),L.consume(G),L.exit("lineEnding"),F}function F(G){return L.enter("codeFencedFence"),Fn(G)?ur(L,V,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(G):V(G)}function V(G){return G===d?(L.enter("codeFencedFenceSequence"),re(G)):B(G)}function re(G){return G===d?(W++,L.consume(G),re):W>=l?(L.exit("codeFencedFenceSequence"),Fn(G)?ur(L,ie,"whitespace")(G):ie(G)):B(G)}function ie(G){return G===null||Vt(G)?(L.exit("codeFencedFence"),U(G)):B(G)}}}function lK(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const B0={name:"codeIndented",tokenize:uK},cK={partial:!0,tokenize:dK};function uK(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),ur(e,o,"linePrefix",5)(u)}function o(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Vt(u)?e.attempt(cK,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Vt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function dK(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Vt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):ur(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Vt(l)?a(l):t(l)}}const fK={name:"codeText",previous:pK,resolve:hK,tokenize:mK};function hK(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function pK(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function mK(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,h(g)):Vt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Vt(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}class gK{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Lm(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Lm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Lm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Lm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Lm(this.left,t.reverse())}}}function Lm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function ME(e){const n={};let t=-1,r,a,o,l,d,f,u;const h=new gK(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,yK(h,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=h.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},d=h.slice(a,t),d.unshift(r),h.splice(a,t-a+1,d))}}return nl(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function yK(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let h,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const xK={resolve:vK,tokenize:wK},bK={partial:!0,tokenize:SK};function vK(e){return ME(e),e}function wK(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Vt(d)?e.check(bK,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function SK(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),ur(e,o,"linePrefix")}function o(l){if(l===null||Vt(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function OE(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let h=0;return g;function g(P){return P===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||Q1(P)?t(P):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||Vt(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!h&&(P===null||P===41||pa(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(P)):h<u&&P===40?(e.consume(P),h++,k):P===41?(e.consume(P),h--,k):P===null||P===32||P===40||Q1(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function LE(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),h}function h(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Vt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Vt(v)||d++>999?(e.exit("chunkString"),h(v)):(e.consume(v),f||(f=!Fn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function FE(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Vt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),ur(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||Vt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function Hm(e,n){let t;return r;function r(a){return Vt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):Fn(a)?ur(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const NK={name:"definition",tokenize:_K},CK={partial:!0,tokenize:jK};function _K(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return LE.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=Ih(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return pa(v)?Hm(e,u)(v):u(v)}function u(v){return OE(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(CK,g,g)(v)}function g(v){return Fn(v)?ur(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Vt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function jK(e,n,t){return r;function r(d){return pa(d)?Hm(e,a)(d):t(d)}function a(d){return FE(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return Fn(d)?ur(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Vt(d)?n(d):t(d)}}const kK={name:"hardBreakEscape",tokenize:TK};function TK(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Vt(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const EK={name:"headingAtx",resolve:AK,tokenize:PK};function AK(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},nl(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function PK(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),o(h)}function o(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||pa(h)?(e.exit("atxHeadingSequence"),d(h)):t(h)}function d(h){return h===35?(e.enter("atxHeadingSequence"),f(h)):h===null||Vt(h)?(e.exit("atxHeading"),n(h)):Fn(h)?ur(e,d,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function f(h){return h===35?(e.consume(h),f):(e.exit("atxHeadingSequence"),d(h))}function u(h){return h===null||h===35||pa(h)?(e.exit("atxHeadingText"),d(h)):(e.consume(h),u)}}const DK=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],oj=["pre","script","style","textarea"],IK={concrete:!0,name:"htmlFlow",resolveTo:OK,tokenize:LK},RK={partial:!0,tokenize:$K},MK={partial:!0,tokenize:FK};function OK(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function LK(e,n,t){const r=this;let a,o,l,d,f;return u;function u(D){return h(D)}function h(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,r.interrupt?n:E):Xo(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):Xo(D)?(e.consume(D),a=4,r.interrupt?n:E):t(D)}function v(D){return D===45?(e.consume(D),r.interrupt?n:E):t(D)}function S(D){const pe="CDATA[";return D===pe.charCodeAt(d++)?(e.consume(D),d===pe.length?r.interrupt?n:V:S):t(D)}function k(D){return Xo(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||pa(D)){const pe=D===47,Ne=l.toLowerCase();return!pe&&!o&&oj.includes(Ne)?(a=1,r.interrupt?n(D):V(D)):DK.includes(l.toLowerCase())?(a=6,pe?(e.consume(D),P):r.interrupt?n(D):V(D)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(D):o?M(D):R(D))}return D===45||Ba(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),r.interrupt?n:V):t(D)}function M(D){return Fn(D)?(e.consume(D),M):I(D)}function R(D){return D===47?(e.consume(D),I):D===58||D===95||Xo(D)?(e.consume(D),z):Fn(D)?(e.consume(D),R):I(D)}function z(D){return D===45||D===46||D===58||D===95||Ba(D)?(e.consume(D),z):$(D)}function $(D){return D===61?(e.consume(D),L):Fn(D)?(e.consume(D),$):R(D)}function L(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,U):Fn(D)?(e.consume(D),L):B(D)}function U(D){return D===f?(e.consume(D),f=null,W):D===null||Vt(D)?t(D):(e.consume(D),U)}function B(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||pa(D)?$(D):(e.consume(D),B)}function W(D){return D===47||D===62||Fn(D)?R(D):t(D)}function I(D){return D===62?(e.consume(D),F):t(D)}function F(D){return D===null||Vt(D)?V(D):Fn(D)?(e.consume(D),F):t(D)}function V(D){return D===45&&a===2?(e.consume(D),Y):D===60&&a===1?(e.consume(D),ne):D===62&&a===4?(e.consume(D),de):D===63&&a===3?(e.consume(D),E):D===93&&a===5?(e.consume(D),oe):Vt(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(RK,he,re)(D)):D===null||Vt(D)?(e.exit("htmlFlowData"),re(D)):(e.consume(D),V)}function re(D){return e.check(MK,ie,he)(D)}function ie(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),G}function G(D){return D===null||Vt(D)?re(D):(e.enter("htmlFlowData"),V(D))}function Y(D){return D===45?(e.consume(D),E):V(D)}function ne(D){return D===47?(e.consume(D),l="",le):V(D)}function le(D){if(D===62){const pe=l.toLowerCase();return oj.includes(pe)?(e.consume(D),de):V(D)}return Xo(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),le):V(D)}function oe(D){return D===93?(e.consume(D),E):V(D)}function E(D){return D===62?(e.consume(D),de):D===45&&a===2?(e.consume(D),E):V(D)}function de(D){return D===null||Vt(D)?(e.exit("htmlFlowData"),he(D)):(e.consume(D),de)}function he(D){return e.exit("htmlFlow"),n(D)}}function FK(e,n,t){const r=this;return a;function a(l){return Vt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function $K(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Kb,n,t)}}const zK={name:"htmlText",tokenize:UK};function UK(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),$):E===63?(e.consume(E),R):Xo(E)?(e.consume(E),B):t(E)}function u(E){return E===45?(e.consume(E),h):E===91?(e.consume(E),o=0,S):Xo(E)?(e.consume(E),M):t(E)}function h(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Vt(E)?(l=g,ne(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?Y(E):E===45?b(E):g(E)}function S(E){const de="CDATA[";return E===de.charCodeAt(o++)?(e.consume(E),o===de.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Vt(E)?(l=k,ne(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),P):k(E)}function P(E){return E===62?Y(E):E===93?(e.consume(E),P):k(E)}function M(E){return E===null||E===62?Y(E):Vt(E)?(l=M,ne(E)):(e.consume(E),M)}function R(E){return E===null?t(E):E===63?(e.consume(E),z):Vt(E)?(l=R,ne(E)):(e.consume(E),R)}function z(E){return E===62?Y(E):R(E)}function $(E){return Xo(E)?(e.consume(E),L):t(E)}function L(E){return E===45||Ba(E)?(e.consume(E),L):U(E)}function U(E){return Vt(E)?(l=U,ne(E)):Fn(E)?(e.consume(E),U):Y(E)}function B(E){return E===45||Ba(E)?(e.consume(E),B):E===47||E===62||pa(E)?W(E):t(E)}function W(E){return E===47?(e.consume(E),Y):E===58||E===95||Xo(E)?(e.consume(E),I):Vt(E)?(l=W,ne(E)):Fn(E)?(e.consume(E),W):Y(E)}function I(E){return E===45||E===46||E===58||E===95||Ba(E)?(e.consume(E),I):F(E)}function F(E){return E===61?(e.consume(E),V):Vt(E)?(l=F,ne(E)):Fn(E)?(e.consume(E),F):W(E)}function V(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,re):Vt(E)?(l=V,ne(E)):Fn(E)?(e.consume(E),V):(e.consume(E),ie)}function re(E){return E===a?(e.consume(E),a=void 0,G):E===null?t(E):Vt(E)?(l=re,ne(E)):(e.consume(E),re)}function ie(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||pa(E)?W(E):(e.consume(E),ie)}function G(E){return E===47||E===62||pa(E)?W(E):t(E)}function Y(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function ne(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),le}function le(E){return Fn(E)?ur(e,oe,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):oe(E)}function oe(E){return e.enter("htmlTextData"),l(E)}}const cS={name:"labelEnd",resolveAll:HK,resolveTo:GK,tokenize:YK},BK={tokenize:WK},qK={tokenize:QK},VK={tokenize:JK};function HK(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&nl(e,0,e.length,t),e}function GK(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=ys(d,e.slice(o+1,o+r+3)),d=ys(d,[["enter",h,n]]),d=ys(d,lS(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=ys(d,[["exit",h,n],e[l-2],e[l-1],["exit",u,n]]),d=ys(d,e.slice(l+1)),d=ys(d,[["exit",f,n]]),nl(e,o,e.length,d),e}function YK(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(Ih(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(BK,h,l?h:g)(b):b===91?e.attempt(qK,h,l?u:g)(b):l?h(b):g(b)}function u(b){return e.attempt(VK,h,g)(b)}function h(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function WK(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return pa(g)?Hm(e,o)(g):o(g)}function o(g){return g===41?h(g):OE(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return pa(g)?Hm(e,f)(g):h(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?FE(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function u(g){return pa(g)?Hm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function QK(e,n,t){const r=this;return a;function a(d){return LE.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes(Ih(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function JK(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const KK={name:"labelStartImage",resolveAll:cS.resolveAll,tokenize:XK};function XK(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const ZK={name:"labelStartLink",resolveAll:cS.resolveAll,tokenize:eX};function eX(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const q0={name:"lineEnding",tokenize:tX};function tX(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),ur(e,n,"linePrefix")}}const Wx={name:"thematicBreak",tokenize:nX};function nX(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Vt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),Fn(u)?ur(e,d,"whitespace")(u):d(u))}}const da={continuation:{tokenize:sX},exit:lX,name:"list",tokenize:aX},rX={partial:!0,tokenize:cX},iX={partial:!0,tokenize:oX};function aX(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:J1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Wx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return J1(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(Kb,r.interrupt?t:h,e.attempt(rX,b,g))}function h(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return Fn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function sX(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(Kb,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,ur(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!Fn(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(iX,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,ur(e,e.attempt(da,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function oX(e,n,t){const r=this;return ur(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function lX(e){e.exit(this.containerState.type)}function cX(e,n,t){const r=this;return ur(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!Fn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const lj={name:"setextUnderline",resolveTo:uX,tokenize:dX};function uX(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function dX(e,n,t){const r=this;let a;return o;function o(u){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),Fn(u)?ur(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Vt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const fX={tokenize:hX};function hX(e){const n=this,t=e.attempt(Kb,r,e.attempt(this.parser.constructs.flowInitial,a,ur(e,e.attempt(this.parser.constructs.flow,a,e.attempt(xK,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const pX={resolveAll:zE()},mX=$E("string"),gX=$E("text");function $E(e){return{resolveAll:zE(e==="text"?yX:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(h){return u(h)?o(h):d(h)}function d(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),f}function f(h){return u(h)?(t.exit("data"),o(h)):(t.consume(h),f)}function u(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function zE(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function yX(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const xX={42:da,43:da,45:da,48:da,49:da,50:da,51:da,52:da,53:da,54:da,55:da,56:da,57:da,62:DE},bX={91:NK},vX={[-2]:B0,[-1]:B0,32:B0},wX={35:EK,42:Wx,45:[lj,Wx],60:IK,61:lj,95:Wx,96:sj,126:sj},SX={38:RE,92:IE},NX={[-5]:q0,[-4]:q0,[-3]:q0,33:KK,38:RE,42:K1,60:[ZJ,zK],91:ZK,92:[kK,IE],93:cS,95:K1,96:fK},CX={null:[K1,pX]},_X={null:[42,95]},jX={null:[]},kX=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:_X,contentInitial:bX,disable:jX,document:xX,flow:wX,flowInitial:vX,insideSpan:CX,string:SX,text:NX},Symbol.toStringTag,{value:"Module"}));function TX(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:U($),check:U(L),consume:M,enter:R,exit:z,interrupt:U(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(F){return l=ys(l,F),T(),l[l.length-1]!==null?[]:(B(n,0),u.events=lS(o,u.events,u),u.events)}function b(F,V){return AX(v(F),V)}function v(F){return EX(l,F)}function S(){const{_bufferIndex:F,_index:V,line:re,column:ie,offset:G}=r;return{_bufferIndex:F,_index:V,line:re,column:ie,offset:G}}function k(F){a[F.line]=F.column,I()}function T(){let F;for(;r._index<l.length;){const V=l[r._index];if(typeof V=="string")for(F=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===F&&r._bufferIndex<V.length;)P(V.charCodeAt(r._bufferIndex));else P(V)}}function P(F){h=h(F)}function M(F){Vt(F)?(r.line++,r.column=1,r.offset+=F===-3?2:1,I()):F!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=F}function R(F,V){const re=V||{};return re.type=F,re.start=S(),u.events.push(["enter",re,u]),d.push(re),re}function z(F){const V=d.pop();return V.end=S(),u.events.push(["exit",V,u]),V}function $(F,V){B(F,V.from)}function L(F,V){V.restore()}function U(F,V){return re;function re(ie,G,Y){let ne,le,oe,E;return Array.isArray(ie)?he(ie):"tokenize"in ie?he([ie]):de(ie);function de(te){return K;function K(J){const ye=J!==null&&te[J],He=J!==null&&te.null,Q=[...Array.isArray(ye)?ye:ye?[ye]:[],...Array.isArray(He)?He:He?[He]:[]];return he(Q)(J)}}function he(te){return ne=te,le=0,te.length===0?Y:D(te[le])}function D(te){return K;function K(J){return E=W(),oe=te,te.partial||(u.currentConstruct=te),te.name&&u.parser.constructs.disable.null.includes(te.name)?Ne():te.tokenize.call(V?Object.assign(Object.create(u),V):u,f,pe,Ne)(J)}}function pe(te){return F(oe,E),G}function Ne(te){return E.restore(),++le<ne.length?D(ne[le]):Y}}}function B(F,V){F.resolveAll&&!o.includes(F)&&o.push(F),F.resolve&&nl(u.events,V,u.events.length-V,F.resolve(u.events.slice(V),u)),F.resolveTo&&(u.events=F.resolveTo(u.events,u))}function W(){const F=S(),V=u.previous,re=u.currentConstruct,ie=u.events.length,G=Array.from(d);return{from:ie,restore:Y};function Y(){r=F,u.previous=V,u.currentConstruct=re,u.events.length=ie,d=G,I()}}function I(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function EX(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function AX(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function PX(e){const r={constructs:FJ([kX,...(e||{}).extensions||[]]),content:a(GJ),defined:[],document:a(WJ),flow:a(fX),lazy:{},string:a(mX),text:a(gX)};return r;function a(o){return l;function l(d){return TX(r,o,d)}}}function DX(e){for(;!ME(e););return e}const cj=/[\0\t\n\r]/g;function IX(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,h,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(cj.lastIndex=g,u=cj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,f.push(-2);e++<h;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const RX=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function UE(e){return e.replace(RX,MX)}function MX(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return PE(t.slice(o?2:1),o?16:10)}return oS(t)||e}function Gm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?uj(e.position):"start"in e||"end"in e?uj(e):"line"in e||"column"in e?X1(e):""}function X1(e){return dj(e&&e.line)+":"+dj(e&&e.column)}function uj(e){return X1(e&&e.start)+"-"+X1(e&&e.end)}function dj(e){return e&&typeof e=="number"?e:1}const BE={}.hasOwnProperty;function OX(e,n,t){return typeof n!="string"&&(t=n,n=void 0),LX(t)(DX(PX(t).document().write(IX()(e,n,!0))))}function LX(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(xt),autolinkProtocol:W,autolinkEmail:W,atxHeading:o(_e),blockQuote:o(He),characterEscape:W,characterReference:W,codeFenced:o(Q),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Q,l),codeText:o(Pe,l),codeTextData:W,data:W,codeFlowValue:W,definition:o(Re),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Le),hardBreakEscape:o(Ke),hardBreakTrailing:o(Ke),htmlFlow:o(Ye,l),htmlFlowData:W,htmlText:o(Ye,l),htmlTextData:W,image:o(it),label:l,link:o(xt),listItem:o(ue),listItemValue:b,listOrdered:o(Nt,g),listUnordered:o(Nt),paragraph:o(Ae),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(_e),strong:o(ke),thematicBreak:o(ve)},exit:{atxHeading:f(),atxHeadingSequence:$,autolink:f(),autolinkEmail:ye,autolinkProtocol:J,blockQuote:f(),characterEscapeValue:I,characterReferenceMarkerHexadecimal:Ne,characterReferenceMarkerNumeric:Ne,characterReferenceValue:te,characterReference:K,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:I,codeIndented:f(P),codeText:f(G),codeTextData:I,data:I,definition:f(),definitionDestinationString:z,definitionLabelString:M,definitionTitleString:R,emphasis:f(),hardBreakEscape:f(V),hardBreakTrailing:f(V),htmlFlow:f(re),htmlFlowData:I,htmlText:f(ie),htmlTextData:I,image:f(ne),label:oe,labelText:le,lineEnding:F,link:f(Y),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:pe,resourceDestinationString:E,resourceTitleString:de,resource:he,setextHeading:f(B),setextHeadingLineSequence:U,setextHeadingText:L,strong:f(),thematicBreak:f()}};qE(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(X){let fe={type:"root",children:[]};const Ge={stack:[fe],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:h,data:t},Je=[];let ct=-1;for(;++ct<X.length;)if(X[ct][1].type==="listOrdered"||X[ct][1].type==="listUnordered")if(X[ct][0]==="enter")Je.push(ct);else{const wt=Je.pop();ct=a(X,wt,ct)}for(ct=-1;++ct<X.length;){const wt=n[X[ct][0]];BE.call(wt,X[ct][1].type)&&wt[X[ct][1].type].call(Object.assign({sliceSerialize:X[ct][2].sliceSerialize},Ge),X[ct][1])}if(Ge.tokenStack.length>0){const wt=Ge.tokenStack[Ge.tokenStack.length-1];(wt[1]||fj).call(Ge,void 0,wt[0])}for(fe.position={start:ru(X.length>0?X[0][1].start:{line:1,column:1,offset:0}),end:ru(X.length>0?X[X.length-2][1].end:{line:1,column:1,offset:0})},ct=-1;++ct<n.transforms.length;)fe=n.transforms[ct](fe)||fe;return fe}function a(X,fe,Ge){let Je=fe-1,ct=-1,wt=!1,Ht,Ce,be,Fe;for(;++Je<=Ge;){const Ie=X[Je];switch(Ie[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ie[0]==="enter"?ct++:ct--,Fe=void 0;break}case"lineEndingBlank":{Ie[0]==="enter"&&(Ht&&!Fe&&!ct&&!be&&(be=Je),Fe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Fe=void 0}if(!ct&&Ie[0]==="enter"&&Ie[1].type==="listItemPrefix"||ct===-1&&Ie[0]==="exit"&&(Ie[1].type==="listUnordered"||Ie[1].type==="listOrdered")){if(Ht){let Ve=Je;for(Ce=void 0;Ve--;){const st=X[Ve];if(st[1].type==="lineEnding"||st[1].type==="lineEndingBlank"){if(st[0]==="exit")continue;Ce&&(X[Ce][1].type="lineEndingBlank",wt=!0),st[1].type="lineEnding",Ce=Ve}else if(!(st[1].type==="linePrefix"||st[1].type==="blockQuotePrefix"||st[1].type==="blockQuotePrefixWhitespace"||st[1].type==="blockQuoteMarker"||st[1].type==="listItemIndent"))break}be&&(!Ce||be<Ce)&&(Ht._spread=!0),Ht.end=Object.assign({},Ce?X[Ce][1].start:Ie[1].end),X.splice(Ce||Je,0,["exit",Ht,Ie[2]]),Je++,Ge++}if(Ie[1].type==="listItemPrefix"){const Ve={type:"listItem",_spread:!1,start:Object.assign({},Ie[1].start),end:void 0};Ht=Ve,X.splice(Je,0,["enter",Ve,Ie[2]]),Je++,Ge++,be=void 0,Fe=!0}}}return X[fe][1]._spread=wt,Ge}function o(X,fe){return Ge;function Ge(Je){d.call(this,X(Je),Je),fe&&fe.call(this,Je)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(X,fe,Ge){this.stack[this.stack.length-1].children.push(X),this.stack.push(X),this.tokenStack.push([fe,Ge||void 0]),X.position={start:ru(fe.start),end:void 0}}function f(X){return fe;function fe(Ge){X&&X.call(this,Ge),u.call(this,Ge)}}function u(X,fe){const Ge=this.stack.pop(),Je=this.tokenStack.pop();if(Je)Je[0].type!==X.type&&(fe?fe.call(this,X,Je[0]):(Je[1]||fj).call(this,X,Je[0]));else throw new Error("Cannot close `"+X.type+"` ("+Gm({start:X.start,end:X.end})+"): its not open");Ge.position.end=ru(X.end)}function h(){return sS(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(X){if(this.data.expectingFirstListItemValue){const fe=this.stack[this.stack.length-2];fe.start=Number.parseInt(this.sliceSerialize(X),10),this.data.expectingFirstListItemValue=void 0}}function v(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.lang=X}function S(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.meta=X}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X.replace(/(\r?\n|\r)$/g,"")}function M(X){const fe=this.resume(),Ge=this.stack[this.stack.length-1];Ge.label=fe,Ge.identifier=Ih(this.sliceSerialize(X)).toLowerCase()}function R(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.title=X}function z(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.url=X}function $(X){const fe=this.stack[this.stack.length-1];if(!fe.depth){const Ge=this.sliceSerialize(X).length;fe.depth=Ge}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function U(X){const fe=this.stack[this.stack.length-1];fe.depth=this.sliceSerialize(X).codePointAt(0)===61?1:2}function B(){this.data.setextHeadingSlurpLineEnding=void 0}function W(X){const Ge=this.stack[this.stack.length-1].children;let Je=Ge[Ge.length-1];(!Je||Je.type!=="text")&&(Je=Se(),Je.position={start:ru(X.start),end:void 0},Ge.push(Je)),this.stack.push(Je)}function I(X){const fe=this.stack.pop();fe.value+=this.sliceSerialize(X),fe.position.end=ru(X.end)}function F(X){const fe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ge=fe.children[fe.children.length-1];Ge.position.end=ru(X.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(fe.type)&&(W.call(this,X),I.call(this,X))}function V(){this.data.atHardBreak=!0}function re(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X}function ie(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X}function G(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.value=X}function Y(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=fe,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function ne(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=fe,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function le(X){const fe=this.sliceSerialize(X),Ge=this.stack[this.stack.length-2];Ge.label=UE(fe),Ge.identifier=Ih(fe).toLowerCase()}function oe(){const X=this.stack[this.stack.length-1],fe=this.resume(),Ge=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ge.type==="link"){const Je=X.children;Ge.children=Je}else Ge.alt=fe}function E(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.url=X}function de(){const X=this.resume(),fe=this.stack[this.stack.length-1];fe.title=X}function he(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function pe(X){const fe=this.resume(),Ge=this.stack[this.stack.length-1];Ge.label=fe,Ge.identifier=Ih(this.sliceSerialize(X)).toLowerCase(),this.data.referenceType="full"}function Ne(X){this.data.characterReferenceType=X.type}function te(X){const fe=this.sliceSerialize(X),Ge=this.data.characterReferenceType;let Je;Ge?(Je=PE(fe,Ge==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Je=oS(fe);const ct=this.stack[this.stack.length-1];ct.value+=Je}function K(X){const fe=this.stack.pop();fe.position.end=ru(X.end)}function J(X){I.call(this,X);const fe=this.stack[this.stack.length-1];fe.url=this.sliceSerialize(X)}function ye(X){I.call(this,X);const fe=this.stack[this.stack.length-1];fe.url="mailto:"+this.sliceSerialize(X)}function He(){return{type:"blockquote",children:[]}}function Q(){return{type:"code",lang:null,meta:null,value:""}}function Pe(){return{type:"inlineCode",value:""}}function Re(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Le(){return{type:"emphasis",children:[]}}function _e(){return{type:"heading",depth:0,children:[]}}function Ke(){return{type:"break"}}function Ye(){return{type:"html",value:""}}function it(){return{type:"image",title:null,url:"",alt:null}}function xt(){return{type:"link",title:null,url:"",children:[]}}function Nt(X){return{type:"list",ordered:X.type==="listOrdered",start:null,spread:X._spread,children:[]}}function ue(X){return{type:"listItem",spread:X._spread,checked:null,children:[]}}function Ae(){return{type:"paragraph",children:[]}}function ke(){return{type:"strong",children:[]}}function Se(){return{type:"text",value:""}}function ve(){return{type:"thematicBreak"}}}function ru(e){return{line:e.line,column:e.column,offset:e.offset}}function qE(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?qE(e,r):FX(e,r)}}function FX(e,n){let t;for(t in n)if(BE.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function fj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Gm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Gm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Gm({start:n.start,end:n.end})+") is still open")}function $X(e){const n=this;n.parser=t;function t(r){return OX(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const hj={}.hasOwnProperty;function VE(e,n){const t=n||{};function r(a,...o){let l=r.invalid;const d=r.handlers;if(a&&hj.call(a,e)){const f=String(a[e]);l=hj.call(d,f)?d[f]:r.unknown}if(l)return l.call(this,a,...o)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const zX={}.hasOwnProperty;function HE(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)HE(e,n.extensions[t]);for(r in n)if(zX.call(n,r))switch(r){case"extensions":break;case"unsafe":{pj(e[r],n[r]);break}case"join":{pj(e[r],n[r]);break}case"handlers":{UX(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function pj(e,n){n&&e.push(...n)}function UX(e,n){n&&Object.assign(e,n)}function BX(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),qX);return a(),l}function qX(e,n,t){return">"+(t?"":" ")+e}function GE(e,n){return mj(e,n.inConstruct,!0)&&!mj(e,n.notInConstruct,!1)}function mj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function gj(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&GE(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function VX(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function Z1(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function HX(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function GX(e,n,t,r){const a=HX(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(Z1(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,YX);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(VX(o,a)+1,3)),u=t.enter("codeFenced");let h=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=d.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=d.move(" "),h+=d.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...d.current()})),g()}return h+=d.move(`
`),o&&(h+=d.move(o+`
`)),h+=d.move(f),u(),h}function YX(e,n,t){return(t?"":"    ")+e}function uS(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function WX(e,n,t,r){const a=uS(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function QX(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function cu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function xb(e,n,t){const r=yb(e),a=yb(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}YE.peek=JX;function YE(e,n,t,r){const a=QX(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=xb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=cu(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=xb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+cu(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function JX(e,n,t){return t.options.emphasis||"*"}const dS=function(e){if(e==null)return eZ;if(typeof e=="function")return Xb(e);if(typeof e=="object")return Array.isArray(e)?KX(e):XX(e);if(typeof e=="string")return ZX(e);throw new Error("Expected function, string, or object as test")};function KX(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=dS(e[t]);return Xb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function XX(e){const n=e;return Xb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function ZX(e){return Xb(n);function n(t){return t&&t.type===e}}function Xb(e){return n;function n(t,r,a){return!!(tZ(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function eZ(){return!0}function tZ(e){return e!==null&&typeof e=="object"&&"type"in e}const WE=[],nZ=!0,ew=!1,rZ="skip";function iZ(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=dS(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,h){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=WE,S,k,T;if((!n||o(f,u,h[h.length-1]||void 0))&&(v=aZ(t(f,h)),v[0]===ew))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==rZ)for(k=(r?P.children.length:-1)+l,T=h.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===ew)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function aZ(e){return Array.isArray(e)?e:typeof e=="number"?[nZ,e]:e==null?WE:[e]}function QE(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),iZ(e,o,d,a);function d(f,u){const h=u[u.length-1],g=h?h.children.indexOf(f):void 0;return l(f,g,h)}}function JE(e,n){let t=!1;return QE(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,ew}),!!((!e.depth||e.depth<3)&&sS(e)&&(n.options.setext||t))}function sZ(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(JE(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=cu(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}KE.peek=oZ;function KE(e){return e.value||""}function oZ(){return"<"}XE.peek=lZ;function XE(e,n,t,r){const a=uS(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function lZ(){return"!"}ZE.peek=cZ;function ZE(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function cZ(){return"!"}eA.peek=uZ;function eA(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function uZ(){return"`"}function tA(e,n){const t=sS(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}nA.peek=dZ;function nA(e,n,t,r){const a=uS(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(tA(e,t)){const h=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=h,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function dZ(e,n,t){return tA(e,t)?"<":"["}rA.peek=fZ;function rA(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function fZ(){return"["}function fS(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function hZ(e){const n=fS(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function pZ(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function iA(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function mZ(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?pZ(t):fS(t);const d=e.ordered?l==="."?")":".":hZ(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),iA(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function gZ(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function yZ(e,n,t,r){const a=gZ(t);let o=t.bulletCurrent||fS(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),h);return f(),u;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function xZ(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const bZ=dS(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function vZ(e,n,t,r){return(e.children.some(function(l){return bZ(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function wZ(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}aA.peek=SZ;function aA(e,n,t,r){const a=wZ(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=xb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=cu(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=xb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+cu(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function SZ(e,n,t){return t.options.strong||"*"}function NZ(e,n,t,r){return t.safe(e.value,r)}function CZ(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function _Z(e,n,t){const r=(iA(t)+(t.options.ruleSpaces?" ":"")).repeat(CZ(t));return t.options.ruleSpaces?r.slice(0,-1):r}const jZ={blockquote:BX,break:gj,code:GX,definition:WX,emphasis:YE,hardBreak:gj,heading:sZ,html:KE,image:XE,imageReference:ZE,inlineCode:eA,link:nA,linkReference:rA,list:mZ,listItem:yZ,paragraph:xZ,root:vZ,strong:aA,text:NZ,thematicBreak:_Z},kZ=[TZ];function TZ(e,n,t,r){if(n.type==="code"&&Z1(n,r)&&(e.type==="list"||e.type===n.type&&Z1(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&JE(n,r))?void 0:t.spread?1:0}const Id=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],EZ=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Id},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Id},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Id},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Id},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Id},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Id},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Id},{atBreak:!0,character:"~"}];function AZ(e){return e.label||!e.identifier?e.label||"":UE(e.identifier)}function PZ(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function DZ(e,n,t){const r=n.indexStack,a=e.children||[],o=[];let l=-1,d=t.before,f;r.push(-1);let u=n.createTracker(t);for(;++l<a.length;){const h=a[l];let g;if(r[r.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else g=t.after;o.length>0&&(d==="\r"||d===`
`)&&h.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),d=" ",u=n.createTracker(t),u.move(o.join("")));let b=n.handle(h,e,n,{...u.current(),after:g,before:d});f&&f===b.slice(0,1)&&(b=cu(f.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,f=void 0,v&&(o.length>0&&v.before&&d===o[o.length-1].slice(-1)&&(o[o.length-1]=o[o.length-1].slice(0,-1)+cu(d.charCodeAt(0))),v.after&&(f=g)),u.move(b),o.push(b),d=b.slice(-1)}return r.pop(),o.join("")}function IZ(e,n,t){const r=n.indexStack,a=e.children||[],o=n.createTracker(t),l=[];let d=-1;for(r.push(-1);++d<a.length;){const f=a[d];r[r.length-1]=d,l.push(o.move(n.handle(f,e,n,{before:`
`,after:`
`,...o.current()}))),f.type!=="list"&&(n.bulletLastUsed=void 0),d<a.length-1&&l.push(o.move(RZ(f,a[d+1],e,n)))}return r.pop(),l.join("")}function RZ(e,n,t,r){let a=r.join.length;for(;a--;){const o=r.join[a](e,n,t,r);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}const MZ=/\r?\n|\r/g;function OZ(e,n){const t=[];let r=0,a=0,o;for(;o=MZ.exec(e);)l(e.slice(r,o.index)),t.push(o[0]),r=o.index+o[0].length,a++;return l(e.slice(r)),t.join("");function l(d){t.push(n(d,a,!d))}}function LZ(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],o=[],l={};let d=-1;for(;++d<e.unsafe.length;){const h=e.unsafe[d];if(!GE(e.stack,h))continue;const g=e.compilePattern(h);let b;for(;b=g.exec(r);){const v="before"in h||!!h.atBreak,S="after"in h,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(FZ);let f=t.before?t.before.length:0;const u=r.length-(t.after?t.after.length:0);for(d=-1;++d<a.length;){const h=a[d];h<f||h>=u||h+1<u&&a[d+1]===h+1&&l[h].after&&!l[h+1].before&&!l[h+1].after||a[d-1]===h-1&&l[h].before&&!l[h-1].before&&!l[h-1].after||(f!==h&&o.push(yj(r.slice(f,h),"\\")),f=h,/[!-/:-@[-`{-~]/.test(r.charAt(h))&&(!t.encode||!t.encode.includes(r.charAt(h)))?o.push("\\"):(o.push(cu(r.charCodeAt(h))),f++))}return o.push(yj(r.slice(f,u),t.after)),o.join("")}function FZ(e,n){return e-n}function yj(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],o=e+n;let l=-1,d=0,f;for(;f=t.exec(o);)r.push(f.index);for(;++l<r.length;)d!==r[l]&&a.push(e.slice(d,r[l])),a.push("\\"),d=r[l];return a.push(e.slice(d)),a.join("")}function $Z(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,o=t.column||1;return{move:f,current:l,shift:d};function l(){return{now:{line:a,column:o},lineShift:r}}function d(u){r+=u}function f(u){const h=u||"",g=h.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,o=g.length===1?o+b.length:1+b.length+r,h}}function zZ(e,n){const t=n||{},r={associationId:AZ,containerPhrasing:VZ,containerFlow:HZ,createTracker:$Z,compilePattern:PZ,enter:o,handlers:{...jZ},handle:void 0,indentLines:OZ,indexStack:[],join:[...kZ],options:{},safe:GZ,stack:[],unsafe:[...EZ]};HE(r,t),r.options.tightDefinitions&&r.join.push(qZ),r.handle=VE("type",{invalid:UZ,unknown:BZ,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function o(l){return r.stack.push(l),d;function d(){r.stack.pop()}}}function UZ(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function BZ(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function qZ(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function VZ(e,n){return DZ(e,this,n)}function HZ(e,n){return IZ(e,this,n)}function GZ(e,n){return LZ(this,e,n)}function YZ(e){const n=this;n.compiler=t;function t(r){return zZ(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function xj(e){if(e)throw e}var V0,bj;function WZ(){if(bj)return V0;bj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var h=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!h&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,h){t&&h.name==="__proto__"?t(u,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):u[h.name]=h.newValue},d=function(u,h){if(h==="__proto__")if(e.call(u,h)){if(r)return r(u,h).value}else return;return u[h]};return V0=function f(){var u,h,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(h in u)g=d(k,h),b=d(u,h),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:h,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},V0}var QZ=WZ();const H0=Hd(QZ);function tw(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function JZ(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const h=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,h?KZ(h,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function KZ(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const h=u;if(d&&t)throw h;return a(h)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}class ya extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=d?d.line:void 0,this.name=Gm(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}ya.prototype.file="";ya.prototype.name="";ya.prototype.reason="";ya.prototype.message="";ya.prototype.stack="";ya.prototype.column=void 0;ya.prototype.line=void 0;ya.prototype.ancestors=void 0;ya.prototype.cause=void 0;ya.prototype.fatal=void 0;ya.prototype.place=void 0;ya.prototype.ruleId=void 0;ya.prototype.source=void 0;const Wo={basename:XZ,dirname:ZZ,extname:eee,join:tee,sep:"/"};function XZ(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');gg(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function ZZ(e){if(gg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function eee(e){gg(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function tee(...e){let n=-1,t;for(;++n<e.length;)gg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":nee(t)}function nee(e){gg(e);const n=e.codePointAt(0)===47;let t=ree(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function ree(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function gg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const iee={cwd:aee};function aee(){return"/"}function nw(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function see(e){if(typeof e=="string")e=new URL(e);else if(!nw(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return oee(e)}function oee(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const G0=["history","path","basename","stem","extname","dirname"];class lee{constructor(n){let t;n?nw(n)?t={path:n}:typeof n=="string"||cee(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":iee.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<G0.length;){const o=G0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)G0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Wo.basename(this.path):void 0}set basename(n){W0(n,"basename"),Y0(n,"basename"),this.path=Wo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Wo.dirname(this.path):void 0}set dirname(n){vj(this.basename,"dirname"),this.path=Wo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Wo.extname(this.path):void 0}set extname(n){if(Y0(n,"extname"),vj(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Wo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){nw(n)&&(n=see(n)),W0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Wo.basename(this.path,this.extname):void 0}set stem(n){W0(n,"stem"),Y0(n,"stem"),this.path=Wo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new ya(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function Y0(e,n){if(e&&e.includes(Wo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Wo.sep+"`")}function W0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function vj(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function cee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const uee=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},dee={}.hasOwnProperty;class hS extends uee{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=JZ()}copy(){const n=new hS;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(H0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(K0("data",this.frozen),this.namespace[n]=t,this):dee.call(this.namespace,n)&&this.namespace[n]||void 0:n?(K0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Ax(n),r=this.parser||this.Parser;return Q0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),Q0("process",this.parser||this.Parser),J0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=Ax(n),f=r.parse(d);r.run(f,d,function(h,g,b){if(h||!g||!b)return u(h);const v=g,S=r.stringify(v,b);pee(S)?b.value=S:b.result=S,u(h,b)});function u(h,g){h||!g?l(h):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),Q0("processSync",this.parser||this.Parser),J0("processSync",this.compiler||this.Compiler),this.process(n,a),Sj("processSync","process",t),r;function a(o,l){t=!0,xj(o),r=l}}run(n,t,r){wj(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=Ax(t);a.run(n,f,u);function u(h,g,b){const v=g||n;h?d(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),Sj("runSync","run",r),a;function o(l,d){xj(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=Ax(t),a=this.compiler||this.Compiler;return J0("stringify",a),wj(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(K0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...g]=u;f(h,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=H0(!0,a.settings,u.settings))}function d(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const g=u[h];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];tw(k)&&tw(v)&&(v=H0(!0,k,v)),r[b]=[u,v,...S]}}}}const fee=new hS().freeze();function Q0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function J0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function K0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function wj(e){if(!tw(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Sj(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Ax(e){return hee(e)?e:new lee(e)}function hee(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function pee(e){return typeof e=="string"||mee(e)}function mee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const gee=fee().use($X).use(YZ).freeze(),sA=-1,Zb=0,Ym=1,bb=2,pS=3,mS=4,gS=5,yS=6,oA=7,lA=8,Nj=typeof self=="object"?self:globalThis,yee=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Zb:case sA:return t(l,a);case Ym:{const d=t([],a);for(const f of l)d.push(r(f));return d}case bb:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case pS:return t(new Date(l),a);case mS:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case gS:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case yS:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case oA:{const{name:d,message:f}=l;return t(new Nj[d](f),a)}case lA:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new Nj[o](l),a)};return r},Cj=e=>yee(new Map,e)(0),Ch="",{toString:xee}={},{keys:bee}=Object,Fm=e=>{const n=typeof e;if(n!=="object"||!e)return[Zb,n];const t=xee.call(e).slice(8,-1);switch(t){case"Array":return[Ym,Ch];case"Object":return[bb,Ch];case"Date":return[pS,Ch];case"RegExp":return[mS,Ch];case"Map":return[gS,Ch];case"Set":return[yS,Ch];case"DataView":return[Ym,t]}return t.includes("Array")?[Ym,t]:t.includes("Error")?[oA,t]:[bb,t]},Px=([e,n])=>e===Zb&&(n==="function"||n==="symbol"),vee=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Fm(l);switch(d){case Zb:{let h=l;switch(f){case"bigint":d=lA,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);h=null;break;case"undefined":return a([sA],l)}return a([d,h],l)}case Ym:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const h=[],g=a([d,h],l);for(const b of l)h.push(o(b));return g}case bb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const h=[],g=a([d,h],l);for(const b of bee(l))(e||!Px(Fm(l[b])))&&h.push([o(b),o(l[b])]);return g}case pS:return a([d,l.toISOString()],l);case mS:{const{source:h,flags:g}=l;return a([d,{source:h,flags:g}],l)}case gS:{const h=[],g=a([d,h],l);for(const[b,v]of l)(e||!(Px(Fm(b))||Px(Fm(v))))&&h.push([o(b),o(v)]);return g}case yS:{const h=[],g=a([d,h],l);for(const b of l)(e||!Px(Fm(b)))&&h.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},_j=(e,{json:n,lossy:t}={})=>{const r=[];return vee(!(n||t),!!n,new Map,r)(e),r},ig=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?Cj(_j(e,n)):structuredClone(e):(e,n)=>Cj(_j(e,n)),cA=dA("end"),uA=dA("start");function dA(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function fA(e){const n=uA(e),t=cA(e);if(n&&t)return{start:n,end:t}}const Rd=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],jj={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Rd,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Rd],h2:[["className","sr-only"]],img:[...Rd,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Rd,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Rd],table:[...Rd],ul:[...Rd,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},iu={}.hasOwnProperty;function wee(e,n){let t={type:"root",children:[]};const r={schema:n?{...jj,...n}:jj,stack:[]},a=hA(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function hA(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return See(e,t);case"doctype":return Nee(e,t);case"element":return Cee(e,t);case"root":return _ee(e,t);case"text":return jee(e,t)}}}function See(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),o={type:"comment",value:r<0?t:t.slice(0,r)};return yg(o,n),o}}function Nee(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return yg(t,n),t}}function Cee(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=pA(e,n.children),a=kee(e,n.properties);e.stack.pop();let o=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(o=!0,e.schema.ancestors&&iu.call(e.schema.ancestors,t))){const d=e.schema.ancestors[t];let f=-1;for(o=!1;++f<d.length;)e.stack.includes(d[f])&&(o=!0)}if(!o)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const l={type:"element",tagName:t,properties:a,children:r};return yg(l,n),l}function _ee(e,n){const r={type:"root",children:pA(e,n.children)};return yg(r,n),r}function jee(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return yg(r,n),r}function pA(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const o=hA(e,r[a]);o&&(Array.isArray(o)?t.push(...o):t.push(o))}}return t}function kee(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,o=r&&iu.call(r,t)?r[t]:void 0,l=r&&iu.call(r,"*")?r["*"]:void 0,d=n&&typeof n=="object"?n:{},f={};let u;for(u in d)if(iu.call(d,u)){const h=d[u];let g=kj(e,Tj(o,u),u,h);g==null&&(g=kj(e,Tj(l,u),u,h)),g!=null&&(f[u]=g)}if(a&&iu.call(a,t)){const h=a[t];for(u in h)iu.call(h,u)&&!iu.call(f,u)&&(f[u]=h[u])}return f}function kj(e,n,t,r){return n?Array.isArray(r)?Tee(e,n,t,r):mA(e,n,t,r):void 0}function Tee(e,n,t,r){let a=-1;const o=[];for(;++a<r.length;){const l=mA(e,n,t,r[a]);(typeof l=="number"||typeof l=="string")&&o.push(l)}return o}function mA(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&Eee(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,o=0;for(;++o<n.length;){const l=n[o];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(r))){a=!0;break}}else if(l===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function Eee(e,n,t){const r=e.schema.protocols&&iu.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),o=a.indexOf(":"),l=a.indexOf("?"),d=a.indexOf("#"),f=a.indexOf("/");if(o<0||f>-1&&o>f||l>-1&&o>l||d>-1&&o>d)return!0;let u=-1;for(;++u<r.length;){const h=r[u];if(o===h.length&&a.slice(0,h.length)===h)return!0}return!1}function yg(e,n){const t=fA(n);n.data&&(e.data=ig(n.data)),t&&(e.position=t)}function Tj(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],o=typeof a=="string"?a:a[0];if(o===n)return a;o==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function Aee(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function Pee(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function Dee(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function Iee(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Ree(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Mee(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Xh(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function Oee(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Lee(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function gA(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function Fee(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return gA(e,n);const a={src:Xh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function $ee(e,n){const t={src:Xh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function zee(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function Uee(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return gA(e,n);const a={href:Xh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function Bee(e,n){const t={href:Xh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function qee(e,n,t){const r=e.all(n),a=t?Vee(t):yA(n),o={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const h=r[d];(a||d!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function Vee(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=yA(t[r])}return n}function yA(e){const n=e.spread;return n??e.children.length>1}function Hee(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function Gee(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Yee(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function Wee(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Qee(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=uA(n.children[1]),f=cA(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function Jee(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,h),e.applyData(n,h)}function Kee(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Ej=9,Aj=32;function Xee(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(Pj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(Pj(n.slice(a),a>0,!1)),o.join("")}function Pj(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===Ej||o===Aj;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===Ej||o===Aj;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function Zee(e,n){const t={type:"text",value:Xee(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function ete(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const tte={blockquote:Aee,break:Pee,code:Dee,delete:Iee,emphasis:Ree,footnoteReference:Mee,heading:Oee,html:Lee,imageReference:Fee,image:$ee,inlineCode:zee,linkReference:Uee,link:Bee,listItem:qee,list:Hee,paragraph:Gee,root:Yee,strong:Wee,table:Qee,tableCell:Kee,tableRow:Jee,text:Zee,thematicBreak:ete,toml:Dx,yaml:Dx,definition:Dx,footnoteDefinition:Dx};function Dx(){}function nte(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function rte(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function ite(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||nte,r=e.options.footnoteBackLabel||rte,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const h=e.all(u),g=String(u.identifier).toUpperCase(),b=Xh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else h.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...ig(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const rw={}.hasOwnProperty,ate={};function ste(e,n){const t=n||ate,r=new Map,a=new Map,o=new Map,l={...tte,...t.handlers},d={all:u,applyData:lte,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:ote,wrap:ute};return QE(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),d;function f(h,g){const b=h.type,v=d.handlers[b];if(rw.call(d.handlers,b)&&v)return v(d,h,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,P=ig(T);return P.children=d.all(h),P}return ig(h)}return(d.options.unknownHandler||cte)(d,h,g)}function u(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Dj(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=Dj(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function ote(e,n){e.position&&(n.position=fA(e))}function lte(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,ig(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function cte(e,n){const t=n.data||{},r="value"in n&&!(rw.call(t,"hProperties")||rw.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function ute(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Dj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function dte(e,n){const t=ste(e,n),r=t.one(e,void 0),a=ite(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}const fte=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class xg{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}xg.prototype.normal={};xg.prototype.property={};xg.prototype.space=void 0;function xA(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new xg(t,r,n)}function iw(e){return e.toLowerCase()}class xa{constructor(n,t){this.attribute=t,this.property=n}}xa.prototype.attribute="";xa.prototype.booleanish=!1;xa.prototype.boolean=!1;xa.prototype.commaOrSpaceSeparated=!1;xa.prototype.commaSeparated=!1;xa.prototype.defined=!1;xa.prototype.mustUseProperty=!1;xa.prototype.number=!1;xa.prototype.overloadedBoolean=!1;xa.prototype.property="";xa.prototype.spaceSeparated=!1;xa.prototype.space=void 0;let hte=0;const en=Wd(),Ur=Wd(),aw=Wd(),lt=Wd(),cr=Wd(),Rh=Wd(),$a=Wd();function Wd(){return 2**++hte}const sw=Object.freeze(Object.defineProperty({__proto__:null,boolean:en,booleanish:Ur,commaOrSpaceSeparated:$a,commaSeparated:Rh,number:lt,overloadedBoolean:aw,spaceSeparated:cr},Symbol.toStringTag,{value:"Module"})),X0=Object.keys(sw);class xS extends xa{constructor(n,t,r,a){let o=-1;if(super(n,t),Ij(this,"space",a),typeof r=="number")for(;++o<X0.length;){const l=X0[o];Ij(this,X0[o],(r&sw[l])===sw[l])}}}xS.prototype.defined=!0;function Ij(e,n,t){t&&(e[n]=t)}function Zh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new xS(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[iw(r)]=r,t[iw(o.attribute)]=r}return new xg(n,t,e.space)}const bA=Zh({properties:{ariaActiveDescendant:null,ariaAtomic:Ur,ariaAutoComplete:null,ariaBusy:Ur,ariaChecked:Ur,ariaColCount:lt,ariaColIndex:lt,ariaColSpan:lt,ariaControls:cr,ariaCurrent:null,ariaDescribedBy:cr,ariaDetails:null,ariaDisabled:Ur,ariaDropEffect:cr,ariaErrorMessage:null,ariaExpanded:Ur,ariaFlowTo:cr,ariaGrabbed:Ur,ariaHasPopup:null,ariaHidden:Ur,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:cr,ariaLevel:lt,ariaLive:null,ariaModal:Ur,ariaMultiLine:Ur,ariaMultiSelectable:Ur,ariaOrientation:null,ariaOwns:cr,ariaPlaceholder:null,ariaPosInSet:lt,ariaPressed:Ur,ariaReadOnly:Ur,ariaRelevant:null,ariaRequired:Ur,ariaRoleDescription:cr,ariaRowCount:lt,ariaRowIndex:lt,ariaRowSpan:lt,ariaSelected:Ur,ariaSetSize:lt,ariaSort:null,ariaValueMax:lt,ariaValueMin:lt,ariaValueNow:lt,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function vA(e,n){return n in e?e[n]:n}function wA(e,n){return vA(e,n.toLowerCase())}const pte=Zh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Rh,acceptCharset:cr,accessKey:cr,action:null,allow:null,allowFullScreen:en,allowPaymentRequest:en,allowUserMedia:en,alt:null,as:null,async:en,autoCapitalize:null,autoComplete:cr,autoFocus:en,autoPlay:en,blocking:cr,capture:null,charSet:null,checked:en,cite:null,className:cr,cols:lt,colSpan:null,content:null,contentEditable:Ur,controls:en,controlsList:cr,coords:lt|Rh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:en,defer:en,dir:null,dirName:null,disabled:en,download:aw,draggable:Ur,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:en,formTarget:null,headers:cr,height:lt,hidden:aw,high:lt,href:null,hrefLang:null,htmlFor:cr,httpEquiv:cr,id:null,imageSizes:null,imageSrcSet:null,inert:en,inputMode:null,integrity:null,is:null,isMap:en,itemId:null,itemProp:cr,itemRef:cr,itemScope:en,itemType:cr,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:en,low:lt,manifest:null,max:null,maxLength:lt,media:null,method:null,min:null,minLength:lt,multiple:en,muted:en,name:null,nonce:null,noModule:en,noValidate:en,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:en,optimum:lt,pattern:null,ping:cr,placeholder:null,playsInline:en,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:en,referrerPolicy:null,rel:cr,required:en,reversed:en,rows:lt,rowSpan:lt,sandbox:cr,scope:null,scoped:en,seamless:en,selected:en,shadowRootClonable:en,shadowRootDelegatesFocus:en,shadowRootMode:null,shape:null,size:lt,sizes:null,slot:null,span:lt,spellCheck:Ur,src:null,srcDoc:null,srcLang:null,srcSet:null,start:lt,step:null,style:null,tabIndex:lt,target:null,title:null,translate:null,type:null,typeMustMatch:en,useMap:null,value:Ur,width:lt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:cr,axis:null,background:null,bgColor:null,border:lt,borderColor:null,bottomMargin:lt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:en,declare:en,event:null,face:null,frame:null,frameBorder:null,hSpace:lt,leftMargin:lt,link:null,longDesc:null,lowSrc:null,marginHeight:lt,marginWidth:lt,noResize:en,noHref:en,noShade:en,noWrap:en,object:null,profile:null,prompt:null,rev:null,rightMargin:lt,rules:null,scheme:null,scrolling:Ur,standby:null,summary:null,text:null,topMargin:lt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:lt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:en,disableRemotePlayback:en,prefix:null,property:null,results:lt,security:null,unselectable:null},space:"html",transform:wA}),mte=Zh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:$a,accentHeight:lt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:lt,amplitude:lt,arabicForm:null,ascent:lt,attributeName:null,attributeType:null,azimuth:lt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:lt,by:null,calcMode:null,capHeight:lt,className:cr,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:lt,diffuseConstant:lt,direction:null,display:null,dur:null,divisor:lt,dominantBaseline:null,download:en,dx:null,dy:null,edgeMode:null,editable:null,elevation:lt,enableBackground:null,end:null,event:null,exponent:lt,externalResourcesRequired:null,fill:null,fillOpacity:lt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Rh,g2:Rh,glyphName:Rh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:lt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:lt,horizOriginX:lt,horizOriginY:lt,id:null,ideographic:lt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:lt,k:lt,k1:lt,k2:lt,k3:lt,k4:lt,kernelMatrix:$a,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:lt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:lt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:lt,overlineThickness:lt,paintOrder:null,panose1:null,path:null,pathLength:lt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:cr,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:lt,pointsAtY:lt,pointsAtZ:lt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:$a,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:$a,rev:$a,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:$a,requiredFeatures:$a,requiredFonts:$a,requiredFormats:$a,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:lt,specularExponent:lt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:lt,strikethroughThickness:lt,string:null,stroke:null,strokeDashArray:$a,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:lt,strokeOpacity:lt,strokeWidth:null,style:null,surfaceScale:lt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:$a,tabIndex:lt,tableValues:null,target:null,targetX:lt,targetY:lt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:$a,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:lt,underlineThickness:lt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:lt,values:null,vAlphabetic:lt,vMathematical:lt,vectorEffect:null,vHanging:lt,vIdeographic:lt,version:null,vertAdvY:lt,vertOriginX:lt,vertOriginY:lt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:lt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:vA}),SA=Zh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),NA=Zh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:wA}),CA=Zh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),gte=/[A-Z]/g,Rj=/-[a-z]/g,yte=/^data[-\w.:]+$/i;function xte(e,n){const t=iw(n);let r=n,a=xa;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&yte.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(Rj,vte);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!Rj.test(o)){let l=o.replace(gte,bte);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=xS}return new a(r,n)}function bte(e){return"-"+e.toLowerCase()}function vte(e){return e.charAt(1).toUpperCase()}const wte=xA([bA,pte,SA,NA,CA],"html"),_A=xA([bA,mte,SA,NA,CA],"svg"),Ste=/["&'<>`]/g,Nte=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Cte=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,_te=/[|\\{}()[\]^$+*?.]/g,Mj=new WeakMap;function jte(e,n){if(e=e.replace(n.subset?kte(n.subset):Ste,r),n.subset||n.escapeOnly)return e;return e.replace(Nte,t).replace(Cte,r);function t(a,o,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(o+2),n)}function r(a,o,l){return n.format(a.charCodeAt(0),l.charCodeAt(o+1),n)}}function kte(e){let n=Mj.get(e);return n||(n=Tte(e),Mj.set(e,n)),n}function Tte(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(_te,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const Ete=/[\dA-Fa-f]/;function Ate(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!Ete.test(String.fromCharCode(n))?r:r+";"}const Pte=/\d/;function Dte(e,n,t){const r="&#"+String(e);return t&&n&&!Pte.test(String.fromCharCode(n))?r:r+";"}const Ite=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],Z0={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},Rte=["cent","copy","divide","gt","lt","not","para","times"],jA={}.hasOwnProperty,ow={};let Ix;for(Ix in Z0)jA.call(Z0,Ix)&&(ow[Z0[Ix]]=Ix);const Mte=/[^\dA-Za-z]/;function Ote(e,n,t,r){const a=String.fromCharCode(e);if(jA.call(ow,a)){const o=ow[a],l="&"+o;return t&&Ite.includes(o)&&!Rte.includes(o)&&(!r||n&&n!==61&&Mte.test(String.fromCharCode(n)))?l:l+";"}return""}function Lte(e,n,t){let r=Ate(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=Ote(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const o=Dte(e,n,t.omitOptionalSemicolons);o.length<r.length&&(r=o)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function Mh(e,n){return jte(e,Object.assign({format:Lte},n))}const Fte=/^>|^->|<!--|-->|--!>|<!-$/g,$te=[">"],zte=["<",">"];function Ute(e,n,t,r){return r.settings.bogusComments?"<?"+Mh(e.value,Object.assign({},r.settings.characterReferences,{subset:$te}))+">":"<!--"+e.value.replace(Fte,a)+"-->";function a(o){return Mh(o,Object.assign({},r.settings.characterReferences,{subset:zte}))}}function Bte(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function Oj(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function qte(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function Vte(e){return e.join(" ").trim()}const Hte=/[ \t\n\f\r]/g;function bS(e){return typeof e=="object"?e.type==="text"?Lj(e.value):!1:Lj(e)}function Lj(e){return e.replace(Hte,"")===""}const Qr=TA(1),kA=TA(-1),Gte=[];function TA(e){return n;function n(t,r,a){const o=t?t.children:Gte;let l=(r||0)+e,d=o[l];if(!a)for(;d&&bS(d);)l+=e,d=o[l];return d}}const Yte={}.hasOwnProperty;function EA(e){return n;function n(t,r,a){return Yte.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const vS=EA({body:Qte,caption:e1,colgroup:e1,dd:Zte,dt:Xte,head:e1,html:Wte,li:Kte,optgroup:ene,option:tne,p:Jte,rp:Fj,rt:Fj,tbody:rne,td:$j,tfoot:ine,th:$j,thead:nne,tr:ane});function e1(e,n,t){const r=Qr(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&bS(r.value.charAt(0)))}function Wte(e,n,t){const r=Qr(t,n);return!r||r.type!=="comment"}function Qte(e,n,t){const r=Qr(t,n);return!r||r.type!=="comment"}function Jte(e,n,t){const r=Qr(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function Kte(e,n,t){const r=Qr(t,n);return!r||r.type==="element"&&r.tagName==="li"}function Xte(e,n,t){const r=Qr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function Zte(e,n,t){const r=Qr(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function Fj(e,n,t){const r=Qr(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function ene(e,n,t){const r=Qr(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function tne(e,n,t){const r=Qr(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function nne(e,n,t){const r=Qr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function rne(e,n,t){const r=Qr(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function ine(e,n,t){return!Qr(t,n)}function ane(e,n,t){const r=Qr(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function $j(e,n,t){const r=Qr(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const sne=EA({body:cne,colgroup:une,head:lne,html:one,tbody:dne});function one(e){const n=Qr(e,-1);return!n||n.type!=="comment"}function lne(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function cne(e){const n=Qr(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&bS(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function une(e,n,t){const r=kA(t,n),a=Qr(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&vS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function dne(e,n,t){const r=kA(t,n),a=Qr(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&vS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Rx={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function fne(e,n,t,r){const a=r.schema,o=a.space==="svg"?!1:r.settings.omitOptionalTags;let l=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const d=[];let f;a.space==="html"&&e.tagName==="svg"&&(r.schema=_A);const u=hne(r,e.properties),h=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,h&&(l=!1),(u||!o||!sne(e,n,t))&&(d.push("<",e.tagName,u?" "+u:""),l&&(a.space==="svg"||r.settings.closeSelfClosing)&&(f=u.charAt(u.length-1),(!r.settings.tightSelfClosing||f==="/"||f&&f!=='"'&&f!=="'")&&d.push(" "),d.push("/")),d.push(">")),d.push(h),!l&&(!o||!vS(e,n,t))&&d.push("</"+e.tagName+">"),d.join("")}function hne(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const o=pne(e,a,n[a]);o&&t.push(o)}}for(;++r<t.length;){const o=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&o!=='"'&&o!=="'"&&(t[r]+=" ")}return t.join("")}function pne(e,n,t){const r=xte(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,o=e.settings.allowDangerousCharacters?0:1;let l=e.quote,d;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const f=Mh(r.attribute,Object.assign({},e.settings.characterReferences,{subset:Rx.name[a][o]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?qte:Vte)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?f:(e.settings.preferUnquoted&&(d=Mh(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Rx.unquoted[a][o]}))),d!==t&&(e.settings.quoteSmart&&Oj(t,l)>Oj(t,e.alternative)&&(l=e.alternative),d=l+Mh(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?Rx.single:Rx.double)[a][o],attribute:!0}))+l),f+(d&&"="+d))}const mne=["<","&"];function AA(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Mh(e.value,Object.assign({},r.settings.characterReferences,{subset:mne}))}function gne(e,n,t,r){return r.settings.allowDangerousHtml?e.value:AA(e,n,t,r)}function yne(e,n,t,r){return r.all(e)}const xne=VE("type",{invalid:bne,unknown:vne,handlers:{comment:Ute,doctype:Bte,element:fne,raw:gne,root:yne,text:AA}});function bne(e){throw new Error("Expected node, not `"+e+"`")}function vne(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const wne={},Sne={},Nne=[];function Cne(e,n){const t=n||wne,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:_ne,all:jne,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||fte,characterReferences:t.characterReferences||Sne,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?_A:wte,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function _ne(e,n,t){return xne(e,n,t,this)}function jne(e){const n=[],t=e&&e.children||Nne;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const kne={};function Tne(e){const n=this,{handlers:t,sanitize:r,...a}=e||kne;let o=!1,l;typeof r=="boolean"?o=!r:r&&(l=r),n.compiler=d;function d(f,u){const h=dte(f,{handlers:t,allowDangerousHtml:o}),g=o?h:wee(h,l),b=Cne(g,{...a,allowDangerousHtml:o});return u.extname&&(u.extname=".html"),f&&f.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const Ene=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){h([]);return}const R=d.toLowerCase();h(r.filter(z=>z.name.toLowerCase().includes(R)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one drug.");return}for(const R of o)if(R.selected_pack_quantity===0&&R.selected_loose_quantity===0){b(`Please specify a quantity for ${R.name}.`);return}S(!0),b(null);try{const R={patient_id:t,items:o.map($=>({drug_id:$.id,name:$.name,pack_quantity:$.selected_pack_quantity,loose_quantity:$.selected_loose_quantity,pack_price:0,loose_price:0,total_price:0,tabletsPerDay:1,numberOfDays:1,directions_to_use:"As directed"})),order_total:0,prescription_for_unavailable_drugs:""},z=await me("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!z.ok){const $=await z.json().catch(()=>({}));throw new Error($.message||`Failed to create pharmacy order: ${z.statusText} `)}await z.json(),a(t),n(),l([]),f("")}catch(R){b(`Order Creation Error: ${R.message} `)}finally{S(!1)}},T=R=>{if(o.some(z=>z.id===R.id)){b(`${R.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),h([]);return}l(z=>[...z,{...R,selected_pack_quantity:0,selected_loose_quantity:0}]),f(""),h([])},P=R=>{l(z=>z.filter($=>$.id!==R))},M=(R,z,$)=>{const L=parseInt($)||0;l(U=>U.map(B=>B.id===R?{...B,[z==="pack"?"selected_pack_quantity":"selected_loose_quantity"]:L}:B))};return e?i.jsx("div",{className:Et.modalOverlay,children:i.jsxs("div",{className:Et.modalContent,children:[i.jsxs("div",{className:Et.modalHeader,children:[i.jsx("h3",{className:Et.modalTitle,children:"Create Pharmacy Order"}),i.jsx("button",{onClick:n,className:Et.modalCloseButton,children:i.jsx(bn,{size:20})})]}),i.jsxs("div",{className:Et.modalBody,children:[g&&i.jsx("div",{className:Et.errorText,children:g}),i.jsxs("div",{className:Et.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Drug"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:d,onChange:R=>f(R.target.value),className:Et.inputField,autoComplete:"off"}),d&&u.length>0&&i.jsx("div",{className:Et.searchResultsCard,children:i.jsx("ul",{className:Et.searchResultsList,children:u.map(R=>i.jsx("li",{onClick:()=>T(R),className:Et.searchResultItem,children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[i.jsx("span",{children:R.name}),i.jsxs("span",{className:Et.searchResultPrice,children:["Stock: ",R.stock," (Box) / ",R.loose||0," (Loose)"]})]})},R.id))})})]}),i.jsxs("div",{className:Et.selectedTestsCard,children:[" ",i.jsx("h4",{className:Et.selectedTestsHeader,children:"Selected Drugs"}),o.length===0?i.jsx("p",{className:Et.noTestsMessage,children:"No drugs added yet."}):i.jsx("ul",{className:Et.selectedTestsList,children:o.map(R=>i.jsxs("li",{className:Et.selectedTestItem,style:{flexDirection:"column",alignItems:"flex-start",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},children:[i.jsx("span",{className:Et.selectedTestName,style:{fontWeight:"bold"},children:R.name}),i.jsx("button",{type:"button",onClick:()=>P(String(R.id)),className:Et.removeTestButton,title:"Remove Drug",children:i.jsx(Wr,{size:16})})]}),i.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",width:"100%"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Packs"}),i.jsx("input",{type:"number",min:"0",className:Et.inputField,style:{padding:"4px 8px"},value:R.selected_pack_quantity||"",onChange:z=>M(R.id,"pack",z.target.value),placeholder:"0"})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Loose"}),i.jsx("input",{type:"number",min:"0",className:Et.inputField,style:{padding:"4px 8px"},value:R.selected_loose_quantity||"",onChange:z=>M(R.id,"loose",z.target.value),placeholder:"0"})]})]})]},R.id))})]})]}),i.jsxs("div",{className:Et.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Et.button} ${Et.buttonSecondary} `,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${Et.button} ${Et.buttonPrimary} ${o.length===0||v?Et.buttonDisabled:""} `,children:[" ",v?"Creating...":"Create Order"," "]})]})]})}):null},PA=({isOpen:e,onClose:n,onSuccess:t,medication:r,initialPatient:a,initialItems:o})=>{const[l,d]=w.useState(""),[f,u]=w.useState([]),[h,g]=w.useState(null),[b,v]=w.useState(!1);w.useEffect(()=>{if(e&&r){k([{id:Date.now(),medication_name:r.medicationName,drug_id:null,quantity:r.quantity,tablets_per_day:r.tabletsPerDay||1,number_of_days:r.numberOfDays||30,directions:r.directions||"",notes:r.notes||""}]),P(r.frequencyDays);try{const K=new Date(r.nextDeliveryDate);isNaN(K.getTime())||R(K.toISOString().split("T")[0])}catch(K){console.error("Error parsing date",K)}g({id:r.patientId,name:r.patientName,phone:r.patientPhone,patient_token_number:r.patientToken})}else e&&(a||o)?(o&&o.length>0&&k(o),a&&g(a)):e&&!r&&!o&&(k([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),P(30),R(""),g(null),d(""))},[e,r,a,o]);const[S,k]=w.useState([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),[T,P]=w.useState(30),[M,R]=w.useState(""),[z,$]=w.useState(null),[L,U]=w.useState(""),[B,W]=w.useState([]),[I,F]=w.useState(!1),[V,re]=w.useState(!1),[ie,G]=w.useState(null),Y=w.useRef(null),ne=w.useRef(null);w.useEffect(()=>{if(e){const K=new Date;K.setDate(K.getDate()+30),R(K.toISOString().split("T")[0])}},[e]);const le=w.useCallback(async K=>{if(!K.trim()){u([]);return}v(!0);try{const J=await me(`/api/patients?search=${encodeURIComponent(K)}&limit=10`);if(J.ok){const ye=await J.json();u(ye.patients||[])}}catch(J){console.error("Error searching patients:",J)}finally{v(!1)}},[]);w.useEffect(()=>{Y.current&&clearTimeout(Y.current),l&&!h?Y.current=setTimeout(()=>le(l),300):u([])},[l,h,le]);const oe=w.useCallback(async K=>{if(!K.trim()){W([]);return}F(!0);try{const J=await me(`/api/drugs?search=${encodeURIComponent(K)}&limit=10`);if(J.ok){const ye=await J.json();W(ye.drugs||[])}}catch(J){console.error("Error searching drugs:",J)}finally{F(!1)}},[]);w.useEffect(()=>{ne.current&&clearTimeout(ne.current),L&&z!==null?ne.current=setTimeout(()=>oe(L),300):W([])},[L,z,oe]);const E=K=>{if(!K)return 1;const J=K.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return J?parseInt(J[1],10):1},de=K=>{g(K),d(`${K.name} (${K.patient_token_number})`),u([])},he=(K,J)=>{const ye=[...S];ye[J]={...ye[J],medication_name:K.name,drug_id:K.id,pack_size:E(K.pack),packs:0,loose:0,quantity:0},k(ye),$(null),U(""),W([])},D=(K,J,ye)=>{const He=[...S],Q={...He[K]},Pe=Q.pack_size||1;if(J==="packs"||J==="loose"){const Re=parseInt(ye)||0;J==="packs"&&(Q.packs=Re),J==="loose"&&(Q.loose=Re);const Le=Q.packs||0,_e=Q.loose||0;Q.quantity=Le*Pe+_e}else if(J==="tablets_per_day"||J==="number_of_days"){J==="tablets_per_day"&&(Q.tablets_per_day=ye),J==="number_of_days"&&(Q.number_of_days=ye);const Re=parseFloat(Q.tablets_per_day.toString())||0,Le=parseInt(Q.number_of_days.toString())||0,_e=Math.ceil(Re*Le);Q.quantity=_e,Q.packs=Math.floor(_e/Pe),Q.loose=_e%Pe}else Q[J]=ye;He[K]=Q,k(He)},pe=()=>{k([...S,{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:T,directions:"",notes:"",packs:0,loose:0,pack_size:1}])},Ne=K=>{S.length>1&&k(S.filter((J,ye)=>ye!==K))},te=async K=>{if(K.preventDefault(),G(null),!h){G("Please select a patient.");return}if(S.some(ye=>!ye.medication_name||ye.quantity<=0)){G("Please ensure all items have a medication name and valid quantity.");return}re(!0);try{const ye={patient_id:h.id,items:S.map(Q=>({medication_name:Q.medication_name,drug_id:Q.drug_id,quantity:Q.quantity,tablets_per_day:Q.tablets_per_day,number_of_days:Q.number_of_days,directions:Q.directions,notes:Q.notes,frequency_days:T,next_delivery_date:M}))},He=await me("/api/recurring-medications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ye)});if(!He.ok){const Q=await He.json();throw new Error(Q.message+(Q.error?": "+Q.error:"")||"Failed to create recurring medication.")}t(),n(),g(null),d(""),k([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),P(30)}catch(ye){G(ye.message)}finally{re(!1)}};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"add-recurring-modal",style:{maxWidth:"800px",width:"95%"},children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Add Recurring Medication Order"}),i.jsx("button",{className:"close-btn",onClick:n,children:i.jsx(bn,{size:20})})]}),i.jsxs("div",{className:"modal-body",children:[ie&&i.jsx("div",{className:"error-message",children:ie}),i.jsxs("form",{onSubmit:te,className:"recurring-form",children:[i.jsxs("div",{className:"order-settings-row",children:[i.jsxs("div",{className:"form-group",style:{flex:2},children:[i.jsxs("label",{children:[i.jsx(eo,{size:16})," Patient"]}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search patient...",value:l,onChange:K=>{d(K.target.value),g(null)},className:h?"selected":"unselected"}),b&&i.jsx("span",{className:"spinner",children:"..."}),l&&!h&&f.length>0&&i.jsx("ul",{className:"suggestions-list",children:f.map(K=>i.jsxs("li",{onClick:()=>de(K),children:[i.jsx("div",{className:"suggestion-name",children:K.name}),i.jsxs("div",{className:"suggestion-details",children:[K.phone,"  ",K.patient_token_number]})]},K.id))})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(H3,{size:16})," Frequency"]}),i.jsxs("select",{value:T,onChange:K=>{const J=parseInt(K.target.value);P(J);const ye=new Date;ye.setDate(ye.getDate()+J),R(ye.toISOString().split("T")[0]);const He=S.map(Q=>({...Q,number_of_days:J}));k(He)},children:[i.jsx("option",{value:15,children:"Every 15 Days"}),i.jsx("option",{value:30,children:"Every 30 Days"}),i.jsx("option",{value:60,children:"Every 60 Days"}),i.jsx("option",{value:90,children:"Every 90 Days"})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(Qm,{size:16})," Next Delivery"]}),i.jsx("input",{type:"date",value:M,onChange:K=>R(K.target.value)})]})]}),i.jsx("hr",{className:"divider"}),i.jsxs("div",{className:"items-header",children:[i.jsx("h4",{children:"Medications"}),i.jsxs("button",{type:"button",className:"add-item-btn",onClick:pe,children:[i.jsx(tl,{size:14})," Add Drug"]})]}),i.jsx("div",{className:"items-list",children:S.map((K,J)=>i.jsxs("div",{className:"medication-item-row",children:[i.jsxs("div",{className:"row-top",children:[i.jsxs("div",{className:"form-group med-search-group",children:[i.jsx("label",{children:"Drug Name"}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drug...",value:z===J?L:K.medication_name,onFocus:()=>{$(J),U(K.medication_name)},onChange:ye=>{U(ye.target.value),D(J,"medication_name",ye.target.value)}}),z===J&&I&&i.jsx("span",{className:"spinner",children:"..."}),z===J&&L&&B.length>0&&i.jsx("ul",{className:"suggestions-list",children:B.map(ye=>i.jsxs("li",{onClick:()=>he(ye,J),children:[i.jsx("div",{className:"suggestion-name",children:ye.name}),i.jsxs("div",{className:"suggestion-details",children:["Stock: ",ye.stock]})]},ye.id))})]})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Tabs/Day"}),i.jsx("input",{type:"number",min:"0.5",step:"0.5",value:K.tablets_per_day,onChange:ye=>D(J,"tablets_per_day",ye.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Days"}),i.jsx("input",{type:"number",min:"1",value:K.number_of_days,onChange:ye=>D(J,"number_of_days",ye.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:K.packs||"",onChange:ye=>D(J,"packs",ye.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:K.loose||"",onChange:ye=>D(J,"loose",ye.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Total"}),i.jsx("input",{type:"number",value:K.quantity,disabled:!0,style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]}),i.jsx("button",{type:"button",className:"remove-btn",onClick:()=>Ne(J),disabled:S.length===1,children:i.jsx(Wr,{size:16})})]}),i.jsxs("div",{className:"row-bottom",children:[i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Directions (e.g. 1-0-1 after food)",value:K.directions,onChange:ye=>D(J,"directions",ye.target.value)})}),i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Notes",value:K.notes,onChange:ye=>D(J,"notes",ye.target.value)})})]})]},K.id))}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",className:"btn-cancel",onClick:n,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-submit",disabled:V,children:V?"Creating...":"Create Recurring Order"})]})]})]})]})}):null},Ane=({messages:e})=>{const n=w.useRef(null);return w.useEffect(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e]),i.jsxs("div",{className:"conversation-panel",children:[i.jsxs("div",{className:"conversation-header",children:[i.jsx("div",{className:"conversation-title",children:i.jsx("h3",{children:"Conversation"})}),i.jsxs("span",{className:"conversation-count",children:[e.length," messages"]})]}),i.jsxs("div",{ref:n,className:"message-list custom-scrollbar",children:[e.length===0&&i.jsx("div",{className:"empty-state",children:"Start talking to the AI..."}),e.map(t=>i.jsxs("div",{className:`message-wrapper ${t.role}`,children:[i.jsx("div",{className:`message-bubble ${t.role} ${t.role==="system"?t.type||"info":""}`,children:t.role==="ai"||t.role==="system"&&t.type==="loading"?i.jsx("div",{className:"prose prose-sm max-w-none",children:t.role==="system"&&t.type==="loading"?i.jsxs("span",{className:"flex items-center justify-center gap-2",children:[i.jsx("span",{className:"loading-spinner"}),t.content]}):i.jsx(xs,{remarkPlugins:[za],children:t.content})}):i.jsx("div",{className:"whitespace-pre-wrap",children:t.content})}),t.role!=="system"&&i.jsx("span",{className:"message-timestamp",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id))]})]})},t1=e=>{if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return"";const t=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,16)},zj=()=>{var Sc,as;const{openCommandBar:e}=Nb(),{recordId:n,patientId:t}=Ki(),[r,a]=w.useState(n||void 0),o=At(),l=qr(),[d,f]=w.useState(""),[u]=w.useState([]),[h,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(void 0),[T,P]=w.useState(void 0),[M,R]=w.useState(null),[z,$]=w.useState(!1),[L,U]=w.useState(""),[B,W]=w.useState(!1),[I,F]=w.useState(null),[V,re]=w.useState(null),[ie,G]=w.useState(!1),[Y,ne]=w.useState(!1),[le,oe]=w.useState(null),[E,de]=w.useState(""),[he,D]=w.useState(""),[pe,Ne]=w.useState(null),[te,K]=w.useState(!1),[J,ye]=w.useState(!1),[He,Q]=w.useState(!1),[Pe,Re]=w.useState(window.innerHeight),[Le,_e]=w.useState([]),[Ke,Ye]=w.useState(!1),[it,xt]=w.useState(null),[Nt,ue]=w.useState([]),[Ae,ke]=w.useState([]),[Se,ve]=w.useState([]),[X,fe]=w.useState(!1),[Ge,Je]=w.useState(null),ct=w.useRef(null),wt=w.useRef(null),Ht=w.useRef(!1),Ce=w.useRef(null),be=w.useRef(null),Fe=w.useRef(null),Ie=w.useRef(null),Ve=w.useRef(null),st=w.useRef(null),mt=w.useRef(null),[Ct,ln]=w.useState([]),[dn,vn]=w.useState(!1);w.useEffect(()=>{(async()=>{if(Ct.length>0&&!dn){vn(!0);const ge=Ct[0];ge.current&&(ge.current.scrollIntoView({behavior:"smooth",block:"center"}),ge.current.classList.add("ai-glow"),await new Promise(ce=>setTimeout(ce,2e3)),ge.current&&ge.current.classList.remove("ai-glow")),ln(ce=>ce.slice(1)),vn(!1)}})()},[Ct,dn]);const kt=ae=>{let ge=null;switch(ae){case"update_patient_details":ge=Fe;break;case"create_pharmacy_order":case"edit_pharmacy_order":ge=Ie;break;case"create_lab_order":case"edit_lab_order":ge=Ve;break;case"add_complaint_history":ge=st;break;case"update_case_summary":ge=mt;break}ge&&ln(ce=>[...ce,ge])},[bt,Yt]=w.useState(33.33),[It,Jn]=w.useState(!1),Vr=w.useRef(null),fr=w.useRef(null),[En,wr]=w.useState("response"),Jr=w.useRef(null),ws=w.useRef(null),Qd=150,[Jd,Kd]=w.useState([]),[Ss,gu]=w.useState([]),[ba,Ns]=w.useState(!0),[Cs,_s]=w.useState(null),[Sr,Xd]=w.useState(!1),[Zd,js]=w.useState(!1),[ao,Kl]=w.useState(!1),[ef,il]=w.useState(!1),[ep,Xl]=w.useState(!1),[so,vr]=w.useState([]),[Ya,Zl]=w.useState(!1),[ks,ec]=w.useState(null),[al,yu]=w.useState(!1),[tc,Kr]=w.useState(null),[oo,xu]=w.useState({}),[nc,rc]=w.useState(!1),[Wa,bu]=w.useState(!1),[ci,sl]=w.useState(!1),[vu,ol]=w.useState([]),[va,ic]=w.useState(!1),[lo,wa]=w.useState(!1),[Qa,ac]=w.useState(!1),[ll,sc]=w.useState(!1),[oc,wu]=w.useState(!1),[Ja,Ka]=w.useState(!1),co=w.useMemo(()=>(b==null?void 0:b.admission_date)&&!(b!=null&&b.discharge_date),[b]),[Ts,Sa]=w.useState(!1),[Su,cl]=w.useState(null),[lc,Es]=w.useState(""),[Fi,As]=w.useState(void 0),[Ps,Xi]=w.useState(void 0),[ul,uo]=w.useState(void 0),[Zi,_n]=w.useState(!1),[jn,Xa]=w.useState(null),[Xr,Na]=w.useState(null),[cc,Ds]=w.useState(null),[dl,uc]=w.useState(!1),fo=w.useRef(null),[tr,Za]=w.useState(null),[Ca,Nu]=w.useState([]),dc=w.useCallback(ae=>{Nu(ge=>[...ge,{id:Math.random().toString(36).substr(2,9),timestamp:new Date,role:"system",content:"",...ae}])},[]),[Zr,fl]=w.useState(null),hl=w.useRef(null),pl=w.useRef(null),[tf,fc]=w.useState(!1),[hc,Hr]=w.useState(!1),[Pn,ei]=w.useState(null),[pc,mc]=w.useState(""),[ti,es]=w.useState(""),[Cu,qn]=w.useState(!0),[ni,gc]=w.useState(!1),[_u,ho]=w.useState(!1),[po,nf]=w.useState(!1),[tp,ju]=w.useState(!1),ts=w.useRef(null),mo=async()=>{ts.current&&(await ts.current.undoLastAction(),ju(!1))},ns=async ae=>{try{const ge=await me(`/api/patients/${ae}`);if(!ge.ok){const Te=await ge.json().catch(()=>({}));throw new Error(Te.message||`Failed to fetch patient details: ${ge.status}`)}const ce=await ge.json();if(v(ce),k(ce.age),P(ce.gender),de(ce.ai_response||""),v(Te=>Te?{...Te,current_status:ce.current_status,admission_date:ce.admission_date,discharge_date:ce.discharge_date}:{...ce,current_status:ce.current_status,admission_date:ce.admission_date,discharge_date:ce.discharge_date}),ce.insurance_type&&v(Te=>Te?{...Te,insurance_type:ce.insurance_type}:{...ce}),yo(ae),ce.ai_response){const Te=/```json\s*([\s\S]*?)\s*```/,et=ce.ai_response.match(Te);if(et&&et[1])D(ce.ai_response.replace(Te,"").trim()),Ne(et[1].trim());else{const dt=ce.ai_response.trim();if(dt.startsWith("{")&&dt.endsWith("}"))try{JSON.parse(dt),D(""),Ne(dt)}catch{D(dt),Ne(null)}else if(dt.startsWith("[")&&dt.endsWith("]"))try{JSON.parse(dt),D(""),Ne(dt)}catch{D(dt),Ne(null)}else D(dt),Ne(null)}}else D(""),Ne(null)}catch{v(null),de(""),D(""),Ne(null)}},go=async(ae,ge)=>{v(ce=>ce?{...ce,insurance_type:ge}:null);try{const ce=await me(`/api/patients/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:ge})});if(!ce.ok){const Te=await ce.json();throw new Error(Te.message||"Failed to update insurance type")}}catch(ce){console.error("Error updating insurance type:",ce),ae&&ns(ae)}},ku=async ae=>{fe(!0),Je(null),ve([]);try{const ge=await me(`/api/queue/patient/${ae}/complaints`);if(!ge.ok){const Te=await ge.json().catch(()=>({}));throw new Error(Te.message||`HTTP error! status: ${ge.status}`)}const ce=await ge.json();ve(ce||[])}catch(ge){Je(`Past complaints error: ${ge.message}`)}finally{fe(!1)}},_a=async ae=>{ue([]);try{const ge=await me(`/api/pharmacy-orders/patient/${ae}`);if(!ge.ok){const Te=await ge.json().catch(()=>({}));throw new Error(Te.message||`HTTP error! status: ${ge.status}`)}const ce=await ge.json();ue(ce||[])}catch{}},ja=async ae=>{Zl(!0),ec(null),vr([]);try{const ge=await me(`/api/lab/orders/patient/${ae}`);if(!ge.ok){const Te=await ge.json().catch(()=>({}));throw new Error(Te.message||`HTTP error! status: ${ge.status}`)}const ce=await ge.json();vr(ce||[])}catch(ge){ec(`Pending labs error: ${ge.message}`)}finally{Zl(!1)}},Is=async ae=>{Ye(!0),xt(null),_e([]);try{const ge=await me(`/api/lab/patient/${ae}`);if(!ge.ok){const Te=await ge.json().catch(()=>({}));throw new Error(Te.message||`HTTP error! status: ${ge.status}`)}const ce=await ge.json();_e(ce||[])}catch(ge){xt(`Lab reports error: ${ge.message}`)}finally{Ye(!1)}},Tu=async ae=>{try{const ge=await me(`/api/patients/${ae}/context`);if(!ge.ok){console.error("Failed to fetch patient context");return}const ce=await ge.json();if(v(ce.patient),k(ce.patient.age),P(ce.patient.gender),de(ce.patient.ai_response||""),ce.patient.ai_response){const Te=/```json\s*([\s\S]*?)\s*```/,et=ce.patient.ai_response.match(Te);if(et&&et[1])D(ce.patient.ai_response.replace(Te,"").trim()),Ne(et[1].trim());else{const dt=ce.patient.ai_response.trim();if(dt.startsWith("{")&&dt.endsWith("}"))try{JSON.parse(dt),D(""),Ne(dt)}catch{D(dt),Ne(null)}else if(dt.startsWith("[")&&dt.endsWith("]"))try{JSON.parse(dt),D(""),Ne(dt)}catch{D(dt),Ne(null)}else D(dt),Ne(null)}}else D(""),Ne(null);if(Ka(ce.patient.current_status==="In Doctor Queue"||ce.patient.current_status==="In Consultation"),ve(Array.isArray(ce.history)?ce.history:[]),ue(Array.isArray(ce.pharmacyOrders)?ce.pharmacyOrders:[]),Array.isArray(ce.labOrders)){const Te=ce.labOrders,et=Te.filter(_t=>!_t.report);vr(et);const dt=Te.filter(_t=>_t.report).map(_t=>({..._t.report,id:_t.id,patient_id:_t.patient_id,createdAt:_t.createdAt}));_e(dt),_e(dt)}else vr([]),_e([]);Array.isArray(ce.recurringMedications)?ke(ce.recurringMedications):ke([])}catch(ge){console.error("Error fetching patient context:",ge)}},yo=async ae=>{try{const ge=await me(`/api/queue/patient/${ae}/latest`);if(!ge.ok){const Te=await ge.json().catch(()=>({}));throw new Error(Te.message||`Failed to fetch queue status: ${ge.status}`)}const ce=await ge.json();if(ce){const Te=new Date(ce.createdAt),et=new Date,dt=Te.getDate()===et.getDate()&&Te.getMonth()===et.getMonth()&&Te.getFullYear()===et.getFullYear(),_t=["waiting","consulting"].includes(ce.status);Ka(dt&&_t)}else Ka(!1)}catch(ge){console.error("Error checking patient queue status:",ge),Ka(!1)}},ka=async(ae,ge)=>{try{if(!(await me(`/api/pharmacy-orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:ge})})).ok)throw new Error("Failed to update pharmacy order date");h&&_a(h)}catch(ce){console.error("Error updating pharmacy order date:",ce),oe("Failed to update pharmacy order date")}},yc=async(ae,ge,ce)=>{try{const Te={};if(ge==="order"?Te.date=ce:ge==="report"&&(Te.reportDate=ce),!(await me(`/api/lab/orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Te)})).ok)throw new Error("Failed to update lab date");h&&(ja(h),Is(h))}catch(Te){console.error("Error updating lab order date:",Te),oe("Failed to update lab order date")}},Eu=ae=>{o(`/dashboard/edit-pharmacy-order/${ae}`)},ui=ae=>{const ge=ae.medications.map((ce,Te)=>({id:Date.now()+Te,medication_name:ce.name,drug_id:ce.drug_id?String(ce.drug_id):null,quantity:(ce.pack_quantity||0)*(ce.pack_price||1)+(ce.loose_quantity||0),tablets_per_day:ce.tabletsPerDay||1,number_of_days:ce.numberOfDays||30,directions:ce.directions_to_use||"",notes:"",packs:ce.pack_quantity,loose:ce.loose_quantity,pack_size:1}));ol(ge),sl(!0)},xc=ae=>{oe(null),console.log(`Preparing billing navigation for order: ${ae}`);const ge=Nt.find(ce=>ce.id===ae);if(ge){const ce=ge.medications.map(Te=>{const et=Te.price??0;return(Te.price===void 0||Te.price===null)&&console.warn(`Medication "${Te.name}" in order ${ae} is missing a price. Defaulting to 0.`),{name:Te.name,pack_quantity:Te.pack_quantity,loose_quantity:Te.loose_quantity,price:et,pack_price:Te.pack_price,loose_price:Te.loose_price,total_price:Number(Te.total_price)||0,isLoose:Te.isLoose,unit:Te.unit,drug_id:Te.drug_id?String(Te.drug_id):null,tabletsPerDay:Te.tabletsPerDay,numberOfDays:Te.numberOfDays,directions_to_use:Te.directions_to_use,discount_percentage:Te.discount_percentage??0,batch:Te.batch,expiry_date:Te.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:ce}),o(`/dashboard/pharmacy-billing/${ae}`,{state:{initialItems:ce}})}else console.error(`Order with ID ${ae} not found.`),oe(`Order with ID ${ae} not found.`),alert(`Error: Could not find order ${ae} to bill.`)},xo=async(ae,ge)=>{oe(null);const ce=Nt.find(et=>et.id===ae);if(!ce){oe(`Order with ID ${ae} not found.`);return}const Te={status:ge,medications:ce.medications};try{const et=await me(`/api/pharmacy-orders/${ae}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Te)});if(!et.ok){const _t=await et.text();throw new Error(`Failed to update status: ${et.statusText} (${et.status}) - ${_t}`)}const dt=await et.json();ue(_t=>_t.map(yt=>yt.id===dt.id?{...yt,status:dt.status}:yt)),h&&_a(h)}catch(et){console.error("Failed to update order status:",et),oe(et.message||`Failed to update status for order ${ae}.`),alert(`Error updating status for order ${ae}: ${et.message||"Please try again."}`)}},bo=ae=>{vr(ge=>ge.map(ce=>ce.id===ae?{...ce,isEditing:!0,editedTests:[...ce.tests],editedStatus:ce.status}:{...ce,isEditing:!1}))},vo=ae=>{vr(ge=>ge.map(ce=>ce.id===ae?{...ce,isEditing:!1,editedTests:void 0,editedStatus:void 0}:ce))},np=(ae,ge,ce,Te)=>{vr(et=>et.map(dt=>{if(dt.id===ae){const _t=dt.editedTests?[...dt.editedTests]:[...dt.tests];if(ce==="add")return{...dt,editedTests:[..._t,{id:"",name:"",price:0}]};if(ce==="remove")return{...dt,editedTests:Te};if(ge!==-1){const yt={..._t[ge],[ce]:Te};return _t[ge]=yt,{...dt,editedTests:_t}}}return dt}))},bc=(ae,ge)=>{vr(ce=>ce.map(Te=>Te.id===ae?{...Te,editedStatus:ge}:Te))},rf=async ae=>{if(!ae){console.error("Cannot navigate to billing: Lab Order data is missing."),alert("Could not open billing page: Lab Order information is missing.");return}o(`/dashboard/lab-billing/${ae.id}`)},af=async(ae,ge)=>{console.log(`Updating lab order ${ae} to status ${ge}`);try{const ce=await me(`/api/lab/${ae}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:ge})});if(!ce.ok){const Te=await ce.json();throw new Error(Te.message||`Failed to update lab order status: ${ce.status}`)}h&&(ja(h),Is(h)),console.log(`Lab Order ${ae} status updated to ${ge}, refetching data.`)}catch(ce){console.error("Error updating lab order status:",ce),alert(`Failed to update lab order status: ${ce instanceof Error?ce.message:"Unknown error"}`)}},vc=ae=>{ae&&ae.id?o(`/lab/report/${ae.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the report entry page: Lab Order information is missing."))},rs=async(ae,ge,ce)=>{ic(!0),oe(null);try{if(!ge||ge.length===0)throw new Error("Lab order must have at least one test.");for(const dt of ge)if(!dt.id||!dt.name||isNaN(dt.price)||dt.price<0)throw new Error(`Invalid test data: ${JSON.stringify(dt)}. Each test must have id, name, and a valid price.`);const Te={tests:ge,status:ce},et=await me(`/api/lab/orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Te)});if(!et.ok){const dt=await et.json().catch(()=>({}));throw new Error(dt.message||`Failed to update lab order: ${et.statusText}`)}h&&ja(h),vr(dt=>dt.map(_t=>_t.id===ae?{..._t,isEditing:!1,editedTests:void 0,editedStatus:void 0}:_t))}catch(Te){oe(`Lab Order Save Error: ${Te.message}`)}finally{ic(!1)}},ml=async ae=>{if(!window.confirm(`Are you sure you want to delete this ${ae.type.toLowerCase()} record? This action cannot be undone.`))return;yu(!0),Kr(null);let ce=null,Te;const et=ae.type;try{switch(et){case"Complaint":if(Te=ae.data.id,!Te)throw new Error("Complaint ID is missing.");ce=`/api/patients/complaints/${Te}`;break;case"Lab Order":if(Te=ae.data.id,!Te)throw new Error("Lab Order ID is missing.");ce=`/api/lab/orders/${Te}`;break;case"Lab Report":if(Te=ae.data.reportId,!Te)throw new Error("Lab Report ID is missing.");ce=`/api/lab/reports/${Te}`;break;case"Pharmacy Order":if(Te=ae.data.id,!Te)throw new Error("Pharmacy Order ID is missing.");ce=`/api/pharmacy-orders/${Te}`;break;default:throw new Error(`Deletion not supported for item type: ${et}`)}if(!ce)throw new Error(`Could not determine delete URL for type: ${et}`);const dt=await me(ce,{method:"DELETE"});if(!dt.ok){const _t=await dt.json().catch(()=>({}));throw new Error(_t.message||`Failed to delete ${et}: ${dt.statusText}`)}h&&(et==="Complaint"?ku(h):et==="Lab Order"?(ja(h),Is(h)):et==="Lab Report"?Is(h):et==="Pharmacy Order"&&_a(h))}catch(dt){Kr(`Delete Error (${et}): ${dt.message}`),al&&yu(!1)}finally{yu(!1)}},sf=async()=>{if(!h)return;if(Nt.filter(ge=>ge.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Hr(!0);try{const ge=await me(`/api/pharmacy-orders/patient/${h}/merge-pending`,{method:"POST"});if(!ge.ok){const ce=await ge.json().catch(()=>({}));throw new Error(ce.message||"Failed to merge orders")}_a(h)}catch(ge){oe(`Merge Error: ${ge.message}`)}finally{Hr(!1)}},$i=w.useMemo(()=>{if(!h||!Se)return[];const ae=Se.map(ge=>({date:new Date(ge.createdAt),type:"Complaint",data:ge,originalDateString:ge.createdAt})).filter(ge=>!isNaN(ge.date.getTime()));return ae.sort((ge,ce)=>ce.date.getTime()-ge.date.getTime()),ae},[h,Se]),Ta=w.useMemo(()=>{if(!h)return[];const ae=new Map;(so??[]).forEach(ce=>{ae.set(ce.id,{...ce})}),(Le??[]).forEach(ce=>{if(!ae.has(ce.id))ae.set(ce.id,{id:ce.id,patient_id:ce.patient_id,tests:ce.tests,status:ce.status,createdAt:ce.createdAt,report:ce});else{const Te=ae.get(ce.id);Te&&(Te.report=ce,Te.status=ce.status)}});let ge=Array.from(ae.values());return ge.sort((ce,Te)=>new Date(ce.createdAt).getTime()-new Date(Te.createdAt).getTime()),ge=ge.map((ce,Te)=>({...ce,serialNumber:Te+1})),ge.map(ce=>({date:new Date(ce.createdAt),type:"Lab Order",data:ce,originalDateString:ce.createdAt}))},[h,so,Le]),Mr=w.useMemo(()=>{if(!h||!Nt)return[];const ae=Nt.map(ge=>({date:new Date(ge.date),type:"Pharmacy Order",data:ge,originalDateString:ge.date})).filter(ge=>!isNaN(ge.date.getTime()));return ae.sort((ge,ce)=>ce.date.getTime()-ge.date.getTime()),ae},[h,Nt]),[gl,of]=w.useState(null),[lf,ri]=w.useState([]),[ii,di]=w.useState(""),wc=(ae,ge)=>{if(!ae||!ae.report_content||!ge)return"";try{const ce=JSON.parse(ae.report_content||"{}");if(typeof ce!="object"||ce===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${ae.report_content}</pre>`;let Te="";return ge.forEach(et=>{ce[et.id]?(Te+=`<h5 class="font-semibold text-sm mt-2 mb-1">${et.name}</h5>`,Te+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(ce[et.id]).map(([dt,_t])=>{var Kn;const yt=(Kn=et.default_parameters)==null?void 0:Kn.find(vl=>vl.name===dt);let hr="N/A";yt&&yt.type==="number"&&(yt.lower_limit!=null||yt.upper_limit!=null)?(hr="",yt.lower_limit!=null&&(hr+=` > ${yt.lower_limit}`),yt.lower_limit!=null&&yt.upper_limit!=null&&(hr+=" - "),yt.upper_limit!=null&&(hr+=` < ${yt.upper_limit}`),hr=hr.trim()||"N/A"):(yt==null?void 0:yt.type)==="boolean"?hr="N/A":yt!=null&&yt.normal_range&&(hr=yt.normal_range),Te+=`<tr><td>${dt}</td><td>${String(_t)} ${(yt==null?void 0:yt.unit)||""}</td><td>${hr}</td></tr>`}),Te+="</tbody></table>"):Te+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${et.name}.</p>`}),Te}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${ae.report_content}</pre>`}};w.useEffect(()=>{const ae=()=>{Re(window.innerHeight)};return window.addEventListener("resize",ae),ae(),()=>window.removeEventListener("resize",ae)},[]),w.useEffect(()=>{const ae=ce=>{if(!It||!ws.current||!Jr.current)return;const Te=Jr.current.getBoundingClientRect(),dt=ce.clientX-ws.current.x;let _t=ws.current.initialWidth+dt;const yt=Te.width-Qd-10;_t=Math.max(Qd,_t),_t=Math.min(_t,yt);const hr=_t/Te.width*100;Yt(hr)},ge=()=>{Jn(!1),ws.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return It&&(window.addEventListener("mousemove",ae),window.addEventListener("mouseup",ge),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",ae),window.removeEventListener("mouseup",ge),document.body.style.cursor="",document.body.style.userSelect=""}},[It]);const cf=ae=>{if(!Jr.current)return;ae.preventDefault();const ge=Jr.current.querySelector(".edit-complaint-context-column");ge&&(ws.current={x:ae.clientX,initialWidth:ge.offsetWidth},Jn(!0))},Au=w.useCallback(async()=>{ne(!0),oe(null);try{const ae=await me("/api/queue/doctor/new",{method:"POST"});if(!ae.ok){const ce=await ae.json().catch(()=>({}));throw new Error(ce.message||`Failed to create record: ${ae.statusText}`)}const ge=await ae.json();if(!ge.recordId)throw new Error("New record ID not received from server.");o(`/edit-complaint/${ge.recordId}`,{replace:!0})}catch(ae){oe(`Failed to create new complaint record: ${ae.message}`)}finally{ne(!1)}},[o]);w.useEffect(()=>{(async()=>{qn(!0);try{const ge=await me("/api/clinics/settings");if(!ge.ok){const Te=await ge.json().catch(()=>({}));throw new Error(Te.message||"Failed to fetch clinic settings.")}const ce=await ge.json();ei({admissionCharge:parseFloat(ce.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(ce.perDayCharge||0).toFixed(2),otherCharges:parseFloat(ce.otherCharges||0).toFixed(2),aiMemory:ce.aiMemory||"",aiMemoryUpdatedAt:ce.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:ce.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:ce.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:ce.gemini_api_key||""}),mc(ce.aiMemory||""),es(ce.clinicWideSystemPrompt||"")}catch{}finally{qn(!1)}})()},[]),w.useEffect(()=>{var ge;(ge=l.state)!=null&&ge.initialComplaint&&f(l.state.initialComplaint);const ae=async ce=>{G(!0),oe(null);try{const Te=await me(`/api/queue/doctor/complaint/${ce}`);if(!Te.ok){const dt=await Te.json().catch(()=>({}));throw new Error(dt.message||`HTTP error! status: ${Te.status}`)}const et=await Te.json();g(et.patientId),k(et.age),P(et.gender),R(et.case_summary||null),re(et.updatedAt||null)}catch{oe("Failed to load current complaint details."),g(null),k(void 0),P(void 0),R(null),re(null)}finally{G(!1)}};if(r)ae(r);else if(t){const ce=t;ce&&(g(ce),(async()=>{try{const et=await me(`/api/queue/patient/${ce}/latest`);if(et.ok){const _t=await et.json();if(_t!=null&&_t._id){a(_t._id),ae(_t._id);return}}const dt=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:ce,complaint:"Visit Initiated"})});if(dt.ok){const _t=await dt.json();if(_t!=null&&_t.id){a(_t.id),ae(_t.id);return}}}catch(et){console.error("Background queue resolution failed",et),oe("Failed to initialize visit record.")}})())}else Au()},[r,Au,(Sc=l.state)==null?void 0:Sc.initialComplaint,t]),w.useEffect(()=>{h?Tu(h):(v(null),ve([]),ue([]),vr([]),_e([]),re(null),Ka(!1))},[h]),w.useEffect(()=>{var ce;const ae=(ce=l.state)==null?void 0:ce.initialComplaint;ae&&r&&(!ie&&!X&&!Ya&&!Ke&&!ba)&&!Ht.current&&d===ae&&(Ht.current=!0,qe(),o(l.pathname,{replace:!0,state:{}}))},[(as=l.state)==null?void 0:as.initialComplaint,r,d,ie,X,Ya,Ke,ba,o]);const Pu=()=>{U(M||""),$(!0),F(null)},rp=()=>{$(!1),U(""),F(null)},wo=async()=>{if(!r){F("Missing Record ID.");return}W(!0),F(null);try{const ae=await me(`/api/queue/doctor/complaint/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:L.trim()})});if(!ae.ok){const ce=await ae.json().catch(()=>({}));throw new Error(ce.message||`Failed to save case summary: ${ae.statusText}`)}const ge=await ae.json();R(ge.case_summary||L.trim()),re(ge.updatedAt||null),$(!1)}catch(ae){F(`Save Error: ${ae.message}`)}finally{W(!1)}};w.useEffect(()=>{(async()=>{Ns(!0),_s(null);try{const[ge,ce]=await Promise.all([me("/api/drugs"),me("/api/lab-tests")]);if(!ge.ok)throw new Error(`Pharmacy inventory error! status: ${ge.status}`);const Te=await ge.json(),et=Te.drugs||Te||[];if(Kd(et),!ce.ok)throw new Error(`Lab inventory error! status: ${ce.status}`);const dt=await ce.json();gu(dt||[])}catch(ge){_s(ge.message)}finally{Ns(!1)}})()},[]);const is=async()=>{if(!Pn)return;if(pc===Pn.aiMemory&&ti===Pn.clinicWideSystemPrompt){ho(!1);return}const ae=pc!==Pn.aiMemory,ge=ti!==Pn.clinicWideSystemPrompt;ae&&gc(!0),ge&&nf(!0);try{const ce={...Pn};ae&&(ce.aiMemory=pc),ge&&(ce.clinicWideSystemPrompt=ti);const Te=await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify(ce)});if(!Te.ok){const dt=await Te.json().catch(()=>({}));throw new Error(dt.message||"Failed to update clinic settings.")}const et=await Te.json();ei({admissionCharge:parseFloat(et.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(et.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(et.settings.otherCharges).toFixed(2),aiMemory:et.settings.aiMemory||"",aiMemoryUpdatedAt:et.settings.aiMemoryUpdatedAt||(Pn==null?void 0:Pn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:et.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:et.settings.clinicWideSystemPromptUpdatedAt||(Pn==null?void 0:Pn.clinicWideSystemPromptUpdatedAt)||null}),ae&&mc(et.settings.aiMemory||""),ge&&(es(et.settings.clinicWideSystemPrompt||""),ho(!1))}catch{}finally{ae&&gc(!1),ge&&nf(!1)}},De=()=>{Pn&&(es(Pn.clinicWideSystemPrompt||""),ho(!0))},Qe=()=>{ho(!1),Pn&&es(Pn.clinicWideSystemPrompt||"")},qe=async ae=>{const ge=ae??d;ge.trim()&&(pl.current&&(clearTimeout(pl.current),pl.current=null),dc({role:"user",content:ge}),ts.current&&(await ts.current.callGenerativeApi(ge),pl.current=setTimeout(()=>{Nu([])},1e4)))},ft=ae=>{navigator.clipboard.writeText(ae).then(()=>{}).catch(ge=>{console.error("Failed to copy text: ",ge)})},Pt=(ae,ge)=>{const ce=window.open("","_blank");ce&&(ce.document.write(`
        <html>
          <head>
            <title>${ge}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${ge}</h2>
            <div id="print-content">${ae}</div>
          </body>
        </html>
      `),ce.document.close(),ce.print())},fn=()=>{if(E){const ae=gee().use(za).use(Tne).processSync(he).toString();Pt(`<div class="prose">${ae}</div>`,"AI Response")}};w.useEffect(()=>{if(b){let ae=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${b.name||"N/A"}</p>
          <p><strong>Token:</strong> ${b.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${b.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${b.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${b.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${b.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${b.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${b.admission_date?new Date(b.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${b.discharge_date?new Date(b.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${M||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${$i.length>0?`
            <ul>
              ${$i.map(ge=>`<li>${new Date(ge.originalDateString).toLocaleDateString()}: ${ge.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${Mr.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${Mr.map(ge=>ge.data.medications.map((ce,Te)=>`
                    <tr>
                      ${Te===0?`<td rowspan="${ge.data.medications.length}">${new Date(ge.originalDateString).toLocaleDateString()}</td>`:""}
                      ${Te===0?`<td rowspan="${ge.data.medications.length}">${ge.data.status}</td>`:""}
                      <td><strong>${ce.name}</strong></td>
                      <td>
                        ${ce.pack_quantity!==void 0&&ce.pack_quantity>0?`Packs: ${ce.pack_quantity}`:""}
                        ${ce.pack_quantity!==void 0&&ce.pack_quantity>0&&ce.loose_quantity!==void 0&&ce.loose_quantity>0?", ":""}
                        ${ce.loose_quantity!==void 0&&ce.loose_quantity>0?`Loose: ${ce.loose_quantity}`:""}
                      </td>
                      <td>${ce.tabletsPerDay&&ce.numberOfDays?`${ce.tabletsPerDay} tab/day for ${ce.numberOfDays} days`:"N/A"}</td>
                      <td>${ce.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${Ta.length>0?`
            ${Ta.map(ge=>{const ce=ge.data.tests.map(et=>et.name).join(", ");let Te="";return ge.data.report&&(Te=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(ge.data.report.report_date).toLocaleDateString()})</h4>
                    ${wc(ge.data.report,ge.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(ge.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${ge.data.status}</p>
                  <p><strong>Tests:</strong> ${ce}</p>
                  ${Te}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;di(ae)}else di("")},[b,M,$i,Mr,Ta,wc]);const nr=()=>{ii&&Pt(ii,`Patient Details - ${b==null?void 0:b.name}`)},hn=ae=>{f(ae),of(null),ri([]),setTimeout(()=>{qe(ae)},0)},fi=ie||J||He||Ke||X||ba||Ya||Y||Sr||Zd||ao||ef||ep||va||Zi||ni||po||hc||al||lo||Qa||ll||oc||B,uf=fi,hi=()=>{f("reports came,please anaylse"),setTimeout(()=>{qe()},0)},yl=ae=>{xu(ge=>({...ge,[ae]:!ge[ae]}))},ip=ae=>{ae.key==="Enter"&&!ae.shiftKey&&(ae.preventDefault(),!fi&&d.trim()&&r&&qe())};w.useEffect(()=>{const ae=window.SpeechRecognition||window.webkitSpeechRecognition;if(!ae){Za("Speech recognition not supported in this browser.");return}const ge=new ae;return ge.continuous=!0,ge.interimResults=!0,ge.lang="en-US",ge.onresult=ce=>{let Te="";for(let et=ce.resultIndex;et<ce.results.length;++et)ce.results[et].isFinal&&(Te+=ce.results[et][0].transcript);Te&&f(et=>et+(et.endsWith(" ")||et===""?"":" ")+Te)},ge.onerror=ce=>{Za(`Speech error: ${ce.error}`),uc(!1)},ge.onend=()=>{},fo.current=ge,()=>{fo.current&&fo.current.stop()}},[]);const So=async()=>{if(h)if(co){ac(!0);try{const ae=await me(`/api/patients/${h}/discharge`,{method:"POST"});if(!ae.ok){const ge=await ae.json().catch(()=>({}));throw new Error(ge.message||`Failed to discharge patient: ${ae.status}`)}ns(h)}catch(ae){oe(`Discharge Error: ${ae.message}`)}finally{ac(!1)}}else{wa(!0);try{const ae=await me(`/api/patients/${h}/admit`,{method:"POST"});if(!ae.ok){const ge=await ae.json().catch(()=>({}));throw new Error(ge.message||`Failed to admit patient: ${ae.status}`)}ns(h)}catch(ae){oe(`Admit Error: ${ae.message}`)}finally{wa(!1)}}},xl=async ae=>{if(h){sc(!0);try{const ce=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:h})});if(!ce.ok){const Te=await ce.json().catch(()=>({}));throw new Error(Te.message||`Failed to add patient to ${ae} queue: ${ce.status}`)}alert(`Patient added to ${ae} queue successfully!`),h&&(ns(h),yo(h))}catch(ge){oe(`Add to Queue Error: ${ge.message}`)}finally{sc(!1)}}},bl=async()=>{if(r){wu(!0),oe(null);try{const ae=await me(`/api/queue/${r}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!ae.ok){const ge=await ae.json().catch(()=>({}));throw new Error(ge.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),h&&(ns(h),yo(h))}catch(ae){oe(`Error completing consultation: ${ae.message}`)}finally{wu(!1)}}},wn=async()=>{if(!h){Xa("Missing Patient ID.");return}if(!b){Xa("Patient details not loaded.");return}_n(!0),Xa(null);try{const ae={};let ge=!1;if(lc!==b.name&&(ae.name=lc,ge=!0),Fi!==b.age&&(ae.age=Fi,ge=!0),Ps!==b.gender&&(ae.gender=Ps,ge=!0),ul!==b.phone&&(ae.phone=ul,ge=!0),!ge){Xa("No changes detected."),_n(!1),Sa(!1);return}const ce=await me(`/api/patients/${h}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!ce.ok){const et=await ce.json().catch(()=>({}));throw new Error(et.message||`Failed to update patient details: ${ce.statusText}`)}const Te=await ce.json();v(Te),k(Te.age),P(Te.gender),Es(Te.name),As(Te.age),Xi(Te.gender),uo(Te.phone),Sa(!1)}catch(ae){Xa(`Save Error: ${ae.message}`)}finally{_n(!1)}},zi=w.useCallback(()=>{if(!b)return null;const ae={token_number:b.patient_token_number||"N/A",name:b.name||"N/A",age:b.age||"N/A",gender:b.gender||"N/A",phone:b.phone||"N/A"};return $i.length>0?ae.complaints_history=$i.map(ge=>`${ge.data.complaint} (${new Date(ge.originalDateString).toLocaleDateString()})`).join("; "):ae.complaints_history="No past complaints.",Mr.length>0?ae.pharmacy_orders_history=Mr.map(ge=>`Order: ${ge.data.medications.map(Te=>{let et=`${Te.name}`;return Te.pack_quantity!==void 0&&Te.pack_quantity>0&&(et+=` Packs: ${Te.pack_quantity}`),Te.loose_quantity!==void 0&&Te.loose_quantity>0&&(et+=` Loose: ${Te.loose_quantity}`),et}).join(", ")} (${ge.data.status}, ${new Date(ge.originalDateString).toLocaleDateString()})`).join("; "):ae.pharmacy_orders_history="No pharmacy orders.",Ta.length>0?ae.lab_orders_history=Ta.map(ge=>{let Te=`Lab Order: ${ge.data.tests.map(et=>et.name).join(", ")} (${ge.data.status}, ${new Date(ge.originalDateString).toLocaleDateString()})`;return ge.data.report&&(Te+=` - Report: ${ge.data.report.report_content} (${new Date(ge.data.report.report_date).toLocaleDateString()})`),Te}).join("; "):ae.lab_orders_history="No lab history.",ae},[b,$i,Mr,Ta]),Du=()=>{if(!b){Za("Patient details are required to use the Live API.");return}fc(!0)},Gr=()=>{var ae;(ae=hl.current)==null||ae.click()},vi=ae=>{var ce;const ge=(ce=ae.target.files)==null?void 0:ce[0];ge&&fl(ge)},Rs=ae=>{wr(ae),ae==="context"&&Vr.current?Vr.current.scrollIntoView({behavior:"smooth",block:"start"}):ae==="response"&&fr.current&&fr.current.scrollIntoView({behavior:"smooth",block:"start"})};return w.useEffect(()=>{const ae=new IntersectionObserver(ge=>{ge.forEach(ce=>{ce.isIntersecting&&(ce.target===fr.current?wr("response"):ce.target===Vr.current&&wr("context"))})},{root:null,threshold:.5});return fr.current&&ae.observe(fr.current),Vr.current&&ae.observe(Vr.current),()=>{fr.current&&ae.unobserve(fr.current),Vr.current&&ae.unobserve(Vr.current)}},[]),i.jsxs("div",{className:"edit-complaint-page",style:{height:`${Pe}px`},children:[i.jsx(MJ,{ref:ts,recordId:r,patientId:h,patientDetails:b,caseSummary:M,caseSummaryUpdatedAt:V,clinicSettings:Pn,userMessages:u,selectedImageFile:Zr,pendingLabOrders:so,labReports:Le,pastComplaints:Se,pharmacyOrders:Nt,pharmacyInventory:Jd,labInventory:Ss,currentComplaint:d,setCurrentComplaint:f,setAiResponse:de,setAiResponseText:D,setAiResponseJsonString:Ne,setShowAiJsonDetails:K,setIsLoadingAi:ye,setAiError:()=>{},setIsSubmittingAiOrder:Xd,setAiOrderSubmissionStatus:()=>{},setIsSubmittingAiLabOrder:js,setAiLabOrderSubmissionStatus:()=>{},setIsSubmittingAiComplaint:Kl,setAiComplaintSubmissionStatus:()=>{},setIsUpdatingCaseSummary:il,setAiCaseSummaryUpdateStatus:()=>{},setCaseSummary:R,setCaseSummaryUpdatedAt:re,setIsUpdatingAiMemoryByAI:Xl,setAiMemoryUpdateByAIStatus:()=>{},setFollowUpQuestion:of,setFollowUpOptions:ri,setError:oe,setIsSavingAiResponse:Q,setSaveAiResponseError:()=>{},fetchPharmacyOrdersData:_a,fetchPendingLabOrdersData:ja,fetchLabReportsData:Is,fetchPastComplaintsData:ku,fetchPatientDetails:ns,setClinicSettings:ei,setEditedAiMemory:mc,handleDeleteItem:ml,setCanUndo:ju,onAiActionSuccess:kt,addMessage:dc}),tf&&b&&i.jsx(rS,{onClose:()=>fc(!1),patientData:zi(),tokenNumber:b.patient_token_number?String(b.patient_token_number):null,onAiSummaryChange:ae=>{ae&&(f(ae),qe(ae),fc(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>o(-1),disabled:fi,className:"back-button",title:"Go Back",children:"< Back"}),i.jsx("span",{ref:be,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),b&&i.jsx("div",{className:"edit-complaint-patient-details",children:b&&!Ts?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{Sa(!0),Es(b.name||""),As(b.age),Xi(b.gender),uo(b.phone),Xa(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:Zi,children:i.jsx(Ul,{size:14})}),b.name??"N/A",b.patient_token_number!==null&&b.patient_token_number!==void 0&&` (${b.patient_token_number})`," - ",b.age??"N/A"," / ",b.gender??"N/A",b.phone&&` / ${b.phone}`,i.jsx("button",{onClick:ae=>{ae.stopPropagation(),nr()},disabled:!ii,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(Ko,{size:14})})]}):b&&Ts?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:lc,onChange:ae=>Es(ae.target.value),placeholder:"Name",className:"edit-input",disabled:Zi}),i.jsx("input",{type:"number",value:Fi??"",onChange:ae=>As(ae.target.value?parseInt(ae.target.value):null),placeholder:"Age",className:"edit-input",disabled:Zi}),i.jsxs("select",{value:Ps??"",onChange:ae=>Xi(ae.target.value||null),className:"edit-input",disabled:Zi,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:ul??"",onChange:ae=>uo(ae.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Zi}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{Sa(!1),Xa(null)},className:"button-secondary",disabled:Zi,children:"Cancel"}),i.jsx("button",{onClick:wn,className:"button-primary blue",disabled:Zi,children:Zi?"Saving...":"Save"})]}),jn&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:jn})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[S??"N/A"," / ",T??"N/A",i.jsx("button",{onClick:ae=>{ae.stopPropagation(),nr()},disabled:!ii,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(Ko,{size:14})})]})}),!b&&S!==void 0&&T!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[S??"N/A"," / ",T??"N/A",i.jsx("button",{onClick:ae=>{ae.stopPropagation(),nr()},disabled:!ii,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(Ko,{size:14})})]}),i.jsx("div",{style:{minWidth:"64px",display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{onClick:e,className:"icon-button small text-gray-600 hover:text-gray-900 bg-gray-100 hover:bg-gray-200",title:"Open Command Bar (Ctrl+K)",style:{padding:"0.2rem",borderRadius:"8px"},children:i.jsx(bi,{size:24})})})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:Jr,children:[Ca.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"edit-complaint-chat-column",style:{width:"30%",minWidth:"320px",maxWidth:"40%",flexShrink:0},children:i.jsx(Ane,{messages:Ca})}),i.jsx("div",{className:"draggable-divider",onMouseDown:()=>{}})]}),i.jsxs("div",{ref:fr,className:"edit-complaint-main-column",style:{flex:1,minWidth:0},children:[le&&i.jsxs("div",{className:"general-error-message",children:["Error: ",le]}),(he||pe)&&i.jsxs("div",{ref:ct,className:`${pe?"ai-function-call-block":"ai-response-container"} group`,children:[he&&i.jsx(xs,{remarkPlugins:[za],children:he}),pe&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>K(!te),className:"ai-json-toggle-button",children:[te?i.jsx(x1,{size:14,className:"mr-1"}):i.jsx(y1,{size:14,className:"mr-1"}),te?"Hide":"Show"," AI Function Call Details"]}),te&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(pe),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>ft(E),disabled:!E,title:"Copy Full AI Response",children:i.jsx(Y3,{size:12})}),i.jsx("button",{onClick:fn,disabled:!E,title:"Print AI Response",children:i.jsx(Ko,{size:12})})]})]})]}),i.jsx("div",{className:"draggable-divider",onMouseDown:cf}),i.jsx("div",{ref:Vr,className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-bt}% - 5px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsxs("h3",{className:"ai-context-header",children:[i.jsx("span",{children:"AI Context:"}),(b==null?void 0:b.insurance_type)&&i.jsx("div",{className:"insurance-type-container mt-2",children:i.jsxs("select",{ref:Ce,value:b.insurance_type,onChange:ae=>go(b.id,ae.target.value),className:"insurance-type-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),i.jsxs("div",{ref:Fe,className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),(b==null?void 0:b.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(b.admission_date).toLocaleDateString()]}),(b==null?void 0:b.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(b.discharge_date).toLocaleDateString()]}),(b==null?void 0:b.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:b.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsx("button",{onClick:So,className:`admit-discharge-button ${co?"discharge":"admit"}`,title:co?"Discharge Patient":"Admit Patient",disabled:!h||lo||Qa,children:lo?"Admitting...":Qa?"Discharging...":co?"Discharge":"Admit"}),i.jsx("button",{onClick:()=>xl("doctor"),className:`queue-status-button ${Ja?"in-queue":"add-to-queue"}`,title:Ja?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!h||ll||Ja,children:ll?"Adding...":Ja?"In Queue":"Add to Queue"}),i.jsx("button",{onClick:bl,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:oc,children:oc?"Completing...":"Complete Consultation"})]})]}),i.jsx("div",{ref:Ie,children:i.jsx(z0,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:sf,className:"button-primary blue text-xs px-2 py-1",disabled:hc||Nt.filter(ae=>ae.status==="pending").length<2,title:"Merge all pending orders into one",children:hc?"Merging...":"Merge Orders"}),i.jsxs("button",{onClick:()=>bu(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!h,children:[i.jsx(tl,{size:12,className:"mr-1"})," Create Order"]})]}),items:Mr,isLoading:!1,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(ae,ge)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",Mr.length-ge,". Order Status: (",ae.data.status,")",i.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:Su===ae.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",children:i.jsx("input",{type:"datetime-local",defaultValue:t1(ae.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:ce=>{ce.target.value&&ka(ae.data.id,ce.target.value),cl(null)},onKeyDown:ce=>{if(ce.key==="Enter"){const Te=ce.target;Te.value&&ka(ae.data.id,Te.value),cl(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:()=>cl(ae.data.id),title:"Click to edit date",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")",i.jsx(Ul,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>Eu(ae.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(Ul,{size:12})}),ae.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>Pt(ae.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(Ko,{size:12})}),i.jsx("button",{onClick:()=>ml({type:"Pharmacy Order",data:ae.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(Wr,{size:12})}),ae.data.status==="pending"&&i.jsx("button",{onClick:()=>xc(ae.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:va,children:i.jsx(Fh,{size:12})}),ae.data.status==="billed"&&i.jsx("button",{onClick:()=>xo(ae.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:va,children:i.jsx(vs,{size:12})}),i.jsx("button",{onClick:()=>ui(ae.data),className:"icon-button small group-hover:block",title:"Add to Recurring Medications",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[i.jsx("path",{d:"m17 2 4 4-4 4"}),i.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),i.jsx("path",{d:"m7 22-4-4 4-4"}),i.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2 cursor-pointer hover:bg-gray-50 transition-colors rounded p-1",onClick:()=>Eu(ae.data.id),title:"Click to edit order",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:ae.data.medications.map((ce,Te)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:ce.name})}),i.jsxs("td",{className:"py-1 px-2",children:[ce.pack_quantity!==void 0&&ce.pack_quantity>0&&`Packs: ${ce.pack_quantity}`,ce.pack_quantity!==void 0&&ce.pack_quantity>0&&ce.loose_quantity!==void 0&&ce.loose_quantity>0&&", ",ce.loose_quantity!==void 0&&ce.loose_quantity>0&&`Loose: ${ce.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:ce.tabletsPerDay&&ce.numberOfDays?`${ce.tabletsPerDay} tab/day for ${ce.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:ce.directions_to_use||"N/A"})]},ce.drug_id||ce.name||Te))})]})}),ae.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",ae.data.prescriptionForUnavailableDrugs]})]})})}),i.jsxs("div",{className:"ai-context-section mt-4",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Recurring Medications"}),Ae.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full text-xs text-left",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",children:[i.jsx("th",{className:"py-1 px-2",children:"Medication"}),i.jsx("th",{className:"py-1 px-2",children:"Qty"}),i.jsx("th",{className:"py-1 px-2",children:"Frequency"}),i.jsx("th",{className:"py-1 px-2",children:"Next Delivery"}),i.jsx("th",{className:"py-1 px-2",children:"Status"})]})}),i.jsx("tbody",{children:Ae.map(ae=>i.jsxs("tr",{className:"border-b last:border-0 hover:bg-gray-50",children:[i.jsx("td",{className:"py-1 px-2 font-medium",children:ae.medicationName}),i.jsx("td",{className:"py-1 px-2",children:ae.quantity}),i.jsxs("td",{className:"py-1 px-2",children:[ae.frequencyDays," days"]}),i.jsx("td",{className:"py-1 px-2",children:new Date(ae.nextDeliveryDate).toLocaleDateString()}),i.jsx("td",{className:"py-1 px-2",children:i.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] ${ae.status==="active"?"bg-green-100 text-green-800":ae.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ae.status})})]},ae.id))})]})}):i.jsx("p",{className:"text-gray-500 text-sm italic",children:"No recurring medications."})]}),Wa&&i.jsx(Ene,{isOpen:Wa,onClose:()=>bu(!1),patientId:h,pharmacyInventory:Jd,fetchPharmacyOrdersData:_a}),i.jsxs("div",{ref:Ve,children:[i.jsx(z0,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:hi,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:uf,children:"Analyse Reports"}),i.jsxs("button",{onClick:()=>rc(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!h,children:[i.jsx(tl,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:Ta,onDeleteItem:ml,onEditLabOrder:bo,onSaveLabOrder:rs,onCancelEditLabOrder:vo,onLabOrderTestChange:np,onLabOrderStatusChange:bc,onBillLabOrder:rf,onUpdateLabOrderStatus:af,onEnterLabReport:vc,labInventory:Ss,isSavingLabOrder:va,isLoading:Ya||Ke,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:oo,toggleLabReport:yl,renderItemContent:(ae,ge)=>{const ce=tJ(ae.data.report?ae.data.report.status:ae.data.status);return i.jsxs("div",{className:"ai-context-text",children:[i.jsxs("div",{onClick:()=>vc(ae.data),className:"cursor-pointer hover:bg-gray-100 rounded p-1 inline-block -ml-1",title:"Click to enter report",children:[ae.data.serialNumber,". ",i.jsx("span",{className:"font-medium",children:"[Order]"})," ",ae.data.tests&&ae.data.tests.length>0?ae.data.tests.map(Te=>i.jsxs("strong",{children:[Te.name," (",Te.price,")"]},Te.id||Te.name)).reduce((Te,et)=>[Te,", ",et]):i.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",ae.data.tests&&ae.data.tests.length>0&&i.jsxs("span",{className:"font-bold ml-2",children:["Total: ",ae.data.tests.reduce((Te,et)=>Te+(Number(et.price)||0),0).toFixed(2)]}),"(",i.jsx("span",{className:ce.className,children:ce.text}),")"]}),i.jsx("span",{className:"text-gray-400 ml-1 inline-flex items-center",children:Xr===ae.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Te=>Te.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:t1(ae.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Te=>{Te.target.value&&yc(ae.data.id,"order",Te.target.value),Na(null)},onKeyDown:Te=>{if(Te.key==="Enter"){const et=Te.target;et.value&&yc(ae.data.id,"order",et.value),Na(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:Te=>{Te.stopPropagation(),Na(ae.data.id)},title:"Click to edit order date",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")",i.jsx(Ul,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),ae.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),i.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:cc===ae.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Te=>Te.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:t1(ae.data.report.report_date),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Te=>{Te.target.value&&yc(ae.data.id,"report",Te.target.value),Ds(null)},onKeyDown:Te=>{if(Te.key==="Enter"){const et=Te.target;et.value&&yc(ae.data.id,"report",et.value),Ds(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/reportDate ml-1",onClick:Te=>{Te.stopPropagation(),Ds(ae.data.id)},title:"Click to edit report date",children:["(",new Date(ae.data.report.report_date).toLocaleDateString(),")",i.jsx(Ul,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsx("button",{onClick:()=>yl(ae.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:oo[ae.data.report.reportId]?"Collapse Report":"Expand Report",children:oo[ae.data.report.reportId]?i.jsx(x1,{size:14}):i.jsx(y1,{size:14})})]}),oo[ae.data.report.reportId]&&(()=>{try{const Te=JSON.parse(ae.data.report.report_content||"{}");return typeof Te=="object"&&Te!==null&&ae.data.report.tests?ae.data.report.tests.map(et=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:et.name}),Te[et.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(Te[et.id]).map(([dt,_t])=>{var hr;const yt=(hr=et.default_parameters)==null?void 0:hr.find(Kn=>Kn.name===dt);return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:dt}),i.jsxs("td",{className:"py-1 px-2",children:[String(_t)," ",(yt==null?void 0:yt.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(yt&&yt.type==="number"&&(yt.lower_limit!=null||yt.upper_limit!=null)){let Kn="";return yt.lower_limit!=null&&(Kn+=` > ${yt.lower_limit}`),yt.lower_limit!=null&&yt.upper_limit!=null&&(Kn+=" - "),yt.upper_limit!=null&&(Kn+=` < ${yt.upper_limit}`),Kn.trim()||"N/A"}else if((yt==null?void 0:yt.type)==="boolean")return"N/A";return(yt==null?void 0:yt.normal_range)||"N/A"})()})]},dt)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},et.id)):i.jsx(xs,{remarkPlugins:[za],children:ae.data.report.report_content})}catch{return i.jsx(xs,{remarkPlugins:[za],children:ae.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(TJ,{isOpen:nc,onClose:()=>rc(!1),patientId:h,labInventory:Ss,fetchPendingLabOrdersData:ja}),i.jsx("div",{ref:st,children:i.jsx(z0,{title:"Complaints History",items:$i,isLoading:X,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(ae,ge)=>i.jsxs("span",{className:"ai-context-text",children:[ae.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:ml})}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(Db,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!_u&&i.jsx("button",{onClick:De,className:"edit-button",title:"Edit System Prompt",disabled:Cu||ni||po,children:i.jsx(Ul,{size:14})})]}),_u&&Pn?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:ti,onChange:ae=>es(ae.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:ni||po}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:Qe,disabled:ni||po,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:is,disabled:ni||po||pc===Pn.aiMemory&&ti===Pn.clinicWideSystemPrompt,className:"button-primary purple",children:[i.jsx(zd,{size:14,className:"mr-1"}),po||ni?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:Pn!=null&&Pn.clinicWideSystemPrompt?i.jsx(xs,{remarkPlugins:[za],children:Pn.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!_u&&(Pn==null?void 0:Pn.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(Pn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{ref:mt,className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!z&&i.jsx("button",{onClick:Pu,className:"edit-button",title:"Edit Case Summary",disabled:ie||B,children:i.jsx(Ul,{size:14})})]}),z?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:L,onChange:ae=>U(ae.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:B}),I&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:I}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:rp,disabled:B,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:wo,disabled:B||L===M,className:"button-primary blue",children:B?"Saving...":"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:M?i.jsx(xs,{remarkPlugins:[za],components:{},children:M}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),V&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(V).toLocaleDateString()]})]})]}),$i.length===0&&Ta.length===0&&Mr.length===0&&!(X||Ya||Ke)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),al&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),tc&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:tc})]})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsx("div",{className:"mobile-section-selector",children:i.jsxs("div",{className:"selector-container",children:[i.jsx("button",{onClick:()=>Rs("response"),className:`selector-button ${En==="response"?"active":""}`,children:"AI Response"}),i.jsx("button",{onClick:()=>Rs("context"),className:`selector-button ${En==="context"?"active":""}`,children:"AI Context"})]})}),i.jsxs("div",{className:"status-messages-container",children:[it&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:it}),Ge&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ge}),ks&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:ks}),Cs&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Cs})]}),r&&!Y&&i.jsxs(w.Fragment,{children:[gl&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:gl}),lf.length>0&&i.jsx("div",{className:"options-grid",children:lf.map((ae,ge)=>i.jsx("button",{onClick:()=>hn(ae),className:"option-button",children:ae},ge))})]}),tr&&i.jsx("div",{className:"speech-error-display",children:tr}),Zr&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",Zr.name]}),i.jsx("button",{onClick:()=>{fl(null),hl.current&&(hl.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:hl,onChange:vi,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:wt,className:"complaint-textarea",value:d,onChange:ae=>f(ae.target.value),onKeyDown:ip,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:fi||!r||dl}),i.jsxs("div",{className:"chat-input-actions-container",children:[h&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>o(`/patient/${h}/lab-reports`),disabled:Ke||!h,className:"icon-button",title:"View Lab Reports",children:i.jsx(lu,{size:14})}),i.jsx("button",{onClick:()=>o("/inventory"),disabled:ba,className:"icon-button",title:"View Inventory",children:i.jsx($d,{size:14})})]}),i.jsx("button",{type:"button",onClick:Gr,disabled:fi||!r||dl,className:"icon-button",title:"Attach Image",children:i.jsx(Ab,{size:14})}),i.jsx("button",{type:"button",onClick:Du,disabled:fi||!r||!fo.current,className:`mic-button ${dl?"listening":""}`,title:dl?"Stop":"Mic",children:i.jsx(Eb,{size:14})}),i.jsx("button",{onClick:()=>qe(),disabled:fi||!d.trim()||!r||dl,className:"send-button",title:fi?"Processing...":"Save & Ask AI",children:fi?i.jsx("div",{className:"custom-loader-circle",role:"status","aria-label":"loading"}):i.jsx(g1,{size:14})}),tp&&i.jsx("button",{type:"button",onClick:mo,disabled:fi,className:"icon-button text-red-500",title:"Undo Last AI Actions",children:i.jsx(Wr,{size:14})})]})]})})]})]}),ci&&i.jsx(PA,{isOpen:ci,onClose:()=>sl(!1),onSuccess:()=>{h&&Tu(h)},initialItems:vu,initialPatient:b?{id:b.id,name:b.name,phone:b.phone||"",patient_token_number:String(b.patient_token_number||"")}:void 0})]})},Pne=()=>{const{patientId:e}=Ki(),n=At(),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(!1),[f,u]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){u("Patient ID not provided.");return}d(!0),u(null);try{const b=await me(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();o({name:v.name,age:v.age,gender:v.gender});const S=await me(`/api/patients/${e}/complaints`);if(S.ok){const T=(await S.json()).sort((P,M)=>new Date(M.createdAt).getTime()-new Date(P.createdAt).getTime());r(T)}else if(S.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),u(`Failed to load data. ${b.message}`),r([]),o(null)}finally{d(!1)}})()},[e]);const h=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),f&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",f]}),l&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!f&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>h(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Mx=500,Uj="defaultConsultationFee",Dne=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:o=[],billType:l="other",relatedId:d,initialStatus:f="pending",initialDiscountPercentage:u=0,readOnlyMode:h=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[T,P]=w.useState([]),M=w.useRef([]),[R,z]=w.useState(""),[$,L]=w.useState(""),[U,B]=w.useState(1),[W,I]=w.useState(u),[F,V]=w.useState("cash"),[re,ie]=w.useState(!1),[G,Y]=w.useState(null),[ne,le]=w.useState(!1),[oe,E]=w.useState(!1),[de,he]=w.useState(!1),[D,pe]=w.useState(null),[,Ne]=w.useState([]),[te,K]=w.useState(null),[J,ye]=w.useState(""),[He,Q]=w.useState("cash"),[Pe,Re]=w.useState(!1),[Le,_e]=w.useState(Mx),[Ke,Ye]=w.useState(Mx.toString()),it=n?"view_pay":"create";w.useEffect(()=>{const be=localStorage.getItem(Uj),Fe=be?parseFloat(be):Mx;isNaN(Fe)||(_e(Fe),Ye(Fe.toString()))},[]);const xt=o.length===0;w.useEffect(()=>{e?(async()=>{ie(!0),Y(null);try{const Fe=await me(`/api/patients/${e}`);if(!Fe.ok){const Ve=await Fe.json().catch(()=>({}));throw new Error(Ve.message||"Failed to fetch patient details")}const Ie=await Fe.json();k(Ie)}catch(Fe){Y(`Failed to load patient details: ${Fe.message}`),k(null)}finally{ie(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{he(!0),Y(null),pe(null),Ne([]),K(null);try{const Fe=await me(`/api/bills/${n}`);if(!Fe.ok){const Ve=await Fe.json().catch(()=>({}));throw new Error(Ve.message||"Failed to fetch bill details")}const Ie=await Fe.json();if(!Ie.bill||!Ie.payments||!Ie.calculated)throw new Error("Invalid bill details structure.");pe(Ie.bill),Ne(Ie.payments),K(Ie.calculated),I(Ie.bill.discount_percentage!==void 0&&Ie.bill.discount_percentage!==null?parseFloat(Ie.bill.discount_percentage.toString()):0),!S&&Ie.bill.patient_id&&Nt(Ie.bill.patient_id.toString())}catch(Fe){Y(`Failed to load bill details: ${Fe.message}`),pe(null),Ne([]),K(null)}finally{he(!1)}})():(pe(null),Ne([]),K(null))},[n]);const Nt=async be=>{ie(!0);try{const Fe=await me(`/api/patients/${be}`);if(!Fe.ok)throw new Error("Failed to fetch patient");const Ie=await Fe.json();k(Ie)}catch(Fe){console.error("Error fetching patient details:",Fe),k(null)}finally{ie(!1)}},ue=w.useCallback(async be=>{E(!0),Y(null);const Fe=be.filter(Ie=>Ie.drug_id!=null).map(async Ie=>{try{const Ve=await me(`/api/drugs/${Ie.drug_id}`);if(!Ve.ok)throw new Error(`Drug ${Ie.drug_id} not found.`);const st=await Ve.json();return{...Ie,price:st.price,total:st.price*Ie.quantity}}catch{return Y(st=>`${st?st+"; ":""}Failed to fetch price for ${Ie.name}`),Ie}});try{const Ie=await Promise.all(Fe);P(Ve=>{const st=new Map(Ie.map(mt=>[mt.id,mt]));return Ve.map(mt=>st.get(mt.id)||mt)})}catch{}finally{E(!1)}},[me]);w.useEffect(()=>{if(n){P([]),M.current=[];return}JSON.stringify(o)===JSON.stringify(M.current)||(async()=>{let Ie=[];if(o&&o.length>0)Ie=o.map((Ve,st)=>({...Ve,id:`initial-${st}-${Date.now()}`})),V(f==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),I(u),l==="pharmacy"&&!h&&await ue(Ie);else if(e&&xt&&l==="consultation"){let Ve=Le;if(g)try{const st=await me(`/api/staff/${g}`);if(!st.ok){const Ct=await st.json().catch(()=>({}));throw new Error(Ct.message||"Doctor not found or error fetching fee")}const mt=await st.json();mt.opd_fee!=null&&!isNaN(parseFloat(String(mt.opd_fee)))&&parseFloat(String(mt.opd_fee))>=0&&(Ve=parseFloat(String(mt.opd_fee)))}catch(st){Y(mt=>`${mt?mt+"; ":""}Could not fetch doctor's fee, using default. (${st.message})`)}Ie=[{id:Date.now(),name:"Consultation Fee",price:Ve,quantity:1,total:Ve*1,drug_id:null}],V(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else Ie=[],V(v==="no_cash_insurance"?"no_cash_insurance":"cash");P(Ie),M.current=o})()},[n,e,g,o,l,Le,xt,f,h,ue,u,v]);const Ae=()=>{const be=parseFloat($);if(!h)if(R&&!isNaN(be)&&be>=0&&U>0){if(R.trim().toLowerCase()==="consultation fee"&&T.some(Ie=>Ie.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Fe={id:Date.now(),name:R.trim(),price:be,quantity:U,total:be*U,drug_id:null};P([...T,Fe]),z(""),L(""),B(1)}else alert("Invalid item details.")},ke=be=>{h||P(T.filter(Fe=>Fe.id!==be))},Se=w.useMemo(()=>{let be=T.reduce((Fe,Ie)=>Fe+Ie.total,0);return it==="create"&&W>0&&(be=be*(1-W/100)),(te==null?void 0:te.totalDue)!==void 0&&(te==null?void 0:te.totalDue)!==null?te.totalDue:be},[T,te,W,it]),ve=w.useMemo(()=>(te==null?void 0:te.totalPaid)??0,[te]),X=w.useMemo(()=>(te==null?void 0:te.balance)!==void 0&&(te==null?void 0:te.balance)!==null?te.balance:Se-ve,[te,Se,ve]),fe=()=>{const be=parseFloat(Ke);!isNaN(be)&&be>=0?(_e(be),localStorage.setItem(Uj,be.toString()),alert(`Default Fee set to ${be.toFixed(2)}`)):alert("Invalid fee amount.")},Ge=async(be,Fe)=>{le(!0),Y(null);try{const Ie=await me("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Fe,billId:be})}),Ve=await Ie.json();if(!Ie.ok||!Ve.order)throw new Error(Ve.message||"Failed to create Razorpay order.");const{key_id:st,order:mt}=Ve,Ct={key:st,amount:mt.amount,currency:mt.currency,name:"Newtons Ai HMS Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:mt.id,handler:async function(ln){try{const dn=await me("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:ln.razorpay_payment_id,razorpay_order_id:ln.razorpay_order_id,razorpay_signature:ln.razorpay_signature,billId:be})}),vn=await dn.json();if(dn.ok&&vn.success)alert("Payment Successful!"),r&&r(be),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(vn.message||"Payment verification failed.")}catch(dn){Y(`Payment verification failed: ${dn.message}. Contact support.`)}finally{le(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:be,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){Y("Payment cancelled."),le(!1)}}};if(window.Razorpay)new window.Razorpay(Ct).open();else throw new Error("Razorpay SDK not loaded.")}catch(Ie){Y(`Failed to initiate online payment: ${Ie.message}`),le(!1)}},Je=async()=>{if(!n){Y("Bill ID is missing.");return}if(!J||isNaN(parseFloat(J))||parseFloat(J)<=0){Y("Please enter a valid positive payment amount.");return}Re(!0),Y(null);const be={amount_paid:parseFloat(J),payment_mode:He};try{const Fe=await me(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(be)}),Ie=await Fe.json();if(!Fe.ok)throw new Error(Ie.message||`Failed to record payment (Status: ${Fe.status})`);alert(`Payment of ${be.amount_paid.toFixed(2)} recorded.`),ye(""),a?a():console.log("Payment recorded.")}catch(Fe){Y(`Failed to record payment: ${Fe.message}`)}finally{Re(!1)}},ct=async()=>{if(it==="view_pay")return;if(!e){Y("Patient ID is missing for creating a bill.");return}if(T.length===0){Y("Cannot finalize an empty bill.");return}le(!0),Y(null);const be=Se,Fe=T.map(({id:Ie,...Ve})=>Ve);if(F==="online"){const Ie={patientId:e,queueId:t||null,items:Fe,amount:be,paymentMode:"online",type:l,related_id:d||b||null,status:"pending",discountPercentage:W,labOrderId:b||null};try{const Ve=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ie)}),st=await Ve.json();if(!Ve.ok)throw new Error(st.message||"Failed to create pending bill.");Ge(st.id,Math.round(be*100))}catch(Ve){Y(`Failed to create pending bill: ${Ve.message}`),le(!1)}}else{const Ie="paid";if(!F){Y("Payment mode required."),le(!1);return}const Ve={patientId:e,queueId:t||null,items:Fe,amount:be,paymentMode:F,type:l,related_id:d||b||null,status:Ie,discountPercentage:W,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const st=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ve)}),mt=await st.json();if(!st.ok)throw new Error(mt.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(mt.id),le(!1)}catch(st){Y(`Failed to process bill: ${st.message}`),le(!1)}}},wt=(D==null?void 0:D.type)??l,Ht=(D==null?void 0:D.status)??f,Ce=it==="view_pay"&&D&&Ht==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):re||it==="view_pay"&&de?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):it==="view_pay"&&!D&&!de&&G?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",G]}):it==="create"&&!S&&!re&&G?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",G]}):i.jsxs("div",{className:"billing-component-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:it==="create"?"Create Bill":"Bill Details"}),it==="create"&&l==="consultation"&&!h&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),i.jsx("input",{id:"defaultFee",type:"number",value:Ke,onChange:be=>Ye(be.target.value),className:"",placeholder:Mx.toString(),disabled:h}),i.jsx("button",{onClick:fe,title:"Set Default Fee",className:"",disabled:h,children:i.jsx(zd,{size:16})})]})]}),G&&!de&&!Pe&&i.jsxs("div",{className:"error-message",role:"alert",children:[i.jsx("strong",{children:"Error: "}),G]}),S&&i.jsxs("div",{className:"patient-details-section",children:[i.jsx("h3",{children:"Patient Details"}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",S.id]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",S.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",i.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),i.jsxs("div",{className:"bill-items-summary-section",children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:it==="create"?"Bill Items":"Billing Summary"}),it==="create"&&l==="pharmacy"&&!h&&T.some(be=>be.drug_id!=null)&&i.jsxs("button",{onClick:()=>ue(T),disabled:oe,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[i.jsx(v1,{size:14,className:`lucide ${oe?"animate-spin":""}`}),oe?"Refreshing...":"Refresh"]})]}),it==="view_pay"&&D&&i.jsxs("div",{className:"bill-info-bar",children:[i.jsxs("span",{children:["Bill ID: ",i.jsx("strong",{children:D.id})]}),i.jsxs("span",{children:["Type: ",i.jsx("strong",{className:"capitalize",children:wt})]}),i.jsxs("span",{children:["Status: ",i.jsx("strong",{className:`capitalize ${Ht==="paid"?"status-paid":"status-pending"}`,children:Ht})]})]}),(it==="create"||it==="view_pay"&&D)&&i.jsxs("div",{className:"bill-items-list",children:[it==="create"&&oe&&T.length>0&&i.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),it==="create"&&!oe&&T.map((be,Fe)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Fe+1,". ",be.name]}),be.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",be.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",be.total.toFixed(2)]}),it==="create"&&typeof be.id=="number"&&!h&&i.jsxs("button",{onClick:()=>ke(be.id),className:"remove-item-button",title:"Remove",children:[" ",i.jsx(bn,{size:16})," "]}),(typeof be.id!="number"||h||be.name==="Consultation Fee")&&i.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",i.jsx(GN,{size:14})," "]})]})]},be.id)),it==="view_pay"&&D&&D.items.map((be,Fe)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Fe+1,". ",be.name]}),be.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",be.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",(be.total??be.price*be.quantity).toFixed(2)]}),i.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",i.jsx(GN,{size:14})," "]})]})]},Fe)),it==="create"&&T.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items added."}),it==="view_pay"&&D&&D.items.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),it==="create"&&!h&&i.jsxs("div",{className:"add-item-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Item"}),i.jsx("input",{type:"text",value:R,onChange:be=>z(be.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:U,onChange:be=>B(parseInt(be.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[i.jsx("label",{children:"Price ()"}),i.jsx("input",{type:"number",value:$,onChange:be=>L(be.target.value),placeholder:"0.00",className:"custom-text-input"})]}),i.jsx("button",{onClick:Ae,className:"add-item-button",children:"Add"})]})]})," ",i.jsxs("div",{className:"billing-footer",children:[i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),i.jsxs("span",{className:"total-amount-value",children:["",typeof Se=="number"?Se.toFixed(2):"0.00"]}),it==="create"&&!h&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),i.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:W,onChange:be=>I(parseFloat(be.target.value)||0),className:"",disabled:h||ne})]}),it==="view_pay"&&D&&(D.status==="pending"||D.status==="paid")&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),i.jsxs("span",{className:"discount-value",children:[W.toFixed(2),"%"]})]})]}),it==="view_pay"&&te&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),i.jsxs("span",{className:"total-amount-value",children:["",ve.toFixed(2)]})]}),it==="view_pay"&&te&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),i.jsxs("span",{className:"total-amount-value",children:["",X.toFixed(2)]})]}),i.jsxs("div",{className:"footer-actions",children:[it==="create"&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:F,onChange:be=>V(be.target.value),className:"custom-select-input",disabled:h||ne,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("button",{onClick:ct,disabled:ne||T.length===0||h,className:"finalize-button",children:ne?"Processing...":"Finalize Bill"})]}),it==="view_pay"&&Ce&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Record Payment Amount ()"}),i.jsx("input",{type:"number",value:J,onChange:be=>ye(be.target.value),placeholder:`Max: ${X.toFixed(2)}`,className:"custom-text-input",disabled:Pe})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:He,onChange:be=>Q(be.target.value),className:"custom-select-input",disabled:Pe,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{onClick:Je,disabled:Pe||!J||parseFloat(J)<=0||parseFloat(J)>X,className:"record-payment-button",children:Pe?"Recording...":"Record Payment"})]}),it==="create"&&h&&T.length>0&&i.jsx("div",{className:"status-message read-only",children:"Read-only."}),it==="view_pay"&&Ht==="paid"&&i.jsx("div",{className:"status-message paid",children:"PAID."}),it==="view_pay"&&Ht==="cancelled"&&i.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},Ine=()=>{const e=At(),n=qr(),{patientId:t,queueId:r,patientName:a,initialItems:o,billType:l,relatedId:d,initialStatus:f,initialDiscountPercentage:u,doctorId:h,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,T]=w.useState(null),[P,M]=w.useState(null),[R,z]=w.useState(null),[$,L]=w.useState(null),[U,B]=w.useState(null),[W,I]=w.useState(null),[F,V]=w.useState(null),[re,ie]=w.useState(!0),[G,Y]=w.useState(null),[ne,le]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{ie(!0),Y(null);try{let pe=t,Ne=o||null,te=f||null,K=l||null,J=d||null,ye=u!==void 0?parseFloat(u):null,He=a||null,Q=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Pe=await me(`/api/bills/${g}`);if(!Pe.ok){const Le=await Pe.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(Le.message||`Failed to fetch bill details (Status: ${Pe.status})`)}const Re=await Pe.json();if(console.log("Fetched Bill Data:",Re),Ne=Re.bill.items||[],te=Re.bill.status||"pending",K=Re.bill.type||null,J=Re.bill.related_id||null,ye=Re.bill.discount_percentage!==void 0&&Re.bill.discount_percentage!==null?parseFloat(Re.bill.discount_percentage):0,pe=Re.bill.patient_id,z(Ne),L(te),B(K),I(J),V(ye),pe){const Le=await me(`/api/patients/${pe}`);if(Le.ok){const _e=await Le.json();He=_e.name,Q=_e.phone??null,M(_e.insurance_type??null),le(He),T(Q)}else console.warn(`Could not fetch patient details for ID ${pe} from bill.`),le("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),le("Patient (Unknown)")}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Pe=await me(`/api/lab/${b}`);if(!Pe.ok){let Le=`Failed to fetch lab order details (Status: ${Pe.status} ${Pe.statusText})`;try{Le=(await Pe.json()).message||Le}catch{console.error("Response was not valid JSON:",await Pe.text())}throw new Error(Le)}const Re=await Pe.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(Re,null,2)),Ne=(Re.tests||[]).filter(Le=>Le&&typeof Le.name=="string"&&Le.price!==void 0&&Le.id!==void 0).map(Le=>{const _e=parseFloat(Le.price||"0"),Ke=!isNaN(_e)&&isFinite(_e)?_e:0;return{item_id:Le.id,name:Le.name,price:Ke,quantity:1,total:Ke*1,type:"lab_test"}}),Ne&&Ne.length===0&&(Re.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",Re.tests),Y(Le=>`${Le?Le+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),te="pending",K="lab",J=b,pe=Re.patient_id,z(Ne),L(te),B(K),I(J),pe){const Le=await me(`/api/patients/${pe}`);if(Le.ok){const _e=await Le.json();He=_e.name,Q=_e.phone??null,M(_e.insurance_type??null),le(He),T(Q)}else console.warn(`Could not fetch patient details for ID ${pe} from lab order.`),le("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),le("Patient (Unknown)")}else if(z(o||null),L(f||null),B(l||null),I(d||null),V(u!==void 0?parseFloat(u):null),le(a||`ID ${t}`),pe){const Pe=await me(`/api/patients/${pe}`);if(Pe.ok){const Re=await Pe.json();T(Re.phone??null),M(Re.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${pe}.`)}if(r){const Pe=await me(`/api/queue/${r}`);if(Pe.ok){const Re=await Pe.json();S(Re.token_number)}else console.warn(`Could not fetch queue details for ID ${r}.`)}}catch(pe){console.error("Error fetching billing page details:",pe),Y(`Failed to load details: ${pe.message}`),z(null),L(null),B(null),I(null),le(a||""),T(null),S(null)}finally{ie(!1)}})()},[t,g,b,r,e]);const oe=D=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${D}`),e(-1)},E=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(YN,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(re)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(G)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(YN,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:G}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const he=($??f)==="paid";return i.jsxs("div",{className:"billing-page-container",children:[i.jsx("div",{className:"back-button-container",children:i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(an,{size:20,className:"lucide"})," Back"]})}),i.jsxs("div",{className:"billing-content-wrapper",children:[i.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",ne||`ID ${t}`]}),i.jsxs("div",{className:"patient-info-bar",children:[v!==null&&i.jsxs("span",{children:[i.jsx(Jm,{size:14,className:"lucide"})," Token: ",v]}),k&&i.jsxs("span",{children:[i.jsx(Mk,{size:14,className:"lucide"})," Phone: ",k]}),b&&i.jsxs("span",{className:"lab-order-info",children:[i.jsx(Hl,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),P&&i.jsxs("span",{className:"insurance-info",children:[i.jsx(KF,{size:14,className:"lucide"})," Insurance: ",P.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase())]}),!k&&v===null&&!b&&!P&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),i.jsx(Dne,{patientId:t,labOrderId:b,queueId:r,onBillCreated:oe,onBillUpdated:E,initialItems:R??o,billType:U??l,relatedId:W??d,initialStatus:$??f,initialDiscountPercentage:F??u,readOnlyMode:he,doctorId:h,patientInsuranceType:P??void 0})]})]})},Rne=()=>{const{patientId:e}=Ki(),n=At(),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided in URL.");return}o(!0),d(null),r([]);try{try{const v=await me(`/api/patients/${e}`);if(v.ok){const S=await v.json();u(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await me(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),d(`Failed to load pharmacy orders: ${g.message}`)}finally{o(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(an,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx($d,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",f&&`for ${f}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(h=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(h.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",h.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",h.prescribedBy||"N/A"]}),h.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",h.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:h.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},h.id))})]})},Mne=()=>{const e=At(),n=qr(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState([]),[f,u]=w.useState(""),[h,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState(null),[M,R]=w.useState(!0),[z,$]=w.useState(""),[L,U]=w.useState([]),[B,W]=w.useState(!1),[I,F]=w.useState(null),[V,re]=w.useState(!1),[ie,G]=w.useState(!1),[Y,ne]=w.useState([]),[le,oe]=w.useState(!1),[E,de]=w.useState(null),he=/^\+?[0-9\s\-().]{7,20}$/,D=/^[a-zA-Z\s'-]{2,}$/,pe=w.useCallback(async()=>{try{const ue=await me("/api/drugs");if(!ue.ok)throw new Error("Failed to fetch drugs");const Ae=await ue.json(),ke=Ae.drugs||Ae||[];o(ke)}catch(ue){console.error("Failed to fetch available drugs:",ue),v("Could not load drug list. "+ue.message)}},[]),Ne=w.useCallback(async ue=>{oe(!0),de(null);try{const Ae=await me(`/api/pharmacy-orders/patient/${ue}`);if(!Ae.ok){const Se=await Ae.json().catch(()=>({}));throw new Error(Se.message||`HTTP error! status: ${Ae.status}`)}const ke=await Ae.json();ne(ke||[])}catch(Ae){console.error("Failed to fetch previous pharmacy orders:",Ae),de(`Could not load previous orders: ${Ae.message}`)}finally{oe(!1)}},[]);w.useEffect(()=>{var ue;pe(),(ue=n.state)!=null&&ue.patient?J(n.state.patient):R(!0)},[pe,n.state]),w.useEffect(()=>{t!=null&&t.id?Ne(t.id):ne([])},[t,Ne]),w.useEffect(()=>{if(!f){g([]);return}const ue=f.toLowerCase();g(a.filter(Ae=>{const ke=Ae.name&&Ae.name.toLowerCase().includes(ue),Se=Ae.brand_name&&Ae.brand_name.toLowerCase().includes(ue);return ke||Se}).slice(0,10))},[f,a]);const te=w.useMemo(()=>fg(async ue=>{if(ue.trim().length<2){U([]),W(!1),F(null);return}W(!0),F(null);try{const Ae=new URLSearchParams({search:encodeURIComponent(ue),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),ke=await me(`/api/patients?${Ae.toString()}`);if(!ke.ok){const ve=await ke.text();throw new Error(`API Error (${ke.status}): ${ve||ke.statusText}`)}const Se=await ke.json();U(Se.patients)}catch(Ae){console.error("Error searching patients:",Ae),F(Ae.message||"Failed to search patients."),U([])}finally{W(!1)}},300),[he]),K=ue=>{const Ae=ue.target.value;$(Ae),re(he.test(Ae)),G(D.test(Ae)&&!he.test(Ae)),W(!0),te(Ae)},J=w.useCallback(ue=>{r(ue),R(!1),$(""),U([]),F(null)},[]),ye=w.useCallback(async ue=>{if(!z||ue==="phone"&&!V||ue==="name"&&!ie){F(`Invalid ${ue} to create a new patient.`);return}W(!0),F(null);try{const ke=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ue==="name"?z:"direct pharmacy",phone:ue==="phone"?z:null,age:null,gender:null,token:null})});if(!ke.ok){const ve=await ke.json();throw new Error(ve.message||`Failed to create patient: ${ke.statusText}`)}const Se=await ke.json();alert(`New patient "${Se.name}" created with ${ue==="phone"?`phone ${Se.phone}`:`name ${Se.name}`}.`),J(Se)}catch(Ae){console.error("Error creating new patient:",Ae),F(Ae.message||"Failed to create new patient.")}finally{W(!1)}},[z,V,ie,J]),He=()=>{r(null),R(!0),d([]),v(null),ne([])},Q=ue=>{if(l.some(Ae=>Ae.drug_id===ue.id)){const Ae=ue.name||ue.brand_name||"This drug";v(`${Ae} is already in the order.`),setTimeout(()=>v(null),3e3),u(""),g([]);return}d(Ae=>[...Ae,{drug_id:ue.id,name:ue.name||ue.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,mrp:Number(ue.mrp)||0,originalMrp:Number(ue.mrp)||0,stock:ue.stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(ue.mrp)||0)/(Re(ue.pack)||1),pack:ue.pack}]),u(""),g([])},Pe=()=>{const ue=f.trim();if(!ue){v("Please enter a drug name to navigate to the add drug page."),setTimeout(()=>v(null),3e3);return}e("/dashboard/inventory/add",{state:{initialDrugName:ue}}),u(""),g([])},Re=ue=>{if(!ue)return null;const Ae=ue.match(/(?:\d+x)?(\d+)/);return Ae?parseInt(Ae[1],10):null},Le=ue=>{d(Ae=>Ae.filter(ke=>(ke.drug_id??ke.name)!==ue))},_e=(ue,Ae)=>{d(ke=>ke.map(Se=>{if((Se.drug_id??Se.name)===ue&&Se.isLoose){const X=Re(Se.pack),fe=Math.max(0,Ae),Ge=fe*(X??1)+(Se.looseUnits??0);return{...Se,loosePacks:fe,looseQuantity:Ge,pack_quantity:fe}}return Se}))},Ke=(ue,Ae)=>{d(ke=>ke.map(Se=>{if((Se.drug_id??Se.name)===ue&&Se.isLoose){const X=Re(Se.pack),fe=Math.max(0,Ae),Ge=(Se.loosePacks??0)*(X??1)+fe;return{...Se,looseUnits:fe,looseQuantity:Ge}}return Se}))},Ye=ue=>{const Ae=[];ue.medications.forEach(ke=>{if(l.find(ve=>ve.drug_id&&ke.drug_id&&ve.drug_id===ke.drug_id||ve.name.toLowerCase()===ke.name.toLowerCase()))d(ve=>ve.map(X=>{if(X.drug_id&&ke.drug_id&&X.drug_id===ke.drug_id||X.name.toLowerCase()===ke.name.toLowerCase()){const fe=(X.pack_quantity??0)+(ke.pack_quantity??0),Ge=(X.loose_quantity??0)+(ke.loose_quantity??0),Je=ke.tabletsPerDay??X.tabletsPerDay,ct=ke.numberOfDays??X.numberOfDays,wt=Re(X.pack),Ht=fe*(wt??1)+Ge;return{...X,pack_quantity:fe,loose_quantity:Ge,directions_to_use:ke.directions_to_use??X.directions_to_use,tabletsPerDay:Je,numberOfDays:ct,looseQuantity:Ht,loosePacks:Math.floor(Ht/(wt??1)),looseUnits:Ht%(wt??1)}}return X}));else{let ve=ke.drug_id,X=ke.drug_id?a.find(fe=>fe.id===ke.drug_id):void 0;if(!ve&&ke.name){const fe=a.find(Ge=>Ge.name&&Ge.name.toLowerCase()===ke.name.toLowerCase());fe&&(ve=fe.id,X=fe)}Ae.push({drug_id:ve,name:ke.name,pack_quantity:ke.pack_quantity??0,loose_quantity:ke.loose_quantity??0,directions_to_use:ke.directions_to_use,tabletsPerDay:ke.tabletsPerDay??1,numberOfDays:ke.numberOfDays??1,mrp:X?X.mrp:ke.pack_price,originalMrp:X?X.mrp:ke.pack_price,stock:X?X.stock:ke.stock,isLoose:!0,loosePacks:0,looseUnits:(ke.pack_quantity??0)*(Re((X==null?void 0:X.pack)||ke.pack)??1)+(ke.loose_quantity??0),looseQuantity:(ke.pack_quantity??0)*(Re((X==null?void 0:X.pack)||ke.pack)??1)+(ke.loose_quantity??0),pricePerLooseUnit:(X?Number(X.mrp):Number(ke.pack_price)||0)/(Re((X==null?void 0:X.pack)||ke.pack)||1),pack:(X==null?void 0:X.pack)||ke.pack})}}),d(ke=>[...ke,...Ae]),ue.prescriptionForUnavailableDrugs&&(!T||!T.includes(ue.prescriptionForUnavailableDrugs))&&P(ke=>ke?`${ke}

-- From Order ${ue.id.substring(0,8)} --
${ue.prescriptionForUnavailableDrugs}`:ue.prescriptionForUnavailableDrugs),v("Medications from previous order added to current order."),setTimeout(()=>v(null),3e3)},it=async ue=>{if(ue.preventDefault(),v(null),k(!0),!t){v("No patient selected for the order."),k(!1);return}if(l.length===0&&!(T!=null&&T.trim())){v("Please add at least one medication or provide a prescription for unavailable drugs."),k(!1);return}const Ae=l.filter(Se=>{const ve=Se.looseQuantity??0;return ve<=0||Se.stock!==void 0&&ve>Se.stock});if(Ae.length>0){v(`Invalid quantity or insufficient stock for: ${Ae.map(Se=>Se.name).join(", ")}`),k(!1);return}const ke={patient_id:t.id,items:l.map(Se=>{const ve=Se.mrp??0,X=Se.pricePerLooseUnit??0,fe=X*(Se.looseQuantity??0);return{drug_id:Se.drug_id===void 0?null:Se.drug_id,name:Se.name,pack_quantity:Se.loosePacks??0,loose_quantity:Se.looseUnits??0,pack_price:ve,loose_price:X,total_price:fe,price:Se.originalMrp??0,directions_to_use:Se.directions_to_use===void 0?null:Se.directions_to_use,tabletsPerDay:Se.tabletsPerDay??1,numberOfDays:Se.numberOfDays??1}}),order_total:xt,prescription_for_unavailable_drugs:T};try{const Se=await me("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ke)});if(!Se.ok){const ve=await Se.json();throw new Error(ve.message||`Failed to create order: ${Se.statusText}`)}alert(`Pharmacy order created successfully for ${t.name}!`),e(-1)}catch(Se){console.error("Failed to create pharmacy order:",Se),v(Se.message||"Failed to create order. Please try again.")}finally{k(!1)}},xt=w.useMemo(()=>l.reduce((ue,Ae)=>{const ke=Ae.isLoose?Ae.pricePerLooseUnit??0:Ae.mrp??0,Se=Ae.isLoose?Ae.looseQuantity??0:Ae.quantity??0;return ue+ke*Se},0),[l]),Nt=(Number(xt)||0).toFixed(2);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-6 max-w-5xl mx-auto",children:[" ",i.jsxs("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:[" ",i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:[i.jsx(an,{size:20})," "]}),i.jsx("h2",{className:"text-2xl",children:"Create New Pharmacy Order"})," "]})]}),M&&i.jsxs("div",{className:"content-section",children:[" ",i.jsx("h3",{className:"section-title",children:"Select Patient"})," ",i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"})," ",i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:z,onChange:K,className:"custom-text-input mt-1",autoFocus:!0}),B&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),I&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:I})," ",L.length>0&&i.jsxs("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:[" ",i.jsxs("ul",{children:[" ",L.map(ue=>i.jsxs("li",{onClick:()=>J({id:ue.id,name:ue.name,token:ue.token,age:ue.age,gender:ue.gender,phone:ue.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",ue.token]}),ue.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[ue.age?`${ue.age} yrs`:"Age N/A",ue.gender?` / ${ue.gender}`:" / Gender N/A",ue.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",ue.phone]})]})]}),ue.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",ue.phone]})]},ue.id))]})]}),z.length>=2&&!B&&L.length===0&&!I&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',z,'".']}),V&&i.jsx("button",{type:"button",onClick:()=>ye("phone"),className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:B,children:'Create "direct pharmacy" Patient with this Phone'}),ie&&i.jsx("button",{type:"button",onClick:()=>ye("name"),className:"create-patient-button mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ml-2",disabled:B,children:"Create Patient with this Name"})]}),z.length<2&&!B&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]}),t&&!M&&i.jsxs("form",{onSubmit:it,children:[i.jsxs("div",{className:"selected-patient-info content-section flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:"section-title",children:[" ","Patient: ",i.jsx("span",{className:"font-normal",children:t.name})]}),i.jsxs("p",{className:"text-sm mt-1",children:["Token: ",i.jsx("span",{className:"font-medium",children:t.token??"N/A"}),t.age&&`    Age: ${t.age}`,t.gender&&`    Gender: ${t.gender}`,t.phone&&`    Phone: ${t.phone}`]}),i.jsxs("p",{className:"text-xs mt-1",title:`Patient UUID: ${t.id}`,children:["ID: ",t.id.substring(0,12),"..."]})]}),i.jsx("button",{type:"button",onClick:He,className:"change-patient-button mt-2 sm:mt-0 px-3 py-1.5 border rounded-md text-sm font-medium focus:outline-none focus:ring-2",children:"Change Patient"})]}),b&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:b})," ",le&&i.jsx("div",{className:"content-section text-center py-4",children:i.jsx("p",{className:"text-gray-500",children:"Loading previous orders..."})}),E&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:E}),!le&&Y.length>0&&i.jsxs("div",{className:"content-section mt-4",children:[i.jsx("h3",{className:"section-title",children:"Previous Orders"}),i.jsx("div",{className:"space-y-4",children:Y.map(ue=>i.jsxs("div",{className:"previous-order-card p-4 border rounded-lg shadow-sm bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"font-semibold text-gray-800",children:["Order Date: ",new Date(ue.date).toLocaleDateString()]}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ue.status==="dispensed"?"bg-green-100 text-green-800":ue.status==="pending"?"bg-yellow-100 text-yellow-800":ue.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:ue.status.charAt(0).toUpperCase()+ue.status.slice(1)})]}),i.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mb-3",children:ue.medications.map((Ae,ke)=>i.jsxs("li",{children:[i.jsx("strong",{children:Ae.name}),": ",Ae.quantity," Qty",Ae.directions_to_use&&` - Directions: ${Ae.directions_to_use}`]},ke))}),ue.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[i.jsx("span",{className:"font-semibold",children:"Prescription for Unavailable:"}),i.jsxs("div",{className:"prose prose-sm max-w-none",children:[" ",i.jsx(xs,{remarkPlugins:[za],children:ue.prescriptionForUnavailableDrugs})]})]}),i.jsxs("button",{type:"button",onClick:()=>Ye(ue),className:"add-previous-meds-button mt-3 px-3 py-1.5 text-sm font-medium rounded-md flex items-center justify-center",children:[i.jsx(tl,{size:16,className:"mr-1"})," Add Medications to Current Order"]})]},ue.id))})]}),!le&&Y.length===0&&t&&i.jsx("div",{className:"content-section text-center py-4 mt-4",children:i.jsx("p",{className:"text-gray-500",children:"No previous orders found for this patient."})}),i.jsxs("div",{className:"mb-4 content-section",children:[i.jsx("label",{htmlFor:"prescription-unavailable",className:"form-label",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-unavailable",rows:3,value:T??"",onChange:ue=>P(ue.target.value||null),placeholder:"Enter prescription details for any drugs that are currently unavailable...",className:"custom-text-input mt-1 w-full"})]}),i.jsxs("div",{className:"mb-4 relative content-section",children:[" ",i.jsx("label",{htmlFor:"drug-search",className:"form-label",children:"Add Medication"})," ",i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search for drug name or type to add custom...",value:f,onChange:ue=>u(ue.target.value),className:"custom-text-input mt-1"}),f&&i.jsxs("div",{className:"drug-search-dropdown mt-1 w-full max-h-60 rounded-md border shadow-lg overflow-auto focus:outline-none sm:text-sm z-20",children:[" ",h.length>0&&i.jsxs("ul",{children:[" ",h.map(ue=>i.jsxs("li",{onClick:()=>Q(ue),className:"cursor-pointer select-none relative",children:[i.jsx("span",{className:"font-medium block truncate",children:ue.name||ue.brand_name}),i.jsxs("span",{className:"drug-stock-price text-xs",children:[" ","(Stock: ",ue.stock??"N/A",", MRP: ",Number(ue.mrp||0).toFixed(2),")"]})]},ue.id))]}),f.trim()&&!a.some(ue=>ue.name&&ue.name.toLowerCase()===f.trim().toLowerCase()||ue.brand_name&&ue.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsxs("div",{onClick:Pe,className:"add-custom-drug-button cursor-pointer text-sm font-medium",role:"button",children:['Add "',f.trim(),'" as new item']}),f.trim()&&h.length===0&&a.some(ue=>ue.name&&ue.name.toLowerCase()===f.trim().toLowerCase()||ue.brand_name&&ue.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsx("p",{className:"text-gray-400 py-2.5 px-4 text-sm",children:"Drug already selected or no new matches."})]})]}),i.jsxs("div",{className:"order-items-section content-section max-h-96 overflow-y-auto",children:[" ",i.jsx("h4",{className:"section-title",children:"Order Items"})," ",l.length===0&&i.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No medications added yet."}),l.length>0&&i.jsx("ul",{className:"space-y-4",children:l.map(ue=>{const Ae=ue.drug_id??ue.name,ke=!ue.drug_id;return i.jsxs("li",{className:"order-item-card text-sm",children:[" ",i.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3",children:[i.jsxs("div",{className:"flex-grow mb-2 md:mb-0",children:[i.jsxs("span",{className:`item-name block text-base ${ke?"custom":""}`,children:[" ",ue.name,ke?" (custom)":""]}),!ke&&ue.pricePerLooseUnit!==void 0&&i.jsxs("span",{className:"item-details text-xs",children:[" ","@ ",(Number(ue.pricePerLooseUnit)||0).toFixed(2)," per loose unit"]}),ue.stock!==void 0&&i.jsxs("span",{className:`item-details text-xs ml-2 ${ue.stock<=10?"item-stock low":""}`,children:[" ","(Stock: ",ue.stock,")"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2",children:[i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-packs-${Ae}`,className:"dosage-label",children:"Packs:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>_e(Ae,(ue.loosePacks??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-packs-${Ae}`,min:"0",value:ue.loosePacks??0,onChange:Se=>{const ve=parseInt(Se.target.value,10);_e(Ae,isNaN(ve)?0:ve)},onFocus:Se=>Se.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>_e(Ae,(ue.loosePacks??0)+1),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-units-${Ae}`,className:"dosage-label",children:"Loose:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>Ke(Ae,(ue.looseUnits??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-units-${Ae}`,min:"0",value:ue.looseUnits??0,onChange:Se=>{const ve=parseInt(Se.target.value,10);Ke(Ae,isNaN(ve)?0:ve)},onFocus:Se=>Se.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>Ke(Ae,(ue.looseUnits??0)+1),className:"quantity-btn",children:"+"})]}),ue.pack&&i.jsxs("span",{className:"ml-2 text-sm text-gray-400",children:["(",ue.pack.split("x")[1]||ue.pack," per pack)"]})]})]}),i.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-3 mt-2 md:mt-0 md:flex-col md:items-end",children:[i.jsxs("div",{className:"w-28 text-right font-semibold",children:[" ","",(Number((ue.pricePerLooseUnit??0)*(ue.looseQuantity??0))||0).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>Le(Ae),className:"remove-item-button p-1.5 -m-1.5 rounded-full",title:"Remove Item",children:i.jsx(Wr,{size:18})})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2 mt-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:`tablets-per-day-${Ae}`,className:"dosage-label",children:"Per Day:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(Se=>Se.map(ve=>ve.drug_id===Ae?{...ve,tabletsPerDay:Math.max(1,(ve.tabletsPerDay??1)-1)}:ve)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`tablets-per-day-${Ae}`,min:"1",value:ue.tabletsPerDay??1,onChange:Se=>{const ve=parseInt(Se.target.value,10);d(X=>X.map(fe=>fe.drug_id===Ae?{...fe,tabletsPerDay:isNaN(ve)?1:Math.max(1,ve)}:fe))},onFocus:Se=>Se.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(Se=>Se.map(ve=>ve.drug_id===Ae?{...ve,tabletsPerDay:(ve.tabletsPerDay??1)+1}:ve)),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`number-of-days-${Ae}`,className:"dosage-label",children:"No. Days:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(Se=>Se.map(ve=>ve.drug_id===Ae?{...ve,numberOfDays:Math.max(1,(ve.numberOfDays??1)-1)}:ve)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`number-of-days-${Ae}`,min:"1",value:ue.numberOfDays??1,onChange:Se=>{const ve=parseInt(Se.target.value,10);d(X=>X.map(fe=>fe.drug_id===Ae?{...fe,numberOfDays:isNaN(ve)?1:Math.max(1,ve)}:fe))},onFocus:Se=>Se.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(Se=>Se.map(ve=>ve.drug_id===Ae?{...ve,numberOfDays:(ve.numberOfDays??1)+1}:ve)),className:"quantity-btn",children:"+"})]})]})]}),i.jsx("div",{className:"flex items-center mt-2",children:ue.pack&&Re(ue.pack)&&i.jsx("span",{className:"ml-4 text-sm text-gray-400",children:(()=>{const Se=Re(ue.pack),ve=ue.looseQuantity??0;if(Se&&Se>0){const X=Math.floor(ve/Se),fe=ve%Se;return`(Subtract: ${X} packs, ${fe} loose)`}return""})()})}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{htmlFor:`directions-${Ae}`,className:"dosage-label",children:"Directions:"}),i.jsx("input",{type:"text",id:`directions-${Ae}`,placeholder:"e.g., 'After food', 'Twice a day'",value:ue.directions_to_use??"",onChange:Se=>{const ve=Se.target.value;d(X=>X.map(fe=>(fe.drug_id??fe.name)===Ae?{...fe,directions_to_use:ve}:fe))},className:"dosage-input text-sm w-full mt-1"})]})]},Ae)})})]}),l.length>0&&i.jsx("div",{className:"mt-6 text-right pr-4",children:i.jsxs("span",{className:"grand-total font-bold",children:[" ","Grand Total: ",Nt]})}),i.jsx("div",{className:"mt-8 flex justify-end",children:i.jsx("button",{type:"submit",disabled:S||l.length===0&&!(T!=null&&T.trim()),className:`submit-order-button inline-flex items-center justify-center text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${S||l.length===0&&!(T!=null&&T.trim())?"":"hover:opacity-90"}`,children:S?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner animate-spin rounded-full h-5 w-5 border-2 mr-3"})," ","Creating Order..."]}):"Create Order"})})]})]})},DA=()=>{const{orderId:e}=Ki(),n=At(),[t,r]=w.useState(null),[a,o]=w.useState(null),[l,d]=w.useState([]),[f,u]=w.useState([]),[h,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,R]=w.useState(null),[z,$]=w.useState(!0),L=w.useCallback(async()=>{$(!0);try{const G=await me(`/api/pharmacy-orders/${e}`);if(!G.ok)throw new Error("Failed to fetch order details");const Y=await G.json();r(Y),o({id:Y.patientId,name:Y.patientName||"N/A",token:Y.patientTokenNumber}),R(Y.prescriptionForUnavailableDrugs);const ne=Y.medications.map(le=>{const oe=B(le.pack),E=le.pack_quantity*(oe??1)+le.loose_quantity;return{...le,isLoose:!0,loosePacks:le.pack_quantity,looseUnits:le.loose_quantity,looseQuantity:E,pack_price:le.pack_price,loose_price:le.loose_price,total_price:le.total_price,pricePerLooseUnit:le.loose_price,originalPrice:le.pack_price,box_number:le.box_number,pack:le.pack,batch:le.batch,expiry_date:le.expiry_date,discount_percentage:le.discount_percentage}});u(ne)}catch(G){k("Could not load order details. "+G.message)}finally{$(!1)}},[e]),U=w.useCallback(async()=>{try{const G=await me("/api/drugs");if(!G.ok)throw new Error("Failed to fetch drugs");const Y=await G.json(),ne=Y.drugs||Y||[];d(ne)}catch(G){k("Could not load drug list. "+G.message)}},[]);w.useEffect(()=>{L(),U()},[L,U]),w.useEffect(()=>{if(!h){v([]);return}const G=h.toLowerCase();v(l.filter(Y=>{const ne=Y.name&&Y.name.toLowerCase().includes(G),le=Y.brand_name&&Y.brand_name.toLowerCase().includes(G);return ne||le}).slice(0,10))},[h,l]);const B=G=>{if(!G)return null;const Y=G.match(/(?:\d+x)?(\d+)/);return Y?parseInt(Y[1],10):null},W=G=>{if(f.some(Y=>Y.drug_id===G.id)){k(`${G.name||G.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}u(Y=>[...Y,{drug_id:G.id,name:G.name||G.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(G.mrp)||0,loose_price:(Number(G.mrp)||0)/(B(G.pack)||1),total_price:(Number(G.mrp)||0)/(B(G.pack)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:G.stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(G.mrp)||0)/(B(G.pack)||1),originalPrice:Number(G.mrp)||0,pack:G.pack}]),g(""),v([])},I=G=>{u(Y=>Y.filter(ne=>(ne.drug_id??ne.name)!==G))},F=(G,Y)=>{u(ne=>ne.map(le=>{if((le.drug_id??le.name)===G&&le.isLoose){const oe=B(le.pack),E=Math.max(0,Y),de=E*(oe??1)+(le.looseUnits??0);return{...le,loosePacks:E,looseQuantity:de,pack_quantity:E}}return le}))},V=(G,Y)=>{u(ne=>ne.map(le=>{if((le.drug_id??le.name)===G&&le.isLoose){const oe=B(le.pack),E=Math.max(0,Y),de=(le.loosePacks??0)*(oe??1)+E;return{...le,looseUnits:E,looseQuantity:de,loose_quantity:E}}return le}))},re=async G=>{if(G.preventDefault(),k(null),P(!0),f.length===0&&!(M!=null&&M.trim())){k("Please add at least one medication or provide a prescription."),P(!1);return}const Y=f.filter(le=>{const oe=le.looseQuantity??0;return oe<=0||le.stock!==void 0&&oe>le.stock});if(Y.length>0){k(`Invalid quantity or insufficient stock for: ${Y.map(le=>le.name).join(", ")}`),P(!1);return}const ne={items:f.map(le=>({drug_id:le.drug_id??null,name:le.name,pack_quantity:le.loosePacks??0,loose_quantity:le.looseUnits??0,pack_price:le.pack_price??0,loose_price:le.loose_price??0,total_price:(le.loose_price??0)*(le.looseQuantity??0),discount_percentage:le.discount_percentage??0,directions_to_use:le.directions_to_use??null,tabletsPerDay:le.tabletsPerDay??1,numberOfDays:le.numberOfDays??1})),prescription_for_unavailable_drugs:M,order_total:ie};try{const le=await me(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ne)});if(!le.ok){const oe=await le.json();throw new Error(oe.message||"Failed to update order")}alert("Pharmacy order updated successfully!"),n(-1)}catch(le){k(le.message||"Failed to update order. Please try again.")}finally{P(!1)}},ie=w.useMemo(()=>f.reduce((G,Y)=>{const ne=Y.loose_price??0,le=Y.looseQuantity??0;return G+ne*le},0),[f]);return z?i.jsx("div",{className:"p-6 flex justify-center items-center h-screen text-gray-500",children:"Loading order details..."}):t?i.jsxs("div",{className:"edit-pharmacy-order-container",children:[i.jsxs("div",{className:"page-header",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(an,{size:20})}),i.jsxs("h2",{className:"page-title",children:["EDIT ORDER ",i.jsxs("span",{className:"text-gray-500 text-lg font-normal ml-2",children:[a==null?void 0:a.name," #",t.id.substring(0,4)]})]})]}),i.jsx("div",{className:"header-right",children:i.jsx("span",{className:"status-badge",children:t.status.toUpperCase()})})]}),i.jsx("div",{className:"order-meta",children:i.jsxs("span",{className:"order-date",children:[" Order Date: ",new Date(t.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})]})}),i.jsxs("form",{onSubmit:re,className:"main-layout",children:[i.jsxs("div",{className:"left-column",children:[i.jsxs("div",{className:"card search-section",children:[i.jsx("div",{className:"card-header",children:i.jsx("h3",{children:" Find & Add Medication"})}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or brand...",value:h,onChange:G=>g(G.target.value),className:"search-input"}),h&&i.jsx("div",{className:"dropdown-results",children:b.length>0?i.jsx("ul",{children:b.map(G=>i.jsxs("li",{onClick:()=>W(G),className:"dropdown-item",children:[i.jsx("span",{className:"drug-name",children:G.name||G.brand_name}),i.jsxs("span",{className:"drug-meta",children:["(Stock: ",G.stock??"N/A",", MRP: ",Number(G.mrp||0).toFixed(2),")"]})]},G.id))}):i.jsxs("div",{className:"p-3 text-gray-500 text-sm",children:['No drugs found matching "',h,'"']})})]})]}),i.jsxs("div",{className:"card medications-list-section",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[" Medications in Order ",i.jsxs("span",{className:"item-count",children:[f.length," items"]})]})}),f.length>0?i.jsxs("div",{className:"table-container",children:[i.jsxs("div",{className:"table-header-row",children:[i.jsx("div",{className:"col-medication",children:"MEDICATION"}),i.jsx("div",{className:"col-directions",children:"DIRECTIONS"}),i.jsx("div",{className:"col-quantity",children:"QUANTITY"}),i.jsx("div",{className:"col-subtotal",children:"SUBTOTAL"}),i.jsx("div",{className:"col-action"})]}),i.jsx("div",{className:"table-body",children:f.map(G=>{const Y=G.drug_id??G.name;return i.jsxs("div",{className:"table-row",children:[i.jsxs("div",{className:"col-medication",children:[i.jsx("span",{className:"med-name",children:G.name}),G.pack&&i.jsx("span",{className:"med-unit text-xs text-gray-500 block",children:G.pack}),i.jsxs("div",{className:"stock-info",children:[" Stock: ",i.jsxs("span",{className:"stock-value",children:[" ",G.stock!==void 0?G.pack?`BOX OF ${B(G.pack)}`:G.stock:"N/A"]})]})]}),i.jsx("div",{className:"col-directions",children:i.jsx("input",{type:"text",placeholder:"1 tablet twice daily...",value:G.directions_to_use??"",onChange:ne=>{const le=ne.target.value;u(oe=>oe.map(E=>(E.drug_id??E.name)===Y?{...E,directions_to_use:le}:E))},className:"directions-input"})}),i.jsx("div",{className:"col-quantity",children:i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"PACKS"}),i.jsx("input",{type:"number",min:"0",value:G.loosePacks??0,onChange:ne=>F(Y,parseInt(ne.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"LOOSE"}),i.jsx("input",{type:"number",min:"0",value:G.looseUnits??0,onChange:ne=>V(Y,parseInt(ne.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]})]})}),i.jsxs("div",{className:"col-subtotal",children:["",(Number((G.pricePerLooseUnit??0)*(G.looseQuantity??0))||0).toFixed(2)]}),i.jsx("div",{className:"col-action",children:i.jsx("button",{type:"button",onClick:()=>I(Y),className:"delete-btn",children:i.jsx(Wr,{size:16})})})]},Y)})})]}):i.jsx("div",{className:"empty-state",children:"No medications added. Search above to add."})]})]}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"card notes-card",children:[i.jsx("div",{className:"card-header border-b-0 pb-2",children:i.jsx("h3",{children:" Prescription Notes"})}),i.jsx("textarea",{rows:3,value:M??"",onChange:G=>R(G.target.value||null),placeholder:"Add notes about unavailable drugs...",className:"notes-input"})]}),i.jsxs("button",{type:"submit",disabled:T,className:"confirm-btn",style:{width:"100%",margin:"20px 0 0 0"},children:[i.jsx("span",{className:"check-icon",children:""})," ",T?"Updating...":"Confirm Changes"]}),S&&i.jsx("div",{className:"error-alert mt-4",children:S})]})]})]}):i.jsx("div",{className:"p-6 text-red-500 flex justify-center items-center h-screen",children:"Order not found or failed to load."})},One=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Lne=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},Fne=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},$ne=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},zne=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},Une=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},Bj=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),qj=()=>{var pe,Ne;const{orderId:e}=Ki(),n=At(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[T,P]=w.useState({}),[M,R]=w.useState(null),[z,$]=w.useState(!1),[L,U]=w.useState(""),[B,W]=w.useState(!1),[I,F]=w.useState(""),V=w.useCallback(async te=>{var K;try{const J=await me(`/api/patients/${te}`);if(!J.ok)throw new Error(`Failed to fetch patient details: ${J.status}`);const ye=await J.json();v(ye.age),k(((K=ye.sex)==null?void 0:K.toLowerCase())==="female"?"female":"male"),ye.phone&&r(He=>He?{...He,Patient:{...He.Patient,phone:ye.phone}}:null)}catch(J){console.error("Error fetching patient details:",J),v(null),k(null)}},[]),re=w.useCallback(async()=>{if(e){d(!0),g(null);try{const te=await me(`/api/lab/${e}`);if(!te.ok){const ye=await te.json().catch(()=>({message:`HTTP error! status: ${te.status}`}));throw new Error(ye.message||`HTTP error! status: ${te.status}`)}const K=await te.json();if(r(K),K.createdAt)try{const ye=new Date(K.createdAt),He=new Date(ye.getTime()-ye.getTimezoneOffset()*6e4).toISOString().slice(0,16);U(He)}catch(ye){console.error("Error formatting date for edit:",ye)}if(K.report_date)try{const ye=new Date(K.report_date),He=new Date(ye.getTime()-ye.getTimezoneOffset()*6e4).toISOString().slice(0,16);F(He)}catch(ye){console.error("Error formatting report date for edit:",ye)}else{const ye=new Date,He=new Date(ye.getTime()-ye.getTimezoneOffset()*6e4).toISOString().slice(0,16);F(He)}K.patient_id&&V(K.patient_id);const J={};if(K.tests&&K.tests.forEach(ye=>{J[ye.id]={},ye.default_parameters&&ye.default_parameters.length>0?ye.default_parameters.forEach(He=>{J[ye.id][He.name]=He.defaultValue}):J[ye.id].report_content=""}),K.report_content)try{const ye=JSON.parse(K.report_content);typeof ye=="object"&&ye!==null&&!Array.isArray(ye)?o(ye):(console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),o(J))}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),o(J)}else o({})}catch(te){console.error("Failed to fetch lab order details:",te),g(te instanceof Error?te.message:"An unknown error occurred while fetching order details.")}finally{d(!1)}}},[e,V]);w.useEffect(()=>{e?re():(g("No Order ID provided in the URL."),d(!1))},[e,re]);const ie=(te,K,J)=>{o(ye=>{var X,fe,Ge,Je,ct,wt,Ht,Ce,be,Fe,Ie,Ve,st,mt,Ct,ln,dn,vn,kt;const He={...ye,[te]:{...ye[te],[K]:J}},Q=parseFloat((X=He[te])==null?void 0:X.Creatinine),Pe=b,Re=S;if(K==="Creatinine"&&!isNaN(Q)&&Pe!==null&&Re!==null){const bt=One(Q,Pe,Re);bt!==null&&((fe=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&fe.default_parameters.find(It=>It.name==="eGFR"))&&(He[te].eGFR=bt)}const Le=parseFloat((Ge=He[te])==null?void 0:Ge["Total Cholesterol"]),_e=parseFloat((Je=He[te])==null?void 0:Je["HDL Cholesterol"]),Ke=parseFloat((ct=He[te])==null?void 0:ct.Triglycerides);if((K==="Total Cholesterol"||K==="HDL Cholesterol"||K==="Triglycerides")&&!isNaN(Le)&&!isNaN(_e)&&!isNaN(Ke)){const bt=Lne(Le,_e,Ke);bt!==null&&((wt=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&wt.default_parameters.find(It=>It.name==="LDL Cholesterol"))&&(He[te]["LDL Cholesterol"]=bt)}const Ye=parseFloat((Ht=He[te])==null?void 0:Ht["Total Bilirubin"]),it=parseFloat((Ce=He[te])==null?void 0:Ce["Direct Bilirubin"]);if((K==="Total Bilirubin"||K==="Direct Bilirubin")&&!isNaN(Ye)&&!isNaN(it)){const bt=Fne(Ye,it);bt!==null&&((be=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&be.default_parameters.find(It=>It.name==="Indirect Bilirubin"))&&(He[te]["Indirect Bilirubin"]=bt)}const xt=parseFloat((Fe=He[te])==null?void 0:Fe["Total Protein"]),Nt=parseFloat((Ie=He[te])==null?void 0:Ie.Albumin);if((K==="Total Protein"||K==="Albumin")&&!isNaN(xt)&&!isNaN(Nt)){const bt=$ne(xt,Nt);bt!==null&&((Ve=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&Ve.default_parameters.find(It=>It.name==="Globulin"))&&(He[te].Globulin=bt)}const ue=parseFloat((st=He[te])==null?void 0:st.Sodium),Ae=parseFloat((mt=He[te])==null?void 0:mt.Chloride),ke=parseFloat((Ct=He[te])==null?void 0:Ct.Bicarbonate);if((K==="Sodium"||K==="Chloride"||K==="Bicarbonate")&&!isNaN(ue)&&!isNaN(Ae)&&!isNaN(ke)){const bt=zne(ue,Ae,ke);bt!==null&&((ln=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&ln.default_parameters.find(It=>It.name==="Anion Gap"))&&(He[te]["Anion Gap"]=bt)}const Se=parseFloat((dn=He[te])==null?void 0:dn.Glucose),ve=parseFloat((vn=He[te])==null?void 0:vn.BUN);if((K==="Sodium"||K==="Glucose"||K==="BUN")&&!isNaN(ue)&&!isNaN(Se)&&!isNaN(ve)){const bt=Une(ue,Se,ve);bt!==null&&((kt=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&kt.default_parameters.find(It=>It.name==="Osmolality"))&&(He[te].Osmolality=bt)}return He})},G=async te=>{const K=a[te]||{},J=t==null?void 0:t.tests.find(Pe=>Pe.id===te);if(!J)return;const ye={};J.default_parameters&&J.default_parameters.forEach(Pe=>{ye[Pe.name]=Pe.defaultValue});const He={...ye,...K},Q={...a,[te]:He};o(Q),u(!0),g(null);try{const Pe=await me(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Q),isPartial:!0})});if(!Pe.ok)throw new Error(`Save failed: ${Pe.status}`);alert(`Report for ${J.name} saved successfully!`)}catch(Pe){console.error("Error saving test report:",Pe),alert("Failed to save test report.")}finally{u(!1)}},Y=(te=null)=>{R(te),setTimeout(()=>{window.print()},100)},ne=()=>{t&&aS(t)},le=async()=>{if(!t||!t.tests){alert("Order details not loaded.");return}if(!e){alert("Cannot submit report without an Order ID.");return}const te={};if(t.tests.forEach(K=>{const J=a[K.id]||{},ye={};K.default_parameters&&K.default_parameters.forEach(He=>{He.defaultValue!==void 0&&He.defaultValue!==null&&(ye[He.name]=He.defaultValue)}),te[K.id]={...ye,...J},(!K.default_parameters||K.default_parameters.length===0)&&!te[K.id].report_content&&(te[K.id].report_content="")}),Object.keys(te).length===0){alert("Report content cannot be empty.");return}o(te),u(!0),g(null);try{const K=await me(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(te)})});if(!K.ok){const J=await K.json().catch(()=>({message:`Submission failed: ${K.status}`}));throw new Error(J.message||`Submission failed: ${K.status}`)}alert("Report submitted successfully!"),n(-1)}catch(K){console.error("Error submitting report:",K),g(K instanceof Error?K.message:"An unknown error occurred during submission.")}finally{u(!1)}},oe=async()=>{if(!(!e||!L))try{const te=await me(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:new Date(L).toISOString()})});if(!te.ok)throw new Error("Failed to update date");const K=await te.json();K.order&&r(J=>J?{...J,createdAt:K.order.createdAt}:null),$(!1)}catch(te){console.error("Failed to update date:",te),alert("Failed to update date")}},E=async()=>{if(!(!e||!I))try{const te=await me(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportDate:new Date(I).toISOString()})});if(!te.ok)throw new Error("Failed to update report date");const K=await te.json();K.order&&r(J=>J?{...J,report_date:K.order.report_date}:null),W(!1)}catch(te){console.error("Failed to update report date:",te),alert("Failed to update report date")}};if(l)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(Gl,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(h&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Ir,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:h}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Zo,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const de=(pe=t==null?void 0:t.Patient)==null?void 0:pe.name,he=(Ne=t==null?void 0:t.Patient)==null?void 0:Ne.patient_token_number;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Enter Lab Report"})," ",i.jsxs("button",{onClick:()=>n(e?"/lab":-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:f,children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),e?"Back to Lab Panel":"Back"]}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginLeft:"10px"},children:[i.jsxs("button",{onClick:()=>Y(null),className:"lab-inventory-button",title:"Print Full Report",children:[i.jsx(Ko,{size:16,style:{marginRight:"5px"}})," Print All"]}),i.jsxs("button",{onClick:ne,className:"lab-inventory-button",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},title:"Share via WhatsApp",children:[i.jsx(Lk,{size:16,style:{marginRight:"5px"}})," WhatsApp"]})]})]}),t&&i.jsxs("div",{className:"lab-inventory-card no-print",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(Zo,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(eo,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",de??"N/A"," (Token: ",he??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(HN,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",z?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:L,onChange:te=>U(te.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:oe,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Date",children:i.jsx(Zx,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if($(!1),t.createdAt){const te=new Date(t.createdAt),K=new Date(te.getTime()-te.getTimezoneOffset()*6e4).toISOString().slice(0,16);U(K)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(bn,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[Fd(new Date(t.createdAt),"PPpp"),i.jsx("button",{onClick:()=>$(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Date",children:i.jsx(t0,{size:14})})]})]}),i.jsxs("div",{children:[i.jsx(HN,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Report Date:"})," ",B?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:I,onChange:te=>F(te.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Report Date",children:i.jsx(Zx,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if(W(!1),t.report_date){const te=new Date(t.report_date),K=new Date(te.getTime()-te.getTimezoneOffset()*6e4).toISOString().slice(0,16);F(K)}else{const te=new Date,K=new Date(te.getTime()-te.getTimezoneOffset()*6e4).toISOString().slice(0,16);F(K)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(bn,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[t.report_date?Fd(new Date(t.report_date),"PPpp"):"Not Reported",i.jsx("button",{onClick:()=>W(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Report Date",children:i.jsx(t0,{size:14})})]})]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(dF,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(te=>te.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:qne(t.status),children:Bne(t.status)})]})]})]}),i.jsxs("div",{className:"lab-inventory-form-group no-print",style:{marginTop:"20px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:"Report Parameters"}),t==null?void 0:t.tests.map(te=>{var K;return i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",margin:0},children:te.name}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsxs("button",{type:"button",onClick:J=>{J.stopPropagation(),G(te.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em"},disabled:f,children:[i.jsx(zd,{size:14,style:{marginRight:"4px"}})," Save"]}),i.jsx("button",{type:"button",onClick:J=>{J.stopPropagation(),Y(te.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em",marginLeft:"5px"},title:"Print This Test Only",children:i.jsx(Ko,{size:14})})]})]}),i.jsx("div",{className:"test-parameters-body",style:{display:"block"},children:te.default_parameters&&te.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{className:"lab-inventory-table",style:{marginTop:"10px",width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9fafb"},children:[i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Parameter"}),i.jsx("th",{style:{width:"35%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Result"}),i.jsx("th",{style:{width:"15%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Units"}),i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Normal Range"})]})}),i.jsx("tbody",{children:te.default_parameters.map(J=>{var ye,He,Q,Pe,Re,Le,_e,Ke,Ye;return i.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#374151",fontWeight:"500"},children:i.jsx("label",{htmlFor:`${te.id}-${J.name}`,style:{cursor:"pointer"},children:J.name})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle"},children:J.type==="boolean"?i.jsxs("select",{id:`${te.id}-${J.name}`,value:((He=(ye=a[te.id])==null?void 0:ye[J.name])==null?void 0:He.toString())??"false",onChange:it=>ie(te.id,J.name,it.target.value==="true"),className:"lab-inventory-input",disabled:f,style:{margin:0,width:"100%"},children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-Reactive"})]}):i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{id:`${te.id}-${J.name}`,type:J.type==="number"?"number":"text",value:((Q=a[te.id])==null?void 0:Q[J.name])!==void 0?(Pe=a[te.id])==null?void 0:Pe[J.name]:J.defaultValue??"",onChange:it=>{const xt=J.type==="number"&&it.target.value===""?"":it.target.value;ie(te.id,J.name,xt)},className:`lab-inventory-input ${J.type==="number"&&((Re=a[te.id])==null?void 0:Re[J.name])!==""&&(J.lower_limit!=null&&parseFloat((Le=a[te.id])==null?void 0:Le[J.name])<J.lower_limit||J.upper_limit!=null&&parseFloat((_e=a[te.id])==null?void 0:_e[J.name])>J.upper_limit)?"abnormal-result":""}`,disabled:f||Bj(J.name)&&!((Ke=T[te.id])!=null&&Ke[J.name]),style:{margin:0,width:"100%"}}),Bj(J.name)&&i.jsx("button",{type:"button",onClick:()=>P(it=>{var xt;return{...it,[te.id]:{...it[te.id]||{},[J.name]:!((xt=it[te.id])!=null&&xt[J.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.7em",padding:"4px 6px",height:"fit-content",whiteSpace:"nowrap"},disabled:f,title:(Ye=T[te.id])!=null&&Ye[J.name]?"Disable Manual Edit":"Edit Calculated Field",children:i.jsx(t0,{size:12})})]})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280"},children:J.unit||"-"}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280",fontSize:"0.9em"},children:J.type==="number"&&(J.lower_limit!==null||J.upper_limit!==null)?i.jsxs(i.Fragment,{children:[J.lower_limit!==null&&J.lower_limit!==void 0&&`> ${J.lower_limit}`,J.lower_limit!==null&&J.lower_limit!==void 0&&J.upper_limit!==null&&J.upper_limit!==void 0&&" - ",J.upper_limit!==null&&J.upper_limit!==void 0&&`< ${J.upper_limit}`]}):"-"})]},J.name)})})]})})}):i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:`${te.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${te.id}-report_content`,value:((K=a[te.id])==null?void 0:K.report_content)??"",onChange:J=>ie(te.id,"report_content",J.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${te.name}...`,disabled:f})]})})]},te.id)}),h&&i.jsxs("p",{className:"error-text",style:{marginTop:"10px"},children:[i.jsx(Ir,{size:15,className:"inline mr-1"}),h]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:f,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:le,disabled:f,className:"lab-inventory-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(Gl,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(zd,{size:16,style:{marginRight:"5px"}})," Submit Full Report"]})})]}),i.jsxs("div",{className:"printable-only",children:[t&&t.Patient&&i.jsxs("div",{style:{marginBottom:"20px",borderBottom:"1px solid #ccc",paddingBottom:"10px"},children:[i.jsx("h2",{style:{textAlign:"center",marginBottom:"15px"},children:"Lab Report"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"12px"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Patient Name:"})," ",t.Patient.name]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age/Sex:"})," ",b??"N/A"," / ",S??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Ref. Doctor:"})," ",t.uploaded_by||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Date:"})," ",Fd(new Date,"PPpp")]})]})]}),t==null?void 0:t.tests.filter(te=>M===null||te.id===M).map(te=>{var K;return i.jsxs("div",{style:{marginBottom:"20px",pageBreakInside:"avoid"},children:[i.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"5px"},children:te.name}),te.default_parameters&&te.default_parameters.length>0?i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9f9f9"},children:[i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Parameter"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Result"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Units"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Normal Range"})]})}),i.jsx("tbody",{children:te.default_parameters.map(J=>{var Le;const ye=(Le=a[te.id])==null?void 0:Le[J.name],He=typeof ye=="string"?parseFloat(ye):typeof ye=="number"?ye:NaN,Q=J.type==="number"&&!isNaN(He)&&ye!==""&&(J.lower_limit!=null&&He<J.lower_limit||J.upper_limit!=null&&He>J.upper_limit),Pe=J.type==="boolean"&&(ye===!0||ye==="true"),Re=J.type==="boolean"?ye===!0||ye==="true"?"Reactive":"Non-Reactive":ye??"";return i.jsxs("tr",{children:[i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:J.name}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee",fontWeight:Q||Pe?"bold":"normal",color:Q?"red":Pe?"green":"inherit"},children:Re}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:J.unit??""}),i.jsxs("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:[J.lower_limit!==null&&J.lower_limit!==void 0&&`> ${J.lower_limit}`,J.lower_limit!==null&&J.lower_limit!==void 0&&J.upper_limit!==null&&J.upper_limit!==void 0&&" - ",J.upper_limit!==null&&J.upper_limit!==void 0&&`< ${J.upper_limit}`]})]},J.name)})})]}):i.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:"12px",padding:"10px"},children:((K=a[te.id])==null?void 0:K.report_content)||"No report content entered."})]},te.id)})]})]})})},Bne=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",qne=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},Vne=()=>{const{orderId:e}=Ki(),n=At(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=w.useCallback(async h=>{if(!h){d("No Order ID specified in the URL."),o(!1),r(null);return}o(!0),d(null),r(null);try{console.log(`Fetching order details for ID: ${h}`);const g=await me(`/api/lab/orders/${h}/report`);if(!g.ok){let v;try{v=await g.json()}catch{v={message:`Server returned status ${g.status}`}}throw console.error("Fetch order details error response:",v),new Error(v.message||`Failed to fetch order details: ${g.status}`)}const b=await g.json();if(console.log("Received order data:",b),!b)throw console.error("Invalid order data structure:",b),new Error("Invalid order data received from server.");r(b)}catch(g){console.error("Error fetching order details:",g),d(g instanceof Error?g.message:"An unknown error occurred while fetching the order details")}finally{o(!1)}},[me]);w.useEffect(()=>{f(e)},[e,f]);const u=()=>{t&&aS(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(bs,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(bi,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(Ko,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:u,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(Lk,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(Ir,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:l}),e&&i.jsx("button",{onClick:()=>f(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(eo,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(lu,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const h=JSON.parse(t.report_content||"{}");return typeof h=="object"&&h!==null&&t.tests?t.tests.map(g=>i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em"},children:g.name}),h[g.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(h[g.id]).map(([b,v])=>{var R;const S=(R=g.default_parameters)==null?void 0:R.find(z=>z.name===b),k=typeof v=="string"?parseFloat(v):typeof v=="number"?v:NaN,T=(S==null?void 0:S.type)==="number"&&!isNaN(k)&&(S.lower_limit!=null&&k<S.lower_limit||S.upper_limit!=null&&k>S.upper_limit),P=(S==null?void 0:S.type)==="boolean"?v===!0||v==="true"?"Reactive":"Non-Reactive":String(v),M=(S==null?void 0:S.type)==="boolean"&&(v===!0||v==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:b}),i.jsxs("td",{className:`${T?"abnormal-result":""} ${M?"reactive-result":""}`,children:[P," ",S==null?void 0:S.unit]}),i.jsx("td",{children:S&&S.type==="number"&&(S.lower_limit!==null||S.upper_limit!==null)?i.jsxs(i.Fragment,{children:[S.lower_limit!=null&&` > ${S.lower_limit}`,S.lower_limit!=null&&S.upper_limit!=null&&" - ",S.upper_limit!=null&&` < ${S.upper_limit}`,S.unit&&` ${S.unit}`]}):((S==null?void 0:S.type)==="boolean","N/A")})]},b)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},g.id)):i.jsx(xs,{remarkPlugins:[za],children:t.report_content})}catch{return i.jsx(xs,{remarkPlugins:[za],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(bs,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},Hne=()=>{const e=At(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[o,l]=w.useState([]),[d,f]=w.useState(null),[u,h]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{h(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[u]);const g=async()=>{const k=n.trim();if(!k){l([]),f(null);return}a(!0),f(null),l([]),console.log(`Searching for: ${k}`);try{const T=await me("/api/lab");if(!T.ok){let L;try{L=await T.json()}catch{L={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",L),new Error(L.message||`HTTP error! status: ${T.status}`)}const{orders:P}=await T.json();console.log("Received lab orders for search:",P);const R=P.filter(L=>!!L.report_content).map(L=>{var U,B;return{id:L.id,labTokenNumber:String(L.lab_token_number??"N/A"),patientName:((U=L.Patient)==null?void 0:U.name)||"N/A",patientId:L.patient_id,patientTokenNumber:String(((B=L.Patient)==null?void 0:B.patient_token_number)??"N/A"),tests:(L.tests||[]).map(W=>W.name||"Unknown Test"),date:Fd(new Date(L.createdAt),"yyyy-MM-dd"),status:L.status}}),z=n.toLowerCase(),$=R.filter(L=>{var W,I,F,V,re;const U=String(L.labTokenNumber).toLowerCase(),B=String(L.patientTokenNumber).toLowerCase();return(((W=L.patientName)==null?void 0:W.toLowerCase())||"").includes(z)||U.includes(z)||B.includes(z)||(((F=(I=L.tests)==null?void 0:I.join(" "))==null?void 0:F.toLowerCase())||"").includes(z)||(((V=L.id)==null?void 0:V.toLowerCase())||"").includes(z)||(((re=L.patientId)==null?void 0:re.toLowerCase())||"").includes(z)});console.log("Filtered search results:",$),l($),$.length===0&&k?f(`No matching reports found for "${k}".`):f(null)}catch(T){console.error("Failed to search lab reports:",T),f(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(bi,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),d&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(Ir,{size:20,className:"inline mr-2"})," ",d]}),o.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:o.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(U3,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:S(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(lu,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(c6,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(T3,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&o.length===0&&!d&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&o.length===0&&!d&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},Gne=()=>{const{patientId:e}=Ki(),n=At(),[t,r]=w.useState([]),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID is missing from the URL."),o(!1);return}o(!0),d(null),r([]),g(null);try{const S=await me(`/api/patients/${e}`);if(S.ok){const P=await S.json();g(P.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await me(`/api/lab/patient/${e}`);if(!k.ok){const P=await k.json().catch(()=>({}));throw new Error(P.message||`HTTP error! status: ${k.status}`)}const T=await k.json();r(T||[])}catch(S){console.error("Error fetching data:",S),d(`Failed to load data: ${S.message}`)}finally{o(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",h?`for ${h}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await me("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(Ua,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(Gl,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(f6,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:l})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(lu,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(bs,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):f?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",f.report_date?Fd(new Date(f.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>u(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(an,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(f.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(xs,{remarkPlugins:[za],children:f.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(lu,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Fd(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:Wne(v.status),children:Yne(v.status)}),i.jsx(Gd,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},Yne=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},Wne=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},IA=()=>{const e=At(),[n,t]=w.useState("pharmacy");return i.jsxs("div",{className:"inventory-management-container",style:{padding:"20px",backgroundColor:"var(--background-color)",minHeight:"100vh"},children:[i.jsxs("div",{className:"inventory-header",style:{marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)"},children:i.jsx(an,{size:24})}),i.jsx("h1",{style:{margin:0,fontSize:"1.8rem",fontWeight:"700",color:"var(--text-primary)"},children:"Inventory Management"})]}),i.jsxs("div",{className:"inventory-tabs",style:{display:"flex",gap:"5px",backgroundColor:"var(--card-bg, #f3f4f6)",padding:"5px",borderRadius:"12px",border:"1px solid var(--border-color, #e5e7eb)"},children:[i.jsxs("button",{onClick:()=>t("pharmacy"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="pharmacy"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="pharmacy"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="pharmacy"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="pharmacy"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="pharmacy"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(lg,{size:18}),"Pharmacy Stock"]}),i.jsxs("button",{onClick:()=>t("lab"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="lab"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="lab"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="lab"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="lab"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="lab"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(Hl,{size:18}),"Lab Stock"]})]})]}),i.jsx("div",{className:"inventory-content",style:{backgroundColor:"var(--card-bg, #fff)",borderRadius:"16px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden"},children:n==="pharmacy"?i.jsx(kE,{isEmbedded:!0}):i.jsx(iS,{isEmbedded:!0})})]})},Qne=({fetchWithAuth:e})=>{const n=At(),[t,r]=w.useState(!0),[a,o]=w.useState([]),[l,d]=w.useState(null),[f,u]=w.useState(null),h=w.useCallback(async()=>{r(!0),d(null);try{const S=await(await e("/staff")).json();o(S.map(k=>({...k,id:k._id||k.id})))}catch(v){d(`Failed to load staff data: ${v.message}`),o([])}finally{r(!1)}},[e]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{if(f){const v=setTimeout(()=>u(null),5e3);return()=>clearTimeout(v)}},[f]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return i.jsx(Fk,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return i.jsx(_w,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return i.jsx(lg,{size:16,className:"mr-2 text-purple-600"});case"lab":return i.jsx(Hl,{size:16,className:"mr-2 text-yellow-600"});case"admin":return i.jsx(Db,{size:16,className:"mr-2 text-teal-600"});default:return i.jsx(Gh,{size:16,className:"mr-2 text-gray-500"})}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",i.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[f&&i.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${f.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[f.type==="success"?i.jsx(vs,{size:18,className:"mr-2"}):i.jsx(Ir,{size:18,className:"mr-2"}),i.jsx("span",{children:f.message}),i.jsx("button",{onClick:()=>u(null),className:"ml-auto text-xl font-bold",children:""})]}),l&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[i.jsx(Ir,{size:18,className:"mr-2 text-red-500"}),l,i.jsx("button",{onClick:()=>d(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(an,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[i.jsx(tl,{size:16,className:"mr-2"})," Add New Staff"]})]}),i.jsx("div",{className:"staff-table-container",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),i.jsx("th",{className:"hidden md:table-cell",children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:a.length===0&&!t?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>i.jsxs("tr",{children:[i.jsx("td",{children:v.name}),i.jsx("td",{className:"hidden md:table-cell",children:v.email}),i.jsx("td",{children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),i.jsx("td",{className:"hidden md:table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"actions",children:i.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[i.jsx(Yl,{size:16})," Edit"]})})]},v.id))})]})})]})},Jne=()=>{var k,T,P,M,R,z,$,L,U,B,W,I,F,V;const{patientId:e,billId:n}=Ki(),t=At(),[r,a]=w.useState(null),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,h]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),f(null);try{const ie=await me(`/api/bills/${n}`);if(!ie.ok)throw new Error(`HTTP error! status: ${ie.status}`);const G=await ie.json();if(!G||!G.bill||!G.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(G.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",G.bill.type),new Error(`Unexpected bill type received: ${G.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(G,null,2));const Y=Array.isArray(G.admissionPayments)?G.admissionPayments:[];console.log("Processed admissionPaymentsData:",Y);const ne={...G.bill,amount:G.bill.amount,AdmissionPayments:Y,calculated:G.calculated,patient:G.bill.Patient?{id:G.bill.Patient.id,name:G.bill.Patient.name,admission_date:G.bill.Patient.admission_date,discharge_date:G.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(ne,null,2)),a(ne)}catch(ie){console.error("Failed to fetch admission bill details:",ie),f(ie instanceof Error?ie.message:"An unknown error occurred")}finally{l(!1)}})():(f("Bill ID is missing."),l(!1))},[n,e]);const S=async re=>{var ie;if(re.preventDefault(),!e||!u||isNaN(parseFloat(u))||parseFloat(u)<=0||parseFloat(u)>(((ie=r==null?void 0:r.calculated)==null?void 0:ie.balance)??0)){f("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}f(null);try{const G=await me(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(u),payment_mode:g})});if(!G.ok){const le=await G.json();throw new Error(le.message||`HTTP error! status: ${G.status}`)}const ne=await(await me(`/api/bills/${n}`)).json();if(ne&&ne.bill&&ne.calculated&&ne.admissionPayments)a({...ne.bill,amount:parseFloat(ne.bill.amount),AdmissionPayments:ne.admissionPayments,calculated:ne.calculated,patient:ne.bill.Patient?{id:ne.bill.Patient.id,name:ne.bill.Patient.name,admission_date:ne.bill.Patient.admission_date,discharge_date:ne.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");h("")}catch(G){console.error("Failed to submit payment:",G),f(G instanceof Error?G.message:"Failed to record payment")}};return o?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):d?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",d]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=r.patient)==null?void 0:T.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(P=r.patient)!=null&&P.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((M=r.patient)==null?void 0:M.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((R=r.status)==null?void 0:R.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((z=r==null?void 0:r.calculated)==null?void 0:z.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number(($=r==null?void 0:r.calculated)==null?void 0:$.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number((L=r==null?void 0:r.calculated)==null?void 0:L.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((U=r==null?void 0:r.calculated)==null?void 0:U.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((B=r==null?void 0:r.calculated)==null?void 0:B.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:u,onChange:re=>h(re.target.value),placeholder:`Max ${(Number((W=r==null?void 0:r.calculated)==null?void 0:W.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((I=r==null?void 0:r.calculated)==null?void 0:I.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:re=>b(re.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:o||!u||parseFloat(u)<=0||parseFloat(u)>(Number((F=r==null?void 0:r.calculated)==null?void 0:F.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(V=r==null?void 0:r.AdmissionPayments)==null?void 0:V.map(re=>{if(!re||typeof re!="object")return null;let ie="Invalid Date";try{re.payment_date&&!isNaN(new Date(re.payment_date).getTime())&&(ie=new Date(re.payment_date).toLocaleString())}catch(G){console.error("Error formatting payment date:",re.payment_date,G)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:re.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ie}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(re.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:re.payment_mode??"N/A"})]},re.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var Kne=Object.defineProperty,vb=Object.getOwnPropertySymbols,RA=Object.prototype.hasOwnProperty,MA=Object.prototype.propertyIsEnumerable,Vj=(e,n,t)=>n in e?Kne(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,lw=(e,n)=>{for(var t in n||(n={}))RA.call(n,t)&&Vj(e,t,n[t]);if(vb)for(var t of vb(n))MA.call(n,t)&&Vj(e,t,n[t]);return e},cw=(e,n)=>{var t={};for(var r in e)RA.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&vb)for(var r of vb(e))n.indexOf(r)<0&&MA.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Vd;(e=>{const n=class gn{constructor(f,u,h,g){if(this.version=f,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],f<gn.MIN_VERSION||f>gn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(h);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<S&&(g=k,S=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,u){const h=e.QrSegment.makeSegments(f);return gn.encodeSegments(h,u)}static encodeBinary(f,u){const h=e.QrSegment.makeBytes(f);return gn.encodeSegments([h],u)}static encodeSegments(f,u,h=1,g=40,b=-1,v=!0){if(!(gn.MIN_VERSION<=h&&h<=g&&g<=gn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=h;;S++){const R=gn.getNumDataCodewords(S,u)*8,z=l.getTotalBits(f,S);if(z<=R){k=z;break}if(S>=g)throw new RangeError("Data too long")}for(const R of[gn.Ecc.MEDIUM,gn.Ecc.QUARTILE,gn.Ecc.HIGH])v&&k<=gn.getNumDataCodewords(S,R)*8&&(u=R);let T=[];for(const R of f){t(R.mode.modeBits,4,T),t(R.numChars,R.mode.numCharCountBits(S),T);for(const z of R.getData())T.push(z)}a(T.length==k);const P=gn.getNumDataCodewords(S,u)*8;a(T.length<=P),t(0,Math.min(4,P-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let R=236;T.length<P;R^=253)t(R,8,T);let M=[];for(;M.length*8<T.length;)M.push(0);return T.forEach((R,z)=>M[z>>>3]|=R<<7-(z&7)),new gn(S,u,M,b)}getModule(f,u){return 0<=f&&f<this.size&&0<=u&&u<this.size&&this.modules[u][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),u=f.length;for(let h=0;h<u;h++)for(let g=0;g<u;g++)h==0&&g==0||h==0&&g==u-1||h==u-1&&g==0||this.drawAlignmentPattern(f[h],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const u=this.errorCorrectionLevel.formatBits<<3|f;let h=u;for(let b=0;b<10;b++)h=h<<1^(h>>>9)*1335;const g=(u<<10|h)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let h=0;h<12;h++)f=f<<1^(f>>>11)*7973;const u=this.version<<12|f;a(u>>>18==0);for(let h=0;h<18;h++){const g=r(u,h),b=this.size-11+h%3,v=Math.floor(h/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(f,u){for(let h=-4;h<=4;h++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(h)),v=f+g,S=u+h;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(f,u){for(let h=-2;h<=2;h++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,u+h,Math.max(Math.abs(g),Math.abs(h))!=1)}setFunctionModule(f,u,h){this.modules[u][f]=h,this.isFunction[u][f]=!0}addEccAndInterleave(f){const u=this.version,h=this.errorCorrectionLevel;if(f.length!=gn.getNumDataCodewords(u,h))throw new RangeError("Invalid argument");const g=gn.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][u],b=gn.ECC_CODEWORDS_PER_BLOCK[h.ordinal][u],v=Math.floor(gn.getNumRawDataModules(u)/8),S=g-v%g,k=Math.floor(v/g);let T=[];const P=gn.reedSolomonComputeDivisor(b);for(let R=0,z=0;R<g;R++){let $=f.slice(z,z+k-b+(R<S?0:1));z+=$.length;const L=gn.reedSolomonComputeRemainder($,P);R<S&&$.push(0),T.push($.concat(L))}let M=[];for(let R=0;R<T[0].length;R++)T.forEach((z,$)=>{(R!=k-b||$>=S)&&M.push(z[R])});return a(M.length==v),M}drawCodewords(f){if(f.length!=Math.floor(gn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=h-b,k=(h+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&u<f.length*8&&(this.modules[k][v]=r(f[u>>>3],7-(u&7)),u++)}}a(u==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let h=0;h<this.size;h++){let g;switch(f){case 0:g=(h+u)%2==0;break;case 1:g=u%2==0;break;case 2:g=h%3==0;break;case 3:g=(h+u)%3==0;break;case 4:g=(Math.floor(h/3)+Math.floor(u/2))%2==0;break;case 5:g=h*u%2+h*u%3==0;break;case 6:g=(h*u%2+h*u%3)%2==0;break;case 7:g=((h+u)%2+h*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][h]&&g&&(this.modules[u][h]=!this.modules[u][h])}}getPenaltyScore(){let f=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(S++,S==5?f+=gn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*gn.PENALTY_N3),v=this.modules[b][T],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*gn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(S++,S==5?f+=gn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*gn.PENALTY_N3),v=this.modules[T][b],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*gn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(f+=gn.PENALTY_N2)}let u=0;for(const b of this.modules)u=b.reduce((v,S)=>v+(S?1:0),u);const h=this.size*this.size,g=Math.ceil(Math.abs(u*20-h*10)/h)-1;return a(0<=g&&g<=9),f+=g*gn.PENALTY_N4,a(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let h=[6];for(let g=this.size-7;h.length<f;g-=u)h.splice(1,0,g);return h}}static getNumRawDataModules(f){if(f<gn.MIN_VERSION||f>gn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*f+128)*f+64;if(f>=2){const h=Math.floor(f/7)+2;u-=(25*h-10)*h-55,f>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(f,u){return Math.floor(gn.getNumRawDataModules(f)/8)-gn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][f]*gn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let u=[];for(let g=0;g<f-1;g++)u.push(0);u.push(1);let h=1;for(let g=0;g<f;g++){for(let b=0;b<u.length;b++)u[b]=gn.reedSolomonMultiply(u[b],h),b+1<u.length&&(u[b]^=u[b+1]);h=gn.reedSolomonMultiply(h,2)}return u}static reedSolomonComputeRemainder(f,u){let h=u.map(g=>0);for(const g of f){const b=g^h.shift();h.push(0),u.forEach((v,S)=>h[S]^=gn.reedSolomonMultiply(v,b))}return h}static reedSolomonMultiply(f,u){if(f>>>8||u>>>8)throw new RangeError("Byte out of range");let h=0;for(let g=7;g>=0;g--)h=h<<1^(h>>>7)*285,h^=(u>>>g&1)*f;return a(h>>>8==0),h}finderPenaltyCountPatterns(f){const u=f[1];a(u<=this.size*3);const h=u>0&&f[2]==u&&f[3]==u*3&&f[4]==u&&f[5]==u;return(h&&f[0]>=u*4&&f[6]>=u?1:0)+(h&&f[6]>=u*4&&f[0]>=u?1:0)}finderPenaltyTerminateAndCount(f,u,h){return f&&(this.finderPenaltyAddHistory(u,h),u=0),u+=this.size,this.finderPenaltyAddHistory(u,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(f,u){u[0]==0&&(f+=this.size),u.pop(),u.unshift(f)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(d,f,u){if(f<0||f>31||d>>>f)throw new RangeError("Value out of range");for(let h=f-1;h>=0;h--)u.push(d>>>h&1)}function r(d,f){return(d>>>f&1)!=0}function a(d){if(!d)throw new Error("Assertion error")}const o=class Cr{constructor(f,u,h){if(this.mode=f,this.numChars=u,this.bitData=h,u<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(f){let u=[];for(const h of f)t(h,8,u);return new Cr(Cr.Mode.BYTE,f.length,u)}static makeNumeric(f){if(!Cr.isNumeric(f))throw new RangeError("String contains non-numeric characters");let u=[];for(let h=0;h<f.length;){const g=Math.min(f.length-h,3);t(parseInt(f.substring(h,h+g),10),g*3+1,u),h+=g}return new Cr(Cr.Mode.NUMERIC,f.length,u)}static makeAlphanumeric(f){if(!Cr.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],h;for(h=0;h+2<=f.length;h+=2){let g=Cr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h))*45;g+=Cr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h+1)),t(g,11,u)}return h<f.length&&t(Cr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h)),6,u),new Cr(Cr.Mode.ALPHANUMERIC,f.length,u)}static makeSegments(f){return f==""?[]:Cr.isNumeric(f)?[Cr.makeNumeric(f)]:Cr.isAlphanumeric(f)?[Cr.makeAlphanumeric(f)]:[Cr.makeBytes(Cr.toUtf8ByteArray(f))]}static makeEci(f){let u=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)t(f,8,u);else if(f<16384)t(2,2,u),t(f,14,u);else if(f<1e6)t(6,3,u),t(f,21,u);else throw new RangeError("ECI assignment value out of range");return new Cr(Cr.Mode.ECI,0,u)}static isNumeric(f){return Cr.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return Cr.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,u){let h=0;for(const g of f){const b=g.mode.numCharCountBits(u);if(g.numChars>=1<<b)return 1/0;h+=4+b+g.bitData.length}return h}static toUtf8ByteArray(f){f=encodeURI(f);let u=[];for(let h=0;h<f.length;h++)f.charAt(h)!="%"?u.push(f.charCodeAt(h)):(u.push(parseInt(f.substring(h+1,h+3),16)),h+=2);return u}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=o;e.QrSegment=o})(Vd||(Vd={}));(e=>{(n=>{const t=class{constructor(a,o){this.ordinal=a,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(Vd||(Vd={}));(e=>{(n=>{const t=class{constructor(a,o){this.modeBits=a,this.numBitsCharCount=o}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Vd||(Vd={}));var Ah=Vd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Xne={L:Ah.QrCode.Ecc.LOW,M:Ah.QrCode.Ecc.MEDIUM,Q:Ah.QrCode.Ecc.QUARTILE,H:Ah.QrCode.Ecc.HIGH},OA=128,LA="L",FA="#FFFFFF",$A="#000000",zA=!1,UA=1,Zne=4,ere=0,tre=.1;function BA(e,n=0){const t=[];return e.forEach(function(r,a){let o=null;r.forEach(function(l,d){if(!l&&o!==null){t.push(`M${o+n} ${a+n}h${d-o}v1H${o+n}z`),o=null;return}if(d===r.length-1){if(!l)return;o===null?t.push(`M${d+n},${a+n} h1v1H${d+n}z`):t.push(`M${o+n},${a+n} h${d+1-o}v1H${o+n}z`);return}l&&o===null&&(o=d)})}),t.join("")}function qA(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,o)=>o<n.x||o>=n.x+n.w?a:!1))}function nre(e,n,t,r){if(r==null)return null;const a=e.length+t*2,o=Math.floor(n*tre),l=a/n,d=(r.width||o)*l,f=(r.height||o)*l,u=r.x==null?e.length/2-d/2:r.x*l,h=r.y==null?e.length/2-f/2:r.y*l,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let S=Math.floor(u),k=Math.floor(h),T=Math.ceil(d+u-S),P=Math.ceil(f+h-k);b={x:S,y:k,w:T,h:P}}const v=r.crossOrigin;return{x:u,y:h,h:f,w:d,excavation:b,opacity:g,crossOrigin:v}}function rre(e,n){return n!=null?Math.max(Math.floor(n),0):e?Zne:ere}function VA({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:o,size:l,boostLevel:d}){let f=kn.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(...Ah.QrSegment.makeSegments(T)),k),[]);return Ah.QrCode.encodeSegments(S,Xne[n],t,void 0,void 0,d)},[e,n,t,d]);const{cells:u,margin:h,numCells:g,calculatedImageSettings:b}=kn.useMemo(()=>{let v=f.getModules();const S=rre(r,a),k=v.length+S*2,T=nre(v,l,S,o);return{cells:v,margin:S,numCells:k,calculatedImageSettings:T}},[f,l,o,r,a]);return{qrcode:f,margin:h,cells:u,numCells:g,calculatedImageSettings:b}}var ire=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Uh=kn.forwardRef(function(n,t){const r=n,{value:a,size:o=OA,level:l=LA,bgColor:d=FA,fgColor:f=$A,includeMargin:u=zA,minVersion:h=UA,boostLevel:g,marginSize:b,imageSettings:v}=r,k=cw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,P=cw(k,["style"]),M=v==null?void 0:v.src,R=kn.useRef(null),z=kn.useRef(null),$=kn.useCallback(ie=>{R.current=ie,typeof t=="function"?t(ie):t&&(t.current=ie)},[t]),[L,U]=kn.useState(!1),{margin:B,cells:W,numCells:I,calculatedImageSettings:F}=VA({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:u,marginSize:b,imageSettings:v,size:o});kn.useEffect(()=>{if(R.current!=null){const ie=R.current,G=ie.getContext("2d");if(!G)return;let Y=W;const ne=z.current,le=F!=null&&ne!==null&&ne.complete&&ne.naturalHeight!==0&&ne.naturalWidth!==0;le&&F.excavation!=null&&(Y=qA(W,F.excavation));const oe=window.devicePixelRatio||1;ie.height=ie.width=o*oe;const E=o/I*oe;G.scale(E,E),G.fillStyle=d,G.fillRect(0,0,I,I),G.fillStyle=f,ire?G.fill(new Path2D(BA(Y,B))):W.forEach(function(de,he){de.forEach(function(D,pe){D&&G.fillRect(pe+B,he+B,1,1)})}),F&&(G.globalAlpha=F.opacity),le&&G.drawImage(ne,F.x+B,F.y+B,F.w,F.h)}}),kn.useEffect(()=>{U(!1)},[M]);const V=lw({height:o,width:o},T);let re=null;return M!=null&&(re=kn.createElement("img",{src:M,key:M,style:{display:"none"},onLoad:()=>{U(!0)},ref:z,crossOrigin:F==null?void 0:F.crossOrigin})),kn.createElement(kn.Fragment,null,kn.createElement("canvas",lw({style:V,height:o,width:o,ref:$,role:"img"},P)),re)});Uh.displayName="QRCodeCanvas";var are=kn.forwardRef(function(n,t){const r=n,{value:a,size:o=OA,level:l=LA,bgColor:d=FA,fgColor:f=$A,includeMargin:u=zA,minVersion:h=UA,boostLevel:g,title:b,marginSize:v,imageSettings:S}=r,k=cw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:P,numCells:M,calculatedImageSettings:R}=VA({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:u,marginSize:v,imageSettings:S,size:o});let z=P,$=null;S!=null&&R!=null&&(R.excavation!=null&&(z=qA(P,R.excavation)),$=kn.createElement("image",{href:S.src,height:R.h,width:R.w,x:R.x+T,y:R.y+T,preserveAspectRatio:"none",opacity:R.opacity,crossOrigin:R.crossOrigin}));const L=BA(z,T);return kn.createElement("svg",lw({height:o,width:o,viewBox:`0 0 ${M} ${M}`,ref:t,role:"img"},k),!!b&&kn.createElement("title",null,b),kn.createElement("path",{fill:d,d:`M0,0 h${M}v${M}H0z`,shapeRendering:"crispEdges"}),kn.createElement("path",{fill:f,d:L,shapeRendering:"crispEdges"}),$)});are.displayName="QRCodeSVG";const sre=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},ore=()=>{const{orderId:e}=Ki(),n=At(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[h,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,P]=w.useState("cash"),M=w.useMemo(()=>(t==null?void 0:t.medications.reduce((F,V)=>{const re=V.total_price??0,ie=re*(V.discount_percentage??0)/100;return F+re-ie},0))??0,[t==null?void 0:t.medications]),R=5,z=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce((F,V,re)=>{var oe,E;const ie=V.drug_id??`index-${re}`,G=((oe=h[ie])==null?void 0:oe.pack)||0,Y=((E=h[ie])==null?void 0:E.loose)||0,ne=V.pack_price??0,le=V.loose_price??0;return F+G*ne+Y*le},0),[t,h]),$=w.useCallback(async()=>{if(!e){d("Order ID is missing."),o(!1);return}o(!0),d(null);try{const F=await me(`/api/pharmacy-orders/${e}`);if(!F.ok)throw F.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${F.statusText} (${F.status})`);const V=await F.json();console.log("Fetched order data after return:",V);const ie=V.medications.map(Y=>Y.pack_price&&Y.loose_price&&Y.loose_price>0?{...Y,unitsPerPack:Math.round(Y.pack_price/Y.loose_price)}:{...Y,unitsPerPack:0}).map(Y=>({...Y,discount_percentage:Y.discount_percentage??0}));r({...V,medications:ie});const G={};ie.forEach((Y,ne)=>{const le=Y.drug_id??`index-${ne}`;G[le]={pack:0,loose:0}}),g(G)}catch(F){console.error("Failed to fetch order details:",F),d(F.message||"Failed to load order details.")}finally{o(!1)}},[e]);w.useEffect(()=>{$()},[$]),w.useEffect(()=>{(async()=>{try{const V=await me("/api/clinics/settings");if(!V.ok)throw new Error("Failed to fetch clinic settings");const re=await V.json();console.log("Fetched clinic settings:",re),v(re.upi_id||"")}catch(V){console.error("Error fetching clinic settings:",V)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const F=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k(F)}else k("")},[t==null?void 0:t.order_total,b]);const L=(F,V)=>{r(re=>{if(!re)return null;const ie=re.medications.map((Y,ne)=>(Y.drug_id??`index-${ne}`)===F?{...Y,discount_percentage:isNaN(V)?0:V}:Y),G=ie.reduce((Y,ne)=>{const le=ne.total_price??0,oe=le*(ne.discount_percentage??0)/100;return Y+le-oe},0);return{...re,medications:ie,order_total:G}})},U=(F,V,re)=>{g(ie=>{const G=re.unitsPerPack||0,ne=re.pack_quantity*G+re.loose_quantity,le=Math.max(0,Math.min(V,ne));let oe=0,E=le;return G>0&&(oe=Math.floor(le/G),E=le%G),{...ie,[F]:{pack:oe,loose:E}}})},B=async()=>{const F=t==null?void 0:t.medications.map((V,re)=>{var ne,le;const ie=V.drug_id??`index-${re}`,G=((ne=h[ie])==null?void 0:ne.pack)||0,Y=((le=h[ie])==null?void 0:le.loose)||0;return G>0||Y>0?{drug_id:V.drug_id,name:V.name,pack_quantity:V.pack_quantity,loose_quantity:V.loose_quantity,returnPackQuantity:G,returnLooseQuantity:Y}:null}).filter(V=>V!==null);if(!F||F.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!F){alert("Could not prepare items for return.");return}u(!0),d(null);try{const V=await me(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:F})}),re=await V.json();if(!V.ok)throw new Error(re.message||`Failed to process return: ${V.statusText}`);alert("Return processed successfully! Stock has been updated.");const ie={};t==null||t.medications.forEach((G,Y)=>{const ne=G.drug_id??`index-${Y}`;ie[ne]={pack:0,loose:0}}),g(ie),$()}catch(V){console.error("Failed to process return:",V),d(V.message||"An error occurred while processing the return."),alert(`Error processing return: ${V.message||"Unknown error"}`)}finally{u(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(an,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(an,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const W=()=>{window.print()},I=sre(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(an,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:W,className:"print-button",children:[i.jsx(Ko,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${I.text} ${I.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map((F,V)=>{var oe,E,de,he,D,pe;const re=F.drug_id??`index-${V}`,ie=F.total_price??0,G=ie*(F.discount_percentage??0)/100,Y=ie-G,ne=((oe=h[re])==null?void 0:oe.pack)||0,le=((E=h[re])==null?void 0:E.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:F.name}),i.jsx("td",{children:F.pack_quantity??0}),i.jsx("td",{children:((de=F.pack_price)==null?void 0:de.toFixed(2))??"N/A"}),i.jsx("td",{children:F.loose_quantity??0}),i.jsx("td",{children:((he=F.loose_price)==null?void 0:he.toFixed(2))??"N/A"}),i.jsx("td",{children:((D=F.price)==null?void 0:D.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((pe=F.price)==null?void 0:pe.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:F.discount_percentage??0,onChange:Ne=>L(re,parseFloat(Ne.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[F.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[R.toFixed(1),"%"]}),i.jsx("td",{children:Y.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:F.pack_quantity,value:ne,onChange:Ne=>{const K=(parseInt(Ne.target.value,10)||0)*(F.unitsPerPack||0)+le;U(re,K,F)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:F.loose_quantity+F.pack_quantity*(F.unitsPerPack||0)-ne*(F.unitsPerPack||0),value:le,onChange:Ne=>{const te=parseInt(Ne.target.value,10)||0,K=ne*(F.unitsPerPack||0)+te;U(re,K,F)},className:"return-quantity-input"})})]})]},re)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",M.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",M.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:T,onChange:F=>P(F.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Uh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[z>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",z.toFixed(2)]}),i.jsx("button",{onClick:B,disabled:Object.values(h).every(F=>F.pack===0&&F.loose===0)||f,className:"process-return-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(v1,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(v1,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},lre=async()=>{const e=await me("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},cre=async e=>{const n=await me(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},ure=async e=>{const n=await me("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},dre=async(e,n)=>{const t=await me(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},fre=async e=>{const n=await me(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},hre=async(e,n)=>{const t=await me("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},pre=()=>{const e=At(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await lre();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const h=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await fre(g),f({type:"success",message:"Plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(vs,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ir,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(bn,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(tl,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Yl,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Wr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},mre=()=>{const e=At(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await ure(n),f({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(vs,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ir,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(bn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},gre=()=>{const{id:e}=Ki(),n=At(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await cre(e);r(M),o({name:M.name,description:M.description||"",price:M.price,period:M.period,interval:M.interval,razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:R,value:z}=M.target;o($=>({...$,[R]:z}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await dre(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(R){const z=R.message||"Failed to update plan.";g(z),v({type:"error",message:z})}finally{d(!1)}},P=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(vs,{size:18,className:"mr-2"}):i.jsx(Ir,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(bn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},yre=()=>{const{patientId:e}=Ki(),n=At(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=w.useCallback(async()=>{u(!0),g(null);try{const $=await me(`/api/patients/${e}`);if(!$.ok){const W=await $.json();throw new Error(W.message||"Failed to fetch patient details")}const L=await $.json();r(L);const U=await me("/api/subscriptions");if(!U.ok){const W=await U.json();throw new Error(W.message||"Failed to fetch subscription plans")}const B=await U.json();o(B.filter(W=>W.status==="active"))}catch($){console.error("Error fetching data:",$),g(`Failed to load data: ${$.message}`)}finally{u(!1)}},[e]);w.useEffect(()=>{e?M():(g("Patient ID is missing."),u(!1))},[e,M]);const R=($,L)=>{const U=new Date($),B=L.interval||1;switch(L.period){case"daily":U.setDate($.getDate()+B);break;case"weekly":U.setDate($.getDate()+B*7);break;case"monthly":U.setMonth($.getMonth()+B);break;case"yearly":U.setFullYear($.getFullYear()+B);break;default:console.warn(`Unknown subscription period: ${L.period}. Defaulting to 1 month.`),U.setMonth($.getMonth()+1)}return U},z=async()=>{if(!e||!l){P("Please select a subscription plan.");return}const $=a.find(L=>L.id===l);if(!$){P("Selected plan details not found.");return}k(!0),P(null);try{const L=new Date,U=R(L,$);if(b==="manual"){const B={subscription_plan_id:l,subscription_status:"active",subscription_start_date:L.toISOString(),subscription_end_date:U.toISOString(),subscription_payment_method:"manual"},W=await me(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(!W.ok){const I=await W.json();throw new Error(I.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",$);const B=await hre(e,l);if(B&&B.short_url)window.location.href=B.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch(L){console.error("Error starting subscription:",L),P(`Failed to start subscription: ${L.message}`),k(!1)}};return f?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):h?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:h})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(eo,{size:28})," ","Start Subscription for ",t.name]}),T&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:T})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map($=>i.jsxs("div",{className:`subscription-plan-card ${l===$.id?"selected-plan":""}`,onClick:()=>d($.id),children:[i.jsx("h3",{children:$.name}),i.jsxs("p",{className:"price",children:["",$.price]}),i.jsxs("p",{className:"duration",children:["Every ",$.interval," ",$.period,$.interval>1?"s":""]}),$.description&&i.jsx("p",{children:$.description})]},$.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:z,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16}),"Back"]})]})},wS=async()=>{const e=await me("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},xre=async e=>{const n=await me(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},bre=async e=>{const n=await me(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},vre=async e=>{const n=await me(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},wre=async e=>{const n=await me("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},Sre=async(e,n)=>{const t=await me(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},Nre=async e=>{const n=await me(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},Cre=async e=>{const n=await me("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},_re=async()=>{try{const e=await me("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},jre=async()=>{const e=await me("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()},kre=()=>{const e=At(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await wS();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const h=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await Nre(g),f({type:"success",message:"Clinic plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate clinic plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(vs,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ir,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(bn,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(an,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(tl,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Yl,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Wr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},Tre=()=>{const e=At(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(S):S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await wre(n),f({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(vs,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ir,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(bn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Ere=()=>{const{id:e}=Ki(),n=At(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await vre(e);r(M),o({name:M.name,description:M.description||"",price:Number(M.price),period:M.period,interval:Number(M.interval),razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch clinic plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:R,value:z,type:$}=M.target;o(L=>({...L,[R]:$==="number"?parseFloat(z):z}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await Sre(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(R){const z=R.message||"Failed to update clinic plan.";g(z),v({type:"error",message:z})}finally{d(!1)}},P=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(vs,{size:18,className:"mr-2"}):i.jsx(Ir,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(bn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},Are=()=>{const e=At(),[n,t]=w.useState([]),[r,a]=w.useState(""),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,h]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{f(null);try{const T=(await wS()).filter(P=>P.status==="active");t(T),T.length>0&&!r&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),f(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const T=await _re();if(T&&T.short_url){window.location.href=T.short_url,f("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),f(`An unexpected error occurred: ${T.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===r);if(!k){b("Selected plan details not found.");return}h(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await Cre(r);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),h(!1)}};return o?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):d?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:d})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(_3,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:S,disabled:!r||u||n.length===0,className:"subscription-btn",children:[u&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),u?"Initiating Payment...":"Buy Pro Plan"]})})]})},Pre=()=>{const e=At(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[P,M]=w.useState(""),[R,z]=w.useState(""),[$,L]=w.useState({}),[U,B]=w.useState(!1),[W,I]=w.useState(null),[F,V]=w.useState([]),[re,ie]=w.useState(""),[G,Y]=w.useState(!1),[ne,le]=w.useState(null);w.useEffect(()=>{const J=setTimeout(()=>{z(P)},500);return()=>{clearTimeout(J)}},[P]),w.useEffect(()=>{oe(R)},[R]);const oe=async(J="")=>{a(!0);try{const ye=J?`/api/users?search=${encodeURIComponent(J)}`:"/api/users",Q=await(await me(ye)).json();if(t(Q),Q.length>0){const Pe=[...new Set(Q.map(Le=>Le.clinic_id).filter(Le=>!!Le))],Re={};await Promise.all(Pe.map(async Le=>{try{const _e=await bre(Le);Re[Le]=_e}catch(_e){console.error(`Failed to fetch subscription status for clinic ${Le}`,_e),Re[Le]={hasProPlan:!1}}})),L(Re)}l(null)}catch(ye){l("Failed to fetch users."),console.error(ye)}finally{a(!1)}},E=async J=>{J.preventDefault();try{await me("/users",{method:"POST",body:JSON.stringify(v)}),f(!1),S({name:"",email:"",password:"",role:"user"}),oe()}catch(ye){l("Failed to add user."),console.error(ye)}},de=async J=>{if(J.preventDefault(),!g)return;const{password:ye,confirmPassword:He,...Q}=k,Pe={...Q};if(ye){if(ye.length<6){l("Password must be at least 6 characters long.");return}if(ye!==He){l("Passwords do not match.");return}Pe.password=ye}try{await me(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Pe)}),h(!1),b(null),T({...k,password:"",confirmPassword:""}),oe()}catch(Re){l("Failed to update user."),console.error(Re)}},he=async J=>{if(window.confirm("Are you sure you want to delete this user?"))try{await me(`/users/${J}`,{method:"DELETE"}),oe()}catch(ye){l("Failed to delete user."),console.error(ye)}},D=J=>{b(J),T({name:J.name,email:J.email,role:J.role,password:"",confirmPassword:""}),h(!0)},pe=async()=>{Y(!0);try{const J=await wS();V(J),J.length>0&&ie(J[0].id),le(null)}catch(J){le("Failed to fetch subscription plans."),console.error(J)}finally{Y(!1)}},Ne=J=>{I(J),B(!0),pe()},te=async J=>{if(J.preventDefault(),!W||!re){l("Please select a clinic and a plan.");return}try{await me("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:W,planId:re})}),B(!1),I(null),ie(""),oe(),l(null)}catch(ye){l("Failed to manually activate clinic subscription."),console.error(ye)}},K=async J=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await xre(J),oe(),l(null)}catch(ye){l("Failed to cancel subscription."),console.error(ye)}};return r?i.jsx("div",{children:"Loading users..."}):o?i.jsx("div",{className:"error-message",children:o}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:P,onChange:J=>M(J.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>f(!0),className:"add-user-button",children:"Add New User"})]}),d&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>f(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:J=>S({...v,name:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:J=>S({...v,email:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:J=>S({...v,password:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:J=>S({...v,role:J.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),u&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>h(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:de,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:J=>T({...k,name:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:J=>T({...k,email:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:J=>T({...k,role:J.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:J=>T({...k,password:J.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:J=>T({...k,confirmPassword:J.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),U&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>B(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),G&&i.jsx("div",{children:"Loading plans..."}),ne&&i.jsx("div",{className:"error-message",children:ne}),!G&&!ne&&F.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!G&&!ne&&F.length>0&&i.jsxs("form",{onSubmit:te,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:re,onChange:J=>ie(J.target.value),required:!0,children:F.map(J=>i.jsxs("option",{value:J.id,children:[J.name," - $",J.price,"/",J.interval," ",J.period]},J.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(J=>{const ye=J.clinic_id||"N/A",He=ye!=="N/A"?$[ye]:null,Q=(He==null?void 0:He.hasProPlan)??!1,Pe=Q?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:J.name}),i.jsx("td",{children:J.email}),i.jsx("td",{children:J.role}),i.jsx("td",{children:ye}),i.jsx("td",{children:ye!=="N/A"?i.jsx("span",{className:Q?"pro-badge":"standard-badge",children:Pe}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>D(J),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>he(J.id),className:"delete-button",children:"Delete"}),J.clinic_id&&!Q&&i.jsx("button",{onClick:()=>Ne(J.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),J.clinic_id&&Q&&i.jsx("button",{onClick:()=>K(J.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},J.id)})})]})]})},Dre="_modalOverlay_1spz3_3",Ire="_modalContent_1spz3_29",Rre="_modalHeader_1spz3_53",Mre="_modalTitle_1spz3_71",Ore="_modalCloseButton_1spz3_83",Lre="_modalBody_1spz3_111",Fre="_formGroup_1spz3_119",$re="_inputField_1spz3_141",zre="_errorText_1spz3_175",Ure="_successText_1spz3_193",Bre="_modalFooter_1spz3_211",qre="_button_1spz3_227",Vre="_buttonPrimary_1spz3_247",Hre="_buttonSecondary_1spz3_265",Qi={modalOverlay:Dre,modalContent:Ire,modalHeader:Rre,modalTitle:Mre,modalCloseButton:Ore,modalBody:Lre,formGroup:Fre,inputField:$re,errorText:zre,successText:Ure,modalFooter:Bre,button:qre,buttonPrimary:Vre,buttonSecondary:Hre},Gre=({isOpen:e,onClose:n})=>{const[t,r]=w.useState(""),[a,o]=w.useState(!1),[l,d]=w.useState(!1),[f,u]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{e&&b()},[e]);const b=async()=>{o(!0),u(null);try{const S=await me("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();r(k.value||"")}else S.status}catch(S){console.warn("Could not fetch existing key:",S)}finally{o(!1)}},v=async()=>{d(!0),u(null),g(null);try{if(!(await me("/api/global-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"app_gemini_api_key",value:t})})).ok)throw new Error("Failed to save API Key");g("API Key updated successfully!"),setTimeout(()=>{n(),g(null)},1500)}catch(S){u(S.message||"Error saving key")}finally{d(!1)}};return e?i.jsx("div",{className:Qi.modalOverlay,children:i.jsxs("div",{className:Qi.modalContent,children:[i.jsxs("div",{className:Qi.modalHeader,children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(Dk,{size:24}),i.jsx("h3",{className:Qi.modalTitle,children:"App Gemini API Key"})]}),i.jsx("button",{onClick:n,className:Qi.modalCloseButton,children:i.jsx(bn,{size:20})})]}),i.jsxs("div",{className:Qi.modalBody,children:[f&&i.jsx("div",{className:Qi.errorText,children:f}),h&&i.jsx("div",{className:Qi.successText,children:h}),i.jsxs("div",{className:Qi.formGroup,children:[i.jsx("label",{htmlFor:"gemini-key",children:"Gemini API Key"}),i.jsx("input",{type:"text",id:"gemini-key",value:t,onChange:S=>r(S.target.value),className:Qi.inputField,placeholder:"Enter Gemini API Key (AIza...)",disabled:a||l})]}),i.jsx("p",{style:{fontSize:"0.9em",color:"var(--secondary-text-color, #666)"},children:"This key will be used as a fallback for all clinics if their specific Gemini API key is not configured."})]}),i.jsxs("div",{className:Qi.modalFooter,children:[i.jsx("button",{onClick:n,className:`${Qi.button} ${Qi.buttonSecondary}`,disabled:l,children:"Cancel"}),i.jsx("button",{onClick:v,className:`${Qi.button} ${Qi.buttonPrimary}`,disabled:l,children:l?"Saving...":"Save Key"})]})]})}):null},Yre=()=>{const[e,n]=w.useState(!1);return i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(Db,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(bs,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(Fh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(bs,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(Gh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),i.jsxs("div",{className:"admin-panel-card",onClick:()=>n(!0),style:{cursor:"pointer"},children:[i.jsx(Dk,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage App Gemini API Key"}),i.jsx("p",{children:"Update the fallback Gemini API key used by the application."})]})]}),i.jsx(Gre,{isOpen:e,onClose:()=>n(!1)})]})},n1="tutorialCurrentStep",Wre=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[r,a]=w.useState(""),[o,l]=w.useState(""),[d,f]=w.useState(""),[u,h]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!r||!o||!d){e(!1,"Please fill all fields.");return}h(!0);try{const v=await me("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:o,role:g,password:d})});if(v.ok)e(!0,`Successfully added "${r}" as a ${g}!`),a(""),l(""),f(""),n&&n(g);else{const S=await v.json();e(!1,`Failed: ${S.message||v.statusText}`)}}catch(v){e(!1,`Error: ${v instanceof Error?v.message:String(v)}`)}finally{h(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"text",placeholder:"Name",value:r,onChange:v=>a(v.target.value),disabled:u,className:"tutorial-input"}),i.jsx("input",{type:"email",placeholder:"Email",value:o,onChange:v=>l(v.target.value),disabled:u,className:"tutorial-input"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",placeholder:"Password",value:d,onChange:v=>f(v.target.value),disabled:u,className:"tutorial-input"}),i.jsx("div",{className:"role-badge",children:g==="lab"?"Lab Tech":g==="pharmacy"?"Pharmacist":"Receptionist"})]}),i.jsx("button",{onClick:b,className:"tutorial-button primary small",disabled:u,children:u?"Adding...":"Add Staff"})]})},Qre=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),o=async()=>{t(!0);try{(await me("/api/drugs/import-defaults",{method:"POST"})).ok?(a(!0),e(!0,"Default medications imported successfully!","pharmacyImport")):e(!1,"Failed to import medications.")}catch{e(!1,"Error importing medications.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"One click to populate your inventory."}),r?i.jsxs("div",{className:"success-badge",children:[i.jsx(Zx,{size:16})," Imported"]}):i.jsx("button",{onClick:o,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[i.jsx(Cw,{size:18})," Import Drugs"]})})]})},Jre=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),o=async()=>{t(!0);try{(await me("/api/lab-tests/import-defaults",{method:"POST"})).ok?(a(!0),e(!0,"Default lab tests imported successfully!","labImport")):e(!1,"Failed to import lab tests.")}catch{e(!1,"Error importing lab tests.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"Setup your lab with common tests."}),r?i.jsxs("div",{className:"success-badge",children:[i.jsx(Zx,{size:16})," Imported"]}):i.jsx("button",{onClick:o,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[i.jsx(Hl,{size:18})," Import Tests"]})})]})},Kre=[{icon:"",title:"Fever & Cold",description:"Rajesh Kumar, 35M, fever 2 days, body pain.",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Stomach Ache",description:"Priya Sharma, 28F, acidity, bloating 3 days.",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}],Xre=({onSelectExample:e})=>i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("p",{className:"action-hint",children:"Click an example to try the AI:"}),i.jsx("div",{className:"example-cards-grid",children:Kre.map((n,t)=>i.jsxs("div",{className:"tutorial-example-card",onClick:()=>e(n.text),children:[i.jsx("div",{className:"example-icon",children:n.icon}),i.jsxs("div",{className:"example-info",children:[i.jsx("h4",{children:n.title}),i.jsx("p",{children:n.description})]}),i.jsx(Gd,{size:16,className:"arrow-icon"})]},t))})]}),r1=[{title:"Welcome to Newtons Ai HMS",description:"Your all-in-one clinic management solution. Let's get your clinic ready in less than 2 minutes.",icon:i.jsx(t6,{size:48,className:"step-icon welcome"}),component:null,actionText:"Get Started"},{title:"Pharmacy Setup",description:"Start by populating your pharmacy. We can import a standard list of medicines for you.",icon:i.jsx(Cw,{size:48,className:"step-icon pharmacy"}),component:Qre,actionText:"Next",showSkip:!0},{title:"Lab Configuration",description:"Next, let's set up your lab. Import common lab tests to start generating reports immediately.",icon:i.jsx(Hl,{size:48,className:"step-icon lab"}),component:Jre,actionText:"Next",showSkip:!0},{title:"Add Your Team",description:"Invite your staff. Create accounts for receptionists, pharmacists, and lab technicians.",icon:i.jsx(Gh,{size:48,className:"step-icon staff"}),component:Wre,actionText:"Next",showSkip:!0},{title:"Experience the AI",description:"The magic happens here. Select an example case below to see how our AI creates patient records instantly.",icon:i.jsx(S3,{size:48,className:"step-icon ai"}),component:Xre,actionText:null,isLast:!0}],Zre=({onClose:e,onMarkAsSeen:n})=>{const[t,r]=w.useState(()=>{const T=localStorage.getItem(n1);return T?parseInt(T,10):0}),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(null),h=At();w.useEffect(()=>{localStorage.setItem(n1,t.toString()),d(null)},[t]);const g=()=>{o(!0),setTimeout(()=>{r(T=>Math.min(T+1,r1.length-1)),o(!1)},300)},b=(T,P,M)=>{u(T),d(P),T&&(M==="pharmacyImport"||M==="labImport")&&setTimeout(g,1e3)},v=()=>{n(),e(),localStorage.removeItem(n1)},S=T=>{const P=encodeURIComponent(T);h(`/dashboard?tab=newtons-ai&caseDetails=${P}`),v()},k=r1[t];return i.jsx("div",{className:"tutorial-overlay",children:i.jsxs("div",{className:`tutorial-card ${a?"fade-out":"fade-in"}`,children:[i.jsxs("div",{className:"tutorial-visual",children:[i.jsx("div",{className:"icon-circle",children:k.icon}),i.jsx("div",{className:"step-indicators",children:r1.map((T,P)=>i.jsx("div",{className:`step-dot ${P===t?"active":""} ${P<t?"completed":""}`},P))})]}),i.jsxs("div",{className:"tutorial-content",children:[i.jsx("button",{className:"close-button",onClick:v,title:"Close Tutorial",children:i.jsx(bn,{size:20})}),i.jsxs("div",{className:"text-content",children:[i.jsx("h2",{children:k.title}),i.jsx("p",{className:"description",children:k.description})]}),i.jsxs("div",{className:"interactive-area",children:[k.component?i.jsx(k.component,{onActionComplete:b,onSelectExample:S}):null,l&&i.jsx("div",{className:`status-message ${f?"success":"error"}`,children:l})]}),i.jsxs("div",{className:"action-footer",children:[k.showSkip&&i.jsx("button",{onClick:g,className:"tutorial-button text-only",children:"Skip for now"}),k.actionText&&i.jsxs("button",{onClick:g,className:"tutorial-button primary",children:[k.actionText," ",i.jsx(Gd,{size:16})]})]})]})]})})},eie=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(""),[f,u]=w.useState(1),[h,g]=w.useState(1),[b,v]=w.useState(0),[S,k]=w.useState(!1),[T,P]=w.useState(void 0),M=10,R=w.useRef(null),z=w.useCallback(async(F,V)=>{r(!0),o(null);try{let re=`/api/recurring-medications?page=${F}&limit=${M}`;V&&(re+=`&search=${encodeURIComponent(V)}`);const ie=await me(re);if(!ie.ok)throw new Error("Failed to fetch recurring medications.");const G=await ie.json();n(G.medications),g(G.totalPages),v(G.total),u(G.page)}catch(re){console.error(re),o(re.message||"An error occurred while fetching data.")}finally{r(!1)}},[]);w.useEffect(()=>(R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{z(f,l)},500),()=>{R.current&&clearTimeout(R.current)}),[l,f,z]);const $=F=>{d(F.target.value),u(1)},L=F=>{F>=1&&F<=h&&u(F)},U=F=>{P(F),k(!0)},B=()=>{z(f,l),k(!1),P(void 0)},W=F=>F===30?"Every 30 Days (Monthly)":F===15?"Every 15 Days":`Every ${F} Days`,I=F=>{switch(F){case"active":return"status-pill status-pill-active";case"paused":return"status-pill status-pill-paused";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill"}};return i.jsxs("div",{className:"refill-reminders-container",children:[i.jsxs("div",{className:"refill-header",children:[i.jsx("h3",{className:"refill-title",children:"Recurring Medications"}),i.jsxs("div",{className:"refill-actions",children:[i.jsxs("button",{className:"refill-action-button btn-add",onClick:()=>{P(void 0),k(!0)},children:[i.jsx(Ua,{size:16})," Add New"]}),i.jsxs("div",{className:"search-box",children:[i.jsx("input",{type:"text",placeholder:"Search patient, phone, medication...",value:l,onChange:$}),i.jsx(bi,{size:18,className:"search-icon"})]})]})]}),a&&i.jsx("div",{className:"error-message-box",children:a}),i.jsx("div",{className:"refill-table-container",children:t?i.jsx("div",{className:"loading-pulse",children:"Loading..."}):e.length===0?i.jsx("div",{className:"empty-state",children:"No recurring medications found."}):i.jsxs("table",{className:"refill-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Details"}),i.jsx("th",{children:"Medication Info"}),i.jsx("th",{children:"Frequency"}),i.jsx("th",{children:"Next Delivery"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(F=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:F.patientName}),i.jsxs("div",{className:"patient-subtext",children:["Phone: ",F.patientPhone]}),i.jsxs("div",{className:"patient-subtext",children:["Token: ",F.patientToken]})]}),i.jsxs("td",{children:[i.jsx("div",{className:"med-name",children:F.medicationName}),i.jsxs("div",{className:"med-qty",children:["Qty: ",F.quantity]}),(F.tabletsPerDay||F.numberOfDays||F.directions)&&i.jsxs("div",{className:"med-usage-details",style:{fontSize:"0.8em",color:"#666",marginTop:"4px"},children:[F.tabletsPerDay&&i.jsxs("span",{children:[F.tabletsPerDay," tabs/day  "]}),F.numberOfDays&&i.jsxs("span",{children:[F.numberOfDays," days  "]}),F.directions&&i.jsx("span",{children:F.directions})]}),F.notes&&i.jsxs("div",{className:"med-notes",children:["Note: ",F.notes]})]}),i.jsx("td",{children:i.jsx("span",{className:"frequency-badge",children:W(F.frequencyDays)})}),i.jsx("td",{children:i.jsx("div",{className:"date-display",children:new Date(F.nextDeliveryDate).toLocaleDateString()})}),i.jsx("td",{children:i.jsx("span",{className:I(F.status),children:F.status})}),i.jsx("td",{children:i.jsxs("div",{className:"action-buttons",children:[i.jsx("button",{className:"action-btn edit",title:"Edit",onClick:()=>U(F),children:i.jsx(Yl,{size:16})}),i.jsx("button",{className:"action-btn delete",title:"Cancel/Delete",children:i.jsx(Wr,{size:16})})]})})]},F.id))})]})}),!t&&h>1&&i.jsxs("div",{className:"pagination-container",children:[i.jsxs("span",{className:"pagination-info",children:["Page ",f," of ",h," (Total ",b,")"]}),i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("button",{onClick:()=>L(f-1),disabled:f===1,className:"page-btn",children:[i.jsx(Tb,{size:16})," Prev"]}),i.jsxs("button",{onClick:()=>L(f+1),disabled:f===h,className:"page-btn",children:["Next ",i.jsx(Gd,{size:16})]})]})]}),i.jsx(PA,{isOpen:S,onClose:()=>{k(!1),P(void 0)},onSuccess:B,medication:T})]})},tie=()=>{const e=At(),n=qr();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const l=await me(`/api/patients?search=${r}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const f=(await l.json()).patients[0];if(!f)throw new Error("Patient with the given token not found");const u=await me(`/api/queue/patient/${f.id}/latest`);if(u.ok){const b=await u.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a}});return}}const h=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:f.id,complaint:a})});if(!h.ok)throw new Error("Failed to create queue entry");const g=await h.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},Hj=()=>{const e=At(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[R,z]=w.useState([]),[$,L]=w.useState(null),[U,B]=w.useState(""),[W,I]=w.useState(""),[F,V]=w.useState(""),[re,ie]=w.useState(""),[G,Y]=w.useState(""),[ne,le]=w.useState(""),[oe,E]=w.useState(""),[de,he]=w.useState(""),[D,pe]=w.useState(""),[Ne,te]=w.useState(""),[K,J]=w.useState(""),ye=w.useCallback(async()=>{a(!0),l(null);try{const ve=await me("/api/distributors");if(!ve.ok)throw new Error(`Failed to fetch distributors: ${ve.statusText}`);const X=await ve.json();t(X)}catch(ve){console.error("Failed to fetch distributors:",ve),l(ve.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{ye()},[ye]);const He=async ve=>{ve.preventDefault(),l(null);try{const X=await me("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:U,contact_person:W,phone:F,email:re,address:G,gst_number:ne,drug_license_number:oe})});if(!X.ok){const fe=await X.json();throw new Error(fe.message||"Failed to add distributor.")}alert("Distributor added successfully!"),Ke(),ye()}catch(X){console.error("Error adding distributor:",X),l(X.message||"Failed to add distributor.")}},Q=async ve=>{if(ve.preventDefault(),l(null),!!P)try{const X=await me(`/api/distributors/${P.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:U,contact_person:W,phone:F,email:re,address:G,gst_number:ne,drug_license_number:oe})});if(!X.ok){const fe=await X.json();throw new Error(fe.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),it(),ye()}catch(X){console.error("Error updating distributor:",X),l(X.message||"Failed to update distributor.")}},Pe=async()=>{if(l(null),!!P)try{const ve=await me(`/api/distributors/${P.id}`,{method:"DELETE"});if(!ve.ok){const X=await ve.json();throw new Error(X.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),Nt(),ye()}catch(ve){console.error("Error deleting distributor:",ve),l(ve.message||"Failed to delete distributor.")}},Re=w.useCallback(async ve=>{l(null);try{const X=await me(`/api/distributors/${ve}/payments`);if(!X.ok)throw new Error(`Failed to fetch payments: ${X.statusText}`);const Ge=(await X.json()).map(wt=>({...wt,order_value:parseFloat(wt.order_value),amount_paid:parseFloat(wt.amount_paid),balance_remaining:parseFloat(wt.balance_remaining)}));z(Ge);const Je=await me(`/api/distributors/${ve}/balance`);if(!Je.ok)throw new Error(`Failed to fetch balance: ${Je.statusText}`);const ct=await Je.json();L({totalOrderValue:parseFloat(ct.totalOrderValue),totalAmountPaid:parseFloat(ct.totalAmountPaid),remainingBalance:parseFloat(ct.remainingBalance)})}catch(X){console.error("Error fetching payments/balance:",X),l(X.message||"Failed to load payments or balance.")}},[]),Le=async ve=>{if(ve.preventDefault(),l(null),!!P)try{const X=await me(`/api/distributors/${P.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:de,order_value:parseFloat(D||"0"),amount_paid:parseFloat(Ne||"0"),notes:K})});if(!X.ok){const fe=await X.json();throw new Error(fe.message||"Failed to add payment.")}alert("Payment added successfully!"),Se(),Re(P.id)}catch(X){console.error("Error adding payment:",X),l(X.message||"Failed to add payment.")}},_e=()=>{B(""),I(""),V(""),ie(""),Y(""),le(""),E(""),l(null),f(!0)},Ke=()=>{f(!1)},Ye=ve=>{M(ve),B(ve.name),I(ve.contact_person||""),V(ve.phone||""),ie(ve.email||""),Y(ve.address||""),le(ve.gst_number||""),E(ve.drug_license_number||""),l(null),h(!0)},it=()=>{h(!1),M(null)},xt=ve=>{M(ve),l(null),b(!0)},Nt=()=>{b(!1),M(null)},ue=ve=>{M(ve),Re(ve.id),l(null),S(!0)},Ae=()=>{S(!1),M(null),z([]),L(null)},ke=ve=>{M(ve),he(new Date().toISOString().split("T")[0]),pe("0"),te("0"),J(""),l(null),T(!0)},Se=()=>{T(!1),M(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):o?i.jsxs("div",{className:"error-indicator",children:["Error: ",o]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(an,{size:24})," Back"]}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const ve=n.reduce((fe,Ge)=>fe+parseFloat(Ge.remainingBalance||"0"),0),X=ve>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${X}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",ve.toFixed(2)]})})(),i.jsxs("button",{onClick:_e,className:"add-distributor-button",children:[i.jsx(Ua,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(ve=>i.jsxs("tr",{children:[i.jsx("td",{children:ve.name}),i.jsx("td",{children:ve.contact_person||"-"}),i.jsx("td",{children:ve.phone||"-"}),i.jsx("td",{children:ve.email||"-"}),i.jsx("td",{children:ve.address||"-"}),i.jsx("td",{children:ve.gst_number||"-"})," ",i.jsx("td",{children:ve.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(ve.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",ve.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>ue(ve),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(X3,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>ke(ve),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(Ua,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>Ye(ve),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(Yl,{size:16})}),i.jsx("button",{onClick:()=>xt(ve),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(Wr,{size:16})})]})})]},ve.id))})]})}),d&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ke,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:He,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:U,onChange:ve=>B(ve.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:W,onChange:ve=>I(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:F,onChange:ve=>V(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:re,onChange:ve=>ie(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:G,onChange:ve=>Y(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:ne,onChange:ve=>le(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:oe,onChange:ve=>E(ve.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ke,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),u&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:it,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Q,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:U,onChange:ve=>B(ve.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:W,onChange:ve=>I(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:F,onChange:ve=>V(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:re,onChange:ve=>ie(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:G,onChange:ve=>Y(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:ne,onChange:ve=>le(ve.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:oe,onChange:ve=>E(ve.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:it,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Nt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',P.name,'"?']}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Nt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Pe,className:"button-delete",children:"Delete"})]})]})}),v&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:Ae,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",P.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),$&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",$.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",$.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",$.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),R.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:R.map(ve=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(ve.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",ve.order_value.toFixed(2)]}),i.jsxs("td",{children:["",ve.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",ve.balance_remaining.toFixed(2)]}),i.jsx("td",{children:ve.notes||"-"})]},ve.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:Ae,className:"button-cancel",children:"Close"})})]})}),k&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Se,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",P.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Le,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:de,onChange:ve=>he(ve.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:D,onChange:ve=>pe(ve.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:Ne,onChange:ve=>te(ve.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:K,onChange:ve=>J(ve.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Se,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},nie=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[o,l]=w.useState({});if(w.useEffect(()=>{e&&f()},[e,t,a]),!e)return null;const d=(h,g)=>{l(b=>({...b,[h]:g}))},f=()=>{const h={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=Um(g,b);v&&(h[g]=v.name)}),l(h)},u=()=>{const h={};for(const g in o)o[g]&&o[g]!=="none"&&(h[g]=o[g]);r(h),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(bn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:f,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((h,g)=>i.jsxs(kn.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:h}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:o[h]||"",onChange:b=>d(h,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:u,className:"button-submit",children:"Confirm Mapping"})]})]})})},rie=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r})=>{const a=w.useRef(new Map),o=["name","mrp","stock","pack","expiry_date","rate","brand_name","box_number","gst","discount","batch","hsn_code","mfg","loose"],l=(d,f,u)=>{if(d.key==="Tab"){d.preventDefault();const h=o.indexOf(u);if(h!==-1){const g=(h+1)%o.length,b=o[g],v=a.current.get(`${f}-${b}`);v==null||v.focus()}}};return e.length===0?i.jsxs("div",{className:"no-drugs-message",children:[i.jsx("p",{children:"No drugs added to the purchase list yet."}),i.jsxs("button",{onClick:r,className:"action-button add-drug-to-table-button",children:[i.jsx(Ua,{size:18,className:"button-icon"}),"Add the first drug"]})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"purchase-drugs-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Composition Name"}),i.jsx("th",{children:"MRP ()"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Pack"}),i.jsx("th",{children:"Supplier"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Rate ()"}),i.jsx("th",{children:"Brand Name"}),i.jsx("th",{children:"Box Number"}),i.jsx("th",{children:"GST (%)"}),i.jsx("th",{children:"Discount (%)"}),i.jsx("th",{children:"Margin (%)"}),i.jsx("th",{children:"Batch"}),i.jsx("th",{children:"HSN Code"}),i.jsx("th",{children:"MFG"}),i.jsx("th",{children:"Loose"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map((d,f)=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("input",{type:"text",value:d.name||"",onChange:u=>n(u,d.id,"name"),onKeyDown:u=>l(u,d.id,"name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.mrp,onChange:u=>n(u,d.id,"mrp"),onKeyDown:u=>l(u,d.id,"mrp"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mrp`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.stock,onChange:u=>n(u,d.id,"stock"),onKeyDown:u=>l(u,d.id,"stock"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-stock`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.pack||"",onChange:u=>n(u,d.id,"pack"),onKeyDown:u=>l(u,d.id,"pack"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-pack`,u)}})}),i.jsx("td",{children:d.supplier||"N/A"}),i.jsx("td",{children:i.jsx("input",{type:"date",value:d.expiry_date||"",onChange:u=>n(u,d.id,"expiry_date"),onKeyDown:u=>l(u,d.id,"expiry_date"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-expiry_date`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.rate||"",onChange:u=>n(u,d.id,"rate"),onKeyDown:u=>l(u,d.id,"rate"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-rate`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.brand_name||"",onChange:u=>n(u,d.id,"brand_name"),onKeyDown:u=>l(u,d.id,"brand_name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-brand_name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.box_number||"",onChange:u=>n(u,d.id,"box_number"),onKeyDown:u=>l(u,d.id,"box_number"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-box_number`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.gst||"",onChange:u=>n(u,d.id,"gst"),onKeyDown:u=>l(u,d.id,"gst"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-gst`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.discount||"",onChange:u=>n(u,d.id,"discount"),onKeyDown:u=>l(u,d.id,"discount"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-discount`,u)}})}),i.jsx("td",{children:(()=>{const u=d.mrp||0,h=d.rate||0,g=d.gst!==null&&d.gst!==void 0?d.gst/100*h:0,b=d.discount!==null&&d.discount!==void 0?d.discount/100*u:0,v=u-(h+g)-b;return`${(u>0?v/u*100:0).toFixed(2)}%`})()}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.batch||"",onChange:u=>n(u,d.id,"batch"),onKeyDown:u=>l(u,d.id,"batch"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-batch`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.hsn_code||"",onChange:u=>n(u,d.id,"hsn_code"),onKeyDown:u=>l(u,d.id,"hsn_code"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-hsn_code`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.mfg||"",onChange:u=>n(u,d.id,"mfg"),onKeyDown:u=>l(u,d.id,"mfg"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mfg`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.loose||"",onChange:u=>n(u,d.id,"loose"),onKeyDown:u=>l(u,d.id,"loose"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-loose`,u)}})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>t(d.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})})]},d.id||f))})]})})},Gj=()=>{const e=At(),{purchaseRows:n,setPurchaseRows:t,selectedDistributor:r,setSelectedDistributor:a,searchTerm:o,setSearchTerm:l,amountPaidToDistributor:d,setAmountPaidToDistributor:f,distributors:u,setDistributors:h}=dk(),[g,b]=w.useState(!1),v=w.useRef(null),S=w.useRef(null),[k,T]=w.useState(!1),P=w.useRef(null),[M,R]=w.useState(!1),[z,$]=w.useState([]),[L,U]=w.useState(null),[B,W]=w.useState(null),[I,F]=w.useState(!1),V=["name","description","mrp","stock","pack","supplier","expiry_date","rate","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],re=()=>{const Pe={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",mrp:0,stock:0,pack:"",supplier:r?r.name:"",expiry_date:"",rate:0,box_number:"",gst:0,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""};t(Re=>[...Re,Pe])},ie=async(Q,Pe)=>{if(!Q){W("No file provided for import.");return}if(!r){W("Please select a distributor before importing.");return}b(!0),W(null);const Re=new FormData;Re.append("inventoryFile",Q),Re.append("columnMapping",JSON.stringify(Pe));try{const Le=await me("/api/drugs/parse-excel",{method:"POST",body:Re});if(!Le.ok){const Ke=await Le.json();throw new Error(Ke.message||`Failed to parse Excel file: ${Le.statusText}`)}const _e=await Le.json();t(Ke=>[...Ke,..._e.map(Ye=>({...Ye,id:Date.now().toString()+Math.random().toString(36).substring(2,9),supplier:r?r.name:Ye.supplier}))]),alert(`Successfully parsed ${_e.length} drugs from Excel. They have been added to the purchase list.`)}catch(Le){console.error("Failed to parse Excel file:",Le),W(Le.message||"Failed to parse Excel file. Please check the file format and try again."),alert(`Excel parsing failed: ${Le.message||"Please check the file format and try again."}`)}finally{v.current&&(v.current.value=""),b(!1),U(null)}},G=async Q=>{if(Q.target.files&&Q.target.files[0]){const Pe=Q.target.files[0];U(Pe),W(null),b(!0);const Re=new FormData;Re.append("inventoryFile",Pe);try{const Le=await me("/api/drugs/get-file-headers",{method:"POST",body:Re});if(!Le.ok){const Ke=await Le.json();throw new Error(Ke.message||`Failed to get file headers: ${Le.statusText}`)}const{headers:_e}=await Le.json();$(_e),R(!0)}catch(Le){console.error("Failed to get file headers:",Le),W(Le.message||"Failed to read file headers. Please check the file format and try again."),alert(`Error reading file headers: ${Le.message||"Please check the file format and try again."}`),U(null)}finally{b(!1)}}else U(null)},Y=Q=>{L?ie(L,Q):W("No file selected for import after mapping."),R(!1)},ne=()=>{R(!1),$([]),U(null),v.current&&(v.current.value="")},le=()=>{var Q;(Q=v.current)==null||Q.click()},oe=async Q=>{if(Q.target.files&&Q.target.files[0]){const Pe=Q.target.files[0];W(null),b(!0);const Re=new FormData;Re.append("file",Pe),Re.append("output_type","csv");const _e={Authorization:"Bearer 00841ac4-b279-11f0-ab55-0a3a41e3fad1"};try{const Ke=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:_e,body:Re});if(!Ke.ok){const Se=await Ke.json();throw new Error(Se.message||`Failed to extract data from image/PDF: ${Ke.statusText}`)}const Ye=await Ke.json();if(!Ye.success||!Ye.content)throw new Error(Ye.detail||"Nanonets API did not return expected content.");let it=Ye.content;it=it.split(`
`).filter(Se=>!Se.startsWith("#")&&Se.trim()!=="").join(`
`);const Nt=new File([it],"extracted_data.csv",{type:"text/csv"}),ue=new FormData;ue.append("inventoryFile",Nt);const Ae=await me("/api/drugs/get-file-headers",{method:"POST",body:ue});if(!Ae.ok){const Se=await Ae.json();throw new Error(Se.message||`Failed to get headers from extracted CSV: ${Ae.statusText}`)}const{headers:ke}=await Ae.json();$(ke),U(Nt),R(!0),alert("Successfully extracted data from image/PDF as CSV. Please map the columns.")}catch(Ke){console.error("Failed to extract data from image/PDF:",Ke),W(Ke.message||"Failed to extract data from image/PDF. Please check the file and try again."),alert(`Image/PDF extraction failed: ${Ke.message||"Please check the file and try again."}`)}finally{S.current&&(S.current.value=""),b(!1)}}},E=()=>{var Q;(Q=S.current)==null||Q.click()},de=()=>{if(!r){W("Please select a distributor before adding a drug manually.");return}F(!0)},he=()=>{F(!1),W(null)},D=Q=>{t(Pe=>[...Pe,{...Q,id:Date.now().toString(),supplier:r?r.name:Q.supplier}]),he()},pe=Q=>{t(Pe=>Pe.filter(Re=>Re.id!==Q))},Ne=(Q,Pe,Re)=>{const{value:Le}=Q.target;t(_e=>_e.map(Ke=>{if(Ke.id===Pe){let Ye=Le;Re==="expiry_date"?Ye=Le.trim()===""?null:Le:["mrp","stock","rate","gst","margin","discount","loose"].includes(Re)&&(Ye=parseFloat(Le),isNaN(Ye)&&(Ye=null));const it={...Ke,[Re]:Ye};return Re==="name"&&r&&!it.supplier&&(it.supplier=r.name),it}return Ke}))},te=w.useCallback(()=>n.reduce((Q,Pe)=>{const Re=Pe.stock||0,Le=Pe.rate||0,_e=Pe.gst||0,Ke=Pe.discount||0;let Ye=Le*(1-Ke/100),it=Re*Ye;return it+=it*(_e/100),Q+it},0),[n]),K=async()=>{if(!r){W("Please select a distributor before submitting the purchase.");return}const Q=n.filter(Pe=>Object.values(Pe).some(Re=>typeof Re=="string"&&Re.trim()!==""||typeof Re=="number"&&Re!==0||Re!=null&&typeof Re!="string"&&typeof Re!="number"));if(Q.length===0){W("No valid drugs to submit. Please fill in at least one field for a row, or remove empty rows."),b(!1);return}b(!0),W(null);try{for(const _e of Q){const Ke={..._e,expiry_date:_e.expiry_date===""?null:_e.expiry_date,distributorId:r.id},Ye=await me("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ke)});if(!Ye.ok){const it=await Ye.json();throw new Error(it.message||`Failed to add drug ${_e.name}: ${Ye.statusText}`)}}const Pe=te(),Re=new Date().toISOString().split("T")[0],Le=await me(`/api/distributors/${r.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:Re,order_value:Pe,amount_paid:d,notes:"Payment from purchase page."})});if(!Le.ok){const _e=await Le.json();throw new Error(_e.message||`Failed to record distributor payment: ${Le.statusText}`)}alert("All valid drugs added to inventory and distributor payment recorded successfully!"),t([]),a(null),l(""),f(0),e("/dashboard/inventory")}catch(Pe){console.error("Failed to submit purchase:",Pe),W(Pe.message||"Failed to submit purchase. Please try again."),alert(`Purchase submission failed: ${Pe.message||"Please try again."}`)}finally{b(!1)}},J=w.useCallback(async Q=>{if(Q.trim()===""){h([]);return}try{const Pe=await me(`/api/distributors?search=${encodeURIComponent(Q)}`);if(!Pe.ok)throw new Error(`Failed to fetch distributors: ${Pe.statusText}`);const Re=await Pe.json();h(Re)}catch(Pe){console.error("Failed to fetch distributors:",Pe),W(Pe.message||"Failed to load distributors.")}},[]),ye=Q=>{const Pe=Q.target.value;l(Pe),a(null),P.current&&clearTimeout(P.current),Pe.trim()!==""?P.current=setTimeout(()=>{J(Pe),T(!0)},300):(h([]),T(!1))},He=Q=>{a(Q),l(Q.name),T(!1),h([])};return w.useEffect(()=>{const Q=Pe=>{Pe.target instanceof HTMLElement&&!Pe.target.closest(".distributor-search-container")&&T(!1)};return document.addEventListener("mousedown",Q),()=>{document.removeEventListener("mousedown",Q),P.current&&clearTimeout(P.current)}},[]),i.jsxs("div",{className:"purchase-page",children:[i.jsxs("div",{className:"purchase-header",children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:i.jsx(an,{size:24})}),i.jsx("h2",{className:"purchase-page-title",children:"Purchase Inventory"})]}),B&&i.jsx("div",{className:"error-message",children:B}),i.jsxs("div",{className:"purchase-controls-header",children:[i.jsxs("div",{className:"distributor-selection-section",children:[i.jsxs("h3",{children:[i.jsx(p6,{size:24,className:"icon-left"})," Select Distributor"]}),i.jsxs("div",{className:"distributor-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(bi,{size:20,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search distributor by name...",value:o,onChange:ye,onFocus:()=>o.trim()!==""&&T(!0),className:"distributor-search-input"})]}),k&&u.length>0&&i.jsx("ul",{className:"distributor-search-results",children:u.map(Q=>i.jsx("li",{onClick:()=>He(Q),children:Q.name},Q.id))}),r&&i.jsxs("div",{className:"selected-distributor-info",children:["Selected: ",i.jsx("strong",{children:r.name}),r.contact_person&&i.jsxs("span",{children:[" (",r.contact_person,")"]})]})]})]}),i.jsxs("div",{className:"import-section",children:[i.jsxs("h3",{children:[i.jsx(WN,{size:24,className:"icon-left"})," Import Drugs"]}),i.jsx("p",{children:"Upload an Excel (.xlsx, .xls), CSV, PDF, or Image file to import drug data."}),i.jsxs("div",{className:"import-controls",children:[i.jsx("input",{ref:v,id:"excel-file-upload",name:"excel-file-upload",type:"file",className:"sr-only",accept:".xlsx, .xls, .csv",onChange:G}),i.jsxs("button",{onClick:le,disabled:g||!r,className:`action-button import-button ${g?"importing":""}`,title:r?"":"Please select a distributor",children:[i.jsx(WN,{size:18,className:"button-icon"}),g?"Reading Headers...":"Import XL or CSV"]}),i.jsx("input",{ref:S,id:"image-pdf-file-upload",name:"image-pdf-file-upload",type:"file",className:"sr-only",accept:".pdf, .png, .jpg, .jpeg",onChange:oe}),i.jsxs("button",{onClick:E,disabled:g||!r,className:"action-button import-button",title:r?"":"Please select a distributor",children:[i.jsx(lu,{size:18,className:"button-icon"}),"Import from PDF/Image"]}),i.jsxs("button",{onClick:de,className:"action-button add-drug-manual-button",disabled:!r,title:r?"":"Select a distributor to add drugs manually",children:[i.jsx(Ua,{size:18,className:"button-icon"}),"Add Drug"]})]})]})]}),i.jsx(nie,{isOpen:M,onClose:ne,excelHeaders:z,onConfirm:Y,availableFields:V}),I&&i.jsx(EE,{isOpen:I,onClose:he,onDrugAddedToPurchase:D}),i.jsxs("div",{className:"purchase-summary-section",children:[i.jsxs("h3",{children:[i.jsx(o6,{size:24,className:"icon-left"})," Drugs to be Purchased (",n.length,")"]}),i.jsx(rie,{purchaseRows:n,onCellChange:Ne,onRemoveDrug:pe,onAddEmptyRow:re}),i.jsxs("div",{className:"purchase-summary-actions",children:[i.jsxs("button",{onClick:re,className:"action-button add-drug-to-table-button",children:[i.jsx(Ua,{size:18,className:"button-icon"}),"Add Row"]}),i.jsxs("div",{className:"summary-details",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount-paid-to-distributor",children:"Amount Paid ():"}),i.jsx("input",{type:"number",id:"amount-paid-to-distributor",value:d,onChange:Q=>f(parseFloat(Q.target.value)||0),placeholder:"0.00",className:"amount-paid-input",step:"0.01",disabled:!r,title:r?"":"Please select a distributor first"})]}),i.jsxs("div",{className:"total-purchase-value",children:[i.jsx("strong",{children:"Total Purchase Value:"})," ",te().toFixed(2)]})]}),i.jsx("button",{onClick:K,disabled:g||n.length===0||!r,className:"action-button submit-purchase-button",children:g?"Submitting...":"Submit Purchase"})]})]})]})},iie=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},aie=()=>{const e=At(),n=qr(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(!0),[f,u]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[T,P]=w.useState(""),[M,R]=w.useState(""),[z,$]=w.useState(""),[L,U]=w.useState(""),[B,W]=w.useState(0),I=w.useRef(!1),F=oe=>{const E=Math.max(0,Math.min(100,isNaN(oe)?0:oe));I.current=!0,W(E);const de=a.map(he=>({...he,discount_percentage:E}));o(de)},V=(oe,E)=>{const de=[...a];de[oe].discount_percentage=isNaN(E)?0:E,o(de)};w.useEffect(()=>{if(I.current){I.current=!1;return}const oe=a.reduce((he,D)=>he+(D.total_price??0),0);if(oe===0){W(0);return}const de=a.reduce((he,D)=>{const Ne=(D.total_price??0)*((D.discount_percentage??0)/100);return he+Ne},0)/oe*100;W(he=>Math.abs(he-de)>.01?de:he)},[a]);const re=async()=>{if(!t)return u("No order data available to bill."),null;if(a.length===0)return u("Cannot bill an empty order."),null;g(!0),u(null);try{const oe=a.map(pe=>{const Ne=(pe.pricePerLooseUnit??0)*(pe.looseQuantity??0),te=Ne*((pe.discount_percentage??0)/100),K=Ne-te;return{name:pe.name,pack_quantity:pe.loosePacks??0,loose_quantity:pe.looseUnits??0,price:pe.originalPrice??0,pack_price:pe.originalPrice??0,loose_price:pe.pricePerLooseUnit??0,total:K,drug_id:pe.drug_id,discount_percentage:pe.discount_percentage??0,batch:pe.batch,expiry_date:pe.expiry_date}}),E={patientId:t.patientId,queueId:t.id,items:oe,amount:le,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:B},de=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),he=await de.json();if(!de.ok||!he.id)throw new Error(he.message||"Failed to create bill.");const D=await me(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:he.id,medications:a})});if(!D.ok){const pe=await D.text();throw new Error(`Failed to update pharmacy order status: ${D.statusText} - ${pe}`)}return r(pe=>pe?{...pe,status:"billed",bill_id:he.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${he.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:he.id},initialItems:a}}),he.id}catch(oe){return console.error("Billing process failed:",oe),u(oe.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},ie=()=>{window.print()},G=async()=>{await re()&&(window.print(),e(-1))};w.useEffect(()=>{const oe=n.pathname.split("/"),E=oe[oe.length-1];E?(async()=>{try{const he=await me(`/api/pharmacy-orders/${E}`);if(!he.ok)throw new Error("Failed to fetch pharmacy order details");const D=await he.json();r(D);const pe=D.medications.map(Ne=>{const te=iie(Ne.unit),K=(Ne.pack_quantity??0)*te+(Ne.loose_quantity??0);return{...Ne,isLoose:!0,loosePacks:Ne.pack_quantity??0,looseUnits:Ne.loose_quantity??0,looseQuantity:K,pack_price:Number(Ne.pack_price)||0,loose_price:Number(Ne.loose_price)||0,total_price:Number(Ne.total_price)||0,pricePerLooseUnit:Number(Ne.loose_price)||0,originalPrice:Number(Ne.pack_price)||0,discount_percentage:Number(Ne.discount_percentage)??0,directions_to_use:Ne.directions_to_use,tabletsPerDay:Ne.tabletsPerDay,numberOfDays:Ne.numberOfDays,batch:Ne.batch,expiry_date:Ne.expiry_date}});o(pe)}catch(he){console.error("Failed to fetch order:",he),u(he.message||"Failed to load order details.")}finally{d(!1)}})():(u("No pharmacy order ID provided."),d(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const E=await me("/api/clinics/settings");if(!E.ok)throw new Error("Failed to fetch clinic settings");const de=await E.json();P(de.upi_id||""),R(de.name||""),$(de.address||""),U(de.notes||"")}catch(E){console.error("Error fetching clinic settings:",E)}})()},[]);const Y=w.useMemo(()=>a.reduce((oe,E)=>oe+(E.total_price??0),0),[a]),ne=w.useMemo(()=>a.reduce((oe,E)=>{const he=(E.total_price??0)*(E.discount_percentage??0)/100;return oe+he},0),[a]),le=w.useMemo(()=>Y-ne,[Y,ne]);return w.useEffect(()=>{if(le>0&&T){const oe=`upi://pay?pa=${T}&pn=ClinicName&am=${le.toFixed(2)}&cu=INR`;k(oe)}else k("")},[le,T]),l?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):f?i.jsxs("div",{className:"error-message-box",children:["Error: ",f]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:M?`${M} Pharmacy`:"Pharmacy Bill"}),(z||L)&&i.jsxs("div",{className:"clinic-details-print",children:[z&&i.jsx("span",{className:"small-text clinic-address",children:z}),L&&i.jsx("span",{className:"small-text clinic-notes",children:L})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(eo,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Jm,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Qm,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(an,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(eo,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Jm,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(lg,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Qm,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((oe,E)=>{var Ne,te;const de=oe.total_price??0,he=de*(oe.discount_percentage??0)/100,D=de-he;return i.jsxs("tr",{children:[i.jsx("td",{children:E+1}),i.jsx("td",{children:oe.name}),i.jsx("td",{children:oe.batch||"N/A"}),i.jsx("td",{children:oe.expiry_date?new Date(oe.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",oe.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",oe.looseUnits??0]})]}),i.jsx("td",{children:((Ne=oe.originalPrice)==null?void 0:Ne.toFixed(2))??"N/A"}),i.jsx("td",{children:((te=oe.pricePerLooseUnit)==null?void 0:te.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:oe.discount_percentage??0,onChange:K=>V(E,parseFloat(K.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:D.toFixed(2)})]},E)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Uh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",Y.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",B.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",ne.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(le*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",le.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",Y.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",ne.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:B,onChange:oe=>F(parseFloat(oe.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:h||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",le.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Uh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:oe=>v(oe.target.value),className:"payment-mode-select",disabled:h||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:ie,className:"secondary-button print-preview-button no-print",disabled:h||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:G,className:"primary-button",disabled:h||a.length===0,children:h?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},sie=()=>{const e=At(),n=qr(),[t,r]=w.useState(null),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState([]),[h,g]=w.useState(!0),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState("cash"),[M,R]=w.useState(""),[z,$]=w.useState(""),[L,U]=w.useState(""),[B,W]=w.useState(""),[I,F]=w.useState(""),[V,re]=w.useState(0),ie=w.useRef(!1),G=D=>{const pe=Math.max(0,Math.min(100,isNaN(D)?0:D));ie.current=!0,re(pe);const Ne=f.map(te=>({...te,discount_percentage:pe}));u(Ne)},Y=(D,pe)=>{const Ne=[...f];Ne[D].discount_percentage=isNaN(pe)?0:pe,u(Ne)};w.useEffect(()=>{if(ie.current){ie.current=!1;return}const D=f.reduce((te,K)=>te+(K.price??0),0);if(D===0){re(0);return}const Ne=f.reduce((te,K)=>{const ye=(K.price??0)*((K.discount_percentage??0)/100);return te+ye},0)/D*100;re(te=>Math.abs(te-Ne)>.01?Ne:te)},[f]);const ne=async()=>{if(!t)return v("No order data available to bill."),null;if(f.length===0)return v("Cannot bill an empty order."),null;k(!0),v(null);try{const D=f.map(J=>{const ye=J.price,He=ye*((J.discount_percentage??0)/100),Q=ye-He;return{name:J.name,price:J.price,quantity:1,total:Q,item_id:J.id,type:"lab_test",discount_percentage:J.discount_percentage??0}}),pe={patientId:t.patient_id,items:D,amount:he,paymentMode:T,type:"lab",related_id:t.id,status:"paid",discountPercentage:V},Ne=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(pe)}),te=await Ne.json();if(!Ne.ok||!te.id)throw new Error(te.message||"Failed to create bill.");const K=await me(`/api/lab/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:te.id})});if(!K.ok){const J=await K.text();throw new Error(`Failed to update lab order status: ${K.statusText} - ${J}`)}return r(J=>J?{...J,status:"billed",bill_id:te.id}:null),alert(`Lab Order bill created (ID: ${te.id}) and marked as billed.`),e(`/dashboard/lab-billing/${t.id}`,{replace:!0,state:{...n.state,order:{...t,status:"billed",bill_id:te.id}}}),te.id}catch(D){return console.error("Billing process failed:",D),v(D.message||"Failed to mark order as billed. Please try again."),null}finally{k(!1)}},le=()=>{window.print()},oe=async()=>{await ne()&&(window.print(),e(-1))};w.useEffect(()=>{const D=n.pathname.split("/"),pe=D[D.length-1];pe?(async()=>{try{const te=await me(`/api/lab/${pe}`);if(!te.ok)throw new Error("Failed to fetch lab order details");const K=await te.json();if(r(K),K.patient_id){const ye=await me(`/api/patients/${K.patient_id}`);if(ye.ok){const He=await ye.json();o(He.name),d(He.patient_token_number)}}const J=K.tests.map(ye=>({...ye,price:typeof ye.price=="string"?parseFloat(ye.price):Number(ye.price)||0,discount_percentage:0,total_price:typeof ye.price=="string"?parseFloat(ye.price):Number(ye.price)||0}));u(J)}catch(te){console.error("Failed to fetch order:",te),v(te.message||"Failed to load order details.")}finally{g(!1)}})():(v("No lab order ID provided."),g(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const pe=await me("/api/clinics/settings");if(!pe.ok)throw new Error("Failed to fetch clinic settings");const Ne=await pe.json();$(Ne.upi_id||""),U(Ne.name||""),W(Ne.address||""),F(Ne.notes||"")}catch(pe){console.error("Error fetching clinic settings:",pe)}})()},[]);const E=w.useMemo(()=>f.reduce((D,pe)=>D+(pe.price??0),0),[f]),de=w.useMemo(()=>f.reduce((D,pe)=>{const te=(pe.price??0)*(pe.discount_percentage??0)/100;return D+te},0),[f]),he=w.useMemo(()=>E-de,[E,de]);return w.useEffect(()=>{if(he>0&&z){const D=`upi://pay?pa=${z}&pn=ClinicName&am=${he.toFixed(2)}&cu=INR`;R(D)}else R("")},[he,z]),h?i.jsx("div",{className:"loading-pulse",children:"Loading Lab Bill..."}):b?i.jsxs("div",{className:"error-message-box",children:["Error: ",b]}):t?i.jsxs("div",{className:"pharmacy-billing-page",children:[" ",i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"LAB INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:L?`${L} Lab`:"Lab Bill"}),(B||I)&&i.jsxs("div",{className:"clinic-details-print",children:[B&&i.jsx("span",{className:"small-text clinic-address",children:B}),I&&i.jsx("span",{className:"small-text clinic-notes",children:I})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(eo,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Jm,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Qm,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(an,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(eo,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Jm,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(Hl,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Qm,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),f.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"TEST DESCRIPTION"}),i.jsx("th",{children:"PRICE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:f.map((D,pe)=>{const Ne=D.price??0,te=Ne*(D.discount_percentage??0)/100,K=Ne-te;return i.jsxs("tr",{children:[i.jsx("td",{children:pe+1}),i.jsx("td",{children:D.name}),i.jsx("td",{children:typeof D.price=="number"?D.price.toFixed(2):Number(D.price||0).toFixed(2)}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:D.discount_percentage??0,onChange:J=>Y(pe,parseFloat(J.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsx("td",{children:K.toFixed(2)})]},pe)})})]}):i.jsx("p",{children:"No tests in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[M&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${T!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Uh,{value:M,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",V.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",de.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",he.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",de.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:V,onChange:D=>G(parseFloat(D.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:S||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",he.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:M?i.jsxs(i.Fragment,{children:[i.jsx(Uh,{value:M,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:T,onChange:D=>P(D.target.value),className:"payment-mode-select",disabled:S||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status!=="billed"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:le,className:"secondary-button print-preview-button no-print",disabled:S||f.length===0,children:"Print Preview"}),i.jsx("button",{onClick:oe,className:"primary-button",disabled:S||f.length===0,children:S?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e("/billing",{state:{billId:t.bill_id}}),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})]}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},oie=()=>{const e=At(),[n,t]=w.useState(!0),[r,a]=w.useState([]),[o,l]=w.useState(""),[d,f]=w.useState(!0),[u,h]=w.useState(!1),[g,b]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[v,S]=w.useState(null),[k,T]=w.useState(!1),P=(I,F)=>{S({type:I,message:F}),setTimeout(()=>S(null),3e3)},M=I=>{switch(I){case"doctor":return i.jsx(Fk,{size:14,className:"text-blue-600"});case"receptionist":return i.jsx(_w,{size:14,className:"text-green-600"});case"pharmacy":return i.jsx(lg,{size:14,className:"text-purple-600"});case"lab":return i.jsx(Hl,{size:14,className:"text-yellow-600"});default:return i.jsx(Db,{size:14,className:"text-gray-500"})}},R=I=>{switch(I){case"doctor":return"avatar-blue";case"receptionist":return"avatar-green";case"pharmacy":return"avatar-purple";case"lab":return"avatar-yellow";default:return"avatar-gray"}},z=w.useCallback(async()=>{t(!0);try{const I=await me("/staff");if(I.ok){const F=await I.json();a(F.map(V=>({...V,id:V._id||V.id})))}}catch(I){console.error("Error fetching staff:",I),P("error","Failed to load staff list")}finally{t(!1)}},[]),$=w.useCallback(async()=>{f(!0);try{const I=await me("/api/clinics/settings");if(I.ok){const F=await I.json();b({admissionCharge:parseFloat(F.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(F.perDayCharge||0).toFixed(2),otherCharges:parseFloat(F.otherCharges||0).toFixed(2),aiMemory:F.aiMemory||"",clinicWideSystemPrompt:F.clinicWideSystemPrompt||"",gemini_api_key:F.gemini_api_key||"",low_stock_threshold:F.low_stock_threshold!==void 0&&F.low_stock_threshold!==null?String(F.low_stock_threshold):"10",name:F.name||"",logoUrl:F.logoUrl||"",upi_id:F.upi_id||"",address:F.address||"",notes:F.notes||"",clinic_id:F.clinic_id})}}catch(I){console.error("Error fetching settings:",I),P("error","Failed to load settings")}finally{f(!1)}},[]);w.useEffect(()=>{z(),$()},[z,$]);const L=I=>{const{name:F,value:V}=I.target;b(re=>({...re,[F]:V}))},U=async()=>{h(!0);try{const I=parseFloat(g.admissionCharge),F=parseFloat(g.perDayCharge),V=parseFloat(g.otherCharges),re=parseInt(g.low_stock_threshold);if((await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:g.name,admissionCharge:I,perDayCharge:F,otherCharges:V,aiMemory:g.aiMemory,clinicWideSystemPrompt:g.clinicWideSystemPrompt,gemini_api_key:g.gemini_api_key,low_stock_threshold:re,logoUrl:g.logoUrl,upi_id:g.upi_id,address:g.address,notes:g.notes})})).ok)P("success","Changes saved successfully");else throw new Error("Failed to save")}catch(I){console.error("Error saving settings:",I),P("error","Failed to save settings")}finally{h(!1)}},B=r.filter(I=>I.name.toLowerCase().includes(o.toLowerCase())||I.role.toLowerCase().includes(o.toLowerCase())),W=async I=>{for(const F of I){const V=document.getElementById(F);V&&(V.scrollIntoView({behavior:"smooth",block:"center"}),V.classList.add("ai-feedback-glow"),await new Promise(re=>setTimeout(re,1500)),V.classList.remove("ai-feedback-glow"))}};return i.jsxs("div",{className:"clinic-hub-container",children:[i.jsxs("header",{className:"clinic-hub-header",children:[i.jsxs("div",{className:"clinic-hub-title",children:[i.jsx("h1",{children:"Clinic Hub"}),i.jsx("p",{className:"clinic-hub-subtitle",children:"Manage your ecosystem"})]}),i.jsxs("div",{className:"clinic-hub-actions",children:[v&&i.jsx("div",{className:`px-4 py-2 rounded-md text-sm font-medium ${v.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.message}),i.jsxs("button",{className:"btn-assistant",onClick:()=>T(!0),style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",backgroundColor:"#7c3aed",color:"white",borderRadius:"6px",marginRight:"8px"},children:[i.jsx(Xx,{size:16})," AI Assistant"]}),i.jsxs("button",{className:"btn-add-staff",onClick:()=>e("/dashboard/staff/add"),children:[i.jsx(tl,{size:16})," Add Staff"]}),i.jsxs("button",{className:"btn-save-changes",onClick:U,disabled:u,children:[i.jsx(zd,{size:16})," ",u?"Saving...":"Save Changes"]})]})]}),i.jsxs("main",{className:"clinic-hub-content",children:[i.jsxs("div",{className:"team-directory-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx(Gh,{size:18,className:"text-gray-500"}),i.jsxs("span",{className:"panel-title",children:["Team Directory (",r.length,")"]})]}),i.jsx("div",{className:"search-container",children:i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(bi,{size:16,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Find member...",className:"search-input",value:o,onChange:I=>l(I.target.value)})]})}),i.jsx("div",{className:"team-list",children:n?i.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading staff..."}):B.length===0?i.jsx("div",{className:"empty-state",children:"No staff found."}):B.map(I=>i.jsxs("div",{id:`staff-member-${I.id}`,className:"team-member-item",children:[i.jsx("div",{className:`member-avatar ${R(I.role)}`,children:I.name.charAt(0).toUpperCase()}),i.jsxs("div",{className:"member-info",children:[i.jsx("div",{className:"member-name",children:I.name}),i.jsxs("div",{className:"member-role",children:[M(I.role),I.role]})]}),i.jsx("span",{className:`member-status ${I.active?"status-active":"status-inactive"}`,children:I.active?"Active":"Inactive"}),i.jsx("button",{className:"btn-edit-member",onClick:()=>e(`/dashboard/staff/edit/${I.id}`),children:i.jsx(Yl,{size:16})})]},I.id))})]}),i.jsxs("div",{className:"config-console-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx(Ik,{size:18,className:"text-gray-500"}),i.jsx("span",{className:"panel-title",children:"Configuration Console"})]}),d?i.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading settings..."}):i.jsxs("div",{className:"config-content",children:[i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Rk,{size:16})," CLINIC IDENTITY & LOCATION"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Clinic Name"}),i.jsx("input",{type:"text",className:"form-input",name:"name",id:"setting-name",value:g.name,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Logo URL"}),i.jsx("input",{type:"url",className:"form-input",placeholder:"https://",name:"logoUrl",id:"setting-logoUrl",value:g.logoUrl,onChange:L})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Address"}),i.jsx("textarea",{className:"form-textarea",placeholder:"Full physical address",name:"address",id:"setting-address",value:g.address,onChange:L})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Fh,{size:16})," FINANCIAL OPERATIONS"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Admission Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"admissionCharge",id:"setting-admissionCharge",value:g.admissionCharge,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Per Day Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"perDayCharge",id:"setting-perDayCharge",value:g.perDayCharge,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Other Charges ()"}),i.jsx("input",{type:"number",className:"form-input",name:"otherCharges",id:"setting-otherCharges",value:g.otherCharges,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"UPI ID"}),i.jsx("input",{type:"text",className:"form-input",name:"upi_id",id:"setting-upi_id",value:g.upi_id,onChange:L})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Ak,{size:16})," INVENTORY & AI"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Low Stock Threshold"}),i.jsx("input",{type:"number",className:"form-input",name:"low_stock_threshold",id:"setting-low_stock_threshold",value:g.low_stock_threshold,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Gemini API Key"}),i.jsx("input",{type:"password",className:"form-input",name:"gemini_api_key",id:"setting-gemini_api_key",value:g.gemini_api_key,onChange:L,placeholder:"******************"})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Clinic-Wide System Prompt"}),i.jsx("textarea",{className:"form-textarea",name:"clinicWideSystemPrompt",id:"setting-clinicWideSystemPrompt",value:g.clinicWideSystemPrompt,onChange:L,placeholder:"Instructions for the AI..."})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"AI Memory (Context)"}),i.jsx("textarea",{className:"form-textarea",name:"aiMemory",id:"setting-aiMemory",value:g.aiMemory,onChange:L,placeholder:"Shared context for the AI..."})]})]})]})]})]})]}),k&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex justify-end",children:i.jsx("div",{className:"w-96 bg-white h-full shadow-2xl animate-slide-in-right",children:i.jsx(G2,{onClose:()=>T(!1),settings:g,staffList:r,onSettingsUpdate:$,onStaffUpdate:z,onHighlight:W})})})]})},lie="_container_1sjqk_1",cie="_header_1sjqk_15",uie="_title_1sjqk_37",die="_controls_1sjqk_51",fie="_dateInputGroup_1sjqk_63",hie="_dateInputLabel_1sjqk_75",pie="_dateInput_1sjqk_63",mie="_section_1sjqk_121",gie="_sectionTitle_1sjqk_137",yie="_statsGrid_1sjqk_157",xie="_statCard_1sjqk_171",bie="_statTitle_1sjqk_197",vie="_statValue_1sjqk_213",wie="_statSubtitle_1sjqk_225",Sie="_revenueGrid_1sjqk_239",Nie="_revenueCard_1sjqk_253",Cie="_revenueCardTitle_1sjqk_267",_ie="_revenueCardList_1sjqk_281",jie="_revenueCardListItem_1sjqk_293",kie="_tableContainer_1sjqk_321",Tie="_table_1sjqk_321",Eie="_textGreen_1sjqk_395",Aie="_textRed_1sjqk_403",Pie="_loadingContainer_1sjqk_421",Die="_errorAlert_1sjqk_439",Zt={container:lie,header:cie,title:uie,controls:die,dateInputGroup:fie,dateInputLabel:hie,dateInput:pie,section:mie,sectionTitle:gie,statsGrid:yie,statCard:xie,statTitle:bie,statValue:vie,statSubtitle:wie,revenueGrid:Sie,revenueCard:Nie,revenueCardTitle:Cie,revenueCardList:_ie,revenueCardListItem:jie,tableContainer:kie,table:Tie,textGreen:Eie,textRed:Aie,loadingContainer:Pie,errorAlert:Die},Iie=()=>{const e=At(),n=qr(),t=new URLSearchParams(n.search),r=t.get("startDate"),a=t.get("endDate"),o=new Date().toISOString().split("T")[0],[l,d]=w.useState(r||o),[f,u]=w.useState(a||o),[h,g]=w.useState(!1),[b,v]=w.useState(null),{setAnalysisDateRange:S,analysisDateRange:k,setAnalysisData:T,registerAnalysisNavigator:P,registerAnalysisRefresher:M}=xw(),[R,z]=w.useState(0),[$,L]=w.useState(0),[U,B]=w.useState(null),[W,I]=w.useState(null),[F,V]=w.useState({reception:{},pharmacy:{},lab:{}}),[re,ie]=w.useState(null),G=w.useCallback(async(ne,le)=>{g(!0),v(null);const oe=ne||l,E=le||f;if(z(0),L(0),B(null),I(null),V({reception:{},pharmacy:{},lab:{}}),ie(null),!oe||!E){v("Please select both start and end dates."),g(!1);return}try{const de=e3(),[he,D,pe,Ne]=await Promise.all([me(`/api/bills?startDate=${l}&endDate=${f}`),me(`/api/payment/admission?startDate=${l}&endDate=${f}`),me(`/api/subscriptions/transactions/manual?startDate=${l}&endDate=${f}`),de?me(`/api/inventory/comprehensive-analysis?startDate=${l}&endDate=${f}&clinicId=${de}`):Promise.resolve(null)]);if(he.ok&&D.ok&&pe.ok){const te=await he.json(),K=await D.json(),J=await pe.json(),ye=te.bills||[],He=K.admissionPayments||[],Q=J||[];let Pe=0,Re=0;const Le={},_e={consultation:0,pharmacy:0,lab:0,other:0},Ke={reception:{},pharmacy:{},lab:{}};ye.forEach(Ye=>{if(Ye.status==="paid"||Ye.type==="pharmacy_return"){const it=parseFloat(Ye.amount.toString()),xt=Ye.payment_mode||"Unknown";let Nt=Ye.type||"other";Nt==="pharmacy_return"&&(Re+=it,Nt="pharmacy"),Pe+=it,Le[xt]=(Le[xt]||0)+it,_e.hasOwnProperty(Nt)?_e[Nt]=(_e[Nt]||0)+it:_e.other=(_e.other||0)+it,Nt==="pharmacy"?Ke.pharmacy[xt]=(Ke.pharmacy[xt]||0)+it:Nt==="lab"?Ke.lab[xt]=(Ke.lab[xt]||0)+it:Ke.reception[xt]=(Ke.reception[xt]||0)+it}}),He.forEach(Ye=>{const it=parseFloat(Ye.amount_paid.toString()),xt=Ye.payment_mode||"Unknown";Pe+=it,Le[xt]=(Le[xt]||0)+it,Ke.reception[xt]=(Ke.reception[xt]||0)+it}),Q.forEach(Ye=>{var Nt,ue;const it=parseFloat(((ue=(Nt=Ye.subscriptionPlan)==null?void 0:Nt.price)==null?void 0:ue.toString())??"0"),xt=Ye.subscription_payment_method||"manual";Pe+=it,Le[xt]=(Le[xt]||0)+it,Ke.reception[xt]=(Ke.reception[xt]||0)+it}),z(Pe),L(Re),B(Le),I(_e),V(Ke)}if(Ne&&Ne.ok){const te=await Ne.json();ie(te)}}catch(de){console.error("Analysis Fetch Error:",de),v("Failed to fetch analysis data. Please try again.")}finally{g(!1)}},[l,f]);w.useEffect(()=>{P(ne=>{const le=`analysis-${ne}`,oe=document.getElementById(le);oe&&(oe.scrollIntoView({behavior:"smooth",block:"center"}),oe.classList.add("ai-highlight-glow"),setTimeout(()=>oe.classList.remove("ai-highlight-glow"),2e3))})},[P]),w.useEffect(()=>{M(async()=>(await G(),null))},[M,G]),w.useEffect(()=>{if(k.startDate&&k.endDate){const ne=k.startDate.toISOString().split("T")[0],le=k.endDate.toISOString().split("T")[0];(ne!==l||le!==f)&&(d(ne),u(le))}},[k]),w.useEffect(()=>{const ne=new URLSearchParams(n.search),le=ne.get("section"),oe=ne.get("startDate"),E=ne.get("endDate");if(oe&&E){d(oe),u(E);const de=k.startDate?k.startDate.toISOString().split("T")[0]:null,he=k.endDate?k.endDate.toISOString().split("T")[0]:null;(de!==oe||he!==E)&&S({startDate:new Date(oe),endDate:new Date(E)})}if(le){const de=`analysis-${le}`;setTimeout(()=>{const he=document.getElementById(de);he&&(he.scrollIntoView({behavior:"smooth",block:"center"}),he.classList.add("ai-highlight-glow"),setTimeout(()=>he.classList.remove("ai-highlight-glow"),2e3))},500)}},[n.search]),w.useEffect(()=>{G()},[l,f,G]),w.useEffect(()=>{!h&&(R>0||re)&&T({totalRevenue:R,inventoryValue:0,pharmacyRevenue:(W==null?void 0:W.pharmacy)||0,labRevenue:(W==null?void 0:W.lab)||0,receptionRevenue:((W==null?void 0:W.consultation)||0)+((W==null?void 0:W.other)||0),inventorySummary:re?{totalItemsAnalyzed:re.pharmacyAnalysis.length,netPositiveItems:re.pharmacyAnalysis.filter(ne=>ne.net_change>0).length}:null})},[R,re,W,h,T]);const Y=ne=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(ne);return i.jsxs("div",{className:Zt.container,children:[i.jsxs("div",{className:Zt.header,children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-gray-100 rounded-full",children:i.jsx(an,{size:20,className:"text-gray-600"})}),i.jsx("h1",{className:Zt.title,children:"Analysis Dashboard"})]}),i.jsxs("div",{className:Zt.controls,children:[i.jsxs("div",{className:Zt.dateInputGroup,children:[i.jsx("label",{className:Zt.dateInputLabel,children:"From:"}),i.jsx("input",{type:"date",className:Zt.dateInput,value:l,onChange:ne=>{d(ne.target.value),f&&S({startDate:new Date(ne.target.value),endDate:new Date(f)})}})]}),i.jsxs("div",{className:Zt.dateInputGroup,children:[i.jsx("label",{className:Zt.dateInputLabel,children:"To:"}),i.jsx("input",{type:"date",className:Zt.dateInput,value:f,onChange:ne=>{u(ne.target.value),l&&S({startDate:new Date(l),endDate:new Date(ne.target.value)})}})]})]})]}),b&&i.jsxs("div",{className:Zt.errorAlert,children:[i.jsx(Ir,{size:20}),i.jsx("span",{children:b})]}),!h&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{className:Zt.section,id:"analysis-financial",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Fh,{className:"text-blue-600"}),i.jsx("h2",{className:Zt.sectionTitle,children:"Financial Performance"})]}),i.jsxs("div",{className:Zt.statsGrid,children:[i.jsxs("div",{className:Zt.statCard,children:[i.jsx("div",{className:Zt.statTitle,children:"Total Revenue Collected"}),i.jsx("div",{className:`${Zt.statValue} text-blue-600`,children:Y(R)}),i.jsx("div",{className:Zt.statSubtitle,children:"All payment modes"})]}),U&&Object.entries(U).map(([ne,le])=>i.jsxs("div",{className:Zt.statCard,children:[i.jsxs("div",{className:Zt.statTitle,children:[ne," Collections"]}),i.jsx("div",{className:Zt.statValue,children:Y(le)})]},ne))]}),F&&i.jsxs("div",{className:Zt.revenueGrid,children:[i.jsxs("div",{className:Zt.revenueCard,children:[i.jsx("h3",{className:Zt.revenueCardTitle,children:"Reception / Clinic"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:Y(((W==null?void 0:W.consultation)||0)+((W==null?void 0:W.other)||0))}),i.jsx("ul",{className:Zt.revenueCardList,children:Object.entries(F.reception).map(([ne,le])=>i.jsxs("li",{className:Zt.revenueCardListItem,children:[i.jsx("span",{children:ne}),i.jsx("span",{className:"font-medium text-gray-900",children:Y(le)})]},ne))})]}),i.jsxs("div",{className:Zt.revenueCard,children:[i.jsx("h3",{className:Zt.revenueCardTitle,children:"Pharmacy"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:Y((W==null?void 0:W.pharmacy)||0)}),$<0&&i.jsxs("div",{className:"text-sm text-red-500 mb-2",children:["Returns: ",Y($)]}),i.jsx("ul",{className:Zt.revenueCardList,children:Object.entries(F.pharmacy).map(([ne,le])=>i.jsxs("li",{className:Zt.revenueCardListItem,children:[i.jsx("span",{children:ne}),i.jsx("span",{className:"font-medium text-gray-900",children:Y(le)})]},ne))})]}),i.jsxs("div",{className:Zt.revenueCard,children:[i.jsx("h3",{className:Zt.revenueCardTitle,children:"Laboratory"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:Y((W==null?void 0:W.lab)||0)}),i.jsx("ul",{className:Zt.revenueCardList,children:Object.entries(F.lab).map(([ne,le])=>i.jsxs("li",{className:Zt.revenueCardListItem,children:[i.jsx("span",{children:ne}),i.jsx("span",{className:"font-medium text-gray-900",children:Y(le)})]},ne))})]})]})]}),i.jsxs("section",{className:Zt.section,id:"analysis-inventory",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx($d,{className:"text-emerald-600"}),i.jsx("h2",{className:Zt.sectionTitle,children:"Inventory Movement"})]}),re&&re.pharmacyAnalysis.length>0?i.jsx("div",{className:Zt.tableContainer,children:i.jsxs("table",{className:Zt.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Item Name"}),i.jsx("th",{children:"Stock In"}),i.jsx("th",{children:"Stock Out"}),i.jsx("th",{children:"Net Change"}),i.jsx("th",{className:"text-right",children:"Est. Revenue"}),i.jsx("th",{className:"text-right",children:"Est. Profit"})]})}),i.jsx("tbody",{children:re.pharmacyAnalysis.map(ne=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:ne.name}),i.jsx("div",{className:"text-xs text-gray-500",children:ne.supplier})]}),i.jsxs("td",{className:Zt.textGreen,children:["+",ne.quantity_in,Object.entries(ne.quantity_in_by_reason).map(([le,oe])=>i.jsxs("div",{className:"text-xs opacity-75",children:[le,": ",oe]},le))]}),i.jsxs("td",{className:Zt.textRed,children:["-",ne.quantity_out,Object.entries(ne.quantity_out_by_reason).map(([le,oe])=>i.jsxs("div",{className:"text-xs opacity-75",children:[le,": ",oe]},le))]}),i.jsx("td",{children:i.jsxs("span",{className:`font-semibold ${ne.net_change>=0?"text-green-600":"text-red-600"}`,children:[ne.net_change>0?"+":"",ne.net_change]})}),i.jsx("td",{className:"text-right font-medium",children:Y(ne.revenue)}),i.jsx("td",{className:`text-right font-medium ${ne.profit>=0?"text-green-600":"text-red-600"}`,children:Y(ne.profit)})]},ne.drug_id))})]})}):i.jsx("div",{className:"text-center py-8 text-gray-500 mb-4 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No inventory movement recorded for this period."})]})]}),h&&i.jsxs("div",{className:Zt.loadingContainer,children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),i.jsx("div",{children:"Analyzing Financial & Inventory Data..."})]})]})};function Rie(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),h=R=>{r(R),n(!0),R.role==="admin"&&!R.has_seen_tutorial&&u(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const R=localStorage.getItem("authToken"),z=localStorage.getItem("currentUser");if(R&&z)try{const $=JSON.parse(z);r($),n(!0),$.role==="admin"&&!$.has_seen_tutorial&&u(!0)}catch($){console.error("Error parsing stored user data:",$),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}o(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const z=await jre();d(z)}catch(z){console.error("Error fetching clinic pro plan status:",z),d({hasProPlan:!1})}else d(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const R=z=>{z.preventDefault(),v(z),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",R),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",R)}},[]),w.useEffect(()=>{const R=window.matchMedia("(prefers-color-scheme: dark)"),z=()=>{R.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return z(),R.addEventListener("change",z),()=>{R.removeEventListener("change",z),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const R=b;R.prompt();const{outcome:z}=await R.userChoice;console.log(`User response to the install prompt: ${z}`),v(null),k(!1)},[b]),P=async()=>{if(t)try{(await me(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(z=>z?{...z,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),u(!1)):console.error("Failed to update tutorial status on backend.")}catch(R){console.error("Error marking tutorial as seen:",R)}};return a?i.jsx(_P,{}):i.jsx(kP,{clientId:"277898779560-33obduhn8r758rini4qagetdrupvisri.apps.googleusercontent.com",children:i.jsx(aI,{children:i.jsx(rI,{children:i.jsx(iI,{children:i.jsxs(HD,{children:[i.jsx(nI,{children:i.jsxs(_h,{children:[i.jsx(ht,{path:"/login",element:e?i.jsx(Cn,{to:"/dashboard"}):i.jsx(oW,{onLoginSuccess:h})}),i.jsx(ht,{path:"/register",element:e?i.jsx(Cn,{to:"/dashboard"}):i.jsx(lW,{})}),i.jsx(ht,{path:"/handle-complaint-url",element:e?i.jsx(tie,{}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/live-api",element:e?i.jsx(oY,{}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/create-lab-order",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(bE,{currentUser:t})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/manage-admission",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(yE,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/lab/report/:orderId",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(qj,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(qj,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/add-patient",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(W1,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/billing",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Ine,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(zj,{}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/edit-complaint/patient/:patientId",element:e&&t?i.jsx(zj,{}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(DA,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/*",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:Mie(t.role,t,me)}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Vne,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/lab/search-report",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Hne,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Gne,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Rne,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/inventory",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(IA,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/inventory/add",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(KQ,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/inventory/edit/:id",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(TE,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/lab-inventory",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(iS,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Pne,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Jne,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(yre,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/start-clinic-subscription",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Are,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/refill-reminders",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(eie,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/create-custom-bill",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(xE,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(aie,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/lab-billing/:orderId",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(sie,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/analysis",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Iie,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/clinic-hub",element:e&&t?i.jsx(or,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(oie,{})}):i.jsx(Cn,{to:"/login"})}),i.jsx(ht,{path:"*",element:i.jsx(Cn,{to:e?"/dashboard":"/login"})})]})}),f&&i.jsx(Zre,{onClose:()=>u(!1),onMarkAsSeen:P}),e&&t&&i.jsx(Oie,{user:t}),e&&t&&i.jsx(sW,{})]})})})})})}const Mie=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(_h,{children:[i.jsx(ht,{index:!0,element:i.jsx(Yre,{})}),i.jsx(ht,{path:"clinic-subscriptions",element:i.jsx(kre,{})}),i.jsx(ht,{path:"clinic-subscriptions/add",element:i.jsx(Tre,{})}),i.jsx(ht,{path:"clinic-subscriptions/edit/:id",element:i.jsx(Ere,{})}),i.jsx(ht,{path:"users",element:i.jsx(Pre,{})})," ",i.jsx(ht,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(_h,{children:[i.jsx(ht,{index:!0,element:i.jsx(wW,{fetchWithAuth:t})}),i.jsx(ht,{path:"staff",element:i.jsx(Qne,{fetchWithAuth:t})}),i.jsx(ht,{path:"staff/add",element:i.jsx(XQ,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(ht,{path:"staff/edit/:id",element:i.jsx(ZQ,{})}),i.jsx(ht,{path:"patients/add",element:i.jsx(W1,{})}),i.jsx(ht,{path:"search-patient",element:i.jsx(Eh,{})}),i.jsx(ht,{path:"patients",element:i.jsx(G1,{})}),i.jsx(ht,{path:"inventory",element:i.jsx(kE,{})}),i.jsx(ht,{path:"inventory/edit/:id",element:i.jsx(TE,{})}),i.jsx(ht,{path:"distributors",element:i.jsx(Hj,{})}),i.jsx(ht,{path:"purchase",element:i.jsx(Gj,{})})," ",i.jsx(ht,{path:"queue",element:i.jsx(M0,{})}),i.jsx(ht,{path:"subscriptions",element:i.jsx(pre,{})}),i.jsx(ht,{path:"subscriptions/add",element:i.jsx(mre,{})}),i.jsx(ht,{path:"subscriptions/edit/:id",element:i.jsx(gre,{})}),i.jsx(ht,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(_h,{children:[i.jsx(ht,{index:!0,element:i.jsx(Cn,{to:"search-patient",replace:!0})}),i.jsx(ht,{path:"search-patient",element:i.jsx(Eh,{})}),i.jsx(ht,{path:"queue",element:i.jsx(M0,{})}),i.jsx(ht,{path:":patientId",element:i.jsx(M0,{})}),i.jsx(ht,{path:"add-patient",element:i.jsx(W1,{})}),i.jsx(ht,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(_h,{children:[i.jsx(ht,{index:!0,element:i.jsx(NW,{currentUser:n})}),i.jsx(ht,{path:"all-patients",element:i.jsx(G1,{})}),i.jsx(ht,{path:"search-patient",element:i.jsx(Eh,{})}),i.jsx(ht,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(YQ,{});case"pharmacy":return i.jsxs(_h,{children:[i.jsx(ht,{index:!0,element:i.jsx(WQ,{})}),i.jsx(ht,{path:"inventory",element:i.jsx(IA,{})}),i.jsx(ht,{path:"settings",element:i.jsx(JQ,{})}),i.jsx(ht,{path:"add-order",element:i.jsx(Mne,{})}),i.jsx(ht,{path:"edit-pharmacy-order/:orderId",element:i.jsx(DA,{})}),i.jsx(ht,{path:"orders/:orderId",element:i.jsx(ore,{})}),i.jsx(ht,{path:"search-patient-records",element:i.jsx(Eh,{})}),i.jsx(ht,{path:"distributors",element:i.jsx(Hj,{})}),i.jsx(ht,{path:"purchase",element:i.jsx(Gj,{})})," ",i.jsx(ht,{path:"*",element:i.jsx(Cn,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},or=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:o})=>{const l=At(),[d,f]=w.useState(!1),[u,h]=w.useState(window.innerWidth<=768),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>m1.subscribe(P=>{S(P)}),[]),w.useEffect(()=>{const P=()=>{h(window.innerWidth<=768)};return window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[]),w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const M=await me("/api/clinics/settings");if(M.ok){const R=await M.json();b(R.logoUrl)}else console.error("Failed to fetch clinic details for display:",M.statusText),b(null)}catch(M){console.error("Error fetching clinic details for display:",M),b(null)}else b(null)})()},[e==null?void 0:e.clinic_id]);const k=()=>{f(!d)},{toggleCommandBar:T}=Nb();return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("a",{href:"#",onClick:P=>{P.preventDefault(),l("/dashboard")},className:"logo-container",children:i.jsx("img",{src:g||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:"Newtons Ai"}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),o&&(o.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),i.jsx("button",{onClick:T,className:"p-2 mr-2 text-gray-600 hover:text-violet-600 transition-colors",title:"Search & Commands (Ctrl+K)",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"11",cy:"11",r:"8"}),i.jsx("path",{d:"m21 21-4.3-4.3"})]})}),i.jsx("button",{className:"hamburger-icon",onClick:k,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]}),v&&i.jsx("div",{className:"global-loading-bar"})]}),i.jsx("main",{className:"main-content",children:t}),u?i.jsx(xW,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k,roleNavigation:gE}):i.jsx(yW,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k}),!u&&d&&i.jsx("div",{className:"side-panel-overlay",onClick:k}),!u&&d&&i.jsx("div",{className:"side-panel-overlay",onClick:k})]})},Oie=({user:e})=>{const{isOpen:n,closeAssistant:t}=xw(),r=At(),[a,o]=w.useState(null),[l,d]=w.useState([]);return w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const[u,h]=await Promise.all([me("/api/clinics/settings"),me("/api/staff")]);u.ok&&o(await u.json()),h.ok&&d(await h.json())}catch(u){console.error("Failed to fetch initial AI context",u)}})()},[e.clinic_id]),n?i.jsx("div",{className:"ai-assistant-wrapper",children:i.jsx(G2,{onClose:t,settings:a,staffList:l,onSettingsUpdate:()=>{},onStaffUpdate:()=>{},onHighlight:f=>{f.forEach(u=>{if(u.startsWith("navigate_")){const h=u.replace("navigate_","");r(`/dashboard/analysis?section=${h}`)}else{const h=document.getElementById(u);h&&(h.scrollIntoView({behavior:"smooth",block:"center"}),h.classList.add("ai-highlight-glow"),setTimeout(()=>h.classList.remove("ai-highlight-glow"),2e3))}})}})}):null};CP.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(Rie,{})}));
