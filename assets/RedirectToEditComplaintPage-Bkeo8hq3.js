import{j as l,f as r}from"./index-CRA8Xzko.js";import{u as m,f as u,r as f}from"./react-vendor-Cc0P4_ZX.js";import"./utils-vendor-azd6ta8e.js";import"./ai-vendor-CB5T-uN5.js";import"./ui-vendor-SmiJk_kJ.js";import"./chart-vendor-BcjzKorn.js";const L=()=>{const t=m(),s=u();return f.useEffect(()=>{const c=new URLSearchParams(s.search),p=c.get("token"),o=c.get("caseDetails");p?(async()=>{try{const e=await r(`/api/patients?search=${p}&limit=1`);if(!e.ok)throw new Error("Failed to fetch patient by token");const n=(await e.json()).patients[0];if(!n)throw new Error("Patient with the given token not found");const d=await r(`/api/queue/patient/${n.id}/latest`);if(d.ok){const i=await d.json();if(i!=null&&i._id){t(`/dashboard/edit-complaint/${i._id}`,{state:{initialComplaint:o}});return}}const h=await r("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:n.id,complaint:o})});if(!h.ok)throw new Error("Failed to create queue entry");const a=await h.json();if(a!=null&&a.id)t(`/dashboard/edit-complaint/${a.id}`,{state:{initialComplaint:o}});else throw new Error("Failed to get ID from new queue entry.")}catch(e){console.error("Error handling complaint URL:",e),t("/dashboard/search-patient")}})():t("/dashboard/search-patient")},[s,t]),l.jsx("div",{children:"Loading..."})};export{L as default};
