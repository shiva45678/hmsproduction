var QA=Object.defineProperty;var JA=(e,n,t)=>n in e?QA(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var qn=(e,n,t)=>JA(e,typeof n!="symbol"?n+"":n,t);function KA(e,n){for(var t=0;t<n.length;t++){const i=n[t];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(i,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var Qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Lv={exports:{}},xm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aS;function XA(){if(aS)return xm;aS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(i,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var d in a)d!=="key"&&(o[d]=a[d])}else o=a;return a=o.ref,{$$typeof:e,type:i,key:l,ref:a!==void 0?a:null,props:o}}return xm.Fragment=n,xm.jsx=t,xm.jsxs=t,xm}var sS;function ZA(){return sS||(sS=1,Lv.exports=XA()),Lv.exports}var r=ZA(),Fv={exports:{}},Qt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oS;function eP(){if(oS)return Qt;oS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=g&&A[g]||A["@@iterator"],typeof A=="function"?A:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function T(A,oe,ue){this.props=A,this.context=oe,this.refs=k,this.updater=ue||v}T.prototype.isReactComponent={},T.prototype.setState=function(A,oe){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,oe,"setState")},T.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function P(){}P.prototype=T.prototype;function M(A,oe,ue){this.props=A,this.context=oe,this.refs=k,this.updater=ue||v}var I=M.prototype=new P;I.constructor=M,S(I,T.prototype),I.isPureReactComponent=!0;var U=Array.isArray,L={H:null,A:null,T:null,S:null,V:null},F=Object.prototype.hasOwnProperty;function z(A,oe,ue,D,se,be){return ue=be.ref,{$$typeof:e,type:A,key:oe,ref:ue!==void 0?ue:null,props:be}}function $(A,oe){return z(A.type,oe,void 0,void 0,void 0,A.props)}function B(A){return typeof A=="object"&&A!==null&&A.$$typeof===e}function R(A){var oe={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(ue){return oe[ue]})}var V=/\/+/g;function Y(A,oe){return typeof A=="object"&&A!==null&&A.key!=null?R(""+A.key):oe.toString(36)}function ie(){}function te(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(ie,ie):(A.status="pending",A.then(function(oe){A.status==="pending"&&(A.status="fulfilled",A.value=oe)},function(oe){A.status==="pending"&&(A.status="rejected",A.reason=oe)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function W(A,oe,ue,D,se){var be=typeof A;(be==="undefined"||be==="boolean")&&(A=null);var ee=!1;if(A===null)ee=!0;else switch(be){case"bigint":case"string":case"number":ee=!0;break;case"object":switch(A.$$typeof){case e:case n:ee=!0;break;case p:return ee=A._init,W(ee(A._payload),oe,ue,D,se)}}if(ee)return se=se(A),ee=D===""?"."+Y(A,0):D,U(se)?(ue="",ee!=null&&(ue=ee.replace(V,"$&/")+"/"),W(se,oe,ue,"",function(Pe){return Pe})):se!=null&&(B(se)&&(se=$(se,ue+(se.key==null||A&&A.key===se.key?"":(""+se.key).replace(V,"$&/")+"/")+ee)),oe.push(se)),1;ee=0;var ce=D===""?".":D+":";if(U(A))for(var re=0;re<A.length;re++)D=A[re],be=ce+Y(D,re),ee+=W(D,oe,ue,be,se);else if(re=b(A),typeof re=="function")for(A=re.call(A),re=0;!(D=A.next()).done;)D=D.value,be=ce+Y(D,re++),ee+=W(D,oe,ue,be,se);else if(be==="object"){if(typeof A.then=="function")return W(te(A),oe,ue,D,se);throw oe=String(A),Error("Objects are not valid as a React child (found: "+(oe==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":oe)+"). If you meant to render a collection of children, use an array instead.")}return ee}function H(A,oe,ue){if(A==null)return A;var D=[],se=0;return W(A,D,"","",function(be){return oe.call(ue,be,se++)}),D}function Q(A){if(A._status===-1){var oe=A._result;oe=oe(),oe.then(function(ue){(A._status===0||A._status===-1)&&(A._status=1,A._result=ue)},function(ue){(A._status===0||A._status===-1)&&(A._status=2,A._result=ue)}),A._status===-1&&(A._status=0,A._result=oe)}if(A._status===1)return A._result.default;throw A._result}var J=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var oe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(oe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function fe(){}return Qt.Children={map:H,forEach:function(A,oe,ue){H(A,function(){oe.apply(this,arguments)},ue)},count:function(A){var oe=0;return H(A,function(){oe++}),oe},toArray:function(A){return H(A,function(oe){return oe})||[]},only:function(A){if(!B(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Qt.Component=T,Qt.Fragment=t,Qt.Profiler=a,Qt.PureComponent=M,Qt.StrictMode=i,Qt.Suspense=f,Qt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Qt.__COMPILER_RUNTIME={__proto__:null,c:function(A){return L.H.useMemoCache(A)}},Qt.cache=function(A){return function(){return A.apply(null,arguments)}},Qt.cloneElement=function(A,oe,ue){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var D=S({},A.props),se=A.key,be=void 0;if(oe!=null)for(ee in oe.ref!==void 0&&(be=void 0),oe.key!==void 0&&(se=""+oe.key),oe)!F.call(oe,ee)||ee==="key"||ee==="__self"||ee==="__source"||ee==="ref"&&oe.ref===void 0||(D[ee]=oe[ee]);var ee=arguments.length-2;if(ee===1)D.children=ue;else if(1<ee){for(var ce=Array(ee),re=0;re<ee;re++)ce[re]=arguments[re+2];D.children=ce}return z(A.type,se,void 0,void 0,be,D)},Qt.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:o,_context:A},A},Qt.createElement=function(A,oe,ue){var D,se={},be=null;if(oe!=null)for(D in oe.key!==void 0&&(be=""+oe.key),oe)F.call(oe,D)&&D!=="key"&&D!=="__self"&&D!=="__source"&&(se[D]=oe[D]);var ee=arguments.length-2;if(ee===1)se.children=ue;else if(1<ee){for(var ce=Array(ee),re=0;re<ee;re++)ce[re]=arguments[re+2];se.children=ce}if(A&&A.defaultProps)for(D in ee=A.defaultProps,ee)se[D]===void 0&&(se[D]=ee[D]);return z(A,be,void 0,void 0,null,se)},Qt.createRef=function(){return{current:null}},Qt.forwardRef=function(A){return{$$typeof:d,render:A}},Qt.isValidElement=B,Qt.lazy=function(A){return{$$typeof:p,_payload:{_status:-1,_result:A},_init:Q}},Qt.memo=function(A,oe){return{$$typeof:u,type:A,compare:oe===void 0?null:oe}},Qt.startTransition=function(A){var oe=L.T,ue={};L.T=ue;try{var D=A(),se=L.S;se!==null&&se(ue,D),typeof D=="object"&&D!==null&&typeof D.then=="function"&&D.then(fe,J)}catch(be){J(be)}finally{L.T=oe}},Qt.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Qt.use=function(A){return L.H.use(A)},Qt.useActionState=function(A,oe,ue){return L.H.useActionState(A,oe,ue)},Qt.useCallback=function(A,oe){return L.H.useCallback(A,oe)},Qt.useContext=function(A){return L.H.useContext(A)},Qt.useDebugValue=function(){},Qt.useDeferredValue=function(A,oe){return L.H.useDeferredValue(A,oe)},Qt.useEffect=function(A,oe,ue){var D=L.H;if(typeof ue=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return D.useEffect(A,oe)},Qt.useId=function(){return L.H.useId()},Qt.useImperativeHandle=function(A,oe,ue){return L.H.useImperativeHandle(A,oe,ue)},Qt.useInsertionEffect=function(A,oe){return L.H.useInsertionEffect(A,oe)},Qt.useLayoutEffect=function(A,oe){return L.H.useLayoutEffect(A,oe)},Qt.useMemo=function(A,oe){return L.H.useMemo(A,oe)},Qt.useOptimistic=function(A,oe){return L.H.useOptimistic(A,oe)},Qt.useReducer=function(A,oe,ue){return L.H.useReducer(A,oe,ue)},Qt.useRef=function(A){return L.H.useRef(A)},Qt.useState=function(A){return L.H.useState(A)},Qt.useSyncExternalStore=function(A,oe,ue){return L.H.useSyncExternalStore(A,oe,ue)},Qt.useTransition=function(){return L.H.useTransition()},Qt.version="19.1.0",Qt}var lS;function J1(){return lS||(lS=1,Fv.exports=eP()),Fv.exports}var w=J1();const wn=qd(w),cS=KA({__proto__:null,default:wn},[w]);var $v={exports:{}},bm={},zv={exports:{}},Uv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uS;function tP(){return uS||(uS=1,function(e){function n(H,Q){var J=H.length;H.push(Q);e:for(;0<J;){var fe=J-1>>>1,A=H[fe];if(0<a(A,Q))H[fe]=Q,H[J]=A,J=fe;else break e}}function t(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var Q=H[0],J=H.pop();if(J!==Q){H[0]=J;e:for(var fe=0,A=H.length,oe=A>>>1;fe<oe;){var ue=2*(fe+1)-1,D=H[ue],se=ue+1,be=H[se];if(0>a(D,J))se<A&&0>a(be,D)?(H[fe]=be,H[se]=J,fe=se):(H[fe]=D,H[ue]=J,fe=ue);else if(se<A&&0>a(be,J))H[fe]=be,H[se]=J,fe=se;else break e}}return Q}function a(H,Q){var J=H.sortIndex-Q.sortIndex;return J!==0?J:H.id-Q.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var f=[],u=[],p=1,g=null,b=3,v=!1,S=!1,k=!1,T=!1,P=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function U(H){for(var Q=t(u);Q!==null;){if(Q.callback===null)i(u);else if(Q.startTime<=H)i(u),Q.sortIndex=Q.expirationTime,n(f,Q);else break;Q=t(u)}}function L(H){if(k=!1,U(H),!S)if(t(f)!==null)S=!0,F||(F=!0,Y());else{var Q=t(u);Q!==null&&W(L,Q.startTime-H)}}var F=!1,z=-1,$=5,B=-1;function R(){return T?!0:!(e.unstable_now()-B<$)}function V(){if(T=!1,F){var H=e.unstable_now();B=H;var Q=!0;try{e:{S=!1,k&&(k=!1,M(z),z=-1),v=!0;var J=b;try{t:{for(U(H),g=t(f);g!==null&&!(g.expirationTime>H&&R());){var fe=g.callback;if(typeof fe=="function"){g.callback=null,b=g.priorityLevel;var A=fe(g.expirationTime<=H);if(H=e.unstable_now(),typeof A=="function"){g.callback=A,U(H),Q=!0;break t}g===t(f)&&i(f),U(H)}else i(f);g=t(f)}if(g!==null)Q=!0;else{var oe=t(u);oe!==null&&W(L,oe.startTime-H),Q=!1}}break e}finally{g=null,b=J,v=!1}Q=void 0}}finally{Q?Y():F=!1}}}var Y;if(typeof I=="function")Y=function(){I(V)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,te=ie.port2;ie.port1.onmessage=V,Y=function(){te.postMessage(null)}}else Y=function(){P(V,0)};function W(H,Q){z=P(function(){H(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(H){switch(b){case 1:case 2:case 3:var Q=3;break;default:Q=b}var J=b;b=Q;try{return H()}finally{b=J}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(H,Q){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var J=b;b=H;try{return Q()}finally{b=J}},e.unstable_scheduleCallback=function(H,Q,J){var fe=e.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?fe+J:fe):J=fe,H){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=J+A,H={id:p++,callback:Q,priorityLevel:H,startTime:J,expirationTime:A,sortIndex:-1},J>fe?(H.sortIndex=J,n(u,H),t(f)===null&&H===t(u)&&(k?(M(z),z=-1):k=!0,W(L,J-fe))):(H.sortIndex=A,n(f,H),S||v||(S=!0,F||(F=!0,Y()))),H},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(H){var Q=b;return function(){var J=b;b=Q;try{return H.apply(this,arguments)}finally{b=J}}}}(Uv)),Uv}var dS;function nP(){return dS||(dS=1,zv.exports=tP()),zv.exports}var Bv={exports:{}},Tr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fS;function iP(){if(fS)return Tr;fS=1;var e=J1();function n(f){var u="https://react.dev/errors/"+f;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,u,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:f,containerInfo:u,implementation:p}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,u){if(f==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Tr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Tr.createPortal=function(f,u){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(n(299));return o(f,u,null,p)},Tr.flushSync=function(f){var u=l.T,p=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=u,i.p=p,i.d.f()}},Tr.preconnect=function(f,u){typeof f=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,i.d.C(f,u))},Tr.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},Tr.preinit=function(f,u){if(typeof f=="string"&&u&&typeof u.as=="string"){var p=u.as,g=d(p,u.crossOrigin),b=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;p==="style"?i.d.S(f,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):p==="script"&&i.d.X(f,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Tr.preinitModule=function(f,u){if(typeof f=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var p=d(u.as,u.crossOrigin);i.d.M(f,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&i.d.M(f)},Tr.preload=function(f,u){if(typeof f=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var p=u.as,g=d(p,u.crossOrigin);i.d.L(f,p,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Tr.preloadModule=function(f,u){if(typeof f=="string")if(u){var p=d(u.as,u.crossOrigin);i.d.m(f,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else i.d.m(f)},Tr.requestFormReset=function(f){i.d.r(f)},Tr.unstable_batchedUpdates=function(f,u){return f(u)},Tr.useFormState=function(f,u,p){return l.H.useFormState(f,u,p)},Tr.useFormStatus=function(){return l.H.useHostTransitionStatus()},Tr.version="19.1.0",Tr}var hS;function R_(){if(hS)return Bv.exports;hS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Bv.exports=iP(),Bv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pS;function rP(){if(pS)return bm;pS=1;var e=nP(),n=J1(),t=R_();function i(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var c=s,h=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(h=c.return),s=c.return;while(s)}return c.tag===3?h:null}function l(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function d(s){if(o(s)!==s)throw Error(i(188))}function f(s){var c=s.alternate;if(!c){if(c=o(s),c===null)throw Error(i(188));return c!==s?null:s}for(var h=s,x=c;;){var N=h.return;if(N===null)break;var E=N.alternate;if(E===null){if(x=N.return,x!==null){h=x;continue}break}if(N.child===E.child){for(E=N.child;E;){if(E===h)return d(N),s;if(E===x)return d(N),c;E=E.sibling}throw Error(i(188))}if(h.return!==x.return)h=N,x=E;else{for(var q=!1,Z=N.child;Z;){if(Z===h){q=!0,h=N,x=E;break}if(Z===x){q=!0,x=N,h=E;break}Z=Z.sibling}if(!q){for(Z=E.child;Z;){if(Z===h){q=!0,h=E,x=N;break}if(Z===x){q=!0,x=E,h=N;break}Z=Z.sibling}if(!q)throw Error(i(189))}}if(h.alternate!==x)throw Error(i(190))}if(h.tag!==3)throw Error(i(188));return h.stateNode.current===h?s:c}function u(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=u(s),c!==null)return c;s=s.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),I=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function Y(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var ie=Symbol.for("react.client.reference");function te(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ie?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case L:return"Suspense";case F:return"SuspenseList";case B:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case I:return(s.displayName||"Context")+".Provider";case M:return(s._context.displayName||"Context")+".Consumer";case U:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case z:return c=s.displayName||null,c!==null?c:te(s.type)||"Memo";case $:c=s._payload,s=s._init;try{return te(s(c))}catch{}}return null}var W=Array.isArray,H=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},fe=[],A=-1;function oe(s){return{current:s}}function ue(s){0>A||(s.current=fe[A],fe[A]=null,A--)}function D(s,c){A++,fe[A]=s.current,s.current=c}var se=oe(null),be=oe(null),ee=oe(null),ce=oe(null);function re(s,c){switch(D(ee,c),D(be,s),D(se,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?Zn(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=Zn(c),s=ai(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ue(se),D(se,s)}function Pe(){ue(se),ue(be),ue(ee)}function Qe(s){s.memoizedState!==null&&D(ce,s);var c=se.current,h=ai(c,s.type);c!==h&&(D(be,s),D(se,h))}function Se(s){be.current===s&&(ue(se),ue(be)),ce.current===s&&(ue(ce),Bc._currentValue=J)}var Ne=Object.prototype.hasOwnProperty,De=e.unstable_scheduleCallback,Me=e.unstable_cancelCallback,nt=e.unstable_shouldYield,ft=e.unstable_requestPaint,ut=e.unstable_now,rt=e.unstable_getCurrentPriorityLevel,Nt=e.unstable_ImmediatePriority,Ft=e.unstable_UserBlockingPriority,ye=e.unstable_NormalPriority,Te=e.unstable_LowPriority,Ye=e.unstable_IdlePriority,$e=e.log,_e=e.unstable_setDisableYieldValue,X=null,de=null;function qe(s){if(typeof $e=="function"&&_e(s),de&&typeof de.setStrictMode=="function")try{de.setStrictMode(X,s)}catch{}}var et=Math.clz32?Math.clz32:ot,ct=Math.log,Fe=Math.LN2;function ot(s){return s>>>=0,s===0?32:31-(ct(s)/Fe|0)|0}var ve=256,xe=4194304;function Be(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ue(s,c,h){var x=s.pendingLanes;if(x===0)return 0;var N=0,E=s.suspendedLanes,q=s.pingedLanes;s=s.warmLanes;var Z=x&134217727;return Z!==0?(x=Z&~E,x!==0?N=Be(x):(q&=Z,q!==0?N=Be(q):h||(h=Z&~s,h!==0&&(N=Be(h))))):(Z=x&~E,Z!==0?N=Be(Z):q!==0?N=Be(q):h||(h=x&~s,h!==0&&(N=Be(h)))),N===0?0:c!==0&&c!==N&&(c&E)===0&&(E=N&-N,h=c&-c,E>=h||E===32&&(h&4194048)!==0)?c:N}function tt(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function dt(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qt(){var s=ve;return ve<<=1,(ve&4194048)===0&&(ve=256),s}function On(){var s=xe;return xe<<=1,(xe&62914560)===0&&(xe=4194304),s}function Tt(s){for(var c=[],h=0;31>h;h++)c.push(s);return c}function Rt(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function si(s,c,h,x,N,E){var q=s.pendingLanes;s.pendingLanes=h,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=h,s.entangledLanes&=h,s.errorRecoveryDisabledLanes&=h,s.shellSuspendCounter=0;var Z=s.entanglements,ge=s.expirationTimes,Re=s.hiddenUpdates;for(h=q&~h;0<h;){var Ge=31-et(h),Xe=1<<Ge;Z[Ge]=0,ge[Ge]=-1;var Le=Re[Ge];if(Le!==null)for(Re[Ge]=null,Ge=0;Ge<Le.length;Ge++){var Oe=Le[Ge];Oe!==null&&(Oe.lane&=-536870913)}h&=~Xe}x!==0&&ki(s,x,0),E!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=E&~(q&~c))}function ki(s,c,h){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-et(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|h&4194090}function bn(s,c){var h=s.entangledLanes|=c;for(s=s.entanglements;h;){var x=31-et(h),N=1<<x;N&c|s[x]&c&&(s[x]|=c),h&=~N}}function Ti(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function rn(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ps(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:tx(s.type))}function ql(s,c){var h=Q.p;try{return Q.p=s,c()}finally{Q.p=h}}var bi=Math.random().toString(36).slice(2),Ln="__reactFiber$"+bi,Li="__reactProps$"+bi,Jr="__reactContainer$"+bi,ms="__reactEvents$"+bi,el="__reactListeners$"+bi,Gd="__reactHandles$"+bi,uu="__reactResources$"+bi,tl="__reactMarker$"+bi;function nl(s){delete s[Ln],delete s[Li],delete s[ms],delete s[el],delete s[Gd]}function no(s){var c=s[Ln];if(c)return c;for(var h=s.parentNode;h;){if(c=h[Jr]||h[Ln]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(s=qy(s);s!==null;){if(h=s[Ln])return h;s=qy(s)}return c}s=h,h=s.parentNode}return null}function ya(s){if(s=s[Ln]||s[Jr]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function gs(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(i(33))}function ys(s){var c=s[uu];return c||(c=s[uu]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function hi(s){s[tl]=!0}var Yd=new Set,Wd={};function Mr(s,c){io(s,c),io(s+"Capture",c)}function io(s,c){for(Wd[s]=c,s=0;s<c.length;s++)Yd.add(c[s])}var Vl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qd={},xa={};function Jh(s){return Ne.call(xa,s)?!0:Ne.call(Qd,s)?!1:Vl.test(s)?xa[s]=!0:(Qd[s]=!0,!1)}function Hl(s,c,h){if(Jh(c))if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+h)}}function Gl(s,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+h)}}function ur(s,c,h,x){if(x===null)s.removeAttribute(h);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttributeNS(c,h,""+x)}}var Yl,du;function ro(s){if(Yl===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);Yl=c&&c[1]||"",du=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Yl+s+du}var il=!1;function fu(s,c){if(!s||il)return"";il=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var Xe=function(){throw Error()};if(Object.defineProperty(Xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Xe,[])}catch(Oe){var Le=Oe}Reflect.construct(s,[],Xe)}else{try{Xe.call()}catch(Oe){Le=Oe}s.call(Xe.prototype)}}else{try{throw Error()}catch(Oe){Le=Oe}(Xe=s())&&typeof Xe.catch=="function"&&Xe.catch(function(){})}}catch(Oe){if(Oe&&Le&&typeof Oe.stack=="string")return[Oe.stack,Le.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=x.DetermineComponentFrameRoot(),q=E[0],Z=E[1];if(q&&Z){var ge=q.split(`
`),Re=Z.split(`
`);for(N=x=0;x<ge.length&&!ge[x].includes("DetermineComponentFrameRoot");)x++;for(;N<Re.length&&!Re[N].includes("DetermineComponentFrameRoot");)N++;if(x===ge.length||N===Re.length)for(x=ge.length-1,N=Re.length-1;1<=x&&0<=N&&ge[x]!==Re[N];)N--;for(;1<=x&&0<=N;x--,N--)if(ge[x]!==Re[N]){if(x!==1||N!==1)do if(x--,N--,0>N||ge[x]!==Re[N]){var Ge=`
`+ge[x].replace(" at new "," at ");return s.displayName&&Ge.includes("<anonymous>")&&(Ge=Ge.replace("<anonymous>",s.displayName)),Ge}while(1<=x&&0<=N);break}}}finally{il=!1,Error.prepareStackTrace=h}return(h=s?s.displayName||s.name:"")?ro(h):""}function Kh(s){switch(s.tag){case 26:case 27:case 5:return ro(s.type);case 16:return ro("Lazy");case 13:return ro("Suspense");case 19:return ro("SuspenseList");case 0:case 15:return fu(s.type,!1);case 11:return fu(s.type.render,!1);case 1:return fu(s.type,!0);case 31:return ro("Activity");default:return""}}function hu(s){try{var c="";do c+=Kh(s),s=s.return;while(s);return c}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function Fi(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function pu(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function rl(s){var c=pu(s)?"checked":"value",h=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var N=h.get,E=h.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return N.call(this)},set:function(q){x=""+q,E.call(this,q)}}),Object.defineProperty(s,c,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(q){x=""+q},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function Xi(s){s._valueTracker||(s._valueTracker=rl(s))}function xs(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var h=c.getValue(),x="";return s&&(x=pu(s)?s.checked?"true":"false":s.value),s=x,s!==h?(c.setValue(s),!0):!1}function za(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var mu=/[\n"\\]/g;function Zi(s){return s.replace(mu,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function ao(s,c,h,x,N,E,q,Z){s.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?s.type=q:s.removeAttribute("type"),c!=null?q==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+Fi(c)):s.value!==""+Fi(c)&&(s.value=""+Fi(c)):q!=="submit"&&q!=="reset"||s.removeAttribute("value"),c!=null?so(s,q,Fi(c)):h!=null?so(s,q,Fi(h)):x!=null&&s.removeAttribute("value"),N==null&&E!=null&&(s.defaultChecked=!!E),N!=null&&(s.checked=N&&typeof N!="function"&&typeof N!="symbol"),Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?s.name=""+Fi(Z):s.removeAttribute("name")}function al(s,c,h,x,N,E,q,Z){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),c!=null||h!=null){if(!(E!=="submit"&&E!=="reset"||c!=null))return;h=h!=null?""+Fi(h):"",c=c!=null?""+Fi(c):h,Z||c===s.value||(s.value=c),s.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=Z?s.checked:!!x,s.defaultChecked=!!x,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(s.name=q)}function so(s,c,h){c==="number"&&za(s.ownerDocument)===s||s.defaultValue===""+h||(s.defaultValue=""+h)}function bs(s,c,h,x){if(s=s.options,c){c={};for(var N=0;N<h.length;N++)c["$"+h[N]]=!0;for(h=0;h<s.length;h++)N=c.hasOwnProperty("$"+s[h].value),s[h].selected!==N&&(s[h].selected=N),N&&x&&(s[h].defaultSelected=!0)}else{for(h=""+Fi(h),c=null,N=0;N<s.length;N++){if(s[N].value===h){s[N].selected=!0,x&&(s[N].defaultSelected=!0);return}c!==null||s[N].disabled||(c=s[N])}c!==null&&(c.selected=!0)}}function oo(s,c,h){if(c!=null&&(c=""+Fi(c),c!==s.value&&(s.value=c),h==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=h!=null?""+Fi(h):""}function Wl(s,c,h,x){if(c==null){if(x!=null){if(h!=null)throw Error(i(92));if(W(x)){if(1<x.length)throw Error(i(93));x=x[0]}h=x}h==null&&(h=""),c=h}h=Fi(c),s.defaultValue=h,x=s.textContent,x===h&&x!==""&&x!==null&&(s.value=x)}function Ua(s,c){if(c){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=c;return}}s.textContent=c}var vs=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ql(s,c,h){var x=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,h):typeof h!="number"||h===0||vs.has(c)?c==="float"?s.cssFloat=h:s[c]=(""+h).trim():s[c]=h+"px"}function Jl(s,c,h){if(c!=null&&typeof c!="object")throw Error(i(62));if(s=s.style,h!=null){for(var x in h)!h.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&h[N]!==x&&Ql(s,N,x)}else for(var E in c)c.hasOwnProperty(E)&&Ql(s,E,c[E])}function lo(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Kl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function co(s){return Kl.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var uo=null;function Xl(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ba=null,ws=null;function sl(s){var c=ya(s);if(c&&(s=c.stateNode)){var h=s[Li]||null;e:switch(s=c.stateNode,c.type){case"input":if(ao(s,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Zi(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var x=h[c];if(x!==s&&x.form===s.form){var N=x[Li]||null;if(!N)throw Error(i(90));ao(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<h.length;c++)x=h[c],x.form===s.form&&xs(x)}break e;case"textarea":oo(s,h.value,h.defaultValue);break e;case"select":c=h.value,c!=null&&bs(s,!!h.multiple,c,!1)}}}var Zl=!1;function ol(s,c,h){if(Zl)return s(c,h);Zl=!0;try{var x=s(c);return x}finally{if(Zl=!1,(Ba!==null||ws!==null)&&(Vf(),Ba&&(c=Ba,s=ws,ws=Ba=null,sl(c),s)))for(c=0;c<s.length;c++)sl(s[c])}}function ba(s,c){var h=s.stateNode;if(h===null)return null;var x=h[Li]||null;if(x===null)return null;h=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(i(231,c,typeof h));return h}var dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fo=!1;if(dr)try{var qa={};Object.defineProperty(qa,"passive",{get:function(){fo=!0}}),window.addEventListener("test",qa,qa),window.removeEventListener("test",qa,qa)}catch{fo=!1}var Va=null,ll=null,ho=null;function ec(){if(ho)return ho;var s,c=ll,h=c.length,x,N="value"in Va?Va.value:Va.textContent,E=N.length;for(s=0;s<h&&c[s]===N[s];s++);var q=h-s;for(x=1;x<=q&&c[h-x]===N[E-x];x++);return ho=N.slice(s,1<x?1-x:void 0)}function vn(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function mn(){return!0}function tc(){return!1}function Ei(s){function c(h,x,N,E,q){this._reactName=h,this._targetInst=N,this.type=x,this.nativeEvent=E,this.target=q,this.currentTarget=null;for(var Z in s)s.hasOwnProperty(Z)&&(h=s[Z],this[Z]=h?h(E):E[Z]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?mn:tc,this.isPropagationStopped=tc,this}return p(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=mn)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=mn)},persist:function(){},isPersistent:mn}),c}var va={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},po=Ei(va),er=p({},va,{view:0,detail:0}),yu=Ei(er),cl,wa,ri,Ha=p({},er,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ri&&(ri&&s.type==="mousemove"?(cl=s.screenX-ri.screenX,wa=s.screenY-ri.screenY):wa=cl=0,ri=s),cl)},movementY:function(s){return"movementY"in s?s.movementY:wa}}),Ga=Ei(Ha),nc=p({},Ha,{dataTransfer:0}),Ss=Ei(nc),fr=p({},er,{relatedTarget:0}),Ns=Ei(fr),xu=p({},va,{animationName:0,elapsedTime:0,pseudoElement:0}),ic=Ei(xu),rc=p({},va,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),bu=Ei(rc),ul=p({},va,{data:0}),qi=Ei(ul),vu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nn(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=Jd[s])?!!c[s]:!1}function hr(){return Nn}var Cs=p({},er,{key:function(s){if(s.key){var c=vu[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=vn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Vi[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hr,charCode:function(s){return s.type==="keypress"?vn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?vn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),dl=Ei(Cs),jn=p({},Ha,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tr=Ei(jn),wu=p({},er,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hr}),Kd=Ei(wu),Ya=p({},va,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=Ei(Ya),Su=p({},Ha,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ac=Ei(Su),js=p({},va,{newState:0,oldState:0}),fl=Ei(js),mo=[9,13,27,32],sc=dr&&"CompositionEvent"in window,Kr=null;dr&&"documentMode"in document&&(Kr=document.documentMode);var Zd=dr&&"TextEvent"in window&&!Kr,Sa=dr&&(!sc||Kr&&8<Kr&&11>=Kr),oc=" ",lc=!1;function _s(s,c){switch(s){case"keyup":return mo.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Na(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var pr=!1;function Xh(s,c){switch(s){case"compositionend":return Na(c);case"keypress":return c.which!==32?null:(lc=!0,oc);case"textInput":return s=c.data,s===oc&&lc?null:s;default:return null}}function cc(s,c){if(pr)return s==="compositionend"||!sc&&_s(s,c)?(s=ec(),ho=ll=Va=null,pr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Sa&&c.locale!=="ko"?null:c.data;default:return null}}var Hi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ks(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!Hi[s.type]:c==="textarea"}function Ts(s,c,h,x){Ba?ws?ws.push(x):ws=[x]:Ba=x,c=Kf(c,"onChange"),0<c.length&&(h=new po("onChange","change",null,h,x),s.push({event:h,listeners:c}))}var go=null,yo=null;function Zh(s){My(s,0)}function uc(s){var c=gs(s);if(xs(c))return s}function ef(s,c){if(s==="change")return c}var tf=!1;if(dr){var Nu;if(dr){var Wa="oninput"in document;if(!Wa){var Cu=document.createElement("div");Cu.setAttribute("oninput","return;"),Wa=typeof Cu.oninput=="function"}Nu=Wa}else Nu=!1;tf=Nu&&(!document.documentMode||9<document.documentMode)}function nf(){go&&(go.detachEvent("onpropertychange",Es),yo=go=null)}function Es(s){if(s.propertyName==="value"&&uc(yo)){var c=[];Ts(c,yo,s,Xl(s)),ol(Zh,c)}}function rf(s,c,h){s==="focusin"?(nf(),go=c,yo=h,go.attachEvent("onpropertychange",Es)):s==="focusout"&&nf()}function $i(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return uc(yo)}function Or(s,c){if(s==="click")return uc(c)}function Ca(s,c){if(s==="input"||s==="change")return uc(c)}function af(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var Gi=typeof Object.is=="function"?Object.is:af;function Lr(s,c){if(Gi(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var h=Object.keys(s),x=Object.keys(c);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var N=h[x];if(!Ne.call(c,N)||!Gi(s[N],c[N]))return!1}return!0}function nr(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function hl(s,c){var h=nr(s);s=0;for(var x;h;){if(h.nodeType===3){if(x=s+h.textContent.length,s<=c&&x>=c)return{node:h,offset:c-s};s=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=nr(h)}}function ju(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?ju(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function _u(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=za(s.document);c instanceof s.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)s=c.contentWindow;else break;c=za(s.document)}return c}function ku(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var sf=dr&&"documentMode"in document&&11>=document.documentMode,xo=null,Qa=null,ke=null,He=!1;function ze(s,c,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;He||xo==null||xo!==za(x)||(x=xo,"selectionStart"in x&&ku(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),ke&&Lr(ke,x)||(ke=x,x=Kf(Qa,"onSelect"),0<x.length&&(c=new po("onSelect","select",null,c,h),s.push({event:c,listeners:x}),c.target=xo)))}function ht(s,c){var h={};return h[s.toLowerCase()]=c.toLowerCase(),h["Webkit"+s]="webkit"+c,h["Moz"+s]="moz"+c,h}var St={animationend:ht("Animation","AnimationEnd"),animationiteration:ht("Animation","AnimationIteration"),animationstart:ht("Animation","AnimationStart"),transitionrun:ht("Transition","TransitionRun"),transitionstart:ht("Transition","TransitionStart"),transitioncancel:ht("Transition","TransitionCancel"),transitionend:ht("Transition","TransitionEnd")},on={},Wn={};dr&&(Wn=document.createElement("div").style,"AnimationEvent"in window||(delete St.animationend.animation,delete St.animationiteration.animation,delete St.animationstart.animation),"TransitionEvent"in window||delete St.transitionend.transition);function ln(s){if(on[s])return on[s];if(!St[s])return s;var c=St[s],h;for(h in c)if(c.hasOwnProperty(h)&&h in Wn)return on[s]=c[h];return s}var dc=ln("animationend"),of=ln("animationiteration"),Qn=ln("animationstart"),fc=ln("transitionrun"),ep=ln("transitionstart"),As=ln("transitioncancel"),pl=ln("transitionend"),ml=new Map,gn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");gn.push("scrollEnd");function Fr(s,c){ml.set(s,c),Mr(c,[s])}var Tu=new WeakMap;function zi(s,c){if(typeof s=="object"&&s!==null){var h=Tu.get(s);return h!==void 0?h:(c={value:s,source:c,stack:hu(c)},Tu.set(s,c),c)}return{value:s,source:c,stack:hu(c)}}var mr=[],bo=0,Eu=0;function Ja(){for(var s=bo,c=Eu=bo=0;c<s;){var h=mr[c];mr[c++]=null;var x=mr[c];mr[c++]=null;var N=mr[c];mr[c++]=null;var E=mr[c];if(mr[c++]=null,x!==null&&N!==null){var q=x.pending;q===null?N.next=N:(N.next=q.next,q.next=N),x.pending=N}E!==0&&me(h,N,E)}}function gr(s,c,h,x){mr[bo++]=s,mr[bo++]=c,mr[bo++]=h,mr[bo++]=x,Eu|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function Ps(s,c,h,x){return gr(s,c,h,x),le(s)}function ae(s,c){return gr(s,null,null,c),le(s)}function me(s,c,h){s.lanes|=h;var x=s.alternate;x!==null&&(x.lanes|=h);for(var N=!1,E=s.return;E!==null;)E.childLanes|=h,x=E.alternate,x!==null&&(x.childLanes|=h),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(N=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,N&&c!==null&&(N=31-et(h),s=E.hiddenUpdates,x=s[N],x===null?s[N]=[c]:x.push(c),c.lane=h|536870912),E):null}function le(s){if(50<Rc)throw Rc=0,Wp=null,Error(i(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var je={};function Je(s,c,h,x){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lt(s,c,h,x){return new Je(s,c,h,x)}function bt(s){return s=s.prototype,!(!s||!s.isReactComponent)}function xt(s,c){var h=s.alternate;return h===null?(h=lt(s.tag,c,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=c,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&65011712,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,c=s.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h.refCleanup=s.refCleanup,h}function mi(s,c){s.flags&=65011714;var h=s.alternate;return h===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,c=h.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function yr(s,c,h,x,N,E){var q=0;if(x=s,typeof s=="function")bt(s)&&(q=1);else if(typeof s=="string")q=Nv(s,h,se.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case B:return s=lt(31,h,c,N),s.elementType=B,s.lanes=E,s;case S:return Ds(h.children,N,E,c);case k:q=8,N|=24;break;case T:return s=lt(12,h,c,N|2),s.elementType=T,s.lanes=E,s;case L:return s=lt(13,h,c,N),s.elementType=L,s.lanes=E,s;case F:return s=lt(19,h,c,N),s.elementType=F,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case P:case I:q=10;break e;case M:q=9;break e;case U:q=11;break e;case z:q=14;break e;case $:q=16,x=null;break e}q=29,h=Error(i(130,s===null?"null":typeof s,"")),x=null}return c=lt(q,h,c,N),c.elementType=s,c.type=x,c.lanes=E,c}function Ds(s,c,h,x){return s=lt(7,s,x,c),s.lanes=h,s}function tp(s,c,h){return s=lt(6,s,null,c),s.lanes=h,s}function hc(s,c,h){return c=lt(4,s.children!==null?s.children:[],s.key,c),c.lanes=h,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var Is=[],vo=0,lf=null,Au=0,Xr=[],Zr=0,Vn=null,Jn=1,Rs="";function gl(s,c){Is[vo++]=Au,Is[vo++]=lf,lf=s,Au=c}function np(s,c,h){Xr[Zr++]=Jn,Xr[Zr++]=Rs,Xr[Zr++]=Vn,Vn=s;var x=Jn;s=Rs;var N=32-et(x)-1;x&=~(1<<N),h+=1;var E=32-et(c)+N;if(30<E){var q=N-N%5;E=(x&(1<<q)-1).toString(32),x>>=q,N-=q,Jn=1<<32-et(c)+N|h<<N|x,Rs=E+s}else Jn=1<<E|h<<N|x,Rs=s}function ip(s){s.return!==null&&(gl(s,1),np(s,1,0))}function Pu(s){for(;s===lf;)lf=Is[--vo],Is[vo]=null,Au=Is[--vo],Is[vo]=null;for(;s===Vn;)Vn=Xr[--Zr],Xr[Zr]=null,Rs=Xr[--Zr],Xr[Zr]=null,Jn=Xr[--Zr],Xr[Zr]=null}var vi=null,Kn=null,an=!1,ja=null,xr=!1,pc=Error(i(519));function ea(s){var c=Error(i(418,""));throw wo(zi(c,s)),pc}function mg(s){var c=s.stateNode,h=s.type,x=s.memoizedProps;switch(c[Ln]=s,c[Li]=x,h){case"dialog":tn("cancel",c),tn("close",c);break;case"iframe":case"object":case"embed":tn("load",c);break;case"video":case"audio":for(h=0;h<bd.length;h++)tn(bd[h],c);break;case"source":tn("error",c);break;case"img":case"image":case"link":tn("error",c),tn("load",c);break;case"details":tn("toggle",c);break;case"input":tn("invalid",c),al(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Xi(c);break;case"select":tn("invalid",c);break;case"textarea":tn("invalid",c),Wl(c,x.value,x.defaultValue,x.children),Xi(c)}h=x.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||x.suppressHydrationWarning===!0||Fy(c.textContent,h)?(x.popover!=null&&(tn("beforetoggle",c),tn("toggle",c)),x.onScroll!=null&&tn("scroll",c),x.onScrollEnd!=null&&tn("scrollend",c),x.onClick!=null&&(c.onclick=Xf),c=!0):c=!1,c||ea(s)}function gg(s){for(vi=s.return;vi;)switch(vi.tag){case 5:case 13:xr=!1;return;case 27:case 3:xr=!0;return;default:vi=vi.return}}function Du(s){if(s!==vi)return!1;if(!an)return gg(s),an=!0,!1;var c=s.tag,h;if((h=c!==3&&c!==27)&&((h=c===5)&&(h=s.type,h=!(h!=="form"&&h!=="button")||eh(s.type,s.memoizedProps)),h=!h),h&&Kn&&ea(s),gg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(h=s.data,h==="/$"){if(c===0){Kn=Pa(s.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++;s=s.nextSibling}Kn=null}}else c===27?(c=Kn,sa(s.type)?(s=lm,lm=null,Kn=s):Kn=c):Kn=vi?Pa(s.stateNode.nextSibling):null;return!0}function Iu(){Kn=vi=null,an=!1}function yg(){var s=ja;return s!==null&&(_r===null?_r=s:_r.push.apply(_r,s),ja=null),s}function wo(s){ja===null?ja=[s]:ja.push(s)}var yl=oe(null),So=null,K=null;function $r(s,c,h){D(yl,c._currentValue),c._currentValue=h}function ta(s){s._currentValue=yl.current,ue(yl)}function br(s,c,h){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===h)break;s=s.return}}function Kt(s,c,h,x){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var E=N.dependencies;if(E!==null){var q=N.child;E=E.firstContext;e:for(;E!==null;){var Z=E;E=N;for(var ge=0;ge<c.length;ge++)if(Z.context===c[ge]){E.lanes|=h,Z=E.alternate,Z!==null&&(Z.lanes|=h),br(E.return,h,s),x||(q=null);break e}E=Z.next}}else if(N.tag===18){if(q=N.return,q===null)throw Error(i(341));q.lanes|=h,E=q.alternate,E!==null&&(E.lanes|=h),br(q,h,s),q=null}else q=N.child;if(q!==null)q.return=N;else for(q=N;q!==null;){if(q===s){q=null;break}if(N=q.sibling,N!==null){N.return=q.return,q=N;break}q=q.return}N=q}}function Ru(s,c,h,x){s=null;for(var N=c,E=!1;N!==null;){if(!E){if((N.flags&524288)!==0)E=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var q=N.alternate;if(q===null)throw Error(i(387));if(q=q.memoizedProps,q!==null){var Z=N.type;Gi(N.pendingProps.value,q.value)||(s!==null?s.push(Z):s=[Z])}}else if(N===ce.current){if(q=N.alternate,q===null)throw Error(i(387));q.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(Bc):s=[Bc])}N=N.return}s!==null&&Kt(c,s,h,x),c.flags|=262144}function cf(s){for(s=s.firstContext;s!==null;){if(!Gi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function xl(s){So=s,K=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function oi(s){return xg(So,s)}function uf(s,c){return So===null&&xl(s),xg(s,c)}function xg(s,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},K===null){if(s===null)throw Error(i(308));K=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else K=K.next=c;return h}var Yb=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(h,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(h){return h()})}},Wb=e.unstable_scheduleCallback,Qb=e.unstable_NormalPriority,Fn={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function rp(){return{controller:new Yb,data:new Map,refCount:0}}function Mu(s){s.refCount--,s.refCount===0&&Wb(Qb,function(){s.controller.abort()})}var Ou=null,ap=0,mc=0,vr=null;function Jb(s,c){if(Ou===null){var h=Ou=[];ap=0,mc=Jf(),vr={status:"pending",value:void 0,then:function(x){h.push(x)}}}return ap++,c.then(bg,bg),c}function bg(){if(--ap===0&&Ou!==null){vr!==null&&(vr.status="fulfilled");var s=Ou;Ou=null,mc=0,vr=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function Kb(s,c){var h=[],x={status:"pending",value:null,reason:null,then:function(N){h.push(N)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<h.length;N++)(0,h[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<h.length;N++)(0,h[N])(void 0)}),x}var vg=H.S;H.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Jb(s,c),vg!==null&&vg(s,c)};var bl=oe(null);function Ms(){var s=bl.current;return s!==null?s:Bn.pooledCache}function df(s,c){c===null?D(bl,bl.current):D(bl,c.pool)}function wg(){var s=Ms();return s===null?null:{parent:Fn._currentValue,pool:s}}var ir=Error(i(460)),Sg=Error(i(474)),ff=Error(i(542)),sp={then:function(){}};function Ng(s){return s=s.status,s==="fulfilled"||s==="rejected"}function hf(){}function op(s,c,h){switch(h=s[h],h===void 0?s.push(c):h!==c&&(c.then(hf,hf),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,jg(s),s;default:if(typeof c.status=="string")c.then(hf,hf);else{if(s=Bn,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,jg(s),s}throw gc=c,ir}}var gc=null;function Cg(){if(gc===null)throw Error(i(459));var s=gc;return gc=null,s}function jg(s){if(s===ir||s===ff)throw Error(i(483))}var Ka=!1;function vl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yc(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function No(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Os(s,c,h){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Tn&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=le(s),me(s,null,h),c}return gr(s,x,c,h),le(s)}function Lu(s,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,h|=x,c.lanes=h,bn(s,h)}}function _a(s,c){var h=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var N=null,E=null;if(h=h.firstBaseUpdate,h!==null){do{var q={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};E===null?N=E=q:E=E.next=q,h=h.next}while(h!==null);E===null?N=E=c:E=E.next=c}else N=E=c;h={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:E,shared:x.shared,callbacks:x.callbacks},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=c:s.next=c,h.lastBaseUpdate=c}var Fu=!1;function ka(){if(Fu){var s=vr;if(s!==null)throw s}}function Yi(s,c,h,x){Fu=!1;var N=s.updateQueue;Ka=!1;var E=N.firstBaseUpdate,q=N.lastBaseUpdate,Z=N.shared.pending;if(Z!==null){N.shared.pending=null;var ge=Z,Re=ge.next;ge.next=null,q===null?E=Re:q.next=Re,q=ge;var Ge=s.alternate;Ge!==null&&(Ge=Ge.updateQueue,Z=Ge.lastBaseUpdate,Z!==q&&(Z===null?Ge.firstBaseUpdate=Re:Z.next=Re,Ge.lastBaseUpdate=ge))}if(E!==null){var Xe=N.baseState;q=0,Ge=Re=ge=null,Z=E;do{var Le=Z.lane&-536870913,Oe=Le!==Z.lane;if(Oe?(hn&Le)===Le:(x&Le)===Le){Le!==0&&Le===mc&&(Fu=!0),Ge!==null&&(Ge=Ge.next={lane:0,tag:Z.tag,payload:Z.payload,callback:null,next:null});e:{var At=s,Et=Z;Le=c;var Rn=h;switch(Et.tag){case 1:if(At=Et.payload,typeof At=="function"){Xe=At.call(Rn,Xe,Le);break e}Xe=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=Et.payload,Le=typeof At=="function"?At.call(Rn,Xe,Le):At,Le==null)break e;Xe=p({},Xe,Le);break e;case 2:Ka=!0}}Le=Z.callback,Le!==null&&(s.flags|=64,Oe&&(s.flags|=8192),Oe=N.callbacks,Oe===null?N.callbacks=[Le]:Oe.push(Le))}else Oe={lane:Le,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Ge===null?(Re=Ge=Oe,ge=Xe):Ge=Ge.next=Oe,q|=Le;if(Z=Z.next,Z===null){if(Z=N.shared.pending,Z===null)break;Oe=Z,Z=Oe.next,Oe.next=null,N.lastBaseUpdate=Oe,N.shared.pending=null}}while(!0);Ge===null&&(ge=Xe),N.baseState=ge,N.firstBaseUpdate=Re,N.lastBaseUpdate=Ge,E===null&&(N.shared.lanes=0),Do|=q,s.lanes=q,s.memoizedState=Xe}}function _g(s,c){if(typeof s!="function")throw Error(i(191,s));s.call(c)}function lp(s,c){var h=s.callbacks;if(h!==null)for(s.callbacks=null,s=0;s<h.length;s++)_g(h[s],c)}var wl=oe(null),Co=oe(0);function Ls(s,c){s=Gs,D(Co,s),D(wl,c),Gs=s|c.baseLanes}function pf(){D(Co,Gs),D(wl,wl.current)}function cp(){Gs=Co.current,ue(wl),ue(Co)}var Ta=0,Wt=null,kn=null,sn=null,xc=!1,Sl=!1,Wi=!1,bc=0,jo=0,na=null,kg=0;function cn(){throw Error(i(321))}function $u(s,c){if(c===null)return!1;for(var h=0;h<c.length&&h<s.length;h++)if(!Gi(s[h],c[h]))return!1;return!0}function up(s,c,h,x,N,E){return Ta=E,Wt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,H.H=s===null||s.memoizedState===null?zg:Tp,Wi=!1,E=h(x,N),Wi=!1,Sl&&(E=Eg(c,h,x,N)),Tg(s),E}function Tg(s){H.H=Ju;var c=kn!==null&&kn.next!==null;if(Ta=0,sn=kn=Wt=null,xc=!1,jo=0,na=null,c)throw Error(i(300));s===null||Ai||(s=s.dependencies,s!==null&&cf(s)&&(Ai=!0))}function Eg(s,c,h,x){Wt=s;var N=0;do{if(Sl&&(na=null),jo=0,Sl=!1,25<=N)throw Error(i(301));if(N+=1,sn=kn=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}H.H=Ug,E=c(h,x)}while(Sl);return E}function dp(){var s=H.H,c=s.useState()[0];return c=typeof c.then=="function"?zu(c):c,s=s.useState()[0],(kn!==null?kn.memoizedState:null)!==s&&(Wt.flags|=1024),c}function fp(){var s=bc!==0;return bc=0,s}function Nl(s,c,h){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~h}function mf(s){if(xc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}xc=!1}Ta=0,sn=kn=Wt=null,Sl=!1,jo=bc=0,na=null}function wr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?Wt.memoizedState=sn=s:sn=sn.next=s,sn}function gi(){if(kn===null){var s=Wt.alternate;s=s!==null?s.memoizedState:null}else s=kn.next;var c=sn===null?Wt.memoizedState:sn.next;if(c!==null)sn=c,kn=s;else{if(s===null)throw Wt.alternate===null?Error(i(467)):Error(i(310));kn=s,s={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},sn===null?Wt.memoizedState=sn=s:sn=sn.next=s}return sn}function Cl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zu(s){var c=jo;return jo+=1,na===null&&(na=[]),s=op(na,s,c),c=Wt,(sn===null?c.memoizedState:sn.next)===null&&(c=c.alternate,H.H=c===null||c.memoizedState===null?zg:Tp),s}function gf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return zu(s);if(s.$$typeof===I)return oi(s)}throw Error(i(438,String(s)))}function Uu(s){var c=null,h=Wt.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var x=Wt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=Cl(),Wt.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(s),x=0;x<s;x++)h[x]=R;return c.index++,h}function Xa(s,c){return typeof c=="function"?c(s):c}function yf(s){var c=gi();return hp(c,kn,s)}function hp(s,c,h){var x=s.queue;if(x===null)throw Error(i(311));x.lastRenderedReducer=h;var N=s.baseQueue,E=x.pending;if(E!==null){if(N!==null){var q=N.next;N.next=E.next,E.next=q}c.baseQueue=N=E,x.pending=null}if(E=s.baseState,N===null)s.memoizedState=E;else{c=N.next;var Z=q=null,ge=null,Re=c,Ge=!1;do{var Xe=Re.lane&-536870913;if(Xe!==Re.lane?(hn&Xe)===Xe:(Ta&Xe)===Xe){var Le=Re.revertLane;if(Le===0)ge!==null&&(ge=ge.next={lane:0,revertLane:0,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null}),Xe===mc&&(Ge=!0);else if((Ta&Le)===Le){Re=Re.next,Le===mc&&(Ge=!0);continue}else Xe={lane:0,revertLane:Re.revertLane,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null},ge===null?(Z=ge=Xe,q=E):ge=ge.next=Xe,Wt.lanes|=Le,Do|=Le;Xe=Re.action,Wi&&h(E,Xe),E=Re.hasEagerState?Re.eagerState:h(E,Xe)}else Le={lane:Xe,revertLane:Re.revertLane,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null},ge===null?(Z=ge=Le,q=E):ge=ge.next=Le,Wt.lanes|=Xe,Do|=Xe;Re=Re.next}while(Re!==null&&Re!==c);if(ge===null?q=E:ge.next=Z,!Gi(E,s.memoizedState)&&(Ai=!0,Ge&&(h=vr,h!==null)))throw h;s.memoizedState=E,s.baseState=q,s.baseQueue=ge,x.lastRenderedState=E}return N===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function pp(s){var c=gi(),h=c.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=s;var x=h.dispatch,N=h.pending,E=c.memoizedState;if(N!==null){h.pending=null;var q=N=N.next;do E=s(E,q.action),q=q.next;while(q!==N);Gi(E,c.memoizedState)||(Ai=!0),c.memoizedState=E,c.baseQueue===null&&(c.baseState=E),h.lastRenderedState=E}return[E,x]}function mp(s,c,h){var x=Wt,N=gi(),E=an;if(E){if(h===void 0)throw Error(i(407));h=h()}else h=c();var q=!Gi((kn||N).memoizedState,h);q&&(N.memoizedState=h,Ai=!0),N=N.queue;var Z=bf.bind(null,x,N,s);if(Vu(2048,8,Z,[s]),N.getSnapshot!==c||q||sn!==null&&sn.memoizedState.tag&1){if(x.flags|=2048,vc(9,Cf(),Ag.bind(null,x,N,h,c),null),Bn===null)throw Error(i(349));E||(Ta&124)!==0||xf(x,c,h)}return h}function xf(s,c,h){s.flags|=16384,s={getSnapshot:c,value:h},c=Wt.updateQueue,c===null?(c=Cl(),Wt.updateQueue=c,c.stores=[s]):(h=c.stores,h===null?c.stores=[s]:h.push(s))}function Ag(s,c,h,x){c.value=h,c.getSnapshot=x,gp(c)&&yp(s)}function bf(s,c,h){return h(function(){gp(c)&&yp(s)})}function gp(s){var c=s.getSnapshot;s=s.value;try{var h=c();return!Gi(s,h)}catch{return!0}}function yp(s){var c=ae(s,2);c!==null&&Vr(c,s,2)}function vf(s){var c=wr();if(typeof s=="function"){var h=s;if(s=h(),Wi){qe(!0);try{h()}finally{qe(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:s},c}function Bu(s,c,h,x){return s.baseState=h,hp(s,kn,typeof x=="function"?x:Xa)}function Xb(s,c,h,x,N){if(Tf(s))throw Error(i(485));if(s=c.action,s!==null){var E={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){E.listeners.push(q)}};H.T!==null?h(!0):E.isTransition=!1,x(E),h=c.pending,h===null?(E.next=c.pending=E,xp(c,E)):(E.next=h.next,c.pending=h.next=E)}}function xp(s,c){var h=c.action,x=c.payload,N=s.state;if(c.isTransition){var E=H.T,q={};H.T=q;try{var Z=h(N,x),ge=H.S;ge!==null&&ge(q,Z),bp(s,c,Z)}catch(Re){wf(s,c,Re)}finally{H.T=E}}else try{E=h(N,x),bp(s,c,E)}catch(Re){wf(s,c,Re)}}function bp(s,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(x){Pg(s,c,x)},function(x){return wf(s,c,x)}):Pg(s,c,h)}function Pg(s,c,h){c.status="fulfilled",c.value=h,Dg(c),s.state=h,c=s.pending,c!==null&&(h=c.next,h===c?s.pending=null:(h=h.next,c.next=h,xp(s,h)))}function wf(s,c,h){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=h,Dg(c),c=c.next;while(c!==x)}s.action=null}function Dg(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function Sf(s,c){return c}function vp(s,c){if(an){var h=Bn.formState;if(h!==null){e:{var x=Wt;if(an){if(Kn){t:{for(var N=Kn,E=xr;N.nodeType!==8;){if(!E){N=null;break t}if(N=Pa(N.nextSibling),N===null){N=null;break t}}E=N.data,N=E==="F!"||E==="F"?N:null}if(N){Kn=Pa(N.nextSibling),x=N.data==="F!";break e}}ea(x)}x=!1}x&&(c=h[0])}}return h=wr(),h.memoizedState=h.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sf,lastRenderedState:c},h.queue=x,h=jp.bind(null,Wt,x),x.dispatch=h,x=vf(!1),E=_p.bind(null,Wt,!1,x.queue),x=wr(),N={state:c,dispatch:null,action:s,pending:null},x.queue=N,h=Xb.bind(null,Wt,N,E,h),N.dispatch=h,x.memoizedState=s,[c,h,!1]}function Nf(s){var c=gi();return Ig(c,kn,s)}function Ig(s,c,h){if(c=hp(s,c,Sf)[0],s=yf(Xa)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=zu(c)}catch(q){throw q===ir?ff:q}else x=c;c=gi();var N=c.queue,E=N.dispatch;return h!==c.memoizedState&&(Wt.flags|=2048,vc(9,Cf(),wp.bind(null,N,h),null)),[x,E,s]}function wp(s,c){s.action=c}function Vt(s){var c=gi(),h=kn;if(h!==null)return Ig(c,h,s);gi(),c=c.memoizedState,h=gi();var x=h.queue.dispatch;return h.memoizedState=s,[c,x,!1]}function vc(s,c,h,x){return s={tag:s,create:h,deps:x,inst:c,next:null},c=Wt.updateQueue,c===null&&(c=Cl(),Wt.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=s.next=s:(x=h.next,h.next=s,s.next=x,c.lastEffect=s),s}function Cf(){return{destroy:void 0,resource:void 0}}function wc(){return gi().memoizedState}function qu(s,c,h,x){var N=wr();x=x===void 0?null:x,Wt.flags|=s,N.memoizedState=vc(1|c,Cf(),h,x)}function Vu(s,c,h,x){var N=gi();x=x===void 0?null:x;var E=N.memoizedState.inst;kn!==null&&x!==null&&$u(x,kn.memoizedState.deps)?N.memoizedState=vc(c,E,h,x):(Wt.flags|=s,N.memoizedState=vc(1|c,E,h,x))}function Rg(s,c){qu(8390656,8,s,c)}function zr(s,c){Vu(2048,8,s,c)}function Mg(s,c){return Vu(4,2,s,c)}function Hu(s,c){return Vu(4,4,s,c)}function jf(s,c){if(typeof c=="function"){s=s();var h=c(s);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Sp(s,c,h){h=h!=null?h.concat([s]):null,Vu(4,4,jf.bind(null,c,s),h)}function _f(){}function Sr(s,c){var h=gi();c=c===void 0?null:c;var x=h.memoizedState;return c!==null&&$u(c,x[1])?x[0]:(h.memoizedState=[s,c],s)}function Fs(s,c){var h=gi();c=c===void 0?null:c;var x=h.memoizedState;if(c!==null&&$u(c,x[1]))return x[0];if(x=s(),Wi){qe(!0);try{s()}finally{qe(!1)}}return h.memoizedState=[x,c],x}function Gu(s,c,h){return h===void 0||(Ta&1073741824)!==0?s.memoizedState=c:(s.memoizedState=h,s=py(),Wt.lanes|=s,Do|=s,h)}function Np(s,c,h,x){return Gi(h,c)?h:wl.current!==null?(s=Gu(s,h,x),Gi(s,c)||(Ai=!0),s):(Ta&42)===0?(Ai=!0,s.memoizedState=h):(s=py(),Wt.lanes|=s,Do|=s,c)}function Yu(s,c,h,x,N){var E=Q.p;Q.p=E!==0&&8>E?E:8;var q=H.T,Z={};H.T=Z,_p(s,!1,c,h);try{var ge=N(),Re=H.S;if(Re!==null&&Re(Z,ge),ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var Ge=Kb(ge,x);jl(s,c,Ge,Ji(s))}else jl(s,c,x,Ji(s))}catch(Xe){jl(s,c,{then:function(){},status:"rejected",reason:Xe},Ji())}finally{Q.p=E,H.T=q}}function Og(){}function Wu(s,c,h,x){if(s.tag!==5)throw Error(i(476));var N=Cp(s).queue;Yu(s,N,c,J,h===null?Og:function(){return kf(s),h(x)})}function Cp(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:J},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:h},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function kf(s){var c=Cp(s).next.queue;jl(s,c,{},Ji())}function Qu(){return oi(Bc)}function $s(){return gi().memoizedState}function Lg(){return gi().memoizedState}function _o(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var h=Ji();s=No(h);var x=Os(c,s,h);x!==null&&(Vr(x,c,h),Lu(x,c,h)),c={cache:rp()},s.payload=c;return}c=c.return}}function Fg(s,c,h){var x=Ji();h={lane:x,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},Tf(s)?$g(c,h):(h=Ps(s,c,h,x),h!==null&&(Vr(h,s,x),kp(h,c,x)))}function jp(s,c,h){var x=Ji();jl(s,c,h,x)}function jl(s,c,h,x){var N={lane:x,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(Tf(s))$g(c,N);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=c.lastRenderedReducer,E!==null))try{var q=c.lastRenderedState,Z=E(q,h);if(N.hasEagerState=!0,N.eagerState=Z,Gi(Z,q))return gr(s,c,N,0),Bn===null&&Ja(),!1}catch{}finally{}if(h=Ps(s,c,N,x),h!==null)return Vr(h,s,x),kp(h,c,x),!0}return!1}function _p(s,c,h,x){if(x={lane:2,revertLane:Jf(),action:x,hasEagerState:!1,eagerState:null,next:null},Tf(s)){if(c)throw Error(i(479))}else c=Ps(s,h,x,2),c!==null&&Vr(c,s,2)}function Tf(s){var c=s.alternate;return s===Wt||c!==null&&c===Wt}function $g(s,c){Sl=xc=!0;var h=s.pending;h===null?c.next=c:(c.next=h.next,h.next=c),s.pending=c}function kp(s,c,h){if((h&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,h|=x,c.lanes=h,bn(s,h)}}var Ju={readContext:oi,use:gf,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useLayoutEffect:cn,useInsertionEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useSyncExternalStore:cn,useId:cn,useHostTransitionStatus:cn,useFormState:cn,useActionState:cn,useOptimistic:cn,useMemoCache:cn,useCacheRefresh:cn},zg={readContext:oi,use:gf,useCallback:function(s,c){return wr().memoizedState=[s,c===void 0?null:c],s},useContext:oi,useEffect:Rg,useImperativeHandle:function(s,c,h){h=h!=null?h.concat([s]):null,qu(4194308,4,jf.bind(null,c,s),h)},useLayoutEffect:function(s,c){return qu(4194308,4,s,c)},useInsertionEffect:function(s,c){qu(4,2,s,c)},useMemo:function(s,c){var h=wr();c=c===void 0?null:c;var x=s();if(Wi){qe(!0);try{s()}finally{qe(!1)}}return h.memoizedState=[x,c],x},useReducer:function(s,c,h){var x=wr();if(h!==void 0){var N=h(c);if(Wi){qe(!0);try{h(c)}finally{qe(!1)}}}else N=c;return x.memoizedState=x.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},x.queue=s,s=s.dispatch=Fg.bind(null,Wt,s),[x.memoizedState,s]},useRef:function(s){var c=wr();return s={current:s},c.memoizedState=s},useState:function(s){s=vf(s);var c=s.queue,h=jp.bind(null,Wt,c);return c.dispatch=h,[s.memoizedState,h]},useDebugValue:_f,useDeferredValue:function(s,c){var h=wr();return Gu(h,s,c)},useTransition:function(){var s=vf(!1);return s=Yu.bind(null,Wt,s.queue,!0,!1),wr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,h){var x=Wt,N=wr();if(an){if(h===void 0)throw Error(i(407));h=h()}else{if(h=c(),Bn===null)throw Error(i(349));(hn&124)!==0||xf(x,c,h)}N.memoizedState=h;var E={value:h,getSnapshot:c};return N.queue=E,Rg(bf.bind(null,x,E,s),[s]),x.flags|=2048,vc(9,Cf(),Ag.bind(null,x,E,h,c),null),h},useId:function(){var s=wr(),c=Bn.identifierPrefix;if(an){var h=Rs,x=Jn;h=(x&~(1<<32-et(x)-1)).toString(32)+h,c=""+c+"R"+h,h=bc++,0<h&&(c+="H"+h.toString(32)),c+=""}else h=kg++,c=""+c+"r"+h.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Qu,useFormState:vp,useActionState:vp,useOptimistic:function(s){var c=wr();c.memoizedState=c.baseState=s;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=_p.bind(null,Wt,!0,h),h.dispatch=c,[s,c]},useMemoCache:Uu,useCacheRefresh:function(){return wr().memoizedState=_o.bind(null,Wt)}},Tp={readContext:oi,use:gf,useCallback:Sr,useContext:oi,useEffect:zr,useImperativeHandle:Sp,useInsertionEffect:Mg,useLayoutEffect:Hu,useMemo:Fs,useReducer:yf,useRef:wc,useState:function(){return yf(Xa)},useDebugValue:_f,useDeferredValue:function(s,c){var h=gi();return Np(h,kn.memoizedState,s,c)},useTransition:function(){var s=yf(Xa)[0],c=gi().memoizedState;return[typeof s=="boolean"?s:zu(s),c]},useSyncExternalStore:mp,useId:$s,useHostTransitionStatus:Qu,useFormState:Nf,useActionState:Nf,useOptimistic:function(s,c){var h=gi();return Bu(h,kn,s,c)},useMemoCache:Uu,useCacheRefresh:Lg},Ug={readContext:oi,use:gf,useCallback:Sr,useContext:oi,useEffect:zr,useImperativeHandle:Sp,useInsertionEffect:Mg,useLayoutEffect:Hu,useMemo:Fs,useReducer:pp,useRef:wc,useState:function(){return pp(Xa)},useDebugValue:_f,useDeferredValue:function(s,c){var h=gi();return kn===null?Gu(h,s,c):Np(h,kn.memoizedState,s,c)},useTransition:function(){var s=pp(Xa)[0],c=gi().memoizedState;return[typeof s=="boolean"?s:zu(s),c]},useSyncExternalStore:mp,useId:$s,useHostTransitionStatus:Qu,useFormState:Vt,useActionState:Vt,useOptimistic:function(s,c){var h=gi();return kn!==null?Bu(h,kn,s,c):(h.baseState=s,[s,h.queue.dispatch])},useMemoCache:Uu,useCacheRefresh:Lg},wi=null,Nr=0;function Ef(s){var c=Nr;return Nr+=1,wi===null&&(wi=[]),op(wi,s,c)}function Ku(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function _l(s,c){throw c.$$typeof===g?Error(i(525)):(s=Object.prototype.toString.call(c),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function kl(s){var c=s._init;return c(s._payload)}function Ep(s){function c(Ee,Ce){if(s){var Ie=Ee.deletions;Ie===null?(Ee.deletions=[Ce],Ee.flags|=16):Ie.push(Ce)}}function h(Ee,Ce){if(!s)return null;for(;Ce!==null;)c(Ee,Ce),Ce=Ce.sibling;return null}function x(Ee){for(var Ce=new Map;Ee!==null;)Ee.key!==null?Ce.set(Ee.key,Ee):Ce.set(Ee.index,Ee),Ee=Ee.sibling;return Ce}function N(Ee,Ce){return Ee=xt(Ee,Ce),Ee.index=0,Ee.sibling=null,Ee}function E(Ee,Ce,Ie){return Ee.index=Ie,s?(Ie=Ee.alternate,Ie!==null?(Ie=Ie.index,Ie<Ce?(Ee.flags|=67108866,Ce):Ie):(Ee.flags|=67108866,Ce)):(Ee.flags|=1048576,Ce)}function q(Ee){return s&&Ee.alternate===null&&(Ee.flags|=67108866),Ee}function Z(Ee,Ce,Ie,We){return Ce===null||Ce.tag!==6?(Ce=tp(Ie,Ee.mode,We),Ce.return=Ee,Ce):(Ce=N(Ce,Ie),Ce.return=Ee,Ce)}function ge(Ee,Ce,Ie,We){var yt=Ie.type;return yt===S?Ge(Ee,Ce,Ie.props.children,We,Ie.key):Ce!==null&&(Ce.elementType===yt||typeof yt=="object"&&yt!==null&&yt.$$typeof===$&&kl(yt)===Ce.type)?(Ce=N(Ce,Ie.props),Ku(Ce,Ie),Ce.return=Ee,Ce):(Ce=yr(Ie.type,Ie.key,Ie.props,null,Ee.mode,We),Ku(Ce,Ie),Ce.return=Ee,Ce)}function Re(Ee,Ce,Ie,We){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==Ie.containerInfo||Ce.stateNode.implementation!==Ie.implementation?(Ce=hc(Ie,Ee.mode,We),Ce.return=Ee,Ce):(Ce=N(Ce,Ie.children||[]),Ce.return=Ee,Ce)}function Ge(Ee,Ce,Ie,We,yt){return Ce===null||Ce.tag!==7?(Ce=Ds(Ie,Ee.mode,We,yt),Ce.return=Ee,Ce):(Ce=N(Ce,Ie),Ce.return=Ee,Ce)}function Xe(Ee,Ce,Ie){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ce=tp(""+Ce,Ee.mode,Ie),Ce.return=Ee,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case b:return Ie=yr(Ce.type,Ce.key,Ce.props,null,Ee.mode,Ie),Ku(Ie,Ce),Ie.return=Ee,Ie;case v:return Ce=hc(Ce,Ee.mode,Ie),Ce.return=Ee,Ce;case $:var We=Ce._init;return Ce=We(Ce._payload),Xe(Ee,Ce,Ie)}if(W(Ce)||Y(Ce))return Ce=Ds(Ce,Ee.mode,Ie,null),Ce.return=Ee,Ce;if(typeof Ce.then=="function")return Xe(Ee,Ef(Ce),Ie);if(Ce.$$typeof===I)return Xe(Ee,uf(Ee,Ce),Ie);_l(Ee,Ce)}return null}function Le(Ee,Ce,Ie,We){var yt=Ce!==null?Ce.key:null;if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return yt!==null?null:Z(Ee,Ce,""+Ie,We);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case b:return Ie.key===yt?ge(Ee,Ce,Ie,We):null;case v:return Ie.key===yt?Re(Ee,Ce,Ie,We):null;case $:return yt=Ie._init,Ie=yt(Ie._payload),Le(Ee,Ce,Ie,We)}if(W(Ie)||Y(Ie))return yt!==null?null:Ge(Ee,Ce,Ie,We,null);if(typeof Ie.then=="function")return Le(Ee,Ce,Ef(Ie),We);if(Ie.$$typeof===I)return Le(Ee,Ce,uf(Ee,Ie),We);_l(Ee,Ie)}return null}function Oe(Ee,Ce,Ie,We,yt){if(typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint")return Ee=Ee.get(Ie)||null,Z(Ce,Ee,""+We,yt);if(typeof We=="object"&&We!==null){switch(We.$$typeof){case b:return Ee=Ee.get(We.key===null?Ie:We.key)||null,ge(Ce,Ee,We,yt);case v:return Ee=Ee.get(We.key===null?Ie:We.key)||null,Re(Ce,Ee,We,yt);case $:var Xt=We._init;return We=Xt(We._payload),Oe(Ee,Ce,Ie,We,yt)}if(W(We)||Y(We))return Ee=Ee.get(Ie)||null,Ge(Ce,Ee,We,yt,null);if(typeof We.then=="function")return Oe(Ee,Ce,Ie,Ef(We),yt);if(We.$$typeof===I)return Oe(Ee,Ce,Ie,uf(Ce,We),yt);_l(Ce,We)}return null}function At(Ee,Ce,Ie,We){for(var yt=null,Xt=null,wt=Ce,Pt=Ce=0,Ii=null;wt!==null&&Pt<Ie.length;Pt++){wt.index>Pt?(Ii=wt,wt=null):Ii=wt.sibling;var yn=Le(Ee,wt,Ie[Pt],We);if(yn===null){wt===null&&(wt=Ii);break}s&&wt&&yn.alternate===null&&c(Ee,wt),Ce=E(yn,Ce,Pt),Xt===null?yt=yn:Xt.sibling=yn,Xt=yn,wt=Ii}if(Pt===Ie.length)return h(Ee,wt),an&&gl(Ee,Pt),yt;if(wt===null){for(;Pt<Ie.length;Pt++)wt=Xe(Ee,Ie[Pt],We),wt!==null&&(Ce=E(wt,Ce,Pt),Xt===null?yt=wt:Xt.sibling=wt,Xt=wt);return an&&gl(Ee,Pt),yt}for(wt=x(wt);Pt<Ie.length;Pt++)Ii=Oe(wt,Ee,Pt,Ie[Pt],We),Ii!==null&&(s&&Ii.alternate!==null&&wt.delete(Ii.key===null?Pt:Ii.key),Ce=E(Ii,Ce,Pt),Xt===null?yt=Ii:Xt.sibling=Ii,Xt=Ii);return s&&wt.forEach(function(Bo){return c(Ee,Bo)}),an&&gl(Ee,Pt),yt}function Et(Ee,Ce,Ie,We){if(Ie==null)throw Error(i(151));for(var yt=null,Xt=null,wt=Ce,Pt=Ce=0,Ii=null,yn=Ie.next();wt!==null&&!yn.done;Pt++,yn=Ie.next()){wt.index>Pt?(Ii=wt,wt=null):Ii=wt.sibling;var Bo=Le(Ee,wt,yn.value,We);if(Bo===null){wt===null&&(wt=Ii);break}s&&wt&&Bo.alternate===null&&c(Ee,wt),Ce=E(Bo,Ce,Pt),Xt===null?yt=Bo:Xt.sibling=Bo,Xt=Bo,wt=Ii}if(yn.done)return h(Ee,wt),an&&gl(Ee,Pt),yt;if(wt===null){for(;!yn.done;Pt++,yn=Ie.next())yn=Xe(Ee,yn.value,We),yn!==null&&(Ce=E(yn,Ce,Pt),Xt===null?yt=yn:Xt.sibling=yn,Xt=yn);return an&&gl(Ee,Pt),yt}for(wt=x(wt);!yn.done;Pt++,yn=Ie.next())yn=Oe(wt,Ee,Pt,yn.value,We),yn!==null&&(s&&yn.alternate!==null&&wt.delete(yn.key===null?Pt:yn.key),Ce=E(yn,Ce,Pt),Xt===null?yt=yn:Xt.sibling=yn,Xt=yn);return s&&wt.forEach(function(Rv){return c(Ee,Rv)}),an&&gl(Ee,Pt),yt}function Rn(Ee,Ce,Ie,We){if(typeof Ie=="object"&&Ie!==null&&Ie.type===S&&Ie.key===null&&(Ie=Ie.props.children),typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case b:e:{for(var yt=Ie.key;Ce!==null;){if(Ce.key===yt){if(yt=Ie.type,yt===S){if(Ce.tag===7){h(Ee,Ce.sibling),We=N(Ce,Ie.props.children),We.return=Ee,Ee=We;break e}}else if(Ce.elementType===yt||typeof yt=="object"&&yt!==null&&yt.$$typeof===$&&kl(yt)===Ce.type){h(Ee,Ce.sibling),We=N(Ce,Ie.props),Ku(We,Ie),We.return=Ee,Ee=We;break e}h(Ee,Ce);break}else c(Ee,Ce);Ce=Ce.sibling}Ie.type===S?(We=Ds(Ie.props.children,Ee.mode,We,Ie.key),We.return=Ee,Ee=We):(We=yr(Ie.type,Ie.key,Ie.props,null,Ee.mode,We),Ku(We,Ie),We.return=Ee,Ee=We)}return q(Ee);case v:e:{for(yt=Ie.key;Ce!==null;){if(Ce.key===yt)if(Ce.tag===4&&Ce.stateNode.containerInfo===Ie.containerInfo&&Ce.stateNode.implementation===Ie.implementation){h(Ee,Ce.sibling),We=N(Ce,Ie.children||[]),We.return=Ee,Ee=We;break e}else{h(Ee,Ce);break}else c(Ee,Ce);Ce=Ce.sibling}We=hc(Ie,Ee.mode,We),We.return=Ee,Ee=We}return q(Ee);case $:return yt=Ie._init,Ie=yt(Ie._payload),Rn(Ee,Ce,Ie,We)}if(W(Ie))return At(Ee,Ce,Ie,We);if(Y(Ie)){if(yt=Y(Ie),typeof yt!="function")throw Error(i(150));return Ie=yt.call(Ie),Et(Ee,Ce,Ie,We)}if(typeof Ie.then=="function")return Rn(Ee,Ce,Ef(Ie),We);if(Ie.$$typeof===I)return Rn(Ee,Ce,uf(Ee,Ie),We);_l(Ee,Ie)}return typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint"?(Ie=""+Ie,Ce!==null&&Ce.tag===6?(h(Ee,Ce.sibling),We=N(Ce,Ie),We.return=Ee,Ee=We):(h(Ee,Ce),We=tp(Ie,Ee.mode,We),We.return=Ee,Ee=We),q(Ee)):h(Ee,Ce)}return function(Ee,Ce,Ie,We){try{Nr=0;var yt=Rn(Ee,Ce,Ie,We);return wi=null,yt}catch(wt){if(wt===ir||wt===ff)throw wt;var Xt=lt(29,wt,null,Ee.mode);return Xt.lanes=We,Xt.return=Ee,Xt}finally{}}}var Tl=Ep(!0),Bg=Ep(!1),Ur=oe(null),rr=null;function ia(s){var c=s.alternate;D(li,li.current&1),D(Ur,s),rr===null&&(c===null||wl.current!==null||c.memoizedState!==null)&&(rr=s)}function qg(s){if(s.tag===22){if(D(li,li.current),D(Ur,s),rr===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(rr=s)}}else zs()}function zs(){D(li,li.current),D(Ur,Ur.current)}function Za(s){ue(Ur),rr===s&&(rr=null),ue(li)}var li=oe(0);function Xu(s){for(var c=s;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||sr(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Sc(s,c,h,x){c=s.memoizedState,h=h(x,c),h=h==null?c:p({},c,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var Zu={enqueueSetState:function(s,c,h){s=s._reactInternals;var x=Ji(),N=No(x);N.payload=c,h!=null&&(N.callback=h),c=Os(s,N,x),c!==null&&(Vr(c,s,x),Lu(c,s,x))},enqueueReplaceState:function(s,c,h){s=s._reactInternals;var x=Ji(),N=No(x);N.tag=1,N.payload=c,h!=null&&(N.callback=h),c=Os(s,N,x),c!==null&&(Vr(c,s,x),Lu(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var h=Ji(),x=No(h);x.tag=2,c!=null&&(x.callback=c),c=Os(s,x,h),c!==null&&(Vr(c,s,h),Lu(c,s,h))}};function ed(s,c,h,x,N,E,q){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,E,q):c.prototype&&c.prototype.isPureReactComponent?!Lr(h,x)||!Lr(N,E):!0}function Vg(s,c,h,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,x),c.state!==s&&Zu.enqueueReplaceState(c,c.state,null)}function ko(s,c){var h=c;if("ref"in c){h={};for(var x in c)x!=="ref"&&(h[x]=c[x])}if(s=s.defaultProps){h===c&&(h=p({},h));for(var N in s)h[N]===void 0&&(h[N]=s[N])}return h}var El=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Ap(s){El(s)}function Af(s){console.error(s)}function Hg(s){El(s)}function td(s,c){try{var h=s.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function es(s,c,h){try{var x=s.onCaughtError;x(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Pf(s,c,h){return h=No(h),h.tag=3,h.payload={element:null},h.callback=function(){td(s,c)},h}function Pp(s){return s=No(s),s.tag=3,s}function Gg(s,c,h,x){var N=h.type.getDerivedStateFromError;if(typeof N=="function"){var E=x.value;s.payload=function(){return N(E)},s.callback=function(){es(c,h,x)}}var q=h.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(s.callback=function(){es(c,h,x),typeof N!="function"&&(Io===null?Io=new Set([this]):Io.add(this));var Z=x.stack;this.componentDidCatch(x.value,{componentStack:Z!==null?Z:""})})}function Yg(s,c,h,x,N){if(h.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=h.alternate,c!==null&&Ru(c,h,N,!0),h=Ur.current,h!==null){switch(h.tag){case 13:return rr===null?Jp():h.alternate===null&&ci===0&&(ci=3),h.flags&=-257,h.flags|=65536,h.lanes=N,x===sp?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([x]):c.add(x),Zp(s,x,N)),!1;case 22:return h.flags|=65536,x===sp?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([x]):h.add(x)),Zp(s,x,N)),!1}throw Error(i(435,h.tag))}return Zp(s,x,N),Jp(),!1}if(an)return c=Ur.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==pc&&(s=Error(i(422),{cause:x}),wo(zi(s,h)))):(x!==pc&&(c=Error(i(423),{cause:x}),wo(zi(c,h))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,x=zi(x,h),N=Pf(s.stateNode,x,N),_a(s,N),ci!==4&&(ci=2)),!1;var E=Error(i(520),{cause:x});if(E=zi(E,h),dd===null?dd=[E]:dd.push(E),ci!==4&&(ci=2),c===null)return!0;x=zi(x,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,s=N&-N,h.lanes|=s,s=Pf(h.stateNode,x,s),_a(h,s),!1;case 1:if(c=h.type,E=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Io===null||!Io.has(E))))return h.flags|=65536,N&=-N,h.lanes|=N,N=Pp(N),Gg(N,s,h,x),_a(h,N),!1}h=h.return}while(h!==null);return!1}var Wg=Error(i(461)),Ai=!1;function Hn(s,c,h,x){c.child=s===null?Bg(c,null,h,x):Tl(c,s.child,h,x)}function Df(s,c,h,x,N){h=h.render;var E=c.ref;if("ref"in x){var q={};for(var Z in x)Z!=="ref"&&(q[Z]=x[Z])}else q=x;return xl(c),x=up(s,c,h,q,E,N),Z=fp(),s!==null&&!Ai?(Nl(s,c,N),Us(s,c,N)):(an&&Z&&ip(c),c.flags|=1,Hn(s,c,x,N),c.child)}function If(s,c,h,x,N){if(s===null){var E=h.type;return typeof E=="function"&&!bt(E)&&E.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=E,Rf(s,c,E,x,N)):(s=yr(h.type,null,x,c,c.mode,N),s.ref=c.ref,s.return=c,c.child=s)}if(E=s.child,!Ea(s,N)){var q=E.memoizedProps;if(h=h.compare,h=h!==null?h:Lr,h(q,x)&&s.ref===c.ref)return Us(s,c,N)}return c.flags|=1,s=xt(E,x),s.ref=c.ref,s.return=c,c.child=s}function Rf(s,c,h,x,N){if(s!==null){var E=s.memoizedProps;if(Lr(E,x)&&s.ref===c.ref)if(Ai=!1,c.pendingProps=x=E,Ea(s,N))(s.flags&131072)!==0&&(Ai=!0);else return c.lanes=s.lanes,Us(s,c,N)}return Nc(s,c,h,x,N)}function nd(s,c,h){var x=c.pendingProps,N=x.children,E=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=E!==null?E.baseLanes|h:h,s!==null){for(N=c.child=s.child,E=0;N!==null;)E=E|N.lanes|N.childLanes,N=N.sibling;c.childLanes=E&~x}else c.childLanes=0,c.child=null;return Al(s,c,x,h)}if((h&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&df(c,E!==null?E.cachePool:null),E!==null?Ls(c,E):pf(),qg(c);else return c.lanes=c.childLanes=536870912,Al(s,c,E!==null?E.baseLanes|h:h,h)}else E!==null?(df(c,E.cachePool),Ls(c,E),zs(),c.memoizedState=null):(s!==null&&df(c,null),pf(),zs());return Hn(s,c,N,h),c.child}function Al(s,c,h,x){var N=Ms();return N=N===null?null:{parent:Fn._currentValue,pool:N},c.memoizedState={baseLanes:h,cachePool:N},s!==null&&df(c,null),pf(),qg(c),s!==null&&Ru(s,c,x,!0),null}function Ct(s,c){var h=c.ref;if(h===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(i(284));(s===null||s.ref!==h)&&(c.flags|=4194816)}}function Nc(s,c,h,x,N){return xl(c),h=up(s,c,h,x,void 0,N),x=fp(),s!==null&&!Ai?(Nl(s,c,N),Us(s,c,N)):(an&&x&&ip(c),c.flags|=1,Hn(s,c,h,N),c.child)}function Mf(s,c,h,x,N,E){return xl(c),c.updateQueue=null,h=Eg(c,x,h,N),Tg(s),x=fp(),s!==null&&!Ai?(Nl(s,c,E),Us(s,c,E)):(an&&x&&ip(c),c.flags|=1,Hn(s,c,h,E),c.child)}function To(s,c,h,x,N){if(xl(c),c.stateNode===null){var E=je,q=h.contextType;typeof q=="object"&&q!==null&&(E=oi(q)),E=new h(x,E),c.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=Zu,c.stateNode=E,E._reactInternals=c,E=c.stateNode,E.props=x,E.state=c.memoizedState,E.refs={},vl(c),q=h.contextType,E.context=typeof q=="object"&&q!==null?oi(q):je,E.state=c.memoizedState,q=h.getDerivedStateFromProps,typeof q=="function"&&(Sc(c,h,q,x),E.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(q=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),q!==E.state&&Zu.enqueueReplaceState(E,E.state,null),Yi(c,x,E,N),ka(),E.state=c.memoizedState),typeof E.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){E=c.stateNode;var Z=c.memoizedProps,ge=ko(h,Z);E.props=ge;var Re=E.context,Ge=h.contextType;q=je,typeof Ge=="object"&&Ge!==null&&(q=oi(Ge));var Xe=h.getDerivedStateFromProps;Ge=typeof Xe=="function"||typeof E.getSnapshotBeforeUpdate=="function",Z=c.pendingProps!==Z,Ge||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(Z||Re!==q)&&Vg(c,E,x,q),Ka=!1;var Le=c.memoizedState;E.state=Le,Yi(c,x,E,N),ka(),Re=c.memoizedState,Z||Le!==Re||Ka?(typeof Xe=="function"&&(Sc(c,h,Xe,x),Re=c.memoizedState),(ge=Ka||ed(c,h,ge,x,Le,Re,q))?(Ge||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(c.flags|=4194308)):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Re),E.props=x,E.state=Re,E.context=q,x=ge):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{E=c.stateNode,yc(s,c),q=c.memoizedProps,Ge=ko(h,q),E.props=Ge,Xe=c.pendingProps,Le=E.context,Re=h.contextType,ge=je,typeof Re=="object"&&Re!==null&&(ge=oi(Re)),Z=h.getDerivedStateFromProps,(Re=typeof Z=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(q!==Xe||Le!==ge)&&Vg(c,E,x,ge),Ka=!1,Le=c.memoizedState,E.state=Le,Yi(c,x,E,N),ka();var Oe=c.memoizedState;q!==Xe||Le!==Oe||Ka||s!==null&&s.dependencies!==null&&cf(s.dependencies)?(typeof Z=="function"&&(Sc(c,h,Z,x),Oe=c.memoizedState),(Ge=Ka||ed(c,h,Ge,x,Le,Oe,ge)||s!==null&&s.dependencies!==null&&cf(s.dependencies))?(Re||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(x,Oe,ge),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(x,Oe,ge)),typeof E.componentDidUpdate=="function"&&(c.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof E.componentDidUpdate!="function"||q===s.memoizedProps&&Le===s.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&Le===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Oe),E.props=x,E.state=Oe,E.context=ge,x=Ge):(typeof E.componentDidUpdate!="function"||q===s.memoizedProps&&Le===s.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&Le===s.memoizedState||(c.flags|=1024),x=!1)}return E=x,Ct(s,c),x=(c.flags&128)!==0,E||x?(E=c.stateNode,h=x&&typeof h.getDerivedStateFromError!="function"?null:E.render(),c.flags|=1,s!==null&&x?(c.child=Tl(c,s.child,null,N),c.child=Tl(c,null,h,N)):Hn(s,c,h,N),c.memoizedState=E.state,s=c.child):s=Us(s,c,N),s}function Qg(s,c,h,x){return Iu(),c.flags|=256,Hn(s,c,h,x),c.child}var id={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Of(s){return{baseLanes:s,cachePool:wg()}}function Pi(s,c,h){return s=s!==null?s.childLanes&~h:0,c&&(s|=aa),s}function Jg(s,c,h){var x=c.pendingProps,N=!1,E=(c.flags&128)!==0,q;if((q=E)||(q=s!==null&&s.memoizedState===null?!1:(li.current&2)!==0),q&&(N=!0,c.flags&=-129),q=(c.flags&32)!==0,c.flags&=-33,s===null){if(an){if(N?ia(c):zs(),an){var Z=Kn,ge;if(ge=Z){e:{for(ge=Z,Z=xr;ge.nodeType!==8;){if(!Z){Z=null;break e}if(ge=Pa(ge.nextSibling),ge===null){Z=null;break e}}Z=ge}Z!==null?(c.memoizedState={dehydrated:Z,treeContext:Vn!==null?{id:Jn,overflow:Rs}:null,retryLane:536870912,hydrationErrors:null},ge=lt(18,null,null,0),ge.stateNode=Z,ge.return=c,c.child=ge,vi=c,Kn=null,ge=!0):ge=!1}ge||ea(c)}if(Z=c.memoizedState,Z!==null&&(Z=Z.dehydrated,Z!==null))return sr(Z)?c.lanes=32:c.lanes=536870912,null;Za(c)}return Z=x.children,x=x.fallback,N?(zs(),N=c.mode,Z=rd({mode:"hidden",children:Z},N),x=Ds(x,N,h,null),Z.return=c,x.return=c,Z.sibling=x,c.child=Z,N=c.child,N.memoizedState=Of(h),N.childLanes=Pi(s,q,h),c.memoizedState=id,x):(ia(c),Dp(c,Z))}if(ge=s.memoizedState,ge!==null&&(Z=ge.dehydrated,Z!==null)){if(E)c.flags&256?(ia(c),c.flags&=-257,c=Ip(s,c,h)):c.memoizedState!==null?(zs(),c.child=s.child,c.flags|=128,c=null):(zs(),N=x.fallback,Z=c.mode,x=rd({mode:"visible",children:x.children},Z),N=Ds(N,Z,h,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,Tl(c,s.child,null,h),x=c.child,x.memoizedState=Of(h),x.childLanes=Pi(s,q,h),c.memoizedState=id,c=N);else if(ia(c),sr(Z)){if(q=Z.nextSibling&&Z.nextSibling.dataset,q)var Re=q.dgst;q=Re,x=Error(i(419)),x.stack="",x.digest=q,wo({value:x,source:null,stack:null}),c=Ip(s,c,h)}else if(Ai||Ru(s,c,h,!1),q=(h&s.childLanes)!==0,Ai||q){if(q=Bn,q!==null&&(x=h&-h,x=(x&42)!==0?1:Ti(x),x=(x&(q.suspendedLanes|h))!==0?0:x,x!==0&&x!==ge.retryLane))throw ge.retryLane=x,ae(s,x),Vr(q,s,x),Wg;Z.data==="$?"||Jp(),c=Ip(s,c,h)}else Z.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=ge.treeContext,Kn=Pa(Z.nextSibling),vi=c,an=!0,ja=null,xr=!1,s!==null&&(Xr[Zr++]=Jn,Xr[Zr++]=Rs,Xr[Zr++]=Vn,Jn=s.id,Rs=s.overflow,Vn=c),c=Dp(c,x.children),c.flags|=4096);return c}return N?(zs(),N=x.fallback,Z=c.mode,ge=s.child,Re=ge.sibling,x=xt(ge,{mode:"hidden",children:x.children}),x.subtreeFlags=ge.subtreeFlags&65011712,Re!==null?N=xt(Re,N):(N=Ds(N,Z,h,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,Z=s.child.memoizedState,Z===null?Z=Of(h):(ge=Z.cachePool,ge!==null?(Re=Fn._currentValue,ge=ge.parent!==Re?{parent:Re,pool:Re}:ge):ge=wg(),Z={baseLanes:Z.baseLanes|h,cachePool:ge}),N.memoizedState=Z,N.childLanes=Pi(s,q,h),c.memoizedState=id,x):(ia(c),h=s.child,s=h.sibling,h=xt(h,{mode:"visible",children:x.children}),h.return=c,h.sibling=null,s!==null&&(q=c.deletions,q===null?(c.deletions=[s],c.flags|=16):q.push(s)),c.child=h,c.memoizedState=null,h)}function Dp(s,c){return c=rd({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function rd(s,c){return s=lt(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Ip(s,c,h){return Tl(c,s.child,null,h),s=Dp(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Rp(s,c,h){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),br(s.return,c,h)}function Mp(s,c,h,x,N){var E=s.memoizedState;E===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:N}:(E.isBackwards=c,E.rendering=null,E.renderingStartTime=0,E.last=x,E.tail=h,E.tailMode=N)}function Kg(s,c,h){var x=c.pendingProps,N=x.revealOrder,E=x.tail;if(Hn(s,c,x.children,h),x=li.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Rp(s,h,c);else if(s.tag===19)Rp(s,h,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(D(li,x),N){case"forwards":for(h=c.child,N=null;h!==null;)s=h.alternate,s!==null&&Xu(s)===null&&(N=h),h=h.sibling;h=N,h===null?(N=c.child,c.child=null):(N=h.sibling,h.sibling=null),Mp(c,!1,N,h,E);break;case"backwards":for(h=null,N=c.child,c.child=null;N!==null;){if(s=N.alternate,s!==null&&Xu(s)===null){c.child=N;break}s=N.sibling,N.sibling=h,h=N,N=s}Mp(c,!0,h,null,E);break;case"together":Mp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Us(s,c,h){if(s!==null&&(c.dependencies=s.dependencies),Do|=c.lanes,(h&c.childLanes)===0)if(s!==null){if(Ru(s,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(i(153));if(c.child!==null){for(s=c.child,h=xt(s,s.pendingProps),c.child=h,h.return=c;s.sibling!==null;)s=s.sibling,h=h.sibling=xt(s,s.pendingProps),h.return=c;h.sibling=null}return c.child}function Ea(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&cf(s)))}function ar(s,c,h){switch(c.tag){case 3:re(c,c.stateNode.containerInfo),$r(c,Fn,s.memoizedState.cache),Iu();break;case 27:case 5:Qe(c);break;case 4:re(c,c.stateNode.containerInfo);break;case 10:$r(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(ia(c),c.flags|=128,null):(h&c.child.childLanes)!==0?Jg(s,c,h):(ia(c),s=Us(s,c,h),s!==null?s.sibling:null);ia(c);break;case 19:var N=(s.flags&128)!==0;if(x=(h&c.childLanes)!==0,x||(Ru(s,c,h,!1),x=(h&c.childLanes)!==0),N){if(x)return Kg(s,c,h);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),D(li,li.current),x)break;return null;case 22:case 23:return c.lanes=0,nd(s,c,h);case 24:$r(c,Fn,s.memoizedState.cache)}return Us(s,c,h)}function Lf(s,c,h){if(s!==null)if(s.memoizedProps!==c.pendingProps)Ai=!0;else{if(!Ea(s,h)&&(c.flags&128)===0)return Ai=!1,ar(s,c,h);Ai=(s.flags&131072)!==0}else Ai=!1,an&&(c.flags&1048576)!==0&&np(c,Au,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")bt(x)?(s=ko(x,s),c.tag=1,c=To(null,c,x,s,h)):(c.tag=0,c=Nc(null,c,x,s,h));else{if(x!=null){if(N=x.$$typeof,N===U){c.tag=11,c=Df(null,c,x,s,h);break e}else if(N===z){c.tag=14,c=If(null,c,x,s,h);break e}}throw c=te(x)||x,Error(i(306,c,""))}}return c;case 0:return Nc(s,c,c.type,c.pendingProps,h);case 1:return x=c.type,N=ko(x,c.pendingProps),To(s,c,x,N,h);case 3:e:{if(re(c,c.stateNode.containerInfo),s===null)throw Error(i(387));x=c.pendingProps;var E=c.memoizedState;N=E.element,yc(s,c),Yi(c,x,null,h);var q=c.memoizedState;if(x=q.cache,$r(c,Fn,x),x!==E.cache&&Kt(c,[Fn],h,!0),ka(),x=q.element,E.isDehydrated)if(E={element:x,isDehydrated:!1,cache:q.cache},c.updateQueue.baseState=E,c.memoizedState=E,c.flags&256){c=Qg(s,c,x,h);break e}else if(x!==N){N=zi(Error(i(424)),c),wo(N),c=Qg(s,c,x,h);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Kn=Pa(s.firstChild),vi=c,an=!0,ja=null,xr=!0,h=Bg(c,null,x,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Iu(),x===N){c=Us(s,c,h);break e}Hn(s,c,x,h)}c=c.child}return c;case 26:return Ct(s,c),s===null?(h=Yy(c.type,null,c.pendingProps,null))?c.memoizedState=h:an||(h=c.type,s=c.pendingProps,x=Il(ee.current).createElement(h),x[Ln]=c,x[Li]=s,Ci(x,h,s),hi(x),c.stateNode=x):c.memoizedState=Yy(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return Qe(c),s===null&&an&&(x=c.stateNode=Vy(c.type,c.pendingProps,ee.current),vi=c,xr=!0,N=Kn,sa(c.type)?(lm=N,Kn=Pa(x.firstChild)):Kn=N),Hn(s,c,c.pendingProps.children,h),Ct(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&an&&((N=x=Kn)&&(x=By(x,c.type,c.pendingProps,xr),x!==null?(c.stateNode=x,vi=c,Kn=Pa(x.firstChild),xr=!1,N=!0):N=!1),N||ea(c)),Qe(c),N=c.type,E=c.pendingProps,q=s!==null?s.memoizedProps:null,x=E.children,eh(N,E)?x=null:q!==null&&eh(N,q)&&(c.flags|=32),c.memoizedState!==null&&(N=up(s,c,dp,null,null,h),Bc._currentValue=N),Ct(s,c),Hn(s,c,x,h),c.child;case 6:return s===null&&an&&((s=h=Kn)&&(h=nh(h,c.pendingProps,xr),h!==null?(c.stateNode=h,vi=c,Kn=null,s=!0):s=!1),s||ea(c)),null;case 13:return Jg(s,c,h);case 4:return re(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=Tl(c,null,x,h):Hn(s,c,x,h),c.child;case 11:return Df(s,c,c.type,c.pendingProps,h);case 7:return Hn(s,c,c.pendingProps,h),c.child;case 8:return Hn(s,c,c.pendingProps.children,h),c.child;case 12:return Hn(s,c,c.pendingProps.children,h),c.child;case 10:return x=c.pendingProps,$r(c,c.type,x.value),Hn(s,c,x.children,h),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,xl(c),N=oi(N),x=x(N),c.flags|=1,Hn(s,c,x,h),c.child;case 14:return If(s,c,c.type,c.pendingProps,h);case 15:return Rf(s,c,c.type,c.pendingProps,h);case 19:return Kg(s,c,h);case 31:return x=c.pendingProps,h=c.mode,x={mode:x.mode,children:x.children},s===null?(h=rd(x,h),h.ref=c.ref,c.child=h,h.return=c,c=h):(h=xt(s.child,x),h.ref=c.ref,c.child=h,h.return=c,c=h),c;case 22:return nd(s,c,h);case 24:return xl(c),x=oi(Fn),s===null?(N=Ms(),N===null&&(N=Bn,E=rp(),N.pooledCache=E,E.refCount++,E!==null&&(N.pooledCacheLanes|=h),N=E),c.memoizedState={parent:x,cache:N},vl(c),$r(c,Fn,N)):((s.lanes&h)!==0&&(yc(s,c),Yi(c,null,null,h),ka()),N=s.memoizedState,E=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),$r(c,Fn,x)):(x=E.cache,$r(c,Fn,x),x!==N.cache&&Kt(c,[Fn],h,!0))),Hn(s,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(i(156,c.tag))}function Bs(s){s.flags|=4}function Ff(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!ji(c)){if(c=Ur.current,c!==null&&((hn&4194048)===hn?rr!==null:(hn&62914560)!==hn&&(hn&536870912)===0||c!==rr))throw gc=sp,Sg;s.flags|=8192}}function $f(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?On():536870912,s.lanes|=c,Ac|=c)}function ad(s,c){if(!an)switch(s.tailMode){case"hidden":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function $n(s){var c=s.alternate!==null&&s.alternate.child===s.child,h=0,x=0;if(c)for(var N=s.child;N!==null;)h|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)h|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=x,s.childLanes=h,c}function Xg(s,c,h){var x=c.pendingProps;switch(Pu(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(c),null;case 1:return $n(c),null;case 3:return h=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),ta(Fn),Pe(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Du(c)?Bs(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,yg())),$n(c),null;case 26:return h=c.memoizedState,s===null?(Bs(c),h!==null?($n(c),Ff(c,h)):($n(c),c.flags&=-16777217)):h?h!==s.memoizedState?(Bs(c),$n(c),Ff(c,h)):($n(c),c.flags&=-16777217):(s.memoizedProps!==x&&Bs(c),$n(c),c.flags&=-16777217),null;case 27:Se(c),h=ee.current;var N=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Bs(c);else{if(!x){if(c.stateNode===null)throw Error(i(166));return $n(c),null}s=se.current,Du(c)?mg(c):(s=Vy(N,x,h),c.stateNode=s,Bs(c))}return $n(c),null;case 5:if(Se(c),h=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Bs(c);else{if(!x){if(c.stateNode===null)throw Error(i(166));return $n(c),null}if(s=se.current,Du(c))mg(c);else{switch(N=Il(ee.current),s){case 1:s=N.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:s=N.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":s=N.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":s=N.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?N.createElement(h,{is:x.is}):N.createElement(h)}}s[Ln]=c,s[Li]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)s.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=s;e:switch(Ci(s,h,x),h){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Bs(c)}}return $n(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&Bs(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(i(166));if(s=ee.current,Du(c)){if(s=c.stateNode,h=c.memoizedProps,x=null,N=vi,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}s[Ln]=c,s=!!(s.nodeValue===h||x!==null&&x.suppressHydrationWarning===!0||Fy(s.nodeValue,h)),s||ea(c)}else s=Il(s).createTextNode(x),s[Ln]=c,c.stateNode=s}return $n(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=Du(c),x!==null&&x.dehydrated!==null){if(s===null){if(!N)throw Error(i(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(i(317));N[Ln]=c}else Iu(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;$n(c),N=!1}else N=yg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(Za(c),c):(Za(c),null)}if(Za(c),(c.flags&128)!==0)return c.lanes=h,c;if(h=x!==null,s=s!==null&&s.memoizedState!==null,h){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var E=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(E=x.memoizedState.cachePool.pool),E!==N&&(x.flags|=2048)}return h!==s&&h&&(c.child.flags|=8192),$f(c,c.updateQueue),$n(c),null;case 4:return Pe(),s===null&&rm(c.stateNode.containerInfo),$n(c),null;case 10:return ta(c.type),$n(c),null;case 19:if(ue(li),N=c.memoizedState,N===null)return $n(c),null;if(x=(c.flags&128)!==0,E=N.rendering,E===null)if(x)ad(N,!1);else{if(ci!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(E=Xu(s),E!==null){for(c.flags|=128,ad(N,!1),s=E.updateQueue,c.updateQueue=s,$f(c,s),c.subtreeFlags=0,s=h,h=c.child;h!==null;)mi(h,s),h=h.sibling;return D(li,li.current&1|2),c.child}s=s.sibling}N.tail!==null&&ut()>Pc&&(c.flags|=128,x=!0,ad(N,!1),c.lanes=4194304)}else{if(!x)if(s=Xu(E),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,$f(c,s),ad(N,!0),N.tail===null&&N.tailMode==="hidden"&&!E.alternate&&!an)return $n(c),null}else 2*ut()-N.renderingStartTime>Pc&&h!==536870912&&(c.flags|=128,x=!0,ad(N,!1),c.lanes=4194304);N.isBackwards?(E.sibling=c.child,c.child=E):(s=N.last,s!==null?s.sibling=E:c.child=E,N.last=E)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=ut(),c.sibling=null,s=li.current,D(li,x?s&1|2:s&1),c):($n(c),null);case 22:case 23:return Za(c),cp(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(h&536870912)!==0&&(c.flags&128)===0&&($n(c),c.subtreeFlags&6&&(c.flags|=8192)):$n(c),h=c.updateQueue,h!==null&&$f(c,h.retryQueue),h=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==h&&(c.flags|=2048),s!==null&&ue(bl),null;case 24:return h=null,s!==null&&(h=s.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),ta(Fn),$n(c),null;case 25:return null;case 30:return null}throw Error(i(156,c.tag))}function Zg(s,c){switch(Pu(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return ta(Fn),Pe(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return Se(c),null;case 13:if(Za(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(i(340));Iu()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return ue(li),null;case 4:return Pe(),null;case 10:return ta(c.type),null;case 22:case 23:return Za(c),cp(),s!==null&&ue(bl),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return ta(Fn),null;case 25:return null;default:return null}}function ey(s,c){switch(Pu(c),c.tag){case 3:ta(Fn),Pe();break;case 26:case 27:case 5:Se(c);break;case 4:Pe();break;case 13:Za(c);break;case 19:ue(li);break;case 10:ta(c.type);break;case 22:case 23:Za(c),cp(),s!==null&&ue(bl);break;case 24:ta(Fn)}}function sd(s,c){try{var h=c.updateQueue,x=h!==null?h.lastEffect:null;if(x!==null){var N=x.next;h=N;do{if((h.tag&s)===s){x=void 0;var E=h.create,q=h.inst;x=E(),q.destroy=x}h=h.next}while(h!==N)}}catch(Z){zn(c,c.return,Z)}}function Eo(s,c,h){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var E=N.next;x=E;do{if((x.tag&s)===s){var q=x.inst,Z=q.destroy;if(Z!==void 0){q.destroy=void 0,N=c;var ge=h,Re=Z;try{Re()}catch(Ge){zn(N,ge,Ge)}}}x=x.next}while(x!==E)}}catch(Ge){zn(c,c.return,Ge)}}function ty(s){var c=s.updateQueue;if(c!==null){var h=s.stateNode;try{lp(c,h)}catch(x){zn(s,s.return,x)}}}function Op(s,c,h){h.props=ko(s.type,s.memoizedProps),h.state=s.memoizedState;try{h.componentWillUnmount()}catch(x){zn(s,c,x)}}function Cc(s,c){try{var h=s.ref;if(h!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof h=="function"?s.refCleanup=h(x):h.current=x}}catch(N){zn(s,c,N)}}function ts(s,c){var h=s.ref,x=s.refCleanup;if(h!==null)if(typeof x=="function")try{x()}catch(N){zn(s,c,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(N){zn(s,c,N)}else h.current=null}function zf(s){var c=s.type,h=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&x.focus();break e;case"img":h.src?x.src=h.src:h.srcSet&&(x.srcset=h.srcSet)}}catch(N){zn(s,s.return,N)}}function Uf(s,c,h){try{var x=s.stateNode;hv(x,s.type,h,c),x[Li]=c}catch(N){zn(s,s.return,N)}}function jc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&sa(s.type)||s.tag===4}function od(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||jc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&sa(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Bf(s,c,h){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(s,c):(c=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,c.appendChild(s),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Xf));else if(x!==4&&(x===27&&sa(s.type)&&(h=s.stateNode,c=null),s=s.child,s!==null))for(Bf(s,c,h),s=s.sibling;s!==null;)Bf(s,c,h),s=s.sibling}function ld(s,c,h){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?h.insertBefore(s,c):h.appendChild(s);else if(x!==4&&(x===27&&sa(s.type)&&(h=s.stateNode),s=s.child,s!==null))for(ld(s,c,h),s=s.sibling;s!==null;)ld(s,c,h),s=s.sibling}function cd(s){var c=s.stateNode,h=s.memoizedProps;try{for(var x=s.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);Ci(c,x,h),c[Ln]=s,c[Li]=h}catch(E){zn(s,s.return,E)}}var ns=!1,_n=!1,qs=!1,ny=typeof WeakSet=="function"?WeakSet:Set,Si=null;function Zb(s,c){if(s=s.containerInfo,Aa=sh,s=_u(s),ku(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var N=x.anchorOffset,E=x.focusNode;x=x.focusOffset;try{h.nodeType,E.nodeType}catch{h=null;break e}var q=0,Z=-1,ge=-1,Re=0,Ge=0,Xe=s,Le=null;t:for(;;){for(var Oe;Xe!==h||N!==0&&Xe.nodeType!==3||(Z=q+N),Xe!==E||x!==0&&Xe.nodeType!==3||(ge=q+x),Xe.nodeType===3&&(q+=Xe.nodeValue.length),(Oe=Xe.firstChild)!==null;)Le=Xe,Xe=Oe;for(;;){if(Xe===s)break t;if(Le===h&&++Re===N&&(Z=q),Le===E&&++Ge===x&&(ge=q),(Oe=Xe.nextSibling)!==null)break;Xe=Le,Le=Xe.parentNode}Xe=Oe}h=Z===-1||ge===-1?null:{start:Z,end:ge}}else h=null}h=h||{start:0,end:0}}else h=null;for(Zf={focusedElem:s,selectionRange:h},sh=!1,Si=c;Si!==null;)if(c=Si,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,Si=s;else for(;Si!==null;){switch(c=Si,E=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,h=c,N=E.memoizedProps,E=E.memoizedState,x=h.stateNode;try{var At=ko(h.type,N,h.elementType===h.type);s=x.getSnapshotBeforeUpdate(At,E),x.__reactInternalSnapshotBeforeUpdate=s}catch(Et){zn(h,h.return,Et)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,h=s.nodeType,h===9)om(s);else if(h===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":om(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=c.sibling,s!==null){s.return=c.return,Si=s;break}Si=c.return}}function iy(s,c,h){var x=h.flags;switch(h.tag){case 0:case 11:case 15:Ao(s,h),x&4&&sd(5,h);break;case 1:if(Ao(s,h),x&4)if(s=h.stateNode,c===null)try{s.componentDidMount()}catch(q){zn(h,h.return,q)}else{var N=ko(h.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(N,c,s.__reactInternalSnapshotBeforeUpdate)}catch(q){zn(h,h.return,q)}}x&64&&ty(h),x&512&&Cc(h,h.return);break;case 3:if(Ao(s,h),x&64&&(s=h.updateQueue,s!==null)){if(c=null,h.child!==null)switch(h.child.tag){case 27:case 5:c=h.child.stateNode;break;case 1:c=h.child.stateNode}try{lp(s,c)}catch(q){zn(h,h.return,q)}}break;case 27:c===null&&x&4&&cd(h);case 26:case 5:Ao(s,h),c===null&&x&4&&zf(h),x&512&&Cc(h,h.return);break;case 12:Ao(s,h);break;case 13:Ao(s,h),x&4&&sy(s,h),x&64&&(s=h.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(h=Yf.bind(null,h),Lc(s,h))));break;case 22:if(x=h.memoizedState!==null||ns,!x){c=c!==null&&c.memoizedState!==null||_n,N=ns;var E=_n;ns=x,(_n=c)&&!E?Hs(s,h,(h.subtreeFlags&8772)!==0):Ao(s,h),ns=N,_n=E}break;case 30:break;default:Ao(s,h)}}function ry(s){var c=s.alternate;c!==null&&(s.alternate=null,ry(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&nl(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Xn=null,Cr=!1;function Vs(s,c,h){for(h=h.child;h!==null;)ay(s,c,h),h=h.sibling}function ay(s,c,h){if(de&&typeof de.onCommitFiberUnmount=="function")try{de.onCommitFiberUnmount(X,h)}catch{}switch(h.tag){case 26:_n||ts(h,c),Vs(s,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:_n||ts(h,c);var x=Xn,N=Cr;sa(h.type)&&(Xn=h.stateNode,Cr=!1),Vs(s,c,h),vd(h.stateNode),Xn=x,Cr=N;break;case 5:_n||ts(h,c);case 6:if(x=Xn,N=Cr,Xn=null,Vs(s,c,h),Xn=x,Cr=N,Xn!==null)if(Cr)try{(Xn.nodeType===9?Xn.body:Xn.nodeName==="HTML"?Xn.ownerDocument.body:Xn).removeChild(h.stateNode)}catch(E){zn(h,c,E)}else try{Xn.removeChild(h.stateNode)}catch(E){zn(h,c,E)}break;case 18:Xn!==null&&(Cr?(s=Xn,th(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,h.stateNode),Td(s)):th(Xn,h.stateNode));break;case 4:x=Xn,N=Cr,Xn=h.stateNode.containerInfo,Cr=!0,Vs(s,c,h),Xn=x,Cr=N;break;case 0:case 11:case 14:case 15:_n||Eo(2,h,c),_n||Eo(4,h,c),Vs(s,c,h);break;case 1:_n||(ts(h,c),x=h.stateNode,typeof x.componentWillUnmount=="function"&&Op(h,c,x)),Vs(s,c,h);break;case 21:Vs(s,c,h);break;case 22:_n=(x=_n)||h.memoizedState!==null,Vs(s,c,h),_n=x;break;default:Vs(s,c,h)}}function sy(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Td(s)}catch(h){zn(c,c.return,h)}}function ev(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new ny),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new ny),c;default:throw Error(i(435,s.tag))}}function Lp(s,c){var h=ev(s);c.forEach(function(x){var N=sv.bind(null,s,x);h.has(x)||(h.add(x),x.then(N,N))})}function Br(s,c){var h=c.deletions;if(h!==null)for(var x=0;x<h.length;x++){var N=h[x],E=s,q=c,Z=q;e:for(;Z!==null;){switch(Z.tag){case 27:if(sa(Z.type)){Xn=Z.stateNode,Cr=!1;break e}break;case 5:Xn=Z.stateNode,Cr=!1;break e;case 3:case 4:Xn=Z.stateNode.containerInfo,Cr=!0;break e}Z=Z.return}if(Xn===null)throw Error(i(160));ay(E,q,N),Xn=null,Cr=!1,E=N.alternate,E!==null&&(E.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Fp(c,s),c=c.sibling}var ra=null;function Fp(s,c){var h=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Br(c,s),jr(s),x&4&&(Eo(3,s,s.return),sd(3,s),Eo(5,s,s.return));break;case 1:Br(c,s),jr(s),x&512&&(_n||h===null||ts(h,h.return)),x&64&&ns&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(h=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=h===null?x:h.concat(x))));break;case 26:var N=ra;if(Br(c,s),jr(s),x&512&&(_n||h===null||ts(h,h.return)),x&4){var E=h!==null?h.memoizedState:null;if(x=s.memoizedState,h===null)if(x===null)if(s.stateNode===null){e:{x=s.type,h=s.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":E=N.getElementsByTagName("title")[0],(!E||E[tl]||E[Ln]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=N.createElement(x),N.head.insertBefore(E,N.querySelector("head > title"))),Ci(E,x,h),E[Ln]=s,hi(E),x=E;break e;case"link":var q=Jy("link","href",N).get(x+(h.href||""));if(q){for(var Z=0;Z<q.length;Z++)if(E=q[Z],E.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&E.getAttribute("rel")===(h.rel==null?null:h.rel)&&E.getAttribute("title")===(h.title==null?null:h.title)&&E.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){q.splice(Z,1);break t}}E=N.createElement(x),Ci(E,x,h),N.head.appendChild(E);break;case"meta":if(q=Jy("meta","content",N).get(x+(h.content||""))){for(Z=0;Z<q.length;Z++)if(E=q[Z],E.getAttribute("content")===(h.content==null?null:""+h.content)&&E.getAttribute("name")===(h.name==null?null:h.name)&&E.getAttribute("property")===(h.property==null?null:h.property)&&E.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&E.getAttribute("charset")===(h.charSet==null?null:h.charSet)){q.splice(Z,1);break t}}E=N.createElement(x),Ci(E,x,h),N.head.appendChild(E);break;default:throw Error(i(468,x))}E[Ln]=s,hi(E),x=E}s.stateNode=x}else Ky(N,s.type,s.stateNode);else s.stateNode=Qy(N,x,s.memoizedProps);else E!==x?(E===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):E.count--,x===null?Ky(N,s.type,s.stateNode):Qy(N,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Uf(s,s.memoizedProps,h.memoizedProps)}break;case 27:Br(c,s),jr(s),x&512&&(_n||h===null||ts(h,h.return)),h!==null&&x&4&&Uf(s,s.memoizedProps,h.memoizedProps);break;case 5:if(Br(c,s),jr(s),x&512&&(_n||h===null||ts(h,h.return)),s.flags&32){N=s.stateNode;try{Ua(N,"")}catch(Oe){zn(s,s.return,Oe)}}x&4&&s.stateNode!=null&&(N=s.memoizedProps,Uf(s,N,h!==null?h.memoizedProps:N)),x&1024&&(qs=!0);break;case 6:if(Br(c,s),jr(s),x&4){if(s.stateNode===null)throw Error(i(162));x=s.memoizedProps,h=s.stateNode;try{h.nodeValue=x}catch(Oe){zn(s,s.return,Oe)}}break;case 3:if(Uc=null,N=ra,ra=Bt(c.containerInfo),Br(c,s),ra=N,jr(s),x&4&&h!==null&&h.memoizedState.isDehydrated)try{Td(c.containerInfo)}catch(Oe){zn(s,s.return,Oe)}qs&&(qs=!1,oy(s));break;case 4:x=ra,ra=Bt(s.stateNode.containerInfo),Br(c,s),jr(s),ra=x;break;case 12:Br(c,s),jr(s);break;case 13:Br(c,s),jr(s),s.child.flags&8192&&s.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Hp=ut()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Lp(s,x)));break;case 22:N=s.memoizedState!==null;var ge=h!==null&&h.memoizedState!==null,Re=ns,Ge=_n;if(ns=Re||N,_n=Ge||ge,Br(c,s),_n=Ge,ns=Re,jr(s),x&8192)e:for(c=s.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(h===null||ge||ns||_n||Pl(s)),h=null,c=s;;){if(c.tag===5||c.tag===26){if(h===null){ge=h=c;try{if(E=ge.stateNode,N)q=E.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{Z=ge.stateNode;var Xe=ge.memoizedProps.style,Le=Xe!=null&&Xe.hasOwnProperty("display")?Xe.display:null;Z.style.display=Le==null||typeof Le=="boolean"?"":(""+Le).trim()}}catch(Oe){zn(ge,ge.return,Oe)}}}else if(c.tag===6){if(h===null){ge=c;try{ge.stateNode.nodeValue=N?"":ge.memoizedProps}catch(Oe){zn(ge,ge.return,Oe)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(h=x.retryQueue,h!==null&&(x.retryQueue=null,Lp(s,h))));break;case 19:Br(c,s),jr(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Lp(s,x)));break;case 30:break;case 21:break;default:Br(c,s),jr(s)}}function jr(s){var c=s.flags;if(c&2){try{for(var h,x=s.return;x!==null;){if(jc(x)){h=x;break}x=x.return}if(h==null)throw Error(i(160));switch(h.tag){case 27:var N=h.stateNode,E=od(s);ld(s,E,N);break;case 5:var q=h.stateNode;h.flags&32&&(Ua(q,""),h.flags&=-33);var Z=od(s);ld(s,Z,q);break;case 3:case 4:var ge=h.stateNode.containerInfo,Re=od(s);Bf(s,Re,ge);break;default:throw Error(i(161))}}catch(Ge){zn(s,s.return,Ge)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function oy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;oy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function Ao(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)iy(s,c.alternate,c),c=c.sibling}function Pl(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:Eo(4,c,c.return),Pl(c);break;case 1:ts(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&Op(c,c.return,h),Pl(c);break;case 27:vd(c.stateNode);case 26:case 5:ts(c,c.return),Pl(c);break;case 22:c.memoizedState===null&&Pl(c);break;case 30:Pl(c);break;default:Pl(c)}s=s.sibling}}function Hs(s,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=s,E=c,q=E.flags;switch(E.tag){case 0:case 11:case 15:Hs(N,E,h),sd(4,E);break;case 1:if(Hs(N,E,h),x=E,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Re){zn(x,x.return,Re)}if(x=E,N=x.updateQueue,N!==null){var Z=x.stateNode;try{var ge=N.shared.hiddenCallbacks;if(ge!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ge.length;N++)_g(ge[N],Z)}catch(Re){zn(x,x.return,Re)}}h&&q&64&&ty(E),Cc(E,E.return);break;case 27:cd(E);case 26:case 5:Hs(N,E,h),h&&x===null&&q&4&&zf(E),Cc(E,E.return);break;case 12:Hs(N,E,h);break;case 13:Hs(N,E,h),h&&q&4&&sy(N,E);break;case 22:E.memoizedState===null&&Hs(N,E,h),Cc(E,E.return);break;case 30:break;default:Hs(N,E,h)}c=c.sibling}}function $p(s,c){var h=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==h&&(s!=null&&s.refCount++,h!=null&&Mu(h))}function zp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Mu(s))}function is(s,c,h,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)ly(s,c,h,x),c=c.sibling}function ly(s,c,h,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:is(s,c,h,x),N&2048&&sd(9,c);break;case 1:is(s,c,h,x);break;case 3:is(s,c,h,x),N&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Mu(s)));break;case 12:if(N&2048){is(s,c,h,x),s=c.stateNode;try{var E=c.memoizedProps,q=E.id,Z=E.onPostCommit;typeof Z=="function"&&Z(q,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ge){zn(c,c.return,ge)}}else is(s,c,h,x);break;case 13:is(s,c,h,x);break;case 23:break;case 22:E=c.stateNode,q=c.alternate,c.memoizedState!==null?E._visibility&2?is(s,c,h,x):ud(s,c):E._visibility&2?is(s,c,h,x):(E._visibility|=2,_c(s,c,h,x,(c.subtreeFlags&10256)!==0)),N&2048&&$p(q,c);break;case 24:is(s,c,h,x),N&2048&&zp(c.alternate,c);break;default:is(s,c,h,x)}}function _c(s,c,h,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var E=s,q=c,Z=h,ge=x,Re=q.flags;switch(q.tag){case 0:case 11:case 15:_c(E,q,Z,ge,N),sd(8,q);break;case 23:break;case 22:var Ge=q.stateNode;q.memoizedState!==null?Ge._visibility&2?_c(E,q,Z,ge,N):ud(E,q):(Ge._visibility|=2,_c(E,q,Z,ge,N)),N&&Re&2048&&$p(q.alternate,q);break;case 24:_c(E,q,Z,ge,N),N&&Re&2048&&zp(q.alternate,q);break;default:_c(E,q,Z,ge,N)}c=c.sibling}}function ud(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=s,x=c,N=x.flags;switch(x.tag){case 22:ud(h,x),N&2048&&$p(x.alternate,x);break;case 24:ud(h,x),N&2048&&zp(x.alternate,x);break;default:ud(h,x)}c=c.sibling}}var Qi=8192;function kc(s){if(s.subtreeFlags&Qi)for(s=s.child;s!==null;)cy(s),s=s.sibling}function cy(s){switch(s.tag){case 26:kc(s),s.flags&Qi&&s.memoizedState!==null&&jv(ra,s.memoizedState,s.memoizedProps);break;case 5:kc(s);break;case 3:case 4:var c=ra;ra=Bt(s.stateNode.containerInfo),kc(s),ra=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Qi,Qi=16777216,kc(s),Qi=c):kc(s));break;default:kc(s)}}function uy(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Tc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];Si=x,fy(x,s)}uy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)dy(s),s=s.sibling}function dy(s){switch(s.tag){case 0:case 11:case 15:Tc(s),s.flags&2048&&Eo(9,s,s.return);break;case 3:Tc(s);break;case 12:Tc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,qf(s)):Tc(s);break;default:Tc(s)}}function qf(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];Si=x,fy(x,s)}uy(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:Eo(8,c,c.return),qf(c);break;case 22:h=c.stateNode,h._visibility&2&&(h._visibility&=-3,qf(c));break;default:qf(c)}s=s.sibling}}function fy(s,c){for(;Si!==null;){var h=Si;switch(h.tag){case 0:case 11:case 15:Eo(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var x=h.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Mu(h.memoizedState.cache)}if(x=h.child,x!==null)x.return=h,Si=x;else e:for(h=s;Si!==null;){x=Si;var N=x.sibling,E=x.return;if(ry(x),x===h){Si=null;break e}if(N!==null){N.return=E,Si=N;break e}Si=E}}}var tv={getCacheForType:function(s){var c=oi(Fn),h=c.data.get(s);return h===void 0&&(h=s(),c.data.set(s,h)),h}},Up=typeof WeakMap=="function"?WeakMap:Map,Tn=0,Bn=null,en=null,hn=0,En=0,qr=null,Po=!1,Ec=!1,Bp=!1,Gs=0,ci=0,Do=0,Dl=0,qp=0,aa=0,Ac=0,dd=null,_r=null,Vp=!1,Hp=0,Pc=1/0,fd=null,Io=null,Ui=0,Ro=null,Dc=null,Ic=0,Gp=0,Yp=null,hy=null,Rc=0,Wp=null;function Ji(){if((Tn&2)!==0&&hn!==0)return hn&-hn;if(H.T!==null){var s=mc;return s!==0?s:Jf()}return ps()}function py(){aa===0&&(aa=(hn&536870912)===0||an?qt():536870912);var s=Ur.current;return s!==null&&(s.flags|=32),aa}function Vr(s,c,h){(s===Bn&&(En===2||En===9)||s.cancelPendingCommit!==null)&&(Mc(s,0),Mo(s,hn,aa,!1)),Rt(s,h),((Tn&2)===0||s!==Bn)&&(s===Bn&&((Tn&2)===0&&(Dl|=h),ci===4&&Mo(s,hn,aa,!1)),rs(s))}function my(s,c,h){if((Tn&6)!==0)throw Error(i(327));var x=!h&&(c&124)===0&&(c&s.expiredLanes)===0||tt(s,c),N=x?rv(s,c):Kp(s,c,!0),E=x;do{if(N===0){Ec&&!x&&Mo(s,c,0,!1);break}else{if(h=s.current.alternate,E&&!nv(h)){N=Kp(s,c,!1),E=!1;continue}if(N===2){if(E=c,s.errorRecoveryDisabledLanes&E)var q=0;else q=s.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){c=q;e:{var Z=s;N=dd;var ge=Z.current.memoizedState.isDehydrated;if(ge&&(Mc(Z,q).flags|=256),q=Kp(Z,q,!1),q!==2){if(Bp&&!ge){Z.errorRecoveryDisabledLanes|=E,Dl|=E,N=4;break e}E=_r,_r=N,E!==null&&(_r===null?_r=E:_r.push.apply(_r,E))}N=q}if(E=!1,N!==2)continue}}if(N===1){Mc(s,0),Mo(s,c,0,!0);break}e:{switch(x=s,E=N,E){case 0:case 1:throw Error(i(345));case 4:if((c&4194048)!==c)break;case 6:Mo(x,c,aa,!Po);break e;case 2:_r=null;break;case 3:case 5:break;default:throw Error(i(329))}if((c&62914560)===c&&(N=Hp+300-ut(),10<N)){if(Mo(x,c,aa,!Po),Ue(x,0,!0)!==0)break e;x.timeoutHandle=$y(gy.bind(null,x,h,_r,fd,Vp,c,aa,Dl,Ac,Po,E,2,-0,0),N);break e}gy(x,h,_r,fd,Vp,c,aa,Dl,Ac,Po,E,0,-0,0)}}break}while(!0);rs(s)}function gy(s,c,h,x,N,E,q,Z,ge,Re,Ge,Xe,Le,Oe){if(s.timeoutHandle=-1,Xe=c.subtreeFlags,(Xe&8192||(Xe&16785408)===16785408)&&(Di={stylesheets:null,count:0,unsuspend:Cv},cy(c),Xe=_v(),Xe!==null)){s.cancelPendingCommit=Xe(hd.bind(null,s,c,E,h,x,N,q,Z,ge,Ge,1,Le,Oe)),Mo(s,E,q,!Re);return}hd(s,c,E,h,x,N,q,Z,ge)}function nv(s){for(var c=s;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var x=0;x<h.length;x++){var N=h[x],E=N.getSnapshot;N=N.value;try{if(!Gi(E(),N))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Mo(s,c,h,x){c&=~qp,c&=~Dl,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var N=c;0<N;){var E=31-et(N),q=1<<E;x[E]=-1,N&=~q}h!==0&&ki(s,h,c)}function Vf(){return(Tn&6)===0?(gd(0),!1):!0}function Qp(){if(en!==null){if(En===0)var s=en.return;else s=en,K=So=null,mf(s),wi=null,Nr=0,s=en;for(;s!==null;)ey(s.alternate,s),s=s.return;en=null}}function Mc(s,c){var h=s.timeoutHandle;h!==-1&&(s.timeoutHandle=-1,mv(h)),h=s.cancelPendingCommit,h!==null&&(s.cancelPendingCommit=null,h()),Qp(),Bn=s,en=h=xt(s.current,null),hn=c,En=0,qr=null,Po=!1,Ec=tt(s,c),Bp=!1,Ac=aa=qp=Dl=Do=ci=0,_r=dd=null,Vp=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var N=31-et(x),E=1<<N;c|=s[N],x&=~E}return Gs=c,Ja(),h}function yy(s,c){Wt=null,H.H=Ju,c===ir||c===ff?(c=Cg(),En=3):c===Sg?(c=Cg(),En=4):En=c===Wg?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,qr=c,en===null&&(ci=1,td(s,zi(c,s.current)))}function xy(){var s=H.H;return H.H=Ju,s===null?Ju:s}function by(){var s=H.A;return H.A=tv,s}function Jp(){ci=4,Po||(hn&4194048)!==hn&&Ur.current!==null||(Ec=!0),(Do&134217727)===0&&(Dl&134217727)===0||Bn===null||Mo(Bn,hn,aa,!1)}function Kp(s,c,h){var x=Tn;Tn|=2;var N=xy(),E=by();(Bn!==s||hn!==c)&&(fd=null,Mc(s,c)),c=!1;var q=ci;e:do try{if(En!==0&&en!==null){var Z=en,ge=qr;switch(En){case 8:Qp(),q=6;break e;case 3:case 2:case 9:case 6:Ur.current===null&&(c=!0);var Re=En;if(En=0,qr=null,Oc(s,Z,ge,Re),h&&Ec){q=0;break e}break;default:Re=En,En=0,qr=null,Oc(s,Z,ge,Re)}}iv(),q=ci;break}catch(Ge){yy(s,Ge)}while(!0);return c&&s.shellSuspendCounter++,K=So=null,Tn=x,H.H=N,H.A=E,en===null&&(Bn=null,hn=0,Ja()),q}function iv(){for(;en!==null;)Xp(en)}function rv(s,c){var h=Tn;Tn|=2;var x=xy(),N=by();Bn!==s||hn!==c?(fd=null,Pc=ut()+500,Mc(s,c)):Ec=tt(s,c);e:do try{if(En!==0&&en!==null){c=en;var E=qr;t:switch(En){case 1:En=0,qr=null,Oc(s,c,E,1);break;case 2:case 9:if(Ng(E)){En=0,qr=null,wy(c);break}c=function(){En!==2&&En!==9||Bn!==s||(En=7),rs(s)},E.then(c,c);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:Ng(E)?(En=0,qr=null,wy(c)):(En=0,qr=null,Oc(s,c,E,7));break;case 5:var q=null;switch(en.tag){case 26:q=en.memoizedState;case 5:case 27:var Z=en;if(!q||ji(q)){En=0,qr=null;var ge=Z.sibling;if(ge!==null)en=ge;else{var Re=Z.return;Re!==null?(en=Re,Hf(Re)):en=null}break t}}En=0,qr=null,Oc(s,c,E,5);break;case 6:En=0,qr=null,Oc(s,c,E,6);break;case 8:Qp(),ci=6;break e;default:throw Error(i(462))}}vy();break}catch(Ge){yy(s,Ge)}while(!0);return K=So=null,H.H=x,H.A=N,Tn=h,en!==null?0:(Bn=null,hn=0,Ja(),ci)}function vy(){for(;en!==null&&!nt();)Xp(en)}function Xp(s){var c=Lf(s.alternate,s,Gs);s.memoizedProps=s.pendingProps,c===null?Hf(s):en=c}function wy(s){var c=s,h=c.alternate;switch(c.tag){case 15:case 0:c=Mf(h,c,c.pendingProps,c.type,void 0,hn);break;case 11:c=Mf(h,c,c.pendingProps,c.type.render,c.ref,hn);break;case 5:mf(c);default:ey(h,c),c=en=mi(c,Gs),c=Lf(h,c,Gs)}s.memoizedProps=s.pendingProps,c===null?Hf(s):en=c}function Oc(s,c,h,x){K=So=null,mf(c),wi=null,Nr=0;var N=c.return;try{if(Yg(s,N,c,h,hn)){ci=1,td(s,zi(h,s.current)),en=null;return}}catch(E){if(N!==null)throw en=N,E;ci=1,td(s,zi(h,s.current)),en=null;return}c.flags&32768?(an||x===1?s=!0:Ec||(hn&536870912)!==0?s=!1:(Po=s=!0,(x===2||x===9||x===3||x===6)&&(x=Ur.current,x!==null&&x.tag===13&&(x.flags|=16384))),Sy(c,s)):Hf(c)}function Hf(s){var c=s;do{if((c.flags&32768)!==0){Sy(c,Po);return}s=c.return;var h=Xg(c.alternate,c,Gs);if(h!==null){en=h;return}if(c=c.sibling,c!==null){en=c;return}en=c=s}while(c!==null);ci===0&&(ci=5)}function Sy(s,c){do{var h=Zg(s.alternate,s);if(h!==null){h.flags&=32767,en=h;return}if(h=s.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(s=s.sibling,s!==null)){en=s;return}en=s=h}while(s!==null);ci=6,en=null}function hd(s,c,h,x,N,E,q,Z,ge){s.cancelPendingCommit=null;do Gf();while(Ui!==0);if((Tn&6)!==0)throw Error(i(327));if(c!==null){if(c===s.current)throw Error(i(177));if(E=c.lanes|c.childLanes,E|=Eu,si(s,h,E,q,Z,ge),s===Bn&&(en=Bn=null,hn=0),Dc=c,Ro=s,Ic=h,Gp=E,Yp=N,hy=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ay(ye,function(){return ky(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=H.T,H.T=null,N=Q.p,Q.p=2,q=Tn,Tn|=4;try{Zb(s,c,h)}finally{Tn=q,Q.p=N,H.T=x}}Ui=1,Ny(),Cy(),jy()}}function Ny(){if(Ui===1){Ui=0;var s=Ro,c=Dc,h=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||h){h=H.T,H.T=null;var x=Q.p;Q.p=2;var N=Tn;Tn|=4;try{Fp(c,s);var E=Zf,q=_u(s.containerInfo),Z=E.focusedElem,ge=E.selectionRange;if(q!==Z&&Z&&Z.ownerDocument&&ju(Z.ownerDocument.documentElement,Z)){if(ge!==null&&ku(Z)){var Re=ge.start,Ge=ge.end;if(Ge===void 0&&(Ge=Re),"selectionStart"in Z)Z.selectionStart=Re,Z.selectionEnd=Math.min(Ge,Z.value.length);else{var Xe=Z.ownerDocument||document,Le=Xe&&Xe.defaultView||window;if(Le.getSelection){var Oe=Le.getSelection(),At=Z.textContent.length,Et=Math.min(ge.start,At),Rn=ge.end===void 0?Et:Math.min(ge.end,At);!Oe.extend&&Et>Rn&&(q=Rn,Rn=Et,Et=q);var Ee=hl(Z,Et),Ce=hl(Z,Rn);if(Ee&&Ce&&(Oe.rangeCount!==1||Oe.anchorNode!==Ee.node||Oe.anchorOffset!==Ee.offset||Oe.focusNode!==Ce.node||Oe.focusOffset!==Ce.offset)){var Ie=Xe.createRange();Ie.setStart(Ee.node,Ee.offset),Oe.removeAllRanges(),Et>Rn?(Oe.addRange(Ie),Oe.extend(Ce.node,Ce.offset)):(Ie.setEnd(Ce.node,Ce.offset),Oe.addRange(Ie))}}}}for(Xe=[],Oe=Z;Oe=Oe.parentNode;)Oe.nodeType===1&&Xe.push({element:Oe,left:Oe.scrollLeft,top:Oe.scrollTop});for(typeof Z.focus=="function"&&Z.focus(),Z=0;Z<Xe.length;Z++){var We=Xe[Z];We.element.scrollLeft=We.left,We.element.scrollTop=We.top}}sh=!!Aa,Zf=Aa=null}finally{Tn=N,Q.p=x,H.T=h}}s.current=c,Ui=2}}function Cy(){if(Ui===2){Ui=0;var s=Ro,c=Dc,h=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||h){h=H.T,H.T=null;var x=Q.p;Q.p=2;var N=Tn;Tn|=4;try{iy(s,c.alternate,c)}finally{Tn=N,Q.p=x,H.T=h}}Ui=3}}function jy(){if(Ui===4||Ui===3){Ui=0,ft();var s=Ro,c=Dc,h=Ic,x=hy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Ui=5:(Ui=0,Dc=Ro=null,_y(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(Io=null),rn(h),c=c.stateNode,de&&typeof de.onCommitFiberRoot=="function")try{de.onCommitFiberRoot(X,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=H.T,N=Q.p,Q.p=2,H.T=null;try{for(var E=s.onRecoverableError,q=0;q<x.length;q++){var Z=x[q];E(Z.value,{componentStack:Z.stack})}}finally{H.T=c,Q.p=N}}(Ic&3)!==0&&Gf(),rs(s),N=s.pendingLanes,(h&4194090)!==0&&(N&42)!==0?s===Wp?Rc++:(Rc=0,Wp=s):Rc=0,gd(0)}}function _y(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,Mu(c)))}function Gf(s){return Ny(),Cy(),jy(),ky()}function ky(){if(Ui!==5)return!1;var s=Ro,c=Gp;Gp=0;var h=rn(Ic),x=H.T,N=Q.p;try{Q.p=32>h?32:h,H.T=null,h=Yp,Yp=null;var E=Ro,q=Ic;if(Ui=0,Dc=Ro=null,Ic=0,(Tn&6)!==0)throw Error(i(331));var Z=Tn;if(Tn|=4,dy(E.current),ly(E,E.current,q,h),Tn=Z,gd(0,!1),de&&typeof de.onPostCommitFiberRoot=="function")try{de.onPostCommitFiberRoot(X,E)}catch{}return!0}finally{Q.p=N,H.T=x,_y(s,c)}}function Ty(s,c,h){c=zi(h,c),c=Pf(s.stateNode,c,2),s=Os(s,c,2),s!==null&&(Rt(s,2),rs(s))}function zn(s,c,h){if(s.tag===3)Ty(s,s,h);else for(;c!==null;){if(c.tag===3){Ty(c,s,h);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Io===null||!Io.has(x))){s=zi(h,s),h=Pp(2),x=Os(c,h,2),x!==null&&(Gg(h,x,c,s),Rt(x,2),rs(x));break}}c=c.return}}function Zp(s,c,h){var x=s.pingCache;if(x===null){x=s.pingCache=new Up;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(h)||(Bp=!0,N.add(h),s=av.bind(null,s,c,h),c.then(s,s))}function av(s,c,h){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&h,s.warmLanes&=~h,Bn===s&&(hn&h)===h&&(ci===4||ci===3&&(hn&62914560)===hn&&300>ut()-Hp?(Tn&2)===0&&Mc(s,0):qp|=h,Ac===hn&&(Ac=0)),rs(s)}function Ey(s,c){c===0&&(c=On()),s=ae(s,c),s!==null&&(Rt(s,c),rs(s))}function Yf(s){var c=s.memoizedState,h=0;c!==null&&(h=c.retryLane),Ey(s,h)}function sv(s,c){var h=0;switch(s.tag){case 13:var x=s.stateNode,N=s.memoizedState;N!==null&&(h=N.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(i(314))}x!==null&&x.delete(c),Ey(s,h)}function Ay(s,c){return De(s,c)}var pd=null,Oo=null,Wf=!1,md=!1,Qf=!1,Lo=0;function rs(s){s!==Oo&&s.next===null&&(Oo===null?pd=Oo=s:Oo=Oo.next=s),md=!0,Wf||(Wf=!0,em())}function gd(s,c){if(!Qf&&md){Qf=!0;do for(var h=!1,x=pd;x!==null;){if(s!==0){var N=x.pendingLanes;if(N===0)var E=0;else{var q=x.suspendedLanes,Z=x.pingedLanes;E=(1<<31-et(42|s)+1)-1,E&=N&~(q&~Z),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(h=!0,Dy(x,E))}else E=hn,E=Ue(x,x===Bn?E:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(E&3)===0||tt(x,E)||(h=!0,Dy(x,E));x=x.next}while(h);Qf=!1}}function ov(){yd()}function yd(){md=Wf=!1;var s=0;Lo!==0&&(pv()&&(s=Lo),Lo=0);for(var c=ut(),h=null,x=pd;x!==null;){var N=x.next,E=xd(x,c);E===0?(x.next=null,h===null?pd=N:h.next=N,N===null&&(Oo=h)):(h=x,(s!==0||(E&3)!==0)&&(md=!0)),x=N}gd(s)}function xd(s,c){for(var h=s.suspendedLanes,x=s.pingedLanes,N=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var q=31-et(E),Z=1<<q,ge=N[q];ge===-1?((Z&h)===0||(Z&x)!==0)&&(N[q]=dt(Z,c)):ge<=c&&(s.expiredLanes|=Z),E&=~Z}if(c=Bn,h=hn,h=Ue(s,s===c?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,h===0||s===c&&(En===2||En===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&Me(x),s.callbackNode=null,s.callbackPriority=0;if((h&3)===0||tt(s,h)){if(c=h&-h,c===s.callbackPriority)return c;switch(x!==null&&Me(x),rn(h)){case 2:case 8:h=Ft;break;case 32:h=ye;break;case 268435456:h=Ye;break;default:h=ye}return x=Py.bind(null,s),h=De(h,x),s.callbackPriority=c,s.callbackNode=h,c}return x!==null&&x!==null&&Me(x),s.callbackPriority=2,s.callbackNode=null,2}function Py(s,c){if(Ui!==0&&Ui!==5)return s.callbackNode=null,s.callbackPriority=0,null;var h=s.callbackNode;if(Gf()&&s.callbackNode!==h)return null;var x=hn;return x=Ue(s,s===Bn?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(my(s,x,c),xd(s,ut()),s.callbackNode!=null&&s.callbackNode===h?Py.bind(null,s):null)}function Dy(s,c){if(Gf())return null;my(s,c,!0)}function em(){gv(function(){(Tn&6)!==0?De(Nt,ov):yd()})}function Jf(){return Lo===0&&(Lo=qt()),Lo}function Iy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:co(""+s)}function Ry(s,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,s.id&&h.setAttribute("form",s.id),c.parentNode.insertBefore(h,c),s=new FormData(s),h.parentNode.removeChild(h),s}function lv(s,c,h,x,N){if(c==="submit"&&h&&h.stateNode===N){var E=Iy((N[Li]||null).action),q=x.submitter;q&&(c=(c=q[Li]||null)?Iy(c.formAction):q.getAttribute("formAction"),c!==null&&(E=c,q=null));var Z=new po("action","action",null,x,N);s.push({event:Z,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Lo!==0){var ge=q?Ry(N,q):new FormData(N);Wu(h,{pending:!0,data:ge,method:N.method,action:E},null,ge)}}else typeof E=="function"&&(Z.preventDefault(),ge=q?Ry(N,q):new FormData(N),Wu(h,{pending:!0,data:ge,method:N.method,action:E},E,ge))},currentTarget:N}]})}}for(var tm=0;tm<gn.length;tm++){var nm=gn[tm],cv=nm.toLowerCase(),uv=nm[0].toUpperCase()+nm.slice(1);Fr(cv,"on"+uv)}Fr(dc,"onAnimationEnd"),Fr(of,"onAnimationIteration"),Fr(Qn,"onAnimationStart"),Fr("dblclick","onDoubleClick"),Fr("focusin","onFocus"),Fr("focusout","onBlur"),Fr(fc,"onTransitionRun"),Fr(ep,"onTransitionStart"),Fr(As,"onTransitionCancel"),Fr(pl,"onTransitionEnd"),io("onMouseEnter",["mouseout","mouseover"]),io("onMouseLeave",["mouseout","mouseover"]),io("onPointerEnter",["pointerout","pointerover"]),io("onPointerLeave",["pointerout","pointerover"]),Mr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bd));function My(s,c){c=(c&4)!==0;for(var h=0;h<s.length;h++){var x=s[h],N=x.event;x=x.listeners;e:{var E=void 0;if(c)for(var q=x.length-1;0<=q;q--){var Z=x[q],ge=Z.instance,Re=Z.currentTarget;if(Z=Z.listener,ge!==E&&N.isPropagationStopped())break e;E=Z,N.currentTarget=Re;try{E(N)}catch(Ge){El(Ge)}N.currentTarget=null,E=ge}else for(q=0;q<x.length;q++){if(Z=x[q],ge=Z.instance,Re=Z.currentTarget,Z=Z.listener,ge!==E&&N.isPropagationStopped())break e;E=Z,N.currentTarget=Re;try{E(N)}catch(Ge){El(Ge)}N.currentTarget=null,E=ge}}}}function tn(s,c){var h=c[ms];h===void 0&&(h=c[ms]=new Set);var x=s+"__bubble";h.has(x)||(Oy(c,s,2,!1),h.add(x))}function im(s,c,h){var x=0;c&&(x|=4),Oy(h,s,x,c)}var kr="_reactListening"+Math.random().toString(36).slice(2);function rm(s){if(!s[kr]){s[kr]=!0,Yd.forEach(function(h){h!=="selectionchange"&&(dv.has(h)||im(h,!1,s),im(h,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[kr]||(c[kr]=!0,im("selectionchange",!1,c))}}function Oy(s,c,h,x){switch(tx(c)){case 2:var N=Ev;break;case 8:N=qc;break;default:N=pm}h=N.bind(null,c,h,s),N=void 0,!fo||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?s.addEventListener(c,h,{capture:!0,passive:N}):s.addEventListener(c,h,!0):N!==void 0?s.addEventListener(c,h,{passive:N}):s.addEventListener(c,h,!1)}function Ys(s,c,h,x,N){var E=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var q=x.tag;if(q===3||q===4){var Z=x.stateNode.containerInfo;if(Z===N)break;if(q===4)for(q=x.return;q!==null;){var ge=q.tag;if((ge===3||ge===4)&&q.stateNode.containerInfo===N)return;q=q.return}for(;Z!==null;){if(q=no(Z),q===null)return;if(ge=q.tag,ge===5||ge===6||ge===26||ge===27){x=E=q;continue e}Z=Z.parentNode}}x=x.return}ol(function(){var Re=E,Ge=Xl(h),Xe=[];e:{var Le=ml.get(s);if(Le!==void 0){var Oe=po,At=s;switch(s){case"keypress":if(vn(h)===0)break e;case"keydown":case"keyup":Oe=dl;break;case"focusin":At="focus",Oe=Ns;break;case"focusout":At="blur",Oe=Ns;break;case"beforeblur":case"afterblur":Oe=Ns;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Oe=Ga;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Oe=Ss;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Oe=Kd;break;case dc:case of:case Qn:Oe=ic;break;case pl:Oe=Xd;break;case"scroll":case"scrollend":Oe=yu;break;case"wheel":Oe=ac;break;case"copy":case"cut":case"paste":Oe=bu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Oe=tr;break;case"toggle":case"beforetoggle":Oe=fl}var Et=(c&4)!==0,Rn=!Et&&(s==="scroll"||s==="scrollend"),Ee=Et?Le!==null?Le+"Capture":null:Le;Et=[];for(var Ce=Re,Ie;Ce!==null;){var We=Ce;if(Ie=We.stateNode,We=We.tag,We!==5&&We!==26&&We!==27||Ie===null||Ee===null||(We=ba(Ce,Ee),We!=null&&Et.push($t(Ce,We,Ie))),Rn)break;Ce=Ce.return}0<Et.length&&(Le=new Oe(Le,At,null,h,Ge),Xe.push({event:Le,listeners:Et}))}}if((c&7)===0){e:{if(Le=s==="mouseover"||s==="pointerover",Oe=s==="mouseout"||s==="pointerout",Le&&h!==uo&&(At=h.relatedTarget||h.fromElement)&&(no(At)||At[Jr]))break e;if((Oe||Le)&&(Le=Ge.window===Ge?Ge:(Le=Ge.ownerDocument)?Le.defaultView||Le.parentWindow:window,Oe?(At=h.relatedTarget||h.toElement,Oe=Re,At=At?no(At):null,At!==null&&(Rn=o(At),Et=At.tag,At!==Rn||Et!==5&&Et!==27&&Et!==6)&&(At=null)):(Oe=null,At=Re),Oe!==At)){if(Et=Ga,We="onMouseLeave",Ee="onMouseEnter",Ce="mouse",(s==="pointerout"||s==="pointerover")&&(Et=tr,We="onPointerLeave",Ee="onPointerEnter",Ce="pointer"),Rn=Oe==null?Le:gs(Oe),Ie=At==null?Le:gs(At),Le=new Et(We,Ce+"leave",Oe,h,Ge),Le.target=Rn,Le.relatedTarget=Ie,We=null,no(Ge)===Re&&(Et=new Et(Ee,Ce+"enter",At,h,Ge),Et.target=Ie,Et.relatedTarget=Rn,We=Et),Rn=We,Oe&&At)t:{for(Et=Oe,Ee=At,Ce=0,Ie=Et;Ie;Ie=Ni(Ie))Ce++;for(Ie=0,We=Ee;We;We=Ni(We))Ie++;for(;0<Ce-Ie;)Et=Ni(Et),Ce--;for(;0<Ie-Ce;)Ee=Ni(Ee),Ie--;for(;Ce--;){if(Et===Ee||Ee!==null&&Et===Ee.alternate)break t;Et=Ni(Et),Ee=Ni(Ee)}Et=null}else Et=null;Oe!==null&&ui(Xe,Le,Oe,Et,!1),At!==null&&Rn!==null&&ui(Xe,Rn,At,Et,!0)}}e:{if(Le=Re?gs(Re):window,Oe=Le.nodeName&&Le.nodeName.toLowerCase(),Oe==="select"||Oe==="input"&&Le.type==="file")var yt=ef;else if(ks(Le))if(tf)yt=Ca;else{yt=$i;var Xt=rf}else Oe=Le.nodeName,!Oe||Oe.toLowerCase()!=="input"||Le.type!=="checkbox"&&Le.type!=="radio"?Re&&lo(Re.elementType)&&(yt=ef):yt=Or;if(yt&&(yt=yt(s,Re))){Ts(Xe,yt,h,Ge);break e}Xt&&Xt(s,Le,Re),s==="focusout"&&Re&&Le.type==="number"&&Re.memoizedProps.value!=null&&so(Le,"number",Le.value)}switch(Xt=Re?gs(Re):window,s){case"focusin":(ks(Xt)||Xt.contentEditable==="true")&&(xo=Xt,Qa=Re,ke=null);break;case"focusout":ke=Qa=xo=null;break;case"mousedown":He=!0;break;case"contextmenu":case"mouseup":case"dragend":He=!1,ze(Xe,h,Ge);break;case"selectionchange":if(sf)break;case"keydown":case"keyup":ze(Xe,h,Ge)}var wt;if(sc)e:{switch(s){case"compositionstart":var Pt="onCompositionStart";break e;case"compositionend":Pt="onCompositionEnd";break e;case"compositionupdate":Pt="onCompositionUpdate";break e}Pt=void 0}else pr?_s(s,h)&&(Pt="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(Pt="onCompositionStart");Pt&&(Sa&&h.locale!=="ko"&&(pr||Pt!=="onCompositionStart"?Pt==="onCompositionEnd"&&pr&&(wt=ec()):(Va=Ge,ll="value"in Va?Va.value:Va.textContent,pr=!0)),Xt=Kf(Re,Pt),0<Xt.length&&(Pt=new qi(Pt,s,null,h,Ge),Xe.push({event:Pt,listeners:Xt}),wt?Pt.data=wt:(wt=Na(h),wt!==null&&(Pt.data=wt)))),(wt=Zd?Xh(s,h):cc(s,h))&&(Pt=Kf(Re,"onBeforeInput"),0<Pt.length&&(Xt=new qi("onBeforeInput","beforeinput",null,h,Ge),Xe.push({event:Xt,listeners:Pt}),Xt.data=wt)),lv(Xe,s,Re,h,Ge)}My(Xe,c)})}function $t(s,c,h){return{instance:s,listener:c,currentTarget:h}}function Kf(s,c){for(var h=c+"Capture",x=[];s!==null;){var N=s,E=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||E===null||(N=ba(s,h),N!=null&&x.unshift($t(s,N,E)),N=ba(s,c),N!=null&&x.push($t(s,N,E))),s.tag===3)return x;s=s.return}return[]}function Ni(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function ui(s,c,h,x,N){for(var E=c._reactName,q=[];h!==null&&h!==x;){var Z=h,ge=Z.alternate,Re=Z.stateNode;if(Z=Z.tag,ge!==null&&ge===x)break;Z!==5&&Z!==26&&Z!==27||Re===null||(ge=Re,N?(Re=ba(h,E),Re!=null&&q.unshift($t(h,Re,ge))):N||(Re=ba(h,E),Re!=null&&q.push($t(h,Re,ge)))),h=h.return}q.length!==0&&s.push({event:c,listeners:q})}var fv=/\r\n?/g,Fo=/\u0000|\uFFFD/g;function Ly(s){return(typeof s=="string"?s:""+s).replace(fv,`
`).replace(Fo,"")}function Fy(s,c){return c=Ly(c),Ly(s)===c}function Xf(){}function In(s,c,h,x,N,E){switch(h){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||Ua(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&Ua(s,""+x);break;case"className":Gl(s,"class",x);break;case"tabIndex":Gl(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Gl(s,h,x);break;case"style":Jl(s,x,E);break;case"data":if(c!=="object"){Gl(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||h!=="href")){s.removeAttribute(h);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(h);break}x=co(""+x),s.setAttribute(h,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(h==="formAction"?(c!=="input"&&In(s,c,"name",N.name,N,null),In(s,c,"formEncType",N.formEncType,N,null),In(s,c,"formMethod",N.formMethod,N,null),In(s,c,"formTarget",N.formTarget,N,null)):(In(s,c,"encType",N.encType,N,null),In(s,c,"method",N.method,N,null),In(s,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(h);break}x=co(""+x),s.setAttribute(h,x);break;case"onClick":x!=null&&(s.onclick=Xf);break;case"onScroll":x!=null&&tn("scroll",s);break;case"onScrollEnd":x!=null&&tn("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(i(61));if(h=x.__html,h!=null){if(N.children!=null)throw Error(i(60));s.innerHTML=h}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}h=co(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,""+x):s.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,""):s.removeAttribute(h);break;case"capture":case"download":x===!0?s.setAttribute(h,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,x):s.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(h,x):s.removeAttribute(h);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(h):s.setAttribute(h,x);break;case"popover":tn("beforetoggle",s),tn("toggle",s),Hl(s,"popover",x);break;case"xlinkActuate":ur(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":ur(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":ur(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":ur(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":ur(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":ur(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":ur(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":ur(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":ur(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Hl(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=gu.get(h)||h,Hl(s,h,x))}}function am(s,c,h,x,N,E){switch(h){case"style":Jl(s,x,E);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(i(61));if(h=x.__html,h!=null){if(N.children!=null)throw Error(i(60));s.innerHTML=h}}break;case"children":typeof x=="string"?Ua(s,x):(typeof x=="number"||typeof x=="bigint")&&Ua(s,""+x);break;case"onScroll":x!=null&&tn("scroll",s);break;case"onScrollEnd":x!=null&&tn("scrollend",s);break;case"onClick":x!=null&&(s.onclick=Xf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wd.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(N=h.endsWith("Capture"),c=h.slice(2,N?h.length-7:void 0),E=s[Li]||null,E=E!=null?E[h]:null,typeof E=="function"&&s.removeEventListener(c,E,N),typeof x=="function")){typeof E!="function"&&E!==null&&(h in s?s[h]=null:s.hasAttribute(h)&&s.removeAttribute(h)),s.addEventListener(c,x,N);break e}h in s?s[h]=x:x===!0?s.setAttribute(h,""):Hl(s,h,x)}}}function Ci(s,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":tn("error",s),tn("load",s);var x=!1,N=!1,E;for(E in h)if(h.hasOwnProperty(E)){var q=h[E];if(q!=null)switch(E){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:In(s,c,E,q,h,null)}}N&&In(s,c,"srcSet",h.srcSet,h,null),x&&In(s,c,"src",h.src,h,null);return;case"input":tn("invalid",s);var Z=E=q=N=null,ge=null,Re=null;for(x in h)if(h.hasOwnProperty(x)){var Ge=h[x];if(Ge!=null)switch(x){case"name":N=Ge;break;case"type":q=Ge;break;case"checked":ge=Ge;break;case"defaultChecked":Re=Ge;break;case"value":E=Ge;break;case"defaultValue":Z=Ge;break;case"children":case"dangerouslySetInnerHTML":if(Ge!=null)throw Error(i(137,c));break;default:In(s,c,x,Ge,h,null)}}al(s,E,Z,ge,Re,q,N,!1),Xi(s);return;case"select":tn("invalid",s),x=q=E=null;for(N in h)if(h.hasOwnProperty(N)&&(Z=h[N],Z!=null))switch(N){case"value":E=Z;break;case"defaultValue":q=Z;break;case"multiple":x=Z;default:In(s,c,N,Z,h,null)}c=E,h=q,s.multiple=!!x,c!=null?bs(s,!!x,c,!1):h!=null&&bs(s,!!x,h,!0);return;case"textarea":tn("invalid",s),E=N=x=null;for(q in h)if(h.hasOwnProperty(q)&&(Z=h[q],Z!=null))switch(q){case"value":x=Z;break;case"defaultValue":N=Z;break;case"children":E=Z;break;case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(91));break;default:In(s,c,q,Z,h,null)}Wl(s,x,N,E),Xi(s);return;case"option":for(ge in h)if(h.hasOwnProperty(ge)&&(x=h[ge],x!=null))switch(ge){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:In(s,c,ge,x,h,null)}return;case"dialog":tn("beforetoggle",s),tn("toggle",s),tn("cancel",s),tn("close",s);break;case"iframe":case"object":tn("load",s);break;case"video":case"audio":for(x=0;x<bd.length;x++)tn(bd[x],s);break;case"image":tn("error",s),tn("load",s);break;case"details":tn("toggle",s);break;case"embed":case"source":case"link":tn("error",s),tn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Re in h)if(h.hasOwnProperty(Re)&&(x=h[Re],x!=null))switch(Re){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:In(s,c,Re,x,h,null)}return;default:if(lo(c)){for(Ge in h)h.hasOwnProperty(Ge)&&(x=h[Ge],x!==void 0&&am(s,c,Ge,x,h,void 0));return}}for(Z in h)h.hasOwnProperty(Z)&&(x=h[Z],x!=null&&In(s,c,Z,x,h,null))}function hv(s,c,h,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,E=null,q=null,Z=null,ge=null,Re=null,Ge=null;for(Oe in h){var Xe=h[Oe];if(h.hasOwnProperty(Oe)&&Xe!=null)switch(Oe){case"checked":break;case"value":break;case"defaultValue":ge=Xe;default:x.hasOwnProperty(Oe)||In(s,c,Oe,null,x,Xe)}}for(var Le in x){var Oe=x[Le];if(Xe=h[Le],x.hasOwnProperty(Le)&&(Oe!=null||Xe!=null))switch(Le){case"type":E=Oe;break;case"name":N=Oe;break;case"checked":Re=Oe;break;case"defaultChecked":Ge=Oe;break;case"value":q=Oe;break;case"defaultValue":Z=Oe;break;case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(i(137,c));break;default:Oe!==Xe&&In(s,c,Le,Oe,x,Xe)}}ao(s,q,Z,ge,Re,Ge,E,N);return;case"select":Oe=q=Z=Le=null;for(E in h)if(ge=h[E],h.hasOwnProperty(E)&&ge!=null)switch(E){case"value":break;case"multiple":Oe=ge;default:x.hasOwnProperty(E)||In(s,c,E,null,x,ge)}for(N in x)if(E=x[N],ge=h[N],x.hasOwnProperty(N)&&(E!=null||ge!=null))switch(N){case"value":Le=E;break;case"defaultValue":Z=E;break;case"multiple":q=E;default:E!==ge&&In(s,c,N,E,x,ge)}c=Z,h=q,x=Oe,Le!=null?bs(s,!!h,Le,!1):!!x!=!!h&&(c!=null?bs(s,!!h,c,!0):bs(s,!!h,h?[]:"",!1));return;case"textarea":Oe=Le=null;for(Z in h)if(N=h[Z],h.hasOwnProperty(Z)&&N!=null&&!x.hasOwnProperty(Z))switch(Z){case"value":break;case"children":break;default:In(s,c,Z,null,x,N)}for(q in x)if(N=x[q],E=h[q],x.hasOwnProperty(q)&&(N!=null||E!=null))switch(q){case"value":Le=N;break;case"defaultValue":Oe=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:N!==E&&In(s,c,q,N,x,E)}oo(s,Le,Oe);return;case"option":for(var At in h)if(Le=h[At],h.hasOwnProperty(At)&&Le!=null&&!x.hasOwnProperty(At))switch(At){case"selected":s.selected=!1;break;default:In(s,c,At,null,x,Le)}for(ge in x)if(Le=x[ge],Oe=h[ge],x.hasOwnProperty(ge)&&Le!==Oe&&(Le!=null||Oe!=null))switch(ge){case"selected":s.selected=Le&&typeof Le!="function"&&typeof Le!="symbol";break;default:In(s,c,ge,Le,x,Oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Et in h)Le=h[Et],h.hasOwnProperty(Et)&&Le!=null&&!x.hasOwnProperty(Et)&&In(s,c,Et,null,x,Le);for(Re in x)if(Le=x[Re],Oe=h[Re],x.hasOwnProperty(Re)&&Le!==Oe&&(Le!=null||Oe!=null))switch(Re){case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(i(137,c));break;default:In(s,c,Re,Le,x,Oe)}return;default:if(lo(c)){for(var Rn in h)Le=h[Rn],h.hasOwnProperty(Rn)&&Le!==void 0&&!x.hasOwnProperty(Rn)&&am(s,c,Rn,void 0,x,Le);for(Ge in x)Le=x[Ge],Oe=h[Ge],!x.hasOwnProperty(Ge)||Le===Oe||Le===void 0&&Oe===void 0||am(s,c,Ge,Le,x,Oe);return}}for(var Ee in h)Le=h[Ee],h.hasOwnProperty(Ee)&&Le!=null&&!x.hasOwnProperty(Ee)&&In(s,c,Ee,null,x,Le);for(Xe in x)Le=x[Xe],Oe=h[Xe],!x.hasOwnProperty(Xe)||Le===Oe||Le==null&&Oe==null||In(s,c,Xe,Le,x,Oe)}var Aa=null,Zf=null;function Il(s){return s.nodeType===9?s:s.ownerDocument}function Zn(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ai(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function eh(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var sm=null;function pv(){var s=window.event;return s&&s.type==="popstate"?s===sm?!1:(sm=s,!0):(sm=null,!1)}var $y=typeof setTimeout=="function"?setTimeout:void 0,mv=typeof clearTimeout=="function"?clearTimeout:void 0,zy=typeof Promise=="function"?Promise:void 0,gv=typeof queueMicrotask=="function"?queueMicrotask:typeof zy<"u"?function(s){return zy.resolve(null).then(s).catch(Uy)}:$y;function Uy(s){setTimeout(function(){throw s})}function sa(s){return s==="head"}function th(s,c){var h=c,x=0,N=0;do{var E=h.nextSibling;if(s.removeChild(h),E&&E.nodeType===8)if(h=E.data,h==="/$"){if(0<x&&8>x){h=x;var q=s.ownerDocument;if(h&1&&vd(q.documentElement),h&2&&vd(q.body),h&4)for(h=q.head,vd(h),q=h.firstChild;q;){var Z=q.nextSibling,ge=q.nodeName;q[tl]||ge==="SCRIPT"||ge==="STYLE"||ge==="LINK"&&q.rel.toLowerCase()==="stylesheet"||h.removeChild(q),q=Z}}if(N===0){s.removeChild(E),Td(c);return}N--}else h==="$"||h==="$?"||h==="$!"?N++:x=h.charCodeAt(0)-48;else x=0;h=E}while(h);Td(c)}function om(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":om(h),nl(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}s.removeChild(h)}}function By(s,c,h,x){for(;s.nodeType===1;){var N=h;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[tl])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==N.rel||s.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||s.getAttribute("title")!==(N.title==null?null:N.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(N.src==null?null:N.src)||s.getAttribute("type")!==(N.type==null?null:N.type)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var E=N.name==null?null:""+N.name;if(N.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=Pa(s.nextSibling),s===null)break}return null}function nh(s,c,h){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!h||(s=Pa(s.nextSibling),s===null))return null;return s}function sr(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Lc(s,c){var h=s.ownerDocument;if(s.data!=="$?"||h.readyState==="complete")c();else{var x=function(){c(),h.removeEventListener("DOMContentLoaded",x)};h.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Pa(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var lm=null;function qy(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return s;c--}else h==="/$"&&c++}s=s.previousSibling}return null}function Vy(s,c,h){switch(c=Il(h),s){case"html":if(s=c.documentElement,!s)throw Error(i(452));return s;case"head":if(s=c.head,!s)throw Error(i(453));return s;case"body":if(s=c.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function vd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);nl(s)}var Hr=new Map,as=new Set;function Bt(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ss=Q.d;Q.d={f:oa,r:Hy,D:yv,C:Gy,L:ih,m:xv,X:vv,S:bv,M:wv};function oa(){var s=ss.f(),c=Vf();return s||c}function Hy(s){var c=ya(s);c!==null&&c.tag===5&&c.type==="form"?kf(c):ss.r(s)}var Fc=typeof document>"u"?null:document;function Cn(s,c,h){var x=Fc;if(x&&typeof c=="string"&&c){var N=Zi(c);N='link[rel="'+s+'"][href="'+N+'"]',typeof h=="string"&&(N+='[crossorigin="'+h+'"]'),as.has(N)||(as.add(N),s={rel:s,crossOrigin:h,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),Ci(c,"link",s),hi(c),x.head.appendChild(c)))}}function yv(s){ss.D(s),Cn("dns-prefetch",s,null)}function Gy(s,c){ss.C(s,c),Cn("preconnect",s,c)}function ih(s,c,h){ss.L(s,c,h);var x=Fc;if(x&&s&&c){var N='link[rel="preload"][as="'+Zi(c)+'"]';c==="image"&&h&&h.imageSrcSet?(N+='[imagesrcset="'+Zi(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(N+='[imagesizes="'+Zi(h.imageSizes)+'"]')):N+='[href="'+Zi(s)+'"]';var E=N;switch(c){case"style":E=$c(s);break;case"script":E=zc(s)}Hr.has(E)||(s=p({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:s,as:c},h),Hr.set(E,s),x.querySelector(N)!==null||c==="style"&&x.querySelector(wd(E))||c==="script"&&x.querySelector(Sd(E))||(c=x.createElement("link"),Ci(c,"link",s),hi(c),x.head.appendChild(c)))}}function xv(s,c){ss.m(s,c);var h=Fc;if(h&&s){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+Zi(x)+'"][href="'+Zi(s)+'"]',E=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=zc(s)}if(!Hr.has(E)&&(s=p({rel:"modulepreload",href:s},c),Hr.set(E,s),h.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Sd(E)))return}x=h.createElement("link"),Ci(x,"link",s),hi(x),h.head.appendChild(x)}}}function bv(s,c,h){ss.S(s,c,h);var x=Fc;if(x&&s){var N=ys(x).hoistableStyles,E=$c(s);c=c||"default";var q=N.get(E);if(!q){var Z={loading:0,preload:null};if(q=x.querySelector(wd(E)))Z.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":c},h),(h=Hr.get(E))&&Nd(s,h);var ge=q=x.createElement("link");hi(ge),Ci(ge,"link",s),ge._p=new Promise(function(Re,Ge){ge.onload=Re,ge.onerror=Ge}),ge.addEventListener("load",function(){Z.loading|=1}),ge.addEventListener("error",function(){Z.loading|=2}),Z.loading|=4,rh(q,c,x)}q={type:"stylesheet",instance:q,count:1,state:Z},N.set(E,q)}}}function vv(s,c){ss.X(s,c);var h=Fc;if(h&&s){var x=ys(h).hoistableScripts,N=zc(s),E=x.get(N);E||(E=h.querySelector(Sd(N)),E||(s=p({src:s,async:!0},c),(c=Hr.get(N))&&cm(s,c),E=h.createElement("script"),hi(E),Ci(E,"link",s),h.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},x.set(N,E))}}function wv(s,c){ss.M(s,c);var h=Fc;if(h&&s){var x=ys(h).hoistableScripts,N=zc(s),E=x.get(N);E||(E=h.querySelector(Sd(N)),E||(s=p({src:s,async:!0,type:"module"},c),(c=Hr.get(N))&&cm(s,c),E=h.createElement("script"),hi(E),Ci(E,"link",s),h.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},x.set(N,E))}}function Yy(s,c,h,x){var N=(N=ee.current)?Bt(N):null;if(!N)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=$c(h.href),h=ys(N).hoistableStyles,x=h.get(c),x||(x={type:"style",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){s=$c(h.href);var E=ys(N).hoistableStyles,q=E.get(s);if(q||(N=N.ownerDocument||N,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,q),(E=N.querySelector(wd(s)))&&!E._p&&(q.instance=E,q.state.loading=5),Hr.has(s)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Hr.set(s,h),E||Sv(N,s,h,q.state))),c&&x===null)throw Error(i(528,""));return q}if(c&&x!==null)throw Error(i(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=zc(h),h=ys(N).hoistableScripts,x=h.get(c),x||(x={type:"script",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function $c(s){return'href="'+Zi(s)+'"'}function wd(s){return'link[rel="stylesheet"]['+s+"]"}function Wy(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function Sv(s,c,h,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),Ci(c,"link",h),hi(c),s.head.appendChild(c))}function zc(s){return'[src="'+Zi(s)+'"]'}function Sd(s){return"script[async]"+s}function Qy(s,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+Zi(h.href)+'"]');if(x)return c.instance=x,hi(x),x;var N=p({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),hi(x),Ci(x,"style",N),rh(x,h.precedence,s),c.instance=x;case"stylesheet":N=$c(h.href);var E=s.querySelector(wd(N));if(E)return c.state.loading|=4,c.instance=E,hi(E),E;x=Wy(h),(N=Hr.get(N))&&Nd(x,N),E=(s.ownerDocument||s).createElement("link"),hi(E);var q=E;return q._p=new Promise(function(Z,ge){q.onload=Z,q.onerror=ge}),Ci(E,"link",x),c.state.loading|=4,rh(E,h.precedence,s),c.instance=E;case"script":return E=zc(h.src),(N=s.querySelector(Sd(E)))?(c.instance=N,hi(N),N):(x=h,(N=Hr.get(E))&&(x=p({},h),cm(x,N)),s=s.ownerDocument||s,N=s.createElement("script"),hi(N),Ci(N,"link",x),s.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(i(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,rh(x,h.precedence,s));return c.instance}function rh(s,c,h){for(var x=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,E=N,q=0;q<x.length;q++){var Z=x[q];if(Z.dataset.precedence===c)E=Z;else if(E!==N)break}E?E.parentNode.insertBefore(s,E.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(s,c.firstChild))}function Nd(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function cm(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var Uc=null;function Jy(s,c,h){if(Uc===null){var x=new Map,N=Uc=new Map;N.set(h,x)}else N=Uc,x=N.get(h),x||(x=new Map,N.set(h,x));if(x.has(s))return x;for(x.set(s,null),h=h.getElementsByTagName(s),N=0;N<h.length;N++){var E=h[N];if(!(E[tl]||E[Ln]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var q=E.getAttribute(c)||"";q=s+q;var Z=x.get(q);Z?Z.push(E):x.set(q,[E])}}return x}function Ky(s,c,h){s=s.ownerDocument||s,s.head.insertBefore(h,c==="title"?s.querySelector("head > title"):null)}function Nv(s,c,h){if(h===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function ji(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Di=null;function Cv(){}function jv(s,c,h){if(Di===null)throw Error(i(475));var x=Di;if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=$c(h.href),E=s.querySelector(wd(N));if(E){s=E._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Cd.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=E,hi(E);return}E=s.ownerDocument||s,h=Wy(h),(N=Hr.get(N))&&Nd(h,N),E=E.createElement("link"),hi(E);var q=E;q._p=new Promise(function(Z,ge){q.onload=Z,q.onerror=ge}),Ci(E,"link",h),c.instance=E}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=Cd.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function _v(){if(Di===null)throw Error(i(475));var s=Di;return s.stylesheets&&s.count===0&&um(s,s.stylesheets),0<s.count?function(c){var h=setTimeout(function(){if(s.stylesheets&&um(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h)}}:null}function Cd(){if(this.count--,this.count===0){if(this.stylesheets)um(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var ah=null;function um(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,ah=new Map,c.forEach(kv,s),ah=null,Cd.call(s))}function kv(s,c){if(!(c.state.loading&4)){var h=ah.get(s);if(h)var x=h.get(null);else{h=new Map,ah.set(s,h);for(var N=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<N.length;E++){var q=N[E];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(h.set(q.dataset.precedence,q),x=q)}x&&h.set(null,x)}N=c.instance,q=N.getAttribute("data-precedence"),E=h.get(q)||x,E===x&&h.set(null,N),h.set(q,N),this.count++,x=Cd.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),E?E.parentNode.insertBefore(N,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(N,s.firstChild)),c.state.loading|=4}}var Bc={$$typeof:I,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function Tv(s,c,h,x,N,E,q,Z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Tt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tt(0),this.hiddenUpdates=Tt(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=E,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function Xy(s,c,h,x,N,E,q,Z,ge,Re,Ge,Xe){return s=new Tv(s,c,h,q,Z,ge,Re,Xe),c=1,E===!0&&(c|=24),E=lt(3,null,null,c),s.current=E,E.stateNode=s,c=rp(),c.refCount++,s.pooledCache=c,c.refCount++,E.memoizedState={element:x,isDehydrated:h,cache:c},vl(E),s}function Zy(s){return s?(s=je,s):je}function dm(s,c,h,x,N,E){N=Zy(N),x.context===null?x.context=N:x.pendingContext=N,x=No(c),x.payload={element:h},E=E===void 0?null:E,E!==null&&(x.callback=E),h=Os(s,x,c),h!==null&&(Vr(h,s,c),Lu(h,s,c))}function fm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<c?h:c}}function hm(s,c){fm(s,c),(s=s.alternate)&&fm(s,c)}function ex(s){if(s.tag===13){var c=ae(s,67108864);c!==null&&Vr(c,s,67108864),hm(s,67108864)}}var sh=!0;function Ev(s,c,h,x){var N=H.T;H.T=null;var E=Q.p;try{Q.p=2,pm(s,c,h,x)}finally{Q.p=E,H.T=N}}function qc(s,c,h,x){var N=H.T;H.T=null;var E=Q.p;try{Q.p=8,pm(s,c,h,x)}finally{Q.p=E,H.T=N}}function pm(s,c,h,x){if(sh){var N=mm(x);if(N===null)Ys(s,c,x,oh,h),nx(s,x);else if(Pv(N,s,c,h,x))x.stopPropagation();else if(nx(s,x),c&4&&-1<Av.indexOf(s)){for(;N!==null;){var E=ya(N);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var q=Be(E.pendingLanes);if(q!==0){var Z=E;for(Z.pendingLanes|=2,Z.entangledLanes|=2;q;){var ge=1<<31-et(q);Z.entanglements[1]|=ge,q&=~ge}rs(E),(Tn&6)===0&&(Pc=ut()+500,gd(0))}}break;case 13:Z=ae(E,2),Z!==null&&Vr(Z,E,2),Vf(),hm(E,2)}if(E=mm(x),E===null&&Ys(s,c,x,oh,h),E===N)break;N=E}N!==null&&x.stopPropagation()}else Ys(s,c,x,null,h)}}function mm(s){return s=Xl(s),gm(s)}var oh=null;function gm(s){if(oh=null,s=no(s),s!==null){var c=o(s);if(c===null)s=null;else{var h=c.tag;if(h===13){if(s=l(c),s!==null)return s;s=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return oh=s,null}function tx(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(rt()){case Nt:return 2;case Ft:return 8;case ye:case Te:return 32;case Ye:return 268435456;default:return 32}default:return 32}}var lh=!1,Ws=null,$o=null,zo=null,jd=new Map,_d=new Map,Uo=[],Av="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function nx(s,c){switch(s){case"focusin":case"focusout":Ws=null;break;case"dragenter":case"dragleave":$o=null;break;case"mouseover":case"mouseout":zo=null;break;case"pointerover":case"pointerout":jd.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":_d.delete(c.pointerId)}}function kd(s,c,h,x,N,E){return s===null||s.nativeEvent!==E?(s={blockedOn:c,domEventName:h,eventSystemFlags:x,nativeEvent:E,targetContainers:[N]},c!==null&&(c=ya(c),c!==null&&ex(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),s)}function Pv(s,c,h,x,N){switch(c){case"focusin":return Ws=kd(Ws,s,c,h,x,N),!0;case"dragenter":return $o=kd($o,s,c,h,x,N),!0;case"mouseover":return zo=kd(zo,s,c,h,x,N),!0;case"pointerover":var E=N.pointerId;return jd.set(E,kd(jd.get(E)||null,s,c,h,x,N)),!0;case"gotpointercapture":return E=N.pointerId,_d.set(E,kd(_d.get(E)||null,s,c,h,x,N)),!0}return!1}function ix(s){var c=no(s.target);if(c!==null){var h=o(c);if(h!==null){if(c=h.tag,c===13){if(c=l(h),c!==null){s.blockedOn=c,ql(s.priority,function(){if(h.tag===13){var x=Ji();x=Ti(x);var N=ae(h,x);N!==null&&Vr(N,h,x),hm(h,x)}});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ch(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var h=mm(s.nativeEvent);if(h===null){h=s.nativeEvent;var x=new h.constructor(h.type,h);uo=x,h.target.dispatchEvent(x),uo=null}else return c=ya(h),c!==null&&ex(c),s.blockedOn=h,!1;c.shift()}return!0}function rx(s,c,h){ch(s)&&h.delete(c)}function Dv(){lh=!1,Ws!==null&&ch(Ws)&&(Ws=null),$o!==null&&ch($o)&&($o=null),zo!==null&&ch(zo)&&(zo=null),jd.forEach(rx),_d.forEach(rx)}function uh(s,c){s.blockedOn===c&&(s.blockedOn=null,lh||(lh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Dv)))}var dh=null;function ax(s){dh!==s&&(dh=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){dh===s&&(dh=null);for(var c=0;c<s.length;c+=3){var h=s[c],x=s[c+1],N=s[c+2];if(typeof x!="function"){if(gm(x||h)===null)continue;break}var E=ya(h);E!==null&&(s.splice(c,3),c-=3,Wu(E,{pending:!0,data:N,method:h.method,action:x},x,N))}}))}function Td(s){function c(ge){return uh(ge,s)}Ws!==null&&uh(Ws,s),$o!==null&&uh($o,s),zo!==null&&uh(zo,s),jd.forEach(c),_d.forEach(c);for(var h=0;h<Uo.length;h++){var x=Uo[h];x.blockedOn===s&&(x.blockedOn=null)}for(;0<Uo.length&&(h=Uo[0],h.blockedOn===null);)ix(h),h.blockedOn===null&&Uo.shift();if(h=(s.ownerDocument||s).$$reactFormReplay,h!=null)for(x=0;x<h.length;x+=3){var N=h[x],E=h[x+1],q=N[Li]||null;if(typeof E=="function")q||ax(h);else if(q){var Z=null;if(E&&E.hasAttribute("formAction")){if(N=E,q=E[Li]||null)Z=q.formAction;else if(gm(N)!==null)continue}else Z=q.action;typeof Z=="function"?h[x+1]=Z:(h.splice(x,3),x-=3),ax(h)}}}function ym(s){this._internalRoot=s}fh.prototype.render=ym.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(i(409));var h=c.current,x=Ji();dm(h,x,s,c,null,null)},fh.prototype.unmount=ym.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;dm(s.current,2,null,s,null,null),Vf(),c[Jr]=null}};function fh(s){this._internalRoot=s}fh.prototype.unstable_scheduleHydration=function(s){if(s){var c=ps();s={blockedOn:null,target:s,priority:c};for(var h=0;h<Uo.length&&c!==0&&c<Uo[h].priority;h++);Uo.splice(h,0,s),h===0&&ix(s)}};var sx=n.version;if(sx!=="19.1.0")throw Error(i(527,sx,"19.1.0"));Q.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=f(c),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var Iv={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hh.isDisabled&&hh.supportsFiber)try{X=hh.inject(Iv),de=hh}catch{}}return bm.createRoot=function(s,c){if(!a(s))throw Error(i(299));var h=!1,x="",N=Ap,E=Af,q=Hg,Z=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(E=c.onCaughtError),c.onRecoverableError!==void 0&&(q=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(Z=c.unstable_transitionCallbacks)),c=Xy(s,1,!1,null,null,h,x,N,E,q,Z,null),s[Jr]=c.current,rm(s),new ym(c)},bm.hydrateRoot=function(s,c,h){if(!a(s))throw Error(i(299));var x=!1,N="",E=Ap,q=Af,Z=Hg,ge=null,Re=null;return h!=null&&(h.unstable_strictMode===!0&&(x=!0),h.identifierPrefix!==void 0&&(N=h.identifierPrefix),h.onUncaughtError!==void 0&&(E=h.onUncaughtError),h.onCaughtError!==void 0&&(q=h.onCaughtError),h.onRecoverableError!==void 0&&(Z=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(ge=h.unstable_transitionCallbacks),h.formState!==void 0&&(Re=h.formState)),c=Xy(s,1,!0,c,h??null,x,N,E,q,Z,ge,Re),c.context=Zy(null),h=c.current,x=Ji(),x=Ti(x),N=No(x),N.callback=null,Os(h,N,x),h=x,c.current.lanes=h,Rt(c,h),rs(c),s[Jr]=c.current,rm(s),new fh(c)},bm.version="19.1.0",bm}var mS;function aP(){if(mS)return $v.exports;mS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),$v.exports=rP(),$v.exports}var sP=aP();function oP(e={}){const{nonce:n,locale:t,onScriptLoadSuccess:i,onScriptLoadError:a}=e,[o,l]=w.useState(!1),d=w.useRef(i);d.current=i;const f=w.useRef(a);return f.current=a,w.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",t&&(u.src+=`?hl=${t}`),u.async=!0,u.defer=!0,u.nonce=n,u.onload=()=>{var p;l(!0),(p=d.current)===null||p===void 0||p.call(d)},u.onerror=()=>{var p;l(!1),(p=f.current)===null||p===void 0||p.call(f)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[n]),o}const M_=w.createContext(null);function lP({clientId:e,nonce:n,locale:t,onScriptLoadSuccess:i,onScriptLoadError:a,children:o}){const l=oP({nonce:n,onScriptLoadSuccess:i,onScriptLoadError:a,locale:t}),d=w.useMemo(()=>({locale:t,clientId:e,scriptLoadedSuccessfully:l}),[e,l]);return wn.createElement(M_.Provider,{value:d},o)}function cP(){const e=w.useContext(M_);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function uP(e){var n;return(n=e==null?void 0:e.clientId)!==null&&n!==void 0?n:e==null?void 0:e.client_id}const dP={large:40,medium:32,small:20};function fP({onSuccess:e,onError:n,useOneTap:t,promptMomentNotification:i,type:a="standard",theme:o="outline",size:l="large",text:d,shape:f,logo_alignment:u,width:p,click_listener:g,state:b,containerProps:v,...S}){const k=w.useRef(null),{clientId:T,locale:P,scriptLoadedSuccessfully:M}=cP(),I=w.useRef(e);I.current=e;const U=w.useRef(n);U.current=n;const L=w.useRef(i);return L.current=i,w.useEffect(()=>{var F,z,$,B,R,V,Y,ie,te;if(M)return($=(z=(F=window==null?void 0:window.google)===null||F===void 0?void 0:F.accounts)===null||z===void 0?void 0:z.id)===null||$===void 0||$.initialize({client_id:T,callback:W=>{var H;if(!(W!=null&&W.credential))return(H=U.current)===null||H===void 0?void 0:H.call(U);const{credential:Q,select_by:J}=W;I.current({credential:Q,clientId:uP(W),select_by:J})},...S}),(V=(R=(B=window==null?void 0:window.google)===null||B===void 0?void 0:B.accounts)===null||R===void 0?void 0:R.id)===null||V===void 0||V.renderButton(k.current,{type:a,theme:o,size:l,text:d,shape:f,logo_alignment:u,width:p,locale:P,click_listener:g,state:b}),t&&((te=(ie=(Y=window==null?void 0:window.google)===null||Y===void 0?void 0:Y.accounts)===null||ie===void 0?void 0:ie.id)===null||te===void 0||te.prompt(L.current)),()=>{var W,H,Q;t&&((Q=(H=(W=window==null?void 0:window.google)===null||W===void 0?void 0:W.accounts)===null||H===void 0?void 0:H.id)===null||Q===void 0||Q.cancel())}},[T,M,t,a,o,l,d,f,u,p,P]),wn.createElement("div",{...v,ref:k,style:{height:dP[l],...v==null?void 0:v.style}})}var vm={},gS;function hP(){if(gS)return vm;gS=1,Object.defineProperty(vm,"__esModule",{value:!0}),vm.parse=l,vm.serialize=u;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new o,k=b.length;if(k<2)return S;const T=(v==null?void 0:v.decode)||p;let P=0;do{const M=b.indexOf("=",P);if(M===-1)break;const I=b.indexOf(";",P),U=I===-1?k:I;if(M>U){P=b.lastIndexOf(";",M-1)+1;continue}const L=d(b,P,M),F=f(b,M,L),z=b.slice(L,F);if(S[z]===void 0){let $=d(b,M+1,U),B=f(b,U,$);const R=T(b.slice($,B));S[z]=R}P=U+1}while(P<k);return S}function d(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function f(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function u(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let P=b+"="+T;if(!S)return P;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);P+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);P+="; Domain="+S.domain}if(S.path){if(!i.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);P+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);P+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(P+="; HttpOnly"),S.secure&&(P+="; Secure"),S.partitioned&&(P+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":P+="; Priority=Low";break;case"medium":P+="; Priority=Medium";break;case"high":P+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":P+="; SameSite=Strict";break;case"lax":P+="; SameSite=Lax";break;case"none":P+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return P}function p(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return vm}hP();var yS="popstate";function pP(e={}){function n(i,a){let{pathname:o,search:l,hash:d}=i.location;return Y0("",{pathname:o,search:l,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){return typeof a=="string"?a:Hm(a)}return gP(n,t,null,e)}function di(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Ks(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function mP(){return Math.random().toString(36).substring(2,10)}function xS(e,n){return{usr:e.state,key:e.key,idx:n}}function Y0(e,n,t=null,i){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?$h(n):n,state:t,key:n&&n.key||i||mP()}}function Hm({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function $h(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let i=e.indexOf("?");i>=0&&(n.search=e.substring(i),e=e.substring(0,i)),e&&(n.pathname=e)}return n}function gP(e,n,t,i={}){let{window:a=document.defaultView,v5Compat:o=!1}=i,l=a.history,d="POP",f=null,u=p();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function p(){return(l.state||{idx:null}).idx}function g(){d="POP";let T=p(),P=T==null?null:T-u;u=T,f&&f({action:d,location:k.location,delta:P})}function b(T,P){d="PUSH";let M=Y0(k.location,T,P);u=p()+1;let I=xS(M,u),U=k.createHref(M);try{l.pushState(I,"",U)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(U)}o&&f&&f({action:d,location:k.location,delta:1})}function v(T,P){d="REPLACE";let M=Y0(k.location,T,P);u=p();let I=xS(M,u),U=k.createHref(M);l.replaceState(I,"",U),o&&f&&f({action:d,location:k.location,delta:0})}function S(T){return yP(T)}let k={get action(){return d},get location(){return e(a,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(yS,g),f=T,()=>{a.removeEventListener(yS,g),f=null}},createHref(T){return n(a,T)},createURL:S,encodeLocation(T){let P=S(T);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:b,replace:v,go(T){return l.go(T)}};return k}function yP(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),di(t,"No window.location.(origin|href) available to create URL");let i=typeof e=="string"?e:Hm(e);return i=i.replace(/ $/,"%20"),!n&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function O_(e,n,t="/"){return xP(e,n,t,!1)}function xP(e,n,t,i){let a=typeof n=="string"?$h(n):n,o=$l(a.pathname||"/",t);if(o==null)return null;let l=L_(e);bP(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let u=AP(o);d=TP(l[f],u,i)}return d}function L_(e,n=[],t=[],i=""){let a=(o,l,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(di(f.relativePath.startsWith(i),`Absolute route path "${f.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(i.length));let u=Ll([i,f.relativePath]),p=t.concat(f);o.children&&o.children.length>0&&(di(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),L_(o.children,n,p,u)),!(o.path==null&&!o.index)&&n.push({path:u,score:_P(u,o.index),routesMeta:p})};return e.forEach((o,l)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))a(o,l);else for(let f of F_(o.path))a(o,l,f)}),n}function F_(e){let n=e.split("/");if(n.length===0)return[];let[t,...i]=n,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(i.length===0)return a?[o,""]:[o];let l=F_(i.join("/")),d=[];return d.push(...l.map(f=>f===""?o:[o,f].join("/"))),a&&d.push(...l),d.map(f=>e.startsWith("/")&&f===""?"/":f)}function bP(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:kP(n.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var vP=/^:[\w-]+$/,wP=3,SP=2,NP=1,CP=10,jP=-2,bS=e=>e==="*";function _P(e,n){let t=e.split("/"),i=t.length;return t.some(bS)&&(i+=jP),n&&(i+=SP),t.filter(a=>!bS(a)).reduce((a,o)=>a+(vP.test(o)?wP:o===""?NP:CP),i)}function kP(e,n){return e.length===n.length&&e.slice(0,-1).every((i,a)=>i===n[a])?e[e.length-1]-n[n.length-1]:0}function TP(e,n,t=!1){let{routesMeta:i}=e,a={},o="/",l=[];for(let d=0;d<i.length;++d){let f=i[d],u=d===i.length-1,p=o==="/"?n:n.slice(o.length)||"/",g=Gx({path:f.relativePath,caseSensitive:f.caseSensitive,end:u},p),b=f.route;if(!g&&u&&t&&!i[i.length-1].route.index&&(g=Gx({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:Ll([o,g.pathname]),pathnameBase:RP(Ll([o,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(o=Ll([o,g.pathnameBase]))}return l}function Gx(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,i]=EP(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:i.reduce((u,{paramName:p,isOptional:g},b)=>{if(p==="*"){let S=d[b]||"";l=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const v=d[b];return g&&!v?u[p]=void 0:u[p]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:l,pattern:e}}function EP(e,n=!1,t=!0){Ks(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(i.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),i]}function AP(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Ks(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function $l(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,i=e.charAt(t);return i&&i!=="/"?null:e.slice(t)||"/"}function PP(e,n="/"){let{pathname:t,search:i="",hash:a=""}=typeof e=="string"?$h(e):e;return{pathname:t?t.startsWith("/")?t:DP(t,n):n,search:MP(i),hash:OP(a)}}function DP(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function qv(e,n,t,i){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function IP(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function K1(e){let n=IP(e);return n.map((t,i)=>i===n.length-1?t.pathname:t.pathnameBase)}function X1(e,n,t,i=!1){let a;typeof e=="string"?a=$h(e):(a={...e},di(!a.pathname||!a.pathname.includes("?"),qv("?","pathname","search",a)),di(!a.pathname||!a.pathname.includes("#"),qv("#","pathname","hash",a)),di(!a.search||!a.search.includes("#"),qv("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,d;if(l==null)d=t;else{let g=n.length-1;if(!i&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}d=g>=0?n[g]:"/"}let f=PP(a,d),u=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(u||p)&&(f.pathname+="/"),f}var Ll=e=>e.join("/").replace(/\/\/+/g,"/"),RP=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),MP=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,OP=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function LP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var $_=["POST","PUT","PATCH","DELETE"];new Set($_);var FP=["GET",...$_];new Set(FP);var zh=w.createContext(null);zh.displayName="DataRouter";var xb=w.createContext(null);xb.displayName="DataRouterState";var z_=w.createContext({isTransitioning:!1});z_.displayName="ViewTransition";var $P=w.createContext(new Map);$P.displayName="Fetchers";var zP=w.createContext(null);zP.displayName="Await";var Zs=w.createContext(null);Zs.displayName="Navigation";var tg=w.createContext(null);tg.displayName="Location";var eo=w.createContext({outlet:null,matches:[],isDataRoute:!1});eo.displayName="Route";var Z1=w.createContext(null);Z1.displayName="RouteError";function UP(e,{relative:n}={}){di(Uh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Zs),{hash:a,pathname:o,search:l}=ng(e,{relative:n}),d=o;return t!=="/"&&(d=o==="/"?t:Ll([t,o])),i.createHref({pathname:d,search:l,hash:a})}function Uh(){return w.useContext(tg)!=null}function cr(){return di(Uh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(tg).location}var U_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function B_(e){w.useContext(Zs).static||w.useLayoutEffect(e)}function kt(){let{isDataRoute:e}=w.useContext(eo);return e?eD():BP()}function BP(){di(Uh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(zh),{basename:n,navigator:t}=w.useContext(Zs),{matches:i}=w.useContext(eo),{pathname:a}=cr(),o=JSON.stringify(K1(i)),l=w.useRef(!1);return B_(()=>{l.current=!0}),w.useCallback((f,u={})=>{if(Ks(l.current,U_),!l.current)return;if(typeof f=="number"){t.go(f);return}let p=X1(f,JSON.parse(o),a,u.relative==="path");e==null&&n!=="/"&&(p.pathname=p.pathname==="/"?n:Ll([n,p.pathname])),(u.replace?t.replace:t.push)(p,u.state,u)},[n,t,o,a,e])}w.createContext(null);function Qr(){let{matches:e}=w.useContext(eo),n=e[e.length-1];return n?n.params:{}}function ng(e,{relative:n}={}){let{matches:t}=w.useContext(eo),{pathname:i}=cr(),a=JSON.stringify(K1(t));return w.useMemo(()=>X1(e,JSON.parse(a),i,n==="path"),[e,a,i,n])}function qP(e,n){return q_(e,n)}function q_(e,n,t,i){var M;di(Uh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=w.useContext(Zs),{matches:l}=w.useContext(eo),d=l[l.length-1],f=d?d.params:{},u=d?d.pathname:"/",p=d?d.pathnameBase:"/",g=d&&d.route;{let I=g&&g.path||"";V_(u,!g||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let b=cr(),v;if(n){let I=typeof n=="string"?$h(n):n;di(p==="/"||((M=I.pathname)==null?void 0:M.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${I.pathname}" was given in the \`location\` prop.`),v=I}else v=b;let S=v.pathname||"/",k=S;if(p!=="/"){let I=p.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(I.length).join("/")}let T=!o&&t&&t.matches&&t.matches.length>0?t.matches:O_(e,{pathname:k});Ks(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Ks(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let P=WP(T&&T.map(I=>Object.assign({},I,{params:Object.assign({},f,I.params),pathname:Ll([p,a.encodeLocation?a.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?p:Ll([p,a.encodeLocation?a.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),l,t,i);return n&&P?w.createElement(tg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},P):P}function VP(){let e=ZP(),n=LP(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:o},"ErrorBoundary")," or"," ",w.createElement("code",{style:o},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var HP=w.createElement(VP,null),GP=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(eo.Provider,{value:this.props.routeContext},w.createElement(Z1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function YP({routeContext:e,match:n,children:t}){let i=w.useContext(zh);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(eo.Provider,{value:e},t)}function WP(e,n=[],t=null,i=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,o=t==null?void 0:t.errors;if(o!=null){let f=a.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);di(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,d=-1;if(t)for(let f=0;f<a.length;f++){let u=a[f];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=f),u.route.id){let{loaderData:p,errors:g}=t,b=u.route.loader&&!p.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||b){l=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,u,p)=>{let g,b=!1,v=null,S=null;t&&(g=o&&u.route.id?o[u.route.id]:void 0,v=u.route.errorElement||HP,l&&(d<0&&p===0?(V_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):d===p&&(b=!0,S=u.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,p+1)),T=()=>{let P;return g?P=v:b?P=S:u.route.Component?P=w.createElement(u.route.Component,null):u.route.element?P=u.route.element:P=f,w.createElement(YP,{match:u,routeContext:{outlet:f,matches:k,isDataRoute:t!=null},children:P})};return t&&(u.route.ErrorBoundary||u.route.errorElement||p===0)?w.createElement(GP,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function ew(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function QP(e){let n=w.useContext(zh);return di(n,ew(e)),n}function JP(e){let n=w.useContext(xb);return di(n,ew(e)),n}function KP(e){let n=w.useContext(eo);return di(n,ew(e)),n}function tw(e){let n=KP(e),t=n.matches[n.matches.length-1];return di(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function XP(){return tw("useRouteId")}function ZP(){var i;let e=w.useContext(Z1),n=JP("useRouteError"),t=tw("useRouteError");return e!==void 0?e:(i=n.errors)==null?void 0:i[t]}function eD(){let{router:e}=QP("useNavigate"),n=tw("useNavigate"),t=w.useRef(!1);return B_(()=>{t.current=!0}),w.useCallback(async(a,o={})=>{Ks(t.current,U_),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...o}))},[e,n])}var vS={};function V_(e,n,t){!n&&!vS[e]&&(vS[e]=!0,Ks(!1,t))}w.memo(tD);function tD({routes:e,future:n,state:t}){return q_(e,void 0,t,n)}function pn({to:e,replace:n,state:t,relative:i}){di(Uh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(Zs);Ks(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=w.useContext(eo),{pathname:l}=cr(),d=kt(),f=X1(e,K1(o),l,i==="path"),u=JSON.stringify(f);return w.useEffect(()=>{d(JSON.parse(u),{replace:n,state:t,relative:i})},[d,u,i,n,t]),null}function pt(e){di(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function nD({basename:e="/",children:n=null,location:t,navigationType:i="POP",navigator:a,static:o=!1}){di(!Uh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=$h(t));let{pathname:f="/",search:u="",hash:p="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=$l(f,l);return S==null?null:{location:{pathname:S,search:u,hash:p,state:g,key:b},navigationType:i}},[l,f,u,p,g,b,i]);return Ks(v!=null,`<Router basename="${l}"> is not able to match the URL "${f}${u}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(Zs.Provider,{value:d},w.createElement(tg.Provider,{children:n,value:v}))}function wh({children:e,location:n}){return qP(W0(e),n)}function W0(e,n=[]){let t=[];return w.Children.forEach(e,(i,a)=>{if(!w.isValidElement(i))return;let o=[...n,a];if(i.type===w.Fragment){t.push.apply(t,W0(i.props.children,o));return}di(i.type===pt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),di(!i.props.index||!i.props.children,"An index route cannot have child routes.");let l={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(l.children=W0(i.props.children,o)),t.push(l)}),t}var Dx="get",Ix="application/x-www-form-urlencoded";function bb(e){return e!=null&&typeof e.tagName=="string"}function iD(e){return bb(e)&&e.tagName.toLowerCase()==="button"}function rD(e){return bb(e)&&e.tagName.toLowerCase()==="form"}function aD(e){return bb(e)&&e.tagName.toLowerCase()==="input"}function sD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function oD(e,n){return e.button===0&&(!n||n==="_self")&&!sD(e)}var ox=null;function lD(){if(ox===null)try{new FormData(document.createElement("form"),0),ox=!1}catch{ox=!0}return ox}var cD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Vv(e){return e!=null&&!cD.has(e)?(Ks(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ix}"`),null):e}function uD(e,n){let t,i,a,o,l;if(rD(e)){let d=e.getAttribute("action");i=d?$l(d,n):null,t=e.getAttribute("method")||Dx,a=Vv(e.getAttribute("enctype"))||Ix,o=new FormData(e)}else if(iD(e)||aD(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||d.getAttribute("action");if(i=f?$l(f,n):null,t=e.getAttribute("formmethod")||d.getAttribute("method")||Dx,a=Vv(e.getAttribute("formenctype"))||Vv(d.getAttribute("enctype"))||Ix,o=new FormData(d,e),!lD()){let{name:u,type:p,value:g}=e;if(p==="image"){let b=u?`${u}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else u&&o.append(u,g)}}else{if(bb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Dx,i=null,a=Ix,l=e}return o&&a==="text/plain"&&(l=o,o=void 0),{action:i,method:t.toLowerCase(),encType:a,formData:o,body:l}}function nw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function dD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function fD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function hD(e,n,t){let i=await Promise.all(e.map(async a=>{let o=n.routes[a.route.id];if(o){let l=await dD(o,t);return l.links?l.links():[]}return[]}));return yD(i.flat(1).filter(fD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function wS(e,n,t,i,a,o){let l=(f,u)=>t[u]?f.route.id!==t[u].route.id:!0,d=(f,u)=>{var p;return t[u].pathname!==f.pathname||((p=t[u].route.path)==null?void 0:p.endsWith("*"))&&t[u].params["*"]!==f.params["*"]};return o==="assets"?n.filter((f,u)=>l(f,u)||d(f,u)):o==="data"?n.filter((f,u)=>{var g;let p=i.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,u)||d(f,u))return!0;if(f.route.shouldRevalidate){let b=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function pD(e,n,{includeHydrateFallback:t}={}){return mD(e.map(i=>{let a=n.routes[i.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function mD(e){return[...new Set(e)]}function gD(e){let n={},t=Object.keys(e).sort();for(let i of t)n[i]=e[i];return n}function yD(e,n){let t=new Set;return new Set(n),e.reduce((i,a)=>{let o=JSON.stringify(gD(a));return t.has(o)||(t.add(o),i.push({key:o,link:a})),i},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var xD=new Set([100,101,204,205]);function bD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&$l(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function H_(){let e=w.useContext(zh);return nw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function vD(){let e=w.useContext(xb);return nw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var iw=w.createContext(void 0);iw.displayName="FrameworkContext";function G_(){let e=w.useContext(iw);return nw(e,"You must render this element inside a <HydratedRouter> element"),e}function wD(e,n){let t=w.useContext(iw),[i,a]=w.useState(!1),[o,l]=w.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:u,onMouseLeave:p,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=P=>{P.forEach(M=>{l(M.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(i){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[i]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[o,b,{}]:[o,b,{onFocus:wm(d,v),onBlur:wm(f,S),onMouseEnter:wm(u,v),onMouseLeave:wm(p,S),onTouchStart:wm(g,v)}]:[!1,b,{}]}function wm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function SD({page:e,...n}){let{router:t}=H_(),i=w.useMemo(()=>O_(t.routes,e,t.basename),[t.routes,e,t.basename]);return i?w.createElement(CD,{page:e,matches:i,...n}):null}function ND(e){let{manifest:n,routeModules:t}=G_(),[i,a]=w.useState([]);return w.useEffect(()=>{let o=!1;return hD(e,n,t).then(l=>{o||a(l)}),()=>{o=!0}},[e,n,t]),i}function CD({page:e,matches:n,...t}){let i=cr(),{manifest:a,routeModules:o}=G_(),{basename:l}=H_(),{loaderData:d,matches:f}=vD(),u=w.useMemo(()=>wS(e,n,f,a,i,"data"),[e,n,f,a,i]),p=w.useMemo(()=>wS(e,n,f,a,i,"assets"),[e,n,f,a,i]),g=w.useMemo(()=>{if(e===i.pathname+i.search+i.hash)return[];let S=new Set,k=!1;if(n.forEach(P=>{var I;let M=a.routes[P.route.id];!M||!M.hasLoader||(!u.some(U=>U.route.id===P.route.id)&&P.route.id in d&&((I=o[P.route.id])!=null&&I.shouldRevalidate)||M.hasClientLoader?k=!0:S.add(P.route.id))}),S.size===0)return[];let T=bD(e,l);return k&&S.size>0&&T.searchParams.set("_routes",n.filter(P=>S.has(P.route.id)).map(P=>P.route.id).join(",")),[T.pathname+T.search]},[l,d,i,a,u,n,e,o]),b=w.useMemo(()=>pD(p,a),[p,a]),v=ND(p);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function jD(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var Y_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Y_&&(window.__reactRouterVersion="7.6.0")}catch{}function _D({basename:e,children:n,window:t}){let i=w.useRef();i.current==null&&(i.current=pP({window:t,v5Compat:!0}));let a=i.current,[o,l]=w.useState({action:a.action,location:a.location}),d=w.useCallback(f=>{w.startTransition(()=>l(f))},[l]);return w.useLayoutEffect(()=>a.listen(d),[a,d]),w.createElement(nD,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}var W_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ds=w.forwardRef(function({onClick:n,discover:t="render",prefetch:i="none",relative:a,reloadDocument:o,replace:l,state:d,target:f,to:u,preventScrollReset:p,viewTransition:g,...b},v){let{basename:S}=w.useContext(Zs),k=typeof u=="string"&&W_.test(u),T,P=!1;if(typeof u=="string"&&k&&(T=u,Y_))try{let B=new URL(window.location.href),R=u.startsWith("//")?new URL(B.protocol+u):new URL(u),V=$l(R.pathname,S);R.origin===B.origin&&V!=null?u=V+R.search+R.hash:P=!0}catch{Ks(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=UP(u,{relative:a}),[I,U,L]=wD(i,b),F=AD(u,{replace:l,state:d,target:f,preventScrollReset:p,relative:a,viewTransition:g});function z(B){n&&n(B),B.defaultPrevented||F(B)}let $=w.createElement("a",{...b,...L,href:T||M,onClick:P||o?n:z,ref:jD(v,U),target:f,"data-discover":!k&&t==="render"?"true":void 0});return I&&!k?w.createElement(w.Fragment,null,$,w.createElement(SD,{page:M})):$});ds.displayName="Link";var kD=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:i="",end:a=!1,style:o,to:l,viewTransition:d,children:f,...u},p){let g=ng(l,{relative:u.relative}),b=cr(),v=w.useContext(xb),{navigator:S,basename:k}=w.useContext(Zs),T=v!=null&&MD(g)&&d===!0,P=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,M=b.pathname,I=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(M=M.toLowerCase(),I=I?I.toLowerCase():null,P=P.toLowerCase()),I&&k&&(I=$l(I,k)||I);const U=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let L=M===P||!a&&M.startsWith(P)&&M.charAt(U)==="/",F=I!=null&&(I===P||!a&&I.startsWith(P)&&I.charAt(P.length)==="/"),z={isActive:L,isPending:F,isTransitioning:T},$=L?n:void 0,B;typeof i=="function"?B=i(z):B=[i,L?"active":null,F?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let R=typeof o=="function"?o(z):o;return w.createElement(ds,{...u,"aria-current":$,className:B,ref:p,style:R,to:l,viewTransition:d},typeof f=="function"?f(z):f)});kD.displayName="NavLink";var TD=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:i,replace:a,state:o,method:l=Dx,action:d,onSubmit:f,relative:u,preventScrollReset:p,viewTransition:g,...b},v)=>{let S=ID(),k=RD(d,{relative:u}),T=l.toLowerCase()==="get"?"get":"post",P=typeof d=="string"&&W_.test(d),M=I=>{if(f&&f(I),I.defaultPrevented)return;I.preventDefault();let U=I.nativeEvent.submitter,L=(U==null?void 0:U.getAttribute("formmethod"))||l;S(U||I.currentTarget,{fetcherKey:n,method:L,navigate:t,replace:a,state:o,relative:u,preventScrollReset:p,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:i?f:M,...b,"data-discover":!P&&e==="render"?"true":void 0})});TD.displayName="Form";function ED(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Q_(e){let n=w.useContext(zh);return di(n,ED(e)),n}function AD(e,{target:n,replace:t,state:i,preventScrollReset:a,relative:o,viewTransition:l}={}){let d=kt(),f=cr(),u=ng(e,{relative:o});return w.useCallback(p=>{if(oD(p,n)){p.preventDefault();let g=t!==void 0?t:Hm(f)===Hm(u);d(e,{replace:g,state:i,preventScrollReset:a,relative:o,viewTransition:l})}},[f,d,u,t,i,n,e,a,o,l])}var PD=0,DD=()=>`__${String(++PD)}__`;function ID(){let{router:e}=Q_("useSubmit"),{basename:n}=w.useContext(Zs),t=XP();return w.useCallback(async(i,a={})=>{let{action:o,method:l,encType:d,formData:f,body:u}=uD(i,n);if(a.navigate===!1){let p=a.fetcherKey||DD();await e.fetch(p,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function RD(e,{relative:n}={}){let{basename:t}=w.useContext(Zs),i=w.useContext(eo);di(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),o={...ng(e||".",{relative:n})},l=cr();if(e==null){o.search=l.search;let d=new URLSearchParams(o.search),f=d.getAll("index");if(f.some(p=>p==="")){d.delete("index"),f.filter(g=>g).forEach(g=>d.append("index",g));let p=d.toString();o.search=p?`?${p}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Ll([t,o.pathname])),Hm(o)}function MD(e,n={}){let t=w.useContext(z_);di(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Q_("useViewTransitionState"),a=ng(e,{relative:n.relative});if(!t.isTransitioning)return!1;let o=$l(t.currentLocation.pathname,i)||t.currentLocation.pathname,l=$l(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Gx(a.pathname,l)!=null||Gx(a.pathname,o)!=null}[...xD];var OD=R_();class LD extends w.Component{constructor(){super(...arguments);qn(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,i){console.error("Uncaught error:",t,i)}render(){return this.state.hasError?r.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[r.jsx("h1",{children:"Something went wrong."}),r.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}class FD{constructor(){qn(this,"listeners",[]);qn(this,"activeRequests",0)}subscribe(n){return this.listeners.push(n),n(this.activeRequests>0),()=>this.unsubscribe(n)}unsubscribe(n){this.listeners=this.listeners.filter(t=>t!==n)}notify(n){n?this.activeRequests++:this.activeRequests=Math.max(0,this.activeRequests-1);const t=this.activeRequests>0;this.listeners.forEach(i=>i(t))}}const Q0=new FD,$D="https://backend.newtons.in",zD=()=>localStorage.getItem("authToken"),pe=async(e,n={})=>{const t=zD(),i={...n.headers};t&&(i.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!i["Content-Type"]&&(i["Content-Type"]="application/json");const a=i;let o=e.startsWith("/")?e:`/${e}`;o.startsWith("/api/")||(o=`/api${o}`);const l=`${$D}${o}`;Q0.notify(!0);try{console.log(`Making API call to: ${l}`);const d=await fetch(l,{...n,headers:a});if(d.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!d.ok){let f=`HTTP error! status: ${d.status}`;try{const u=await d.json();f=(u==null?void 0:u.message)||(u==null?void 0:u.error)||f}catch{}throw console.error(`API Error: ${d.status} ${d.statusText} - ${f}`),new Error(f)}return d}catch(d){throw d instanceof TypeError&&d.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",d):console.error("API Fetch Error:",d),d}finally{Q0.notify(!1)}},UD=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[i,a]=w.useState(""),[o,l]=w.useState(null),[d,f]=w.useState(!1),u=kt(),p=async v=>{v.preventDefault(),f(!0),l(null);try{const S=await pe("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:i})});if(!S.ok){let T=`Login failed with status: ${S.status}`;try{T=(await S.json()).message||T}catch{try{const M=await S.text();M&&(T=`${T} - ${M}`)}catch{}}throw new Error(T)}const k=await S.json();console.log("Login successful:",k),localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Login failed:",S),l(S.message||"Login failed. Please check your credentials.")}finally{f(!1)}},g=async v=>{f(!0),l(null);try{const S=await pe("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v.credential})});if(!S.ok)throw new Error("Google Sign-In failed");const k=await S.json();localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Google Login Error:",S),l("Google Sign-In failed. Please try again.")}finally{f(!1)}},b=()=>{console.error("Google Login Failed"),l("Google Sign-In was unsuccessful. Please try again.")};return r.jsx("div",{className:"auth-page-container",children:r.jsxs("div",{className:"auth-form-card",children:[r.jsx("h2",{className:"auth-title",children:"Sign in to Newtons OPD Zero"}),r.jsxs("form",{onSubmit:p,className:"auth-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email address"}),r.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:v=>t(v.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:i,onChange:v=>a(v.target.value),className:"auth-text-input",placeholder:"Password"})]}),o&&r.jsx("div",{className:"auth-error-message",children:r.jsx("p",{children:o})}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"submit",disabled:d,className:"auth-submit-button",children:d?"Signing in...":"Sign In"})})]}),r.jsx("div",{className:"google-login-container",style:{marginTop:"1rem",display:"flex",justifyContent:"center",width:"100%"},children:r.jsx(fP,{onSuccess:g,onError:b,useOneTap:!0})}),r.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",r.jsx(ds,{to:"/register",className:"auth-navigation-link",children:"Register a new clinic"})]}),r.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},BD=()=>{const[e,n]=w.useState(""),[t,i]=w.useState(""),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState(null),[p,g]=w.useState(!1),b=kt(),v=async S=>{S.preventDefault(),g(!0),u(null);try{const k=await pe("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),u(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return r.jsx("div",{className:"auth-page-container",children:r.jsxs("div",{className:"auth-form-card",children:[r.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),r.jsxs("form",{onSubmit:v,className:"auth-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),r.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),r.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>i(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),r.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>o(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"userPassword",children:"Password"}),r.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>d(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),f&&r.jsx("div",{className:"auth-error-message",children:r.jsx("p",{children:f})}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"submit",disabled:p,className:"auth-submit-button",children:p?"Registering...":"Register Clinic & Admin"})})]}),r.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",r.jsx(ds,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),r.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var J_={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},SS=wn.createContext&&wn.createContext(J_),qD=["attr","size","title"];function VD(e,n){if(e==null)return{};var t=HD(e,n),i,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)i=o[a],!(n.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(t[i]=e[i])}return t}function HD(e,n){if(e==null)return{};var t={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(n.indexOf(i)>=0)continue;t[i]=e[i]}return t}function Yx(){return Yx=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Yx.apply(this,arguments)}function NS(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function Wx(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?NS(Object(t),!0).forEach(function(i){GD(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):NS(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function GD(e,n,t){return n=YD(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function YD(e){var n=WD(e,"string");return typeof n=="symbol"?n:n+""}function WD(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function K_(e){return e&&e.map((n,t)=>wn.createElement(n.tag,Wx({key:t},n.attr),K_(n.child)))}function hs(e){return n=>wn.createElement(QD,Yx({attr:Wx({},e.attr)},n),K_(e.child))}function QD(e){var n=t=>{var{attr:i,size:a,title:o}=e,l=VD(e,qD),d=a||t.size||"1em",f;return t.className&&(f=t.className),e.className&&(f=(f?f+" ":"")+e.className),wn.createElement("svg",Yx({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,l,{className:f,style:Wx(Wx({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),o&&wn.createElement("title",null,o),e.children)};return SS!==void 0?wn.createElement(SS.Consumer,null,t=>n(t)):n(J_)}function Hv(e){return hs({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function CS(e){return hs({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function jS(e){return hs({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function Sh(e){return hs({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function lx(e){return hs({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function cx(e){return hs({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function ux(e){return hs({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Nh(e){return hs({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function X_(e){return hs({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function _S(e){return hs({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function kS(e){return hs({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Sm(e){return hs({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const Z_={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:Sh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:lx},{path:"/dashboard/users",name:"User Management",icon:Sm}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:Sh}]},{title:"Clinic Management",links:[{path:"/dashboard/clinic-hub",name:"Clinic Hub",icon:CS}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:lx},{path:"/dashboard/patients",name:"All Patients",icon:Sm},{path:"/dashboard/patients/search",name:"Search Patient",icon:Nh}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:Hv},{path:"/dashboard/inventory",name:"Inventory Management",icon:ux},{path:"/dashboard/inventory/add",name:"Add Drug",icon:ux},{path:"/dashboard/distributors",name:"Distributor Management",icon:Sm}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:_S},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:cx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:cx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:Nh},{path:"/dashboard/add-patient",name:"Add Patient",icon:lx},{path:"/manage-admission",name:"Manage Admission",icon:kS}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:jS},{path:"/billing",name:"Billing",icon:cx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:_S}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:Sh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:Sm},{path:"/dashboard/patients/add",name:"Add Patient",icon:lx},{path:"/dashboard/patients/search",name:"Search Patient",icon:Nh}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:cx},{path:"/manage-admission",name:"Manage Admission",icon:kS}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:Sh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:jS},{path:"/lab/search-report",name:"Search Lab Report",icon:Nh}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:Sh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:ux},{path:"/dashboard/inventory/add",name:"Add Drug",icon:ux},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:Hv},{path:"/dashboard/distributors",name:"Distributor Management",icon:Sm}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:Hv},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:CS},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:Nh}]}]},JD=({user:e,onLogout:n,userRole:t,isOpen:i,onClose:a})=>{const o=cr(),[l,d]=w.useState(""),f=Z_[t]||[],[u,p]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(T=>{if(g.current){const P=window.innerWidth-T.clientX;P>250&&P<window.innerWidth*.8&&p(P)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=f.map(T=>({...T,links:T.links.filter(P=>P.name.toLowerCase().includes(l.toLowerCase()))})).filter(T=>T.links.length>0);return r.jsxs("div",{className:`side-panel ${i?"open":""}`,style:{width:`${u}px`,right:i?"0":`-${u}px`},children:[r.jsx("div",{className:"resizer",onMouseDown:b}),r.jsxs("div",{className:"side-panel-header",children:[r.jsx(ds,{to:"/dashboard",className:"home-button",onClick:a,children:r.jsx(Sh,{})}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx(Nh,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),r.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:T=>d(T.target.value)})]}),r.jsx("button",{className:"close-button",onClick:a,children:""})]}),r.jsx("nav",{children:k.map((T,P)=>r.jsxs("div",{className:"page-section",children:[r.jsx("div",{className:"page-title",children:T.title}),r.jsx("ul",{className:"sub-page-list",children:T.links.map(M=>{const I=M.icon;return r.jsx("li",{children:r.jsxs(ds,{to:M.path,className:o.pathname===M.path?"active":"",onClick:a,children:[I&&r.jsx(I,{})," ",M.name]})},M.path)})})]},P))}),r.jsxs("div",{className:"user-info-section",children:[r.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),r.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[r.jsx(X_,{})," Logout"]})]})]})},KD=({user:e,onLogout:n,userRole:t,isOpen:i,onClose:a,roleNavigation:o})=>{const l=cr(),d=o[t]||[];return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`mobile-side-panel-overlay ${i?"open":""}`,onClick:a}),r.jsxs("div",{className:`mobile-side-panel ${i?"open":""}`,children:[r.jsxs("div",{className:"mobile-side-panel-header",children:[r.jsx("h3",{children:"Menu"}),r.jsx("button",{className:"close-button",onClick:a,children:""})]}),r.jsx("nav",{children:d.map((f,u)=>r.jsxs("div",{className:"page-section",children:[r.jsx("div",{className:"page-title",children:f.title}),r.jsx("ul",{className:"sub-page-list",children:f.links.map(p=>{const g=p.icon;return r.jsx("li",{children:r.jsxs(ds,{to:p.path,className:l.pathname===p.path?"active":"",onClick:a,children:[g&&r.jsx(g,{})," ",p.name]})},p.path)})})]},u))}),r.jsxs("div",{className:"user-info-section",children:[r.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),r.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[r.jsx(X_,{})," Logout"]})]})]})]})};var Gv,TS;function XD(){if(TS)return Gv;TS=1;var e="Expected a function",n=NaN,t="[object Symbol]",i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,f=typeof Qc=="object"&&Qc&&Qc.Object===Object&&Qc,u=typeof self=="object"&&self&&self.Object===Object&&self,p=f||u||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return p.Date.now()};function T(L,F,z){var $,B,R,V,Y,ie,te=0,W=!1,H=!1,Q=!0;if(typeof L!="function")throw new TypeError(e);F=U(F)||0,P(z)&&(W=!!z.leading,H="maxWait"in z,R=H?v(U(z.maxWait)||0,F):R,Q="trailing"in z?!!z.trailing:Q);function J(ce){var re=$,Pe=B;return $=B=void 0,te=ce,V=L.apply(Pe,re),V}function fe(ce){return te=ce,Y=setTimeout(ue,F),W?J(ce):V}function A(ce){var re=ce-ie,Pe=ce-te,Qe=F-re;return H?S(Qe,R-Pe):Qe}function oe(ce){var re=ce-ie,Pe=ce-te;return ie===void 0||re>=F||re<0||H&&Pe>=R}function ue(){var ce=k();if(oe(ce))return D(ce);Y=setTimeout(ue,A(ce))}function D(ce){return Y=void 0,Q&&$?J(ce):($=B=void 0,V)}function se(){Y!==void 0&&clearTimeout(Y),te=0,$=ie=B=Y=void 0}function be(){return Y===void 0?V:D(k())}function ee(){var ce=k(),re=oe(ce);if($=arguments,B=this,ie=ce,re){if(Y===void 0)return fe(ie);if(H)return Y=setTimeout(ue,F),J(ie)}return Y===void 0&&(Y=setTimeout(ue,F)),V}return ee.cancel=se,ee.flush=be,ee}function P(L){var F=typeof L;return!!L&&(F=="object"||F=="function")}function M(L){return!!L&&typeof L=="object"}function I(L){return typeof L=="symbol"||M(L)&&b.call(L)==t}function U(L){if(typeof L=="number")return L;if(I(L))return n;if(P(L)){var F=typeof L.valueOf=="function"?L.valueOf():L;L=P(F)?F+"":F}if(typeof L!="string")return L===0?L:+L;L=L.replace(i,"");var z=o.test(L);return z||l.test(L)?d(L.slice(2),z?2:8):a.test(L)?n:+L}return Gv=T,Gv}var ZD=XD();const vb=qd(ZD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),tI=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,i)=>i?i.toUpperCase():t.toLowerCase()),ES=e=>{const n=tI(e);return n.charAt(0).toUpperCase()+n.slice(1)},ek=(...e)=>e.filter((n,t,i)=>!!n&&n.trim()!==""&&i.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:a="",children:o,iconNode:l,...d},f)=>w.createElement("svg",{ref:f,...nI,width:n,height:n,stroke:e,strokeWidth:i?Number(t)*24/Number(n):t,className:ek("lucide",a),...d},[...l.map(([u,p])=>w.createElement(u,p)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=(e,n)=>{const t=w.forwardRef(({className:i,...a},o)=>w.createElement(iI,{ref:o,iconNode:n,className:ek(`lucide-${eI(ES(e))}`,`lucide-${e}`,i),...a}));return t.displayName=ES(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],AS=mt("arrow-down",rI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],nn=mt("arrow-left",aI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],J0=mt("arrow-up",sI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],lI=mt("beaker",oI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],uI=mt("bed-double",cI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],tk=mt("brain",dI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],hI=mt("building",fI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],PS=mt("calendar-check-2",pI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],gI=mt("calendar-days",mI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Qx=mt("calendar",yI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],DS=mt("check",xI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],IS=mt("chevron-down",bI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],rw=mt("chevron-left",vI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],wb=mt("chevron-right",wI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],RS=mt("chevron-up",SI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ki=mt("circle-alert",NI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],fs=mt("circle-check-big",CI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],_I=mt("circle-minus",jI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],cs=mt("circle-plus",kI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],EI=mt("circle-user",TI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],MS=mt("clipboard-list",AI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],K0=mt("clipboard",PI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],II=mt("copy",DI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],MI=mt("credit-card",RI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Dh=mt("dollar-sign",OI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],FI=mt("eye",LI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $I=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],OS=mt("file-check",$I);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Xc=mt("file-text",zI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Od=mt("flask-conical",UI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],qI=mt("funnel",BI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VI=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Gm=mt("hash",VI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],nk=mt("house",HI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Jo=mt("info",GI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],ik=mt("key",YI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],rk=mt("layout-grid",WI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],JI=mt("list-ordered",QI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],XI=mt("list",KI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ih=mt("loader-circle",ZI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],LS=mt("lock",eR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],nR=mt("map-pin",tR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],rR=mt("mic-off",iR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],ak=mt("mic",aR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],oR=mt("monitor",sR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],cR=mt("package-open",lR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ld=mt("package",uR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],fR=mt("paperclip",dR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hR=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],pR=mt("pause",hR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Yv=mt("pen",mR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Ml=mt("pencil",gR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],xR=mt("phone",yR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],ig=mt("pill",bR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],wR=mt("play",vR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Zc=mt("plus",SR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Kc=mt("printer",NR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Jx=mt("refresh-cw",CR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Fd=mt("save",jR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],us=mt("search",_R);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],TR=mt("send",kR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],FS=mt("server-crash",ER);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Sb=mt("settings",AR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],sk=mt("share-2",PR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],IR=mt("shield-check",DR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],eu=mt("square-pen",RR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],ok=mt("stethoscope",MR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],LR=mt("table",OR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],$R=mt("tag",FR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],lr=mt("trash-2",zR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],BR=mt("triangle-alert",UR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],VR=mt("truck",qR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],$S=mt("upload",HR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],aw=mt("user-check",GR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],lk=mt("user-plus",YR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],tu=mt("user",WR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],rg=mt("users",QR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],KR=mt("video",JR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ni=mt("x",XR);var Wv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var zS;function ZR(){return zS||(zS=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var d=arguments[l];d&&(o=a(o,i(d)))}return o}function i(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var d in o)n.call(o,d)&&o[d]&&(l=a(l,d));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(Wv)),Wv.exports}var eM=ZR();const Jc=qd(eM);function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$d(e)}function tM(e,n){if($d(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n);if($d(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function ck(e){var n=tM(e,"string");return $d(n)=="symbol"?n:n+""}function Lm(e,n,t){return(n=ck(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function US(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function Dt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?US(Object(t),!0).forEach(function(i){Lm(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):US(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function nM(e){if(Array.isArray(e))return e}function iM(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,a,o,l,d=[],f=!0,u=!1;try{if(o=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;f=!1}else for(;!(f=(i=o.call(t)).done)&&(d.push(i.value),d.length!==n);f=!0);}catch(p){u=!0,a=p}finally{try{if(!f&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return d}}function X0(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=Array(n);t<n;t++)i[t]=e[t];return i}function uk(e,n){if(e){if(typeof e=="string")return X0(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?X0(e,n):void 0}}function rM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fl(e,n){return nM(e)||iM(e,n)||uk(e,n)||rM()}function aM(e,n){if(e==null)return{};var t={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(n.indexOf(i)!==-1)continue;t[i]=e[i]}return t}function Ul(e,n){if(e==null)return{};var t,i,a=aM(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var sM=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function oM(e){var n=e.defaultInputValue,t=n===void 0?"":n,i=e.defaultMenuIsOpen,a=i===void 0?!1:i,o=e.defaultValue,l=o===void 0?null:o,d=e.inputValue,f=e.menuIsOpen,u=e.onChange,p=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=Ul(e,sM),k=w.useState(d!==void 0?d:t),T=Fl(k,2),P=T[0],M=T[1],I=w.useState(f!==void 0?f:a),U=Fl(I,2),L=U[0],F=U[1],z=w.useState(v!==void 0?v:l),$=Fl(z,2),B=$[0],R=$[1],V=w.useCallback(function(J,fe){typeof u=="function"&&u(J,fe),R(J)},[u]),Y=w.useCallback(function(J,fe){var A;typeof p=="function"&&(A=p(J,fe)),M(A!==void 0?A:J)},[p]),ie=w.useCallback(function(){typeof b=="function"&&b(),F(!0)},[b]),te=w.useCallback(function(){typeof g=="function"&&g(),F(!1)},[g]),W=d!==void 0?d:P,H=f!==void 0?f:L,Q=v!==void 0?v:B;return Dt(Dt({},S),{},{inputValue:W,menuIsOpen:H,onChange:V,onInputChange:Y,onMenuClose:te,onMenuOpen:ie,value:Q})}function Lt(){return Lt=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Lt.apply(null,arguments)}function lM(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function BS(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,ck(i.key),i)}}function cM(e,n,t){return n&&BS(e.prototype,n),t&&BS(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z0(e,n){return Z0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},Z0(e,n)}function uM(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Z0(e,n)}function Kx(e){return Kx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Kx(e)}function dk(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dk=function(){return!!e})()}function dM(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fM(e,n){if(n&&($d(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dM(e)}function hM(e){var n=dk();return function(){var t,i=Kx(e);if(n){var a=Kx(this).constructor;t=Reflect.construct(i,arguments,a)}else t=i.apply(this,arguments);return fM(this,t)}}function pM(e){if(Array.isArray(e))return X0(e)}function mM(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gM(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sw(e){return pM(e)||mM(e)||uk(e)||gM()}function yM(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function xM(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var bM=function(){function e(t){var i=this;this._insertTag=function(a){var o;i.tags.length===0?i.insertionPoint?o=i.insertionPoint.nextSibling:i.prepend?o=i.container.firstChild:o=i.before:o=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(a,o),i.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(i){i.forEach(this._insertTag)},n.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(xM(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var o=yM(a);try{o.insertRule(i,o.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(i));this.ctr++},n.flush=function(){this.tags.forEach(function(i){var a;return(a=i.parentNode)==null?void 0:a.removeChild(i)}),this.tags=[],this.ctr=0},e}(),Er="-ms-",Xx="-moz-",An="-webkit-",fk="comm",ow="rule",lw="decl",vM="@import",hk="@keyframes",wM="@layer",SM=Math.abs,Nb=String.fromCharCode,NM=Object.assign;function CM(e,n){return or(e,0)^45?(((n<<2^or(e,0))<<2^or(e,1))<<2^or(e,2))<<2^or(e,3):0}function pk(e){return e.trim()}function jM(e,n){return(e=n.exec(e))?e[0]:e}function Pn(e,n,t){return e.replace(n,t)}function e1(e,n){return e.indexOf(n)}function or(e,n){return e.charCodeAt(n)|0}function Ym(e,n,t){return e.slice(n,t)}function Go(e){return e.length}function cw(e){return e.length}function dx(e,n){return n.push(e),e}function _M(e,n){return e.map(n).join("")}var Cb=1,Rh=1,mk=0,ha=0,Oi=0,Bh="";function jb(e,n,t,i,a,o,l){return{value:e,root:n,parent:t,type:i,props:a,children:o,line:Cb,column:Rh,length:l,return:""}}function Nm(e,n){return NM(jb("",null,null,"",null,null,0),e,{length:-e.length},n)}function kM(){return Oi}function TM(){return Oi=ha>0?or(Bh,--ha):0,Rh--,Oi===10&&(Rh=1,Cb--),Oi}function La(){return Oi=ha<mk?or(Bh,ha++):0,Rh++,Oi===10&&(Rh=1,Cb++),Oi}function Ko(){return or(Bh,ha)}function Rx(){return ha}function ag(e,n){return Ym(Bh,e,n)}function Wm(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function gk(e){return Cb=Rh=1,mk=Go(Bh=e),ha=0,[]}function yk(e){return Bh="",e}function Mx(e){return pk(ag(ha-1,t1(e===91?e+2:e===40?e+1:e)))}function EM(e){for(;(Oi=Ko())&&Oi<33;)La();return Wm(e)>2||Wm(Oi)>3?"":" "}function AM(e,n){for(;--n&&La()&&!(Oi<48||Oi>102||Oi>57&&Oi<65||Oi>70&&Oi<97););return ag(e,Rx()+(n<6&&Ko()==32&&La()==32))}function t1(e){for(;La();)switch(Oi){case e:return ha;case 34:case 39:e!==34&&e!==39&&t1(Oi);break;case 40:e===41&&t1(e);break;case 92:La();break}return ha}function PM(e,n){for(;La()&&e+Oi!==57;)if(e+Oi===84&&Ko()===47)break;return"/*"+ag(n,ha-1)+"*"+Nb(e===47?e:La())}function DM(e){for(;!Wm(Ko());)La();return ag(e,ha)}function IM(e){return yk(Ox("",null,null,null,[""],e=gk(e),0,[0],e))}function Ox(e,n,t,i,a,o,l,d,f){for(var u=0,p=0,g=l,b=0,v=0,S=0,k=1,T=1,P=1,M=0,I="",U=a,L=o,F=i,z=I;T;)switch(S=M,M=La()){case 40:if(S!=108&&or(z,g-1)==58){e1(z+=Pn(Mx(M),"&","&\f"),"&\f")!=-1&&(P=-1);break}case 34:case 39:case 91:z+=Mx(M);break;case 9:case 10:case 13:case 32:z+=EM(S);break;case 92:z+=AM(Rx()-1,7);continue;case 47:switch(Ko()){case 42:case 47:dx(RM(PM(La(),Rx()),n,t),f);break;default:z+="/"}break;case 123*k:d[u++]=Go(z)*P;case 125*k:case 59:case 0:switch(M){case 0:case 125:T=0;case 59+p:P==-1&&(z=Pn(z,/\f/g,"")),v>0&&Go(z)-g&&dx(v>32?VS(z+";",i,t,g-1):VS(Pn(z," ","")+";",i,t,g-2),f);break;case 59:z+=";";default:if(dx(F=qS(z,n,t,u,p,a,d,I,U=[],L=[],g),o),M===123)if(p===0)Ox(z,n,F,F,U,o,g,d,L);else switch(b===99&&or(z,3)===110?100:b){case 100:case 108:case 109:case 115:Ox(e,F,F,i&&dx(qS(e,F,F,0,0,a,d,I,a,U=[],g),L),a,L,g,d,i?U:L);break;default:Ox(z,F,F,F,[""],L,0,d,L)}}u=p=v=0,k=P=1,I=z="",g=l;break;case 58:g=1+Go(z),v=S;default:if(k<1){if(M==123)--k;else if(M==125&&k++==0&&TM()==125)continue}switch(z+=Nb(M),M*k){case 38:P=p>0?1:(z+="\f",-1);break;case 44:d[u++]=(Go(z)-1)*P,P=1;break;case 64:Ko()===45&&(z+=Mx(La())),b=Ko(),p=g=Go(I=z+=DM(Rx())),M++;break;case 45:S===45&&Go(z)==2&&(k=0)}}return o}function qS(e,n,t,i,a,o,l,d,f,u,p){for(var g=a-1,b=a===0?o:[""],v=cw(b),S=0,k=0,T=0;S<i;++S)for(var P=0,M=Ym(e,g+1,g=SM(k=l[S])),I=e;P<v;++P)(I=pk(k>0?b[P]+" "+M:Pn(M,/&\f/g,b[P])))&&(f[T++]=I);return jb(e,n,t,a===0?ow:d,f,u,p)}function RM(e,n,t){return jb(e,n,t,fk,Nb(kM()),Ym(e,2,-2),0)}function VS(e,n,t,i){return jb(e,n,t,lw,Ym(e,0,i),Ym(e,i+1,-1),i)}function kh(e,n){for(var t="",i=cw(e),a=0;a<i;a++)t+=n(e[a],a,e,n)||"";return t}function MM(e,n,t,i){switch(e.type){case wM:if(e.children.length)break;case vM:case lw:return e.return=e.return||e.value;case fk:return"";case hk:return e.return=e.value+"{"+kh(e.children,i)+"}";case ow:e.value=e.props.join(",")}return Go(t=kh(e.children,i))?e.return=e.value+"{"+t+"}":""}function OM(e){var n=cw(e);return function(t,i,a,o){for(var l="",d=0;d<n;d++)l+=e[d](t,i,a,o)||"";return l}}function LM(e){return function(n){n.root||(n=n.return)&&e(n)}}function FM(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var $M=function(n,t,i){for(var a=0,o=0;a=o,o=Ko(),a===38&&o===12&&(t[i]=1),!Wm(o);)La();return ag(n,ha)},zM=function(n,t){var i=-1,a=44;do switch(Wm(a)){case 0:a===38&&Ko()===12&&(t[i]=1),n[i]+=$M(ha-1,t,i);break;case 2:n[i]+=Mx(a);break;case 4:if(a===44){n[++i]=Ko()===58?"&\f":"",t[i]=n[i].length;break}default:n[i]+=Nb(a)}while(a=La());return n},UM=function(n,t){return yk(zM(gk(n),t))},HS=new WeakMap,BM=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,i=n.parent,a=n.column===i.column&&n.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!HS.get(i))&&!a){HS.set(n,!0);for(var o=[],l=UM(t,o),d=i.props,f=0,u=0;f<l.length;f++)for(var p=0;p<d.length;p++,u++)n.props[u]=o[f]?l[f].replace(/&\f/g,d[p]):d[p]+" "+l[f]}}},qM=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function xk(e,n){switch(CM(e,n)){case 5103:return An+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return An+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return An+e+Xx+e+Er+e+e;case 6828:case 4268:return An+e+Er+e+e;case 6165:return An+e+Er+"flex-"+e+e;case 5187:return An+e+Pn(e,/(\w+).+(:[^]+)/,An+"box-$1$2"+Er+"flex-$1$2")+e;case 5443:return An+e+Er+"flex-item-"+Pn(e,/flex-|-self/,"")+e;case 4675:return An+e+Er+"flex-line-pack"+Pn(e,/align-content|flex-|-self/,"")+e;case 5548:return An+e+Er+Pn(e,"shrink","negative")+e;case 5292:return An+e+Er+Pn(e,"basis","preferred-size")+e;case 6060:return An+"box-"+Pn(e,"-grow","")+An+e+Er+Pn(e,"grow","positive")+e;case 4554:return An+Pn(e,/([^-])(transform)/g,"$1"+An+"$2")+e;case 6187:return Pn(Pn(Pn(e,/(zoom-|grab)/,An+"$1"),/(image-set)/,An+"$1"),e,"")+e;case 5495:case 3959:return Pn(e,/(image-set\([^]*)/,An+"$1$`$1");case 4968:return Pn(Pn(e,/(.+:)(flex-)?(.*)/,An+"box-pack:$3"+Er+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+An+e+e;case 4095:case 3583:case 4068:case 2532:return Pn(e,/(.+)-inline(.+)/,An+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Go(e)-1-n>6)switch(or(e,n+1)){case 109:if(or(e,n+4)!==45)break;case 102:return Pn(e,/(.+:)(.+)-([^]+)/,"$1"+An+"$2-$3$1"+Xx+(or(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~e1(e,"stretch")?xk(Pn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(or(e,n+1)!==115)break;case 6444:switch(or(e,Go(e)-3-(~e1(e,"!important")&&10))){case 107:return Pn(e,":",":"+An)+e;case 101:return Pn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+An+(or(e,14)===45?"inline-":"")+"box$3$1"+An+"$2$3$1"+Er+"$2box$3")+e}break;case 5936:switch(or(e,n+11)){case 114:return An+e+Er+Pn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return An+e+Er+Pn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return An+e+Er+Pn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return An+e+Er+e+e}return e}var VM=function(n,t,i,a){if(n.length>-1&&!n.return)switch(n.type){case lw:n.return=xk(n.value,n.length);break;case hk:return kh([Nm(n,{value:Pn(n.value,"@","@"+An)})],a);case ow:if(n.length)return _M(n.props,function(o){switch(jM(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return kh([Nm(n,{props:[Pn(o,/:(read-\w+)/,":"+Xx+"$1")]})],a);case"::placeholder":return kh([Nm(n,{props:[Pn(o,/:(plac\w+)/,":"+An+"input-$1")]}),Nm(n,{props:[Pn(o,/:(plac\w+)/,":"+Xx+"$1")]}),Nm(n,{props:[Pn(o,/:(plac\w+)/,Er+"input-$1")]})],a)}return""})}},HM=[VM],GM=function(n){var t=n.key;if(t==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||HM,o={},l,d=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),P=1;P<T.length;P++)o[T[P]]=!0;d.push(k)});var f,u=[BM,qM];{var p,g=[MM,LM(function(k){p.insert(k)})],b=OM(u.concat(a,g)),v=function(T){return kh(IM(T),b)};f=function(T,P,M,I){p=M,v(T?T+"{"+P.styles+"}":P.styles),I&&(S.inserted[P.name]=!0)}}var S={key:t,sheet:new bM({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:o,registered:{},insert:f};return S.sheet.hydrate(d),S},Qv={exports:{}},Mn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GS;function YM(){if(GS)return Mn;GS=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,i=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,P=e?Symbol.for("react.responder"):60118,M=e?Symbol.for("react.scope"):60119;function I(L){if(typeof L=="object"&&L!==null){var F=L.$$typeof;switch(F){case n:switch(L=L.type,L){case f:case u:case i:case o:case a:case g:return L;default:switch(L=L&&L.$$typeof,L){case d:case p:case S:case v:case l:return L;default:return F}}case t:return F}}}function U(L){return I(L)===u}return Mn.AsyncMode=f,Mn.ConcurrentMode=u,Mn.ContextConsumer=d,Mn.ContextProvider=l,Mn.Element=n,Mn.ForwardRef=p,Mn.Fragment=i,Mn.Lazy=S,Mn.Memo=v,Mn.Portal=t,Mn.Profiler=o,Mn.StrictMode=a,Mn.Suspense=g,Mn.isAsyncMode=function(L){return U(L)||I(L)===f},Mn.isConcurrentMode=U,Mn.isContextConsumer=function(L){return I(L)===d},Mn.isContextProvider=function(L){return I(L)===l},Mn.isElement=function(L){return typeof L=="object"&&L!==null&&L.$$typeof===n},Mn.isForwardRef=function(L){return I(L)===p},Mn.isFragment=function(L){return I(L)===i},Mn.isLazy=function(L){return I(L)===S},Mn.isMemo=function(L){return I(L)===v},Mn.isPortal=function(L){return I(L)===t},Mn.isProfiler=function(L){return I(L)===o},Mn.isStrictMode=function(L){return I(L)===a},Mn.isSuspense=function(L){return I(L)===g},Mn.isValidElementType=function(L){return typeof L=="string"||typeof L=="function"||L===i||L===u||L===o||L===a||L===g||L===b||typeof L=="object"&&L!==null&&(L.$$typeof===S||L.$$typeof===v||L.$$typeof===l||L.$$typeof===d||L.$$typeof===p||L.$$typeof===T||L.$$typeof===P||L.$$typeof===M||L.$$typeof===k)},Mn.typeOf=I,Mn}var YS;function WM(){return YS||(YS=1,Qv.exports=YM()),Qv.exports}var Jv,WS;function QM(){if(WS)return Jv;WS=1;var e=WM(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[e.ForwardRef]=i,o[e.Memo]=a;function l(S){return e.isMemo(S)?a:o[S.$$typeof]||n}var d=Object.defineProperty,f=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,T){if(typeof k!="string"){if(b){var P=g(k);P&&P!==b&&v(S,P,T)}var M=f(k);u&&(M=M.concat(u(k)));for(var I=l(S),U=l(k),L=0;L<M.length;++L){var F=M[L];if(!t[F]&&!(T&&T[F])&&!(U&&U[F])&&!(I&&I[F])){var z=p(k,F);try{d(S,F,z)}catch{}}}}return S}return Jv=v,Jv}QM();var JM=!0;function KM(e,n,t){var i="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(i+=a+" ")}),i}var bk=function(n,t,i){var a=n.key+"-"+t.name;(i===!1||JM===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},XM=function(n,t,i){bk(n,t,i);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var o=t;do n.insert(t===o?"."+a:"",o,n.sheet,!0),o=o.next;while(o!==void 0)}};function ZM(e){for(var n=0,t,i=0,a=e.length;a>=4;++i,a-=4)t=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(i+2)&255)<<16;case 2:n^=(e.charCodeAt(i+1)&255)<<8;case 1:n^=e.charCodeAt(i)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var e4={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},t4=/[A-Z]|^ms/g,n4=/_EMO_([^_]+?)_([^]*?)_EMO_/g,vk=function(n){return n.charCodeAt(1)===45},QS=function(n){return n!=null&&typeof n!="boolean"},Kv=FM(function(e){return vk(e)?e:e.replace(t4,"-$&").toLowerCase()}),JS=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(n4,function(i,a,o){return Yo={name:a,styles:o,next:Yo},a})}return e4[n]!==1&&!vk(n)&&typeof t=="number"&&t!==0?t+"px":t};function Qm(e,n,t){if(t==null)return"";var i=t;if(i.__emotion_styles!==void 0)return i;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return Yo={name:a.name,styles:a.styles,next:Yo},a.name;var o=t;if(o.styles!==void 0){var l=o.next;if(l!==void 0)for(;l!==void 0;)Yo={name:l.name,styles:l.styles,next:Yo},l=l.next;var d=o.styles+";";return d}return i4(e,n,t)}case"function":{if(e!==void 0){var f=Yo,u=t(e);return Yo=f,Qm(e,n,u)}break}}var p=t;return p}function i4(e,n,t){var i="";if(Array.isArray(t))for(var a=0;a<t.length;a++)i+=Qm(e,n,t[a])+";";else for(var o in t){var l=t[o];if(typeof l!="object"){var d=l;QS(d)&&(i+=Kv(o)+":"+JS(o,d)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var f=0;f<l.length;f++)QS(l[f])&&(i+=Kv(o)+":"+JS(o,l[f])+";");else{var u=Qm(e,n,l);switch(o){case"animation":case"animationName":{i+=Kv(o)+":"+u+";";break}default:i+=o+"{"+u+"}"}}}return i}var KS=/label:\s*([^\s;{]+)\s*(;|$)/g,Yo;function wk(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,a="";Yo=void 0;var o=e[0];if(o==null||o.raw===void 0)i=!1,a+=Qm(t,n,o);else{var l=o;a+=l[0]}for(var d=1;d<e.length;d++)if(a+=Qm(t,n,e[d]),i){var f=o;a+=f[d]}KS.lastIndex=0;for(var u="",p;(p=KS.exec(a))!==null;)u+="-"+p[1];var g=ZM(a)+u;return{name:g,styles:a,next:Yo}}var r4=function(n){return n()},a4=cS.useInsertionEffect?cS.useInsertionEffect:!1,s4=a4||r4,Sk=w.createContext(typeof HTMLElement<"u"?GM({key:"css"}):null);Sk.Provider;var o4=function(n){return w.forwardRef(function(t,i){var a=w.useContext(Sk);return n(t,a,i)})},l4=w.createContext({}),uw={}.hasOwnProperty,n1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",c4=function(n,t){var i={};for(var a in t)uw.call(t,a)&&(i[a]=t[a]);return i[n1]=n,i},u4=function(n){var t=n.cache,i=n.serialized,a=n.isStringTag;return bk(t,i,a),s4(function(){return XM(t,i,a)}),null},d4=o4(function(e,n,t){var i=e.css;typeof i=="string"&&n.registered[i]!==void 0&&(i=n.registered[i]);var a=e[n1],o=[i],l="";typeof e.className=="string"?l=KM(n.registered,o,e.className):e.className!=null&&(l=e.className+" ");var d=wk(o,void 0,w.useContext(l4));l+=n.key+"-"+d.name;var f={};for(var u in e)uw.call(e,u)&&u!=="css"&&u!==n1&&(f[u]=e[u]);return f.className=l,t&&(f.ref=t),w.createElement(w.Fragment,null,w.createElement(u4,{cache:n,serialized:d,isStringTag:typeof a=="string"}),w.createElement(a,f))}),f4=d4,_t=function(n,t){var i=arguments;if(t==null||!uw.call(t,"css"))return w.createElement.apply(void 0,i);var a=i.length,o=new Array(a);o[0]=f4,o[1]=c4(n,t);for(var l=2;l<a;l++)o[l]=i[l];return w.createElement.apply(null,o)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(_t||(_t={}));function dw(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return wk(n)}function h4(){var e=dw.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function p4(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const m4=Math.min,g4=Math.max,Zx=Math.round,fx=Math.floor,eb=e=>({x:e,y:e});function y4(e){const{x:n,y:t,width:i,height:a}=e;return{width:i,height:a,top:t,left:n,right:n+i,bottom:t+a,x:n,y:t}}function _b(){return typeof window<"u"}function Nk(e){return jk(e)?(e.nodeName||"").toLowerCase():"#document"}function zl(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Ck(e){var n;return(n=(jk(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function jk(e){return _b()?e instanceof Node||e instanceof zl(e).Node:!1}function x4(e){return _b()?e instanceof Element||e instanceof zl(e).Element:!1}function fw(e){return _b()?e instanceof HTMLElement||e instanceof zl(e).HTMLElement:!1}function XS(e){return!_b()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof zl(e).ShadowRoot}const b4=new Set(["inline","contents"]);function _k(e){const{overflow:n,overflowX:t,overflowY:i,display:a}=hw(e);return/auto|scroll|overlay|hidden|clip/.test(n+i+t)&&!b4.has(a)}function v4(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const w4=new Set(["html","body","#document"]);function S4(e){return w4.has(Nk(e))}function hw(e){return zl(e).getComputedStyle(e)}function N4(e){if(Nk(e)==="html")return e;const n=e.assignedSlot||e.parentNode||XS(e)&&e.host||Ck(e);return XS(n)?n.host:n}function kk(e){const n=N4(e);return S4(n)?e.ownerDocument?e.ownerDocument.body:e.body:fw(n)&&_k(n)?n:kk(n)}function tb(e,n,t){var i;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=kk(e),o=a===((i=e.ownerDocument)==null?void 0:i.body),l=zl(a);if(o){const d=i1(l);return n.concat(l,l.visualViewport||[],_k(a)?a:[],d&&t?tb(d):[])}return n.concat(a,tb(a,[],t))}function i1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function C4(e){const n=hw(e);let t=parseFloat(n.width)||0,i=parseFloat(n.height)||0;const a=fw(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:i,d=Zx(t)!==o||Zx(i)!==l;return d&&(t=o,i=l),{width:t,height:i,$:d}}function pw(e){return x4(e)?e:e.contextElement}function ZS(e){const n=pw(e);if(!fw(n))return eb(1);const t=n.getBoundingClientRect(),{width:i,height:a,$:o}=C4(n);let l=(o?Zx(t.width):t.width)/i,d=(o?Zx(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!d||!Number.isFinite(d))&&(d=1),{x:l,y:d}}const j4=eb(0);function _4(e){const n=zl(e);return!v4()||!n.visualViewport?j4:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function k4(e,n,t){return!1}function eN(e,n,t,i){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=pw(e);let l=eb(1);n&&(l=ZS(e));const d=k4()?_4(o):eb(0);let f=(a.left+d.x)/l.x,u=(a.top+d.y)/l.y,p=a.width/l.x,g=a.height/l.y;if(o){const b=zl(o),v=i;let S=b,k=i1(S);for(;k&&i&&v!==S;){const T=ZS(k),P=k.getBoundingClientRect(),M=hw(k),I=P.left+(k.clientLeft+parseFloat(M.paddingLeft))*T.x,U=P.top+(k.clientTop+parseFloat(M.paddingTop))*T.y;f*=T.x,u*=T.y,p*=T.x,g*=T.y,f+=I,u+=U,S=zl(k),k=i1(S)}}return y4({width:p,height:g,x:f,y:u})}function Tk(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function T4(e,n){let t=null,i;const a=Ck(e);function o(){var d;clearTimeout(i),(d=t)==null||d.disconnect(),t=null}function l(d,f){d===void 0&&(d=!1),f===void 0&&(f=1),o();const u=e.getBoundingClientRect(),{left:p,top:g,width:b,height:v}=u;if(d||n(),!b||!v)return;const S=fx(g),k=fx(a.clientWidth-(p+b)),T=fx(a.clientHeight-(g+v)),P=fx(p),I={rootMargin:-S+"px "+-k+"px "+-T+"px "+-P+"px",threshold:g4(0,m4(1,f))||1};let U=!0;function L(F){const z=F[0].intersectionRatio;if(z!==f){if(!U)return l();z?l(!1,z):i=setTimeout(()=>{l(!1,1e-7)},1e3)}z===1&&!Tk(u,e.getBoundingClientRect())&&l(),U=!1}try{t=new IntersectionObserver(L,{...I,root:a.ownerDocument})}catch{t=new IntersectionObserver(L,I)}t.observe(e)}return l(!0),o}function E4(e,n,t,i){i===void 0&&(i={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:f=!1}=i,u=pw(e),p=a||o?[...u?tb(u):[],...tb(n)]:[];p.forEach(P=>{a&&P.addEventListener("scroll",t,{passive:!0}),o&&P.addEventListener("resize",t)});const g=u&&d?T4(u,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(P=>{let[M]=P;M&&M.target===u&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var I;(I=v)==null||I.observe(n)})),t()}),u&&!f&&v.observe(u),v.observe(n));let S,k=f?eN(e):null;f&&T();function T(){const P=eN(e);k&&!Tk(k,P)&&t(),k=P,S=requestAnimationFrame(T)}return t(),()=>{var P;p.forEach(M=>{a&&M.removeEventListener("scroll",t),o&&M.removeEventListener("resize",t)}),g==null||g(),(P=v)==null||P.disconnect(),v=null,f&&cancelAnimationFrame(S)}}var r1=w.useLayoutEffect,A4=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],nb=function(){};function P4(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function D4(e,n){for(var t=arguments.length,i=new Array(t>2?t-2:0),a=2;a<t;a++)i[a-2]=arguments[a];var o=[].concat(i);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&o.push("".concat(P4(e,l)));return o.filter(function(d){return d}).map(function(d){return String(d).trim()}).join(" ")}var tN=function(n){return U4(n)?n.filter(Boolean):$d(n)==="object"&&n!==null?[n]:[]},Ek=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=Ul(n,A4);return Dt({},t)},xi=function(n,t,i){var a=n.cx,o=n.getStyles,l=n.getClassNames,d=n.className;return{css:o(t,n),className:a(i??{},l(t,n),d)}};function kb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function I4(e){return kb(e)?window.innerHeight:e.clientHeight}function Ak(e){return kb(e)?window.pageYOffset:e.scrollTop}function ib(e,n){if(kb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function R4(e){var n=getComputedStyle(e),t=n.position==="absolute",i=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&i.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function M4(e,n,t,i){return t*((e=e/i-1)*e*e+1)+n}function hx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:nb,a=Ak(e),o=n-a,l=10,d=0;function f(){d+=l;var u=M4(d,a,o,t);ib(e,u),d<t?window.requestAnimationFrame(f):i(e)}f()}function nN(e,n){var t=e.getBoundingClientRect(),i=n.getBoundingClientRect(),a=n.offsetHeight/3;i.bottom+a>t.bottom?ib(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):i.top-a<t.top&&ib(e,Math.max(n.offsetTop-a,0))}function O4(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function iN(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function L4(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var Pk=!1,F4={get passive(){return Pk=!0}},px=typeof window<"u"?window:{};px.addEventListener&&px.removeEventListener&&(px.addEventListener("p",nb,F4),px.removeEventListener("p",nb,!1));var $4=Pk;function z4(e){return e!=null}function U4(e){return Array.isArray(e)}function mx(e,n,t){return e?n:t}var B4=function(n){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];var o=Object.entries(n).filter(function(l){var d=Fl(l,1),f=d[0];return!i.includes(f)});return o.reduce(function(l,d){var f=Fl(d,2),u=f[0],p=f[1];return l[u]=p,l},{})},q4=["children","innerProps"],V4=["children","innerProps"];function H4(e){var n=e.maxHeight,t=e.menuEl,i=e.minHeight,a=e.placement,o=e.shouldScroll,l=e.isFixedPosition,d=e.controlHeight,f=R4(t),u={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return u;var p=f.getBoundingClientRect(),g=p.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),P=T.top,M=l?window.innerHeight:I4(f),I=Ak(f),U=parseInt(getComputedStyle(t).marginBottom,10),L=parseInt(getComputedStyle(t).marginTop,10),F=P-L,z=M-k,$=F+I,B=g-I-k,R=v-M+I+U,V=I+k-L,Y=160;switch(a){case"auto":case"bottom":if(z>=S)return{placement:"bottom",maxHeight:n};if(B>=S&&!l)return o&&hx(f,R,Y),{placement:"bottom",maxHeight:n};if(!l&&B>=i||l&&z>=i){o&&hx(f,R,Y);var ie=l?z-U:B-U;return{placement:"bottom",maxHeight:ie}}if(a==="auto"||l){var te=n,W=l?F:$;return W>=i&&(te=Math.min(W-U-d,n)),{placement:"top",maxHeight:te}}if(a==="bottom")return o&&ib(f,R),{placement:"bottom",maxHeight:n};break;case"top":if(F>=S)return{placement:"top",maxHeight:n};if($>=S&&!l)return o&&hx(f,V,Y),{placement:"top",maxHeight:n};if(!l&&$>=i||l&&F>=i){var H=n;return(!l&&$>=i||l&&F>=i)&&(H=l?F-L:$-L),o&&hx(f,V,Y),{placement:"top",maxHeight:H}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return u}function G4(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var Dk=function(n){return n==="auto"?"bottom":n},Y4=function(n,t){var i,a=n.placement,o=n.theme,l=o.borderRadius,d=o.spacing,f=o.colors;return Dt((i={label:"menu"},Lm(i,G4(a),"100%"),Lm(i,"position","absolute"),Lm(i,"width","100%"),Lm(i,"zIndex",1),i),t?{}:{backgroundColor:f.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:d.menuGutter,marginTop:d.menuGutter})},Ik=w.createContext(null),W4=function(n){var t=n.children,i=n.minMenuHeight,a=n.maxMenuHeight,o=n.menuPlacement,l=n.menuPosition,d=n.menuShouldScrollIntoView,f=n.theme,u=w.useContext(Ik)||{},p=u.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=Fl(b,2),S=v[0],k=v[1],T=w.useState(null),P=Fl(T,2),M=P[0],I=P[1],U=f.spacing.controlHeight;return r1(function(){var L=g.current;if(L){var F=l==="fixed",z=d&&!F,$=H4({maxHeight:a,menuEl:L,minHeight:i,placement:o,shouldScroll:z,isFixedPosition:F,controlHeight:U});k($.maxHeight),I($.placement),p==null||p($.placement)}},[a,o,l,d,i,p,U]),t({ref:g,placerProps:Dt(Dt({},n),{},{placement:M||Dk(o),maxHeight:S})})},Q4=function(n){var t=n.children,i=n.innerRef,a=n.innerProps;return _t("div",Lt({},xi(n,"menu",{menu:!0}),{ref:i},a),t)},J4=Q4,K4=function(n,t){var i=n.maxHeight,a=n.theme.spacing.baseUnit;return Dt({maxHeight:i,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},X4=function(n){var t=n.children,i=n.innerProps,a=n.innerRef,o=n.isMulti;return _t("div",Lt({},xi(n,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:a},i),t)},Rk=function(n,t){var i=n.theme,a=i.spacing.baseUnit,o=i.colors;return Dt({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},Z4=Rk,eO=Rk,tO=function(n){var t=n.children,i=t===void 0?"No options":t,a=n.innerProps,o=Ul(n,q4);return _t("div",Lt({},xi(Dt(Dt({},o),{},{children:i,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),i)},nO=function(n){var t=n.children,i=t===void 0?"Loading...":t,a=n.innerProps,o=Ul(n,V4);return _t("div",Lt({},xi(Dt(Dt({},o),{},{children:i,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),i)},iO=function(n){var t=n.rect,i=n.offset,a=n.position;return{left:t.left,position:a,top:i,width:t.width,zIndex:1}},rO=function(n){var t=n.appendTo,i=n.children,a=n.controlElement,o=n.innerProps,l=n.menuPlacement,d=n.menuPosition,f=w.useRef(null),u=w.useRef(null),p=w.useState(Dk(l)),g=Fl(p,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=Fl(k,2),P=T[0],M=T[1],I=w.useCallback(function(){if(a){var z=O4(a),$=d==="fixed"?0:window.pageYOffset,B=z[b]+$;(B!==(P==null?void 0:P.offset)||z.left!==(P==null?void 0:P.rect.left)||z.width!==(P==null?void 0:P.rect.width))&&M({offset:B,rect:z})}},[a,d,b,P==null?void 0:P.offset,P==null?void 0:P.rect.left,P==null?void 0:P.rect.width]);r1(function(){I()},[I]);var U=w.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),a&&f.current&&(u.current=E4(a,f.current,I,{elementResize:"ResizeObserver"in window}))},[a,I]);r1(function(){U()},[U]);var L=w.useCallback(function(z){f.current=z,U()},[U]);if(!t&&d!=="fixed"||!P)return null;var F=_t("div",Lt({ref:L},xi(Dt(Dt({},n),{},{offset:P.offset,position:d,rect:P.rect}),"menuPortal",{"menu-portal":!0}),o),i);return _t(Ik.Provider,{value:S},t?OD.createPortal(F,t):F)},aO=function(n){var t=n.isDisabled,i=n.isRtl;return{label:"container",direction:i?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},sO=function(n){var t=n.children,i=n.innerProps,a=n.isDisabled,o=n.isRtl;return _t("div",Lt({},xi(n,"container",{"--is-disabled":a,"--is-rtl":o}),i),t)},oO=function(n,t){var i=n.theme.spacing,a=n.isMulti,o=n.hasValue,l=n.selectProps.controlShouldRenderValue;return Dt({alignItems:"center",display:a&&o&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(i.baseUnit/2,"px ").concat(i.baseUnit*2,"px")})},lO=function(n){var t=n.children,i=n.innerProps,a=n.isMulti,o=n.hasValue;return _t("div",Lt({},xi(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":o}),i),t)},cO=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},uO=function(n){var t=n.children,i=n.innerProps;return _t("div",Lt({},xi(n,"indicatorsContainer",{indicators:!0}),i),t)},rN,dO=["size"],fO=["innerProps","isRtl","size"],hO={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Mk=function(n){var t=n.size,i=Ul(n,dO);return _t("svg",Lt({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:hO},i))},mw=function(n){return _t(Mk,Lt({size:20},n),_t("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Ok=function(n){return _t(Mk,Lt({size:20},n),_t("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},Lk=function(n,t){var i=n.isFocused,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Dt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:i?l.neutral60:l.neutral20,padding:o*2,":hover":{color:i?l.neutral80:l.neutral40}})},pO=Lk,mO=function(n){var t=n.children,i=n.innerProps;return _t("div",Lt({},xi(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),i),t||_t(Ok,null))},gO=Lk,yO=function(n){var t=n.children,i=n.innerProps;return _t("div",Lt({},xi(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),i),t||_t(mw,null))},xO=function(n,t){var i=n.isDisabled,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Dt({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:i?l.neutral10:l.neutral20,marginBottom:o*2,marginTop:o*2})},bO=function(n){var t=n.innerProps;return _t("span",Lt({},t,xi(n,"indicatorSeparator",{"indicator-separator":!0})))},vO=h4(rN||(rN=p4([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),wO=function(n,t){var i=n.isFocused,a=n.size,o=n.theme,l=o.colors,d=o.spacing.baseUnit;return Dt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:i?l.neutral60:l.neutral20,padding:d*2})},Xv=function(n){var t=n.delay,i=n.offset;return _t("span",{css:dw({animation:"".concat(vO," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:i?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},SO=function(n){var t=n.innerProps,i=n.isRtl,a=n.size,o=a===void 0?4:a,l=Ul(n,fO);return _t("div",Lt({},xi(Dt(Dt({},l),{},{innerProps:t,isRtl:i,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),_t(Xv,{delay:0,offset:i}),_t(Xv,{delay:160,offset:!0}),_t(Xv,{delay:320,offset:!i}))},NO=function(n,t){var i=n.isDisabled,a=n.isFocused,o=n.theme,l=o.colors,d=o.borderRadius,f=o.spacing;return Dt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:f.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:i?l.neutral5:l.neutral0,borderColor:i?l.neutral10:a?l.primary:l.neutral20,borderRadius:d,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},CO=function(n){var t=n.children,i=n.isDisabled,a=n.isFocused,o=n.innerRef,l=n.innerProps,d=n.menuIsOpen;return _t("div",Lt({ref:o},xi(n,"control",{control:!0,"control--is-disabled":i,"control--is-focused":a,"control--menu-is-open":d}),l,{"aria-disabled":i||void 0}),t)},jO=CO,_O=["data"],kO=function(n,t){var i=n.theme.spacing;return t?{}:{paddingBottom:i.baseUnit*2,paddingTop:i.baseUnit*2}},TO=function(n){var t=n.children,i=n.cx,a=n.getStyles,o=n.getClassNames,l=n.Heading,d=n.headingProps,f=n.innerProps,u=n.label,p=n.theme,g=n.selectProps;return _t("div",Lt({},xi(n,"group",{group:!0}),f),_t(l,Lt({},d,{selectProps:g,theme:p,getStyles:a,getClassNames:o,cx:i}),u),_t("div",null,t))},EO=function(n,t){var i=n.theme,a=i.colors,o=i.spacing;return Dt({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},AO=function(n){var t=Ek(n);t.data;var i=Ul(t,_O);return _t("div",Lt({},xi(n,"groupHeading",{"group-heading":!0}),i))},PO=TO,DO=["innerRef","isDisabled","isHidden","inputClassName"],IO=function(n,t){var i=n.isDisabled,a=n.value,o=n.theme,l=o.spacing,d=o.colors;return Dt(Dt({visibility:i?"hidden":"visible",transform:a?"translateZ(0)":""},RO),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:d.neutral80})},Fk={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},RO={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Dt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Fk)},MO=function(n){return Dt({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},Fk)},OO=function(n){var t=n.cx,i=n.value,a=Ek(n),o=a.innerRef,l=a.isDisabled,d=a.isHidden,f=a.inputClassName,u=Ul(a,DO);return _t("div",Lt({},xi(n,"input",{"input-container":!0}),{"data-value":i||""}),_t("input",Lt({className:t({input:!0},f),ref:o,style:MO(d),disabled:l},u)))},LO=OO,FO=function(n,t){var i=n.theme,a=i.spacing,o=i.borderRadius,l=i.colors;return Dt({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:o/2,margin:a.baseUnit/2})},$O=function(n,t){var i=n.theme,a=i.borderRadius,o=i.colors,l=n.cropWithEllipsis;return Dt({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},zO=function(n,t){var i=n.theme,a=i.spacing,o=i.borderRadius,l=i.colors,d=n.isFocused;return Dt({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:d?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},$k=function(n){var t=n.children,i=n.innerProps;return _t("div",i,t)},UO=$k,BO=$k;function qO(e){var n=e.children,t=e.innerProps;return _t("div",Lt({role:"button"},t),n||_t(mw,{size:14}))}var VO=function(n){var t=n.children,i=n.components,a=n.data,o=n.innerProps,l=n.isDisabled,d=n.removeProps,f=n.selectProps,u=i.Container,p=i.Label,g=i.Remove;return _t(u,{data:a,innerProps:Dt(Dt({},xi(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),o),selectProps:f},_t(p,{data:a,innerProps:Dt({},xi(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:f},t),_t(g,{data:a,innerProps:Dt(Dt({},xi(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},d),selectProps:f}))},HO=VO,GO=function(n,t){var i=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.theme,d=l.spacing,f=l.colors;return Dt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?f.primary:a?f.primary25:"transparent",color:i?f.neutral20:o?f.neutral0:"inherit",padding:"".concat(d.baseUnit*2,"px ").concat(d.baseUnit*3,"px"),":active":{backgroundColor:i?void 0:o?f.primary:f.primary50}})},YO=function(n){var t=n.children,i=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.innerRef,d=n.innerProps;return _t("div",Lt({},xi(n,"option",{option:!0,"option--is-disabled":i,"option--is-focused":a,"option--is-selected":o}),{ref:l,"aria-disabled":i},d),t)},WO=YO,QO=function(n,t){var i=n.theme,a=i.spacing,o=i.colors;return Dt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},JO=function(n){var t=n.children,i=n.innerProps;return _t("div",Lt({},xi(n,"placeholder",{placeholder:!0}),i),t)},KO=JO,XO=function(n,t){var i=n.isDisabled,a=n.theme,o=a.spacing,l=a.colors;return Dt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:i?l.neutral40:l.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},ZO=function(n){var t=n.children,i=n.isDisabled,a=n.innerProps;return _t("div",Lt({},xi(n,"singleValue",{"single-value":!0,"single-value--is-disabled":i}),a),t)},eL=ZO,tL={ClearIndicator:yO,Control:jO,DropdownIndicator:mO,DownChevron:Ok,CrossIcon:mw,Group:PO,GroupHeading:AO,IndicatorsContainer:uO,IndicatorSeparator:bO,Input:LO,LoadingIndicator:SO,Menu:J4,MenuList:X4,MenuPortal:rO,LoadingMessage:nO,NoOptionsMessage:tO,MultiValue:HO,MultiValueContainer:UO,MultiValueLabel:BO,MultiValueRemove:qO,Option:WO,Placeholder:KO,SelectContainer:sO,SingleValue:eL,ValueContainer:lO},nL=function(n){return Dt(Dt({},tL),n.components)},aN=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function iL(e,n){return!!(e===n||aN(e)&&aN(n))}function rL(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!iL(e[t],n[t]))return!1;return!0}function aL(e,n){n===void 0&&(n=rL);var t=null;function i(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return i.clear=function(){t=null},i}var sL={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},oL=function(n){return _t("span",Lt({css:sL},n))},sN=oL,lL={guidance:function(n){var t=n.isSearchable,i=n.isMulti,a=n.tabSelectsValue,o=n.context,l=n.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(i?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,i=n.label,a=i===void 0?"":i,o=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,i=n.focused,a=n.options,o=n.label,l=o===void 0?"":o,d=n.selectValue,f=n.isDisabled,u=n.isSelected,p=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&d)return"value ".concat(l," focused, ").concat(g(d,i),".");if(t==="menu"&&p){var b=f?" disabled":"",v="".concat(u?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,i),".")}return""},onFilter:function(n){var t=n.inputValue,i=n.resultsMessage;return"".concat(i).concat(t?" for search term "+t:"",".")}},cL=function(n){var t=n.ariaSelection,i=n.focusedOption,a=n.focusedValue,o=n.focusableOptions,l=n.isFocused,d=n.selectValue,f=n.selectProps,u=n.id,p=n.isAppleDevice,g=f.ariaLiveMessages,b=f.getOptionLabel,v=f.inputValue,S=f.isMulti,k=f.isOptionDisabled,T=f.isSearchable,P=f.menuIsOpen,M=f.options,I=f.screenReaderStatus,U=f.tabSelectsValue,L=f.isLoading,F=f["aria-label"],z=f["aria-live"],$=w.useMemo(function(){return Dt(Dt({},lL),g||{})},[g]),B=w.useMemo(function(){var W="";if(t&&$.onChange){var H=t.option,Q=t.options,J=t.removedValue,fe=t.removedValues,A=t.value,oe=function(re){return Array.isArray(re)?null:re},ue=J||H||oe(A),D=ue?b(ue):"",se=Q||fe||void 0,be=se?se.map(b):[],ee=Dt({isDisabled:ue&&k(ue,d),label:D,labels:be},t);W=$.onChange(ee)}return W},[t,$,k,d,b]),R=w.useMemo(function(){var W="",H=i||a,Q=!!(i&&d&&d.includes(i));if(H&&$.onFocus){var J={focused:H,label:b(H),isDisabled:k(H,d),isSelected:Q,options:o,context:H===i?"menu":"value",selectValue:d,isAppleDevice:p};W=$.onFocus(J)}return W},[i,a,b,k,$,o,d,p]),V=w.useMemo(function(){var W="";if(P&&M.length&&!L&&$.onFilter){var H=I({count:o.length});W=$.onFilter({inputValue:v,resultsMessage:H})}return W},[o,v,P,$,M,I,L]),Y=(t==null?void 0:t.action)==="initial-input-focus",ie=w.useMemo(function(){var W="";if($.guidance){var H=a?"value":P?"menu":"input";W=$.guidance({"aria-label":F,context:H,isDisabled:i&&k(i,d),isMulti:S,isSearchable:T,tabSelectsValue:U,isInitialFocus:Y})}return W},[F,i,a,S,k,T,P,$,d,U,Y]),te=_t(w.Fragment,null,_t("span",{id:"aria-selection"},B),_t("span",{id:"aria-focused"},R),_t("span",{id:"aria-results"},V),_t("span",{id:"aria-guidance"},ie));return _t(w.Fragment,null,_t(sN,{id:u},Y&&te),_t(sN,{"aria-live":z,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!Y&&te))},uL=cL,a1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],dL=new RegExp("["+a1.map(function(e){return e.letters}).join("")+"]","g"),zk={};for(var Zv=0;Zv<a1.length;Zv++)for(var e0=a1[Zv],t0=0;t0<e0.letters.length;t0++)zk[e0.letters[t0]]=e0.base;var Uk=function(n){return n.replace(dL,function(t){return zk[t]})},fL=aL(Uk),oN=function(n){return n.replace(/^\s+|\s+$/g,"")},hL=function(n){return"".concat(n.label," ").concat(n.value)},pL=function(n){return function(t,i){if(t.data.__isNew__)return!0;var a=Dt({ignoreCase:!0,ignoreAccents:!0,stringify:hL,trim:!0,matchFrom:"any"},n),o=a.ignoreCase,l=a.ignoreAccents,d=a.stringify,f=a.trim,u=a.matchFrom,p=f?oN(i):i,g=f?oN(d(t)):d(t);return o&&(p=p.toLowerCase(),g=g.toLowerCase()),l&&(p=fL(p),g=Uk(g)),u==="start"?g.substr(0,p.length)===p:g.indexOf(p)>-1}},mL=["innerRef"];function gL(e){var n=e.innerRef,t=Ul(e,mL),i=B4(t,"onExited","in","enter","exit","appear");return _t("input",Lt({ref:n},i,{css:dw({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var yL=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function xL(e){var n=e.isEnabled,t=e.onBottomArrive,i=e.onBottomLeave,a=e.onTopArrive,o=e.onTopLeave,l=w.useRef(!1),d=w.useRef(!1),f=w.useRef(0),u=w.useRef(null),p=w.useCallback(function(T,P){if(u.current!==null){var M=u.current,I=M.scrollTop,U=M.scrollHeight,L=M.clientHeight,F=u.current,z=P>0,$=U-L-I,B=!1;$>P&&l.current&&(i&&i(T),l.current=!1),z&&d.current&&(o&&o(T),d.current=!1),z&&P>$?(t&&!l.current&&t(T),F.scrollTop=U,B=!0,l.current=!0):!z&&-P>I&&(a&&!d.current&&a(T),F.scrollTop=0,B=!0,d.current=!0),B&&yL(T)}},[t,i,a,o]),g=w.useCallback(function(T){p(T,T.deltaY)},[p]),b=w.useCallback(function(T){f.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var P=f.current-T.changedTouches[0].clientY;p(T,P)},[p]),S=w.useCallback(function(T){if(T){var P=$4?{passive:!1}:!1;T.addEventListener("wheel",g,P),T.addEventListener("touchstart",b,P),T.addEventListener("touchmove",v,P)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=u.current;return S(T),function(){k(T)}}},[n,S,k]),function(T){u.current=T}}var lN=["boxSizing","height","overflow","paddingRight","position"],cN={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function uN(e){e.cancelable&&e.preventDefault()}function dN(e){e.stopPropagation()}function fN(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function hN(){return"ontouchstart"in window||navigator.maxTouchPoints}var pN=!!(typeof window<"u"&&window.document&&window.document.createElement),Cm=0,ph={capture:!1,passive:!1};function bL(e){var n=e.isEnabled,t=e.accountForScrollbars,i=t===void 0?!0:t,a=w.useRef({}),o=w.useRef(null),l=w.useCallback(function(f){if(pN){var u=document.body,p=u&&u.style;if(i&&lN.forEach(function(S){var k=p&&p[S];a.current[S]=k}),i&&Cm<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(cN).forEach(function(S){var k=cN[S];p&&(p[S]=k)}),p&&(p.paddingRight="".concat(v,"px"))}u&&hN()&&(u.addEventListener("touchmove",uN,ph),f&&(f.addEventListener("touchstart",fN,ph),f.addEventListener("touchmove",dN,ph))),Cm+=1}},[i]),d=w.useCallback(function(f){if(pN){var u=document.body,p=u&&u.style;Cm=Math.max(Cm-1,0),i&&Cm<1&&lN.forEach(function(g){var b=a.current[g];p&&(p[g]=b)}),u&&hN()&&(u.removeEventListener("touchmove",uN,ph),f&&(f.removeEventListener("touchstart",fN,ph),f.removeEventListener("touchmove",dN,ph)))}},[i]);return w.useEffect(function(){if(n){var f=o.current;return l(f),function(){d(f)}}},[n,l,d]),function(f){o.current=f}}var vL=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},wL={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function SL(e){var n=e.children,t=e.lockEnabled,i=e.captureEnabled,a=i===void 0?!0:i,o=e.onBottomArrive,l=e.onBottomLeave,d=e.onTopArrive,f=e.onTopLeave,u=xL({isEnabled:a,onBottomArrive:o,onBottomLeave:l,onTopArrive:d,onTopLeave:f}),p=bL({isEnabled:t}),g=function(v){u(v),p(v)};return _t(w.Fragment,null,t&&_t("div",{onClick:vL,css:wL}),n(g))}var NL={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},CL=function(n){var t=n.name,i=n.onFocus;return _t("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:i,css:NL,value:"",onChange:function(){}})},jL=CL;function gw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function _L(){return gw(/^iPhone/i)}function Bk(){return gw(/^Mac/i)}function kL(){return gw(/^iPad/i)||Bk()&&navigator.maxTouchPoints>1}function TL(){return _L()||kL()}function EL(){return Bk()||TL()}var AL=function(n){return n.label},PL=function(n){return n.label},DL=function(n){return n.value},IL=function(n){return!!n.isDisabled},RL={clearIndicator:gO,container:aO,control:NO,dropdownIndicator:pO,group:kO,groupHeading:EO,indicatorsContainer:cO,indicatorSeparator:xO,input:IO,loadingIndicator:wO,loadingMessage:eO,menu:Y4,menuList:K4,menuPortal:iO,multiValue:FO,multiValueLabel:$O,multiValueRemove:zO,noOptionsMessage:Z4,option:GO,placeholder:QO,singleValue:XO,valueContainer:oO},ML={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},OL=4,qk=4,LL=38,FL=qk*2,$L={baseUnit:qk,controlHeight:LL,menuGutter:FL},n0={borderRadius:OL,colors:ML,spacing:$L},zL={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:iN(),captureMenuScroll:!iN(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:pL(),formatGroupLabel:AL,getOptionLabel:PL,getOptionValue:DL,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:IL,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!L4(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function mN(e,n,t,i){var a=Gk(e,n,t),o=Yk(e,n,t),l=Hk(e,n),d=rb(e,n);return{type:"option",data:n,isDisabled:a,isSelected:o,label:l,value:d,index:i}}function Lx(e,n){return e.options.map(function(t,i){if("options"in t){var a=t.options.map(function(l,d){return mN(e,l,n,d)}).filter(function(l){return yN(e,l)});return a.length>0?{type:"group",data:t,options:a,index:i}:void 0}var o=mN(e,t,n,i);return yN(e,o)?o:void 0}).filter(z4)}function Vk(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,sw(t.options.map(function(i){return i.data}))):n.push(t.data),n},[])}function gN(e,n){return e.reduce(function(t,i){return i.type==="group"?t.push.apply(t,sw(i.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(i.index,"-").concat(a.index)}}))):t.push({data:i.data,id:"".concat(n,"-").concat(i.index)}),t},[])}function UL(e,n){return Vk(Lx(e,n))}function yN(e,n){var t=e.inputValue,i=t===void 0?"":t,a=n.data,o=n.isSelected,l=n.label,d=n.value;return(!Qk(e)||!o)&&Wk(e,{label:l,value:d,data:a},i)}function BL(e,n){var t=e.focusedValue,i=e.selectValue,a=i.indexOf(t);if(a>-1){var o=n.indexOf(t);if(o>-1)return t;if(a<n.length)return n[a]}return null}function qL(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var i0=function(n,t){var i,a=(i=n.find(function(o){return o.data===t}))===null||i===void 0?void 0:i.id;return a||null},Hk=function(n,t){return n.getOptionLabel(t)},rb=function(n,t){return n.getOptionValue(t)};function Gk(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function Yk(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var i=rb(e,n);return t.some(function(a){return rb(e,a)===i})}function Wk(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var Qk=function(n){var t=n.hideSelectedOptions,i=n.isMulti;return t===void 0?i:t},VL=1,Jk=function(e){uM(t,e);var n=hM(t);function t(i){var a;if(lM(this,t),a=n.call(this,i),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(f){a.controlRef=f},a.focusedOptionRef=null,a.getFocusedOptionRef=function(f){a.focusedOptionRef=f},a.menuListRef=null,a.getMenuListRef=function(f){a.menuListRef=f},a.inputRef=null,a.getInputRef=function(f){a.inputRef=f},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(f,u){var p=a.props,g=p.onChange,b=p.name;u.name=b,a.ariaOnChange(f,u),g(f,u)},a.setValue=function(f,u,p){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(f,{action:u,option:p})},a.selectOption=function(f){var u=a.props,p=u.blurInputOnSelect,g=u.isMulti,b=u.name,v=a.state.selectValue,S=g&&a.isOptionSelected(f,v),k=a.isOptionDisabled(f,v);if(S){var T=a.getOptionValue(f);a.setValue(v.filter(function(P){return a.getOptionValue(P)!==T}),"deselect-option",f)}else if(!k)g?a.setValue([].concat(sw(v),[f]),"select-option",f):a.setValue(f,"select-option");else{a.ariaOnChange(f,{action:"select-option",option:f,name:b});return}p&&a.blurInput()},a.removeValue=function(f){var u=a.props.isMulti,p=a.state.selectValue,g=a.getOptionValue(f),b=p.filter(function(S){return a.getOptionValue(S)!==g}),v=mx(u,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:f}),a.focusInput()},a.clearValue=function(){var f=a.state.selectValue;a.onChange(mx(a.props.isMulti,[],null),{action:"clear",removedValues:f})},a.popValue=function(){var f=a.props.isMulti,u=a.state.selectValue,p=u[u.length-1],g=u.slice(0,u.length-1),b=mx(f,g,g[0]||null);p&&a.onChange(b,{action:"pop-value",removedValue:p})},a.getFocusedOptionId=function(f){return i0(a.state.focusableOptionsWithIds,f)},a.getFocusableOptionsWithIds=function(){return gN(Lx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var f=arguments.length,u=new Array(f),p=0;p<f;p++)u[p]=arguments[p];return D4.apply(void 0,[a.props.classNamePrefix].concat(u))},a.getOptionLabel=function(f){return Hk(a.props,f)},a.getOptionValue=function(f){return rb(a.props,f)},a.getStyles=function(f,u){var p=a.props.unstyled,g=RL[f](u,p);g.boxSizing="border-box";var b=a.props.styles[f];return b?b(g,u):g},a.getClassNames=function(f,u){var p,g;return(p=(g=a.props.classNames)[f])===null||p===void 0?void 0:p.call(g,u)},a.getElementId=function(f){return"".concat(a.state.instancePrefix,"-").concat(f)},a.getComponents=function(){return nL(a.props)},a.buildCategorizedOptions=function(){return Lx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return Vk(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(f,u){a.setState({ariaSelection:Dt({value:f},u)})},a.onMenuMouseDown=function(f){f.button===0&&(f.stopPropagation(),f.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(f){a.blockOptionHover=!1},a.onControlMouseDown=function(f){if(!f.defaultPrevented){var u=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&a.onMenuClose():u&&a.openMenu("first"):(u&&(a.openAfterFocus=!0),a.focusInput()),f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&f.preventDefault()}},a.onDropdownIndicatorMouseDown=function(f){if(!(f&&f.type==="mousedown"&&f.button!==0)&&!a.props.isDisabled){var u=a.props,p=u.isMulti,g=u.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!p}),a.onMenuClose()):a.openMenu("first"),f.preventDefault()}},a.onClearIndicatorMouseDown=function(f){f&&f.type==="mousedown"&&f.button!==0||(a.clearValue(),f.preventDefault(),a.openAfterFocus=!1,f.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(f){typeof a.props.closeMenuOnScroll=="boolean"?f.target instanceof HTMLElement&&kb(f.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(f)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(f){var u=f.touches,p=u&&u.item(0);p&&(a.initialTouchX=p.clientX,a.initialTouchY=p.clientY,a.userIsDragging=!1)},a.onTouchMove=function(f){var u=f.touches,p=u&&u.item(0);if(p){var g=Math.abs(p.clientX-a.initialTouchX),b=Math.abs(p.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(f){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(f.target)&&a.menuListRef&&!a.menuListRef.contains(f.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(f){a.userIsDragging||a.onControlMouseDown(f)},a.onClearIndicatorTouchEnd=function(f){a.userIsDragging||a.onClearIndicatorMouseDown(f)},a.onDropdownIndicatorTouchEnd=function(f){a.userIsDragging||a.onDropdownIndicatorMouseDown(f)},a.handleInputChange=function(f){var u=a.props.inputValue,p=f.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(p,{action:"input-change",prevInputValue:u}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(f){a.props.onFocus&&a.props.onFocus(f),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(f){var u=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(f),a.onInputChange("",{action:"input-blur",prevInputValue:u}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(f){if(!(a.blockOptionHover||a.state.focusedOption===f)){var u=a.getFocusableOptions(),p=u.indexOf(f);a.setState({focusedOption:f,focusedOptionId:p>-1?a.getFocusedOptionId(f):null})}},a.shouldHideSelectedOptions=function(){return Qk(a.props)},a.onValueInputFocus=function(f){f.preventDefault(),f.stopPropagation(),a.focus()},a.onKeyDown=function(f){var u=a.props,p=u.isMulti,g=u.backspaceRemovesValue,b=u.escapeClearsValue,v=u.inputValue,S=u.isClearable,k=u.isDisabled,T=u.menuIsOpen,P=u.onKeyDown,M=u.tabSelectsValue,I=u.openMenuOnFocus,U=a.state,L=U.focusedOption,F=U.focusedValue,z=U.selectValue;if(!k&&!(typeof P=="function"&&(P(f),f.defaultPrevented))){switch(a.blockOptionHover=!0,f.key){case"ArrowLeft":if(!p||v)return;a.focusValue("previous");break;case"ArrowRight":if(!p||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if(F)a.removeValue(F);else{if(!g)return;p?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||f.shiftKey||!T||!M||!L||I&&a.isOptionSelected(L,z))return;a.selectOption(L);break;case"Enter":if(f.keyCode===229)break;if(T){if(!L||a.isComposing)return;a.selectOption(L);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!L)return;a.selectOption(L);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}f.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++VL),a.state.selectValue=tN(i.value),i.menuIsOpen&&a.state.selectValue.length){var o=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),d=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=o,a.state.focusedOption=l[d],a.state.focusedOptionId=i0(o,l[d])}return a}return cM(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&nN(this.menuListRef,this.focusedOptionRef),EL()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var o=this.props,l=o.isDisabled,d=o.menuIsOpen,f=this.state.isFocused;(f&&!l&&a.isDisabled||f&&d&&!a.menuIsOpen)&&this.focusInput(),f&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!f&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(nN(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,o){this.props.onInputChange(a,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var o=this,l=this.state,d=l.selectValue,f=l.isFocused,u=this.buildFocusableOptions(),p=a==="first"?0:u.length-1;if(!this.props.isMulti){var g=u.indexOf(d[0]);g>-1&&(p=g)}this.scrollToFocusedOptionOnUpdate=!(f&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[p],focusedOptionId:this.getFocusedOptionId(u[p])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(a){var o=this.state,l=o.selectValue,d=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var f=l.indexOf(d);d||(f=-1);var u=l.length-1,p=-1;if(l.length){switch(a){case"previous":f===0?p=0:f===-1?p=u:p=f-1;break;case"next":f>-1&&f<u&&(p=f+1);break}this.setState({inputIsHidden:p!==-1,focusedValue:l[p]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,d=this.getFocusableOptions();if(d.length){var f=0,u=d.indexOf(l);l||(u=-1),a==="up"?f=u>0?u-1:d.length-1:a==="down"?f=(u+1)%d.length:a==="pageup"?(f=u-o,f<0&&(f=0)):a==="pagedown"?(f=u+o,f>d.length-1&&(f=d.length-1)):a==="last"&&(f=d.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:d[f],focusedValue:null,focusedOptionId:this.getFocusedOptionId(d[f])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(n0):Dt(Dt({},n0),this.props.theme):n0}},{key:"getCommonProps",value:function(){var a=this.clearValue,o=this.cx,l=this.getStyles,d=this.getClassNames,f=this.getValue,u=this.selectOption,p=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:o,getStyles:l,getClassNames:d,getValue:f,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:u,selectProps:g,setValue:p,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,o=a.isClearable,l=a.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(a,o){return Gk(this.props,a,o)}},{key:"isOptionSelected",value:function(a,o){return Yk(this.props,a,o)}},{key:"filterOption",value:function(a,o){return Wk(this.props,a,o)}},{key:"formatOptionLabel",value:function(a,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,d=this.state.selectValue;return this.props.formatOptionLabel(a,{context:o,inputValue:l,selectValue:d})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,o=a.isDisabled,l=a.isSearchable,d=a.inputId,f=a.inputValue,u=a.tabIndex,p=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,T=k.inputIsHidden,P=k.ariaSelection,M=this.commonProps,I=d||this.getElementId("input"),U=Dt(Dt(Dt({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(P==null?void 0:P.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,Lt({},M,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:I,innerRef:this.getInputRef,isDisabled:o,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:p,type:"text",value:f},U)):w.createElement(gL,Lt({id:I,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:nb,onFocus:this.onInputFocus,disabled:o,tabIndex:u,inputMode:"none",form:p,value:""},U))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,o=this.getComponents(),l=o.MultiValue,d=o.MultiValueContainer,f=o.MultiValueLabel,u=o.MultiValueRemove,p=o.SingleValue,g=o.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,P=v.inputValue,M=v.placeholder,I=this.state,U=I.selectValue,L=I.focusedValue,F=I.isFocused;if(!this.hasValue()||!S)return P?null:w.createElement(g,Lt({},b,{key:"placeholder",isDisabled:k,isFocused:F,innerProps:{id:this.getElementId("placeholder")}}),M);if(T)return U.map(function($,B){var R=$===L,V="".concat(a.getOptionLabel($),"-").concat(a.getOptionValue($));return w.createElement(l,Lt({},b,{components:{Container:d,Label:f,Remove:u},isFocused:R,isDisabled:k,key:V,index:B,removeProps:{onClick:function(){return a.removeValue($)},onTouchEnd:function(){return a.removeValue($)},onMouseDown:function(ie){ie.preventDefault()}},data:$}),a.formatOptionLabel($,"value"))});if(P)return null;var z=U[0];return w.createElement(p,Lt({},b,{data:z,isDisabled:k}),this.formatOptionLabel(z,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),o=a.ClearIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,p=this.state.isFocused;if(!this.isClearable()||!o||f||!this.hasValue()||u)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Lt({},l,{innerProps:g,isFocused:p}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),o=a.LoadingIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,p=this.state.isFocused;if(!o||!u)return null;var g={"aria-hidden":"true"};return w.createElement(o,Lt({},l,{innerProps:g,isDisabled:f,isFocused:p}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator,l=a.IndicatorSeparator;if(!o||!l)return null;var d=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused;return w.createElement(l,Lt({},d,{isDisabled:f,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator;if(!o)return null;var l=this.commonProps,d=this.props.isDisabled,f=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Lt({},l,{innerProps:u,isDisabled:d,isFocused:f}))}},{key:"renderMenu",value:function(){var a=this,o=this.getComponents(),l=o.Group,d=o.GroupHeading,f=o.Menu,u=o.MenuList,p=o.MenuPortal,g=o.LoadingMessage,b=o.NoOptionsMessage,v=o.Option,S=this.commonProps,k=this.state.focusedOption,T=this.props,P=T.captureMenuScroll,M=T.inputValue,I=T.isLoading,U=T.loadingMessage,L=T.minMenuHeight,F=T.maxMenuHeight,z=T.menuIsOpen,$=T.menuPlacement,B=T.menuPosition,R=T.menuPortalTarget,V=T.menuShouldBlockScroll,Y=T.menuShouldScrollIntoView,ie=T.noOptionsMessage,te=T.onMenuScrollToTop,W=T.onMenuScrollToBottom;if(!z)return null;var H=function(D,se){var be=D.type,ee=D.data,ce=D.isDisabled,re=D.isSelected,Pe=D.label,Qe=D.value,Se=k===ee,Ne=ce?void 0:function(){return a.onOptionHover(ee)},De=ce?void 0:function(){return a.selectOption(ee)},Me="".concat(a.getElementId("option"),"-").concat(se),nt={id:Me,onClick:De,onMouseMove:Ne,onMouseOver:Ne,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:re};return w.createElement(v,Lt({},S,{innerProps:nt,data:ee,isDisabled:ce,isSelected:re,key:Me,label:Pe,type:be,value:Qe,isFocused:Se,innerRef:Se?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(D.data,"menu"))},Q;if(this.hasOptions())Q=this.getCategorizedOptions().map(function(ue){if(ue.type==="group"){var D=ue.data,se=ue.options,be=ue.index,ee="".concat(a.getElementId("group"),"-").concat(be),ce="".concat(ee,"-heading");return w.createElement(l,Lt({},S,{key:ee,data:D,options:se,Heading:d,headingProps:{id:ce,data:ue.data},label:a.formatGroupLabel(ue.data)}),ue.options.map(function(re){return H(re,"".concat(be,"-").concat(re.index))}))}else if(ue.type==="option")return H(ue,"".concat(ue.index))});else if(I){var J=U({inputValue:M});if(J===null)return null;Q=w.createElement(g,S,J)}else{var fe=ie({inputValue:M});if(fe===null)return null;Q=w.createElement(b,S,fe)}var A={minMenuHeight:L,maxMenuHeight:F,menuPlacement:$,menuPosition:B,menuShouldScrollIntoView:Y},oe=w.createElement(W4,Lt({},S,A),function(ue){var D=ue.ref,se=ue.placerProps,be=se.placement,ee=se.maxHeight;return w.createElement(f,Lt({},S,A,{innerRef:D,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:I,placement:be}),w.createElement(SL,{captureEnabled:P,onTopArrive:te,onBottomArrive:W,lockEnabled:V},function(ce){return w.createElement(u,Lt({},S,{innerRef:function(Pe){a.getMenuListRef(Pe),ce(Pe)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:I,maxHeight:ee,focusedOption:k}),Q)}))});return R||B==="fixed"?w.createElement(p,Lt({},S,{appendTo:R,controlElement:this.controlRef,menuPlacement:$,menuPosition:B}),oe):oe}},{key:"renderFormField",value:function(){var a=this,o=this.props,l=o.delimiter,d=o.isDisabled,f=o.isMulti,u=o.name,p=o.required,g=this.state.selectValue;if(p&&!this.hasValue()&&!d)return w.createElement(jL,{name:u,onFocus:this.onValueInputFocus});if(!(!u||d))if(f)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:u,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:u,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:u,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:u,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,o=this.state,l=o.ariaSelection,d=o.focusedOption,f=o.focusedValue,u=o.isFocused,p=o.selectValue,g=this.getFocusableOptions();return w.createElement(uL,Lt({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:d,focusedValue:f,isFocused:u,selectValue:p,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),o=a.Control,l=a.IndicatorsContainer,d=a.SelectContainer,f=a.ValueContainer,u=this.props,p=u.className,g=u.id,b=u.isDisabled,v=u.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(d,Lt({},k,{className:p,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(o,Lt({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(f,Lt({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,Lt({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,o){var l=o.prevProps,d=o.clearFocusValueOnUpdate,f=o.inputIsHiddenAfterUpdate,u=o.ariaSelection,p=o.isFocused,g=o.prevWasFocused,b=o.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,T=a.inputValue,P=a.isMulti,M=tN(S),I={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||T!==l.inputValue)){var U=k?UL(a,M):[],L=k?gN(Lx(a,M),"".concat(b,"-option")):[],F=d?BL(o,M):null,z=qL(o,U),$=i0(L,z);I={selectValue:M,focusedOption:z,focusedOptionId:$,focusableOptionsWithIds:L,focusedValue:F,clearFocusValueOnUpdate:!1}}var B=f!=null&&a!==l?{inputIsHidden:f,inputIsHiddenAfterUpdate:void 0}:{},R=u,V=p&&g;return p&&!V&&(R={value:mx(P,M,M[0]||null),options:M,action:"initial-input-focus"},V=!g),(u==null?void 0:u.action)==="initial-input-focus"&&(R=null),Dt(Dt(Dt({},I),B),{},{prevProps:a,ariaSelection:R,prevWasFocused:V})}}]),t}(w.Component);Jk.defaultProps=zL;var HL=w.forwardRef(function(e,n){var t=oM(e);return w.createElement(Jk,Lt({ref:n},t))}),Kk=HL;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let GL,YL;function WL(){return{geminiUrl:GL,vertexUrl:YL}}function QL(e,n,t){var i,a,o;if(!(!((i=e.httpOptions)===null||i===void 0)&&i.baseUrl)){const l=WL();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(o=l.geminiUrl)!==null&&o!==void 0?o:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sg{}function zt(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(i,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const o=n[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function j(e,n,t){for(let o=0;o<n.length-1;o++){const l=n[o];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in e))if(Array.isArray(t))e[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[d])){const f=e[d];if(Array.isArray(t))for(let u=0;u<f.length;u++){const p=f[u];j(p,n.slice(o+1),t[u])}else for(const u of f)j(u,n.slice(o+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in e||(e[d]=[{}]);const f=e[d];j(f[0],n.slice(o+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const i=n[n.length-1],a=e[i];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else e[i]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const i=n[t];if(i.endsWith("[]")){const a=i.slice(0,-2);if(a in e){const o=e[a];return Array.isArray(o)?o.map(l=>C(l,n.slice(t+1))):void 0}else return}else e=e[i]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fi(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function Xk(e,n){const t=fi(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function Zk(e,n){return Array.isArray(n)?n.map(t=>ab(e,t)):[ab(e,n)]}function ab(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function JL(e,n){const t=ab(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function KL(e,n){const t=ab(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function xN(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function eT(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>xN(e,t)):[xN(e,n)]}function s1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function bN(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function vN(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function ua(e,n){if(n==null)throw new Error("ContentUnion is required");return s1(n)?n:{role:"user",parts:eT(e,n)}}function tT(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const i=ua(e,t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(e.isVertexAI()){const t=ua(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>ua(e,t)):[ua(e,n)]}function ru(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(bN(n)||vN(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ua(e,n)]}const t=[],i=[],a=s1(n[0]);for(const o of n){const l=s1(o);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(o);else{if(bN(o)||vN(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");i.push(o)}}return a||t.push({role:"user",parts:eT(e,i)}),t}function nT(e,n){return n}function iT(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Tb(e,n){return n}function Eb(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function XL(e,n,t,i=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===i;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function au(e,n){if(typeof n!="string")throw new Error("name must be a string");return XL(e,n,"cachedContents")}function rT(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function su(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function ZL(e){return e!=null&&typeof e=="object"&&"name"in e}function e3(e){return e!=null&&typeof e=="object"&&"video"in e}function t3(e){return e!=null&&typeof e=="object"&&"uri"in e}function aT(e,n){var t;let i;if(ZL(n)&&(i=n.name),!(t3(n)&&(i=n.uri,i===void 0))&&!(e3(n)&&(i=(t=n.video)===null||t===void 0?void 0:t.uri,i===void 0))){if(typeof n=="string"&&(i=n),i===void 0)throw new Error("Could not extract file name from the provided input.");if(i.startsWith("https://")){const o=i.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${i}`);i=o[0]}else i.startsWith("files/")&&(i=i.split("files/")[1]);return i}}function sT(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function oT(e,n){for(const t of["models","tunedModels","publisherModels"])if(n3(n,t))return n[t];return[]}function n3(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function i3(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function r3(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],i3(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function wN(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>r3(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function a3(){return{}}function s3(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function o3(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],s3(e,i)),t}function l3(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],a3());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],o3(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&j(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function c3(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function u3(e,n){const t={},i=C(n,["functionCallingConfig"]);if(i!=null&&j(t,["functionCallingConfig"],c3(e,i)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function d3(e,n,t){const i={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&j(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=ru(e,d);Array.isArray(g)&&(g=g.map(b=>wN(e,b))),j(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&j(t,["systemInstruction"],wN(e,ua(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>l3(e,b))),j(t,["tools"],g)}const p=C(n,["toolConfig"]);return t!==void 0&&p!=null&&j(t,["toolConfig"],u3(e,p)),i}function f3(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["model"],Xk(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],d3(e,a,t)),t}function h3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],au(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function p3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],au(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function m3(e,n,t){const i={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&j(t,["expireTime"],o),i}function g3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],au(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],m3(e,a,t)),t}function y3(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&j(t,["_query","pageToken"],o),i}function x3(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],y3(e,i,t)),t}function b3(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function v3(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],b3(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function SN(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>v3(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function w3(){return{}}function S3(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function N3(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],S3(e,i)),t}function C3(){return{}}function j3(e,n){const t={},i=C(n,["apiKeyString"]);return i!=null&&j(t,["apiKeyString"],i),t}function _3(e,n){const t={},i=C(n,["apiKeyConfig"]);i!=null&&j(t,["apiKeyConfig"],j3(e,i));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&j(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&j(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&j(t,["oidcConfig"],f),t}function k3(e,n){const t={},i=C(n,["authConfig"]);return i!=null&&j(t,["authConfig"],_3(e,i)),t}function T3(e,n){const t={},i=C(n,["retrieval"]);i!=null&&j(t,["retrieval"],i),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],w3());const o=C(n,["googleSearchRetrieval"]);o!=null&&j(t,["googleSearchRetrieval"],N3(e,o)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],C3());const d=C(n,["googleMaps"]);d!=null&&j(t,["googleMaps"],k3(e,d));const f=C(n,["codeExecution"]);f!=null&&j(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function E3(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function A3(e,n){const t={},i=C(n,["latitude"]);i!=null&&j(t,["latitude"],i);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function P3(e,n){const t={},i=C(n,["latLng"]);return i!=null&&j(t,["latLng"],A3(e,i)),t}function D3(e,n){const t={},i=C(n,["functionCallingConfig"]);i!=null&&j(t,["functionCallingConfig"],E3(e,i));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],P3(e,a)),t}function I3(e,n,t){const i={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&j(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=ru(e,d);Array.isArray(g)&&(g=g.map(b=>SN(e,b))),j(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&j(t,["systemInstruction"],SN(e,ua(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>T3(e,b))),j(t,["tools"],g)}const p=C(n,["toolConfig"]);return t!==void 0&&p!=null&&j(t,["toolConfig"],D3(e,p)),i}function R3(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["model"],Xk(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],I3(e,a,t)),t}function M3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],au(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function O3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],au(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function L3(e,n,t){const i={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&j(t,["expireTime"],o),i}function F3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],au(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],L3(e,a,t)),t}function $3(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&j(t,["_query","pageToken"],o),i}function z3(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],$3(e,i,t)),t}function Fx(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["model"]);o!=null&&j(t,["model"],o);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&j(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function U3(){return{}}function B3(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Fx(e,l))),j(t,["cachedContents"],o)}return t}function $x(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["model"]);o!=null&&j(t,["model"],o);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&j(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function q3(){return{}}function V3(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>$x(e,l))),j(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Mh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Mh||(Mh={}));class Ab{constructor(n,t,i,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,i,a)}init(n,t,i){var a,o;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};i?typeof i=="object"?l=Object.assign({},i):l=i:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var NN;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(NN||(NN={}));var CN;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(CN||(CN={}));var jN;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(jN||(jN={}));var _N;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(_N||(_N={}));var kN;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(kN||(kN={}));var TN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(TN||(TN={}));var EN;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(EN||(EN={}));var Oh;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Oh||(Oh={}));var AN;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(AN||(AN={}));var PN;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(PN||(PN={}));var DN;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(DN||(DN={}));var IN;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(IN||(IN={}));var RN;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(RN||(RN={}));var nu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(nu||(nu={}));var MN;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(MN||(MN={}));var o1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(o1||(o1={}));var ON;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ON||(ON={}));var LN;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(LN||(LN={}));var FN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(FN||(FN={}));var $N;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})($N||($N={}));var zN;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(zN||(zN={}));var UN;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(UN||(UN={}));var BN;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(BN||(BN={}));var qN;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(qN||(qN={}));var VN;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(VN||(VN={}));var HN;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(HN||(HN={}));var GN;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(GN||(GN={}));var YN;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(YN||(YN={}));var WN;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(WN||(WN={}));var QN;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(QN||(QN={}));var JN;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(JN||(JN={}));var KN;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(KN||(KN={}));var XN;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(XN||(XN={}));var ZN;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ZN||(ZN={}));class gx{get text(){var n,t,i,a,o,l,d,f;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",p=!1;const g=[];for(const b of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;p=!0,u+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?u:void 0}get data(){var n,t,i,a,o,l,d,f;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const p=[];for(const g of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&p.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(u+=atob(g.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var n,t,i,a,o,l,d,f;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var n,t,i,a,o,l,d,f,u;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var n,t,i,a,o,l,d,f,u;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.output}}class eC{}class tC{}class H3{}class G3{}class nC{}class iC{}class rC{}class Y3{}class aC{}class sC{}class oC{}class W3{}class l1{constructor(n){const t={};for(const i of n.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class Q3{}class J3{}class K3{get text(){var n,t,i;let a="",o=!1;const l=[];for(const d of(i=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,u]of Object.entries(d))f!=="text"&&f!=="thought"&&u!==null&&l.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;o=!0,a+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var n,t,i;let a="";const o=[];for(const l of(i=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,f]of Object.entries(l))d!=="inlineData"&&f!==null&&o.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class X3 extends sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Ab(Mh.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=R3(this.apiClient,n);return d=zt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>$x(this.apiClient,p))}else{const u=f3(this.apiClient,n);return d=zt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Fx(this.apiClient,p))}}async get(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=M3(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>$x(this.apiClient,p))}else{const u=h3(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Fx(this.apiClient,p))}}async delete(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=O3(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(()=>{const p=q3(),g=new sC;return Object.assign(g,p),g})}else{const u=p3(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(()=>{const p=U3(),g=new sC;return Object.assign(g,p),g})}}async update(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=F3(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>$x(this.apiClient,p))}else{const u=g3(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Fx(this.apiClient,p))}}async listInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=z3(this.apiClient,n);return d=zt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=V3(this.apiClient,p),b=new oC;return Object.assign(b,g),b})}else{const u=x3(this.apiClient,n);return d=zt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=B3(this.apiClient,p),b=new oC;return Object.assign(b,g),b})}}}function lC(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ar(e){return this instanceof Ar?(this.v=e,this):new Ar(e)}function sb(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(e,n||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function d(v,S){i[v]&&(a[v]=function(k){return new Promise(function(T,P){o.push([v,k,T,P])>1||f(v,k)})},S&&(a[v]=S(a[v])))}function f(v,S){try{u(i[v](S))}catch(k){b(o[0][3],k)}}function u(v){v.value instanceof Ar?Promise.resolve(v.value.v).then(p,g):b(o[0][2],v)}function p(v){f("next",v)}function g(v){f("throw",v)}function b(v,S){v(S),o.shift(),o.length&&f(o[0][0],o[0][1])}}function c1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof lC=="function"?lC(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=e[o]&&function(l){return new Promise(function(d,f){l=e[o](l),a(d,f,l.done,l.value)})}}function a(o,l,d,f){Promise.resolve(f).then(function(u){o({value:u,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Z3(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:lT(t)}function lT(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function eF(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function tF(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let i=0,a=e[0];for(;i<t;)if(e[i].role==="user")a=e[i],i++;else{const o=[];let l=!0;for(;i<t&&e[i].role==="model";)o.push(e[i]),l&&!lT(e[i])&&(l=!1),i++;l&&(n.push(a),n.push(...o))}return n}class nF{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new iF(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class iF{constructor(n,t,i,a={},o=[]){this.apiClient=n,this.modelsModule=t,this.model=i,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),eF(o)}async sendMessage(n){var t;await this.sendPromise;const i=ua(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l;const f=(l=(o=(await a).candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,u=f?[f]:[];this.recordHistory(i,u)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const i=ua(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,i)}getHistory(n=!1){return n?tF(this.history):this.history}processStreamResponse(n,t){var i,a;return sb(this,arguments,function*(){var l,d,f,u;const p=[];try{for(var g=!0,b=c1(n),v;v=yield Ar(b.next()),l=v.done,!l;g=!0){u=v.value,g=!1;const S=u;if(Z3(S)){const k=(a=(i=S.candidates)===null||i===void 0?void 0:i[0])===null||a===void 0?void 0:a.content;k!==void 0&&p.push(k)}yield yield Ar(S)}}catch(S){d={error:S}}finally{try{!g&&!l&&(f=b.return)&&(yield Ar(f.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,p)})}recordHistory(n,t){let i=[];t.length>0&&t.every(a=>a.role==="model")?i=t:i.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rF(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&j(t,["_query","pageToken"],o),i}function aF(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],rF(e,i,t)),t}function sF(e,n){const t={},i=C(n,["details"]);i!=null&&j(t,["details"],i);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const o=C(n,["code"]);return o!=null&&j(t,["code"],o),t}function oF(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&j(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&j(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&j(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const p=C(n,["sha256Hash"]);p!=null&&j(t,["sha256Hash"],p);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&j(t,["error"],sF(e,T)),t}function lF(e,n){const t={},i=C(n,["file"]);i!=null&&j(t,["file"],oF(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function cF(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","file"],aT(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function uF(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","file"],aT(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function dF(e,n){const t={},i=C(n,["details"]);i!=null&&j(t,["details"],i);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const o=C(n,["code"]);return o!=null&&j(t,["code"],o),t}function u1(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&j(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&j(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&j(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const p=C(n,["sha256Hash"]);p!=null&&j(t,["sha256Hash"],p);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&j(t,["error"],dF(e,T)),t}function fF(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["files"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>u1(e,l))),j(t,["files"],o)}return t}function hF(){return{}}function pF(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mF extends sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Ab(Mh.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>u1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=aF(this.apiClient,n);return o=zt("files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>{const u=fF(this.apiClient,f),p=new W3;return Object.assign(p,u),p})}}async createInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=lF(this.apiClient,n);return o=zt("upload/v1beta/files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(()=>{const f=hF(),u=new Q3;return Object.assign(u,f),u})}}async get(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=cF(this.apiClient,n);return o=zt("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>u1(this.apiClient,f))}}async delete(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=uF(this.apiClient,n);return o=zt("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(()=>{const f=pF(),u=new J3;return Object.assign(u,f),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gF(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function yF(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function xF(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],gF(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function bF(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],yF(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function vF(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>xF(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function wF(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>bF(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function SF(){return{}}function NF(){return{}}function CF(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function jF(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function _F(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],CF(e,i)),t}function kF(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],jF(e,i)),t}function TF(){return{}}function EF(e,n){const t={},i=C(n,["apiKeyString"]);return i!=null&&j(t,["apiKeyString"],i),t}function AF(e,n){const t={},i=C(n,["apiKeyConfig"]);i!=null&&j(t,["apiKeyConfig"],EF(e,i));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&j(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&j(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&j(t,["oidcConfig"],f),t}function PF(e,n){const t={},i=C(n,["authConfig"]);return i!=null&&j(t,["authConfig"],AF(e,i)),t}function DF(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],SF());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],_F(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&j(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function IF(e,n){const t={},i=C(n,["retrieval"]);i!=null&&j(t,["retrieval"],i),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],NF());const o=C(n,["googleSearchRetrieval"]);o!=null&&j(t,["googleSearchRetrieval"],kF(e,o)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],TF());const d=C(n,["googleMaps"]);d!=null&&j(t,["googleMaps"],PF(e,d));const f=C(n,["codeExecution"]);f!=null&&j(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function RF(e,n){const t={},i=C(n,["handle"]);if(i!=null&&j(t,["handle"],i),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function MF(e,n){const t={},i=C(n,["handle"]);i!=null&&j(t,["handle"],i);const a=C(n,["transparent"]);return a!=null&&j(t,["transparent"],a),t}function cC(){return{}}function uC(){return{}}function OF(e,n){const t={},i=C(n,["disabled"]);i!=null&&j(t,["disabled"],i);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&j(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&j(t,["silenceDurationMs"],d),t}function LF(e,n){const t={},i=C(n,["disabled"]);i!=null&&j(t,["disabled"],i);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&j(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&j(t,["silenceDurationMs"],d),t}function FF(e,n){const t={},i=C(n,["automaticActivityDetection"]);i!=null&&j(t,["automaticActivityDetection"],OF(e,i));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&j(t,["turnCoverage"],o),t}function $F(e,n){const t={},i=C(n,["automaticActivityDetection"]);i!=null&&j(t,["automaticActivityDetection"],LF(e,i));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&j(t,["turnCoverage"],o),t}function zF(e,n){const t={},i=C(n,["targetTokens"]);return i!=null&&j(t,["targetTokens"],i),t}function UF(e,n){const t={},i=C(n,["targetTokens"]);return i!=null&&j(t,["targetTokens"],i),t}function BF(e,n){const t={},i=C(n,["triggerTokens"]);i!=null&&j(t,["triggerTokens"],i);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],zF(e,a)),t}function qF(e,n){const t={},i=C(n,["triggerTokens"]);i!=null&&j(t,["triggerTokens"],i);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],UF(e,a)),t}function VF(e,n,t){const i={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&j(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","maxOutputTokens"],u);const p=C(n,["mediaResolution"]);t!==void 0&&p!=null&&j(t,["setup","generationConfig","mediaResolution"],p);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],vF(e,ua(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let U=Eb(e,S);Array.isArray(U)&&(U=U.map(L=>DF(e,Tb(e,L)))),j(t,["setup","tools"],U)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],RF(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","inputAudioTranscription"],cC());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&j(t,["setup","outputAudioTranscription"],cC());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&j(t,["setup","realtimeInputConfig"],FF(e,M));const I=C(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&j(t,["setup","contextWindowCompression"],BF(e,I)),i}function HF(e,n,t){const i={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&j(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","maxOutputTokens"],u);const p=C(n,["mediaResolution"]);t!==void 0&&p!=null&&j(t,["setup","generationConfig","mediaResolution"],p);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],wF(e,ua(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let U=Eb(e,S);Array.isArray(U)&&(U=U.map(L=>IF(e,Tb(e,L)))),j(t,["setup","tools"],U)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],MF(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","inputAudioTranscription"],uC());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&j(t,["setup","outputAudioTranscription"],uC());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&j(t,["setup","realtimeInputConfig"],$F(e,M));const I=C(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&j(t,["setup","contextWindowCompression"],qF(e,I)),i}function GF(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["setup","model"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],VF(e,a,t)),t}function YF(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["setup","model"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],HF(e,a,t)),t}function WF(){return{}}function QF(){return{}}function JF(){return{}}function KF(){return{}}function XF(e,n){const t={},i=C(n,["media"]);i!=null&&j(t,["mediaChunks"],Zk(e,i));const a=C(n,["audio"]);a!=null&&j(t,["audio"],KL(e,a));const o=C(n,["audioStreamEnd"]);o!=null&&j(t,["audioStreamEnd"],o);const l=C(n,["video"]);l!=null&&j(t,["video"],JL(e,l));const d=C(n,["text"]);return d!=null&&j(t,["text"],d),C(n,["activityStart"])!=null&&j(t,["activityStart"],WF()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],JF()),t}function ZF(e,n){const t={},i=C(n,["media"]);if(i!=null&&j(t,["mediaChunks"],Zk(e,i)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&j(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&j(t,["activityStart"],QF()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],KF()),t}function e6(){return{}}function t6(){return{}}function n6(e,n){const t={},i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function i6(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function r6(e,n){const t={},i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],n6(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function a6(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],i6(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function s6(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>r6(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function o6(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>a6(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function dC(e,n){const t={},i=C(n,["text"]);i!=null&&j(t,["text"],i);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function fC(e,n){const t={},i=C(n,["text"]);i!=null&&j(t,["text"],i);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function l6(e,n){const t={},i=C(n,["modelTurn"]);i!=null&&j(t,["modelTurn"],s6(e,i));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&j(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&j(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&j(t,["inputTranscription"],dC(e,f));const u=C(n,["outputTranscription"]);return u!=null&&j(t,["outputTranscription"],dC(e,u)),t}function c6(e,n){const t={},i=C(n,["modelTurn"]);i!=null&&j(t,["modelTurn"],o6(e,i));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&j(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&j(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&j(t,["inputTranscription"],fC(e,f));const u=C(n,["outputTranscription"]);return u!=null&&j(t,["outputTranscription"],fC(e,u)),t}function u6(e,n){const t={},i=C(n,["id"]);i!=null&&j(t,["id"],i);const a=C(n,["args"]);a!=null&&j(t,["args"],a);const o=C(n,["name"]);return o!=null&&j(t,["name"],o),t}function d6(e,n){const t={},i=C(n,["args"]);i!=null&&j(t,["args"],i);const a=C(n,["name"]);return a!=null&&j(t,["name"],a),t}function f6(e,n){const t={},i=C(n,["functionCalls"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>u6(e,o))),j(t,["functionCalls"],a)}return t}function h6(e,n){const t={},i=C(n,["functionCalls"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>d6(e,o))),j(t,["functionCalls"],a)}return t}function p6(e,n){const t={},i=C(n,["ids"]);return i!=null&&j(t,["ids"],i),t}function m6(e,n){const t={},i=C(n,["ids"]);return i!=null&&j(t,["ids"],i),t}function yx(e,n){const t={},i=C(n,["modality"]);i!=null&&j(t,["modality"],i);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function xx(e,n){const t={},i=C(n,["modality"]);i!=null&&j(t,["modality"],i);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function g6(e,n){const t={},i=C(n,["promptTokenCount"]);i!=null&&j(t,["promptTokenCount"],i);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const o=C(n,["responseTokenCount"]);o!=null&&j(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&j(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&j(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(S=>yx(e,S))),j(t,["promptTokensDetails"],v)}const p=C(n,["cacheTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(S=>yx(e,S))),j(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>yx(e,S))),j(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>yx(e,S))),j(t,["toolUsePromptTokensDetails"],v)}return t}function y6(e,n){const t={},i=C(n,["promptTokenCount"]);i!=null&&j(t,["promptTokenCount"],i);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const o=C(n,["candidatesTokenCount"]);o!=null&&j(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&j(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&j(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(k=>xx(e,k))),j(t,["promptTokensDetails"],S)}const p=C(n,["cacheTokensDetails"]);if(p!=null){let S=p;Array.isArray(S)&&(S=S.map(k=>xx(e,k))),j(t,["cacheTokensDetails"],S)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>xx(e,k))),j(t,["responseTokensDetails"],S)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>xx(e,k))),j(t,["toolUsePromptTokensDetails"],S)}const v=C(n,["trafficType"]);return v!=null&&j(t,["trafficType"],v),t}function x6(e,n){const t={},i=C(n,["timeLeft"]);return i!=null&&j(t,["timeLeft"],i),t}function b6(e,n){const t={},i=C(n,["timeLeft"]);return i!=null&&j(t,["timeLeft"],i),t}function v6(e,n){const t={},i=C(n,["newHandle"]);i!=null&&j(t,["newHandle"],i);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&j(t,["lastConsumedClientMessageIndex"],o),t}function w6(e,n){const t={},i=C(n,["newHandle"]);i!=null&&j(t,["newHandle"],i);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&j(t,["lastConsumedClientMessageIndex"],o),t}function S6(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],e6());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],l6(e,a));const o=C(n,["toolCall"]);o!=null&&j(t,["toolCall"],f6(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],p6(e,l));const d=C(n,["usageMetadata"]);d!=null&&j(t,["usageMetadata"],g6(e,d));const f=C(n,["goAway"]);f!=null&&j(t,["goAway"],x6(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&j(t,["sessionResumptionUpdate"],v6(e,u)),t}function N6(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],t6());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],c6(e,a));const o=C(n,["toolCall"]);o!=null&&j(t,["toolCall"],h6(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],m6(e,l));const d=C(n,["usageMetadata"]);d!=null&&j(t,["usageMetadata"],y6(e,d));const f=C(n,["goAway"]);f!=null&&j(t,["goAway"],b6(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&j(t,["sessionResumptionUpdate"],w6(e,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function C6(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function j6(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],C6(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function Pb(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>j6(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function _6(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=C(n,["category"]);i!=null&&j(t,["category"],i);const a=C(n,["threshold"]);return a!=null&&j(t,["threshold"],a),t}function k6(){return{}}function T6(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function E6(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],T6(e,i)),t}function A6(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],k6());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],E6(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&j(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function P6(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function D6(e,n){const t={},i=C(n,["functionCallingConfig"]);if(i!=null&&j(t,["functionCallingConfig"],P6(e,i)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function I6(e,n){const t={},i=C(n,["voiceName"]);return i!=null&&j(t,["voiceName"],i),t}function R6(e,n){const t={},i=C(n,["prebuiltVoiceConfig"]);return i!=null&&j(t,["prebuiltVoiceConfig"],I6(e,i)),t}function M6(e,n){const t={},i=C(n,["voiceConfig"]);i!=null&&j(t,["voiceConfig"],R6(e,i));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function O6(e,n){const t={},i=C(n,["includeThoughts"]);i!=null&&j(t,["includeThoughts"],i);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function L6(e,n,t){const i={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Pb(e,ua(e,a)));const o=C(n,["temperature"]);o!=null&&j(i,["temperature"],o);const l=C(n,["topP"]);l!=null&&j(i,["topP"],l);const d=C(n,["topK"]);d!=null&&j(i,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&j(i,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&j(i,["maxOutputTokens"],u);const p=C(n,["stopSequences"]);p!=null&&j(i,["stopSequences"],p);const g=C(n,["responseLogprobs"]);g!=null&&j(i,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(i,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(i,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(i,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(i,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&j(i,["responseMimeType"],T);const P=C(n,["responseSchema"]);if(P!=null&&j(i,["responseSchema"],nT(e,P)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=C(n,["safetySettings"]);if(t!==void 0&&M!=null){let R=M;Array.isArray(R)&&(R=R.map(V=>_6(e,V))),j(t,["safetySettings"],R)}const I=C(n,["tools"]);if(t!==void 0&&I!=null){let R=Eb(e,I);Array.isArray(R)&&(R=R.map(V=>A6(e,Tb(e,V)))),j(t,["tools"],R)}const U=C(n,["toolConfig"]);if(t!==void 0&&U!=null&&j(t,["toolConfig"],D6(e,U)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const L=C(n,["cachedContent"]);t!==void 0&&L!=null&&j(t,["cachedContent"],au(e,L));const F=C(n,["responseModalities"]);F!=null&&j(i,["responseModalities"],F);const z=C(n,["mediaResolution"]);z!=null&&j(i,["mediaResolution"],z);const $=C(n,["speechConfig"]);if($!=null&&j(i,["speechConfig"],M6(e,iT(e,$))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=C(n,["thinkingConfig"]);return B!=null&&j(i,["thinkingConfig"],O6(e,B)),i}function hC(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=ru(e,a);Array.isArray(l)&&(l=l.map(d=>Pb(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["generationConfig"],L6(e,o,t)),t}function F6(e,n,t){const i={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["requests[]","taskType"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&j(t,["requests[]","title"],o);const l=C(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&j(t,["requests[]","outputDimensionality"],l),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return i}function $6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);a!=null&&j(t,["requests[]","content"],tT(e,a));const o=C(n,["config"]);o!=null&&j(t,["config"],F6(e,o,t));const l=C(n,["model"]);return l!==void 0&&j(t,["requests[]","model"],fi(e,l)),t}function z6(e,n,t){const i={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const o=C(n,["aspectRatio"]);t!==void 0&&o!=null&&j(t,["parameters","aspectRatio"],o);const l=C(n,["guidanceScale"]);if(t!==void 0&&l!=null&&j(t,["parameters","guidanceScale"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=C(n,["safetyFilterLevel"]);t!==void 0&&d!=null&&j(t,["parameters","safetySetting"],d);const f=C(n,["personGeneration"]);t!==void 0&&f!=null&&j(t,["parameters","personGeneration"],f);const u=C(n,["includeSafetyAttributes"]);t!==void 0&&u!=null&&j(t,["parameters","includeSafetyAttributes"],u);const p=C(n,["includeRaiReason"]);t!==void 0&&p!=null&&j(t,["parameters","includeRaiReason"],p);const g=C(n,["language"]);t!==void 0&&g!=null&&j(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&j(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&j(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function U6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&j(t,["config"],z6(e,o,t)),t}function B6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function q6(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&j(t,["_url","models_url"],sT(e,d)),i}function V6(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],q6(e,i,t)),t}function H6(e,n,t){const i={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&j(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),i}function G6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],H6(e,a,t)),t}function Y6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function W6(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function Q6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=ru(e,a);Array.isArray(l)&&(l=l.map(d=>Pb(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["config"],W6(e,o)),t}function J6(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const i=C(n,["imageBytes"]);i!=null&&j(t,["bytesBase64Encoded"],su(e,i));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function K6(e,n,t){const i={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=C(n,["durationSeconds"]);if(t!==void 0&&o!=null&&j(t,["parameters","durationSeconds"],o),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=C(n,["aspectRatio"]);if(t!==void 0&&l!=null&&j(t,["parameters","aspectRatio"],l),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const d=C(n,["personGeneration"]);if(t!==void 0&&d!=null&&j(t,["parameters","personGeneration"],d),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=C(n,["negativePrompt"]);if(t!==void 0&&f!=null&&j(t,["parameters","negativePrompt"],f),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function X6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&j(t,["instances[0]","image"],J6(e,o));const l=C(n,["config"]);return l!=null&&j(t,["config"],K6(e,l,t)),t}function Z6(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function e$(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],Z6(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function qh(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>e$(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function t$(e,n){const t={},i=C(n,["featureSelectionPreference"]);return i!=null&&j(t,["featureSelectionPreference"],i),t}function n$(e,n){const t={},i=C(n,["method"]);i!=null&&j(t,["method"],i);const a=C(n,["category"]);a!=null&&j(t,["category"],a);const o=C(n,["threshold"]);return o!=null&&j(t,["threshold"],o),t}function i$(){return{}}function r$(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function a$(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],r$(e,i)),t}function s$(){return{}}function o$(e,n){const t={},i=C(n,["apiKeyString"]);return i!=null&&j(t,["apiKeyString"],i),t}function l$(e,n){const t={},i=C(n,["apiKeyConfig"]);i!=null&&j(t,["apiKeyConfig"],o$(e,i));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&j(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&j(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&j(t,["oidcConfig"],f),t}function c$(e,n){const t={},i=C(n,["authConfig"]);return i!=null&&j(t,["authConfig"],l$(e,i)),t}function cT(e,n){const t={},i=C(n,["retrieval"]);i!=null&&j(t,["retrieval"],i),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],i$());const o=C(n,["googleSearchRetrieval"]);o!=null&&j(t,["googleSearchRetrieval"],a$(e,o)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],s$());const d=C(n,["googleMaps"]);d!=null&&j(t,["googleMaps"],c$(e,d));const f=C(n,["codeExecution"]);f!=null&&j(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function u$(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function d$(e,n){const t={},i=C(n,["latitude"]);i!=null&&j(t,["latitude"],i);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function f$(e,n){const t={},i=C(n,["latLng"]);return i!=null&&j(t,["latLng"],d$(e,i)),t}function h$(e,n){const t={},i=C(n,["functionCallingConfig"]);i!=null&&j(t,["functionCallingConfig"],u$(e,i));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],f$(e,a)),t}function p$(e,n){const t={},i=C(n,["voiceName"]);return i!=null&&j(t,["voiceName"],i),t}function m$(e,n){const t={},i=C(n,["prebuiltVoiceConfig"]);return i!=null&&j(t,["prebuiltVoiceConfig"],p$(e,i)),t}function g$(e,n){const t={},i=C(n,["voiceConfig"]);i!=null&&j(t,["voiceConfig"],m$(e,i));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function y$(e,n){const t={},i=C(n,["includeThoughts"]);i!=null&&j(t,["includeThoughts"],i);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function x$(e,n,t){const i={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],qh(e,ua(e,a)));const o=C(n,["temperature"]);o!=null&&j(i,["temperature"],o);const l=C(n,["topP"]);l!=null&&j(i,["topP"],l);const d=C(n,["topK"]);d!=null&&j(i,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&j(i,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&j(i,["maxOutputTokens"],u);const p=C(n,["stopSequences"]);p!=null&&j(i,["stopSequences"],p);const g=C(n,["responseLogprobs"]);g!=null&&j(i,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(i,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(i,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(i,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(i,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&j(i,["responseMimeType"],T);const P=C(n,["responseSchema"]);P!=null&&j(i,["responseSchema"],nT(e,P));const M=C(n,["routingConfig"]);M!=null&&j(i,["routingConfig"],M);const I=C(n,["modelSelectionConfig"]);I!=null&&j(i,["modelConfig"],t$(e,I));const U=C(n,["safetySettings"]);if(t!==void 0&&U!=null){let te=U;Array.isArray(te)&&(te=te.map(W=>n$(e,W))),j(t,["safetySettings"],te)}const L=C(n,["tools"]);if(t!==void 0&&L!=null){let te=Eb(e,L);Array.isArray(te)&&(te=te.map(W=>cT(e,Tb(e,W)))),j(t,["tools"],te)}const F=C(n,["toolConfig"]);t!==void 0&&F!=null&&j(t,["toolConfig"],h$(e,F));const z=C(n,["labels"]);t!==void 0&&z!=null&&j(t,["labels"],z);const $=C(n,["cachedContent"]);t!==void 0&&$!=null&&j(t,["cachedContent"],au(e,$));const B=C(n,["responseModalities"]);B!=null&&j(i,["responseModalities"],B);const R=C(n,["mediaResolution"]);R!=null&&j(i,["mediaResolution"],R);const V=C(n,["speechConfig"]);V!=null&&j(i,["speechConfig"],g$(e,iT(e,V)));const Y=C(n,["audioTimestamp"]);Y!=null&&j(i,["audioTimestamp"],Y);const ie=C(n,["thinkingConfig"]);return ie!=null&&j(i,["thinkingConfig"],y$(e,ie)),i}function pC(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=ru(e,a);Array.isArray(l)&&(l=l.map(d=>qh(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["generationConfig"],x$(e,o,t)),t}function b$(e,n,t){const i={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["instances[]","task_type"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&j(t,["instances[]","title"],o);const l=C(n,["outputDimensionality"]);t!==void 0&&l!=null&&j(t,["parameters","outputDimensionality"],l);const d=C(n,["mimeType"]);t!==void 0&&d!=null&&j(t,["instances[]","mimeType"],d);const f=C(n,["autoTruncate"]);return t!==void 0&&f!=null&&j(t,["parameters","autoTruncate"],f),i}function v$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);a!=null&&j(t,["instances[]","content"],tT(e,a));const o=C(n,["config"]);return o!=null&&j(t,["config"],b$(e,o,t)),t}function w$(e,n,t){const i={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&j(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&j(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&j(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const p=C(n,["safetyFilterLevel"]);t!==void 0&&p!=null&&j(t,["parameters","safetySetting"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&j(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["addWatermark"]);t!==void 0&&P!=null&&j(t,["parameters","addWatermark"],P);const M=C(n,["enhancePrompt"]);return t!==void 0&&M!=null&&j(t,["parameters","enhancePrompt"],M),i}function S$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&j(t,["config"],w$(e,o,t)),t}function yw(e,n){const t={},i=C(n,["gcsUri"]);i!=null&&j(t,["gcsUri"],i);const a=C(n,["imageBytes"]);a!=null&&j(t,["bytesBase64Encoded"],su(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function N$(e,n){const t={},i=C(n,["maskMode"]);i!=null&&j(t,["maskMode"],i);const a=C(n,["segmentationClasses"]);a!=null&&j(t,["maskClasses"],a);const o=C(n,["maskDilation"]);return o!=null&&j(t,["dilation"],o),t}function C$(e,n){const t={},i=C(n,["controlType"]);i!=null&&j(t,["controlType"],i);const a=C(n,["enableControlImageComputation"]);return a!=null&&j(t,["computeControl"],a),t}function j$(e,n){const t={},i=C(n,["styleDescription"]);return i!=null&&j(t,["styleDescription"],i),t}function _$(e,n){const t={},i=C(n,["subjectType"]);i!=null&&j(t,["subjectType"],i);const a=C(n,["subjectDescription"]);return a!=null&&j(t,["subjectDescription"],a),t}function k$(e,n){const t={},i=C(n,["referenceImage"]);i!=null&&j(t,["referenceImage"],yw(e,i));const a=C(n,["referenceId"]);a!=null&&j(t,["referenceId"],a);const o=C(n,["referenceType"]);o!=null&&j(t,["referenceType"],o);const l=C(n,["maskImageConfig"]);l!=null&&j(t,["maskImageConfig"],N$(e,l));const d=C(n,["controlImageConfig"]);d!=null&&j(t,["controlImageConfig"],C$(e,d));const f=C(n,["styleImageConfig"]);f!=null&&j(t,["styleImageConfig"],j$(e,f));const u=C(n,["subjectImageConfig"]);return u!=null&&j(t,["subjectImageConfig"],_$(e,u)),t}function T$(e,n,t){const i={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&j(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&j(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&j(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const p=C(n,["safetyFilterLevel"]);t!==void 0&&p!=null&&j(t,["parameters","safetySetting"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&j(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["editMode"]);t!==void 0&&P!=null&&j(t,["parameters","editMode"],P);const M=C(n,["baseSteps"]);return t!==void 0&&M!=null&&j(t,["parameters","editConfig","baseSteps"],M),i}function E$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["referenceImages"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>k$(e,f))),j(t,["instances[0]","referenceImages"],d)}const l=C(n,["config"]);return l!=null&&j(t,["config"],T$(e,l,t)),t}function A$(e,n,t){const i={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&j(t,["parameters","includeRaiReason"],a);const o=C(n,["outputMimeType"]);t!==void 0&&o!=null&&j(t,["parameters","outputOptions","mimeType"],o);const l=C(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&j(t,["parameters","outputOptions","compressionQuality"],l);const d=C(n,["numberOfImages"]);t!==void 0&&d!=null&&j(t,["parameters","sampleCount"],d);const f=C(n,["mode"]);return t!==void 0&&f!=null&&j(t,["parameters","mode"],f),i}function P$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["image"]);a!=null&&j(t,["instances[0]","image"],yw(e,a));const o=C(n,["upscaleFactor"]);o!=null&&j(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=C(n,["config"]);return l!=null&&j(t,["config"],A$(e,l,t)),t}function D$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function I$(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&j(t,["_url","models_url"],sT(e,d)),i}function R$(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],I$(e,i,t)),t}function M$(e,n,t){const i={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&j(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),i}function O$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],M$(e,a,t)),t}function L$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function F$(e,n,t){const i={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],qh(e,ua(e,a)));const o=C(n,["tools"]);if(t!==void 0&&o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>cT(e,f))),j(t,["tools"],d)}const l=C(n,["generationConfig"]);return t!==void 0&&l!=null&&j(t,["generationConfig"],l),i}function $$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=ru(e,a);Array.isArray(l)&&(l=l.map(d=>qh(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["config"],F$(e,o,t)),t}function z$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=ru(e,a);Array.isArray(l)&&(l=l.map(d=>qh(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["config"],o),t}function U$(e,n,t){const i={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const o=C(n,["outputGcsUri"]);t!==void 0&&o!=null&&j(t,["parameters","storageUri"],o);const l=C(n,["fps"]);t!==void 0&&l!=null&&j(t,["parameters","fps"],l);const d=C(n,["durationSeconds"]);t!==void 0&&d!=null&&j(t,["parameters","durationSeconds"],d);const f=C(n,["seed"]);t!==void 0&&f!=null&&j(t,["parameters","seed"],f);const u=C(n,["aspectRatio"]);t!==void 0&&u!=null&&j(t,["parameters","aspectRatio"],u);const p=C(n,["resolution"]);t!==void 0&&p!=null&&j(t,["parameters","resolution"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&j(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&j(t,["parameters","negativePrompt"],v);const S=C(n,["enhancePrompt"]);return t!==void 0&&S!=null&&j(t,["parameters","enhancePrompt"],S),i}function B$(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&j(t,["instances[0]","image"],yw(e,o));const l=C(n,["config"]);return l!=null&&j(t,["config"],U$(e,l,t)),t}function q$(e,n){const t={},i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function V$(e,n){const t={},i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],q$(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function H$(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>V$(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function G$(e,n){const t={},i=C(n,["citationSources"]);return i!=null&&j(t,["citations"],i),t}function Y$(e,n){const t={},i=C(n,["content"]);i!=null&&j(t,["content"],H$(e,i));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],G$(e,a));const o=C(n,["tokenCount"]);o!=null&&j(t,["tokenCount"],o);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&j(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&j(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&j(t,["index"],u);const p=C(n,["logprobsResult"]);p!=null&&j(t,["logprobsResult"],p);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function mC(e,n){const t={},i=C(n,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(f=>Y$(e,f))),j(t,["candidates"],d)}const a=C(n,["modelVersion"]);a!=null&&j(t,["modelVersion"],a);const o=C(n,["promptFeedback"]);o!=null&&j(t,["promptFeedback"],o);const l=C(n,["usageMetadata"]);return l!=null&&j(t,["usageMetadata"],l),t}function W$(e,n){const t={},i=C(n,["values"]);return i!=null&&j(t,["values"],i),t}function Q$(){return{}}function J$(e,n){const t={},i=C(n,["embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>W$(e,l))),j(t,["embeddings"],o)}return C(n,["metadata"])!=null&&j(t,["metadata"],Q$()),t}function K$(e,n){const t={},i=C(n,["bytesBase64Encoded"]);i!=null&&j(t,["imageBytes"],su(e,i));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function uT(e,n){const t={},i=C(n,["safetyAttributes","categories"]);i!=null&&j(t,["categories"],i);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&j(t,["contentType"],o),t}function X$(e,n){const t={},i=C(n,["_self"]);i!=null&&j(t,["image"],K$(e,i));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const o=C(n,["_self"]);return o!=null&&j(t,["safetyAttributes"],uT(e,o)),t}function Z$(e,n){const t={},i=C(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>X$(e,l))),j(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],uT(e,a)),t}function e5(e,n){const t={},i=C(n,["baseModel"]);i!=null&&j(t,["baseModel"],i);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&j(t,["updateTime"],o),t}function d1(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);o!=null&&j(t,["description"],o);const l=C(n,["version"]);l!=null&&j(t,["version"],l);const d=C(n,["_self"]);d!=null&&j(t,["tunedModelInfo"],e5(e,d));const f=C(n,["inputTokenLimit"]);f!=null&&j(t,["inputTokenLimit"],f);const u=C(n,["outputTokenLimit"]);u!=null&&j(t,["outputTokenLimit"],u);const p=C(n,["supportedGenerationMethods"]);return p!=null&&j(t,["supportedActions"],p),t}function t5(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["_self"]);if(a!=null){let o=oT(e,a);Array.isArray(o)&&(o=o.map(l=>d1(e,l))),j(t,["models"],o)}return t}function n5(){return{}}function i5(e,n){const t={},i=C(n,["totalTokens"]);i!=null&&j(t,["totalTokens"],i);const a=C(n,["cachedContentTokenCount"]);return a!=null&&j(t,["cachedContentTokenCount"],a),t}function r5(e,n){const t={},i=C(n,["video","uri"]);i!=null&&j(t,["uri"],i);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],su(e,a));const o=C(n,["encoding"]);return o!=null&&j(t,["mimeType"],o),t}function a5(e,n){const t={},i=C(n,["_self"]);return i!=null&&j(t,["video"],r5(e,i)),t}function s5(e,n){const t={},i=C(n,["generatedSamples"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(d=>a5(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function o5(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&j(t,["response"],s5(e,d)),t}function l5(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function c5(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],l5(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function u5(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>c5(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function d5(e,n){const t={},i=C(n,["citations"]);return i!=null&&j(t,["citations"],i),t}function f5(e,n){const t={},i=C(n,["content"]);i!=null&&j(t,["content"],u5(e,i));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],d5(e,a));const o=C(n,["finishMessage"]);o!=null&&j(t,["finishMessage"],o);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&j(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&j(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&j(t,["index"],u);const p=C(n,["logprobsResult"]);p!=null&&j(t,["logprobsResult"],p);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function gC(e,n){const t={},i=C(n,["candidates"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(p=>f5(e,p))),j(t,["candidates"],u)}const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const o=C(n,["responseId"]);o!=null&&j(t,["responseId"],o);const l=C(n,["modelVersion"]);l!=null&&j(t,["modelVersion"],l);const d=C(n,["promptFeedback"]);d!=null&&j(t,["promptFeedback"],d);const f=C(n,["usageMetadata"]);return f!=null&&j(t,["usageMetadata"],f),t}function h5(e,n){const t={},i=C(n,["truncated"]);i!=null&&j(t,["truncated"],i);const a=C(n,["token_count"]);return a!=null&&j(t,["tokenCount"],a),t}function p5(e,n){const t={},i=C(n,["values"]);i!=null&&j(t,["values"],i);const a=C(n,["statistics"]);return a!=null&&j(t,["statistics"],h5(e,a)),t}function m5(e,n){const t={},i=C(n,["billableCharacterCount"]);return i!=null&&j(t,["billableCharacterCount"],i),t}function g5(e,n){const t={},i=C(n,["predictions[]","embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>p5(e,l))),j(t,["embeddings"],o)}const a=C(n,["metadata"]);return a!=null&&j(t,["metadata"],m5(e,a)),t}function y5(e,n){const t={},i=C(n,["gcsUri"]);i!=null&&j(t,["gcsUri"],i);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["imageBytes"],su(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function dT(e,n){const t={},i=C(n,["safetyAttributes","categories"]);i!=null&&j(t,["categories"],i);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&j(t,["contentType"],o),t}function xw(e,n){const t={},i=C(n,["_self"]);i!=null&&j(t,["image"],y5(e,i));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const o=C(n,["_self"]);o!=null&&j(t,["safetyAttributes"],dT(e,o));const l=C(n,["prompt"]);return l!=null&&j(t,["enhancedPrompt"],l),t}function x5(e,n){const t={},i=C(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>xw(e,l))),j(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],dT(e,a)),t}function b5(e,n){const t={},i=C(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>xw(e,o))),j(t,["generatedImages"],a)}return t}function v5(e,n){const t={},i=C(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>xw(e,o))),j(t,["generatedImages"],a)}return t}function w5(e,n){const t={},i=C(n,["endpoint"]);i!=null&&j(t,["name"],i);const a=C(n,["deployedModelId"]);return a!=null&&j(t,["deployedModelId"],a),t}function S5(e,n){const t={},i=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);i!=null&&j(t,["baseModel"],i);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&j(t,["updateTime"],o),t}function N5(e,n){const t={},i=C(n,["checkpointId"]);i!=null&&j(t,["checkpointId"],i);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const o=C(n,["step"]);return o!=null&&j(t,["step"],o),t}function f1(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);o!=null&&j(t,["description"],o);const l=C(n,["versionId"]);l!=null&&j(t,["version"],l);const d=C(n,["deployedModels"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(v=>w5(e,v))),j(t,["endpoints"],b)}const f=C(n,["labels"]);f!=null&&j(t,["labels"],f);const u=C(n,["_self"]);u!=null&&j(t,["tunedModelInfo"],S5(e,u));const p=C(n,["defaultCheckpointId"]);p!=null&&j(t,["defaultCheckpointId"],p);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>N5(e,v))),j(t,["checkpoints"],b)}return t}function C5(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["_self"]);if(a!=null){let o=oT(e,a);Array.isArray(o)&&(o=o.map(l=>f1(e,l))),j(t,["models"],o)}return t}function j5(){return{}}function _5(e,n){const t={},i=C(n,["totalTokens"]);return i!=null&&j(t,["totalTokens"],i),t}function k5(e,n){const t={},i=C(n,["tokensInfo"]);return i!=null&&j(t,["tokensInfo"],i),t}function T5(e,n){const t={},i=C(n,["gcsUri"]);i!=null&&j(t,["uri"],i);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],su(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function E5(e,n){const t={},i=C(n,["_self"]);return i!=null&&j(t,["video"],T5(e,i)),t}function A5(e,n){const t={},i=C(n,["videos"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(d=>E5(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function P5(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response"]);return d!=null&&j(t,["response"],A5(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const D5="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function I5(e,n,t){const i=new K3;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const o=N6(e,a);Object.assign(i,o)}else{const o=S6(e,a);Object.assign(i,o)}n(i)}class R5{constructor(n,t,i){this.apiClient=n,this.auth=t,this.webSocketFactory=i}async connect(n){var t,i,a,o;const l=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const u=F5(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const U=this.apiClient.getApiKey();f=`${l}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${U}`}let p=()=>{};const g=new Promise(U=>{p=U}),b=n.callbacks,v=function(){var U;(U=b==null?void 0:b.onopen)===null||U===void 0||U.call(b),p({})},S=this.apiClient,k={onopen:v,onmessage:U=>{I5(S,b.onmessage,U)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(U){},onclose:(i=b==null?void 0:b.onclose)!==null&&i!==void 0?i:function(U){}},T=this.webSocketFactory.create(f,L5(u),k);T.connect(),await g;let P=fi(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const U=this.apiClient.getProject(),L=this.apiClient.getLocation();P=`projects/${U}/locations/${L}/`+P}let M={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[nu.AUDIO]}:n.config.responseModalities=[nu.AUDIO]),!((o=n.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I={model:P,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?M=YF(this.apiClient,I):M=GF(this.apiClient,I),delete M.config,T.send(JSON.stringify(M)),new O5(T,this.apiClient)}}const M5={turnComplete:!0};class O5{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=ru(n,t.turns),n.isVertexAI()?i=i.map(a=>qh(n,a)):i=i.map(a=>Pb(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!n.isVertexAI()&&!("id"in o))throw new Error(D5)}return{toolResponse:{functionResponses:i}}}sendClientContent(n){n=Object.assign(Object.assign({},M5),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:ZF(this.apiClient,n)}:t={realtimeInput:XF(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function L5(e){const n={};return e.forEach((t,i)=>{n[i]=t}),n}function F5(e){const n=new Headers;for(const[t,i]of Object.entries(e))n.append(t,i);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $5 extends sg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var a;let o;const l=[];if(i!=null&&i.generatedImages)for(const f of i.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((a=f==null?void 0:f.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=f==null?void 0:f.safetyAttributes:l.push(f);let d;return o?d={generatedImages:l,positivePromptSafetyAttributes:o}:d={generatedImages:l},d}),this.list=async t=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Ab(Mh.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=pC(this.apiClient,n);return d=zt("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=gC(this.apiClient,p),b=new gx;return Object.assign(b,g),b})}else{const u=hC(this.apiClient,n);return d=zt("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=mC(this.apiClient,p),b=new gx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=pC(this.apiClient,n);d=zt("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const p=this.apiClient;return l=p.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(g){return sb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=c1(g),M;M=yield Ar(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const U=gC(p,yield Ar(k.json())),L=new gx;Object.assign(L,U),yield yield Ar(L)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=P.return)&&(yield Ar(S.call(P)))}finally{if(v)throw v.error}}})})}else{const u=hC(this.apiClient,n);d=zt("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const p=this.apiClient;return l=p.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(g){return sb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=c1(g),M;M=yield Ar(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const U=mC(p,yield Ar(k.json())),L=new gx;Object.assign(L,U),yield yield Ar(L)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=P.return)&&(yield Ar(S.call(P)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=v$(this.apiClient,n);return d=zt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=g5(this.apiClient,p),b=new eC;return Object.assign(b,g),b})}else{const u=$6(this.apiClient,n);return d=zt("{model}:batchEmbedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=J$(this.apiClient,p),b=new eC;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=S$(this.apiClient,n);return d=zt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=x5(this.apiClient,p),b=new tC;return Object.assign(b,g),b})}else{const u=U6(this.apiClient,n);return d=zt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=Z$(this.apiClient,p),b=new tC;return Object.assign(b,g),b})}}async editImageInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=E$(this.apiClient,n);return o=zt("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>{const u=b5(this.apiClient,f),p=new H3;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=P$(this.apiClient,n);return o=zt("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>{const u=v5(this.apiClient,f),p=new G3;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=D$(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>f1(this.apiClient,p))}else{const u=B6(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>d1(this.apiClient,p))}}async listInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=R$(this.apiClient,n);return d=zt("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=C5(this.apiClient,p),b=new nC;return Object.assign(b,g),b})}else{const u=V6(this.apiClient,n);return d=zt("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=t5(this.apiClient,p),b=new nC;return Object.assign(b,g),b})}}async update(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=O$(this.apiClient,n);return d=zt("{model}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>f1(this.apiClient,p))}else{const u=G6(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>d1(this.apiClient,p))}}async delete(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=L$(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(()=>{const p=j5(),g=new iC;return Object.assign(g,p),g})}else{const u=Y6(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(()=>{const p=n5(),g=new iC;return Object.assign(g,p),g})}}async countTokens(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=$$(this.apiClient,n);return d=zt("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=_5(this.apiClient,p),b=new rC;return Object.assign(b,g),b})}else{const u=Q6(this.apiClient,n);return d=zt("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=i5(this.apiClient,p),b=new rC;return Object.assign(b,g),b})}}async computeTokens(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=z$(this.apiClient,n);return o=zt("{model}:computeTokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>{const u=k5(this.apiClient,f),p=new Y3;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=B$(this.apiClient,n);return d=zt("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>P5(this.apiClient,p))}else{const u=X6(this.apiClient,n);return d=zt("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>o5(this.apiClient,p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z5(e,n){const t={},i=C(n,["operationName"]);i!=null&&j(t,["_url","operationName"],i);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function U5(e,n){const t={},i=C(n,["operationName"]);i!=null&&j(t,["_url","operationName"],i);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function B5(e,n){const t={},i=C(n,["operationName"]);i!=null&&j(t,["operationName"],i);const a=C(n,["resourceName"]);a!=null&&j(t,["_url","resourceName"],a);const o=C(n,["config"]);return o!=null&&j(t,["config"],o),t}function q5(e,n){const t={},i=C(n,["video","uri"]);i!=null&&j(t,["uri"],i);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],su(e,a));const o=C(n,["encoding"]);return o!=null&&j(t,["mimeType"],o),t}function V5(e,n){const t={},i=C(n,["_self"]);return i!=null&&j(t,["video"],q5(e,i)),t}function H5(e,n){const t={},i=C(n,["generatedSamples"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(d=>V5(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function G5(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&j(t,["response"],H5(e,d)),t}function Y5(e,n){const t={},i=C(n,["gcsUri"]);i!=null&&j(t,["uri"],i);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],su(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function W5(e,n){const t={},i=C(n,["_self"]);return i!=null&&j(t,["video"],Y5(e,i)),t}function Q5(e,n){const t={},i=C(n,["videos"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(d=>W5(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function yC(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response"]);return d!=null&&j(t,["response"],Q5(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class J5 extends sg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,i=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let o;return i&&"httpOptions"in i&&(o=i.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:t.name,config:i})}async getVideosOperationInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=U5(this.apiClient,n);return d=zt("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>yC(this.apiClient,p))}else{const u=z5(this.apiClient,n);return d=zt("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>G5(this.apiClient,p))}}async fetchPredictVideosOperationInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=B5(this.apiClient,n);return o=zt("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>yC(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const K5="Content-Type",X5="X-Server-Timeout",Z5="User-Agent",ez="x-goog-api-client",tz="0.14.1",nz=`google-genai-sdk/${tz}`,iz="v1beta1",rz="v1beta",xC=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class fT extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class h1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class az{constructor(n){var t,i;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:iz,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:rz,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&i.push(n.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,i){const a=[this.getRequestUrlInternal(t)];return i&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const i=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,i);if(n.queryParams)for(const[l,d]of Object.entries(n.queryParams))a.searchParams.append(l,String(d));let o={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=n.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.unaryApiCall(a,o,n.httpMethod)}patchHttpOptions(n,t){const i=JSON.parse(JSON.stringify(n));for(const[a,o]of Object.entries(t))typeof o=="object"?i[a]=Object.assign(Object.assign({},i[a]),o):o!==void 0&&(i[a]=o);return i}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const i=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,i);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=n.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.streamApiCall(a,o,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,i){if(t&&t.timeout||i){const a=new AbortController,o=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),i&&i.addEventListener("abort",()=>{a.abort()}),n.signal=o}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,i){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:i})).then(async a=>(await bC(a),new l1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,i){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:i})).then(async a=>(await bC(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return sb(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:d,value:f}=yield Ar(a.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(f);try{const g=JSON.parse(u);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new fT(k);if(S>=500&&S<600)throw new h1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=u;let p=l.match(xC);for(;p;){const g=p[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Ar(new l1(b)),l=l.slice(p[0].length),p=l.match(xC)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const n={},t=nz+" "+this.clientOptions.userAgentExtra;return n[Z5]=t,n[ez]=t,n[K5]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[i,a]of Object.entries(n.headers))t.append(i,a);n.timeout&&n.timeout>0&&t.append(X5,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var i;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,l=await o.stat(n);a.sizeBytes=String(l.size);const d=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=d;const f=await this.fetchUploadUrl(a,t);return o.upload(n,f,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var i;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const o={file:n},l=await this.request({path:zt("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(i=l==null?void 0:l.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function bC(e){var n;if(e===void 0)throw new h1("response is undefined");if(!e.ok){const t=e.status,i=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=`got status: ${t} ${i}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new fT(o):t>=500&&t<600?new h1(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sz(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],i);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function oz(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),i}function lz(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],oz(e,i,t)),t}function cz(e,n){const t={},i=C(n,["textInput"]);i!=null&&j(t,["textInput"],i);const a=C(n,["output"]);return a!=null&&j(t,["output"],a),t}function uz(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const i=C(n,["examples"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>cz(e,o))),j(t,["examples","examples"],a)}return t}function dz(e,n,t){const i={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&j(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=C(n,["epochCount"]);t!==void 0&&o!=null&&j(t,["tuningTask","hyperparameters","epochCount"],o);const l=C(n,["learningRateMultiplier"]);if(l!=null&&j(i,["tuningTask","hyperparameters","learningRateMultiplier"],l),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=C(n,["batchSize"]);t!==void 0&&d!=null&&j(t,["tuningTask","hyperparameters","batchSize"],d);const f=C(n,["learningRate"]);return t!==void 0&&f!=null&&j(t,["tuningTask","hyperparameters","learningRate"],f),i}function fz(e,n){const t={},i=C(n,["baseModel"]);i!=null&&j(t,["baseModel"],i);const a=C(n,["trainingDataset"]);a!=null&&j(t,["tuningTask","trainingData"],uz(e,a));const o=C(n,["config"]);return o!=null&&j(t,["config"],dz(e,o,t)),t}function hz(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],i);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function pz(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),i}function mz(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],pz(e,i,t)),t}function gz(e,n,t){const i={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function yz(e,n){const t={},i=C(n,["gcsUri"]);return i!=null&&j(t,["validationDatasetUri"],i),t}function xz(e,n,t){const i={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&j(t,["supervisedTuningSpec"],yz(e,a));const o=C(n,["tunedModelDisplayName"]);t!==void 0&&o!=null&&j(t,["tunedModelDisplayName"],o);const l=C(n,["description"]);t!==void 0&&l!=null&&j(t,["description"],l);const d=C(n,["epochCount"]);t!==void 0&&d!=null&&j(t,["supervisedTuningSpec","hyperParameters","epochCount"],d);const f=C(n,["learningRateMultiplier"]);t!==void 0&&f!=null&&j(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const u=C(n,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&j(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const p=C(n,["adapterSize"]);if(t!==void 0&&p!=null&&j(t,["supervisedTuningSpec","hyperParameters","adapterSize"],p),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return i}function bz(e,n){const t={},i=C(n,["baseModel"]);i!=null&&j(t,["baseModel"],i);const a=C(n,["trainingDataset"]);a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],gz(e,a,t));const o=C(n,["config"]);return o!=null&&j(t,["config"],xz(e,o,t)),t}function vz(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["model"],i);const a=C(n,["name"]);return a!=null&&j(t,["endpoint"],a),t}function hT(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["state"]);a!=null&&j(t,["state"],rT(e,a));const o=C(n,["createTime"]);o!=null&&j(t,["createTime"],o);const l=C(n,["tuningTask","startTime"]);l!=null&&j(t,["startTime"],l);const d=C(n,["tuningTask","completeTime"]);d!=null&&j(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["description"]);u!=null&&j(t,["description"],u);const p=C(n,["baseModel"]);p!=null&&j(t,["baseModel"],p);const g=C(n,["_self"]);g!=null&&j(t,["tunedModel"],vz(e,g));const b=C(n,["distillationSpec"]);b!=null&&j(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&j(t,["experiment"],v);const S=C(n,["labels"]);S!=null&&j(t,["labels"],S);const k=C(n,["pipelineJob"]);k!=null&&j(t,["pipelineJob"],k);const T=C(n,["tunedModelDisplayName"]);return T!=null&&j(t,["tunedModelDisplayName"],T),t}function wz(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["tunedModels"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>hT(e,l))),j(t,["tuningJobs"],o)}return t}function Sz(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);return l!=null&&j(t,["error"],l),t}function Nz(e,n){const t={},i=C(n,["checkpointId"]);i!=null&&j(t,["checkpointId"],i);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const o=C(n,["step"]);o!=null&&j(t,["step"],o);const l=C(n,["endpoint"]);return l!=null&&j(t,["endpoint"],l),t}function Cz(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["model"],i);const a=C(n,["endpoint"]);a!=null&&j(t,["endpoint"],a);const o=C(n,["checkpoints"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>Nz(e,d))),j(t,["checkpoints"],l)}return t}function p1(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["state"]);a!=null&&j(t,["state"],rT(e,a));const o=C(n,["createTime"]);o!=null&&j(t,["createTime"],o);const l=C(n,["startTime"]);l!=null&&j(t,["startTime"],l);const d=C(n,["endTime"]);d!=null&&j(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["error"]);u!=null&&j(t,["error"],u);const p=C(n,["description"]);p!=null&&j(t,["description"],p);const g=C(n,["baseModel"]);g!=null&&j(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&j(t,["tunedModel"],Cz(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&j(t,["supervisedTuningSpec"],v);const S=C(n,["tuningDataStats"]);S!=null&&j(t,["tuningDataStats"],S);const k=C(n,["encryptionSpec"]);k!=null&&j(t,["encryptionSpec"],k);const T=C(n,["partnerModelTuningSpec"]);T!=null&&j(t,["partnerModelTuningSpec"],T);const P=C(n,["distillationSpec"]);P!=null&&j(t,["distillationSpec"],P);const M=C(n,["experiment"]);M!=null&&j(t,["experiment"],M);const I=C(n,["labels"]);I!=null&&j(t,["labels"],I);const U=C(n,["pipelineJob"]);U!=null&&j(t,["pipelineJob"],U);const L=C(n,["tunedModelDisplayName"]);return L!=null&&j(t,["tunedModelDisplayName"],L),t}function jz(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["tuningJobs"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>p1(e,l))),j(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _z extends sg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Ab(Mh.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const i=await this.tuneMldevInternal(t);let a="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?a=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(a=i.name.split("/operations/")[0]),{name:a,state:o1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=hz(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>p1(this.apiClient,p))}else{const u=sz(this.apiClient,n);return d=zt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>hT(this.apiClient,p))}}async listInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=mz(this.apiClient,n);return d=zt("tuningJobs",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=jz(this.apiClient,p),b=new aC;return Object.assign(b,g),b})}else{const u=lz(this.apiClient,n);return d=zt("tunedModels",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=wz(this.apiClient,p),b=new aC;return Object.assign(b,g),b})}}async tuneInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=bz(this.apiClient,n);return o=zt("tuningJobs",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>p1(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=fz(this.apiClient,n);return o=zt("tunedModels",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>Sz(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kz{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Tz=1024*1024*8,Ez=3,Az=1e3,Pz=2,r0="x-goog-upload-status";async function Dz(e,n,t){var i,a,o;let l=0,d=0,f=new l1(new Response),u="upload";for(l=e.size;d<l;){const g=Math.min(Tz,l-d),b=e.slice(d,d+g);d+g>=l&&(u+=", finalize");let v=0,S=Az;for(;v<Ez&&(f=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(d),"Content-Length":String(g)}}}),!(!((i=f==null?void 0:f.headers)===null||i===void 0)&&i[r0]));)v++,await Rz(S),S=S*Pz;if(d+=g,((a=f==null?void 0:f.headers)===null||a===void 0?void 0:a[r0])!=="active")break;if(l<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const p=await(f==null?void 0:f.json());if(((o=f==null?void 0:f.headers)===null||o===void 0?void 0:o[r0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return p.file}async function Iz(e){return{size:e.size,type:e.type}}function Rz(e){return new Promise(n=>setTimeout(n,e))}class Mz{async upload(n,t,i){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await Dz(n,t,i)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await Iz(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Oz{create(n,t,i){return new Lz(n,t,i)}}class Lz{constructor(n,t,i){this.url=n,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vC="x-goog-api-key";class Fz{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(vC)===null&&n.append(vC,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $z="gl-node/";class pT{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const i=QL(n,void 0,void 0);i&&(n.httpOptions?n.httpOptions.baseUrl=i:n.httpOptions={baseUrl:i}),this.apiVersion=n.apiVersion;const a=new Fz(this.apiKey);this.apiClient=new az({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:$z+"web",uploader:new Mz,downloader:new kz}),this.models=new $5(this.apiClient),this.live=new R5(this.apiClient,a,new Oz),this.chats=new nF(this.models,this.apiClient),this.caches=new X3(this.apiClient),this.files=new mF(this.apiClient),this.operations=new J5(this.apiClient),this.tunings=new _z(this.apiClient)}}const mh=new Map,mT=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&mh.has(n.id)){const a=mh.get(n.id);if(a)return a}const i=new AudioContext(n);return n!=null&&n.id&&mh.set(n.id,i),i}catch{if(await e,n!=null&&n.id&&mh.has(n.id)){const a=mh.get(n.id);if(a)return a}const i=new AudioContext(n);return n!=null&&n.id&&mh.set(n.id,i),i}}})();function zz(e){var n=atob(e),t=new Uint8Array(n.length);for(let i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t.buffer}const Uz=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,gT=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,bx=new Map,m1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var a0={exports:{}},wC;function Bz(){return wC||(wC=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function a(f,u,p){this.fn=f,this.context=u,this.once=p||!1}function o(f,u,p,g,b){if(typeof p!="function")throw new TypeError("The listener must be a function");var v=new a(p,g||f,b),S=t?t+u:u;return f._events[S]?f._events[S].fn?f._events[S]=[f._events[S],v]:f._events[S].push(v):(f._events[S]=v,f._eventsCount++),f}function l(f,u){--f._eventsCount===0?f._events=new i:delete f._events[u]}function d(){this._events=new i,this._eventsCount=0}d.prototype.eventNames=function(){var u=[],p,g;if(this._eventsCount===0)return u;for(g in p=this._events)n.call(p,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(p)):u},d.prototype.listeners=function(u){var p=t?t+u:u,g=this._events[p];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},d.prototype.listenerCount=function(u){var p=t?t+u:u,g=this._events[p];return g?g.fn?1:g.length:0},d.prototype.emit=function(u,p,g,b,v,S){var k=t?t+u:u;if(!this._events[k])return!1;var T=this._events[k],P=arguments.length,M,I;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),P){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,p),!0;case 3:return T.fn.call(T.context,p,g),!0;case 4:return T.fn.call(T.context,p,g,b),!0;case 5:return T.fn.call(T.context,p,g,b,v),!0;case 6:return T.fn.call(T.context,p,g,b,v,S),!0}for(I=1,M=new Array(P-1);I<P;I++)M[I-1]=arguments[I];T.fn.apply(T.context,M)}else{var U=T.length,L;for(I=0;I<U;I++)switch(T[I].once&&this.removeListener(u,T[I].fn,void 0,!0),P){case 1:T[I].fn.call(T[I].context);break;case 2:T[I].fn.call(T[I].context,p);break;case 3:T[I].fn.call(T[I].context,p,g);break;case 4:T[I].fn.call(T[I].context,p,g,b);break;default:if(!M)for(L=1,M=new Array(P-1);L<P;L++)M[L-1]=arguments[L];T[I].fn.apply(T[I].context,M)}}return!0},d.prototype.on=function(u,p,g){return o(this,u,p,g,!1)},d.prototype.once=function(u,p,g){return o(this,u,p,g,!0)},d.prototype.removeListener=function(u,p,g,b){var v=t?t+u:u;if(!this._events[v])return this;if(!p)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===p&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,T=[],P=S.length;k<P;k++)(S[k].fn!==p||b&&!S[k].once||g&&S[k].context!==g)&&T.push(S[k]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},d.prototype.removeAllListeners=function(u){var p;return u?(p=t?t+u:u,this._events[p]&&l(this,p)):(this._events=new i,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=t,d.EventEmitter=d,e.exports=d}(a0)),a0.exports}var qz=Bz();const yT=qd(qz);function Vz(e){for(var n="",t=new Uint8Array(e),i=t.byteLength,a=0;a<i;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class xT extends yT{constructor(t=16e3){super();qn(this,"stream");qn(this,"audioContext");qn(this,"source");qn(this,"recording",!1);qn(this,"recordingWorklet");qn(this,"vuWorklet");qn(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await mT({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const i="audio-recorder-worklet",a=m1(i,Uz);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,i),this.recordingWorklet.port.onmessage=async l=>{const d=l.data.data.int16arrayBuffer;if(d){const f=Vz(d);this.emit("data",f)}},this.source.connect(this.recordingWorklet);const o="vu-meter";await this.audioContext.audioWorklet.addModule(m1(o,gT)),this.vuWorklet=new AudioWorkletNode(this.audioContext,o),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var i,a;(i=this.source)==null||i.disconnect(),(a=this.stream)==null||a.getTracks().forEach(o=>o.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const Hz=3,Gz=({active:e,volume:n,hover:t})=>{const i=w.useRef([]);return w.useEffect(()=>{let a=null;const o=()=>{i.current.forEach((l,d)=>{l&&(l.style.height=`${Math.min(24,4+n*(d===1?400:60))}px`)}),a=window.setTimeout(o,100)};return o(),()=>clearTimeout(a)},[n]),r.jsx("div",{className:Jc("audioPulse",{active:e,hover:t}),children:Array(Hz).fill(null).map((a,o)=>r.jsx("div",{ref:l=>{i.current[o]=l},style:{animationDelay:`${o*133}ms`}},o))})};var Fm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Yz=Fm.exports,SC;function Wz(){return SC||(SC=1,function(e,n){(function(){var t,i="4.17.21",a=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",u=500,p="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,T=1,P=2,M=4,I=8,U=16,L=32,F=64,z=128,$=256,B=512,R=30,V="...",Y=800,ie=16,te=1,W=2,H=3,Q=1/0,J=9007199254740991,fe=17976931348623157e292,A=NaN,oe=4294967295,ue=oe-1,D=oe>>>1,se=[["ary",z],["bind",T],["bindKey",P],["curry",I],["curryRight",U],["flip",B],["partial",L],["partialRight",F],["rearg",$]],be="[object Arguments]",ee="[object Array]",ce="[object AsyncFunction]",re="[object Boolean]",Pe="[object Date]",Qe="[object DOMException]",Se="[object Error]",Ne="[object Function]",De="[object GeneratorFunction]",Me="[object Map]",nt="[object Number]",ft="[object Null]",ut="[object Object]",rt="[object Promise]",Nt="[object Proxy]",Ft="[object RegExp]",ye="[object Set]",Te="[object String]",Ye="[object Symbol]",$e="[object Undefined]",_e="[object WeakMap]",X="[object WeakSet]",de="[object ArrayBuffer]",qe="[object DataView]",et="[object Float32Array]",ct="[object Float64Array]",Fe="[object Int8Array]",ot="[object Int16Array]",ve="[object Int32Array]",xe="[object Uint8Array]",Be="[object Uint8ClampedArray]",Ue="[object Uint16Array]",tt="[object Uint32Array]",dt=/\b__p \+= '';/g,qt=/\b(__p \+=) '' \+/g,On=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Tt=/&(?:amp|lt|gt|quot|#39);/g,Rt=/[&<>"']/g,si=RegExp(Tt.source),ki=RegExp(Rt.source),bn=/<%-([\s\S]+?)%>/g,Ti=/<%([\s\S]+?)%>/g,rn=/<%=([\s\S]+?)%>/g,ps=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ql=/^\w*$/,bi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ln=/[\\^$.*+?()[\]{}|]/g,Li=RegExp(Ln.source),Jr=/^\s+/,ms=/\s/,el=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Gd=/\{\n\/\* \[wrapped with (.+)\] \*/,uu=/,? & /,tl=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,nl=/[()=,{}\[\]\/\s]/,no=/\\(\\)?/g,ya=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,gs=/\w*$/,ys=/^[-+]0x[0-9a-f]+$/i,hi=/^0b[01]+$/i,Yd=/^\[object .+?Constructor\]$/,Wd=/^0o[0-7]+$/i,Mr=/^(?:0|[1-9]\d*)$/,io=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vl=/($^)/,Qd=/['\n\r\u2028\u2029\\]/g,xa="\\ud800-\\udfff",Jh="\\u0300-\\u036f",Hl="\\ufe20-\\ufe2f",Gl="\\u20d0-\\u20ff",ur=Jh+Hl+Gl,Yl="\\u2700-\\u27bf",du="a-z\\xdf-\\xf6\\xf8-\\xff",ro="\\xac\\xb1\\xd7\\xf7",il="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fu="\\u2000-\\u206f",Kh=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",hu="A-Z\\xc0-\\xd6\\xd8-\\xde",Fi="\\ufe0e\\ufe0f",pu=ro+il+fu+Kh,rl="[']",Xi="["+xa+"]",xs="["+pu+"]",za="["+ur+"]",mu="\\d+",Zi="["+Yl+"]",ao="["+du+"]",al="[^"+xa+pu+mu+Yl+du+hu+"]",so="\\ud83c[\\udffb-\\udfff]",bs="(?:"+za+"|"+so+")",oo="[^"+xa+"]",Wl="(?:\\ud83c[\\udde6-\\uddff]){2}",Ua="[\\ud800-\\udbff][\\udc00-\\udfff]",vs="["+hu+"]",Ql="\\u200d",Jl="(?:"+ao+"|"+al+")",lo="(?:"+vs+"|"+al+")",gu="(?:"+rl+"(?:d|ll|m|re|s|t|ve))?",Kl="(?:"+rl+"(?:D|LL|M|RE|S|T|VE))?",co=bs+"?",uo="["+Fi+"]?",Xl="(?:"+Ql+"(?:"+[oo,Wl,Ua].join("|")+")"+uo+co+")*",Ba="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ws="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",sl=uo+co+Xl,Zl="(?:"+[Zi,Wl,Ua].join("|")+")"+sl,ol="(?:"+[oo+za+"?",za,Wl,Ua,Xi].join("|")+")",ba=RegExp(rl,"g"),dr=RegExp(za,"g"),fo=RegExp(so+"(?="+so+")|"+ol+sl,"g"),qa=RegExp([vs+"?"+ao+"+"+gu+"(?="+[xs,vs,"$"].join("|")+")",lo+"+"+Kl+"(?="+[xs,vs+Jl,"$"].join("|")+")",vs+"?"+Jl+"+"+gu,vs+"+"+Kl,ws,Ba,mu,Zl].join("|"),"g"),Va=RegExp("["+Ql+xa+ur+Fi+"]"),ll=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ho=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ec=-1,vn={};vn[et]=vn[ct]=vn[Fe]=vn[ot]=vn[ve]=vn[xe]=vn[Be]=vn[Ue]=vn[tt]=!0,vn[be]=vn[ee]=vn[de]=vn[re]=vn[qe]=vn[Pe]=vn[Se]=vn[Ne]=vn[Me]=vn[nt]=vn[ut]=vn[Ft]=vn[ye]=vn[Te]=vn[_e]=!1;var mn={};mn[be]=mn[ee]=mn[de]=mn[qe]=mn[re]=mn[Pe]=mn[et]=mn[ct]=mn[Fe]=mn[ot]=mn[ve]=mn[Me]=mn[nt]=mn[ut]=mn[Ft]=mn[ye]=mn[Te]=mn[Ye]=mn[xe]=mn[Be]=mn[Ue]=mn[tt]=!0,mn[Se]=mn[Ne]=mn[_e]=!1;var tc={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Ei={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},va={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},po={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},er=parseFloat,yu=parseInt,cl=typeof Qc=="object"&&Qc&&Qc.Object===Object&&Qc,wa=typeof self=="object"&&self&&self.Object===Object&&self,ri=cl||wa||Function("return this")(),Ha=n&&!n.nodeType&&n,Ga=Ha&&!0&&e&&!e.nodeType&&e,nc=Ga&&Ga.exports===Ha,Ss=nc&&cl.process,fr=function(){try{var ke=Ga&&Ga.require&&Ga.require("util").types;return ke||Ss&&Ss.binding&&Ss.binding("util")}catch{}}(),Ns=fr&&fr.isArrayBuffer,xu=fr&&fr.isDate,ic=fr&&fr.isMap,rc=fr&&fr.isRegExp,bu=fr&&fr.isSet,ul=fr&&fr.isTypedArray;function qi(ke,He,ze){switch(ze.length){case 0:return ke.call(He);case 1:return ke.call(He,ze[0]);case 2:return ke.call(He,ze[0],ze[1]);case 3:return ke.call(He,ze[0],ze[1],ze[2])}return ke.apply(He,ze)}function vu(ke,He,ze,ht){for(var St=-1,on=ke==null?0:ke.length;++St<on;){var Wn=ke[St];He(ht,Wn,ze(Wn),ke)}return ht}function Vi(ke,He){for(var ze=-1,ht=ke==null?0:ke.length;++ze<ht&&He(ke[ze],ze,ke)!==!1;);return ke}function Jd(ke,He){for(var ze=ke==null?0:ke.length;ze--&&He(ke[ze],ze,ke)!==!1;);return ke}function Nn(ke,He){for(var ze=-1,ht=ke==null?0:ke.length;++ze<ht;)if(!He(ke[ze],ze,ke))return!1;return!0}function hr(ke,He){for(var ze=-1,ht=ke==null?0:ke.length,St=0,on=[];++ze<ht;){var Wn=ke[ze];He(Wn,ze,ke)&&(on[St++]=Wn)}return on}function Cs(ke,He){var ze=ke==null?0:ke.length;return!!ze&&mo(ke,He,0)>-1}function dl(ke,He,ze){for(var ht=-1,St=ke==null?0:ke.length;++ht<St;)if(ze(He,ke[ht]))return!0;return!1}function jn(ke,He){for(var ze=-1,ht=ke==null?0:ke.length,St=Array(ht);++ze<ht;)St[ze]=He(ke[ze],ze,ke);return St}function tr(ke,He){for(var ze=-1,ht=He.length,St=ke.length;++ze<ht;)ke[St+ze]=He[ze];return ke}function wu(ke,He,ze,ht){var St=-1,on=ke==null?0:ke.length;for(ht&&on&&(ze=ke[++St]);++St<on;)ze=He(ze,ke[St],St,ke);return ze}function Kd(ke,He,ze,ht){var St=ke==null?0:ke.length;for(ht&&St&&(ze=ke[--St]);St--;)ze=He(ze,ke[St],St,ke);return ze}function Ya(ke,He){for(var ze=-1,ht=ke==null?0:ke.length;++ze<ht;)if(He(ke[ze],ze,ke))return!0;return!1}var Xd=Sa("length");function Su(ke){return ke.split("")}function ac(ke){return ke.match(tl)||[]}function js(ke,He,ze){var ht;return ze(ke,function(St,on,Wn){if(He(St,on,Wn))return ht=on,!1}),ht}function fl(ke,He,ze,ht){for(var St=ke.length,on=ze+(ht?1:-1);ht?on--:++on<St;)if(He(ke[on],on,ke))return on;return-1}function mo(ke,He,ze){return He===He?af(ke,He,ze):fl(ke,Kr,ze)}function sc(ke,He,ze,ht){for(var St=ze-1,on=ke.length;++St<on;)if(ht(ke[St],He))return St;return-1}function Kr(ke){return ke!==ke}function Zd(ke,He){var ze=ke==null?0:ke.length;return ze?Na(ke,He)/ze:A}function Sa(ke){return function(He){return He==null?t:He[ke]}}function oc(ke){return function(He){return ke==null?t:ke[He]}}function lc(ke,He,ze,ht,St){return St(ke,function(on,Wn,ln){ze=ht?(ht=!1,on):He(ze,on,Wn,ln)}),ze}function _s(ke,He){var ze=ke.length;for(ke.sort(He);ze--;)ke[ze]=ke[ze].value;return ke}function Na(ke,He){for(var ze,ht=-1,St=ke.length;++ht<St;){var on=He(ke[ht]);on!==t&&(ze=ze===t?on:ze+on)}return ze}function pr(ke,He){for(var ze=-1,ht=Array(ke);++ze<ke;)ht[ze]=He(ze);return ht}function Xh(ke,He){return jn(He,function(ze){return[ze,ke[ze]]})}function cc(ke){return ke&&ke.slice(0,hl(ke)+1).replace(Jr,"")}function Hi(ke){return function(He){return ke(He)}}function ks(ke,He){return jn(He,function(ze){return ke[ze]})}function Ts(ke,He){return ke.has(He)}function go(ke,He){for(var ze=-1,ht=ke.length;++ze<ht&&mo(He,ke[ze],0)>-1;);return ze}function yo(ke,He){for(var ze=ke.length;ze--&&mo(He,ke[ze],0)>-1;);return ze}function Zh(ke,He){for(var ze=ke.length,ht=0;ze--;)ke[ze]===He&&++ht;return ht}var uc=oc(tc),ef=oc(Ei);function tf(ke){return"\\"+po[ke]}function Nu(ke,He){return ke==null?t:ke[He]}function Wa(ke){return Va.test(ke)}function Cu(ke){return ll.test(ke)}function nf(ke){for(var He,ze=[];!(He=ke.next()).done;)ze.push(He.value);return ze}function Es(ke){var He=-1,ze=Array(ke.size);return ke.forEach(function(ht,St){ze[++He]=[St,ht]}),ze}function rf(ke,He){return function(ze){return ke(He(ze))}}function $i(ke,He){for(var ze=-1,ht=ke.length,St=0,on=[];++ze<ht;){var Wn=ke[ze];(Wn===He||Wn===p)&&(ke[ze]=p,on[St++]=ze)}return on}function Or(ke){var He=-1,ze=Array(ke.size);return ke.forEach(function(ht){ze[++He]=ht}),ze}function Ca(ke){var He=-1,ze=Array(ke.size);return ke.forEach(function(ht){ze[++He]=[ht,ht]}),ze}function af(ke,He,ze){for(var ht=ze-1,St=ke.length;++ht<St;)if(ke[ht]===He)return ht;return-1}function Gi(ke,He,ze){for(var ht=ze+1;ht--;)if(ke[ht]===He)return ht;return ht}function Lr(ke){return Wa(ke)?_u(ke):Xd(ke)}function nr(ke){return Wa(ke)?ku(ke):Su(ke)}function hl(ke){for(var He=ke.length;He--&&ms.test(ke.charAt(He)););return He}var ju=oc(va);function _u(ke){for(var He=fo.lastIndex=0;fo.test(ke);)++He;return He}function ku(ke){return ke.match(fo)||[]}function sf(ke){return ke.match(qa)||[]}var xo=function ke(He){He=He==null?ri:Qa.defaults(ri.Object(),He,Qa.pick(ri,ho));var ze=He.Array,ht=He.Date,St=He.Error,on=He.Function,Wn=He.Math,ln=He.Object,dc=He.RegExp,of=He.String,Qn=He.TypeError,fc=ze.prototype,ep=on.prototype,As=ln.prototype,pl=He["__core-js_shared__"],ml=ep.toString,gn=As.hasOwnProperty,Fr=0,Tu=function(){var m=/[^.]+$/.exec(pl&&pl.keys&&pl.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),zi=As.toString,mr=ml.call(ln),bo=ri._,Eu=dc("^"+ml.call(gn).replace(Ln,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ja=nc?He.Buffer:t,gr=He.Symbol,Ps=He.Uint8Array,ae=Ja?Ja.allocUnsafe:t,me=rf(ln.getPrototypeOf,ln),le=ln.create,je=As.propertyIsEnumerable,Je=fc.splice,lt=gr?gr.isConcatSpreadable:t,bt=gr?gr.iterator:t,xt=gr?gr.toStringTag:t,mi=function(){try{var m=To(ln,"defineProperty");return m({},"",{}),m}catch{}}(),yr=He.clearTimeout!==ri.clearTimeout&&He.clearTimeout,Ds=ht&&ht.now!==ri.Date.now&&ht.now,tp=He.setTimeout!==ri.setTimeout&&He.setTimeout,hc=Wn.ceil,Is=Wn.floor,vo=ln.getOwnPropertySymbols,lf=Ja?Ja.isBuffer:t,Au=He.isFinite,Xr=fc.join,Zr=rf(ln.keys,ln),Vn=Wn.max,Jn=Wn.min,Rs=ht.now,gl=He.parseInt,np=Wn.random,ip=fc.reverse,Pu=To(He,"DataView"),vi=To(He,"Map"),Kn=To(He,"Promise"),an=To(He,"Set"),ja=To(He,"WeakMap"),xr=To(ln,"create"),pc=ja&&new ja,ea={},mg=qs(Pu),gg=qs(vi),Du=qs(Kn),Iu=qs(an),yg=qs(ja),wo=gr?gr.prototype:t,yl=wo?wo.valueOf:t,So=wo?wo.toString:t;function K(m){if(ai(m)&&!$t(m)&&!(m instanceof Kt)){if(m instanceof br)return m;if(gn.call(m,"__wrapped__"))return Si(m)}return new br(m)}var $r=function(){function m(){}return function(y){if(!Zn(y))return{};if(le)return le(y);m.prototype=y;var _=new m;return m.prototype=t,_}}();function ta(){}function br(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}K.templateSettings={escape:bn,evaluate:Ti,interpolate:rn,variable:"",imports:{_:K}},K.prototype=ta.prototype,K.prototype.constructor=K,br.prototype=$r(ta.prototype),br.prototype.constructor=br;function Kt(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=oe,this.__views__=[]}function Ru(){var m=new Kt(this.__wrapped__);return m.__actions__=wi(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=wi(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=wi(this.__views__),m}function cf(){if(this.__filtered__){var m=new Kt(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function xl(){var m=this.__wrapped__.value(),y=this.__dir__,_=$t(m),O=y<0,G=_?m.length:0,ne=Jg(0,G,this.__views__),he=ne.start,we=ne.end,Ae=we-he,Ke=O?we:he-1,Ze=this.__iteratees__,it=Ze.length,gt=0,vt=Jn(Ae,this.__takeCount__);if(!_||!O&&G==Ae&&vt==Ae)return Og(m,this.__actions__);var Mt=[];e:for(;Ae--&&gt<vt;){Ke+=y;for(var Zt=-1,Ot=m[Ke];++Zt<it;){var un=Ze[Zt],xn=un.iteratee,Da=un.type,Gr=xn(Ot);if(Da==W)Ot=Gr;else if(!Gr){if(Da==te)continue e;break e}}Mt[gt++]=Ot}return Mt}Kt.prototype=$r(ta.prototype),Kt.prototype.constructor=Kt;function oi(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function uf(){this.__data__=xr?xr(null):{},this.size=0}function xg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function Yb(m){var y=this.__data__;if(xr){var _=y[m];return _===f?t:_}return gn.call(y,m)?y[m]:t}function Wb(m){var y=this.__data__;return xr?y[m]!==t:gn.call(y,m)}function Qb(m,y){var _=this.__data__;return this.size+=this.has(m)?0:1,_[m]=xr&&y===t?f:y,this}oi.prototype.clear=uf,oi.prototype.delete=xg,oi.prototype.get=Yb,oi.prototype.has=Wb,oi.prototype.set=Qb;function Fn(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function rp(){this.__data__=[],this.size=0}function Mu(m){var y=this.__data__,_=yc(y,m);if(_<0)return!1;var O=y.length-1;return _==O?y.pop():Je.call(y,_,1),--this.size,!0}function Ou(m){var y=this.__data__,_=yc(y,m);return _<0?t:y[_][1]}function ap(m){return yc(this.__data__,m)>-1}function mc(m,y){var _=this.__data__,O=yc(_,m);return O<0?(++this.size,_.push([m,y])):_[O][1]=y,this}Fn.prototype.clear=rp,Fn.prototype.delete=Mu,Fn.prototype.get=Ou,Fn.prototype.has=ap,Fn.prototype.set=mc;function vr(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function Jb(){this.size=0,this.__data__={hash:new oi,map:new(vi||Fn),string:new oi}}function bg(m){var y=Nc(this,m).delete(m);return this.size-=y?1:0,y}function Kb(m){return Nc(this,m).get(m)}function vg(m){return Nc(this,m).has(m)}function bl(m,y){var _=Nc(this,m),O=_.size;return _.set(m,y),this.size+=_.size==O?0:1,this}vr.prototype.clear=Jb,vr.prototype.delete=bg,vr.prototype.get=Kb,vr.prototype.has=vg,vr.prototype.set=bl;function Ms(m){var y=-1,_=m==null?0:m.length;for(this.__data__=new vr;++y<_;)this.add(m[y])}function df(m){return this.__data__.set(m,f),this}function wg(m){return this.__data__.has(m)}Ms.prototype.add=Ms.prototype.push=df,Ms.prototype.has=wg;function ir(m){var y=this.__data__=new Fn(m);this.size=y.size}function Sg(){this.__data__=new Fn,this.size=0}function ff(m){var y=this.__data__,_=y.delete(m);return this.size=y.size,_}function sp(m){return this.__data__.get(m)}function Ng(m){return this.__data__.has(m)}function hf(m,y){var _=this.__data__;if(_ instanceof Fn){var O=_.__data__;if(!vi||O.length<a-1)return O.push([m,y]),this.size=++_.size,this;_=this.__data__=new vr(O)}return _.set(m,y),this.size=_.size,this}ir.prototype.clear=Sg,ir.prototype.delete=ff,ir.prototype.get=sp,ir.prototype.has=Ng,ir.prototype.set=hf;function op(m,y){var _=$t(m),O=!_&&Ys(m),G=!_&&!O&&Fo(m),ne=!_&&!O&&!G&&Lc(m),he=_||O||G||ne,we=he?pr(m.length,of):[],Ae=we.length;for(var Ke in m)(y||gn.call(m,Ke))&&!(he&&(Ke=="length"||G&&(Ke=="offset"||Ke=="parent")||ne&&(Ke=="buffer"||Ke=="byteLength"||Ke=="byteOffset")||Ea(Ke,Ae)))&&we.push(Ke);return we}function gc(m){var y=m.length;return y?m[Nf(0,y-1)]:t}function Cg(m,y){return cd(wi(m),ka(y,0,m.length))}function jg(m){return cd(wi(m))}function Ka(m,y,_){(_!==t&&!kr(m[y],_)||_===t&&!(y in m))&&_a(m,y,_)}function vl(m,y,_){var O=m[y];(!(gn.call(m,y)&&kr(O,_))||_===t&&!(y in m))&&_a(m,y,_)}function yc(m,y){for(var _=m.length;_--;)if(kr(m[_][0],y))return _;return-1}function No(m,y,_,O){return Ls(m,function(G,ne,he){y(O,G,_(G),he)}),O}function Os(m,y){return m&&Nr(y,ji(y),m)}function Lu(m,y){return m&&Nr(y,Di(y),m)}function _a(m,y,_){y=="__proto__"&&mi?mi(m,y,{configurable:!0,enumerable:!0,value:_,writable:!0}):m[y]=_}function Fu(m,y){for(var _=-1,O=y.length,G=ze(O),ne=m==null;++_<O;)G[_]=ne?t:Nd(m,y[_]);return G}function ka(m,y,_){return m===m&&(_!==t&&(m=m<=_?m:_),y!==t&&(m=m>=y?m:y)),m}function Yi(m,y,_,O,G,ne){var he,we=y&g,Ae=y&b,Ke=y&v;if(_&&(he=G?_(m,O,G,ne):_(m)),he!==t)return he;if(!Zn(m))return m;var Ze=$t(m);if(Ze){if(he=Ip(m),!we)return wi(m,he)}else{var it=Pi(m),gt=it==Ne||it==De;if(Fo(m))return jp(m,we);if(it==ut||it==be||gt&&!G){if(he=Ae||gt?{}:Rp(m),!we)return Ae?Ku(m,Lu(he,m)):Ef(m,Os(he,m))}else{if(!mn[it])return G?m:{};he=Mp(m,it,we)}}ne||(ne=new ir);var vt=ne.get(m);if(vt)return vt;ne.set(m,he),By(m)?m.forEach(function(Ot){he.add(Yi(Ot,y,_,Ot,m,ne))}):eh(m)&&m.forEach(function(Ot,un){he.set(un,Yi(Ot,y,_,un,m,ne))});var Mt=Ke?Ae?If:Df:Ae?Di:ji,Zt=Ze?t:Mt(m);return Vi(Zt||m,function(Ot,un){Zt&&(un=Ot,Ot=m[un]),vl(he,un,Yi(Ot,y,_,un,m,ne))}),he}function _g(m){var y=ji(m);return function(_){return lp(_,m,y)}}function lp(m,y,_){var O=_.length;if(m==null)return!O;for(m=ln(m);O--;){var G=_[O],ne=y[G],he=m[G];if(he===t&&!(G in m)||!ne(he))return!1}return!0}function wl(m,y,_){if(typeof m!="function")throw new Qn(l);return jc(function(){m.apply(t,_)},y)}function Co(m,y,_,O){var G=-1,ne=Cs,he=!0,we=m.length,Ae=[],Ke=y.length;if(!we)return Ae;_&&(y=jn(y,Hi(_))),O?(ne=dl,he=!1):y.length>=a&&(ne=Ts,he=!1,y=new Ms(y));e:for(;++G<we;){var Ze=m[G],it=_==null?Ze:_(Ze);if(Ze=O||Ze!==0?Ze:0,he&&it===it){for(var gt=Ke;gt--;)if(y[gt]===it)continue e;Ae.push(Ze)}else ne(y,it,O)||Ae.push(Ze)}return Ae}var Ls=Ep(Wi),pf=Ep(bc,!0);function cp(m,y){var _=!0;return Ls(m,function(O,G,ne){return _=!!y(O,G,ne),_}),_}function Ta(m,y,_){for(var O=-1,G=m.length;++O<G;){var ne=m[O],he=y(ne);if(he!=null&&(we===t?he===he&&!sr(he):_(he,we)))var we=he,Ae=ne}return Ae}function Wt(m,y,_,O){var G=m.length;for(_=Bt(_),_<0&&(_=-_>G?0:G+_),O=O===t||O>G?G:Bt(O),O<0&&(O+=G),O=_>O?0:ss(O);_<O;)m[_++]=y;return m}function kn(m,y){var _=[];return Ls(m,function(O,G,ne){y(O,G,ne)&&_.push(O)}),_}function sn(m,y,_,O,G){var ne=-1,he=m.length;for(_||(_=Us),G||(G=[]);++ne<he;){var we=m[ne];y>0&&_(we)?y>1?sn(we,y-1,_,O,G):tr(G,we):O||(G[G.length]=we)}return G}var xc=Tl(),Sl=Tl(!0);function Wi(m,y){return m&&xc(m,y,ji)}function bc(m,y){return m&&Sl(m,y,ji)}function jo(m,y){return hr(y,function(_){return Aa(m[_])})}function na(m,y){y=$s(y,m);for(var _=0,O=y.length;m!=null&&_<O;)m=m[_n(y[_++])];return _&&_==O?m:t}function kg(m,y,_){var O=y(m);return $t(m)?O:tr(O,_(m))}function cn(m){return m==null?m===t?$e:ft:xt&&xt in ln(m)?Qg(m):ty(m)}function $u(m,y){return m>y}function up(m,y){return m!=null&&gn.call(m,y)}function Tg(m,y){return m!=null&&y in ln(m)}function Eg(m,y,_){return m>=Jn(y,_)&&m<Vn(y,_)}function dp(m,y,_){for(var O=_?dl:Cs,G=m[0].length,ne=m.length,he=ne,we=ze(ne),Ae=1/0,Ke=[];he--;){var Ze=m[he];he&&y&&(Ze=jn(Ze,Hi(y))),Ae=Jn(Ze.length,Ae),we[he]=!_&&(y||G>=120&&Ze.length>=120)?new Ms(he&&Ze):t}Ze=m[0];var it=-1,gt=we[0];e:for(;++it<G&&Ke.length<Ae;){var vt=Ze[it],Mt=y?y(vt):vt;if(vt=_||vt!==0?vt:0,!(gt?Ts(gt,Mt):O(Ke,Mt,_))){for(he=ne;--he;){var Zt=we[he];if(!(Zt?Ts(Zt,Mt):O(m[he],Mt,_)))continue e}gt&&gt.push(Mt),Ke.push(vt)}}return Ke}function fp(m,y,_,O){return Wi(m,function(G,ne,he){y(O,_(G),ne,he)}),O}function Nl(m,y,_){y=$s(y,m),m=Cc(m,y);var O=m==null?m:m[_n(Qi(y))];return O==null?t:qi(O,m,_)}function mf(m){return ai(m)&&cn(m)==be}function wr(m){return ai(m)&&cn(m)==de}function gi(m){return ai(m)&&cn(m)==Pe}function Cl(m,y,_,O,G){return m===y?!0:m==null||y==null||!ai(m)&&!ai(y)?m!==m&&y!==y:zu(m,y,_,O,Cl,G)}function zu(m,y,_,O,G,ne){var he=$t(m),we=$t(y),Ae=he?ee:Pi(m),Ke=we?ee:Pi(y);Ae=Ae==be?ut:Ae,Ke=Ke==be?ut:Ke;var Ze=Ae==ut,it=Ke==ut,gt=Ae==Ke;if(gt&&Fo(m)){if(!Fo(y))return!1;he=!0,Ze=!1}if(gt&&!Ze)return ne||(ne=new ir),he||Lc(m)?Yg(m,y,_,O,G,ne):Wg(m,y,Ae,_,O,G,ne);if(!(_&S)){var vt=Ze&&gn.call(m,"__wrapped__"),Mt=it&&gn.call(y,"__wrapped__");if(vt||Mt){var Zt=vt?m.value():m,Ot=Mt?y.value():y;return ne||(ne=new ir),G(Zt,Ot,_,O,ne)}}return gt?(ne||(ne=new ir),Ai(m,y,_,O,G,ne)):!1}function gf(m){return ai(m)&&Pi(m)==Me}function Uu(m,y,_,O){var G=_.length,ne=G,he=!O;if(m==null)return!ne;for(m=ln(m);G--;){var we=_[G];if(he&&we[2]?we[1]!==m[we[0]]:!(we[0]in m))return!1}for(;++G<ne;){we=_[G];var Ae=we[0],Ke=m[Ae],Ze=we[1];if(he&&we[2]){if(Ke===t&&!(Ae in m))return!1}else{var it=new ir;if(O)var gt=O(Ke,Ze,Ae,m,y,it);if(!(gt===t?Cl(Ze,Ke,S|k,O,it):gt))return!1}}return!0}function Xa(m){if(!Zn(m)||$f(m))return!1;var y=Aa(m)?Eu:Yd;return y.test(qs(m))}function yf(m){return ai(m)&&cn(m)==Ft}function hp(m){return ai(m)&&Pi(m)==ye}function pp(m){return ai(m)&&Il(m.length)&&!!vn[cn(m)]}function mp(m){return typeof m=="function"?m:m==null?Oe:typeof m=="object"?$t(m)?vf(m[0],m[1]):yp(m):yn(m)}function xf(m){if(!$n(m))return Zr(m);var y=[];for(var _ in ln(m))gn.call(m,_)&&_!="constructor"&&y.push(_);return y}function Ag(m){if(!Zn(m))return Eo(m);var y=$n(m),_=[];for(var O in m)O=="constructor"&&(y||!gn.call(m,O))||_.push(O);return _}function bf(m,y){return m<y}function gp(m,y){var _=-1,O=Ni(m)?ze(m.length):[];return Ls(m,function(G,ne,he){O[++_]=y(G,ne,he)}),O}function yp(m){var y=Mf(m);return y.length==1&&y[0][2]?Zg(y[0][0],y[0][1]):function(_){return _===m||Uu(_,m,y)}}function vf(m,y){return Lf(m)&&Xg(y)?Zg(_n(m),y):function(_){var O=Nd(_,m);return O===t&&O===y?Uc(_,m):Cl(y,O,S|k)}}function Bu(m,y,_,O,G){m!==y&&xc(y,function(ne,he){if(G||(G=new ir),Zn(ne))Xb(m,y,he,_,Bu,O,G);else{var we=O?O(zf(m,he),ne,he+"",m,y,G):t;we===t&&(we=ne),Ka(m,he,we)}},Di)}function Xb(m,y,_,O,G,ne,he){var we=zf(m,_),Ae=zf(y,_),Ke=he.get(Ae);if(Ke){Ka(m,_,Ke);return}var Ze=ne?ne(we,Ae,_+"",m,y,he):t,it=Ze===t;if(it){var gt=$t(Ae),vt=!gt&&Fo(Ae),Mt=!gt&&!vt&&Lc(Ae);Ze=Ae,gt||vt||Mt?$t(we)?Ze=we:ui(we)?Ze=wi(we):vt?(it=!1,Ze=jp(Ae,!0)):Mt?(it=!1,Ze=kp(Ae,!0)):Ze=[]:sa(Ae)||Ys(Ae)?(Ze=we,Ys(we)?Ze=Hy(we):(!Zn(we)||Aa(we))&&(Ze=Rp(Ae))):it=!1}it&&(he.set(Ae,Ze),G(Ze,Ae,O,ne,he),he.delete(Ae)),Ka(m,_,Ze)}function xp(m,y){var _=m.length;if(_)return y+=y<0?_:0,Ea(y,_)?m[y]:t}function bp(m,y,_){y.length?y=jn(y,function(ne){return $t(ne)?function(he){return na(he,ne.length===1?ne[0]:ne)}:ne}):y=[Oe];var O=-1;y=jn(y,Hi(Ct()));var G=gp(m,function(ne,he,we){var Ae=jn(y,function(Ke){return Ke(ne)});return{criteria:Ae,index:++O,value:ne}});return _s(G,function(ne,he){return zg(ne,he,_)})}function Pg(m,y){return wf(m,y,function(_,O){return Uc(m,O)})}function wf(m,y,_){for(var O=-1,G=y.length,ne={};++O<G;){var he=y[O],we=na(m,he);_(we,he)&&wc(ne,$s(he,m),we)}return ne}function Dg(m){return function(y){return na(y,m)}}function Sf(m,y,_,O){var G=O?sc:mo,ne=-1,he=y.length,we=m;for(m===y&&(y=wi(y)),_&&(we=jn(m,Hi(_)));++ne<he;)for(var Ae=0,Ke=y[ne],Ze=_?_(Ke):Ke;(Ae=G(we,Ze,Ae,O))>-1;)we!==m&&Je.call(we,Ae,1),Je.call(m,Ae,1);return m}function vp(m,y){for(var _=m?y.length:0,O=_-1;_--;){var G=y[_];if(_==O||G!==ne){var ne=G;Ea(G)?Je.call(m,G,1):Gu(m,G)}}return m}function Nf(m,y){return m+Is(np()*(y-m+1))}function Ig(m,y,_,O){for(var G=-1,ne=Vn(hc((y-m)/(_||1)),0),he=ze(ne);ne--;)he[O?ne:++G]=m,m+=_;return he}function wp(m,y){var _="";if(!m||y<1||y>J)return _;do y%2&&(_+=m),y=Is(y/2),y&&(m+=m);while(y);return _}function Vt(m,y){return od(Op(m,y,Oe),m+"")}function vc(m){return gc(qc(m))}function Cf(m,y){var _=qc(m);return cd(_,ka(y,0,_.length))}function wc(m,y,_,O){if(!Zn(m))return m;y=$s(y,m);for(var G=-1,ne=y.length,he=ne-1,we=m;we!=null&&++G<ne;){var Ae=_n(y[G]),Ke=_;if(Ae==="__proto__"||Ae==="constructor"||Ae==="prototype")return m;if(G!=he){var Ze=we[Ae];Ke=O?O(Ze,Ae,we):t,Ke===t&&(Ke=Zn(Ze)?Ze:Ea(y[G+1])?[]:{})}vl(we,Ae,Ke),we=we[Ae]}return m}var qu=pc?function(m,y){return pc.set(m,y),m}:Oe,Vu=mi?function(m,y){return mi(m,"toString",{configurable:!0,enumerable:!1,value:Re(y),writable:!0})}:Oe;function Rg(m){return cd(qc(m))}function zr(m,y,_){var O=-1,G=m.length;y<0&&(y=-y>G?0:G+y),_=_>G?G:_,_<0&&(_+=G),G=y>_?0:_-y>>>0,y>>>=0;for(var ne=ze(G);++O<G;)ne[O]=m[O+y];return ne}function Mg(m,y){var _;return Ls(m,function(O,G,ne){return _=y(O,G,ne),!_}),!!_}function Hu(m,y,_){var O=0,G=m==null?O:m.length;if(typeof y=="number"&&y===y&&G<=D){for(;O<G;){var ne=O+G>>>1,he=m[ne];he!==null&&!sr(he)&&(_?he<=y:he<y)?O=ne+1:G=ne}return G}return jf(m,y,Oe,_)}function jf(m,y,_,O){var G=0,ne=m==null?0:m.length;if(ne===0)return 0;y=_(y);for(var he=y!==y,we=y===null,Ae=sr(y),Ke=y===t;G<ne;){var Ze=Is((G+ne)/2),it=_(m[Ze]),gt=it!==t,vt=it===null,Mt=it===it,Zt=sr(it);if(he)var Ot=O||Mt;else Ke?Ot=Mt&&(O||gt):we?Ot=Mt&&gt&&(O||!vt):Ae?Ot=Mt&&gt&&!vt&&(O||!Zt):vt||Zt?Ot=!1:Ot=O?it<=y:it<y;Ot?G=Ze+1:ne=Ze}return Jn(ne,ue)}function Sp(m,y){for(var _=-1,O=m.length,G=0,ne=[];++_<O;){var he=m[_],we=y?y(he):he;if(!_||!kr(we,Ae)){var Ae=we;ne[G++]=he===0?0:he}}return ne}function _f(m){return typeof m=="number"?m:sr(m)?A:+m}function Sr(m){if(typeof m=="string")return m;if($t(m))return jn(m,Sr)+"";if(sr(m))return So?So.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Fs(m,y,_){var O=-1,G=Cs,ne=m.length,he=!0,we=[],Ae=we;if(_)he=!1,G=dl;else if(ne>=a){var Ke=y?null:Hg(m);if(Ke)return Or(Ke);he=!1,G=Ts,Ae=new Ms}else Ae=y?[]:we;e:for(;++O<ne;){var Ze=m[O],it=y?y(Ze):Ze;if(Ze=_||Ze!==0?Ze:0,he&&it===it){for(var gt=Ae.length;gt--;)if(Ae[gt]===it)continue e;y&&Ae.push(it),we.push(Ze)}else G(Ae,it,_)||(Ae!==we&&Ae.push(it),we.push(Ze))}return we}function Gu(m,y){return y=$s(y,m),m=Cc(m,y),m==null||delete m[_n(Qi(y))]}function Np(m,y,_,O){return wc(m,y,_(na(m,y)),O)}function Yu(m,y,_,O){for(var G=m.length,ne=O?G:-1;(O?ne--:++ne<G)&&y(m[ne],ne,m););return _?zr(m,O?0:ne,O?ne+1:G):zr(m,O?ne+1:0,O?G:ne)}function Og(m,y){var _=m;return _ instanceof Kt&&(_=_.value()),wu(y,function(O,G){return G.func.apply(G.thisArg,tr([O],G.args))},_)}function Wu(m,y,_){var O=m.length;if(O<2)return O?Fs(m[0]):[];for(var G=-1,ne=ze(O);++G<O;)for(var he=m[G],we=-1;++we<O;)we!=G&&(ne[G]=Co(ne[G]||he,m[we],y,_));return Fs(sn(ne,1),y,_)}function Cp(m,y,_){for(var O=-1,G=m.length,ne=y.length,he={};++O<G;){var we=O<ne?y[O]:t;_(he,m[O],we)}return he}function kf(m){return ui(m)?m:[]}function Qu(m){return typeof m=="function"?m:Oe}function $s(m,y){return $t(m)?m:Lf(m,y)?[m]:ns(Cn(m))}var Lg=Vt;function _o(m,y,_){var O=m.length;return _=_===t?O:_,!y&&_>=O?m:zr(m,y,_)}var Fg=yr||function(m){return ri.clearTimeout(m)};function jp(m,y){if(y)return m.slice();var _=m.length,O=ae?ae(_):new m.constructor(_);return m.copy(O),O}function jl(m){var y=new m.constructor(m.byteLength);return new Ps(y).set(new Ps(m)),y}function _p(m,y){var _=y?jl(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.byteLength)}function Tf(m){var y=new m.constructor(m.source,gs.exec(m));return y.lastIndex=m.lastIndex,y}function $g(m){return yl?ln(yl.call(m)):{}}function kp(m,y){var _=y?jl(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.length)}function Ju(m,y){if(m!==y){var _=m!==t,O=m===null,G=m===m,ne=sr(m),he=y!==t,we=y===null,Ae=y===y,Ke=sr(y);if(!we&&!Ke&&!ne&&m>y||ne&&he&&Ae&&!we&&!Ke||O&&he&&Ae||!_&&Ae||!G)return 1;if(!O&&!ne&&!Ke&&m<y||Ke&&_&&G&&!O&&!ne||we&&_&&G||!he&&G||!Ae)return-1}return 0}function zg(m,y,_){for(var O=-1,G=m.criteria,ne=y.criteria,he=G.length,we=_.length;++O<he;){var Ae=Ju(G[O],ne[O]);if(Ae){if(O>=we)return Ae;var Ke=_[O];return Ae*(Ke=="desc"?-1:1)}}return m.index-y.index}function Tp(m,y,_,O){for(var G=-1,ne=m.length,he=_.length,we=-1,Ae=y.length,Ke=Vn(ne-he,0),Ze=ze(Ae+Ke),it=!O;++we<Ae;)Ze[we]=y[we];for(;++G<he;)(it||G<ne)&&(Ze[_[G]]=m[G]);for(;Ke--;)Ze[we++]=m[G++];return Ze}function Ug(m,y,_,O){for(var G=-1,ne=m.length,he=-1,we=_.length,Ae=-1,Ke=y.length,Ze=Vn(ne-we,0),it=ze(Ze+Ke),gt=!O;++G<Ze;)it[G]=m[G];for(var vt=G;++Ae<Ke;)it[vt+Ae]=y[Ae];for(;++he<we;)(gt||G<ne)&&(it[vt+_[he]]=m[G++]);return it}function wi(m,y){var _=-1,O=m.length;for(y||(y=ze(O));++_<O;)y[_]=m[_];return y}function Nr(m,y,_,O){var G=!_;_||(_={});for(var ne=-1,he=y.length;++ne<he;){var we=y[ne],Ae=O?O(_[we],m[we],we,_,m):t;Ae===t&&(Ae=m[we]),G?_a(_,we,Ae):vl(_,we,Ae)}return _}function Ef(m,y){return Nr(m,id(m),y)}function Ku(m,y){return Nr(m,Of(m),y)}function _l(m,y){return function(_,O){var G=$t(_)?vu:No,ne=y?y():{};return G(_,m,Ct(O,2),ne)}}function kl(m){return Vt(function(y,_){var O=-1,G=_.length,ne=G>1?_[G-1]:t,he=G>2?_[2]:t;for(ne=m.length>3&&typeof ne=="function"?(G--,ne):t,he&&ar(_[0],_[1],he)&&(ne=G<3?t:ne,G=1),y=ln(y);++O<G;){var we=_[O];we&&m(y,we,O,ne)}return y})}function Ep(m,y){return function(_,O){if(_==null)return _;if(!Ni(_))return m(_,O);for(var G=_.length,ne=y?G:-1,he=ln(_);(y?ne--:++ne<G)&&O(he[ne],ne,he)!==!1;);return _}}function Tl(m){return function(y,_,O){for(var G=-1,ne=ln(y),he=O(y),we=he.length;we--;){var Ae=he[m?we:++G];if(_(ne[Ae],Ae,ne)===!1)break}return y}}function Bg(m,y,_){var O=y&T,G=ia(m);function ne(){var he=this&&this!==ri&&this instanceof ne?G:m;return he.apply(O?_:this,arguments)}return ne}function Ur(m){return function(y){y=Cn(y);var _=Wa(y)?nr(y):t,O=_?_[0]:y.charAt(0),G=_?_o(_,1).join(""):y.slice(1);return O[m]()+G}}function rr(m){return function(y){return wu(N(Ws(y).replace(ba,"")),m,"")}}function ia(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var _=$r(m.prototype),O=m.apply(_,y);return Zn(O)?O:_}}function qg(m,y,_){var O=ia(m);function G(){for(var ne=arguments.length,he=ze(ne),we=ne,Ae=Al(G);we--;)he[we]=arguments[we];var Ke=ne<3&&he[0]!==Ae&&he[ne-1]!==Ae?[]:$i(he,Ae);if(ne-=Ke.length,ne<_)return Ap(m,y,li,G.placeholder,t,he,Ke,t,t,_-ne);var Ze=this&&this!==ri&&this instanceof G?O:m;return qi(Ze,this,he)}return G}function zs(m){return function(y,_,O){var G=ln(y);if(!Ni(y)){var ne=Ct(_,3);y=ji(y),_=function(we){return ne(G[we],we,G)}}var he=m(y,_,O);return he>-1?G[ne?y[he]:he]:t}}function Za(m){return Hn(function(y){var _=y.length,O=_,G=br.prototype.thru;for(m&&y.reverse();O--;){var ne=y[O];if(typeof ne!="function")throw new Qn(l);if(G&&!he&&nd(ne)=="wrapper")var he=new br([],!0)}for(O=he?O:_;++O<_;){ne=y[O];var we=nd(ne),Ae=we=="wrapper"?Rf(ne):t;Ae&&Ff(Ae[0])&&Ae[1]==(z|I|L|$)&&!Ae[4].length&&Ae[9]==1?he=he[nd(Ae[0])].apply(he,Ae[3]):he=ne.length==1&&Ff(ne)?he[we]():he.thru(ne)}return function(){var Ke=arguments,Ze=Ke[0];if(he&&Ke.length==1&&$t(Ze))return he.plant(Ze).value();for(var it=0,gt=_?y[it].apply(this,Ke):Ze;++it<_;)gt=y[it].call(this,gt);return gt}})}function li(m,y,_,O,G,ne,he,we,Ae,Ke){var Ze=y&z,it=y&T,gt=y&P,vt=y&(I|U),Mt=y&B,Zt=gt?t:ia(m);function Ot(){for(var un=arguments.length,xn=ze(un),Da=un;Da--;)xn[Da]=arguments[Da];if(vt)var Gr=Al(Ot),Ia=Zh(xn,Gr);if(O&&(xn=Tp(xn,O,G,vt)),ne&&(xn=Ug(xn,ne,he,vt)),un-=Ia,vt&&un<Ke){var _i=$i(xn,Gr);return Ap(m,y,li,Ot.placeholder,_,xn,_i,we,Ae,Ke-un)}var Qs=it?_:this,Rl=gt?Qs[m]:m;return un=xn.length,we?xn=ts(xn,we):Mt&&un>1&&xn.reverse(),Ze&&Ae<un&&(xn.length=Ae),this&&this!==ri&&this instanceof Ot&&(Rl=Zt||ia(Rl)),Rl.apply(Qs,xn)}return Ot}function Xu(m,y){return function(_,O){return fp(_,m,y(O),{})}}function Sc(m,y){return function(_,O){var G;if(_===t&&O===t)return y;if(_!==t&&(G=_),O!==t){if(G===t)return O;typeof _=="string"||typeof O=="string"?(_=Sr(_),O=Sr(O)):(_=_f(_),O=_f(O)),G=m(_,O)}return G}}function Zu(m){return Hn(function(y){return y=jn(y,Hi(Ct())),Vt(function(_){var O=this;return m(y,function(G){return qi(G,O,_)})})})}function ed(m,y){y=y===t?" ":Sr(y);var _=y.length;if(_<2)return _?wp(y,m):y;var O=wp(y,hc(m/Lr(y)));return Wa(y)?_o(nr(O),0,m).join(""):O.slice(0,m)}function Vg(m,y,_,O){var G=y&T,ne=ia(m);function he(){for(var we=-1,Ae=arguments.length,Ke=-1,Ze=O.length,it=ze(Ze+Ae),gt=this&&this!==ri&&this instanceof he?ne:m;++Ke<Ze;)it[Ke]=O[Ke];for(;Ae--;)it[Ke++]=arguments[++we];return qi(gt,G?_:this,it)}return he}function ko(m){return function(y,_,O){return O&&typeof O!="number"&&ar(y,_,O)&&(_=O=t),y=as(y),_===t?(_=y,y=0):_=as(_),O=O===t?y<_?1:-1:as(O),Ig(y,_,O,m)}}function El(m){return function(y,_){return typeof y=="string"&&typeof _=="string"||(y=oa(y),_=oa(_)),m(y,_)}}function Ap(m,y,_,O,G,ne,he,we,Ae,Ke){var Ze=y&I,it=Ze?he:t,gt=Ze?t:he,vt=Ze?ne:t,Mt=Ze?t:ne;y|=Ze?L:F,y&=~(Ze?F:L),y&M||(y&=-4);var Zt=[m,y,G,vt,it,Mt,gt,we,Ae,Ke],Ot=_.apply(t,Zt);return Ff(m)&&Uf(Ot,Zt),Ot.placeholder=O,Bf(Ot,m,y)}function Af(m){var y=Wn[m];return function(_,O){if(_=oa(_),O=O==null?0:Jn(Bt(O),292),O&&Au(_)){var G=(Cn(_)+"e").split("e"),ne=y(G[0]+"e"+(+G[1]+O));return G=(Cn(ne)+"e").split("e"),+(G[0]+"e"+(+G[1]-O))}return y(_)}}var Hg=an&&1/Or(new an([,-0]))[1]==Q?function(m){return new an(m)}:yt;function td(m){return function(y){var _=Pi(y);return _==Me?Es(y):_==ye?Ca(y):Xh(y,m(y))}}function es(m,y,_,O,G,ne,he,we){var Ae=y&P;if(!Ae&&typeof m!="function")throw new Qn(l);var Ke=O?O.length:0;if(Ke||(y&=-97,O=G=t),he=he===t?he:Vn(Bt(he),0),we=we===t?we:Bt(we),Ke-=G?G.length:0,y&F){var Ze=O,it=G;O=G=t}var gt=Ae?t:Rf(m),vt=[m,y,_,O,G,Ze,it,ne,he,we];if(gt&&sd(vt,gt),m=vt[0],y=vt[1],_=vt[2],O=vt[3],G=vt[4],we=vt[9]=vt[9]===t?Ae?0:m.length:Vn(vt[9]-Ke,0),!we&&y&(I|U)&&(y&=-25),!y||y==T)var Mt=Bg(m,y,_);else y==I||y==U?Mt=qg(m,y,we):(y==L||y==(T|L))&&!G.length?Mt=Vg(m,y,_,O):Mt=li.apply(t,vt);var Zt=gt?qu:Uf;return Bf(Zt(Mt,vt),m,y)}function Pf(m,y,_,O){return m===t||kr(m,As[_])&&!gn.call(O,_)?y:m}function Pp(m,y,_,O,G,ne){return Zn(m)&&Zn(y)&&(ne.set(y,m),Bu(m,y,t,Pp,ne),ne.delete(y)),m}function Gg(m){return sa(m)?t:m}function Yg(m,y,_,O,G,ne){var he=_&S,we=m.length,Ae=y.length;if(we!=Ae&&!(he&&Ae>we))return!1;var Ke=ne.get(m),Ze=ne.get(y);if(Ke&&Ze)return Ke==y&&Ze==m;var it=-1,gt=!0,vt=_&k?new Ms:t;for(ne.set(m,y),ne.set(y,m);++it<we;){var Mt=m[it],Zt=y[it];if(O)var Ot=he?O(Zt,Mt,it,y,m,ne):O(Mt,Zt,it,m,y,ne);if(Ot!==t){if(Ot)continue;gt=!1;break}if(vt){if(!Ya(y,function(un,xn){if(!Ts(vt,xn)&&(Mt===un||G(Mt,un,_,O,ne)))return vt.push(xn)})){gt=!1;break}}else if(!(Mt===Zt||G(Mt,Zt,_,O,ne))){gt=!1;break}}return ne.delete(m),ne.delete(y),gt}function Wg(m,y,_,O,G,ne,he){switch(_){case qe:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case de:return!(m.byteLength!=y.byteLength||!ne(new Ps(m),new Ps(y)));case re:case Pe:case nt:return kr(+m,+y);case Se:return m.name==y.name&&m.message==y.message;case Ft:case Te:return m==y+"";case Me:var we=Es;case ye:var Ae=O&S;if(we||(we=Or),m.size!=y.size&&!Ae)return!1;var Ke=he.get(m);if(Ke)return Ke==y;O|=k,he.set(m,y);var Ze=Yg(we(m),we(y),O,G,ne,he);return he.delete(m),Ze;case Ye:if(yl)return yl.call(m)==yl.call(y)}return!1}function Ai(m,y,_,O,G,ne){var he=_&S,we=Df(m),Ae=we.length,Ke=Df(y),Ze=Ke.length;if(Ae!=Ze&&!he)return!1;for(var it=Ae;it--;){var gt=we[it];if(!(he?gt in y:gn.call(y,gt)))return!1}var vt=ne.get(m),Mt=ne.get(y);if(vt&&Mt)return vt==y&&Mt==m;var Zt=!0;ne.set(m,y),ne.set(y,m);for(var Ot=he;++it<Ae;){gt=we[it];var un=m[gt],xn=y[gt];if(O)var Da=he?O(xn,un,gt,y,m,ne):O(un,xn,gt,m,y,ne);if(!(Da===t?un===xn||G(un,xn,_,O,ne):Da)){Zt=!1;break}Ot||(Ot=gt=="constructor")}if(Zt&&!Ot){var Gr=m.constructor,Ia=y.constructor;Gr!=Ia&&"constructor"in m&&"constructor"in y&&!(typeof Gr=="function"&&Gr instanceof Gr&&typeof Ia=="function"&&Ia instanceof Ia)&&(Zt=!1)}return ne.delete(m),ne.delete(y),Zt}function Hn(m){return od(Op(m,t,jr),m+"")}function Df(m){return kg(m,ji,id)}function If(m){return kg(m,Di,Of)}var Rf=pc?function(m){return pc.get(m)}:yt;function nd(m){for(var y=m.name+"",_=ea[y],O=gn.call(ea,y)?_.length:0;O--;){var G=_[O],ne=G.func;if(ne==null||ne==m)return G.name}return y}function Al(m){var y=gn.call(K,"placeholder")?K:m;return y.placeholder}function Ct(){var m=K.iteratee||At;return m=m===At?mp:m,arguments.length?m(arguments[0],arguments[1]):m}function Nc(m,y){var _=m.__data__;return Bs(y)?_[typeof y=="string"?"string":"hash"]:_.map}function Mf(m){for(var y=ji(m),_=y.length;_--;){var O=y[_],G=m[O];y[_]=[O,G,Xg(G)]}return y}function To(m,y){var _=Nu(m,y);return Xa(_)?_:t}function Qg(m){var y=gn.call(m,xt),_=m[xt];try{m[xt]=t;var O=!0}catch{}var G=zi.call(m);return O&&(y?m[xt]=_:delete m[xt]),G}var id=vo?function(m){return m==null?[]:(m=ln(m),hr(vo(m),function(y){return je.call(m,y)}))}:Mv,Of=vo?function(m){for(var y=[];m;)tr(y,id(m)),m=me(m);return y}:Mv,Pi=cn;(Pu&&Pi(new Pu(new ArrayBuffer(1)))!=qe||vi&&Pi(new vi)!=Me||Kn&&Pi(Kn.resolve())!=rt||an&&Pi(new an)!=ye||ja&&Pi(new ja)!=_e)&&(Pi=function(m){var y=cn(m),_=y==ut?m.constructor:t,O=_?qs(_):"";if(O)switch(O){case mg:return qe;case gg:return Me;case Du:return rt;case Iu:return ye;case yg:return _e}return y});function Jg(m,y,_){for(var O=-1,G=_.length;++O<G;){var ne=_[O],he=ne.size;switch(ne.type){case"drop":m+=he;break;case"dropRight":y-=he;break;case"take":y=Jn(y,m+he);break;case"takeRight":m=Vn(m,y-he);break}}return{start:m,end:y}}function Dp(m){var y=m.match(Gd);return y?y[1].split(uu):[]}function rd(m,y,_){y=$s(y,m);for(var O=-1,G=y.length,ne=!1;++O<G;){var he=_n(y[O]);if(!(ne=m!=null&&_(m,he)))break;m=m[he]}return ne||++O!=G?ne:(G=m==null?0:m.length,!!G&&Il(G)&&Ea(he,G)&&($t(m)||Ys(m)))}function Ip(m){var y=m.length,_=new m.constructor(y);return y&&typeof m[0]=="string"&&gn.call(m,"index")&&(_.index=m.index,_.input=m.input),_}function Rp(m){return typeof m.constructor=="function"&&!$n(m)?$r(me(m)):{}}function Mp(m,y,_){var O=m.constructor;switch(y){case de:return jl(m);case re:case Pe:return new O(+m);case qe:return _p(m,_);case et:case ct:case Fe:case ot:case ve:case xe:case Be:case Ue:case tt:return kp(m,_);case Me:return new O;case nt:case Te:return new O(m);case Ft:return Tf(m);case ye:return new O;case Ye:return $g(m)}}function Kg(m,y){var _=y.length;if(!_)return m;var O=_-1;return y[O]=(_>1?"& ":"")+y[O],y=y.join(_>2?", ":" "),m.replace(el,`{
/* [wrapped with `+y+`] */
`)}function Us(m){return $t(m)||Ys(m)||!!(lt&&m&&m[lt])}function Ea(m,y){var _=typeof m;return y=y??J,!!y&&(_=="number"||_!="symbol"&&Mr.test(m))&&m>-1&&m%1==0&&m<y}function ar(m,y,_){if(!Zn(_))return!1;var O=typeof y;return(O=="number"?Ni(_)&&Ea(y,_.length):O=="string"&&y in _)?kr(_[y],m):!1}function Lf(m,y){if($t(m))return!1;var _=typeof m;return _=="number"||_=="symbol"||_=="boolean"||m==null||sr(m)?!0:ql.test(m)||!ps.test(m)||y!=null&&m in ln(y)}function Bs(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Ff(m){var y=nd(m),_=K[y];if(typeof _!="function"||!(y in Kt.prototype))return!1;if(m===_)return!0;var O=Rf(_);return!!O&&m===O[0]}function $f(m){return!!Tu&&Tu in m}var ad=pl?Aa:Ov;function $n(m){var y=m&&m.constructor,_=typeof y=="function"&&y.prototype||As;return m===_}function Xg(m){return m===m&&!Zn(m)}function Zg(m,y){return function(_){return _==null?!1:_[m]===y&&(y!==t||m in ln(_))}}function ey(m){var y=yd(m,function(O){return _.size===u&&_.clear(),O}),_=y.cache;return y}function sd(m,y){var _=m[1],O=y[1],G=_|O,ne=G<(T|P|z),he=O==z&&_==I||O==z&&_==$&&m[7].length<=y[8]||O==(z|$)&&y[7].length<=y[8]&&_==I;if(!(ne||he))return m;O&T&&(m[2]=y[2],G|=_&T?0:M);var we=y[3];if(we){var Ae=m[3];m[3]=Ae?Tp(Ae,we,y[4]):we,m[4]=Ae?$i(m[3],p):y[4]}return we=y[5],we&&(Ae=m[5],m[5]=Ae?Ug(Ae,we,y[6]):we,m[6]=Ae?$i(m[5],p):y[6]),we=y[7],we&&(m[7]=we),O&z&&(m[8]=m[8]==null?y[8]:Jn(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=G,m}function Eo(m){var y=[];if(m!=null)for(var _ in ln(m))y.push(_);return y}function ty(m){return zi.call(m)}function Op(m,y,_){return y=Vn(y===t?m.length-1:y,0),function(){for(var O=arguments,G=-1,ne=Vn(O.length-y,0),he=ze(ne);++G<ne;)he[G]=O[y+G];G=-1;for(var we=ze(y+1);++G<y;)we[G]=O[G];return we[y]=_(he),qi(m,this,we)}}function Cc(m,y){return y.length<2?m:na(m,zr(y,0,-1))}function ts(m,y){for(var _=m.length,O=Jn(y.length,_),G=wi(m);O--;){var ne=y[O];m[O]=Ea(ne,_)?G[ne]:t}return m}function zf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Uf=ld(qu),jc=tp||function(m,y){return ri.setTimeout(m,y)},od=ld(Vu);function Bf(m,y,_){var O=y+"";return od(m,Kg(O,ny(Dp(O),_)))}function ld(m){var y=0,_=0;return function(){var O=Rs(),G=ie-(O-_);if(_=O,G>0){if(++y>=Y)return arguments[0]}else y=0;return m.apply(t,arguments)}}function cd(m,y){var _=-1,O=m.length,G=O-1;for(y=y===t?O:y;++_<y;){var ne=Nf(_,G),he=m[ne];m[ne]=m[_],m[_]=he}return m.length=y,m}var ns=ey(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(bi,function(_,O,G,ne){y.push(G?ne.replace(no,"$1"):O||_)}),y});function _n(m){if(typeof m=="string"||sr(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function qs(m){if(m!=null){try{return ml.call(m)}catch{}try{return m+""}catch{}}return""}function ny(m,y){return Vi(se,function(_){var O="_."+_[0];y&_[1]&&!Cs(m,O)&&m.push(O)}),m.sort()}function Si(m){if(m instanceof Kt)return m.clone();var y=new br(m.__wrapped__,m.__chain__);return y.__actions__=wi(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function Zb(m,y,_){(_?ar(m,y,_):y===t)?y=1:y=Vn(Bt(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var G=0,ne=0,he=ze(hc(O/y));G<O;)he[ne++]=zr(m,G,G+=y);return he}function iy(m){for(var y=-1,_=m==null?0:m.length,O=0,G=[];++y<_;){var ne=m[y];ne&&(G[O++]=ne)}return G}function ry(){var m=arguments.length;if(!m)return[];for(var y=ze(m-1),_=arguments[0],O=m;O--;)y[O-1]=arguments[O];return tr($t(_)?wi(_):[_],sn(y,1))}var Xn=Vt(function(m,y){return ui(m)?Co(m,sn(y,1,ui,!0)):[]}),Cr=Vt(function(m,y){var _=Qi(y);return ui(_)&&(_=t),ui(m)?Co(m,sn(y,1,ui,!0),Ct(_,2)):[]}),Vs=Vt(function(m,y){var _=Qi(y);return ui(_)&&(_=t),ui(m)?Co(m,sn(y,1,ui,!0),t,_):[]});function ay(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Bt(y),zr(m,y<0?0:y,O)):[]}function sy(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Bt(y),y=O-y,zr(m,0,y<0?0:y)):[]}function ev(m,y){return m&&m.length?Yu(m,Ct(y,3),!0,!0):[]}function Lp(m,y){return m&&m.length?Yu(m,Ct(y,3),!0):[]}function Br(m,y,_,O){var G=m==null?0:m.length;return G?(_&&typeof _!="number"&&ar(m,y,_)&&(_=0,O=G),Wt(m,y,_,O)):[]}function ra(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var G=_==null?0:Bt(_);return G<0&&(G=Vn(O+G,0)),fl(m,Ct(y,3),G)}function Fp(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var G=O-1;return _!==t&&(G=Bt(_),G=_<0?Vn(O+G,0):Jn(G,O-1)),fl(m,Ct(y,3),G,!0)}function jr(m){var y=m==null?0:m.length;return y?sn(m,1):[]}function oy(m){var y=m==null?0:m.length;return y?sn(m,Q):[]}function Ao(m,y){var _=m==null?0:m.length;return _?(y=y===t?1:Bt(y),sn(m,y)):[]}function Pl(m){for(var y=-1,_=m==null?0:m.length,O={};++y<_;){var G=m[y];O[G[0]]=G[1]}return O}function Hs(m){return m&&m.length?m[0]:t}function $p(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var G=_==null?0:Bt(_);return G<0&&(G=Vn(O+G,0)),mo(m,y,G)}function zp(m){var y=m==null?0:m.length;return y?zr(m,0,-1):[]}var is=Vt(function(m){var y=jn(m,kf);return y.length&&y[0]===m[0]?dp(y):[]}),ly=Vt(function(m){var y=Qi(m),_=jn(m,kf);return y===Qi(_)?y=t:_.pop(),_.length&&_[0]===m[0]?dp(_,Ct(y,2)):[]}),_c=Vt(function(m){var y=Qi(m),_=jn(m,kf);return y=typeof y=="function"?y:t,y&&_.pop(),_.length&&_[0]===m[0]?dp(_,t,y):[]});function ud(m,y){return m==null?"":Xr.call(m,y)}function Qi(m){var y=m==null?0:m.length;return y?m[y-1]:t}function kc(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var G=O;return _!==t&&(G=Bt(_),G=G<0?Vn(O+G,0):Jn(G,O-1)),y===y?Gi(m,y,G):fl(m,Kr,G,!0)}function cy(m,y){return m&&m.length?xp(m,Bt(y)):t}var uy=Vt(Tc);function Tc(m,y){return m&&m.length&&y&&y.length?Sf(m,y):m}function dy(m,y,_){return m&&m.length&&y&&y.length?Sf(m,y,Ct(_,2)):m}function qf(m,y,_){return m&&m.length&&y&&y.length?Sf(m,y,t,_):m}var fy=Hn(function(m,y){var _=m==null?0:m.length,O=Fu(m,y);return vp(m,jn(y,function(G){return Ea(G,_)?+G:G}).sort(Ju)),O});function tv(m,y){var _=[];if(!(m&&m.length))return _;var O=-1,G=[],ne=m.length;for(y=Ct(y,3);++O<ne;){var he=m[O];y(he,O,m)&&(_.push(he),G.push(O))}return vp(m,G),_}function Up(m){return m==null?m:ip.call(m)}function Tn(m,y,_){var O=m==null?0:m.length;return O?(_&&typeof _!="number"&&ar(m,y,_)?(y=0,_=O):(y=y==null?0:Bt(y),_=_===t?O:Bt(_)),zr(m,y,_)):[]}function Bn(m,y){return Hu(m,y)}function en(m,y,_){return jf(m,y,Ct(_,2))}function hn(m,y){var _=m==null?0:m.length;if(_){var O=Hu(m,y);if(O<_&&kr(m[O],y))return O}return-1}function En(m,y){return Hu(m,y,!0)}function qr(m,y,_){return jf(m,y,Ct(_,2),!0)}function Po(m,y){var _=m==null?0:m.length;if(_){var O=Hu(m,y,!0)-1;if(kr(m[O],y))return O}return-1}function Ec(m){return m&&m.length?Sp(m):[]}function Bp(m,y){return m&&m.length?Sp(m,Ct(y,2)):[]}function Gs(m){var y=m==null?0:m.length;return y?zr(m,1,y):[]}function ci(m,y,_){return m&&m.length?(y=_||y===t?1:Bt(y),zr(m,0,y<0?0:y)):[]}function Do(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Bt(y),y=O-y,zr(m,y<0?0:y,O)):[]}function Dl(m,y){return m&&m.length?Yu(m,Ct(y,3),!1,!0):[]}function qp(m,y){return m&&m.length?Yu(m,Ct(y,3)):[]}var aa=Vt(function(m){return Fs(sn(m,1,ui,!0))}),Ac=Vt(function(m){var y=Qi(m);return ui(y)&&(y=t),Fs(sn(m,1,ui,!0),Ct(y,2))}),dd=Vt(function(m){var y=Qi(m);return y=typeof y=="function"?y:t,Fs(sn(m,1,ui,!0),t,y)});function _r(m){return m&&m.length?Fs(m):[]}function Vp(m,y){return m&&m.length?Fs(m,Ct(y,2)):[]}function Hp(m,y){return y=typeof y=="function"?y:t,m&&m.length?Fs(m,t,y):[]}function Pc(m){if(!(m&&m.length))return[];var y=0;return m=hr(m,function(_){if(ui(_))return y=Vn(_.length,y),!0}),pr(y,function(_){return jn(m,Sa(_))})}function fd(m,y){if(!(m&&m.length))return[];var _=Pc(m);return y==null?_:jn(_,function(O){return qi(y,t,O)})}var Io=Vt(function(m,y){return ui(m)?Co(m,y):[]}),Ui=Vt(function(m){return Wu(hr(m,ui))}),Ro=Vt(function(m){var y=Qi(m);return ui(y)&&(y=t),Wu(hr(m,ui),Ct(y,2))}),Dc=Vt(function(m){var y=Qi(m);return y=typeof y=="function"?y:t,Wu(hr(m,ui),t,y)}),Ic=Vt(Pc);function Gp(m,y){return Cp(m||[],y||[],vl)}function Yp(m,y){return Cp(m||[],y||[],wc)}var hy=Vt(function(m){var y=m.length,_=y>1?m[y-1]:t;return _=typeof _=="function"?(m.pop(),_):t,fd(m,_)});function Rc(m){var y=K(m);return y.__chain__=!0,y}function Wp(m,y){return y(m),m}function Ji(m,y){return y(m)}var py=Hn(function(m){var y=m.length,_=y?m[0]:0,O=this.__wrapped__,G=function(ne){return Fu(ne,m)};return y>1||this.__actions__.length||!(O instanceof Kt)||!Ea(_)?this.thru(G):(O=O.slice(_,+_+(y?1:0)),O.__actions__.push({func:Ji,args:[G],thisArg:t}),new br(O,this.__chain__).thru(function(ne){return y&&!ne.length&&ne.push(t),ne}))});function Vr(){return Rc(this)}function my(){return new br(this.value(),this.__chain__)}function gy(){this.__values__===t&&(this.__values__=Hr(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function nv(){return this}function Mo(m){for(var y,_=this;_ instanceof ta;){var O=Si(_);O.__index__=0,O.__values__=t,y?G.__wrapped__=O:y=O;var G=O;_=_.__wrapped__}return G.__wrapped__=m,y}function Vf(){var m=this.__wrapped__;if(m instanceof Kt){var y=m;return this.__actions__.length&&(y=new Kt(this)),y=y.reverse(),y.__actions__.push({func:Ji,args:[Up],thisArg:t}),new br(y,this.__chain__)}return this.thru(Up)}function Qp(){return Og(this.__wrapped__,this.__actions__)}var Mc=_l(function(m,y,_){gn.call(m,_)?++m[_]:_a(m,_,1)});function yy(m,y,_){var O=$t(m)?Nn:cp;return _&&ar(m,y,_)&&(y=t),O(m,Ct(y,3))}function xy(m,y){var _=$t(m)?hr:kn;return _(m,Ct(y,3))}var by=zs(ra),Jp=zs(Fp);function Kp(m,y){return sn(hd(m,y),1)}function iv(m,y){return sn(hd(m,y),Q)}function rv(m,y,_){return _=_===t?1:Bt(_),sn(hd(m,y),_)}function vy(m,y){var _=$t(m)?Vi:Ls;return _(m,Ct(y,3))}function Xp(m,y){var _=$t(m)?Jd:pf;return _(m,Ct(y,3))}var wy=_l(function(m,y,_){gn.call(m,_)?m[_].push(y):_a(m,_,[y])});function Oc(m,y,_,O){m=Ni(m)?m:qc(m),_=_&&!O?Bt(_):0;var G=m.length;return _<0&&(_=Vn(G+_,0)),nh(m)?_<=G&&m.indexOf(y,_)>-1:!!G&&mo(m,y,_)>-1}var Hf=Vt(function(m,y,_){var O=-1,G=typeof y=="function",ne=Ni(m)?ze(m.length):[];return Ls(m,function(he){ne[++O]=G?qi(y,he,_):Nl(he,y,_)}),ne}),Sy=_l(function(m,y,_){_a(m,_,y)});function hd(m,y){var _=$t(m)?jn:gp;return _(m,Ct(y,3))}function Ny(m,y,_,O){return m==null?[]:($t(y)||(y=y==null?[]:[y]),_=O?t:_,$t(_)||(_=_==null?[]:[_]),bp(m,y,_))}var Cy=_l(function(m,y,_){m[_?0:1].push(y)},function(){return[[],[]]});function jy(m,y,_){var O=$t(m)?wu:lc,G=arguments.length<3;return O(m,Ct(y,4),_,G,Ls)}function _y(m,y,_){var O=$t(m)?Kd:lc,G=arguments.length<3;return O(m,Ct(y,4),_,G,pf)}function Gf(m,y){var _=$t(m)?hr:kn;return _(m,xd(Ct(y,3)))}function ky(m){var y=$t(m)?gc:vc;return y(m)}function Ty(m,y,_){(_?ar(m,y,_):y===t)?y=1:y=Bt(y);var O=$t(m)?Cg:Cf;return O(m,y)}function zn(m){var y=$t(m)?jg:Rg;return y(m)}function Zp(m){if(m==null)return 0;if(Ni(m))return nh(m)?Lr(m):m.length;var y=Pi(m);return y==Me||y==ye?m.size:xf(m).length}function av(m,y,_){var O=$t(m)?Ya:Mg;return _&&ar(m,y,_)&&(y=t),O(m,Ct(y,3))}var Ey=Vt(function(m,y){if(m==null)return[];var _=y.length;return _>1&&ar(m,y[0],y[1])?y=[]:_>2&&ar(y[0],y[1],y[2])&&(y=[y[0]]),bp(m,sn(y,1),[])}),Yf=Ds||function(){return ri.Date.now()};function sv(m,y){if(typeof y!="function")throw new Qn(l);return m=Bt(m),function(){if(--m<1)return y.apply(this,arguments)}}function Ay(m,y,_){return y=_?t:y,y=m&&y==null?m.length:y,es(m,z,t,t,t,t,y)}function pd(m,y){var _;if(typeof y!="function")throw new Qn(l);return m=Bt(m),function(){return--m>0&&(_=y.apply(this,arguments)),m<=1&&(y=t),_}}var Oo=Vt(function(m,y,_){var O=T;if(_.length){var G=$i(_,Al(Oo));O|=L}return es(m,O,y,_,G)}),Wf=Vt(function(m,y,_){var O=T|P;if(_.length){var G=$i(_,Al(Wf));O|=L}return es(y,O,m,_,G)});function md(m,y,_){y=_?t:y;var O=es(m,I,t,t,t,t,t,y);return O.placeholder=md.placeholder,O}function Qf(m,y,_){y=_?t:y;var O=es(m,U,t,t,t,t,t,y);return O.placeholder=Qf.placeholder,O}function Lo(m,y,_){var O,G,ne,he,we,Ae,Ke=0,Ze=!1,it=!1,gt=!0;if(typeof m!="function")throw new Qn(l);y=oa(y)||0,Zn(_)&&(Ze=!!_.leading,it="maxWait"in _,ne=it?Vn(oa(_.maxWait)||0,y):ne,gt="trailing"in _?!!_.trailing:gt);function vt(_i){var Qs=O,Rl=G;return O=G=t,Ke=_i,he=m.apply(Rl,Qs),he}function Mt(_i){return Ke=_i,we=jc(un,y),Ze?vt(_i):he}function Zt(_i){var Qs=_i-Ae,Rl=_i-Ke,rS=y-Qs;return it?Jn(rS,ne-Rl):rS}function Ot(_i){var Qs=_i-Ae,Rl=_i-Ke;return Ae===t||Qs>=y||Qs<0||it&&Rl>=ne}function un(){var _i=Yf();if(Ot(_i))return xn(_i);we=jc(un,Zt(_i))}function xn(_i){return we=t,gt&&O?vt(_i):(O=G=t,he)}function Da(){we!==t&&Fg(we),Ke=0,O=Ae=G=we=t}function Gr(){return we===t?he:xn(Yf())}function Ia(){var _i=Yf(),Qs=Ot(_i);if(O=arguments,G=this,Ae=_i,Qs){if(we===t)return Mt(Ae);if(it)return Fg(we),we=jc(un,y),vt(Ae)}return we===t&&(we=jc(un,y)),he}return Ia.cancel=Da,Ia.flush=Gr,Ia}var rs=Vt(function(m,y){return wl(m,1,y)}),gd=Vt(function(m,y,_){return wl(m,oa(y)||0,_)});function ov(m){return es(m,B)}function yd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new Qn(l);var _=function(){var O=arguments,G=y?y.apply(this,O):O[0],ne=_.cache;if(ne.has(G))return ne.get(G);var he=m.apply(this,O);return _.cache=ne.set(G,he)||ne,he};return _.cache=new(yd.Cache||vr),_}yd.Cache=vr;function xd(m){if(typeof m!="function")throw new Qn(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Py(m){return pd(2,m)}var Dy=Lg(function(m,y){y=y.length==1&&$t(y[0])?jn(y[0],Hi(Ct())):jn(sn(y,1),Hi(Ct()));var _=y.length;return Vt(function(O){for(var G=-1,ne=Jn(O.length,_);++G<ne;)O[G]=y[G].call(this,O[G]);return qi(m,this,O)})}),em=Vt(function(m,y){var _=$i(y,Al(em));return es(m,L,t,y,_)}),Jf=Vt(function(m,y){var _=$i(y,Al(Jf));return es(m,F,t,y,_)}),Iy=Hn(function(m,y){return es(m,$,t,t,t,y)});function Ry(m,y){if(typeof m!="function")throw new Qn(l);return y=y===t?y:Bt(y),Vt(m,y)}function lv(m,y){if(typeof m!="function")throw new Qn(l);return y=y==null?0:Vn(Bt(y),0),Vt(function(_){var O=_[y],G=_o(_,0,y);return O&&tr(G,O),qi(m,this,G)})}function tm(m,y,_){var O=!0,G=!0;if(typeof m!="function")throw new Qn(l);return Zn(_)&&(O="leading"in _?!!_.leading:O,G="trailing"in _?!!_.trailing:G),Lo(m,y,{leading:O,maxWait:y,trailing:G})}function nm(m){return Ay(m,1)}function cv(m,y){return em(Qu(y),m)}function uv(){if(!arguments.length)return[];var m=arguments[0];return $t(m)?m:[m]}function bd(m){return Yi(m,v)}function dv(m,y){return y=typeof y=="function"?y:t,Yi(m,v,y)}function My(m){return Yi(m,g|v)}function tn(m,y){return y=typeof y=="function"?y:t,Yi(m,g|v,y)}function im(m,y){return y==null||lp(m,y,ji(y))}function kr(m,y){return m===y||m!==m&&y!==y}var rm=El($u),Oy=El(function(m,y){return m>=y}),Ys=mf(function(){return arguments}())?mf:function(m){return ai(m)&&gn.call(m,"callee")&&!je.call(m,"callee")},$t=ze.isArray,Kf=Ns?Hi(Ns):wr;function Ni(m){return m!=null&&Il(m.length)&&!Aa(m)}function ui(m){return ai(m)&&Ni(m)}function fv(m){return m===!0||m===!1||ai(m)&&cn(m)==re}var Fo=lf||Ov,Ly=xu?Hi(xu):gi;function Fy(m){return ai(m)&&m.nodeType===1&&!sa(m)}function Xf(m){if(m==null)return!0;if(Ni(m)&&($t(m)||typeof m=="string"||typeof m.splice=="function"||Fo(m)||Lc(m)||Ys(m)))return!m.length;var y=Pi(m);if(y==Me||y==ye)return!m.size;if($n(m))return!xf(m).length;for(var _ in m)if(gn.call(m,_))return!1;return!0}function In(m,y){return Cl(m,y)}function am(m,y,_){_=typeof _=="function"?_:t;var O=_?_(m,y):t;return O===t?Cl(m,y,t,_):!!O}function Ci(m){if(!ai(m))return!1;var y=cn(m);return y==Se||y==Qe||typeof m.message=="string"&&typeof m.name=="string"&&!sa(m)}function hv(m){return typeof m=="number"&&Au(m)}function Aa(m){if(!Zn(m))return!1;var y=cn(m);return y==Ne||y==De||y==ce||y==Nt}function Zf(m){return typeof m=="number"&&m==Bt(m)}function Il(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=J}function Zn(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function ai(m){return m!=null&&typeof m=="object"}var eh=ic?Hi(ic):gf;function sm(m,y){return m===y||Uu(m,y,Mf(y))}function pv(m,y,_){return _=typeof _=="function"?_:t,Uu(m,y,Mf(y),_)}function $y(m){return Uy(m)&&m!=+m}function mv(m){if(ad(m))throw new St(o);return Xa(m)}function zy(m){return m===null}function gv(m){return m==null}function Uy(m){return typeof m=="number"||ai(m)&&cn(m)==nt}function sa(m){if(!ai(m)||cn(m)!=ut)return!1;var y=me(m);if(y===null)return!0;var _=gn.call(y,"constructor")&&y.constructor;return typeof _=="function"&&_ instanceof _&&ml.call(_)==mr}var th=rc?Hi(rc):yf;function om(m){return Zf(m)&&m>=-9007199254740991&&m<=J}var By=bu?Hi(bu):hp;function nh(m){return typeof m=="string"||!$t(m)&&ai(m)&&cn(m)==Te}function sr(m){return typeof m=="symbol"||ai(m)&&cn(m)==Ye}var Lc=ul?Hi(ul):pp;function Pa(m){return m===t}function lm(m){return ai(m)&&Pi(m)==_e}function qy(m){return ai(m)&&cn(m)==X}var Vy=El(bf),vd=El(function(m,y){return m<=y});function Hr(m){if(!m)return[];if(Ni(m))return nh(m)?nr(m):wi(m);if(bt&&m[bt])return nf(m[bt]());var y=Pi(m),_=y==Me?Es:y==ye?Or:qc;return _(m)}function as(m){if(!m)return m===0?m:0;if(m=oa(m),m===Q||m===-1/0){var y=m<0?-1:1;return y*fe}return m===m?m:0}function Bt(m){var y=as(m),_=y%1;return y===y?_?y-_:y:0}function ss(m){return m?ka(Bt(m),0,oe):0}function oa(m){if(typeof m=="number")return m;if(sr(m))return A;if(Zn(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=Zn(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=cc(m);var _=hi.test(m);return _||Wd.test(m)?yu(m.slice(2),_?2:8):ys.test(m)?A:+m}function Hy(m){return Nr(m,Di(m))}function Fc(m){return m?ka(Bt(m),-9007199254740991,J):m===0?m:0}function Cn(m){return m==null?"":Sr(m)}var yv=kl(function(m,y){if($n(y)||Ni(y)){Nr(y,ji(y),m);return}for(var _ in y)gn.call(y,_)&&vl(m,_,y[_])}),Gy=kl(function(m,y){Nr(y,Di(y),m)}),ih=kl(function(m,y,_,O){Nr(y,Di(y),m,O)}),xv=kl(function(m,y,_,O){Nr(y,ji(y),m,O)}),bv=Hn(Fu);function vv(m,y){var _=$r(m);return y==null?_:Os(_,y)}var wv=Vt(function(m,y){m=ln(m);var _=-1,O=y.length,G=O>2?y[2]:t;for(G&&ar(y[0],y[1],G)&&(O=1);++_<O;)for(var ne=y[_],he=Di(ne),we=-1,Ae=he.length;++we<Ae;){var Ke=he[we],Ze=m[Ke];(Ze===t||kr(Ze,As[Ke])&&!gn.call(m,Ke))&&(m[Ke]=ne[Ke])}return m}),Yy=Vt(function(m){return m.push(t,Pp),qi(Cd,t,m)});function $c(m,y){return js(m,Ct(y,3),Wi)}function wd(m,y){return js(m,Ct(y,3),bc)}function Wy(m,y){return m==null?m:xc(m,Ct(y,3),Di)}function Sv(m,y){return m==null?m:Sl(m,Ct(y,3),Di)}function zc(m,y){return m&&Wi(m,Ct(y,3))}function Sd(m,y){return m&&bc(m,Ct(y,3))}function Qy(m){return m==null?[]:jo(m,ji(m))}function rh(m){return m==null?[]:jo(m,Di(m))}function Nd(m,y,_){var O=m==null?t:na(m,y);return O===t?_:O}function cm(m,y){return m!=null&&rd(m,y,up)}function Uc(m,y){return m!=null&&rd(m,y,Tg)}var Jy=Xu(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=zi.call(y)),m[y]=_},Re(Oe)),Ky=Xu(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=zi.call(y)),gn.call(m,y)?m[y].push(_):m[y]=[_]},Ct),Nv=Vt(Nl);function ji(m){return Ni(m)?op(m):xf(m)}function Di(m){return Ni(m)?op(m,!0):Ag(m)}function Cv(m,y){var _={};return y=Ct(y,3),Wi(m,function(O,G,ne){_a(_,y(O,G,ne),O)}),_}function jv(m,y){var _={};return y=Ct(y,3),Wi(m,function(O,G,ne){_a(_,G,y(O,G,ne))}),_}var _v=kl(function(m,y,_){Bu(m,y,_)}),Cd=kl(function(m,y,_,O){Bu(m,y,_,O)}),ah=Hn(function(m,y){var _={};if(m==null)return _;var O=!1;y=jn(y,function(ne){return ne=$s(ne,m),O||(O=ne.length>1),ne}),Nr(m,If(m),_),O&&(_=Yi(_,g|b|v,Gg));for(var G=y.length;G--;)Gu(_,y[G]);return _});function um(m,y){return Bc(m,xd(Ct(y)))}var kv=Hn(function(m,y){return m==null?{}:Pg(m,y)});function Bc(m,y){if(m==null)return{};var _=jn(If(m),function(O){return[O]});return y=Ct(y),wf(m,_,function(O,G){return y(O,G[0])})}function Tv(m,y,_){y=$s(y,m);var O=-1,G=y.length;for(G||(G=1,m=t);++O<G;){var ne=m==null?t:m[_n(y[O])];ne===t&&(O=G,ne=_),m=Aa(ne)?ne.call(m):ne}return m}function Xy(m,y,_){return m==null?m:wc(m,y,_)}function Zy(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:wc(m,y,_,O)}var dm=td(ji),fm=td(Di);function hm(m,y,_){var O=$t(m),G=O||Fo(m)||Lc(m);if(y=Ct(y,4),_==null){var ne=m&&m.constructor;G?_=O?new ne:[]:Zn(m)?_=Aa(ne)?$r(me(m)):{}:_={}}return(G?Vi:Wi)(m,function(he,we,Ae){return y(_,he,we,Ae)}),_}function ex(m,y){return m==null?!0:Gu(m,y)}function sh(m,y,_){return m==null?m:Np(m,y,Qu(_))}function Ev(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:Np(m,y,Qu(_),O)}function qc(m){return m==null?[]:ks(m,ji(m))}function pm(m){return m==null?[]:ks(m,Di(m))}function mm(m,y,_){return _===t&&(_=y,y=t),_!==t&&(_=oa(_),_=_===_?_:0),y!==t&&(y=oa(y),y=y===y?y:0),ka(oa(m),y,_)}function oh(m,y,_){return y=as(y),_===t?(_=y,y=0):_=as(_),m=oa(m),Eg(m,y,_)}function gm(m,y,_){if(_&&typeof _!="boolean"&&ar(m,y,_)&&(y=_=t),_===t&&(typeof y=="boolean"?(_=y,y=t):typeof m=="boolean"&&(_=m,m=t)),m===t&&y===t?(m=0,y=1):(m=as(m),y===t?(y=m,m=0):y=as(y)),m>y){var O=m;m=y,y=O}if(_||m%1||y%1){var G=np();return Jn(m+G*(y-m+er("1e-"+((G+"").length-1))),y)}return Nf(m,y)}var tx=rr(function(m,y,_){return y=y.toLowerCase(),m+(_?lh(y):y)});function lh(m){return x(Cn(m).toLowerCase())}function Ws(m){return m=Cn(m),m&&m.replace(io,uc).replace(dr,"")}function $o(m,y,_){m=Cn(m),y=Sr(y);var O=m.length;_=_===t?O:ka(Bt(_),0,O);var G=_;return _-=y.length,_>=0&&m.slice(_,G)==y}function zo(m){return m=Cn(m),m&&ki.test(m)?m.replace(Rt,ef):m}function jd(m){return m=Cn(m),m&&Li.test(m)?m.replace(Ln,"\\$&"):m}var _d=rr(function(m,y,_){return m+(_?"-":"")+y.toLowerCase()}),Uo=rr(function(m,y,_){return m+(_?" ":"")+y.toLowerCase()}),Av=Ur("toLowerCase");function nx(m,y,_){m=Cn(m),y=Bt(y);var O=y?Lr(m):0;if(!y||O>=y)return m;var G=(y-O)/2;return ed(Is(G),_)+m+ed(hc(G),_)}function kd(m,y,_){m=Cn(m),y=Bt(y);var O=y?Lr(m):0;return y&&O<y?m+ed(y-O,_):m}function Pv(m,y,_){m=Cn(m),y=Bt(y);var O=y?Lr(m):0;return y&&O<y?ed(y-O,_)+m:m}function ix(m,y,_){return _||y==null?y=0:y&&(y=+y),gl(Cn(m).replace(Jr,""),y||0)}function ch(m,y,_){return(_?ar(m,y,_):y===t)?y=1:y=Bt(y),wp(Cn(m),y)}function rx(){var m=arguments,y=Cn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var Dv=rr(function(m,y,_){return m+(_?"_":"")+y.toLowerCase()});function uh(m,y,_){return _&&typeof _!="number"&&ar(m,y,_)&&(y=_=t),_=_===t?oe:_>>>0,_?(m=Cn(m),m&&(typeof y=="string"||y!=null&&!th(y))&&(y=Sr(y),!y&&Wa(m))?_o(nr(m),0,_):m.split(y,_)):[]}var dh=rr(function(m,y,_){return m+(_?" ":"")+x(y)});function ax(m,y,_){return m=Cn(m),_=_==null?0:ka(Bt(_),0,m.length),y=Sr(y),m.slice(_,_+y.length)==y}function Td(m,y,_){var O=K.templateSettings;_&&ar(m,y,_)&&(y=t),m=Cn(m),y=ih({},y,O,Pf);var G=ih({},y.imports,O.imports,Pf),ne=ji(G),he=ks(G,ne),we,Ae,Ke=0,Ze=y.interpolate||Vl,it="__p += '",gt=dc((y.escape||Vl).source+"|"+Ze.source+"|"+(Ze===rn?ya:Vl).source+"|"+(y.evaluate||Vl).source+"|$","g"),vt="//# sourceURL="+(gn.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ec+"]")+`
`;m.replace(gt,function(Ot,un,xn,Da,Gr,Ia){return xn||(xn=Da),it+=m.slice(Ke,Ia).replace(Qd,tf),un&&(we=!0,it+=`' +
__e(`+un+`) +
'`),Gr&&(Ae=!0,it+=`';
`+Gr+`;
__p += '`),xn&&(it+=`' +
((__t = (`+xn+`)) == null ? '' : __t) +
'`),Ke=Ia+Ot.length,Ot}),it+=`';
`;var Mt=gn.call(y,"variable")&&y.variable;if(!Mt)it=`with (obj) {
`+it+`
}
`;else if(nl.test(Mt))throw new St(d);it=(Ae?it.replace(dt,""):it).replace(qt,"$1").replace(On,"$1;"),it="function("+(Mt||"obj")+`) {
`+(Mt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(we?", __e = _.escape":"")+(Ae?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+it+`return __p
}`;var Zt=E(function(){return on(ne,vt+"return "+it).apply(t,he)});if(Zt.source=it,Ci(Zt))throw Zt;return Zt}function ym(m){return Cn(m).toLowerCase()}function fh(m){return Cn(m).toUpperCase()}function sx(m,y,_){if(m=Cn(m),m&&(_||y===t))return cc(m);if(!m||!(y=Sr(y)))return m;var O=nr(m),G=nr(y),ne=go(O,G),he=yo(O,G)+1;return _o(O,ne,he).join("")}function Iv(m,y,_){if(m=Cn(m),m&&(_||y===t))return m.slice(0,hl(m)+1);if(!m||!(y=Sr(y)))return m;var O=nr(m),G=yo(O,nr(y))+1;return _o(O,0,G).join("")}function hh(m,y,_){if(m=Cn(m),m&&(_||y===t))return m.replace(Jr,"");if(!m||!(y=Sr(y)))return m;var O=nr(m),G=go(O,nr(y));return _o(O,G).join("")}function s(m,y){var _=R,O=V;if(Zn(y)){var G="separator"in y?y.separator:G;_="length"in y?Bt(y.length):_,O="omission"in y?Sr(y.omission):O}m=Cn(m);var ne=m.length;if(Wa(m)){var he=nr(m);ne=he.length}if(_>=ne)return m;var we=_-Lr(O);if(we<1)return O;var Ae=he?_o(he,0,we).join(""):m.slice(0,we);if(G===t)return Ae+O;if(he&&(we+=Ae.length-we),th(G)){if(m.slice(we).search(G)){var Ke,Ze=Ae;for(G.global||(G=dc(G.source,Cn(gs.exec(G))+"g")),G.lastIndex=0;Ke=G.exec(Ze);)var it=Ke.index;Ae=Ae.slice(0,it===t?we:it)}}else if(m.indexOf(Sr(G),we)!=we){var gt=Ae.lastIndexOf(G);gt>-1&&(Ae=Ae.slice(0,gt))}return Ae+O}function c(m){return m=Cn(m),m&&si.test(m)?m.replace(Tt,ju):m}var h=rr(function(m,y,_){return m+(_?" ":"")+y.toUpperCase()}),x=Ur("toUpperCase");function N(m,y,_){return m=Cn(m),y=_?t:y,y===t?Cu(m)?sf(m):ac(m):m.match(y)||[]}var E=Vt(function(m,y){try{return qi(m,t,y)}catch(_){return Ci(_)?_:new St(_)}}),q=Hn(function(m,y){return Vi(y,function(_){_=_n(_),_a(m,_,Oo(m[_],m))}),m});function Z(m){var y=m==null?0:m.length,_=Ct();return m=y?jn(m,function(O){if(typeof O[1]!="function")throw new Qn(l);return[_(O[0]),O[1]]}):[],Vt(function(O){for(var G=-1;++G<y;){var ne=m[G];if(qi(ne[0],this,O))return qi(ne[1],this,O)}})}function ge(m){return _g(Yi(m,g))}function Re(m){return function(){return m}}function Ge(m,y){return m==null||m!==m?y:m}var Xe=Za(),Le=Za(!0);function Oe(m){return m}function At(m){return mp(typeof m=="function"?m:Yi(m,g))}function Et(m){return yp(Yi(m,g))}function Rn(m,y){return vf(m,Yi(y,g))}var Ee=Vt(function(m,y){return function(_){return Nl(_,m,y)}}),Ce=Vt(function(m,y){return function(_){return Nl(m,_,y)}});function Ie(m,y,_){var O=ji(y),G=jo(y,O);_==null&&!(Zn(y)&&(G.length||!O.length))&&(_=y,y=m,m=this,G=jo(y,ji(y)));var ne=!(Zn(_)&&"chain"in _)||!!_.chain,he=Aa(m);return Vi(G,function(we){var Ae=y[we];m[we]=Ae,he&&(m.prototype[we]=function(){var Ke=this.__chain__;if(ne||Ke){var Ze=m(this.__wrapped__),it=Ze.__actions__=wi(this.__actions__);return it.push({func:Ae,args:arguments,thisArg:m}),Ze.__chain__=Ke,Ze}return Ae.apply(m,tr([this.value()],arguments))})}),m}function We(){return ri._===this&&(ri._=bo),this}function yt(){}function Xt(m){return m=Bt(m),Vt(function(y){return xp(y,m)})}var wt=Zu(jn),Pt=Zu(Nn),Ii=Zu(Ya);function yn(m){return Lf(m)?Sa(_n(m)):Dg(m)}function Bo(m){return function(y){return m==null?t:na(m,y)}}var Rv=ko(),kA=ko(!0);function Mv(){return[]}function Ov(){return!1}function TA(){return{}}function EA(){return""}function AA(){return!0}function PA(m,y){if(m=Bt(m),m<1||m>J)return[];var _=oe,O=Jn(m,oe);y=Ct(y),m-=oe;for(var G=pr(O,y);++_<m;)y(_);return G}function DA(m){return $t(m)?jn(m,_n):sr(m)?[m]:wi(ns(Cn(m)))}function IA(m){var y=++Fr;return Cn(m)+y}var RA=Sc(function(m,y){return m+y},0),MA=Af("ceil"),OA=Sc(function(m,y){return m/y},1),LA=Af("floor");function FA(m){return m&&m.length?Ta(m,Oe,$u):t}function $A(m,y){return m&&m.length?Ta(m,Ct(y,2),$u):t}function zA(m){return Zd(m,Oe)}function UA(m,y){return Zd(m,Ct(y,2))}function BA(m){return m&&m.length?Ta(m,Oe,bf):t}function qA(m,y){return m&&m.length?Ta(m,Ct(y,2),bf):t}var VA=Sc(function(m,y){return m*y},1),HA=Af("round"),GA=Sc(function(m,y){return m-y},0);function YA(m){return m&&m.length?Na(m,Oe):0}function WA(m,y){return m&&m.length?Na(m,Ct(y,2)):0}return K.after=sv,K.ary=Ay,K.assign=yv,K.assignIn=Gy,K.assignInWith=ih,K.assignWith=xv,K.at=bv,K.before=pd,K.bind=Oo,K.bindAll=q,K.bindKey=Wf,K.castArray=uv,K.chain=Rc,K.chunk=Zb,K.compact=iy,K.concat=ry,K.cond=Z,K.conforms=ge,K.constant=Re,K.countBy=Mc,K.create=vv,K.curry=md,K.curryRight=Qf,K.debounce=Lo,K.defaults=wv,K.defaultsDeep=Yy,K.defer=rs,K.delay=gd,K.difference=Xn,K.differenceBy=Cr,K.differenceWith=Vs,K.drop=ay,K.dropRight=sy,K.dropRightWhile=ev,K.dropWhile=Lp,K.fill=Br,K.filter=xy,K.flatMap=Kp,K.flatMapDeep=iv,K.flatMapDepth=rv,K.flatten=jr,K.flattenDeep=oy,K.flattenDepth=Ao,K.flip=ov,K.flow=Xe,K.flowRight=Le,K.fromPairs=Pl,K.functions=Qy,K.functionsIn=rh,K.groupBy=wy,K.initial=zp,K.intersection=is,K.intersectionBy=ly,K.intersectionWith=_c,K.invert=Jy,K.invertBy=Ky,K.invokeMap=Hf,K.iteratee=At,K.keyBy=Sy,K.keys=ji,K.keysIn=Di,K.map=hd,K.mapKeys=Cv,K.mapValues=jv,K.matches=Et,K.matchesProperty=Rn,K.memoize=yd,K.merge=_v,K.mergeWith=Cd,K.method=Ee,K.methodOf=Ce,K.mixin=Ie,K.negate=xd,K.nthArg=Xt,K.omit=ah,K.omitBy=um,K.once=Py,K.orderBy=Ny,K.over=wt,K.overArgs=Dy,K.overEvery=Pt,K.overSome=Ii,K.partial=em,K.partialRight=Jf,K.partition=Cy,K.pick=kv,K.pickBy=Bc,K.property=yn,K.propertyOf=Bo,K.pull=uy,K.pullAll=Tc,K.pullAllBy=dy,K.pullAllWith=qf,K.pullAt=fy,K.range=Rv,K.rangeRight=kA,K.rearg=Iy,K.reject=Gf,K.remove=tv,K.rest=Ry,K.reverse=Up,K.sampleSize=Ty,K.set=Xy,K.setWith=Zy,K.shuffle=zn,K.slice=Tn,K.sortBy=Ey,K.sortedUniq=Ec,K.sortedUniqBy=Bp,K.split=uh,K.spread=lv,K.tail=Gs,K.take=ci,K.takeRight=Do,K.takeRightWhile=Dl,K.takeWhile=qp,K.tap=Wp,K.throttle=tm,K.thru=Ji,K.toArray=Hr,K.toPairs=dm,K.toPairsIn=fm,K.toPath=DA,K.toPlainObject=Hy,K.transform=hm,K.unary=nm,K.union=aa,K.unionBy=Ac,K.unionWith=dd,K.uniq=_r,K.uniqBy=Vp,K.uniqWith=Hp,K.unset=ex,K.unzip=Pc,K.unzipWith=fd,K.update=sh,K.updateWith=Ev,K.values=qc,K.valuesIn=pm,K.without=Io,K.words=N,K.wrap=cv,K.xor=Ui,K.xorBy=Ro,K.xorWith=Dc,K.zip=Ic,K.zipObject=Gp,K.zipObjectDeep=Yp,K.zipWith=hy,K.entries=dm,K.entriesIn=fm,K.extend=Gy,K.extendWith=ih,Ie(K,K),K.add=RA,K.attempt=E,K.camelCase=tx,K.capitalize=lh,K.ceil=MA,K.clamp=mm,K.clone=bd,K.cloneDeep=My,K.cloneDeepWith=tn,K.cloneWith=dv,K.conformsTo=im,K.deburr=Ws,K.defaultTo=Ge,K.divide=OA,K.endsWith=$o,K.eq=kr,K.escape=zo,K.escapeRegExp=jd,K.every=yy,K.find=by,K.findIndex=ra,K.findKey=$c,K.findLast=Jp,K.findLastIndex=Fp,K.findLastKey=wd,K.floor=LA,K.forEach=vy,K.forEachRight=Xp,K.forIn=Wy,K.forInRight=Sv,K.forOwn=zc,K.forOwnRight=Sd,K.get=Nd,K.gt=rm,K.gte=Oy,K.has=cm,K.hasIn=Uc,K.head=Hs,K.identity=Oe,K.includes=Oc,K.indexOf=$p,K.inRange=oh,K.invoke=Nv,K.isArguments=Ys,K.isArray=$t,K.isArrayBuffer=Kf,K.isArrayLike=Ni,K.isArrayLikeObject=ui,K.isBoolean=fv,K.isBuffer=Fo,K.isDate=Ly,K.isElement=Fy,K.isEmpty=Xf,K.isEqual=In,K.isEqualWith=am,K.isError=Ci,K.isFinite=hv,K.isFunction=Aa,K.isInteger=Zf,K.isLength=Il,K.isMap=eh,K.isMatch=sm,K.isMatchWith=pv,K.isNaN=$y,K.isNative=mv,K.isNil=gv,K.isNull=zy,K.isNumber=Uy,K.isObject=Zn,K.isObjectLike=ai,K.isPlainObject=sa,K.isRegExp=th,K.isSafeInteger=om,K.isSet=By,K.isString=nh,K.isSymbol=sr,K.isTypedArray=Lc,K.isUndefined=Pa,K.isWeakMap=lm,K.isWeakSet=qy,K.join=ud,K.kebabCase=_d,K.last=Qi,K.lastIndexOf=kc,K.lowerCase=Uo,K.lowerFirst=Av,K.lt=Vy,K.lte=vd,K.max=FA,K.maxBy=$A,K.mean=zA,K.meanBy=UA,K.min=BA,K.minBy=qA,K.stubArray=Mv,K.stubFalse=Ov,K.stubObject=TA,K.stubString=EA,K.stubTrue=AA,K.multiply=VA,K.nth=cy,K.noConflict=We,K.noop=yt,K.now=Yf,K.pad=nx,K.padEnd=kd,K.padStart=Pv,K.parseInt=ix,K.random=gm,K.reduce=jy,K.reduceRight=_y,K.repeat=ch,K.replace=rx,K.result=Tv,K.round=HA,K.runInContext=ke,K.sample=ky,K.size=Zp,K.snakeCase=Dv,K.some=av,K.sortedIndex=Bn,K.sortedIndexBy=en,K.sortedIndexOf=hn,K.sortedLastIndex=En,K.sortedLastIndexBy=qr,K.sortedLastIndexOf=Po,K.startCase=dh,K.startsWith=ax,K.subtract=GA,K.sum=YA,K.sumBy=WA,K.template=Td,K.times=PA,K.toFinite=as,K.toInteger=Bt,K.toLength=ss,K.toLower=ym,K.toNumber=oa,K.toSafeInteger=Fc,K.toString=Cn,K.toUpper=fh,K.trim=sx,K.trimEnd=Iv,K.trimStart=hh,K.truncate=s,K.unescape=c,K.uniqueId=IA,K.upperCase=h,K.upperFirst=x,K.each=vy,K.eachRight=Xp,K.first=Hs,Ie(K,function(){var m={};return Wi(K,function(y,_){gn.call(K.prototype,_)||(m[_]=y)}),m}(),{chain:!1}),K.VERSION=i,Vi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){K[m].placeholder=K}),Vi(["drop","take"],function(m,y){Kt.prototype[m]=function(_){_=_===t?1:Vn(Bt(_),0);var O=this.__filtered__&&!y?new Kt(this):this.clone();return O.__filtered__?O.__takeCount__=Jn(_,O.__takeCount__):O.__views__.push({size:Jn(_,oe),type:m+(O.__dir__<0?"Right":"")}),O},Kt.prototype[m+"Right"]=function(_){return this.reverse()[m](_).reverse()}}),Vi(["filter","map","takeWhile"],function(m,y){var _=y+1,O=_==te||_==H;Kt.prototype[m]=function(G){var ne=this.clone();return ne.__iteratees__.push({iteratee:Ct(G,3),type:_}),ne.__filtered__=ne.__filtered__||O,ne}}),Vi(["head","last"],function(m,y){var _="take"+(y?"Right":"");Kt.prototype[m]=function(){return this[_](1).value()[0]}}),Vi(["initial","tail"],function(m,y){var _="drop"+(y?"":"Right");Kt.prototype[m]=function(){return this.__filtered__?new Kt(this):this[_](1)}}),Kt.prototype.compact=function(){return this.filter(Oe)},Kt.prototype.find=function(m){return this.filter(m).head()},Kt.prototype.findLast=function(m){return this.reverse().find(m)},Kt.prototype.invokeMap=Vt(function(m,y){return typeof m=="function"?new Kt(this):this.map(function(_){return Nl(_,m,y)})}),Kt.prototype.reject=function(m){return this.filter(xd(Ct(m)))},Kt.prototype.slice=function(m,y){m=Bt(m);var _=this;return _.__filtered__&&(m>0||y<0)?new Kt(_):(m<0?_=_.takeRight(-m):m&&(_=_.drop(m)),y!==t&&(y=Bt(y),_=y<0?_.dropRight(-y):_.take(y-m)),_)},Kt.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},Kt.prototype.toArray=function(){return this.take(oe)},Wi(Kt.prototype,function(m,y){var _=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),G=K[O?"take"+(y=="last"?"Right":""):y],ne=O||/^find/.test(y);G&&(K.prototype[y]=function(){var he=this.__wrapped__,we=O?[1]:arguments,Ae=he instanceof Kt,Ke=we[0],Ze=Ae||$t(he),it=function(un){var xn=G.apply(K,tr([un],we));return O&&gt?xn[0]:xn};Ze&&_&&typeof Ke=="function"&&Ke.length!=1&&(Ae=Ze=!1);var gt=this.__chain__,vt=!!this.__actions__.length,Mt=ne&&!gt,Zt=Ae&&!vt;if(!ne&&Ze){he=Zt?he:new Kt(this);var Ot=m.apply(he,we);return Ot.__actions__.push({func:Ji,args:[it],thisArg:t}),new br(Ot,gt)}return Mt&&Zt?m.apply(this,we):(Ot=this.thru(it),Mt?O?Ot.value()[0]:Ot.value():Ot)})}),Vi(["pop","push","shift","sort","splice","unshift"],function(m){var y=fc[m],_=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);K.prototype[m]=function(){var G=arguments;if(O&&!this.__chain__){var ne=this.value();return y.apply($t(ne)?ne:[],G)}return this[_](function(he){return y.apply($t(he)?he:[],G)})}}),Wi(Kt.prototype,function(m,y){var _=K[y];if(_){var O=_.name+"";gn.call(ea,O)||(ea[O]=[]),ea[O].push({name:y,func:_})}}),ea[li(t,P).name]=[{name:"wrapper",func:t}],Kt.prototype.clone=Ru,Kt.prototype.reverse=cf,Kt.prototype.value=xl,K.prototype.at=py,K.prototype.chain=Vr,K.prototype.commit=my,K.prototype.next=gy,K.prototype.plant=Mo,K.prototype.reverse=Vf,K.prototype.toJSON=K.prototype.valueOf=K.prototype.value=Qp,K.prototype.first=K.prototype.head,bt&&(K.prototype[bt]=nv),K},Qa=xo();Ga?((Ga.exports=Qa)._=Qa,Ha._=Qa):ri._=Qa}).call(Yz)}(Fm,Fm.exports)),Fm.exports}var bT=Wz();class Qz{constructor(n){qn(this,"sampleRate",24e3);qn(this,"bufferSize",7680);qn(this,"audioQueue",[]);qn(this,"isPlaying",!1);qn(this,"isStreamComplete",!1);qn(this,"checkInterval",null);qn(this,"scheduledTime",0);qn(this,"initialBufferTime",.1);qn(this,"gainNode");qn(this,"source");qn(this,"endOfQueueAudioSource",null);qn(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,i){let a=bx.get(this.context);if(a&&a[n])return a[n].handlers.push(i),Promise.resolve(this);a||(bx.set(this.context,{}),a=bx.get(this.context)),a[n]={handlers:[i]};const o=m1(n,t);await this.context.audioWorklet.addModule(o);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),i=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const o=i.getInt16(a*2,!0);t[a]=o/32768}catch(o){console.error(o)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const i=t.slice(0,this.bufferSize);this.audioQueue.push(i),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),i=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=i,a.connect(this.gainNode);const o=bx.get(this.context);o&&Object.entries(o).forEach(([,d])=>{const{node:f,handlers:u}=d;f&&(a.connect(f),f.port.onmessage=function(p){u.forEach(g=>{g.call(f.port,p)})},f.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+i.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function vT(e,n){return function(){return e.apply(n,arguments)}}const{toString:Jz}=Object.prototype,{getPrototypeOf:bw}=Object,Db=(e=>n=>{const t=Jz.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),to=e=>(e=e.toLowerCase(),n=>Db(n)===e),Ib=e=>n=>typeof n===e,{isArray:Vh}=Array,Jm=Ib("undefined");function Kz(e){return e!==null&&!Jm(e)&&e.constructor!==null&&!Jm(e.constructor)&&Fa(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const wT=to("ArrayBuffer");function Xz(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&wT(e.buffer),n}const Zz=Ib("string"),Fa=Ib("function"),ST=Ib("number"),Rb=e=>e!==null&&typeof e=="object",eU=e=>e===!0||e===!1,zx=e=>{if(Db(e)!=="object")return!1;const n=bw(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},tU=to("Date"),nU=to("File"),iU=to("Blob"),rU=to("FileList"),aU=e=>Rb(e)&&Fa(e.pipe),sU=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Fa(e.append)&&((n=Db(e))==="formdata"||n==="object"&&Fa(e.toString)&&e.toString()==="[object FormData]"))},oU=to("URLSearchParams"),[lU,cU,uU,dU]=["ReadableStream","Request","Response","Headers"].map(to),fU=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function og(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let i,a;if(typeof e!="object"&&(e=[e]),Vh(e))for(i=0,a=e.length;i<a;i++)n.call(null,e[i],i,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let d;for(i=0;i<l;i++)d=o[i],n.call(null,e[d],d,e)}}function NT(e,n){n=n.toLowerCase();const t=Object.keys(e);let i=t.length,a;for(;i-- >0;)if(a=t[i],n===a.toLowerCase())return a;return null}const Id=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,CT=e=>!Jm(e)&&e!==Id;function g1(){const{caseless:e}=CT(this)&&this||{},n={},t=(i,a)=>{const o=e&&NT(n,a)||a;zx(n[o])&&zx(i)?n[o]=g1(n[o],i):zx(i)?n[o]=g1({},i):Vh(i)?n[o]=i.slice():n[o]=i};for(let i=0,a=arguments.length;i<a;i++)arguments[i]&&og(arguments[i],t);return n}const hU=(e,n,t,{allOwnKeys:i}={})=>(og(n,(a,o)=>{t&&Fa(a)?e[o]=vT(a,t):e[o]=a},{allOwnKeys:i}),e),pU=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),mU=(e,n,t,i)=>{e.prototype=Object.create(n.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},gU=(e,n,t,i)=>{let a,o,l;const d={};if(n=n||{},e==null)return n;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)l=a[o],(!i||i(l,e,n))&&!d[l]&&(n[l]=e[l],d[l]=!0);e=t!==!1&&bw(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},yU=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const i=e.indexOf(n,t);return i!==-1&&i===t},xU=e=>{if(!e)return null;if(Vh(e))return e;let n=e.length;if(!ST(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},bU=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&bw(Uint8Array)),vU=(e,n)=>{const i=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=i.next())&&!a.done;){const o=a.value;n.call(e,o[0],o[1])}},wU=(e,n)=>{let t;const i=[];for(;(t=e.exec(n))!==null;)i.push(t);return i},SU=to("HTMLFormElement"),NU=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,a){return i.toUpperCase()+a}),NC=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),CU=to("RegExp"),jT=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),i={};og(t,(a,o)=>{let l;(l=n(a,o,e))!==!1&&(i[o]=l||a)}),Object.defineProperties(e,i)},jU=e=>{jT(e,(n,t)=>{if(Fa(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=e[t];if(Fa(i)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},_U=(e,n)=>{const t={},i=a=>{a.forEach(o=>{t[o]=!0})};return Vh(e)?i(e):i(String(e).split(n)),t},kU=()=>{},TU=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function EU(e){return!!(e&&Fa(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const AU=e=>{const n=new Array(10),t=(i,a)=>{if(Rb(i)){if(n.indexOf(i)>=0)return;if(!("toJSON"in i)){n[a]=i;const o=Vh(i)?[]:{};return og(i,(l,d)=>{const f=t(l,a+1);!Jm(f)&&(o[d]=f)}),n[a]=void 0,o}}return i};return t(e,0)},PU=to("AsyncFunction"),DU=e=>e&&(Rb(e)||Fa(e))&&Fa(e.then)&&Fa(e.catch),_T=((e,n)=>e?setImmediate:n?((t,i)=>(Id.addEventListener("message",({source:a,data:o})=>{a===Id&&o===t&&i.length&&i.shift()()},!1),a=>{i.push(a),Id.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Fa(Id.postMessage)),IU=typeof queueMicrotask<"u"?queueMicrotask.bind(Id):typeof process<"u"&&process.nextTick||_T,Ve={isArray:Vh,isArrayBuffer:wT,isBuffer:Kz,isFormData:sU,isArrayBufferView:Xz,isString:Zz,isNumber:ST,isBoolean:eU,isObject:Rb,isPlainObject:zx,isReadableStream:lU,isRequest:cU,isResponse:uU,isHeaders:dU,isUndefined:Jm,isDate:tU,isFile:nU,isBlob:iU,isRegExp:CU,isFunction:Fa,isStream:aU,isURLSearchParams:oU,isTypedArray:bU,isFileList:rU,forEach:og,merge:g1,extend:hU,trim:fU,stripBOM:pU,inherits:mU,toFlatObject:gU,kindOf:Db,kindOfTest:to,endsWith:yU,toArray:xU,forEachEntry:vU,matchAll:wU,isHTMLForm:SU,hasOwnProperty:NC,hasOwnProp:NC,reduceDescriptors:jT,freezeMethods:jU,toObjectSet:_U,toCamelCase:NU,noop:kU,toFiniteNumber:TU,findKey:NT,global:Id,isContextDefined:CT,isSpecCompliantForm:EU,toJSONObject:AU,isAsyncFn:PU,isThenable:DU,setImmediate:_T,asap:IU};function Yt(e,n,t,i,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),i&&(this.request=i),a&&(this.response=a,this.status=a.status?a.status:null)}Ve.inherits(Yt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ve.toJSONObject(this.config),code:this.code,status:this.status}}});const kT=Yt.prototype,TT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{TT[e]={value:e}});Object.defineProperties(Yt,TT);Object.defineProperty(kT,"isAxiosError",{value:!0});Yt.from=(e,n,t,i,a,o)=>{const l=Object.create(kT);return Ve.toFlatObject(e,l,function(f){return f!==Error.prototype},d=>d!=="isAxiosError"),Yt.call(l,e.message,n,t,i,a),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const RU=null;function y1(e){return Ve.isPlainObject(e)||Ve.isArray(e)}function ET(e){return Ve.endsWith(e,"[]")?e.slice(0,-2):e}function CC(e,n,t){return e?e.concat(n).map(function(a,o){return a=ET(a),!t&&o?"["+a+"]":a}).join(t?".":""):n}function MU(e){return Ve.isArray(e)&&!e.some(y1)}const OU=Ve.toFlatObject(Ve,{},null,function(n){return/^is[A-Z]/.test(n)});function Mb(e,n,t){if(!Ve.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=Ve.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,T){return!Ve.isUndefined(T[k])});const i=t.metaTokens,a=t.visitor||p,o=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&Ve.isSpecCompliantForm(n);if(!Ve.isFunction(a))throw new TypeError("visitor must be a function");function u(S){if(S===null)return"";if(Ve.isDate(S))return S.toISOString();if(!f&&Ve.isBlob(S))throw new Yt("Blob is not supported. Use a Buffer instead.");return Ve.isArrayBuffer(S)||Ve.isTypedArray(S)?f&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function p(S,k,T){let P=S;if(S&&!T&&typeof S=="object"){if(Ve.endsWith(k,"{}"))k=i?k:k.slice(0,-2),S=JSON.stringify(S);else if(Ve.isArray(S)&&MU(S)||(Ve.isFileList(S)||Ve.endsWith(k,"[]"))&&(P=Ve.toArray(S)))return k=ET(k),P.forEach(function(I,U){!(Ve.isUndefined(I)||I===null)&&n.append(l===!0?CC([k],U,o):l===null?k:k+"[]",u(I))}),!1}return y1(S)?!0:(n.append(CC(T,k,o),u(S)),!1)}const g=[],b=Object.assign(OU,{defaultVisitor:p,convertValue:u,isVisitable:y1});function v(S,k){if(!Ve.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+k.join("."));g.push(S),Ve.forEach(S,function(P,M){(!(Ve.isUndefined(P)||P===null)&&a.call(n,P,Ve.isString(M)?M.trim():M,k,b))===!0&&v(P,k?k.concat(M):[M])}),g.pop()}}if(!Ve.isObject(e))throw new TypeError("data must be an object");return v(e),n}function jC(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return n[i]})}function vw(e,n){this._pairs=[],e&&Mb(e,this,n)}const AT=vw.prototype;AT.append=function(n,t){this._pairs.push([n,t])};AT.toString=function(n){const t=n?function(i){return n.call(this,i,jC)}:jC;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function LU(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function PT(e,n,t){if(!n)return e;const i=t&&t.encode||LU;Ve.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let o;if(a?o=a(n,t):o=Ve.isURLSearchParams(n)?n.toString():new vw(n,t).toString(i),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class _C{constructor(){this.handlers=[]}use(n,t,i){return this.handlers.push({fulfilled:n,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Ve.forEach(this.handlers,function(i){i!==null&&n(i)})}}const DT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},FU=typeof URLSearchParams<"u"?URLSearchParams:vw,$U=typeof FormData<"u"?FormData:null,zU=typeof Blob<"u"?Blob:null,UU={isBrowser:!0,classes:{URLSearchParams:FU,FormData:$U,Blob:zU},protocols:["http","https","file","blob","url","data"]},ww=typeof window<"u"&&typeof document<"u",x1=typeof navigator=="object"&&navigator||void 0,BU=ww&&(!x1||["ReactNative","NativeScript","NS"].indexOf(x1.product)<0),qU=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",VU=ww&&window.location.href||"http://localhost",HU=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ww,hasStandardBrowserEnv:BU,hasStandardBrowserWebWorkerEnv:qU,navigator:x1,origin:VU},Symbol.toStringTag,{value:"Module"})),Pr={...HU,...UU};function GU(e,n){return Mb(e,new Pr.classes.URLSearchParams,Object.assign({visitor:function(t,i,a,o){return Pr.isNode&&Ve.isBuffer(t)?(this.append(i,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function YU(e){return Ve.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function WU(e){const n={},t=Object.keys(e);let i;const a=t.length;let o;for(i=0;i<a;i++)o=t[i],n[o]=e[o];return n}function IT(e){function n(t,i,a,o){let l=t[o++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),f=o>=t.length;return l=!l&&Ve.isArray(a)?a.length:l,f?(Ve.hasOwnProp(a,l)?a[l]=[a[l],i]:a[l]=i,!d):((!a[l]||!Ve.isObject(a[l]))&&(a[l]=[]),n(t,i,a[l],o)&&Ve.isArray(a[l])&&(a[l]=WU(a[l])),!d)}if(Ve.isFormData(e)&&Ve.isFunction(e.entries)){const t={};return Ve.forEachEntry(e,(i,a)=>{n(YU(i),a,t,0)}),t}return null}function QU(e,n,t){if(Ve.isString(e))try{return(n||JSON.parse)(e),Ve.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(e)}const lg={transitional:DT,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const i=t.getContentType()||"",a=i.indexOf("application/json")>-1,o=Ve.isObject(n);if(o&&Ve.isHTMLForm(n)&&(n=new FormData(n)),Ve.isFormData(n))return a?JSON.stringify(IT(n)):n;if(Ve.isArrayBuffer(n)||Ve.isBuffer(n)||Ve.isStream(n)||Ve.isFile(n)||Ve.isBlob(n)||Ve.isReadableStream(n))return n;if(Ve.isArrayBufferView(n))return n.buffer;if(Ve.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(o){if(i.indexOf("application/x-www-form-urlencoded")>-1)return GU(n,this.formSerializer).toString();if((d=Ve.isFileList(n))||i.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Mb(d?{"files[]":n}:n,f&&new f,this.formSerializer)}}return o||a?(t.setContentType("application/json",!1),QU(n)):n}],transformResponse:[function(n){const t=this.transitional||lg.transitional,i=t&&t.forcedJSONParsing,a=this.responseType==="json";if(Ve.isResponse(n)||Ve.isReadableStream(n))return n;if(n&&Ve.isString(n)&&(i&&!this.responseType||a)){const l=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(n)}catch(d){if(l)throw d.name==="SyntaxError"?Yt.from(d,Yt.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Pr.classes.FormData,Blob:Pr.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ve.forEach(["delete","get","head","post","put","patch"],e=>{lg.headers[e]={}});const JU=Ve.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),KU=e=>{const n={};let t,i,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),t=l.substring(0,a).trim().toLowerCase(),i=l.substring(a+1).trim(),!(!t||n[t]&&JU[t])&&(t==="set-cookie"?n[t]?n[t].push(i):n[t]=[i]:n[t]=n[t]?n[t]+", "+i:i)}),n},kC=Symbol("internals");function jm(e){return e&&String(e).trim().toLowerCase()}function Ux(e){return e===!1||e==null?e:Ve.isArray(e)?e.map(Ux):String(e)}function XU(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(e);)n[i[1]]=i[2];return n}const ZU=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function s0(e,n,t,i,a){if(Ve.isFunction(i))return i.call(this,n,t);if(a&&(n=t),!!Ve.isString(n)){if(Ve.isString(i))return n.indexOf(i)!==-1;if(Ve.isRegExp(i))return i.test(n)}}function eB(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,i)=>t.toUpperCase()+i)}function tB(e,n){const t=Ve.toCamelCase(" "+n);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+t,{value:function(a,o,l){return this[i].call(this,n,a,o,l)},configurable:!0})})}let da=class{constructor(n){n&&this.set(n)}set(n,t,i){const a=this;function o(d,f,u){const p=jm(f);if(!p)throw new Error("header name must be a non-empty string");const g=Ve.findKey(a,p);(!g||a[g]===void 0||u===!0||u===void 0&&a[g]!==!1)&&(a[g||f]=Ux(d))}const l=(d,f)=>Ve.forEach(d,(u,p)=>o(u,p,f));if(Ve.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(Ve.isString(n)&&(n=n.trim())&&!ZU(n))l(KU(n),t);else if(Ve.isHeaders(n))for(const[d,f]of n.entries())o(f,d,i);else n!=null&&o(t,n,i);return this}get(n,t){if(n=jm(n),n){const i=Ve.findKey(this,n);if(i){const a=this[i];if(!t)return a;if(t===!0)return XU(a);if(Ve.isFunction(t))return t.call(this,a,i);if(Ve.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=jm(n),n){const i=Ve.findKey(this,n);return!!(i&&this[i]!==void 0&&(!t||s0(this,this[i],i,t)))}return!1}delete(n,t){const i=this;let a=!1;function o(l){if(l=jm(l),l){const d=Ve.findKey(i,l);d&&(!t||s0(i,i[d],d,t))&&(delete i[d],a=!0)}}return Ve.isArray(n)?n.forEach(o):o(n),a}clear(n){const t=Object.keys(this);let i=t.length,a=!1;for(;i--;){const o=t[i];(!n||s0(this,this[o],o,n,!0))&&(delete this[o],a=!0)}return a}normalize(n){const t=this,i={};return Ve.forEach(this,(a,o)=>{const l=Ve.findKey(i,o);if(l){t[l]=Ux(a),delete t[o];return}const d=n?eB(o):String(o).trim();d!==o&&delete t[o],t[d]=Ux(a),i[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return Ve.forEach(this,(i,a)=>{i!=null&&i!==!1&&(t[a]=n&&Ve.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const i=new this(n);return t.forEach(a=>i.set(a)),i}static accessor(n){const i=(this[kC]=this[kC]={accessors:{}}).accessors,a=this.prototype;function o(l){const d=jm(l);i[d]||(tB(a,l),i[d]=!0)}return Ve.isArray(n)?n.forEach(o):o(n),this}};da.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ve.reduceDescriptors(da.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(i){this[t]=i}}});Ve.freezeMethods(da);function o0(e,n){const t=this||lg,i=n||t,a=da.from(i.headers);let o=i.data;return Ve.forEach(e,function(d){o=d.call(t,o,a.normalize(),n?n.status:void 0)}),a.normalize(),o}function RT(e){return!!(e&&e.__CANCEL__)}function Hh(e,n,t){Yt.call(this,e??"canceled",Yt.ERR_CANCELED,n,t),this.name="CanceledError"}Ve.inherits(Hh,Yt,{__CANCEL__:!0});function MT(e,n,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?e(t):n(new Yt("Request failed with status code "+t.status,[Yt.ERR_BAD_REQUEST,Yt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function nB(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function iB(e,n){e=e||10;const t=new Array(e),i=new Array(e);let a=0,o=0,l;return n=n!==void 0?n:1e3,function(f){const u=Date.now(),p=i[o];l||(l=u),t[a]=f,i[a]=u;let g=o,b=0;for(;g!==a;)b+=t[g++],g=g%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),u-l<n)return;const v=p&&u-p;return v?Math.round(b*1e3/v):void 0}}function rB(e,n){let t=0,i=1e3/n,a,o;const l=(u,p=Date.now())=>{t=p,a=null,o&&(clearTimeout(o),o=null),e.apply(null,u)};return[(...u)=>{const p=Date.now(),g=p-t;g>=i?l(u,p):(a=u,o||(o=setTimeout(()=>{o=null,l(a)},i-g)))},()=>a&&l(a)]}const ob=(e,n,t=3)=>{let i=0;const a=iB(50,250);return rB(o=>{const l=o.loaded,d=o.lengthComputable?o.total:void 0,f=l-i,u=a(f),p=l<=d;i=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:u||void 0,estimated:u&&d&&p?(d-l)/u:void 0,event:o,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(g)},t)},TC=(e,n)=>{const t=e!=null;return[i=>n[0]({lengthComputable:t,total:e,loaded:i}),n[1]]},EC=e=>(...n)=>Ve.asap(()=>e(...n)),aB=Pr.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,Pr.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(Pr.origin),Pr.navigator&&/(msie|trident)/i.test(Pr.navigator.userAgent)):()=>!0,sB=Pr.hasStandardBrowserEnv?{write(e,n,t,i,a,o){const l=[e+"="+encodeURIComponent(n)];Ve.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),Ve.isString(i)&&l.push("path="+i),Ve.isString(a)&&l.push("domain="+a),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function oB(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function lB(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function OT(e,n,t){let i=!oB(n);return e&&(i||t==!1)?lB(e,n):n}const AC=e=>e instanceof da?{...e}:e;function zd(e,n){n=n||{};const t={};function i(u,p,g,b){return Ve.isPlainObject(u)&&Ve.isPlainObject(p)?Ve.merge.call({caseless:b},u,p):Ve.isPlainObject(p)?Ve.merge({},p):Ve.isArray(p)?p.slice():p}function a(u,p,g,b){if(Ve.isUndefined(p)){if(!Ve.isUndefined(u))return i(void 0,u,g,b)}else return i(u,p,g,b)}function o(u,p){if(!Ve.isUndefined(p))return i(void 0,p)}function l(u,p){if(Ve.isUndefined(p)){if(!Ve.isUndefined(u))return i(void 0,u)}else return i(void 0,p)}function d(u,p,g){if(g in n)return i(u,p);if(g in e)return i(void 0,u)}const f={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(u,p,g)=>a(AC(u),AC(p),g,!0)};return Ve.forEach(Object.keys(Object.assign({},e,n)),function(p){const g=f[p]||a,b=g(e[p],n[p],p);Ve.isUndefined(b)&&g!==d||(t[p]=b)}),t}const LT=e=>{const n=zd({},e);let{data:t,withXSRFToken:i,xsrfHeaderName:a,xsrfCookieName:o,headers:l,auth:d}=n;n.headers=l=da.from(l),n.url=PT(OT(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let f;if(Ve.isFormData(t)){if(Pr.hasStandardBrowserEnv||Pr.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((f=l.getContentType())!==!1){const[u,...p]=f?f.split(";").map(g=>g.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...p].join("; "))}}if(Pr.hasStandardBrowserEnv&&(i&&Ve.isFunction(i)&&(i=i(n)),i||i!==!1&&aB(n.url))){const u=a&&o&&sB.read(o);u&&l.set(a,u)}return n},cB=typeof XMLHttpRequest<"u",uB=cB&&function(e){return new Promise(function(t,i){const a=LT(e);let o=a.data;const l=da.from(a.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:u}=a,p,g,b,v,S;function k(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(p),a.signal&&a.signal.removeEventListener("abort",p)}let T=new XMLHttpRequest;T.open(a.method.toUpperCase(),a.url,!0),T.timeout=a.timeout;function P(){if(!T)return;const I=da.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),L={data:!d||d==="text"||d==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:I,config:e,request:T};MT(function(z){t(z),k()},function(z){i(z),k()},L),T=null}"onloadend"in T?T.onloadend=P:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(P)},T.onabort=function(){T&&(i(new Yt("Request aborted",Yt.ECONNABORTED,e,T)),T=null)},T.onerror=function(){i(new Yt("Network Error",Yt.ERR_NETWORK,e,T)),T=null},T.ontimeout=function(){let U=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const L=a.transitional||DT;a.timeoutErrorMessage&&(U=a.timeoutErrorMessage),i(new Yt(U,L.clarifyTimeoutError?Yt.ETIMEDOUT:Yt.ECONNABORTED,e,T)),T=null},o===void 0&&l.setContentType(null),"setRequestHeader"in T&&Ve.forEach(l.toJSON(),function(U,L){T.setRequestHeader(L,U)}),Ve.isUndefined(a.withCredentials)||(T.withCredentials=!!a.withCredentials),d&&d!=="json"&&(T.responseType=a.responseType),u&&([b,S]=ob(u,!0),T.addEventListener("progress",b)),f&&T.upload&&([g,v]=ob(f),T.upload.addEventListener("progress",g),T.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(p=I=>{T&&(i(!I||I.type?new Hh(null,e,T):I),T.abort(),T=null)},a.cancelToken&&a.cancelToken.subscribe(p),a.signal&&(a.signal.aborted?p():a.signal.addEventListener("abort",p)));const M=nB(a.url);if(M&&Pr.protocols.indexOf(M)===-1){i(new Yt("Unsupported protocol "+M+":",Yt.ERR_BAD_REQUEST,e));return}T.send(o||null)})},dB=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let i=new AbortController,a;const o=function(u){if(!a){a=!0,d();const p=u instanceof Error?u:this.reason;i.abort(p instanceof Yt?p:new Hh(p instanceof Error?p.message:p))}};let l=n&&setTimeout(()=>{l=null,o(new Yt(`timeout ${n} of ms exceeded`,Yt.ETIMEDOUT))},n);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),e=null)};e.forEach(u=>u.addEventListener("abort",o));const{signal:f}=i;return f.unsubscribe=()=>Ve.asap(d),f}},fB=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let i=0,a;for(;i<t;)a=i+n,yield e.slice(i,a),i=a},hB=async function*(e,n){for await(const t of pB(e))yield*fB(t,n)},pB=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:i}=await n.read();if(t)break;yield i}}finally{await n.cancel()}},PC=(e,n,t,i)=>{const a=hB(e,n);let o=0,l,d=f=>{l||(l=!0,i&&i(f))};return new ReadableStream({async pull(f){try{const{done:u,value:p}=await a.next();if(u){d(),f.close();return}let g=p.byteLength;if(t){let b=o+=g;t(b)}f.enqueue(new Uint8Array(p))}catch(u){throw d(u),u}},cancel(f){return d(f),a.return()}},{highWaterMark:2})},Ob=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",FT=Ob&&typeof ReadableStream=="function",mB=Ob&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),$T=(e,...n)=>{try{return!!e(...n)}catch{return!1}},gB=FT&&$T(()=>{let e=!1;const n=new Request(Pr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),DC=64*1024,b1=FT&&$T(()=>Ve.isReadableStream(new Response("").body)),lb={stream:b1&&(e=>e.body)};Ob&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!lb[n]&&(lb[n]=Ve.isFunction(e[n])?t=>t[n]():(t,i)=>{throw new Yt(`Response type '${n}' is not supported`,Yt.ERR_NOT_SUPPORT,i)})})})(new Response);const yB=async e=>{if(e==null)return 0;if(Ve.isBlob(e))return e.size;if(Ve.isSpecCompliantForm(e))return(await new Request(Pr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Ve.isArrayBufferView(e)||Ve.isArrayBuffer(e))return e.byteLength;if(Ve.isURLSearchParams(e)&&(e=e+""),Ve.isString(e))return(await mB(e)).byteLength},xB=async(e,n)=>{const t=Ve.toFiniteNumber(e.getContentLength());return t??yB(n)},bB=Ob&&(async e=>{let{url:n,method:t,data:i,signal:a,cancelToken:o,timeout:l,onDownloadProgress:d,onUploadProgress:f,responseType:u,headers:p,withCredentials:g="same-origin",fetchOptions:b}=LT(e);u=u?(u+"").toLowerCase():"text";let v=dB([a,o&&o.toAbortSignal()],l),S;const k=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let T;try{if(f&&gB&&t!=="get"&&t!=="head"&&(T=await xB(p,i))!==0){let L=new Request(n,{method:"POST",body:i,duplex:"half"}),F;if(Ve.isFormData(i)&&(F=L.headers.get("content-type"))&&p.setContentType(F),L.body){const[z,$]=TC(T,ob(EC(f)));i=PC(L.body,DC,z,$)}}Ve.isString(g)||(g=g?"include":"omit");const P="credentials"in Request.prototype;S=new Request(n,{...b,signal:v,method:t.toUpperCase(),headers:p.normalize().toJSON(),body:i,duplex:"half",credentials:P?g:void 0});let M=await fetch(S);const I=b1&&(u==="stream"||u==="response");if(b1&&(d||I&&k)){const L={};["status","statusText","headers"].forEach(B=>{L[B]=M[B]});const F=Ve.toFiniteNumber(M.headers.get("content-length")),[z,$]=d&&TC(F,ob(EC(d),!0))||[];M=new Response(PC(M.body,DC,z,()=>{$&&$(),k&&k()}),L)}u=u||"text";let U=await lb[Ve.findKey(lb,u)||"text"](M,e);return!I&&k&&k(),await new Promise((L,F)=>{MT(L,F,{data:U,headers:da.from(M.headers),status:M.status,statusText:M.statusText,config:e,request:S})})}catch(P){throw k&&k(),P&&P.name==="TypeError"&&/fetch/i.test(P.message)?Object.assign(new Yt("Network Error",Yt.ERR_NETWORK,e,S),{cause:P.cause||P}):Yt.from(P,P&&P.code,e,S)}}),v1={http:RU,xhr:uB,fetch:bB};Ve.forEach(v1,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const IC=e=>`- ${e}`,vB=e=>Ve.isFunction(e)||e===null||e===!1,zT={getAdapter:e=>{e=Ve.isArray(e)?e:[e];const{length:n}=e;let t,i;const a={};for(let o=0;o<n;o++){t=e[o];let l;if(i=t,!vB(t)&&(i=v1[(l=String(t)).toLowerCase()],i===void 0))throw new Yt(`Unknown adapter '${l}'`);if(i)break;a[l||"#"+o]=i}if(!i){const o=Object.entries(a).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(IC).join(`
`):" "+IC(o[0]):"as no adapter specified";throw new Yt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i},adapters:v1};function l0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Hh(null,e)}function RC(e){return l0(e),e.headers=da.from(e.headers),e.data=o0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),zT.getAdapter(e.adapter||lg.adapter)(e).then(function(i){return l0(e),i.data=o0.call(e,e.transformResponse,i),i.headers=da.from(i.headers),i},function(i){return RT(i)||(l0(e),i&&i.response&&(i.response.data=o0.call(e,e.transformResponse,i.response),i.response.headers=da.from(i.response.headers))),Promise.reject(i)})}const UT="1.8.4",Lb={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Lb[e]=function(i){return typeof i===e||"a"+(n<1?"n ":" ")+e}});const MC={};Lb.transitional=function(n,t,i){function a(o,l){return"[Axios v"+UT+"] Transitional option '"+o+"'"+l+(i?". "+i:"")}return(o,l,d)=>{if(n===!1)throw new Yt(a(l," has been removed"+(t?" in "+t:"")),Yt.ERR_DEPRECATED);return t&&!MC[l]&&(MC[l]=!0,console.warn(a(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,d):!0}};Lb.spelling=function(n){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${n}`),!0)};function wB(e,n,t){if(typeof e!="object")throw new Yt("options must be an object",Yt.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let a=i.length;for(;a-- >0;){const o=i[a],l=n[o];if(l){const d=e[o],f=d===void 0||l(d,o,e);if(f!==!0)throw new Yt("option "+o+" must be "+f,Yt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Yt("Unknown option "+o,Yt.ERR_BAD_OPTION)}}const Bx={assertOptions:wB,validators:Lb},qo=Bx.validators;let Rd=class{constructor(n){this.defaults=n,this.interceptors={request:new _C,response:new _C}}async request(n,t){try{return await this._request(n,t)}catch(i){if(i instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{i.stack?o&&!String(i.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+o):i.stack=o}catch{}}throw i}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=zd(this.defaults,t);const{transitional:i,paramsSerializer:a,headers:o}=t;i!==void 0&&Bx.assertOptions(i,{silentJSONParsing:qo.transitional(qo.boolean),forcedJSONParsing:qo.transitional(qo.boolean),clarifyTimeoutError:qo.transitional(qo.boolean)},!1),a!=null&&(Ve.isFunction(a)?t.paramsSerializer={serialize:a}:Bx.assertOptions(a,{encode:qo.function,serialize:qo.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Bx.assertOptions(t,{baseUrl:qo.spelling("baseURL"),withXsrfToken:qo.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&Ve.merge(o.common,o[t.method]);o&&Ve.forEach(["delete","get","head","post","put","patch","common"],S=>{delete o[S]}),t.headers=da.concat(l,o);const d=[];let f=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(f=f&&k.synchronous,d.unshift(k.fulfilled,k.rejected))});const u=[];this.interceptors.response.forEach(function(k){u.push(k.fulfilled,k.rejected)});let p,g=0,b;if(!f){const S=[RC.bind(this),void 0];for(S.unshift.apply(S,d),S.push.apply(S,u),b=S.length,p=Promise.resolve(t);g<b;)p=p.then(S[g++],S[g++]);return p}b=d.length;let v=t;for(g=0;g<b;){const S=d[g++],k=d[g++];try{v=S(v)}catch(T){k.call(this,T);break}}try{p=RC.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,b=u.length;g<b;)p=p.then(u[g++],u[g++]);return p}getUri(n){n=zd(this.defaults,n);const t=OT(n.baseURL,n.url,n.allowAbsoluteUrls);return PT(t,n.params,n.paramsSerializer)}};Ve.forEach(["delete","get","head","options"],function(n){Rd.prototype[n]=function(t,i){return this.request(zd(i||{},{method:n,url:t,data:(i||{}).data}))}});Ve.forEach(["post","put","patch"],function(n){function t(i){return function(o,l,d){return this.request(zd(d||{},{method:n,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}Rd.prototype[n]=t(),Rd.prototype[n+"Form"]=t(!0)});let SB=class BT{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const i=this;this.promise.then(a=>{if(!i._listeners)return;let o=i._listeners.length;for(;o-- >0;)i._listeners[o](a);i._listeners=null}),this.promise.then=a=>{let o;const l=new Promise(d=>{i.subscribe(d),o=d}).then(a);return l.cancel=function(){i.unsubscribe(o)},l},n(function(o,l,d){i.reason||(i.reason=new Hh(o,l,d),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=i=>{n.abort(i)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new BT(function(a){n=a}),cancel:n}}};function NB(e){return function(t){return e.apply(null,t)}}function CB(e){return Ve.isObject(e)&&e.isAxiosError===!0}const w1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(w1).forEach(([e,n])=>{w1[n]=e});function qT(e){const n=new Rd(e),t=vT(Rd.prototype.request,n);return Ve.extend(t,Rd.prototype,n,{allOwnKeys:!0}),Ve.extend(t,n,null,{allOwnKeys:!0}),t.create=function(a){return qT(zd(e,a))},t}const pi=qT(lg);pi.Axios=Rd;pi.CanceledError=Hh;pi.CancelToken=SB;pi.isCancel=RT;pi.VERSION=UT;pi.toFormData=Mb;pi.AxiosError=Yt;pi.Cancel=pi.CanceledError;pi.all=function(n){return Promise.all(n)};pi.spread=NB;pi.isAxiosError=CB;pi.mergeConfig=zd;pi.AxiosHeaders=da;pi.formToJSON=e=>IT(Ve.isHTMLForm(e)?new FormData(e):e);pi.getAdapter=zT.getAdapter;pi.HttpStatusCode=w1;pi.default=pi;const{Axios:Ane,AxiosError:Pne,CanceledError:Dne,isCancel:Ine,CancelToken:Rne,VERSION:Mne,all:One,Cancel:Lne,isAxiosError:Fne,spread:$ne,toFormData:zne,AxiosHeaders:Une,HttpStatusCode:Bne,formToJSON:qne,getAdapter:Vne,mergeConfig:Hne}=pi,jB=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},VT=()=>localStorage.getItem("authToken");function _B(){const[e,n]=w.useState(null),[t,i]=w.useState(!1);return w.useEffect(()=>{const d=()=>{i(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"screen",start:async()=>{const d=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(d),i(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),i(!1))},isStreaming:t,stream:e}}function kB(){const[e,n]=w.useState(null),[t,i]=w.useState(!1);return w.useEffect(()=>{const d=()=>{i(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"webcam",start:async()=>{const d=await navigator.mediaDevices.getUserMedia({video:!0});return n(d),i(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),i(!1))},isStreaming:t,stream:e}}class TB extends yT{constructor(t){super();qn(this,"client");qn(this,"_status","disconnected");qn(this,"_session",null);qn(this,"_model",null);qn(this,"config",null);this.client=new pT(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,i){const a={date:new Date,type:t,message:i};this.emit("log",a)}async connect(t,i){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=i,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:i,callbacks:a})}catch(o){return console.error("Error connecting to GenAI Live:",o),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var i;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let o=((i=a.modelTurn)==null?void 0:i.parts)||[];const l=o.filter(p=>{var g;return p.inlineData&&((g=p.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),d=l.map(p=>{var g;return(g=p.inlineData)==null?void 0:g.data}),f=bT.difference(o,l);if(d.forEach(p=>{if(p){const g=zz(p);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!f.length)return;o=f;const u={modelTurn:{parts:o}};this.emit("content",u),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let i=!1,a=!1;for(const d of t)if((l=this.session)==null||l.sendRealtimeInput({media:d}),d.mimeType.includes("audio")&&(i=!0),d.mimeType.includes("image")&&(a=!0),i&&a)break;const o=i&&a?"audio + video":i?"audio":a?"video":"unknown";this.log("client.realtimeInput",o)}sendToolResponse(t){var i;t.functionResponses&&t.functionResponses.length&&((i=this.session)==null||i.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,i=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:i}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:i})}}function EB(e){const n=w.useMemo(()=>new TB(e),[e]),t=w.useRef(null),[i,a]=w.useState("models/gemini-2.5-flash-live-preview"),[o,l]=w.useState({}),[d,f]=w.useState(!1),[u,p]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||mT({id:"audio-out"}).then(k=>{t.current=new Qz(k),t.current.addWorklet("vumeter-out",gT,T=>{p(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{f(!0)},T=()=>{f(!1)},P=L=>{console.error("error",L)},M=()=>{var L;return(L=t.current)==null?void 0:L.stop()},I=L=>{var F;return(F=t.current)==null?void 0:F.addPCM16(new Uint8Array(L))},U=L=>{if(console.log("Received content event:",L),L.modelTurn&&L.modelTurn.parts){const F=L.modelTurn.parts.filter(z=>"text"in z&&z.text);if(F.length>0){const z=F.map($=>$.text).join(" ");b(z),console.log("AI Summary received:",z)}}};return n.on("error",P).on("open",k).on("close",T).on("interrupted",M).on("audio",I).on("content",U),()=>{n.off("error",P).off("open",k).off("close",T).off("interrupted",M).off("audio",I).off("content",U).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!o)throw new Error("config has not been set");n.disconnect(),await n.connect(i,o)},[n,o,i]),S=w.useCallback(async()=>{n.disconnect(),f(!1)},[f,n]);return{client:n,config:o,setConfig:l,model:i,setModel:a,connected:d,connect:v,disconnect:S,volume:u,aiSummary:g}}const HT=w.createContext(void 0),Sw=({options:e,children:n})=>{const t=EB(e);return r.jsx(HT.Provider,{value:t,children:n})},ou=()=>{const e=w.useContext(HT);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function AB(){const{config:e,setConfig:n}=ou(),[t,i]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(o=>{n({...e,responseModalities:[o==="audio"?nu.AUDIO:nu.TEXT]})},[e,n]);return r.jsxs("div",{className:"select-group",children:[r.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),r.jsx(Kk,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:o=>{i(o),o&&(o.value==="audio"||o.value==="text")&&a(o.value)}})]})}const OC=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function PB(){const{config:e,setConfig:n}=ou();w.useEffect(()=>{var d,f,u;const o=((u=(f=(d=e.speechConfig)==null?void 0:d.voiceConfig)==null?void 0:f.prebuiltVoiceConfig)==null?void 0:u.voiceName)||"Atari02";i({value:o,label:o})},[e]);const[t,i]=w.useState(OC[5]),a=w.useCallback(o=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:o}}}})},[e,n]);return r.jsxs("div",{className:"select-group",children:[r.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),r.jsx(Kk,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:OC,onChange:o=>{i(o),o&&a(o.value)}})]})}function DB(){const[e,n]=w.useState(!1),{config:t,setConfig:i,connected:a}=ou(),o=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(u=>Array.isArray(u.functionDeclarations)).map(u=>u.functionDeclarations).filter(u=>!!u).flat():[],[t]),l=w.useMemo(()=>{var u;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(p=>typeof p=="string"?p:p.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((u=t.systemInstruction.parts)==null?void 0:u.map(p=>p.text).join(`
`))||"":""},[t]),d=w.useCallback(u=>{const p={...t,systemInstruction:u.target.value};i(p)},[t,i]),f=w.useCallback((u,p)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===u?{...k,description:p}:k)}:v}))||[]};i(g)},[t,i]);return r.jsxs("div",{className:"settings-dialog",children:[r.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),r.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:r.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&r.jsx("div",{className:"connected-indicator",children:r.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),r.jsxs("div",{className:"mode-selectors",children:[r.jsx(AB,{}),r.jsx(PB,{})]}),r.jsx("h3",{children:"System Instructions"}),r.jsx("textarea",{className:"system",onChange:d,value:l}),r.jsx("h4",{children:"Function declarations"}),r.jsx("div",{className:"function-declarations",children:r.jsx("div",{className:"fd-rows",children:o.map((u,p)=>{var g;return r.jsxs("div",{className:"fd-row",children:[r.jsx("span",{className:"fd-row-name",children:u.name}),r.jsx("span",{className:"fd-row-args",children:Object.keys(((g=u.parameters)==null?void 0:g.properties)||{}).map((b,v)=>r.jsx("span",{children:b},v))}),r.jsx("input",{className:"fd-row-description",type:"text",defaultValue:u.description,onBlur:b=>f(u.name,b.target.value)},`fd-${u.description}`)]},`function-${p}`)})})})]})})]})}const LC=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:i,stop:a})=>e?r.jsx("button",{className:"action-button",onClick:a,children:r.jsx("span",{className:"material-symbols-outlined",children:n})}):r.jsx("button",{className:"action-button",onClick:i,children:r.jsx("span",{className:"material-symbols-outlined",children:t})}));function IB({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:i,enableEditingSettings:a}){const o=[kB(),_B()],[l,d]=w.useState(null),[f,u]=o,[p,g]=w.useState(0),[b]=w.useState(()=>new xT),[v,S]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:P,connected:M,connect:I,disconnect:U,volume:L}=ou();w.useEffect(()=>{!M&&T.current&&T.current.focus()},[M]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(p*200,8))}px`)},[p]),w.useEffect(()=>{const z=$=>{P.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:$}])};return M&&!v&&b?b.on("data",z).on("volume",g).start():b.stop(),()=>{b.off("data",z).off("volume",g)}},[M,P,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let z=-1;function $(){const B=e.current,R=k.current;if(!B||!R)return;const V=R.getContext("2d");if(R.width=B.videoWidth*.25,R.height=B.videoHeight*.25,R.width+R.height>0){V.drawImage(B,0,0,R.width,R.height);const Y=R.toDataURL("image/jpeg",1),ie=Y.slice(Y.indexOf(",")+1,1/0);P.sendRealtimeInput([{mimeType:"image/jpeg",data:ie}])}M&&(z=window.setTimeout($,1e3/.5))}return M&&l!==null&&requestAnimationFrame($),()=>{clearTimeout(z)}},[M,l,P,e]);const F=z=>async()=>{if(z){const $=await z.start();d($),t($)}else d(null),t(null);o.filter($=>$!==z).forEach($=>$.stop())};return r.jsxs("section",{className:"control-tray",children:[r.jsx("canvas",{style:{display:"none"},ref:k}),r.jsxs("nav",{className:Jc("actions-nav",{disabled:!M}),children:[r.jsx("button",{className:Jc("action-button mic-button",{recording:!v&&M}),onClick:()=>S(!v),children:v?r.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):r.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),r.jsx("div",{className:"action-button no-action outlined",children:r.jsx(Gz,{volume:L,active:M,hover:!1})}),i&&r.jsxs(r.Fragment,{children:[r.jsx(LC,{isStreaming:u.isStreaming,start:F(u),stop:F(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),r.jsx(LC,{isStreaming:f.isStreaming,start:F(f),stop:F(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),r.jsxs("div",{className:Jc("connection-container",{connected:M}),children:[r.jsx("div",{className:"connection-button-container",children:r.jsx("button",{ref:T,className:Jc("action-button connect-toggle",{connected:M}),onClick:M?U:I,children:r.jsx("span",{className:"material-symbols-outlined filled",children:M?"pause":"play_arrow"})})}),r.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?r.jsx(DB,{}):""]})}const FC={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Oh.OBJECT,properties:{summary:{type:Oh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},RB=({patientData:e,tokenNumber:n})=>{const[t,i]=w.useState(""),{client:a,setConfig:o,setModel:l}=ou();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),o({responseModalities:[nu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[FC]}]})},[o,l]),w.useEffect(()=>{const d=f=>{if(!f.functionCalls)return;const u=f.functionCalls.find(p=>p.name===FC.name);if(u){const p=u.args.summary;i(p)}f.functionCalls.length&&setTimeout(()=>{var p;return a.sendToolResponse({functionResponses:(p=f.functionCalls)==null?void 0:p.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",d),()=>{a.off("toolcall",d)}},[a]),w.useEffect(()=>{if(t){const d=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${d}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${d}`}},[t,n]),r.jsxs("div",{className:"hospital-reception",children:[r.jsx("h1",{children:"Newtons Ai"}),r.jsx("p",{children:"Newtons Ai"}),n&&r.jsxs("h2",{children:["Token Number: ",n]}),e&&r.jsxs("div",{children:[r.jsx("h2",{children:"Patient Details"}),r.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&r.jsxs("div",{children:[r.jsx("h2",{children:"Case Summary (from Tool Call)"}),r.jsx("p",{children:t})]})]})},$C="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes";async function MB(){const e=VT();if(!e)return console.warn("No auth token found, using default Live API key."),$C;try{const t=(await pi.get("/api/clinics/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).data.geminiApiKey;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Live API key:",n)}return console.warn("Clinic-specific Live API key not found or failed to fetch, using default."),$C}function OB(){const e=w.useRef(null),[n,t]=w.useState(null),[i,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await MB();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),i?r.jsx("div",{className:"App",children:r.jsx(Sw,{options:i,children:r.jsx(LB,{videoRef:e,setVideoStream:t,videoStream:n})})}):r.jsx("div",{children:"Loading Live API settings..."})}const LB=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[i,a]=w.useState(null),[o,l]=w.useState(null),{connected:d,client:f,connect:u,config:p,model:g}=ou(),[b,v]=w.useState(""),S=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const M=window.matchMedia("(prefers-color-scheme: dark)"),I=U=>{document.documentElement.setAttribute("data-theme",U.matches?"dark":"light")};return I(M),M.addEventListener("change",I),()=>M.removeEventListener("change",I)},[]),w.useEffect(()=>{const M=new URLSearchParams(window.location.search),I={};for(const[U,L]of M.entries())U==="token_number"?l(L):I[U]=L;a(I)},[]),w.useEffect(()=>{Object.keys(p).length>0&&g&&u()},[u,p,g]),w.useEffect(()=>{if(d&&i&&!k){const M=JSON.stringify(i,null,2);f.send([{text:M}]),v(""),T(!0)}},[d,i,f,k]),w.useEffect(()=>{i&&v(JSON.stringify(i,null,2))},[i]);const P=()=>{f.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return r.jsx("div",{className:"streaming-console",children:r.jsxs("main",{children:[r.jsxs("div",{className:"main-app-area",children:[r.jsx(RB,{patientData:i,tokenNumber:o}),r.jsx("video",{className:Jc("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),r.jsx("div",{className:Jc("input-container",{disabled:!d}),children:r.jsxs("div",{className:"input-content",children:[r.jsx("textarea",{className:"input-area",ref:S,onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),M.stopPropagation(),P())},onChange:M=>v(M.target.value),value:b}),r.jsx("span",{className:Jc("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),r.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:P,children:"send"})]})}),r.jsx(IB,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},zC="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",FB=({volume:e,active:n})=>{const t=Array.from({length:5},(i,a)=>r.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return r.jsx("div",{className:"audio-pulse",children:t})},$B=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:i,onSubmitTextInput:a},o)=>{var F;const{connected:l,connect:d,disconnect:f,client:u,volume:p}=ou(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P]=w.useState(()=>new xT),M=async()=>{l?await f():(await d(),i.trim()&&a())};w.useEffect(()=>{const z=$=>{u.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:$}])};return l&&!g?P.on("data",z).start():P.stop(),()=>{P.off("data",z),P.stop()}},[l,u,g,P]);const I=w.useCallback(async()=>{if(v)L==null||L.getTracks().forEach(z=>z.stop()),t(null),S(!1);else try{const z=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=z),t(z),S(!0)}catch(z){console.error("Error accessing webcam:",z),S(!1)}},[v,t,e]),U=w.useCallback(async()=>{if(k)L==null||L.getTracks().forEach(z=>z.stop()),t(null),T(!1);else try{const z=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=z),t(z),T(!0)}catch(z){console.error("Error accessing screen share:",z),T(!1)}},[k,t,e]),L=(F=e.current)==null?void 0:F.srcObject;return w.useEffect(()=>()=>{L&&L.getTracks().forEach(z=>z.stop())},[L]),w.useImperativeHandle(o,()=>({handleConnect:M})),r.jsx("div",{className:"live-api-control-tray",children:r.jsxs("div",{className:"live-api-control-tray-inner",children:[r.jsxs("div",{className:"live-api-control-group",children:[r.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?r.jsx(rR,{className:"w-5 h-5"}):r.jsx(ak,{className:"w-5 h-5"})}),r.jsx("div",{className:"live-api-audio-pulse-container",children:r.jsx(FB,{volume:p,active:l})}),n&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:U,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:r.jsx(oR,{className:"w-5 h-5"})}),r.jsx("button",{onClick:I,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:r.jsx(KR,{className:"w-5 h-5"})})]})]}),r.jsxs("div",{className:"live-api-control-group",children:[r.jsxs("div",{className:"live-api-status-indicator",children:[r.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),r.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),r.jsx("button",{onClick:M,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?r.jsxs(r.Fragment,{children:[r.jsx(pR,{className:"w-5 h-5"}),r.jsx("span",{children:"Pause"})]}):r.jsxs(r.Fragment,{children:[r.jsx(wR,{className:"w-5 h-5"}),r.jsx("span",{children:"Start"})]})})]})]})})}),zB=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:i})=>r.jsxs("div",{className:"hospital-reception-container",children:[r.jsxs("div",{className:"hospital-reception-logo-section",children:[r.jsx("div",{className:"hospital-reception-logo",children:r.jsx("span",{children:i.charAt(0)})}),r.jsxs("h1",{className:"hospital-reception-title",children:[i," AI"]}),r.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",i," Reception Assistant"]})]}),n&&r.jsxs("div",{className:"hospital-reception-token-card",children:[r.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),r.jsx("p",{className:"hospital-reception-token-number",children:n})]}),e?r.jsxs("div",{className:"hospital-reception-patient-info-card",children:[r.jsx("h3",{className:"hospital-reception-patient-info-title",children:"Patient Information"}),r.jsx("div",{className:"hospital-reception-patient-info-content",children:r.jsx("pre",{className:"hospital-reception-patient-info-pre",children:JSON.stringify(e,null,2)})})]}):r.jsxs("div",{className:"hospital-reception-patient-info-card",children:[r.jsx("h3",{className:"hospital-reception-patient-info-title",children:"New Case"}),r.jsx("p",{className:"hospital-reception-patient-info-pre",children:"No patient data provided. This is a new case."})]}),t&&r.jsxs("div",{className:"hospital-reception-summary-card",children:[r.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),r.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),UC={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Oh.OBJECT,properties:{summary:{type:Oh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},UB=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:i,clinicName:a})=>{const o=w.useRef(null),l=w.useRef(null),[d,f]=w.useState(null),[u,p]=w.useState("hi"),{client:g,connected:b,aiSummary:v,setConfig:S,setModel:k,disconnect:T}=ou(),[P,M]=w.useState(null),I=w.useMemo(()=>{let F=`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`;return n&&(F+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[nu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:F}]},tools:[{functionDeclarations:[UC]}]}},[n]);w.useEffect(()=>{k("models/gemini-2.5-flash-live-preview"),S(I);const F=setTimeout(()=>{l.current&&!b&&l.current.handleConnect()},2e3);return()=>clearTimeout(F)},[S,k,I,b]),w.useEffect(()=>()=>{b&&T()},[b,T]),w.useEffect(()=>{i(v)},[v,i]),w.useEffect(()=>{const F=z=>{if(z.modelTurn&&z.modelTurn.parts){for(const $ of z.modelTurn.parts)if($.executableCode){const B=$.executableCode.code,R=/summary=["'](.*?)["']/.exec(B);if(R&&R[1]){const V=R[1];M(V),i(V)}}}};return g.on("content",F),()=>{g.off("content",F)}},[g,i]),w.useEffect(()=>{const F=z=>{if(!z.functionCalls)return;const $=z.functionCalls.find(B=>B.name===UC.name);if($){const B=$.args.summary;i(B)}z.functionCalls.length&&setTimeout(()=>{var B;return g.sendToolResponse({functionResponses:(B=z.functionCalls)==null?void 0:B.map(R=>({response:{output:{success:!0}},id:R.id,name:R.name}))})},200)};return g.on("toolcall",F),()=>{g.off("toolcall",F)}},[g,i]);const U=()=>{u.trim()&&(g.send([{text:u}]),p(""))},L=F=>{F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),U())};return r.jsx("div",{className:"live-api-modal-overlay",children:r.jsxs("div",{className:"live-api-modal-content",children:[r.jsxs("div",{className:"live-api-modal-header",children:[r.jsxs("div",{className:"live-api-modal-header-left",children:[r.jsx("div",{className:"live-api-modal-logo",children:r.jsx("span",{children:a.charAt(0)})}),r.jsxs("div",{children:[r.jsx("h1",{className:"live-api-modal-title",children:a}),r.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:r.jsx(ni,{className:"w-6 h-6"})})})]}),r.jsx("div",{className:"live-api-modal-main-content",children:r.jsxs("div",{className:"flex-1 flex flex-col",children:[r.jsxs("div",{className:"live-api-reception-area",children:[r.jsx(zB,{patientData:n,tokenNumber:t,aiSummary:P??v,clinicName:a}),d&&r.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),r.jsx("div",{className:"live-api-input-area",children:r.jsxs("div",{className:"live-api-input-container",children:[r.jsx("textarea",{value:u,onChange:F=>p(F.target.value),onKeyDown:L,placeholder:"Type your message here...",disabled:!b,rows:1,className:"live-api-textarea"}),r.jsx("button",{onClick:U,disabled:!b||!u.trim(),className:"live-api-send-button","aria-label":"Send message",children:r.jsx(TR,{className:"w-5 h-5"})})]})}),r.jsx($B,{ref:l,videoRef:o,supportsVideo:!0,onVideoStreamChange:f,textInput:u,onSubmitTextInput:U})]})})]})})},GT=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:i})=>{const[a,o]=w.useState(null),[l,d]=w.useState("Newtons Ai"),[f,u]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{const v=await(await pe("/api/clinics/settings")).json();if(v.name&&v.name!==""?d(v.name):d("Newtons Ai"),v.gemini_api_key)o(v.gemini_api_key);else{try{const S=await pe("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();if(k.value){o(k.value);return}}}catch(S){console.warn("Failed to fetch global key fallback",S)}o(zC)}}catch(b){console.error("Failed to fetch clinic settings, using default API key and unknown clinic name:",b),o(zC),d("Newtons Ai")}finally{u(!1)}})()},[]),f)return r.jsx("div",{className:"live-api-modal-overlay",children:r.jsx("div",{className:"live-api-modal-content",children:r.jsx("div",{children:"Loading API Key and Clinic Name..."})})});if(!a)return r.jsx("div",{className:"live-api-modal-overlay",children:r.jsx("div",{className:"live-api-modal-content",children:r.jsx("div",{children:"Error: API Key not available."})})});const p={apiKey:a};return r.jsx(Sw,{options:p,children:r.jsx(UB,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:i,clinicName:l})})},BB="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",qB={apiKey:BB},jh=()=>{const[e,n]=w.useState(""),[t,i]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState(null),b=w.useRef(null),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[I,U]=w.useState(null),[L,F]=w.useState([]),z=kt(),$=cr();w.useEffect(()=>{(async()=>{try{const Q=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),J=await pe(`/api/patients?${Q.toString()}`);if(J.ok){const fe=await J.json();F(fe.patients||[])}}catch(Q){console.error("Error fetching recent patients:",Q)}})()},[]);const B=w.useCallback(async H=>{const Q=H||e;if(!Q.trim()){g("Please enter complaint details.");return}u(!0),g(null);try{const J=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!J.ok){const ue=await J.json().catch(()=>({message:"Failed to create patient"}));if(J.status===403&&ue.message.includes("Patient limit")){z("/start-clinic-subscription",{state:{errorMessage:ue.message}});return}throw new Error(ue.message||`Failed to create patient: ${J.statusText}`)}const fe=await J.json();if(!fe||!fe.id)throw new Error("Failed to create new patient or retrieve patient ID.");const A=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:fe.id,complaint:Q})});if(!A.ok){const ue=await A.text();throw new Error(`Failed to create queue entry: ${ue||A.statusText}`)}const oe=await A.json();if(!oe||!oe.id)throw new Error("Failed to create new complaint record or retrieve record ID.");z(`/dashboard/edit-complaint/${oe.id}`,{state:{initialComplaint:Q}})}catch(J){console.error("Error starting new complaint:",J),J.message.includes("Patient limit")?(g(`Error: ${J.message}. Please upgrade your plan.`),z("/start-clinic-subscription")):g(`Error: ${J.message||"Failed to start new complaint process."}`)}finally{u(!1)}},[e,z]);w.useEffect(()=>{const H=b.current;H&&(H.style.height="auto",H.style.height=`${H.scrollHeight}px`);const J=new URLSearchParams($.search).get("caseDetails");if(J){const fe=decodeURIComponent(J);fe!==e&&(n(fe),S(!0))}},[$.search,e]),w.useEffect(()=>{v&&e.trim()&&(z($.pathname,{replace:!0}),B(e),S(!1))},[v,e,B,z,$.pathname]),w.useEffect(()=>{const H=b.current;H&&(H.style.height="auto",H.style.height=`${H.scrollHeight}px`)},[e]),w.useEffect(()=>{P&&(n(P),T(!1),B(P),M(null))},[P,B]);const R=()=>{U({id:null,token:null,name:"New Case",age:null,gender:null}),T(!0)},V=w.useMemo(()=>vb(async H=>{const Q=H.trim(),J=/^\d+$/.test(Q),fe=Q.split(/\s+/).length;if(Q.length<2||J&&Q.length>10||!J&&fe>2){i([]),o(!1),d(null);return}o(!0),d(null);try{const A=new URLSearchParams({search:encodeURIComponent(H),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),oe=await pe(`/api/patients?${A.toString()}`);if(!oe.ok){const D=await oe.text();throw new Error(`API Error (${oe.status}): ${D||oe.statusText}`)}const ue=await oe.json();i(ue.patients)}catch(A){console.error("Error searching patients:",A),d(A.message||"Failed to search patients."),i([])}finally{o(!1)}},300),[]),Y=H=>{const Q=H.target.value;n(Q);const J=Q.trim(),fe=/^\d+$/.test(J),A=J.split(/\s+/).length;J.length>=2&&!(fe&&J.length>10||!fe&&A>2)?o(!0):(o(!1),i([])),V(Q)},ie=H=>{H.key==="Enter"&&!H.shiftKey&&(H.preventDefault(),t.length>0&&!a?te(t[0]):e.trim()&&!a&&B(e))},te=async H=>{H&&H.id&&z(`/dashboard/edit-complaint/patient/${H.id}`)},W=[{icon:"",title:"Example: Fever & Cold",description:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Example: Stomach Ache",description:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}];return r.jsxs("div",{className:"patient-search-page-container",children:[r.jsxs("div",{className:"patient-search-header",children:[r.jsx("button",{onClick:()=>z("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),r.jsx("button",{onClick:()=>z(-1),className:"patient-search-button patient-search-button-back",children:r.jsx(nn,{size:16})})]}),r.jsxs("div",{className:"patient-search-content-box",children:[l&&r.jsx("p",{className:"patient-search-error",children:l}),p&&r.jsx("p",{className:"patient-search-error",children:p}),L.length>0&&r.jsxs("div",{className:"newly-registered-section",children:[r.jsx("div",{className:"recent-list",children:L.map(H=>r.jsxs("div",{className:"recent-patient-pill",onClick:()=>te(H),children:[r.jsxs("div",{className:"recent-name-container",children:[r.jsx("span",{className:"recent-name",children:H.name||"New Patient"}),r.jsxs("span",{className:"recent-token",children:["#",H.token]})]}),r.jsxs("div",{className:"recent-info",children:[H.age," yrs / ",H.gender]})]},H.id))}),r.jsx("div",{className:"newly-registered-label",children:"NEWLY REGISTERED"})]}),r.jsxs("div",{className:"example-cases-section",children:[r.jsxs("div",{className:"example-cases-header",children:[r.jsx("span",{className:"sparkles-icon",children:""}),r.jsx("h3",{children:"Try AI with Example Cases"})]}),r.jsx("div",{className:"example-cards-container",children:W.map((H,Q)=>r.jsxs("div",{className:"example-case-card",onClick:()=>n(H.text),children:[r.jsx("div",{className:"example-icon",children:H.icon}),r.jsxs("div",{className:"example-content",children:[r.jsx("div",{className:"example-title",children:H.title}),r.jsx("div",{className:"example-description",children:H.description})]})]},Q))})]})]}),r.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&!f&&r.jsx("ul",{className:"patient-search-results-list",children:t.map(H=>r.jsxs("li",{onClick:()=>te(H),className:"patient-search-result-item",children:[r.jsxs("div",{className:"patient-search-result-item-name-container",children:[r.jsxs("span",{className:"patient-search-result-item-token",children:["[#",H.token,"]"]}),r.jsx("span",{className:"patient-search-result-item-name",children:H.name})]}),r.jsxs("div",{className:"patient-search-result-item-details",children:[H.age?`${H.age} yrs`:"",H.age&&H.gender?" / ":"",H.gender||"N/A"]})]},H.id))}),e.length>=2&&!a&&t.length===0&&!l&&r.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),r.jsxs("div",{className:"chat-input-controls",children:[r.jsx("textarea",{ref:b,placeholder:"Search by Name/Phone/Token or Enter New Case: Name, Age, Sex, Complaint...",value:e,onChange:Y,onKeyDown:ie,className:"chat-input",autoFocus:!0,disabled:f,rows:1}),r.jsx("button",{onClick:e.trim()?()=>B(e):R,className:`chat-submit-button ${f||a?"opacity-50":""}`,disabled:f||a||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:f||a?r.jsx("div",{className:"spinner"}):e.trim()?r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:r.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:r.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),k&&r.jsx(Sw,{options:qB,children:r.jsx(GT,{onClose:()=>T(!1),patientData:I,tokenNumber:null,onAiSummaryChange:M})})]})},VB=({})=>{const e=kt(),[n]=w.useState("patientSearch"),[t]=w.useState(!1),[i,a]=w.useState(null),[o,l]=w.useState(null);return w.useEffect(()=>{if(o){const d=setTimeout(()=>l(null),5e3);return()=>clearTimeout(d)}},[o]),t?r.jsxs("div",{className:"loading-animation-container",children:[" ",r.jsx("div",{className:"breathing-ball"}),r.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):r.jsxs("div",{className:"admin-panel-container",children:[" ",o&&r.jsxs("div",{className:`alert-box ${o.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[r.jsx("div",{className:"alert-box-icon",children:o.type==="success"?r.jsx(fs,{size:18}):r.jsx(Ki,{size:18})}),r.jsx("div",{className:"alert-box-content",children:r.jsx("span",{children:o.message})}),r.jsx("button",{onClick:()=>l(null),className:"alert-box-close",children:r.jsx(ni,{size:16})})]}),i&&r.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",r.jsx("div",{className:"alert-box-icon",children:r.jsx(Ki,{size:18})}),r.jsx("div",{className:"alert-box-content",children:r.jsx("span",{className:"block sm:inline flex-1",children:i})}),r.jsx("button",{onClick:()=>a(null),className:"alert-box-close",children:r.jsx(ni,{size:16})})]}),r.jsxs("div",{className:"admin-nav-bar",children:[" ",r.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[r.jsx(nk,{})," "]}),r.jsxs("button",{onClick:()=>e("/dashboard/clinic-hub"),className:"admin-nav-button",children:[r.jsx(rk,{})," Clinic Hub"]}),r.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:"admin-nav-button",children:[r.jsx(ig,{})," Inventory Management"]}),r.jsxs("button",{onClick:()=>e("/dashboard/analysis"),className:"admin-nav-button",children:[r.jsx(K0,{})," Analysis Dashboard"]}),r.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),r.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[r.jsx(MI,{})," Patient Subscriptions"]}),r.jsx("button",{onClick:()=>e("/refill-reminders"),className:"admin-nav-button",children:"Refill Reminders"}),r.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[r.jsx(K0,{})," Lab Tests"]}),r.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-nav-button",children:[r.jsx(rg,{})," All Patients"]})]}),r.jsxs("div",{className:"space-y-6",children:[" ",n==="patientSearch"&&r.jsx("div",{className:"admin-content-section",children:r.jsx(jh,{})})]})]})},Vc=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},HB=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},gh=({title:e,icon:n,items:t,renderItemContent:i,isLoading:a,loadingText:o,noDataText:l})=>{const d=w.useMemo(()=>{const f={};t.forEach(p=>{if(isNaN(p.date.getTime())){f["Unknown Date"]||(f["Unknown Date"]=[]),f["Unknown Date"].push(p);return}const g=HB(p.originalDateString);f[g]||(f[g]=[]),f[g].push(p)});const u=Object.keys(f);return u.sort((p,g)=>{if(p==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const T=k.split(" ");if(T.length===3){const M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(T[1]);if(M!==-1)return new Date(parseInt(T[2]),M,parseInt(T[0]))}return new Date(k)},v=b(p),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(p)}),u.map(p=>({date:p,items:f[p]}))},[t]);return r.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded-md border border-gray-200",children:[r.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 border-b border-gray-300 pb-1 flex items-center",children:[" ",n&&r.jsx(n,{size:14,className:"mr-1.5 text-indigo-600"})," ",e]}),a&&r.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:o}),!a&&t.length===0&&r.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:l}),!a&&t.length>0&&r.jsxs("div",{className:"space-y-2",children:[" ",d.map(({date:f,items:u})=>r.jsxs("div",{className:"pl-0.5",children:[" ",r.jsxs("h5",{className:"text-[11px] font-medium text-indigo-700 mb-1 bg-indigo-50 px-1 py-0.5 rounded-sm inline-block",children:[" ",f]}),r.jsx("div",{className:"space-y-1 pl-1.5 border-l-2 border-indigo-200 ml-0.5",children:u.map((p,g)=>r.jsxs("div",{className:"text-xs py-0 flex items-start",children:[" ",r.jsx("div",{className:"flex-grow mr-1",children:i(p)})," "]},`${p.type}-${p.originalDateString}-${g}`))})]},f))]})]})},c0=()=>{var W,H;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,i]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[T,P]=w.useState(null),{patientId:M}=Qr(),I=kt(),U=w.useCallback(async Q=>{g(null),d(null),u(null),k(!0),P(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const J=await pe(`/api/patients/${Q}`);if(!J.ok)throw new Error(`Patient details fetch failed (${J.status})`);const fe=await J.json();d(fe);const A=await pe(`/api/queue/patient/${Q}/latest`);if(!A.ok&&A.status!==404)throw new Error(`Queue entry fetch failed (${A.status})`);if(A.ok){const oe=await A.json();u(oe)}await L(Q)}catch(J){console.error("Error fetching specific patient data:",J),g(J.message||"Failed to load patient data."),P(J.message||"Failed to load patient history.")}finally{k(!1)}},[]),L=w.useCallback(async Q=>{k(!0),P(null);try{const[J,fe,A,oe]=await Promise.all([pe(`/api/queue/patient/${Q}/complaints`),pe(`/api/lab/patient/${Q}`),pe(`/api/lab/orders/patient/${Q}?status=pending`),pe(`/api/pharmacy-orders/patient/${Q}`)]),ue=J.ok?await J.json():[],D=fe.ok?await fe.json():[],se=A.ok?await A.json():[],be=oe.ok?await oe.json():[];v({pastComplaints:ue||[],labReports:D||[],pendingLabOrders:se||[],pharmacyOrders:be||[]})}catch(J){console.error("Error fetching patient history:",J),P(J.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),F=w.useCallback(async()=>{i(!0),o(null);try{const Q=await pe("/api/queue/doctor");if(!Q.ok){const fe=await Q.text();throw new Error(`API Error (${Q.status}): ${fe||Q.statusText}`)}const J=await Q.json();if(J===null||typeof J!="object"||typeof J.waitingCount!="number")throw console.error("Invalid queue data format:",J),new Error("Invalid queue data format received");n({currentPatient:J.currentPatient||null,nextPatient:J.nextPatient||null,waitingCount:J.waitingCount})}catch(Q){console.error("Error fetching queue data:",Q),o(Q.message||"Failed to fetch queue data.")}finally{i(!1)}},[]);w.useEffect(()=>{let Q=null;return M?(U(M),n({currentPatient:null,nextPatient:null,waitingCount:0})):(F(),Q=setInterval(F,1e4),d(null),u(null)),()=>{Q&&clearInterval(Q)}},[M,U,F]),w.useEffect(()=>{var Q;!M&&((Q=e.currentPatient)!=null&&Q.patientId)?L(e.currentPatient.patientId):!M&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null))},[M,(W=e.currentPatient)==null?void 0:W.patientId,L]);const z=((H=e.currentPatient)==null?void 0:H.patientId)||(M?parseInt(M,10):null),$=w.useMemo(()=>{if(!z||!b.pastComplaints)return[];const Q=b.pastComplaints.map(J=>({date:new Date(J.createdAt),type:"Complaint",data:J,originalDateString:J.createdAt})).filter(J=>!isNaN(J.date.getTime()));return Q.sort((J,fe)=>fe.date.getTime()-J.date.getTime()),Q},[z,b.pastComplaints]),B=w.useMemo(()=>{if(!z)return[];const Q=[];return(b.pendingLabOrders??[]).forEach(J=>{const fe=new Date(J.createdAt);isNaN(fe.getTime())||Q.push({date:fe,type:"Lab Order (Pending)",data:J,originalDateString:J.createdAt})}),(b.labReports??[]).forEach(J=>{const fe=J.reportCreatedAt?new Date(J.reportCreatedAt):null;fe&&!isNaN(fe.getTime())&&Q.push({date:fe,type:"Lab Report",data:J,originalDateString:J.reportCreatedAt})}),Q.sort((J,fe)=>fe.date.getTime()-J.date.getTime()),Q},[z,b.pendingLabOrders,b.labReports]),R=w.useMemo(()=>{if(!z||!b.pharmacyOrders)return[];const Q=b.pharmacyOrders.map(J=>({date:new Date(J.date),type:"Pharmacy Order",data:J,originalDateString:J.date})).filter(J=>!isNaN(J.date.getTime()));return Q.sort((J,fe)=>fe.date.getTime()-J.date.getTime()),Q},[z,b.pharmacyOrders]),V=async()=>{i(!0),o(null);try{await pe("/api/queue/doctor/next",{method:"POST"}),await F()}catch(Q){console.error("Error calling next patient:",Q),o(Q.message||"Failed to call next patient.")}finally{i(!1)}},Y=async()=>{if(!(!e.currentPatient||M)){i(!0),o(null);try{await pe(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await F(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null)}catch(Q){console.error("Error completing consultation:",Q),o(Q.message||"Failed to complete consultation.")}finally{i(!1)}}},ie=Q=>{switch(Q){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return Q}};let te=null;return e.currentPatient&&(te=r.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-teal-500",children:[r.jsx("h2",{className:"text-xl text-teal-700 font-semibold mb-3",children:"NOW SEEING:"}),r.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[r.jsxs("div",{className:"flex-grow md:w-1/2",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{className:"flex-grow mr-4",children:[r.jsx("div",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-1",children:e.currentPatient.name}),r.jsxs("div",{className:"text-lg md:text-xl text-gray-600",children:[r.jsx("span",{className:"font-bold",children:e.currentPatient.age})," | ",r.jsx("span",{className:"font-bold",children:e.currentPatient.gender})]})]}),r.jsxs("div",{className:"text-right flex-shrink-0",children:[r.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-700 mb-1",children:e.currentPatient.token}),r.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:ie(e.currentPatient.status)})]})]}),r.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex justify-end space-x-3 border-t pt-4",children:[r.jsx("button",{onClick:()=>{var J;const Q=(J=e.currentPatient)==null?void 0:J._id;Q&&I(`/dashboard/edit-complaint/${Q}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Edit Complaint / AI"}),r.jsx("button",{onClick:Y,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success disabled:opacity-50 disabled:cursor-not-allowed",children:"Complete Consultation"})]})]})," ",r.jsxs("div",{className:"complaint-section md:w-1/2 mt-4 md:mt-0 border-t md:border-t-0 md:border-l md:pl-6 pt-4 md:pt-0",children:[r.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-2",children:"Context & History:"}),T&&r.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),r.jsxs("div",{className:"space-y-2 pr-2",children:[r.jsx(gh,{title:"Complaints History",icon:Xc,items:$,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:Q=>r.jsxs("span",{className:"block text-xs",children:[Q.data.complaint,r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(Q.originalDateString),")"]})]})}),r.jsx(gh,{title:"Lab History (Orders & Reports)",icon:Od,items:B,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:Q=>Q.type==="Lab Order (Pending)"?r.jsxs("span",{className:"flex items-start text-xs",children:[r.jsx(MS,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"}),r.jsxs("span",{className:"block",children:[r.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",Q.data.tests.map(J=>J.name).join(", ")," ",r.jsxs("span",{className:"text-gray-600",children:["(",Q.data.status,")"]}),r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(Q.originalDateString),")"]})]})]}):r.jsxs("span",{className:"flex items-start text-xs",children:[r.jsx(OS,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"}),r.jsxs("span",{className:"block",children:[r.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",Q.data.testName," - ",Q.data.reportFindings.substring(0,50),Q.data.reportFindings.length>50?"...":"",r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(Q.originalDateString),")"]})]})]})}),r.jsx(gh,{title:"Pharmacy Order History",icon:Ld,items:R,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:Q=>r.jsxs("span",{className:"block text-xs",children:[Q.data.medications.map(J=>`${J.name} (Qty: ${J.quantity})`).join(", ")," ",r.jsxs("span",{className:"text-gray-600",children:["(",Q.data.status,")"]}),r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(Q.originalDateString),")"]})]})}),$.length===0&&B.length===0&&R.length===0&&!S&&r.jsx("p",{className:"text-gray-500 italic text-xs mt-2 px-1",children:"No history found for this patient."})]})," "]})," "]})," "]})),r.jsx(r.Fragment,{children:r.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("button",{onClick:()=>I(-1),className:"back-button mr-4",children:r.jsx(nn,{size:24})}),r.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),M?r.jsxs(r.Fragment,{children:[p&&r.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:p}),l&&r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-purple-500",children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsx("h2",{className:"text-xl text-purple-700 font-semibold",children:"Patient Record:"}),r.jsx("button",{onClick:()=>I("/dashboard/doctor"),className:"text-sm text-blue-600 hover:underline",children:"Back to Queue"})]}),r.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-1 md:mb-2",children:l.name}),r.jsxs("div",{className:"text-lg md:text-xl text-gray-600 mb-3 md:mb-4",children:["Age: ",l.age??"N/A"," | ",l.gender??"N/A"]}),r.jsxs("div",{className:"mt-3 md:mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[r.jsx("label",{className:"font-medium block mb-1 text-sm text-gray-600",children:"Latest Queue Entry:"}),f?r.jsxs("div",{className:"space-y-2",children:[" ",r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("span",{className:"text-sm flex-1 break-words",children:[r.jsxs("span",{className:"font-medium text-gray-700",children:["(",f.age," / ",f.gender,")"]}),": ",f.complaint||r.jsx("span",{className:"text-gray-400 italic",children:"No complaint"}),r.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${f.status==="consulting"?"bg-teal-100 text-teal-800":f.status==="seen"?"bg-green-100 text-green-800":f.status==="waiting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:ie(f.status)})]}),f.status==="consulting"&&f._id&&r.jsx("button",{onClick:()=>I(`/dashboard/edit-complaint/${f._id}`),className:"ml-4 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded flex-shrink-0",children:"Edit"})]}),f.case_summary&&r.jsxs("p",{className:"text-xs text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[r.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",f.case_summary]})]}):r.jsx("p",{className:"text-gray-500 italic text-sm",children:"No queue entry found for this patient today."})]}),r.jsxs("div",{className:"mt-4 border-t pt-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Patient History:"}),T&&r.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),r.jsx(gh,{title:"Complaints History",icon:Xc,items:$,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:Q=>r.jsxs("span",{className:"block text-xs",children:[" ",Q.data.complaint,r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(Q.originalDateString),")"]})]})}),r.jsx(gh,{title:"Lab History (Orders & Reports)",icon:Od,items:B,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:Q=>Q.type==="Lab Order (Pending)"?r.jsxs("span",{className:"flex items-start text-xs",children:[" ",r.jsx(MS,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"})," ",r.jsxs("span",{className:"block",children:[r.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",Q.data.tests.map(J=>J.name).join(", ")," ",r.jsxs("span",{className:"text-gray-600",children:["(",Q.data.status,")"]}),r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(Q.originalDateString),")"]})]})]}):r.jsxs("span",{className:"flex items-start text-xs",children:[" ",r.jsx(OS,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"})," ",r.jsxs("span",{className:"block",children:[r.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",Q.data.testName," - ",Q.data.reportFindings.substring(0,50),Q.data.reportFindings.length>50?"...":"",r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(Q.originalDateString),")"]})]})]})}),r.jsx(gh,{title:"Pharmacy Order History",icon:Ld,items:R,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:Q=>r.jsxs("span",{className:"block text-xs",children:[" ",Q.data.medications.map(J=>`${J.name} (Qty: ${J.quantity})`).join(", ")," ",r.jsxs("span",{className:"text-gray-600",children:["(",Q.data.status,")"]}),r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(Q.originalDateString),")"]})]})}),$.length===0&&B.length===0&&R.length===0&&!S&&r.jsx("p",{className:"text-gray-500 italic text-sm mt-2",children:"No history found."})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[r.jsxs("button",{onClick:()=>I("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[r.jsx(lk,{size:18,className:"mr-2"})," Add Patient"]}),r.jsx("button",{onClick:()=>I("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&r.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&r.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),r.jsx("div",{className:"mb-6 md:mb-8",children:te||r.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),r.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[r.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?r.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[r.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:ie(e.nextPatient.status)})]}),r.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),r.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&r.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&r.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&r.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[r.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):r.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),r.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[r.jsx("button",{onClick:V,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),r.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:r.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},YT=()=>{const[e,n]=w.useState(""),[t,i]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=kt(),I=w.useCallback(bT.debounce(async R=>{if(R.trim().length<2){i([]),k(!1);return}k(!0),P(null);try{const V=new URLSearchParams({search:encodeURIComponent(R),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),Y=await pe(`/api/patients?${V.toString()}`);if(!Y.ok){const te=await Y.text();throw new Error(`API Error (${Y.status}): ${te||Y.statusText||"Failed to fetch patients"}`)}const ie=await Y.json();i(ie.patients)}catch(V){P(V instanceof Error?V.message:"An unknown error occurred while searching patients"),i([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),I(e)):(i([]),I.cancel()),()=>{I.cancel()}),[e,I]);const U=R=>{o(R),n(""),i([]),P(null),d(null),u(null),g(null),v(!1)},L=async()=>{if(!a){P("No patient selected.");return}P(null),k(!0);try{const R=await pe(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!R.ok){const Y=await R.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(Y.message||"Failed to admit patient")}const V=await R.json();alert(V.message||"Patient admitted successfully!"),V.bill&&V.bill.id?M(`/patient/${a.id}/admission-bill/${V.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),P("Admission successful, but couldn't navigate to billing."),o(V.patient))}catch(R){P(R instanceof Error?R.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){d(null),g(null);return}v(!0),u(null),d(null),g(null);try{const V=await pe(`/api/patients/${a.id}/active-bill?type=admission`);if(!V.ok)throw V.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const Y=await V.json(),ie=Y==null?void 0:Y.id;if(!ie)throw new Error("Active admission bill ID not found in response.");d(ie);const te=await pe(`/api/bills/${ie}`);if(!te.ok)throw new Error(`Failed to fetch bill details (ID: ${ie}). Status: ${te.status}`);const W=await te.json();if(W&&W.calculated)g(W.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",W),new Error("Fetched bill details are incomplete (missing calculated data).")}catch(V){u(V instanceof Error?V.message:"An unknown error occurred while fetching bill details."),d(null),g(null)}finally{v(!1)}})()},[a]);const F=async()=>{if(!a){P("No patient selected.");return}if(!a.admission_date||a.discharge_date){P("Patient is not currently admitted.");return}P(null),k(!0);try{const R=await pe(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!R.ok){const Y=await R.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(Y.message||"Failed to discharge patient")}const V=await R.json();alert(V.message||"Patient discharged successfully!"),V.patient?o(V.patient):(console.error("Discharge successful, but updated patient info missing in response."),o(null),P("Discharge successful, but couldn't update patient details locally."))}catch(R){P(R instanceof Error?R.message:"Failed to discharge patient")}finally{k(!1)}},z=()=>{if(!a||!l){P("Cannot navigate to billing: Patient or Bill ID missing.");return}M(`/patient/${a.id}/admission-bill/${l}`)};let $="",B=null;if(a){const R=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,V=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?($=`Patient admitted on: ${R}`,B=r.jsxs("div",{className:"space-y-4",children:[" ",b&&r.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",f&&r.jsx("p",{className:"text-sm text-red-500 text-center",children:f})," ",!b&&p&&r.jsxs("div",{className:"admission-card",children:[r.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),r.jsxs("div",{className:"admission-card-content",children:[r.jsxs("p",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Total Due:"}),r.jsxs("span",{children:["",(Number(p.totalDue)||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",r.jsx("span",{children:"Total Paid:"}),r.jsxs("span",{children:["",(Number(p.totalPaid)||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",r.jsx("span",{children:"Balance Due:"}),r.jsxs("span",{children:["",(Number(p.balance)||0).toFixed(2)]})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("button",{onClick:z,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!f?"Finding Bill...":"Pay Bill / View Details"}),r.jsx("button",{onClick:F,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):($=`Patient admitted on ${R} and discharged on ${V}.`,B=r.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):($="Patient is not admitted.",B=r.jsx("button",{onClick:L,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return r.jsxs("div",{className:"admission-page-container",children:[r.jsxs("div",{className:"admission-header-container",children:[r.jsxs("button",{onClick:()=>M(-1),className:"back-button",children:[r.jsx(nn,{size:16}),"Back"]}),r.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),r.jsxs("div",{className:"admission-section mb-6 relative",children:[r.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),r.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:R=>n(R.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&r.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&r.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(R=>r.jsxs("li",{onClick:()=>U(R),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",R.name," (Token: ",R.token,")",r.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[R.admission_date?`Admitted: ${new Date(R.admission_date).toLocaleDateString()}`:"Not Admitted",R.discharge_date?`, Discharged: ${new Date(R.discharge_date).toLocaleDateString()}`:""]})]},R.id))]}),t.length===0&&e&&!S&&!a&&r.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&r.jsxs("div",{className:"admission-section",children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),r.jsx("button",{onClick:()=>o(null),className:"admission-link",children:"Clear Selection"})]}),r.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Name:"})," ",a.name]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Token:"})," ",a.token]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),r.jsxs("p",{className:"col-span-2",children:[r.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),r.jsx("hr",{className:"my-4"}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:$})," ",T&&r.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",B]})]})},u0=15,S1=()=>{const e=kt(),[n,t]=w.useState([]),[i,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(""),[u,p]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,T]=w.useState("created_at"),[P,M]=w.useState("desc"),[I,U]=w.useState(""),[L,F]=w.useState(!1),[z,$]=w.useState(null),[B,R]=w.useState([]),[V,Y]=w.useState(""),[ie,te]=w.useState(!1),[W,H]=w.useState(null),[Q,J]=w.useState(!0),[fe,A]=w.useState(null),[oe,ue]=w.useState(d);w.useEffect(()=>{const Se=setTimeout(()=>{ue(d),p(1)},500);return()=>{clearTimeout(Se)}},[d]);const D=w.useCallback(async()=>{J(!0),A(null);try{const Se=await pe("/api/subscriptions");if(!Se.ok){let De=`Failed to fetch subscription plans (${Se.status})`;try{De=(await Se.json()).message||De}catch{}throw new Error(De)}const Ne=await Se.json();R(Ne)}catch(Se){console.error("Error fetching subscription plans:",Se),A(Se.message||"An unknown error occurred while fetching plans."),R([])}finally{J(!1)}},[]),se=w.useCallback(async(Se,Ne,De,Me,nt)=>{a(!0),l(null);try{const ft=new URLSearchParams({page:Se.toString(),limit:u0.toString(),sortBy:De,sortOrder:Me});Ne&&ft.append("search",Ne),nt&&ft.append("gender",nt);const ut=await pe(`/api/patients?${ft.toString()}`);if(!ut.ok){const Nt=await ut.json();throw new Error(Nt.message||"Failed to fetch patients")}const rt=await ut.json();t(rt.patients),S(rt.totalCount),p(rt.currentPage),b(rt.totalPages)}catch(ft){console.error("Error fetching patients:",ft),l(`Failed to load patients: ${ft.message}`),t([]),S(0),p(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{se(u,oe,k,P,I),D()},[u,oe,k,P,I,se,D]);const be=Se=>{const Ne=k===Se&&P==="asc"?"desc":"asc";T(Se),M(Ne),p(1)},ee=Se=>{try{return new Date(Se).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},ce=()=>{F(!1),$(null),Y(""),H(null),te(!1)},re=async(Se,Ne)=>{t(De=>De.map(Me=>Me.id===Se?{...Me,insurance_type:Ne}:Me));try{const De=await pe(`/api/patients/${Se}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Ne})});if(!De.ok){const Me=await De.json();throw new Error(Me.message||"Failed to update insurance type")}}catch(De){console.error("Error updating insurance type:",De),se(u,oe,k,P,I)}},Pe=(Se,Ne)=>{const De=new Date(Se),Me=Ne.interval||1;switch(Ne.period){case"daily":De.setDate(Se.getDate()+Me);break;case"weekly":De.setDate(Se.getDate()+Me*7);break;case"monthly":De.setMonth(Se.getMonth()+Me);break;case"yearly":De.setFullYear(Se.getFullYear()+Me);break;default:console.warn(`Unknown subscription period: ${Ne.period}. Defaulting to 1 month.`),De.setMonth(Se.getMonth()+1)}return De},Qe=async()=>{if(!z||!V){H("Please select a subscription plan.");return}const Se=B.find(Ne=>Ne.id===V);if(!Se){H("Selected plan details not found.");return}te(!0),H(null);try{const Ne=new Date,De=Pe(Ne,Se),Me={subscription_plan_id:V,subscription_status:"active",subscription_start_date:Ne.toISOString(),subscription_end_date:De.toISOString(),subscription_payment_method:"manual"},nt=await pe(`/api/patients/${z.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Me)});if(!nt.ok){const ft=await nt.json();throw new Error(ft.message||"Failed to update patient subscription")}ce(),se(u,oe,k,P,I)}catch(Ne){console.error("Error starting subscription:",Ne),H(`Failed to start subscription: ${Ne.message}`)}finally{te(!1)}};return r.jsxs("div",{className:"all-patients-container",children:[r.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[r.jsx(nn,{size:16}),"Back"]}),r.jsxs("h1",{className:"all-patients-title",children:[r.jsx(tu,{size:28}),"All Registered Patients"]}),o&&r.jsxs("div",{className:"error-alert",role:"alert",children:[r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:o})]}),r.jsxs("div",{className:"subscription-plans-card",children:[r.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),r.jsx("div",{children:Q?r.jsx("p",{className:"loading-state",children:"Loading plans..."}):fe?r.jsxs("p",{className:"error-message",children:["Error loading plans: ",fe]}):B.length===0?r.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):r.jsx("ul",{className:"subscription-plans-list",children:B.map(Se=>r.jsxs("li",{children:[r.jsx("strong",{children:Se.name}),": ",Se.price," / ",Se.interval," ",Se.period,Se.interval>1?"s":"",Se.description&&r.jsx("span",{className:"plan-description",children:Se.description})]},Se.id))})})]}),r.jsxs("div",{className:"controls-container",children:[r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:d,onChange:Se=>f(Se.target.value)}),r.jsx(us,{className:"search-input-icon",size:20})]}),r.jsxs("div",{className:"filter-dropdown-wrapper",children:[r.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),r.jsxs("div",{className:"filter-select-container",children:[r.jsx(qI,{size:16,className:"filter-select-icon"}),r.jsxs("select",{id:"genderFilter",value:I,onChange:Se=>U(Se.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"All Genders"}),r.jsx("option",{value:"M",children:"Male"}),r.jsx("option",{value:"F",children:"Female"}),r.jsx("option",{value:"O",children:"Other"})]})]})]})]}),i?r.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?r.jsx("div",{className:"empty-state",children:oe?"No patients found matching your search.":"No patients registered yet."}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"patients-table-wrapper",children:r.jsxs("table",{className:"patients-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Token"}),r.jsxs("th",{className:"sortable-header",onClick:()=>be("name"),children:["Name",k==="name"&&(P==="asc"?r.jsx(J0,{size:14,className:"sort-icon"}):r.jsx(AS,{size:14,className:"sort-icon"}))]}),r.jsx("th",{children:"Age"}),r.jsx("th",{children:"Gender"}),r.jsx("th",{children:"Phone"}),r.jsx("th",{children:"Address"}),r.jsxs("th",{className:"sortable-header",onClick:()=>be("created_at"),children:["Registered On",k==="created_at"&&(P==="asc"?r.jsx(J0,{size:14,className:"sort-icon"}):r.jsx(AS,{size:14,className:"sort-icon"}))]}),r.jsx("th",{children:"Subscription Status"}),r.jsx("th",{children:"Insurance Type"})," ",r.jsx("th",{children:"Action"})," "]})}),r.jsx("tbody",{children:n.map(Se=>r.jsxs("tr",{children:[r.jsx("td",{children:Se.token??"-"}),r.jsx("td",{className:"patient-name",children:Se.name}),r.jsx("td",{children:Se.age??"-"}),r.jsx("td",{children:Se.gender??"-"}),r.jsx("td",{children:Se.phone??"-"}),r.jsx("td",{children:Se.address??"-"}),r.jsx("td",{children:ee(Se.created_at)}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${Se.subscription_status==="active"?"active":Se.subscription_status==="cancelled"||Se.subscription_status==="expired"?"inactive":"none"}`,children:Se.subscription_status??"None"})}),r.jsx("td",{children:r.jsxs("select",{value:Se.insurance_type,onChange:Ne=>re(Se.id,Ne.target.value),className:"form-select insurance-select",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"insurance",children:"Insurance"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),r.jsx("td",{children:r.jsx("button",{onClick:()=>e(`/start-subscription/${Se.id}`),className:"action-button",children:"Start Sub"})})]},Se.id))})]})}),g>1&&r.jsxs("div",{className:"pagination-controls",children:[r.jsxs("div",{className:"pagination-info",children:["Showing"," ",r.jsx("span",{className:"font-medium",children:(u-1)*u0+1})," ","to"," ",r.jsx("span",{className:"font-medium",children:Math.min(u*u0,v)})," ","of"," ",r.jsx("span",{className:"font-medium",children:v})," results"]}),r.jsxs("div",{className:"pagination-buttons",children:[r.jsxs("button",{onClick:()=>p(Se=>Math.max(Se-1,1)),disabled:u===1||i,className:"pagination-button",children:[r.jsx(rw,{size:16,className:"prev-icon"}),"Previous"]}),r.jsxs("span",{className:"pagination-current-page",children:["Page ",r.jsx("span",{className:"font-medium",children:u})," of ",r.jsx("span",{className:"font-medium",children:g})]}),r.jsxs("button",{onClick:()=>p(Se=>Math.min(Se+1,g)),disabled:u===g||i,className:"pagination-button",children:["Next",r.jsx(wb,{size:16,className:"next-icon"})]})]})]})]}),L&&z&&r.jsx("div",{className:"subscription-modal-overlay",children:r.jsxs("div",{className:"subscription-modal-content",children:[r.jsxs("div",{className:"subscription-modal-header",children:[r.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",z.name]}),r.jsx("button",{onClick:ce,className:"subscription-modal-close-button",children:r.jsx(ni,{size:24})})]}),W&&r.jsx("div",{className:"error-alert",role:"alert",children:r.jsx("span",{children:W})}),r.jsxs("div",{className:"subscription-modal-body",children:[r.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),r.jsxs("select",{id:"subscriptionPlan",value:V,onChange:Se=>Y(Se.target.value),className:"form-select",disabled:ie||Q||fe!==null||B.length===0,children:[r.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),Q?r.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):fe?r.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):B.length>0?B.map(Se=>r.jsxs("option",{value:Se.id,children:[Se.name," - ",Se.price," (",Se.interval," ",Se.period,Se.interval>1?"s":"",")"]},Se.id)):r.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),fe&&r.jsx("p",{className:"error-message",children:fe}),B.length===0&&!Q&&!fe&&r.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),r.jsxs("div",{className:"subscription-modal-footer",children:[r.jsx("button",{onClick:ce,disabled:ie,className:"subscription-modal-button cancel",children:"Cancel"}),r.jsx("button",{onClick:Qe,disabled:!V||ie,className:"subscription-modal-button submit",children:ie?"Starting...":"Start Subscription"})]})]})})]})},WT=()=>{const e=kt(),[n]=w.useState(!0),[t,i]=w.useState(""),[a,o]=w.useState([]),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>vb(async P=>{if(P.trim().length<2){o([]),d(!1),u(null);return}d(!0),u(null);try{const M=new URLSearchParams({search:encodeURIComponent(P),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),I=await pe(`/api/patients?${M.toString()}`);if(!I.ok){const L=await I.text();throw new Error(`API Error (${I.status}): ${L||I.statusText}`)}const U=await I.json();o(U.patients)}catch(M){console.error("Error searching patients:",M),u(M.message||"Failed to search patients."),o([])}finally{d(!1)}},300),[]),S=P=>{const M=P.target.value;i(M),g(b.test(M)),d(!0),v(M)},k=w.useCallback(P=>{e("/billing",{state:{patientId:P.id,patientName:P.name}})},[e]),T=w.useCallback(async()=>{if(!t||!p){u("Invalid phone number to create a new patient.");return}d(!0),u(null);try{const M=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!M.ok){const U=await M.json();throw new Error(U.message||`Failed to create patient: ${M.statusText}`)}const I=await M.json();alert(`New patient "direct pharmacy" created with phone ${I.phone}.`),k(I)}catch(P){console.error("Error creating new patient:",P),u(P.message||"Failed to create new patient.")}finally{d(!1)}},[t,p,k]);return r.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[r.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:r.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[r.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:r.jsx(nn,{size:20})}),r.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&r.jsxs("div",{className:"content-section",children:[r.jsx("h3",{className:"section-title",children:"Select Patient"}),r.jsxs("div",{className:"mb-3 relative",children:[r.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),r.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&r.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),f&&r.jsx("div",{className:"ai-function-status error mb-3 p-3",children:f}),a.length>0&&r.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:r.jsx("ul",{children:a.map(P=>r.jsxs("li",{onClick:()=>k({id:P.id,name:P.name,token:P.token,age:P.age,gender:P.gender,phone:P.phone}),children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[r.jsxs("div",{className:"font-medium",children:[r.jsxs("span",{className:"patient-token mr-2",children:["#",P.token]}),P.name]}),r.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[P.age?`${P.age} yrs`:"Age N/A",P.gender?` / ${P.gender}`:" / Gender N/A",P.phone&&r.jsxs("span",{className:"hidden sm:inline",children:[" / ",P.phone]})]})]}),P.phone&&r.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",P.phone]})]},P.id))})}),t.length>=2&&!l&&a.length===0&&!f&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),p&&r.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&r.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},QT=({currentUser:e})=>{const n=kt(),[t,i]=w.useState("select_patient"),[a,o]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,d]=w.useState(null),[f,u]=w.useState([]),[p,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[T,P]=w.useState(""),[M,I]=w.useState([]),[U,L]=w.useState(!1),[F,z]=w.useState(null),[$,B]=w.useState(null),[R,V]=w.useState(null),[Y,ie]=w.useState(!1),[te,W]=w.useState(!1),[H,Q]=w.useState(!1),J=/^\+?[0-9\s\-().]{7,20}$/,fe=/^[a-zA-Z\s'-]{2,}$/,A=w.useCallback(async()=>{if(!(f.length>0)){ie(!0),V(null);try{const Ne=await pe("/api/lab-tests");if(!Ne.ok)throw new Error("Failed to fetch lab tests");const De=await Ne.json();u(De)}catch(Ne){console.error("Failed to fetch available lab tests:",Ne),V("Could not load lab test list: "+Ne.message),u([])}finally{ie(!1)}}},[f.length]);w.useEffect(()=>{if(!b){k([]);return}const Ne=b.toLowerCase();k(f.filter(De=>De.name.toLowerCase().includes(Ne)||De.description&&De.description.toLowerCase().includes(Ne)).slice(0,10))},[b,f]);const oe=w.useCallback(Ne=>{const De={id:Ne.id,name:Ne.name,token:Ne.token,age:Ne.age,gender:Ne.gender,phone:Ne.phone};d(De),i("create_order"),g([]),v(""),k([]),V(null),A()},[A]),ue=w.useMemo(()=>vb(async Ne=>{if(Ne.trim().length<2){I([]),L(!1),z(null);return}L(!0),z(null);try{const De=new URLSearchParams({search:encodeURIComponent(Ne),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Me=await pe(`/api/patients?${De.toString()}`);if(!Me.ok){const ft=await Me.text();throw new Error(`API Error (${Me.status}): ${ft||Me.statusText}`)}const nt=await Me.json();I(nt.patients)}catch(De){console.error("Error searching lab patients:",De),z(De.message||"Failed to search lab patients."),I([])}finally{L(!1)}},300),[J,fe]),D=Ne=>{const De=Ne.target.value;P(De),W(J.test(De)),Q(fe.test(De)&&!J.test(De)),L(!0),ue(De)},se=w.useCallback(async Ne=>{if(!T||Ne==="phone"&&!te||Ne==="name"&&!H){z(`Invalid ${Ne} to create a new patient.`);return}L(!0),z(null);try{const Me=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Ne==="name"?T:"direct lab",phone:Ne==="phone"?T:null,age:null,gender:null,token:null})});if(!Me.ok){const ft=await Me.json();throw new Error(ft.message||`Failed to create patient: ${Me.statusText}`)}const nt=await Me.json();alert(`New patient "${nt.name}" created with ${Ne==="phone"?`phone ${nt.phone}`:`name ${nt.name}`}.`),oe({id:nt.id,name:nt.name,token:nt.token??null,age:nt.age??null,gender:nt.gender??null,phone:nt.phone})}catch(De){console.error("Error creating new patient:",De),z(De.message||"Failed to create new patient.")}finally{L(!1)}},[T,te,H,oe]),be=()=>{o({name:"",age:void 0,gender:null,phone:"",address:""}),B(null),i("create_patient"),d(null)},ee=()=>{i("select_patient"),d(null),P(""),I([]),z(null)},ce=Ne=>{const{name:De,value:Me}=Ne.target;o(nt=>({...nt,[De]:De==="age"?Me?parseInt(Me,10):void 0:Me}))},re=async Ne=>{if(Ne.preventDefault(),B(null),!a.name){B("Patient Name is required.");return}const De={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const Me=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(De)});if(!Me.ok){const ft=await Me.json();throw new Error(ft.message||`Failed to create patient: ${Me.statusText}`)}const nt=await Me.json();alert(`Patient "${nt.name}" created successfully!`),oe({id:nt.id,name:nt.name,token:nt.token??null,age:nt.age??null,gender:nt.gender??null,phone:nt.phone})}catch(Me){console.error("Failed to create patient:",Me),B(Me.message||"Failed to create patient. Please try again.")}},Pe=Ne=>{if(p.some(De=>De.id===Ne.id)){V(`${Ne.name} is already in the order.`),setTimeout(()=>V(null),3e3),v(""),k([]);return}g(De=>[...De,{...Ne}]),v(""),k([])},Qe=Ne=>{g(De=>De.filter(Me=>Me.id!==Ne))},Se=async Ne=>{if(Ne.preventDefault(),V(null),!l){V("No patient selected.");return}if(p.length===0){V("No lab tests selected.");return}const De={patient_id:l.id,tests:p.map(Me=>({id:Me.id,name:Me.name,price:Me.price}))};console.log("Submitting Lab Order:",De);try{const Me=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(De)});if(!Me.ok){const ut=await Me.json();throw console.error("API Error Data:",ut),new Error(ut.message||`Failed to create lab order: ${Me.statusText}`)}const nt=await Me.json();console.log("Lab Order Creation Result:",nt);let ft=l.queueId;if(!ft){const ut=await pe(`/api/queue/patient/${l.id}/latest`);if(ut.ok){const rt=await ut.json();rt!=null&&rt._id&&(ft=rt._id)}}if(!ft){const ut=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!ut.ok){const Nt=await ut.text();throw new Error(`Failed to create queue entry for redirection: ${Nt||ut.statusText}`)}const rt=await ut.json();if(rt!=null&&rt.id)ft=rt.id;else throw new Error("Failed to get ID from new queue entry for redirection.")}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${ft}`)}catch(Me){console.error("Failed to create lab order:",Me),V(Me.message||"Failed to create lab order.")}};return w.useEffect(()=>{A()},[A]),r.jsxs("div",{className:"lab-inventory-container",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[r.jsx(nn,{size:18,className:"mr-2"}),"Back"]}),r.jsx("h1",{className:"lab-inventory-header",children:"Create New Lab Order"}),r.jsx("div",{className:"w-16"})," "]}),(t==="select_patient"||t==="create_patient")&&r.jsxs("div",{className:"lab-inventory-card",children:[t==="select_patient"&&r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Select Existing Patient"}),r.jsxs("div",{className:"lab-inventory-form-group",style:{position:"relative"},children:[r.jsx("label",{htmlFor:"lab-patient-search",children:"Search Patient (Name, Token, or Phone)"}),r.jsx("input",{type:"text",id:"lab-patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:T,onChange:D,className:"lab-inventory-input",autoFocus:!0}),U&&r.jsx("span",{className:"loading-text",style:{position:"absolute",right:"10px",top:"35px",fontSize:"0.8em"},children:"Searching..."})]}),F&&r.jsx("div",{className:"error-text",children:F}),M.length>0&&r.jsx("div",{className:"lab-inventory-card",style:{maxHeight:"300px",overflowY:"auto",padding:"0",marginTop:"10px"},children:r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:M.map(Ne=>r.jsxs("li",{onClick:()=>oe(Ne),className:"lab-inventory-link",style:{padding:"10px 15px",borderBottom:"1px solid #eee",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsxs("span",{style:{color:"#007bff",marginRight:"10px"},children:["[#",Ne.token,"]"]}),Ne.name]}),r.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[Ne.age?`${Ne.age} yrs`:"",Ne.age&&Ne.gender?" / ":"",Ne.gender||"N/A"]})]},Ne.id))})}),T.length>=2&&!U&&M.length===0&&!F&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"no-data-message",children:['No patients found matching "',T,'".']}),te&&r.jsx("button",{type:"button",onClick:()=>se("phone"),className:"lab-inventory-button",style:{marginTop:"15px",marginRight:"10px"},disabled:U,children:'Create "direct lab" Patient with this Phone'}),H&&r.jsx("button",{type:"button",onClick:()=>se("name"),className:"lab-inventory-button",style:{marginTop:"15px"},disabled:U,children:"Create Patient with this Name"})]}),T.length<2&&!U&&r.jsx("p",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter at least 2 characters to search."}),r.jsx("button",{onClick:be,className:"lab-inventory-link",style:{marginTop:"15px",background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Or, Register New Patient"})]}),t==="create_patient"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[r.jsx("h2",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"none",margin:"0"},children:"Register New Patient"}),r.jsx("button",{onClick:ee,className:"lab-inventory-link",style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:" Back to Search "})]}),$&&r.jsx("div",{className:"error-text",children:$}),r.jsxs("form",{onSubmit:re,children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"15px"},children:[r.jsxs("div",{className:"lab-inventory-form-group",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{htmlFor:"lab-patient-name",children:"Name *"}),r.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:ce,className:"lab-inventory-input"})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:"lab-patient-age",children:"Age"}),r.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:ce,className:"lab-inventory-input"})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:"lab-patient-gender",children:"Gender"}),r.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:ce,className:"lab-inventory-select",children:[r.jsx("option",{value:"",children:"Select..."})," ",r.jsx("option",{value:"M",children:"Male"})," ",r.jsx("option",{value:"F",children:"Female"})," ",r.jsx("option",{value:"O",children:"Other"})]})]}),r.jsxs("div",{className:"lab-inventory-form-group",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{htmlFor:"lab-patient-phone",children:"Phone"}),r.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:ce,className:"lab-inventory-input"})]}),r.jsxs("div",{className:"lab-inventory-form-group",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{htmlFor:"lab-patient-address",children:"Address"}),r.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:ce,className:"lab-inventory-input"})]})]}),r.jsxs("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{type:"button",onClick:ee,className:"lab-inventory-button lab-inventory-button-secondary",children:" Cancel "}),r.jsx("button",{type:"submit",className:"lab-inventory-button",children:" Create Patient & Proceed "})]})]})]})]}),t==="create_order"&&l&&r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[r.jsxs("h2",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"none",margin:"0"},children:["Create Order for: ",l.name]}),r.jsx("button",{onClick:ee,className:"lab-inventory-link",style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:" Change Patient "})]}),r.jsxs("p",{style:{fontSize:"0.9em",color:"#555",marginBottom:"20px"},children:["ID: ",l.id.substring(0,8),"... ",l.age&&`| Age: ${l.age}`," ",l.gender&&`| Gender: ${l.gender}`]}),R&&r.jsx("div",{className:"error-text",children:R}),r.jsxs("form",{onSubmit:Se,children:[r.jsxs("div",{className:"lab-inventory-form-group",style:{position:"relative"},children:[r.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),r.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:b,onChange:Ne=>v(Ne.target.value),className:"lab-inventory-input",disabled:Y}),Y&&r.jsx("span",{className:"loading-text",style:{position:"absolute",right:"10px",top:"35px",fontSize:"0.8em"},children:"Loading tests..."}),b&&S.length>0&&r.jsx("div",{className:"lab-inventory-card",style:{maxHeight:"200px",overflowY:"auto",padding:"0",marginTop:"5px",position:"absolute",width:"100%",zIndex:10},children:r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:S.map(Ne=>r.jsxs("li",{onClick:()=>Pe(Ne),className:"lab-inventory-link",style:{padding:"10px 15px",borderBottom:"1px solid #eee",cursor:"pointer",display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{children:Ne.name}),r.jsxs("span",{style:{color:"#555",fontSize:"0.9em"},children:["(",parseFloat(Ne.price).toFixed(2),")"]})]},Ne.id))})}),b&&S.length===0&&!Y&&r.jsxs("div",{className:"no-data-message",style:{marginTop:"5px"},children:['No tests found matching "',b,'".']})]}),r.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",maxHeight:"300px",overflowY:"auto"},children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",borderBottom:"1px solid #eee",marginBottom:"10px"},children:"Selected Tests"}),p.length===0?r.jsx("p",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"0"},children:"No tests added yet."}):r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:p.map(Ne=>r.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #f0f0f0"},children:[r.jsx("span",{style:{flex:1,marginRight:"10px"},children:Ne.name}),r.jsxs("span",{style:{fontWeight:"500",marginRight:"15px"},children:["",parseFloat(Ne.price).toFixed(2)]}),r.jsx("button",{type:"button",onClick:()=>Qe(Ne.id),className:"lab-inventory-link",title:"Remove Test",style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:r.jsx(lr,{size:16})})]},Ne.id))})]}),p.length>0&&r.jsxs("div",{style:{textAlign:"right",fontWeight:"bold",fontSize:"1.2em",marginTop:"20px",marginBottom:"20px"},children:["Total: ",p.reduce((Ne,De)=>Ne+parseFloat(De.price),0).toFixed(2)]}),r.jsxs("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{type:"button",onClick:ee,className:"lab-inventory-button lab-inventory-button-secondary",children:" Cancel Order "}),r.jsx("button",{type:"submit",disabled:p.length===0,className:`lab-inventory-button ${p.length===0?"opacity-50 cursor-not-allowed":""}`,children:" Create Lab Order "})]})]})]})]})},GB=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[i,a]=w.useState(""),[o,l]=w.useState([]),[d,f]=w.useState(!0),[u,p]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(null),P=kt(),M=async()=>{f(!0),T(null);let B=[];try{const R=await pe("/api/queue");if(!R.ok){const ie=await R.json();throw new Error(ie.message||"Failed to fetch queue")}B=await R.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(B,null,2));const V=B.map(async ie=>{if(!ie.patient_id)return console.warn(`Queue entry ${ie.id} has no patient_id.`),ie;try{const te=await pe(`/api/patients/${ie.patient_id}`);if(!te.ok)return console.error(`Failed to fetch patient details for ${ie.patient_id}: ${te.status}`),ie;const W=await te.json();return{...ie,Patient:{...ie.Patient??{},...W}}}catch(te){return console.error(`Error fetching patient details for ${ie.patient_id}:`,te),ie}}),Y=await Promise.all(V);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(Y,null,2)),Y.sort((ie,te)=>{var fe,A;const W=((fe=ie.Patient)==null?void 0:fe.subscription_status)==="active",H=((A=te.Patient)==null?void 0:A.subscription_status)==="active";if(W&&!H)return-1;if(!W&&H)return 1;const Q=ie.created_at?new Date(ie.created_at).getTime():0,J=te.created_at?new Date(te.created_at).getTime():0;return Q-J}),console.log("Sorted Queue Data:",JSON.stringify(Y,null,2)),l(Y)}catch(R){console.error("Error in fetchQueue process:",R),T(`Failed to load queue: ${R.message}`),l(B)}finally{f(!1)}},I=async()=>{b(!0),T(null);try{const B=await pe("/api/staff?role=doctor");if(!B.ok){const V=await B.json();throw new Error(V.message||"Failed to fetch doctors")}const R=await B.json();p(R.filter(V=>V.active))}catch(B){console.error("Error fetching doctors:",B),T(`Failed to fetch doctors: ${B.message}`)}finally{b(!1)}};w.useEffect(()=>{n==="queue"&&(M(),I()),S(null)},[n]);const U=w.useCallback(async(B,R)=>{if(console.log(`Attempting to assign doctor ${R} to queue ${B}`),T(null),S(null),!R){console.log("No doctor ID provided, skipping assignment.");return}const V=o.find(te=>te.id===B);if(!V){console.error(`Queue entry ${B} not found in local state.`),T("Queue entry not found.");return}if(V.doctor_id===R){console.log(`Queue ${B} already assigned to doctor ${R}. Skipping.`);return}const Y=async te=>{if(!te||!te.id||!te.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",te);return}const W=async()=>{try{const H={status:"waiting",doctorId:R},Q=await pe(`/api/queue/${B}/status`,{method:"PATCH",body:JSON.stringify(H)}),J=await Q.json();if(!Q.ok)throw new Error(J.message||`HTTP error! status: ${Q.status}`);const fe=u.find(A=>A.id===R);return console.log(`Successfully assigned doctor ${fe==null?void 0:fe.name} to queue ${B}.`),l(A=>A.map(oe=>oe.id===B?{...oe,doctor_id:R,status:J.status||oe.status,User:fe?{name:fe.name}:null,Patient:te}:oe)),!0}catch(H){return console.error(`Error assigning doctor for queue ${B}:`,H),T(`Failed to assign doctor: ${H.message}`),!1}};te.subscription_status==="active"?(console.log(`Patient ${te.name} (ID: ${te.id}) has active subscription. Assigning doctor directly.`),await W()):(console.log(`Patient ${te.name} (ID: ${te.id}) does not have active subscription (Status: ${te.subscription_status}). Assigning doctor and proceeding to billing.`),await W()?(console.log(`Navigating to billing for patient ${te.name} (ID: ${te.id}), queue ID: ${B}, doctor ID: ${R}`),P("/billing",{state:{patientId:te.id,queueId:B,patientName:te.name,doctorId:R,billType:"consultation"}})):console.log(`Assignment failed for patient ${te.name}, skipping navigation.`))},ie=V.Patient;if(ie&&ie.id&&ie.name)console.log("Patient details found in state. Proceeding with assignment."),await Y(ie);else{console.warn(`Patient details missing for queue entry ${B}. Fetching patient ${V.patient_id}...`);try{const te=await pe(`/api/patients/${V.patient_id}`);if(!te.ok){const H=await te.json().catch(()=>({}));throw new Error(H.message||`Failed to fetch patient details (status ${te.status})`)}const W=await te.json();console.log("Successfully fetched patient details:",W),await Y(W)}catch(te){console.error(`Failed to fetch patient details for patient ID ${V.patient_id}:`,te),T(`Failed to fetch required patient details: ${te.message}`)}}},[u,o,P]),L=async(B,R)=>{T(null);const V=R==="consulting"?"start consultation":"complete visit";try{const Y=o.find(H=>H.id===B);if(!Y&&R==="consulting")throw new Error("Queue entry not found to start consultation.");let ie={status:R};if(R==="consulting"){if(!(Y!=null&&Y.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");ie.doctorId=Y.doctor_id}const te=await pe(`/api/queue/${B}/status`,{method:"PATCH",body:JSON.stringify(ie)}),W=await te.json();if(!te.ok)throw new Error(W.message||`HTTP error! status: ${te.status}`);l(H=>H.map(Q=>Q.id===B?{...Q,status:R}:Q))}catch(Y){console.error(`Error trying to ${V}:`,Y),T(`Failed to ${V}: ${Y.message}`)}},F=[{id:"queue",label:"Queue",icon:r.jsx(rg,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:r.jsx(us,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:r.jsx(uI,{size:20})},{id:"all-patients",label:"All Patients",icon:r.jsx(XI,{size:20})},{id:"lab",label:"Lab Tests",icon:r.jsx(K0,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:r.jsx(cs,{size:20})}],z=B=>{try{return new Date(B).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},$=o.filter(B=>{var R,V;return(V=(R=B.Patient)==null?void 0:R.name)==null?void 0:V.toLowerCase().includes(i.toLowerCase())});return r.jsx("div",{className:"reception-dashboard-container",children:r.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&r.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:k})]}),r.jsxs("div",{className:"reception-tab-nav",children:[" ",F.map(B=>r.jsxs("button",{className:`reception-tab-button ${n===B.id?"active":""}`,onClick:()=>t(B.id),children:[r.jsx("span",{children:B.icon}),B.label]},B.id))]}),n==="queue"&&r.jsxs("div",{className:"space-y-6",children:[" ",r.jsxs("div",{className:"queue-header",children:[" ",r.jsxs("div",{className:"queue-actions",children:[" ",r.jsxs("div",{className:"search-bar-container",children:[" ",r.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:i,onChange:B=>a(B.target.value)}),r.jsx(us,{className:"search-icon",size:18})]})]}),r.jsxs("div",{className:"summary-cards-grid",children:[" ",r.jsxs("div",{className:"summary-card card-waiting",children:[" ",r.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",r.jsx("div",{className:"summary-card-value",children:o.filter(B=>B.status==="waiting").length})," "]}),r.jsxs("div",{className:"summary-card card-consulting",children:[" ",r.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",r.jsx("div",{className:"summary-card-value",children:o.filter(B=>B.status==="consulting").length})," "]}),r.jsxs("div",{className:"summary-card card-completed",children:[" ",r.jsx("div",{className:"summary-card-title",children:"Completed"})," ",r.jsx("div",{className:"summary-card-value",children:o.filter(B=>B.status==="seen").length})," "]})]})]}),d?r.jsxs("div",{className:"loading-container",children:[" ",r.jsx("div",{className:"breathing-ball"})," ",r.jsx("span",{children:"Loading queue..."})]}):$.length===0?r.jsx("div",{className:"empty-queue-message",children:i?"No patients found matching your search.":"Queue is empty."}):r.jsxs("div",{className:"queue-table-wrapper",children:[" ",r.jsxs("table",{className:"queue-table",children:[" ",r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Queue"}),r.jsx("th",{children:"Patient"}),r.jsx("th",{children:"Phone Number"}),r.jsx("th",{children:"Complaint"}),r.jsx("th",{children:"Subscription Status"}),r.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",r.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),r.jsx("tbody",{children:$.map(B=>{var R,V,Y,ie,te,W,H,Q,J,fe,A;return r.jsxs("tr",{onClick:()=>P(`/dashboard/edit-complaint/${B.id}`),className:"queue-row-clickable",children:[r.jsxs("td",{children:[" ",r.jsxs("span",{className:"queue-token",children:["#",B.token_no]})," "]}),r.jsxs("td",{children:[" ",r.jsx("div",{className:"patient-name",children:((R=B.Patient)==null?void 0:R.name)||"N/A"})," ",r.jsxs("div",{className:"patient-details",children:[(V=B.Patient)!=null&&V.age?`${B.Patient.age} yrs, `:"",((Y=B.Patient)==null?void 0:Y.gender)||""]})," "]}),r.jsxs("td",{children:[" ",r.jsx("div",{className:"patient-phone",children:((ie=B.Patient)==null?void 0:ie.phone)||"N/A"})," "]}),r.jsx("td",{className:"complaint-text",children:B.complaint||"-"}),r.jsxs("td",{children:[r.jsx("span",{className:`subscription-status-badge ${((te=B.Patient)==null?void 0:te.subscription_status)==="active"?"status-active":((W=B.Patient)==null?void 0:W.subscription_status)==="cancelled"||((H=B.Patient)==null?void 0:H.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((Q=B.Patient)==null?void 0:Q.subscription_status)??"None"}),B.Patient&&B.Patient.id&&B.Patient.subscription_status!=="active"&&r.jsx("button",{onClick:oe=>{oe.stopPropagation(),B.Patient&&P(`/start-subscription/${B.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),r.jsx("td",{className:"hidden md:table-cell time-added",children:z(B.created_at)}),r.jsx("td",{className:"action-doctor-cell",children:v===B.id?r.jsx("div",{className:"relative inline-block text-left w-full",onClick:oe=>oe.stopPropagation(),children:r.jsxs("select",{value:"",onChange:oe=>U(B.id,oe.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[r.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?r.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(oe=>r.jsx("option",{value:oe.id,children:oe.name},oe.id)):r.jsx("option",{disabled:!0,children:"No doctors available"})]})}):r.jsxs("div",{className:"action-doctor-content",onClick:oe=>oe.stopPropagation(),children:[" ",B.status==="waiting"&&r.jsx(r.Fragment,{children:(J=B.User)!=null&&J.name?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"doctor-name-display",children:B.User.name}),r.jsx("button",{onClick:()=>L(B.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?r.jsx("span",{className:"status-text-italic",children:"Loading..."}):u.length===0?r.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?r.jsxs("button",{onClick:()=>U(B.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):r.jsx("button",{onClick:()=>S(B.id),className:"action-button btn-assign",children:"Assign"})}),B.status==="consulting"&&r.jsxs(r.Fragment,{children:[((fe=B.User)==null?void 0:fe.name)&&r.jsx("span",{className:"doctor-name-display",children:B.User.name}),r.jsx("button",{onClick:()=>L(B.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),B.status==="seen"&&r.jsxs(r.Fragment,{children:[((A=B.User)==null?void 0:A.name)&&r.jsx("span",{className:"doctor-name-display",children:B.User.name}),r.jsx("span",{className:"status-text-italic",children:"Completed"})]}),B.status==="cancelled"&&r.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},B.id)})})]})]})]}),n==="lab"&&r.jsxs("div",{className:"lab-tab-content",children:[" ",r.jsx(QT,{currentUser:e}),r.jsxs("button",{onClick:()=>P("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[r.jsx(us,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&r.jsx("div",{className:"newtons-ai-tab-content",children:r.jsx(jh,{})}),n==="manage-admission"&&r.jsx("div",{className:"manage-admission-tab-content",children:r.jsx(YT,{})}),n==="all-patients"&&r.jsx("div",{className:"all-patients-tab-content",children:r.jsx(S1,{})}),n==="custom-bill"&&r.jsx("div",{className:"custom-bill-tab-content",children:r.jsx(WT,{})})]})})},JT=6048e5,YB=864e5,KT=6e4,XT=36e5,BC=Symbol.for("constructDateFrom");function Xs(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&BC in e?e[BC](n):e instanceof Date?new e.constructor(n):new Date(n)}function Ir(e,n){return Xs(n||e,e)}function WB(e,n,t){const i=Ir(e,t==null?void 0:t.in);if(isNaN(n))return Xs(e,NaN);const a=i.getDate(),o=Xs(e,i.getTime());o.setMonth(i.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(i.setFullYear(o.getFullYear(),o.getMonth(),a),i)}let QB={};function Fb(){return QB}function Km(e,n){var d,f,u,p;const t=Fb(),i=(n==null?void 0:n.weekStartsOn)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((p=(u=t.locale)==null?void 0:u.options)==null?void 0:p.weekStartsOn)??0,a=Ir(e,n==null?void 0:n.in),o=a.getDay(),l=(o<i?7:0)+o-i;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function cb(e,n){return Km(e,{...n,weekStartsOn:1})}function ZT(e,n){const t=Ir(e,n==null?void 0:n.in),i=t.getFullYear(),a=Xs(t,0);a.setFullYear(i+1,0,4),a.setHours(0,0,0,0);const o=cb(a),l=Xs(t,0);l.setFullYear(i,0,4),l.setHours(0,0,0,0);const d=cb(l);return t.getTime()>=o.getTime()?i+1:t.getTime()>=d.getTime()?i:i-1}function qC(e){const n=Ir(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function JB(e,...n){const t=Xs.bind(null,n.find(i=>typeof i=="object"));return n.map(t)}function VC(e,n){const t=Ir(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function KB(e,n,t){const[i,a]=JB(t==null?void 0:t.in,e,n),o=VC(i),l=VC(a),d=+o-qC(o),f=+l-qC(l);return Math.round((d-f)/YB)}function XB(e,n){const t=ZT(e,n),i=Xs(e,0);return i.setFullYear(t,0,4),i.setHours(0,0,0,0),cb(i)}function ZB(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function N1(e){return!(!ZB(e)&&typeof e!="number"||isNaN(+Ir(e)))}function e8(e,n){const t=Ir(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const t8={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},n8=(e,n,t)=>{let i;const a=t8[e];return typeof a=="string"?i=a:n===1?i=a.one:i=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+i:i+" ago":i};function d0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const i8={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},r8={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},a8={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},s8={date:d0({formats:i8,defaultWidth:"full"}),time:d0({formats:r8,defaultWidth:"full"}),dateTime:d0({formats:a8,defaultWidth:"full"})},o8={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},l8=(e,n,t,i)=>o8[e];function _m(e){return(n,t)=>{const i=t!=null&&t.context?String(t.context):"standalone";let a;if(i==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,d=t!=null&&t.width?String(t.width):l;a=e.formattingValues[d]||e.formattingValues[l]}else{const l=e.defaultWidth,d=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[d]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const c8={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},u8={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},d8={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},f8={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},h8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},p8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},m8=(e,n)=>{const t=Number(e),i=t%100;if(i>20||i<10)switch(i%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},g8={ordinalNumber:m8,era:_m({values:c8,defaultWidth:"wide"}),quarter:_m({values:u8,defaultWidth:"wide",argumentCallback:e=>e-1}),month:_m({values:d8,defaultWidth:"wide"}),day:_m({values:f8,defaultWidth:"wide"}),dayPeriod:_m({values:h8,defaultWidth:"wide",formattingValues:p8,defaultFormattingWidth:"wide"})};function km(e){return(n,t={})=>{const i=t.width,a=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],d=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(d)?x8(d,g=>g.test(l)):y8(d,g=>g.test(l));let u;u=e.valueCallback?e.valueCallback(f):f,u=t.valueCallback?t.valueCallback(u):u;const p=n.slice(l.length);return{value:u,rest:p}}}function y8(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function x8(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function b8(e){return(n,t={})=>{const i=n.match(e.matchPattern);if(!i)return null;const a=i[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const d=n.slice(a.length);return{value:l,rest:d}}}const v8=/^(\d+)(th|st|nd|rd)?/i,w8=/\d+/i,S8={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},N8={any:[/^b/i,/^(a|c)/i]},C8={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},j8={any:[/1/i,/2/i,/3/i,/4/i]},_8={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},k8={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},T8={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},E8={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},A8={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},P8={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},D8={ordinalNumber:b8({matchPattern:v8,parsePattern:w8,valueCallback:e=>parseInt(e,10)}),era:km({matchPatterns:S8,defaultMatchWidth:"wide",parsePatterns:N8,defaultParseWidth:"any"}),quarter:km({matchPatterns:C8,defaultMatchWidth:"wide",parsePatterns:j8,defaultParseWidth:"any",valueCallback:e=>e+1}),month:km({matchPatterns:_8,defaultMatchWidth:"wide",parsePatterns:k8,defaultParseWidth:"any"}),day:km({matchPatterns:T8,defaultMatchWidth:"wide",parsePatterns:E8,defaultParseWidth:"any"}),dayPeriod:km({matchPatterns:A8,defaultMatchWidth:"any",parsePatterns:P8,defaultParseWidth:"any"})},I8={code:"en-US",formatDistance:n8,formatLong:s8,formatRelative:l8,localize:g8,match:D8,options:{weekStartsOn:0,firstWeekContainsDate:1}};function R8(e,n){const t=Ir(e,n==null?void 0:n.in);return KB(t,e8(t))+1}function M8(e,n){const t=Ir(e,n==null?void 0:n.in),i=+cb(t)-+XB(t);return Math.round(i/JT)+1}function e2(e,n){var p,g,b,v;const t=Ir(e,n==null?void 0:n.in),i=t.getFullYear(),a=Fb(),o=(n==null?void 0:n.firstWeekContainsDate)??((g=(p=n==null?void 0:n.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=Xs((n==null?void 0:n.in)||e,0);l.setFullYear(i+1,0,o),l.setHours(0,0,0,0);const d=Km(l,n),f=Xs((n==null?void 0:n.in)||e,0);f.setFullYear(i,0,o),f.setHours(0,0,0,0);const u=Km(f,n);return+t>=+d?i+1:+t>=+u?i:i-1}function O8(e,n){var d,f,u,p;const t=Fb(),i=(n==null?void 0:n.firstWeekContainsDate)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((p=(u=t.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??1,a=e2(e,n),o=Xs((n==null?void 0:n.in)||e,0);return o.setFullYear(a,0,i),o.setHours(0,0,0,0),Km(o,n)}function L8(e,n){const t=Ir(e,n==null?void 0:n.in),i=+Km(t,n)-+O8(t,n);return Math.round(i/JT)+1}function Un(e,n){const t=e<0?"-":"",i=Math.abs(e).toString().padStart(n,"0");return t+i}const Hc={y(e,n){const t=e.getFullYear(),i=t>0?t:1-t;return Un(n==="yy"?i%100:i,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Un(t+1,2)},d(e,n){return Un(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Un(e.getHours()%12||12,n.length)},H(e,n){return Un(e.getHours(),n.length)},m(e,n){return Un(e.getMinutes(),n.length)},s(e,n){return Un(e.getSeconds(),n.length)},S(e,n){const t=n.length,i=e.getMilliseconds(),a=Math.trunc(i*Math.pow(10,t-3));return Un(a,n.length)}},yh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},HC={G:function(e,n,t){const i=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(i,{width:"abbreviated"});case"GGGGG":return t.era(i,{width:"narrow"});case"GGGG":default:return t.era(i,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const i=e.getFullYear(),a=i>0?i:1-i;return t.ordinalNumber(a,{unit:"year"})}return Hc.y(e,n)},Y:function(e,n,t,i){const a=e2(e,i),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Un(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Un(o,n.length)},R:function(e,n){const t=ZT(e);return Un(t,n.length)},u:function(e,n){const t=e.getFullYear();return Un(t,n.length)},Q:function(e,n,t){const i=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(i);case"QQ":return Un(i,2);case"Qo":return t.ordinalNumber(i,{unit:"quarter"});case"QQQ":return t.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,n,t){const i=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(i);case"qq":return Un(i,2);case"qo":return t.ordinalNumber(i,{unit:"quarter"});case"qqq":return t.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,n,t){const i=e.getMonth();switch(n){case"M":case"MM":return Hc.M(e,n);case"Mo":return t.ordinalNumber(i+1,{unit:"month"});case"MMM":return t.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(i,{width:"wide",context:"formatting"})}},L:function(e,n,t){const i=e.getMonth();switch(n){case"L":return String(i+1);case"LL":return Un(i+1,2);case"Lo":return t.ordinalNumber(i+1,{unit:"month"});case"LLL":return t.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(i,{width:"wide",context:"standalone"})}},w:function(e,n,t,i){const a=L8(e,i);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Un(a,n.length)},I:function(e,n,t){const i=M8(e);return n==="Io"?t.ordinalNumber(i,{unit:"week"}):Un(i,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):Hc.d(e,n)},D:function(e,n,t){const i=R8(e);return n==="Do"?t.ordinalNumber(i,{unit:"dayOfYear"}):Un(i,n.length)},E:function(e,n,t){const i=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(i,{width:"short",context:"formatting"});case"EEEE":default:return t.day(i,{width:"wide",context:"formatting"})}},e:function(e,n,t,i){const a=e.getDay(),o=(a-i.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Un(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,i){const a=e.getDay(),o=(a-i.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Un(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const i=e.getDay(),a=i===0?7:i;switch(n){case"i":return String(a);case"ii":return Un(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(i,{width:"short",context:"formatting"});case"iiii":default:return t.day(i,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const i=e.getHours();let a;switch(i===12?a=yh.noon:i===0?a=yh.midnight:a=i/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const i=e.getHours();let a;switch(i>=17?a=yh.evening:i>=12?a=yh.afternoon:i>=4?a=yh.morning:a=yh.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let i=e.getHours()%12;return i===0&&(i=12),t.ordinalNumber(i,{unit:"hour"})}return Hc.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):Hc.H(e,n)},K:function(e,n,t){const i=e.getHours()%12;return n==="Ko"?t.ordinalNumber(i,{unit:"hour"}):Un(i,n.length)},k:function(e,n,t){let i=e.getHours();return i===0&&(i=24),n==="ko"?t.ordinalNumber(i,{unit:"hour"}):Un(i,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):Hc.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):Hc.s(e,n)},S:function(e,n){return Hc.S(e,n)},X:function(e,n,t){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(n){case"X":return YC(i);case"XXXX":case"XX":return Dd(i);case"XXXXX":case"XXX":default:return Dd(i,":")}},x:function(e,n,t){const i=e.getTimezoneOffset();switch(n){case"x":return YC(i);case"xxxx":case"xx":return Dd(i);case"xxxxx":case"xxx":default:return Dd(i,":")}},O:function(e,n,t){const i=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+GC(i,":");case"OOOO":default:return"GMT"+Dd(i,":")}},z:function(e,n,t){const i=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+GC(i,":");case"zzzz":default:return"GMT"+Dd(i,":")}},t:function(e,n,t){const i=Math.trunc(+e/1e3);return Un(i,n.length)},T:function(e,n,t){return Un(+e,n.length)}};function GC(e,n=""){const t=e>0?"-":"+",i=Math.abs(e),a=Math.trunc(i/60),o=i%60;return o===0?t+String(a):t+String(a)+n+Un(o,2)}function YC(e,n){return e%60===0?(e>0?"-":"+")+Un(Math.abs(e)/60,2):Dd(e,n)}function Dd(e,n=""){const t=e>0?"-":"+",i=Math.abs(e),a=Un(Math.trunc(i/60),2),o=Un(i%60,2);return t+a+n+o}const WC=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},t2=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},F8=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],i=t[1],a=t[2];if(!a)return WC(e,n);let o;switch(i){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",WC(i,n)).replace("{{time}}",t2(a,n))},$8={p:t2,P:F8},z8=/^D+$/,U8=/^Y+$/,B8=["D","DD","YY","YYYY"];function q8(e){return z8.test(e)}function V8(e){return U8.test(e)}function H8(e,n,t){const i=G8(e,n,t);if(console.warn(i),B8.includes(e))throw new RangeError(i)}function G8(e,n,t){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${i} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Y8=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,W8=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Q8=/^'([^]*?)'?$/,J8=/''/g,K8=/[a-zA-Z]/;function Md(e,n,t){var p,g,b,v;const i=Fb(),a=i.locale??I8,o=i.firstWeekContainsDate??((g=(p=i.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??1,l=i.weekStartsOn??((v=(b=i.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,d=Ir(e,t==null?void 0:t.in);if(!N1(d))throw new RangeError("Invalid time value");let f=n.match(W8).map(S=>{const k=S[0];if(k==="p"||k==="P"){const T=$8[k];return T(S,a.formatLong)}return S}).join("").match(Y8).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:X8(S)};if(HC[k])return{isToken:!0,value:S};if(k.match(K8))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(f=a.localize.preprocessor(d,f));const u={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(S=>{if(!S.isToken)return S.value;const k=S.value;(V8(k)||q8(k))&&H8(k,n,String(e));const T=HC[k[0]];return T(d,k,a.localize,u)}).join("")}function X8(e){const n=e.match(Q8);return n?n[1].replace(J8,"'"):e}function f0(e,n){return+Ir(e)<+Ir(n)}function QC(e,n){const t=()=>Xs(n==null?void 0:n.in,NaN),a=nq(e);let o;if(a.date){const u=iq(a.date,2);o=rq(u.restDateString,u.year)}if(!o||isNaN(+o))return t();const l=+o;let d=0,f;if(a.time&&(d=aq(a.time),isNaN(d)))return t();if(a.timezone){if(f=sq(a.timezone),isNaN(f))return t()}else{const u=new Date(l+d),p=Ir(0,n==null?void 0:n.in);return p.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),p.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),p}return Ir(l+d+f,n==null?void 0:n.in)}const vx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Z8=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,eq=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,tq=/^([+-])(\d{2})(?::?(\d{2}))?$/;function nq(e){const n={},t=e.split(vx.dateTimeDelimiter);let i;if(t.length>2)return n;if(/:/.test(t[0])?i=t[0]:(n.date=t[0],i=t[1],vx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(vx.timeZoneDelimiter)[0],i=e.substr(n.date.length,e.length))),i){const a=vx.timezone.exec(i);a?(n.time=i.replace(a[1],""),n.timezone=a[1]):n.time=i}return n}function iq(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),i=e.match(t);if(!i)return{year:NaN,restDateString:""};const a=i[1]?parseInt(i[1]):null,o=i[2]?parseInt(i[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((i[1]||i[2]).length)}}function rq(e,n){if(n===null)return new Date(NaN);const t=e.match(Z8);if(!t)return new Date(NaN);const i=!!t[4],a=Tm(t[1]),o=Tm(t[2])-1,l=Tm(t[3]),d=Tm(t[4]),f=Tm(t[5])-1;if(i)return dq(n,d,f)?oq(n,d,f):new Date(NaN);{const u=new Date(0);return!cq(n,o,l)||!uq(n,a)?new Date(NaN):(u.setUTCFullYear(n,o,Math.max(a,l)),u)}}function Tm(e){return e?parseInt(e):1}function aq(e){const n=e.match(eq);if(!n)return NaN;const t=h0(n[1]),i=h0(n[2]),a=h0(n[3]);return fq(t,i,a)?t*XT+i*KT+a*1e3:NaN}function h0(e){return e&&parseFloat(e.replace(",","."))||0}function sq(e){if(e==="Z")return 0;const n=e.match(tq);if(!n)return 0;const t=n[1]==="+"?-1:1,i=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return hq(i,a)?t*(i*XT+a*KT):NaN}function oq(e,n,t){const i=new Date(0);i.setUTCFullYear(e,0,4);const a=i.getUTCDay()||7,o=(n-1)*7+t+1-a;return i.setUTCDate(i.getUTCDate()+o),i}const lq=[31,null,31,30,31,30,31,31,30,31,30,31];function n2(e){return e%400===0||e%4===0&&e%100!==0}function cq(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(lq[n]||(n2(e)?29:28))}function uq(e,n){return n>=1&&n<=(n2(e)?366:365)}function dq(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function fq(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function hq(e,n){return n>=0&&n<=59}const Nw=({isEmbedded:e=!1})=>{const[n,t]=w.useState([]),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(null),g=w.useRef(null),[b,v]=w.useState(!1),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,I]=w.useState(!1),[U,L]=w.useState(null),[F,z]=w.useState({name:"",description:"",price:"",default_parameters:[]}),$=w.useCallback(async()=>{a(!0),l(null),p(null),k(null);try{const D=await pe("/api/lab-tests");if(!D.ok)throw new Error(`HTTP error! status: ${D.status}`);const se=await D.json();t(se)}catch(D){console.error("Error fetching lab tests:",D),l(D.message||"Failed to fetch lab tests.")}finally{a(!1)}},[]);w.useEffect(()=>{$()},[$]);const B=D=>{const{name:se,value:be}=D.target;z(ee=>({...ee,[se]:be}))},R=(D,se,be)=>{const ee=[...F.default_parameters],ce=ee[D];if(se==="type")switch(ce.type=be,be){case"number":ce.defaultValue=0,ce.lower_limit=null,ce.upper_limit=null,ce.unit="";break;case"boolean":ce.defaultValue=!1,ce.lower_limit=void 0,ce.upper_limit=void 0,ce.unit=void 0;break;case"string":default:ce.defaultValue="",ce.lower_limit=void 0,ce.upper_limit=void 0,ce.unit=void 0;break}else se==="defaultValue"?ce.type==="number"?ce.defaultValue=parseFloat(be)||0:(ce.type,ce.defaultValue=be):se==="lower_limit"||se==="upper_limit"?ce[se]=be===""?null:parseFloat(be):ce[se]=be;z(re=>({...re,default_parameters:ee}))},V=()=>{z(D=>({...D,default_parameters:[...D.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},Y=D=>{z(se=>({...se,default_parameters:se.default_parameters.filter((be,ee)=>ee!==D)}))},ie=async D=>{D.preventDefault(),a(!0),l(null);const se=U!==null,be=se?`/api/lab-tests/${U}`:"/api/lab-tests",ee=se?"PUT":"POST";try{const ce=await pe(be,{method:ee,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:F.name,description:F.description,price:parseFloat(F.price),default_parameters:F.default_parameters})});if(!ce.ok){const re=await ce.json();throw new Error(re.message||`HTTP error! status: ${ce.status}`)}I(!1),L(null),z({name:"",description:"",price:"",default_parameters:[]}),$()}catch(ce){console.error(`Error ${se?"updating":"adding"} lab test:`,ce),l(ce.message||`Failed to ${se?"update":"add"} lab test.`)}finally{a(!1)}},te=()=>{L(null),z({name:"",description:"",price:"",default_parameters:[]}),I(!0)},W=D=>{if(U===D.id)L(null);else{L(D.id);const se=(D.default_parameters||[]).map(be=>({...be,unit:be.unit||"",lower_limit:be.lower_limit===void 0?null:be.lower_limit,upper_limit:be.upper_limit===void 0?null:be.upper_limit}));z({name:D.name,description:D.description||"",price:D.price,default_parameters:se}),I(!1)}},H=async D=>{if(window.confirm("Are you sure you want to delete this lab test?")){a(!0),l(null);try{const se=await pe(`/api/lab-tests/${D}`,{method:"DELETE"});if(!se.ok){const be=await se.json();throw new Error(be.message||`HTTP error! status: ${se.status}`)}$()}catch(se){console.error("Error deleting lab test:",se),l(se.message||"Failed to delete lab test.")}finally{a(!1)}}},Q=()=>{I(!1),L(null),l(null),z({name:"",description:"",price:"",default_parameters:[]})},J=async D=>{if(!D){p("No file selected.");return}f(!0),p(null),l(null);const se=new FormData;se.append("file",D);try{const be=await pe("/api/lab-tests/import",{method:"POST",body:se});if(!be.ok){const ee=await be.json();throw new Error(ee.message||`Import failed: ${be.statusText}`)}$()}catch(be){console.error("Error importing lab tests from Excel:",be),p(be.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},fe=async D=>{if(D.target.files&&D.target.files[0]){const se=D.target.files[0];await J(se),D.target&&(D.target.value="")}},A=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){v(!0),k(null),l(null);try{const D=await pe("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!D.ok){const se=await D.json();throw new Error(se.message||`Default import failed: ${D.statusText}`)}$()}catch(D){console.error("Error importing default lab tests:",D),k(D.message||"Failed to import default lab tests.")}finally{v(!1)}}},oe=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){P(!0),l(null),p(null),k(null);try{const D=await pe("/api/lab-tests/all",{method:"DELETE"});if(!D.ok){const se=await D.json();throw new Error(se.message||`Delete all failed: ${D.statusText}`)}$()}catch(D){console.error("Error deleting all lab tests:",D),l(D.message||"Failed to delete all lab tests.")}finally{P(!1)}}},ue=i||d||b||T;return r.jsxs("div",{className:`lab-inventory-card ${e?"embedded":""}`,style:e?{border:"none",boxShadow:"none",padding:0}:{},children:[!e&&r.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),r.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[r.jsx("button",{onClick:te,className:"lab-inventory-button",disabled:ue,children:"Add New Test"}),r.jsx("button",{onClick:()=>{var D;return(D=g.current)==null?void 0:D.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:d?"Importing...":"Import from Excel"}),r.jsx("input",{type:"file",ref:g,onChange:fe,accept:".xlsx, .xls",style:{display:"none"},disabled:d}),r.jsx("button",{onClick:A,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:b?"Importing Defaults...":"Import Default Tests"}),r.jsx("button",{onClick:oe,className:"lab-inventory-button lab-inventory-button-danger",disabled:ue,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:T?"Deleting All...":"Delete All Tests"})]}),o&&r.jsx("div",{className:"error-text mb-4",children:o}),u&&r.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),S&&r.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",S]}),M&&r.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",r.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),r.jsxs("form",{onSubmit:ie,children:[r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Test Name ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:B,className:"lab-inventory-input",required:!0,disabled:ue})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:B,rows:3,className:"lab-inventory-input",disabled:ue})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:B,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ue})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),F.default_parameters.map((D,se)=>{var be,ee;return r.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[r.jsx("input",{type:"text",placeholder:"Parameter Name",value:D.name,onChange:ce=>R(se,"name",ce.target.value),className:"lab-inventory-input"}),r.jsxs("select",{value:D.type,onChange:ce=>R(se,"type",ce.target.value),className:"lab-inventory-input",children:[r.jsx("option",{value:"string",children:"Text"}),r.jsx("option",{value:"number",children:"Number"}),r.jsx("option",{value:"boolean",children:"Yes/No"})]}),D.type==="boolean"?r.jsxs("select",{value:D.defaultValue.toString(),onChange:ce=>R(se,"defaultValue",ce.target.value==="true"),className:"lab-inventory-input",children:[r.jsx("option",{value:"true",children:"Reactive"}),r.jsx("option",{value:"false",children:"Non-reactive"})]}):r.jsx("input",{type:D.type==="number"?"number":"text",placeholder:"Default Value",value:D.defaultValue.toString(),onChange:ce=>R(se,"defaultValue",ce.target.value),className:"lab-inventory-input"}),D.type==="number"&&r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"number",placeholder:"Lower Limit",value:D.lower_limit===null?"":((be=D.lower_limit)==null?void 0:be.toString())??"",onChange:ce=>R(se,"lower_limit",ce.target.value),className:"lab-inventory-input"}),r.jsx("input",{type:"number",placeholder:"Upper Limit",value:D.upper_limit===null?"":((ee=D.upper_limit)==null?void 0:ee.toString())??"",onChange:ce=>R(se,"upper_limit",ce.target.value),className:"lab-inventory-input"}),r.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:D.unit||"",onChange:ce=>R(se,"unit",ce.target.value),className:"lab-inventory-input"})]}),r.jsx("button",{type:"button",onClick:()=>Y(se),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},se)}),r.jsx("button",{type:"button",onClick:V,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[r.jsx("button",{type:"button",onClick:Q,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:"Cancel"}),r.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ue,children:i?"Saving...":"Add Test"})]})]})]}),ue&&!M&&r.jsxs("p",{className:"loading-text",children:[" ",d?"Importing Excel data...":b?"Importing default data...":"Loading tests..."]}),!ue&&n.length===0&&!o&&!u&&!S&&r.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!ue&&n.length>0&&r.jsxs("div",{className:"overflow-x-auto",children:[" ",r.jsxs("table",{className:"lab-inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",r.jsx("th",{children:"Price"}),r.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),r.jsx("tbody",{children:n.map(D=>{const se=U===D.id,be=D.price&&typeof D.price=="string"?parseFloat(D.price):NaN,ee=isNaN(be)?"0.00":be.toFixed(2);return r.jsxs(wn.Fragment,{children:[r.jsxs("tr",{onClick:()=>W(D),style:{cursor:"pointer"},children:[r.jsx("td",{children:D.name}),r.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:D.description||"-"}),r.jsxs("td",{children:["",ee]}),r.jsx("td",{style:{textAlign:"right"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{onClick:ce=>{ce.stopPropagation(),W(D)},className:"lab-inventory-link",disabled:ue,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),r.jsx("button",{onClick:ce=>{ce.stopPropagation(),H(D.id)},className:"lab-inventory-link",disabled:ue,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),se&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,children:r.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[r.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),r.jsxs("form",{onSubmit:ie,children:[r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Test Name ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:B,className:"lab-inventory-input",required:!0,disabled:ue})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:B,rows:3,className:"lab-inventory-input",disabled:ue})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:B,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ue})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),F.default_parameters.map((ce,re)=>{var Pe,Qe;return r.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[r.jsx("input",{type:"text",placeholder:"Parameter Name",value:ce.name,onChange:Se=>R(re,"name",Se.target.value),className:"lab-inventory-input"}),r.jsxs("select",{value:ce.type,onChange:Se=>R(re,"type",Se.target.value),className:"lab-inventory-input",children:[r.jsx("option",{value:"string",children:"Text"}),r.jsx("option",{value:"number",children:"Number"}),r.jsx("option",{value:"boolean",children:"Yes/No"})]}),ce.type==="boolean"?r.jsxs("select",{value:ce.defaultValue.toString(),onChange:Se=>R(re,"defaultValue",Se.target.value==="true"),className:"lab-inventory-input",children:[r.jsx("option",{value:"true",children:"Reactive"}),r.jsx("option",{value:"false",children:"Non-reactive"})]}):r.jsx("input",{type:ce.type==="number"?"number":"text",placeholder:"Default Value",value:ce.defaultValue.toString(),onChange:Se=>R(re,"defaultValue",Se.target.value),className:"lab-inventory-input"}),ce.type==="number"&&r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"number",placeholder:"Lower Limit",value:ce.lower_limit===null?"":((Pe=ce.lower_limit)==null?void 0:Pe.toString())??"",onChange:Se=>R(re,"lower_limit",Se.target.value),className:"lab-inventory-input"}),r.jsx("input",{type:"number",placeholder:"Upper Limit",value:ce.upper_limit===null?"":((Qe=ce.upper_limit)==null?void 0:Qe.toString())??"",onChange:Se=>R(re,"upper_limit",Se.target.value),className:"lab-inventory-input"}),r.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:ce.unit||"",onChange:Se=>R(re,"unit",Se.target.value),className:"lab-inventory-input"})]}),r.jsx("button",{type:"button",onClick:()=>Y(re),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},re)}),r.jsx("button",{type:"button",onClick:V,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[r.jsx("button",{type:"button",onClick:Q,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:"Cancel"}),r.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ue,children:i?"Saving...":"Update Test"})]})]})]})})})]},D.id)})})]})]})]})},pq=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((i,a)=>{n+=`*Test: ${i.name}*
`,t[i.id]?Object.entries(t[i.id]).forEach(([o,l])=>{var p;const d=(p=i.default_parameters)==null?void 0:p.find(g=>g.name===o);let f=String(l),u="";if(d){const g=d.unit?` _${d.unit}_`:"";if(d.type==="boolean"){const b=l===!0||l==="true";f=b?"*Reactive*":"Non-Reactive",b||(u="`Normal: Non-Reactive`")}else if(d.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(d.lower_limit!=null||d.upper_limit!=null){let v=[];d.lower_limit!=null&&v.push(`${d.lower_limit}`),d.upper_limit!=null&&v.push(`${d.upper_limit}`),u=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(d.lower_limit!=null&&b<d.lower_limit||d.upper_limit!=null&&b>d.upper_limit)&&(f=`*${f}*`)}}d.unit&&(f+=g)}n+=`${o}: ${f}
`,u&&((d==null?void 0:d.type)==="boolean"&&(l===!0||l==="true")||(n+=`${u}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},Cw=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=pq(e),i=`Hello ${n},

Your lab report is ready.

${t}`,o=`https://wa.me/${mq(e.Patient.phone)}?text=${encodeURIComponent(i)}`;window.open(o,"_blank")},mq=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,i=n.match(t);return i?n="91"+i[1]:n.startsWith("91")||(n="91"+n),n},gq=()=>{const[e,n]=w.useState([]),[t,i]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState("orders"),[p,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async($=1,B="")=>{o(!0),d(null);try{const R=new URLSearchParams({page:String($),limit:String(b)});B&&R.append("search",B);const V=await pe(`/api/lab?${R.toString()}`);if(!V.ok)throw new Error(`HTTP error! status: ${V.status}`);const Y=await V.json(),ie=Y.orders.map(te=>{var W,H;return{id:te.id,labTokenNumber:String(te.lab_token_number??"N/A"),patientName:((W=te.Patient)==null?void 0:W.name)||"N/A",patientId:te.patient_id,patientTokenNumber:String(((H=te.Patient)==null?void 0:H.patient_token_number)??"N/A"),tests:(te.tests||[]).map(Q=>Q.name||"Unknown Test"),date:Md(new Date(te.createdAt),"yyyy-MM-dd"),status:te.status,reportId:te.reportId,billId:te.billId}});n(ie),S(Y.totalCount),g($)}catch(R){console.error("Failed to fetch lab orders:",R),d(R instanceof Error?R.message:"An unknown error occurred"),n([]),S(0)}finally{o(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${p}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(p,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,p,t]),w.useEffect(()=>{const $=setTimeout(()=>{t.length>=2?p!==1&&g(1):t.length<2&&p!==1&&g(1)},1e3);return()=>{clearTimeout($)}},[t]);const P=async($,B)=>{console.log(`Updating order ${$} to status ${B}`);try{const R=await pe(`/api/lab/${$}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:B})});if(!R.ok){const V=await R.json();throw new Error(V.message||`Failed to update status: ${R.status}`)}if(B==="completed"){const V=await pe(`/api/lab/orders/${$}/report`);if(V.ok){const Y=await V.json();Cw(Y)}}await T(p,t),console.log(`Order ${$} status updated to ${B}, refetching page ${p}`)}catch(R){console.error("Error updating status:",R),alert(`Failed to update status: ${R instanceof Error?R.message:"Unknown error"}`)}},M=kt(),I=$=>{if(!$){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}$.billId?(console.log(`Navigating to existing bill for Bill ID: ${$.billId}, Patient: ${$.patientName}`),M("/billing",{state:{billId:$.billId,patientId:$.patientId,patientName:$.patientName,billType:"lab"}})):(console.log(`Navigating to LabBillingPage for Order ID: ${$.id}`),M(`/dashboard/lab-billing/${$.id}`))},U=$=>{$&&$.id?M(`/lab/report/${$.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},L=$=>{switch($){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:$,className:"status-badge"}}};if(a)return r.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:r.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return r.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[r.jsx(Ki,{size:48,className:"mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),r.jsx("p",{className:"mb-4",children:l}),r.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const F=()=>{p>1&&g($=>$-1)},z=()=>{p<k&&g($=>$+1)};return r.jsxs("div",{className:"lab-inventory-container",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("button",{onClick:()=>M(-1),className:"back-button mr-4",children:r.jsx(nn,{size:24})}),r.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),r.jsxs("main",{className:"flex-1 overflow-y-auto",children:[r.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[r.jsxs("button",{onClick:()=>u("orders"),className:`lab-inventory-button ${f==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[r.jsx(nk,{size:16,style:{marginRight:"8px"}}),"Orders"]}),r.jsx("button",{onClick:()=>M("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),r.jsxs("button",{onClick:()=>u("inventory"),className:`lab-inventory-button ${f==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[r.jsx(lI,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),f==="orders"&&r.jsxs("div",{className:"lab-orders-view",children:[" ",r.jsxs("div",{className:"lab-orders-header-controls",children:[r.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),r.jsxs("div",{className:"lab-orders-search-container",children:[r.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:$=>i($.target.value),className:"lab-inventory-input lab-orders-search-input"}),r.jsx(us,{size:18,className:"lab-orders-search-icon"})]})]}),r.jsx("div",{className:"lab-orders-table-container",children:r.jsxs("table",{className:"lab-inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Patient (Token)"}),r.jsx("th",{children:"Tests"}),r.jsx("th",{className:"hidden md:table-cell",children:"Date"}),r.jsx("th",{children:"Status"}),r.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),r.jsxs("tbody",{children:[a&&!l&&e.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map($=>{const B=L($.status);return r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("div",{children:$.patientName}),r.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",$.patientTokenNumber]})]}),r.jsx("td",{children:$.tests.map((R,V)=>r.jsx("div",{children:R},V))}),r.jsx("td",{className:"hidden md:table-cell",children:$.date}),r.jsx("td",{children:r.jsx("span",{className:B.className,children:B.text})}),r.jsx("td",{children:r.jsxs("div",{className:"lab-table-actions",children:[$.status==="pending"&&r.jsx("button",{onClick:()=>I($),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),$.status==="billed"&&r.jsx("button",{onClick:()=>P($.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),$.status==="collected"&&r.jsx("button",{onClick:()=>P($.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),($.status==="processing"||$.status==="report_ready"||$.status==="reported")&&r.jsx("button",{onClick:()=>U($),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),($.status==="report_ready"||$.status==="reported")&&r.jsx("button",{onClick:()=>P($.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),($.status==="completed"||$.status==="report_ready"||$.status==="reported")&&r.jsx("button",{onClick:()=>{$.id?M(`/lab/view-report/${$.id}`):(console.error("Attempted to view report for an order with no ID:",$),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},$.id)})]})]})}),r.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&r.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&r.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map($=>{const B=L($.status);return r.jsxs("div",{className:"lab-order-card",children:[r.jsxs("div",{className:"lab-card-header",children:[r.jsxs("div",{children:[r.jsx("div",{className:"lab-card-patient-name",children:$.patientName}),r.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",$.patientTokenNumber]}),r.jsx("div",{className:"lab-card-date",children:$.date})]}),r.jsx("span",{className:`${B.className} lab-card-status-pill`,children:B.text})]}),r.jsxs("div",{className:"lab-card-section",children:[r.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),$.tests.map((R,V)=>r.jsx("div",{className:"lab-card-test-item",children:R},V)),$.tests.length===0&&r.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),r.jsxs("div",{className:"lab-card-actions",children:[$.status==="pending"&&r.jsx("button",{onClick:()=>I($),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),$.status==="billed"&&r.jsx("button",{onClick:()=>P($.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),$.status==="collected"&&r.jsx("button",{onClick:()=>P($.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),($.status==="processing"||$.status==="report_ready"||$.status==="reported")&&r.jsx("button",{onClick:()=>U($),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),($.status==="report_ready"||$.status==="reported")&&r.jsx("button",{onClick:()=>P($.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),($.status==="completed"||$.status==="report_ready"||$.status==="reported")&&r.jsx("button",{onClick:()=>{$.id?M(`/lab/view-report/${$.id}`):(console.error("Attempted to view report for an order with no ID:",$),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},$.id)})]}),!a&&v>0&&r.jsxs("div",{className:"lab-pagination-controls",children:[r.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",r.jsx("strong",{children:(p-1)*b+1})," ","to"," ",r.jsx("strong",{children:Math.min(p*b,v)})," ","of"," ",r.jsx("strong",{children:v})," ","results"]}),r.jsxs("div",{className:"lab-pagination-buttons",children:[r.jsx("button",{onClick:F,disabled:p===1,className:"lab-pagination-button","aria-label":"Previous page",children:r.jsx(rw,{size:18})}),r.jsxs("span",{children:["Page ",p," of ",k]}),r.jsx("button",{onClick:z,disabled:p===k,className:"lab-pagination-button","aria-label":"Next page",children:r.jsx(wb,{size:18})})]})]})]}),f==="inventory"&&r.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",r.jsx(Nw,{})]})]})]})},yq=()=>{const[e,n]=w.useState([]),[t,i]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=kt(),u=w.useRef(null),[p,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),T=10,P=w.useCallback(async(z,$,B)=>{o(!0),d(null);try{let R=`/api/pharmacy-orders?page=${z}&limit=${$}`;B&&B.trim()!==""&&(R+=`&search=${encodeURIComponent(B.trim())}`);const V=await pe(R);if(!V.ok)throw new Error(`Failed to fetch orders: ${V.statusText} (${V.status})`);const Y=await V.json();if(Y&&Array.isArray(Y.orders)&&typeof Y.totalOrders=="number"&&typeof Y.totalPages=="number")console.log("Fetched pharmacy orders data:",Y.orders),n(Y.orders),k(Y.totalOrders),v(Y.totalPages),g(Y.currentPage||z);else throw console.error("Received data does not match expected paginated structure:",Y),new Error("Invalid data format received from API")}catch(R){console.error("Failed to fetch pharmacy orders:",R),d(R.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{o(!1)}},[]);w.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const z=t===""?p:1;t!==""&&p!==1&&g(1),P(z,T,t)},500),()=>{u.current&&clearTimeout(u.current)}),[t,p,P,T]);const M=z=>{f(`/dashboard/edit-pharmacy-order/${z}`)},I=z=>{d(null),console.log(`Preparing billing navigation for order: ${z}`);const $=e.find(B=>B.id===z);if($){const B=$.medications.map(R=>{const V=R.price??0;return(R.price===void 0||R.price===null)&&console.warn(`Medication "${R.name}" in order ${z} is missing a price. Defaulting to 0.`),{name:R.name,pack_quantity:R.pack_quantity,loose_quantity:R.loose_quantity,price:V,pack_price:R.pack_price,loose_price:R.loose_price,total_price:R.total_price,isLoose:R.isLoose,unit:R.unit,drug_id:R.drug_id?String(R.drug_id):null,tabletsPerDay:R.tabletsPerDay,numberOfDays:R.numberOfDays,directions_to_use:R.directions_to_use,discount_percentage:0,batch:R.batch,expiry_date:R.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:B}),f(`/dashboard/pharmacy-billing/${z}`,{state:{initialItems:B}})}else console.error(`Order with ID ${z} not found.`),d(`Order with ID ${z} not found.`),alert(`Error: Could not find order ${z} to bill.`)},U=async(z,$)=>{d(null);const B=e.find(V=>V.id===z);if(!B){d(`Order with ID ${z} not found.`);return}const R={status:$,medications:B.medications};try{const V=await pe(`/api/pharmacy-orders/${z}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!V.ok){const ie=await V.text();throw new Error(`Failed to update status: ${V.statusText} (${V.status}) - ${ie}`)}const Y=await V.json();n(ie=>ie.map(te=>te.id===Y.id?{...te,status:Y.status}:te))}catch(V){console.error("Failed to update order status:",V),d(V.message||`Failed to update status for order ${z}.`),alert(`Error updating status for order ${z}: ${V.message||"Please try again."}`)}},L=z=>{switch(z){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},F=z=>{f(`/dashboard/orders/${z.id}`)};return a&&e.length===0&&!l?r.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?r.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):r.jsxs("div",{className:"pharmacy-queue-container",children:[r.jsxs("div",{className:"pharmacy-queue-header",children:[r.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),r.jsxs("div",{className:"pharmacy-actions-container",children:[r.jsxs("div",{className:"pharmacy-buttons-group",children:[r.jsxs("button",{onClick:()=>f("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[r.jsx(cs,{size:16}),"Add Order"]}),r.jsxs("button",{onClick:()=>f("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[r.jsx(Ld,{size:16}),"Inventory"]}),r.jsxs("button",{onClick:()=>f("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[r.jsx(tk,{size:16}),"Newton's AI"]}),r.jsxs("button",{onClick:()=>f("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[r.jsx(Ld,{size:16}),"Distributors"]})]}),r.jsxs("div",{className:"pharmacy-search-input-container",children:[r.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:z=>i(z.target.value),className:"pharmacy-search-input"}),r.jsx(us,{size:18,className:"pharmacy-search-icon"})]})]})]}),r.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&r.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&r.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&r.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"pharmacy-table-container",children:r.jsxs("table",{className:"pharmacy-queue-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Patient"}),r.jsx("th",{children:"Medications"}),r.jsx("th",{className:"hidden md:table-cell",children:"Date"}),r.jsx("th",{children:"Order Total"})," ",r.jsx("th",{children:"Status"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.map(z=>r.jsxs("tr",{onClick:()=>F(z),style:{cursor:"pointer"},children:[r.jsxs("td",{children:[r.jsx("div",{className:"patient-name",children:z.patientName}),r.jsx("div",{className:"patient-token",title:`Patient Token: ${z.patientTokenNumber}`,children:z.patientTokenNumber})]}),r.jsxs("td",{className:"medication-info",children:[z.medications.map(($,B)=>r.jsxs("div",{className:"medication-item",children:[r.jsxs("span",{children:[$.name," (Packs: ",$.pack_quantity,", Loose: ",$.loose_quantity,", ",$.tabletsPerDay??"N/A","x",$.numberOfDays??"N/A","d)",$.box_number&&r.jsxs("span",{className:"medication-box-number",children:[" (Box: ",$.box_number,")"]})]}),$.directions_to_use&&r.jsxs("span",{className:"medication-directions",children:["Directions: ",$.directions_to_use]}),r.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[$.pack_price!==void 0&&`Pack Price: ${Number($.pack_price).toFixed(2)}`,$.loose_price!==void 0&&` | Loose Price: ${Number($.loose_price).toFixed(2)}`,$.total_price!==void 0&&` | Item Total: ${Number($.total_price).toFixed(2)}`]})]},B)),z.prescriptionForUnavailableDrugs&&r.jsxs("div",{className:"unavailable-drugs-note",children:[r.jsx("strong",{children:"Unavailable Drugs Note:"})," ",z.prescriptionForUnavailableDrugs]})]}),r.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(z.date).toLocaleDateString()}),r.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(z.order_total??0).toFixed(2)]}),r.jsx("td",{children:r.jsx("span",{className:L(z.status),children:z.status})}),r.jsx("td",{children:r.jsxs("div",{className:"pharmacy-table-actions",children:[z.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:$=>{$.stopPropagation(),M(z.id)},className:"pharmacy-table-action-button btn-edit-order",children:[r.jsx(eu,{size:14})," Edit"]}),r.jsxs("button",{onClick:$=>{$.stopPropagation(),I(z.id)},className:"pharmacy-table-action-button btn-bill-order",children:[r.jsx(Dh,{size:14})," Bill"]})]}),z.status==="billed"&&r.jsxs("button",{onClick:$=>{$.stopPropagation(),U(z.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[r.jsx(fs,{size:14})," Dispense"]}),(z.status==="pending"||z.status==="billed")&&r.jsx("button",{onClick:$=>{$.stopPropagation(),U(z.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),r.jsx("button",{onClick:$=>{$.stopPropagation(),F(z)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},z.id))})]})}),r.jsx("div",{className:"pharmacy-card-view-container",children:e.map(z=>{const $=L(z.status);return r.jsxs("div",{className:"pharmacy-order-card",onClick:()=>F(z),children:[r.jsxs("div",{className:"pharmacy-card-header",children:[r.jsxs("div",{children:[r.jsx("div",{className:"pharmacy-card-patient-name",children:z.patientName||"N/A"}),r.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${z.patientTokenNumber}`,children:["Token: ",z.patientTokenNumber||"N/A"]}),r.jsx("div",{className:"pharmacy-card-date",children:new Date(z.date).toLocaleDateString()})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:$,children:z.status}),z.order_total!==void 0&&r.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(z.order_total).toFixed(2)]})]})]}),r.jsxs("div",{className:"pharmacy-card-medications",children:[r.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),r.jsxs("div",{className:"space-y-0_5",children:[z.medications.slice(0,2).map((B,R)=>r.jsxs("div",{className:"pharmacy-card-medication-item",children:[r.jsxs("span",{title:`${B.name} (Packs: ${B.pack_quantity}, Loose: ${B.loose_quantity}, ${B.tabletsPerDay??"N/A"}x${B.numberOfDays??"N/A"}d)`,children:[B.name," (Packs: ",B.pack_quantity,", Loose: ",B.loose_quantity,", ",B.tabletsPerDay??"N/A","x",B.numberOfDays??"N/A","d)",B.box_number&&r.jsxs("span",{className:"medication-box-number",children:[" (Box: ",B.box_number,")"]})]}),B.directions_to_use&&r.jsxs("span",{className:"medication-directions",title:`Directions: ${B.directions_to_use}`,children:["Directions: ",B.directions_to_use]}),r.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[B.pack_price!==void 0&&`Pack Price: ${Number(B.pack_price).toFixed(2)}`,B.loose_price!==void 0&&` | Loose Price: ${Number(B.loose_price).toFixed(2)}`,B.total_price!==void 0&&` | Item Total: ${Number(B.total_price).toFixed(2)}`]})]},R)),z.medications.length>2&&r.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",z.medications.length-2," more"]}),z.medications.length===0&&r.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),z.prescriptionForUnavailableDrugs&&r.jsxs("div",{className:"unavailable-drugs-note",children:[r.jsx("strong",{children:"Unavailable Drugs Note:"})," ",z.prescriptionForUnavailableDrugs]})]}),r.jsxs("div",{className:"pharmacy-card-actions",children:[z.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:B=>{B.stopPropagation(),M(z.id)},className:"pharmacy-table-action-button btn-edit-order",children:[r.jsx(eu,{size:14})," Edit"]}),r.jsxs("button",{onClick:B=>{B.stopPropagation(),I(z.id)},className:"pharmacy-table-action-button btn-bill-order",children:[r.jsx(Dh,{size:14})," Bill"]})]}),z.status==="billed"&&r.jsxs("button",{onClick:B=>{B.stopPropagation(),U(z.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[r.jsx(fs,{size:14})," Dispense"]}),(z.status==="pending"||z.status==="billed")&&r.jsx("button",{onClick:B=>{B.stopPropagation(),U(z.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),r.jsx("button",{onClick:B=>{B.stopPropagation(),F(z)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},z.id)})})]}),!a&&b>1&&r.jsxs("div",{className:"pharmacy-pagination-container",children:[r.jsxs("div",{className:"pagination-mobile-controls",children:[r.jsx("button",{onClick:()=>g(z=>Math.max(z-1,1)),disabled:p===1,className:"pagination-button prev",children:"Previous"}),r.jsx("button",{onClick:()=>g(z=>Math.min(z+1,b)),disabled:p===b,className:"pagination-button next",children:"Next"})]}),r.jsxs("div",{className:"pagination-desktop-controls",children:[r.jsx("div",{className:"pagination-info",children:r.jsxs("p",{children:["Showing ",r.jsx("span",{className:"font-medium",children:(p-1)*T+1})," ","to ",r.jsx("span",{className:"font-medium",children:Math.min(p*T,S)})," ","of ",r.jsx("span",{className:"font-medium",children:S})," results"]})}),r.jsx("div",{children:r.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[r.jsxs("button",{onClick:()=>g(z=>Math.max(z-1,1)),disabled:p===1,className:"pagination-nav-button prev",children:[r.jsx("span",{className:"sr-only",children:"Previous"}),r.jsx(rw,{"aria-hidden":"true"})]}),r.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",p," of ",b]}),r.jsxs("button",{onClick:()=>g(z=>Math.min(z+1,b)),disabled:p===b,className:"pagination-nav-button next",children:[r.jsx("span",{className:"sr-only",children:"Next"}),r.jsx(wb,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},JC=10,xq=3,i2=({isEmbedded:e=!1})=>{const n=kt(),[t,i]=w.useState([]),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(new Set),[S,k]=w.useState("all"),T=async()=>{try{const ve=await pe("/api/inventory/download-csv");if(!ve.ok)throw new Error(`Failed to download CSV: ${ve.statusText}`);const xe=await ve.blob(),Be=window.URL.createObjectURL(xe),Ue=document.createElement("a");Ue.href=Be,Ue.download="pharmacy_inventory.csv",document.body.appendChild(Ue),Ue.click(),Ue.remove(),window.URL.revokeObjectURL(Be)}catch(ve){console.error("Failed to download CSV:",ve),g(ve.message||"Failed to download inventory CSV. Please try again.")}},[P,M]=w.useState(!1),[I,U]=w.useState(!1),[L,F]=w.useState(null),[z,$]=w.useState(!1),[B,R]=w.useState(new Set),[V,Y]=w.useState(1),ie=8,[te,W]=w.useState(null),[H,Q]=w.useState(0),[J,fe]=w.useState(!1),[A,oe]=w.useState(null),[ue,D]=w.useState(1),[se,be]=w.useState(!1),ee=V*ie,ce=ee-ie,re=a.slice(ce,ee),Pe=Math.ceil(a.length/ie);w.useEffect(()=>{Y(1)},[l,S]);const Qe=w.useCallback(async()=>{u(!0),g(null);try{const ve=await pe("/api/drugs");if(!ve.ok)throw new Error(`Failed to fetch drugs: ${ve.statusText} (${ve.status})`);let xe=await ve.json();xe=xe.map(Be=>({...Be,price:parseFloat(String(Be.price))||0,buying_price:Be.buying_price!==null&&Be.buying_price!==void 0?parseFloat(String(Be.buying_price)):null,quantity_in_stock:parseInt(String(Be.quantity_in_stock),10)||0,gst:Be.gst!==null&&Be.gst!==void 0?parseFloat(String(Be.gst)):null,margin:Be.margin!==null&&Be.margin!==void 0?parseFloat(String(Be.margin)):null,discount:Be.discount!==null&&Be.discount!==void 0?parseFloat(String(Be.discount)):null})),i(xe),o(xe)}catch(ve){console.error("Failed to fetch drugs:",ve),g(ve.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{Qe()},[Qe]),w.useEffect(()=>{const ve=l.toLowerCase();let xe=t.filter(tt=>{var si,ki,bn,Ti,rn;const dt=((si=tt.name)==null?void 0:si.toLowerCase())||"",qt=((ki=tt.description)==null?void 0:ki.toLowerCase())||"",On=((bn=tt.supplier)==null?void 0:bn.toLowerCase())||"",Tt=((Ti=tt.box_number)==null?void 0:Ti.toLowerCase())||"",Rt=((rn=tt.brand_name)==null?void 0:rn.toLowerCase())||"";return dt.includes(ve)||qt.includes(ve)||On.includes(ve)||Tt.includes(ve)||Rt.includes(ve)});const Be=new Date,Ue=WB(Be,xq);S==="low-stock"?xe=xe.filter(tt=>tt.quantity_in_stock<=JC):S==="near-expiry"?xe=xe.filter(tt=>{if(!tt.expiry_date)return!1;const dt=QC(tt.expiry_date);return N1(dt)&&f0(dt,Ue)&&!f0(dt,Be)}):S==="expired"&&(xe=xe.filter(tt=>{if(!tt.expiry_date)return!1;const dt=QC(tt.expiry_date);return N1(dt)&&f0(dt,Be)})),o(xe)},[l,t,S]);const Se=()=>{M(!1),W(null)},Ne=ve=>{Q(parseInt(ve.target.value,10)||0)},De=async ve=>{if(ve.preventDefault(),g(null),!te||!te.id||H===0){g("No drug selected or adjustment amount is zero.");return}try{const xe=await pe(`/api/drugs/${te.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:H})});if(!xe.ok){const Ue=await xe.json();throw new Error(Ue.message||`Failed to adjust stock: ${xe.statusText}`)}const Be=await xe.json();i(Ue=>Ue.map(tt=>tt.id===Be.id?Be:tt)),Se(),alert(`Stock for "${Be.name}" adjusted successfully. New stock: ${Be.quantity_in_stock}`)}catch(xe){console.error("Failed to adjust stock:",xe),g(xe.message||"Failed to adjust stock. Please try again.")}},Me=ve=>{F(ve),U(!0)},nt=()=>{U(!1),F(null)},ft=async()=>{if(!L||!L.id){g("No drug selected for deletion.");return}u(!0),g(null);try{const ve=await pe(`/api/drugs/${L.id}`,{method:"DELETE"});if(!ve.ok){const xe=await ve.json();throw new Error(xe.message||`Failed to delete drug: ${ve.statusText}`)}alert(`Drug "${L.name}" deleted successfully.`),Qe(),nt()}catch(ve){console.error("Failed to delete drug:",ve),g(ve.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},ut=()=>{$(!0)},rt=()=>{$(!1)},[Nt,Ft]=w.useState(!1),ye=()=>{B.size>0&&Ft(!0)},Te=()=>{Ft(!1)},Ye=async()=>{if(B.size===0){g("No drugs selected for deletion.");return}u(!0),g(null);try{const ve=await pe("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(B)})});if(!ve.ok){const xe=await ve.json();throw new Error(xe.message||`Failed to delete selected drugs: ${ve.statusText}`)}alert(`${B.size} drug(s) deleted successfully.`),Qe(),R(new Set),Te()}catch(ve){console.error("Failed to delete selected drugs:",ve),g(ve.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},$e=async()=>{u(!0),g(null);try{const ve=await pe("/api/drugs/all",{method:"DELETE"});if(!ve.ok){const xe=await ve.json();throw new Error(xe.message||`Failed to delete all drugs: ${ve.statusText}`)}alert("All drugs deleted successfully."),Qe(),rt()}catch(ve){console.error("Failed to delete all drugs:",ve),g(ve.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},_e=ve=>{if(!ve)return null;const xe=ve.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return xe?parseInt(xe[1],10):null},X=ve=>{oe(ve),D(1),fe(!0)},de=()=>{fe(!1),oe(null),D(1)},qe=ve=>{D(parseInt(ve.target.value,10)||0)},et=async ve=>{if(ve.preventDefault(),g(null),!A||!A.id||ue<=0){g("No drug selected or invalid number of packs to convert.");return}const xe=_e(A.unit);if(!xe||xe<=0){g(`Cannot convert "${A.name}" to loose. Invalid pack unit: ${A.unit||"N/A"}.`);return}if(ue>(A.quantity_in_stock??0)){g(`Cannot convert ${ue} packs. Only ${A.quantity_in_stock??0} packs are in stock.`);return}try{const Be=await pe(`/api/drugs/${A.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:ue,packSize:xe})});if(!Be.ok){const tt=await Be.json();throw new Error(tt.message||`Failed to convert to loose: ${Be.statusText}`)}const Ue=await Be.json();i(tt=>tt.map(dt=>dt.id===Ue.id?Ue:dt)),de(),alert(`Converted ${ue} pack(s) of "${Ue.name}" to loose. New stock: ${Ue.quantity_in_stock} packs, ${Ue.loose??0} loose units.`)}catch(Be){console.error("Failed to convert to loose:",Be),g(Be.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},ct=()=>{be(!0)},Fe=()=>{be(!1)},ot=async()=>{u(!0),g(null);try{const ve=await pe("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!ve.ok){const xe=await ve.json();throw new Error(xe.message||`Failed to add default medications: ${ve.statusText}`)}alert("Default medications added successfully."),Qe(),Fe()}catch(ve){console.error("Failed to add default medications:",ve),g(ve.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?r.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):p?r.jsxs("div",{className:"error-indicator",children:["Error: ",p]}):r.jsxs("div",{className:`pharmacy-inventory-page ${e?"embedded":""}`,style:e?{minHeight:"auto",padding:"0",background:"transparent"}:{},children:[r.jsx("div",{className:"inventory-header-controls",style:{padding:"20px 20px 0 20px"},children:r.jsxs("div",{className:"inventory-actions-group",children:[r.jsxs("div",{className:"action-group-left",style:{display:"flex",gap:"12px"},children:[r.jsxs("button",{onClick:()=>n("/dashboard/inventory/add"),className:"action-button-outline add-drug-button",children:[r.jsx(cs,{size:18}),"Add New Drug"]}),r.jsxs("button",{onClick:()=>n("/dashboard/purchase"),className:"action-button-outline",children:[r.jsx(cs,{size:18}),"Purchase Page"]}),r.jsxs("button",{onClick:()=>n("/dashboard/distributors"),className:"action-button-outline",children:[r.jsx(cs,{size:18}),"Distributors"]})]}),r.jsxs("div",{className:"action-group-right",style:{display:"flex",gap:"12px"},children:[r.jsx("button",{onClick:T,className:"action-button-outline",children:"Download CSV"}),r.jsxs("button",{onClick:ct,className:"action-button-outline",children:[r.jsx(cs,{size:18}),"Import Defaults"]}),r.jsxs("button",{onClick:ye,className:"action-button-outline delete-button-outline",disabled:B.size===0,children:[r.jsx(lr,{size:18}),"Delete (",B.size,")"]}),r.jsxs("button",{onClick:ut,className:"action-button-outline delete-all-button-outline",children:[r.jsx(lr,{size:18}),"Delete All"]})]})]})}),r.jsxs("div",{className:"search-bar-container",style:{padding:"0 20px 20px 20px",borderBottom:"1px solid var(--border-color)",marginBottom:"0"},children:[r.jsxs("div",{className:"search-input-wrapper",style:{maxWidth:"600px"},children:[r.jsx(us,{size:20,className:"search-input-icon"}),r.jsx("input",{type:"text",placeholder:"Search drugs...",value:l,onChange:ve=>d(ve.target.value),className:"inventory-search-input"})]}),r.jsx("div",{className:"filter-dropdown-wrapper",children:r.jsxs("select",{value:S,onChange:ve=>k(ve.target.value),className:"inventory-filter-select",children:[r.jsx("option",{value:"all",children:"All Drugs"}),r.jsx("option",{value:"low-stock",children:"Low Stock"}),r.jsx("option",{value:"near-expiry",children:"Near Expiry"}),r.jsx("option",{value:"expired",children:"Expired"})]})})]}),r.jsx("div",{className:"inventory-table-container",children:r.jsxs("table",{className:"inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"checkbox-header",children:r.jsx("input",{type:"checkbox",onChange:ve=>{if(ve.target.checked){const xe=new Set(a.map(Be=>Be.id));R(xe)}else R(new Set)},checked:B.size===a.length&&a.length>0,disabled:a.length===0})}),r.jsx("th",{className:"drug-name-header",children:"DRUG NAME"}),r.jsx("th",{className:"brand-name-header",children:"BRAND"}),r.jsx("th",{className:"pack-header",children:"PACK"}),r.jsx("th",{className:"expiry-header",children:"EXPIRY"}),r.jsx("th",{className:"text-stock qty-header",children:"STOCK"}),r.jsx("th",{className:"text-price mrp-header",children:"MRP"}),r.jsx("th",{className:"text-cost rate-header",children:"RATE"}),r.jsx("th",{className:"box-number-header",children:"BOX"}),r.jsx("th",{className:"discount-header",children:"DISC %"}),r.jsx("th",{className:"margin-header",children:"MARGIN"}),r.jsx("th",{className:"actions-cell",children:"ACTIONS"})]})}),r.jsxs("tbody",{children:[a.length===0&&r.jsx("tr",{className:"no-results-message",children:r.jsx("td",{colSpan:12,children:"No drugs found matching your search."})}),re.map(ve=>r.jsxs(wn.Fragment,{children:[r.jsxs("tr",{className:"drug-row",onClick:()=>{const xe=new Set(b);xe.has(ve.id)&&ve.id!==void 0?xe.delete(ve.id):ve.id!==void 0&&xe.add(ve.id),v(xe)},children:[r.jsx("td",{className:"checkbox-cell",children:r.jsx("input",{type:"checkbox",onClick:xe=>xe.stopPropagation(),checked:B.has(ve.id),onChange:()=>{const xe=new Set(B);xe.has(ve.id)?xe.delete(ve.id):xe.add(ve.id),R(xe)}})}),r.jsx("td",{className:"drug-name-cell",children:ve.name||"-"}),r.jsx("td",{className:"brand-name-cell",children:ve.brand_name||"-"}),r.jsx("td",{className:"text-muted pack-cell",children:ve.unit||"-"}),r.jsx("td",{className:"text-muted",children:ve.expiry_date?new Date(ve.expiry_date).toLocaleDateString("en-GB"):"-"}),r.jsxs("td",{className:`text-stock ${ve.quantity_in_stock<=JC?"low-stock":""}`,children:[r.jsx("div",{style:{fontWeight:"bold"},children:ve.quantity_in_stock}),r.jsx("div",{className:"loose-quantity",children:ve.loose!==null&&ve.loose!==void 0?`${ve.loose} loose`:"0 loose"})]}),r.jsxs("td",{className:"text-muted text-price",children:["",typeof ve.price=="number"?ve.price.toFixed(2):"N/A"]}),r.jsx("td",{className:"text-muted text-cost",children:ve.buying_price!==null&&ve.buying_price!==void 0?`${ve.buying_price.toFixed(2)}`:"-"}),r.jsx("td",{className:"text-muted",children:ve.box_number||"-"}),r.jsx("td",{className:"text-muted",children:ve.discount!==null&&ve.discount!==void 0?`${ve.discount.toFixed(2)}%`:"0.00%"}),r.jsx("td",{className:"text-muted",children:(()=>{const xe=ve.price||0,Be=ve.buying_price||0,Ue=ve.discount||0,tt=ve.gst||0,qt=Be*(1-Ue/100)*(1+tt/100),On=xe-qt;return`${(xe>0?On/xe*100:0).toFixed(2)}%`})()}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"actions-buttons-group",children:[r.jsx("button",{onClick:xe=>{xe.stopPropagation(),n(`/dashboard/inventory/edit/${ve.id}`)},className:"action-icon-button",title:"Edit Drug",children:r.jsx(eu,{size:16})}),r.jsx("button",{onClick:xe=>{xe.stopPropagation(),Me(ve)},className:"action-icon-button delete-button",title:"Delete Drug",children:r.jsx(lr,{size:16})}),r.jsx("button",{onClick:xe=>{xe.stopPropagation(),W(ve),M(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:r.jsx(_I,{size:16})}),r.jsx("button",{onClick:xe=>{xe.stopPropagation(),X(ve)},className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!ve.unit||_e(ve.unit)===null,children:r.jsx(cR,{size:16})})]})})]}),b.has(ve.id)&&r.jsx("tr",{className:"collapsible-row",children:r.jsx("td",{colSpan:12,children:r.jsxs("div",{className:"collapsible-content",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Description:"})," ",ve.description||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Supplier:"})," ",ve.supplier||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Batch:"})," ",ve.batch||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"HSN Code:"})," ",ve.hsn_code||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"MFG:"})," ",ve.mfg||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Loose Price:"}),(()=>{const xe=_e(ve.unit);return xe&&xe>0&&typeof ve.price=="number"?`${(ve.price/xe).toFixed(2)}`:"N/A"})()]}),r.jsxs("p",{children:[r.jsx("strong",{children:"GST:"})," ",ve.gst!==null&&ve.gst!==void 0?`${ve.gst.toFixed(2)}%`:"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Last Updated:"})," ",new Date(ve.last_updated).toLocaleString()]})]})})})]},ve.id))]})]})}),Pe>1&&r.jsxs("div",{className:"pagination-controls",style:{padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"20px",backgroundColor:"var(--card-bg, #fff)",borderTop:"1px solid var(--border-color)"},children:[r.jsx("button",{onClick:()=>Y(ve=>Math.max(ve-1,1)),disabled:V===1,className:"pagination-button",children:"Previous"}),r.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Page ",V," of ",Pe]}),r.jsx("button",{onClick:()=>Y(ve=>Math.min(ve+1,Pe)),disabled:V===Pe,className:"pagination-button",children:"Next"})]}),I&&L&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:nt,className:"modal-close-button",children:r.jsx(ni,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),r.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',r.jsx("span",{className:"drug-name",children:L.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:nt,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:ft,className:"button-delete",children:"Delete"})]})]})}),P&&te&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:Se,className:"modal-close-button",children:r.jsx(ni,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),r.jsxs("p",{className:"modal-description",children:["Drug: ",r.jsx("span",{className:"drug-name",children:te.name||"Unnamed Drug"}),r.jsx("br",{}),"Current Stock: ",te.quantity_in_stock]}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("form",{onSubmit:De,children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),r.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:H,onChange:Ne,placeholder:"e.g., 10 or -5",className:"form-input"}),r.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:Se,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),z&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:rt,className:"modal-close-button",children:r.jsx(ni,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),r.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",r.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:rt,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:$e,className:"button-delete",children:"Delete All"})]})]})}),Nt&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:Te,className:"modal-close-button",children:r.jsx(ni,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),r.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",r.jsx("span",{className:"drug-name",children:B.size})," selected drug(s)? This action cannot be undone."]}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:Te,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:Ye,className:"button-delete",children:"Delete Selected"})]})]})}),J&&A&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:de,className:"modal-close-button",children:r.jsx(ni,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Convert Pack to Loose"}),r.jsxs("p",{className:"modal-description",children:["Drug: ",r.jsx("span",{className:"drug-name",children:A.name||"Unnamed Drug"}),r.jsx("br",{}),"Current Packs in Stock: ",A.quantity_in_stock??0,r.jsx("br",{}),"Current Loose Units: ",A.loose??0,r.jsx("br",{}),"Pack Size: ",_e(A.unit)||"N/A"," units per pack"]}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("form",{onSubmit:et,children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"packs-to-convert",className:"form-label",children:"Number of Packs to Convert"}),r.jsx("input",{type:"number",name:"packs-to-convert",id:"packs-to-convert",required:!0,min:"1",step:"1",value:ue,onChange:qe,placeholder:"e.g., 1",className:"form-input"}),r.jsxs("p",{className:"form-help-text",children:["This will reduce pack quantity by ",ue," and add ",ue*(_e(A.unit)||0)," to loose quantity."]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:de,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Convert to Loose"})]})]})]})}),se&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:Fe,className:"modal-close-button",children:r.jsx(ni,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),r.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:Fe,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:ot,className:"button-submit",children:"Add Defaults"})]})]})})]})},bq=()=>{const e=kt();return r.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[r.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),r.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},r2=()=>{const{id:e}=Qr(),n=kt(),[t,i]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){d("Drug ID is missing."),o(!1);return}o(!0),d(null);try{const I=await pe(`/api/drugs/${e}`);if(!I.ok){const L=await I.json();throw new Error(L.message||`Failed to fetch drug: ${I.statusText}`)}let U=await I.json();U={...U,name:U.name||"",brand_name:U.brand_name||"",price:parseFloat(String(U.price))||0,buying_price:U.buying_price!==null&&U.buying_price!==void 0?parseFloat(String(U.buying_price)):null,quantity_in_stock:parseInt(String(U.quantity_in_stock),10)||0,gst:U.gst!==null&&U.gst!==void 0?parseFloat(String(U.gst)):null,margin:U.margin!==null&&U.margin!==void 0?parseFloat(String(U.margin)):null,discount:U.discount!==null&&U.discount!==void 0?parseFloat(String(U.discount)):null,batch:U.batch||"",hsn_code:U.hsn_code||"",mfg:U.mfg||"",loose:U.loose!==null&&U.loose!==void 0?parseInt(String(U.loose),10):null},i(U)}catch(I){console.error("Failed to fetch drug:",I),d(I.message||"Failed to load drug data. Please try again.")}finally{o(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const I=L=>{L.key==="Tab"&&v.current===document.activeElement&&(p||(g(!0),setTimeout(()=>{var F;(F=S.current)==null||F.focus()},0),L.preventDefault()))},U=L=>{b.current&&!b.current.contains(L.target)&&g(!1)};return document.addEventListener("keydown",I),document.addEventListener("mousedown",U),()=>{document.removeEventListener("keydown",I),document.removeEventListener("mousedown",U)}},[p]);const T=I=>{const{name:U,value:L,type:F}=I.target;i(z=>z?{...z,[U]:F==="number"?parseFloat(L)||null:L}:null)},P=()=>{n(-1)},M=async I=>{if(I.preventDefault(),d(null),u(!0),!t||!t.id){d("Cannot edit drug: No drug data available."),u(!1);return}if(t.price===void 0||t.quantity_in_stock===void 0){d("Price and Stock Quantity are required."),u(!1);return}const U={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,buying_price:t.buying_price===0?null:t.buying_price,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const L=await pe(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(!L.ok){const z=await L.json();throw new Error(z.message||`Failed to update drug: ${L.statusText}`)}const F=await L.json();alert(`Drug "${F.name}" updated successfully!`),n(-1)}catch(L){console.error("Failed to update drug:",L),d(L.message||"Failed to update drug. Please try again.")}finally{u(!1)}};return a?r.jsx("div",{className:"edit-drug-form-page",children:r.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?r.jsx("div",{className:"edit-drug-form-page",children:r.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?r.jsx("div",{className:"edit-drug-form-page",children:r.jsxs("div",{className:"edit-drug-form-container",children:[r.jsxs("div",{className:"edit-drug-form-header",children:[r.jsxs("h2",{children:["Edit Drug: ",t.name]}),r.jsx("button",{onClick:P,className:"cancel-button",title:"Go Back",children:r.jsx(ni,{size:24})})]}),l&&r.jsx("div",{className:"error-message-submit",children:l}),r.jsxs("form",{onSubmit:M,className:"edit-drug-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"sm-col-span-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Jo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),r.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),r.jsxs("div",{className:"sm-col-span-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Jo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),r.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"edit-price",className:"form-label",children:"MRP () *"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Jo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),r.jsx("input",{type:"number",name:"price",id:"edit-price",required:!0,step:"0.01",min:"0",value:t.price,onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"edit-quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Jo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),r.jsx("input",{type:"number",name:"quantity_in_stock",id:"edit-quantity_in_stock",required:!0,step:"1",min:"0",value:t.quantity_in_stock,onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),r.jsx("input",{type:"text",name:"unit",id:"edit-unit",value:t.unit||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),r.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),r.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),r.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[r.jsx("button",{type:"button",onClick:()=>g(!p),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),p&&r.jsxs("div",{className:"others-fields-grid",children:[" ",r.jsxs("div",{className:"sm-col-span-2",children:[r.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),r.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),r.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-buying_price",className:"form-label",children:"Rate ()"}),r.jsx("input",{type:"number",name:"buying_price",id:"edit-buying_price",step:"0.01",min:"0",value:t.buying_price??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),r.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),r.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),r.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),r.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),r.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),r.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),r.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",onClick:P,disabled:f,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),r.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button",tabIndex:20,children:f?"Saving...":"Save Changes"})]})]})]})}):r.jsx("div",{className:"edit-drug-form-page",children:r.jsx("div",{className:"not-found-message",children:"Drug not found."})})},a2=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[i,a]=w.useState({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),f(!1),p(!1))},[e]),w.useEffect(()=>{const T=M=>{M.key==="Tab"&&b.current===document.activeElement&&(u||(p(!0),setTimeout(()=>{var I;(I=v.current)==null||I.focus()},0),M.preventDefault()))},P=M=>{g.current&&!g.current.contains(M.target)&&p(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",P),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",P)}},[u]);const S=T=>{const{name:P,value:M,type:I}=T.target;a(U=>({...U,[P]:I==="number"?parseFloat(M)||null:M}))},k=T=>{if(T.preventDefault(),l(null),f(!0),i.price===void 0||i.quantity_in_stock===void 0){l("MRP and Stock Quantity are required."),f(!1);return}const P={...i,name:i.name===""?null:i.name,composition:i.composition===""?null:i.composition,buying_price:i.buying_price===0?null:i.buying_price,expiry_date:i.expiry_date===""?null:i.expiry_date,gst:i.gst===0?null:i.gst,margin:i.margin===0?null:i.margin,discount:i.discount===0?null:i.discount,brand_name:i.brand_name===""?null:i.brand_name,batch:i.batch===""?null:i.batch,hsn_code:i.hsn_code===""?null:i.hsn_code,mfg:i.mfg===""?null:i.mfg,loose:i.loose===0?null:i.loose};t(P),f(!1),n()};return e?r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[r.jsxs("div",{className:"add-drug-form-header",children:[r.jsx("h2",{children:"Add New Drug"}),r.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:r.jsx(ni,{size:24})})]}),o&&r.jsx("div",{className:"error-message",children:o}),r.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"sm-col-span-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Jo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),r.jsx("input",{type:"text",name:"name",id:"name",value:i.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),r.jsxs("div",{className:"sm-col-span-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Jo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),r.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:i.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"price",className:"form-label",children:"MRP () *"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Jo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),r.jsx("input",{type:"number",name:"price",id:"price",required:!0,step:"0.01",min:"0",value:i.price,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Jo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),r.jsx("input",{type:"number",name:"quantity_in_stock",id:"quantity_in_stock",required:!0,step:"1",min:"0",value:i.quantity_in_stock,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),r.jsx("input",{type:"text",name:"unit",id:"unit",value:i.unit||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),r.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:i.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),r.jsx("input",{type:"text",name:"box_number",id:"box_number",value:i.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),r.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[r.jsx("button",{type:"button",onClick:()=>p(!u),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),u&&r.jsxs("div",{className:"others-fields-grid",children:[" ",r.jsxs("div",{className:"sm-col-span-2",children:[r.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),r.jsx("textarea",{name:"description",id:"description",rows:3,value:i.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"buying_price",className:"form-label",children:"Rate ()"}),r.jsx("input",{type:"number",name:"buying_price",id:"buying_price",step:"0.01",min:"0",value:i.buying_price??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),r.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:i.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),r.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:i.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),r.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:i.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),r.jsx("input",{type:"text",name:"batch",id:"batch",value:i.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),r.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:i.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),r.jsx("input",{type:"text",name:"mfg",id:"mfg",value:i.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),r.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:i.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",onClick:n,disabled:d,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:d,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:d?"Adding...":"Add Drug"})]})]})]})}):null},vq=()=>{const e=kt(),n=async t=>{try{const i=await pe("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok){const a=await i.json();throw new Error(a.message||"Failed to add drug")}e(-1)}catch(i){console.error("Error adding drug:",i),alert(`Failed to add drug: ${i.message}`)}};return r.jsx("div",{className:"add-drug-page-wrapper",style:{paddingTop:"2rem"},children:r.jsx(a2,{isOpen:!0,onClose:()=>e(-1),onDrugAddedToPurchase:n})})},C1=()=>{const e=kt(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),[u,p]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,T]=w.useState(!1),[P,M]=w.useState([]),[I,U]=w.useState(!0);w.useEffect(()=>{(async()=>{U(!0);try{const V=await pe("/api/staff?role=doctor");if(!V.ok)throw new Error("Failed to fetch doctors");const Y=await V.json();M(Y),Y.length>0&&t(ie=>({...ie,doctorId:""}))}catch(V){console.error("Error fetching doctors:",V),l(`Failed to load doctors: ${V.message}`)}finally{U(!1)}})()},[]);const L=w.useCallback(async()=>{if(u.trim()){T(!0),l(null),b([]);try{const R=encodeURIComponent(u.trim()),V=await pe(`/api/patients?search=${R}&limit=10`);if(!V.ok){const ie=await V.json().catch(()=>({message:"Failed to search patients"}));throw new Error(ie.message||"Failed to search patients")}const Y=await V.json();Y&&Array.isArray(Y.patients)?b(Y.patients):(console.error("Unexpected response format from patient search:",Y),b([]))}catch(R){console.error("Error searching patients:",R),l(`Search failed: ${R.message}`)}finally{T(!1)}}},[u]);w.useEffect(()=>{if(u.trim().length<2){b([]),l(null);return}const R=setTimeout(()=>{L()},300);return()=>clearTimeout(R)},[u,L]);const F=R=>{S(R),p(""),b([]),l(null),t(V=>({...V,name:"",age:"",gender:"",phone:""}))},z=()=>{S(null),p(""),b([]),l(null),t(R=>({...R,name:"",age:"",gender:"",phone:""}))},$=R=>{const{name:V,value:Y}=R.target;t(ie=>({...ie,[V]:Y}))},B=async R=>{var V;R.preventDefault(),l(null),f(null),a(!0);try{let Y,ie;if(v)Y=v.id,ie=v.name,console.log(`Adding existing patient ${Y} to queue.`);else{console.log("Registering new patient...");const Q=await pe("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!Q.ok){const fe=await Q.json();if(Q.status===403&&fe.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:fe.message}});return}throw new Error(fe.message||"Failed to register patient")}const J=await Q.json();Y=J.id,ie=J.name,console.log(`New patient ${Y} registered.`)}const te=n.doctorId||null;console.log(`Adding patient ${Y} to queue for doctor ${te||"Unassigned"}`);const W=await pe("/api/queue",{method:"POST",body:JSON.stringify({patientId:Y,complaint:n.complaint||null,doctorId:te})});if(!W.ok){const Q=await W.json();throw new Error(Q.message||"Failed to add patient to queue")}const H=await W.json();if(console.log(`Patient added to queue, entry ID: ${H.id}`),S(null),p(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),te){const Q=((V=P.find(fe=>fe.id===te))==null?void 0:V.name)||"Selected Doctor",J=v?`Existing patient "${ie}" added to queue for Dr. ${Q}. Redirecting to billing...`:`Patient "${ie}" registered and added to queue for Dr. ${Q}. Redirecting to billing...`;f(J),e("/billing",{state:{patientId:Y,queueId:H.id,patientName:ie,doctorId:te,billType:"consultation"}})}else{const Q=v?`Existing patient "${ie}" added to the general queue.`:`Patient "${ie}" registered and added to the general queue.`;f(Q)}}catch(Y){console.error("Error in add/queue process:",Y),Y.message.includes("Patient limit")?(l(`Operation failed: ${Y.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${Y.message}`)}finally{a(!1)}};return r.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[r.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",r.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[r.jsx(nn,{size:20,className:"btn-icon"})," Back"]})]}),r.jsxs("div",{className:"add-patient-card",children:[r.jsxs("h3",{className:"add-patient-title",children:[r.jsx(lk,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),r.jsxs("div",{className:"search-section",children:[r.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",r.jsxs("div",{className:"flex items-center space-x-2",children:[" ",r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:u,onChange:R=>p(R.target.value),className:"form-input",disabled:i||!!v}),r.jsx(us,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&r.jsxs("button",{type:"button",onClick:z,className:"btn btn-danger",title:"Clear Selection",children:[r.jsx(ni,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&r.jsx("ul",{className:"search-results-list",children:g.map(R=>r.jsxs("li",{onClick:()=>F(R),children:[R.name," (ID: ",R.id,", Phone: ",R.phone||"N/A",")"]},R.id))}),u.length>=2&&g.length===0&&!k&&!v&&r.jsxs("p",{className:"search-info-text",children:['No patients found matching "',u,'". You can register them below.']}),k&&u.length>=2&&r.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),o&&r.jsxs("div",{className:"alert alert-danger",role:"alert",children:[r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:o})]}),d&&r.jsxs("div",{className:"alert alert-success",role:"alert",children:[r.jsx("strong",{children:"Success: "}),r.jsx("span",{children:d})]}),r.jsxs("form",{onSubmit:B,className:"space-y-5",children:[" ",r.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[r.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),r.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Full Name *"}),r.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:$,className:"form-input",required:!v,disabled:i||!!v})]}),r.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Age"}),r.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:$,className:"form-input",min:"0",disabled:i||!!v})]}),r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Gender"}),r.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:$,className:"form-select",disabled:i||!!v,children:[r.jsx("option",{value:"",children:"Select"}),r.jsx("option",{value:"M",children:"Male"}),r.jsx("option",{value:"F",children:"Female"}),r.jsx("option",{value:"O",children:"Other"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Phone"}),r.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:$,className:"form-input",disabled:i||!!v})]})]})]}),r.jsxs("fieldset",{className:"form-fieldset",children:[r.jsx("legend",{children:"Visit Details"}),r.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),r.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:$,className:`form-select ${I?"opacity-50":""}`,disabled:i||I,children:[r.jsx("option",{value:"",children:I?"Loading doctors...":P.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),P.map(R=>r.jsx("option",{value:R.id,children:R.name},R.id))]}),P.length===0&&!I&&r.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),r.jsxs("div",{className:"form-grid-col-span-2",children:[" ",r.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),r.jsx("textarea",{name:"complaint",value:n.complaint,onChange:$,rows:2,className:"form-textarea",disabled:i})]})]})]}),r.jsxs("div",{className:"flex justify-end pt-2",children:[" ",r.jsxs("button",{type:"submit",className:`btn btn-primary ${i||I?"disabled":""}`,disabled:i||I,children:[r.jsx(aw,{size:18,className:"btn-icon"}),i?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})]})},wq=({clinicId:e})=>{const n=kt(),[t,i]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,o]=w.useState(null),[l,d]=w.useState(!1);w.useEffect(()=>{o(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const f=g=>{const{name:b,value:v}=g.target;i(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},u=async g=>{if(g.preventDefault(),o(null),!t.name||!t.email||!t.role||!t.password){o("Name, Email, Role, and Password are required.");return}if(!e){o("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){o("Invalid OPD Fee format. Please enter a number.");return}d(!0);try{const v=await pe("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){o(`Failed to add staff: ${v.message}`)}finally{d(!1)}},p=()=>{n(-1)};return r.jsxs("div",{className:"staff-page-container",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("button",{onClick:p,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[r.jsx(nn,{size:18,className:"mr-2"}),"Back"]}),r.jsx("h1",{children:"Add New Staff Member"}),r.jsx("div",{className:"w-16"})," "]}),a&&r.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[r.jsx(Ki,{size:18,className:"mr-2 text-red-500"}),a]}),r.jsxs("form",{onSubmit:u,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Full Name"}),r.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter full name"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email Address"}),r.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter email address"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"role",children:"Assign Role"}),r.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:f,required:!0,disabled:l||!e,children:[r.jsx("option",{value:"receptionist",children:"Receptionist"}),r.jsx("option",{value:"doctor",children:"Doctor"}),r.jsx("option",{value:"pharmacy",children:"Pharmacist"}),r.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),r.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),r.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:f,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:l||!e}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),r.jsxs("button",{type:"submit",disabled:l||!e,children:[l?r.jsx(Ih,{size:18,className:"animate-spin mr-2"}):r.jsx(Zc,{size:18,className:"mr-2"}),l?"Adding...":"Add Staff Member"]})]})]})},Sq=()=>{const{id:e}=Qr(),n=kt(),[t,i]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,o]=w.useState(""),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),d(!1);return}d(!0),g(null),v(null);try{const M=await pe(`/staff/${e}`);if(!M.ok){const U=await M.json();throw new Error(U.message||`HTTP error! status: ${M.status}`)}const I=await M.json();i({name:I.name,email:I.email,role:I.role,opd_fee:I.opd_fee??"",active:I.active})}catch(M){g(`Failed to load staff details: ${M.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=M=>{const{name:I,value:U,type:L}=M.target;if(L==="checkbox"){const{checked:F}=M.target;i(z=>({...z,[I]:F}))}else i(F=>({...F,[I]:U}))},T=M=>{o(M.target.value)},P=async M=>{if(M.preventDefault(),!e){g("Staff ID is missing.");return}u(!0),g(null),v(null);const I={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const U=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(U!==null&&isNaN(U)){g("OPD Fee must be a valid number."),u(!1);return}I.opd_fee=U}else I.opd_fee=null;a.trim()!==""&&(I.password=a.trim());try{const U=await pe(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!U.ok){const L=await U.json();throw new Error(L.message||`HTTP error! status: ${U.status}`)}v("Staff details updated successfully!"),o(""),setTimeout(()=>n(-1),1500)}catch(U){g(`Failed to update staff: ${U.message}`)}finally{u(!1)}};return l?r.jsxs("div",{className:"flex justify-center items-center h-screen",children:[r.jsx(Ih,{className:"h-12 w-12 animate-spin text-teal-600"}),r.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):r.jsxs("div",{className:"staff-page-container",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[r.jsx(nn,{size:18,className:"mr-2"}),"Back"]}),r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),r.jsx("div",{className:"w-16"})," "]}),p&&r.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[r.jsx(Ki,{size:18,className:"mr-2 text-red-500"}),p,r.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&r.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[r.jsx(fs,{size:18,className:"mr-2 text-green-500"}),b,r.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),r.jsxs("form",{onSubmit:P,className:"staff-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Full Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"email",children:["Email Address ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"role",children:["Role ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[r.jsx("option",{value:"doctor",children:"Doctor"}),r.jsx("option",{value:"receptionist",children:"Receptionist"}),r.jsx("option",{value:"lab",children:"Lab Technician"}),r.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),r.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),r.jsxs("div",{className:"form-group checkbox-group",children:[r.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),r.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),r.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),r.jsx("button",{type:"submit",disabled:f,children:f?r.jsxs(r.Fragment,{children:[r.jsx(Ih,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Fd,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})};function Nq(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const Cq=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,jq=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,_q={};function KC(e,n){return(_q.jsx?jq:Cq).test(e)}const kq=/[ \t\n\f\r]/g;function Tq(e){return typeof e=="object"?e.type==="text"?XC(e.value):!1:XC(e)}function XC(e){return e.replace(kq,"")===""}let cg=class{constructor(n,t,i){this.normal=t,this.property=n,i&&(this.space=i)}};cg.prototype.normal={};cg.prototype.property={};cg.prototype.space=void 0;function s2(e,n){const t={},i={};for(const a of e)Object.assign(t,a.property),Object.assign(i,a.normal);return new cg(t,i,n)}function j1(e){return e.toLowerCase()}let pa=class{constructor(n,t){this.attribute=t,this.property=n}};pa.prototype.attribute="";pa.prototype.booleanish=!1;pa.prototype.boolean=!1;pa.prototype.commaOrSpaceSeparated=!1;pa.prototype.commaSeparated=!1;pa.prototype.defined=!1;pa.prototype.mustUseProperty=!1;pa.prototype.number=!1;pa.prototype.overloadedBoolean=!1;pa.prototype.property="";pa.prototype.spaceSeparated=!1;pa.prototype.space=void 0;let Eq=0;const Gt=Vd(),Ri=Vd(),o2=Vd(),at=Vd(),ei=Vd(),Th=Vd(),Ra=Vd();function Vd(){return 2**++Eq}const _1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Gt,booleanish:Ri,commaOrSpaceSeparated:Ra,commaSeparated:Th,number:at,overloadedBoolean:o2,spaceSeparated:ei},Symbol.toStringTag,{value:"Module"})),p0=Object.keys(_1);let jw=class extends pa{constructor(n,t,i,a){let o=-1;if(super(n,t),ZC(this,"space",a),typeof i=="number")for(;++o<p0.length;){const l=p0[o];ZC(this,p0[o],(i&_1[l])===_1[l])}}};jw.prototype.defined=!0;function ZC(e,n,t){t&&(e[n]=t)}function Gh(e){const n={},t={};for(const[i,a]of Object.entries(e.properties)){const o=new jw(i,e.transform(e.attributes||{},i),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),n[i]=o,t[j1(i)]=i,t[j1(o.attribute)]=i}return new cg(n,t,e.space)}const l2=Gh({properties:{ariaActiveDescendant:null,ariaAtomic:Ri,ariaAutoComplete:null,ariaBusy:Ri,ariaChecked:Ri,ariaColCount:at,ariaColIndex:at,ariaColSpan:at,ariaControls:ei,ariaCurrent:null,ariaDescribedBy:ei,ariaDetails:null,ariaDisabled:Ri,ariaDropEffect:ei,ariaErrorMessage:null,ariaExpanded:Ri,ariaFlowTo:ei,ariaGrabbed:Ri,ariaHasPopup:null,ariaHidden:Ri,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ei,ariaLevel:at,ariaLive:null,ariaModal:Ri,ariaMultiLine:Ri,ariaMultiSelectable:Ri,ariaOrientation:null,ariaOwns:ei,ariaPlaceholder:null,ariaPosInSet:at,ariaPressed:Ri,ariaReadOnly:Ri,ariaRelevant:null,ariaRequired:Ri,ariaRoleDescription:ei,ariaRowCount:at,ariaRowIndex:at,ariaRowSpan:at,ariaSelected:Ri,ariaSetSize:at,ariaSort:null,ariaValueMax:at,ariaValueMin:at,ariaValueNow:at,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function c2(e,n){return n in e?e[n]:n}function u2(e,n){return c2(e,n.toLowerCase())}const Aq=Gh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Th,acceptCharset:ei,accessKey:ei,action:null,allow:null,allowFullScreen:Gt,allowPaymentRequest:Gt,allowUserMedia:Gt,alt:null,as:null,async:Gt,autoCapitalize:null,autoComplete:ei,autoFocus:Gt,autoPlay:Gt,blocking:ei,capture:null,charSet:null,checked:Gt,cite:null,className:ei,cols:at,colSpan:null,content:null,contentEditable:Ri,controls:Gt,controlsList:ei,coords:at|Th,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Gt,defer:Gt,dir:null,dirName:null,disabled:Gt,download:o2,draggable:Ri,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Gt,formTarget:null,headers:ei,height:at,hidden:Gt,high:at,href:null,hrefLang:null,htmlFor:ei,httpEquiv:ei,id:null,imageSizes:null,imageSrcSet:null,inert:Gt,inputMode:null,integrity:null,is:null,isMap:Gt,itemId:null,itemProp:ei,itemRef:ei,itemScope:Gt,itemType:ei,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Gt,low:at,manifest:null,max:null,maxLength:at,media:null,method:null,min:null,minLength:at,multiple:Gt,muted:Gt,name:null,nonce:null,noModule:Gt,noValidate:Gt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Gt,optimum:at,pattern:null,ping:ei,placeholder:null,playsInline:Gt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Gt,referrerPolicy:null,rel:ei,required:Gt,reversed:Gt,rows:at,rowSpan:at,sandbox:ei,scope:null,scoped:Gt,seamless:Gt,selected:Gt,shadowRootClonable:Gt,shadowRootDelegatesFocus:Gt,shadowRootMode:null,shape:null,size:at,sizes:null,slot:null,span:at,spellCheck:Ri,src:null,srcDoc:null,srcLang:null,srcSet:null,start:at,step:null,style:null,tabIndex:at,target:null,title:null,translate:null,type:null,typeMustMatch:Gt,useMap:null,value:Ri,width:at,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ei,axis:null,background:null,bgColor:null,border:at,borderColor:null,bottomMargin:at,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Gt,declare:Gt,event:null,face:null,frame:null,frameBorder:null,hSpace:at,leftMargin:at,link:null,longDesc:null,lowSrc:null,marginHeight:at,marginWidth:at,noResize:Gt,noHref:Gt,noShade:Gt,noWrap:Gt,object:null,profile:null,prompt:null,rev:null,rightMargin:at,rules:null,scheme:null,scrolling:Ri,standby:null,summary:null,text:null,topMargin:at,valueType:null,version:null,vAlign:null,vLink:null,vSpace:at,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Gt,disableRemotePlayback:Gt,prefix:null,property:null,results:at,security:null,unselectable:null},space:"html",transform:u2}),Pq=Gh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ra,accentHeight:at,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:at,amplitude:at,arabicForm:null,ascent:at,attributeName:null,attributeType:null,azimuth:at,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:at,by:null,calcMode:null,capHeight:at,className:ei,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:at,diffuseConstant:at,direction:null,display:null,dur:null,divisor:at,dominantBaseline:null,download:Gt,dx:null,dy:null,edgeMode:null,editable:null,elevation:at,enableBackground:null,end:null,event:null,exponent:at,externalResourcesRequired:null,fill:null,fillOpacity:at,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Th,g2:Th,glyphName:Th,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:at,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:at,horizOriginX:at,horizOriginY:at,id:null,ideographic:at,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:at,k:at,k1:at,k2:at,k3:at,k4:at,kernelMatrix:Ra,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:at,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:at,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:at,overlineThickness:at,paintOrder:null,panose1:null,path:null,pathLength:at,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ei,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:at,pointsAtY:at,pointsAtZ:at,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ra,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ra,rev:Ra,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ra,requiredFeatures:Ra,requiredFonts:Ra,requiredFormats:Ra,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:at,specularExponent:at,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:at,strikethroughThickness:at,string:null,stroke:null,strokeDashArray:Ra,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:at,strokeOpacity:at,strokeWidth:null,style:null,surfaceScale:at,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ra,tabIndex:at,tableValues:null,target:null,targetX:at,targetY:at,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ra,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:at,underlineThickness:at,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:at,values:null,vAlphabetic:at,vMathematical:at,vectorEffect:null,vHanging:at,vIdeographic:at,version:null,vertAdvY:at,vertOriginX:at,vertOriginY:at,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:at,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:c2}),d2=Gh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),f2=Gh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:u2}),h2=Gh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),Dq={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},Iq=/[A-Z]/g,ej=/-[a-z]/g,Rq=/^data[-\w.:]+$/i;function Mq(e,n){const t=j1(n);let i=n,a=pa;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&Rq.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(ej,Lq);i="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!ej.test(o)){let l=o.replace(Iq,Oq);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=jw}return new a(i,n)}function Oq(e){return"-"+e.toLowerCase()}function Lq(e){return e.charAt(1).toUpperCase()}const Fq=s2([l2,Aq,d2,f2,h2],"html"),_w=s2([l2,Pq,d2,f2,h2],"svg");function $q(e){return e.join(" ").trim()}var xh={},m0,tj;function zq(){if(tj)return m0;tj=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,i=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,d=/^\s+|\s+$/g,f=`
`,u="/",p="*",g="",b="comment",v="declaration";m0=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var P=1,M=1;function I(ie){var te=ie.match(n);te&&(P+=te.length);var W=ie.lastIndexOf(f);M=~W?ie.length-W:M+ie.length}function U(){var ie={line:P,column:M};return function(te){return te.position=new L(ie),$(),te}}function L(ie){this.start=ie,this.end={line:P,column:M},this.source=T.source}L.prototype.content=k;function F(ie){var te=new Error(T.source+":"+P+":"+M+": "+ie);if(te.reason=ie,te.filename=T.source,te.line=P,te.column=M,te.source=k,!T.silent)throw te}function z(ie){var te=ie.exec(k);if(te){var W=te[0];return I(W),k=k.slice(W.length),te}}function $(){z(t)}function B(ie){var te;for(ie=ie||[];te=R();)te!==!1&&ie.push(te);return ie}function R(){var ie=U();if(!(u!=k.charAt(0)||p!=k.charAt(1))){for(var te=2;g!=k.charAt(te)&&(p!=k.charAt(te)||u!=k.charAt(te+1));)++te;if(te+=2,g===k.charAt(te-1))return F("End of comment missing");var W=k.slice(2,te-2);return M+=2,I(W),k=k.slice(te),M+=2,ie({type:b,comment:W})}}function V(){var ie=U(),te=z(i);if(te){if(R(),!z(a))return F("property missing ':'");var W=z(o),H=ie({type:v,property:S(te[0].replace(e,g)),value:W?S(W[0].replace(e,g)):g});return z(l),H}}function Y(){var ie=[];B(ie);for(var te;te=V();)te!==!1&&(ie.push(te),B(ie));return ie}return $(),Y()};function S(k){return k?k.replace(d,g):g}return m0}var nj;function Uq(){if(nj)return xh;nj=1;var e=xh&&xh.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(xh,"__esModule",{value:!0}),xh.default=t;var n=e(zq());function t(i,a){var o=null;if(!i||typeof i!="string")return o;var l=(0,n.default)(i),d=typeof a=="function";return l.forEach(function(f){if(f.type==="declaration"){var u=f.property,p=f.value;d?a(u,p,f):p&&(o=o||{},o[u]=p)}}),o}return xh}var Em={},ij;function Bq(){if(ij)return Em;ij=1,Object.defineProperty(Em,"__esModule",{value:!0}),Em.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,i=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,o=function(u){return!u||t.test(u)||e.test(u)},l=function(u,p){return p.toUpperCase()},d=function(u,p){return"".concat(p,"-")},f=function(u,p){return p===void 0&&(p={}),o(u)?u:(u=u.toLowerCase(),p.reactCompat?u=u.replace(a,d):u=u.replace(i,d),u.replace(n,l))};return Em.camelCase=f,Em}var Am,rj;function qq(){if(rj)return Am;rj=1;var e=Am&&Am.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(Uq()),t=Bq();function i(a,o){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(d,f){d&&f&&(l[(0,t.camelCase)(d,o)]=f)}),l}return i.default=i,Am=i,Am}var Vq=qq();const Hq=qd(Vq),p2=m2("end"),kw=m2("start");function m2(e){return n;function n(t){const i=t&&t.position&&t.position[e]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function Gq(e){const n=kw(e),t=p2(e);if(n&&t)return{start:n,end:t}}function $m(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?aj(e.position):"start"in e||"end"in e?aj(e):"line"in e||"column"in e?k1(e):""}function k1(e){return sj(e&&e.line)+":"+sj(e&&e.column)}function aj(e){return k1(e&&e.start)+"-"+k1(e&&e.end)}function sj(e){return e&&typeof e=="number"?e:1}let Rr=class extends Error{constructor(n,t,i){super(),typeof t=="string"&&(i=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof i=="string"){const f=i.indexOf(":");f===-1?o.ruleId=i:(o.source=i.slice(0,f),o.ruleId=i.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=d?d.line:void 0,this.name=$m(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}};Rr.prototype.file="";Rr.prototype.name="";Rr.prototype.reason="";Rr.prototype.message="";Rr.prototype.stack="";Rr.prototype.column=void 0;Rr.prototype.line=void 0;Rr.prototype.ancestors=void 0;Rr.prototype.cause=void 0;Rr.prototype.fatal=void 0;Rr.prototype.place=void 0;Rr.prototype.ruleId=void 0;Rr.prototype.source=void 0;const Tw={}.hasOwnProperty,Yq=new Map,Wq=/[A-Z]/g,Qq=new Set(["table","tbody","thead","tfoot","tr"]),Jq=new Set(["td","th"]),g2="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Kq(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let i;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=a9(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=r9(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:i,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?_w:Fq,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=y2(a,e,void 0);return o&&typeof o!="string"?o:a.create(e,a.Fragment,{children:o||void 0},void 0)}function y2(e,n,t){if(n.type==="element")return Xq(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return Zq(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return t9(e,n,t);if(n.type==="mdxjsEsm")return e9(e,n);if(n.type==="root")return n9(e,n,t);if(n.type==="text")return i9(e,n)}function Xq(e,n,t){const i=e.schema;let a=i;n.tagName.toLowerCase()==="svg"&&i.space==="html"&&(a=_w,e.schema=a),e.ancestors.push(n);const o=b2(e,n.tagName,!1),l=s9(e,n);let d=Aw(e,n);return Qq.has(n.tagName)&&(d=d.filter(function(f){return typeof f=="string"?!Tq(f):!0})),x2(e,l,o,n),Ew(l,d),e.ancestors.pop(),e.schema=i,e.create(n,o,l,t)}function Zq(e,n){if(n.data&&n.data.estree&&e.evaluater){const i=n.data.estree.body[0];return i.type,e.evaluater.evaluateExpression(i.expression)}Xm(e,n.position)}function e9(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);Xm(e,n.position)}function t9(e,n,t){const i=e.schema;let a=i;n.name==="svg"&&i.space==="html"&&(a=_w,e.schema=a),e.ancestors.push(n);const o=n.name===null?e.Fragment:b2(e,n.name,!0),l=o9(e,n),d=Aw(e,n);return x2(e,l,o,n),Ew(l,d),e.ancestors.pop(),e.schema=i,e.create(n,o,l,t)}function n9(e,n,t){const i={};return Ew(i,Aw(e,n)),e.create(n,e.Fragment,i,t)}function i9(e,n){return n.value}function x2(e,n,t,i){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=i)}function Ew(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function r9(e,n,t){return i;function i(a,o,l,d){const u=Array.isArray(l.children)?t:n;return d?u(o,l,d):u(o,l)}}function a9(e,n){return t;function t(i,a,o,l){const d=Array.isArray(o.children),f=kw(i);return n(a,o,l,d,{columnNumber:f?f.column-1:void 0,fileName:e,lineNumber:f?f.line:void 0},void 0)}}function s9(e,n){const t={};let i,a;for(a in n.properties)if(a!=="children"&&Tw.call(n.properties,a)){const o=l9(e,a,n.properties[a]);if(o){const[l,d]=o;e.tableCellAlignToStyle&&l==="align"&&typeof d=="string"&&Jq.has(n.tagName)?i=d:t[l]=d}}if(i){const o=t.style||(t.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return t}function o9(e,n){const t={};for(const i of n.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&e.evaluater){const o=i.data.estree.body[0];o.type;const l=o.expression;l.type;const d=l.properties[0];d.type,Object.assign(t,e.evaluater.evaluateExpression(d.argument))}else Xm(e,n.position);else{const a=i.name;let o;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&e.evaluater){const d=i.value.data.estree.body[0];d.type,o=e.evaluater.evaluateExpression(d.expression)}else Xm(e,n.position);else o=i.value===null?!0:i.value;t[a]=o}return t}function Aw(e,n){const t=[];let i=-1;const a=e.passKeys?new Map:Yq;for(;++i<n.children.length;){const o=n.children[i];let l;if(e.passKeys){const f=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(f){const u=a.get(f)||0;l=f+"-"+u,a.set(f,u+1)}}const d=y2(e,o,l);d!==void 0&&t.push(d)}return t}function l9(e,n,t){const i=Mq(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=i.commaSeparated?Nq(t):$q(t)),i.property==="style"){let a=typeof t=="object"?t:c9(e,String(t));return e.stylePropertyNameCase==="css"&&(a=u9(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&i.space?Dq[i.property]||i.property:i.attribute,t]}}function c9(e,n){try{return Hq(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const i=t,a=new Rr("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=g2+"#cannot-parse-style-attribute",a}}function b2(e,n,t){let i;if(!t)i={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let o=-1,l;for(;++o<a.length;){const d=KC(a[o])?{type:"Identifier",name:a[o]}:{type:"Literal",value:a[o]};l=l?{type:"MemberExpression",object:l,property:d,computed:!!(o&&d.type==="Literal"),optional:!1}:d}i=l}else i=KC(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(i.type==="Literal"){const a=i.value;return Tw.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(i);Xm(e)}function Xm(e,n){const t=new Rr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=g2+"#cannot-handle-mdx-estrees-without-createevaluater",t}function u9(e){const n={};let t;for(t in e)Tw.call(e,t)&&(n[d9(t)]=e[t]);return n}function d9(e){let n=e.replace(Wq,f9);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function f9(e){return"-"+e.toLowerCase()}const g0={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},h9={};function Pw(e,n){const t=h9,i=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return v2(e,i,a)}function v2(e,n,t){if(p9(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return oj(e.children,n,t)}return Array.isArray(e)?oj(e,n,t):""}function oj(e,n,t){const i=[];let a=-1;for(;++a<e.length;)i[a]=v2(e[a],n,t);return i.join("")}function p9(e){return!!(e&&typeof e=="object")}const lj=document.createElement("i");function Dw(e){const n="&"+e+";";lj.innerHTML=n;const t=lj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function $a(e,n,t,i){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,i.length<1e4)l=Array.from(i),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<i.length;)l=i.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function os(e,n){return e.length>0?($a(e,e.length,0,n),e):n}const cj={}.hasOwnProperty;function w2(e){const n={};let t=-1;for(;++t<e.length;)m9(n,e[t]);return n}function m9(e,n){let t;for(t in n){const a=(cj.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){cj.call(a,l)||(a[l]=[]);const d=o[l];g9(a[l],Array.isArray(d)?d:d?[d]:[])}}}function g9(e,n){let t=-1;const i=[];for(;++t<n.length;)(n[t].add==="after"?e:i).push(n[t]);$a(e,0,0,i)}function S2(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Js(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Wr=lu(/[A-Za-z]/),Dr=lu(/[\dA-Za-z]/),y9=lu(/[#-'*+\--9=?A-Z^-~]/);function ub(e){return e!==null&&(e<32||e===127)}const T1=lu(/\d/),x9=lu(/[\dA-Fa-f]/),b9=lu(/[!-/:-@[-`{-~]/);function It(e){return e!==null&&e<-2}function Yn(e){return e!==null&&(e<0||e===32)}function fn(e){return e===-2||e===-1||e===32}const $b=lu(new RegExp("\\p{P}|\\p{S}","u")),Ud=lu(/\s/);function lu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Yh(e){const n=[];let t=-1,i=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Dr(e.charCodeAt(t+1))&&Dr(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(i,t),encodeURIComponent(l)),i=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(i)}function Sn(e,n,t,i){const a=i?i-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return fn(f)?(e.enter(t),d(f)):n(f)}function d(f){return fn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const v9={tokenize:w9};function w9(e){const n=e.attempt(this.parser.constructs.contentInitial,i,a);let t;return n;function i(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),Sn(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return It(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const S9={tokenize:N9},uj={tokenize:C9};function N9(e){const n=this,t=[];let i=0,a,o,l;return d;function d(I){if(i<t.length){const U=t[i];return n.containerState=U[1],e.attempt(U[0].continuation,f,u)(I)}return u(I)}function f(I){if(i++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const U=n.events.length;let L=U,F;for(;L--;)if(n.events[L][0]==="exit"&&n.events[L][1].type==="chunkFlow"){F=n.events[L][1].end;break}P(i);let z=U;for(;z<n.events.length;)n.events[z][1].end={...F},z++;return $a(n.events,L+1,0,n.events.slice(U)),n.events.length=z,u(I)}return d(I)}function u(I){if(i===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(uj,p,g)(I)}function p(I){return a&&M(),P(i),b(I)}function g(I){return n.parser.lazy[n.now().line]=i!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(uj,v,S)(I)}function v(I){return i++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&M(),P(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(I);return}return It(I)?(e.consume(I),T(e.exit("chunkFlow")),i=0,n.interrupt=void 0,d):(e.consume(I),k)}function T(I,U){const L=n.sliceStream(I);if(U&&L.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write(L),n.parser.lazy[I.start.line]){let F=a.events.length;for(;F--;)if(a.events[F][1].start.offset<l&&(!a.events[F][1].end||a.events[F][1].end.offset>l))return;const z=n.events.length;let $=z,B,R;for(;$--;)if(n.events[$][0]==="exit"&&n.events[$][1].type==="chunkFlow"){if(B){R=n.events[$][1].end;break}B=!0}for(P(i),F=z;F<n.events.length;)n.events[F][1].end={...R},F++;$a(n.events,$+1,0,n.events.slice(z)),n.events.length=F}}function P(I){let U=t.length;for(;U-- >I;){const L=t[U];n.containerState=L[1],L[0].exit.call(n,e)}t.length=I}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function C9(e,n,t){return Sn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Lh(e){if(e===null||Yn(e)||Ud(e))return 1;if($b(e))return 2}function zb(e,n,t){const i=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!i.includes(o)&&(n=o(n,t),i.push(o))}return n}const E1={name:"attention",resolveAll:j9,tokenize:_9};function j9(e,n){let t=-1,i,a,o,l,d,f,u,p;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(i=t;i--;)if(e[i][0]==="exit"&&e[i][1].type==="attentionSequence"&&e[i][1]._open&&n.sliceSerialize(e[i][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[i][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[i][1].end.offset-e[i][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[i][1].end.offset-e[i][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[i][1].end},b={...e[t][1].start};dj(g,-f),dj(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[i][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[i][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[i][1].end={...l.start},e[t][1].start={...d.end},u=[],e[i][1].end.offset-e[i][1].start.offset&&(u=os(u,[["enter",e[i][1],n],["exit",e[i][1],n]])),u=os(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=os(u,zb(n.parser.constructs.insideSpan.null,e.slice(i+1,t),n)),u=os(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(p=2,u=os(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):p=0,$a(e,i-1,t-i+3,u),t=i+u.length-p-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function _9(e,n){const t=this.parser.constructs.attentionMarkers.null,i=this.previous,a=Lh(i);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),p=Lh(f),g=!p||p===2&&a||t.includes(f),b=!a||a===2&&p||t.includes(i);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(p||!g)),n(f)}}function dj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const k9={name:"autolink",tokenize:T9};function T9(e,n,t){let i=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Wr(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Dr(v)?(i=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),i=0,f):(v===43||v===45||v===46||Dr(v))&&i++<32?(e.consume(v),d):(i=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||ub(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),p):y9(v)?(e.consume(v),u):t(v)}function p(v){return Dr(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),i=0,p):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Dr(v))&&i++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const ug={partial:!0,tokenize:E9};function E9(e,n,t){return i;function i(o){return fn(o)?Sn(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||It(o)?n(o):t(o)}}const N2={continuation:{tokenize:P9},exit:D9,name:"blockQuote",tokenize:A9};function A9(e,n,t){const i=this;return a;function a(l){if(l===62){const d=i.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return fn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function P9(e,n,t){const i=this;return a;function a(l){return fn(l)?Sn(e,o,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(N2,n,t)(l)}}function D9(e){e.exit("blockQuote")}const C2={name:"characterEscape",tokenize:I9};function I9(e,n,t){return i;function i(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return b9(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const j2={name:"characterReference",tokenize:R9};function R9(e,n,t){const i=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Dr,p(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=x9,p):(e.enter("characterReferenceValue"),o=7,l=T1,p(g))}function p(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Dr&&!Dw(i.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),p):t(g)}}const fj={partial:!0,tokenize:O9},hj={concrete:!0,name:"codeFenced",tokenize:M9};function M9(e,n,t){const i=this,a={partial:!0,tokenize:L};let o=0,l=0,d;return f;function f(F){return u(F)}function u(F){const z=i.events[i.events.length-1];return o=z&&z[1].type==="linePrefix"?z[2].sliceSerialize(z[1],!0).length:0,d=F,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p(F)}function p(F){return F===d?(l++,e.consume(F),p):l<3?t(F):(e.exit("codeFencedFenceSequence"),fn(F)?Sn(e,g,"whitespace")(F):g(F))}function g(F){return F===null||It(F)?(e.exit("codeFencedFence"),i.interrupt?n(F):e.check(fj,k,U)(F)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(F))}function b(F){return F===null||It(F)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(F)):fn(F)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Sn(e,v,"whitespace")(F)):F===96&&F===d?t(F):(e.consume(F),b)}function v(F){return F===null||It(F)?g(F):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(F))}function S(F){return F===null||It(F)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(F)):F===96&&F===d?t(F):(e.consume(F),S)}function k(F){return e.attempt(a,U,T)(F)}function T(F){return e.enter("lineEnding"),e.consume(F),e.exit("lineEnding"),P}function P(F){return o>0&&fn(F)?Sn(e,M,"linePrefix",o+1)(F):M(F)}function M(F){return F===null||It(F)?e.check(fj,k,U)(F):(e.enter("codeFlowValue"),I(F))}function I(F){return F===null||It(F)?(e.exit("codeFlowValue"),M(F)):(e.consume(F),I)}function U(F){return e.exit("codeFenced"),n(F)}function L(F,z,$){let B=0;return R;function R(W){return F.enter("lineEnding"),F.consume(W),F.exit("lineEnding"),V}function V(W){return F.enter("codeFencedFence"),fn(W)?Sn(F,Y,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):Y(W)}function Y(W){return W===d?(F.enter("codeFencedFenceSequence"),ie(W)):$(W)}function ie(W){return W===d?(B++,F.consume(W),ie):B>=l?(F.exit("codeFencedFenceSequence"),fn(W)?Sn(F,te,"whitespace")(W):te(W)):$(W)}function te(W){return W===null||It(W)?(F.exit("codeFencedFence"),z(W)):$(W)}}}function O9(e,n,t){const i=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return i.parser.lazy[i.now().line]?t(l):n(l)}}const y0={name:"codeIndented",tokenize:F9},L9={partial:!0,tokenize:$9};function F9(e,n,t){const i=this;return a;function a(u){return e.enter("codeIndented"),Sn(e,o,"linePrefix",5)(u)}function o(u){const p=i.events[i.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):It(u)?e.attempt(L9,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||It(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function $9(e,n,t){const i=this;return a;function a(l){return i.parser.lazy[i.now().line]?t(l):It(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):Sn(e,o,"linePrefix",5)(l)}function o(l){const d=i.events[i.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):It(l)?a(l):t(l)}}const z9={name:"codeText",previous:B9,resolve:U9,tokenize:q9};function U9(e){let n=e.length-4,t=3,i,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(i=t;++i<n;)if(e[i][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(i=t-1,n++;++i<=n;)a===void 0?i!==n&&e[i][1].type!=="lineEnding"&&(a=i):(i===n||e[i][1].type==="lineEnding")&&(e[a][1].type="codeTextData",i!==a+2&&(e[a][1].end=e[i-1][1].end,e.splice(a+2,i-a-2),n-=i-a-2,i=a+2),a=void 0);return e}function B9(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function q9(e,n,t){let i=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),i++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,p(g)):It(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||It(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function p(g){return g===96?(e.consume(g),a++,p):a===i?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}let V9=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const i=t??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(n,i):n>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(n,t,i){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return i&&Pm(this.left,i),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Pm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Pm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Pm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Pm(this.left,t.reverse())}}};function Pm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function _2(e){const n={};let t=-1,i,a,o,l,d,f,u;const p=new V9(e);for(;++t<p.length;){for(;t in n;)t=n[t];if(i=p.get(t),t&&i[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(f=i[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(i[0]==="enter")i[1].contentType&&(Object.assign(n,H9(p,t)),t=n[t],u=!0);else if(i[1]._container){for(o=t,a=void 0;o--;)if(l=p.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(i[1].end={...p.get(a)[1].start},d=p.slice(a,t),d.unshift(i),p.splice(a,t-a+1,d))}}return $a(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!u}function H9(e,n){const t=e.get(n)[1],i=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=i.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let p,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(p=i.sliceStream(v),v.next||p.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(p),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const G9={resolve:W9,tokenize:Q9},Y9={partial:!0,tokenize:J9};function W9(e){return _2(e),e}function Q9(e,n){let t;return i;function i(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):It(d)?e.check(Y9,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function J9(e,n,t){const i=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Sn(e,o,"linePrefix")}function o(l){if(l===null||It(l))return t(l);const d=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(i.parser.constructs.flow,t,n)(l)}}function k2(e,n,t,i,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let p=0;return g;function g(P){return P===60?(e.enter(i),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||ub(P)?t(P):(e.enter(i),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(i),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||It(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!p&&(P===null||P===41||Yn(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(i),n(P)):p<u&&P===40?(e.consume(P),p++,k):P===41?(e.consume(P),p--,k):P===null||P===32||P===40||ub(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function T2(e,n,t,i,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(i),e.enter(a),e.consume(v),e.exit(a),e.enter(o),p}function p(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(i),n):It(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||It(v)||d++>999?(e.exit("chunkString"),p(v)):(e.consume(v),f||(f=!fn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function E2(e,n,t,i,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(i),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(i),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):It(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),Sn(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===l||b===null||It(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:p)}function g(b){return b===l||b===92?(e.consume(b),p):p(b)}}function zm(e,n){let t;return i;function i(a){return It(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,i):fn(a)?Sn(e,i,t?"linePrefix":"lineSuffix")(a):n(a)}}const K9={name:"definition",tokenize:Z9},X9={partial:!0,tokenize:e7};function Z9(e,n,t){const i=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return T2.call(i,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=Js(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return Yn(v)?zm(e,u)(v):u(v)}function u(v){return k2(e,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function p(v){return e.attempt(X9,g,g)(v)}function g(v){return fn(v)?Sn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||It(v)?(e.exit("definition"),i.parser.defined.push(a),n(v)):t(v)}}function e7(e,n,t){return i;function i(d){return Yn(d)?zm(e,a)(d):t(d)}function a(d){return E2(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return fn(d)?Sn(e,l,"whitespace")(d):l(d)}function l(d){return d===null||It(d)?n(d):t(d)}}const t7={name:"hardBreakEscape",tokenize:n7};function n7(e,n,t){return i;function i(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return It(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const i7={name:"headingAtx",resolve:r7,tokenize:a7};function r7(e,n){let t=e.length-2,i=3,a,o;return e[i][1].type==="whitespace"&&(i+=2),t-2>i&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(i===t-1||t-4>i&&e[t-2][1].type==="whitespace")&&(t-=i+1===t?2:4),t>i&&(a={type:"atxHeadingText",start:e[i][1].start,end:e[t][1].end},o={type:"chunkText",start:e[i][1].start,end:e[t][1].end,contentType:"text"},$a(e,i,t-i+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function a7(e,n,t){let i=0;return a;function a(p){return e.enter("atxHeading"),o(p)}function o(p){return e.enter("atxHeadingSequence"),l(p)}function l(p){return p===35&&i++<6?(e.consume(p),l):p===null||Yn(p)?(e.exit("atxHeadingSequence"),d(p)):t(p)}function d(p){return p===35?(e.enter("atxHeadingSequence"),f(p)):p===null||It(p)?(e.exit("atxHeading"),n(p)):fn(p)?Sn(e,d,"whitespace")(p):(e.enter("atxHeadingText"),u(p))}function f(p){return p===35?(e.consume(p),f):(e.exit("atxHeadingSequence"),d(p))}function u(p){return p===null||p===35||Yn(p)?(e.exit("atxHeadingText"),d(p)):(e.consume(p),u)}}const s7=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],pj=["pre","script","style","textarea"],o7={concrete:!0,name:"htmlFlow",resolveTo:u7,tokenize:d7},l7={partial:!0,tokenize:h7},c7={partial:!0,tokenize:f7};function u7(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function d7(e,n,t){const i=this;let a,o,l,d,f;return u;function u(D){return p(D)}function p(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,i.interrupt?n:A):Wr(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):Wr(D)?(e.consume(D),a=4,i.interrupt?n:A):t(D)}function v(D){return D===45?(e.consume(D),i.interrupt?n:A):t(D)}function S(D){const se="CDATA[";return D===se.charCodeAt(d++)?(e.consume(D),d===se.length?i.interrupt?n:Y:S):t(D)}function k(D){return Wr(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||Yn(D)){const se=D===47,be=l.toLowerCase();return!se&&!o&&pj.includes(be)?(a=1,i.interrupt?n(D):Y(D)):s7.includes(l.toLowerCase())?(a=6,se?(e.consume(D),P):i.interrupt?n(D):Y(D)):(a=7,i.interrupt&&!i.parser.lazy[i.now().line]?t(D):o?M(D):I(D))}return D===45||Dr(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),i.interrupt?n:Y):t(D)}function M(D){return fn(D)?(e.consume(D),M):R(D)}function I(D){return D===47?(e.consume(D),R):D===58||D===95||Wr(D)?(e.consume(D),U):fn(D)?(e.consume(D),I):R(D)}function U(D){return D===45||D===46||D===58||D===95||Dr(D)?(e.consume(D),U):L(D)}function L(D){return D===61?(e.consume(D),F):fn(D)?(e.consume(D),L):I(D)}function F(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,z):fn(D)?(e.consume(D),F):$(D)}function z(D){return D===f?(e.consume(D),f=null,B):D===null||It(D)?t(D):(e.consume(D),z)}function $(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||Yn(D)?L(D):(e.consume(D),$)}function B(D){return D===47||D===62||fn(D)?I(D):t(D)}function R(D){return D===62?(e.consume(D),V):t(D)}function V(D){return D===null||It(D)?Y(D):fn(D)?(e.consume(D),V):t(D)}function Y(D){return D===45&&a===2?(e.consume(D),H):D===60&&a===1?(e.consume(D),Q):D===62&&a===4?(e.consume(D),oe):D===63&&a===3?(e.consume(D),A):D===93&&a===5?(e.consume(D),fe):It(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(l7,ue,ie)(D)):D===null||It(D)?(e.exit("htmlFlowData"),ie(D)):(e.consume(D),Y)}function ie(D){return e.check(c7,te,ue)(D)}function te(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),W}function W(D){return D===null||It(D)?ie(D):(e.enter("htmlFlowData"),Y(D))}function H(D){return D===45?(e.consume(D),A):Y(D)}function Q(D){return D===47?(e.consume(D),l="",J):Y(D)}function J(D){if(D===62){const se=l.toLowerCase();return pj.includes(se)?(e.consume(D),oe):Y(D)}return Wr(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),J):Y(D)}function fe(D){return D===93?(e.consume(D),A):Y(D)}function A(D){return D===62?(e.consume(D),oe):D===45&&a===2?(e.consume(D),A):Y(D)}function oe(D){return D===null||It(D)?(e.exit("htmlFlowData"),ue(D)):(e.consume(D),oe)}function ue(D){return e.exit("htmlFlow"),n(D)}}function f7(e,n,t){const i=this;return a;function a(l){return It(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return i.parser.lazy[i.now().line]?t(l):n(l)}}function h7(e,n,t){return i;function i(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(ug,n,t)}}const p7={name:"htmlText",tokenize:m7};function m7(e,n,t){const i=this;let a,o,l;return d;function d(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),f}function f(A){return A===33?(e.consume(A),u):A===47?(e.consume(A),L):A===63?(e.consume(A),I):Wr(A)?(e.consume(A),$):t(A)}function u(A){return A===45?(e.consume(A),p):A===91?(e.consume(A),o=0,S):Wr(A)?(e.consume(A),M):t(A)}function p(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):It(A)?(l=g,Q(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?H(A):A===45?b(A):g(A)}function S(A){const oe="CDATA[";return A===oe.charCodeAt(o++)?(e.consume(A),o===oe.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),T):It(A)?(l=k,Q(A)):(e.consume(A),k)}function T(A){return A===93?(e.consume(A),P):k(A)}function P(A){return A===62?H(A):A===93?(e.consume(A),P):k(A)}function M(A){return A===null||A===62?H(A):It(A)?(l=M,Q(A)):(e.consume(A),M)}function I(A){return A===null?t(A):A===63?(e.consume(A),U):It(A)?(l=I,Q(A)):(e.consume(A),I)}function U(A){return A===62?H(A):I(A)}function L(A){return Wr(A)?(e.consume(A),F):t(A)}function F(A){return A===45||Dr(A)?(e.consume(A),F):z(A)}function z(A){return It(A)?(l=z,Q(A)):fn(A)?(e.consume(A),z):H(A)}function $(A){return A===45||Dr(A)?(e.consume(A),$):A===47||A===62||Yn(A)?B(A):t(A)}function B(A){return A===47?(e.consume(A),H):A===58||A===95||Wr(A)?(e.consume(A),R):It(A)?(l=B,Q(A)):fn(A)?(e.consume(A),B):H(A)}function R(A){return A===45||A===46||A===58||A===95||Dr(A)?(e.consume(A),R):V(A)}function V(A){return A===61?(e.consume(A),Y):It(A)?(l=V,Q(A)):fn(A)?(e.consume(A),V):B(A)}function Y(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ie):It(A)?(l=Y,Q(A)):fn(A)?(e.consume(A),Y):(e.consume(A),te)}function ie(A){return A===a?(e.consume(A),a=void 0,W):A===null?t(A):It(A)?(l=ie,Q(A)):(e.consume(A),ie)}function te(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||Yn(A)?B(A):(e.consume(A),te)}function W(A){return A===47||A===62||Yn(A)?B(A):t(A)}function H(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function Q(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),J}function J(A){return fn(A)?Sn(e,fe,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):fe(A)}function fe(A){return e.enter("htmlTextData"),l(A)}}const Iw={name:"labelEnd",resolveAll:b7,resolveTo:v7,tokenize:w7},g7={tokenize:S7},y7={tokenize:N7},x7={tokenize:C7};function b7(e){let n=-1;const t=[];for(;++n<e.length;){const i=e[n][1];if(t.push(e[n]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const a=i.type==="labelImage"?4:2;i.type="data",n+=a}}return e.length!==t.length&&$a(e,0,e.length,t),e}function v7(e,n){let t=e.length,i=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){i=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},p={type:"labelText",start:{...e[o+i+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=os(d,e.slice(o+1,o+i+3)),d=os(d,[["enter",p,n]]),d=os(d,zb(n.parser.constructs.insideSpan.null,e.slice(o+i+4,l-3),n)),d=os(d,[["exit",p,n],e[l-2],e[l-1],["exit",u,n]]),d=os(d,e.slice(l+1)),d=os(d,[["exit",f,n]]),$a(e,o,e.length,d),e}function w7(e,n,t){const i=this;let a=i.events.length,o,l;for(;a--;)if((i.events[a][1].type==="labelImage"||i.events[a][1].type==="labelLink")&&!i.events[a][1]._balanced){o=i.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=i.parser.defined.includes(Js(i.sliceSerialize({start:o.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(g7,p,l?p:g)(b):b===91?e.attempt(y7,p,l?u:g)(b):l?p(b):g(b)}function u(b){return e.attempt(x7,p,g)(b)}function p(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function S7(e,n,t){return i;function i(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return Yn(g)?zm(e,o)(g):o(g)}function o(g){return g===41?p(g):k2(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return Yn(g)?zm(e,f)(g):p(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?E2(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function u(g){return Yn(g)?zm(e,p)(g):p(g)}function p(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function N7(e,n,t){const i=this;return a;function a(d){return T2.call(i,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return i.parser.defined.includes(Js(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function C7(e,n,t){return i;function i(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const j7={name:"labelStartImage",resolveAll:Iw.resolveAll,tokenize:_7};function _7(e,n,t){const i=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(d):n(d)}}const k7={name:"labelStartLink",resolveAll:Iw.resolveAll,tokenize:T7};function T7(e,n,t){const i=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(l):n(l)}}const x0={name:"lineEnding",tokenize:E7};function E7(e,n){return t;function t(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),Sn(e,n,"linePrefix")}}const qx={name:"thematicBreak",tokenize:A7};function A7(e,n,t){let i=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):i>=3&&(u===null||It(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),i++,f):(e.exit("thematicBreakSequence"),fn(u)?Sn(e,d,"whitespace")(u):d(u))}}const la={continuation:{tokenize:R7},exit:O7,name:"list",tokenize:I7},P7={partial:!0,tokenize:L7},D7={partial:!0,tokenize:M7};function I7(e,n,t){const i=this,a=i.events[i.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=i.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!i.containerState.marker||v===i.containerState.marker:T1(v)){if(i.containerState.type||(i.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(qx,t,u)(v):u(v);if(!i.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return T1(v)&&++l<10?(e.consume(v),f):(!i.interrupt||l<2)&&(i.containerState.marker?v===i.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||v,e.check(ug,i.interrupt?t:p,e.attempt(P7,b,g))}function p(v){return i.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return fn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return i.containerState.size=o+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function R7(e,n,t){const i=this;return i.containerState._closeFlow=void 0,e.check(ug,a,o);function a(d){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,Sn(e,n,"listItemIndent",i.containerState.size+1)(d)}function o(d){return i.containerState.furtherBlankLines||!fn(d)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,l(d)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(D7,n,l)(d))}function l(d){return i.containerState._closeFlow=!0,i.interrupt=void 0,Sn(e,e.attempt(la,n,t),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function M7(e,n,t){const i=this;return Sn(e,a,"listItemIndent",i.containerState.size+1);function a(o){const l=i.events[i.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===i.containerState.size?n(o):t(o)}}function O7(e){e.exit(this.containerState.type)}function L7(e,n,t){const i=this;return Sn(e,a,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=i.events[i.events.length-1];return!fn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const mj={name:"setextUnderline",resolveTo:F7,tokenize:$7};function F7(e,n){let t=e.length,i,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){i=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[i][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[i][1],n]),e[i][1].end={...e[o][1].end}):e[i][1]=l,e.push(["exit",l,n]),e}function $7(e,n,t){const i=this;let a;return o;function o(u){let p=i.events.length,g;for(;p--;)if(i.events[p][1].type!=="lineEnding"&&i.events[p][1].type!=="linePrefix"&&i.events[p][1].type!=="content"){g=i.events[p][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),fn(u)?Sn(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||It(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const z7={tokenize:U7};function U7(e){const n=this,t=e.attempt(ug,i,e.attempt(this.parser.constructs.flowInitial,a,Sn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(G9,a)),"linePrefix")));return t;function i(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const B7={resolveAll:P2()},q7=A2("string"),V7=A2("text");function A2(e){return{resolveAll:P2(e==="text"?H7:void 0),tokenize:n};function n(t){const i=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(p){return u(p)?o(p):d(p)}function d(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),f}function f(p){return u(p)?(t.exit("data"),o(p)):(t.consume(p),f)}function u(p){if(p===null)return!0;const g=a[p];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(i,i.previous))return!0}return!1}}}function P2(e){return n;function n(t,i){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,i):t}}function H7(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const i=e[t-1][1],a=n.sliceStream(i);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:i.start._bufferIndex+l,_index:i.start._index+o,line:i.end.line,column:i.end.column-d,offset:i.end.offset-d},end:{...i.end}};i.end={...u.start},i.start.offset===i.end.offset?Object.assign(i,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const G7={42:la,43:la,45:la,48:la,49:la,50:la,51:la,52:la,53:la,54:la,55:la,56:la,57:la,62:N2},Y7={91:K9},W7={[-2]:y0,[-1]:y0,32:y0},Q7={35:i7,42:qx,45:[mj,qx],60:o7,61:mj,95:qx,96:hj,126:hj},J7={38:j2,92:C2},K7={[-5]:x0,[-4]:x0,[-3]:x0,33:j7,38:j2,42:E1,60:[k9,p7],91:k7,92:[t7,C2],93:Iw,95:E1,96:z9},X7={null:[E1,B7]},Z7={null:[42,95]},eV={null:[]},tV=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Z7,contentInitial:Y7,disable:eV,document:G7,flow:Q7,flowInitial:W7,insideSpan:X7,string:J7,text:K7},Symbol.toStringTag,{value:"Module"}));function nV(e,n,t){let i={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:z(L),check:z(F),consume:M,enter:I,exit:U,interrupt:z(F,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let p=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(V){return l=os(l,V),T(),l[l.length-1]!==null?[]:($(n,0),u.events=zb(o,u.events,u),u.events)}function b(V,Y){return rV(v(V),Y)}function v(V){return iV(l,V)}function S(){const{_bufferIndex:V,_index:Y,line:ie,column:te,offset:W}=i;return{_bufferIndex:V,_index:Y,line:ie,column:te,offset:W}}function k(V){a[V.line]=V.column,R()}function T(){let V;for(;i._index<l.length;){const Y=l[i._index];if(typeof Y=="string")for(V=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===V&&i._bufferIndex<Y.length;)P(Y.charCodeAt(i._bufferIndex));else P(Y)}}function P(V){p=p(V)}function M(V){It(V)?(i.line++,i.column=1,i.offset+=V===-3?2:1,R()):V!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===l[i._index].length&&(i._bufferIndex=-1,i._index++)),u.previous=V}function I(V,Y){const ie=Y||{};return ie.type=V,ie.start=S(),u.events.push(["enter",ie,u]),d.push(ie),ie}function U(V){const Y=d.pop();return Y.end=S(),u.events.push(["exit",Y,u]),Y}function L(V,Y){$(V,Y.from)}function F(V,Y){Y.restore()}function z(V,Y){return ie;function ie(te,W,H){let Q,J,fe,A;return Array.isArray(te)?ue(te):"tokenize"in te?ue([te]):oe(te);function oe(ee){return ce;function ce(re){const Pe=re!==null&&ee[re],Qe=re!==null&&ee.null,Se=[...Array.isArray(Pe)?Pe:Pe?[Pe]:[],...Array.isArray(Qe)?Qe:Qe?[Qe]:[]];return ue(Se)(re)}}function ue(ee){return Q=ee,J=0,ee.length===0?H:D(ee[J])}function D(ee){return ce;function ce(re){return A=B(),fe=ee,ee.partial||(u.currentConstruct=ee),ee.name&&u.parser.constructs.disable.null.includes(ee.name)?be():ee.tokenize.call(Y?Object.assign(Object.create(u),Y):u,f,se,be)(re)}}function se(ee){return V(fe,A),W}function be(ee){return A.restore(),++J<Q.length?D(Q[J]):H}}}function $(V,Y){V.resolveAll&&!o.includes(V)&&o.push(V),V.resolve&&$a(u.events,Y,u.events.length-Y,V.resolve(u.events.slice(Y),u)),V.resolveTo&&(u.events=V.resolveTo(u.events,u))}function B(){const V=S(),Y=u.previous,ie=u.currentConstruct,te=u.events.length,W=Array.from(d);return{from:te,restore:H};function H(){i=V,u.previous=Y,u.currentConstruct=ie,u.events.length=te,d=W,R()}}function R(){i.line in a&&i.column<2&&(i.column=a[i.line],i.offset+=a[i.line]-1)}}function iV(e,n){const t=n.start._index,i=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(i,o)];else{if(l=e.slice(t,a),i>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(i):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function rV(e,n){let t=-1;const i=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,i.push(l)}return i.join("")}function aV(e){const i={constructs:w2([tV,...(e||{}).extensions||[]]),content:a(v9),defined:[],document:a(S9),flow:a(z7),lazy:{},string:a(q7),text:a(V7)};return i;function a(o){return l;function l(d){return nV(i,o,d)}}}function sV(e){for(;!_2(e););return e}const gj=/[\0\t\n\r]/g;function oV(){let e=1,n="",t=!0,i;return a;function a(o,l,d){const f=[];let u,p,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(gj.lastIndex=g,u=gj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&i)f.push(-3),i=void 0;else switch(i&&(f.push(-5),i=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,f.push(-2);e++<p;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:i=!0,e=1}g=b+1}return d&&(i&&f.push(-5),n&&f.push(n),f.push(null)),f}}const lV=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function cV(e){return e.replace(lV,uV)}function uV(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return S2(t.slice(o?2:1),o?16:10)}return Dw(t)||e}const D2={}.hasOwnProperty;function dV(e,n,t){return typeof n!="string"&&(t=n,n=void 0),fV(t)(sV(aV(t).document().write(oV()(e,n,!0))))}function fV(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(Nt),autolinkProtocol:B,autolinkEmail:B,atxHeading:o(nt),blockQuote:o(Qe),characterEscape:B,characterReference:B,codeFenced:o(Se),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Se,l),codeText:o(Ne,l),codeTextData:B,data:B,codeFlowValue:B,definition:o(De),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Me),hardBreakEscape:o(ft),hardBreakTrailing:o(ft),htmlFlow:o(ut,l),htmlFlowData:B,htmlText:o(ut,l),htmlTextData:B,image:o(rt),label:l,link:o(Nt),listItem:o(ye),listItemValue:b,listOrdered:o(Ft,g),listUnordered:o(Ft),paragraph:o(Te),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(nt),strong:o(Ye),thematicBreak:o(_e)},exit:{atxHeading:f(),atxHeadingSequence:L,autolink:f(),autolinkEmail:Pe,autolinkProtocol:re,blockQuote:f(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:be,characterReferenceMarkerNumeric:be,characterReferenceValue:ee,characterReference:ce,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:R,codeIndented:f(P),codeText:f(W),codeTextData:R,data:R,definition:f(),definitionDestinationString:U,definitionLabelString:M,definitionTitleString:I,emphasis:f(),hardBreakEscape:f(Y),hardBreakTrailing:f(Y),htmlFlow:f(ie),htmlFlowData:R,htmlText:f(te),htmlTextData:R,image:f(Q),label:fe,labelText:J,lineEnding:V,link:f(H),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:se,resourceDestinationString:A,resourceTitleString:oe,resource:ue,setextHeading:f($),setextHeadingLineSequence:z,setextHeadingText:F,strong:f(),thematicBreak:f()}};I2(n,(e||{}).mdastExtensions||[]);const t={};return i;function i(X){let de={type:"root",children:[]};const qe={stack:[de],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:p,data:t},et=[];let ct=-1;for(;++ct<X.length;)if(X[ct][1].type==="listOrdered"||X[ct][1].type==="listUnordered")if(X[ct][0]==="enter")et.push(ct);else{const Fe=et.pop();ct=a(X,Fe,ct)}for(ct=-1;++ct<X.length;){const Fe=n[X[ct][0]];D2.call(Fe,X[ct][1].type)&&Fe[X[ct][1].type].call(Object.assign({sliceSerialize:X[ct][2].sliceSerialize},qe),X[ct][1])}if(qe.tokenStack.length>0){const Fe=qe.tokenStack[qe.tokenStack.length-1];(Fe[1]||yj).call(qe,void 0,Fe[0])}for(de.position={start:Gc(X.length>0?X[0][1].start:{line:1,column:1,offset:0}),end:Gc(X.length>0?X[X.length-2][1].end:{line:1,column:1,offset:0})},ct=-1;++ct<n.transforms.length;)de=n.transforms[ct](de)||de;return de}function a(X,de,qe){let et=de-1,ct=-1,Fe=!1,ot,ve,xe,Be;for(;++et<=qe;){const Ue=X[et];switch(Ue[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ue[0]==="enter"?ct++:ct--,Be=void 0;break}case"lineEndingBlank":{Ue[0]==="enter"&&(ot&&!Be&&!ct&&!xe&&(xe=et),Be=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Be=void 0}if(!ct&&Ue[0]==="enter"&&Ue[1].type==="listItemPrefix"||ct===-1&&Ue[0]==="exit"&&(Ue[1].type==="listUnordered"||Ue[1].type==="listOrdered")){if(ot){let tt=et;for(ve=void 0;tt--;){const dt=X[tt];if(dt[1].type==="lineEnding"||dt[1].type==="lineEndingBlank"){if(dt[0]==="exit")continue;ve&&(X[ve][1].type="lineEndingBlank",Fe=!0),dt[1].type="lineEnding",ve=tt}else if(!(dt[1].type==="linePrefix"||dt[1].type==="blockQuotePrefix"||dt[1].type==="blockQuotePrefixWhitespace"||dt[1].type==="blockQuoteMarker"||dt[1].type==="listItemIndent"))break}xe&&(!ve||xe<ve)&&(ot._spread=!0),ot.end=Object.assign({},ve?X[ve][1].start:Ue[1].end),X.splice(ve||et,0,["exit",ot,Ue[2]]),et++,qe++}if(Ue[1].type==="listItemPrefix"){const tt={type:"listItem",_spread:!1,start:Object.assign({},Ue[1].start),end:void 0};ot=tt,X.splice(et,0,["enter",tt,Ue[2]]),et++,qe++,xe=void 0,Be=!0}}}return X[de][1]._spread=Fe,qe}function o(X,de){return qe;function qe(et){d.call(this,X(et),et),de&&de.call(this,et)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(X,de,qe){this.stack[this.stack.length-1].children.push(X),this.stack.push(X),this.tokenStack.push([de,qe||void 0]),X.position={start:Gc(de.start),end:void 0}}function f(X){return de;function de(qe){X&&X.call(this,qe),u.call(this,qe)}}function u(X,de){const qe=this.stack.pop(),et=this.tokenStack.pop();if(et)et[0].type!==X.type&&(de?de.call(this,X,et[0]):(et[1]||yj).call(this,X,et[0]));else throw new Error("Cannot close `"+X.type+"` ("+$m({start:X.start,end:X.end})+"): its not open");qe.position.end=Gc(X.end)}function p(){return Pw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(X){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];de.start=Number.parseInt(this.sliceSerialize(X),10),this.data.expectingFirstListItemValue=void 0}}function v(){const X=this.resume(),de=this.stack[this.stack.length-1];de.lang=X}function S(){const X=this.resume(),de=this.stack[this.stack.length-1];de.meta=X}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X.replace(/(\r?\n|\r)$/g,"")}function M(X){const de=this.resume(),qe=this.stack[this.stack.length-1];qe.label=de,qe.identifier=Js(this.sliceSerialize(X)).toLowerCase()}function I(){const X=this.resume(),de=this.stack[this.stack.length-1];de.title=X}function U(){const X=this.resume(),de=this.stack[this.stack.length-1];de.url=X}function L(X){const de=this.stack[this.stack.length-1];if(!de.depth){const qe=this.sliceSerialize(X).length;de.depth=qe}}function F(){this.data.setextHeadingSlurpLineEnding=!0}function z(X){const de=this.stack[this.stack.length-1];de.depth=this.sliceSerialize(X).codePointAt(0)===61?1:2}function $(){this.data.setextHeadingSlurpLineEnding=void 0}function B(X){const qe=this.stack[this.stack.length-1].children;let et=qe[qe.length-1];(!et||et.type!=="text")&&(et=$e(),et.position={start:Gc(X.start),end:void 0},qe.push(et)),this.stack.push(et)}function R(X){const de=this.stack.pop();de.value+=this.sliceSerialize(X),de.position.end=Gc(X.end)}function V(X){const de=this.stack[this.stack.length-1];if(this.data.atHardBreak){const qe=de.children[de.children.length-1];qe.position.end=Gc(X.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(de.type)&&(B.call(this,X),R.call(this,X))}function Y(){this.data.atHardBreak=!0}function ie(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X}function te(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X}function W(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X}function H(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=de,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function Q(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=de,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function J(X){const de=this.sliceSerialize(X),qe=this.stack[this.stack.length-2];qe.label=cV(de),qe.identifier=Js(de).toLowerCase()}function fe(){const X=this.stack[this.stack.length-1],de=this.resume(),qe=this.stack[this.stack.length-1];if(this.data.inReference=!0,qe.type==="link"){const et=X.children;qe.children=et}else qe.alt=de}function A(){const X=this.resume(),de=this.stack[this.stack.length-1];de.url=X}function oe(){const X=this.resume(),de=this.stack[this.stack.length-1];de.title=X}function ue(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function se(X){const de=this.resume(),qe=this.stack[this.stack.length-1];qe.label=de,qe.identifier=Js(this.sliceSerialize(X)).toLowerCase(),this.data.referenceType="full"}function be(X){this.data.characterReferenceType=X.type}function ee(X){const de=this.sliceSerialize(X),qe=this.data.characterReferenceType;let et;qe?(et=S2(de,qe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):et=Dw(de);const ct=this.stack[this.stack.length-1];ct.value+=et}function ce(X){const de=this.stack.pop();de.position.end=Gc(X.end)}function re(X){R.call(this,X);const de=this.stack[this.stack.length-1];de.url=this.sliceSerialize(X)}function Pe(X){R.call(this,X);const de=this.stack[this.stack.length-1];de.url="mailto:"+this.sliceSerialize(X)}function Qe(){return{type:"blockquote",children:[]}}function Se(){return{type:"code",lang:null,meta:null,value:""}}function Ne(){return{type:"inlineCode",value:""}}function De(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Me(){return{type:"emphasis",children:[]}}function nt(){return{type:"heading",depth:0,children:[]}}function ft(){return{type:"break"}}function ut(){return{type:"html",value:""}}function rt(){return{type:"image",title:null,url:"",alt:null}}function Nt(){return{type:"link",title:null,url:"",children:[]}}function Ft(X){return{type:"list",ordered:X.type==="listOrdered",start:null,spread:X._spread,children:[]}}function ye(X){return{type:"listItem",spread:X._spread,checked:null,children:[]}}function Te(){return{type:"paragraph",children:[]}}function Ye(){return{type:"strong",children:[]}}function $e(){return{type:"text",value:""}}function _e(){return{type:"thematicBreak"}}}function Gc(e){return{line:e.line,column:e.column,offset:e.offset}}function I2(e,n){let t=-1;for(;++t<n.length;){const i=n[t];Array.isArray(i)?I2(e,i):hV(e,i)}}function hV(e,n){let t;for(t in n)if(D2.call(n,t))switch(t){case"canContainEols":{const i=n[t];i&&e[t].push(...i);break}case"transforms":{const i=n[t];i&&e[t].push(...i);break}case"enter":case"exit":{const i=n[t];i&&Object.assign(e[t],i);break}}}function yj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+$m({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+$m({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+$m({start:n.start,end:n.end})+") is still open")}function pV(e){const n=this;n.parser=t;function t(i){return dV(i,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function mV(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function gV(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function yV(e,n){const t=n.value?n.value+`
`:"",i={};n.lang&&(i.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:i,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function xV(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function bV(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function vV(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",i=String(n.identifier).toUpperCase(),a=Yh(i.toLowerCase()),o=e.footnoteOrder.indexOf(i);let l,d=e.footnoteCounts.get(i);d===void 0?(d=0,e.footnoteOrder.push(i),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(i,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function wV(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function SV(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function R2(e,n){const t=n.referenceType;let i="]";if(t==="collapsed"?i+="[]":t==="full"&&(i+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+i}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=i:a.push({type:"text",value:i}),a}function NV(e,n){const t=String(n.identifier).toUpperCase(),i=e.definitionById.get(t);if(!i)return R2(e,n);const a={src:Yh(i.url||""),alt:n.alt};i.title!==null&&i.title!==void 0&&(a.title=i.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function CV(e,n){const t={src:Yh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const i={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,i),e.applyData(n,i)}function jV(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const i={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,i),e.applyData(n,i)}function _V(e,n){const t=String(n.identifier).toUpperCase(),i=e.definitionById.get(t);if(!i)return R2(e,n);const a={href:Yh(i.url||"")};i.title!==null&&i.title!==void 0&&(a.title=i.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function kV(e,n){const t={href:Yh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const i={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,i),e.applyData(n,i)}function TV(e,n,t){const i=e.all(n),a=t?EV(t):M2(n),o={},l=[];if(typeof n.checked=="boolean"){const p=i[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},i.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<i.length;){const p=i[d];(a||d!==0||p.type!=="element"||p.tagName!=="p")&&l.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?l.push(...p.children):l.push(p)}const f=i[i.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function EV(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let i=-1;for(;!n&&++i<t.length;)n=M2(t[i])}return n}function M2(e){const n=e.spread;return n??e.children.length>1}function AV(e,n){const t={},i=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<i.length;){const l=i[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(i,!0)};return e.patch(n,o),e.applyData(n,o)}function PV(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function DV(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function IV(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function RV(e,n){const t=e.all(n),i=t.shift(),a=[];if(i){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=kw(n.children[1]),f=p2(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function MV(e,n,t){const i=t?t.children:void 0,o=(i?i.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const p={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,p),e.applyData(n,p)}function OV(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const xj=9,bj=32;function LV(e){const n=String(e),t=/\r?\n|\r/g;let i=t.exec(n),a=0;const o=[];for(;i;)o.push(vj(n.slice(a,i.index),a>0,!0),i[0]),a=i.index+i[0].length,i=t.exec(n);return o.push(vj(n.slice(a),a>0,!1)),o.join("")}function vj(e,n,t){let i=0,a=e.length;if(n){let o=e.codePointAt(i);for(;o===xj||o===bj;)i++,o=e.codePointAt(i)}if(t){let o=e.codePointAt(a-1);for(;o===xj||o===bj;)a--,o=e.codePointAt(a-1)}return a>i?e.slice(i,a):""}function FV(e,n){const t={type:"text",value:LV(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function $V(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const zV={blockquote:mV,break:gV,code:yV,delete:xV,emphasis:bV,footnoteReference:vV,heading:wV,html:SV,imageReference:NV,image:CV,inlineCode:jV,linkReference:_V,link:kV,listItem:TV,list:AV,paragraph:PV,root:DV,strong:IV,table:RV,tableCell:OV,tableRow:MV,text:FV,thematicBreak:$V,toml:wx,yaml:wx,definition:wx,footnoteDefinition:wx};function wx(){}const O2=-1,Ub=0,Um=1,db=2,Rw=3,Mw=4,Ow=5,Lw=6,L2=7,F2=8,wj=typeof self=="object"?self:globalThis,UV=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),i=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Ub:case O2:return t(l,a);case Um:{const d=t([],a);for(const f of l)d.push(i(f));return d}case db:{const d=t({},a);for(const[f,u]of l)d[i(f)]=i(u);return d}case Rw:return t(new Date(l),a);case Mw:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case Ow:{const d=t(new Map,a);for(const[f,u]of l)d.set(i(f),i(u));return d}case Lw:{const d=t(new Set,a);for(const f of l)d.add(i(f));return d}case L2:{const{name:d,message:f}=l;return t(new wj[d](f),a)}case F2:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new wj[o](l),a)};return i},Sj=e=>UV(new Map,e)(0),bh="",{toString:BV}={},{keys:qV}=Object,Dm=e=>{const n=typeof e;if(n!=="object"||!e)return[Ub,n];const t=BV.call(e).slice(8,-1);switch(t){case"Array":return[Um,bh];case"Object":return[db,bh];case"Date":return[Rw,bh];case"RegExp":return[Mw,bh];case"Map":return[Ow,bh];case"Set":return[Lw,bh];case"DataView":return[Um,t]}return t.includes("Array")?[Um,t]:t.includes("Error")?[L2,t]:[db,t]},Sx=([e,n])=>e===Ub&&(n==="function"||n==="symbol"),VV=(e,n,t,i)=>{const a=(l,d)=>{const f=i.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Dm(l);switch(d){case Ub:{let p=l;switch(f){case"bigint":d=F2,p=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);p=null;break;case"undefined":return a([O2],l)}return a([d,p],l)}case Um:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const p=[],g=a([d,p],l);for(const b of l)p.push(o(b));return g}case db:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const p=[],g=a([d,p],l);for(const b of qV(l))(e||!Sx(Dm(l[b])))&&p.push([o(b),o(l[b])]);return g}case Rw:return a([d,l.toISOString()],l);case Mw:{const{source:p,flags:g}=l;return a([d,{source:p,flags:g}],l)}case Ow:{const p=[],g=a([d,p],l);for(const[b,v]of l)(e||!(Sx(Dm(b))||Sx(Dm(v))))&&p.push([o(b),o(v)]);return g}case Lw:{const p=[],g=a([d,p],l);for(const b of l)(e||!Sx(Dm(b)))&&p.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},Nj=(e,{json:n,lossy:t}={})=>{const i=[];return VV(!(n||t),!!n,new Map,i)(e),i},fb=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?Sj(Nj(e,n)):structuredClone(e):(e,n)=>Sj(Nj(e,n));function HV(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function GV(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function YV(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||HV,i=e.options.footnoteBackLabel||GV,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const p=e.all(u),g=String(u.identifier).toUpperCase(),b=Yh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=p[p.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else p.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(p,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...fb(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const Bb=function(e){if(e==null)return KV;if(typeof e=="function")return qb(e);if(typeof e=="object")return Array.isArray(e)?WV(e):QV(e);if(typeof e=="string")return JV(e);throw new Error("Expected function, string, or object as test")};function WV(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Bb(e[t]);return qb(i);function i(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function QV(e){const n=e;return qb(t);function t(i){const a=i;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function JV(e){return qb(n);function n(t){return t&&t.type===e}}function qb(e){return n;function n(t,i,a){return!!(XV(t)&&e.call(this,t,typeof i=="number"?i:void 0,a||void 0))}}function KV(){return!0}function XV(e){return e!==null&&typeof e=="object"&&"type"in e}const $2=[],ZV=!0,A1=!1,eH="skip";function z2(e,n,t,i){let a;typeof n=="function"&&typeof t!="function"?(i=t,t=n):a=n;const o=Bb(a),l=i?-1:1;d(e,void 0,[])();function d(f,u,p){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=$2,S,k,T;if((!n||o(f,u,p[p.length-1]||void 0))&&(v=tH(t(f,p)),v[0]===A1))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==eH)for(k=(i?P.children.length:-1)+l,T=p.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===A1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function tH(e){return Array.isArray(e)?e:typeof e=="number"?[ZV,e]:e==null?$2:[e]}function Fw(e,n,t,i){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=i),z2(e,o,d,a);function d(f,u){const p=u[u.length-1],g=p?p.children.indexOf(f):void 0;return l(f,g,p)}}const P1={}.hasOwnProperty,nH={};function iH(e,n){const t=n||nH,i=new Map,a=new Map,o=new Map,l={...zV,...t.handlers},d={all:u,applyData:aH,definitionById:i,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:rH,wrap:oH};return Fw(e,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?i:a,b=String(p.identifier).toUpperCase();g.has(b)||g.set(b,p)}}),d;function f(p,g){const b=p.type,v=d.handlers[b];if(P1.call(d.handlers,b)&&v)return v(d,p,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in p){const{children:k,...T}=p,P=fb(T);return P.children=d.all(p),P}return fb(p)}return(d.options.unknownHandler||sH)(d,p,g)}function u(p){const g=[];if("children"in p){const b=p.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],p);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Cj(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=Cj(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function rH(e,n){e.position&&(n.position=Gq(e))}function aH(e,n){let t=n;if(e&&e.data){const i=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof i=="string")if(t.type==="element")t.tagName=i;else{const l="children"in t?t.children:[t];t={type:"element",tagName:i,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,fb(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function sH(e,n){const t=n.data||{},i="value"in n&&!(P1.call(t,"hProperties")||P1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,i),e.applyData(n,i)}function oH(e,n){const t=[];let i=-1;for(n&&t.push({type:"text",value:`
`});++i<e.length;)i&&t.push({type:"text",value:`
`}),t.push(e[i]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Cj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function jj(e,n){const t=iH(e,n),i=t.one(e,void 0),a=YV(t),o=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}function lH(e,n){return e&&"run"in e?async function(t,i){const a=jj(t,{file:i,...n});await e.run(a,i)}:function(t,i){return jj(t,{file:i,...e||n})}}function _j(e){if(e)throw e}var b0,kj;function cH(){if(kj)return b0;kj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,i=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var p=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!p&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,p){t&&p.name==="__proto__"?t(u,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):u[p.name]=p.newValue},d=function(u,p){if(p==="__proto__")if(e.call(u,p)){if(i)return i(u,p).value}else return;return u[p]};return b0=function f(){var u,p,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(p in u)g=d(k,p),b=d(u,p),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:p,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:p,newValue:b}));return k},b0}var uH=cH();const v0=qd(uH);function D1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function dH(){const e=[],n={run:t,use:i};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const p=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,p?fH(p,d)(...u):l(null,...u)}}function i(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function fH(e,n){let t;return i;function i(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const p=u;if(d&&t)throw p;return a(p)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}const Vo={basename:hH,dirname:pH,extname:mH,join:gH,sep:"/"};function hH(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');dg(e);let t=0,i=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else i<0&&(o=!0,i=a+1);return i<0?"":e.slice(t,i)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(i=a):(d=-1,i=l));return t===i?i=l:i<0&&(i=e.length),e.slice(t,i)}function pH(e){if(dg(e),e.length===0)return".";let n=-1,t=e.length,i;for(;--t;)if(e.codePointAt(t)===47){if(i){n=t;break}}else i||(i=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function mH(e){dg(e);let n=e.length,t=-1,i=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){i=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===i+1?"":e.slice(a,t)}function gH(...e){let n=-1,t;for(;++n<e.length;)dg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":yH(t)}function yH(e){dg(e);const n=e.codePointAt(0)===47;let t=xH(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function xH(e,n){let t="",i=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||i!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",i=0):(t=t.slice(0,f),i=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",i=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",i=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),i=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function dg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const bH={cwd:vH};function vH(){return"/"}function I1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function wH(e){if(typeof e=="string")e=new URL(e);else if(!I1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return SH(e)}function SH(e){if(e.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const i=n.codePointAt(t+2);if(i===70||i===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const w0=["history","path","basename","stem","extname","dirname"];let U2=class{constructor(n){let t;n?I1(n)?t={path:n}:typeof n=="string"||NH(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":bH.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<w0.length;){const o=w0[i];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)w0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Vo.basename(this.path):void 0}set basename(n){N0(n,"basename"),S0(n,"basename"),this.path=Vo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Vo.dirname(this.path):void 0}set dirname(n){Tj(this.basename,"dirname"),this.path=Vo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Vo.extname(this.path):void 0}set extname(n){if(S0(n,"extname"),Tj(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Vo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){I1(n)&&(n=wH(n)),N0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Vo.basename(this.path,this.extname):void 0}set stem(n){N0(n,"stem"),S0(n,"stem"),this.path=Vo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,i){const a=this.message(n,t,i);throw a.fatal=!0,a}info(n,t,i){const a=this.message(n,t,i);return a.fatal=void 0,a}message(n,t,i){const a=new Rr(n,t,i);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function S0(e,n){if(e&&e.includes(Vo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Vo.sep+"`")}function N0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function Tj(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function NH(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const CH=function(e){const i=this.constructor.prototype,a=i[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,i),o},jH={}.hasOwnProperty;let _H=class B2 extends CH{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=dH()}copy(){const n=new B2;let t=-1;for(;++t<this.attachers.length;){const i=this.attachers[t];n.use(...i)}return n.data(v0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(_0("data",this.frozen),this.namespace[n]=t,this):jH.call(this.namespace,n)&&this.namespace[n]||void 0:n?(_0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const a=t.call(n,...i);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Nx(n),i=this.parser||this.Parser;return C0("parse",i),i(String(t),t)}process(n,t){const i=this;return this.freeze(),C0("process",this.parser||this.Parser),j0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=Nx(n),f=i.parse(d);i.run(f,d,function(p,g,b){if(p||!g||!b)return u(p);const v=g,S=i.stringify(v,b);EH(S)?b.value=S:b.result=S,u(p,b)});function u(p,g){p||!g?l(p):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,i;return this.freeze(),C0("processSync",this.parser||this.Parser),j0("processSync",this.compiler||this.Compiler),this.process(n,a),Aj("processSync","process",t),i;function a(o,l){t=!0,_j(o),i=l}}run(n,t,i){Ej(n),this.freeze();const a=this.transformers;return!i&&typeof t=="function"&&(i=t,t=void 0),i?o(void 0,i):new Promise(o);function o(l,d){const f=Nx(t);a.run(n,f,u);function u(p,g,b){const v=g||n;p?d(p):l?l(v):i(void 0,v,b)}}}runSync(n,t){let i=!1,a;return this.run(n,t,o),Aj("runSync","run",i),a;function o(l,d){_j(l),a=d,i=!0}}stringify(n,t){this.freeze();const i=Nx(t),a=this.compiler||this.Compiler;return j0("stringify",a),Ej(n),a(n,i)}use(n,...t){const i=this.attachers,a=this.namespace;if(_0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[p,...g]=u;f(p,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=v0(!0,a.settings,u.settings))}function d(u){let p=-1;if(u!=null)if(Array.isArray(u))for(;++p<u.length;){const g=u[p];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,p){let g=-1,b=-1;for(;++g<i.length;)if(i[g][0]===u){b=g;break}if(b===-1)i.push([u,...p]);else if(p.length>0){let[v,...S]=p;const k=i[b][1];D1(k)&&D1(v)&&(v=v0(!0,k,v)),i[b]=[u,v,...S]}}}};const kH=new _H().freeze();function C0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function j0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function _0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Ej(e){if(!D1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Aj(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Nx(e){return TH(e)?e:new U2(e)}function TH(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function EH(e){return typeof e=="string"||AH(e)}function AH(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const PH="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Pj=[],Dj={allowDangerousHtml:!0},DH=/^(https?|ircs?|mailto|xmpp)$/i,IH=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Ol(e){const n=RH(e),t=MH(e);return OH(n.runSync(n.parse(t),t),e)}function RH(e){const n=e.rehypePlugins||Pj,t=e.remarkPlugins||Pj,i=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Dj}:Dj;return kH().use(pV).use(t).use(lH,i).use(n)}function MH(e){const n=e.children||"",t=new U2;return typeof n=="string"&&(t.value=n),t}function OH(e,n){const t=n.allowedElements,i=n.allowElement,a=n.components,o=n.disallowedElements,l=n.skipHtml,d=n.unwrapDisallowed,f=n.urlTransform||LH;for(const p of IH)Object.hasOwn(n,p.from)&&(""+p.from+(p.to?"use `"+p.to+"` instead":"remove it")+PH+p.id,void 0);return Fw(e,u),Kq(e,{Fragment:r.Fragment,components:a,ignoreInvalidStyle:!0,jsx:r.jsx,jsxs:r.jsxs,passKeys:!0,passNode:!0});function u(p,g,b){if(p.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:p.value},g;if(p.type==="element"){let v;for(v in g0)if(Object.hasOwn(g0,v)&&Object.hasOwn(p.properties,v)){const S=p.properties[v],k=g0[v];(k===null||k.includes(p.tagName))&&(p.properties[v]=f(String(S||""),v,p))}}if(p.type==="element"){let v=t?!t.includes(p.tagName):o?o.includes(p.tagName):!1;if(!v&&i&&typeof g=="number"&&(v=!i(p,g,b)),v&&b&&typeof g=="number")return d&&p.children?b.children.splice(g,1,...p.children):b.children.splice(g,1),g}}}function LH(e){const n=e.indexOf(":"),t=e.indexOf("?"),i=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||i!==-1&&n>i||DH.test(e.slice(0,n))?e:""}function Ij(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let i=0,a=t.indexOf(n);for(;a!==-1;)i++,a=t.indexOf(n,a+n.length);return i}function FH(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function $H(e,n,t){const a=Bb((t||{}).ignore||[]),o=zH(n);let l=-1;for(;++l<o.length;)z2(e,"text",d);function d(u,p){let g=-1,b;for(;++g<p.length;){const v=p[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return f(u,p)}function f(u,p){const g=p[p.length-1],b=o[l][0],v=o[l][1];let S=0;const T=g.children.indexOf(u);let P=!1,M=[];b.lastIndex=0;let I=b.exec(u.value);for(;I;){const U=I.index,L={index:I.index,input:I.input,stack:[...p,u]};let F=v(...I,L);if(typeof F=="string"&&(F=F.length>0?{type:"text",value:F}:void 0),F===!1?b.lastIndex=U+1:(S!==U&&M.push({type:"text",value:u.value.slice(S,U)}),Array.isArray(F)?M.push(...F):F&&M.push(F),S=U+I[0].length,P=!0),!b.global)break;I=b.exec(u.value)}return P?(S<u.value.length&&M.push({type:"text",value:u.value.slice(S)}),g.children.splice(T,1,...M)):M=[u],T+M.length}}function zH(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let i=-1;for(;++i<t.length;){const a=t[i];n.push([UH(a[0]),BH(a[1])])}return n}function UH(e){return typeof e=="string"?new RegExp(FH(e),"g"):e}function BH(e){return typeof e=="function"?e:function(){return e}}const k0="phrasing",T0=["autolink","link","image","label"];function qH(){return{transforms:[JH],enter:{literalAutolink:HH,literalAutolinkEmail:E0,literalAutolinkHttp:E0,literalAutolinkWww:E0},exit:{literalAutolink:QH,literalAutolinkEmail:WH,literalAutolinkHttp:GH,literalAutolinkWww:YH}}}function VH(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:k0,notInConstruct:T0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:k0,notInConstruct:T0},{character:":",before:"[ps]",after:"\\/",inConstruct:k0,notInConstruct:T0}]}}function HH(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function E0(e){this.config.enter.autolinkProtocol.call(this,e)}function GH(e){this.config.exit.autolinkProtocol.call(this,e)}function YH(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function WH(e){this.config.exit.autolinkEmail.call(this,e)}function QH(e){this.exit(e)}function JH(e){$H(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,KH],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),XH]],{ignore:["link","linkReference"]})}function KH(e,n,t,i,a){let o="";if(!q2(a)||(/^w/i.test(n)&&(t=n+t,n="",o="http://"),!ZH(t)))return!1;const l=eG(t+i);if(!l[0])return!1;const d={type:"link",title:null,url:o+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[d,{type:"text",value:l[1]}]:d}function XH(e,n,t,i){return!q2(i,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function ZH(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function eG(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],i=t.indexOf(")");const a=Ij(e,"(");let o=Ij(e,")");for(;i!==-1&&a>o;)e+=t.slice(0,i+1),t=t.slice(i+1),i=t.indexOf(")"),o++;return[e,t]}function q2(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||Ud(t)||$b(t))&&(!n||t!==47)}V2.peek=cG;function tG(){this.buffer()}function nG(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function iG(){this.buffer()}function rG(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function aG(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Js(this.sliceSerialize(e)).toLowerCase(),t.label=n}function sG(e){this.exit(e)}function oG(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Js(this.sliceSerialize(e)).toLowerCase(),t.label=n}function lG(e){this.exit(e)}function cG(){return"["}function V2(e,n,t,i){const a=t.createTracker(i);let o=a.move("[^");const l=t.enter("footnoteReference"),d=t.enter("reference");return o+=a.move(t.safe(t.associationId(e),{after:"]",before:o})),d(),l(),o+=a.move("]"),o}function uG(){return{enter:{gfmFootnoteCallString:tG,gfmFootnoteCall:nG,gfmFootnoteDefinitionLabelString:iG,gfmFootnoteDefinition:rG},exit:{gfmFootnoteCallString:aG,gfmFootnoteCall:sG,gfmFootnoteDefinitionLabelString:oG,gfmFootnoteDefinition:lG}}}function dG(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:V2},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(i,a,o,l){const d=o.createTracker(l);let f=d.move("[^");const u=o.enter("footnoteDefinition"),p=o.enter("label");return f+=d.move(o.safe(o.associationId(i),{before:f,after:"]"})),p(),f+=d.move("]:"),i.children&&i.children.length>0&&(d.shift(4),f+=d.move((n?`
`:" ")+o.indentLines(o.containerFlow(i,d.current()),n?H2:fG))),u(),f}}function fG(e,n,t){return n===0?e:H2(e,n,t)}function H2(e,n,t){return(t?"":"    ")+e}const hG=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];G2.peek=xG;function pG(){return{canContainEols:["delete"],enter:{strikethrough:gG},exit:{strikethrough:yG}}}function mG(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:hG}],handlers:{delete:G2}}}function gG(e){this.enter({type:"delete",children:[]},e)}function yG(e){this.exit(e)}function G2(e,n,t,i){const a=t.createTracker(i),o=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),o(),l}function xG(){return"~"}function bG(e){return e.length}function vG(e,n){const t=n||{},i=(t.align||[]).concat(),a=t.stringLength||bG,o=[],l=[],d=[],f=[];let u=0,p=-1;for(;++p<e.length;){const k=[],T=[];let P=-1;for(e[p].length>u&&(u=e[p].length);++P<e[p].length;){const M=wG(e[p][P]);if(t.alignDelimiters!==!1){const I=a(M);T[P]=I,(f[P]===void 0||I>f[P])&&(f[P]=I)}k.push(M)}l[p]=k,d[p]=T}let g=-1;if(typeof i=="object"&&"length"in i)for(;++g<u;)o[g]=Rj(i[g]);else{const k=Rj(i);for(;++g<u;)o[g]=k}g=-1;const b=[],v=[];for(;++g<u;){const k=o[g];let T="",P="";k===99?(T=":",P=":"):k===108?T=":":k===114&&(P=":");let M=t.alignDelimiters===!1?1:Math.max(1,f[g]-T.length-P.length);const I=T+"-".repeat(M)+P;t.alignDelimiters!==!1&&(M=T.length+M+P.length,M>f[g]&&(f[g]=M),v[g]=M),b[g]=I}l.splice(1,0,b),d.splice(1,0,v),p=-1;const S=[];for(;++p<l.length;){const k=l[p],T=d[p];g=-1;const P=[];for(;++g<u;){const M=k[g]||"";let I="",U="";if(t.alignDelimiters!==!1){const L=f[g]-(T[g]||0),F=o[g];F===114?I=" ".repeat(L):F===99?L%2?(I=" ".repeat(L/2+.5),U=" ".repeat(L/2-.5)):(I=" ".repeat(L/2),U=I):U=" ".repeat(L)}t.delimiterStart!==!1&&!g&&P.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&M==="")&&(t.delimiterStart!==!1||g)&&P.push(" "),t.alignDelimiters!==!1&&P.push(I),P.push(M),t.alignDelimiters!==!1&&P.push(U),t.padding!==!1&&P.push(" "),(t.delimiterEnd!==!1||g!==u-1)&&P.push("|")}S.push(t.delimiterEnd===!1?P.join("").replace(/ +$/,""):P.join(""))}return S.join(`
`)}function wG(e){return e==null?"":String(e)}function Rj(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function SG(e,n,t,i){const a=t.enter("blockquote"),o=t.createTracker(i);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),NG);return a(),l}function NG(e,n,t){return">"+(t?"":" ")+e}function CG(e,n){return Mj(e,n.inConstruct,!0)&&!Mj(e,n.notInConstruct,!1)}function Mj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let i=-1;for(;++i<n.length;)if(e.includes(n[i]))return!0;return!1}function Oj(e,n,t,i){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&CG(t.stack,t.unsafe[a]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function jG(e,n){const t=String(e);let i=t.indexOf(n),a=i,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===a?++o>l&&(l=o):o=1,a=i+n.length,i=t.indexOf(n,a);return l}function _G(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function kG(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function TG(e,n,t,i){const a=kG(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(_G(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,EG);return g(),b}const d=t.createTracker(i),f=a.repeat(Math.max(jG(o,a)+1,3)),u=t.enter("codeFenced");let p=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);p+=d.move(t.safe(e.lang,{before:p,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);p+=d.move(" "),p+=d.move(t.safe(e.meta,{before:p,after:`
`,encode:["`"],...d.current()})),g()}return p+=d.move(`
`),o&&(p+=d.move(o+`
`)),p+=d.move(f),u(),p}function EG(e,n,t){return(t?"":"    ")+e}function $w(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function AG(e,n,t,i){const a=$w(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(i);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function PG(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function Zm(e){return"&#x"+e.toString(16).toUpperCase()+";"}function hb(e,n,t){const i=Lh(e),a=Lh(n);return i===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Y2.peek=DG;function Y2(e,n,t,i){const a=PG(t),o=t.enter("emphasis"),l=t.createTracker(i),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=hb(i.before.charCodeAt(i.before.length-1),u,a);p.inside&&(f=Zm(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=hb(i.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+Zm(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function DG(e,n,t){return t.options.emphasis||"*"}function IG(e,n){let t=!1;return Fw(e,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return t=!0,A1}),!!((!e.depth||e.depth<3)&&Pw(e)&&(n.options.setext||t))}function RG(e,n,t,i){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(i);if(IG(e,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),p(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=Zm(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}W2.peek=MG;function W2(e){return e.value||""}function MG(){return"<"}Q2.peek=OG;function Q2(e,n,t,i){const a=$w(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(i);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function OG(){return"!"}J2.peek=LG;function J2(e,n,t,i){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(i);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function LG(){return"!"}K2.peek=FG;function K2(e,n,t){let i=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(i);)a+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(i);){let u=f.index;i.charCodeAt(u)===10&&i.charCodeAt(u-1)===13&&u--,i=i.slice(0,u)+" "+i.slice(f.index+1)}}return a+i+a}function FG(){return"`"}function X2(e,n){const t=Pw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}Z2.peek=$G;function Z2(e,n,t,i){const a=$w(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(i);let d,f;if(X2(e,t)){const p=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=p,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function $G(e,n,t){return X2(e,t)?"<":"["}eE.peek=zG;function eE(e,n,t,i){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(i);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function zG(){return"["}function zw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function UG(e){const n=zw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function BG(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function tE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function qG(e,n,t,i){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?BG(t):zw(t);const d=e.ordered?l==="."?")":".":UG(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const p=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),tE(t)===l&&p){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,i);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function VG(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function HG(e,n,t,i){const a=VG(t);let o=t.bulletCurrent||zw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(i);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),p);return f(),u;function p(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function GG(e,n,t,i){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,i);return o(),a(),l}const YG=Bb(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function WG(e,n,t,i){return(e.children.some(function(l){return YG(l)})?t.containerPhrasing:t.containerFlow).call(t,e,i)}function QG(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}nE.peek=JG;function nE(e,n,t,i){const a=QG(t),o=t.enter("strong"),l=t.createTracker(i),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=hb(i.before.charCodeAt(i.before.length-1),u,a);p.inside&&(f=Zm(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=hb(i.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+Zm(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function JG(e,n,t){return t.options.strong||"*"}function KG(e,n,t,i){return t.safe(e.value,i)}function XG(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function ZG(e,n,t){const i=(tE(t)+(t.options.ruleSpaces?" ":"")).repeat(XG(t));return t.options.ruleSpaces?i.slice(0,-1):i}const iE={blockquote:SG,break:Oj,code:TG,definition:AG,emphasis:Y2,hardBreak:Oj,heading:RG,html:W2,image:Q2,imageReference:J2,inlineCode:K2,link:Z2,linkReference:eE,list:qG,listItem:HG,paragraph:GG,root:WG,strong:nE,text:KG,thematicBreak:ZG};function eY(){return{enter:{table:tY,tableData:Lj,tableHeader:Lj,tableRow:iY},exit:{codeText:rY,table:nY,tableData:A0,tableHeader:A0,tableRow:A0}}}function tY(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function nY(e){this.exit(e),this.data.inTable=void 0}function iY(e){this.enter({type:"tableRow",children:[]},e)}function A0(e){this.exit(e)}function Lj(e){this.enter({type:"tableCell",children:[]},e)}function rY(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,aY));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function aY(e,n){return n==="|"?n:e}function sY(e){const n=e||{},t=n.tableCellPadding,i=n.tablePipeAlign,a=n.stringLength,o=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:f,tableRow:d}};function l(v,S,k,T){return u(p(v,k,T),v.align)}function d(v,S,k,T){const P=g(v,k,T),M=u([P]);return M.slice(0,M.indexOf(`
`))}function f(v,S,k,T){const P=k.enter("tableCell"),M=k.enter("phrasing"),I=k.containerPhrasing(v,{...T,before:o,after:o});return M(),P(),I}function u(v,S){return vG(v,{align:S,alignDelimiters:i,padding:t,stringLength:a})}function p(v,S,k){const T=v.children;let P=-1;const M=[],I=S.enter("table");for(;++P<T.length;)M[P]=g(T[P],S,k);return I(),M}function g(v,S,k){const T=v.children;let P=-1;const M=[],I=S.enter("tableRow");for(;++P<T.length;)M[P]=f(T[P],v,S,k);return I(),M}function b(v,S,k){let T=iE.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function oY(){return{exit:{taskListCheckValueChecked:Fj,taskListCheckValueUnchecked:Fj,paragraph:cY}}}function lY(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:uY}}}function Fj(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function cY(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const i=t.children[0];if(i&&i.type==="text"){const a=n.children;let o=-1,l;for(;++o<a.length;){const d=a[o];if(d.type==="paragraph"){l=d;break}}l===t&&(i.value=i.value.slice(1),i.value.length===0?t.children.shift():t.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,t.position.start=Object.assign({},i.position.start)))}}this.exit(e)}function uY(e,n,t,i){const a=e.children[0],o=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",d=t.createTracker(i);o&&d.move(l);let f=iE.listItem(e,n,t,{...i,...d.current()});return o&&(f=f.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),f;function u(p){return p+l}}function dY(){return[qH(),uG(),pG(),eY(),oY()]}function fY(e){return{extensions:[VH(),dG(e),mG(),sY(e),lY()]}}const hY={tokenize:bY,partial:!0},rE={tokenize:vY,partial:!0},aE={tokenize:wY,partial:!0},sE={tokenize:SY,partial:!0},pY={tokenize:NY,partial:!0},oE={name:"wwwAutolink",tokenize:yY,previous:cE},lE={name:"protocolAutolink",tokenize:xY,previous:uE},Bl={name:"emailAutolink",tokenize:gY,previous:dE},Zo={};function mY(){return{text:Zo}}let Ed=48;for(;Ed<123;)Zo[Ed]=Bl,Ed++,Ed===58?Ed=65:Ed===91&&(Ed=97);Zo[43]=Bl;Zo[45]=Bl;Zo[46]=Bl;Zo[95]=Bl;Zo[72]=[Bl,lE];Zo[104]=[Bl,lE];Zo[87]=[Bl,oE];Zo[119]=[Bl,oE];function gY(e,n,t){const i=this;let a,o;return l;function l(g){return!R1(g)||!dE.call(i,i.previous)||Uw(i.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),d(g))}function d(g){return R1(g)?(e.consume(g),d):g===64?(e.consume(g),f):t(g)}function f(g){return g===46?e.check(pY,p,u)(g):g===45||g===95||Dr(g)?(o=!0,e.consume(g),f):p(g)}function u(g){return e.consume(g),a=!0,f}function p(g){return o&&a&&Wr(i.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function yY(e,n,t){const i=this;return a;function a(l){return l!==87&&l!==119||!cE.call(i,i.previous)||Uw(i.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(hY,e.attempt(rE,e.attempt(aE,o),t),t)(l))}function o(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function xY(e,n,t){const i=this;let a="",o=!1;return l;function l(g){return(g===72||g===104)&&uE.call(i,i.previous)&&!Uw(i.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),d):t(g)}function d(g){if(Wr(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),d;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),f}return t(g)}function f(g){return g===47?(e.consume(g),o?u:(o=!0,f)):t(g)}function u(g){return g===null||ub(g)||Yn(g)||Ud(g)||$b(g)?t(g):e.attempt(rE,e.attempt(aE,p),t)(g)}function p(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function bY(e,n,t){let i=0;return a;function a(l){return(l===87||l===119)&&i<3?(i++,e.consume(l),a):l===46&&i===3?(e.consume(l),o):t(l)}function o(l){return l===null?t(l):n(l)}}function vY(e,n,t){let i,a,o;return l;function l(u){return u===46||u===95?e.check(sE,f,d)(u):u===null||Yn(u)||Ud(u)||u!==45&&$b(u)?f(u):(o=!0,e.consume(u),l)}function d(u){return u===95?i=!0:(a=i,i=void 0),e.consume(u),l}function f(u){return a||i||!o?t(u):n(u)}}function wY(e,n){let t=0,i=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&i<t?o(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(sE,n,o)(l):l===null||Yn(l)||Ud(l)?n(l):(e.consume(l),a)}function o(l){return l===41&&i++,e.consume(l),a}}function SY(e,n,t){return i;function i(d){return d===33||d===34||d===39||d===41||d===42||d===44||d===46||d===58||d===59||d===63||d===95||d===126?(e.consume(d),i):d===38?(e.consume(d),o):d===93?(e.consume(d),a):d===60||d===null||Yn(d)||Ud(d)?n(d):t(d)}function a(d){return d===null||d===40||d===91||Yn(d)||Ud(d)?n(d):i(d)}function o(d){return Wr(d)?l(d):t(d)}function l(d){return d===59?(e.consume(d),i):Wr(d)?(e.consume(d),l):t(d)}}function NY(e,n,t){return i;function i(o){return e.consume(o),a}function a(o){return Dr(o)?t(o):n(o)}}function cE(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Yn(e)}function uE(e){return!Wr(e)}function dE(e){return!(e===47||R1(e))}function R1(e){return e===43||e===45||e===46||e===95||Dr(e)}function Uw(e){let n=e.length,t=!1;for(;n--;){const i=e[n][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){t=!0;break}if(i._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const CY={tokenize:DY,partial:!0};function jY(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:EY,continuation:{tokenize:AY},exit:PY}},text:{91:{name:"gfmFootnoteCall",tokenize:TY},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:_Y,resolveTo:kY}}}}function _Y(e,n,t){const i=this;let a=i.events.length;const o=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let l;for(;a--;){const f=i.events[a][1];if(f.type==="labelImage"){l=f;break}if(f.type==="gfmFootnoteCall"||f.type==="labelLink"||f.type==="label"||f.type==="image"||f.type==="link")break}return d;function d(f){if(!l||!l._balanced)return t(f);const u=Js(i.sliceSerialize({start:l.end,end:i.now()}));return u.codePointAt(0)!==94||!o.includes(u.slice(1))?t(f):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(f),e.exit("gfmFootnoteCallLabelMarker"),n(f))}}function kY(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},d=[e[t+1],e[t+2],["enter",i,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",o,n],["enter",l,n],["exit",l,n],["exit",o,n],e[e.length-2],e[e.length-1],["exit",i,n]];return e.splice(t,e.length-t+1,...d),e}function TY(e,n,t){const i=this,a=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o=0,l;return d;function d(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),f}function f(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(g){if(o>999||g===93&&!l||g===null||g===91||Yn(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(Js(i.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return Yn(g)||(l=!0),o++,e.consume(g),g===92?p:u}function p(g){return g===91||g===92||g===93?(e.consume(g),o++,u):u(g)}}function EY(e,n,t){const i=this,a=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o,l=0,d;return f;function f(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",p):t(S)}function p(S){if(l>999||S===93&&!d||S===null||S===91||Yn(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return o=Js(i.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return Yn(S)||(d=!0),l++,e.consume(S),S===92?g:p}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,p):p(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(o)||a.push(o),Sn(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function AY(e,n,t){return e.check(ug,n,e.attempt(CY,n,t))}function PY(e){e.exit("gfmFootnoteDefinition")}function DY(e,n,t){const i=this;return Sn(e,a,"gfmFootnoteDefinitionIndent",5);function a(o){const l=i.events[i.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(o):t(o)}}function IY(e){let t=(e||{}).singleTilde;const i={name:"strikethrough",tokenize:o,resolveAll:a};return t==null&&(t=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function a(l,d){let f=-1;for(;++f<l.length;)if(l[f][0]==="enter"&&l[f][1].type==="strikethroughSequenceTemporary"&&l[f][1]._close){let u=f;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[f][1].end.offset-l[f][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[f][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const p={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[f][1].end)},g={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[f][1].start)},b=[["enter",p,d],["enter",l[u][1],d],["exit",l[u][1],d],["enter",g,d]],v=d.parser.constructs.insideSpan.null;v&&$a(b,b.length,0,zb(v,l.slice(u+1,f),d)),$a(b,b.length,0,[["exit",g,d],["enter",l[f][1],d],["exit",l[f][1],d],["exit",p,d]]),$a(l,u-1,f-u+3,b),f=u+b.length-2;break}}for(f=-1;++f<l.length;)l[f][1].type==="strikethroughSequenceTemporary"&&(l[f][1].type="data");return l}function o(l,d,f){const u=this.previous,p=this.events;let g=0;return b;function b(S){return u===126&&p[p.length-1][1].type!=="characterEscape"?f(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=Lh(u);if(S===126)return g>1?f(S):(l.consume(S),g++,v);if(g<2&&!t)return f(S);const T=l.exit("strikethroughSequenceTemporary"),P=Lh(S);return T._open=!P||P===2&&!!k,T._close=!k||k===2&&!!P,d(S)}}}class RY{constructor(){this.map=[]}add(n,t,i){MY(this,n,t,i)}consume(n){if(this.map.sort(function(o,l){return o[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const i=[];for(;t>0;)t-=1,i.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];i.push(n.slice()),n.length=0;let a=i.pop();for(;a;){for(const o of a)n.push(o);a=i.pop()}this.map.length=0}}function MY(e,n,t,i){let a=0;if(!(t===0&&i.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...i);return}a+=1}e.map.push([n,t,i])}}function OY(e,n){let t=!1;const i=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&i.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const o=i.length-1;i[o]=i[o]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return i}function LY(){return{flow:{null:{name:"table",tokenize:FY,resolveAll:$Y}}}}function FY(e,n,t){const i=this;let a=0,o=0,l;return d;function d(R){let V=i.events.length-1;for(;V>-1;){const te=i.events[V][1].type;if(te==="lineEnding"||te==="linePrefix")V--;else break}const Y=V>-1?i.events[V][1].type:null,ie=Y==="tableHead"||Y==="tableRow"?F:f;return ie===F&&i.parser.lazy[i.now().line]?t(R):ie(R)}function f(R){return e.enter("tableHead"),e.enter("tableRow"),u(R)}function u(R){return R===124||(l=!0,o+=1),p(R)}function p(R){return R===null?t(R):It(R)?o>1?(o=0,i.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(R),e.exit("lineEnding"),v):t(R):fn(R)?Sn(e,p,"whitespace")(R):(o+=1,l&&(l=!1,a+=1),R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),l=!0,p):(e.enter("data"),g(R)))}function g(R){return R===null||R===124||Yn(R)?(e.exit("data"),p(R)):(e.consume(R),R===92?b:g)}function b(R){return R===92||R===124?(e.consume(R),g):g(R)}function v(R){return i.interrupt=!1,i.parser.lazy[i.now().line]?t(R):(e.enter("tableDelimiterRow"),l=!1,fn(R)?Sn(e,S,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(R):S(R))}function S(R){return R===45||R===58?T(R):R===124?(l=!0,e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),k):L(R)}function k(R){return fn(R)?Sn(e,T,"whitespace")(R):T(R)}function T(R){return R===58?(o+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),P):R===45?(o+=1,P(R)):R===null||It(R)?U(R):L(R)}function P(R){return R===45?(e.enter("tableDelimiterFiller"),M(R)):L(R)}function M(R){return R===45?(e.consume(R),M):R===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),I):(e.exit("tableDelimiterFiller"),I(R))}function I(R){return fn(R)?Sn(e,U,"whitespace")(R):U(R)}function U(R){return R===124?S(R):R===null||It(R)?!l||a!==o?L(R):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(R)):L(R)}function L(R){return t(R)}function F(R){return e.enter("tableRow"),z(R)}function z(R){return R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),z):R===null||It(R)?(e.exit("tableRow"),n(R)):fn(R)?Sn(e,z,"whitespace")(R):(e.enter("data"),$(R))}function $(R){return R===null||R===124||Yn(R)?(e.exit("data"),z(R)):(e.consume(R),R===92?B:$)}function B(R){return R===92||R===124?(e.consume(R),$):$(R)}}function $Y(e,n){let t=-1,i=!0,a=0,o=[0,0,0,0],l=[0,0,0,0],d=!1,f=0,u,p,g;const b=new RY;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(d=!1,f!==0&&($j(b,n,f,u,p),p=void 0,f=0),u={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",u,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(i=!0,g=void 0,o=[0,0,0,0],l=[0,t+1,0,0],d&&(d=!1,p={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",p,n]])),a=S.type==="tableDelimiterRow"?2:p?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(i=!1,l[2]===0&&(o[1]!==0&&(l[0]=l[1],g=Cx(b,n,o,a,void 0,g),o=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(i?i=!1:(o[1]!==0&&(l[0]=l[1],g=Cx(b,n,o,a,void 0,g)),o=l,l=[o[1],t,0,0])):S.type==="tableHead"?(d=!0,f=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(f=t,o[1]!==0?(l[0]=l[1],g=Cx(b,n,o,a,t,g)):l[1]!==0&&(g=Cx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(f!==0&&$j(b,n,f,u,p),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=OY(n.events,t))}return e}function Cx(e,n,t,i,a,o){const l=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",d="tableContent";t[0]!==0&&(o.end=Object.assign({},Ch(n.events,t[0])),e.add(t[0],0,[["exit",o,n]]));const f=Ch(n.events,t[1]);if(o={type:l,start:Object.assign({},f),end:Object.assign({},f)},e.add(t[1],0,[["enter",o,n]]),t[2]!==0){const u=Ch(n.events,t[2]),p=Ch(n.events,t[3]),g={type:d,start:Object.assign({},u),end:Object.assign({},p)};if(e.add(t[2],0,[["enter",g,n]]),i!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(o.end=Object.assign({},Ch(n.events,a)),e.add(a,0,[["exit",o,n]]),o=void 0),o}function $j(e,n,t,i,a){const o=[],l=Ch(n.events,t);a&&(a.end=Object.assign({},l),o.push(["exit",a,n])),i.end=Object.assign({},l),o.push(["exit",i,n]),e.add(t+1,0,o)}function Ch(e,n){const t=e[n],i=t[0]==="enter"?"start":"end";return t[1][i]}const zY={name:"tasklistCheck",tokenize:BY};function UY(){return{text:{91:zY}}}function BY(e,n,t){const i=this;return a;function a(f){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?t(f):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),o)}function o(f){return Yn(f)?(e.enter("taskListCheckValueUnchecked"),e.consume(f),e.exit("taskListCheckValueUnchecked"),l):f===88||f===120?(e.enter("taskListCheckValueChecked"),e.consume(f),e.exit("taskListCheckValueChecked"),l):t(f)}function l(f){return f===93?(e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),d):t(f)}function d(f){return It(f)?n(f):fn(f)?e.check({tokenize:qY},n,t)(f):t(f)}}function qY(e,n,t){return Sn(e,i,"whitespace");function i(a){return a===null?t(a):n(a)}}function VY(e){return w2([mY(),jY(),IY(e),LY(),UY()])}const HY={};function Wo(e){const n=this,t=e||HY,i=n.data(),a=i.micromarkExtensions||(i.micromarkExtensions=[]),o=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),l=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);a.push(VY(t)),o.push(dY()),l.push(fY(t))}const GY=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},YY=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},P0=({title:e,items:n,renderItemContent:t,headerAction:i,isLoading:a,loadingText:o,noDataText:l,onDeleteItem:d,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:p,onLabOrderTestChange:g,onLabOrderStatusChange:b,onEditPharmacyOrder:v,onPrintUnavailablePrescription:S,onBillLabOrder:k,onUpdateLabOrderStatus:T,onEnterLabReport:P,labInventory:M=[],isSavingLabOrder:I=!1,expandedLabReports:U={},toggleLabReport:L=()=>{}})=>{const F=w.useMemo(()=>{const $={};n.forEach(R=>{if(isNaN(R.date.getTime())){$["Unknown Date"]||($["Unknown Date"]=[]),$["Unknown Date"].push(R);return}const V=GY(R.originalDateString);$[V]||($[V]=[]),$[V].push(R)});const B=Object.keys($);return B.sort((R,V)=>{if(R==="Unknown Date")return 1;if(V==="Unknown Date")return-1;try{const Y=new Date(R.split(" ").reverse().join(" ")),ie=new Date(V.split(" ").reverse().join(" "));if(!isNaN(Y.getTime())&&!isNaN(ie.getTime()))return ie.getTime()-Y.getTime()}catch{}return V.localeCompare(R)}),B.map(R=>({date:R,items:$[R]}))},[n]),z=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return r.jsxs("div",{className:"ai-context-section",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),i]}),a&&r.jsx("p",{className:"ai-context-text italic",children:o}),!a&&n.length===0&&r.jsx("p",{className:"ai-context-text italic",children:l}),!a&&n.length>0&&r.jsx("div",{className:"space-y-3",children:F.map(({date:$,items:B})=>r.jsxs("div",{children:[r.jsx("h5",{className:"grouped-history-date",children:$}),r.jsx("div",{className:"space-y-1 grouped-history-item-container",children:B.map((R,V)=>r.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[r.jsxs("div",{className:"flex justify-between items-center w-full",children:[r.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(R,V,U,L)}),r.jsxs("div",{className:"flex items-center space-x-1",children:[R.type==="Lab Order"&&!R.data.isEditing&&f&&r.jsx("button",{onClick:()=>f(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:I,children:r.jsx(Ml,{size:14})}),R.type==="Lab Order"&&R.data.isEditing&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>u&&u(R.data.id,R.data.editedTests,R.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:I,children:r.jsx(Fd,{size:14})}),r.jsx("button",{onClick:()=>p&&p(R.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:I,children:r.jsx(lr,{size:14})})]}),R.type==="Lab Order"&&r.jsxs("div",{className:"lab-table-actions",children:[R.data.status==="pending"&&k&&(()=>{const Y=R.data.tests.reduce((ie,te)=>ie+(Number(te.price)||0),0).toFixed(2);return r.jsxs("button",{onClick:()=>k(R.data),className:"lab-action-button btn-bill",title:`Pay total of ${Y}`,children:["Pay (",Y,")"]})})(),R.data.status==="billed"&&T&&r.jsx("button",{onClick:()=>T(R.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),R.data.status==="collected"&&T&&r.jsx("button",{onClick:()=>T(R.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),["pending","billed","collected","processing","report_ready","reported","completed"].includes(R.data.status)&&P&&r.jsx("button",{onClick:()=>P(R.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(R.data.status==="report_ready"||R.data.status==="reported")&&T&&r.jsx("button",{onClick:()=>T(R.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"})]}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&v&&r.jsx("button",{onClick:()=>v(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:I,children:r.jsx(Ml,{size:14})}),R.type==="Pharmacy Order"&&R.data.prescriptionForUnavailableDrugs&&S&&r.jsx("button",{onClick:()=>S(R.data.prescriptionForUnavailableDrugs,`Prescription for Order ${R.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:I,children:r.jsx(Kc,{size:14})}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&d&&r.jsx("button",{onClick:()=>d({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:I,children:r.jsx(lr,{size:14})}),d&&["Complaint","Lab Order","Lab Report"].includes(R.type)&&r.jsx("button",{onClick:()=>d({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${R.type.toLowerCase()}`,disabled:I,children:r.jsx(lr,{size:14})})]})]}),R.type==="Lab Order"&&R.data.isEditing&&r.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[r.jsxs("div",{className:"mb-2",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),r.jsx("select",{value:R.data.editedStatus||R.data.status,onChange:Y=>b&&b(R.data.id,Y.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:I,children:z.map(Y=>r.jsx("option",{value:Y,children:Y.replace(/_/g," ")},Y))})]}),r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),R.data.editedTests.map((Y,ie)=>r.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[r.jsxs("select",{value:Y.id,onChange:te=>{const W=M.find(H=>String(H.id)===te.target.value);W&&(g&&g(R.data.id,ie,"id",W.id),g&&g(R.data.id,ie,"name",W.name),g&&g(R.data.id,ie,"price",W.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:I,children:[r.jsx("option",{value:"",children:"Select Test"}),M.map(te=>r.jsxs("option",{value:te.id,children:[te.name," (",te.price,")"]},te.id))]}),r.jsx("button",{onClick:()=>{const te=R.data.editedTests.filter((W,H)=>H!==ie);g&&g(R.data.id,-1,"remove",te)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:I,children:r.jsx(lr,{size:14})})]},ie)),r.jsx("button",{onClick:()=>{g&&g(R.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:I,children:"Add Test"})]})]},`${R.type}-${R.originalDateString}-${V}`))})]},$))})]})},WY="_modalOverlay_1yna4_3",QY="_modalContent_1yna4_29",JY="_modalHeader_1yna4_57",KY="_modalTitle_1yna4_75",XY="_modalCloseButton_1yna4_87",ZY="_modalBody_1yna4_115",eW="_errorText_1yna4_129",tW="_formGroup_1yna4_147",nW="_inputField_1yna4_171",iW="_searchResultsCard_1yna4_213",rW="_searchResultsList_1yna4_241",aW="_searchResultItem_1yna4_253",sW="_searchResultPrice_1yna4_289",oW="_selectedTestsCard_1yna4_299",lW="_selectedTestsHeader_1yna4_319",cW="_noTestsMessage_1yna4_335",uW="_selectedTestsList_1yna4_351",dW="_selectedTestItem_1yna4_363",fW="_selectedTestName_1yna4_387",hW="_selectedTestPrice_1yna4_399",pW="_removeTestButton_1yna4_411",mW="_totalAmount_1yna4_437",gW="_modalFooter_1yna4_455",yW="_button_1yna4_473",xW="_buttonPrimary_1yna4_491",bW="_buttonSecondary_1yna4_513",jt={modalOverlay:WY,modalContent:QY,modalHeader:JY,modalTitle:KY,modalCloseButton:XY,modalBody:ZY,errorText:eW,formGroup:tW,inputField:nW,searchResultsCard:iW,searchResultsList:rW,searchResultItem:aW,searchResultPrice:sW,selectedTestsCard:oW,selectedTestsHeader:lW,noTestsMessage:cW,selectedTestsList:uW,selectedTestItem:dW,selectedTestName:fW,selectedTestPrice:hW,removeTestButton:pW,totalAmount:mW,modalFooter:gW,button:yW,buttonPrimary:xW,buttonSecondary:bW},vW=({isOpen:e,onClose:n,patientId:t,labInventory:i,fetchPendingLabOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,p]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){p([]);return}const M=d.toLowerCase();p(i.filter(I=>I.name.toLowerCase().includes(M)||I.description&&I.description.toLowerCase().includes(M)).slice(0,10))},[d,i]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const M={patient_id:t,tests:o.map(U=>({id:U.id,name:U.name,price:U.price}))},I=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!I.ok){const U=await I.json().catch(()=>({}));throw new Error(U.message||`Failed to create lab order: ${I.statusText}`)}await I.json(),a(t),n(),l([]),f("")}catch(M){b(`Lab Order Creation Error: ${M.message}`)}finally{S(!1)}},T=M=>{if(o.some(I=>I.id===M.id)){b(`${M.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),p([]);return}l(I=>[...I,{...M}]),f(""),p([])},P=M=>{l(I=>I.filter(U=>U.id!==M))};return e?r.jsx("div",{className:jt.modalOverlay,children:r.jsxs("div",{className:jt.modalContent,children:[r.jsxs("div",{className:jt.modalHeader,children:[r.jsx("h3",{className:jt.modalTitle,children:"Create New Lab Order"}),r.jsx("button",{onClick:n,className:jt.modalCloseButton,children:r.jsx(ni,{size:20})})]}),r.jsxs("div",{className:jt.modalBody,children:[g&&r.jsx("div",{className:jt.errorText,children:g}),r.jsxs("div",{className:jt.formGroup,style:{position:"relative"},children:[r.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),r.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:d,onChange:M=>f(M.target.value),className:jt.inputField}),d&&u.length>0&&r.jsx("div",{className:jt.searchResultsCard,children:r.jsx("ul",{className:jt.searchResultsList,children:u.map(M=>r.jsxs("li",{onClick:()=>T(M),className:jt.searchResultItem,children:[r.jsx("span",{children:M.name}),r.jsxs("span",{className:jt.searchResultPrice,children:["(",parseFloat(String(M.price)).toFixed(2),")"]})]},M.id))})})]}),r.jsxs("div",{className:jt.selectedTestsCard,children:[r.jsx("h4",{className:jt.selectedTestsHeader,children:"Selected Tests"}),o.length===0?r.jsx("p",{className:jt.noTestsMessage,children:"No tests added yet."}):r.jsx("ul",{className:jt.selectedTestsList,children:o.map(M=>r.jsxs("li",{className:jt.selectedTestItem,children:[r.jsx("span",{className:jt.selectedTestName,children:M.name}),r.jsxs("span",{className:jt.selectedTestPrice,children:["",parseFloat(String(M.price)).toFixed(2)]}),r.jsx("button",{type:"button",onClick:()=>P(String(M.id)),className:jt.removeTestButton,title:"Remove Test",children:r.jsx(lr,{size:16})})]},M.id))})]}),o.length>0&&r.jsxs("div",{className:jt.totalAmount,children:["Total: ",o.reduce((M,I)=>M+parseFloat(String(I.price)),0).toFixed(2)]})]}),r.jsxs("div",{className:jt.modalFooter,children:[r.jsx("button",{type:"button",onClick:n,className:`${jt.button} ${jt.buttonSecondary}`,children:" Cancel "}),r.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${jt.button} ${jt.buttonPrimary} ${o.length===0||v?jt.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},jx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},Vx=(e,n)=>{if(!e||!n||n.length===0)return;const t=jx(e);let i=n.find(l=>jx(l.name)===t);if(i)return i;let a=n.find(l=>jx(l.name).includes(t));if(a)return a;let o=n.find(l=>t.includes(jx(l.name)));if(o)return o},wW=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's unit/pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this *separate* tool format (a single JSON object, NOT inside the array) only when you need clarification or missing information that prevents you from completing the assessment or required actions.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"] // Optional: Provide 2-5 choices
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,zj="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",SW="gemini-2.5-flash";async function NW(){const e=VT();if(!e)return console.warn("No auth token found, using default Gemini API key."),zj;try{const t=(await pi.get("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).data.gemini_api_key;if(t)return t;const a=(await pi.get("/api/global-settings/app_gemini_api_key",{headers:{Authorization:`Bearer ${e}`}})).data.value;if(a)return a}catch(n){console.warn("Failed to fetch clinic-specific or global Gemini API key, trying fallback.",n)}return console.warn("Clinic-specific and global Gemini API keys not found, using default env var."),zj}let D0=null;async function CW(){if(!D0){const e=await NW();D0=new pT({apiKey:e})}return D0}async function jW(e,n){const{query:t,currentDateTime:i,patientName:a,patientAge:o,patientGender:l,case_summary:d,case_summary_last_updated:f,clinic_ai_memory:u,clinic_ai_memory_last_updated:p,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,pharmacyInventory:k,labInventory:T}=e;let P=`Patient Complaint: ${t}`;if(d&&(P+=`

--- Case Summary (Provided by Doctor) ---
${d}`,f))try{const R=new Date(f).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${R})`}catch{console.warn(`Could not format case_summary_last_updated: ${f}`),P+=`
(Last Updated: ${f})`}if(a&&(P+=`

Patient Name: ${a}`),o!=null&&(P+=`
Patient Age: ${o}`),l&&(P+=`
Patient Gender: ${l}`),i)try{const R=new Date(i).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`

Current Interaction Time: ${R}`}catch{console.warn(`Could not format currentDateTime: ${i}`),P+=`

Current Interaction Time: ${i}`}if(u&&(P+=`

--- Clinic-wide AI Memory/Context ---
${u}`,p))try{const R=new Date(p).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${R})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${p}`),P+=`
(Last Updated: ${p})`}let M="";b&&Array.isArray(b)&&b.length>0&&(M=`

--- Lab History (Orders & Reports) ---
`,b.forEach(R=>{let V="Unknown Date";try{V=new Date(R.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${R.orderDate}`)}if(M+=`
Order #${R.serialNumber} Date: ${V} (Status: ${R.status})
`,M+=`Tests: ${R.tests.map(Y=>Y.name).join(", ")}
`,R.report){let Y="Unknown Date";try{Y=new Date(R.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${R.report.reportDate}`)}M+=`  -> Report Date: ${Y}
`,R.report.tests&&Array.isArray(R.report.tests)?(M+=`     Findings:
`,R.report.tests.forEach(ie=>{M+=`       - Test: ${ie.testName}
`,ie.parameters&&Array.isArray(ie.parameters)&&ie.parameters.forEach(te=>{M+=`         - ${te.name}: ${te.value} (Normal: ${te.normal_range})
`})})):(M+=`     Findings: ${R.report.reportContent||"N/A"}
`,R.report.error&&(M+=`     Note: ${R.report.error}
`))}M+=`---
`}),P+=M);let I="";v&&Array.isArray(v)&&v.length>0&&(I=`

--- Recent Pharmacy Orders ---
`,v.forEach(R=>{let V="Unknown Date/Time";try{V=new Date(R.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${R.date}`)}I+=`
Order #${R.serialNumber} Date/Time: ${V} (Status: ${R.status})
`,I+=`Prescribed By: ${R.prescribedBy||"N/A"}
`,R.dispensedBy&&(I+=`Dispensed By: ${R.dispensedBy}
`),I+=`Medications:
`,R.medications.forEach(Y=>{I+=`  - ${Y.name} (Qty: ${Y.quantity}`,Y.tabletsPerDay&&(I+=`, ${Y.tabletsPerDay}/day`),Y.numberOfDays&&(I+=` for ${Y.numberOfDays} days`),I+=`)
`}),R.prescriptionForUnavailableDrugs&&(I+=`  Prescription for Unavailable Drugs: ${R.prescriptionForUnavailableDrugs}
`),I+=`---
`}),P+=I);let U="";S&&Array.isArray(S)&&S.length>0&&(U=`

--- Past Complaints History ---
`,S.forEach(R=>{let V="Unknown Date/Time";try{V=new Date(R.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${R.createdAt}`)}U+=`
Date/Time: ${V}
Complaint: ${R.complaint||"N/A"}
---
`}),P+=U);let L="";k&&Array.isArray(k)&&k.length>0&&(L=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(R=>{L+=`- ${R.name} (Pack: ${R.unit??"N/A"}): ${R.quantity_in_stock??"N/A"}
`}),P+=L);let F="";T&&Array.isArray(T)&&T.length>0&&(F=`

--- Available Lab Tests ---
`,T.forEach(R=>{F+=`- ${R.name} (Price: ${R.price??"N/A"})
`}),P+=F);const z=[{text:wW}];g&&g.trim()!==""&&z.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const $=[{text:P}];if(n){const R=new FileReader,V=await new Promise((Y,ie)=>{R.onloadend=()=>{typeof R.result=="string"?Y(R.result.split(",")[1]):ie(new Error("Failed to read image file as base64."))},R.onerror=ie,R.readAsDataURL(n)});$.push({inlineData:{mimeType:n.type,data:V}})}const B=[];z.length>0&&B.push({role:"user",parts:z}),B.push({role:"user",parts:$});try{const R={model:SW,contents:B,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},Y=await(await CW()).models.generateContentStream(R);let ie="";for await(const te of Y)if(te&&typeof te.text=="function"){const W=te.text;W&&(ie+=W)}else te&&te.candidates&&te.candidates[0]&&te.candidates[0].content&&te.candidates[0].content.parts&&te.candidates[0].content.parts[0]&&te.candidates[0].content.parts[0].text&&(ie+=te.candidates[0].content.parts[0].text);if(ie&&ie.trim()!=="")return ie.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(R){console.error("Error calling Gemini API:",R);let V="Failed to get suggestion from Gemini.";throw R.message&&(V=`Error processing Gemini request: ${R.message}`),new Error(V)}}const _W=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},kW=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:i,caseSummaryUpdatedAt:a,clinicSettings:o,userMessages:l,selectedImageFile:d,pendingLabOrders:f,labReports:u,pastComplaints:p,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,currentComplaint:S,setCurrentComplaint:k,setAiResponse:T,setAiResponseText:P,setAiResponseJsonString:M,setShowAiJsonDetails:I,setIsLoadingAi:U,setAiError:L,setIsSubmittingAiOrder:F,setAiOrderSubmissionStatus:z,setIsSubmittingAiLabOrder:$,setAiLabOrderSubmissionStatus:B,setIsSubmittingAiComplaint:R,setAiComplaintSubmissionStatus:V,setIsUpdatingCaseSummary:Y,setAiCaseSummaryUpdateStatus:ie,setCaseSummary:te,setIsUpdatingAiMemoryByAI:W,setAiMemoryUpdateByAIStatus:H,setFollowUpQuestion:Q,setFollowUpOptions:J,setError:fe,setIsSavingAiResponse:A,setSaveAiResponseError:oe,fetchPharmacyOrdersData:ue,fetchPendingLabOrdersData:D,fetchPastComplaintsData:se,fetchPatientDetails:be,setClinicSettings:ee,setEditedAiMemory:ce,setCanUndo:re,onAiActionSuccess:Pe},Qe)=>{const[Se,Ne]=wn.useState(null);wn.useEffect(()=>{re(!!Se)},[Se,re]);let De;const Me=async(Nt,Ft,ye,Te=0)=>{let Ye;const _e=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(X=>{var de;return(de=Ft.message)==null?void 0:de.includes(X)});ye&&_e?Ye=`AI Error: ${Ft.message}

${ye}`:(Ye=`I encountered a frontend error while trying to execute the '${Nt}' function. The error message is: "${Ft.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(Nt==="create_pharmacy_order"||Nt==="edit_pharmacy_order")&&(Ye+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),ye&&(Ye+=`

The original AI response that caused the error was:
\`\`\`
${ye}
\`\`\``)),await De(Ye,Te+1)},nt=async Nt=>{console.log("Executing Rollback for actions:",Nt);for(const Ft of Nt){const{actionType:ye,undoData:Te}=Ft;if(Te){console.log(`Rolling back ${ye}...`);try{if(ye==="create_pharmacy_order"&&(Te!=null&&Te.orderId))await pe(`/api/pharmacy-orders/${Te.orderId}`,{method:"DELETE"}),ue(n);else if(ye==="create_lab_order"&&(Te!=null&&Te.orderId))await pe(`/api/lab/orders/${Te.orderId}`,{method:"DELETE"}),D(n);else if(ye==="update_patient_details"&&(Te!=null&&Te.patientId)&&(Te!=null&&Te.originalDetails))await pe(`/api/patients/${Te.patientId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Te.originalDetails)}),be(Te.patientId);else if(ye==="add_complaint_history"&&(Te!=null&&Te.recordId))await pe(`/api/queue/doctor/complaint/${Te.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:Te.originalComplaint})}),k(Te.originalComplaint);else if(ye==="update_case_summary"&&(Te!=null&&Te.recordId))await pe(`/api/queue/doctor/complaint/${Te.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:Te.originalSummary})}),te(Te.originalSummary);else if(ye==="update_clinic_ai_memory"&&(Te==null?void 0:Te.originalMemory)!==void 0)await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify({...o,aiMemory:Te.originalMemory})}),ce(Te.originalMemory);else if(ye==="edit_pharmacy_order"&&(Te!=null&&Te.orderId)&&(Te!=null&&Te.originalState)){const Ye={items:Te.originalState.medications||[],status:Te.originalState.status,prescription_for_unavailable_drugs:Te.originalState.prescription_for_unavailable_drugs,order_total:Te.originalState.order_total};await pe(`/api/pharmacy-orders/${Te.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ye)}),ue(n)}else if(ye==="edit_lab_order"&&(Te!=null&&Te.orderId)&&(Te!=null&&Te.originalState)){const Ye={tests:Te.originalState.tests,status:Te.originalState.status};await pe(`/api/lab/orders/${Te.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ye)}),D(n)}}catch(Ye){console.error(`Failed to rollback ${ye}:`,Ye)}}}},ft=async()=>{!Se||!window.confirm("Are you sure you want to undo the last AI actions?")||(U(!0),await nt([...Se].reverse()),Ne(null),U(!1),L("Last actions undone successfully."))},ut=async(Nt,Ft)=>{Ne(null),z(null),B(null),V(null),ie(null),H(null),Q(null),J([]),fe(null);let ye=null;const Te=/```json\s*([\s\S]*?)\s*```/,Ye=Nt.match(Te);if(Ye&&Ye[1])ye=Ye[1];else{const $e=Nt.trim();if($e.startsWith("{")&&$e.endsWith("}"))ye=$e;else if($e.startsWith("[")&&$e.endsWith("]"))ye=$e;else throw new Error("AI response did not contain a recognized function call.")}if(ye)try{const $e=JSON.parse(ye),_e=Array.isArray($e)?$e:[$e],X=[];let de=null,qe=!1;for(const Fe of _e){if(Fe.action==="ask_followup_question"){de=Fe,qe=!0;continue}qe=!0;const ot=Fe.action;ot==="update_clinic_ai_memory"&&typeof Fe.memory_content=="string"?X.push((async()=>{W(!0),H("Processing AI mem...");const ve=(o==null?void 0:o.aiMemory)||"";try{if(!o)throw new Error("Clinic settings not loaded.");const xe={...o,aiMemory:Fe.memory_content.trim(),admissionCharge:o.admissionCharge,perDayCharge:o.perDayCharge,otherCharges:o.otherCharges,clinicWideSystemPrompt:o.clinicWideSystemPrompt},Be=await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(xe)});if(!Be.ok){const tt=await Be.json().catch(()=>({}));throw new Error(tt.message||`AI-triggered clinic memory update failed: ${Be.statusText}`)}const Ue=await Be.json();return ee(tt=>tt?{...tt,aiMemory:Ue.settings.aiMemory}:null),ce(Ue.settings.aiMemory||""),H("AI mem updated!"),{success:!0,actionType:ot,undoData:{originalMemory:ve}}}catch(xe){return H("Failed"),{success:!1,actionType:ot,error:xe,originalActionPayload:Fe}}finally{W(!1)}})()):ot==="create_pharmacy_order"?X.push((async()=>{var ve,xe;F(!0),z("Processing order...");try{if(!n)throw new Error("Missing patient ID.");const Be=[];let Ue=null;if(Array.isArray(Fe.items))for(const Tt of Fe.items){let Rt;if(Tt.drug_id?Rt=b.find(bi=>bi.id===Tt.drug_id):Tt.name&&(Rt=Vx(Tt.name,b)),!Rt){Ue=`Drug "${Tt.name||Tt.drug_id}" not found.`;break}const si=_W(Rt.unit),ki=Number(Rt.price),bn=ki,Ti=si>0?ki/si:0,rn=Number(Tt.pack_quantity)||0,ps=Number(Tt.loose_quantity)||0,ql=rn*bn+ps*Ti;Be.push({drug_id:String(Rt.id),name:Rt.name,pack_quantity:rn,loose_quantity:ps,tabletsPerDay:Tt.tabletsPerDay,numberOfDays:Tt.numberOfDays,directions_to_use:Tt.directions_to_use,group_id:Tt.group_id,pack_price:bn,loose_price:Ti,total_price:ql,price:ki,isLoose:Tt.isLoose,unit:Rt.unit})}if(Ue)throw new Error(Ue);const tt=Be.reduce((Tt,Rt)=>Tt+Rt.total_price,0),dt={patient_id:n,items:Be,prescription_for_unavailable_drugs:Fe.prescription_for_unavailable_drugs,order_total:parseFloat(tt.toFixed(2))},qt=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(dt)});if(!qt.ok){const Tt=await qt.json().catch(()=>({}));throw new Error(Tt.message||"Order creation failed.")}const On=await qt.json();return z("Order created!"),ue(n),{success:!0,actionType:ot,data:On,undoData:{orderId:((xe=(ve=On.orders)==null?void 0:ve[0])==null?void 0:xe.id)||On.id}}}catch(Be){return{success:!1,actionType:ot,error:Be,originalActionPayload:Fe}}finally{F(!1)}})()):ot==="update_patient_details"?X.push((async()=>{U(!0);const ve={...t};try{if(!n)throw new Error("Missing patient ID.");const xe={};if(Fe.name&&(xe.name=Fe.name),Fe.age&&(xe.age=Fe.age),Fe.gender&&(xe.gender=Fe.gender),Fe.phone_number!==void 0&&(xe.phone_number=Fe.phone_number),!(await pe(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)})).ok)throw new Error("Patient update failed.");return be(n),{success:!0,actionType:ot,undoData:{patientId:n,originalDetails:ve}}}catch(xe){return{success:!1,actionType:ot,error:xe,originalActionPayload:Fe}}finally{U(!1)}})()):ot==="create_lab_order"?X.push((async()=>{$(!0),B("Processing lab...");try{if(!n)throw new Error("Missing patient ID.");const ve=[];for(const Ue of Fe.tests||[]){let tt;if(Ue.id?tt=v.find(dt=>String(dt.id)===String(Ue.id)):Ue.name&&(tt=Vx(Ue.name,v)),!tt)throw new Error(`Lab test "${Ue.name}" not found.`);ve.push({id:tt.id,name:tt.name,price:Number(tt.price)})}const xe=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:ve})});if(!xe.ok)throw new Error("Lab order creation failed.");const Be=await xe.json();return B("Success!"),D(n),{success:!0,actionType:ot,data:Be.labOrder,undoData:{orderId:Be.labOrder.id}}}catch(ve){return{success:!1,actionType:ot,error:ve,originalActionPayload:Fe}}finally{$(!1)}})()):ot==="edit_pharmacy_order"?X.push((async()=>{F(!0);try{const ve=Fe.serialNumber;let xe;if(ve?xe=[...g].sort((Rt,si)=>new Date(Rt.date).getTime()-new Date(si.date).getTime())[ve-1]:xe=g.find(Tt=>Tt.status==="pending"),!xe)throw new Error("Order to edit not found.");const Be=JSON.parse(JSON.stringify(xe));let Ue=[...xe.medications];const tt=Fe.items_to_remove,dt=Fe.items;if(Array.isArray(tt)&&(Ue=Ue.filter(Tt=>!tt.some(Rt=>Rt.drug_id&&String(Tt.drug_id)===String(Rt.drug_id)||Rt.name&&Tt.name.toLowerCase()===Rt.name.toLowerCase()))),Array.isArray(dt))for(const Tt of dt){let Rt;if(Tt.drug_id?Rt=b.find(bn=>String(bn.id)===String(Tt.drug_id)):Tt.name&&(Rt=Vx(Tt.name,b)),!Rt)throw new Error(`Drug ${Tt.name} not found.`);const si=Ue.findIndex(bn=>bn.drug_id===String(Rt==null?void 0:Rt.id)),ki={drug_id:String(Rt.id),name:Rt.name,pack_quantity:Tt.pack_quantity||0,loose_quantity:Tt.loose_quantity||0,pack_price:Number(Rt.price),loose_price:0,total_price:0,price:Number(Rt.price)};si>=0?Ue[si]={...Ue[si],...ki}:Ue.push(ki)}const qt={items:Ue,status:Fe.status,prescription_for_unavailable_drugs:Fe.prescription_for_unavailable_drugs,order_total:0};if(!(await pe(`/api/pharmacy-orders/${xe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(qt)})).ok)throw new Error("Order edit failed.");return ue(n),{success:!0,actionType:ot,undoData:{orderId:xe.id,originalState:Be}}}catch(ve){return{success:!1,actionType:ot,error:ve,originalActionPayload:Fe}}finally{F(!1)}})()):ot==="edit_lab_order"?X.push((async()=>{$(!0);try{const ve=f.sort((tt,dt)=>new Date(dt.createdAt).getTime()-new Date(tt.createdAt).getTime()).find(tt=>tt.status==="pending");if(!ve)throw new Error("No pending lab order to edit.");const xe=JSON.parse(JSON.stringify(ve)),Be={tests:[],status:Fe.status};if(!(await pe(`/api/lab/orders/${ve.id}`,{method:"PUT",body:JSON.stringify(Be),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Lab edit failed.");return D(n),{success:!0,actionType:ot,undoData:{orderId:ve.id,originalState:xe}}}catch(ve){return{success:!1,actionType:ot,error:ve,originalActionPayload:Fe}}finally{$(!1)}})()):ot==="add_complaint_history"?X.push((async()=>{R(!0);const ve=S;try{if(!e)throw new Error("No record ID.");if(!(await pe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({complaint:Fe.complaint}),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Complaint update failed.");return k(Fe.complaint),n&&se(n),{success:!0,actionType:ot,undoData:{recordId:e,originalComplaint:ve}}}catch(xe){return{success:!1,actionType:ot,error:xe,originalActionPayload:Fe}}finally{R(!1)}})()):ot==="update_case_summary"?X.push((async()=>{Y(!0);const ve=i;try{if(!e)throw new Error("No record ID.");const xe=await pe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({case_summary:Fe.summary}),headers:{"Content-Type":"application/json"}});if(!xe.ok)throw new Error("Summary update failed.");const Be=await xe.json();return te(Be.case_summary),{success:!0,actionType:ot,undoData:{recordId:e,originalSummary:ve}}}catch(xe){return{success:!1,actionType:ot,error:xe,originalActionPayload:Fe}}finally{Y(!1)}})()):(console.warn(`Unknown action ${ot}`),X.push(Promise.resolve({success:!1,actionType:ot,error:new Error(`Unknown action: ${ot}`),originalActionPayload:Fe})))}const et=await Promise.all(X),ct=et.filter(Fe=>!Fe.success);if(ct.length>0){console.log("AI Actions Failed. Initiating Rollback...",ct);const Fe=et.filter(Ue=>Ue.success),ot=[...Fe].reverse();await nt(ot);const ve=ct.map(Ue=>{var tt;return`${Ue.actionType}: ${(tt=Ue.error)==null?void 0:tt.message}`}).join("; "),xe=Fe.length>0?` I successfully rolled back ${Fe.length} other actions that succeeded.`:"",Be=`One or more actions failed: [${ve}].${xe} Please analyze the failure and try again.`;await Me("multiple_actions",{message:Be},Nt,Ft)}else{const Fe=et.filter(ot=>ot.success);if(Fe.length>0&&(Ne(Fe),Pe&&Fe.forEach(ot=>Pe(ot.actionType))),de&&typeof de.question=="string")Q(de.question),J(Array.isArray(de.options)?de.options:[]);else if(!qe)throw new Error("AI response did not result in a recognized or performed function call.")}}catch($e){await Me("parse_json_actions",$e,Nt,Ft)}else throw new Error("AI response did not contain a recognized function call.")};De=async(Nt,Ft=0)=>{if(Ft>1){L("AI call failed after multiple retries. Please try a different prompt."),U(!1);return}U(!0),L(null);let ye;const Ye=[...l,Nt].join(`

`);try{const $e=new Map;(f??[]).forEach(Fe=>{$e.set(Fe.id,{...Fe})}),(u??[]).forEach(Fe=>{if(!$e.has(Fe.id))$e.set(Fe.id,{id:Fe.id,patient_id:Fe.patient_id,tests:Fe.tests,status:Fe.status,createdAt:Fe.createdAt,report:Fe});else{const ot=$e.get(Fe.id);ot&&(ot.report=Fe,ot.status=Fe.status)}});const _e=Array.from($e.values());_e.sort((Fe,ot)=>new Date(ot.createdAt).getTime()-new Date(Fe.createdAt).getTime());const X=_e.map((Fe,ot)=>{let ve=null;if(Fe.report)try{const xe=typeof Fe.report.report_content=="string"?Fe.report.report_content:JSON.stringify(Fe.report.report_content||{}),Be=JSON.parse(xe||"{}"),Ue=(Fe.report.tests||[]).map(tt=>{const dt=Be[tt.id]||{},qt=On=>({name:On.name,value:dt[On.name]!==void 0?String(dt[On.name]):String(On.defaultValue),normal_range:On.normal_range||"N/A"});return{testId:tt.id,testName:tt.name,parameters:(tt.default_parameters||[]).map(qt)}});ve={reportId:Fe.report.reportId,reportDate:Fe.report.report_date,tests:Ue}}catch{ve={reportId:Fe.report.reportId,reportDate:Fe.report.report_date,reportContent:typeof Fe.report.report_content=="string"?Fe.report.report_content:JSON.stringify(Fe.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:_e.length-ot,orderId:Fe.id,orderDate:isNaN(new Date(Fe.createdAt).getTime())?Fe.createdAt:new Date(Fe.createdAt).toISOString(),tests:Fe.tests.map(xe=>({id:xe.id,name:xe.name,price:xe.price})),status:Fe.status,report:ve}}),de=p.map(Fe=>{try{return{...Fe,createdAt:isNaN(new Date(Fe.createdAt).getTime())?Fe.createdAt:new Date(Fe.createdAt).toISOString()}}catch{return Fe}}),et=[...g].sort((Fe,ot)=>{const ve=new Date(Fe.date).getTime(),xe=new Date(ot.date).getTime();return ve-xe}).map((Fe,ot)=>{try{return{serialNumber:ot+1,...Fe,date:Fe.date&&!isNaN(new Date(Fe.date).getTime())?new Date(Fe.date).toISOString():Fe.date}}catch{return{serialNumber:ot+1,...Fe}}}),ct={query:Ye,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:i||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(o==null?void 0:o.aiMemory)||"",clinic_ai_memory_last_updated:o!=null&&o.aiMemoryUpdatedAt?new Date(o.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(o==null?void 0:o.clinicWideSystemPrompt)||"",labHistory:X,pharmacyOrders:et,pastComplaints:de,pharmacyInventory:b,labInventory:v};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(ct,null,2)),ye=await jW(ct,d),ye){T(ye);const Fe=/```json\s*([\s\S]*?)\s*```/,ot=ye.match(Fe);if(ot&&ot[1])P(ye.replace(Fe,"").trim()),M(ot[1].trim());else{const ve=ye.trim();if(ve.startsWith("{")&&ve.endsWith("}"))try{JSON.parse(ve),P(""),M(ve)}catch{P(ve),M(null)}else if(ve.startsWith("[")&&ve.endsWith("]"))try{JSON.parse(ve),P(""),M(ve)}catch{P(ve),M(null)}else P(ve),M(null)}I(!1),n&&ye&&await rt(n,ye),await ut(ye,Ft),k("")}else throw new Error("Invalid AI response format.")}catch($e){await Me("call_generative_api",$e,ye,Ft)}finally{U(!1)}};const rt=async(Nt,Ft)=>{A(!0),oe(null);try{const ye={ai_response:Ft},Te=await pe(`/api/patients/${Nt}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ye)});if(!Te.ok){const Ye=await Te.json().catch(()=>({}));throw new Error(Ye.message||`Failed to save AI response to patient: ${Te.statusText}`)}}catch(ye){oe(`AI Response Save Error: ${ye.message}`)}finally{A(!1)}};return w.useImperativeHandle(Qe,()=>({callGenerativeApi:De,undoLastAction:ft})),null}),TW={};function Bw(e,n){const t=TW,i=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return fE(e,i,a)}function fE(e,n,t){if(EW(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Uj(e.children,n,t)}return Array.isArray(e)?Uj(e,n,t):""}function Uj(e,n,t){const i=[];let a=-1;for(;++a<e.length;)i[a]=fE(e[a],n,t);return i.join("")}function EW(e){return!!(e&&typeof e=="object")}const Bj=document.createElement("i");function qw(e){const n="&"+e+";";Bj.innerHTML=n;const t=Bj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Xo(e,n,t,i){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,i.length<1e4)l=Array.from(i),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<i.length;)l=i.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function ls(e,n){return e.length>0?(Xo(e,e.length,0,n),e):n}const qj={}.hasOwnProperty;function AW(e){const n={};let t=-1;for(;++t<e.length;)PW(n,e[t]);return n}function PW(e,n){let t;for(t in n){const a=(qj.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){qj.call(a,l)||(a[l]=[]);const d=o[l];DW(a[l],Array.isArray(d)?d:d?[d]:[])}}}function DW(e,n){let t=-1;const i=[];for(;++t<n.length;)(n[t].add==="after"?e:i).push(n[t]);Xo(e,0,0,i)}function hE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Eh(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Qo=cu(/[A-Za-z]/),Oa=cu(/[\dA-Za-z]/),IW=cu(/[#-'*+\--9=?A-Z^-~]/);function M1(e){return e!==null&&(e<32||e===127)}const O1=cu(/\d/),RW=cu(/[\dA-Fa-f]/),MW=cu(/[!-/:-@[-`{-~]/);function Ut(e){return e!==null&&e<-2}function fa(e){return e!==null&&(e<0||e===32)}function Dn(e){return e===-2||e===-1||e===32}const OW=cu(new RegExp("\\p{P}|\\p{S}","u")),LW=cu(/\s/);function cu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Wh(e){const n=[];let t=-1,i=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Oa(e.charCodeAt(t+1))&&Oa(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(i,t),encodeURIComponent(l)),i=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(i)}function ii(e,n,t,i){const a=i?i-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return Dn(f)?(e.enter(t),d(f)):n(f)}function d(f){return Dn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const FW={tokenize:$W};function $W(e){const n=e.attempt(this.parser.constructs.contentInitial,i,a);let t;return n;function i(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),ii(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Ut(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const zW={tokenize:UW},Vj={tokenize:BW};function UW(e){const n=this,t=[];let i=0,a,o,l;return d;function d(I){if(i<t.length){const U=t[i];return n.containerState=U[1],e.attempt(U[0].continuation,f,u)(I)}return u(I)}function f(I){if(i++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const U=n.events.length;let L=U,F;for(;L--;)if(n.events[L][0]==="exit"&&n.events[L][1].type==="chunkFlow"){F=n.events[L][1].end;break}P(i);let z=U;for(;z<n.events.length;)n.events[z][1].end={...F},z++;return Xo(n.events,L+1,0,n.events.slice(U)),n.events.length=z,u(I)}return d(I)}function u(I){if(i===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(Vj,p,g)(I)}function p(I){return a&&M(),P(i),b(I)}function g(I){return n.parser.lazy[n.now().line]=i!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(Vj,v,S)(I)}function v(I){return i++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&M(),P(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(I);return}return Ut(I)?(e.consume(I),T(e.exit("chunkFlow")),i=0,n.interrupt=void 0,d):(e.consume(I),k)}function T(I,U){const L=n.sliceStream(I);if(U&&L.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write(L),n.parser.lazy[I.start.line]){let F=a.events.length;for(;F--;)if(a.events[F][1].start.offset<l&&(!a.events[F][1].end||a.events[F][1].end.offset>l))return;const z=n.events.length;let $=z,B,R;for(;$--;)if(n.events[$][0]==="exit"&&n.events[$][1].type==="chunkFlow"){if(B){R=n.events[$][1].end;break}B=!0}for(P(i),F=z;F<n.events.length;)n.events[F][1].end={...R},F++;Xo(n.events,$+1,0,n.events.slice(z)),n.events.length=F}}function P(I){let U=t.length;for(;U-- >I;){const L=t[U];n.containerState=L[1],L[0].exit.call(n,e)}t.length=I}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function BW(e,n,t){return ii(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function pb(e){if(e===null||fa(e)||LW(e))return 1;if(OW(e))return 2}function Vw(e,n,t){const i=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!i.includes(o)&&(n=o(n,t),i.push(o))}return n}const L1={name:"attention",resolveAll:qW,tokenize:VW};function qW(e,n){let t=-1,i,a,o,l,d,f,u,p;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(i=t;i--;)if(e[i][0]==="exit"&&e[i][1].type==="attentionSequence"&&e[i][1]._open&&n.sliceSerialize(e[i][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[i][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[i][1].end.offset-e[i][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[i][1].end.offset-e[i][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[i][1].end},b={...e[t][1].start};Hj(g,-f),Hj(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[i][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[i][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[i][1].end={...l.start},e[t][1].start={...d.end},u=[],e[i][1].end.offset-e[i][1].start.offset&&(u=ls(u,[["enter",e[i][1],n],["exit",e[i][1],n]])),u=ls(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=ls(u,Vw(n.parser.constructs.insideSpan.null,e.slice(i+1,t),n)),u=ls(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(p=2,u=ls(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):p=0,Xo(e,i-1,t-i+3,u),t=i+u.length-p-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function VW(e,n){const t=this.parser.constructs.attentionMarkers.null,i=this.previous,a=pb(i);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),p=pb(f),g=!p||p===2&&a||t.includes(f),b=!a||a===2&&p||t.includes(i);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(p||!g)),n(f)}}function Hj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const HW={name:"autolink",tokenize:GW};function GW(e,n,t){let i=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Qo(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Oa(v)?(i=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),i=0,f):(v===43||v===45||v===46||Oa(v))&&i++<32?(e.consume(v),d):(i=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||M1(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),p):IW(v)?(e.consume(v),u):t(v)}function p(v){return Oa(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),i=0,p):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Oa(v))&&i++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const Vb={partial:!0,tokenize:YW};function YW(e,n,t){return i;function i(o){return Dn(o)?ii(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Ut(o)?n(o):t(o)}}const pE={continuation:{tokenize:QW},exit:JW,name:"blockQuote",tokenize:WW};function WW(e,n,t){const i=this;return a;function a(l){if(l===62){const d=i.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return Dn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function QW(e,n,t){const i=this;return a;function a(l){return Dn(l)?ii(e,o,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(pE,n,t)(l)}}function JW(e){e.exit("blockQuote")}const mE={name:"characterEscape",tokenize:KW};function KW(e,n,t){return i;function i(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return MW(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const gE={name:"characterReference",tokenize:XW};function XW(e,n,t){const i=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Oa,p(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=RW,p):(e.enter("characterReferenceValue"),o=7,l=O1,p(g))}function p(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Oa&&!qw(i.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),p):t(g)}}const Gj={partial:!0,tokenize:eQ},Yj={concrete:!0,name:"codeFenced",tokenize:ZW};function ZW(e,n,t){const i=this,a={partial:!0,tokenize:L};let o=0,l=0,d;return f;function f(F){return u(F)}function u(F){const z=i.events[i.events.length-1];return o=z&&z[1].type==="linePrefix"?z[2].sliceSerialize(z[1],!0).length:0,d=F,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p(F)}function p(F){return F===d?(l++,e.consume(F),p):l<3?t(F):(e.exit("codeFencedFenceSequence"),Dn(F)?ii(e,g,"whitespace")(F):g(F))}function g(F){return F===null||Ut(F)?(e.exit("codeFencedFence"),i.interrupt?n(F):e.check(Gj,k,U)(F)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(F))}function b(F){return F===null||Ut(F)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(F)):Dn(F)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ii(e,v,"whitespace")(F)):F===96&&F===d?t(F):(e.consume(F),b)}function v(F){return F===null||Ut(F)?g(F):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(F))}function S(F){return F===null||Ut(F)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(F)):F===96&&F===d?t(F):(e.consume(F),S)}function k(F){return e.attempt(a,U,T)(F)}function T(F){return e.enter("lineEnding"),e.consume(F),e.exit("lineEnding"),P}function P(F){return o>0&&Dn(F)?ii(e,M,"linePrefix",o+1)(F):M(F)}function M(F){return F===null||Ut(F)?e.check(Gj,k,U)(F):(e.enter("codeFlowValue"),I(F))}function I(F){return F===null||Ut(F)?(e.exit("codeFlowValue"),M(F)):(e.consume(F),I)}function U(F){return e.exit("codeFenced"),n(F)}function L(F,z,$){let B=0;return R;function R(W){return F.enter("lineEnding"),F.consume(W),F.exit("lineEnding"),V}function V(W){return F.enter("codeFencedFence"),Dn(W)?ii(F,Y,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):Y(W)}function Y(W){return W===d?(F.enter("codeFencedFenceSequence"),ie(W)):$(W)}function ie(W){return W===d?(B++,F.consume(W),ie):B>=l?(F.exit("codeFencedFenceSequence"),Dn(W)?ii(F,te,"whitespace")(W):te(W)):$(W)}function te(W){return W===null||Ut(W)?(F.exit("codeFencedFence"),z(W)):$(W)}}}function eQ(e,n,t){const i=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return i.parser.lazy[i.now().line]?t(l):n(l)}}const I0={name:"codeIndented",tokenize:nQ},tQ={partial:!0,tokenize:iQ};function nQ(e,n,t){const i=this;return a;function a(u){return e.enter("codeIndented"),ii(e,o,"linePrefix",5)(u)}function o(u){const p=i.events[i.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Ut(u)?e.attempt(tQ,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Ut(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function iQ(e,n,t){const i=this;return a;function a(l){return i.parser.lazy[i.now().line]?t(l):Ut(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):ii(e,o,"linePrefix",5)(l)}function o(l){const d=i.events[i.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Ut(l)?a(l):t(l)}}const rQ={name:"codeText",previous:sQ,resolve:aQ,tokenize:oQ};function aQ(e){let n=e.length-4,t=3,i,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(i=t;++i<n;)if(e[i][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(i=t-1,n++;++i<=n;)a===void 0?i!==n&&e[i][1].type!=="lineEnding"&&(a=i):(i===n||e[i][1].type==="lineEnding")&&(e[a][1].type="codeTextData",i!==a+2&&(e[a][1].end=e[i-1][1].end,e.splice(a+2,i-a-2),n-=i-a-2,i=a+2),a=void 0);return e}function sQ(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function oQ(e,n,t){let i=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),i++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,p(g)):Ut(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Ut(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function p(g){return g===96?(e.consume(g),a++,p):a===i?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}class lQ{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const i=t??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(n,i):n>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(n,t,i){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return i&&Im(this.left,i),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Im(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Im(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Im(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Im(this.left,t.reverse())}}}function Im(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function yE(e){const n={};let t=-1,i,a,o,l,d,f,u;const p=new lQ(e);for(;++t<p.length;){for(;t in n;)t=n[t];if(i=p.get(t),t&&i[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(f=i[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(i[0]==="enter")i[1].contentType&&(Object.assign(n,cQ(p,t)),t=n[t],u=!0);else if(i[1]._container){for(o=t,a=void 0;o--;)if(l=p.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(i[1].end={...p.get(a)[1].start},d=p.slice(a,t),d.unshift(i),p.splice(a,t-a+1,d))}}return Xo(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!u}function cQ(e,n){const t=e.get(n)[1],i=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=i.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let p,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(p=i.sliceStream(v),v.next||p.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(p),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const uQ={resolve:fQ,tokenize:hQ},dQ={partial:!0,tokenize:pQ};function fQ(e){return yE(e),e}function hQ(e,n){let t;return i;function i(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Ut(d)?e.check(dQ,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function pQ(e,n,t){const i=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),ii(e,o,"linePrefix")}function o(l){if(l===null||Ut(l))return t(l);const d=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(i.parser.constructs.flow,t,n)(l)}}function xE(e,n,t,i,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let p=0;return g;function g(P){return P===60?(e.enter(i),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||M1(P)?t(P):(e.enter(i),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(i),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||Ut(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!p&&(P===null||P===41||fa(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(i),n(P)):p<u&&P===40?(e.consume(P),p++,k):P===41?(e.consume(P),p--,k):P===null||P===32||P===40||M1(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function bE(e,n,t,i,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(i),e.enter(a),e.consume(v),e.exit(a),e.enter(o),p}function p(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(i),n):Ut(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Ut(v)||d++>999?(e.exit("chunkString"),p(v)):(e.consume(v),f||(f=!Dn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function vE(e,n,t,i,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(i),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(i),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Ut(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),ii(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===l||b===null||Ut(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:p)}function g(b){return b===l||b===92?(e.consume(b),p):p(b)}}function Bm(e,n){let t;return i;function i(a){return Ut(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,i):Dn(a)?ii(e,i,t?"linePrefix":"lineSuffix")(a):n(a)}}const mQ={name:"definition",tokenize:yQ},gQ={partial:!0,tokenize:xQ};function yQ(e,n,t){const i=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return bE.call(i,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=Eh(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return fa(v)?Bm(e,u)(v):u(v)}function u(v){return xE(e,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function p(v){return e.attempt(gQ,g,g)(v)}function g(v){return Dn(v)?ii(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Ut(v)?(e.exit("definition"),i.parser.defined.push(a),n(v)):t(v)}}function xQ(e,n,t){return i;function i(d){return fa(d)?Bm(e,a)(d):t(d)}function a(d){return vE(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return Dn(d)?ii(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Ut(d)?n(d):t(d)}}const bQ={name:"hardBreakEscape",tokenize:vQ};function vQ(e,n,t){return i;function i(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Ut(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const wQ={name:"headingAtx",resolve:SQ,tokenize:NQ};function SQ(e,n){let t=e.length-2,i=3,a,o;return e[i][1].type==="whitespace"&&(i+=2),t-2>i&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(i===t-1||t-4>i&&e[t-2][1].type==="whitespace")&&(t-=i+1===t?2:4),t>i&&(a={type:"atxHeadingText",start:e[i][1].start,end:e[t][1].end},o={type:"chunkText",start:e[i][1].start,end:e[t][1].end,contentType:"text"},Xo(e,i,t-i+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function NQ(e,n,t){let i=0;return a;function a(p){return e.enter("atxHeading"),o(p)}function o(p){return e.enter("atxHeadingSequence"),l(p)}function l(p){return p===35&&i++<6?(e.consume(p),l):p===null||fa(p)?(e.exit("atxHeadingSequence"),d(p)):t(p)}function d(p){return p===35?(e.enter("atxHeadingSequence"),f(p)):p===null||Ut(p)?(e.exit("atxHeading"),n(p)):Dn(p)?ii(e,d,"whitespace")(p):(e.enter("atxHeadingText"),u(p))}function f(p){return p===35?(e.consume(p),f):(e.exit("atxHeadingSequence"),d(p))}function u(p){return p===null||p===35||fa(p)?(e.exit("atxHeadingText"),d(p)):(e.consume(p),u)}}const CQ=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Wj=["pre","script","style","textarea"],jQ={concrete:!0,name:"htmlFlow",resolveTo:TQ,tokenize:EQ},_Q={partial:!0,tokenize:PQ},kQ={partial:!0,tokenize:AQ};function TQ(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function EQ(e,n,t){const i=this;let a,o,l,d,f;return u;function u(D){return p(D)}function p(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,i.interrupt?n:A):Qo(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):Qo(D)?(e.consume(D),a=4,i.interrupt?n:A):t(D)}function v(D){return D===45?(e.consume(D),i.interrupt?n:A):t(D)}function S(D){const se="CDATA[";return D===se.charCodeAt(d++)?(e.consume(D),d===se.length?i.interrupt?n:Y:S):t(D)}function k(D){return Qo(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||fa(D)){const se=D===47,be=l.toLowerCase();return!se&&!o&&Wj.includes(be)?(a=1,i.interrupt?n(D):Y(D)):CQ.includes(l.toLowerCase())?(a=6,se?(e.consume(D),P):i.interrupt?n(D):Y(D)):(a=7,i.interrupt&&!i.parser.lazy[i.now().line]?t(D):o?M(D):I(D))}return D===45||Oa(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),i.interrupt?n:Y):t(D)}function M(D){return Dn(D)?(e.consume(D),M):R(D)}function I(D){return D===47?(e.consume(D),R):D===58||D===95||Qo(D)?(e.consume(D),U):Dn(D)?(e.consume(D),I):R(D)}function U(D){return D===45||D===46||D===58||D===95||Oa(D)?(e.consume(D),U):L(D)}function L(D){return D===61?(e.consume(D),F):Dn(D)?(e.consume(D),L):I(D)}function F(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,z):Dn(D)?(e.consume(D),F):$(D)}function z(D){return D===f?(e.consume(D),f=null,B):D===null||Ut(D)?t(D):(e.consume(D),z)}function $(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||fa(D)?L(D):(e.consume(D),$)}function B(D){return D===47||D===62||Dn(D)?I(D):t(D)}function R(D){return D===62?(e.consume(D),V):t(D)}function V(D){return D===null||Ut(D)?Y(D):Dn(D)?(e.consume(D),V):t(D)}function Y(D){return D===45&&a===2?(e.consume(D),H):D===60&&a===1?(e.consume(D),Q):D===62&&a===4?(e.consume(D),oe):D===63&&a===3?(e.consume(D),A):D===93&&a===5?(e.consume(D),fe):Ut(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(_Q,ue,ie)(D)):D===null||Ut(D)?(e.exit("htmlFlowData"),ie(D)):(e.consume(D),Y)}function ie(D){return e.check(kQ,te,ue)(D)}function te(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),W}function W(D){return D===null||Ut(D)?ie(D):(e.enter("htmlFlowData"),Y(D))}function H(D){return D===45?(e.consume(D),A):Y(D)}function Q(D){return D===47?(e.consume(D),l="",J):Y(D)}function J(D){if(D===62){const se=l.toLowerCase();return Wj.includes(se)?(e.consume(D),oe):Y(D)}return Qo(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),J):Y(D)}function fe(D){return D===93?(e.consume(D),A):Y(D)}function A(D){return D===62?(e.consume(D),oe):D===45&&a===2?(e.consume(D),A):Y(D)}function oe(D){return D===null||Ut(D)?(e.exit("htmlFlowData"),ue(D)):(e.consume(D),oe)}function ue(D){return e.exit("htmlFlow"),n(D)}}function AQ(e,n,t){const i=this;return a;function a(l){return Ut(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return i.parser.lazy[i.now().line]?t(l):n(l)}}function PQ(e,n,t){return i;function i(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Vb,n,t)}}const DQ={name:"htmlText",tokenize:IQ};function IQ(e,n,t){const i=this;let a,o,l;return d;function d(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),f}function f(A){return A===33?(e.consume(A),u):A===47?(e.consume(A),L):A===63?(e.consume(A),I):Qo(A)?(e.consume(A),$):t(A)}function u(A){return A===45?(e.consume(A),p):A===91?(e.consume(A),o=0,S):Qo(A)?(e.consume(A),M):t(A)}function p(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):Ut(A)?(l=g,Q(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?H(A):A===45?b(A):g(A)}function S(A){const oe="CDATA[";return A===oe.charCodeAt(o++)?(e.consume(A),o===oe.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),T):Ut(A)?(l=k,Q(A)):(e.consume(A),k)}function T(A){return A===93?(e.consume(A),P):k(A)}function P(A){return A===62?H(A):A===93?(e.consume(A),P):k(A)}function M(A){return A===null||A===62?H(A):Ut(A)?(l=M,Q(A)):(e.consume(A),M)}function I(A){return A===null?t(A):A===63?(e.consume(A),U):Ut(A)?(l=I,Q(A)):(e.consume(A),I)}function U(A){return A===62?H(A):I(A)}function L(A){return Qo(A)?(e.consume(A),F):t(A)}function F(A){return A===45||Oa(A)?(e.consume(A),F):z(A)}function z(A){return Ut(A)?(l=z,Q(A)):Dn(A)?(e.consume(A),z):H(A)}function $(A){return A===45||Oa(A)?(e.consume(A),$):A===47||A===62||fa(A)?B(A):t(A)}function B(A){return A===47?(e.consume(A),H):A===58||A===95||Qo(A)?(e.consume(A),R):Ut(A)?(l=B,Q(A)):Dn(A)?(e.consume(A),B):H(A)}function R(A){return A===45||A===46||A===58||A===95||Oa(A)?(e.consume(A),R):V(A)}function V(A){return A===61?(e.consume(A),Y):Ut(A)?(l=V,Q(A)):Dn(A)?(e.consume(A),V):B(A)}function Y(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ie):Ut(A)?(l=Y,Q(A)):Dn(A)?(e.consume(A),Y):(e.consume(A),te)}function ie(A){return A===a?(e.consume(A),a=void 0,W):A===null?t(A):Ut(A)?(l=ie,Q(A)):(e.consume(A),ie)}function te(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||fa(A)?B(A):(e.consume(A),te)}function W(A){return A===47||A===62||fa(A)?B(A):t(A)}function H(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function Q(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),J}function J(A){return Dn(A)?ii(e,fe,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):fe(A)}function fe(A){return e.enter("htmlTextData"),l(A)}}const Hw={name:"labelEnd",resolveAll:LQ,resolveTo:FQ,tokenize:$Q},RQ={tokenize:zQ},MQ={tokenize:UQ},OQ={tokenize:BQ};function LQ(e){let n=-1;const t=[];for(;++n<e.length;){const i=e[n][1];if(t.push(e[n]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const a=i.type==="labelImage"?4:2;i.type="data",n+=a}}return e.length!==t.length&&Xo(e,0,e.length,t),e}function FQ(e,n){let t=e.length,i=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){i=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},p={type:"labelText",start:{...e[o+i+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=ls(d,e.slice(o+1,o+i+3)),d=ls(d,[["enter",p,n]]),d=ls(d,Vw(n.parser.constructs.insideSpan.null,e.slice(o+i+4,l-3),n)),d=ls(d,[["exit",p,n],e[l-2],e[l-1],["exit",u,n]]),d=ls(d,e.slice(l+1)),d=ls(d,[["exit",f,n]]),Xo(e,o,e.length,d),e}function $Q(e,n,t){const i=this;let a=i.events.length,o,l;for(;a--;)if((i.events[a][1].type==="labelImage"||i.events[a][1].type==="labelLink")&&!i.events[a][1]._balanced){o=i.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=i.parser.defined.includes(Eh(i.sliceSerialize({start:o.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(RQ,p,l?p:g)(b):b===91?e.attempt(MQ,p,l?u:g)(b):l?p(b):g(b)}function u(b){return e.attempt(OQ,p,g)(b)}function p(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function zQ(e,n,t){return i;function i(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return fa(g)?Bm(e,o)(g):o(g)}function o(g){return g===41?p(g):xE(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return fa(g)?Bm(e,f)(g):p(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?vE(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function u(g){return fa(g)?Bm(e,p)(g):p(g)}function p(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function UQ(e,n,t){const i=this;return a;function a(d){return bE.call(i,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return i.parser.defined.includes(Eh(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function BQ(e,n,t){return i;function i(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const qQ={name:"labelStartImage",resolveAll:Hw.resolveAll,tokenize:VQ};function VQ(e,n,t){const i=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(d):n(d)}}const HQ={name:"labelStartLink",resolveAll:Hw.resolveAll,tokenize:GQ};function GQ(e,n,t){const i=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(l):n(l)}}const R0={name:"lineEnding",tokenize:YQ};function YQ(e,n){return t;function t(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),ii(e,n,"linePrefix")}}const Hx={name:"thematicBreak",tokenize:WQ};function WQ(e,n,t){let i=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):i>=3&&(u===null||Ut(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),i++,f):(e.exit("thematicBreakSequence"),Dn(u)?ii(e,d,"whitespace")(u):d(u))}}const ca={continuation:{tokenize:XQ},exit:eJ,name:"list",tokenize:KQ},QQ={partial:!0,tokenize:tJ},JQ={partial:!0,tokenize:ZQ};function KQ(e,n,t){const i=this,a=i.events[i.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=i.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!i.containerState.marker||v===i.containerState.marker:O1(v)){if(i.containerState.type||(i.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Hx,t,u)(v):u(v);if(!i.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return O1(v)&&++l<10?(e.consume(v),f):(!i.interrupt||l<2)&&(i.containerState.marker?v===i.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||v,e.check(Vb,i.interrupt?t:p,e.attempt(QQ,b,g))}function p(v){return i.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return Dn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return i.containerState.size=o+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function XQ(e,n,t){const i=this;return i.containerState._closeFlow=void 0,e.check(Vb,a,o);function a(d){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,ii(e,n,"listItemIndent",i.containerState.size+1)(d)}function o(d){return i.containerState.furtherBlankLines||!Dn(d)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,l(d)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(JQ,n,l)(d))}function l(d){return i.containerState._closeFlow=!0,i.interrupt=void 0,ii(e,e.attempt(ca,n,t),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function ZQ(e,n,t){const i=this;return ii(e,a,"listItemIndent",i.containerState.size+1);function a(o){const l=i.events[i.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===i.containerState.size?n(o):t(o)}}function eJ(e){e.exit(this.containerState.type)}function tJ(e,n,t){const i=this;return ii(e,a,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=i.events[i.events.length-1];return!Dn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const Qj={name:"setextUnderline",resolveTo:nJ,tokenize:iJ};function nJ(e,n){let t=e.length,i,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){i=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[i][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[i][1],n]),e[i][1].end={...e[o][1].end}):e[i][1]=l,e.push(["exit",l,n]),e}function iJ(e,n,t){const i=this;let a;return o;function o(u){let p=i.events.length,g;for(;p--;)if(i.events[p][1].type!=="lineEnding"&&i.events[p][1].type!=="linePrefix"&&i.events[p][1].type!=="content"){g=i.events[p][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),Dn(u)?ii(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Ut(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const rJ={tokenize:aJ};function aJ(e){const n=this,t=e.attempt(Vb,i,e.attempt(this.parser.constructs.flowInitial,a,ii(e,e.attempt(this.parser.constructs.flow,a,e.attempt(uQ,a)),"linePrefix")));return t;function i(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const sJ={resolveAll:SE()},oJ=wE("string"),lJ=wE("text");function wE(e){return{resolveAll:SE(e==="text"?cJ:void 0),tokenize:n};function n(t){const i=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(p){return u(p)?o(p):d(p)}function d(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),f}function f(p){return u(p)?(t.exit("data"),o(p)):(t.consume(p),f)}function u(p){if(p===null)return!0;const g=a[p];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(i,i.previous))return!0}return!1}}}function SE(e){return n;function n(t,i){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,i):t}}function cJ(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const i=e[t-1][1],a=n.sliceStream(i);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:i.start._bufferIndex+l,_index:i.start._index+o,line:i.end.line,column:i.end.column-d,offset:i.end.offset-d},end:{...i.end}};i.end={...u.start},i.start.offset===i.end.offset?Object.assign(i,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const uJ={42:ca,43:ca,45:ca,48:ca,49:ca,50:ca,51:ca,52:ca,53:ca,54:ca,55:ca,56:ca,57:ca,62:pE},dJ={91:mQ},fJ={[-2]:I0,[-1]:I0,32:I0},hJ={35:wQ,42:Hx,45:[Qj,Hx],60:jQ,61:Qj,95:Hx,96:Yj,126:Yj},pJ={38:gE,92:mE},mJ={[-5]:R0,[-4]:R0,[-3]:R0,33:qQ,38:gE,42:L1,60:[HW,DQ],91:HQ,92:[bQ,mE],93:Hw,95:L1,96:rQ},gJ={null:[L1,sJ]},yJ={null:[42,95]},xJ={null:[]},bJ=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:yJ,contentInitial:dJ,disable:xJ,document:uJ,flow:hJ,flowInitial:fJ,insideSpan:gJ,string:pJ,text:mJ},Symbol.toStringTag,{value:"Module"}));function vJ(e,n,t){let i={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:z(L),check:z(F),consume:M,enter:I,exit:U,interrupt:z(F,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let p=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(V){return l=ls(l,V),T(),l[l.length-1]!==null?[]:($(n,0),u.events=Vw(o,u.events,u),u.events)}function b(V,Y){return SJ(v(V),Y)}function v(V){return wJ(l,V)}function S(){const{_bufferIndex:V,_index:Y,line:ie,column:te,offset:W}=i;return{_bufferIndex:V,_index:Y,line:ie,column:te,offset:W}}function k(V){a[V.line]=V.column,R()}function T(){let V;for(;i._index<l.length;){const Y=l[i._index];if(typeof Y=="string")for(V=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===V&&i._bufferIndex<Y.length;)P(Y.charCodeAt(i._bufferIndex));else P(Y)}}function P(V){p=p(V)}function M(V){Ut(V)?(i.line++,i.column=1,i.offset+=V===-3?2:1,R()):V!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===l[i._index].length&&(i._bufferIndex=-1,i._index++)),u.previous=V}function I(V,Y){const ie=Y||{};return ie.type=V,ie.start=S(),u.events.push(["enter",ie,u]),d.push(ie),ie}function U(V){const Y=d.pop();return Y.end=S(),u.events.push(["exit",Y,u]),Y}function L(V,Y){$(V,Y.from)}function F(V,Y){Y.restore()}function z(V,Y){return ie;function ie(te,W,H){let Q,J,fe,A;return Array.isArray(te)?ue(te):"tokenize"in te?ue([te]):oe(te);function oe(ee){return ce;function ce(re){const Pe=re!==null&&ee[re],Qe=re!==null&&ee.null,Se=[...Array.isArray(Pe)?Pe:Pe?[Pe]:[],...Array.isArray(Qe)?Qe:Qe?[Qe]:[]];return ue(Se)(re)}}function ue(ee){return Q=ee,J=0,ee.length===0?H:D(ee[J])}function D(ee){return ce;function ce(re){return A=B(),fe=ee,ee.partial||(u.currentConstruct=ee),ee.name&&u.parser.constructs.disable.null.includes(ee.name)?be():ee.tokenize.call(Y?Object.assign(Object.create(u),Y):u,f,se,be)(re)}}function se(ee){return V(fe,A),W}function be(ee){return A.restore(),++J<Q.length?D(Q[J]):H}}}function $(V,Y){V.resolveAll&&!o.includes(V)&&o.push(V),V.resolve&&Xo(u.events,Y,u.events.length-Y,V.resolve(u.events.slice(Y),u)),V.resolveTo&&(u.events=V.resolveTo(u.events,u))}function B(){const V=S(),Y=u.previous,ie=u.currentConstruct,te=u.events.length,W=Array.from(d);return{from:te,restore:H};function H(){i=V,u.previous=Y,u.currentConstruct=ie,u.events.length=te,d=W,R()}}function R(){i.line in a&&i.column<2&&(i.column=a[i.line],i.offset+=a[i.line]-1)}}function wJ(e,n){const t=n.start._index,i=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(i,o)];else{if(l=e.slice(t,a),i>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(i):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function SJ(e,n){let t=-1;const i=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,i.push(l)}return i.join("")}function NJ(e){const i={constructs:AW([bJ,...(e||{}).extensions||[]]),content:a(FW),defined:[],document:a(zW),flow:a(rJ),lazy:{},string:a(oJ),text:a(lJ)};return i;function a(o){return l;function l(d){return vJ(i,o,d)}}}function CJ(e){for(;!yE(e););return e}const Jj=/[\0\t\n\r]/g;function jJ(){let e=1,n="",t=!0,i;return a;function a(o,l,d){const f=[];let u,p,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(Jj.lastIndex=g,u=Jj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&i)f.push(-3),i=void 0;else switch(i&&(f.push(-5),i=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,f.push(-2);e++<p;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:i=!0,e=1}g=b+1}return d&&(i&&f.push(-5),n&&f.push(n),f.push(null)),f}}const _J=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function NE(e){return e.replace(_J,kJ)}function kJ(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return hE(t.slice(o?2:1),o?16:10)}return qw(t)||e}function qm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Kj(e.position):"start"in e||"end"in e?Kj(e):"line"in e||"column"in e?F1(e):""}function F1(e){return Xj(e&&e.line)+":"+Xj(e&&e.column)}function Kj(e){return F1(e&&e.start)+"-"+F1(e&&e.end)}function Xj(e){return e&&typeof e=="number"?e:1}const CE={}.hasOwnProperty;function TJ(e,n,t){return typeof n!="string"&&(t=n,n=void 0),EJ(t)(CJ(NJ(t).document().write(jJ()(e,n,!0))))}function EJ(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(Nt),autolinkProtocol:B,autolinkEmail:B,atxHeading:o(nt),blockQuote:o(Qe),characterEscape:B,characterReference:B,codeFenced:o(Se),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Se,l),codeText:o(Ne,l),codeTextData:B,data:B,codeFlowValue:B,definition:o(De),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Me),hardBreakEscape:o(ft),hardBreakTrailing:o(ft),htmlFlow:o(ut,l),htmlFlowData:B,htmlText:o(ut,l),htmlTextData:B,image:o(rt),label:l,link:o(Nt),listItem:o(ye),listItemValue:b,listOrdered:o(Ft,g),listUnordered:o(Ft),paragraph:o(Te),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(nt),strong:o(Ye),thematicBreak:o(_e)},exit:{atxHeading:f(),atxHeadingSequence:L,autolink:f(),autolinkEmail:Pe,autolinkProtocol:re,blockQuote:f(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:be,characterReferenceMarkerNumeric:be,characterReferenceValue:ee,characterReference:ce,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:R,codeIndented:f(P),codeText:f(W),codeTextData:R,data:R,definition:f(),definitionDestinationString:U,definitionLabelString:M,definitionTitleString:I,emphasis:f(),hardBreakEscape:f(Y),hardBreakTrailing:f(Y),htmlFlow:f(ie),htmlFlowData:R,htmlText:f(te),htmlTextData:R,image:f(Q),label:fe,labelText:J,lineEnding:V,link:f(H),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:se,resourceDestinationString:A,resourceTitleString:oe,resource:ue,setextHeading:f($),setextHeadingLineSequence:z,setextHeadingText:F,strong:f(),thematicBreak:f()}};jE(n,(e||{}).mdastExtensions||[]);const t={};return i;function i(X){let de={type:"root",children:[]};const qe={stack:[de],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:p,data:t},et=[];let ct=-1;for(;++ct<X.length;)if(X[ct][1].type==="listOrdered"||X[ct][1].type==="listUnordered")if(X[ct][0]==="enter")et.push(ct);else{const Fe=et.pop();ct=a(X,Fe,ct)}for(ct=-1;++ct<X.length;){const Fe=n[X[ct][0]];CE.call(Fe,X[ct][1].type)&&Fe[X[ct][1].type].call(Object.assign({sliceSerialize:X[ct][2].sliceSerialize},qe),X[ct][1])}if(qe.tokenStack.length>0){const Fe=qe.tokenStack[qe.tokenStack.length-1];(Fe[1]||Zj).call(qe,void 0,Fe[0])}for(de.position={start:Yc(X.length>0?X[0][1].start:{line:1,column:1,offset:0}),end:Yc(X.length>0?X[X.length-2][1].end:{line:1,column:1,offset:0})},ct=-1;++ct<n.transforms.length;)de=n.transforms[ct](de)||de;return de}function a(X,de,qe){let et=de-1,ct=-1,Fe=!1,ot,ve,xe,Be;for(;++et<=qe;){const Ue=X[et];switch(Ue[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ue[0]==="enter"?ct++:ct--,Be=void 0;break}case"lineEndingBlank":{Ue[0]==="enter"&&(ot&&!Be&&!ct&&!xe&&(xe=et),Be=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Be=void 0}if(!ct&&Ue[0]==="enter"&&Ue[1].type==="listItemPrefix"||ct===-1&&Ue[0]==="exit"&&(Ue[1].type==="listUnordered"||Ue[1].type==="listOrdered")){if(ot){let tt=et;for(ve=void 0;tt--;){const dt=X[tt];if(dt[1].type==="lineEnding"||dt[1].type==="lineEndingBlank"){if(dt[0]==="exit")continue;ve&&(X[ve][1].type="lineEndingBlank",Fe=!0),dt[1].type="lineEnding",ve=tt}else if(!(dt[1].type==="linePrefix"||dt[1].type==="blockQuotePrefix"||dt[1].type==="blockQuotePrefixWhitespace"||dt[1].type==="blockQuoteMarker"||dt[1].type==="listItemIndent"))break}xe&&(!ve||xe<ve)&&(ot._spread=!0),ot.end=Object.assign({},ve?X[ve][1].start:Ue[1].end),X.splice(ve||et,0,["exit",ot,Ue[2]]),et++,qe++}if(Ue[1].type==="listItemPrefix"){const tt={type:"listItem",_spread:!1,start:Object.assign({},Ue[1].start),end:void 0};ot=tt,X.splice(et,0,["enter",tt,Ue[2]]),et++,qe++,xe=void 0,Be=!0}}}return X[de][1]._spread=Fe,qe}function o(X,de){return qe;function qe(et){d.call(this,X(et),et),de&&de.call(this,et)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(X,de,qe){this.stack[this.stack.length-1].children.push(X),this.stack.push(X),this.tokenStack.push([de,qe||void 0]),X.position={start:Yc(de.start),end:void 0}}function f(X){return de;function de(qe){X&&X.call(this,qe),u.call(this,qe)}}function u(X,de){const qe=this.stack.pop(),et=this.tokenStack.pop();if(et)et[0].type!==X.type&&(de?de.call(this,X,et[0]):(et[1]||Zj).call(this,X,et[0]));else throw new Error("Cannot close `"+X.type+"` ("+qm({start:X.start,end:X.end})+"): its not open");qe.position.end=Yc(X.end)}function p(){return Bw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(X){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];de.start=Number.parseInt(this.sliceSerialize(X),10),this.data.expectingFirstListItemValue=void 0}}function v(){const X=this.resume(),de=this.stack[this.stack.length-1];de.lang=X}function S(){const X=this.resume(),de=this.stack[this.stack.length-1];de.meta=X}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X.replace(/(\r?\n|\r)$/g,"")}function M(X){const de=this.resume(),qe=this.stack[this.stack.length-1];qe.label=de,qe.identifier=Eh(this.sliceSerialize(X)).toLowerCase()}function I(){const X=this.resume(),de=this.stack[this.stack.length-1];de.title=X}function U(){const X=this.resume(),de=this.stack[this.stack.length-1];de.url=X}function L(X){const de=this.stack[this.stack.length-1];if(!de.depth){const qe=this.sliceSerialize(X).length;de.depth=qe}}function F(){this.data.setextHeadingSlurpLineEnding=!0}function z(X){const de=this.stack[this.stack.length-1];de.depth=this.sliceSerialize(X).codePointAt(0)===61?1:2}function $(){this.data.setextHeadingSlurpLineEnding=void 0}function B(X){const qe=this.stack[this.stack.length-1].children;let et=qe[qe.length-1];(!et||et.type!=="text")&&(et=$e(),et.position={start:Yc(X.start),end:void 0},qe.push(et)),this.stack.push(et)}function R(X){const de=this.stack.pop();de.value+=this.sliceSerialize(X),de.position.end=Yc(X.end)}function V(X){const de=this.stack[this.stack.length-1];if(this.data.atHardBreak){const qe=de.children[de.children.length-1];qe.position.end=Yc(X.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(de.type)&&(B.call(this,X),R.call(this,X))}function Y(){this.data.atHardBreak=!0}function ie(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X}function te(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X}function W(){const X=this.resume(),de=this.stack[this.stack.length-1];de.value=X}function H(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=de,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function Q(){const X=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";X.type+="Reference",X.referenceType=de,delete X.url,delete X.title}else delete X.identifier,delete X.label;this.data.referenceType=void 0}function J(X){const de=this.sliceSerialize(X),qe=this.stack[this.stack.length-2];qe.label=NE(de),qe.identifier=Eh(de).toLowerCase()}function fe(){const X=this.stack[this.stack.length-1],de=this.resume(),qe=this.stack[this.stack.length-1];if(this.data.inReference=!0,qe.type==="link"){const et=X.children;qe.children=et}else qe.alt=de}function A(){const X=this.resume(),de=this.stack[this.stack.length-1];de.url=X}function oe(){const X=this.resume(),de=this.stack[this.stack.length-1];de.title=X}function ue(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function se(X){const de=this.resume(),qe=this.stack[this.stack.length-1];qe.label=de,qe.identifier=Eh(this.sliceSerialize(X)).toLowerCase(),this.data.referenceType="full"}function be(X){this.data.characterReferenceType=X.type}function ee(X){const de=this.sliceSerialize(X),qe=this.data.characterReferenceType;let et;qe?(et=hE(de,qe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):et=qw(de);const ct=this.stack[this.stack.length-1];ct.value+=et}function ce(X){const de=this.stack.pop();de.position.end=Yc(X.end)}function re(X){R.call(this,X);const de=this.stack[this.stack.length-1];de.url=this.sliceSerialize(X)}function Pe(X){R.call(this,X);const de=this.stack[this.stack.length-1];de.url="mailto:"+this.sliceSerialize(X)}function Qe(){return{type:"blockquote",children:[]}}function Se(){return{type:"code",lang:null,meta:null,value:""}}function Ne(){return{type:"inlineCode",value:""}}function De(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Me(){return{type:"emphasis",children:[]}}function nt(){return{type:"heading",depth:0,children:[]}}function ft(){return{type:"break"}}function ut(){return{type:"html",value:""}}function rt(){return{type:"image",title:null,url:"",alt:null}}function Nt(){return{type:"link",title:null,url:"",children:[]}}function Ft(X){return{type:"list",ordered:X.type==="listOrdered",start:null,spread:X._spread,children:[]}}function ye(X){return{type:"listItem",spread:X._spread,checked:null,children:[]}}function Te(){return{type:"paragraph",children:[]}}function Ye(){return{type:"strong",children:[]}}function $e(){return{type:"text",value:""}}function _e(){return{type:"thematicBreak"}}}function Yc(e){return{line:e.line,column:e.column,offset:e.offset}}function jE(e,n){let t=-1;for(;++t<n.length;){const i=n[t];Array.isArray(i)?jE(e,i):AJ(e,i)}}function AJ(e,n){let t;for(t in n)if(CE.call(n,t))switch(t){case"canContainEols":{const i=n[t];i&&e[t].push(...i);break}case"transforms":{const i=n[t];i&&e[t].push(...i);break}case"enter":case"exit":{const i=n[t];i&&Object.assign(e[t],i);break}}}function Zj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+qm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+qm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+qm({start:n.start,end:n.end})+") is still open")}function PJ(e){const n=this;n.parser=t;function t(i){return TJ(i,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const e_={}.hasOwnProperty;function _E(e,n){const t=n||{};function i(a,...o){let l=i.invalid;const d=i.handlers;if(a&&e_.call(a,e)){const f=String(a[e]);l=e_.call(d,f)?d[f]:i.unknown}if(l)return l.call(this,a,...o)}return i.handlers=t.handlers||{},i.invalid=t.invalid,i.unknown=t.unknown,i}const DJ={}.hasOwnProperty;function kE(e,n){let t=-1,i;if(n.extensions)for(;++t<n.extensions.length;)kE(e,n.extensions[t]);for(i in n)if(DJ.call(n,i))switch(i){case"extensions":break;case"unsafe":{t_(e[i],n[i]);break}case"join":{t_(e[i],n[i]);break}case"handlers":{IJ(e[i],n[i]);break}default:e.options[i]=n[i]}return e}function t_(e,n){n&&e.push(...n)}function IJ(e,n){n&&Object.assign(e,n)}function RJ(e,n,t,i){const a=t.enter("blockquote"),o=t.createTracker(i);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),MJ);return a(),l}function MJ(e,n,t){return">"+(t?"":" ")+e}function TE(e,n){return n_(e,n.inConstruct,!0)&&!n_(e,n.notInConstruct,!1)}function n_(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let i=-1;for(;++i<n.length;)if(e.includes(n[i]))return!0;return!1}function i_(e,n,t,i){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&TE(t.stack,t.unsafe[a]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function OJ(e,n){const t=String(e);let i=t.indexOf(n),a=i,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===a?++o>l&&(l=o):o=1,a=i+n.length,i=t.indexOf(n,a);return l}function $1(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function LJ(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function FJ(e,n,t,i){const a=LJ(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if($1(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,$J);return g(),b}const d=t.createTracker(i),f=a.repeat(Math.max(OJ(o,a)+1,3)),u=t.enter("codeFenced");let p=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);p+=d.move(t.safe(e.lang,{before:p,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);p+=d.move(" "),p+=d.move(t.safe(e.meta,{before:p,after:`
`,encode:["`"],...d.current()})),g()}return p+=d.move(`
`),o&&(p+=d.move(o+`
`)),p+=d.move(f),u(),p}function $J(e,n,t){return(t?"":"    ")+e}function Gw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function zJ(e,n,t,i){const a=Gw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(i);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function UJ(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function iu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function mb(e,n,t){const i=pb(e),a=pb(n);return i===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}EE.peek=BJ;function EE(e,n,t,i){const a=UJ(t),o=t.enter("emphasis"),l=t.createTracker(i),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=mb(i.before.charCodeAt(i.before.length-1),u,a);p.inside&&(f=iu(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=mb(i.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+iu(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function BJ(e,n,t){return t.options.emphasis||"*"}const Yw=function(e){if(e==null)return GJ;if(typeof e=="function")return Hb(e);if(typeof e=="object")return Array.isArray(e)?qJ(e):VJ(e);if(typeof e=="string")return HJ(e);throw new Error("Expected function, string, or object as test")};function qJ(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Yw(e[t]);return Hb(i);function i(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function VJ(e){const n=e;return Hb(t);function t(i){const a=i;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function HJ(e){return Hb(n);function n(t){return t&&t.type===e}}function Hb(e){return n;function n(t,i,a){return!!(YJ(t)&&e.call(this,t,typeof i=="number"?i:void 0,a||void 0))}}function GJ(){return!0}function YJ(e){return e!==null&&typeof e=="object"&&"type"in e}const AE=[],WJ=!0,z1=!1,QJ="skip";function JJ(e,n,t,i){let a;typeof n=="function"&&typeof t!="function"?(i=t,t=n):a=n;const o=Yw(a),l=i?-1:1;d(e,void 0,[])();function d(f,u,p){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=AE,S,k,T;if((!n||o(f,u,p[p.length-1]||void 0))&&(v=KJ(t(f,p)),v[0]===z1))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==QJ)for(k=(i?P.children.length:-1)+l,T=p.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===z1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function KJ(e){return Array.isArray(e)?e:typeof e=="number"?[WJ,e]:e==null?AE:[e]}function PE(e,n,t,i){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=i),JJ(e,o,d,a);function d(f,u){const p=u[u.length-1],g=p?p.children.indexOf(f):void 0;return l(f,g,p)}}function DE(e,n){let t=!1;return PE(e,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return t=!0,z1}),!!((!e.depth||e.depth<3)&&Bw(e)&&(n.options.setext||t))}function XJ(e,n,t,i){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(i);if(DE(e,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),p(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=iu(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}IE.peek=ZJ;function IE(e){return e.value||""}function ZJ(){return"<"}RE.peek=eK;function RE(e,n,t,i){const a=Gw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(i);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function eK(){return"!"}ME.peek=tK;function ME(e,n,t,i){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(i);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function tK(){return"!"}OE.peek=nK;function OE(e,n,t){let i=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(i);)a+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(i);){let u=f.index;i.charCodeAt(u)===10&&i.charCodeAt(u-1)===13&&u--,i=i.slice(0,u)+" "+i.slice(f.index+1)}}return a+i+a}function nK(){return"`"}function LE(e,n){const t=Bw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}FE.peek=iK;function FE(e,n,t,i){const a=Gw(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(i);let d,f;if(LE(e,t)){const p=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=p,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function iK(e,n,t){return LE(e,t)?"<":"["}$E.peek=rK;function $E(e,n,t,i){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(i);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function rK(){return"["}function Ww(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function aK(e){const n=Ww(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function sK(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function zE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function oK(e,n,t,i){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?sK(t):Ww(t);const d=e.ordered?l==="."?")":".":aK(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const p=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),zE(t)===l&&p){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,i);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function lK(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function cK(e,n,t,i){const a=lK(t);let o=t.bulletCurrent||Ww(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(i);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),p);return f(),u;function p(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function uK(e,n,t,i){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,i);return o(),a(),l}const dK=Yw(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function fK(e,n,t,i){return(e.children.some(function(l){return dK(l)})?t.containerPhrasing:t.containerFlow).call(t,e,i)}function hK(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}UE.peek=pK;function UE(e,n,t,i){const a=hK(t),o=t.enter("strong"),l=t.createTracker(i),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=mb(i.before.charCodeAt(i.before.length-1),u,a);p.inside&&(f=iu(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=mb(i.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+iu(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function pK(e,n,t){return t.options.strong||"*"}function mK(e,n,t,i){return t.safe(e.value,i)}function gK(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function yK(e,n,t){const i=(zE(t)+(t.options.ruleSpaces?" ":"")).repeat(gK(t));return t.options.ruleSpaces?i.slice(0,-1):i}const xK={blockquote:RJ,break:i_,code:FJ,definition:zJ,emphasis:EE,hardBreak:i_,heading:XJ,html:IE,image:RE,imageReference:ME,inlineCode:OE,link:FE,linkReference:$E,list:oK,listItem:cK,paragraph:uK,root:fK,strong:UE,text:mK,thematicBreak:yK},bK=[vK];function vK(e,n,t,i){if(n.type==="code"&&$1(n,i)&&(e.type==="list"||e.type===n.type&&$1(e,i)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&DE(n,i))?void 0:t.spread?1:0}const Ad=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],wK=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Ad},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Ad},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Ad},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Ad},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Ad},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Ad},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Ad},{atBreak:!0,character:"~"}];function SK(e){return e.label||!e.identifier?e.label||"":NE(e.identifier)}function NK(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function CK(e,n,t){const i=n.indexStack,a=e.children||[],o=[];let l=-1,d=t.before,f;i.push(-1);let u=n.createTracker(t);for(;++l<a.length;){const p=a[l];let g;if(i[i.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else g=t.after;o.length>0&&(d==="\r"||d===`
`)&&p.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),d=" ",u=n.createTracker(t),u.move(o.join("")));let b=n.handle(p,e,n,{...u.current(),after:g,before:d});f&&f===b.slice(0,1)&&(b=iu(f.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,f=void 0,v&&(o.length>0&&v.before&&d===o[o.length-1].slice(-1)&&(o[o.length-1]=o[o.length-1].slice(0,-1)+iu(d.charCodeAt(0))),v.after&&(f=g)),u.move(b),o.push(b),d=b.slice(-1)}return i.pop(),o.join("")}function jK(e,n,t){const i=n.indexStack,a=e.children||[],o=n.createTracker(t),l=[];let d=-1;for(i.push(-1);++d<a.length;){const f=a[d];i[i.length-1]=d,l.push(o.move(n.handle(f,e,n,{before:`
`,after:`
`,...o.current()}))),f.type!=="list"&&(n.bulletLastUsed=void 0),d<a.length-1&&l.push(o.move(_K(f,a[d+1],e,n)))}return i.pop(),l.join("")}function _K(e,n,t,i){let a=i.join.length;for(;a--;){const o=i.join[a](e,n,t,i);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}const kK=/\r?\n|\r/g;function TK(e,n){const t=[];let i=0,a=0,o;for(;o=kK.exec(e);)l(e.slice(i,o.index)),t.push(o[0]),i=o.index+o[0].length,a++;return l(e.slice(i)),t.join("");function l(d){t.push(n(d,a,!d))}}function EK(e,n,t){const i=(t.before||"")+(n||"")+(t.after||""),a=[],o=[],l={};let d=-1;for(;++d<e.unsafe.length;){const p=e.unsafe[d];if(!TE(e.stack,p))continue;const g=e.compilePattern(p);let b;for(;b=g.exec(i);){const v="before"in p||!!p.atBreak,S="after"in p,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(AK);let f=t.before?t.before.length:0;const u=i.length-(t.after?t.after.length:0);for(d=-1;++d<a.length;){const p=a[d];p<f||p>=u||p+1<u&&a[d+1]===p+1&&l[p].after&&!l[p+1].before&&!l[p+1].after||a[d-1]===p-1&&l[p].before&&!l[p-1].before&&!l[p-1].after||(f!==p&&o.push(r_(i.slice(f,p),"\\")),f=p,/[!-/:-@[-`{-~]/.test(i.charAt(p))&&(!t.encode||!t.encode.includes(i.charAt(p)))?o.push("\\"):(o.push(iu(i.charCodeAt(p))),f++))}return o.push(r_(i.slice(f,u),t.after)),o.join("")}function AK(e,n){return e-n}function r_(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,i=[],a=[],o=e+n;let l=-1,d=0,f;for(;f=t.exec(o);)i.push(f.index);for(;++l<i.length;)d!==i[l]&&a.push(e.slice(d,i[l])),a.push("\\"),d=i[l];return a.push(e.slice(d)),a.join("")}function PK(e){const n=e||{},t=n.now||{};let i=n.lineShift||0,a=t.line||1,o=t.column||1;return{move:f,current:l,shift:d};function l(){return{now:{line:a,column:o},lineShift:i}}function d(u){i+=u}function f(u){const p=u||"",g=p.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,o=g.length===1?o+b.length:1+b.length+i,p}}function DK(e,n){const t=n||{},i={associationId:SK,containerPhrasing:OK,containerFlow:LK,createTracker:PK,compilePattern:NK,enter:o,handlers:{...xK},handle:void 0,indentLines:TK,indexStack:[],join:[...bK],options:{},safe:FK,stack:[],unsafe:[...wK]};kE(i,t),i.options.tightDefinitions&&i.join.push(MK),i.handle=_E("type",{invalid:IK,unknown:RK,handlers:i.handlers});let a=i.handle(e,void 0,i,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function o(l){return i.stack.push(l),d;function d(){i.stack.pop()}}}function IK(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function RK(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function MK(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function OK(e,n){return CK(e,this,n)}function LK(e,n){return jK(e,this,n)}function FK(e,n){return EK(this,e,n)}function $K(e){const n=this;n.compiler=t;function t(i){return DK(i,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function a_(e){if(e)throw e}var M0,s_;function zK(){if(s_)return M0;s_=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,i=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var p=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!p&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,p){t&&p.name==="__proto__"?t(u,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):u[p.name]=p.newValue},d=function(u,p){if(p==="__proto__")if(e.call(u,p)){if(i)return i(u,p).value}else return;return u[p]};return M0=function f(){var u,p,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(p in u)g=d(k,p),b=d(u,p),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:p,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:p,newValue:b}));return k},M0}var UK=zK();const O0=qd(UK);function U1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function BK(){const e=[],n={run:t,use:i};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const p=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,p?qK(p,d)(...u):l(null,...u)}}function i(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function qK(e,n){let t;return i;function i(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const p=u;if(d&&t)throw p;return a(p)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}class ma extends Error{constructor(n,t,i){super(),typeof t=="string"&&(i=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof i=="string"){const f=i.indexOf(":");f===-1?o.ruleId=i:(o.source=i.slice(0,f),o.ruleId=i.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=d?d.line:void 0,this.name=qm(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}ma.prototype.file="";ma.prototype.name="";ma.prototype.reason="";ma.prototype.message="";ma.prototype.stack="";ma.prototype.column=void 0;ma.prototype.line=void 0;ma.prototype.ancestors=void 0;ma.prototype.cause=void 0;ma.prototype.fatal=void 0;ma.prototype.place=void 0;ma.prototype.ruleId=void 0;ma.prototype.source=void 0;const Ho={basename:VK,dirname:HK,extname:GK,join:YK,sep:"/"};function VK(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');fg(e);let t=0,i=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else i<0&&(o=!0,i=a+1);return i<0?"":e.slice(t,i)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(i=a):(d=-1,i=l));return t===i?i=l:i<0&&(i=e.length),e.slice(t,i)}function HK(e){if(fg(e),e.length===0)return".";let n=-1,t=e.length,i;for(;--t;)if(e.codePointAt(t)===47){if(i){n=t;break}}else i||(i=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function GK(e){fg(e);let n=e.length,t=-1,i=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){i=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===i+1?"":e.slice(a,t)}function YK(...e){let n=-1,t;for(;++n<e.length;)fg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":WK(t)}function WK(e){fg(e);const n=e.codePointAt(0)===47;let t=QK(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function QK(e,n){let t="",i=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||i!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",i=0):(t=t.slice(0,f),i=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",i=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",i=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),i=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function fg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const JK={cwd:KK};function KK(){return"/"}function B1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function XK(e){if(typeof e=="string")e=new URL(e);else if(!B1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return ZK(e)}function ZK(e){if(e.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const i=n.codePointAt(t+2);if(i===70||i===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const L0=["history","path","basename","stem","extname","dirname"];class eX{constructor(n){let t;n?B1(n)?t={path:n}:typeof n=="string"||tX(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":JK.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<L0.length;){const o=L0[i];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)L0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Ho.basename(this.path):void 0}set basename(n){$0(n,"basename"),F0(n,"basename"),this.path=Ho.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Ho.dirname(this.path):void 0}set dirname(n){o_(this.basename,"dirname"),this.path=Ho.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Ho.extname(this.path):void 0}set extname(n){if(F0(n,"extname"),o_(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Ho.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){B1(n)&&(n=XK(n)),$0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Ho.basename(this.path,this.extname):void 0}set stem(n){$0(n,"stem"),F0(n,"stem"),this.path=Ho.join(this.dirname||"",n+(this.extname||""))}fail(n,t,i){const a=this.message(n,t,i);throw a.fatal=!0,a}info(n,t,i){const a=this.message(n,t,i);return a.fatal=void 0,a}message(n,t,i){const a=new ma(n,t,i);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function F0(e,n){if(e&&e.includes(Ho.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Ho.sep+"`")}function $0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function o_(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function tX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const nX=function(e){const i=this.constructor.prototype,a=i[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,i),o},iX={}.hasOwnProperty;class Qw extends nX{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=BK()}copy(){const n=new Qw;let t=-1;for(;++t<this.attachers.length;){const i=this.attachers[t];n.use(...i)}return n.data(O0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(B0("data",this.frozen),this.namespace[n]=t,this):iX.call(this.namespace,n)&&this.namespace[n]||void 0:n?(B0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const a=t.call(n,...i);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=_x(n),i=this.parser||this.Parser;return z0("parse",i),i(String(t),t)}process(n,t){const i=this;return this.freeze(),z0("process",this.parser||this.Parser),U0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=_x(n),f=i.parse(d);i.run(f,d,function(p,g,b){if(p||!g||!b)return u(p);const v=g,S=i.stringify(v,b);sX(S)?b.value=S:b.result=S,u(p,b)});function u(p,g){p||!g?l(p):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,i;return this.freeze(),z0("processSync",this.parser||this.Parser),U0("processSync",this.compiler||this.Compiler),this.process(n,a),c_("processSync","process",t),i;function a(o,l){t=!0,a_(o),i=l}}run(n,t,i){l_(n),this.freeze();const a=this.transformers;return!i&&typeof t=="function"&&(i=t,t=void 0),i?o(void 0,i):new Promise(o);function o(l,d){const f=_x(t);a.run(n,f,u);function u(p,g,b){const v=g||n;p?d(p):l?l(v):i(void 0,v,b)}}}runSync(n,t){let i=!1,a;return this.run(n,t,o),c_("runSync","run",i),a;function o(l,d){a_(l),a=d,i=!0}}stringify(n,t){this.freeze();const i=_x(t),a=this.compiler||this.Compiler;return U0("stringify",a),l_(n),a(n,i)}use(n,...t){const i=this.attachers,a=this.namespace;if(B0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[p,...g]=u;f(p,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=O0(!0,a.settings,u.settings))}function d(u){let p=-1;if(u!=null)if(Array.isArray(u))for(;++p<u.length;){const g=u[p];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,p){let g=-1,b=-1;for(;++g<i.length;)if(i[g][0]===u){b=g;break}if(b===-1)i.push([u,...p]);else if(p.length>0){let[v,...S]=p;const k=i[b][1];U1(k)&&U1(v)&&(v=O0(!0,k,v)),i[b]=[u,v,...S]}}}}const rX=new Qw().freeze();function z0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function U0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function B0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function l_(e){if(!U1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function c_(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function _x(e){return aX(e)?e:new eX(e)}function aX(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function sX(e){return typeof e=="string"||oX(e)}function oX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const lX=rX().use(PJ).use($K).freeze(),BE=-1,Gb=0,Vm=1,gb=2,Jw=3,Kw=4,Xw=5,Zw=6,qE=7,VE=8,u_=typeof self=="object"?self:globalThis,cX=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),i=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Gb:case BE:return t(l,a);case Vm:{const d=t([],a);for(const f of l)d.push(i(f));return d}case gb:{const d=t({},a);for(const[f,u]of l)d[i(f)]=i(u);return d}case Jw:return t(new Date(l),a);case Kw:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case Xw:{const d=t(new Map,a);for(const[f,u]of l)d.set(i(f),i(u));return d}case Zw:{const d=t(new Set,a);for(const f of l)d.add(i(f));return d}case qE:{const{name:d,message:f}=l;return t(new u_[d](f),a)}case VE:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new u_[o](l),a)};return i},d_=e=>cX(new Map,e)(0),vh="",{toString:uX}={},{keys:dX}=Object,Rm=e=>{const n=typeof e;if(n!=="object"||!e)return[Gb,n];const t=uX.call(e).slice(8,-1);switch(t){case"Array":return[Vm,vh];case"Object":return[gb,vh];case"Date":return[Jw,vh];case"RegExp":return[Kw,vh];case"Map":return[Xw,vh];case"Set":return[Zw,vh];case"DataView":return[Vm,t]}return t.includes("Array")?[Vm,t]:t.includes("Error")?[qE,t]:[gb,t]},kx=([e,n])=>e===Gb&&(n==="function"||n==="symbol"),fX=(e,n,t,i)=>{const a=(l,d)=>{const f=i.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Rm(l);switch(d){case Gb:{let p=l;switch(f){case"bigint":d=VE,p=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);p=null;break;case"undefined":return a([BE],l)}return a([d,p],l)}case Vm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const p=[],g=a([d,p],l);for(const b of l)p.push(o(b));return g}case gb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const p=[],g=a([d,p],l);for(const b of dX(l))(e||!kx(Rm(l[b])))&&p.push([o(b),o(l[b])]);return g}case Jw:return a([d,l.toISOString()],l);case Kw:{const{source:p,flags:g}=l;return a([d,{source:p,flags:g}],l)}case Xw:{const p=[],g=a([d,p],l);for(const[b,v]of l)(e||!(kx(Rm(b))||kx(Rm(v))))&&p.push([o(b),o(v)]);return g}case Zw:{const p=[],g=a([d,p],l);for(const b of l)(e||!kx(Rm(b)))&&p.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},f_=(e,{json:n,lossy:t}={})=>{const i=[];return fX(!(n||t),!!n,new Map,i)(e),i},eg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?d_(f_(e,n)):structuredClone(e):(e,n)=>d_(f_(e,n)),HE=YE("end"),GE=YE("start");function YE(e){return n;function n(t){const i=t&&t.position&&t.position[e]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function WE(e){const n=GE(e),t=HE(e);if(n&&t)return{start:n,end:t}}const Pd=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],h_={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Pd,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Pd],h2:[["className","sr-only"]],img:[...Pd,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Pd,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Pd],table:[...Pd],ul:[...Pd,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},Wc={}.hasOwnProperty;function hX(e,n){let t={type:"root",children:[]};const i={schema:n?{...h_,...n}:h_,stack:[]},a=QE(i,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function QE(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return pX(e,t);case"doctype":return mX(e,t);case"element":return gX(e,t);case"root":return yX(e,t);case"text":return xX(e,t)}}}function pX(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",i=t.indexOf("-->"),o={type:"comment",value:i<0?t:t.slice(0,i)};return hg(o,n),o}}function mX(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return hg(t,n),t}}function gX(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const i=JE(e,n.children),a=bX(e,n.properties);e.stack.pop();let o=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(o=!0,e.schema.ancestors&&Wc.call(e.schema.ancestors,t))){const d=e.schema.ancestors[t];let f=-1;for(o=!1;++f<d.length;)e.stack.includes(d[f])&&(o=!0)}if(!o)return e.schema.strip&&!e.schema.strip.includes(t)?i:void 0;const l={type:"element",tagName:t,properties:a,children:i};return hg(l,n),l}function yX(e,n){const i={type:"root",children:JE(e,n.children)};return hg(i,n),i}function xX(e,n){const i={type:"text",value:typeof n.value=="string"?n.value:""};return hg(i,n),i}function JE(e,n){const t=[];if(Array.isArray(n)){const i=n;let a=-1;for(;++a<i.length;){const o=QE(e,i[a]);o&&(Array.isArray(o)?t.push(...o):t.push(o))}}return t}function bX(e,n){const t=e.stack[e.stack.length-1],i=e.schema.attributes,a=e.schema.required,o=i&&Wc.call(i,t)?i[t]:void 0,l=i&&Wc.call(i,"*")?i["*"]:void 0,d=n&&typeof n=="object"?n:{},f={};let u;for(u in d)if(Wc.call(d,u)){const p=d[u];let g=p_(e,m_(o,u),u,p);g==null&&(g=p_(e,m_(l,u),u,p)),g!=null&&(f[u]=g)}if(a&&Wc.call(a,t)){const p=a[t];for(u in p)Wc.call(p,u)&&!Wc.call(f,u)&&(f[u]=p[u])}return f}function p_(e,n,t,i){return n?Array.isArray(i)?vX(e,n,t,i):KE(e,n,t,i):void 0}function vX(e,n,t,i){let a=-1;const o=[];for(;++a<i.length;){const l=KE(e,n,t,i[a]);(typeof l=="number"||typeof l=="string")&&o.push(l)}return o}function KE(e,n,t,i){if(!(typeof i!="boolean"&&typeof i!="number"&&typeof i!="string")&&wX(e,t,i)){if(typeof n=="object"&&n.length>1){let a=!1,o=0;for(;++o<n.length;){const l=n[o];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(i))){a=!0;break}}else if(l===i){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+i:i}}function wX(e,n,t){const i=e.schema.protocols&&Wc.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!i||i.length===0)return!0;const a=String(t),o=a.indexOf(":"),l=a.indexOf("?"),d=a.indexOf("#"),f=a.indexOf("/");if(o<0||f>-1&&o>f||l>-1&&o>l||d>-1&&o>d)return!0;let u=-1;for(;++u<i.length;){const p=i[u];if(o===p.length&&a.slice(0,p.length)===p)return!0}return!1}function hg(e,n){const t=WE(n);n.data&&(e.data=eg(n.data)),t&&(e.position=t)}function m_(e,n){let t,i=-1;if(e)for(;++i<e.length;){const a=e[i],o=typeof a=="string"?a:a[0];if(o===n)return a;o==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function SX(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function NX(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function CX(e,n){const t=n.value?n.value+`
`:"",i={};n.lang&&(i.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:i,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function jX(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function _X(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function kX(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",i=String(n.identifier).toUpperCase(),a=Wh(i.toLowerCase()),o=e.footnoteOrder.indexOf(i);let l,d=e.footnoteCounts.get(i);d===void 0?(d=0,e.footnoteOrder.push(i),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(i,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function TX(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function EX(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function XE(e,n){const t=n.referenceType;let i="]";if(t==="collapsed"?i+="[]":t==="full"&&(i+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+i}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=i:a.push({type:"text",value:i}),a}function AX(e,n){const t=String(n.identifier).toUpperCase(),i=e.definitionById.get(t);if(!i)return XE(e,n);const a={src:Wh(i.url||""),alt:n.alt};i.title!==null&&i.title!==void 0&&(a.title=i.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function PX(e,n){const t={src:Wh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const i={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,i),e.applyData(n,i)}function DX(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const i={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,i),e.applyData(n,i)}function IX(e,n){const t=String(n.identifier).toUpperCase(),i=e.definitionById.get(t);if(!i)return XE(e,n);const a={href:Wh(i.url||"")};i.title!==null&&i.title!==void 0&&(a.title=i.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function RX(e,n){const t={href:Wh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const i={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,i),e.applyData(n,i)}function MX(e,n,t){const i=e.all(n),a=t?OX(t):ZE(n),o={},l=[];if(typeof n.checked=="boolean"){const p=i[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},i.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<i.length;){const p=i[d];(a||d!==0||p.type!=="element"||p.tagName!=="p")&&l.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?l.push(...p.children):l.push(p)}const f=i[i.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function OX(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let i=-1;for(;!n&&++i<t.length;)n=ZE(t[i])}return n}function ZE(e){const n=e.spread;return n??e.children.length>1}function LX(e,n){const t={},i=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<i.length;){const l=i[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(i,!0)};return e.patch(n,o),e.applyData(n,o)}function FX(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function $X(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function zX(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function UX(e,n){const t=e.all(n),i=t.shift(),a=[];if(i){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=GE(n.children[1]),f=HE(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function BX(e,n,t){const i=t?t.children:void 0,o=(i?i.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const p={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,p),e.applyData(n,p)}function qX(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const g_=9,y_=32;function VX(e){const n=String(e),t=/\r?\n|\r/g;let i=t.exec(n),a=0;const o=[];for(;i;)o.push(x_(n.slice(a,i.index),a>0,!0),i[0]),a=i.index+i[0].length,i=t.exec(n);return o.push(x_(n.slice(a),a>0,!1)),o.join("")}function x_(e,n,t){let i=0,a=e.length;if(n){let o=e.codePointAt(i);for(;o===g_||o===y_;)i++,o=e.codePointAt(i)}if(t){let o=e.codePointAt(a-1);for(;o===g_||o===y_;)a--,o=e.codePointAt(a-1)}return a>i?e.slice(i,a):""}function HX(e,n){const t={type:"text",value:VX(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function GX(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const YX={blockquote:SX,break:NX,code:CX,delete:jX,emphasis:_X,footnoteReference:kX,heading:TX,html:EX,imageReference:AX,image:PX,inlineCode:DX,linkReference:IX,link:RX,listItem:MX,list:LX,paragraph:FX,root:$X,strong:zX,table:UX,tableCell:qX,tableRow:BX,text:HX,thematicBreak:GX,toml:Tx,yaml:Tx,definition:Tx,footnoteDefinition:Tx};function Tx(){}function WX(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function QX(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function JX(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||WX,i=e.options.footnoteBackLabel||QX,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const p=e.all(u),g=String(u.identifier).toUpperCase(),b=Wh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=p[p.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else p.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(p,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...eg(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const q1={}.hasOwnProperty,KX={};function XX(e,n){const t=n||KX,i=new Map,a=new Map,o=new Map,l={...YX,...t.handlers},d={all:u,applyData:eZ,definitionById:i,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:ZX,wrap:nZ};return PE(e,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?i:a,b=String(p.identifier).toUpperCase();g.has(b)||g.set(b,p)}}),d;function f(p,g){const b=p.type,v=d.handlers[b];if(q1.call(d.handlers,b)&&v)return v(d,p,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in p){const{children:k,...T}=p,P=eg(T);return P.children=d.all(p),P}return eg(p)}return(d.options.unknownHandler||tZ)(d,p,g)}function u(p){const g=[];if("children"in p){const b=p.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],p);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=b_(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=b_(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function ZX(e,n){e.position&&(n.position=WE(e))}function eZ(e,n){let t=n;if(e&&e.data){const i=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof i=="string")if(t.type==="element")t.tagName=i;else{const l="children"in t?t.children:[t];t={type:"element",tagName:i,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,eg(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function tZ(e,n){const t=n.data||{},i="value"in n&&!(q1.call(t,"hProperties")||q1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,i),e.applyData(n,i)}function nZ(e,n){const t=[];let i=-1;for(n&&t.push({type:"text",value:`
`});++i<e.length;)i&&t.push({type:"text",value:`
`}),t.push(e[i]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function b_(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function iZ(e,n){const t=XX(e,n),i=t.one(e,void 0),a=JX(t),o=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}const rZ=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class pg{constructor(n,t,i){this.normal=t,this.property=n,i&&(this.space=i)}}pg.prototype.normal={};pg.prototype.property={};pg.prototype.space=void 0;function eA(e,n){const t={},i={};for(const a of e)Object.assign(t,a.property),Object.assign(i,a.normal);return new pg(t,i,n)}function V1(e){return e.toLowerCase()}class ga{constructor(n,t){this.attribute=t,this.property=n}}ga.prototype.attribute="";ga.prototype.booleanish=!1;ga.prototype.boolean=!1;ga.prototype.commaOrSpaceSeparated=!1;ga.prototype.commaSeparated=!1;ga.prototype.defined=!1;ga.prototype.mustUseProperty=!1;ga.prototype.number=!1;ga.prototype.overloadedBoolean=!1;ga.prototype.property="";ga.prototype.spaceSeparated=!1;ga.prototype.space=void 0;let aZ=0;const Jt=Hd(),Mi=Hd(),H1=Hd(),st=Hd(),ti=Hd(),Ah=Hd(),Ma=Hd();function Hd(){return 2**++aZ}const G1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Jt,booleanish:Mi,commaOrSpaceSeparated:Ma,commaSeparated:Ah,number:st,overloadedBoolean:H1,spaceSeparated:ti},Symbol.toStringTag,{value:"Module"})),q0=Object.keys(G1);class eS extends ga{constructor(n,t,i,a){let o=-1;if(super(n,t),v_(this,"space",a),typeof i=="number")for(;++o<q0.length;){const l=q0[o];v_(this,q0[o],(i&G1[l])===G1[l])}}}eS.prototype.defined=!0;function v_(e,n,t){t&&(e[n]=t)}function Qh(e){const n={},t={};for(const[i,a]of Object.entries(e.properties)){const o=new eS(i,e.transform(e.attributes||{},i),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),n[i]=o,t[V1(i)]=i,t[V1(o.attribute)]=i}return new pg(n,t,e.space)}const tA=Qh({properties:{ariaActiveDescendant:null,ariaAtomic:Mi,ariaAutoComplete:null,ariaBusy:Mi,ariaChecked:Mi,ariaColCount:st,ariaColIndex:st,ariaColSpan:st,ariaControls:ti,ariaCurrent:null,ariaDescribedBy:ti,ariaDetails:null,ariaDisabled:Mi,ariaDropEffect:ti,ariaErrorMessage:null,ariaExpanded:Mi,ariaFlowTo:ti,ariaGrabbed:Mi,ariaHasPopup:null,ariaHidden:Mi,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ti,ariaLevel:st,ariaLive:null,ariaModal:Mi,ariaMultiLine:Mi,ariaMultiSelectable:Mi,ariaOrientation:null,ariaOwns:ti,ariaPlaceholder:null,ariaPosInSet:st,ariaPressed:Mi,ariaReadOnly:Mi,ariaRelevant:null,ariaRequired:Mi,ariaRoleDescription:ti,ariaRowCount:st,ariaRowIndex:st,ariaRowSpan:st,ariaSelected:Mi,ariaSetSize:st,ariaSort:null,ariaValueMax:st,ariaValueMin:st,ariaValueNow:st,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function nA(e,n){return n in e?e[n]:n}function iA(e,n){return nA(e,n.toLowerCase())}const sZ=Qh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ah,acceptCharset:ti,accessKey:ti,action:null,allow:null,allowFullScreen:Jt,allowPaymentRequest:Jt,allowUserMedia:Jt,alt:null,as:null,async:Jt,autoCapitalize:null,autoComplete:ti,autoFocus:Jt,autoPlay:Jt,blocking:ti,capture:null,charSet:null,checked:Jt,cite:null,className:ti,cols:st,colSpan:null,content:null,contentEditable:Mi,controls:Jt,controlsList:ti,coords:st|Ah,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Jt,defer:Jt,dir:null,dirName:null,disabled:Jt,download:H1,draggable:Mi,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Jt,formTarget:null,headers:ti,height:st,hidden:H1,high:st,href:null,hrefLang:null,htmlFor:ti,httpEquiv:ti,id:null,imageSizes:null,imageSrcSet:null,inert:Jt,inputMode:null,integrity:null,is:null,isMap:Jt,itemId:null,itemProp:ti,itemRef:ti,itemScope:Jt,itemType:ti,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Jt,low:st,manifest:null,max:null,maxLength:st,media:null,method:null,min:null,minLength:st,multiple:Jt,muted:Jt,name:null,nonce:null,noModule:Jt,noValidate:Jt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Jt,optimum:st,pattern:null,ping:ti,placeholder:null,playsInline:Jt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Jt,referrerPolicy:null,rel:ti,required:Jt,reversed:Jt,rows:st,rowSpan:st,sandbox:ti,scope:null,scoped:Jt,seamless:Jt,selected:Jt,shadowRootClonable:Jt,shadowRootDelegatesFocus:Jt,shadowRootMode:null,shape:null,size:st,sizes:null,slot:null,span:st,spellCheck:Mi,src:null,srcDoc:null,srcLang:null,srcSet:null,start:st,step:null,style:null,tabIndex:st,target:null,title:null,translate:null,type:null,typeMustMatch:Jt,useMap:null,value:Mi,width:st,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ti,axis:null,background:null,bgColor:null,border:st,borderColor:null,bottomMargin:st,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Jt,declare:Jt,event:null,face:null,frame:null,frameBorder:null,hSpace:st,leftMargin:st,link:null,longDesc:null,lowSrc:null,marginHeight:st,marginWidth:st,noResize:Jt,noHref:Jt,noShade:Jt,noWrap:Jt,object:null,profile:null,prompt:null,rev:null,rightMargin:st,rules:null,scheme:null,scrolling:Mi,standby:null,summary:null,text:null,topMargin:st,valueType:null,version:null,vAlign:null,vLink:null,vSpace:st,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Jt,disableRemotePlayback:Jt,prefix:null,property:null,results:st,security:null,unselectable:null},space:"html",transform:iA}),oZ=Qh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ma,accentHeight:st,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:st,amplitude:st,arabicForm:null,ascent:st,attributeName:null,attributeType:null,azimuth:st,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:st,by:null,calcMode:null,capHeight:st,className:ti,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:st,diffuseConstant:st,direction:null,display:null,dur:null,divisor:st,dominantBaseline:null,download:Jt,dx:null,dy:null,edgeMode:null,editable:null,elevation:st,enableBackground:null,end:null,event:null,exponent:st,externalResourcesRequired:null,fill:null,fillOpacity:st,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ah,g2:Ah,glyphName:Ah,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:st,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:st,horizOriginX:st,horizOriginY:st,id:null,ideographic:st,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:st,k:st,k1:st,k2:st,k3:st,k4:st,kernelMatrix:Ma,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:st,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:st,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:st,overlineThickness:st,paintOrder:null,panose1:null,path:null,pathLength:st,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ti,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:st,pointsAtY:st,pointsAtZ:st,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ma,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ma,rev:Ma,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ma,requiredFeatures:Ma,requiredFonts:Ma,requiredFormats:Ma,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:st,specularExponent:st,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:st,strikethroughThickness:st,string:null,stroke:null,strokeDashArray:Ma,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:st,strokeOpacity:st,strokeWidth:null,style:null,surfaceScale:st,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ma,tabIndex:st,tableValues:null,target:null,targetX:st,targetY:st,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ma,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:st,underlineThickness:st,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:st,values:null,vAlphabetic:st,vMathematical:st,vectorEffect:null,vHanging:st,vIdeographic:st,version:null,vertAdvY:st,vertOriginX:st,vertOriginY:st,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:st,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:nA}),rA=Qh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),aA=Qh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:iA}),sA=Qh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),lZ=/[A-Z]/g,w_=/-[a-z]/g,cZ=/^data[-\w.:]+$/i;function uZ(e,n){const t=V1(n);let i=n,a=ga;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&cZ.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(w_,fZ);i="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!w_.test(o)){let l=o.replace(lZ,dZ);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=eS}return new a(i,n)}function dZ(e){return"-"+e.toLowerCase()}function fZ(e){return e.charAt(1).toUpperCase()}const hZ=eA([tA,sZ,rA,aA,sA],"html"),oA=eA([tA,oZ,rA,aA,sA],"svg"),pZ=/["&'<>`]/g,mZ=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,gZ=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,yZ=/[|\\{}()[\]^$+*?.]/g,S_=new WeakMap;function xZ(e,n){if(e=e.replace(n.subset?bZ(n.subset):pZ,i),n.subset||n.escapeOnly)return e;return e.replace(mZ,t).replace(gZ,i);function t(a,o,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(o+2),n)}function i(a,o,l){return n.format(a.charCodeAt(0),l.charCodeAt(o+1),n)}}function bZ(e){let n=S_.get(e);return n||(n=vZ(e),S_.set(e,n)),n}function vZ(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(yZ,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const wZ=/[\dA-Fa-f]/;function SZ(e,n,t){const i="&#x"+e.toString(16).toUpperCase();return t&&n&&!wZ.test(String.fromCharCode(n))?i:i+";"}const NZ=/\d/;function CZ(e,n,t){const i="&#"+String(e);return t&&n&&!NZ.test(String.fromCharCode(n))?i:i+";"}const jZ=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],V0={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},_Z=["cent","copy","divide","gt","lt","not","para","times"],lA={}.hasOwnProperty,Y1={};let Ex;for(Ex in V0)lA.call(V0,Ex)&&(Y1[V0[Ex]]=Ex);const kZ=/[^\dA-Za-z]/;function TZ(e,n,t,i){const a=String.fromCharCode(e);if(lA.call(Y1,a)){const o=Y1[a],l="&"+o;return t&&jZ.includes(o)&&!_Z.includes(o)&&(!i||n&&n!==61&&kZ.test(String.fromCharCode(n)))?l:l+";"}return""}function EZ(e,n,t){let i=SZ(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=TZ(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const o=CZ(e,n,t.omitOptionalSemicolons);o.length<i.length&&(i=o)}return a&&(!t.useShortestReferences||a.length<i.length)?a:i}function Ph(e,n){return xZ(e,Object.assign({format:EZ},n))}const AZ=/^>|^->|<!--|-->|--!>|<!-$/g,PZ=[">"],DZ=["<",">"];function IZ(e,n,t,i){return i.settings.bogusComments?"<?"+Ph(e.value,Object.assign({},i.settings.characterReferences,{subset:PZ}))+">":"<!--"+e.value.replace(AZ,a)+"-->";function a(o){return Ph(o,Object.assign({},i.settings.characterReferences,{subset:DZ}))}}function RZ(e,n,t,i){return"<!"+(i.settings.upperDoctype?"DOCTYPE":"doctype")+(i.settings.tightDoctype?"":" ")+"html>"}function N_(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let i=0,a=t.indexOf(n);for(;a!==-1;)i++,a=t.indexOf(n,a+n.length);return i}function MZ(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function OZ(e){return e.join(" ").trim()}const LZ=/[ \t\n\f\r]/g;function tS(e){return typeof e=="object"?e.type==="text"?C_(e.value):!1:C_(e)}function C_(e){return e.replace(LZ,"")===""}const Bi=uA(1),cA=uA(-1),FZ=[];function uA(e){return n;function n(t,i,a){const o=t?t.children:FZ;let l=(i||0)+e,d=o[l];if(!a)for(;d&&tS(d);)l+=e,d=o[l];return d}}const $Z={}.hasOwnProperty;function dA(e){return n;function n(t,i,a){return $Z.call(e,t.tagName)&&e[t.tagName](t,i,a)}}const nS=dA({body:UZ,caption:H0,colgroup:H0,dd:HZ,dt:VZ,head:H0,html:zZ,li:qZ,optgroup:GZ,option:YZ,p:BZ,rp:j_,rt:j_,tbody:QZ,td:__,tfoot:JZ,th:__,thead:WZ,tr:KZ});function H0(e,n,t){const i=Bi(t,n,!0);return!i||i.type!=="comment"&&!(i.type==="text"&&tS(i.value.charAt(0)))}function zZ(e,n,t){const i=Bi(t,n);return!i||i.type!=="comment"}function UZ(e,n,t){const i=Bi(t,n);return!i||i.type!=="comment"}function BZ(e,n,t){const i=Bi(t,n);return i?i.type==="element"&&(i.tagName==="address"||i.tagName==="article"||i.tagName==="aside"||i.tagName==="blockquote"||i.tagName==="details"||i.tagName==="div"||i.tagName==="dl"||i.tagName==="fieldset"||i.tagName==="figcaption"||i.tagName==="figure"||i.tagName==="footer"||i.tagName==="form"||i.tagName==="h1"||i.tagName==="h2"||i.tagName==="h3"||i.tagName==="h4"||i.tagName==="h5"||i.tagName==="h6"||i.tagName==="header"||i.tagName==="hgroup"||i.tagName==="hr"||i.tagName==="main"||i.tagName==="menu"||i.tagName==="nav"||i.tagName==="ol"||i.tagName==="p"||i.tagName==="pre"||i.tagName==="section"||i.tagName==="table"||i.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function qZ(e,n,t){const i=Bi(t,n);return!i||i.type==="element"&&i.tagName==="li"}function VZ(e,n,t){const i=Bi(t,n);return!!(i&&i.type==="element"&&(i.tagName==="dt"||i.tagName==="dd"))}function HZ(e,n,t){const i=Bi(t,n);return!i||i.type==="element"&&(i.tagName==="dt"||i.tagName==="dd")}function j_(e,n,t){const i=Bi(t,n);return!i||i.type==="element"&&(i.tagName==="rp"||i.tagName==="rt")}function GZ(e,n,t){const i=Bi(t,n);return!i||i.type==="element"&&i.tagName==="optgroup"}function YZ(e,n,t){const i=Bi(t,n);return!i||i.type==="element"&&(i.tagName==="option"||i.tagName==="optgroup")}function WZ(e,n,t){const i=Bi(t,n);return!!(i&&i.type==="element"&&(i.tagName==="tbody"||i.tagName==="tfoot"))}function QZ(e,n,t){const i=Bi(t,n);return!i||i.type==="element"&&(i.tagName==="tbody"||i.tagName==="tfoot")}function JZ(e,n,t){return!Bi(t,n)}function KZ(e,n,t){const i=Bi(t,n);return!i||i.type==="element"&&i.tagName==="tr"}function __(e,n,t){const i=Bi(t,n);return!i||i.type==="element"&&(i.tagName==="td"||i.tagName==="th")}const XZ=dA({body:tee,colgroup:nee,head:eee,html:ZZ,tbody:iee});function ZZ(e){const n=Bi(e,-1);return!n||n.type!=="comment"}function eee(e){const n=new Set;for(const i of e.children)if(i.type==="element"&&(i.tagName==="base"||i.tagName==="title")){if(n.has(i.tagName))return!1;n.add(i.tagName)}const t=e.children[0];return!t||t.type==="element"}function tee(e){const n=Bi(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&tS(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function nee(e,n,t){const i=cA(t,n),a=Bi(e,-1,!0);return t&&i&&i.type==="element"&&i.tagName==="colgroup"&&nS(i,t.children.indexOf(i),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function iee(e,n,t){const i=cA(t,n),a=Bi(e,-1);return t&&i&&i.type==="element"&&(i.tagName==="thead"||i.tagName==="tbody")&&nS(i,t.children.indexOf(i),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Ax={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function ree(e,n,t,i){const a=i.schema,o=a.space==="svg"?!1:i.settings.omitOptionalTags;let l=a.space==="svg"?i.settings.closeEmptyElements:i.settings.voids.includes(e.tagName.toLowerCase());const d=[];let f;a.space==="html"&&e.tagName==="svg"&&(i.schema=oA);const u=aee(i,e.properties),p=i.all(a.space==="html"&&e.tagName==="template"?e.content:e);return i.schema=a,p&&(l=!1),(u||!o||!XZ(e,n,t))&&(d.push("<",e.tagName,u?" "+u:""),l&&(a.space==="svg"||i.settings.closeSelfClosing)&&(f=u.charAt(u.length-1),(!i.settings.tightSelfClosing||f==="/"||f&&f!=='"'&&f!=="'")&&d.push(" "),d.push("/")),d.push(">")),d.push(p),!l&&(!o||!nS(e,n,t))&&d.push("</"+e.tagName+">"),d.join("")}function aee(e,n){const t=[];let i=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const o=see(e,a,n[a]);o&&t.push(o)}}for(;++i<t.length;){const o=e.settings.tightAttributes?t[i].charAt(t[i].length-1):void 0;i!==t.length-1&&o!=='"'&&o!=="'"&&(t[i]+=" ")}return t.join("")}function see(e,n,t){const i=uZ(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,o=e.settings.allowDangerousCharacters?0:1;let l=e.quote,d;if(i.overloadedBoolean&&(t===i.attribute||t==="")?t=!0:(i.boolean||i.overloadedBoolean)&&(typeof t!="string"||t===i.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const f=Ph(i.attribute,Object.assign({},e.settings.characterReferences,{subset:Ax.name[a][o]}));return t===!0||(t=Array.isArray(t)?(i.commaSeparated?MZ:OZ)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?f:(e.settings.preferUnquoted&&(d=Ph(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Ax.unquoted[a][o]}))),d!==t&&(e.settings.quoteSmart&&N_(t,l)>N_(t,e.alternative)&&(l=e.alternative),d=l+Ph(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?Ax.single:Ax.double)[a][o],attribute:!0}))+l),f+(d&&"="+d))}const oee=["<","&"];function fA(e,n,t,i){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Ph(e.value,Object.assign({},i.settings.characterReferences,{subset:oee}))}function lee(e,n,t,i){return i.settings.allowDangerousHtml?e.value:fA(e,n,t,i)}function cee(e,n,t,i){return i.all(e)}const uee=_E("type",{invalid:dee,unknown:fee,handlers:{comment:IZ,doctype:RZ,element:ree,raw:lee,root:cee,text:fA}});function dee(e){throw new Error("Expected node, not `"+e+"`")}function fee(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const hee={},pee={},mee=[];function gee(e,n){const t=n||hee,i=t.quote||'"',a=i==='"'?"'":'"';if(i!=='"'&&i!=="'")throw new Error("Invalid quote `"+i+"`, expected `'` or `\"`");return{one:yee,all:xee,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||rZ,characterReferences:t.characterReferences||pee,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?oA:hZ,quote:i,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function yee(e,n,t){return uee(e,n,t,this)}function xee(e){const n=[],t=e&&e.children||mee;let i=-1;for(;++i<t.length;)n[i]=this.one(t[i],i,e);return n.join("")}const bee={};function vee(e){const n=this,{handlers:t,sanitize:i,...a}=e||bee;let o=!1,l;typeof i=="boolean"?o=!i:i&&(l=i),n.compiler=d;function d(f,u){const p=iZ(f,{handlers:t,allowDangerousHtml:o}),g=o?p:hX(p,l),b=gee(g,{...a,allowDangerousHtml:o});return u.extname&&(u.extname=".html"),f&&f.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const wee=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:i,fetchPharmacyOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,p]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){p([]);return}const I=d.toLowerCase();p(i.filter(U=>U.name.toLowerCase().includes(I)).slice(0,10))},[d,i]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one drug.");return}for(const I of o)if(I.selected_pack_quantity===0&&I.selected_loose_quantity===0){b(`Please specify a quantity for ${I.name}.`);return}S(!0),b(null);try{const I={patient_id:t,items:o.map(L=>({drug_id:L.id,name:L.name,pack_quantity:L.selected_pack_quantity,loose_quantity:L.selected_loose_quantity,pack_price:0,loose_price:0,total_price:0,tabletsPerDay:1,numberOfDays:1,directions_to_use:"As directed"})),order_total:0,prescription_for_unavailable_drugs:""},U=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!U.ok){const L=await U.json().catch(()=>({}));throw new Error(L.message||`Failed to create pharmacy order: ${U.statusText}`)}await U.json(),a(t),n(),l([]),f("")}catch(I){b(`Order Creation Error: ${I.message}`)}finally{S(!1)}},T=I=>{if(o.some(U=>U.id===I.id)){b(`${I.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),p([]);return}l(U=>[...U,{...I,selected_pack_quantity:0,selected_loose_quantity:0}]),f(""),p([])},P=I=>{l(U=>U.filter(L=>L.id!==I))},M=(I,U,L)=>{const F=parseInt(L)||0;l(z=>z.map($=>$.id===I?{...$,[U==="pack"?"selected_pack_quantity":"selected_loose_quantity"]:F}:$))};return e?r.jsx("div",{className:jt.modalOverlay,children:r.jsxs("div",{className:jt.modalContent,children:[r.jsxs("div",{className:jt.modalHeader,children:[r.jsx("h3",{className:jt.modalTitle,children:"Create Pharmacy Order"}),r.jsx("button",{onClick:n,className:jt.modalCloseButton,children:r.jsx(ni,{size:20})})]}),r.jsxs("div",{className:jt.modalBody,children:[g&&r.jsx("div",{className:jt.errorText,children:g}),r.jsxs("div",{className:jt.formGroup,style:{position:"relative"},children:[r.jsx("label",{htmlFor:"drug-search",children:"Add Drug"}),r.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:d,onChange:I=>f(I.target.value),className:jt.inputField,autoComplete:"off"}),d&&u.length>0&&r.jsx("div",{className:jt.searchResultsCard,children:r.jsx("ul",{className:jt.searchResultsList,children:u.map(I=>r.jsx("li",{onClick:()=>T(I),className:jt.searchResultItem,children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[r.jsx("span",{children:I.name}),r.jsxs("span",{className:jt.searchResultPrice,children:["Stock: ",I.quantity_in_stock," (Box) / ",I.loose||0," (Loose)"]})]})},I.id))})})]}),r.jsxs("div",{className:jt.selectedTestsCard,children:[" ",r.jsx("h4",{className:jt.selectedTestsHeader,children:"Selected Drugs"}),o.length===0?r.jsx("p",{className:jt.noTestsMessage,children:"No drugs added yet."}):r.jsx("ul",{className:jt.selectedTestsList,children:o.map(I=>r.jsxs("li",{className:jt.selectedTestItem,style:{flexDirection:"column",alignItems:"flex-start",gap:"8px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},children:[r.jsx("span",{className:jt.selectedTestName,style:{fontWeight:"bold"},children:I.name}),r.jsx("button",{type:"button",onClick:()=>P(String(I.id)),className:jt.removeTestButton,title:"Remove Drug",children:r.jsx(lr,{size:16})})]}),r.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",width:"100%"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Packs"}),r.jsx("input",{type:"number",min:"0",className:jt.inputField,style:{padding:"4px 8px"},value:I.selected_pack_quantity||"",onChange:U=>M(I.id,"pack",U.target.value),placeholder:"0"})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Loose"}),r.jsx("input",{type:"number",min:"0",className:jt.inputField,style:{padding:"4px 8px"},value:I.selected_loose_quantity||"",onChange:U=>M(I.id,"loose",U.target.value),placeholder:"0"})]})]})]},I.id))})]})]}),r.jsxs("div",{className:jt.modalFooter,children:[r.jsx("button",{type:"button",onClick:n,className:`${jt.button} ${jt.buttonSecondary}`,children:" Cancel "}),r.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${jt.button} ${jt.buttonPrimary} ${o.length===0||v?jt.buttonDisabled:""}`,children:[" ",v?"Creating...":"Create Order"," "]})]})]})}):null},G0=e=>{if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return"";const t=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,16)},k_=()=>{var gr,Ps;const{recordId:e,patientId:n}=Qr(),[t,i]=w.useState(e||void 0),a=kt(),o=cr(),[l,d]=w.useState(""),[f]=w.useState([]),[u,p]=w.useState(null),[g,b]=w.useState(null),[v,S]=w.useState(void 0),[k,T]=w.useState(void 0),[P,M]=w.useState(null),[I,U]=w.useState(!1),[L,F]=w.useState(""),[z,$]=w.useState(!1),[B,R]=w.useState(null),[V,Y]=w.useState(null),[ie,te]=w.useState(!1),[W,H]=w.useState(!1),[Q,J]=w.useState(null),[fe,A]=w.useState(""),[oe,ue]=w.useState(""),[D,se]=w.useState(null),[be,ee]=w.useState(!1),[ce,re]=w.useState(!1),[Pe,Qe]=w.useState(null),[Se,Ne]=w.useState(!1),[De,Me]=w.useState(null),[nt,ft]=w.useState(window.innerHeight),[ut,rt]=w.useState([]),[Nt,Ft]=w.useState(!1),[ye,Te]=w.useState(null),[Ye,$e]=w.useState([]),[_e,X]=w.useState([]),[de,qe]=w.useState(!1),[et,ct]=w.useState(null),Fe=w.useRef(null),ot=w.useRef(null),ve=w.useRef(!1),xe=w.useRef(null),Be=w.useRef(null),Ue=w.useRef(null),tt=w.useRef(null),dt=w.useRef(null),qt=w.useRef(null),On=w.useRef(null),[Tt,Rt]=w.useState([]),[si,ki]=w.useState(!1);w.useEffect(()=>{(async()=>{if(Tt.length>0&&!si){ki(!0);const me=Tt[0];me.current&&(me.current.scrollIntoView({behavior:"smooth",block:"center"}),me.current.classList.add("ai-glow"),await new Promise(le=>setTimeout(le,2e3)),me.current&&me.current.classList.remove("ai-glow")),Rt(le=>le.slice(1)),ki(!1)}})()},[Tt,si]);const bn=ae=>{let me=null;switch(ae){case"update_patient_details":me=Ue;break;case"create_pharmacy_order":case"edit_pharmacy_order":me=tt;break;case"create_lab_order":case"edit_lab_order":me=dt;break;case"add_complaint_history":me=qt;break;case"update_case_summary":me=On;break}me&&Rt(le=>[...le,me])},[Ti,rn]=w.useState(33.33),[ps,ql]=w.useState(!1),bi=w.useRef(null),Ln=w.useRef(null),[Li,Jr]=w.useState("response"),ms=w.useRef(null),el=w.useRef(null),Gd=150,[uu,tl]=w.useState([]),[nl,no]=w.useState([]),[ya,gs]=w.useState(!1),[ys,hi]=w.useState(null),[Yd,Wd]=w.useState(!1),[Mr,io]=w.useState(null),[Vl,Qd]=w.useState(!1),[xa,Jh]=w.useState(null),[Hl,Gl]=w.useState(!1),[ur,Yl]=w.useState(null),[du,ro]=w.useState(!1),[il,fu]=w.useState(null),[Kh,hu]=w.useState(!1),[Fi,pu]=w.useState(null),[rl,Xi]=w.useState([]),[xs,za]=w.useState(!1),[mu,Zi]=w.useState(null),[ao,al]=w.useState(!1),[so,bs]=w.useState(null),[oo,Wl]=w.useState({}),[Ua,vs]=w.useState(!1),[Ql,Jl]=w.useState(!1),[lo,gu]=w.useState(!1),[Kl,co]=w.useState(!1),[uo,Xl]=w.useState(!1),[Ba,ws]=w.useState(!1),[sl,Zl]=w.useState(!1),[ol,ba]=w.useState(!1),dr=w.useMemo(()=>(g==null?void 0:g.admission_date)&&!(g!=null&&g.discharge_date),[g]),[fo,qa]=w.useState(!1),[Va,ll]=w.useState(null),[ho,ec]=w.useState(""),[vn,mn]=w.useState(void 0),[tc,Ei]=w.useState(void 0),[va,po]=w.useState(void 0),[er,yu]=w.useState(!1),[cl,wa]=w.useState(null),[ri,Ha]=w.useState(null),[Ga,nc]=w.useState(null),[Ss,fr]=w.useState(!1),Ns=w.useRef(null),[xu,ic]=w.useState(null),[rc,bu]=w.useState(null),ul=w.useRef(null),[qi,vu]=w.useState(!1),[Vi,Jd]=w.useState(!1),[Nn,hr]=w.useState(null),[Cs,dl]=w.useState(""),[jn,tr]=w.useState(""),[wu,Kd]=w.useState(!0),[Ya,Xd]=w.useState(!1),[Su,ac]=w.useState(!1),[js,fl]=w.useState(!1),[mo,sc]=w.useState(!1),Kr=w.useRef(null),Zd=async()=>{Kr.current&&(await Kr.current.undoLastAction(),sc(!1))},Sa=async ae=>{try{const me=await pe(`/api/patients/${ae}`);if(!me.ok){const je=await me.json().catch(()=>({}));throw new Error(je.message||`Failed to fetch patient details: ${me.status}`)}const le=await me.json();if(b(le),S(le.age),T(le.gender),A(le.ai_response||""),b(je=>je?{...je,current_status:le.current_status,admission_date:le.admission_date,discharge_date:le.discharge_date}:{...le,current_status:le.current_status,admission_date:le.admission_date,discharge_date:le.discharge_date}),le.insurance_type&&b(je=>je?{...je,insurance_type:le.insurance_type}:{...le}),cc(ae),le.ai_response){const je=/```json\s*([\s\S]*?)\s*```/,Je=le.ai_response.match(je);if(Je&&Je[1])ue(le.ai_response.replace(je,"").trim()),se(Je[1].trim());else{const lt=le.ai_response.trim();if(lt.startsWith("{")&&lt.endsWith("}"))try{JSON.parse(lt),ue(""),se(lt)}catch{ue(lt),se(null)}else if(lt.startsWith("[")&&lt.endsWith("]"))try{JSON.parse(lt),ue(""),se(lt)}catch{ue(lt),se(null)}else ue(lt),se(null)}}else ue(""),se(null)}catch{b(null),A(""),ue(""),se(null)}},oc=async(ae,me)=>{b(le=>le?{...le,insurance_type:me}:null);try{const le=await pe(`/api/patients/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:me})});if(!le.ok){const je=await le.json();throw new Error(je.message||"Failed to update insurance type")}}catch(le){console.error("Error updating insurance type:",le),ae&&Sa(ae)}},lc=async ae=>{qe(!0),ct(null),X([]);try{const me=await pe(`/api/queue/patient/${ae}/complaints`);if(!me.ok){const je=await me.json().catch(()=>({}));throw new Error(je.message||`HTTP error! status: ${me.status}`)}const le=await me.json();X(le||[])}catch(me){ct(`Past complaints error: ${me.message}`)}finally{qe(!1)}},_s=async ae=>{$e([]);try{const me=await pe(`/api/pharmacy-orders/patient/${ae}`);if(!me.ok){const je=await me.json().catch(()=>({}));throw new Error(je.message||`HTTP error! status: ${me.status}`)}const le=await me.json();$e(le||[])}catch{}},Na=async ae=>{za(!0),Zi(null),Xi([]);try{const me=await pe(`/api/lab/orders/patient/${ae}`);if(!me.ok){const je=await me.json().catch(()=>({}));throw new Error(je.message||`HTTP error! status: ${me.status}`)}const le=await me.json();Xi(le||[])}catch(me){Zi(`Pending labs error: ${me.message}`)}finally{za(!1)}},pr=async ae=>{Ft(!0),Te(null),rt([]);try{const me=await pe(`/api/lab/patient/${ae}`);if(!me.ok){const je=await me.json().catch(()=>({}));throw new Error(je.message||`HTTP error! status: ${me.status}`)}const le=await me.json();rt(le||[])}catch(me){Te(`Lab reports error: ${me.message}`)}finally{Ft(!1)}},Xh=async ae=>{try{const me=await pe(`/api/patients/${ae}/context`);if(!me.ok){console.error("Failed to fetch patient context");return}const le=await me.json();if(b(le.patient),S(le.patient.age),T(le.patient.gender),A(le.patient.ai_response||""),le.patient.ai_response){const je=/```json\s*([\s\S]*?)\s*```/,Je=le.patient.ai_response.match(je);if(Je&&Je[1])ue(le.patient.ai_response.replace(je,"").trim()),se(Je[1].trim());else{const lt=le.patient.ai_response.trim();if(lt.startsWith("{")&&lt.endsWith("}"))try{JSON.parse(lt),ue(""),se(lt)}catch{ue(lt),se(null)}else if(lt.startsWith("[")&&lt.endsWith("]"))try{JSON.parse(lt),ue(""),se(lt)}catch{ue(lt),se(null)}else ue(lt),se(null)}}else ue(""),se(null);if(ba(le.patient.current_status==="In Doctor Queue"||le.patient.current_status==="In Consultation"),X(Array.isArray(le.history)?le.history:[]),$e(Array.isArray(le.pharmacyOrders)?le.pharmacyOrders:[]),Array.isArray(le.labOrders)){const je=le.labOrders,Je=je.filter(bt=>!bt.report);Xi(Je);const lt=je.filter(bt=>bt.report).map(bt=>({...bt.report,id:bt.id,patient_id:bt.patient_id,createdAt:bt.createdAt}));rt(lt)}else Xi([]),rt([])}catch(me){console.error("Error fetching patient context:",me)}},cc=async ae=>{try{const me=await pe(`/api/queue/patient/${ae}/latest`);if(!me.ok){const je=await me.json().catch(()=>({}));throw new Error(je.message||`Failed to fetch queue status: ${me.status}`)}const le=await me.json();if(le){const je=new Date(le.createdAt),Je=new Date,lt=je.getDate()===Je.getDate()&&je.getMonth()===Je.getMonth()&&je.getFullYear()===Je.getFullYear(),bt=["waiting","consulting"].includes(le.status);ba(lt&&bt)}else ba(!1)}catch(me){console.error("Error checking patient queue status:",me),ba(!1)}},Hi=async(ae,me)=>{try{if(!(await pe(`/api/pharmacy-orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:me})})).ok)throw new Error("Failed to update pharmacy order date");u&&_s(u)}catch(le){console.error("Error updating pharmacy order date:",le),J("Failed to update pharmacy order date")}},ks=async(ae,me,le)=>{try{const je={};if(me==="order"?je.date=le:me==="report"&&(je.reportDate=le),!(await pe(`/api/lab/orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(je)})).ok)throw new Error("Failed to update lab date");u&&(Na(u),pr(u))}catch(je){console.error("Error updating lab order date:",je),J("Failed to update lab order date")}},Ts=ae=>{a(`/dashboard/edit-pharmacy-order/${ae}`)},go=ae=>{J(null),console.log(`Preparing billing navigation for order: ${ae}`);const me=Ye.find(le=>le.id===ae);if(me){const le=me.medications.map(je=>{const Je=je.price??0;return(je.price===void 0||je.price===null)&&console.warn(`Medication "${je.name}" in order ${ae} is missing a price. Defaulting to 0.`),{name:je.name,pack_quantity:je.pack_quantity,loose_quantity:je.loose_quantity,price:Je,pack_price:je.pack_price,loose_price:je.loose_price,total_price:Number(je.total_price)||0,isLoose:je.isLoose,unit:je.unit,drug_id:je.drug_id?String(je.drug_id):null,tabletsPerDay:je.tabletsPerDay,numberOfDays:je.numberOfDays,directions_to_use:je.directions_to_use,discount_percentage:je.discount_percentage??0,batch:je.batch,expiry_date:je.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:le}),a(`/dashboard/pharmacy-billing/${ae}`,{state:{initialItems:le}})}else console.error(`Order with ID ${ae} not found.`),J(`Order with ID ${ae} not found.`),alert(`Error: Could not find order ${ae} to bill.`)},yo=async(ae,me)=>{J(null);const le=Ye.find(Je=>Je.id===ae);if(!le){J(`Order with ID ${ae} not found.`);return}const je={status:me,medications:le.medications};try{const Je=await pe(`/api/pharmacy-orders/${ae}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(je)});if(!Je.ok){const bt=await Je.text();throw new Error(`Failed to update status: ${Je.statusText} (${Je.status}) - ${bt}`)}const lt=await Je.json();$e(bt=>bt.map(xt=>xt.id===lt.id?{...xt,status:lt.status}:xt)),u&&_s(u)}catch(Je){console.error("Failed to update order status:",Je),J(Je.message||`Failed to update status for order ${ae}.`),alert(`Error updating status for order ${ae}: ${Je.message||"Please try again."}`)}},Zh=ae=>{Xi(me=>me.map(le=>le.id===ae?{...le,isEditing:!0,editedTests:[...le.tests],editedStatus:le.status}:{...le,isEditing:!1}))},uc=ae=>{Xi(me=>me.map(le=>le.id===ae?{...le,isEditing:!1,editedTests:void 0,editedStatus:void 0}:le))},ef=(ae,me,le,je)=>{Xi(Je=>Je.map(lt=>{if(lt.id===ae){const bt=lt.editedTests?[...lt.editedTests]:[...lt.tests];if(le==="add")return{...lt,editedTests:[...bt,{id:"",name:"",price:0}]};if(le==="remove")return{...lt,editedTests:je};if(me!==-1){const xt={...bt[me],[le]:je};return bt[me]=xt,{...lt,editedTests:bt}}}return lt}))},tf=(ae,me)=>{Xi(le=>le.map(je=>je.id===ae?{...je,editedStatus:me}:je))},Nu=async ae=>{if(!ae){console.error("Cannot navigate to billing: Lab Order data is missing."),alert("Could not open billing page: Lab Order information is missing.");return}a(`/dashboard/lab-billing/${ae.id}`)},Wa=async(ae,me)=>{console.log(`Updating lab order ${ae} to status ${me}`);try{const le=await pe(`/api/lab/${ae}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:me})});if(!le.ok){const je=await le.json();throw new Error(je.message||`Failed to update lab order status: ${le.status}`)}u&&(Na(u),pr(u)),console.log(`Lab Order ${ae} status updated to ${me}, refetching data.`)}catch(le){console.error("Error updating lab order status:",le),alert(`Failed to update lab order status: ${le instanceof Error?le.message:"Unknown error"}`)}},Cu=ae=>{ae&&ae.id?a(`/lab/report/${ae.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the report entry page: Lab Order information is missing."))},nf=async(ae,me,le)=>{gu(!0),J(null);try{if(!me||me.length===0)throw new Error("Lab order must have at least one test.");for(const lt of me)if(!lt.id||!lt.name||isNaN(lt.price)||lt.price<0)throw new Error(`Invalid test data: ${JSON.stringify(lt)}. Each test must have id, name, and a valid price.`);const je={tests:me,status:le},Je=await pe(`/api/lab/orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(je)});if(!Je.ok){const lt=await Je.json().catch(()=>({}));throw new Error(lt.message||`Failed to update lab order: ${Je.statusText}`)}u&&Na(u),Xi(lt=>lt.map(bt=>bt.id===ae?{...bt,isEditing:!1,editedTests:void 0,editedStatus:void 0}:bt))}catch(je){J(`Lab Order Save Error: ${je.message}`)}finally{gu(!1)}},Es=async ae=>{if(!window.confirm(`Are you sure you want to delete this ${ae.type.toLowerCase()} record? This action cannot be undone.`))return;al(!0),bs(null);let le=null,je;const Je=ae.type;try{switch(Je){case"Complaint":if(je=ae.data.id,!je)throw new Error("Complaint ID is missing.");le=`/api/patients/complaints/${je}`;break;case"Lab Order":if(je=ae.data.id,!je)throw new Error("Lab Order ID is missing.");le=`/api/lab/orders/${je}`;break;case"Lab Report":if(je=ae.data.reportId,!je)throw new Error("Lab Report ID is missing.");le=`/api/lab/reports/${je}`;break;case"Pharmacy Order":if(je=ae.data.id,!je)throw new Error("Pharmacy Order ID is missing.");le=`/api/pharmacy-orders/${je}`;break;default:throw new Error(`Deletion not supported for item type: ${Je}`)}if(!le)throw new Error(`Could not determine delete URL for type: ${Je}`);const lt=await pe(le,{method:"DELETE"});if(!lt.ok){const bt=await lt.json().catch(()=>({}));throw new Error(bt.message||`Failed to delete ${Je}: ${lt.statusText}`)}u&&(Je==="Complaint"?lc(u):Je==="Lab Order"?(Na(u),pr(u)):Je==="Lab Report"?pr(u):Je==="Pharmacy Order"&&_s(u))}catch(lt){bs(`Delete Error (${Je}): ${lt.message}`),ao&&al(!1)}finally{al(!1)}},rf=async()=>{if(!u)return;if(Ye.filter(me=>me.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Jd(!0);try{const me=await pe(`/api/pharmacy-orders/patient/${u}/merge-pending`,{method:"POST"});if(!me.ok){const le=await me.json().catch(()=>({}));throw new Error(le.message||"Failed to merge orders")}_s(u)}catch(me){J(`Merge Error: ${me.message}`)}finally{Jd(!1)}},$i=w.useMemo(()=>{if(!u||!_e)return[];const ae=_e.map(me=>({date:new Date(me.createdAt),type:"Complaint",data:me,originalDateString:me.createdAt})).filter(me=>!isNaN(me.date.getTime()));return ae.sort((me,le)=>le.date.getTime()-me.date.getTime()),ae},[u,_e]),Or=w.useMemo(()=>{if(!u)return[];const ae=new Map;(rl??[]).forEach(le=>{ae.set(le.id,{...le})}),(ut??[]).forEach(le=>{if(!ae.has(le.id))ae.set(le.id,{id:le.id,patient_id:le.patient_id,tests:le.tests,status:le.status,createdAt:le.createdAt,report:le});else{const je=ae.get(le.id);je&&(je.report=le,je.status=le.status)}});let me=Array.from(ae.values());return me.sort((le,je)=>new Date(le.createdAt).getTime()-new Date(je.createdAt).getTime()),me=me.map((le,je)=>({...le,serialNumber:je+1})),me.map(le=>({date:new Date(le.createdAt),type:"Lab Order",data:le,originalDateString:le.createdAt}))},[u,rl,ut]),Ca=w.useMemo(()=>{if(!u||!Ye)return[];const ae=Ye.map(me=>({date:new Date(me.date),type:"Pharmacy Order",data:me,originalDateString:me.date})).filter(me=>!isNaN(me.date.getTime()));return ae.sort((me,le)=>le.date.getTime()-me.date.getTime()),ae},[u,Ye]),[af,Gi]=w.useState(null),[Lr,nr]=w.useState([]),[hl,ju]=w.useState(""),_u=(ae,me)=>{if(!ae||!ae.report_content||!me)return"";try{const le=JSON.parse(ae.report_content||"{}");if(typeof le!="object"||le===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${ae.report_content}</pre>`;let je="";return me.forEach(Je=>{le[Je.id]?(je+=`<h5 class="font-semibold text-sm mt-2 mb-1">${Je.name}</h5>`,je+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(le[Je.id]).map(([lt,bt])=>{var yr;const xt=(yr=Je.default_parameters)==null?void 0:yr.find(Ds=>Ds.name===lt);let mi="N/A";xt&&xt.type==="number"&&(xt.lower_limit!=null||xt.upper_limit!=null)?(mi="",xt.lower_limit!=null&&(mi+=` > ${xt.lower_limit}`),xt.lower_limit!=null&&xt.upper_limit!=null&&(mi+=" - "),xt.upper_limit!=null&&(mi+=` < ${xt.upper_limit}`),mi=mi.trim()||"N/A"):(xt==null?void 0:xt.type)==="boolean"?mi="N/A":xt!=null&&xt.normal_range&&(mi=xt.normal_range),je+=`<tr><td>${lt}</td><td>${String(bt)} ${(xt==null?void 0:xt.unit)||""}</td><td>${mi}</td></tr>`}),je+="</tbody></table>"):je+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${Je.name}.</p>`}),je}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${ae.report_content}</pre>`}};w.useEffect(()=>{const ae=()=>{ft(window.innerHeight)};return window.addEventListener("resize",ae),ae(),()=>window.removeEventListener("resize",ae)},[]),w.useEffect(()=>{const ae=le=>{if(!ps||!el.current||!ms.current)return;const je=ms.current.getBoundingClientRect(),lt=le.clientX-el.current.x;let bt=el.current.initialWidth-lt;const xt=je.width-Gd-10;bt=Math.max(Gd,bt),bt=Math.min(bt,xt);const mi=bt/je.width*100;rn(mi)},me=()=>{ql(!1),el.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return ps&&(window.addEventListener("mousemove",ae),window.addEventListener("mouseup",me),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",ae),window.removeEventListener("mouseup",me),document.body.style.cursor="",document.body.style.userSelect=""}},[ps]);const ku=ae=>{if(!ms.current)return;ae.preventDefault();const me=ms.current.querySelector(".edit-complaint-context-column");me&&(el.current={x:ae.clientX,initialWidth:me.offsetWidth},ql(!0))},sf=w.useCallback(async()=>{H(!0),J(null);try{const ae=await pe("/api/queue/doctor/new",{method:"POST"});if(!ae.ok){const le=await ae.json().catch(()=>({}));throw new Error(le.message||`Failed to create record: ${ae.statusText}`)}const me=await ae.json();if(!me.recordId)throw new Error("New record ID not received from server.");a(`/edit-complaint/${me.recordId}`,{replace:!0})}catch(ae){J(`Failed to create new complaint record: ${ae.message}`)}finally{H(!1)}},[a]);w.useEffect(()=>{(async()=>{Kd(!0);try{const me=await pe("/api/clinics/settings");if(!me.ok){const je=await me.json().catch(()=>({}));throw new Error(je.message||"Failed to fetch clinic settings.")}const le=await me.json();hr({admissionCharge:parseFloat(le.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(le.perDayCharge||0).toFixed(2),otherCharges:parseFloat(le.otherCharges||0).toFixed(2),aiMemory:le.aiMemory||"",aiMemoryUpdatedAt:le.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:le.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:le.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:le.gemini_api_key||""}),dl(le.aiMemory||""),tr(le.clinicWideSystemPrompt||"")}catch{}finally{Kd(!1)}})()},[]),w.useEffect(()=>{var me;(me=o.state)!=null&&me.initialComplaint&&d(o.state.initialComplaint);const ae=async le=>{te(!0),J(null);try{const je=await pe(`/api/queue/doctor/complaint/${le}`);if(!je.ok){const lt=await je.json().catch(()=>({}));throw new Error(lt.message||`HTTP error! status: ${je.status}`)}const Je=await je.json();p(Je.patientId),S(Je.age),T(Je.gender),M(Je.case_summary||null),Y(Je.updatedAt||null)}catch{J("Failed to load current complaint details."),p(null),S(void 0),T(void 0),M(null),Y(null)}finally{te(!1)}};if(t)ae(t);else if(n){const le=n;le&&(p(le),(async()=>{try{const Je=await pe(`/api/queue/patient/${le}/latest`);if(Je.ok){const bt=await Je.json();if(bt!=null&&bt._id){i(bt._id),ae(bt._id);return}}const lt=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:le,complaint:"Visit Initiated"})});if(lt.ok){const bt=await lt.json();if(bt!=null&&bt.id){i(bt.id),ae(bt.id);return}}}catch(Je){console.error("Background queue resolution failed",Je),J("Failed to initialize visit record.")}})())}else sf()},[t,sf,(gr=o.state)==null?void 0:gr.initialComplaint,n]),w.useEffect(()=>{u?Xh(u):(b(null),X([]),$e([]),Xi([]),rt([]),Y(null),ba(!1))},[u]),w.useEffect(()=>{var le;const ae=(le=o.state)==null?void 0:le.initialComplaint;ae&&t&&(!ie&&!de&&!xs&&!Nt&&!ya)&&!ve.current&&l===ae&&(ve.current=!0,St(),a(o.pathname,{replace:!0,state:{}}))},[(Ps=o.state)==null?void 0:Ps.initialComplaint,t,l,ie,de,xs,Nt,ya,a]);const xo=()=>{F(P||""),U(!0),R(null)},Qa=()=>{U(!1),F(""),R(null)},ke=async()=>{if(!t){R("Missing Record ID.");return}$(!0),R(null);try{const ae=await pe(`/api/queue/doctor/complaint/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:L.trim()})});if(!ae.ok){const le=await ae.json().catch(()=>({}));throw new Error(le.message||`Failed to save case summary: ${ae.statusText}`)}const me=await ae.json();M(me.case_summary||L.trim()),Y(me.updatedAt||null),U(!1)}catch(ae){R(`Save Error: ${ae.message}`)}finally{$(!1)}};w.useEffect(()=>{(async()=>{gs(!0),hi(null);try{const[me,le]=await Promise.all([pe("/api/drugs"),pe("/api/lab-tests")]);if(!me.ok)throw new Error(`Pharmacy inventory error! status: ${me.status}`);const je=await me.json();if(tl(je||[]),!le.ok)throw new Error(`Lab inventory error! status: ${le.status}`);const Je=await le.json();no(Je||[])}catch(me){hi(me.message)}finally{gs(!1)}})()},[]);const He=async()=>{if(!Nn)return;if(Cs===Nn.aiMemory&&jn===Nn.clinicWideSystemPrompt){ac(!1);return}const ae=Cs!==Nn.aiMemory,me=jn!==Nn.clinicWideSystemPrompt;ae&&Xd(!0),me&&fl(!0);try{const le={...Nn};ae&&(le.aiMemory=Cs),me&&(le.clinicWideSystemPrompt=jn);const je=await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(le)});if(!je.ok){const lt=await je.json().catch(()=>({}));throw new Error(lt.message||"Failed to update clinic settings.")}const Je=await je.json();hr({admissionCharge:parseFloat(Je.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(Je.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(Je.settings.otherCharges).toFixed(2),aiMemory:Je.settings.aiMemory||"",aiMemoryUpdatedAt:Je.settings.aiMemoryUpdatedAt||(Nn==null?void 0:Nn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:Je.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:Je.settings.clinicWideSystemPromptUpdatedAt||(Nn==null?void 0:Nn.clinicWideSystemPromptUpdatedAt)||null}),ae&&dl(Je.settings.aiMemory||""),me&&(tr(Je.settings.clinicWideSystemPrompt||""),ac(!1))}catch{}finally{ae&&Xd(!1),me&&fl(!1)}},ze=()=>{Nn&&(tr(Nn.clinicWideSystemPrompt||""),ac(!0))},ht=()=>{ac(!1),Nn&&tr(Nn.clinicWideSystemPrompt||"")},St=async ae=>{const me=ae??l;Kr.current&&await Kr.current.callGenerativeApi(me)},on=ae=>{navigator.clipboard.writeText(ae).then(()=>{}).catch(me=>{console.error("Failed to copy text: ",me)})},Wn=(ae,me)=>{const le=window.open("","_blank");le&&(le.document.write(`
        <html>
          <head>
            <title>${me}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${me}</h2>
            <div id="print-content">${ae}</div>
          </body>
        </html>
      `),le.document.close(),le.print())},ln=()=>{if(fe){const ae=lX().use(Wo).use(vee).processSync(oe).toString();Wn(`<div class="prose">${ae}</div>`,"AI Response")}};w.useEffect(()=>{if(g){let ae=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${g.name||"N/A"}</p>
          <p><strong>Token:</strong> ${g.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${g.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${g.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${g.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${g.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${g.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${g.admission_date?new Date(g.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${g.discharge_date?new Date(g.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${P||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${$i.length>0?`
            <ul>
              ${$i.map(me=>`<li>${new Date(me.originalDateString).toLocaleDateString()}: ${me.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${Ca.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${Ca.map(me=>me.data.medications.map((le,je)=>`
                    <tr>
                      ${je===0?`<td rowspan="${me.data.medications.length}">${new Date(me.originalDateString).toLocaleDateString()}</td>`:""}
                      ${je===0?`<td rowspan="${me.data.medications.length}">${me.data.status}</td>`:""}
                      <td><strong>${le.name}</strong></td>
                      <td>
                        ${le.pack_quantity!==void 0&&le.pack_quantity>0?`Packs: ${le.pack_quantity}`:""}
                        ${le.pack_quantity!==void 0&&le.pack_quantity>0&&le.loose_quantity!==void 0&&le.loose_quantity>0?", ":""}
                        ${le.loose_quantity!==void 0&&le.loose_quantity>0?`Loose: ${le.loose_quantity}`:""}
                      </td>
                      <td>${le.tabletsPerDay&&le.numberOfDays?`${le.tabletsPerDay} tab/day for ${le.numberOfDays} days`:"N/A"}</td>
                      <td>${le.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${Or.length>0?`
            ${Or.map(me=>{const le=me.data.tests.map(Je=>Je.name).join(", ");let je="";return me.data.report&&(je=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(me.data.report.report_date).toLocaleDateString()})</h4>
                    ${_u(me.data.report,me.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(me.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${me.data.status}</p>
                  <p><strong>Tests:</strong> ${le}</p>
                  ${je}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;ju(ae)}else ju("")},[g,P,$i,Ca,Or,_u]);const dc=()=>{hl&&Wn(hl,`Patient Details - ${g==null?void 0:g.name}`)},of=ae=>{d(ae),Gi(null),nr([]),setTimeout(()=>{St(ae)},0)},Qn=ie||ce||Se||Nt||de||ya||xs||W||Yd||Vl||Hl||du||Kh||lo||er||Ya||js||Vi||ao||Kl||uo||Ba||sl||z,fc=Qn,ep=()=>{d("reports came,please anaylse"),setTimeout(()=>{St()},0)},As=ae=>{Wl(me=>({...me,[ae]:!me[ae]}))},pl=ae=>{ae.key==="Enter"&&!ae.shiftKey&&(ae.preventDefault(),!Qn&&l.trim()&&t&&St())};w.useEffect(()=>{const ae=window.SpeechRecognition||window.webkitSpeechRecognition;if(!ae){ic("Speech recognition not supported in this browser.");return}const me=new ae;return me.continuous=!0,me.interimResults=!0,me.lang="en-US",me.onresult=le=>{let je="";for(let Je=le.resultIndex;Je<le.results.length;++Je)le.results[Je].isFinal&&(je+=le.results[Je][0].transcript);je&&d(Je=>Je+(Je.endsWith(" ")||Je===""?"":" ")+je)},me.onerror=le=>{ic(`Speech error: ${le.error}`),fr(!1)},me.onend=()=>{},Ns.current=me,()=>{Ns.current&&Ns.current.stop()}},[]);const ml=async()=>{if(u)if(dr){Xl(!0);try{const ae=await pe(`/api/patients/${u}/discharge`,{method:"POST"});if(!ae.ok){const me=await ae.json().catch(()=>({}));throw new Error(me.message||`Failed to discharge patient: ${ae.status}`)}Sa(u)}catch(ae){J(`Discharge Error: ${ae.message}`)}finally{Xl(!1)}}else{co(!0);try{const ae=await pe(`/api/patients/${u}/admit`,{method:"POST"});if(!ae.ok){const me=await ae.json().catch(()=>({}));throw new Error(me.message||`Failed to admit patient: ${ae.status}`)}Sa(u)}catch(ae){J(`Admit Error: ${ae.message}`)}finally{co(!1)}}},gn=async ae=>{if(u){ws(!0);try{const le=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:u})});if(!le.ok){const je=await le.json().catch(()=>({}));throw new Error(je.message||`Failed to add patient to ${ae} queue: ${le.status}`)}alert(`Patient added to ${ae} queue successfully!`),u&&(Sa(u),cc(u))}catch(me){J(`Add to Queue Error: ${me.message}`)}finally{ws(!1)}}},Fr=async()=>{if(t){Zl(!0),J(null);try{const ae=await pe(`/api/queue/${t}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!ae.ok){const me=await ae.json().catch(()=>({}));throw new Error(me.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),u&&(Sa(u),cc(u))}catch(ae){J(`Error completing consultation: ${ae.message}`)}finally{Zl(!1)}}},Tu=async()=>{if(!u){wa("Missing Patient ID.");return}if(!g){wa("Patient details not loaded.");return}yu(!0),wa(null);try{const ae={};let me=!1;if(ho!==g.name&&(ae.name=ho,me=!0),vn!==g.age&&(ae.age=vn,me=!0),tc!==g.gender&&(ae.gender=tc,me=!0),va!==g.phone&&(ae.phone=va,me=!0),!me){wa("No changes detected."),yu(!1),qa(!1);return}const le=await pe(`/api/patients/${u}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!le.ok){const Je=await le.json().catch(()=>({}));throw new Error(Je.message||`Failed to update patient details: ${le.statusText}`)}const je=await le.json();b(je),S(je.age),T(je.gender),ec(je.name),mn(je.age),Ei(je.gender),po(je.phone),qa(!1)}catch(ae){wa(`Save Error: ${ae.message}`)}finally{yu(!1)}},zi=w.useCallback(()=>{if(!g)return null;const ae={token_number:g.patient_token_number||"N/A",name:g.name||"N/A",age:g.age||"N/A",gender:g.gender||"N/A",phone:g.phone||"N/A"};return $i.length>0?ae.complaints_history=$i.map(me=>`${me.data.complaint} (${new Date(me.originalDateString).toLocaleDateString()})`).join("; "):ae.complaints_history="No past complaints.",Ca.length>0?ae.pharmacy_orders_history=Ca.map(me=>`Order: ${me.data.medications.map(je=>{let Je=`${je.name}`;return je.pack_quantity!==void 0&&je.pack_quantity>0&&(Je+=` Packs: ${je.pack_quantity}`),je.loose_quantity!==void 0&&je.loose_quantity>0&&(Je+=` Loose: ${je.loose_quantity}`),Je}).join(", ")} (${me.data.status}, ${new Date(me.originalDateString).toLocaleDateString()})`).join("; "):ae.pharmacy_orders_history="No pharmacy orders.",Or.length>0?ae.lab_orders_history=Or.map(me=>{let je=`Lab Order: ${me.data.tests.map(Je=>Je.name).join(", ")} (${me.data.status}, ${new Date(me.originalDateString).toLocaleDateString()})`;return me.data.report&&(je+=` - Report: ${me.data.report.report_content} (${new Date(me.data.report.report_date).toLocaleDateString()})`),je}).join("; "):ae.lab_orders_history="No lab history.",ae},[g,$i,Ca,Or]),mr=()=>{if(!g){ic("Patient details are required to use the Live API.");return}vu(!0)},bo=()=>{var ae;(ae=ul.current)==null||ae.click()},Eu=ae=>{var le;const me=(le=ae.target.files)==null?void 0:le[0];me&&bu(me)},Ja=ae=>{Jr(ae),ae==="context"&&bi.current?bi.current.scrollIntoView({behavior:"smooth",block:"start"}):ae==="response"&&Ln.current&&Ln.current.scrollIntoView({behavior:"smooth",block:"start"})};return w.useEffect(()=>{const ae=new IntersectionObserver(me=>{me.forEach(le=>{le.isIntersecting&&(le.target===Ln.current?Jr("response"):le.target===bi.current&&Jr("context"))})},{root:null,threshold:.5});return Ln.current&&ae.observe(Ln.current),bi.current&&ae.observe(bi.current),()=>{Ln.current&&ae.unobserve(Ln.current),bi.current&&ae.unobserve(bi.current)}},[]),r.jsxs("div",{className:"edit-complaint-page",style:{height:`${nt}px`},children:[r.jsx(kW,{ref:Kr,recordId:t,patientId:u,patientDetails:g,caseSummary:P,caseSummaryUpdatedAt:V,clinicSettings:Nn,userMessages:f,selectedImageFile:rc,pendingLabOrders:rl,labReports:ut,pastComplaints:_e,pharmacyOrders:Ye,pharmacyInventory:uu,labInventory:nl,currentComplaint:l,setCurrentComplaint:d,setAiResponse:A,setAiResponseText:ue,setAiResponseJsonString:se,setShowAiJsonDetails:ee,setIsLoadingAi:re,setAiError:Qe,setIsSubmittingAiOrder:Wd,setAiOrderSubmissionStatus:io,setIsSubmittingAiLabOrder:Qd,setAiLabOrderSubmissionStatus:Jh,setIsSubmittingAiComplaint:Gl,setAiComplaintSubmissionStatus:Yl,setIsUpdatingCaseSummary:ro,setAiCaseSummaryUpdateStatus:fu,setCaseSummary:M,setCaseSummaryUpdatedAt:Y,setIsUpdatingAiMemoryByAI:hu,setAiMemoryUpdateByAIStatus:pu,setFollowUpQuestion:Gi,setFollowUpOptions:nr,setError:J,setIsSavingAiResponse:Ne,setSaveAiResponseError:Me,fetchPharmacyOrdersData:_s,fetchPendingLabOrdersData:Na,fetchLabReportsData:pr,fetchPastComplaintsData:lc,fetchPatientDetails:Sa,setClinicSettings:hr,setEditedAiMemory:dl,handleDeleteItem:Es,setCanUndo:sc,onAiActionSuccess:bn}),qi&&g&&r.jsx(GT,{onClose:()=>vu(!1),patientData:zi(),tokenNumber:g.patient_token_number?String(g.patient_token_number):null,onAiSummaryChange:ae=>{ae&&(d(ae),St(ae),vu(!1))}}),r.jsxs("div",{className:"edit-complaint-header",children:[r.jsx("button",{onClick:()=>a(-1),disabled:Qn,className:"back-button",title:"Go Back",children:"< Back"}),r.jsx("span",{ref:Be,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),g&&r.jsx("div",{className:"edit-complaint-patient-details",children:g&&!fo?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{qa(!0),ec(g.name||""),mn(g.age),Ei(g.gender),po(g.phone),wa(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:er,children:r.jsx(Ml,{size:14})}),g.name??"N/A",g.patient_token_number!==null&&g.patient_token_number!==void 0&&` (${g.patient_token_number})`," - ",g.age??"N/A"," / ",g.gender??"N/A",g.phone&&` / ${g.phone}`]}):g&&fo?r.jsxs("div",{className:"patient-details-edit-form",children:[r.jsx("input",{type:"text",value:ho,onChange:ae=>ec(ae.target.value),placeholder:"Name",className:"edit-input",disabled:er}),r.jsx("input",{type:"number",value:vn??"",onChange:ae=>mn(ae.target.value?parseInt(ae.target.value):null),placeholder:"Age",className:"edit-input",disabled:er}),r.jsxs("select",{value:tc??"",onChange:ae=>Ei(ae.target.value||null),className:"edit-input",disabled:er,children:[r.jsx("option",{value:"",children:"Select Gender"}),r.jsx("option",{value:"M",children:"Male"}),r.jsx("option",{value:"F",children:"Female"}),r.jsx("option",{value:"O",children:"Other"})]}),r.jsx("input",{type:"text",value:va??"",onChange:ae=>po(ae.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:er}),r.jsxs("div",{className:"edit-actions",children:[r.jsx("button",{onClick:()=>{qa(!1),wa(null)},className:"button-secondary",disabled:er,children:"Cancel"}),r.jsx("button",{onClick:Tu,className:"button-primary blue",disabled:er,children:er?"Saving...":"Save"})]}),cl&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:cl})]}):r.jsxs("div",{className:"edit-complaint-patient-details",children:[v??"N/A"," / ",k??"N/A"]})}),!g&&v!==void 0&&k!==void 0&&r.jsxs("div",{className:"edit-complaint-patient-details",children:[v??"N/A"," / ",k??"N/A"]}),r.jsx("div",{style:{width:"64px"}})]}),r.jsxs("div",{className:"edit-complaint-content-area",ref:ms,children:[r.jsxs("div",{ref:Ln,className:"edit-complaint-main-column",style:{flexBasis:`calc(${100-Ti}% - 5px)`},children:[Q&&r.jsxs("div",{className:"general-error-message",children:["Error: ",Q]}),Pe&&r.jsx("div",{className:"ai-error-message",children:Pe}),Mr&&r.jsx("div",{className:`ai-function-status ${Mr.toLowerCase().includes("error:")?"error":Mr.toLowerCase().startsWith("order created")||Mr.toLowerCase().startsWith("success:")?"success":"info"}`,children:Mr}),xa&&r.jsx("div",{className:`ai-function-status ${xa.toLowerCase().includes("error:")?"error":xa.toLowerCase().startsWith("success:")||xa.toLowerCase().startsWith("lab order created")?"success":"info"}`,children:xa}),ur&&r.jsx("div",{className:`ai-function-status ${ur.toLowerCase().includes("error:")?"error":"info"}`,children:ur}),il&&r.jsx("div",{className:`ai-function-status ${il.toLowerCase().includes("error:")?"error":"info"}`,children:il}),Fi&&r.jsx("div",{className:`ai-function-status ${Fi.toLowerCase().includes("error:")?"error":"info"}`,children:Fi}),De&&r.jsxs("div",{className:"general-error-message",children:["Error saving AI response: ",De]}),(oe||D)&&r.jsxs("div",{ref:Fe,className:`${D?"ai-function-call-block":"ai-response-container"} group`,children:[oe&&r.jsx(Ol,{remarkPlugins:[Wo],children:oe}),D&&r.jsxs("div",{className:"ai-json-details-container",children:[r.jsxs("button",{onClick:()=>ee(!be),className:"ai-json-toggle-button",children:[be?r.jsx(RS,{size:14,className:"mr-1"}):r.jsx(IS,{size:14,className:"mr-1"}),be?"Hide":"Show"," AI Function Call Details"]}),be&&r.jsx("pre",{className:"ai-json-pre",children:r.jsx("code",{children:JSON.stringify(JSON.parse(D),null,2)})})]}),r.jsxs("div",{className:"ai-response-actions",children:[r.jsx("button",{onClick:()=>on(fe),disabled:!fe,title:"Copy Full AI Response",children:r.jsx(II,{size:12})}),r.jsx("button",{onClick:ln,disabled:!fe,title:"Print AI Response",children:r.jsx(Kc,{size:12})})]})]})]}),r.jsx("div",{className:"draggable-divider",onMouseDown:ku}),r.jsx("div",{ref:bi,className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-Ti}% - 5px)`},children:r.jsxs("div",{className:"ai-context-container",children:[r.jsxs("h3",{className:"ai-context-header",children:[r.jsx("span",{children:"AI Context:"}),r.jsx("div",{className:"ai-context-actions-top",children:r.jsxs("button",{onClick:dc,disabled:!hl,title:"Print All Patient Details",className:"context-action-button",children:[r.jsx(Kc,{size:14})," Print"]})}),(g==null?void 0:g.insurance_type)&&r.jsx("div",{className:"insurance-type-container mt-2",children:r.jsxs("select",{ref:xe,value:g.insurance_type,onChange:ae=>oc(g.id,ae.target.value),className:"insurance-type-select",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"insurance",children:"Insurance"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),r.jsxs("div",{ref:Ue,className:"ai-context-section",children:[r.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),(g==null?void 0:g.admission_date)&&r.jsxs("p",{className:"ai-context-text",children:[r.jsx("strong",{children:"Admitted:"})," ",new Date(g.admission_date).toLocaleDateString()]}),(g==null?void 0:g.discharge_date)&&r.jsxs("p",{className:"ai-context-text",children:[r.jsx("strong",{children:"Discharged:"})," ",new Date(g.discharge_date).toLocaleDateString()]}),(g==null?void 0:g.current_status)&&r.jsxs("p",{className:"ai-context-text",children:[r.jsx("strong",{children:"Current Status:"})," ",r.jsx("span",{className:"font-semibold",children:g.current_status})]}),r.jsxs("div",{className:"flex space-x-2 mt-2",children:[r.jsx("button",{onClick:ml,className:`admit-discharge-button ${dr?"discharge":"admit"}`,title:dr?"Discharge Patient":"Admit Patient",disabled:!u||Kl||uo,children:Kl?"Admitting...":uo?"Discharging...":dr?"Discharge":"Admit"}),r.jsx("button",{onClick:()=>gn("doctor"),className:`queue-status-button ${ol?"in-queue":"add-to-queue"}`,title:ol?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!u||Ba||ol,children:Ba?"Adding...":ol?"In Queue":"Add to Queue"}),r.jsx("button",{onClick:Fr,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:sl,children:sl?"Completing...":"Complete Consultation"})]})]}),r.jsx("div",{ref:tt,children:r.jsx(P0,{title:"Pharmacy Order History",headerAction:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:rf,className:"button-primary blue text-xs px-2 py-1",disabled:Vi||Ye.filter(ae=>ae.status==="pending").length<2,title:"Merge all pending orders into one",children:Vi?"Merging...":"Merge Orders"}),r.jsxs("button",{onClick:()=>Jl(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!u,children:[r.jsx(Zc,{size:12,className:"mr-1"})," Create Order"]})]}),items:Ca,isLoading:!1,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(ae,me)=>r.jsxs("div",{className:"flex flex-col w-full",children:[r.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",Ca.length-me,". Order Status: (",ae.data.status,")",r.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:Va===ae.data.id?r.jsx("div",{className:"flex items-center space-x-1 ml-1",children:r.jsx("input",{type:"datetime-local",defaultValue:G0(ae.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:le=>{le.target.value&&Hi(ae.data.id,le.target.value),ll(null)},onKeyDown:le=>{if(le.key==="Enter"){const je=le.target;je.value&&Hi(ae.data.id,je.value),ll(null)}},autoFocus:!0})}):r.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:()=>ll(ae.data.id),title:"Click to edit date",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")",r.jsx(Ml,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),r.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",r.jsx("button",{onClick:()=>Ts(ae.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:r.jsx(Ml,{size:12})}),ae.data.prescriptionForUnavailableDrugs&&r.jsx("button",{onClick:()=>Wn(ae.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:r.jsx(Kc,{size:12})}),r.jsx("button",{onClick:()=>Es({type:"Pharmacy Order",data:ae.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:r.jsx(lr,{size:12})}),ae.data.status==="pending"&&r.jsx("button",{onClick:()=>go(ae.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:lo,children:r.jsx(Dh,{size:12})}),ae.data.status==="billed"&&r.jsx("button",{onClick:()=>yo(ae.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:lo,children:r.jsx(fs,{size:12})})]})]}),r.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2 cursor-pointer hover:bg-gray-50 transition-colors rounded p-1",onClick:()=>Ts(ae.data.id),title:"Click to edit order",children:r.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),r.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),r.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),r.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),r.jsx("tbody",{children:ae.data.medications.map((le,je)=>r.jsxs("tr",{children:[r.jsx("td",{className:"py-1 px-2",children:r.jsx("strong",{children:le.name})}),r.jsxs("td",{className:"py-1 px-2",children:[le.pack_quantity!==void 0&&le.pack_quantity>0&&`Packs: ${le.pack_quantity}`,le.pack_quantity!==void 0&&le.pack_quantity>0&&le.loose_quantity!==void 0&&le.loose_quantity>0&&", ",le.loose_quantity!==void 0&&le.loose_quantity>0&&`Loose: ${le.loose_quantity}`]}),r.jsx("td",{className:"py-1 px-2",children:le.tabletsPerDay&&le.numberOfDays?`${le.tabletsPerDay} tab/day for ${le.numberOfDays} days`:"N/A"}),r.jsx("td",{className:"py-1 px-2",children:le.directions_to_use||"N/A"})]},le.drug_id||le.name||je))})]})}),ae.data.prescriptionForUnavailableDrugs&&r.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[r.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",ae.data.prescriptionForUnavailableDrugs]})]})})}),Ql&&r.jsx(wee,{isOpen:Ql,onClose:()=>Jl(!1),patientId:u,pharmacyInventory:uu,fetchPharmacyOrdersData:_s}),r.jsxs("div",{ref:dt,children:[r.jsx(P0,{title:"Lab History (Orders & Reports)",headerAction:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:ep,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:fc,children:"Analyse Reports"}),r.jsxs("button",{onClick:()=>vs(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!u,children:[r.jsx(Zc,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:Or,onDeleteItem:Es,onEditLabOrder:Zh,onSaveLabOrder:nf,onCancelEditLabOrder:uc,onLabOrderTestChange:ef,onLabOrderStatusChange:tf,onBillLabOrder:Nu,onUpdateLabOrderStatus:Wa,onEnterLabReport:Cu,labInventory:nl,isSavingLabOrder:lo,isLoading:xs||Nt,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:oo,toggleLabReport:As,renderItemContent:(ae,me)=>{const le=YY(ae.data.report?ae.data.report.status:ae.data.status);return r.jsxs("div",{className:"ai-context-text",children:[r.jsxs("div",{onClick:()=>Cu(ae.data),className:"cursor-pointer hover:bg-gray-100 rounded p-1 inline-block -ml-1",title:"Click to enter report",children:[ae.data.serialNumber,". ",r.jsx("span",{className:"font-medium",children:"[Order]"})," ",ae.data.tests&&ae.data.tests.length>0?ae.data.tests.map(je=>r.jsxs("strong",{children:[je.name," (",je.price,")"]},je.id||je.name)).reduce((je,Je)=>[je,", ",Je]):r.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",ae.data.tests&&ae.data.tests.length>0&&r.jsxs("span",{className:"font-bold ml-2",children:["Total: ",ae.data.tests.reduce((je,Je)=>je+(Number(Je.price)||0),0).toFixed(2)]}),"(",r.jsx("span",{className:le.className,children:le.text}),")"]}),r.jsx("span",{className:"text-gray-400 ml-1 inline-flex items-center",children:ri===ae.data.id?r.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:je=>je.stopPropagation(),children:r.jsx("input",{type:"datetime-local",defaultValue:G0(ae.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:je=>{je.target.value&&ks(ae.data.id,"order",je.target.value),Ha(null)},onKeyDown:je=>{if(je.key==="Enter"){const Je=je.target;Je.value&&ks(ae.data.id,"order",Je.value),Ha(null)}},autoFocus:!0})}):r.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:je=>{je.stopPropagation(),Ha(ae.data.id)},title:"Click to edit order date",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")",r.jsx(Ml,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),ae.data.report&&r.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium",children:"[Report]"}),r.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:Ga===ae.data.id?r.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:je=>je.stopPropagation(),children:r.jsx("input",{type:"datetime-local",defaultValue:G0(ae.data.report.report_date),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:je=>{je.target.value&&ks(ae.data.id,"report",je.target.value),nc(null)},onKeyDown:je=>{if(je.key==="Enter"){const Je=je.target;Je.value&&ks(ae.data.id,"report",Je.value),nc(null)}},autoFocus:!0})}):r.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/reportDate ml-1",onClick:je=>{je.stopPropagation(),nc(ae.data.id)},title:"Click to edit report date",children:["(",new Date(ae.data.report.report_date).toLocaleDateString(),")",r.jsx(Ml,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),r.jsx("button",{onClick:()=>As(ae.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:oo[ae.data.report.reportId]?"Collapse Report":"Expand Report",children:oo[ae.data.report.reportId]?r.jsx(RS,{size:14}):r.jsx(IS,{size:14})})]}),oo[ae.data.report.reportId]&&(()=>{try{const je=JSON.parse(ae.data.report.report_content||"{}");return typeof je=="object"&&je!==null&&ae.data.report.tests?ae.data.report.tests.map(Je=>r.jsxs("div",{style:{marginBottom:"10px"},children:[r.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:Je.name}),je[Je.id]?r.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-1 px-2",children:"Parameter"}),r.jsx("th",{className:"py-1 px-2",children:"Value"}),r.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),r.jsx("tbody",{children:Object.entries(je[Je.id]).map(([lt,bt])=>{var mi;const xt=(mi=Je.default_parameters)==null?void 0:mi.find(yr=>yr.name===lt);return r.jsxs("tr",{children:[r.jsx("td",{className:"py-1 px-2",children:lt}),r.jsxs("td",{className:"py-1 px-2",children:[String(bt)," ",(xt==null?void 0:xt.unit)||""]}),r.jsx("td",{className:"py-1 px-2",children:(()=>{if(xt&&xt.type==="number"&&(xt.lower_limit!=null||xt.upper_limit!=null)){let yr="";return xt.lower_limit!=null&&(yr+=` > ${xt.lower_limit}`),xt.lower_limit!=null&&xt.upper_limit!=null&&(yr+=" - "),xt.upper_limit!=null&&(yr+=` < ${xt.upper_limit}`),yr.trim()||"N/A"}else if((xt==null?void 0:xt.type)==="boolean")return"N/A";return(xt==null?void 0:xt.normal_range)||"N/A"})()})]},lt)})})]}):r.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},Je.id)):r.jsx(Ol,{remarkPlugins:[Wo],children:ae.data.report.report_content})}catch{return r.jsx(Ol,{remarkPlugins:[Wo],children:ae.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),r.jsx(vW,{isOpen:Ua,onClose:()=>vs(!1),patientId:u,labInventory:nl,fetchPendingLabOrdersData:Na}),r.jsx("div",{ref:qt,children:r.jsx(P0,{title:"Complaints History",items:$i,isLoading:de,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(ae,me)=>r.jsxs("span",{className:"ai-context-text",children:[ae.data.complaint,r.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:Es})}),r.jsxs("div",{className:"ai-context-section",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("h4",{className:"ai-context-section-title",children:[r.jsx(Sb,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!Su&&r.jsx("button",{onClick:ze,className:"edit-button",title:"Edit System Prompt",disabled:wu||Ya||js,children:r.jsx(Ml,{size:14})})]}),Su&&Nn?r.jsxs("div",{className:"mt-2",children:[r.jsx("textarea",{value:jn,onChange:ae=>tr(ae.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:Ya||js}),r.jsxs("div",{className:"context-edit-actions",children:[r.jsx("button",{onClick:ht,disabled:Ya||js,className:"button-secondary",children:"Cancel"}),r.jsxs("button",{onClick:He,disabled:Ya||js||Cs===Nn.aiMemory&&jn===Nn.clinicWideSystemPrompt,className:"button-primary purple",children:[r.jsx(Fd,{size:14,className:"mr-1"}),js||Ya?"Saving...":"Save Settings"]})]})]}):r.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:Nn!=null&&Nn.clinicWideSystemPrompt?r.jsx(Ol,{remarkPlugins:[Wo],children:Nn.clinicWideSystemPrompt}):r.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!Su&&(Nn==null?void 0:Nn.clinicWideSystemPromptUpdatedAt)&&r.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(Nn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),r.jsxs("div",{ref:On,className:"ai-context-section",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!I&&r.jsx("button",{onClick:xo,className:"edit-button",title:"Edit Case Summary",disabled:ie||z,children:r.jsx(Ml,{size:14})})]}),I?r.jsxs("div",{className:"mt-2",children:[r.jsx("textarea",{value:L,onChange:ae=>F(ae.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:z}),B&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:B}),r.jsxs("div",{className:"context-edit-actions",children:[r.jsx("button",{onClick:Qa,disabled:z,className:"button-secondary",children:"Cancel"}),r.jsx("button",{onClick:ke,disabled:z||L===P,className:"button-primary blue",children:z?"Saving...":"Save"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:P?r.jsx(Ol,{remarkPlugins:[Wo],components:{},children:P}):r.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),V&&r.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(V).toLocaleDateString()]})]})]}),$i.length===0&&Or.length===0&&Ca.length===0&&!(de||xs||Nt)&&r.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),ao&&r.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),so&&r.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:so})]})]})})]}),r.jsxs("div",{className:"edit-complaint-input-area",children:[r.jsxs("div",{className:"status-messages-container",children:[ye&&r.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:ye}),et&&r.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:et}),mu&&r.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:mu}),ys&&r.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:ys})]}),t&&!W&&r.jsxs(w.Fragment,{children:[af&&r.jsxs("div",{className:"follow-up-question-container",children:[r.jsx("p",{className:"question-text",children:af}),Lr.length>0&&r.jsx("div",{className:"options-grid",children:Lr.map((ae,me)=>r.jsx("button",{onClick:()=>of(ae),className:"option-button",children:ae},me))})]}),xu&&r.jsx("div",{className:"speech-error-display",children:xu}),rc&&r.jsxs("div",{className:"selected-file-display",children:[r.jsxs("span",{children:["Selected: ",rc.name]}),r.jsx("button",{onClick:()=>{bu(null),ul.current&&(ul.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),r.jsx("div",{className:"input-wrapper",children:r.jsxs("div",{className:"main-input-container",children:[r.jsx("input",{type:"file",ref:ul,onChange:Eu,accept:"image/*",className:"hidden"}),r.jsx("textarea",{ref:ot,className:"complaint-textarea",value:l,onChange:ae=>d(ae.target.value),onKeyDown:pl,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:Qn||!t||Ss}),r.jsxs("div",{className:"chat-input-actions-container",children:[u&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>a(`/patient/${u}/lab-reports`),disabled:Nt||!u,className:"icon-button",title:"View Lab Reports",children:r.jsx(Xc,{size:14})}),r.jsx("button",{onClick:()=>a("/inventory"),disabled:ya,className:"icon-button",title:"View Inventory",children:r.jsx(Ld,{size:14})})]}),r.jsx("button",{type:"button",onClick:bo,disabled:Qn||!t||Ss,className:"icon-button",title:"Attach Image",children:r.jsx(fR,{size:14})}),r.jsx("button",{type:"button",onClick:mr,disabled:Qn||!t||!Ns.current,className:`mic-button ${Ss?"listening":""}`,title:Ss?"Stop":"Mic",children:r.jsx(ak,{size:14})}),r.jsx("button",{onClick:()=>St(),disabled:Qn||!l.trim()||!t||Ss,className:"send-button",title:Qn?"Processing...":"Save & Ask AI",children:Qn?r.jsx("span",{className:"animate-spin",role:"status","aria-label":"loading"}):r.jsx(J0,{size:14})}),mo&&r.jsx("button",{type:"button",onClick:Zd,disabled:Qn,className:"icon-button text-red-500",title:"Undo Last AI Actions",children:r.jsx(lr,{size:14})})]})]})})]})]}),r.jsx("div",{className:"mobile-section-selector",children:r.jsxs("div",{className:"selector-container",children:[r.jsx("button",{onClick:()=>Ja("response"),className:`selector-button ${Li==="response"?"active":""}`,children:"AI Response"}),r.jsx("button",{onClick:()=>Ja("context"),className:`selector-button ${Li==="context"?"active":""}`,children:"AI Context"})]})})]})},See=()=>{const{patientId:e}=Qr(),n=kt(),[t,i]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(!1),[f,u]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){u("Patient ID not provided.");return}d(!0),u(null);try{const b=await pe(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();o({name:v.name,age:v.age,gender:v.gender});const S=await pe(`/api/patients/${e}/complaints`);if(S.ok){const T=(await S.json()).sort((P,M)=>new Date(M.createdAt).getTime()-new Date(P.createdAt).getTime());i(T)}else if(S.status===404)i([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),u(`Failed to load data. ${b.message}`),i([]),o(null)}finally{d(!1)}})()},[e]);const p=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return r.jsxs("div",{className:"container mx-auto p-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),r.jsx("div",{className:"w-16"})," "]}),a&&r.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",r.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),f&&r.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",f]}),l&&r.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!f&&r.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&r.jsx("div",{className:"space-y-4",children:t.map(g=>r.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[r.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),r.jsx("button",{onClick:()=>p(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Px=500,T_="defaultConsultationFee",Nee=({patientId:e,billId:n,queueId:t,onBillCreated:i,onBillUpdated:a,initialItems:o=[],billType:l="other",relatedId:d,initialStatus:f="pending",initialDiscountPercentage:u=0,readOnlyMode:p=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[T,P]=w.useState([]),M=w.useRef([]),[I,U]=w.useState(""),[L,F]=w.useState(""),[z,$]=w.useState(1),[B,R]=w.useState(u),[V,Y]=w.useState("cash"),[ie,te]=w.useState(!1),[W,H]=w.useState(null),[Q,J]=w.useState(!1),[fe,A]=w.useState(!1),[oe,ue]=w.useState(!1),[D,se]=w.useState(null),[,be]=w.useState([]),[ee,ce]=w.useState(null),[re,Pe]=w.useState(""),[Qe,Se]=w.useState("cash"),[Ne,De]=w.useState(!1),[Me,nt]=w.useState(Px),[ft,ut]=w.useState(Px.toString()),rt=n?"view_pay":"create";w.useEffect(()=>{const xe=localStorage.getItem(T_),Be=xe?parseFloat(xe):Px;isNaN(Be)||(nt(Be),ut(Be.toString()))},[]);const Nt=o.length===0;w.useEffect(()=>{e?(async()=>{te(!0),H(null);try{const Be=await pe(`/api/patients/${e}`);if(!Be.ok){const tt=await Be.json().catch(()=>({}));throw new Error(tt.message||"Failed to fetch patient details")}const Ue=await Be.json();k(Ue)}catch(Be){H(`Failed to load patient details: ${Be.message}`),k(null)}finally{te(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{ue(!0),H(null),se(null),be([]),ce(null);try{const Be=await pe(`/api/bills/${n}`);if(!Be.ok){const tt=await Be.json().catch(()=>({}));throw new Error(tt.message||"Failed to fetch bill details")}const Ue=await Be.json();if(!Ue.bill||!Ue.payments||!Ue.calculated)throw new Error("Invalid bill details structure.");se(Ue.bill),be(Ue.payments),ce(Ue.calculated),R(Ue.bill.discount_percentage!==void 0&&Ue.bill.discount_percentage!==null?parseFloat(Ue.bill.discount_percentage.toString()):0),!S&&Ue.bill.patient_id&&Ft(Ue.bill.patient_id.toString())}catch(Be){H(`Failed to load bill details: ${Be.message}`),se(null),be([]),ce(null)}finally{ue(!1)}})():(se(null),be([]),ce(null))},[n]);const Ft=async xe=>{te(!0);try{const Be=await pe(`/api/patients/${xe}`);if(!Be.ok)throw new Error("Failed to fetch patient");const Ue=await Be.json();k(Ue)}catch(Be){console.error("Error fetching patient details:",Be),k(null)}finally{te(!1)}},ye=w.useCallback(async xe=>{A(!0),H(null);const Be=xe.filter(Ue=>Ue.drug_id!=null).map(async Ue=>{try{const tt=await pe(`/api/drugs/${Ue.drug_id}`);if(!tt.ok)throw new Error(`Drug ${Ue.drug_id} not found.`);const dt=await tt.json();return{...Ue,price:dt.price,total:dt.price*Ue.quantity}}catch{return H(dt=>`${dt?dt+"; ":""}Failed to fetch price for ${Ue.name}`),Ue}});try{const Ue=await Promise.all(Be);P(tt=>{const dt=new Map(Ue.map(qt=>[qt.id,qt]));return tt.map(qt=>dt.get(qt.id)||qt)})}catch{}finally{A(!1)}},[pe]);w.useEffect(()=>{if(n){P([]),M.current=[];return}JSON.stringify(o)===JSON.stringify(M.current)||(async()=>{let Ue=[];if(o&&o.length>0)Ue=o.map((tt,dt)=>({...tt,id:`initial-${dt}-${Date.now()}`})),Y(f==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),R(u),l==="pharmacy"&&!p&&await ye(Ue);else if(e&&Nt&&l==="consultation"){let tt=Me;if(g)try{const dt=await pe(`/api/staff/${g}`);if(!dt.ok){const On=await dt.json().catch(()=>({}));throw new Error(On.message||"Doctor not found or error fetching fee")}const qt=await dt.json();qt.opd_fee!=null&&!isNaN(parseFloat(String(qt.opd_fee)))&&parseFloat(String(qt.opd_fee))>=0&&(tt=parseFloat(String(qt.opd_fee)))}catch(dt){H(qt=>`${qt?qt+"; ":""}Could not fetch doctor's fee, using default. (${dt.message})`)}Ue=[{id:Date.now(),name:"Consultation Fee",price:tt,quantity:1,total:tt*1,drug_id:null}],Y(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else Ue=[],Y(v==="no_cash_insurance"?"no_cash_insurance":"cash");P(Ue),M.current=o})()},[n,e,g,o,l,Me,Nt,f,p,ye,u,v]);const Te=()=>{const xe=parseFloat(L);if(!p)if(I&&!isNaN(xe)&&xe>=0&&z>0){if(I.trim().toLowerCase()==="consultation fee"&&T.some(Ue=>Ue.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Be={id:Date.now(),name:I.trim(),price:xe,quantity:z,total:xe*z,drug_id:null};P([...T,Be]),U(""),F(""),$(1)}else alert("Invalid item details.")},Ye=xe=>{p||P(T.filter(Be=>Be.id!==xe))},$e=w.useMemo(()=>{let xe=T.reduce((Be,Ue)=>Be+Ue.total,0);return rt==="create"&&B>0&&(xe=xe*(1-B/100)),(ee==null?void 0:ee.totalDue)!==void 0&&(ee==null?void 0:ee.totalDue)!==null?ee.totalDue:xe},[T,ee,B,rt]),_e=w.useMemo(()=>(ee==null?void 0:ee.totalPaid)??0,[ee]),X=w.useMemo(()=>(ee==null?void 0:ee.balance)!==void 0&&(ee==null?void 0:ee.balance)!==null?ee.balance:$e-_e,[ee,$e,_e]),de=()=>{const xe=parseFloat(ft);!isNaN(xe)&&xe>=0?(nt(xe),localStorage.setItem(T_,xe.toString()),alert(`Default Fee set to ${xe.toFixed(2)}`)):alert("Invalid fee amount.")},qe=async(xe,Be)=>{J(!0),H(null);try{const Ue=await pe("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Be,billId:xe})}),tt=await Ue.json();if(!Ue.ok||!tt.order)throw new Error(tt.message||"Failed to create Razorpay order.");const{key_id:dt,order:qt}=tt,On={key:dt,amount:qt.amount,currency:qt.currency,name:"Newtons OPD Zero Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:qt.id,handler:async function(Tt){try{const Rt=await pe("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:Tt.razorpay_payment_id,razorpay_order_id:Tt.razorpay_order_id,razorpay_signature:Tt.razorpay_signature,billId:xe})}),si=await Rt.json();if(Rt.ok&&si.success)alert("Payment Successful!"),i&&i(xe),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(si.message||"Payment verification failed.")}catch(Rt){H(`Payment verification failed: ${Rt.message}. Contact support.`)}finally{J(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:xe,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){H("Payment cancelled."),J(!1)}}};if(window.Razorpay)new window.Razorpay(On).open();else throw new Error("Razorpay SDK not loaded.")}catch(Ue){H(`Failed to initiate online payment: ${Ue.message}`),J(!1)}},et=async()=>{if(!n){H("Bill ID is missing.");return}if(!re||isNaN(parseFloat(re))||parseFloat(re)<=0){H("Please enter a valid positive payment amount.");return}De(!0),H(null);const xe={amount_paid:parseFloat(re),payment_mode:Qe};try{const Be=await pe(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)}),Ue=await Be.json();if(!Be.ok)throw new Error(Ue.message||`Failed to record payment (Status: ${Be.status})`);alert(`Payment of ${xe.amount_paid.toFixed(2)} recorded.`),Pe(""),a?a():console.log("Payment recorded.")}catch(Be){H(`Failed to record payment: ${Be.message}`)}finally{De(!1)}},ct=async()=>{if(rt==="view_pay")return;if(!e){H("Patient ID is missing for creating a bill.");return}if(T.length===0){H("Cannot finalize an empty bill.");return}J(!0),H(null);const xe=$e,Be=T.map(({id:Ue,...tt})=>tt);if(V==="online"){const Ue={patientId:e,queueId:t||null,items:Be,amount:xe,paymentMode:"online",type:l,related_id:d||b||null,status:"pending",discountPercentage:B,labOrderId:b||null};try{const tt=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ue)}),dt=await tt.json();if(!tt.ok)throw new Error(dt.message||"Failed to create pending bill.");qe(dt.id,Math.round(xe*100))}catch(tt){H(`Failed to create pending bill: ${tt.message}`),J(!1)}}else{const Ue="paid";if(!V){H("Payment mode required."),J(!1);return}const tt={patientId:e,queueId:t||null,items:Be,amount:xe,paymentMode:V,type:l,related_id:d||b||null,status:Ue,discountPercentage:B,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const dt=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(tt)}),qt=await dt.json();if(!dt.ok)throw new Error(qt.message||"Failed to create bill.");alert("Bill marked as paid!"),i&&i(qt.id),J(!1)}catch(dt){H(`Failed to process bill: ${dt.message}`),J(!1)}}},Fe=(D==null?void 0:D.type)??l,ot=(D==null?void 0:D.status)??f,ve=rt==="view_pay"&&D&&ot==="pending";return!e&&!n?r.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):ie||rt==="view_pay"&&oe?r.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):rt==="view_pay"&&!D&&!oe&&W?r.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",W]}):rt==="create"&&!S&&!ie&&W?r.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",W]}):r.jsxs("div",{className:"billing-component-container printable-section",children:[r.jsxs("div",{className:"billing-header",children:[r.jsx("h2",{children:rt==="create"?"Create Bill":"Bill Details"}),rt==="create"&&l==="consultation"&&!p&&r.jsxs("div",{className:"default-fee-section",children:[r.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),r.jsx("input",{id:"defaultFee",type:"number",value:ft,onChange:xe=>ut(xe.target.value),className:"",placeholder:Px.toString(),disabled:p}),r.jsx("button",{onClick:de,title:"Set Default Fee",className:"",disabled:p,children:r.jsx(Fd,{size:16})})]})]}),W&&!oe&&!Ne&&r.jsxs("div",{className:"error-message",role:"alert",children:[r.jsx("strong",{children:"Error: "}),W]}),S&&r.jsxs("div",{className:"patient-details-section",children:[r.jsx("h3",{children:"Patient Details"}),r.jsxs("p",{children:[r.jsx("strong",{children:"ID:"})," ",S.id]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Name:"})," ",S.name]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",r.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),r.jsxs("div",{className:"bill-items-summary-section",children:[r.jsxs("div",{className:"bill-items-header",children:[r.jsx("h3",{children:rt==="create"?"Bill Items":"Billing Summary"}),rt==="create"&&l==="pharmacy"&&!p&&T.some(xe=>xe.drug_id!=null)&&r.jsxs("button",{onClick:()=>ye(T),disabled:fe,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[r.jsx(Jx,{size:14,className:`lucide ${fe?"animate-spin":""}`}),fe?"Refreshing...":"Refresh"]})]}),rt==="view_pay"&&D&&r.jsxs("div",{className:"bill-info-bar",children:[r.jsxs("span",{children:["Bill ID: ",r.jsx("strong",{children:D.id})]}),r.jsxs("span",{children:["Type: ",r.jsx("strong",{className:"capitalize",children:Fe})]}),r.jsxs("span",{children:["Status: ",r.jsx("strong",{className:`capitalize ${ot==="paid"?"status-paid":"status-pending"}`,children:ot})]})]}),(rt==="create"||rt==="view_pay"&&D)&&r.jsxs("div",{className:"bill-items-list",children:[rt==="create"&&fe&&T.length>0&&r.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),rt==="create"&&!fe&&T.map((xe,Be)=>r.jsxs("div",{className:"bill-item",children:[r.jsxs("div",{className:"bill-item-details",children:[r.jsxs("span",{children:[Be+1,". ",xe.name]}),xe.quantity>1&&r.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",xe.quantity,")"]})]}),r.jsxs("div",{className:"bill-item-price-actions",children:[r.jsxs("span",{className:"bill-item-price",children:["",xe.total.toFixed(2)]}),rt==="create"&&typeof xe.id=="number"&&!p&&r.jsxs("button",{onClick:()=>Ye(xe.id),className:"remove-item-button",title:"Remove",children:[" ",r.jsx(ni,{size:16})," "]}),(typeof xe.id!="number"||p||xe.name==="Consultation Fee")&&r.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",r.jsx(LS,{size:14})," "]})]})]},xe.id)),rt==="view_pay"&&D&&D.items.map((xe,Be)=>r.jsxs("div",{className:"bill-item",children:[r.jsxs("div",{className:"bill-item-details",children:[r.jsxs("span",{children:[Be+1,". ",xe.name]}),xe.quantity>1&&r.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",xe.quantity,")"]})]}),r.jsxs("div",{className:"bill-item-price-actions",children:[r.jsxs("span",{className:"bill-item-price",children:["",(xe.total??xe.price*xe.quantity).toFixed(2)]}),r.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",r.jsx(LS,{size:14})," "]})]})]},Be)),rt==="create"&&T.length===0&&r.jsx("p",{className:"empty-items-message",children:"No items added."}),rt==="view_pay"&&D&&D.items.length===0&&r.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),rt==="create"&&!p&&r.jsxs("div",{className:"add-item-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Item"}),r.jsx("input",{type:"text",value:I,onChange:xe=>U(xe.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),r.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[r.jsx("label",{children:"Qty"}),r.jsx("input",{type:"number",min:"1",value:z,onChange:xe=>$(parseInt(xe.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),r.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[r.jsx("label",{children:"Price ()"}),r.jsx("input",{type:"number",value:L,onChange:xe=>F(xe.target.value),placeholder:"0.00",className:"custom-text-input"})]}),r.jsx("button",{onClick:Te,className:"add-item-button",children:"Add"})]})]})," ",r.jsxs("div",{className:"billing-footer",children:[r.jsxs("div",{className:"total-amount-section",children:[r.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),r.jsxs("span",{className:"total-amount-value",children:["",typeof $e=="number"?$e.toFixed(2):"0.00"]}),rt==="create"&&!p&&r.jsxs("div",{className:"discount-section",children:[r.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),r.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:B,onChange:xe=>R(parseFloat(xe.target.value)||0),className:"",disabled:p||Q})]}),rt==="view_pay"&&D&&(D.status==="pending"||D.status==="paid")&&r.jsxs("div",{className:"discount-section",children:[r.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),r.jsxs("span",{className:"discount-value",children:[B.toFixed(2),"%"]})]})]}),rt==="view_pay"&&ee&&r.jsxs("div",{className:"total-amount-section",children:[r.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),r.jsxs("span",{className:"total-amount-value",children:["",_e.toFixed(2)]})]}),rt==="view_pay"&&ee&&r.jsxs("div",{className:"total-amount-section",children:[r.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),r.jsxs("span",{className:"total-amount-value",children:["",X.toFixed(2)]})]}),r.jsxs("div",{className:"footer-actions",children:[rt==="create"&&!p&&r.jsxs("div",{className:"action-group",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Payment Mode"}),r.jsxs("select",{value:V,onChange:xe=>Y(xe.target.value),className:"custom-select-input",disabled:p||Q,children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),r.jsx("option",{value:"credit",children:"Credit"})]})]}),r.jsx("button",{onClick:ct,disabled:Q||T.length===0||p,className:"finalize-button",children:Q?"Processing...":"Finalize Bill"})]}),rt==="view_pay"&&ve&&!p&&r.jsxs("div",{className:"action-group",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Record Payment Amount ()"}),r.jsx("input",{type:"number",value:re,onChange:xe=>Pe(xe.target.value),placeholder:`Max: ${X.toFixed(2)}`,className:"custom-text-input",disabled:Ne})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Payment Mode"}),r.jsxs("select",{value:Qe,onChange:xe=>Se(xe.target.value),className:"custom-select-input",disabled:Ne,children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),r.jsx("button",{onClick:et,disabled:Ne||!re||parseFloat(re)<=0||parseFloat(re)>X,className:"record-payment-button",children:Ne?"Recording...":"Record Payment"})]}),rt==="create"&&p&&T.length>0&&r.jsx("div",{className:"status-message read-only",children:"Read-only."}),rt==="view_pay"&&ot==="paid"&&r.jsx("div",{className:"status-message paid",children:"PAID."}),rt==="view_pay"&&ot==="cancelled"&&r.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},Cee=()=>{const e=kt(),n=cr(),{patientId:t,queueId:i,patientName:a,initialItems:o,billType:l,relatedId:d,initialStatus:f,initialDiscountPercentage:u,doctorId:p,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,T]=w.useState(null),[P,M]=w.useState(null),[I,U]=w.useState(null),[L,F]=w.useState(null),[z,$]=w.useState(null),[B,R]=w.useState(null),[V,Y]=w.useState(null),[ie,te]=w.useState(!0),[W,H]=w.useState(null),[Q,J]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{te(!0),H(null);try{let se=t,be=o||null,ee=f||null,ce=l||null,re=d||null,Pe=u!==void 0?parseFloat(u):null,Qe=a||null,Se=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Ne=await pe(`/api/bills/${g}`);if(!Ne.ok){const Me=await Ne.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(Me.message||`Failed to fetch bill details (Status: ${Ne.status})`)}const De=await Ne.json();if(console.log("Fetched Bill Data:",De),be=De.bill.items||[],ee=De.bill.status||"pending",ce=De.bill.type||null,re=De.bill.related_id||null,Pe=De.bill.discount_percentage!==void 0&&De.bill.discount_percentage!==null?parseFloat(De.bill.discount_percentage):0,se=De.bill.patient_id,U(be),F(ee),$(ce),R(re),Y(Pe),se){const Me=await pe(`/api/patients/${se}`);if(Me.ok){const nt=await Me.json();Qe=nt.name,Se=nt.phone??null,M(nt.insurance_type??null),J(Qe),T(Se)}else console.warn(`Could not fetch patient details for ID ${se} from bill.`),J("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),J("Patient (Unknown)")}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Ne=await pe(`/api/lab/${b}`);if(!Ne.ok){let Me=`Failed to fetch lab order details (Status: ${Ne.status} ${Ne.statusText})`;try{Me=(await Ne.json()).message||Me}catch{console.error("Response was not valid JSON:",await Ne.text())}throw new Error(Me)}const De=await Ne.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(De,null,2)),be=(De.tests||[]).filter(Me=>Me&&typeof Me.name=="string"&&Me.price!==void 0&&Me.id!==void 0).map(Me=>{const nt=parseFloat(Me.price||"0"),ft=!isNaN(nt)&&isFinite(nt)?nt:0;return{item_id:Me.id,name:Me.name,price:ft,quantity:1,total:ft*1,type:"lab_test"}}),be&&be.length===0&&(De.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",De.tests),H(Me=>`${Me?Me+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),ee="pending",ce="lab",re=b,se=De.patient_id,U(be),F(ee),$(ce),R(re),se){const Me=await pe(`/api/patients/${se}`);if(Me.ok){const nt=await Me.json();Qe=nt.name,Se=nt.phone??null,M(nt.insurance_type??null),J(Qe),T(Se)}else console.warn(`Could not fetch patient details for ID ${se} from lab order.`),J("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),J("Patient (Unknown)")}else if(U(o||null),F(f||null),$(l||null),R(d||null),Y(u!==void 0?parseFloat(u):null),J(a||`ID ${t}`),se){const Ne=await pe(`/api/patients/${se}`);if(Ne.ok){const De=await Ne.json();T(De.phone??null),M(De.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${se}.`)}if(i){const Ne=await pe(`/api/queue/${i}`);if(Ne.ok){const De=await Ne.json();S(De.token_number)}else console.warn(`Could not fetch queue details for ID ${i}.`)}}catch(se){console.error("Error fetching billing page details:",se),H(`Failed to load details: ${se.message}`),U(null),F(null),$(null),R(null),J(a||""),T(null),S(null)}finally{te(!1)}})()},[t,g,b,i,e]);const fe=D=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${D}`),e(-1)},A=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return r.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[r.jsx(FS,{size:48,className:"mb-4 text-red-500"}),r.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),r.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),r.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(ie)return r.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:r.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(W)return r.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[r.jsx(FS,{size:48,className:"mb-4"}),r.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),r.jsx("p",{className:"text-sm text-center mb-4",children:W}),r.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),r.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const ue=(L??f)==="paid";return r.jsxs("div",{className:"billing-page-container",children:[r.jsx("div",{className:"back-button-container",children:r.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[r.jsx(nn,{size:20,className:"lucide"})," Back"]})}),r.jsxs("div",{className:"billing-content-wrapper",children:[r.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",Q||`ID ${t}`]}),r.jsxs("div",{className:"patient-info-bar",children:[v!==null&&r.jsxs("span",{children:[r.jsx(Gm,{size:14,className:"lucide"})," Token: ",v]}),k&&r.jsxs("span",{children:[r.jsx(xR,{size:14,className:"lucide"})," Phone: ",k]}),b&&r.jsxs("span",{className:"lab-order-info",children:[r.jsx(Od,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&r.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),P&&r.jsxs("span",{className:"insurance-info",children:[r.jsx(IR,{size:14,className:"lucide"})," Insurance: ",P.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase())]}),!k&&v===null&&!b&&!P&&r.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),r.jsx(Nee,{patientId:t,labOrderId:b,queueId:i,onBillCreated:fe,onBillUpdated:A,initialItems:I??o,billType:z??l,relatedId:B??d,initialStatus:L??f,initialDiscountPercentage:V??u,readOnlyMode:ue,doctorId:p,patientInsuranceType:P??void 0})]})]})},jee=()=>{const{patientId:e}=Qr(),n=kt(),[t,i]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided in URL.");return}o(!0),d(null),i([]);try{try{const v=await pe(`/api/patients/${e}`);if(v.ok){const S=await v.json();u(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await pe(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),i(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),d(`Failed to load pharmacy orders: ${g.message}`)}finally{o(!1)}})()},[e]),r.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[r.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[r.jsx(nn,{size:16,className:"mr-1"}),"Back"]}),r.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[r.jsx(Ld,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",f&&`for ${f}`]}),r.jsx("div",{})," "]}),a&&r.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&r.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&r.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&r.jsx("div",{className:"space-y-4",children:t.map(p=>r.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Date:"})," ",new Date(p.date).toLocaleDateString()]}),r.jsxs("p",{className:"text-sm font-medium capitalize",children:[r.jsx("strong",{children:"Status:"})," ",p.status]})]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Prescribed By:"})," ",p.prescribedBy||"N/A"]}),p.dispensedBy&&r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Dispensed By:"})," ",p.dispensedBy]}),r.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),r.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:p.medications.map((g,b)=>r.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},p.id))})]})},_ee=()=>{const e=kt(),n=cr(),[t,i]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState([]),[f,u]=w.useState(""),[p,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState(null),[M,I]=w.useState(!0),[U,L]=w.useState(""),[F,z]=w.useState([]),[$,B]=w.useState(!1),[R,V]=w.useState(null),[Y,ie]=w.useState(!1),[te,W]=w.useState(!1),[H,Q]=w.useState([]),[J,fe]=w.useState(!1),[A,oe]=w.useState(null),ue=/^\+?[0-9\s\-().]{7,20}$/,D=/^[a-zA-Z\s'-]{2,}$/,se=w.useCallback(async()=>{try{const ye=await pe("/api/drugs");if(!ye.ok)throw new Error("Failed to fetch drugs");const Te=await ye.json();o(Te)}catch(ye){console.error("Failed to fetch available drugs:",ye),v("Could not load drug list. "+ye.message)}},[]),be=w.useCallback(async ye=>{fe(!0),oe(null);try{const Te=await pe(`/api/pharmacy-orders/patient/${ye}`);if(!Te.ok){const $e=await Te.json().catch(()=>({}));throw new Error($e.message||`HTTP error! status: ${Te.status}`)}const Ye=await Te.json();Q(Ye||[])}catch(Te){console.error("Failed to fetch previous pharmacy orders:",Te),oe(`Could not load previous orders: ${Te.message}`)}finally{fe(!1)}},[]);w.useEffect(()=>{var ye;se(),(ye=n.state)!=null&&ye.patient?re(n.state.patient):I(!0)},[se,n.state]),w.useEffect(()=>{t!=null&&t.id?be(t.id):Q([])},[t,be]),w.useEffect(()=>{if(!f){g([]);return}const ye=f.toLowerCase();g(a.filter(Te=>{const Ye=Te.name&&Te.name.toLowerCase().includes(ye),$e=Te.brand_name&&Te.brand_name.toLowerCase().includes(ye);return Ye||$e}).slice(0,10))},[f,a]);const ee=w.useMemo(()=>vb(async ye=>{if(ye.trim().length<2){z([]),B(!1),V(null);return}B(!0),V(null);try{const Te=new URLSearchParams({search:encodeURIComponent(ye),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Ye=await pe(`/api/patients?${Te.toString()}`);if(!Ye.ok){const _e=await Ye.text();throw new Error(`API Error (${Ye.status}): ${_e||Ye.statusText}`)}const $e=await Ye.json();z($e.patients)}catch(Te){console.error("Error searching patients:",Te),V(Te.message||"Failed to search patients."),z([])}finally{B(!1)}},300),[ue]),ce=ye=>{const Te=ye.target.value;L(Te),ie(ue.test(Te)),W(D.test(Te)&&!ue.test(Te)),B(!0),ee(Te)},re=w.useCallback(ye=>{i(ye),I(!1),L(""),z([]),V(null)},[]),Pe=w.useCallback(async ye=>{if(!U||ye==="phone"&&!Y||ye==="name"&&!te){V(`Invalid ${ye} to create a new patient.`);return}B(!0),V(null);try{const Ye=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ye==="name"?U:"direct pharmacy",phone:ye==="phone"?U:null,age:null,gender:null,token:null})});if(!Ye.ok){const _e=await Ye.json();throw new Error(_e.message||`Failed to create patient: ${Ye.statusText}`)}const $e=await Ye.json();alert(`New patient "${$e.name}" created with ${ye==="phone"?`phone ${$e.phone}`:`name ${$e.name}`}.`),re($e)}catch(Te){console.error("Error creating new patient:",Te),V(Te.message||"Failed to create new patient.")}finally{B(!1)}},[U,Y,te,re]),Qe=()=>{i(null),I(!0),d([]),v(null),Q([])},Se=ye=>{if(l.some(Te=>Te.drug_id===ye.id)){const Te=ye.name||ye.brand_name||"This drug";v(`${Te} is already in the order.`),setTimeout(()=>v(null),3e3),u(""),g([]);return}d(Te=>[...Te,{drug_id:ye.id,name:ye.name||ye.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,price:Number(ye.price)||0,originalPrice:Number(ye.price)||0,stock:ye.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(ye.price)||0)/(De(ye.unit)||1),unit:ye.unit}]),u(""),g([])},Ne=()=>{const ye=f.trim();if(!ye){v("Please enter a drug name to navigate to the add drug page."),setTimeout(()=>v(null),3e3);return}e("/dashboard/inventory/add",{state:{initialDrugName:ye}}),u(""),g([])},De=ye=>{if(!ye)return null;const Te=ye.match(/(?:\d+x)?(\d+)/);return Te?parseInt(Te[1],10):null},Me=ye=>{d(Te=>Te.filter(Ye=>(Ye.drug_id??Ye.name)!==ye))},nt=(ye,Te)=>{d(Ye=>Ye.map($e=>{if(($e.drug_id??$e.name)===ye&&$e.isLoose){const X=De($e.unit),de=Math.max(0,Te),qe=de*(X??1)+($e.looseUnits??0);return{...$e,loosePacks:de,looseQuantity:qe}}return $e}))},ft=(ye,Te)=>{d(Ye=>Ye.map($e=>{if(($e.drug_id??$e.name)===ye&&$e.isLoose){const X=De($e.unit),de=Math.max(0,Te),qe=($e.loosePacks??0)*(X??1)+de;return{...$e,looseUnits:de,looseQuantity:qe}}return $e}))},ut=ye=>{const Te=[];ye.medications.forEach(Ye=>{if(l.find(_e=>_e.drug_id&&Ye.drug_id&&_e.drug_id===Ye.drug_id||_e.name.toLowerCase()===Ye.name.toLowerCase()))d(_e=>_e.map(X=>{if(X.drug_id&&Ye.drug_id&&X.drug_id===Ye.drug_id||X.name.toLowerCase()===Ye.name.toLowerCase()){const de=(X.pack_quantity??0)+(Ye.pack_quantity??0),qe=(X.loose_quantity??0)+(Ye.loose_quantity??0),et=Ye.tabletsPerDay??X.tabletsPerDay,ct=Ye.numberOfDays??X.numberOfDays,Fe=De(X.unit),ot=de*(Fe??1)+qe;return{...X,pack_quantity:de,loose_quantity:qe,directions_to_use:Ye.directions_to_use??X.directions_to_use,tabletsPerDay:et,numberOfDays:ct,looseQuantity:ot,loosePacks:Math.floor(ot/(Fe??1)),looseUnits:ot%(Fe??1)}}return X}));else{let _e=Ye.drug_id,X=Ye.drug_id?a.find(de=>de.id===Ye.drug_id):void 0;if(!_e&&Ye.name){const de=a.find(qe=>qe.name&&qe.name.toLowerCase()===Ye.name.toLowerCase());de&&(_e=de.id,X=de)}Te.push({drug_id:_e,name:Ye.name,pack_quantity:Ye.pack_quantity??0,loose_quantity:Ye.loose_quantity??0,directions_to_use:Ye.directions_to_use,tabletsPerDay:Ye.tabletsPerDay??1,numberOfDays:Ye.numberOfDays??1,price:X?X.price:Ye.price,stock:X?X.quantity_in_stock:Ye.stock,isLoose:!0,loosePacks:0,looseUnits:(Ye.pack_quantity??0)*(De((X==null?void 0:X.unit)||Ye.unit)??1)+(Ye.loose_quantity??0),looseQuantity:(Ye.pack_quantity??0)*(De((X==null?void 0:X.unit)||Ye.unit)??1)+(Ye.loose_quantity??0),pricePerLooseUnit:(X?Number(X.price):Number(Ye.price)||0)/(De((X==null?void 0:X.unit)||Ye.unit)||1),unit:(X==null?void 0:X.unit)||Ye.unit})}}),d(Ye=>[...Ye,...Te]),ye.prescriptionForUnavailableDrugs&&(!T||!T.includes(ye.prescriptionForUnavailableDrugs))&&P(Ye=>Ye?`${Ye}

-- From Order ${ye.id.substring(0,8)} --
${ye.prescriptionForUnavailableDrugs}`:ye.prescriptionForUnavailableDrugs),v("Medications from previous order added to current order."),setTimeout(()=>v(null),3e3)},rt=async ye=>{if(ye.preventDefault(),v(null),k(!0),!t){v("No patient selected for the order."),k(!1);return}if(l.length===0&&!(T!=null&&T.trim())){v("Please add at least one medication or provide a prescription for unavailable drugs."),k(!1);return}const Te=l.filter($e=>{const _e=$e.looseQuantity??0;return _e<=0||$e.stock!==void 0&&_e>$e.stock});if(Te.length>0){v(`Invalid quantity or insufficient stock for: ${Te.map($e=>$e.name).join(", ")}`),k(!1);return}const Ye={patient_id:t.id,items:l.map($e=>{const _e=$e.price??0,X=$e.pricePerLooseUnit??0,de=X*($e.looseQuantity??0);return{drug_id:$e.drug_id===void 0?null:$e.drug_id,name:$e.name,pack_quantity:$e.loosePacks??0,loose_quantity:$e.looseUnits??0,pack_price:_e,loose_price:X,total_price:de,price:$e.originalPrice??0,directions_to_use:$e.directions_to_use===void 0?null:$e.directions_to_use,tabletsPerDay:$e.tabletsPerDay??1,numberOfDays:$e.numberOfDays??1}}),order_total:Nt,prescription_for_unavailable_drugs:T};try{const $e=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ye)});if(!$e.ok){const _e=await $e.json();throw new Error(_e.message||`Failed to create order: ${$e.statusText}`)}alert(`Pharmacy order created successfully for ${t.name}!`),e(-1)}catch($e){console.error("Failed to create pharmacy order:",$e),v($e.message||"Failed to create order. Please try again.")}finally{k(!1)}},Nt=w.useMemo(()=>l.reduce((ye,Te)=>{const Ye=Te.isLoose?Te.pricePerLooseUnit??0:Te.price??0,$e=Te.isLoose?Te.looseQuantity??0:Te.quantity??0;return ye+Ye*$e},0),[l]),Ft=(Number(Nt)||0).toFixed(2);return r.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-6 max-w-5xl mx-auto",children:[" ",r.jsxs("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:[" ",r.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:[r.jsx(nn,{size:20})," "]}),r.jsx("h2",{className:"text-2xl",children:"Create New Pharmacy Order"})," "]})]}),M&&r.jsxs("div",{className:"content-section",children:[" ",r.jsx("h3",{className:"section-title",children:"Select Patient"})," ",r.jsxs("div",{className:"mb-3 relative",children:[r.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"})," ",r.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:U,onChange:ce,className:"custom-text-input mt-1",autoFocus:!0}),$&&r.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),R&&r.jsx("div",{className:"ai-function-status error mb-3 p-3",children:R})," ",F.length>0&&r.jsxs("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:[" ",r.jsxs("ul",{children:[" ",F.map(ye=>r.jsxs("li",{onClick:()=>re({id:ye.id,name:ye.name,token:ye.token,age:ye.age,gender:ye.gender,phone:ye.phone}),children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[r.jsxs("div",{className:"font-medium",children:[r.jsxs("span",{className:"patient-token mr-2",children:["#",ye.token]}),ye.name]}),r.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[ye.age?`${ye.age} yrs`:"Age N/A",ye.gender?` / ${ye.gender}`:" / Gender N/A",ye.phone&&r.jsxs("span",{className:"hidden sm:inline",children:[" / ",ye.phone]})]})]}),ye.phone&&r.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",ye.phone]})]},ye.id))]})]}),U.length>=2&&!$&&F.length===0&&!R&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',U,'".']}),Y&&r.jsx("button",{type:"button",onClick:()=>Pe("phone"),className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:$,children:'Create "direct pharmacy" Patient with this Phone'}),te&&r.jsx("button",{type:"button",onClick:()=>Pe("name"),className:"create-patient-button mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ml-2",disabled:$,children:"Create Patient with this Name"})]}),U.length<2&&!$&&r.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]}),t&&!M&&r.jsxs("form",{onSubmit:rt,children:[r.jsxs("div",{className:"selected-patient-info content-section flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[" ",r.jsxs("div",{children:[r.jsxs("h3",{className:"section-title",children:[" ","Patient: ",r.jsx("span",{className:"font-normal",children:t.name})]}),r.jsxs("p",{className:"text-sm mt-1",children:["Token: ",r.jsx("span",{className:"font-medium",children:t.token??"N/A"}),t.age&&`    Age: ${t.age}`,t.gender&&`    Gender: ${t.gender}`,t.phone&&`    Phone: ${t.phone}`]}),r.jsxs("p",{className:"text-xs mt-1",title:`Patient UUID: ${t.id}`,children:["ID: ",t.id.substring(0,12),"..."]})]}),r.jsx("button",{type:"button",onClick:Qe,className:"change-patient-button mt-2 sm:mt-0 px-3 py-1.5 border rounded-md text-sm font-medium focus:outline-none focus:ring-2",children:"Change Patient"})]}),b&&r.jsx("div",{className:"ai-function-status error mb-4 p-3",children:b})," ",J&&r.jsx("div",{className:"content-section text-center py-4",children:r.jsx("p",{className:"text-gray-500",children:"Loading previous orders..."})}),A&&r.jsx("div",{className:"ai-function-status error mb-4 p-3",children:A}),!J&&H.length>0&&r.jsxs("div",{className:"content-section mt-4",children:[r.jsx("h3",{className:"section-title",children:"Previous Orders"}),r.jsx("div",{className:"space-y-4",children:H.map(ye=>r.jsxs("div",{className:"previous-order-card p-4 border rounded-lg shadow-sm bg-gray-50",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("p",{className:"font-semibold text-gray-800",children:["Order Date: ",new Date(ye.date).toLocaleDateString()]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ye.status==="dispensed"?"bg-green-100 text-green-800":ye.status==="pending"?"bg-yellow-100 text-yellow-800":ye.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:ye.status.charAt(0).toUpperCase()+ye.status.slice(1)})]}),r.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mb-3",children:ye.medications.map((Te,Ye)=>r.jsxs("li",{children:[r.jsx("strong",{children:Te.name}),": ",Te.quantity," Qty",Te.directions_to_use&&` - Directions: ${Te.directions_to_use}`]},Ye))}),ye.prescriptionForUnavailableDrugs&&r.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[r.jsx("span",{className:"font-semibold",children:"Prescription for Unavailable:"}),r.jsxs("div",{className:"prose prose-sm max-w-none",children:[" ",r.jsx(Ol,{remarkPlugins:[Wo],children:ye.prescriptionForUnavailableDrugs})]})]}),r.jsxs("button",{type:"button",onClick:()=>ut(ye),className:"add-previous-meds-button mt-3 px-3 py-1.5 text-sm font-medium rounded-md flex items-center justify-center",children:[r.jsx(Zc,{size:16,className:"mr-1"})," Add Medications to Current Order"]})]},ye.id))})]}),!J&&H.length===0&&t&&r.jsx("div",{className:"content-section text-center py-4 mt-4",children:r.jsx("p",{className:"text-gray-500",children:"No previous orders found for this patient."})}),r.jsxs("div",{className:"mb-4 content-section",children:[r.jsx("label",{htmlFor:"prescription-unavailable",className:"form-label",children:"Prescription for Unavailable Drugs (Optional)"}),r.jsx("textarea",{id:"prescription-unavailable",rows:3,value:T??"",onChange:ye=>P(ye.target.value||null),placeholder:"Enter prescription details for any drugs that are currently unavailable...",className:"custom-text-input mt-1 w-full"})]}),r.jsxs("div",{className:"mb-4 relative content-section",children:[" ",r.jsx("label",{htmlFor:"drug-search",className:"form-label",children:"Add Medication"})," ",r.jsx("input",{type:"text",id:"drug-search",placeholder:"Search for drug name or type to add custom...",value:f,onChange:ye=>u(ye.target.value),className:"custom-text-input mt-1"}),f&&r.jsxs("div",{className:"drug-search-dropdown mt-1 w-full max-h-60 rounded-md border shadow-lg overflow-auto focus:outline-none sm:text-sm z-20",children:[" ",p.length>0&&r.jsxs("ul",{children:[" ",p.map(ye=>r.jsxs("li",{onClick:()=>Se(ye),className:"cursor-pointer select-none relative",children:[r.jsx("span",{className:"font-medium block truncate",children:ye.name||ye.brand_name}),r.jsxs("span",{className:"drug-stock-price text-xs",children:[" ","(Stock: ",ye.quantity_in_stock??"N/A",", Price: ",Number(ye.price||0).toFixed(2),")"]})]},ye.id))]}),f.trim()&&!a.some(ye=>ye.name&&ye.name.toLowerCase()===f.trim().toLowerCase()||ye.brand_name&&ye.brand_name.toLowerCase()===f.trim().toLowerCase())&&r.jsxs("div",{onClick:Ne,className:"add-custom-drug-button cursor-pointer text-sm font-medium",role:"button",children:['Add "',f.trim(),'" as new item']}),f.trim()&&p.length===0&&a.some(ye=>ye.name&&ye.name.toLowerCase()===f.trim().toLowerCase()||ye.brand_name&&ye.brand_name.toLowerCase()===f.trim().toLowerCase())&&r.jsx("p",{className:"text-gray-400 py-2.5 px-4 text-sm",children:"Drug already selected or no new matches."})]})]}),r.jsxs("div",{className:"order-items-section content-section max-h-96 overflow-y-auto",children:[" ",r.jsx("h4",{className:"section-title",children:"Order Items"})," ",l.length===0&&r.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No medications added yet."}),l.length>0&&r.jsx("ul",{className:"space-y-4",children:l.map(ye=>{const Te=ye.drug_id??ye.name,Ye=!ye.drug_id;return r.jsxs("li",{className:"order-item-card text-sm",children:[" ",r.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3",children:[r.jsxs("div",{className:"flex-grow mb-2 md:mb-0",children:[r.jsxs("span",{className:`item-name block text-base ${Ye?"custom":""}`,children:[" ",ye.name,Ye?" (custom)":""]}),!Ye&&ye.pricePerLooseUnit!==void 0&&r.jsxs("span",{className:"item-details text-xs",children:[" ","@ ",(Number(ye.pricePerLooseUnit)||0).toFixed(2)," per loose unit"]}),ye.stock!==void 0&&r.jsxs("span",{className:`item-details text-xs ml-2 ${ye.stock<=10?"item-stock low":""}`,children:[" ","(Stock: ",ye.stock,")"]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2",children:[r.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[r.jsx("label",{htmlFor:`loose-packs-${Te}`,className:"dosage-label",children:"Packs:"}),r.jsxs("div",{className:"quantity-control",children:[r.jsx("button",{type:"button",onClick:()=>nt(Te,(ye.loosePacks??0)-1),className:"quantity-btn",children:"-"}),r.jsx("input",{type:"number",id:`loose-packs-${Te}`,min:"0",value:ye.loosePacks??0,onChange:$e=>{const _e=parseInt($e.target.value,10);nt(Te,isNaN(_e)?0:_e)},onFocus:$e=>$e.target.select(),className:"dosage-input text-sm text-right"}),r.jsx("button",{type:"button",onClick:()=>nt(Te,(ye.loosePacks??0)+1),className:"quantity-btn",children:"+"})]})]}),r.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[r.jsx("label",{htmlFor:`loose-units-${Te}`,className:"dosage-label",children:"Loose:"}),r.jsxs("div",{className:"quantity-control",children:[r.jsx("button",{type:"button",onClick:()=>ft(Te,(ye.looseUnits??0)-1),className:"quantity-btn",children:"-"}),r.jsx("input",{type:"number",id:`loose-units-${Te}`,min:"0",value:ye.looseUnits??0,onChange:$e=>{const _e=parseInt($e.target.value,10);ft(Te,isNaN(_e)?0:_e)},onFocus:$e=>$e.target.select(),className:"dosage-input text-sm text-right"}),r.jsx("button",{type:"button",onClick:()=>ft(Te,(ye.looseUnits??0)+1),className:"quantity-btn",children:"+"})]}),ye.unit&&r.jsxs("span",{className:"ml-2 text-sm text-gray-400",children:["(",ye.unit.split("x")[1]||ye.unit," per pack)"]})]})]}),r.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-3 mt-2 md:mt-0 md:flex-col md:items-end",children:[r.jsxs("div",{className:"w-28 text-right font-semibold",children:[" ","",(Number((ye.pricePerLooseUnit??0)*(ye.looseQuantity??0))||0).toFixed(2)]}),r.jsx("button",{type:"button",onClick:()=>Me(Te),className:"remove-item-button p-1.5 -m-1.5 rounded-full",title:"Remove Item",children:r.jsx(lr,{size:18})})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2 mt-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:`tablets-per-day-${Te}`,className:"dosage-label",children:"Per Day:"}),r.jsxs("div",{className:"quantity-control",children:[r.jsx("button",{type:"button",onClick:()=>d($e=>$e.map(_e=>_e.drug_id===Te?{..._e,tabletsPerDay:Math.max(1,(_e.tabletsPerDay??1)-1)}:_e)),className:"quantity-btn",children:"-"}),r.jsx("input",{type:"number",id:`tablets-per-day-${Te}`,min:"1",value:ye.tabletsPerDay??1,onChange:$e=>{const _e=parseInt($e.target.value,10);d(X=>X.map(de=>de.drug_id===Te?{...de,tabletsPerDay:isNaN(_e)?1:Math.max(1,_e)}:de))},onFocus:$e=>$e.target.select(),className:"dosage-input text-sm text-right"}),r.jsx("button",{type:"button",onClick:()=>d($e=>$e.map(_e=>_e.drug_id===Te?{..._e,tabletsPerDay:(_e.tabletsPerDay??1)+1}:_e)),className:"quantity-btn",children:"+"})]})]}),r.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[r.jsx("label",{htmlFor:`number-of-days-${Te}`,className:"dosage-label",children:"No. Days:"}),r.jsxs("div",{className:"quantity-control",children:[r.jsx("button",{type:"button",onClick:()=>d($e=>$e.map(_e=>_e.drug_id===Te?{..._e,numberOfDays:Math.max(1,(_e.numberOfDays??1)-1)}:_e)),className:"quantity-btn",children:"-"}),r.jsx("input",{type:"number",id:`number-of-days-${Te}`,min:"1",value:ye.numberOfDays??1,onChange:$e=>{const _e=parseInt($e.target.value,10);d(X=>X.map(de=>de.drug_id===Te?{...de,numberOfDays:isNaN(_e)?1:Math.max(1,_e)}:de))},onFocus:$e=>$e.target.select(),className:"dosage-input text-sm text-right"}),r.jsx("button",{type:"button",onClick:()=>d($e=>$e.map(_e=>_e.drug_id===Te?{..._e,numberOfDays:(_e.numberOfDays??1)+1}:_e)),className:"quantity-btn",children:"+"})]})]})]}),r.jsx("div",{className:"flex items-center mt-2",children:ye.unit&&De(ye.unit)&&r.jsx("span",{className:"ml-4 text-sm text-gray-400",children:(()=>{const $e=De(ye.unit),_e=ye.looseQuantity??0;if($e&&$e>0){const X=Math.floor(_e/$e),de=_e%$e;return`(Subtract: ${X} packs, ${de} loose)`}return""})()})}),r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{htmlFor:`directions-${Te}`,className:"dosage-label",children:"Directions:"}),r.jsx("input",{type:"text",id:`directions-${Te}`,placeholder:"e.g., 'After food', 'Twice a day'",value:ye.directions_to_use??"",onChange:$e=>{const _e=$e.target.value;d(X=>X.map(de=>(de.drug_id??de.name)===Te?{...de,directions_to_use:_e}:de))},className:"dosage-input text-sm w-full mt-1"})]})]},Te)})})]}),l.length>0&&r.jsx("div",{className:"mt-6 text-right pr-4",children:r.jsxs("span",{className:"grand-total font-bold",children:[" ","Grand Total: ",Ft]})}),r.jsx("div",{className:"mt-8 flex justify-end",children:r.jsx("button",{type:"submit",disabled:S||l.length===0&&!(T!=null&&T.trim()),className:`submit-order-button inline-flex items-center justify-center text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${S||l.length===0&&!(T!=null&&T.trim())?"":"hover:opacity-90"}`,children:S?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner animate-spin rounded-full h-5 w-5 border-2 mr-3"})," ","Creating Order..."]}):"Create Order"})})]})]})},hA=()=>{const{orderId:e}=Qr(),n=kt(),[t,i]=w.useState(null),[a,o]=w.useState(null),[l,d]=w.useState([]),[f,u]=w.useState([]),[p,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,I]=w.useState(null),[U,L]=w.useState(!0),F=w.useCallback(async()=>{L(!0);try{const W=await pe(`/api/pharmacy-orders/${e}`);if(!W.ok)throw new Error("Failed to fetch order details");const H=await W.json();i(H),o({id:H.patientId,name:H.patientName||"N/A",token:H.patientTokenNumber}),I(H.prescriptionForUnavailableDrugs);const Q=H.medications.map(J=>{const fe=$(J.unit),A=J.pack_quantity*(fe??1)+J.loose_quantity;return{...J,isLoose:!0,loosePacks:J.pack_quantity,looseUnits:J.loose_quantity,looseQuantity:A,pack_price:J.pack_price,loose_price:J.loose_price,total_price:J.total_price,pricePerLooseUnit:J.loose_price,originalPrice:J.pack_price,box_number:J.box_number,unit:J.unit,batch:J.batch,expiry_date:J.expiry_date,discount_percentage:J.discount_percentage}});u(Q)}catch(W){k("Could not load order details. "+W.message)}finally{L(!1)}},[e]),z=w.useCallback(async()=>{try{const W=await pe("/api/drugs");if(!W.ok)throw new Error("Failed to fetch drugs");const H=await W.json();d(H)}catch(W){k("Could not load drug list. "+W.message)}},[]);w.useEffect(()=>{F(),z()},[F,z]),w.useEffect(()=>{if(!p){v([]);return}const W=p.toLowerCase();v(l.filter(H=>{const Q=H.name&&H.name.toLowerCase().includes(W),J=H.brand_name&&H.brand_name.toLowerCase().includes(W);return Q||J}).slice(0,10))},[p,l]);const $=W=>{if(!W)return null;const H=W.match(/(?:\d+x)?(\d+)/);return H?parseInt(H[1],10):null},B=W=>{if(f.some(H=>H.drug_id===W.id)){k(`${W.name||W.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}u(H=>[...H,{drug_id:W.id,name:W.name||W.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(W.price)||0,loose_price:(Number(W.price)||0)/($(W.unit)||1),total_price:(Number(W.price)||0)/($(W.unit)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:W.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(W.price)||0)/($(W.unit)||1),originalPrice:Number(W.price)||0,unit:W.unit}]),g(""),v([])},R=W=>{u(H=>H.filter(Q=>(Q.drug_id??Q.name)!==W))},V=(W,H)=>{u(Q=>Q.map(J=>{if((J.drug_id??J.name)===W&&J.isLoose){const fe=$(J.unit),A=Math.max(0,H),oe=A*(fe??1)+(J.looseUnits??0);return{...J,loosePacks:A,looseQuantity:oe,pack_quantity:A}}return J}))},Y=(W,H)=>{u(Q=>Q.map(J=>{if((J.drug_id??J.name)===W&&J.isLoose){const fe=$(J.unit),A=Math.max(0,H),oe=(J.loosePacks??0)*(fe??1)+A;return{...J,looseUnits:A,looseQuantity:oe,loose_quantity:A}}return J}))},ie=async W=>{if(W.preventDefault(),k(null),P(!0),f.length===0&&!(M!=null&&M.trim())){k("Please add at least one medication or provide a prescription."),P(!1);return}const H=f.filter(J=>{const fe=J.looseQuantity??0;return fe<=0||J.stock!==void 0&&fe>J.stock});if(H.length>0){k(`Invalid quantity or insufficient stock for: ${H.map(J=>J.name).join(", ")}`),P(!1);return}const Q={items:f.map(J=>({drug_id:J.drug_id??null,name:J.name,pack_quantity:J.loosePacks??0,loose_quantity:J.looseUnits??0,pack_price:J.pack_price??0,loose_price:J.loose_price??0,total_price:(J.loose_price??0)*(J.looseQuantity??0),discount_percentage:J.discount_percentage??0,directions_to_use:J.directions_to_use??null,tabletsPerDay:J.tabletsPerDay??1,numberOfDays:J.numberOfDays??1})),prescription_for_unavailable_drugs:M,order_total:te};try{const J=await pe(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!J.ok){const fe=await J.json();throw new Error(fe.message||"Failed to update order")}alert("Pharmacy order updated successfully!"),n(-1)}catch(J){k(J.message||"Failed to update order. Please try again.")}finally{P(!1)}},te=w.useMemo(()=>f.reduce((W,H)=>{const Q=H.loose_price??0,J=H.looseQuantity??0;return W+Q*J},0),[f]);return U?r.jsx("div",{className:"p-6 flex justify-center items-center h-screen text-gray-500",children:"Loading order details..."}):t?r.jsxs("div",{className:"edit-pharmacy-order-container",children:[r.jsxs("div",{className:"page-header",children:[r.jsxs("div",{className:"header-left",children:[r.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:r.jsx(nn,{size:20})}),r.jsxs("h2",{className:"page-title",children:["EDIT ORDER ",r.jsxs("span",{className:"text-gray-500 text-lg font-normal ml-2",children:[a==null?void 0:a.name," #",t.id.substring(0,4)]})]})]}),r.jsx("div",{className:"header-right",children:r.jsx("span",{className:"status-badge",children:t.status.toUpperCase()})})]}),r.jsx("div",{className:"order-meta",children:r.jsxs("span",{className:"order-date",children:[" Order Date: ",new Date(t.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})]})}),r.jsxs("form",{onSubmit:ie,className:"main-layout",children:[r.jsxs("div",{className:"left-column",children:[r.jsxs("div",{className:"card search-section",children:[r.jsx("div",{className:"card-header",children:r.jsx("h3",{children:" Find & Add Medication"})}),r.jsxs("div",{className:"search-wrapper",children:[r.jsx("input",{type:"text",placeholder:"Search by name or brand...",value:p,onChange:W=>g(W.target.value),className:"search-input"}),p&&r.jsx("div",{className:"dropdown-results",children:b.length>0?r.jsx("ul",{children:b.map(W=>r.jsxs("li",{onClick:()=>B(W),className:"dropdown-item",children:[r.jsx("span",{className:"drug-name",children:W.name||W.brand_name}),r.jsxs("span",{className:"drug-meta",children:["(Stock: ",W.quantity_in_stock??"N/A",", Price: ",Number(W.price||0).toFixed(2),")"]})]},W.id))}):r.jsxs("div",{className:"p-3 text-gray-500 text-sm",children:['No drugs found matching "',p,'"']})})]})]}),r.jsxs("div",{className:"card medications-list-section",children:[r.jsx("div",{className:"card-header",children:r.jsxs("h3",{children:[" Medications in Order ",r.jsxs("span",{className:"item-count",children:[f.length," items"]})]})}),f.length>0?r.jsxs("div",{className:"table-container",children:[r.jsxs("div",{className:"table-header-row",children:[r.jsx("div",{className:"col-medication",children:"MEDICATION"}),r.jsx("div",{className:"col-directions",children:"DIRECTIONS"}),r.jsx("div",{className:"col-quantity",children:"QUANTITY"}),r.jsx("div",{className:"col-subtotal",children:"SUBTOTAL"}),r.jsx("div",{className:"col-action"})]}),r.jsx("div",{className:"table-body",children:f.map(W=>{const H=W.drug_id??W.name;return r.jsxs("div",{className:"table-row",children:[r.jsxs("div",{className:"col-medication",children:[r.jsx("span",{className:"med-name",children:W.name}),W.unit&&r.jsx("span",{className:"med-unit text-xs text-gray-500 block",children:W.unit}),r.jsxs("div",{className:"stock-info",children:[" Stock: ",r.jsxs("span",{className:"stock-value",children:[" ",W.stock!==void 0?W.unit?`BOX OF ${$(W.unit)}`:W.stock:"N/A"]})]})]}),r.jsx("div",{className:"col-directions",children:r.jsx("input",{type:"text",placeholder:"1 tablet twice daily...",value:W.directions_to_use??"",onChange:Q=>{const J=Q.target.value;u(fe=>fe.map(A=>(A.drug_id??A.name)===H?{...A,directions_to_use:J}:A))},className:"directions-input"})}),r.jsx("div",{className:"col-quantity",children:r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"PACKS"}),r.jsx("input",{type:"number",min:"0",value:W.loosePacks??0,onChange:Q=>V(H,parseInt(Q.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"LOOSE"}),r.jsx("input",{type:"number",min:"0",value:W.looseUnits??0,onChange:Q=>Y(H,parseInt(Q.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]})]})}),r.jsxs("div",{className:"col-subtotal",children:["",(Number((W.pricePerLooseUnit??0)*(W.looseQuantity??0))||0).toFixed(2)]}),r.jsx("div",{className:"col-action",children:r.jsx("button",{type:"button",onClick:()=>R(H),className:"delete-btn",children:r.jsx(lr,{size:16})})})]},H)})})]}):r.jsx("div",{className:"empty-state",children:"No medications added. Search above to add."})]})]}),r.jsxs("div",{className:"right-column",children:[r.jsxs("div",{className:"card notes-card",children:[r.jsx("div",{className:"card-header border-b-0 pb-2",children:r.jsx("h3",{children:" Prescription Notes"})}),r.jsx("textarea",{rows:3,value:M??"",onChange:W=>I(W.target.value||null),placeholder:"Add notes about unavailable drugs...",className:"notes-input"})]}),r.jsxs("button",{type:"submit",disabled:T,className:"confirm-btn",style:{width:"100%",margin:"20px 0 0 0"},children:[r.jsx("span",{className:"check-icon",children:""})," ",T?"Updating...":"Confirm Changes"]}),S&&r.jsx("div",{className:"error-alert mt-4",children:S})]})]})]}):r.jsx("div",{className:"p-6 text-red-500 flex justify-center items-center h-screen",children:"Order not found or failed to load."})},kee=(e,n,t,i="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),i==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Tee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const i=e-n-t/5;return parseFloat(i.toFixed(2))},Eee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Aee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Pee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const i=e-(n+t);return parseFloat(i.toFixed(2))},Dee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const i=2*e+n/18+t/2.8;return parseFloat(i.toFixed(2))},E_=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),A_=()=>{var se,be;const{orderId:e}=Qr(),n=kt(),[t,i]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[p,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[T,P]=w.useState({}),[M,I]=w.useState(null),[U,L]=w.useState(!1),[F,z]=w.useState(""),[$,B]=w.useState(!1),[R,V]=w.useState(""),Y=w.useCallback(async ee=>{var ce;try{const re=await pe(`/api/patients/${ee}`);if(!re.ok)throw new Error(`Failed to fetch patient details: ${re.status}`);const Pe=await re.json();v(Pe.age),k(((ce=Pe.sex)==null?void 0:ce.toLowerCase())==="female"?"female":"male"),Pe.phone&&i(Qe=>Qe?{...Qe,Patient:{...Qe.Patient,phone:Pe.phone}}:null)}catch(re){console.error("Error fetching patient details:",re),v(null),k(null)}},[]),ie=w.useCallback(async()=>{if(e){d(!0),g(null);try{const ee=await pe(`/api/lab/${e}`);if(!ee.ok){const Pe=await ee.json().catch(()=>({message:`HTTP error! status: ${ee.status}`}));throw new Error(Pe.message||`HTTP error! status: ${ee.status}`)}const ce=await ee.json();if(i(ce),ce.createdAt)try{const Pe=new Date(ce.createdAt),Qe=new Date(Pe.getTime()-Pe.getTimezoneOffset()*6e4).toISOString().slice(0,16);z(Qe)}catch(Pe){console.error("Error formatting date for edit:",Pe)}if(ce.report_date)try{const Pe=new Date(ce.report_date),Qe=new Date(Pe.getTime()-Pe.getTimezoneOffset()*6e4).toISOString().slice(0,16);V(Qe)}catch(Pe){console.error("Error formatting report date for edit:",Pe)}else{const Pe=new Date,Qe=new Date(Pe.getTime()-Pe.getTimezoneOffset()*6e4).toISOString().slice(0,16);V(Qe)}ce.patient_id&&Y(ce.patient_id);const re={};if(ce.tests&&ce.tests.forEach(Pe=>{re[Pe.id]={},Pe.default_parameters&&Pe.default_parameters.length>0?Pe.default_parameters.forEach(Qe=>{re[Pe.id][Qe.name]=Qe.defaultValue}):re[Pe.id].report_content=""}),ce.report_content)try{const Pe=JSON.parse(ce.report_content);typeof Pe=="object"&&Pe!==null&&!Array.isArray(Pe)?o(Pe):(console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),o(re))}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),o(re)}else o({})}catch(ee){console.error("Failed to fetch lab order details:",ee),g(ee instanceof Error?ee.message:"An unknown error occurred while fetching order details.")}finally{d(!1)}}},[e,Y]);w.useEffect(()=>{e?ie():(g("No Order ID provided in the URL."),d(!1))},[e,ie]);const te=(ee,ce,re)=>{o(Pe=>{var X,de,qe,et,ct,Fe,ot,ve,xe,Be,Ue,tt,dt,qt,On,Tt,Rt,si,ki;const Qe={...Pe,[ee]:{...Pe[ee],[ce]:re}},Se=parseFloat((X=Qe[ee])==null?void 0:X.Creatinine),Ne=b,De=S;if(ce==="Creatinine"&&!isNaN(Se)&&Ne!==null&&De!==null){const bn=kee(Se,Ne,De);bn!==null&&((de=t==null?void 0:t.tests.find(rn=>rn.id===ee))!=null&&de.default_parameters.find(rn=>rn.name==="eGFR"))&&(Qe[ee].eGFR=bn)}const Me=parseFloat((qe=Qe[ee])==null?void 0:qe["Total Cholesterol"]),nt=parseFloat((et=Qe[ee])==null?void 0:et["HDL Cholesterol"]),ft=parseFloat((ct=Qe[ee])==null?void 0:ct.Triglycerides);if((ce==="Total Cholesterol"||ce==="HDL Cholesterol"||ce==="Triglycerides")&&!isNaN(Me)&&!isNaN(nt)&&!isNaN(ft)){const bn=Tee(Me,nt,ft);bn!==null&&((Fe=t==null?void 0:t.tests.find(rn=>rn.id===ee))!=null&&Fe.default_parameters.find(rn=>rn.name==="LDL Cholesterol"))&&(Qe[ee]["LDL Cholesterol"]=bn)}const ut=parseFloat((ot=Qe[ee])==null?void 0:ot["Total Bilirubin"]),rt=parseFloat((ve=Qe[ee])==null?void 0:ve["Direct Bilirubin"]);if((ce==="Total Bilirubin"||ce==="Direct Bilirubin")&&!isNaN(ut)&&!isNaN(rt)){const bn=Eee(ut,rt);bn!==null&&((xe=t==null?void 0:t.tests.find(rn=>rn.id===ee))!=null&&xe.default_parameters.find(rn=>rn.name==="Indirect Bilirubin"))&&(Qe[ee]["Indirect Bilirubin"]=bn)}const Nt=parseFloat((Be=Qe[ee])==null?void 0:Be["Total Protein"]),Ft=parseFloat((Ue=Qe[ee])==null?void 0:Ue.Albumin);if((ce==="Total Protein"||ce==="Albumin")&&!isNaN(Nt)&&!isNaN(Ft)){const bn=Aee(Nt,Ft);bn!==null&&((tt=t==null?void 0:t.tests.find(rn=>rn.id===ee))!=null&&tt.default_parameters.find(rn=>rn.name==="Globulin"))&&(Qe[ee].Globulin=bn)}const ye=parseFloat((dt=Qe[ee])==null?void 0:dt.Sodium),Te=parseFloat((qt=Qe[ee])==null?void 0:qt.Chloride),Ye=parseFloat((On=Qe[ee])==null?void 0:On.Bicarbonate);if((ce==="Sodium"||ce==="Chloride"||ce==="Bicarbonate")&&!isNaN(ye)&&!isNaN(Te)&&!isNaN(Ye)){const bn=Pee(ye,Te,Ye);bn!==null&&((Tt=t==null?void 0:t.tests.find(rn=>rn.id===ee))!=null&&Tt.default_parameters.find(rn=>rn.name==="Anion Gap"))&&(Qe[ee]["Anion Gap"]=bn)}const $e=parseFloat((Rt=Qe[ee])==null?void 0:Rt.Glucose),_e=parseFloat((si=Qe[ee])==null?void 0:si.BUN);if((ce==="Sodium"||ce==="Glucose"||ce==="BUN")&&!isNaN(ye)&&!isNaN($e)&&!isNaN(_e)){const bn=Dee(ye,$e,_e);bn!==null&&((ki=t==null?void 0:t.tests.find(rn=>rn.id===ee))!=null&&ki.default_parameters.find(rn=>rn.name==="Osmolality"))&&(Qe[ee].Osmolality=bn)}return Qe})},W=async ee=>{const ce=a[ee]||{},re=t==null?void 0:t.tests.find(Ne=>Ne.id===ee);if(!re)return;const Pe={};re.default_parameters&&re.default_parameters.forEach(Ne=>{Pe[Ne.name]=Ne.defaultValue});const Qe={...Pe,...ce},Se={...a,[ee]:Qe};o(Se),u(!0),g(null);try{const Ne=await pe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Se),isPartial:!0})});if(!Ne.ok)throw new Error(`Save failed: ${Ne.status}`);alert(`Report for ${re.name} saved successfully!`)}catch(Ne){console.error("Error saving test report:",Ne),alert("Failed to save test report.")}finally{u(!1)}},H=(ee=null)=>{I(ee),setTimeout(()=>{window.print()},100)},Q=()=>{t&&Cw(t)},J=async()=>{if(!t||!t.tests){alert("Order details not loaded.");return}if(!e){alert("Cannot submit report without an Order ID.");return}const ee={};if(t.tests.forEach(ce=>{const re=a[ce.id]||{},Pe={};ce.default_parameters&&ce.default_parameters.forEach(Qe=>{Qe.defaultValue!==void 0&&Qe.defaultValue!==null&&(Pe[Qe.name]=Qe.defaultValue)}),ee[ce.id]={...Pe,...re},(!ce.default_parameters||ce.default_parameters.length===0)&&!ee[ce.id].report_content&&(ee[ce.id].report_content="")}),Object.keys(ee).length===0){alert("Report content cannot be empty.");return}o(ee),u(!0),g(null);try{const ce=await pe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(ee)})});if(!ce.ok){const re=await ce.json().catch(()=>({message:`Submission failed: ${ce.status}`}));throw new Error(re.message||`Submission failed: ${ce.status}`)}alert("Report submitted successfully!"),n(-1)}catch(ce){console.error("Error submitting report:",ce),g(ce instanceof Error?ce.message:"An unknown error occurred during submission.")}finally{u(!1)}},fe=async()=>{if(!(!e||!F))try{const ee=await pe(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:new Date(F).toISOString()})});if(!ee.ok)throw new Error("Failed to update date");const ce=await ee.json();ce.order&&i(re=>re?{...re,createdAt:ce.order.createdAt}:null),L(!1)}catch(ee){console.error("Failed to update date:",ee),alert("Failed to update date")}},A=async()=>{if(!(!e||!R))try{const ee=await pe(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportDate:new Date(R).toISOString()})});if(!ee.ok)throw new Error("Failed to update report date");const ce=await ee.json();ce.order&&i(re=>re?{...re,report_date:ce.order.report_date}:null),B(!1)}catch(ee){console.error("Failed to update report date:",ee),alert("Failed to update report date")}};if(l)return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",r.jsxs("div",{className:"loading-text",children:[r.jsx(Ih,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(p&&!t)return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[r.jsx(Ki,{size:48,className:"mb-3",style:{margin:"0 auto"}}),r.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),r.jsx("p",{className:"error-text",children:p}),r.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[r.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[r.jsx(Jo,{size:48,className:"mb-3",style:{margin:"0 auto"}}),r.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),r.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[r.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const oe=(se=t==null?void 0:t.Patient)==null?void 0:se.name,ue=(be=t==null?void 0:t.Patient)==null?void 0:be.patient_token_number;return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",r.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Enter Lab Report"})," ",r.jsxs("button",{onClick:()=>n(e?"/lab":-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:f,children:[r.jsx(nn,{size:16,style:{marginRight:"5px"}}),e?"Back to Lab Panel":"Back"]}),r.jsxs("div",{style:{display:"flex",gap:"8px",marginLeft:"10px"},children:[r.jsxs("button",{onClick:()=>H(null),className:"lab-inventory-button",title:"Print Full Report",children:[r.jsx(Kc,{size:16,style:{marginRight:"5px"}})," Print All"]}),r.jsxs("button",{onClick:Q,className:"lab-inventory-button",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},title:"Share via WhatsApp",children:[r.jsx(sk,{size:16,style:{marginRight:"5px"}})," WhatsApp"]})]})]}),t&&r.jsxs("div",{className:"lab-inventory-card no-print",style:{marginTop:"20px"},children:[r.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[r.jsx(Jo,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[r.jsxs("div",{children:[r.jsx(tu,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),r.jsx("strong",{children:"Patient:"})," ",oe??"N/A"," (Token: ",ue??"N/A",")"]}),r.jsxs("div",{children:[r.jsx(PS,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),r.jsx("strong",{children:"Order Date:"})," ",U?r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[r.jsx("input",{type:"datetime-local",value:F,onChange:ee=>z(ee.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),r.jsx("button",{onClick:fe,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Date",children:r.jsx(DS,{size:16,color:"green"})}),r.jsx("button",{onClick:()=>{if(L(!1),t.createdAt){const ee=new Date(t.createdAt),ce=new Date(ee.getTime()-ee.getTimezoneOffset()*6e4).toISOString().slice(0,16);z(ce)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:r.jsx(ni,{size:16,color:"red"})})]}):r.jsxs(r.Fragment,{children:[Md(new Date(t.createdAt),"PPpp"),r.jsx("button",{onClick:()=>L(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Date",children:r.jsx(Yv,{size:14})})]})]}),r.jsxs("div",{children:[r.jsx(PS,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),r.jsx("strong",{children:"Report Date:"})," ",$?r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[r.jsx("input",{type:"datetime-local",value:R,onChange:ee=>V(ee.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),r.jsx("button",{onClick:A,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Report Date",children:r.jsx(DS,{size:16,color:"green"})}),r.jsx("button",{onClick:()=>{if(B(!1),t.report_date){const ee=new Date(t.report_date),ce=new Date(ee.getTime()-ee.getTimezoneOffset()*6e4).toISOString().slice(0,16);V(ce)}else{const ee=new Date,ce=new Date(ee.getTime()-ee.getTimezoneOffset()*6e4).toISOString().slice(0,16);V(ce)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:r.jsx(ni,{size:16,color:"red"})})]}):r.jsxs(r.Fragment,{children:[t.report_date?Md(new Date(t.report_date),"PPpp"):"Not Reported",r.jsx("button",{onClick:()=>B(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Report Date",children:r.jsx(Yv,{size:14})})]})]}),r.jsxs("div",{style:{gridColumn:"1 / -1"},children:[r.jsx(JI,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),r.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(ee=>ee.name).join(", ")]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Status:"})," ",r.jsx("span",{className:Ree(t.status),children:Iee(t.status)})]})]})]}),r.jsxs("div",{className:"lab-inventory-form-group no-print",style:{marginTop:"20px"},children:[r.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:"Report Parameters"}),t==null?void 0:t.tests.map(ee=>{var ce;return r.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"15px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"},children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",margin:0},children:ee.name}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[r.jsxs("button",{type:"button",onClick:re=>{re.stopPropagation(),W(ee.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em"},disabled:f,children:[r.jsx(Fd,{size:14,style:{marginRight:"4px"}})," Save"]}),r.jsx("button",{type:"button",onClick:re=>{re.stopPropagation(),H(ee.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em",marginLeft:"5px"},title:"Print This Test Only",children:r.jsx(Kc,{size:14})})]})]}),r.jsx("div",{className:"test-parameters-body",style:{display:"block"},children:ee.default_parameters&&ee.default_parameters.length>0?r.jsx(r.Fragment,{children:r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"lab-inventory-table",style:{marginTop:"10px",width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{backgroundColor:"#f9fafb"},children:[r.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Parameter"}),r.jsx("th",{style:{width:"35%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Result"}),r.jsx("th",{style:{width:"15%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Units"}),r.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Normal Range"})]})}),r.jsx("tbody",{children:ee.default_parameters.map(re=>{var Pe,Qe,Se,Ne,De,Me,nt,ft,ut;return r.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[r.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#374151",fontWeight:"500"},children:r.jsx("label",{htmlFor:`${ee.id}-${re.name}`,style:{cursor:"pointer"},children:re.name})}),r.jsx("td",{style:{padding:"10px",verticalAlign:"middle"},children:re.type==="boolean"?r.jsxs("select",{id:`${ee.id}-${re.name}`,value:((Qe=(Pe=a[ee.id])==null?void 0:Pe[re.name])==null?void 0:Qe.toString())??"false",onChange:rt=>te(ee.id,re.name,rt.target.value==="true"),className:"lab-inventory-input",disabled:f,style:{margin:0,width:"100%"},children:[r.jsx("option",{value:"true",children:"Reactive"}),r.jsx("option",{value:"false",children:"Non-Reactive"})]}):r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[r.jsx("input",{id:`${ee.id}-${re.name}`,type:re.type==="number"?"number":"text",value:((Se=a[ee.id])==null?void 0:Se[re.name])!==void 0?(Ne=a[ee.id])==null?void 0:Ne[re.name]:re.defaultValue??"",onChange:rt=>{const Nt=re.type==="number"&&rt.target.value===""?"":rt.target.value;te(ee.id,re.name,Nt)},className:`lab-inventory-input ${re.type==="number"&&((De=a[ee.id])==null?void 0:De[re.name])!==""&&(re.lower_limit!=null&&parseFloat((Me=a[ee.id])==null?void 0:Me[re.name])<re.lower_limit||re.upper_limit!=null&&parseFloat((nt=a[ee.id])==null?void 0:nt[re.name])>re.upper_limit)?"abnormal-result":""}`,disabled:f||E_(re.name)&&!((ft=T[ee.id])!=null&&ft[re.name]),style:{margin:0,width:"100%"}}),E_(re.name)&&r.jsx("button",{type:"button",onClick:()=>P(rt=>{var Nt;return{...rt,[ee.id]:{...rt[ee.id]||{},[re.name]:!((Nt=rt[ee.id])!=null&&Nt[re.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.7em",padding:"4px 6px",height:"fit-content",whiteSpace:"nowrap"},disabled:f,title:(ut=T[ee.id])!=null&&ut[re.name]?"Disable Manual Edit":"Edit Calculated Field",children:r.jsx(Yv,{size:12})})]})}),r.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280"},children:re.unit||"-"}),r.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280",fontSize:"0.9em"},children:re.type==="number"&&(re.lower_limit!==null||re.upper_limit!==null)?r.jsxs(r.Fragment,{children:[re.lower_limit!==null&&re.lower_limit!==void 0&&`> ${re.lower_limit}`,re.lower_limit!==null&&re.lower_limit!==void 0&&re.upper_limit!==null&&re.upper_limit!==void 0&&" - ",re.upper_limit!==null&&re.upper_limit!==void 0&&`< ${re.upper_limit}`]}):"-"})]},re.name)})})]})})}):r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:`${ee.id}-report_content`,children:"Report Content"}),r.jsx("textarea",{id:`${ee.id}-report_content`,value:((ce=a[ee.id])==null?void 0:ce.report_content)??"",onChange:re=>te(ee.id,"report_content",re.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${ee.name}...`,disabled:f})]})})]},ee.id)}),p&&r.jsxs("p",{className:"error-text",style:{marginTop:"10px"},children:[r.jsx(Ki,{size:15,className:"inline mr-1"}),p]})]}),r.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",r.jsx("button",{type:"button",onClick:()=>n(-1),disabled:f,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),r.jsx("button",{type:"button",onClick:J,disabled:f,className:"lab-inventory-button",children:f?r.jsxs(r.Fragment,{children:[r.jsx(Ih,{className:"animate-spin mr-2",size:16})," Submitting..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Fd,{size:16,style:{marginRight:"5px"}})," Submit Full Report"]})})]}),r.jsxs("div",{className:"printable-only",children:[t&&t.Patient&&r.jsxs("div",{style:{marginBottom:"20px",borderBottom:"1px solid #ccc",paddingBottom:"10px"},children:[r.jsx("h2",{style:{textAlign:"center",marginBottom:"15px"},children:"Lab Report"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"12px"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Patient Name:"})," ",t.Patient.name]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Age/Sex:"})," ",b??"N/A"," / ",S??"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Ref. Doctor:"})," ",t.uploaded_by||"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Date:"})," ",Md(new Date,"PPpp")]})]})]}),t==null?void 0:t.tests.filter(ee=>M===null||ee.id===M).map(ee=>{var ce;return r.jsxs("div",{style:{marginBottom:"20px",pageBreakInside:"avoid"},children:[r.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"5px"},children:ee.name}),ee.default_parameters&&ee.default_parameters.length>0?r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{backgroundColor:"#f9f9f9"},children:[r.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Parameter"}),r.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Result"}),r.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Units"}),r.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Normal Range"})]})}),r.jsx("tbody",{children:ee.default_parameters.map(re=>{var Me;const Pe=(Me=a[ee.id])==null?void 0:Me[re.name],Qe=typeof Pe=="string"?parseFloat(Pe):typeof Pe=="number"?Pe:NaN,Se=re.type==="number"&&!isNaN(Qe)&&Pe!==""&&(re.lower_limit!=null&&Qe<re.lower_limit||re.upper_limit!=null&&Qe>re.upper_limit),Ne=re.type==="boolean"&&(Pe===!0||Pe==="true"),De=re.type==="boolean"?Pe===!0||Pe==="true"?"Reactive":"Non-Reactive":Pe??"";return r.jsxs("tr",{children:[r.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:re.name}),r.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee",fontWeight:Se||Ne?"bold":"normal",color:Se?"red":Ne?"green":"inherit"},children:De}),r.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:re.unit??""}),r.jsxs("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:[re.lower_limit!==null&&re.lower_limit!==void 0&&`> ${re.lower_limit}`,re.lower_limit!==null&&re.lower_limit!==void 0&&re.upper_limit!==null&&re.upper_limit!==void 0&&" - ",re.upper_limit!==null&&re.upper_limit!==void 0&&`< ${re.upper_limit}`]})]},re.name)})})]}):r.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:"12px",padding:"10px"},children:((ce=a[ee.id])==null?void 0:ce.report_content)||"No report content entered."})]},ee.id)})]})]})})},Iee=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",Ree=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},Mee=()=>{const{orderId:e}=Qr(),n=kt(),[t,i]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=w.useCallback(async p=>{if(!p){d("No Order ID specified in the URL."),o(!1),i(null);return}o(!0),d(null),i(null);try{console.log(`Fetching order details for ID: ${p}`);const g=await pe(`/api/lab/orders/${p}/report`);if(!g.ok){let v;try{v=await g.json()}catch{v={message:`Server returned status ${g.status}`}}throw console.error("Fetch order details error response:",v),new Error(v.message||`Failed to fetch order details: ${g.status}`)}const b=await g.json();if(console.log("Received order data:",b),!b)throw console.error("Invalid order data structure:",b),new Error("Invalid order data received from server.");i(b)}catch(g){console.error("Error fetching order details:",g),d(g instanceof Error?g.message:"An unknown error occurred while fetching the order details")}finally{o(!1)}},[pe]);w.useEffect(()=>{f(e)},[e,f]);const u=()=>{t&&Cw(t)};return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[r.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsxs(ds,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[r.jsx(us,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),r.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[r.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]}),r.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[r.jsx(Kc,{size:16,style:{marginRight:"5px"}}),"Print"]}),r.jsxs("button",{onClick:u,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[r.jsx(sk,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),r.jsxs("div",{style:{marginTop:"20px"},children:[r.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&r.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&r.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[r.jsx(Ki,{size:48}),r.jsx("h3",{className:"error-title",children:"Error Loading Report"}),r.jsx("p",{children:l}),e&&r.jsx("button",{onClick:()=>f(e),className:"retry-button",children:"Retry"})]}),r.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&r.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[r.jsxs("h3",{className:"lab-inventory-header",children:[r.jsx(tu,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&r.jsxs("div",{children:[r.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("h3",{className:"lab-inventory-header",children:[r.jsx(Xc,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),r.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const p=JSON.parse(t.report_content||"{}");return typeof p=="object"&&p!==null&&t.tests?t.tests.map(g=>r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em"},children:g.name}),p[g.id]?r.jsxs("table",{className:"lab-inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Parameter"}),r.jsx("th",{children:"Value"}),r.jsx("th",{children:"Normal Range"})]})}),r.jsx("tbody",{children:Object.entries(p[g.id]).map(([b,v])=>{var I;const S=(I=g.default_parameters)==null?void 0:I.find(U=>U.name===b),k=typeof v=="string"?parseFloat(v):typeof v=="number"?v:NaN,T=(S==null?void 0:S.type)==="number"&&!isNaN(k)&&(S.lower_limit!=null&&k<S.lower_limit||S.upper_limit!=null&&k>S.upper_limit),P=(S==null?void 0:S.type)==="boolean"?v===!0||v==="true"?"Reactive":"Non-Reactive":String(v),M=(S==null?void 0:S.type)==="boolean"&&(v===!0||v==="true");return r.jsxs("tr",{children:[r.jsx("td",{children:b}),r.jsxs("td",{className:`${T?"abnormal-result":""} ${M?"reactive-result":""}`,children:[P," ",S==null?void 0:S.unit]}),r.jsx("td",{children:S&&S.type==="number"&&(S.lower_limit!==null||S.upper_limit!==null)?r.jsxs(r.Fragment,{children:[S.lower_limit!=null&&` > ${S.lower_limit}`,S.lower_limit!=null&&S.upper_limit!=null&&" - ",S.upper_limit!=null&&` < ${S.upper_limit}`,S.unit&&` ${S.unit}`]}):((S==null?void 0:S.type)==="boolean","N/A")})]},b)})})]}):r.jsx("p",{children:"No parameters reported for this test."})]},g.id)):r.jsx(Ol,{remarkPlugins:[Wo],children:t.report_content})}catch{return r.jsx(Ol,{remarkPlugins:[Wo],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&r.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&r.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",r.jsx(ds,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},Oee=()=>{const e=kt(),[n,t]=w.useState(""),[i,a]=w.useState(!1),[o,l]=w.useState([]),[d,f]=w.useState(null),[u,p]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{p(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[u]);const g=async()=>{const k=n.trim();if(!k){l([]),f(null);return}a(!0),f(null),l([]),console.log(`Searching for: ${k}`);try{const T=await pe("/api/lab");if(!T.ok){let F;try{F=await T.json()}catch{F={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",F),new Error(F.message||`HTTP error! status: ${T.status}`)}const{orders:P}=await T.json();console.log("Received lab orders for search:",P);const I=P.filter(F=>!!F.report_content).map(F=>{var z,$;return{id:F.id,labTokenNumber:String(F.lab_token_number??"N/A"),patientName:((z=F.Patient)==null?void 0:z.name)||"N/A",patientId:F.patient_id,patientTokenNumber:String((($=F.Patient)==null?void 0:$.patient_token_number)??"N/A"),tests:(F.tests||[]).map(B=>B.name||"Unknown Test"),date:Md(new Date(F.createdAt),"yyyy-MM-dd"),status:F.status}}),U=n.toLowerCase(),L=I.filter(F=>{var B,R,V,Y,ie;const z=String(F.labTokenNumber).toLowerCase(),$=String(F.patientTokenNumber).toLowerCase();return(((B=F.patientName)==null?void 0:B.toLowerCase())||"").includes(U)||z.includes(U)||$.includes(U)||(((V=(R=F.tests)==null?void 0:R.join(" "))==null?void 0:V.toLowerCase())||"").includes(U)||(((Y=F.id)==null?void 0:Y.toLowerCase())||"").includes(U)||(((ie=F.patientId)==null?void 0:ie.toLowerCase())||"").includes(U)});console.log("Filtered search results:",L),l(L),L.length===0&&k?f(`No matching reports found for "${k}".`):f(null)}catch(T){console.error("Failed to search lab reports:",T),f(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),r.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[r.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),r.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[r.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[r.jsx(us,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),r.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),r.jsxs("div",{style:{marginTop:"20px"},children:[i&&r.jsx("div",{className:"loading-text",children:"Searching..."}),d&&!i&&r.jsxs("div",{className:"error-text",children:[r.jsx(Ki,{size:20,className:"inline mr-2"})," ",d]}),o.length>0&&!i&&r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:o.map(k=>r.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[r.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[r.jsx(EI,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),r.jsx("span",{className:S(k.status),children:v(k.status).text})]}),r.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[r.jsxs("div",{style:{marginBottom:"5px"},children:[r.jsx(Xc,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),r.jsxs("div",{style:{marginBottom:"5px"},children:[r.jsx($R,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),r.jsxs("div",{children:[r.jsx(gI,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!i&&o.length===0&&!d&&n.trim()&&r.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!i&&o.length===0&&!d&&!n.trim()&&r.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},Lee=()=>{const{patientId:e}=Qr(),n=kt(),[t,i]=w.useState([]),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID is missing from the URL."),o(!1);return}o(!0),d(null),i([]),g(null);try{const S=await pe(`/api/patients/${e}`);if(S.ok){const P=await S.json();g(P.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await pe(`/api/lab/patient/${e}`);if(!k.ok){const P=await k.json().catch(()=>({}));throw new Error(P.message||`HTTP error! status: ${k.status}`)}const T=await k.json();i(T||[])}catch(S){console.error("Error fetching data:",S),d(`Failed to load data: ${S.message}`)}finally{o(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h2",{style:{margin:0},children:["Lab Reports ",p?`for ${p}`:`for Patient ID: ${e}`]}),r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await pe("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[r.jsx(cs,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),r.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[r.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),r.jsx("div",{style:{marginTop:"20px"},children:a?r.jsxs("div",{className:"loading-text",children:[r.jsx(Ih,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?r.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[r.jsx(BR,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),r.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),r.jsx("p",{children:l})]}):t.length===0?r.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[r.jsx(Xc,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),r.jsx("p",{children:"No lab reports found for this patient."}),r.jsxs("p",{children:["You can ",r.jsx(ds,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):f?r.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[r.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",f.report_date?Md(new Date(f.report_date),"PPP p"):"N/A"]}),r.jsxs("button",{onClick:()=>u(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[r.jsx(nn,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),r.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[r.jsx("strong",{children:"Tests Ordered:"})," ",(f.tests||[]).map(v=>v.name).join(", ")]}),r.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:r.jsx(Ol,{remarkPlugins:[Wo],children:f.report_content||"*No findings recorded.*"})})]}):r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>r.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx(Xc,{size:24,style:{marginRight:"15px",color:"#007bff"}}),r.jsxs("div",{children:[r.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Md(new Date(v.createdAt),"PPP")]}),r.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&r.jsx("span",{className:$ee(v.status),children:Fee(v.status)}),r.jsx(wb,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},Fee=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},$ee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},pA=()=>{const e=kt(),[n,t]=w.useState("pharmacy");return r.jsxs("div",{className:"inventory-management-container",style:{padding:"20px",backgroundColor:"var(--background-color)",minHeight:"100vh"},children:[r.jsxs("div",{className:"inventory-header",style:{marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"15px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[r.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)"},children:r.jsx(nn,{size:24})}),r.jsx("h1",{style:{margin:0,fontSize:"1.8rem",fontWeight:"700",color:"var(--text-primary)"},children:"Inventory Management"})]}),r.jsxs("div",{className:"inventory-tabs",style:{display:"flex",gap:"5px",backgroundColor:"var(--card-bg, #f3f4f6)",padding:"5px",borderRadius:"12px",border:"1px solid var(--border-color, #e5e7eb)"},children:[r.jsxs("button",{onClick:()=>t("pharmacy"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="pharmacy"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="pharmacy"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="pharmacy"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="pharmacy"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="pharmacy"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[r.jsx(ig,{size:18}),"Pharmacy Stock"]}),r.jsxs("button",{onClick:()=>t("lab"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="lab"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="lab"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="lab"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="lab"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="lab"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[r.jsx(Od,{size:18}),"Lab Stock"]})]})]}),r.jsx("div",{className:"inventory-content",style:{backgroundColor:"var(--card-bg, #fff)",borderRadius:"16px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden"},children:n==="pharmacy"?r.jsx(i2,{isEmbedded:!0}):r.jsx(Nw,{isEmbedded:!0})})]})},zee=({fetchWithAuth:e})=>{const n=kt(),[t,i]=w.useState(!0),[a,o]=w.useState([]),[l,d]=w.useState(null),[f,u]=w.useState(null),p=w.useCallback(async()=>{i(!0),d(null);try{const S=await(await e("/staff")).json();o(S.map(k=>({...k,id:k._id||k.id})))}catch(v){d(`Failed to load staff data: ${v.message}`),o([])}finally{i(!1)}},[e]);w.useEffect(()=>{p()},[p]),w.useEffect(()=>{if(f){const v=setTimeout(()=>u(null),5e3);return()=>clearTimeout(v)}},[f]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return r.jsx(ok,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return r.jsx(aw,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return r.jsx(ig,{size:16,className:"mr-2 text-purple-600"});case"lab":return r.jsx(Od,{size:16,className:"mr-2 text-yellow-600"});case"admin":return r.jsx(Sb,{size:16,className:"mr-2 text-teal-600"});default:return r.jsx(rg,{size:16,className:"mr-2 text-gray-500"})}};return t?r.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",r.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),r.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):r.jsxs("div",{className:"staff-page-container",children:[f&&r.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${f.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[f.type==="success"?r.jsx(fs,{size:18,className:"mr-2"}):r.jsx(Ki,{size:18,className:"mr-2"}),r.jsx("span",{children:f.message}),r.jsx("button",{onClick:()=>u(null),className:"ml-auto text-xl font-bold",children:""})]}),l&&r.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[r.jsx(Ki,{size:18,className:"mr-2 text-red-500"}),l,r.jsx("button",{onClick:()=>d(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:r.jsx(nn,{size:20})}),r.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),r.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[r.jsx(Zc,{size:16,className:"mr-2"})," Add New Staff"]})]}),r.jsx("div",{className:"staff-table-container",children:r.jsxs("table",{className:"staff-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{className:"hidden md:table-cell",children:"Email"}),r.jsx("th",{children:"Role"}),r.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),r.jsx("th",{className:"hidden md:table-cell",children:"Status"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:a.length===0&&!t?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>r.jsxs("tr",{children:[r.jsx("td",{children:v.name}),r.jsx("td",{className:"hidden md:table-cell",children:v.email}),r.jsx("td",{children:r.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),r.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),r.jsx("td",{className:"hidden md:table-cell",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),r.jsx("td",{className:"actions",children:r.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[r.jsx(eu,{size:16})," Edit"]})})]},v.id))})]})})]})},Uee=()=>{var k,T,P,M,I,U,L,F,z,$,B,R,V,Y;const{patientId:e,billId:n}=Qr(),t=kt(),[i,a]=w.useState(null),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,p]=w.useState(""),[g,b]=w.useState("cash"),v=((k=i==null?void 0:i.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),f(null);try{const te=await pe(`/api/bills/${n}`);if(!te.ok)throw new Error(`HTTP error! status: ${te.status}`);const W=await te.json();if(!W||!W.bill||!W.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(W.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",W.bill.type),new Error(`Unexpected bill type received: ${W.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(W,null,2));const H=Array.isArray(W.admissionPayments)?W.admissionPayments:[];console.log("Processed admissionPaymentsData:",H);const Q={...W.bill,amount:W.bill.amount,AdmissionPayments:H,calculated:W.calculated,patient:W.bill.Patient?{id:W.bill.Patient.id,name:W.bill.Patient.name,admission_date:W.bill.Patient.admission_date,discharge_date:W.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(Q,null,2)),a(Q)}catch(te){console.error("Failed to fetch admission bill details:",te),f(te instanceof Error?te.message:"An unknown error occurred")}finally{l(!1)}})():(f("Bill ID is missing."),l(!1))},[n,e]);const S=async ie=>{var te;if(ie.preventDefault(),!e||!u||isNaN(parseFloat(u))||parseFloat(u)<=0||parseFloat(u)>(((te=i==null?void 0:i.calculated)==null?void 0:te.balance)??0)){f("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}f(null);try{const W=await pe(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(u),payment_mode:g})});if(!W.ok){const J=await W.json();throw new Error(J.message||`HTTP error! status: ${W.status}`)}const Q=await(await pe(`/api/bills/${n}`)).json();if(Q&&Q.bill&&Q.calculated&&Q.admissionPayments)a({...Q.bill,amount:parseFloat(Q.bill.amount),AdmissionPayments:Q.admissionPayments,calculated:Q.calculated,patient:Q.bill.Patient?{id:Q.bill.Patient.id,name:Q.bill.Patient.name,admission_date:Q.bill.Patient.admission_date,discharge_date:Q.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");p("")}catch(W){console.error("Failed to submit payment:",W),f(W instanceof Error?W.message:"Failed to record payment")}};return o?r.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):d?r.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",d]}):!i||!i.calculated?r.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):r.jsx("div",{className:"admission-page-container",children:r.jsxs("div",{className:"admission-section",children:[" ",r.jsxs("div",{className:"p-4 border-b",children:[" ",r.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",i.id,")"]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=i.patient)==null?void 0:T.name)??"N/A"," (ID: ",i.patient_id,")"]})," ",r.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(P=i.patient)!=null&&P.admission_date?new Date(i.patient.admission_date).toLocaleDateString():"N/A"]}),((M=i.patient)==null?void 0:M.discharge_date)&&r.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(i.patient.discharge_date).toLocaleDateString()]}),r.jsxs("p",{className:"text-sm",children:["Status: ",r.jsx("span",{className:`font-semibold ${i.status==="paid"?"text-green-600":"text-orange-600"}`,children:((I=i.status)==null?void 0:I.toUpperCase())??"UNKNOWN"})]})]}),r.jsxs("div",{className:"p-4",children:[" ",r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[r.jsxs("div",{className:"admission-card",children:[r.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),r.jsxs("div",{className:"admission-card-content",children:[r.jsxs("p",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Initial Charges:"})," ",r.jsxs("span",{children:["",(parseFloat((i==null?void 0:i.amount)||"0")||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Days Stayed:"})," ",r.jsx("span",{children:((U=i==null?void 0:i.calculated)==null?void 0:U.daysStayed)??0})]}),r.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[r.jsx("span",{children:"Total Due:"})," ",r.jsxs("span",{children:["",(Number((L=i==null?void 0:i.calculated)==null?void 0:L.totalDue)||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[r.jsx("span",{children:"Total Paid:"})," ",r.jsxs("span",{children:["",(Number((F=i==null?void 0:i.calculated)==null?void 0:F.totalPaid)||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[r.jsx("span",{children:"Balance Due:"})," ",r.jsxs("span",{children:["",(Number((z=i==null?void 0:i.calculated)==null?void 0:z.balance)||0).toFixed(2)]})]})]})]}),(i==null?void 0:i.status)!=="paid"&&(Number(($=i==null?void 0:i.calculated)==null?void 0:$.balance)||0)>0&&r.jsxs("div",{className:"admission-card",children:[r.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),r.jsxs("form",{onSubmit:S,className:"space-y-4",children:[r.jsxs("div",{className:"admission-form-group",children:[r.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),r.jsx("input",{id:"paymentAmount",type:"number",value:u,onChange:ie=>p(ie.target.value),placeholder:`Max ${(Number((B=i==null?void 0:i.calculated)==null?void 0:B.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((R=i==null?void 0:i.calculated)==null?void 0:R.balance)||0,className:"admission-input"})]}),r.jsxs("div",{className:"admission-form-group",children:[r.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),r.jsxs("select",{id:"paymentMode",value:g,onChange:ie=>b(ie.target.value),className:"admission-select",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"upi",children:"UPI"}),v&&r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),r.jsx("button",{type:"submit",className:"admission-button",disabled:o||!u||parseFloat(u)<=0||parseFloat(u)>(Number((V=i==null?void 0:i.calculated)==null?void 0:V.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),r.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(i==null?void 0:i.AdmissionPayments)&&i.AdmissionPayments.length>0?r.jsxs("div",{className:"overflow-x-auto",children:[" ",r.jsxs("table",{className:"admission-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Payment ID"}),r.jsx("th",{children:"Date"}),r.jsx("th",{children:"Amount Paid"}),r.jsx("th",{children:"Mode"})]})}),r.jsx("tbody",{children:(Y=i==null?void 0:i.AdmissionPayments)==null?void 0:Y.map(ie=>{if(!ie||typeof ie!="object")return null;let te="Invalid Date";try{ie.payment_date&&!isNaN(new Date(ie.payment_date).getTime())&&(te=new Date(ie.payment_date).toLocaleString())}catch(W){console.error("Error formatting payment date:",ie.payment_date,W)}return r.jsxs("tr",{children:[" ",r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ie.id??"N/A"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(ie.amount_paid)||0).toFixed(2)]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:ie.payment_mode??"N/A"})]},ie.id??Math.random())})})]})]}):r.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),r.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",r.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var Bee=Object.defineProperty,yb=Object.getOwnPropertySymbols,mA=Object.prototype.hasOwnProperty,gA=Object.prototype.propertyIsEnumerable,P_=(e,n,t)=>n in e?Bee(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,W1=(e,n)=>{for(var t in n||(n={}))mA.call(n,t)&&P_(e,t,n[t]);if(yb)for(var t of yb(n))gA.call(n,t)&&P_(e,t,n[t]);return e},Q1=(e,n)=>{var t={};for(var i in e)mA.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&yb)for(var i of yb(e))n.indexOf(i)<0&&gA.call(e,i)&&(t[i]=e[i]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Bd;(e=>{const n=class dn{constructor(f,u,p,g){if(this.version=f,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],f<dn.MIN_VERSION||f>dn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(p);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<S&&(g=k,S=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,u){const p=e.QrSegment.makeSegments(f);return dn.encodeSegments(p,u)}static encodeBinary(f,u){const p=e.QrSegment.makeBytes(f);return dn.encodeSegments([p],u)}static encodeSegments(f,u,p=1,g=40,b=-1,v=!0){if(!(dn.MIN_VERSION<=p&&p<=g&&g<=dn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=p;;S++){const I=dn.getNumDataCodewords(S,u)*8,U=l.getTotalBits(f,S);if(U<=I){k=U;break}if(S>=g)throw new RangeError("Data too long")}for(const I of[dn.Ecc.MEDIUM,dn.Ecc.QUARTILE,dn.Ecc.HIGH])v&&k<=dn.getNumDataCodewords(S,I)*8&&(u=I);let T=[];for(const I of f){t(I.mode.modeBits,4,T),t(I.numChars,I.mode.numCharCountBits(S),T);for(const U of I.getData())T.push(U)}a(T.length==k);const P=dn.getNumDataCodewords(S,u)*8;a(T.length<=P),t(0,Math.min(4,P-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let I=236;T.length<P;I^=253)t(I,8,T);let M=[];for(;M.length*8<T.length;)M.push(0);return T.forEach((I,U)=>M[U>>>3]|=I<<7-(U&7)),new dn(S,u,M,b)}getModule(f,u){return 0<=f&&f<this.size&&0<=u&&u<this.size&&this.modules[u][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let p=0;p<this.size;p++)this.setFunctionModule(6,p,p%2==0),this.setFunctionModule(p,6,p%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),u=f.length;for(let p=0;p<u;p++)for(let g=0;g<u;g++)p==0&&g==0||p==0&&g==u-1||p==u-1&&g==0||this.drawAlignmentPattern(f[p],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const u=this.errorCorrectionLevel.formatBits<<3|f;let p=u;for(let b=0;b<10;b++)p=p<<1^(p>>>9)*1335;const g=(u<<10|p)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,i(g,b));this.setFunctionModule(8,7,i(g,6)),this.setFunctionModule(8,8,i(g,7)),this.setFunctionModule(7,8,i(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,i(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,i(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,i(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let p=0;p<12;p++)f=f<<1^(f>>>11)*7973;const u=this.version<<12|f;a(u>>>18==0);for(let p=0;p<18;p++){const g=i(u,p),b=this.size-11+p%3,v=Math.floor(p/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(f,u){for(let p=-4;p<=4;p++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(p)),v=f+g,S=u+p;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(f,u){for(let p=-2;p<=2;p++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,u+p,Math.max(Math.abs(g),Math.abs(p))!=1)}setFunctionModule(f,u,p){this.modules[u][f]=p,this.isFunction[u][f]=!0}addEccAndInterleave(f){const u=this.version,p=this.errorCorrectionLevel;if(f.length!=dn.getNumDataCodewords(u,p))throw new RangeError("Invalid argument");const g=dn.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][u],b=dn.ECC_CODEWORDS_PER_BLOCK[p.ordinal][u],v=Math.floor(dn.getNumRawDataModules(u)/8),S=g-v%g,k=Math.floor(v/g);let T=[];const P=dn.reedSolomonComputeDivisor(b);for(let I=0,U=0;I<g;I++){let L=f.slice(U,U+k-b+(I<S?0:1));U+=L.length;const F=dn.reedSolomonComputeRemainder(L,P);I<S&&L.push(0),T.push(L.concat(F))}let M=[];for(let I=0;I<T[0].length;I++)T.forEach((U,L)=>{(I!=k-b||L>=S)&&M.push(U[I])});return a(M.length==v),M}drawCodewords(f){if(f.length!=Math.floor(dn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let p=this.size-1;p>=1;p-=2){p==6&&(p=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=p-b,k=(p+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&u<f.length*8&&(this.modules[k][v]=i(f[u>>>3],7-(u&7)),u++)}}a(u==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let p=0;p<this.size;p++){let g;switch(f){case 0:g=(p+u)%2==0;break;case 1:g=u%2==0;break;case 2:g=p%3==0;break;case 3:g=(p+u)%3==0;break;case 4:g=(Math.floor(p/3)+Math.floor(u/2))%2==0;break;case 5:g=p*u%2+p*u%3==0;break;case 6:g=(p*u%2+p*u%3)%2==0;break;case 7:g=((p+u)%2+p*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][p]&&g&&(this.modules[u][p]=!this.modules[u][p])}}getPenaltyScore(){let f=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(S++,S==5?f+=dn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*dn.PENALTY_N3),v=this.modules[b][T],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*dn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(S++,S==5?f+=dn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*dn.PENALTY_N3),v=this.modules[T][b],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*dn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(f+=dn.PENALTY_N2)}let u=0;for(const b of this.modules)u=b.reduce((v,S)=>v+(S?1:0),u);const p=this.size*this.size,g=Math.ceil(Math.abs(u*20-p*10)/p)-1;return a(0<=g&&g<=9),f+=g*dn.PENALTY_N4,a(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let p=[6];for(let g=this.size-7;p.length<f;g-=u)p.splice(1,0,g);return p}}static getNumRawDataModules(f){if(f<dn.MIN_VERSION||f>dn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*f+128)*f+64;if(f>=2){const p=Math.floor(f/7)+2;u-=(25*p-10)*p-55,f>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(f,u){return Math.floor(dn.getNumRawDataModules(f)/8)-dn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][f]*dn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let u=[];for(let g=0;g<f-1;g++)u.push(0);u.push(1);let p=1;for(let g=0;g<f;g++){for(let b=0;b<u.length;b++)u[b]=dn.reedSolomonMultiply(u[b],p),b+1<u.length&&(u[b]^=u[b+1]);p=dn.reedSolomonMultiply(p,2)}return u}static reedSolomonComputeRemainder(f,u){let p=u.map(g=>0);for(const g of f){const b=g^p.shift();p.push(0),u.forEach((v,S)=>p[S]^=dn.reedSolomonMultiply(v,b))}return p}static reedSolomonMultiply(f,u){if(f>>>8||u>>>8)throw new RangeError("Byte out of range");let p=0;for(let g=7;g>=0;g--)p=p<<1^(p>>>7)*285,p^=(u>>>g&1)*f;return a(p>>>8==0),p}finderPenaltyCountPatterns(f){const u=f[1];a(u<=this.size*3);const p=u>0&&f[2]==u&&f[3]==u*3&&f[4]==u&&f[5]==u;return(p&&f[0]>=u*4&&f[6]>=u?1:0)+(p&&f[6]>=u*4&&f[0]>=u?1:0)}finderPenaltyTerminateAndCount(f,u,p){return f&&(this.finderPenaltyAddHistory(u,p),u=0),u+=this.size,this.finderPenaltyAddHistory(u,p),this.finderPenaltyCountPatterns(p)}finderPenaltyAddHistory(f,u){u[0]==0&&(f+=this.size),u.pop(),u.unshift(f)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(d,f,u){if(f<0||f>31||d>>>f)throw new RangeError("Value out of range");for(let p=f-1;p>=0;p--)u.push(d>>>p&1)}function i(d,f){return(d>>>f&1)!=0}function a(d){if(!d)throw new Error("Assertion error")}const o=class yi{constructor(f,u,p){if(this.mode=f,this.numChars=u,this.bitData=p,u<0)throw new RangeError("Invalid argument");this.bitData=p.slice()}static makeBytes(f){let u=[];for(const p of f)t(p,8,u);return new yi(yi.Mode.BYTE,f.length,u)}static makeNumeric(f){if(!yi.isNumeric(f))throw new RangeError("String contains non-numeric characters");let u=[];for(let p=0;p<f.length;){const g=Math.min(f.length-p,3);t(parseInt(f.substring(p,p+g),10),g*3+1,u),p+=g}return new yi(yi.Mode.NUMERIC,f.length,u)}static makeAlphanumeric(f){if(!yi.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],p;for(p=0;p+2<=f.length;p+=2){let g=yi.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p))*45;g+=yi.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p+1)),t(g,11,u)}return p<f.length&&t(yi.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p)),6,u),new yi(yi.Mode.ALPHANUMERIC,f.length,u)}static makeSegments(f){return f==""?[]:yi.isNumeric(f)?[yi.makeNumeric(f)]:yi.isAlphanumeric(f)?[yi.makeAlphanumeric(f)]:[yi.makeBytes(yi.toUtf8ByteArray(f))]}static makeEci(f){let u=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)t(f,8,u);else if(f<16384)t(2,2,u),t(f,14,u);else if(f<1e6)t(6,3,u),t(f,21,u);else throw new RangeError("ECI assignment value out of range");return new yi(yi.Mode.ECI,0,u)}static isNumeric(f){return yi.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return yi.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,u){let p=0;for(const g of f){const b=g.mode.numCharCountBits(u);if(g.numChars>=1<<b)return 1/0;p+=4+b+g.bitData.length}return p}static toUtf8ByteArray(f){f=encodeURI(f);let u=[];for(let p=0;p<f.length;p++)f.charAt(p)!="%"?u.push(f.charCodeAt(p)):(u.push(parseInt(f.substring(p+1,p+3),16)),p+=2);return u}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=o;e.QrSegment=o})(Bd||(Bd={}));(e=>{(n=>{const t=class{constructor(a,o){this.ordinal=a,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(Bd||(Bd={}));(e=>{(n=>{const t=class{constructor(a,o){this.modeBits=a,this.numBitsCharCount=o}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Bd||(Bd={}));var _h=Bd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var qee={L:_h.QrCode.Ecc.LOW,M:_h.QrCode.Ecc.MEDIUM,Q:_h.QrCode.Ecc.QUARTILE,H:_h.QrCode.Ecc.HIGH},yA=128,xA="L",bA="#FFFFFF",vA="#000000",wA=!1,SA=1,Vee=4,Hee=0,Gee=.1;function NA(e,n=0){const t=[];return e.forEach(function(i,a){let o=null;i.forEach(function(l,d){if(!l&&o!==null){t.push(`M${o+n} ${a+n}h${d-o}v1H${o+n}z`),o=null;return}if(d===i.length-1){if(!l)return;o===null?t.push(`M${d+n},${a+n} h1v1H${d+n}z`):t.push(`M${o+n},${a+n} h${d+1-o}v1H${o+n}z`);return}l&&o===null&&(o=d)})}),t.join("")}function CA(e,n){return e.slice().map((t,i)=>i<n.y||i>=n.y+n.h?t:t.map((a,o)=>o<n.x||o>=n.x+n.w?a:!1))}function Yee(e,n,t,i){if(i==null)return null;const a=e.length+t*2,o=Math.floor(n*Gee),l=a/n,d=(i.width||o)*l,f=(i.height||o)*l,u=i.x==null?e.length/2-d/2:i.x*l,p=i.y==null?e.length/2-f/2:i.y*l,g=i.opacity==null?1:i.opacity;let b=null;if(i.excavate){let S=Math.floor(u),k=Math.floor(p),T=Math.ceil(d+u-S),P=Math.ceil(f+p-k);b={x:S,y:k,w:T,h:P}}const v=i.crossOrigin;return{x:u,y:p,h:f,w:d,excavation:b,opacity:g,crossOrigin:v}}function Wee(e,n){return n!=null?Math.max(Math.floor(n),0):e?Vee:Hee}function jA({value:e,level:n,minVersion:t,includeMargin:i,marginSize:a,imageSettings:o,size:l,boostLevel:d}){let f=wn.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(..._h.QrSegment.makeSegments(T)),k),[]);return _h.QrCode.encodeSegments(S,qee[n],t,void 0,void 0,d)},[e,n,t,d]);const{cells:u,margin:p,numCells:g,calculatedImageSettings:b}=wn.useMemo(()=>{let v=f.getModules();const S=Wee(i,a),k=v.length+S*2,T=Yee(v,l,S,o);return{cells:v,margin:S,numCells:k,calculatedImageSettings:T}},[f,l,o,i,a]);return{qrcode:f,margin:p,cells:u,numCells:g,calculatedImageSettings:b}}var Qee=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Fh=wn.forwardRef(function(n,t){const i=n,{value:a,size:o=yA,level:l=xA,bgColor:d=bA,fgColor:f=vA,includeMargin:u=wA,minVersion:p=SA,boostLevel:g,marginSize:b,imageSettings:v}=i,k=Q1(i,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,P=Q1(k,["style"]),M=v==null?void 0:v.src,I=wn.useRef(null),U=wn.useRef(null),L=wn.useCallback(te=>{I.current=te,typeof t=="function"?t(te):t&&(t.current=te)},[t]),[F,z]=wn.useState(!1),{margin:$,cells:B,numCells:R,calculatedImageSettings:V}=jA({value:a,level:l,minVersion:p,boostLevel:g,includeMargin:u,marginSize:b,imageSettings:v,size:o});wn.useEffect(()=>{if(I.current!=null){const te=I.current,W=te.getContext("2d");if(!W)return;let H=B;const Q=U.current,J=V!=null&&Q!==null&&Q.complete&&Q.naturalHeight!==0&&Q.naturalWidth!==0;J&&V.excavation!=null&&(H=CA(B,V.excavation));const fe=window.devicePixelRatio||1;te.height=te.width=o*fe;const A=o/R*fe;W.scale(A,A),W.fillStyle=d,W.fillRect(0,0,R,R),W.fillStyle=f,Qee?W.fill(new Path2D(NA(H,$))):B.forEach(function(oe,ue){oe.forEach(function(D,se){D&&W.fillRect(se+$,ue+$,1,1)})}),V&&(W.globalAlpha=V.opacity),J&&W.drawImage(Q,V.x+$,V.y+$,V.w,V.h)}}),wn.useEffect(()=>{z(!1)},[M]);const Y=W1({height:o,width:o},T);let ie=null;return M!=null&&(ie=wn.createElement("img",{src:M,key:M,style:{display:"none"},onLoad:()=>{z(!0)},ref:U,crossOrigin:V==null?void 0:V.crossOrigin})),wn.createElement(wn.Fragment,null,wn.createElement("canvas",W1({style:Y,height:o,width:o,ref:L,role:"img"},P)),ie)});Fh.displayName="QRCodeCanvas";var Jee=wn.forwardRef(function(n,t){const i=n,{value:a,size:o=yA,level:l=xA,bgColor:d=bA,fgColor:f=vA,includeMargin:u=wA,minVersion:p=SA,boostLevel:g,title:b,marginSize:v,imageSettings:S}=i,k=Q1(i,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:P,numCells:M,calculatedImageSettings:I}=jA({value:a,level:l,minVersion:p,boostLevel:g,includeMargin:u,marginSize:v,imageSettings:S,size:o});let U=P,L=null;S!=null&&I!=null&&(I.excavation!=null&&(U=CA(P,I.excavation)),L=wn.createElement("image",{href:S.src,height:I.h,width:I.w,x:I.x+T,y:I.y+T,preserveAspectRatio:"none",opacity:I.opacity,crossOrigin:I.crossOrigin}));const F=NA(U,T);return wn.createElement("svg",W1({height:o,width:o,viewBox:`0 0 ${M} ${M}`,ref:t,role:"img"},k),!!b&&wn.createElement("title",null,b),wn.createElement("path",{fill:d,d:`M0,0 h${M}v${M}H0z`,shapeRendering:"crispEdges"}),wn.createElement("path",{fill:f,d:F,shapeRendering:"crispEdges"}),L)});Jee.displayName="QRCodeSVG";const Kee=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},Xee=()=>{const{orderId:e}=Qr(),n=kt(),[t,i]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,P]=w.useState("cash"),M=w.useMemo(()=>(t==null?void 0:t.medications.reduce((V,Y)=>{const ie=Y.total_price??0,te=ie*(Y.discount_percentage??0)/100;return V+ie-te},0))??0,[t==null?void 0:t.medications]),I=5,U=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce((V,Y,ie)=>{var fe,A;const te=Y.drug_id??`index-${ie}`,W=((fe=p[te])==null?void 0:fe.pack)||0,H=((A=p[te])==null?void 0:A.loose)||0,Q=Y.pack_price??0,J=Y.loose_price??0;return V+W*Q+H*J},0),[t,p]),L=w.useCallback(async()=>{if(!e){d("Order ID is missing."),o(!1);return}o(!0),d(null);try{const V=await pe(`/api/pharmacy-orders/${e}`);if(!V.ok)throw V.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${V.statusText} (${V.status})`);const Y=await V.json();console.log("Fetched order data after return:",Y);const te=Y.medications.map(H=>H.pack_price&&H.loose_price&&H.loose_price>0?{...H,unitsPerPack:Math.round(H.pack_price/H.loose_price)}:{...H,unitsPerPack:0}).map(H=>({...H,discount_percentage:H.discount_percentage??0}));i({...Y,medications:te});const W={};te.forEach((H,Q)=>{const J=H.drug_id??`index-${Q}`;W[J]={pack:0,loose:0}}),g(W)}catch(V){console.error("Failed to fetch order details:",V),d(V.message||"Failed to load order details.")}finally{o(!1)}},[e]);w.useEffect(()=>{L()},[L]),w.useEffect(()=>{(async()=>{try{const Y=await pe("/api/clinics/settings");if(!Y.ok)throw new Error("Failed to fetch clinic settings");const ie=await Y.json();console.log("Fetched clinic settings:",ie),v(ie.upi_id||"")}catch(Y){console.error("Error fetching clinic settings:",Y)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const V=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k(V)}else k("")},[t==null?void 0:t.order_total,b]);const F=(V,Y)=>{i(ie=>{if(!ie)return null;const te=ie.medications.map((H,Q)=>(H.drug_id??`index-${Q}`)===V?{...H,discount_percentage:isNaN(Y)?0:Y}:H),W=te.reduce((H,Q)=>{const J=Q.total_price??0,fe=J*(Q.discount_percentage??0)/100;return H+J-fe},0);return{...ie,medications:te,order_total:W}})},z=(V,Y,ie)=>{g(te=>{const W=ie.unitsPerPack||0,Q=ie.pack_quantity*W+ie.loose_quantity,J=Math.max(0,Math.min(Y,Q));let fe=0,A=J;return W>0&&(fe=Math.floor(J/W),A=J%W),{...te,[V]:{pack:fe,loose:A}}})},$=async()=>{const V=t==null?void 0:t.medications.map((Y,ie)=>{var Q,J;const te=Y.drug_id??`index-${ie}`,W=((Q=p[te])==null?void 0:Q.pack)||0,H=((J=p[te])==null?void 0:J.loose)||0;return W>0||H>0?{drug_id:Y.drug_id,name:Y.name,pack_quantity:Y.pack_quantity,loose_quantity:Y.loose_quantity,returnPackQuantity:W,returnLooseQuantity:H}:null}).filter(Y=>Y!==null);if(!V||V.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!V){alert("Could not prepare items for return.");return}u(!0),d(null);try{const Y=await pe(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:V})}),ie=await Y.json();if(!Y.ok)throw new Error(ie.message||`Failed to process return: ${Y.statusText}`);alert("Return processed successfully! Stock has been updated.");const te={};t==null||t.medications.forEach((W,H)=>{const Q=W.drug_id??`index-${H}`;te[Q]={pack:0,loose:0}}),g(te),L()}catch(Y){console.error("Failed to process return:",Y),d(Y.message||"An error occurred while processing the return."),alert(`Error processing return: ${Y.message||"Unknown error"}`)}finally{u(!1)}};if(a)return r.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return r.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[r.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[r.jsx(nn,{size:14,className:"mr-1.5"})," Back"]}),r.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return r.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[r.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[r.jsx(nn,{size:14,className:"mr-1.5"})," Back"]}),r.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const B=()=>{window.print()},R=Kee(t.status);return r.jsx("div",{className:"pharmacy-order-details-page",children:r.jsxs("div",{className:"order-details-container printable-section",children:[r.jsxs("div",{className:"order-details-header no-print",children:[r.jsx("h1",{children:"Pharmacy Order Details"}),r.jsxs("div",{className:"actions",children:[r.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[r.jsx(nn,{size:18})," Back to Queue"]}),r.jsxs("button",{onClick:B,className:"print-button",children:[r.jsx(Kc,{size:18})," Print Bill"]})]})]}),r.jsxs("div",{className:"billing-header print-only",children:[r.jsx("div",{className:"clinic-header-left",children:r.jsx("div",{className:"clinic-info-print",children:r.jsxs("div",{className:"clinic-name-and-details-print",children:[r.jsx("h1",{children:"Mahajan Pharmacy"}),r.jsxs("div",{className:"clinic-details-print",children:[r.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),r.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),r.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),r.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[r.jsxs("div",{className:"info-item",children:[r.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),r.jsxs("div",{className:"info-item",children:[r.jsx("strong",{children:"Token:"})," 12"]}),r.jsxs("div",{className:"info-item",children:[r.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),r.jsxs("div",{className:"order-info-section no-print",children:[r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Order ID:"})," ",t.id]}),r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Status:"})," ",r.jsx("span",{className:`status-pill ${R.text} ${R.bg}`,children:t.status})]})]}),r.jsxs("div",{className:"medications-section",children:[r.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?r.jsxs("table",{className:"medications-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"DESCRIPTION"}),r.jsx("th",{children:"PACK QTY"}),r.jsx("th",{children:"PACK PRICE"}),r.jsx("th",{children:"LOOSE QTY"}),r.jsx("th",{children:"LOOSE PRICE"}),r.jsx("th",{children:"MRP"}),r.jsx("th",{children:"RATE"}),r.jsx("th",{children:"DIS %"}),r.jsx("th",{children:"GST%"}),r.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&r.jsxs(r.Fragment,{children:[r.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),r.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),r.jsx("tbody",{children:t.medications.map((V,Y)=>{var fe,A,oe,ue,D,se;const ie=V.drug_id??`index-${Y}`,te=V.total_price??0,W=te*(V.discount_percentage??0)/100,H=te-W,Q=((fe=p[ie])==null?void 0:fe.pack)||0,J=((A=p[ie])==null?void 0:A.loose)||0;return r.jsxs("tr",{children:[r.jsx("td",{children:V.name}),r.jsx("td",{children:V.pack_quantity??0}),r.jsx("td",{children:((oe=V.pack_price)==null?void 0:oe.toFixed(2))??"N/A"}),r.jsx("td",{children:V.loose_quantity??0}),r.jsx("td",{children:((ue=V.loose_price)==null?void 0:ue.toFixed(2))??"N/A"}),r.jsx("td",{children:((D=V.price)==null?void 0:D.toFixed(2))??"N/A"})," ",r.jsx("td",{children:((se=V.price)==null?void 0:se.toFixed(2))??"N/A"})," ",r.jsxs("td",{children:[r.jsx("input",{type:"number",value:V.discount_percentage??0,onChange:be=>F(ie,parseFloat(be.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),r.jsxs("span",{className:"print-only",children:[V.discount_percentage??0,"%"]})]}),r.jsxs("td",{children:[I.toFixed(1),"%"]}),r.jsx("td",{children:H.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"no-print",children:r.jsx("input",{type:"number",min:"0",max:V.pack_quantity,value:Q,onChange:be=>{const ce=(parseInt(be.target.value,10)||0)*(V.unitsPerPack||0)+J;z(ie,ce,V)},className:"return-quantity-input"})}),r.jsx("td",{className:"no-print",children:r.jsx("input",{type:"number",min:"0",max:V.loose_quantity+V.pack_quantity*(V.unitsPerPack||0)-Q*(V.unitsPerPack||0),value:J,onChange:be=>{const ee=parseInt(be.target.value,10)||0,ce=Q*(V.unitsPerPack||0)+ee;z(ie,ce,V)},className:"return-quantity-input"})})]})]},ie)})})]}):r.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),r.jsx("div",{className:"print-only-total",children:r.jsxs("strong",{children:["Grand Total: ",M.toFixed(2)]})}),r.jsxs("div",{className:"order-total-section no-print",children:[r.jsx("span",{className:"total-label",children:"Order Total:"}),r.jsxs("span",{className:"total-amount",children:["",M.toFixed(2)]})]}),r.jsxs("div",{className:"payment-section no-print",children:[r.jsxs("div",{className:"payment-mode-group",children:[r.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),r.jsxs("select",{id:"paymentMode",value:T,onChange:V=>P(V.target.value),className:"payment-mode-select",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),r.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&r.jsxs("div",{className:"qr-code-container",children:[r.jsx(Fh,{value:S,size:128}),r.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&r.jsxs("div",{className:"return-action-section no-print",children:[U>0&&r.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",U.toFixed(2)]}),r.jsx("button",{onClick:$,disabled:Object.values(p).every(V=>V.pack===0&&V.loose===0)||f,className:"process-return-button",children:f?r.jsxs(r.Fragment,{children:[r.jsx(Jx,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Jx,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},Zee=async()=>{const e=await pe("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},ete=async e=>{const n=await pe(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},tte=async e=>{const n=await pe("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},nte=async(e,n)=>{const t=await pe(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const i=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(i.message||"Failed to update subscription plan")}return await t.json()},ite=async e=>{const n=await pe(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},rte=async(e,n)=>{const t=await pe("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const i=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(i.message||"Failed to initiate Razorpay subscription")}return await t.json()},ate=()=>{const e=kt(),[n,t]=w.useState([]),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await Zee();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const p=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await ite(g),f({type:"success",message:"Plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return r.jsxs("div",{className:"subscription-page-container",children:[d&&r.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[d.type==="success"?r.jsx(fs,{size:18,className:"mr-2 text-green-500"}):r.jsx(Ki,{size:18,className:"mr-2 text-red-500"}),r.jsx("span",{children:d.message})]}),r.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:r.jsx(ni,{size:16})})]}),r.jsxs("div",{children:[" ",r.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[r.jsx(nn,{size:16}),"Back"]}),r.jsx("h1",{children:"Manage Subscription Plans"}),r.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[r.jsx(Zc,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),i&&n.length===0&&r.jsx("div",{className:"flex items-center justify-center p-8",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:r.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),r.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!i&&o&&n.length===0&&r.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"subscription-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Price"}),r.jsx("th",{children:"Billing Cycle"}),r.jsx("th",{children:"Status"}),r.jsx("th",{className:"text-right",children:"Actions"})]})}),r.jsx("tbody",{children:n.map(g=>r.jsxs("tr",{children:[r.jsx("td",{children:g.name}),r.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),r.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),r.jsx("td",{children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),r.jsxs("td",{className:"actions-cell text-right",children:[r.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:r.jsx(eu,{size:16,className:"inline-block"})}),g.status==="active"&&r.jsx("button",{onClick:()=>p(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:i,children:r.jsx(lr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!i&&n.length===0&&!o&&r.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},ste=()=>{const e=kt(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},p=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await tte(n),f({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return r.jsxs("div",{className:"subscription-page-container",children:[d&&r.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[d.type==="success"?r.jsx(fs,{size:18,className:"mr-2 text-green-500"}):r.jsx(Ki,{size:18,className:"mr-2 text-red-500"}),r.jsx("span",{children:d.message})]}),r.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:r.jsx(ni,{size:16})})]}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h1",{children:"Add New Subscription Plan"}),o&&r.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),r.jsxs("form",{onSubmit:p,children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Plan Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price (INR) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"period",children:["Billing Period ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"}),r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"yearly",children:"Yearly"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"interval",children:["Interval ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),r.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),r.jsxs("button",{type:"submit",disabled:i,className:"subscription-btn",children:[i?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,i?"Creating...":"Create Plan"]})]})]})]})]})},ote=()=>{const{id:e}=Qr(),n=kt(),[t,i]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await ete(e);i(M),o({name:M.name,description:M.description||"",price:M.price,period:M.period,interval:M.interval,razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:I,value:U}=M.target;o(L=>({...L,[I]:U}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await nte(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const U=I.message||"Failed to update plan.";g(U),v({type:"error",message:U})}finally{d(!1)}},P=()=>{n(-1)};return f?r.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):p&&!t?r.jsx("div",{className:"p-6 text-center text-red-500",children:p}):t?r.jsxs("div",{className:"subscription-page-container",children:[b&&r.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[b.type==="success"?r.jsx(fs,{size:18,className:"mr-2"}):r.jsx(Ki,{size:18,className:"mr-2"}),r.jsx("span",{children:b.message})]}),r.jsx("button",{onClick:()=>v(null),className:"ml-4",children:r.jsx(ni,{size:16})})]}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h1",{children:"Edit Subscription Plan"}),p&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:p}),r.jsxs("form",{onSubmit:T,children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Plan Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price (INR) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"period",children:["Billing Period ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"}),r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"yearly",children:"Yearly"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"interval",children:["Interval ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),r.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Status"}),r.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),r.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):r.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},lte=()=>{const{patientId:e}=Qr(),n=kt(),[t,i]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=w.useCallback(async()=>{u(!0),g(null);try{const L=await pe(`/api/patients/${e}`);if(!L.ok){const B=await L.json();throw new Error(B.message||"Failed to fetch patient details")}const F=await L.json();i(F);const z=await pe("/api/subscriptions");if(!z.ok){const B=await z.json();throw new Error(B.message||"Failed to fetch subscription plans")}const $=await z.json();o($.filter(B=>B.status==="active"))}catch(L){console.error("Error fetching data:",L),g(`Failed to load data: ${L.message}`)}finally{u(!1)}},[e]);w.useEffect(()=>{e?M():(g("Patient ID is missing."),u(!1))},[e,M]);const I=(L,F)=>{const z=new Date(L),$=F.interval||1;switch(F.period){case"daily":z.setDate(L.getDate()+$);break;case"weekly":z.setDate(L.getDate()+$*7);break;case"monthly":z.setMonth(L.getMonth()+$);break;case"yearly":z.setFullYear(L.getFullYear()+$);break;default:console.warn(`Unknown subscription period: ${F.period}. Defaulting to 1 month.`),z.setMonth(L.getMonth()+1)}return z},U=async()=>{if(!e||!l){P("Please select a subscription plan.");return}const L=a.find(F=>F.id===l);if(!L){P("Selected plan details not found.");return}k(!0),P(null);try{const F=new Date,z=I(F,L);if(b==="manual"){const $={subscription_plan_id:l,subscription_status:"active",subscription_start_date:F.toISOString(),subscription_end_date:z.toISOString(),subscription_payment_method:"manual"},B=await pe(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!B.ok){const R=await B.json();throw new Error(R.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",L);const $=await rte(e,l);if($&&$.short_url)window.location.href=$.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch(F){console.error("Error starting subscription:",F),P(`Failed to start subscription: ${F.message}`),k(!1)}};return f?r.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):p?r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:p})]}),r.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[r.jsx(nn,{size:16})," ","Back"]})]}):t?r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[r.jsx(nn,{size:16})," ","Back"]}),r.jsxs("h1",{children:[r.jsx(tu,{size:28})," ","Start Subscription for ",t.name]}),T&&r.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",r.jsx("span",{children:T})]}),r.jsxs("div",{className:"subscription-form",children:[" ",r.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?r.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):r.jsx("div",{className:"subscription-plan-list",children:a.map(L=>r.jsxs("div",{className:`subscription-plan-card ${l===L.id?"selected-plan":""}`,onClick:()=>d(L.id),children:[r.jsx("h3",{children:L.name}),r.jsxs("p",{className:"price",children:["",L.price]}),r.jsxs("p",{className:"duration",children:["Every ",L.interval," ",L.period,L.interval>1?"s":""]}),L.description&&r.jsx("p",{children:L.description})]},L.id))})]}),r.jsxs("div",{className:"subscription-form mb-6",children:[" ",r.jsx("h2",{children:"Select Payment Method"}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),r.jsx("span",{children:"Cash (Manual)"})]})}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),r.jsx("span",{children:"Razorpay"})]})})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{onClick:U,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[r.jsx("strong",{children:"Warning: "}),r.jsx("span",{children:"Patient not found."})]}),r.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[r.jsx(nn,{size:16}),"Back"]})]})},iS=async()=>{const e=await pe("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},cte=async e=>{const n=await pe(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},ute=async e=>{const n=await pe(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},dte=async e=>{const n=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},fte=async e=>{const n=await pe("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},hte=async(e,n)=>{const t=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const i=await t.json();throw new Error(i.message||"Failed to update clinic subscription plan")}return t.json()},pte=async e=>{const n=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},mte=async e=>{const n=await pe("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},gte=async()=>{try{const e=await pe("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},yte=async()=>{const e=await pe("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()},xte=()=>{const e=kt(),[n,t]=w.useState([]),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await iS();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const p=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await pte(g),f({type:"success",message:"Clinic plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate clinic plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return r.jsxs("div",{className:"subscription-page-container",children:[d&&r.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[d.type==="success"?r.jsx(fs,{size:18,className:"mr-2 text-green-500"}):r.jsx(Ki,{size:18,className:"mr-2 text-red-500"}),r.jsx("span",{children:d.message})]}),r.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:r.jsx(ni,{size:16})})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:r.jsx(nn,{size:20})}),r.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),r.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[r.jsx(Zc,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),i&&n.length===0&&r.jsx("div",{className:"flex items-center justify-center p-8",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:r.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),r.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!i&&o&&n.length===0&&r.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"subscription-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Price"}),r.jsx("th",{children:"Billing Cycle"}),r.jsx("th",{children:"Status"}),r.jsx("th",{className:"text-right",children:"Actions"})]})}),r.jsx("tbody",{children:n.map(g=>r.jsxs("tr",{children:[r.jsx("td",{children:g.name}),r.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),r.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),r.jsx("td",{children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),r.jsxs("td",{className:"actions-cell text-right",children:[r.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:r.jsx(eu,{size:16,className:"inline-block"})}),g.status==="active"&&r.jsx("button",{onClick:()=>p(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:i,children:r.jsx(lr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!i&&n.length===0&&!o&&r.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},bte=()=>{const e=kt(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(S):S}))},p=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await fte(n),f({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return r.jsxs("div",{className:"subscription-page-container",children:[d&&r.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[d.type==="success"?r.jsx(fs,{size:18,className:"mr-2 text-green-500"}):r.jsx(Ki,{size:18,className:"mr-2 text-red-500"}),r.jsx("span",{children:d.message})]}),r.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:r.jsx(ni,{size:16})})]}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h1",{children:"Add New Clinic Subscription Plan"}),o&&r.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),r.jsxs("form",{onSubmit:p,children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Plan Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price (INR) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"period",children:["Billing Period ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"}),r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"yearly",children:"Yearly"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"interval",children:["Interval ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),r.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),r.jsxs("button",{type:"submit",disabled:i,className:"subscription-btn",children:[i?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,i?"Creating...":"Create Plan"]})]})]})]})]})},vte=()=>{const{id:e}=Qr(),n=kt(),[t,i]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await dte(e);i(M),o({name:M.name,description:M.description||"",price:Number(M.price),period:M.period,interval:Number(M.interval),razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch clinic plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:I,value:U,type:L}=M.target;o(F=>({...F,[I]:L==="number"?parseFloat(U):U}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await hte(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const U=I.message||"Failed to update clinic plan.";g(U),v({type:"error",message:U})}finally{d(!1)}},P=()=>{n(-1)};return f?r.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):p&&!t?r.jsx("div",{className:"p-6 text-center text-red-500",children:p}):t?r.jsxs("div",{className:"subscription-page-container",children:[b&&r.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[b.type==="success"?r.jsx(fs,{size:18,className:"mr-2"}):r.jsx(Ki,{size:18,className:"mr-2"}),r.jsx("span",{children:b.message})]}),r.jsx("button",{onClick:()=>v(null),className:"ml-4",children:r.jsx(ni,{size:16})})]}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h1",{children:"Edit Clinic Subscription Plan"}),p&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:p}),r.jsxs("form",{onSubmit:T,children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Plan Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price (INR) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"period",children:["Billing Period ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"}),r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"yearly",children:"Yearly"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"interval",children:["Interval ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),r.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Status"}),r.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),r.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):r.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},wte=()=>{const e=kt(),[n,t]=w.useState([]),[i,a]=w.useState(""),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,p]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{f(null);try{const T=(await iS()).filter(P=>P.status==="active");t(T),T.length>0&&!i&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),f(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const T=await gte();if(T&&T.short_url){window.location.href=T.short_url,f("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),f(`An unexpected error occurred: ${T.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!i){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===i);if(!k){b("Selected plan details not found.");return}p(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await mte(i);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),p(!1)}};return o?r.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):d?r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:d})]}),r.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[r.jsx(nn,{size:16}),"Back"]})]}):r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[r.jsx(nn,{size:16}),"Back"]}),r.jsxs("h1",{children:[r.jsx(hI,{size:28}),"Buy Pro Plan for Clinic"]}),g&&r.jsx("div",{className:"error-alert-subscription",role:"alert",children:r.jsx("span",{children:g})}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h2",{children:"Available Pro Plans"}),n.length===0?r.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):r.jsx("div",{className:"subscription-plan-list",children:n.map(k=>r.jsxs("div",{className:`subscription-plan-card ${i===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[r.jsx("h3",{children:k.name}),r.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),r.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&r.jsx("p",{children:k.description})]},k.id))})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{onClick:S,disabled:!i||u||n.length===0,className:"subscription-btn",children:[u&&r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),u?"Initiating Payment...":"Buy Pro Plan"]})})]})},Ste=()=>{const e=kt(),[n,t]=w.useState([]),[i,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[P,M]=w.useState(""),[I,U]=w.useState(""),[L,F]=w.useState({}),[z,$]=w.useState(!1),[B,R]=w.useState(null),[V,Y]=w.useState([]),[ie,te]=w.useState(""),[W,H]=w.useState(!1),[Q,J]=w.useState(null);w.useEffect(()=>{const re=setTimeout(()=>{U(P)},500);return()=>{clearTimeout(re)}},[P]),w.useEffect(()=>{fe(I)},[I]);const fe=async(re="")=>{a(!0);try{const Pe=re?`/api/users?search=${encodeURIComponent(re)}`:"/api/users",Se=await(await pe(Pe)).json();if(t(Se),Se.length>0){const Ne=[...new Set(Se.map(Me=>Me.clinic_id).filter(Me=>!!Me))],De={};await Promise.all(Ne.map(async Me=>{try{const nt=await ute(Me);De[Me]=nt}catch(nt){console.error(`Failed to fetch subscription status for clinic ${Me}`,nt),De[Me]={hasProPlan:!1}}})),F(De)}l(null)}catch(Pe){l("Failed to fetch users."),console.error(Pe)}finally{a(!1)}},A=async re=>{re.preventDefault();try{await pe("/users",{method:"POST",body:JSON.stringify(v)}),f(!1),S({name:"",email:"",password:"",role:"user"}),fe()}catch(Pe){l("Failed to add user."),console.error(Pe)}},oe=async re=>{if(re.preventDefault(),!g)return;const{password:Pe,confirmPassword:Qe,...Se}=k,Ne={...Se};if(Pe){if(Pe.length<6){l("Password must be at least 6 characters long.");return}if(Pe!==Qe){l("Passwords do not match.");return}Ne.password=Pe}try{await pe(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Ne)}),p(!1),b(null),T({...k,password:"",confirmPassword:""}),fe()}catch(De){l("Failed to update user."),console.error(De)}},ue=async re=>{if(window.confirm("Are you sure you want to delete this user?"))try{await pe(`/users/${re}`,{method:"DELETE"}),fe()}catch(Pe){l("Failed to delete user."),console.error(Pe)}},D=re=>{b(re),T({name:re.name,email:re.email,role:re.role,password:"",confirmPassword:""}),p(!0)},se=async()=>{H(!0);try{const re=await iS();Y(re),re.length>0&&te(re[0].id),J(null)}catch(re){J("Failed to fetch subscription plans."),console.error(re)}finally{H(!1)}},be=re=>{R(re),$(!0),se()},ee=async re=>{if(re.preventDefault(),!B||!ie){l("Please select a clinic and a plan.");return}try{await pe("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:B,planId:ie})}),$(!1),R(null),te(""),fe(),l(null)}catch(Pe){l("Failed to manually activate clinic subscription."),console.error(Pe)}},ce=async re=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await cte(re),fe(),l(null)}catch(Pe){l("Failed to cancel subscription."),console.error(Pe)}};return i?r.jsx("div",{children:"Loading users..."}):o?r.jsx("div",{className:"error-message",children:o}):r.jsxs("div",{className:"user-management-page",children:[r.jsxs("div",{className:"user-management-header",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[r.jsx(nn,{size:16}),"Back"]}),r.jsx("h1",{children:"User Management"})]}),r.jsxs("div",{className:"controls-container",children:[r.jsx("input",{type:"text",placeholder:"Search by name or email...",value:P,onChange:re=>M(re.target.value),className:"search-input"}),r.jsx("button",{onClick:()=>f(!0),className:"add-user-button",children:"Add New User"})]}),d&&r.jsx("div",{className:"modal",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-button",onClick:()=>f(!1),children:""}),r.jsx("h2",{children:"Add New User"}),r.jsxs("form",{onSubmit:A,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Name:"}),r.jsx("input",{type:"text",value:v.name,onChange:re=>S({...v,name:re.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email:"}),r.jsx("input",{type:"email",value:v.email,onChange:re=>S({...v,email:re.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Password:"}),r.jsx("input",{type:"password",value:v.password,onChange:re=>S({...v,password:re.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Role:"}),r.jsxs("select",{value:v.role,onChange:re=>S({...v,role:re.target.value}),children:[r.jsx("option",{value:"user",children:"User"}),r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),r.jsx("button",{type:"submit",children:"Add User"})]})]})}),u&&g&&r.jsx("div",{className:"modal",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-button",onClick:()=>p(!1),children:""}),r.jsx("h2",{children:"Edit User"}),r.jsxs("form",{onSubmit:oe,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Name:"}),r.jsx("input",{type:"text",value:k.name,onChange:re=>T({...k,name:re.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email:"}),r.jsx("input",{type:"email",value:k.email,onChange:re=>T({...k,email:re.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Role:"}),r.jsxs("select",{value:k.role,onChange:re=>T({...k,role:re.target.value}),children:[r.jsx("option",{value:"user",children:"User"}),r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"New Password (optional):"}),r.jsx("input",{type:"password",value:k.password,onChange:re=>T({...k,password:re.target.value})})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Confirm New Password:"}),r.jsx("input",{type:"password",value:k.confirmPassword,onChange:re=>T({...k,confirmPassword:re.target.value})})]}),r.jsx("button",{type:"submit",children:"Update User"})]})]})}),z&&r.jsx("div",{className:"modal",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-button",onClick:()=>$(!1),children:""}),r.jsx("h2",{children:"Select Subscription Plan for Clinic"}),W&&r.jsx("div",{children:"Loading plans..."}),Q&&r.jsx("div",{className:"error-message",children:Q}),!W&&!Q&&V.length===0&&r.jsx("div",{children:"No active subscription plans available."}),!W&&!Q&&V.length>0&&r.jsxs("form",{onSubmit:ee,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Select Plan:"}),r.jsx("select",{value:ie,onChange:re=>te(re.target.value),required:!0,children:V.map(re=>r.jsxs("option",{value:re.id,children:[re.name," - $",re.price,"/",re.interval," ",re.period]},re.id))})]}),r.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),r.jsxs("table",{className:"user-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Role"}),r.jsx("th",{children:"Clinic ID"}),r.jsx("th",{children:"Subscription Status"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:n.map(re=>{const Pe=re.clinic_id||"N/A",Qe=Pe!=="N/A"?L[Pe]:null,Se=(Qe==null?void 0:Qe.hasProPlan)??!1,Ne=Se?"PRO":"Standard";return r.jsxs("tr",{children:[r.jsx("td",{children:re.name}),r.jsx("td",{children:re.email}),r.jsx("td",{children:re.role}),r.jsx("td",{children:Pe}),r.jsx("td",{children:Pe!=="N/A"?r.jsx("span",{className:Se?"pro-badge":"standard-badge",children:Ne}):"N/A"}),r.jsxs("td",{children:[r.jsx("button",{onClick:()=>D(re),className:"edit-button",children:"Edit"}),r.jsx("button",{onClick:()=>ue(re.id),className:"delete-button",children:"Delete"}),re.clinic_id&&!Se&&r.jsx("button",{onClick:()=>be(re.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),re.clinic_id&&Se&&r.jsx("button",{onClick:()=>ce(re.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},re.id)})})]})]})},Nte="_modalOverlay_1spz3_3",Cte="_modalContent_1spz3_29",jte="_modalHeader_1spz3_53",_te="_modalTitle_1spz3_71",kte="_modalCloseButton_1spz3_83",Tte="_modalBody_1spz3_111",Ete="_formGroup_1spz3_119",Ate="_inputField_1spz3_141",Pte="_errorText_1spz3_175",Dte="_successText_1spz3_193",Ite="_modalFooter_1spz3_211",Rte="_button_1spz3_227",Mte="_buttonPrimary_1spz3_247",Ote="_buttonSecondary_1spz3_265",Yr={modalOverlay:Nte,modalContent:Cte,modalHeader:jte,modalTitle:_te,modalCloseButton:kte,modalBody:Tte,formGroup:Ete,inputField:Ate,errorText:Pte,successText:Dte,modalFooter:Ite,button:Rte,buttonPrimary:Mte,buttonSecondary:Ote},Lte=({isOpen:e,onClose:n})=>{const[t,i]=w.useState(""),[a,o]=w.useState(!1),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(null);w.useEffect(()=>{e&&b()},[e]);const b=async()=>{o(!0),u(null);try{const S=await pe("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();i(k.value||"")}else S.status}catch(S){console.warn("Could not fetch existing key:",S)}finally{o(!1)}},v=async()=>{d(!0),u(null),g(null);try{if(!(await pe("/api/global-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"app_gemini_api_key",value:t})})).ok)throw new Error("Failed to save API Key");g("API Key updated successfully!"),setTimeout(()=>{n(),g(null)},1500)}catch(S){u(S.message||"Error saving key")}finally{d(!1)}};return e?r.jsx("div",{className:Yr.modalOverlay,children:r.jsxs("div",{className:Yr.modalContent,children:[r.jsxs("div",{className:Yr.modalHeader,children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[r.jsx(ik,{size:24}),r.jsx("h3",{className:Yr.modalTitle,children:"App Gemini API Key"})]}),r.jsx("button",{onClick:n,className:Yr.modalCloseButton,children:r.jsx(ni,{size:20})})]}),r.jsxs("div",{className:Yr.modalBody,children:[f&&r.jsx("div",{className:Yr.errorText,children:f}),p&&r.jsx("div",{className:Yr.successText,children:p}),r.jsxs("div",{className:Yr.formGroup,children:[r.jsx("label",{htmlFor:"gemini-key",children:"Gemini API Key"}),r.jsx("input",{type:"text",id:"gemini-key",value:t,onChange:S=>i(S.target.value),className:Yr.inputField,placeholder:"Enter Gemini API Key (AIza...)",disabled:a||l})]}),r.jsx("p",{style:{fontSize:"0.9em",color:"var(--secondary-text-color, #666)"},children:"This key will be used as a fallback for all clinics if their specific Gemini API key is not configured."})]}),r.jsxs("div",{className:Yr.modalFooter,children:[r.jsx("button",{onClick:n,className:`${Yr.button} ${Yr.buttonSecondary}`,disabled:l,children:"Cancel"}),r.jsx("button",{onClick:v,className:`${Yr.button} ${Yr.buttonPrimary}`,disabled:l,children:l?"Saving...":"Save Key"})]})]})}):null},Fte=()=>{const[e,n]=w.useState(!1);return r.jsxs("div",{className:"admin-panel-container",children:[r.jsxs("h1",{className:"admin-panel-title",children:[r.jsx(Sb,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),r.jsxs("div",{className:"admin-panel-grid",children:[r.jsxs(ds,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[r.jsx(Dh,{size:48,className:"card-icon"}),r.jsx("h2",{children:"Manage Clinic Subscription Plans"}),r.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),r.jsxs(ds,{to:"/dashboard/users",className:"admin-panel-card",children:[r.jsx(rg,{size:48,className:"card-icon"}),r.jsx("h2",{children:"User Management"}),r.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),r.jsxs("div",{className:"admin-panel-card",onClick:()=>n(!0),style:{cursor:"pointer"},children:[r.jsx(ik,{size:48,className:"card-icon"}),r.jsx("h2",{children:"Manage App Gemini API Key"}),r.jsx("p",{children:"Update the fallback Gemini API key used by the application."})]})]}),r.jsx(Lte,{isOpen:e,onClose:()=>n(!1)})]})},Mm="tutorialCurrentStep",_A=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[i,a]=w.useState(""),[o,l]=w.useState(""),[d,f]=w.useState(""),[u,p]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!i||!o||!d){e(!1,"Please fill all fields.");return}p(!0);try{const v=await pe("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:i,email:o,role:g,password:d})});if(v.ok)e(!0,`Successfully added "${i}" as a ${g}!`),a(""),l(""),f(""),n&&n(g);else{const S=await v.json();e(!1,`Failed to add staff: ${S.message||v.statusText}`)}}catch(v){console.error("Error adding staff:",v),e(!1,`Error adding staff: ${v instanceof Error?v.message:String(v)}`)}finally{p(!1)}};return r.jsxs("div",{className:"tutorial-interactive-component",children:[r.jsx("h3",{children:"Add a New Staff Member"}),r.jsx("input",{type:"text",placeholder:"Staff Name",value:i,onChange:v=>a(v.target.value),className:"tutorial-input",disabled:u}),r.jsx("input",{type:"email",placeholder:"Email",value:o,onChange:v=>l(v.target.value),className:"tutorial-input",disabled:u}),r.jsx("input",{type:"password",placeholder:"Password",value:d,onChange:v=>f(v.target.value),className:"tutorial-input",disabled:u}),r.jsx("input",{type:"text",placeholder:"Role",value:g==="lab"?"Lab Technician":g==="pharmacy"?"Pharmacist":"Receptionist",className:"tutorial-input",disabled:!0}),r.jsx("button",{onClick:b,className:"tutorial-button primary",disabled:u,children:u?"Adding...":"Add Staff"})]})},$te=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[i,a]=w.useState([]),[o,l]=w.useState(!1),d=async()=>{t(!0);try{const f=await pe("/api/drugs/import-defaults",{method:"POST"});if(f.ok){const u=await f.json(),p=u.drugs?u.drugs.map(g=>g.name):[];a(p),l(!0),e(!0,`Default medications imported: Added ${u.details.added}, Updated ${u.details.updated}.`,"pharmacyImport")}else{const u=await f.json();e(!1,`Failed to import default medications: ${u.message||f.statusText}`)}}catch(f){console.error("Error importing default medications:",f),e(!1,`Error importing default medications: ${f instanceof Error?f.message:String(f)}`)}finally{t(!1)}};return r.jsxs("div",{className:"tutorial-interactive-component",children:[r.jsx("h3",{children:"Import Default Medications"}),r.jsx("p",{children:"Click the button below to populate your pharmacy inventory with a list of common medications."}),r.jsx("button",{onClick:d,className:"tutorial-button primary",disabled:n,children:n?"Importing...":r.jsxs(r.Fragment,{children:[" ",r.jsx("i",{className:"fas fa-pills"})," Import Default Drugs"]})}),o&&i.length>0&&r.jsxs("div",{className:"imported-drugs-list",children:[r.jsx("h4",{children:"Medications Imported:"}),r.jsx("ul",{children:i.map((f,u)=>r.jsx("li",{children:f},u))})]})]})},zte=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[i,a]=w.useState([]),[o,l]=w.useState(!1),d=async()=>{t(!0);try{const f=await pe("/api/lab-tests/import-defaults",{method:"POST"});if(f.ok){const u=await f.json(),p=u.tests?u.tests.map(g=>g.name):[];a(p),l(!0),e(!0,`Default lab tests imported: Added ${u.details.added}, Updated ${u.details.updated}.`,"labImport")}else{const u=await f.json();e(!1,`Failed to import default lab tests: ${u.message||f.statusText}`)}}catch(f){console.error("Error importing default lab tests:",f),e(!1,`Error importing default lab tests: ${f instanceof Error?f.message:String(f)}`)}finally{t(!1)}};return r.jsxs("div",{className:"tutorial-interactive-component",children:[r.jsx("h3",{children:"Import Default Lab Tests"}),r.jsx("p",{children:"Click the button below to populate your lab test inventory with a list of common tests."}),r.jsx("button",{onClick:d,className:"tutorial-button primary",disabled:n,children:n?"Importing...":r.jsxs(r.Fragment,{children:[" ",r.jsx("i",{className:"fas fa-flask"})," Import Default Lab Tests"]})}),o&&i.length>0&&r.jsxs("div",{className:"imported-drugs-list",children:[r.jsx("h4",{children:"Tests Imported:"}),r.jsx("ul",{children:i.map((f,u)=>r.jsx("li",{children:f},u))})]})]})},Om=[{title:"Welcome to Your Admin Dashboard!",description:"This quick tour will guide you through essential features to get your clinic set up.",actionText:"Let's Start!",actionPath:null,component:null},{title:"Step 1: Manage Pharmacy Inventory",description:"Set up your pharmacy by adding drugs, managing stock levels, and importing default drug lists. This ensures smooth prescription fulfillment. Import default medications now!",actionText:"Go to Pharmacy Inventory",actionPath:"/dashboard/inventory",component:$te},{title:"Step 2: Manage Lab Test Inventory",description:"Configure your laboratory by adding available lab tests and importing default test lists. This is crucial for accurate diagnostics. Import default lab tests now!",actionText:"Go to Lab Test Inventory",actionPath:"/lab-inventory",component:zte},{title:"Step 3: Add Staff Members (Optional)",description:"You can add your clinic's staff, including doctors, receptionists, lab technicians, and pharmacists. Each role has specific permissions. You can skip this step for now.",actionText:"Go to Staff Management",actionPath:null,component:_A},{title:"You're All Set!",description:"You've completed the basic setup tour. Now, try out the AI-powered complaint analysis feature!",actionText:"Try the AI!",actionPath:"/edit-complaints",component:null}],Ute=({onClose:e,onMarkAsSeen:n})=>{const[t,i]=w.useState(()=>{const L=localStorage.getItem(Mm);return L?parseInt(L,10):0}),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState(null),[b,v]=w.useState(4),S=kt();w.useEffect(()=>{if(localStorage.setItem(Mm,t.toString()),o(null),d(null),t===0){v(4);const L=setTimeout(()=>{i(z=>z+1)},4e3),F=setInterval(()=>{v(z=>z-1)},1e3);return()=>{clearTimeout(L),clearInterval(F)}}},[t]);const k=(L,F,z)=>{d(L),o(F),L&&(z==="pharmacyImport"||z==="labImport")&&i($=>$+1)},T=()=>{},P=()=>{n(),e(),localStorage.removeItem(Mm)},M=async()=>{const L=Om[t];if(U&&L.actionPath==="/edit-complaints"){u(!0),g(null);try{const F=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - AI Entry",age:null,gender:null,phone:null,address:null})});if(!F.ok){const Y=await F.text();throw new Error(`Failed to create patient: ${Y||F.statusText} (${F.status})`)}const z=await F.json();if(!z||!z.id)throw new Error("Failed to create new patient or retrieve patient ID.");const $=z.id,B=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:$,complaint:""})});if(!B.ok){const Y=await B.text();throw new Error(`Failed to create queue entry: ${Y||B.statusText} (${B.status})`)}const R=await B.json();if(!R||!R.id)throw new Error("Failed to create new complaint record or retrieve record ID.");const V=R.id;S(`/dashboard/edit-complaint/${V}`),e(),n(),localStorage.removeItem(Mm)}catch(F){console.error("Error starting new AI complaint:",F);const z=`Error: ${F.message||"Failed to start new AI complaint process."}`;g(z)}finally{u(!1)}}else L.actionPath&&(S(L.actionPath),e(),t===Om.length-1&&(n(),localStorage.removeItem(Mm)))},I=Om[t],U=t===Om.length-1;return r.jsx("div",{className:"tutorial-modal-overlay",children:r.jsxs("div",{className:"tutorial-modal-content",children:[r.jsx("h2",{children:I.title}),r.jsx("p",{children:I.description}),I.component&&r.jsxs("div",{className:"tutorial-interactive-area",children:[t===3?r.jsx(_A,{onActionComplete:k,onStaffAdded:T,requiredRole:null}):r.jsx(I.component,{onActionComplete:k}),a&&r.jsx("p",{className:`tutorial-message ${l?"success":"error"}`,children:a})]}),p&&r.jsx("p",{className:"tutorial-message error",children:p})," ",r.jsxs("div",{className:"tutorial-modal-actions",children:[I.actionPath&&r.jsx("button",{onClick:M,className:"tutorial-button action",disabled:f,children:f?"Creating AI Patient...":I.actionText}),t===3&&r.jsx("button",{onClick:()=>i(t+1),className:"tutorial-button secondary",children:"Next Step"}),r.jsx("button",{onClick:P,className:"tutorial-button secondary",disabled:f,children:"Skip Tutorial"})]}),t===0&&r.jsxs("div",{className:"tutorial-countdown-indicator",children:["Next step in ",b," seconds..."]}),r.jsxs("div",{className:"tutorial-step-indicator",children:["Step ",t+1," of ",Om.length]})]})})},Bte=(e,n,t)=>{const i=Math.abs(e.getTime()-n.getTime());return Math.ceil(i/(1e3*60*60*24))<=t},qte=()=>{const[e,n]=w.useState([]),[t,i]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(""),[f,u]=w.useState(""),[p,g]=w.useState(1),[b]=w.useState(10),v=new Date,S=kt();w.useEffect(()=>{(async()=>{i(!0);try{const R=await pe("/api/pharmacy-orders/refill-reminders");if(R.ok){const V=await R.json();n(V)}else o("Failed to fetch refill reminders.")}catch{o("An error occurred while fetching data.")}finally{i(!1)}})()},[]);const k=$=>{d($.target.value),g(1)},T=$=>{u($.target.value),g(1)},P=e.filter($=>{const B=l?$.medicationRefillDates.some(V=>new Date(V.refillDate).toLocaleDateString()===new Date(l).toLocaleDateString()):!0,R=f?$.patientName.toLowerCase().includes(f.toLowerCase())||$.patientPhoneNumber.includes(f)||$.items.some(V=>V.name.toLowerCase().includes(f.toLowerCase())):!0;return B&&R}),M=p*b,I=M-b,U=P.slice(I,M),L=Math.ceil(P.length/b),F=$=>g($),z=async $=>{try{const B=await pe(`/api/queue/patient/${$}/latest`);if(B.ok){const R=await B.json();if(R!=null&&R._id)S(`/dashboard/edit-complaint/${R._id}`);else{const V=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:$})});if(V.ok){const Y=await V.json();Y!=null&&Y.id&&S(`/dashboard/edit-complaint/${Y.id}`)}}}}catch(B){console.error("Error handling row click:",B),o("Failed to navigate to patient complaint.")}};return t?r.jsx("div",{children:"Loading..."}):a?r.jsx("div",{children:a}):r.jsxs("div",{className:"refill-reminders-container",children:[r.jsx("h1",{children:"Refill Reminders"}),r.jsxs("div",{className:"controls-container",children:[r.jsxs("div",{className:"filter-container",children:[r.jsx("label",{htmlFor:"refillDate",children:"Filter by Refill Date: "}),r.jsx("input",{type:"date",id:"refillDate",value:l,onChange:k})]}),r.jsxs("div",{className:"search-container",children:[r.jsx("label",{htmlFor:"search",children:"Search: "}),r.jsx("input",{type:"text",id:"search",placeholder:"Search by patient name, phone, or medication",value:f,onChange:T})]})]}),r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Patient Name"}),r.jsx("th",{children:"Patient Phone Number"}),r.jsx("th",{children:"Medications"}),r.jsx("th",{children:"Refill Dates"})]})}),r.jsx("tbody",{children:U.length>0?U.map($=>r.jsxs("tr",{onClick:()=>z($.patientId),style:{cursor:"pointer"},children:[r.jsx("td",{children:$.patientName}),r.jsx("td",{children:$.patientPhoneNumber}),r.jsxs("td",{children:[r.jsx("ul",{children:$.items.map((B,R)=>r.jsxs("li",{children:[B.name," (Qty: ",B.quantity,")",B.tabletsPerDay&&r.jsxs("span",{children:[" - ",B.tabletsPerDay," / day"]}),B.numberOfDays&&r.jsxs("span",{children:[" for ",B.numberOfDays," days"]})]},R))}),r.jsxs("div",{children:["Last Updated: ",new Date($.updatedAt).toLocaleDateString()]}),$.prescription_for_unavailable_drugs&&r.jsxs("div",{className:"unavailable-prescription",children:[r.jsx("strong",{children:"Unavailable:"})," ",$.prescription_for_unavailable_drugs]}),$.billStatus&&r.jsxs("div",{className:`bill-status ${$.billStatus}`,children:["Bill Status: ",$.billStatus]})]}),r.jsx("td",{children:r.jsx("ul",{children:$.medicationRefillDates.map((B,R)=>{const V=new Date(B.refillDate),Y=Bte(V,v,2);return r.jsxs("li",{className:Y?"highlight-refill-date":"",children:[B.name,": ",V.toLocaleDateString()]},R)})})})]},$.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:4,children:"No refill reminders found."})})})]}),r.jsxs("div",{className:"pagination-container",children:[r.jsx("button",{onClick:()=>F(p-1),disabled:p===1,children:"Previous"}),Array.from({length:L},($,B)=>r.jsx("button",{onClick:()=>F(B+1),className:p===B+1?"active":"",children:B+1},B+1)),r.jsx("button",{onClick:()=>F(p+1),disabled:p===L,children:"Next"})]})]})},Vte=()=>{const e=kt(),n=cr();return w.useEffect(()=>{const t=new URLSearchParams(n.search),i=t.get("token"),a=t.get("caseDetails");i?(async()=>{try{const l=await pe(`/api/patients?search=${i}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const f=(await l.json()).patients[0];if(!f)throw new Error("Patient with the given token not found");const u=await pe(`/api/queue/patient/${f.id}/latest`);if(u.ok){const b=await u.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a}});return}}const p=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:f.id,complaint:a})});if(!p.ok)throw new Error("Failed to create queue entry");const g=await p.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),r.jsx("div",{children:"Loading..."})},Hte=()=>{const[e,n]=w.useState([]),[t,i]=w.useState(!0),[a,o]=w.useState(null),l=w.useCallback(async()=>{i(!0),o(null);try{const u=await pe("/api/notifications?all=true");if(u.ok){const g=(await u.json()).sort((b,v)=>{const S={expired_drug:1,near_expiry_drug:2,low_stock:3},k=S[b.type]||99,T=S[v.type]||99;return k!==T?k-T:new Date(v.created_at).getTime()-new Date(b.created_at).getTime()});n(g)}else o("Failed to fetch notifications."),console.error("Failed to fetch notifications:",u.statusText)}catch(u){o("Error fetching notifications."),console.error("Error fetching notifications:",u)}finally{i(!1)}},[]);w.useEffect(()=>{l()},[l]);const d=async u=>{try{const p=await pe(`/api/notifications/${u}/read`,{method:"PUT"});p.ok?n(g=>g.map(b=>b.id===u?{...b,is_read:!0}:b)):console.error("Failed to mark notification as read:",p.statusText)}catch(p){console.error("Error marking notification as read:",p)}},f=async()=>{try{const u=e.filter(g=>!g.is_read).map(g=>g.id);if(u.length===0)return;const p=await pe("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:u})});p.ok?n(g=>g.map(b=>({...b,is_read:!0}))):console.error("Failed to mark all notifications as read:",p.statusText)}catch(u){console.error("Error marking all notifications as read:",u)}};return t?r.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?r.jsx("div",{className:"notifications-page-container error-message",children:a}):r.jsxs("div",{className:"notifications-page-container",children:[r.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),r.jsx("div",{className:"notifications-actions",children:r.jsx("button",{onClick:f,disabled:e.every(u=>u.is_read),className:"mark-all-read-button",children:"Mark All As Read"})}),e.length===0?r.jsx("p",{className:"no-notifications-message",children:"No notifications to display."}):r.jsx("ul",{className:"notifications-list",children:e.map(u=>r.jsxs("li",{className:`notification-item ${u.is_read?"read":"unread"}`,children:[r.jsxs("div",{className:"notification-content",children:[r.jsxs("span",{className:"notification-type",children:[u.type.replace(/_/g," "),": "]}),u.message]}),r.jsxs("div",{className:"notification-meta",children:[r.jsx("span",{className:"notification-timestamp",children:new Date(u.created_at).toLocaleString()}),!u.is_read&&r.jsx("button",{onClick:()=>d(u.id),className:"mark-read-button",children:"Mark as Read"})]})]},u.id))})]})},D_=()=>{const e=kt(),[n,t]=w.useState([]),[i,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[I,U]=w.useState([]),[L,F]=w.useState(null),[z,$]=w.useState(""),[B,R]=w.useState(""),[V,Y]=w.useState(""),[ie,te]=w.useState(""),[W,H]=w.useState(""),[Q,J]=w.useState(""),[fe,A]=w.useState(""),[oe,ue]=w.useState(""),[D,se]=w.useState(""),[be,ee]=w.useState(""),[ce,re]=w.useState(""),Pe=w.useCallback(async()=>{a(!0),l(null);try{const _e=await pe("/api/distributors");if(!_e.ok)throw new Error(`Failed to fetch distributors: ${_e.statusText}`);const X=await _e.json();t(X)}catch(_e){console.error("Failed to fetch distributors:",_e),l(_e.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{Pe()},[Pe]);const Qe=async _e=>{_e.preventDefault(),l(null);try{const X=await pe("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:z,contact_person:B,phone:V,email:ie,address:W,gst_number:Q,drug_license_number:fe})});if(!X.ok){const de=await X.json();throw new Error(de.message||"Failed to add distributor.")}alert("Distributor added successfully!"),ft(),Pe()}catch(X){console.error("Error adding distributor:",X),l(X.message||"Failed to add distributor.")}},Se=async _e=>{if(_e.preventDefault(),l(null),!!P)try{const X=await pe(`/api/distributors/${P.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:z,contact_person:B,phone:V,email:ie,address:W,gst_number:Q,drug_license_number:fe})});if(!X.ok){const de=await X.json();throw new Error(de.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),rt(),Pe()}catch(X){console.error("Error updating distributor:",X),l(X.message||"Failed to update distributor.")}},Ne=async()=>{if(l(null),!!P)try{const _e=await pe(`/api/distributors/${P.id}`,{method:"DELETE"});if(!_e.ok){const X=await _e.json();throw new Error(X.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),Ft(),Pe()}catch(_e){console.error("Error deleting distributor:",_e),l(_e.message||"Failed to delete distributor.")}},De=w.useCallback(async _e=>{l(null);try{const X=await pe(`/api/distributors/${_e}/payments`);if(!X.ok)throw new Error(`Failed to fetch payments: ${X.statusText}`);const qe=(await X.json()).map(Fe=>({...Fe,order_value:parseFloat(Fe.order_value),amount_paid:parseFloat(Fe.amount_paid),balance_remaining:parseFloat(Fe.balance_remaining)}));U(qe);const et=await pe(`/api/distributors/${_e}/balance`);if(!et.ok)throw new Error(`Failed to fetch balance: ${et.statusText}`);const ct=await et.json();F({totalOrderValue:parseFloat(ct.totalOrderValue),totalAmountPaid:parseFloat(ct.totalAmountPaid),remainingBalance:parseFloat(ct.remainingBalance)})}catch(X){console.error("Error fetching payments/balance:",X),l(X.message||"Failed to load payments or balance.")}},[]),Me=async _e=>{if(_e.preventDefault(),l(null),!!P)try{const X=await pe(`/api/distributors/${P.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:oe,order_value:parseFloat(D||"0"),amount_paid:parseFloat(be||"0"),notes:ce})});if(!X.ok){const de=await X.json();throw new Error(de.message||"Failed to add payment.")}alert("Payment added successfully!"),$e(),De(P.id)}catch(X){console.error("Error adding payment:",X),l(X.message||"Failed to add payment.")}},nt=()=>{$(""),R(""),Y(""),te(""),H(""),J(""),A(""),l(null),f(!0)},ft=()=>{f(!1)},ut=_e=>{M(_e),$(_e.name),R(_e.contact_person||""),Y(_e.phone||""),te(_e.email||""),H(_e.address||""),J(_e.gst_number||""),A(_e.drug_license_number||""),l(null),p(!0)},rt=()=>{p(!1),M(null)},Nt=_e=>{M(_e),l(null),b(!0)},Ft=()=>{b(!1),M(null)},ye=_e=>{M(_e),De(_e.id),l(null),S(!0)},Te=()=>{S(!1),M(null),U([]),F(null)},Ye=_e=>{M(_e),ue(new Date().toISOString().split("T")[0]),se("0"),ee("0"),re(""),l(null),T(!0)},$e=()=>{T(!1),M(null)};return i?r.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):o?r.jsxs("div",{className:"error-indicator",children:["Error: ",o]}):r.jsxs("div",{className:"distributor-management-page",children:[r.jsxs("div",{className:"distributor-management-header",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[r.jsx(nn,{size:24})," Back"]}),r.jsx("h2",{children:"Distributor Management"})]}),(()=>{const _e=n.reduce((de,qe)=>de+parseFloat(qe.remainingBalance||"0"),0),X=_e>=0?"balance-positive":"balance-negative";return r.jsxs("div",{className:`total-balance-display ${X}`,children:[r.jsx("strong",{children:"Total Combined Balance:"})," ",_e.toFixed(2)]})})(),r.jsxs("button",{onClick:nt,className:"add-distributor-button",children:[r.jsx(cs,{size:18}),"Add New Distributor"]})]}),r.jsx("div",{className:"distributor-table-container",children:r.jsxs("table",{className:"distributor-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Contact Person"}),r.jsx("th",{children:"Phone"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Address"}),r.jsx("th",{children:"GST Number"})," ",r.jsx("th",{children:"Drug License Number"})," ",r.jsx("th",{children:"Remaining Balance"})," ",r.jsx("th",{className:"actions-cell",children:"Actions"})]})}),r.jsx("tbody",{children:n.length===0?r.jsxs("tr",{children:[r.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(_e=>r.jsxs("tr",{children:[r.jsx("td",{children:_e.name}),r.jsx("td",{children:_e.contact_person||"-"}),r.jsx("td",{children:_e.phone||"-"}),r.jsx("td",{children:_e.email||"-"}),r.jsx("td",{children:_e.address||"-"}),r.jsx("td",{children:_e.gst_number||"-"})," ",r.jsx("td",{children:_e.drug_license_number||"-"})," ",r.jsxs("td",{className:parseFloat(_e.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",_e.remainingBalance||"0.00"]})," ",r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"actions-buttons-group",children:[r.jsxs("button",{onClick:()=>ye(_e),className:"action-text-button view-button",title:"View Payments & Balance",children:[r.jsx(FI,{size:16})," View Payments"]}),r.jsxs("button",{onClick:()=>Ye(_e),className:"action-text-button add-payment-button",title:"Add Payment",children:[r.jsx(cs,{size:16})," Add Payment"]}),r.jsx("button",{onClick:()=>ut(_e),className:"action-icon-button edit-button",title:"Edit Distributor",children:r.jsx(eu,{size:16})}),r.jsx("button",{onClick:()=>Nt(_e),className:"action-icon-button delete-button",title:"Delete Distributor",children:r.jsx(lr,{size:16})})]})})]},_e.id))})]})}),d&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:ft,className:"modal-close-button",children:""}),r.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),o&&r.jsx("div",{className:"modal-error-message",children:o}),r.jsxs("form",{onSubmit:Qe,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Name:"}),r.jsx("input",{type:"text",id:"name",value:z,onChange:_e=>$(_e.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),r.jsx("input",{type:"text",id:"contact_person",value:B,onChange:_e=>R(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"phone",children:"Phone:"}),r.jsx("input",{type:"text",id:"phone",value:V,onChange:_e=>Y(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email:"}),r.jsx("input",{type:"email",id:"email",value:ie,onChange:_e=>te(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"address",children:"Address:"}),r.jsx("textarea",{id:"address",value:W,onChange:_e=>H(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),r.jsx("input",{type:"text",id:"gst_number",value:Q,onChange:_e=>J(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),r.jsx("input",{type:"text",id:"drug_license_number",value:fe,onChange:_e=>A(_e.target.value)})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:ft,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),u&&P&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:rt,className:"modal-close-button",children:""}),r.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),o&&r.jsx("div",{className:"modal-error-message",children:o}),r.jsxs("form",{onSubmit:Se,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-name",children:"Name:"}),r.jsx("input",{type:"text",id:"edit-name",value:z,onChange:_e=>$(_e.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),r.jsx("input",{type:"text",id:"edit-contact_person",value:B,onChange:_e=>R(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),r.jsx("input",{type:"text",id:"edit-phone",value:V,onChange:_e=>Y(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-email",children:"Email:"}),r.jsx("input",{type:"email",id:"edit-email",value:ie,onChange:_e=>te(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-address",children:"Address:"}),r.jsx("textarea",{id:"edit-address",value:W,onChange:_e=>H(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),r.jsx("input",{type:"text",id:"edit-gst_number",value:Q,onChange:_e=>J(_e.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),r.jsx("input",{type:"text",id:"edit-drug_license_number",value:fe,onChange:_e=>A(_e.target.value)})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:rt,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&P&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:Ft,className:"modal-close-button",children:""}),r.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),r.jsxs("p",{children:['Are you sure you want to delete distributor "',P.name,'"?']}),o&&r.jsx("div",{className:"modal-error-message",children:o}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:Ft,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:Ne,className:"button-delete",children:"Delete"})]})]})}),v&&P&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content large-modal",children:[r.jsx("button",{onClick:Te,className:"modal-close-button",children:""}),r.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",P.name]}),o&&r.jsx("div",{className:"modal-error-message",children:o}),L&&r.jsxs("div",{className:"balance-summary",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Total Order Value:"})," ",L.totalOrderValue.toFixed(2)]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Total Amount Paid:"})," ",L.totalAmountPaid.toFixed(2)]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Remaining Balance:"})," ",L.remainingBalance.toFixed(2)]})]}),r.jsx("h4",{children:"Payment History"}),I.length===0?r.jsx("p",{children:"No payments recorded for this distributor."}):r.jsx("div",{className:"table-responsive",children:r.jsxs("table",{className:"distributor-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Date"}),r.jsx("th",{children:"Order Value"}),r.jsx("th",{children:"Amount Paid"}),r.jsx("th",{children:"Balance Remaining"}),r.jsx("th",{children:"Notes"})]})}),r.jsx("tbody",{children:I.map(_e=>r.jsxs("tr",{children:[r.jsx("td",{children:new Date(_e.payment_date).toLocaleDateString()}),r.jsxs("td",{children:["",_e.order_value.toFixed(2)]}),r.jsxs("td",{children:["",_e.amount_paid.toFixed(2)]}),r.jsxs("td",{children:["",_e.balance_remaining.toFixed(2)]}),r.jsx("td",{children:_e.notes||"-"})]},_e.id))})]})}),r.jsx("div",{className:"modal-actions",children:r.jsx("button",{type:"button",onClick:Te,className:"button-cancel",children:"Close"})})]})}),k&&P&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:$e,className:"modal-close-button",children:""}),r.jsxs("h3",{className:"modal-title",children:["Add Payment for ",P.name]}),o&&r.jsx("div",{className:"modal-error-message",children:o}),r.jsxs("form",{onSubmit:Me,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),r.jsx("input",{type:"date",id:"payment_date",value:oe,onChange:_e=>ue(_e.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),r.jsx("input",{type:"number",id:"order_value",value:D,onChange:_e=>se(_e.target.value),step:"0.01"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),r.jsx("input",{type:"number",id:"amount_paid",value:be,onChange:_e=>ee(_e.target.value),step:"0.01"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),r.jsx("textarea",{id:"payment_notes",value:ce,onChange:_e=>re(_e.target.value)})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:$e,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},Gte=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:i,availableFields:a})=>{const[o,l]=w.useState({});if(w.useEffect(()=>{e&&f()},[e,t,a]),!e)return null;const d=(p,g)=>{l(b=>({...b,[p]:g}))},f=()=>{const p={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=Vx(g,b);v&&(p[g]=v.name)}),l(p)},u=()=>{const p={};for(const g in o)o[g]&&o[g]!=="none"&&(p[g]=o[g]);i(p),n()};return r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:n,className:"modal-close-button",children:r.jsx(ni,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Match File Columns"}),r.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),r.jsx("div",{className:"modal-actions-top",children:r.jsx("button",{type:"button",onClick:f,className:"button-auto-match",children:"Auto Match"})}),r.jsxs("div",{className:"column-mapping-grid",children:[r.jsx("div",{className:"grid-header",children:"Excel Column"}),r.jsx("div",{className:"grid-header",children:"App Field"}),t.map((p,g)=>r.jsxs(wn.Fragment,{children:[r.jsx("div",{className:"excel-header-cell",children:p}),r.jsx("div",{className:"app-field-cell",children:r.jsxs("select",{value:o[p]||"",onChange:b=>d(p,b.target.value),className:"app-field-select",children:[r.jsx("option",{value:"",children:"-- Select Field --"}),r.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>r.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:u,className:"button-submit",children:"Confirm Mapping"})]})]})})},Yte=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:i})=>{const a=w.useRef(new Map),o=["name","price","quantity_in_stock","unit","expiry_date","buying_price","brand_name","box_number","gst","discount","batch","hsn_code","mfg","loose"],l=(d,f,u)=>{if(d.key==="Tab"){d.preventDefault();const p=o.indexOf(u);if(p!==-1){const g=(p+1)%o.length,b=o[g],v=a.current.get(`${f}-${b}`);v==null||v.focus()}}};return e.length===0?r.jsxs("div",{className:"no-drugs-message",children:[r.jsx("p",{children:"No drugs added to the purchase list yet."}),r.jsxs("button",{onClick:i,className:"action-button add-drug-to-table-button",children:[r.jsx(cs,{size:18,className:"button-icon"}),"Add the first drug"]})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"purchase-drugs-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Composition Name"}),r.jsx("th",{children:"MRP ()"}),r.jsx("th",{children:"Qty"}),r.jsx("th",{children:"Pack"}),r.jsx("th",{children:"Supplier"}),r.jsx("th",{children:"Expiry Date"}),r.jsx("th",{children:"Rate ()"}),r.jsx("th",{children:"Brand Name"}),r.jsx("th",{children:"Box Number"}),r.jsx("th",{children:"GST (%)"}),r.jsx("th",{children:"Discount (%)"}),r.jsx("th",{children:"Margin (%)"}),r.jsx("th",{children:"Batch"}),r.jsx("th",{children:"HSN Code"}),r.jsx("th",{children:"MFG"}),r.jsx("th",{children:"Loose"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.map((d,f)=>r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("input",{type:"text",value:d.name||"",onChange:u=>n(u,d.id,"name"),onKeyDown:u=>l(u,d.id,"name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-name`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.price,onChange:u=>n(u,d.id,"price"),onKeyDown:u=>l(u,d.id,"price"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-price`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.quantity_in_stock,onChange:u=>n(u,d.id,"quantity_in_stock"),onKeyDown:u=>l(u,d.id,"quantity_in_stock"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-quantity_in_stock`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.unit||"",onChange:u=>n(u,d.id,"unit"),onKeyDown:u=>l(u,d.id,"unit"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-unit`,u)}})}),r.jsx("td",{children:d.supplier||"N/A"}),r.jsx("td",{children:r.jsx("input",{type:"date",value:d.expiry_date||"",onChange:u=>n(u,d.id,"expiry_date"),onKeyDown:u=>l(u,d.id,"expiry_date"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-expiry_date`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.buying_price||"",onChange:u=>n(u,d.id,"buying_price"),onKeyDown:u=>l(u,d.id,"buying_price"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-buying_price`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.brand_name||"",onChange:u=>n(u,d.id,"brand_name"),onKeyDown:u=>l(u,d.id,"brand_name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-brand_name`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.box_number||"",onChange:u=>n(u,d.id,"box_number"),onKeyDown:u=>l(u,d.id,"box_number"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-box_number`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.gst||"",onChange:u=>n(u,d.id,"gst"),onKeyDown:u=>l(u,d.id,"gst"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-gst`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.discount||"",onChange:u=>n(u,d.id,"discount"),onKeyDown:u=>l(u,d.id,"discount"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-discount`,u)}})}),r.jsx("td",{children:(()=>{const u=d.price||0,p=d.buying_price||0,g=d.gst!==null&&d.gst!==void 0?d.gst/100*p:0,b=d.discount!==null&&d.discount!==void 0?d.discount/100*u:0,v=u-(p+g)-b;return`${(u>0?v/u*100:0).toFixed(2)}%`})()}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.batch||"",onChange:u=>n(u,d.id,"batch"),onKeyDown:u=>l(u,d.id,"batch"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-batch`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.hsn_code||"",onChange:u=>n(u,d.id,"hsn_code"),onKeyDown:u=>l(u,d.id,"hsn_code"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-hsn_code`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.mfg||"",onChange:u=>n(u,d.id,"mfg"),onKeyDown:u=>l(u,d.id,"mfg"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mfg`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.loose||"",onChange:u=>n(u,d.id,"loose"),onKeyDown:u=>l(u,d.id,"loose"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-loose`,u)}})}),r.jsx("td",{children:r.jsx("button",{onClick:()=>t(d.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})})]},d.id||f))})]})})},I_=()=>{const e=kt(),[n,t]=w.useState(!1),i=w.useRef(null),a=w.useRef(null),[o,l]=w.useState(""),[d,f]=w.useState([]),[u,p]=w.useState(null),[g,b]=w.useState(!1),v=w.useRef(null),[S,k]=w.useState(!1),[T,P]=w.useState([]),[M,I]=w.useState(null),[U,L]=w.useState(null),[F,z]=w.useState(0),[$,B]=w.useState(!1),[R,V]=w.useState([]),Y=["name","description","price","quantity_in_stock","unit","supplier","expiry_date","buying_price","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],ie=()=>{const Ne={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",supplier:u?u.name:"",expiry_date:"",buying_price:0,box_number:"",gst:0,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""};V(De=>[...De,Ne])},te=async(Se,Ne)=>{if(!Se){L("No file provided for import.");return}if(!u){L("Please select a distributor before importing.");return}t(!0),L(null);const De=new FormData;De.append("inventoryFile",Se),De.append("columnMapping",JSON.stringify(Ne));try{const Me=await pe("/api/drugs/parse-excel",{method:"POST",body:De});if(!Me.ok){const ft=await Me.json();throw new Error(ft.message||`Failed to parse Excel file: ${Me.statusText}`)}const nt=await Me.json();V(ft=>[...ft,...nt.map(ut=>({...ut,id:Date.now().toString()+Math.random().toString(36).substring(2,9),supplier:u?u.name:ut.supplier}))]),alert(`Successfully parsed ${nt.length} drugs from Excel. They have been added to the purchase list.`)}catch(Me){console.error("Failed to parse Excel file:",Me),L(Me.message||"Failed to parse Excel file. Please check the file format and try again."),alert(`Excel parsing failed: ${Me.message||"Please check the file format and try again."}`)}finally{i.current&&(i.current.value=""),t(!1),I(null)}},W=async Se=>{if(Se.target.files&&Se.target.files[0]){const Ne=Se.target.files[0];I(Ne),L(null),t(!0);const De=new FormData;De.append("inventoryFile",Ne);try{const Me=await pe("/api/drugs/get-file-headers",{method:"POST",body:De});if(!Me.ok){const ft=await Me.json();throw new Error(ft.message||`Failed to get file headers: ${Me.statusText}`)}const{headers:nt}=await Me.json();P(nt),k(!0)}catch(Me){console.error("Failed to get file headers:",Me),L(Me.message||"Failed to read file headers. Please check the file format and try again."),alert(`Error reading file headers: ${Me.message||"Please check the file format and try again."}`),I(null)}finally{t(!1)}}else I(null)},H=Se=>{M?te(M,Se):L("No file selected for import after mapping."),k(!1)},Q=()=>{k(!1),P([]),I(null),i.current&&(i.current.value="")},J=()=>{var Se;(Se=i.current)==null||Se.click()},fe=async Se=>{if(Se.target.files&&Se.target.files[0]){const Ne=Se.target.files[0];L(null),t(!0);const De=new FormData;De.append("file",Ne),De.append("output_type","csv");const nt={Authorization:"Bearer 00841ac4-b279-11f0-ab55-0a3a41e3fad1"};try{const ft=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:nt,body:De});if(!ft.ok){const $e=await ft.json();throw new Error($e.message||`Failed to extract data from image/PDF: ${ft.statusText}`)}const ut=await ft.json();if(!ut.success||!ut.content)throw new Error(ut.detail||"Nanonets API did not return expected content.");let rt=ut.content;rt=rt.split(`
`).filter($e=>!$e.startsWith("#")&&$e.trim()!=="").join(`
`);const Ft=new File([rt],"extracted_data.csv",{type:"text/csv"}),ye=new FormData;ye.append("inventoryFile",Ft);const Te=await pe("/api/drugs/get-file-headers",{method:"POST",body:ye});if(!Te.ok){const $e=await Te.json();throw new Error($e.message||`Failed to get headers from extracted CSV: ${Te.statusText}`)}const{headers:Ye}=await Te.json();P(Ye),I(Ft),k(!0),alert("Successfully extracted data from image/PDF as CSV. Please map the columns.")}catch(ft){console.error("Failed to extract data from image/PDF:",ft),L(ft.message||"Failed to extract data from image/PDF. Please check the file and try again."),alert(`Image/PDF extraction failed: ${ft.message||"Please check the file and try again."}`)}finally{a.current&&(a.current.value=""),t(!1)}}},A=()=>{var Se;(Se=a.current)==null||Se.click()},oe=()=>{if(!u){L("Please select a distributor before adding a drug manually.");return}B(!0)},ue=()=>{B(!1),L(null)},D=Se=>{V(Ne=>[...Ne,{...Se,id:Date.now().toString(),supplier:u?u.name:Se.supplier}]),ue()},se=Se=>{V(Ne=>Ne.filter(De=>De.id!==Se))},be=(Se,Ne,De)=>{const{value:Me}=Se.target;V(nt=>nt.map(ft=>{if(ft.id===Ne){let ut=Me;De==="expiry_date"?ut=Me.trim()===""?null:Me:["price","quantity_in_stock","buying_price","gst","margin","discount","loose"].includes(De)&&(ut=parseFloat(Me),isNaN(ut)&&(ut=null));const rt={...ft,[De]:ut};return De==="name"&&u&&!rt.supplier&&(rt.supplier=u.name),rt}return ft}))},ee=w.useCallback(()=>R.reduce((Se,Ne)=>{const De=Ne.quantity_in_stock||0,Me=Ne.buying_price||0,nt=Ne.gst||0,ft=Ne.discount||0;let ut=Me*(1-ft/100),rt=De*ut;return rt+=rt*(nt/100),Se+rt},0),[R]),ce=async()=>{if(!u){L("Please select a distributor before submitting the purchase.");return}const Se=R.filter(Ne=>Object.values(Ne).some(De=>typeof De=="string"&&De.trim()!==""||typeof De=="number"&&De!==0||De!=null&&typeof De!="string"&&typeof De!="number"));if(Se.length===0){L("No valid drugs to submit. Please fill in at least one field for a row, or remove empty rows."),t(!1);return}t(!0),L(null);try{for(const nt of Se){const ft={...nt,expiry_date:nt.expiry_date===""?null:nt.expiry_date,distributorId:u.id},ut=await pe("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ft)});if(!ut.ok){const rt=await ut.json();throw new Error(rt.message||`Failed to add drug ${nt.name}: ${ut.statusText}`)}}const Ne=ee(),De=new Date().toISOString().split("T")[0],Me=await pe(`/api/distributors/${u.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:De,order_value:Ne,amount_paid:F,notes:"Payment from purchase page."})});if(!Me.ok){const nt=await Me.json();throw new Error(nt.message||`Failed to record distributor payment: ${Me.statusText}`)}alert("All valid drugs added to inventory and distributor payment recorded successfully!"),V([]),p(null),l(""),z(0),e("/dashboard/inventory")}catch(Ne){console.error("Failed to submit purchase:",Ne),L(Ne.message||"Failed to submit purchase. Please try again."),alert(`Purchase submission failed: ${Ne.message||"Please try again."}`)}finally{t(!1)}},re=w.useCallback(async Se=>{if(Se.trim()===""){f([]);return}try{const Ne=await pe(`/api/distributors?search=${encodeURIComponent(Se)}`);if(!Ne.ok)throw new Error(`Failed to fetch distributors: ${Ne.statusText}`);const De=await Ne.json();f(De)}catch(Ne){console.error("Failed to fetch distributors:",Ne),L(Ne.message||"Failed to load distributors.")}},[]),Pe=Se=>{const Ne=Se.target.value;l(Ne),p(null),v.current&&clearTimeout(v.current),Ne.trim()!==""?v.current=setTimeout(()=>{re(Ne),b(!0)},300):(f([]),b(!1))},Qe=Se=>{p(Se),l(Se.name),b(!1),f([])};return w.useEffect(()=>{const Se=Ne=>{Ne.target instanceof HTMLElement&&!Ne.target.closest(".distributor-search-container")&&b(!1)};return document.addEventListener("mousedown",Se),()=>{document.removeEventListener("mousedown",Se),v.current&&clearTimeout(v.current)}},[]),r.jsxs("div",{className:"purchase-page",children:[r.jsxs("div",{className:"purchase-header",children:[r.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:r.jsx(nn,{size:24})}),r.jsx("h2",{className:"purchase-page-title",children:"Purchase Inventory"})]}),U&&r.jsx("div",{className:"error-message",children:U}),r.jsxs("div",{className:"purchase-controls-header",children:[r.jsxs("div",{className:"distributor-selection-section",children:[r.jsxs("h3",{children:[r.jsx(VR,{size:24,className:"icon-left"})," Select Distributor"]}),r.jsxs("div",{className:"distributor-search-container",children:[r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx(us,{size:20,className:"search-icon"}),r.jsx("input",{type:"text",placeholder:"Search distributor by name...",value:o,onChange:Pe,onFocus:()=>o.trim()!==""&&b(!0),className:"distributor-search-input"})]}),g&&d.length>0&&r.jsx("ul",{className:"distributor-search-results",children:d.map(Se=>r.jsx("li",{onClick:()=>Qe(Se),children:Se.name},Se.id))}),u&&r.jsxs("div",{className:"selected-distributor-info",children:["Selected: ",r.jsx("strong",{children:u.name}),u.contact_person&&r.jsxs("span",{children:[" (",u.contact_person,")"]})]})]})]}),r.jsxs("div",{className:"import-section",children:[r.jsxs("h3",{children:[r.jsx($S,{size:24,className:"icon-left"})," Import Drugs"]}),r.jsx("p",{children:"Upload an Excel (.xlsx, .xls), CSV, PDF, or Image file to import drug data."}),r.jsxs("div",{className:"import-controls",children:[r.jsx("input",{ref:i,id:"excel-file-upload",name:"excel-file-upload",type:"file",className:"sr-only",accept:".xlsx, .xls, .csv",onChange:W}),r.jsxs("button",{onClick:J,disabled:n||!u,className:`action-button import-button ${n?"importing":""}`,title:u?"":"Please select a distributor",children:[r.jsx($S,{size:18,className:"button-icon"}),n?"Reading Headers...":"Import XL or CSV"]}),r.jsx("input",{ref:a,id:"image-pdf-file-upload",name:"image-pdf-file-upload",type:"file",className:"sr-only",accept:".pdf, .png, .jpg, .jpeg",onChange:fe}),r.jsxs("button",{onClick:A,disabled:n||!u,className:"action-button import-button",title:u?"":"Please select a distributor",children:[r.jsx(Xc,{size:18,className:"button-icon"}),"Import from PDF/Image"]}),r.jsxs("button",{onClick:oe,className:"action-button add-drug-manual-button",disabled:!u,title:u?"":"Select a distributor to add drugs manually",children:[r.jsx(cs,{size:18,className:"button-icon"}),"Add Drug"]})]})]})]}),r.jsx(Gte,{isOpen:S,onClose:Q,excelHeaders:T,onConfirm:H,availableFields:Y}),$&&r.jsx(a2,{isOpen:$,onClose:ue,onDrugAddedToPurchase:D}),r.jsxs("div",{className:"purchase-summary-section",children:[r.jsxs("h3",{children:[r.jsx(LR,{size:24,className:"icon-left"})," Drugs to be Purchased (",R.length,")"]}),r.jsx(Yte,{purchaseRows:R,onCellChange:be,onRemoveDrug:se,onAddEmptyRow:ie}),r.jsxs("div",{className:"purchase-summary-actions",children:[r.jsxs("button",{onClick:ie,className:"action-button add-drug-to-table-button",children:[r.jsx(cs,{size:18,className:"button-icon"}),"Add Row"]}),r.jsxs("div",{className:"summary-details",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"amount-paid-to-distributor",children:"Amount Paid ():"}),r.jsx("input",{type:"number",id:"amount-paid-to-distributor",value:F,onChange:Se=>z(parseFloat(Se.target.value)||0),placeholder:"0.00",className:"amount-paid-input",step:"0.01",disabled:!u,title:u?"":"Please select a distributor first"})]}),r.jsxs("div",{className:"total-purchase-value",children:[r.jsx("strong",{children:"Total Purchase Value:"})," ",ee().toFixed(2)]})]}),r.jsx("button",{onClick:ce,disabled:n||R.length===0||!u,className:"action-button submit-purchase-button",children:n?"Submitting...":"Submit Purchase"})]})]})]})},Wte=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},Qte=()=>{const e=kt(),n=cr(),[t,i]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(!0),[f,u]=w.useState(null),[p,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[T,P]=w.useState(""),[M,I]=w.useState(""),[U,L]=w.useState(""),[F,z]=w.useState(""),[$,B]=w.useState(0),R=w.useRef(!1),V=fe=>{const A=Math.max(0,Math.min(100,isNaN(fe)?0:fe));R.current=!0,B(A);const oe=a.map(ue=>({...ue,discount_percentage:A}));o(oe)},Y=(fe,A)=>{const oe=[...a];oe[fe].discount_percentage=isNaN(A)?0:A,o(oe)};w.useEffect(()=>{if(R.current){R.current=!1;return}const fe=a.reduce((ue,D)=>ue+(D.total_price??0),0);if(fe===0){B(0);return}const oe=a.reduce((ue,D)=>{const be=(D.total_price??0)*((D.discount_percentage??0)/100);return ue+be},0)/fe*100;B(ue=>Math.abs(ue-oe)>.01?oe:ue)},[a]);const ie=async()=>{if(!t)return u("No order data available to bill."),null;if(a.length===0)return u("Cannot bill an empty order."),null;g(!0),u(null);try{const fe=a.map(se=>{const be=(se.pricePerLooseUnit??0)*(se.looseQuantity??0),ee=be*((se.discount_percentage??0)/100),ce=be-ee;return{name:se.name,pack_quantity:se.loosePacks??0,loose_quantity:se.looseUnits??0,price:se.originalPrice??0,pack_price:se.originalPrice??0,loose_price:se.pricePerLooseUnit??0,total:ce,drug_id:se.drug_id,discount_percentage:se.discount_percentage??0,batch:se.batch,expiry_date:se.expiry_date}}),A={patientId:t.patientId,queueId:t.id,items:fe,amount:J,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:$},oe=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),ue=await oe.json();if(!oe.ok||!ue.id)throw new Error(ue.message||"Failed to create bill.");const D=await pe(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ue.id,medications:a})});if(!D.ok){const se=await D.text();throw new Error(`Failed to update pharmacy order status: ${D.statusText} - ${se}`)}return i(se=>se?{...se,status:"billed",bill_id:ue.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${ue.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:ue.id},initialItems:a}}),ue.id}catch(fe){return console.error("Billing process failed:",fe),u(fe.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},te=()=>{window.print()},W=async()=>{await ie()&&(window.print(),e(-1))};w.useEffect(()=>{const fe=n.pathname.split("/"),A=fe[fe.length-1];A?(async()=>{try{const ue=await pe(`/api/pharmacy-orders/${A}`);if(!ue.ok)throw new Error("Failed to fetch pharmacy order details");const D=await ue.json();i(D);const se=D.medications.map(be=>{const ee=Wte(be.unit),ce=(be.pack_quantity??0)*ee+(be.loose_quantity??0);return{...be,isLoose:!0,loosePacks:be.pack_quantity??0,looseUnits:be.loose_quantity??0,looseQuantity:ce,pack_price:Number(be.pack_price)||0,loose_price:Number(be.loose_price)||0,total_price:Number(be.total_price)||0,pricePerLooseUnit:Number(be.loose_price)||0,originalPrice:Number(be.pack_price)||0,discount_percentage:Number(be.discount_percentage)??0,directions_to_use:be.directions_to_use,tabletsPerDay:be.tabletsPerDay,numberOfDays:be.numberOfDays,batch:be.batch,expiry_date:be.expiry_date}});o(se)}catch(ue){console.error("Failed to fetch order:",ue),u(ue.message||"Failed to load order details.")}finally{d(!1)}})():(u("No pharmacy order ID provided."),d(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const A=await pe("/api/clinics/settings");if(!A.ok)throw new Error("Failed to fetch clinic settings");const oe=await A.json();P(oe.upi_id||""),I(oe.name||""),L(oe.address||""),z(oe.notes||"")}catch(A){console.error("Error fetching clinic settings:",A)}})()},[]);const H=w.useMemo(()=>a.reduce((fe,A)=>fe+(A.total_price??0),0),[a]),Q=w.useMemo(()=>a.reduce((fe,A)=>{const ue=(A.total_price??0)*(A.discount_percentage??0)/100;return fe+ue},0),[a]),J=w.useMemo(()=>H-Q,[H,Q]);return w.useEffect(()=>{if(J>0&&T){const fe=`upi://pay?pa=${T}&pn=ClinicName&am=${J.toFixed(2)}&cu=INR`;k(fe)}else k("")},[J,T]),l?r.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):f?r.jsxs("div",{className:"error-message-box",children:["Error: ",f]}):t?r.jsx("div",{className:"pharmacy-billing-page",children:r.jsxs("div",{className:"billing-container printable-section",children:[r.jsxs("div",{className:"billing-header print-only",children:[r.jsx("div",{className:"clinic-header-left",children:r.jsx("div",{className:"clinic-info-print",children:r.jsxs("div",{className:"clinic-name-and-details-print",children:[r.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),r.jsx("h2",{className:"clinic-name-print",children:M?`${M} Pharmacy`:"Pharmacy Bill"}),(U||F)&&r.jsxs("div",{className:"clinic-details-print",children:[U&&r.jsx("span",{className:"small-text clinic-address",children:U}),F&&r.jsx("span",{className:"small-text clinic-notes",children:F})]})]})})}),r.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(tu,{size:16})," Patient Name"]})," ",t.patientName]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Gm,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Qx,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),r.jsxs("header",{className:"billing-header no-print",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[r.jsx(nn,{size:20}),r.jsx("span",{children:"Back"})]}),r.jsx("h1",{children:"Pharmacy Bill"})]}),r.jsxs("div",{className:"billing-layout",children:[r.jsxs("main",{className:"order-content",children:[r.jsxs("section",{className:"order-details-card no-print",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{children:"Patient Information"})}),r.jsxs("div",{className:"patient-info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(tu,{size:16})," Patient Name"]})," ",t.patientName]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Gm,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),r.jsxs("div",{className:"info-item no-print",children:[r.jsxs("strong",{children:[r.jsx(ig,{size:16})," Order ID"]})," ",t.id]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Qx,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),r.jsxs("section",{className:"medications-card",children:[r.jsx("div",{className:"card-header no-print",children:r.jsx("h2",{children:"Medications"})}),a.length>0?r.jsxs("table",{className:"medications-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"S.No."}),r.jsx("th",{children:"DESCRIPTION"}),r.jsx("th",{children:"BATCH"}),r.jsx("th",{children:"EXPIRY"}),r.jsx("th",{children:"QUANTITY"}),r.jsx("th",{children:"MRP"}),r.jsx("th",{children:"RATE"}),r.jsx("th",{children:"DIS %"}),r.jsx("th",{children:"GST%"}),r.jsx("th",{children:"AMT"})]})}),r.jsx("tbody",{children:a.map((fe,A)=>{var be,ee;const oe=fe.total_price??0,ue=oe*(fe.discount_percentage??0)/100,D=oe-ue;return r.jsxs("tr",{children:[r.jsx("td",{children:A+1}),r.jsx("td",{children:fe.name}),r.jsx("td",{children:fe.batch||"N/A"}),r.jsx("td",{children:fe.expiry_date?new Date(fe.expiry_date).toLocaleDateString():"N/A"}),r.jsxs("td",{children:[r.jsxs("div",{children:["Packs: ",fe.loosePacks??0]}),r.jsxs("div",{children:["Loose: ",fe.looseUnits??0]})]}),r.jsx("td",{children:((be=fe.originalPrice)==null?void 0:be.toFixed(2))??"N/A"}),r.jsx("td",{children:((ee=fe.pricePerLooseUnit)==null?void 0:ee.toFixed(2))??"N/A"}),r.jsxs("td",{children:[r.jsx("input",{type:"number",value:fe.discount_percentage??0,onChange:ce=>Y(A,parseFloat(ce.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),r.jsxs("td",{children:[5 .toFixed(1),"%"]}),r.jsx("td",{children:D.toFixed(2)})]},A)})})]}):r.jsx("p",{children:"No medications in this order."})]}),r.jsxs("div",{className:"bill-summary-print print-only",children:[S&&r.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[r.jsx(Fh,{value:S,size:100}),r.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),r.jsxs("div",{className:"bill-summary-details",children:[r.jsxs("div",{className:"summary-row-print",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["",H.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row-print",children:[r.jsxs("span",{children:["Total Discount (",$.toFixed(2),"%)"]}),r.jsxs("span",{children:["- ",Q.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row-print",children:[r.jsx("span",{children:"GST (Included)"}),r.jsxs("span",{children:["",(J*.05).toFixed(2)]})]}),r.jsx("div",{className:"print-only-total",children:r.jsxs("strong",{children:["Grand Total: ",J.toFixed(2)]})})]})]})]}),r.jsx("aside",{className:"billing-sidebar no-print",children:r.jsxs("div",{className:"billing-summary-card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{children:"Billing Summary"})}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["",H.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Total Discount"}),r.jsxs("span",{children:["- ",Q.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Discount Percentage"}),r.jsxs("div",{className:"discount-input-wrapper",children:[r.jsx("input",{type:"number",value:$,onChange:fe=>V(parseFloat(fe.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:p||t.status==="billed"}),"%"]})]}),r.jsxs("div",{className:"summary-row grand-total-row",children:[r.jsx("strong",{children:"Grand Total"}),r.jsxs("strong",{children:["",J.toFixed(2)]})]}),r.jsx("div",{className:"qr-code-container",children:S?r.jsxs(r.Fragment,{children:[r.jsx(Fh,{value:S,size:128}),r.jsx("p",{children:"Scan to pay using UPI"})]}):r.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),r.jsxs("div",{className:"payment-mode-section",children:[r.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:r.jsx("strong",{children:"Payment Mode"})}),r.jsxs("select",{id:"paymentMode",value:b,onChange:fe=>v(fe.target.value),className:"payment-mode-select",disabled:p||t.status==="billed",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),r.jsx("option",{value:"credit",children:"Credit"})]})]}),r.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:te,className:"secondary-button print-preview-button no-print",disabled:p||a.length===0,children:"Print Preview"}),r.jsx("button",{onClick:W,className:"primary-button",disabled:p||a.length===0,children:p?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&r.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),r.jsxs("footer",{className:"billing-footer print-only",children:[r.jsx("p",{children:"Thank you for your business!"}),r.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):r.jsx("div",{className:"error-message-box",children:"No order data available."})},Jte=()=>{const e=kt(),n=cr(),[t,i]=w.useState(null),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState([]),[p,g]=w.useState(!0),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState("cash"),[M,I]=w.useState(""),[U,L]=w.useState(""),[F,z]=w.useState(""),[$,B]=w.useState(""),[R,V]=w.useState(""),[Y,ie]=w.useState(0),te=w.useRef(!1),W=D=>{const se=Math.max(0,Math.min(100,isNaN(D)?0:D));te.current=!0,ie(se);const be=f.map(ee=>({...ee,discount_percentage:se}));u(be)},H=(D,se)=>{const be=[...f];be[D].discount_percentage=isNaN(se)?0:se,u(be)};w.useEffect(()=>{if(te.current){te.current=!1;return}const D=f.reduce((ee,ce)=>ee+(ce.price??0),0);if(D===0){ie(0);return}const be=f.reduce((ee,ce)=>{const Pe=(ce.price??0)*((ce.discount_percentage??0)/100);return ee+Pe},0)/D*100;ie(ee=>Math.abs(ee-be)>.01?be:ee)},[f]);const Q=async()=>{if(!t)return v("No order data available to bill."),null;if(f.length===0)return v("Cannot bill an empty order."),null;k(!0),v(null);try{const D=f.map(re=>{const Pe=re.price,Qe=Pe*((re.discount_percentage??0)/100),Se=Pe-Qe;return{name:re.name,price:re.price,quantity:1,total:Se,item_id:re.id,type:"lab_test",discount_percentage:re.discount_percentage??0}}),se={patientId:t.patient_id,items:D,amount:ue,paymentMode:T,type:"lab",related_id:t.id,status:"paid",discountPercentage:Y},be=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(se)}),ee=await be.json();if(!be.ok||!ee.id)throw new Error(ee.message||"Failed to create bill.");const ce=await pe(`/api/lab/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ee.id})});if(!ce.ok){const re=await ce.text();throw new Error(`Failed to update lab order status: ${ce.statusText} - ${re}`)}return i(re=>re?{...re,status:"billed",bill_id:ee.id}:null),alert(`Lab Order bill created (ID: ${ee.id}) and marked as billed.`),e(`/dashboard/lab-billing/${t.id}`,{replace:!0,state:{...n.state,order:{...t,status:"billed",bill_id:ee.id}}}),ee.id}catch(D){return console.error("Billing process failed:",D),v(D.message||"Failed to mark order as billed. Please try again."),null}finally{k(!1)}},J=()=>{window.print()},fe=async()=>{await Q()&&(window.print(),e(-1))};w.useEffect(()=>{const D=n.pathname.split("/"),se=D[D.length-1];se?(async()=>{try{const ee=await pe(`/api/lab/${se}`);if(!ee.ok)throw new Error("Failed to fetch lab order details");const ce=await ee.json();if(i(ce),ce.patient_id){const Pe=await pe(`/api/patients/${ce.patient_id}`);if(Pe.ok){const Qe=await Pe.json();o(Qe.name),d(Qe.patient_token_number)}}const re=ce.tests.map(Pe=>({...Pe,price:typeof Pe.price=="string"?parseFloat(Pe.price):Number(Pe.price)||0,discount_percentage:0,total_price:typeof Pe.price=="string"?parseFloat(Pe.price):Number(Pe.price)||0}));u(re)}catch(ee){console.error("Failed to fetch order:",ee),v(ee.message||"Failed to load order details.")}finally{g(!1)}})():(v("No lab order ID provided."),g(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const se=await pe("/api/clinics/settings");if(!se.ok)throw new Error("Failed to fetch clinic settings");const be=await se.json();L(be.upi_id||""),z(be.name||""),B(be.address||""),V(be.notes||"")}catch(se){console.error("Error fetching clinic settings:",se)}})()},[]);const A=w.useMemo(()=>f.reduce((D,se)=>D+(se.price??0),0),[f]),oe=w.useMemo(()=>f.reduce((D,se)=>{const ee=(se.price??0)*(se.discount_percentage??0)/100;return D+ee},0),[f]),ue=w.useMemo(()=>A-oe,[A,oe]);return w.useEffect(()=>{if(ue>0&&U){const D=`upi://pay?pa=${U}&pn=ClinicName&am=${ue.toFixed(2)}&cu=INR`;I(D)}else I("")},[ue,U]),p?r.jsx("div",{className:"loading-pulse",children:"Loading Lab Bill..."}):b?r.jsxs("div",{className:"error-message-box",children:["Error: ",b]}):t?r.jsxs("div",{className:"pharmacy-billing-page",children:[" ",r.jsxs("div",{className:"billing-container printable-section",children:[r.jsxs("div",{className:"billing-header print-only",children:[r.jsx("div",{className:"clinic-header-left",children:r.jsx("div",{className:"clinic-info-print",children:r.jsxs("div",{className:"clinic-name-and-details-print",children:[r.jsx("h1",{className:"bill-title",children:"LAB INVOICE"}),r.jsx("h2",{className:"clinic-name-print",children:F?`${F} Lab`:"Lab Bill"}),($||R)&&r.jsxs("div",{className:"clinic-details-print",children:[$&&r.jsx("span",{className:"small-text clinic-address",children:$}),R&&r.jsx("span",{className:"small-text clinic-notes",children:R})]})]})})}),r.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(tu,{size:16})," Patient Name"]})," ",a]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Gm,{size:16})," Token"]})," ",l??"N/A"]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Qx,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),r.jsxs("header",{className:"billing-header no-print",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[r.jsx(nn,{size:20}),r.jsx("span",{children:"Back"})]}),r.jsx("h1",{children:"Lab Bill"})]}),r.jsxs("div",{className:"billing-layout",children:[r.jsxs("main",{className:"order-content",children:[r.jsxs("section",{className:"order-details-card no-print",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{children:"Patient Information"})}),r.jsxs("div",{className:"patient-info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(tu,{size:16})," Patient Name"]})," ",a]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Gm,{size:16})," Token"]})," ",l??"N/A"]}),r.jsxs("div",{className:"info-item no-print",children:[r.jsxs("strong",{children:[r.jsx(Od,{size:16})," Order ID"]})," ",t.id]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Qx,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),r.jsxs("section",{className:"medications-card",children:[r.jsx("div",{className:"card-header no-print",children:r.jsx("h2",{children:"Lab Tests"})}),f.length>0?r.jsxs("table",{className:"medications-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"S.No."}),r.jsx("th",{children:"TEST DESCRIPTION"}),r.jsx("th",{children:"PRICE"}),r.jsx("th",{children:"DIS %"}),r.jsx("th",{children:"AMT"})]})}),r.jsx("tbody",{children:f.map((D,se)=>{const be=D.price??0,ee=be*(D.discount_percentage??0)/100,ce=be-ee;return r.jsxs("tr",{children:[r.jsx("td",{children:se+1}),r.jsx("td",{children:D.name}),r.jsx("td",{children:typeof D.price=="number"?D.price.toFixed(2):Number(D.price||0).toFixed(2)}),r.jsxs("td",{children:[r.jsx("input",{type:"number",value:D.discount_percentage??0,onChange:re=>H(se,parseFloat(re.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),r.jsx("td",{children:ce.toFixed(2)})]},se)})})]}):r.jsx("p",{children:"No tests in this order."})]}),r.jsxs("div",{className:"bill-summary-print print-only",children:[M&&r.jsxs("div",{className:`qr-code-container qr-code-printable-section ${T!=="upi"?"hide-on-screen":""}`,children:[r.jsx(Fh,{value:M,size:100}),r.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),r.jsxs("div",{className:"bill-summary-details",children:[r.jsxs("div",{className:"summary-row-print",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["",A.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row-print",children:[r.jsxs("span",{children:["Total Discount (",Y.toFixed(2),"%)"]}),r.jsxs("span",{children:["- ",oe.toFixed(2)]})]}),r.jsx("div",{className:"print-only-total",children:r.jsxs("strong",{children:["Grand Total: ",ue.toFixed(2)]})})]})]})]}),r.jsx("aside",{className:"billing-sidebar no-print",children:r.jsxs("div",{className:"billing-summary-card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{children:"Billing Summary"})}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["",A.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Total Discount"}),r.jsxs("span",{children:["- ",oe.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Discount Percentage"}),r.jsxs("div",{className:"discount-input-wrapper",children:[r.jsx("input",{type:"number",value:Y,onChange:D=>W(parseFloat(D.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:S||t.status==="billed"}),"%"]})]}),r.jsxs("div",{className:"summary-row grand-total-row",children:[r.jsx("strong",{children:"Grand Total"}),r.jsxs("strong",{children:["",ue.toFixed(2)]})]}),r.jsx("div",{className:"qr-code-container",children:M?r.jsxs(r.Fragment,{children:[r.jsx(Fh,{value:M,size:128}),r.jsx("p",{children:"Scan to pay using UPI"})]}):r.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),r.jsxs("div",{className:"payment-mode-section",children:[r.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:r.jsx("strong",{children:"Payment Mode"})}),r.jsxs("select",{id:"paymentMode",value:T,onChange:D=>P(D.target.value),className:"payment-mode-select",disabled:S||t.status==="billed",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),r.jsx("option",{value:"credit",children:"Credit"})]})]}),r.jsxs("div",{className:"bill-actions",children:[t.status!=="billed"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:J,className:"secondary-button print-preview-button no-print",disabled:S||f.length===0,children:"Print Preview"}),r.jsx("button",{onClick:fe,className:"primary-button",disabled:S||f.length===0,children:S?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&r.jsx("button",{onClick:()=>e("/billing",{state:{billId:t.bill_id}}),className:"secondary-button",children:"View Bill"})]})]})})]}),r.jsxs("footer",{className:"billing-footer print-only",children:[r.jsx("p",{children:"Thank you for your business!"}),r.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})]}):r.jsx("div",{className:"error-message-box",children:"No order data available."})},Kte=()=>{const e=kt(),[n,t]=w.useState(!0),[i,a]=w.useState([]),[o,l]=w.useState(""),[d,f]=w.useState(!0),[u,p]=w.useState(!1),[g,b]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[v,S]=w.useState(null),k=(z,$)=>{S({type:z,message:$}),setTimeout(()=>S(null),3e3)},T=z=>{switch(z){case"doctor":return r.jsx(ok,{size:14,className:"text-blue-600"});case"receptionist":return r.jsx(aw,{size:14,className:"text-green-600"});case"pharmacy":return r.jsx(ig,{size:14,className:"text-purple-600"});case"lab":return r.jsx(Od,{size:14,className:"text-yellow-600"});default:return r.jsx(Sb,{size:14,className:"text-gray-500"})}},P=z=>{switch(z){case"doctor":return"avatar-blue";case"receptionist":return"avatar-green";case"pharmacy":return"avatar-purple";case"lab":return"avatar-yellow";default:return"avatar-gray"}},M=w.useCallback(async()=>{t(!0);try{const z=await pe("/staff");if(z.ok){const $=await z.json();a($.map(B=>({...B,id:B._id||B.id})))}}catch(z){console.error("Error fetching staff:",z),k("error","Failed to load staff list")}finally{t(!1)}},[]),I=w.useCallback(async()=>{f(!0);try{const z=await pe("/api/clinics/settings");if(z.ok){const $=await z.json();b({admissionCharge:parseFloat($.admissionCharge||0).toFixed(2),perDayCharge:parseFloat($.perDayCharge||0).toFixed(2),otherCharges:parseFloat($.otherCharges||0).toFixed(2),aiMemory:$.aiMemory||"",clinicWideSystemPrompt:$.clinicWideSystemPrompt||"",gemini_api_key:$.gemini_api_key||"",low_stock_threshold:$.low_stock_threshold!==void 0&&$.low_stock_threshold!==null?String($.low_stock_threshold):"10",name:$.name||"",logoUrl:$.logoUrl||"",upi_id:$.upi_id||"",address:$.address||"",notes:$.notes||""})}}catch(z){console.error("Error fetching settings:",z),k("error","Failed to load settings")}finally{f(!1)}},[]);w.useEffect(()=>{M(),I()},[M,I]);const U=z=>{const{name:$,value:B}=z.target;b(R=>({...R,[$]:B}))},L=async()=>{p(!0);try{const z=parseFloat(g.admissionCharge),$=parseFloat(g.perDayCharge),B=parseFloat(g.otherCharges),R=parseInt(g.low_stock_threshold);if((await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:g.name,admissionCharge:z,perDayCharge:$,otherCharges:B,aiMemory:g.aiMemory,clinicWideSystemPrompt:g.clinicWideSystemPrompt,gemini_api_key:g.gemini_api_key,low_stock_threshold:R,logoUrl:g.logoUrl,upi_id:g.upi_id,address:g.address,notes:g.notes})})).ok)k("success","Changes saved successfully");else throw new Error("Failed to save")}catch(z){console.error("Error saving settings:",z),k("error","Failed to save settings")}finally{p(!1)}},F=i.filter(z=>z.name.toLowerCase().includes(o.toLowerCase())||z.role.toLowerCase().includes(o.toLowerCase()));return r.jsxs("div",{className:"clinic-hub-container",children:[r.jsxs("header",{className:"clinic-hub-header",children:[r.jsxs("div",{className:"clinic-hub-title",children:[r.jsx("h1",{children:"Clinic Hub"}),r.jsx("p",{className:"clinic-hub-subtitle",children:"Manage your ecosystem"})]}),r.jsxs("div",{className:"clinic-hub-actions",children:[v&&r.jsx("div",{className:`px-4 py-2 rounded-md text-sm font-medium ${v.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.message}),r.jsxs("button",{className:"btn-add-staff",onClick:()=>e("/dashboard/staff/add"),children:[r.jsx(Zc,{size:16})," Add Staff"]}),r.jsxs("button",{className:"btn-save-changes",onClick:L,disabled:u,children:[r.jsx(Fd,{size:16})," ",u?"Saving...":"Save Changes"]})]})]}),r.jsxs("main",{className:"clinic-hub-content",children:[r.jsxs("div",{className:"team-directory-panel",children:[r.jsxs("div",{className:"panel-header",children:[r.jsx(rg,{size:18,className:"text-gray-500"}),r.jsxs("span",{className:"panel-title",children:["Team Directory (",i.length,")"]})]}),r.jsx("div",{className:"search-container",children:r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx(us,{size:16,className:"search-icon"}),r.jsx("input",{type:"text",placeholder:"Find member...",className:"search-input",value:o,onChange:z=>l(z.target.value)})]})}),r.jsx("div",{className:"team-list",children:n?r.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading staff..."}):F.length===0?r.jsx("div",{className:"empty-state",children:"No staff found."}):F.map(z=>r.jsxs("div",{className:"team-member-item",children:[r.jsx("div",{className:`member-avatar ${P(z.role)}`,children:z.name.charAt(0).toUpperCase()}),r.jsxs("div",{className:"member-info",children:[r.jsx("div",{className:"member-name",children:z.name}),r.jsxs("div",{className:"member-role",children:[T(z.role),z.role]})]}),r.jsx("span",{className:`member-status ${z.active?"status-active":"status-inactive"}`,children:z.active?"Active":"Inactive"}),r.jsx("button",{className:"btn-edit-member",onClick:()=>e(`/dashboard/staff/edit/${z.id}`),children:r.jsx(eu,{size:16})})]},z.id))})]}),r.jsxs("div",{className:"config-console-panel",children:[r.jsxs("div",{className:"panel-header",children:[r.jsx(rk,{size:18,className:"text-gray-500"}),r.jsx("span",{className:"panel-title",children:"Configuration Console"})]}),d?r.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading settings..."}):r.jsxs("div",{className:"config-content",children:[r.jsxs("div",{className:"config-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx(nR,{size:16})," CLINIC IDENTITY & LOCATION"]}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Clinic Name"}),r.jsx("input",{type:"text",className:"form-input",name:"name",value:g.name,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Logo URL"}),r.jsx("input",{type:"url",className:"form-input",placeholder:"https://",name:"logoUrl",value:g.logoUrl,onChange:U})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{className:"form-label",children:"Address"}),r.jsx("textarea",{className:"form-textarea",placeholder:"Full physical address",name:"address",value:g.address,onChange:U})]})]})]}),r.jsxs("div",{className:"config-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx(Dh,{size:16})," FINANCIAL OPERATIONS"]}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Admission Charge ()"}),r.jsx("input",{type:"number",className:"form-input",name:"admissionCharge",value:g.admissionCharge,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Per Day Charge ()"}),r.jsx("input",{type:"number",className:"form-input",name:"perDayCharge",value:g.perDayCharge,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Other Charges ()"}),r.jsx("input",{type:"number",className:"form-input",name:"otherCharges",value:g.otherCharges,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"UPI ID"}),r.jsx("input",{type:"text",className:"form-input",name:"upi_id",value:g.upi_id,onChange:U})]})]})]}),r.jsxs("div",{className:"config-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx(tk,{size:16})," INVENTORY & AI"]}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Low Stock Threshold"}),r.jsx("input",{type:"number",className:"form-input",name:"low_stock_threshold",value:g.low_stock_threshold,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Gemini API Key"}),r.jsx("input",{type:"password",className:"form-input",name:"gemini_api_key",value:g.gemini_api_key,onChange:U,placeholder:"******************"})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{className:"form-label",children:"Clinic-Wide System Prompt"}),r.jsx("textarea",{className:"form-textarea",name:"clinicWideSystemPrompt",value:g.clinicWideSystemPrompt,onChange:U,placeholder:"Instructions for the AI..."})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{className:"form-label",children:"AI Memory (Context)"}),r.jsx("textarea",{className:"form-textarea",name:"aiMemory",value:g.aiMemory,onChange:U,placeholder:"Shared context for the AI..."})]})]})]})]})]})]})]})},Xte="_container_nftcg_1",Zte="_header_nftcg_15",ene="_title_nftcg_37",tne="_controls_nftcg_51",nne="_dateInputGroup_nftcg_63",ine="_dateInputLabel_nftcg_75",rne="_dateInput_nftcg_63",ane="_fetchButton_nftcg_117",sne="_section_nftcg_159",one="_sectionTitle_nftcg_175",lne="_statsGrid_nftcg_195",cne="_statCard_nftcg_209",une="_statTitle_nftcg_235",dne="_statValue_nftcg_251",fne="_statSubtitle_nftcg_263",hne="_revenueGrid_nftcg_277",pne="_revenueCard_nftcg_291",mne="_revenueCardTitle_nftcg_305",gne="_revenueCardList_nftcg_319",yne="_revenueCardListItem_nftcg_331",xne="_tableContainer_nftcg_359",bne="_table_nftcg_359",vne="_textGreen_nftcg_433",wne="_textRed_nftcg_441",Sne="_loadingContainer_nftcg_459",Nne="_errorAlert_nftcg_477",Ht={container:Xte,header:Zte,title:ene,controls:tne,dateInputGroup:nne,dateInputLabel:ine,dateInput:rne,fetchButton:ane,section:sne,sectionTitle:one,statsGrid:lne,statCard:cne,statTitle:une,statValue:dne,statSubtitle:fne,revenueGrid:hne,revenueCard:pne,revenueCardTitle:mne,revenueCardList:gne,revenueCardListItem:yne,tableContainer:xne,table:bne,textGreen:vne,textRed:wne,loadingContainer:Sne,errorAlert:Nne},Cne=()=>{const e=kt(),n=new Date().toISOString().split("T")[0],[t,i]=w.useState(n),[a,o]=w.useState(n),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(0),[b,v]=w.useState(0),[S,k]=w.useState(null),[T,P]=w.useState(null),[M,I]=w.useState({reception:{},pharmacy:{},lab:{}}),[U,L]=w.useState(null),F=async()=>{if(d(!0),u(null),g(0),v(0),k(null),P(null),I({reception:{},pharmacy:{},lab:{}}),L(null),!t||!a){u("Please select both start and end dates."),d(!1);return}try{const $=jB(),[B,R,V,Y]=await Promise.all([pe(`/api/bills?startDate=${t}&endDate=${a}`),pe(`/api/payment/admission?startDate=${t}&endDate=${a}`),pe(`/api/subscriptions/transactions/manual?startDate=${t}&endDate=${a}`),$?pe(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${$}`):Promise.resolve(null)]);if(B.ok&&R.ok&&V.ok){const ie=await B.json(),te=await R.json(),W=await V.json(),H=ie.bills||[],Q=te.admissionPayments||[],J=W||[];let fe=0,A=0;const oe={},ue={consultation:0,pharmacy:0,lab:0,other:0},D={reception:{},pharmacy:{},lab:{}};H.forEach(se=>{if(se.status==="paid"||se.type==="pharmacy_return"){const be=parseFloat(se.amount.toString()),ee=se.payment_mode||"Unknown";let ce=se.type||"other";ce==="pharmacy_return"&&(A+=be,ce="pharmacy"),fe+=be,oe[ee]=(oe[ee]||0)+be,ue.hasOwnProperty(ce)?ue[ce]=(ue[ce]||0)+be:ue.other=(ue.other||0)+be,ce==="pharmacy"?D.pharmacy[ee]=(D.pharmacy[ee]||0)+be:ce==="lab"?D.lab[ee]=(D.lab[ee]||0)+be:D.reception[ee]=(D.reception[ee]||0)+be}}),Q.forEach(se=>{const be=parseFloat(se.amount_paid.toString()),ee=se.payment_mode||"Unknown";fe+=be,oe[ee]=(oe[ee]||0)+be,D.reception[ee]=(D.reception[ee]||0)+be}),J.forEach(se=>{var ce,re;const be=parseFloat(((re=(ce=se.subscriptionPlan)==null?void 0:ce.price)==null?void 0:re.toString())??"0"),ee=se.subscription_payment_method||"manual";fe+=be,oe[ee]=(oe[ee]||0)+be,D.reception[ee]=(D.reception[ee]||0)+be}),g(fe),v(A),k(oe),P(ue),I(D)}if(Y&&Y.ok){const ie=await Y.json();L(ie)}}catch($){console.error("Analysis Fetch Error:",$),u("Failed to fetch analysis data. Please try again.")}finally{d(!1)}},z=$=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format($);return r.jsxs("div",{className:Ht.container,children:[r.jsxs("div",{className:Ht.header,children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-gray-100 rounded-full",children:r.jsx(nn,{size:20,className:"text-gray-600"})}),r.jsx("h1",{className:Ht.title,children:"Analysis Dashboard"})]}),r.jsxs("div",{className:Ht.controls,children:[r.jsxs("div",{className:Ht.dateInputGroup,children:[r.jsx("label",{className:Ht.dateInputLabel,children:"From:"}),r.jsx("input",{type:"date",className:Ht.dateInput,value:t,onChange:$=>i($.target.value)})]}),r.jsxs("div",{className:Ht.dateInputGroup,children:[r.jsx("label",{className:Ht.dateInputLabel,children:"To:"}),r.jsx("input",{type:"date",className:Ht.dateInput,value:a,onChange:$=>o($.target.value)})]}),r.jsx("button",{className:Ht.fetchButton,onClick:F,disabled:l,children:l?"Refreshing...":r.jsxs(r.Fragment,{children:[r.jsx(Jx,{size:16,className:"inline mr-2"})," Refresh Analysis"]})})]})]}),f&&r.jsxs("div",{className:Ht.errorAlert,children:[r.jsx(Ki,{size:20}),r.jsx("span",{children:f})]}),!l&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("section",{className:Ht.section,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(Dh,{className:"text-blue-600"}),r.jsx("h2",{className:Ht.sectionTitle,children:"Financial Performance"})]}),r.jsxs("div",{className:Ht.statsGrid,children:[r.jsxs("div",{className:Ht.statCard,children:[r.jsx("div",{className:Ht.statTitle,children:"Total Revenue Collected"}),r.jsx("div",{className:`${Ht.statValue} text-blue-600`,children:z(p)}),r.jsx("div",{className:Ht.statSubtitle,children:"All payment modes"})]}),S&&Object.entries(S).map(([$,B])=>r.jsxs("div",{className:Ht.statCard,children:[r.jsxs("div",{className:Ht.statTitle,children:[$," Collections"]}),r.jsx("div",{className:Ht.statValue,children:z(B)})]},$))]}),M&&r.jsxs("div",{className:Ht.revenueGrid,children:[r.jsxs("div",{className:Ht.revenueCard,children:[r.jsx("h3",{className:Ht.revenueCardTitle,children:"Reception / Clinic"}),r.jsx("div",{className:"text-2xl font-bold mb-2",children:z(((T==null?void 0:T.consultation)||0)+((T==null?void 0:T.other)||0))}),r.jsx("ul",{className:Ht.revenueCardList,children:Object.entries(M.reception).map(([$,B])=>r.jsxs("li",{className:Ht.revenueCardListItem,children:[r.jsx("span",{children:$}),r.jsx("span",{className:"font-medium text-gray-900",children:z(B)})]},$))})]}),r.jsxs("div",{className:Ht.revenueCard,children:[r.jsx("h3",{className:Ht.revenueCardTitle,children:"Pharmacy"}),r.jsx("div",{className:"text-2xl font-bold mb-2",children:z((T==null?void 0:T.pharmacy)||0)}),b<0&&r.jsxs("div",{className:"text-sm text-red-500 mb-2",children:["Returns: ",z(b)]}),r.jsx("ul",{className:Ht.revenueCardList,children:Object.entries(M.pharmacy).map(([$,B])=>r.jsxs("li",{className:Ht.revenueCardListItem,children:[r.jsx("span",{children:$}),r.jsx("span",{className:"font-medium text-gray-900",children:z(B)})]},$))})]}),r.jsxs("div",{className:Ht.revenueCard,children:[r.jsx("h3",{className:Ht.revenueCardTitle,children:"Laboratory"}),r.jsx("div",{className:"text-2xl font-bold mb-2",children:z((T==null?void 0:T.lab)||0)}),r.jsx("ul",{className:Ht.revenueCardList,children:Object.entries(M.lab).map(([$,B])=>r.jsxs("li",{className:Ht.revenueCardListItem,children:[r.jsx("span",{children:$}),r.jsx("span",{className:"font-medium text-gray-900",children:z(B)})]},$))})]})]})]}),r.jsxs("section",{className:Ht.section,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(Ld,{className:"text-emerald-600"}),r.jsx("h2",{className:Ht.sectionTitle,children:"Inventory Movement"})]}),U&&U.pharmacyAnalysis.length>0?r.jsx("div",{className:Ht.tableContainer,children:r.jsxs("table",{className:Ht.table,children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Item Name"}),r.jsx("th",{children:"Stock In"}),r.jsx("th",{children:"Stock Out"}),r.jsx("th",{children:"Net Change"}),r.jsx("th",{className:"text-right",children:"Est. Revenue"}),r.jsx("th",{className:"text-right",children:"Est. Profit"})]})}),r.jsx("tbody",{children:U.pharmacyAnalysis.map($=>r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:$.name}),r.jsx("div",{className:"text-xs text-gray-500",children:$.supplier})]}),r.jsxs("td",{className:Ht.textGreen,children:["+",$.quantity_in,Object.entries($.quantity_in_by_reason).map(([B,R])=>r.jsxs("div",{className:"text-xs opacity-75",children:[B,": ",R]},B))]}),r.jsxs("td",{className:Ht.textRed,children:["-",$.quantity_out,Object.entries($.quantity_out_by_reason).map(([B,R])=>r.jsxs("div",{className:"text-xs opacity-75",children:[B,": ",R]},B))]}),r.jsx("td",{children:r.jsxs("span",{className:`font-semibold ${$.net_change>=0?"text-green-600":"text-red-600"}`,children:[$.net_change>0?"+":"",$.net_change]})}),r.jsx("td",{className:"text-right font-medium",children:z($.revenue)}),r.jsx("td",{className:`text-right font-medium ${$.profit>=0?"text-green-600":"text-red-600"}`,children:z($.profit)})]},$.drug_id))})]})}):r.jsx("div",{className:"text-center py-8 text-gray-500 mb-4 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No inventory movement recorded for this period."})]})]}),l&&r.jsxs("div",{className:Ht.loadingContainer,children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),r.jsx("div",{children:"Analyzing Financial & Inventory Data..."})]})]})};function jne(){const[e,n]=w.useState(!1),[t,i]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),p=I=>{i(I),n(!0),I.role==="admin"&&!I.has_seen_tutorial&&u(!0)},g=()=>{n(!1),i(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const I=localStorage.getItem("authToken"),U=localStorage.getItem("currentUser");if(I&&U)try{const L=JSON.parse(U);i(L),n(!0),L.role==="admin"&&!L.has_seen_tutorial&&u(!0)}catch(L){console.error("Error parsing stored user data:",L),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}o(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const U=await yte();d(U)}catch(U){console.error("Error fetching clinic pro plan status:",U),d({hasProPlan:!1})}else d(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const I=U=>{U.preventDefault(),v(U),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",I),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",I)}},[]),w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),U=()=>{I.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return U(),I.addEventListener("change",U),()=>{I.removeEventListener("change",U),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const I=b;I.prompt();const{outcome:U}=await I.userChoice;console.log(`User response to the install prompt: ${U}`),v(null),k(!1)},[b]),P=async()=>{if(t)try{(await pe(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(i(U=>U?{...U,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),u(!1)):console.error("Failed to update tutorial status on backend.")}catch(I){console.error("Error marking tutorial as seen:",I)}};return a?r.jsx("div",{children:"Loading..."}):r.jsx(lP,{clientId:"277898779560-33obduhn8r758rini4qagetdrupvisri.apps.googleusercontent.com",children:r.jsxs(_D,{children:[r.jsx(LD,{children:r.jsxs(wh,{children:[r.jsx(pt,{path:"/login",element:e?r.jsx(pn,{to:"/dashboard"}):r.jsx(UD,{onLoginSuccess:p})}),r.jsx(pt,{path:"/register",element:e?r.jsx(pn,{to:"/dashboard"}):r.jsx(BD,{})}),r.jsx(pt,{path:"/handle-complaint-url",element:e?r.jsx(Vte,{}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/live-api",element:e?r.jsx(OB,{}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/create-lab-order",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(QT,{currentUser:t})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/manage-admission",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(YT,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/lab/report/:orderId",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(A_,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/lab/enter-report/:orderId",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(A_,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/add-patient",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(C1,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/billing",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Cee,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?r.jsx(k_,{}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/edit-complaint/patient/:patientId",element:e&&t?r.jsx(k_,{}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(hA,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/*",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:_ne(t.role,t,pe)}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/lab/view-report/:orderId",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Mee,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/lab/search-report",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Oee,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/patient/:patientId/lab-reports",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Lee,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(jee,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/inventory",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(pA,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/inventory/add",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(vq,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/inventory/edit/:id",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(r2,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/lab-inventory",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Nw,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/patient/:patientId/complaints",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(See,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Uee,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/start-subscription/:patientId",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(lte,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/start-clinic-subscription",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(wte,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/refill-reminders",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(qte,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/notifications",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Hte,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/create-custom-bill",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(WT,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Qte,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/lab-billing/:orderId",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Jte,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/analysis",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Cne,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/clinic-hub",element:e&&t?r.jsx(Gn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Kte,{})}):r.jsx(pn,{to:"/login"})}),r.jsx(pt,{path:"*",element:r.jsx(pn,{to:e?"/dashboard":"/login"})})]})}),f&&r.jsx(Ute,{onClose:()=>u(!1),onMarkAsSeen:P})]})})}const _ne=(e,n,t)=>{switch(e){case"superadmin":return r.jsxs(wh,{children:[r.jsx(pt,{index:!0,element:r.jsx(Fte,{})}),r.jsx(pt,{path:"clinic-subscriptions",element:r.jsx(xte,{})}),r.jsx(pt,{path:"clinic-subscriptions/add",element:r.jsx(bte,{})}),r.jsx(pt,{path:"clinic-subscriptions/edit/:id",element:r.jsx(vte,{})}),r.jsx(pt,{path:"users",element:r.jsx(Ste,{})})," ",r.jsx(pt,{path:"*",element:r.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return r.jsxs(wh,{children:[r.jsx(pt,{index:!0,element:r.jsx(VB,{fetchWithAuth:t})}),r.jsx(pt,{path:"staff",element:r.jsx(zee,{fetchWithAuth:t})}),r.jsx(pt,{path:"staff/add",element:r.jsx(wq,{clinicId:n==null?void 0:n.clinic_id})}),r.jsx(pt,{path:"staff/edit/:id",element:r.jsx(Sq,{})}),r.jsx(pt,{path:"patients/add",element:r.jsx(C1,{})}),r.jsx(pt,{path:"search-patient",element:r.jsx(jh,{})}),r.jsx(pt,{path:"patients",element:r.jsx(S1,{})}),r.jsx(pt,{path:"inventory",element:r.jsx(i2,{})}),r.jsx(pt,{path:"inventory/edit/:id",element:r.jsx(r2,{})}),r.jsx(pt,{path:"distributors",element:r.jsx(D_,{})}),r.jsx(pt,{path:"purchase",element:r.jsx(I_,{})})," ",r.jsx(pt,{path:"queue",element:r.jsx(c0,{})}),r.jsx(pt,{path:"subscriptions",element:r.jsx(ate,{})}),r.jsx(pt,{path:"subscriptions/add",element:r.jsx(ste,{})}),r.jsx(pt,{path:"subscriptions/edit/:id",element:r.jsx(ote,{})}),r.jsx(pt,{path:"*",element:r.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return r.jsxs(wh,{children:[r.jsx(pt,{index:!0,element:r.jsx(pn,{to:"search-patient",replace:!0})}),r.jsx(pt,{path:"search-patient",element:r.jsx(jh,{})}),r.jsx(pt,{path:"queue",element:r.jsx(c0,{})}),r.jsx(pt,{path:":patientId",element:r.jsx(c0,{})}),r.jsx(pt,{path:"add-patient",element:r.jsx(C1,{})}),r.jsx(pt,{path:"*",element:r.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return r.jsxs(wh,{children:[r.jsx(pt,{index:!0,element:r.jsx(GB,{currentUser:n})}),r.jsx(pt,{path:"all-patients",element:r.jsx(S1,{})}),r.jsx(pt,{path:"search-patient",element:r.jsx(jh,{})}),r.jsx(pt,{path:"*",element:r.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return r.jsx(gq,{});case"pharmacy":return r.jsxs(wh,{children:[r.jsx(pt,{index:!0,element:r.jsx(yq,{})}),r.jsx(pt,{path:"inventory",element:r.jsx(pA,{})}),r.jsx(pt,{path:"settings",element:r.jsx(bq,{})}),r.jsx(pt,{path:"add-order",element:r.jsx(_ee,{})}),r.jsx(pt,{path:"edit-pharmacy-order/:orderId",element:r.jsx(hA,{})}),r.jsx(pt,{path:"orders/:orderId",element:r.jsx(Xee,{})}),r.jsx(pt,{path:"search-patient-records",element:r.jsx(jh,{})}),r.jsx(pt,{path:"distributors",element:r.jsx(D_,{})}),r.jsx(pt,{path:"purchase",element:r.jsx(I_,{})})," ",r.jsx(pt,{path:"*",element:r.jsx(pn,{to:"/dashboard",replace:!0})})]});default:return r.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},Gn=({user:e,onLogout:n,children:t,showInstallPrompt:i,onInstallClick:a,clinicProPlanStatus:o})=>{const l=kt(),[d,f]=w.useState(!1),[u,p]=w.useState(window.innerWidth<=768),[g,b]=w.useState(!1),[v,S]=w.useState([]),[k,T]=w.useState(0),[P,M]=w.useState(!1),[I,U]=w.useState("Newtons Ai"),[L,F]=w.useState(null),[z,$]=w.useState(!1);w.useEffect(()=>Q0.subscribe(W=>{$(W)}),[]);const B=w.useRef(null);w.useEffect(()=>{const W=()=>{p(window.innerWidth<=768)};return window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]);const R=w.useCallback(async()=>{try{const W=await pe("/api/notifications");if(W.ok){const J=(await W.json()).reduce((fe,A)=>{const oe=fe.find(ue=>ue.message===A.message);return oe?new Date(A.created_at)>new Date(oe.created_at)?fe.map(ue=>ue.message===A.message?A:ue):fe:[...fe,A]},[]).sort((fe,A)=>{const oe={expired_drug:1,near_expiry_drug:2,low_stock:3},ue=oe[fe.type]||99,D=oe[A.type]||99;return ue!==D?ue-D:new Date(A.created_at).getTime()-new Date(fe.created_at).getTime()});S(J),T(J.filter(fe=>!fe.is_read).length)}else console.error("Failed to fetch notifications:",W.statusText)}catch(W){console.error("Error fetching notifications:",W)}},[]);w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const H=await pe("/api/clinics/settings");if(H.ok){const Q=await H.json();Q.name===""?U("Newtons Ai"):U(Q.name),F(Q.logoUrl)}else console.error("Failed to fetch clinic details for display:",H.statusText),U("Newtons Ai"),F(null)}catch(H){console.error("Error fetching clinic details for display:",H),U("Newtons Ai"),F(null)}else U("Newtons Ai"),F(null)})()},[e==null?void 0:e.clinic_id]),w.useEffect(()=>{if(e!=null&&e.clinic_id){R();const W=setInterval(R,5*60*1e3);return()=>clearInterval(W)}},[e==null?void 0:e.clinic_id,R]);const V=()=>{f(!d),d||b(!1)},Y=()=>{b(!g),g||f(!1)};w.useEffect(()=>{const W=H=>{B.current&&!B.current.contains(H.target)&&g&&b(!1)};return g&&document.addEventListener("mousedown",W),()=>{document.removeEventListener("mousedown",W)}},[g]);const ie=async W=>{try{const H=await pe(`/api/notifications/${W}/read`,{method:"PUT"});H.ok?R():console.error("Failed to mark notification as read:",H.statusText)}catch(H){console.error("Error marking notification as read:",H)}},te=async()=>{M(!0);try{const W=await pe("/api/notifications/trigger-all",{method:"POST"});W.ok?(console.log("Notification checks triggered successfully."),await R()):console.error("Failed to trigger notification checks:",W.statusText)}catch(W){console.error("Error triggering notification checks:",W)}finally{M(!1)}};return r.jsxs("div",{className:"dashboard-layout",children:[" ",r.jsxs("nav",{className:"app-header no-print",children:[r.jsxs("div",{className:"header-left",children:[r.jsx("a",{href:"#",onClick:W=>{W.preventDefault(),l("/dashboard")},className:"logo-container",children:r.jsx("img",{src:L||"/logo.png",alt:"App Logo",className:"logo-image"})}),r.jsxs("div",{className:"title-section",children:[r.jsx("span",{className:"app-title-link",children:I}),r.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),r.jsxs("div",{className:"header-right",children:[i&&r.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),r.jsx("span",{children:"Install"})]}),o&&(o.hasProPlan?r.jsx("span",{className:"pro-badge",children:"PRO"}):r.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),r.jsxs("div",{className:"notifications-section",ref:B,children:[" ",r.jsxs("button",{className:"notification-icon","aria-label":"Notifications",onClick:Y,children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),k>0&&r.jsx("span",{className:"notification-count",children:k})]}),g&&r.jsxs("div",{className:"notifications-dropdown",children:[r.jsx("div",{className:"dropdown-header",children:"Notifications"}),r.jsx("ul",{className:"dropdown-list",children:v.length>0?v.map(W=>r.jsxs("li",{className:`dropdown-item ${W.is_read?"read":"unread"}`,onClick:()=>ie(W.id),children:[W.message,r.jsx("span",{className:"notification-timestamp",children:new Date(W.created_at).toLocaleString()})]},W.id)):r.jsx("li",{className:"dropdown-item",children:"No new notifications"})}),r.jsxs("div",{className:"dropdown-footer",children:[r.jsx("button",{onClick:()=>l("/dashboard/notifications"),children:"View All"}),(e.role==="admin"||e.role==="superadmin")&&r.jsx("button",{onClick:te,className:"fetch-all-button",disabled:P,children:P?"Fetching...":"Fetch All"})]})]})]}),r.jsx("button",{className:"hamburger-icon",onClick:V,"aria-label":"Open navigation",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]}),z&&r.jsx("div",{className:"global-loading-bar"})]}),r.jsx("main",{className:"main-content",children:t}),u?r.jsx(KD,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:V,roleNavigation:Z_}):r.jsx(JD,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:V}),!u&&d&&r.jsx("div",{className:"side-panel-overlay",onClick:V})]})};sP.createRoot(document.getElementById("root")).render(r.jsx(w.StrictMode,{children:r.jsx(jne,{})}));
