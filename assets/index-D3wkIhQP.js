var hA=Object.defineProperty;var pA=(e,n,t)=>n in e?hA(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var ri=(e,n,t)=>pA(e,typeof n!="symbol"?n+"":n,t);function mA(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();var lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var L0={exports:{}},Tm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nN;function gA(){if(nN)return Tm;nN=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,l){var o=null;if(l!==void 0&&(o=""+l),a.key!==void 0&&(o=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:e,type:r,key:o,ref:a!==void 0?a:null,props:l}}return Tm.Fragment=n,Tm.jsx=t,Tm.jsxs=t,Tm}var iN;function yA(){return iN||(iN=1,L0.exports=gA()),L0.exports}var i=yA(),O0={exports:{}},cn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rN;function xA(){if(rN)return cn;rN=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function b(E){return E===null||typeof E!="object"?null:(E=g&&E[g]||E["@@iterator"],typeof E=="function"?E:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,C={};function A(E,Q,ie){this.props=E,this.context=Q,this.refs=C,this.updater=ie||v}A.prototype.isReactComponent={},A.prototype.setState=function(E,Q){if(typeof E!="object"&&typeof E!="function"&&E!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,E,Q,"setState")},A.prototype.forceUpdate=function(E){this.updater.enqueueForceUpdate(this,E,"forceUpdate")};function T(){}T.prototype=A.prototype;function D(E,Q,ie){this.props=E,this.context=Q,this.refs=C,this.updater=ie||v}var M=D.prototype=new T;M.constructor=D,N(M,A.prototype),M.isPureReactComponent=!0;var V=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},z=Object.prototype.hasOwnProperty;function B(E,Q,ie,I,ce,xe){return ie=xe.ref,{$$typeof:e,type:E,key:Q,ref:ie!==void 0?ie:null,props:xe}}function U(E,Q){return B(E.type,Q,void 0,void 0,void 0,E.props)}function R(E){return typeof E=="object"&&E!==null&&E.$$typeof===e}function O(E){var Q={"=":"=0",":":"=2"};return"$"+E.replace(/[=:]/g,function(ie){return Q[ie]})}var $=/\/+/g;function W(E,Q){return typeof E=="object"&&E!==null&&E.key!=null?O(""+E.key):Q.toString(36)}function te(){}function ne(E){switch(E.status){case"fulfilled":return E.value;case"rejected":throw E.reason;default:switch(typeof E.status=="string"?E.then(te,te):(E.status="pending",E.then(function(Q){E.status==="pending"&&(E.status="fulfilled",E.value=Q)},function(Q){E.status==="pending"&&(E.status="rejected",E.reason=Q)})),E.status){case"fulfilled":return E.value;case"rejected":throw E.reason}}throw E}function re(E,Q,ie,I,ce){var xe=typeof E;(xe==="undefined"||xe==="boolean")&&(E=null);var le=!1;if(E===null)le=!0;else switch(xe){case"bigint":case"string":case"number":le=!0;break;case"object":switch(E.$$typeof){case e:case n:le=!0;break;case h:return le=E._init,re(le(E._payload),Q,ie,I,ce)}}if(le)return ce=ce(E),le=I===""?"."+W(E,0):I,V(ce)?(ie="",le!=null&&(ie=le.replace($,"$&/")+"/"),re(ce,Q,ie,"",function(Re){return Re})):ce!=null&&(R(ce)&&(ce=U(ce,ie+(ce.key==null||E&&E.key===ce.key?"":(""+ce.key).replace($,"$&/")+"/")+le)),Q.push(ce)),1;le=0;var ge=I===""?".":I+":";if(V(E))for(var ye=0;ye<E.length;ye++)I=E[ye],xe=ge+W(I,ye),le+=re(I,Q,ie,xe,ce);else if(ye=b(E),typeof ye=="function")for(E=ye.call(E),ye=0;!(I=E.next()).done;)I=I.value,xe=ge+W(I,ye++),le+=re(I,Q,ie,xe,ce);else if(xe==="object"){if(typeof E.then=="function")return re(ne(E),Q,ie,I,ce);throw Q=String(E),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return le}function J(E,Q,ie){if(E==null)return E;var I=[],ce=0;return re(E,I,"","",function(xe){return Q.call(ie,xe,ce++)}),I}function q(E){if(E._status===-1){var Q=E._result;Q=Q(),Q.then(function(ie){(E._status===0||E._status===-1)&&(E._status=1,E._result=ie)},function(ie){(E._status===0||E._status===-1)&&(E._status=2,E._result=ie)}),E._status===-1&&(E._status=0,E._result=Q)}if(E._status===1)return E._result.default;throw E._result}var H=typeof reportError=="function"?reportError:function(E){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof E=="object"&&E!==null&&typeof E.message=="string"?String(E.message):String(E),error:E});if(!window.dispatchEvent(Q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",E);return}console.error(E)};function ee(){}return cn.Children={map:J,forEach:function(E,Q,ie){J(E,function(){Q.apply(this,arguments)},ie)},count:function(E){var Q=0;return J(E,function(){Q++}),Q},toArray:function(E){return J(E,function(Q){return Q})||[]},only:function(E){if(!R(E))throw Error("React.Children.only expected to receive a single React element child.");return E}},cn.Component=A,cn.Fragment=t,cn.Profiler=a,cn.PureComponent=D,cn.StrictMode=r,cn.Suspense=u,cn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,cn.__COMPILER_RUNTIME={__proto__:null,c:function(E){return F.H.useMemoCache(E)}},cn.cache=function(E){return function(){return E.apply(null,arguments)}},cn.cloneElement=function(E,Q,ie){if(E==null)throw Error("The argument must be a React element, but you passed "+E+".");var I=N({},E.props),ce=E.key,xe=void 0;if(Q!=null)for(le in Q.ref!==void 0&&(xe=void 0),Q.key!==void 0&&(ce=""+Q.key),Q)!z.call(Q,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&Q.ref===void 0||(I[le]=Q[le]);var le=arguments.length-2;if(le===1)I.children=ie;else if(1<le){for(var ge=Array(le),ye=0;ye<le;ye++)ge[ye]=arguments[ye+2];I.children=ge}return B(E.type,ce,void 0,void 0,xe,I)},cn.createContext=function(E){return E={$$typeof:o,_currentValue:E,_currentValue2:E,_threadCount:0,Provider:null,Consumer:null},E.Provider=E,E.Consumer={$$typeof:l,_context:E},E},cn.createElement=function(E,Q,ie){var I,ce={},xe=null;if(Q!=null)for(I in Q.key!==void 0&&(xe=""+Q.key),Q)z.call(Q,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(ce[I]=Q[I]);var le=arguments.length-2;if(le===1)ce.children=ie;else if(1<le){for(var ge=Array(le),ye=0;ye<le;ye++)ge[ye]=arguments[ye+2];ce.children=ge}if(E&&E.defaultProps)for(I in le=E.defaultProps,le)ce[I]===void 0&&(ce[I]=le[I]);return B(E,xe,void 0,void 0,null,ce)},cn.createRef=function(){return{current:null}},cn.forwardRef=function(E){return{$$typeof:f,render:E}},cn.isValidElement=R,cn.lazy=function(E){return{$$typeof:h,_payload:{_status:-1,_result:E},_init:q}},cn.memo=function(E,Q){return{$$typeof:d,type:E,compare:Q===void 0?null:Q}},cn.startTransition=function(E){var Q=F.T,ie={};F.T=ie;try{var I=E(),ce=F.S;ce!==null&&ce(ie,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(ee,H)}catch(xe){H(xe)}finally{F.T=Q}},cn.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},cn.use=function(E){return F.H.use(E)},cn.useActionState=function(E,Q,ie){return F.H.useActionState(E,Q,ie)},cn.useCallback=function(E,Q){return F.H.useCallback(E,Q)},cn.useContext=function(E){return F.H.useContext(E)},cn.useDebugValue=function(){},cn.useDeferredValue=function(E,Q){return F.H.useDeferredValue(E,Q)},cn.useEffect=function(E,Q,ie){var I=F.H;if(typeof ie=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return I.useEffect(E,Q)},cn.useId=function(){return F.H.useId()},cn.useImperativeHandle=function(E,Q,ie){return F.H.useImperativeHandle(E,Q,ie)},cn.useInsertionEffect=function(E,Q){return F.H.useInsertionEffect(E,Q)},cn.useLayoutEffect=function(E,Q){return F.H.useLayoutEffect(E,Q)},cn.useMemo=function(E,Q){return F.H.useMemo(E,Q)},cn.useOptimistic=function(E,Q){return F.H.useOptimistic(E,Q)},cn.useReducer=function(E,Q,ie){return F.H.useReducer(E,Q,ie)},cn.useRef=function(E){return F.H.useRef(E)},cn.useState=function(E){return F.H.useState(E)},cn.useSyncExternalStore=function(E,Q,ie){return F.H.useSyncExternalStore(E,Q,ie)},cn.useTransition=function(){return F.H.useTransition()},cn.version="19.1.0",cn}var aN;function Q1(){return aN||(aN=1,O0.exports=xA()),O0.exports}var w=Q1();const qn=Yd(w),sN=mA({__proto__:null,default:qn},[w]);var F0={exports:{}},Em={},$0={exports:{}},z0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lN;function bA(){return lN||(lN=1,function(e){function n(J,q){var H=J.length;J.push(q);e:for(;0<H;){var ee=H-1>>>1,E=J[ee];if(0<a(E,q))J[ee]=q,J[H]=E,H=ee;else break e}}function t(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var q=J[0],H=J.pop();if(H!==q){J[0]=H;e:for(var ee=0,E=J.length,Q=E>>>1;ee<Q;){var ie=2*(ee+1)-1,I=J[ie],ce=ie+1,xe=J[ce];if(0>a(I,H))ce<E&&0>a(xe,I)?(J[ee]=xe,J[ce]=H,ee=ce):(J[ee]=I,J[ie]=H,ee=ie);else if(ce<E&&0>a(xe,H))J[ee]=xe,J[ce]=H,ee=ce;else break e}}return q}function a(J,q){var H=J.sortIndex-q.sortIndex;return H!==0?H:J.id-q.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,f=o.now();e.unstable_now=function(){return o.now()-f}}var u=[],d=[],h=1,g=null,b=3,v=!1,N=!1,C=!1,A=!1,T=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function V(J){for(var q=t(d);q!==null;){if(q.callback===null)r(d);else if(q.startTime<=J)r(d),q.sortIndex=q.expirationTime,n(u,q);else break;q=t(d)}}function F(J){if(C=!1,V(J),!N)if(t(u)!==null)N=!0,z||(z=!0,W());else{var q=t(d);q!==null&&re(F,q.startTime-J)}}var z=!1,B=-1,U=5,R=-1;function O(){return A?!0:!(e.unstable_now()-R<U)}function $(){if(A=!1,z){var J=e.unstable_now();R=J;var q=!0;try{e:{N=!1,C&&(C=!1,D(B),B=-1),v=!0;var H=b;try{t:{for(V(J),g=t(u);g!==null&&!(g.expirationTime>J&&O());){var ee=g.callback;if(typeof ee=="function"){g.callback=null,b=g.priorityLevel;var E=ee(g.expirationTime<=J);if(J=e.unstable_now(),typeof E=="function"){g.callback=E,V(J),q=!0;break t}g===t(u)&&r(u),V(J)}else r(u);g=t(u)}if(g!==null)q=!0;else{var Q=t(d);Q!==null&&re(F,Q.startTime-J),q=!1}}break e}finally{g=null,b=H,v=!1}q=void 0}}finally{q?W():z=!1}}}var W;if(typeof M=="function")W=function(){M($)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ne=te.port2;te.port1.onmessage=$,W=function(){ne.postMessage(null)}}else W=function(){T($,0)};function re(J,q){B=T(function(){J(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(J){switch(b){case 1:case 2:case 3:var q=3;break;default:q=b}var H=b;b=q;try{return J()}finally{b=H}},e.unstable_requestPaint=function(){A=!0},e.unstable_runWithPriority=function(J,q){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var H=b;b=J;try{return q()}finally{b=H}},e.unstable_scheduleCallback=function(J,q,H){var ee=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?ee+H:ee):H=ee,J){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=H+E,J={id:h++,callback:q,priorityLevel:J,startTime:H,expirationTime:E,sortIndex:-1},H>ee?(J.sortIndex=H,n(d,J),t(u)===null&&J===t(d)&&(C?(D(B),B=-1):C=!0,re(F,H-ee))):(J.sortIndex=E,n(u,J),N||v||(N=!0,z||(z=!0,W()))),J},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(J){var q=b;return function(){var H=b;b=q;try{return J.apply(this,arguments)}finally{b=H}}}}(z0)),z0}var oN;function vA(){return oN||(oN=1,$0.exports=bA()),$0.exports}var B0={exports:{}},Fr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cN;function wA(){if(cN)return Fr;cN=1;var e=Q1();function n(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(u,d,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:u,containerInfo:d,implementation:h}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Fr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Fr.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(n(299));return l(u,d,null,h)},Fr.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},Fr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},Fr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Fr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,g=f(h,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):h==="script"&&r.d.X(u,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Fr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=f(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},Fr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,g=f(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Fr.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=f(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},Fr.requestFormReset=function(u){r.d.r(u)},Fr.unstable_batchedUpdates=function(u,d){return u(d)},Fr.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},Fr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Fr.version="19.1.0",Fr}var uN;function hC(){if(uN)return B0.exports;uN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),B0.exports=wA(),B0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dN;function NA(){if(dN)return Em;dN=1;var e=vA(),n=Q1(),t=hC();function r(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var c=s,p=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(p=c.return),s=c.return;while(s)}return c.tag===3?p:null}function o(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function f(s){if(l(s)!==s)throw Error(r(188))}function u(s){var c=s.alternate;if(!c){if(c=l(s),c===null)throw Error(r(188));return c!==s?null:s}for(var p=s,x=c;;){var S=p.return;if(S===null)break;var P=S.alternate;if(P===null){if(x=S.return,x!==null){p=x;continue}break}if(S.child===P.child){for(P=S.child;P;){if(P===p)return f(S),s;if(P===x)return f(S),c;P=P.sibling}throw Error(r(188))}if(p.return!==x.return)p=S,x=P;else{for(var G=!1,Z=S.child;Z;){if(Z===p){G=!0,p=S,x=P;break}if(Z===x){G=!0,x=S,p=P;break}Z=Z.sibling}if(!G){for(Z=P.child;Z;){if(Z===p){G=!0,p=P,x=S;break}if(Z===x){G=!0,x=P,p=S;break}Z=Z.sibling}if(!G)throw Error(r(189))}}if(p.alternate!==x)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:c}function d(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=d(s),c!==null)return c;s=s.sibling}return null}var h=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),D=Symbol.for("react.consumer"),M=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function W(s){return s===null||typeof s!="object"?null:(s=$&&s[$]||s["@@iterator"],typeof s=="function"?s:null)}var te=Symbol.for("react.client.reference");function ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===te?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case N:return"Fragment";case A:return"Profiler";case C:return"StrictMode";case F:return"Suspense";case z:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case M:return(s.displayName||"Context")+".Provider";case D:return(s._context.displayName||"Context")+".Consumer";case V:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case B:return c=s.displayName||null,c!==null?c:ne(s.type)||"Memo";case U:c=s._payload,s=s._init;try{return ne(s(c))}catch{}}return null}var re=Array.isArray,J=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H={pending:!1,data:null,method:null,action:null},ee=[],E=-1;function Q(s){return{current:s}}function ie(s){0>E||(s.current=ee[E],ee[E]=null,E--)}function I(s,c){E++,ee[E]=s.current,s.current=c}var ce=Q(null),xe=Q(null),le=Q(null),ge=Q(null);function ye(s,c){switch(I(le,c),I(xe,s),I(ce,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?hi(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=hi(c),s=bi(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ie(ce),I(ce,s)}function Re(){ie(ce),ie(xe),ie(le)}function Ze(s){s.memoizedState!==null&&I(ge,s);var c=ce.current,p=bi(c,s.type);c!==p&&(I(xe,s),I(ce,p))}function at(s){xe.current===s&&(ie(ce),ie(xe)),ge.current===s&&(ie(ge),Kc._currentValue=H)}var Le=Object.prototype.hasOwnProperty,Te=e.unstable_scheduleCallback,we=e.unstable_cancelCallback,Fe=e.unstable_shouldYield,Xe=e.unstable_requestPaint,it=e.unstable_now,je=e.unstable_getCurrentPriorityLevel,Ke=e.unstable_ImmediatePriority,ze=e.unstable_UserBlockingPriority,ct=e.unstable_NormalPriority,Tt=e.unstable_LowPriority,bt=e.unstable_IdlePriority,en=e.log,oe=e.unstable_setDisableYieldValue,K=null,fe=null;function Ae(s){if(typeof en=="function"&&oe(s),fe&&typeof fe.setStrictMode=="function")try{fe.setStrictMode(K,s)}catch{}}var Ie=Math.clz32?Math.clz32:gt,Ye=Math.log,ft=Math.LN2;function gt(s){return s>>>=0,s===0?32:31-(Ye(s)/ft|0)|0}var jt=256,$e=4194304;function nt(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ve(s,c,p){var x=s.pendingLanes;if(x===0)return 0;var S=0,P=s.suspendedLanes,G=s.pingedLanes;s=s.warmLanes;var Z=x&134217727;return Z!==0?(x=Z&~P,x!==0?S=nt(x):(G&=Z,G!==0?S=nt(G):p||(p=Z&~s,p!==0&&(S=nt(p))))):(Z=x&~P,Z!==0?S=nt(Z):G!==0?S=nt(G):p||(p=x&~s,p!==0&&(S=nt(p)))),S===0?0:c!==0&&c!==S&&(c&P)===0&&(P=S&-S,p=c&-c,P>=p||P===32&&(p&4194048)!==0)?c:S}function ht(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function Se(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qe(){var s=jt;return jt<<=1,(jt&4194048)===0&&(jt=256),s}function Be(){var s=$e;return $e<<=1,($e&62914560)===0&&($e=4194304),s}function tt(s){for(var c=[],p=0;31>p;p++)c.push(s);return c}function st(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function dt(s,c,p,x,S,P){var G=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var Z=s.entanglements,me=s.expirationTimes,Pe=s.hiddenUpdates;for(p=G&~p;0<p;){var He=31-Ie(p),Qe=1<<He;Z[He]=0,me[He]=-1;var Me=Pe[He];if(Me!==null)for(Pe[He]=null,He=0;He<Me.length;He++){var De=Me[He];De!==null&&(De.lane&=-536870913)}p&=~Qe}x!==0&&tn(s,x,0),P!==0&&S===0&&s.tag!==0&&(s.suspendedLanes|=P&~(G&~c))}function tn(s,c,p){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-Ie(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|p&4194090}function Nt(s,c){var p=s.entangledLanes|=c;for(s=s.entanglements;p;){var x=31-Ie(p),S=1<<x;S&c|s[x]&c&&(s[x]|=c),p&=~S}}function Ot(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Vt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function _t(){var s=q.p;return s!==0?s:(s=window.event,s===void 0?32:ox(s.type))}function Wt(s,c){var p=q.p;try{return q.p=s,c()}finally{q.p=p}}var Et=Math.random().toString(36).slice(2),Dt="__reactFiber$"+Et,kt="__reactProps$"+Et,It="__reactContainer$"+Et,Hn="__reactEvents$"+Et,Ti="__reactListeners$"+Et,sr="__reactHandles$"+Et,Rn="__reactResources$"+Et,On="__reactMarker$"+Et;function Bi(s){delete s[Dt],delete s[kt],delete s[Hn],delete s[Ti],delete s[sr]}function Xi(s){var c=s[Dt];if(c)return c;for(var p=s.parentNode;p;){if(c=p[It]||p[Dt]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(s=Jy(s);s!==null;){if(p=s[Dt])return p;s=Jy(s)}return c}s=p,p=s.parentNode}return null}function Zi(s){if(s=s[Dt]||s[It]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function pr(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(r(33))}function Ui(s){var c=s[Rn];return c||(c=s[Rn]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Gn(s){s[On]=!0}var Es=new Set,Hr={};function Ia(s,c){er(s,c),er(s+"Capture",c)}function er(s,c){for(Hr[s]=c,s=0;s<c.length;s++)Es.add(c[s])}var oa=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ro={},cl={};function Kd(s){return Le.call(cl,s)?!0:Le.call(ro,s)?!1:oa.test(s)?cl[s]=!0:(ro[s]=!0,!1)}function ul(s,c,p){if(Kd(c))if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+p)}}function dl(s,c,p){if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+p)}}function Gr(s,c,p,x){if(x===null)s.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(p);return}s.setAttributeNS(c,p,""+x)}}var ao,fl;function hl(s){if(ao===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);ao=c&&c[1]||"",fl=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ao+s+fl}var bu=!1;function ic(s,c){if(!s||bu)return"";bu=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var Qe=function(){throw Error()};if(Object.defineProperty(Qe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Qe,[])}catch(De){var Me=De}Reflect.construct(s,[],Qe)}else{try{Qe.call()}catch(De){Me=De}s.call(Qe.prototype)}}else{try{throw Error()}catch(De){Me=De}(Qe=s())&&typeof Qe.catch=="function"&&Qe.catch(function(){})}}catch(De){if(De&&Me&&typeof De.stack=="string")return[De.stack,Me.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=x.DetermineComponentFrameRoot(),G=P[0],Z=P[1];if(G&&Z){var me=G.split(`
`),Pe=Z.split(`
`);for(S=x=0;x<me.length&&!me[x].includes("DetermineComponentFrameRoot");)x++;for(;S<Pe.length&&!Pe[S].includes("DetermineComponentFrameRoot");)S++;if(x===me.length||S===Pe.length)for(x=me.length-1,S=Pe.length-1;1<=x&&0<=S&&me[x]!==Pe[S];)S--;for(;1<=x&&0<=S;x--,S--)if(me[x]!==Pe[S]){if(x!==1||S!==1)do if(x--,S--,0>S||me[x]!==Pe[S]){var He=`
`+me[x].replace(" at new "," at ");return s.displayName&&He.includes("<anonymous>")&&(He=He.replace("<anonymous>",s.displayName)),He}while(1<=x&&0<=S);break}}}finally{bu=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?hl(p):""}function rp(s){switch(s.tag){case 26:case 27:case 5:return hl(s.type);case 16:return hl("Lazy");case 13:return hl("Suspense");case 19:return hl("SuspenseList");case 0:case 15:return ic(s.type,!1);case 11:return ic(s.type.render,!1);case 1:return ic(s.type,!0);case 31:return hl("Activity");default:return""}}function rc(s){try{var c="";do c+=rp(s),s=s.return;while(s);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function mr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ac(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function sc(s){var c=ac(s)?"checked":"value",p=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,P=p.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return S.call(this)},set:function(G){x=""+G,P.call(this,G)}}),Object.defineProperty(s,c,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(G){x=""+G},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function lc(s){s._valueTracker||(s._valueTracker=sc(s))}function As(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var p=c.getValue(),x="";return s&&(x=ac(s)?s.checked?"true":"false":s.value),s=x,s!==p?(c.setValue(s),!0):!1}function rs(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var so=/[\n"\\]/g;function gr(s){return s.replace(so,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Ps(s,c,p,x,S,P,G,Z){s.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?s.type=G:s.removeAttribute("type"),c!=null?G==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+mr(c)):s.value!==""+mr(c)&&(s.value=""+mr(c)):G!=="submit"&&G!=="reset"||s.removeAttribute("value"),c!=null?as(s,G,mr(c)):p!=null?as(s,G,mr(p)):x!=null&&s.removeAttribute("value"),S==null&&P!=null&&(s.defaultChecked=!!P),S!=null&&(s.checked=S&&typeof S!="function"&&typeof S!="symbol"),Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?s.name=""+mr(Z):s.removeAttribute("name")}function oc(s,c,p,x,S,P,G,Z){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(s.type=P),c!=null||p!=null){if(!(P!=="submit"&&P!=="reset"||c!=null))return;p=p!=null?""+mr(p):"",c=c!=null?""+mr(c):p,Z||c===s.value||(s.value=c),s.defaultValue=c}x=x??S,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=Z?s.checked:!!x,s.defaultChecked=!!x,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(s.name=G)}function as(s,c,p){c==="number"&&rs(s.ownerDocument)===s||s.defaultValue===""+p||(s.defaultValue=""+p)}function Ds(s,c,p,x){if(s=s.options,c){c={};for(var S=0;S<p.length;S++)c["$"+p[S]]=!0;for(p=0;p<s.length;p++)S=c.hasOwnProperty("$"+s[p].value),s[p].selected!==S&&(s[p].selected=S),S&&x&&(s[p].defaultSelected=!0)}else{for(p=""+mr(p),c=null,S=0;S<s.length;S++){if(s[S].value===p){s[S].selected=!0,x&&(s[S].defaultSelected=!0);return}c!==null||s[S].disabled||(c=s[S])}c!==null&&(c.selected=!0)}}function pl(s,c,p){if(c!=null&&(c=""+mr(c),c!==s.value&&(s.value=c),p==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=p!=null?""+mr(p):""}function lo(s,c,p,x){if(c==null){if(x!=null){if(p!=null)throw Error(r(92));if(re(x)){if(1<x.length)throw Error(r(93));x=x[0]}p=x}p==null&&(p=""),c=p}p=mr(c),s.defaultValue=p,x=s.textContent,x===p&&x!==""&&x!==null&&(s.value=x)}function Yr(s,c){if(c){var p=s.firstChild;if(p&&p===s.lastChild&&p.nodeType===3){p.nodeValue=c;return}}s.textContent=c}var Ra=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ml(s,c,p){var x=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,p):typeof p!="number"||p===0||Ra.has(c)?c==="float"?s.cssFloat=p:s[c]=(""+p).trim():s[c]=p+"px"}function vu(s,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(s=s.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var S in c)x=c[S],c.hasOwnProperty(S)&&p[S]!==x&&ml(s,S,x)}else for(var P in c)c.hasOwnProperty(P)&&ml(s,P,c[P])}function gl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cc=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),uc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ca(s){return uc.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Ms=null;function oo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ss=null,ls=null;function co(s){var c=Zi(s);if(c&&(s=c.stateNode)){var p=s[kt]||null;e:switch(s=c.stateNode,c.type){case"input":if(Ps(s,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+gr(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var x=p[c];if(x!==s&&x.form===s.form){var S=x[kt]||null;if(!S)throw Error(r(90));Ps(x,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(c=0;c<p.length;c++)x=p[c],x.form===s.form&&As(x)}break e;case"textarea":pl(s,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&Ds(s,!!p.multiple,c,!1)}}}var Wr=!1;function dc(s,c,p){if(Wr)return s(c,p);Wr=!0;try{var x=s(c);return x}finally{if(Wr=!1,(ss!==null||ls!==null)&&(Qf(),ss&&(c=ss,s=ls,ls=ss=null,co(c),s)))for(c=0;c<s.length;c++)co(s[c])}}function yl(s,c){var p=s.stateNode;if(p===null)return null;var x=p[kt]||null;if(x===null)return null;p=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),La=!1;if(tr)try{var uo={};Object.defineProperty(uo,"passive",{get:function(){La=!0}}),window.addEventListener("test",uo,uo),window.removeEventListener("test",uo,uo)}catch{La=!1}var Qr=null,fc=null,xl=null;function hc(){if(xl)return xl;var s,c=fc,p=c.length,x,S="value"in Qr?Qr.value:Qr.textContent,P=S.length;for(s=0;s<p&&c[s]===S[s];s++);var G=p-s;for(x=1;x<=G&&c[p-x]===S[P-x];x++);return xl=S.slice(s,1<x?1-x:void 0)}function Dn(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function Cn(){return!0}function Xd(){return!1}function qi(s){function c(p,x,S,P,G){this._reactName=p,this._targetInst=S,this.type=x,this.nativeEvent=P,this.target=G,this.currentTarget=null;for(var Z in s)s.hasOwnProperty(Z)&&(p=s[Z],this[Z]=p?p(P):P[Z]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Cn:Xd,this.isPropagationStopped=Xd,this}return h(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Cn)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Cn)},persist:function(){},isPersistent:Cn}),c}var Oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fo=qi(Oa),kn=h({},Oa,{view:0,detail:0}),wu=qi(kn),Is,ho,Kn,ua=h({},kn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Kn&&(Kn&&s.type==="mousemove"?(Is=s.screenX-Kn.screenX,ho=s.screenY-Kn.screenY):ho=Is=0,Kn=s),Is)},movementY:function(s){return"movementY"in s?s.movementY:ho}}),os=qi(ua),Nu=h({},ua,{dataTransfer:0}),cs=qi(Nu),yr=h({},kn,{relatedTarget:0}),bl=qi(yr),po=h({},Oa,{animationName:0,elapsedTime:0,pseudoElement:0}),Rs=qi(po),Su=h({},Oa,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Fa=qi(Su),mo=h({},Oa,{data:0}),lr=qi(mo),ap={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zd(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=vl[s])?!!c[s]:!1}function Jr(){return Zd}var us=h({},kn,{key:function(s){if(s.key){var c=ap[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=Dn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?nr[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jr,charCode:function(s){return s.type==="keypress"?Dn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Dn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),wl=qi(us),Yn=h({},ua,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kr=qi(Yn),ju=h({},kn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jr}),pc=qi(ju),_u=h({},Oa,{propertyName:0,elapsedTime:0,pseudoElement:0}),sp=qi(_u),lp=h({},ua,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),op=qi(lp),ef=h({},Oa,{newState:0,oldState:0}),mc=qi(ef),Nl=[9,13,27,32],Cu=tr&&"CompositionEvent"in window,Sl=null;tr&&"documentMode"in document&&(Sl=document.documentMode);var tf=tr&&"TextEvent"in window&&!Sl,gc=tr&&(!Cu||Sl&&8<Sl&&11>=Sl),go=" ",ku=!1;function yo(s,c){switch(s){case"keyup":return Nl.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ir=!1;function ds(s,c){switch(s){case"compositionend":return yc(c);case"keypress":return c.which!==32?null:(ku=!0,go);case"textInput":return s=c.data,s===go&&ku?null:s;default:return null}}function da(s,c){if(ir)return s==="compositionend"||!Cu&&yo(s,c)?(s=hc(),xl=fc=Qr=null,ir=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return gc&&c.locale!=="ko"?null:c.data;default:return null}}var or={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xo(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!or[s.type]:c==="textarea"}function Ls(s,c,p,x){ss?ls?ls.push(x):ls=[x]:ss=x,c=nh(c,"onChange"),0<c.length&&(p=new fo("onChange","change",null,p,x),s.push({event:p,listeners:c}))}var Os=null,fs=null;function nf(s){Uy(s,0)}function bo(s){var c=pr(s);if(As(c))return s}function rf(s,c){if(s==="change")return c}var af=!1;if(tr){var xc;if(tr){var hs="oninput"in document;if(!hs){var sf=document.createElement("div");sf.setAttribute("oninput","return;"),hs=typeof sf.oninput=="function"}xc=hs}else xc=!1;af=xc&&(!document.documentMode||9<document.documentMode)}function lf(){Os&&(Os.detachEvent("onpropertychange",bc),fs=Os=null)}function bc(s){if(s.propertyName==="value"&&bo(fs)){var c=[];Ls(c,fs,s,oo(s)),dc(nf,c)}}function of(s,c,p){s==="focusin"?(lf(),Os=c,fs=p,Os.attachEvent("onpropertychange",bc)):s==="focusout"&&lf()}function ps(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return bo(fs)}function $a(s,c){if(s==="click")return bo(c)}function cp(s,c){if(s==="input"||s==="change")return bo(c)}function Tu(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var xr=typeof Object.is=="function"?Object.is:Tu;function fa(s,c){if(xr(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var p=Object.keys(s),x=Object.keys(c);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var S=p[x];if(!Le.call(c,S)||!xr(s[S],c[S]))return!1}return!0}function Cr(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Xr(s,c){var p=Cr(s);s=0;for(var x;p;){if(p.nodeType===3){if(x=s+p.textContent.length,s<=c&&x>=c)return{node:p,offset:c-s};s=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Cr(p)}}function cf(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?cf(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function Eu(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=rs(s.document);c instanceof s.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)s=c.contentWindow;else break;c=rs(s.document)}return c}function Au(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var uf=tr&&"documentMode"in document&&11>=document.documentMode,Fs=null,za=null,Ne=null,Ue=!1;function Oe(s,c,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Ue||Fs==null||Fs!==rs(x)||(x=Fs,"selectionStart"in x&&Au(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Ne&&fa(Ne,x)||(Ne=x,x=nh(za,"onSelect"),0<x.length&&(c=new fo("onSelect","select",null,c,p),s.push({event:c,listeners:x}),c.target=Fs)))}function mt(s,c){var p={};return p[s.toLowerCase()]=c.toLowerCase(),p["Webkit"+s]="webkit"+c,p["Moz"+s]="moz"+c,p}var Ft={animationend:mt("Animation","AnimationEnd"),animationiteration:mt("Animation","AnimationIteration"),animationstart:mt("Animation","AnimationStart"),transitionrun:mt("Transition","TransitionRun"),transitionstart:mt("Transition","TransitionStart"),transitioncancel:mt("Transition","TransitionCancel"),transitionend:mt("Transition","TransitionEnd")},yn={},xi={};tr&&(xi=document.createElement("div").style,"AnimationEvent"in window||(delete Ft.animationend.animation,delete Ft.animationiteration.animation,delete Ft.animationstart.animation),"TransitionEvent"in window||delete Ft.transitionend.transition);function xn(s){if(yn[s])return yn[s];if(!Ft[s])return s;var c=Ft[s],p;for(p in c)if(c.hasOwnProperty(p)&&p in xi)return yn[s]=c[p];return s}var se=xn("animationend"),pe=xn("animationiteration"),de=xn("animationstart"),_e=xn("transitionrun"),rt=xn("transitionstart"),xt=xn("transitioncancel"),Ct=xn("transitionend"),vt=new Map,Qt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qt.push("scrollEnd");function cr(s,c){vt.set(s,c),Ia(c,[s])}var vo=new WeakMap;function Vi(s,c){if(typeof s=="object"&&s!==null){var p=vo.get(s);return p!==void 0?p:(c={value:s,source:c,stack:rc(c)},vo.set(s,c),c)}return{value:s,source:c,stack:rc(c)}}var Mi=[],vc=0,up=0;function wo(){for(var s=vc,c=up=vc=0;c<s;){var p=Mi[c];Mi[c++]=null;var x=Mi[c];Mi[c++]=null;var S=Mi[c];Mi[c++]=null;var P=Mi[c];if(Mi[c++]=null,x!==null&&S!==null){var G=x.pending;G===null?S.next=S:(S.next=G.next,G.next=S),x.pending=S}P!==0&&Pu(p,S,P)}}function Ba(s,c,p,x){Mi[vc++]=s,Mi[vc++]=c,Mi[vc++]=p,Mi[vc++]=x,up|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function wc(s,c,p,x){return Ba(s,c,p,x),Du(s)}function No(s,c){return Ba(s,null,null,c),Du(s)}function Pu(s,c,p){s.lanes|=p;var x=s.alternate;x!==null&&(x.lanes|=p);for(var S=!1,P=s.return;P!==null;)P.childLanes|=p,x=P.alternate,x!==null&&(x.childLanes|=p),P.tag===22&&(s=P.stateNode,s===null||s._visibility&1||(S=!0)),s=P,P=P.return;return s.tag===3?(P=s.stateNode,S&&c!==null&&(S=31-Ie(p),s=P.hiddenUpdates,x=s[S],x===null?s[S]=[c]:x.push(c),c.lane=p|536870912),P):null}function Du(s){if(50<qc)throw qc=0,rm=null,Error(r(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var So={};function df(s,c,p,x){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kr(s,c,p,x){return new df(s,c,p,x)}function jo(s){return s=s.prototype,!(!s||!s.isReactComponent)}function br(s,c){var p=s.alternate;return p===null?(p=kr(s.tag,c,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=c,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,c=s.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Mu(s,c){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,c=p.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function ff(s,c,p,x,S,P){var G=0;if(x=s,typeof s=="function")jo(s)&&(G=1);else if(typeof s=="string")G=N0(s,p,ce.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=kr(31,p,c,S),s.elementType=R,s.lanes=P,s;case N:return _o(p.children,S,P,c);case C:G=8,S|=24;break;case A:return s=kr(12,p,c,S|2),s.elementType=A,s.lanes=P,s;case F:return s=kr(13,p,c,S),s.elementType=F,s.lanes=P,s;case z:return s=kr(19,p,c,S),s.elementType=z,s.lanes=P,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case T:case M:G=10;break e;case D:G=9;break e;case V:G=11;break e;case B:G=14;break e;case U:G=16,x=null;break e}G=29,p=Error(r(130,s===null?"null":typeof s,"")),x=null}return c=kr(G,p,c,S),c.elementType=s,c.type=x,c.lanes=P,c}function _o(s,c,p,x){return s=kr(7,s,x,c),s.lanes=p,s}function dp(s,c,p){return s=kr(6,s,null,c),s.lanes=p,s}function Nc(s,c,p){return c=kr(4,s.children!==null?s.children:[],s.key,c),c.lanes=p,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var $s=[],jl=0,hf=null,Iu=0,ha=[],pa=0,li=null,ui=1,zs="";function Co(s,c){$s[jl++]=Iu,$s[jl++]=hf,hf=s,Iu=c}function fp(s,c,p){ha[pa++]=ui,ha[pa++]=zs,ha[pa++]=li,li=s;var x=ui;s=zs;var S=32-Ie(x)-1;x&=~(1<<S),p+=1;var P=32-Ie(c)+S;if(30<P){var G=S-S%5;P=(x&(1<<G)-1).toString(32),x>>=G,S-=G,ui=1<<32-Ie(c)+S|p<<S|x,zs=P+s}else ui=1<<P|p<<S|x,zs=s}function hp(s){s.return!==null&&(Co(s,1),fp(s,1,0))}function Ru(s){for(;s===hf;)hf=$s[--jl],$s[jl]=null,Iu=$s[--jl],$s[jl]=null;for(;s===li;)li=ha[--pa],ha[pa]=null,zs=ha[--pa],ha[pa]=null,ui=ha[--pa],ha[pa]=null}var Ii=null,di=null,bn=!1,Ua=null,Tr=!1,Sc=Error(r(519));function ma(s){var c=Error(r(418,""));throw _l(Vi(c,s)),Sc}function Ng(s){var c=s.stateNode,p=s.type,x=s.memoizedProps;switch(c[Dt]=s,c[kt]=x,p){case"dialog":gn("cancel",c),gn("close",c);break;case"iframe":case"object":case"embed":gn("load",c);break;case"video":case"audio":for(p=0;p<Sd.length;p++)gn(Sd[p],c);break;case"source":gn("error",c);break;case"img":case"image":case"link":gn("error",c),gn("load",c);break;case"details":gn("toggle",c);break;case"input":gn("invalid",c),oc(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),lc(c);break;case"select":gn("invalid",c);break;case"textarea":gn("invalid",c),lo(c,x.value,x.defaultValue,x.children),lc(c)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||x.suppressHydrationWarning===!0||Hy(c.textContent,p)?(x.popover!=null&&(gn("beforetoggle",c),gn("toggle",c)),x.onScroll!=null&&gn("scroll",c),x.onScrollEnd!=null&&gn("scrollend",c),x.onClick!=null&&(c.onclick=ih),c=!0):c=!1,c||ma(s)}function Sg(s){for(Ii=s.return;Ii;)switch(Ii.tag){case 5:case 13:Tr=!1;return;case 27:case 3:Tr=!0;return;default:Ii=Ii.return}}function Lu(s){if(s!==Ii)return!1;if(!bn)return Sg(s),bn=!0,!1;var c=s.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=s.type,p=!(p!=="form"&&p!=="button")||ah(s.type,s.memoizedProps)),p=!p),p&&di&&ma(s),Sg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(p=s.data,p==="/$"){if(c===0){di=Wa(s.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++;s=s.nextSibling}di=null}}else c===27?(c=di,wa(s.type)?(s=xm,xm=null,di=s):di=c):di=Ii?Wa(s.stateNode.nextSibling):null;return!0}function Ou(){di=Ii=null,bn=!1}function jg(){var s=Ua;return s!==null&&(Lr===null?Lr=s:Lr.push.apply(Lr,s),Ua=null),s}function _l(s){Ua===null?Ua=[s]:Ua.push(s)}var ko=Q(null),Cl=null,X=null;function Zr(s,c,p){I(ko,c._currentValue),c._currentValue=p}function ga(s){s._currentValue=ko.current,ie(ko)}function Er(s,c,p){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===p)break;s=s.return}}function fn(s,c,p,x){var S=s.child;for(S!==null&&(S.return=s);S!==null;){var P=S.dependencies;if(P!==null){var G=S.child;P=P.firstContext;e:for(;P!==null;){var Z=P;P=S;for(var me=0;me<c.length;me++)if(Z.context===c[me]){P.lanes|=p,Z=P.alternate,Z!==null&&(Z.lanes|=p),Er(P.return,p,s),x||(G=null);break e}P=Z.next}}else if(S.tag===18){if(G=S.return,G===null)throw Error(r(341));G.lanes|=p,P=G.alternate,P!==null&&(P.lanes|=p),Er(G,p,s),G=null}else G=S.child;if(G!==null)G.return=S;else for(G=S;G!==null;){if(G===s){G=null;break}if(S=G.sibling,S!==null){S.return=G.return,G=S;break}G=G.return}S=G}}function Fu(s,c,p,x){s=null;for(var S=c,P=!1;S!==null;){if(!P){if((S.flags&524288)!==0)P=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var G=S.alternate;if(G===null)throw Error(r(387));if(G=G.memoizedProps,G!==null){var Z=S.type;xr(S.pendingProps.value,G.value)||(s!==null?s.push(Z):s=[Z])}}else if(S===ge.current){if(G=S.alternate,G===null)throw Error(r(387));G.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(s!==null?s.push(Kc):s=[Kc])}S=S.return}s!==null&&fn(c,s,p,x),c.flags|=262144}function pf(s){for(s=s.firstContext;s!==null;){if(!xr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function To(s){Cl=s,X=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function wi(s){return _g(Cl,s)}function mf(s,c){return Cl===null&&To(s),_g(s,c)}function _g(s,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},X===null){if(s===null)throw Error(r(308));X=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else X=X.next=c;return p}var Gb=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(p,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(p){return p()})}},Yb=e.unstable_scheduleCallback,Wb=e.unstable_NormalPriority,Xn={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function pp(){return{controller:new Gb,data:new Map,refCount:0}}function $u(s){s.refCount--,s.refCount===0&&Yb(Wb,function(){s.controller.abort()})}var zu=null,mp=0,jc=0,Ar=null;function Qb(s,c){if(zu===null){var p=zu=[];mp=0,jc=th(),Ar={status:"pending",value:void 0,then:function(x){p.push(x)}}}return mp++,c.then(Cg,Cg),c}function Cg(){if(--mp===0&&zu!==null){Ar!==null&&(Ar.status="fulfilled");var s=zu;zu=null,jc=0,Ar=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function Jb(s,c){var p=[],x={status:"pending",value:null,reason:null,then:function(S){p.push(S)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var S=0;S<p.length;S++)(0,p[S])(c)},function(S){for(x.status="rejected",x.reason=S,S=0;S<p.length;S++)(0,p[S])(void 0)}),x}var kg=J.S;J.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Qb(s,c),kg!==null&&kg(s,c)};var Eo=Q(null);function Bs(){var s=Eo.current;return s!==null?s:ii.pooledCache}function gf(s,c){c===null?I(Eo,Eo.current):I(Eo,c.pool)}function Tg(){var s=Bs();return s===null?null:{parent:Xn._currentValue,pool:s}}var vr=Error(r(460)),Eg=Error(r(474)),yf=Error(r(542)),gp={then:function(){}};function Ag(s){return s=s.status,s==="fulfilled"||s==="rejected"}function xf(){}function yp(s,c,p){switch(p=s[p],p===void 0?s.push(c):p!==c&&(c.then(xf,xf),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Dg(s),s;default:if(typeof c.status=="string")c.then(xf,xf);else{if(s=ii,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var S=c;S.status="fulfilled",S.value=x}},function(x){if(c.status==="pending"){var S=c;S.status="rejected",S.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Dg(s),s}throw _c=c,vr}}var _c=null;function Pg(){if(_c===null)throw Error(r(459));var s=_c;return _c=null,s}function Dg(s){if(s===vr||s===yf)throw Error(r(483))}var ms=!1;function Ao(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Cc(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function kl(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Us(s,c,p){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,($n&2)!==0){var S=x.pending;return S===null?c.next=c:(c.next=S.next,S.next=c),x.pending=c,c=Du(s),Pu(s,null,p),c}return Ba(s,x,c,p),Du(s)}function Bu(s,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Nt(s,p)}}function qa(s,c){var p=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var S=null,P=null;if(p=p.firstBaseUpdate,p!==null){do{var G={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};P===null?S=P=G:P=P.next=G,p=p.next}while(p!==null);P===null?S=P=c:P=P.next=c}else S=P=c;p={baseState:x.baseState,firstBaseUpdate:S,lastBaseUpdate:P,shared:x.shared,callbacks:x.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=c:s.next=c,p.lastBaseUpdate=c}var Uu=!1;function Va(){if(Uu){var s=Ar;if(s!==null)throw s}}function ur(s,c,p,x){Uu=!1;var S=s.updateQueue;ms=!1;var P=S.firstBaseUpdate,G=S.lastBaseUpdate,Z=S.shared.pending;if(Z!==null){S.shared.pending=null;var me=Z,Pe=me.next;me.next=null,G===null?P=Pe:G.next=Pe,G=me;var He=s.alternate;He!==null&&(He=He.updateQueue,Z=He.lastBaseUpdate,Z!==G&&(Z===null?He.firstBaseUpdate=Pe:Z.next=Pe,He.lastBaseUpdate=me))}if(P!==null){var Qe=S.baseState;G=0,He=Pe=me=null,Z=P;do{var Me=Z.lane&-536870913,De=Me!==Z.lane;if(De?(Tn&Me)===Me:(x&Me)===Me){Me!==0&&Me===jc&&(Uu=!0),He!==null&&(He=He.next={lane:0,tag:Z.tag,payload:Z.payload,callback:null,next:null});e:{var zt=s,$t=Z;Me=c;var Qn=p;switch($t.tag){case 1:if(zt=$t.payload,typeof zt=="function"){Qe=zt.call(Qn,Qe,Me);break e}Qe=zt;break e;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=$t.payload,Me=typeof zt=="function"?zt.call(Qn,Qe,Me):zt,Me==null)break e;Qe=h({},Qe,Me);break e;case 2:ms=!0}}Me=Z.callback,Me!==null&&(s.flags|=64,De&&(s.flags|=8192),De=S.callbacks,De===null?S.callbacks=[Me]:De.push(Me))}else De={lane:Me,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},He===null?(Pe=He=De,me=Qe):He=He.next=De,G|=Me;if(Z=Z.next,Z===null){if(Z=S.shared.pending,Z===null)break;De=Z,Z=De.next,De.next=null,S.lastBaseUpdate=De,S.shared.pending=null}}while(!0);He===null&&(me=Qe),S.baseState=me,S.firstBaseUpdate=Pe,S.lastBaseUpdate=He,P===null&&(S.shared.lanes=0),Ll|=G,s.lanes=G,s.memoizedState=Qe}}function Mg(s,c){if(typeof s!="function")throw Error(r(191,s));s.call(c)}function xp(s,c){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Mg(p[s],c)}var Po=Q(null),Tl=Q(0);function qs(s,c){s=Xs,I(Tl,s),I(Po,c),Xs=s|c.baseLanes}function bf(){I(Tl,Xs),I(Po,Po.current)}function bp(){Xs=Tl.current,ie(Po),ie(Tl)}var Ha=0,on=null,Fn=null,vn=null,kc=!1,Do=!1,dr=!1,Tc=0,El=0,ya=null,Ig=0;function wn(){throw Error(r(321))}function qu(s,c){if(c===null)return!1;for(var p=0;p<c.length&&p<s.length;p++)if(!xr(s[p],c[p]))return!1;return!0}function vp(s,c,p,x,S,P){return Ha=P,on=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,J.H=s===null||s.memoizedState===null?Yg:Fp,dr=!1,P=p(x,S),dr=!1,Do&&(P=Lg(c,p,x,S)),Rg(s),P}function Rg(s){J.H=ed;var c=Fn!==null&&Fn.next!==null;if(Ha=0,vn=Fn=on=null,kc=!1,El=0,ya=null,c)throw Error(r(300));s===null||Hi||(s=s.dependencies,s!==null&&pf(s)&&(Hi=!0))}function Lg(s,c,p,x){on=s;var S=0;do{if(Do&&(ya=null),El=0,Do=!1,25<=S)throw Error(r(301));if(S+=1,vn=Fn=null,s.updateQueue!=null){var P=s.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}J.H=Wg,P=c(p,x)}while(Do);return P}function wp(){var s=J.H,c=s.useState()[0];return c=typeof c.then=="function"?Vu(c):c,s=s.useState()[0],(Fn!==null?Fn.memoizedState:null)!==s&&(on.flags|=1024),c}function Np(){var s=Tc!==0;return Tc=0,s}function Mo(s,c,p){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~p}function vf(s){if(kc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}kc=!1}Ha=0,vn=Fn=on=null,Do=!1,El=Tc=0,ya=null}function Pr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?on.memoizedState=vn=s:vn=vn.next=s,vn}function Ei(){if(Fn===null){var s=on.alternate;s=s!==null?s.memoizedState:null}else s=Fn.next;var c=vn===null?on.memoizedState:vn.next;if(c!==null)vn=c,Fn=s;else{if(s===null)throw on.alternate===null?Error(r(467)):Error(r(310));Fn=s,s={memoizedState:Fn.memoizedState,baseState:Fn.baseState,baseQueue:Fn.baseQueue,queue:Fn.queue,next:null},vn===null?on.memoizedState=vn=s:vn=vn.next=s}return vn}function Io(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vu(s){var c=El;return El+=1,ya===null&&(ya=[]),s=yp(ya,s,c),c=on,(vn===null?c.memoizedState:vn.next)===null&&(c=c.alternate,J.H=c===null||c.memoizedState===null?Yg:Fp),s}function wf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Vu(s);if(s.$$typeof===M)return wi(s)}throw Error(r(438,String(s)))}function Hu(s){var c=null,p=on.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var x=on.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(S){return S.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=Io(),on.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(s),x=0;x<s;x++)p[x]=O;return c.index++,p}function gs(s,c){return typeof c=="function"?c(s):c}function Nf(s){var c=Ei();return Sp(c,Fn,s)}function Sp(s,c,p){var x=s.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=p;var S=s.baseQueue,P=x.pending;if(P!==null){if(S!==null){var G=S.next;S.next=P.next,P.next=G}c.baseQueue=S=P,x.pending=null}if(P=s.baseState,S===null)s.memoizedState=P;else{c=S.next;var Z=G=null,me=null,Pe=c,He=!1;do{var Qe=Pe.lane&-536870913;if(Qe!==Pe.lane?(Tn&Qe)===Qe:(Ha&Qe)===Qe){var Me=Pe.revertLane;if(Me===0)me!==null&&(me=me.next={lane:0,revertLane:0,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null}),Qe===jc&&(He=!0);else if((Ha&Me)===Me){Pe=Pe.next,Me===jc&&(He=!0);continue}else Qe={lane:0,revertLane:Pe.revertLane,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null},me===null?(Z=me=Qe,G=P):me=me.next=Qe,on.lanes|=Me,Ll|=Me;Qe=Pe.action,dr&&p(P,Qe),P=Pe.hasEagerState?Pe.eagerState:p(P,Qe)}else Me={lane:Qe,revertLane:Pe.revertLane,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null},me===null?(Z=me=Me,G=P):me=me.next=Me,on.lanes|=Qe,Ll|=Qe;Pe=Pe.next}while(Pe!==null&&Pe!==c);if(me===null?G=P:me.next=Z,!xr(P,s.memoizedState)&&(Hi=!0,He&&(p=Ar,p!==null)))throw p;s.memoizedState=P,s.baseState=G,s.baseQueue=me,x.lastRenderedState=P}return S===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function jp(s){var c=Ei(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var x=p.dispatch,S=p.pending,P=c.memoizedState;if(S!==null){p.pending=null;var G=S=S.next;do P=s(P,G.action),G=G.next;while(G!==S);xr(P,c.memoizedState)||(Hi=!0),c.memoizedState=P,c.baseQueue===null&&(c.baseState=P),p.lastRenderedState=P}return[P,x]}function _p(s,c,p){var x=on,S=Ei(),P=bn;if(P){if(p===void 0)throw Error(r(407));p=p()}else p=c();var G=!xr((Fn||S).memoizedState,p);G&&(S.memoizedState=p,Hi=!0),S=S.queue;var Z=jf.bind(null,x,S,s);if(Wu(2048,8,Z,[s]),S.getSnapshot!==c||G||vn!==null&&vn.memoizedState.tag&1){if(x.flags|=2048,Ec(9,Ef(),Og.bind(null,x,S,p,c),null),ii===null)throw Error(r(349));P||(Ha&124)!==0||Sf(x,c,p)}return p}function Sf(s,c,p){s.flags|=16384,s={getSnapshot:c,value:p},c=on.updateQueue,c===null?(c=Io(),on.updateQueue=c,c.stores=[s]):(p=c.stores,p===null?c.stores=[s]:p.push(s))}function Og(s,c,p,x){c.value=p,c.getSnapshot=x,Cp(c)&&kp(s)}function jf(s,c,p){return p(function(){Cp(c)&&kp(s)})}function Cp(s){var c=s.getSnapshot;s=s.value;try{var p=c();return!xr(s,p)}catch{return!0}}function kp(s){var c=No(s,2);c!==null&&ra(c,s,2)}function _f(s){var c=Pr();if(typeof s=="function"){var p=s;if(s=p(),dr){Ae(!0);try{p()}finally{Ae(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:s},c}function Gu(s,c,p,x){return s.baseState=p,Sp(s,Fn,typeof x=="function"?x:gs)}function Kb(s,c,p,x,S){if(Mf(s))throw Error(r(485));if(s=c.action,s!==null){var P={payload:S,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){P.listeners.push(G)}};J.T!==null?p(!0):P.isTransition=!1,x(P),p=c.pending,p===null?(P.next=c.pending=P,Tp(c,P)):(P.next=p.next,c.pending=p.next=P)}}function Tp(s,c){var p=c.action,x=c.payload,S=s.state;if(c.isTransition){var P=J.T,G={};J.T=G;try{var Z=p(S,x),me=J.S;me!==null&&me(G,Z),Ep(s,c,Z)}catch(Pe){Cf(s,c,Pe)}finally{J.T=P}}else try{P=p(S,x),Ep(s,c,P)}catch(Pe){Cf(s,c,Pe)}}function Ep(s,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Fg(s,c,x)},function(x){return Cf(s,c,x)}):Fg(s,c,p)}function Fg(s,c,p){c.status="fulfilled",c.value=p,$g(c),s.state=p,c=s.pending,c!==null&&(p=c.next,p===c?s.pending=null:(p=p.next,c.next=p,Tp(s,p)))}function Cf(s,c,p){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=p,$g(c),c=c.next;while(c!==x)}s.action=null}function $g(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function kf(s,c){return c}function Ap(s,c){if(bn){var p=ii.formState;if(p!==null){e:{var x=on;if(bn){if(di){t:{for(var S=di,P=Tr;S.nodeType!==8;){if(!P){S=null;break t}if(S=Wa(S.nextSibling),S===null){S=null;break t}}P=S.data,S=P==="F!"||P==="F"?S:null}if(S){di=Wa(S.nextSibling),x=S.data==="F!";break e}}ma(x)}x=!1}x&&(c=p[0])}}return p=Pr(),p.memoizedState=p.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kf,lastRenderedState:c},p.queue=x,p=Rp.bind(null,on,x),x.dispatch=p,x=_f(!1),P=Lp.bind(null,on,!1,x.queue),x=Pr(),S={state:c,dispatch:null,action:s,pending:null},x.queue=S,p=Kb.bind(null,on,S,P,p),S.dispatch=p,x.memoizedState=s,[c,p,!1]}function Tf(s){var c=Ei();return zg(c,Fn,s)}function zg(s,c,p){if(c=Sp(s,c,kf)[0],s=Nf(gs)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Vu(c)}catch(G){throw G===vr?yf:G}else x=c;c=Ei();var S=c.queue,P=S.dispatch;return p!==c.memoizedState&&(on.flags|=2048,Ec(9,Ef(),Pp.bind(null,S,p),null)),[x,P,s]}function Pp(s,c){s.action=c}function sn(s){var c=Ei(),p=Fn;if(p!==null)return zg(c,p,s);Ei(),c=c.memoizedState,p=Ei();var x=p.queue.dispatch;return p.memoizedState=s,[c,x,!1]}function Ec(s,c,p,x){return s={tag:s,create:p,deps:x,inst:c,next:null},c=on.updateQueue,c===null&&(c=Io(),on.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=s.next=s:(x=p.next,p.next=s,s.next=x,c.lastEffect=s),s}function Ef(){return{destroy:void 0,resource:void 0}}function Ac(){return Ei().memoizedState}function Yu(s,c,p,x){var S=Pr();x=x===void 0?null:x,on.flags|=s,S.memoizedState=Ec(1|c,Ef(),p,x)}function Wu(s,c,p,x){var S=Ei();x=x===void 0?null:x;var P=S.memoizedState.inst;Fn!==null&&x!==null&&qu(x,Fn.memoizedState.deps)?S.memoizedState=Ec(c,P,p,x):(on.flags|=s,S.memoizedState=Ec(1|c,P,p,x))}function Bg(s,c){Yu(8390656,8,s,c)}function ea(s,c){Wu(2048,8,s,c)}function Ug(s,c){return Wu(4,2,s,c)}function Qu(s,c){return Wu(4,4,s,c)}function Af(s,c){if(typeof c=="function"){s=s();var p=c(s);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Dp(s,c,p){p=p!=null?p.concat([s]):null,Wu(4,4,Af.bind(null,c,s),p)}function Pf(){}function Dr(s,c){var p=Ei();c=c===void 0?null:c;var x=p.memoizedState;return c!==null&&qu(c,x[1])?x[0]:(p.memoizedState=[s,c],s)}function Vs(s,c){var p=Ei();c=c===void 0?null:c;var x=p.memoizedState;if(c!==null&&qu(c,x[1]))return x[0];if(x=s(),dr){Ae(!0);try{s()}finally{Ae(!1)}}return p.memoizedState=[x,c],x}function Ju(s,c,p){return p===void 0||(Ha&1073741824)!==0?s.memoizedState=c:(s.memoizedState=p,s=wy(),on.lanes|=s,Ll|=s,p)}function Mp(s,c,p,x){return xr(p,c)?p:Po.current!==null?(s=Ju(s,p,x),xr(s,c)||(Hi=!0),s):(Ha&42)===0?(Hi=!0,s.memoizedState=p):(s=wy(),on.lanes|=s,Ll|=s,c)}function Ku(s,c,p,x,S){var P=q.p;q.p=P!==0&&8>P?P:8;var G=J.T,Z={};J.T=Z,Lp(s,!1,c,p);try{var me=S(),Pe=J.S;if(Pe!==null&&Pe(Z,me),me!==null&&typeof me=="object"&&typeof me.then=="function"){var He=Jb(me,x);Ro(s,c,He,hr(s))}else Ro(s,c,x,hr(s))}catch(Qe){Ro(s,c,{then:function(){},status:"rejected",reason:Qe},hr())}finally{q.p=P,J.T=G}}function qg(){}function Xu(s,c,p,x){if(s.tag!==5)throw Error(r(476));var S=Ip(s).queue;Ku(s,S,c,H,p===null?qg:function(){return Df(s),p(x)})}function Ip(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:H,baseState:H,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:H},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:p},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function Df(s){var c=Ip(s).next.queue;Ro(s,c,{},hr())}function Zu(){return wi(Kc)}function Hs(){return Ei().memoizedState}function Vg(){return Ei().memoizedState}function Al(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var p=hr();s=kl(p);var x=Us(c,s,p);x!==null&&(ra(x,c,p),Bu(x,c,p)),c={cache:pp()},s.payload=c;return}c=c.return}}function Hg(s,c,p){var x=hr();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Mf(s)?Gg(c,p):(p=wc(s,c,p,x),p!==null&&(ra(p,s,x),Op(p,c,x)))}function Rp(s,c,p){var x=hr();Ro(s,c,p,x)}function Ro(s,c,p,x){var S={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Mf(s))Gg(c,S);else{var P=s.alternate;if(s.lanes===0&&(P===null||P.lanes===0)&&(P=c.lastRenderedReducer,P!==null))try{var G=c.lastRenderedState,Z=P(G,p);if(S.hasEagerState=!0,S.eagerState=Z,xr(Z,G))return Ba(s,c,S,0),ii===null&&wo(),!1}catch{}finally{}if(p=wc(s,c,S,x),p!==null)return ra(p,s,x),Op(p,c,x),!0}return!1}function Lp(s,c,p,x){if(x={lane:2,revertLane:th(),action:x,hasEagerState:!1,eagerState:null,next:null},Mf(s)){if(c)throw Error(r(479))}else c=wc(s,p,x,2),c!==null&&ra(c,s,2)}function Mf(s){var c=s.alternate;return s===on||c!==null&&c===on}function Gg(s,c){Do=kc=!0;var p=s.pending;p===null?c.next=c:(c.next=p.next,p.next=c),s.pending=c}function Op(s,c,p){if((p&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Nt(s,p)}}var ed={readContext:wi,use:wf,useCallback:wn,useContext:wn,useEffect:wn,useImperativeHandle:wn,useLayoutEffect:wn,useInsertionEffect:wn,useMemo:wn,useReducer:wn,useRef:wn,useState:wn,useDebugValue:wn,useDeferredValue:wn,useTransition:wn,useSyncExternalStore:wn,useId:wn,useHostTransitionStatus:wn,useFormState:wn,useActionState:wn,useOptimistic:wn,useMemoCache:wn,useCacheRefresh:wn},Yg={readContext:wi,use:wf,useCallback:function(s,c){return Pr().memoizedState=[s,c===void 0?null:c],s},useContext:wi,useEffect:Bg,useImperativeHandle:function(s,c,p){p=p!=null?p.concat([s]):null,Yu(4194308,4,Af.bind(null,c,s),p)},useLayoutEffect:function(s,c){return Yu(4194308,4,s,c)},useInsertionEffect:function(s,c){Yu(4,2,s,c)},useMemo:function(s,c){var p=Pr();c=c===void 0?null:c;var x=s();if(dr){Ae(!0);try{s()}finally{Ae(!1)}}return p.memoizedState=[x,c],x},useReducer:function(s,c,p){var x=Pr();if(p!==void 0){var S=p(c);if(dr){Ae(!0);try{p(c)}finally{Ae(!1)}}}else S=c;return x.memoizedState=x.baseState=S,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:S},x.queue=s,s=s.dispatch=Hg.bind(null,on,s),[x.memoizedState,s]},useRef:function(s){var c=Pr();return s={current:s},c.memoizedState=s},useState:function(s){s=_f(s);var c=s.queue,p=Rp.bind(null,on,c);return c.dispatch=p,[s.memoizedState,p]},useDebugValue:Pf,useDeferredValue:function(s,c){var p=Pr();return Ju(p,s,c)},useTransition:function(){var s=_f(!1);return s=Ku.bind(null,on,s.queue,!0,!1),Pr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,p){var x=on,S=Pr();if(bn){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),ii===null)throw Error(r(349));(Tn&124)!==0||Sf(x,c,p)}S.memoizedState=p;var P={value:p,getSnapshot:c};return S.queue=P,Bg(jf.bind(null,x,P,s),[s]),x.flags|=2048,Ec(9,Ef(),Og.bind(null,x,P,p,c),null),p},useId:function(){var s=Pr(),c=ii.identifierPrefix;if(bn){var p=zs,x=ui;p=(x&~(1<<32-Ie(x)-1)).toString(32)+p,c=""+c+"R"+p,p=Tc++,0<p&&(c+="H"+p.toString(32)),c+=""}else p=Ig++,c=""+c+"r"+p.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Zu,useFormState:Ap,useActionState:Ap,useOptimistic:function(s){var c=Pr();c.memoizedState=c.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=Lp.bind(null,on,!0,p),p.dispatch=c,[s,c]},useMemoCache:Hu,useCacheRefresh:function(){return Pr().memoizedState=Al.bind(null,on)}},Fp={readContext:wi,use:wf,useCallback:Dr,useContext:wi,useEffect:ea,useImperativeHandle:Dp,useInsertionEffect:Ug,useLayoutEffect:Qu,useMemo:Vs,useReducer:Nf,useRef:Ac,useState:function(){return Nf(gs)},useDebugValue:Pf,useDeferredValue:function(s,c){var p=Ei();return Mp(p,Fn.memoizedState,s,c)},useTransition:function(){var s=Nf(gs)[0],c=Ei().memoizedState;return[typeof s=="boolean"?s:Vu(s),c]},useSyncExternalStore:_p,useId:Hs,useHostTransitionStatus:Zu,useFormState:Tf,useActionState:Tf,useOptimistic:function(s,c){var p=Ei();return Gu(p,Fn,s,c)},useMemoCache:Hu,useCacheRefresh:Vg},Wg={readContext:wi,use:wf,useCallback:Dr,useContext:wi,useEffect:ea,useImperativeHandle:Dp,useInsertionEffect:Ug,useLayoutEffect:Qu,useMemo:Vs,useReducer:jp,useRef:Ac,useState:function(){return jp(gs)},useDebugValue:Pf,useDeferredValue:function(s,c){var p=Ei();return Fn===null?Ju(p,s,c):Mp(p,Fn.memoizedState,s,c)},useTransition:function(){var s=jp(gs)[0],c=Ei().memoizedState;return[typeof s=="boolean"?s:Vu(s),c]},useSyncExternalStore:_p,useId:Hs,useHostTransitionStatus:Zu,useFormState:sn,useActionState:sn,useOptimistic:function(s,c){var p=Ei();return Fn!==null?Gu(p,Fn,s,c):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:Hu,useCacheRefresh:Vg},Ri=null,Mr=0;function If(s){var c=Mr;return Mr+=1,Ri===null&&(Ri=[]),yp(Ri,s,c)}function td(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function Lo(s,c){throw c.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function Oo(s){var c=s._init;return c(s._payload)}function $p(s){function c(Ce,ve){if(s){var Ee=Ce.deletions;Ee===null?(Ce.deletions=[ve],Ce.flags|=16):Ee.push(ve)}}function p(Ce,ve){if(!s)return null;for(;ve!==null;)c(Ce,ve),ve=ve.sibling;return null}function x(Ce){for(var ve=new Map;Ce!==null;)Ce.key!==null?ve.set(Ce.key,Ce):ve.set(Ce.index,Ce),Ce=Ce.sibling;return ve}function S(Ce,ve){return Ce=br(Ce,ve),Ce.index=0,Ce.sibling=null,Ce}function P(Ce,ve,Ee){return Ce.index=Ee,s?(Ee=Ce.alternate,Ee!==null?(Ee=Ee.index,Ee<ve?(Ce.flags|=67108866,ve):Ee):(Ce.flags|=67108866,ve)):(Ce.flags|=1048576,ve)}function G(Ce){return s&&Ce.alternate===null&&(Ce.flags|=67108866),Ce}function Z(Ce,ve,Ee,Ge){return ve===null||ve.tag!==6?(ve=dp(Ee,Ce.mode,Ge),ve.return=Ce,ve):(ve=S(ve,Ee),ve.return=Ce,ve)}function me(Ce,ve,Ee,Ge){var St=Ee.type;return St===N?He(Ce,ve,Ee.props.children,Ge,Ee.key):ve!==null&&(ve.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===U&&Oo(St)===ve.type)?(ve=S(ve,Ee.props),td(ve,Ee),ve.return=Ce,ve):(ve=ff(Ee.type,Ee.key,Ee.props,null,Ce.mode,Ge),td(ve,Ee),ve.return=Ce,ve)}function Pe(Ce,ve,Ee,Ge){return ve===null||ve.tag!==4||ve.stateNode.containerInfo!==Ee.containerInfo||ve.stateNode.implementation!==Ee.implementation?(ve=Nc(Ee,Ce.mode,Ge),ve.return=Ce,ve):(ve=S(ve,Ee.children||[]),ve.return=Ce,ve)}function He(Ce,ve,Ee,Ge,St){return ve===null||ve.tag!==7?(ve=_o(Ee,Ce.mode,Ge,St),ve.return=Ce,ve):(ve=S(ve,Ee),ve.return=Ce,ve)}function Qe(Ce,ve,Ee){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return ve=dp(""+ve,Ce.mode,Ee),ve.return=Ce,ve;if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case b:return Ee=ff(ve.type,ve.key,ve.props,null,Ce.mode,Ee),td(Ee,ve),Ee.return=Ce,Ee;case v:return ve=Nc(ve,Ce.mode,Ee),ve.return=Ce,ve;case U:var Ge=ve._init;return ve=Ge(ve._payload),Qe(Ce,ve,Ee)}if(re(ve)||W(ve))return ve=_o(ve,Ce.mode,Ee,null),ve.return=Ce,ve;if(typeof ve.then=="function")return Qe(Ce,If(ve),Ee);if(ve.$$typeof===M)return Qe(Ce,mf(Ce,ve),Ee);Lo(Ce,ve)}return null}function Me(Ce,ve,Ee,Ge){var St=ve!==null?ve.key:null;if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return St!==null?null:Z(Ce,ve,""+Ee,Ge);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case b:return Ee.key===St?me(Ce,ve,Ee,Ge):null;case v:return Ee.key===St?Pe(Ce,ve,Ee,Ge):null;case U:return St=Ee._init,Ee=St(Ee._payload),Me(Ce,ve,Ee,Ge)}if(re(Ee)||W(Ee))return St!==null?null:He(Ce,ve,Ee,Ge,null);if(typeof Ee.then=="function")return Me(Ce,ve,If(Ee),Ge);if(Ee.$$typeof===M)return Me(Ce,ve,mf(Ce,Ee),Ge);Lo(Ce,Ee)}return null}function De(Ce,ve,Ee,Ge,St){if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint")return Ce=Ce.get(Ee)||null,Z(ve,Ce,""+Ge,St);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case b:return Ce=Ce.get(Ge.key===null?Ee:Ge.key)||null,me(ve,Ce,Ge,St);case v:return Ce=Ce.get(Ge.key===null?Ee:Ge.key)||null,Pe(ve,Ce,Ge,St);case U:var hn=Ge._init;return Ge=hn(Ge._payload),De(Ce,ve,Ee,Ge,St)}if(re(Ge)||W(Ge))return Ce=Ce.get(Ee)||null,He(ve,Ce,Ge,St,null);if(typeof Ge.then=="function")return De(Ce,ve,Ee,If(Ge),St);if(Ge.$$typeof===M)return De(Ce,ve,Ee,mf(ve,Ge),St);Lo(ve,Ge)}return null}function zt(Ce,ve,Ee,Ge){for(var St=null,hn=null,Pt=ve,Bt=ve=0,Wi=null;Pt!==null&&Bt<Ee.length;Bt++){Pt.index>Bt?(Wi=Pt,Pt=null):Wi=Pt.sibling;var En=Me(Ce,Pt,Ee[Bt],Ge);if(En===null){Pt===null&&(Pt=Wi);break}s&&Pt&&En.alternate===null&&c(Ce,Pt),ve=P(En,ve,Bt),hn===null?St=En:hn.sibling=En,hn=En,Pt=Wi}if(Bt===Ee.length)return p(Ce,Pt),bn&&Co(Ce,Bt),St;if(Pt===null){for(;Bt<Ee.length;Bt++)Pt=Qe(Ce,Ee[Bt],Ge),Pt!==null&&(ve=P(Pt,ve,Bt),hn===null?St=Pt:hn.sibling=Pt,hn=Pt);return bn&&Co(Ce,Bt),St}for(Pt=x(Pt);Bt<Ee.length;Bt++)Wi=De(Pt,Ce,Bt,Ee[Bt],Ge),Wi!==null&&(s&&Wi.alternate!==null&&Pt.delete(Wi.key===null?Bt:Wi.key),ve=P(Wi,ve,Bt),hn===null?St=Wi:hn.sibling=Wi,hn=Wi);return s&&Pt.forEach(function(Gl){return c(Ce,Gl)}),bn&&Co(Ce,Bt),St}function $t(Ce,ve,Ee,Ge){if(Ee==null)throw Error(r(151));for(var St=null,hn=null,Pt=ve,Bt=ve=0,Wi=null,En=Ee.next();Pt!==null&&!En.done;Bt++,En=Ee.next()){Pt.index>Bt?(Wi=Pt,Pt=null):Wi=Pt.sibling;var Gl=Me(Ce,Pt,En.value,Ge);if(Gl===null){Pt===null&&(Pt=Wi);break}s&&Pt&&Gl.alternate===null&&c(Ce,Pt),ve=P(Gl,ve,Bt),hn===null?St=Gl:hn.sibling=Gl,hn=Gl,Pt=Wi}if(En.done)return p(Ce,Pt),bn&&Co(Ce,Bt),St;if(Pt===null){for(;!En.done;Bt++,En=Ee.next())En=Qe(Ce,En.value,Ge),En!==null&&(ve=P(En,ve,Bt),hn===null?St=En:hn.sibling=En,hn=En);return bn&&Co(Ce,Bt),St}for(Pt=x(Pt);!En.done;Bt++,En=Ee.next())En=De(Pt,Ce,Bt,En.value,Ge),En!==null&&(s&&En.alternate!==null&&Pt.delete(En.key===null?Bt:En.key),ve=P(En,ve,Bt),hn===null?St=En:hn.sibling=En,hn=En);return s&&Pt.forEach(function(M0){return c(Ce,M0)}),bn&&Co(Ce,Bt),St}function Qn(Ce,ve,Ee,Ge){if(typeof Ee=="object"&&Ee!==null&&Ee.type===N&&Ee.key===null&&(Ee=Ee.props.children),typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case b:e:{for(var St=Ee.key;ve!==null;){if(ve.key===St){if(St=Ee.type,St===N){if(ve.tag===7){p(Ce,ve.sibling),Ge=S(ve,Ee.props.children),Ge.return=Ce,Ce=Ge;break e}}else if(ve.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===U&&Oo(St)===ve.type){p(Ce,ve.sibling),Ge=S(ve,Ee.props),td(Ge,Ee),Ge.return=Ce,Ce=Ge;break e}p(Ce,ve);break}else c(Ce,ve);ve=ve.sibling}Ee.type===N?(Ge=_o(Ee.props.children,Ce.mode,Ge,Ee.key),Ge.return=Ce,Ce=Ge):(Ge=ff(Ee.type,Ee.key,Ee.props,null,Ce.mode,Ge),td(Ge,Ee),Ge.return=Ce,Ce=Ge)}return G(Ce);case v:e:{for(St=Ee.key;ve!==null;){if(ve.key===St)if(ve.tag===4&&ve.stateNode.containerInfo===Ee.containerInfo&&ve.stateNode.implementation===Ee.implementation){p(Ce,ve.sibling),Ge=S(ve,Ee.children||[]),Ge.return=Ce,Ce=Ge;break e}else{p(Ce,ve);break}else c(Ce,ve);ve=ve.sibling}Ge=Nc(Ee,Ce.mode,Ge),Ge.return=Ce,Ce=Ge}return G(Ce);case U:return St=Ee._init,Ee=St(Ee._payload),Qn(Ce,ve,Ee,Ge)}if(re(Ee))return zt(Ce,ve,Ee,Ge);if(W(Ee)){if(St=W(Ee),typeof St!="function")throw Error(r(150));return Ee=St.call(Ee),$t(Ce,ve,Ee,Ge)}if(typeof Ee.then=="function")return Qn(Ce,ve,If(Ee),Ge);if(Ee.$$typeof===M)return Qn(Ce,ve,mf(Ce,Ee),Ge);Lo(Ce,Ee)}return typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint"?(Ee=""+Ee,ve!==null&&ve.tag===6?(p(Ce,ve.sibling),Ge=S(ve,Ee),Ge.return=Ce,Ce=Ge):(p(Ce,ve),Ge=dp(Ee,Ce.mode,Ge),Ge.return=Ce,Ce=Ge),G(Ce)):p(Ce,ve)}return function(Ce,ve,Ee,Ge){try{Mr=0;var St=Qn(Ce,ve,Ee,Ge);return Ri=null,St}catch(Pt){if(Pt===vr||Pt===yf)throw Pt;var hn=kr(29,Pt,null,Ce.mode);return hn.lanes=Ge,hn.return=Ce,hn}finally{}}}var Fo=$p(!0),Qg=$p(!1),ta=Q(null),wr=null;function xa(s){var c=s.alternate;I(Ni,Ni.current&1),I(ta,s),wr===null&&(c===null||Po.current!==null||c.memoizedState!==null)&&(wr=s)}function Jg(s){if(s.tag===22){if(I(Ni,Ni.current),I(ta,s),wr===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(wr=s)}}else Gs()}function Gs(){I(Ni,Ni.current),I(ta,ta.current)}function ys(s){ie(ta),wr===s&&(wr=null),ie(Ni)}var Ni=Q(0);function nd(s){for(var c=s;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||Sr(p)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Pc(s,c,p,x){c=s.memoizedState,p=p(x,c),p=p==null?c:h({},c,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}var id={enqueueSetState:function(s,c,p){s=s._reactInternals;var x=hr(),S=kl(x);S.payload=c,p!=null&&(S.callback=p),c=Us(s,S,x),c!==null&&(ra(c,s,x),Bu(c,s,x))},enqueueReplaceState:function(s,c,p){s=s._reactInternals;var x=hr(),S=kl(x);S.tag=1,S.payload=c,p!=null&&(S.callback=p),c=Us(s,S,x),c!==null&&(ra(c,s,x),Bu(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var p=hr(),x=kl(p);x.tag=2,c!=null&&(x.callback=c),c=Us(s,x,p),c!==null&&(ra(c,s,p),Bu(c,s,p))}};function rd(s,c,p,x,S,P,G){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,P,G):c.prototype&&c.prototype.isPureReactComponent?!fa(p,x)||!fa(S,P):!0}function Kg(s,c,p,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,x),c.state!==s&&id.enqueueReplaceState(c,c.state,null)}function Pl(s,c){var p=c;if("ref"in c){p={};for(var x in c)x!=="ref"&&(p[x]=c[x])}if(s=s.defaultProps){p===c&&(p=h({},p));for(var S in s)p[S]===void 0&&(p[S]=s[S])}return p}var $o=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function zp(s){$o(s)}function Rf(s){console.error(s)}function Xg(s){$o(s)}function ad(s,c){try{var p=s.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function xs(s,c,p){try{var x=s.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function Lf(s,c,p){return p=kl(p),p.tag=3,p.payload={element:null},p.callback=function(){ad(s,c)},p}function Bp(s){return s=kl(s),s.tag=3,s}function Zg(s,c,p,x){var S=p.type.getDerivedStateFromError;if(typeof S=="function"){var P=x.value;s.payload=function(){return S(P)},s.callback=function(){xs(c,p,x)}}var G=p.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(s.callback=function(){xs(c,p,x),typeof S!="function"&&(Ol===null?Ol=new Set([this]):Ol.add(this));var Z=x.stack;this.componentDidCatch(x.value,{componentStack:Z!==null?Z:""})})}function ey(s,c,p,x,S){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=p.alternate,c!==null&&Fu(c,p,S,!0),p=ta.current,p!==null){switch(p.tag){case 13:return wr===null?sm():p.alternate===null&&Si===0&&(Si=3),p.flags&=-257,p.flags|=65536,p.lanes=S,x===gp?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([x]):c.add(x),cm(s,x,S)),!1;case 22:return p.flags|=65536,x===gp?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([x]):p.add(x)),cm(s,x,S)),!1}throw Error(r(435,p.tag))}return cm(s,x,S),sm(),!1}if(bn)return c=ta.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=S,x!==Sc&&(s=Error(r(422),{cause:x}),_l(Vi(s,p)))):(x!==Sc&&(c=Error(r(423),{cause:x}),_l(Vi(c,p))),s=s.current.alternate,s.flags|=65536,S&=-S,s.lanes|=S,x=Vi(x,p),S=Lf(s.stateNode,x,S),qa(s,S),Si!==4&&(Si=2)),!1;var P=Error(r(520),{cause:x});if(P=Vi(P,p),md===null?md=[P]:md.push(P),Si!==4&&(Si=2),c===null)return!0;x=Vi(x,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,s=S&-S,p.lanes|=s,s=Lf(p.stateNode,x,s),qa(p,s),!1;case 1:if(c=p.type,P=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Ol===null||!Ol.has(P))))return p.flags|=65536,S&=-S,p.lanes|=S,S=Bp(S),Zg(S,s,p,x),qa(p,S),!1}p=p.return}while(p!==null);return!1}var ty=Error(r(461)),Hi=!1;function oi(s,c,p,x){c.child=s===null?Qg(c,null,p,x):Fo(c,s.child,p,x)}function Of(s,c,p,x,S){p=p.render;var P=c.ref;if("ref"in x){var G={};for(var Z in x)Z!=="ref"&&(G[Z]=x[Z])}else G=x;return To(c),x=vp(s,c,p,G,P,S),Z=Np(),s!==null&&!Hi?(Mo(s,c,S),Ys(s,c,S)):(bn&&Z&&hp(c),c.flags|=1,oi(s,c,x,S),c.child)}function Ff(s,c,p,x,S){if(s===null){var P=p.type;return typeof P=="function"&&!jo(P)&&P.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=P,$f(s,c,P,x,S)):(s=ff(p.type,null,x,c,c.mode,S),s.ref=c.ref,s.return=c,c.child=s)}if(P=s.child,!Ga(s,S)){var G=P.memoizedProps;if(p=p.compare,p=p!==null?p:fa,p(G,x)&&s.ref===c.ref)return Ys(s,c,S)}return c.flags|=1,s=br(P,x),s.ref=c.ref,s.return=c,c.child=s}function $f(s,c,p,x,S){if(s!==null){var P=s.memoizedProps;if(fa(P,x)&&s.ref===c.ref)if(Hi=!1,c.pendingProps=x=P,Ga(s,S))(s.flags&131072)!==0&&(Hi=!0);else return c.lanes=s.lanes,Ys(s,c,S)}return Dc(s,c,p,x,S)}function sd(s,c,p){var x=c.pendingProps,S=x.children,P=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=P!==null?P.baseLanes|p:p,s!==null){for(S=c.child=s.child,P=0;S!==null;)P=P|S.lanes|S.childLanes,S=S.sibling;c.childLanes=P&~x}else c.childLanes=0,c.child=null;return zo(s,c,x,p)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&gf(c,P!==null?P.cachePool:null),P!==null?qs(c,P):bf(),Jg(c);else return c.lanes=c.childLanes=536870912,zo(s,c,P!==null?P.baseLanes|p:p,p)}else P!==null?(gf(c,P.cachePool),qs(c,P),Gs(),c.memoizedState=null):(s!==null&&gf(c,null),bf(),Gs());return oi(s,c,S,p),c.child}function zo(s,c,p,x){var S=Bs();return S=S===null?null:{parent:Xn._currentValue,pool:S},c.memoizedState={baseLanes:p,cachePool:S},s!==null&&gf(c,null),bf(),Jg(c),s!==null&&Fu(s,c,x,!0),null}function Rt(s,c){var p=c.ref;if(p===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(c.flags|=4194816)}}function Dc(s,c,p,x,S){return To(c),p=vp(s,c,p,x,void 0,S),x=Np(),s!==null&&!Hi?(Mo(s,c,S),Ys(s,c,S)):(bn&&x&&hp(c),c.flags|=1,oi(s,c,p,S),c.child)}function zf(s,c,p,x,S,P){return To(c),c.updateQueue=null,p=Lg(c,x,p,S),Rg(s),x=Np(),s!==null&&!Hi?(Mo(s,c,P),Ys(s,c,P)):(bn&&x&&hp(c),c.flags|=1,oi(s,c,p,P),c.child)}function Dl(s,c,p,x,S){if(To(c),c.stateNode===null){var P=So,G=p.contextType;typeof G=="object"&&G!==null&&(P=wi(G)),P=new p(x,P),c.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=id,c.stateNode=P,P._reactInternals=c,P=c.stateNode,P.props=x,P.state=c.memoizedState,P.refs={},Ao(c),G=p.contextType,P.context=typeof G=="object"&&G!==null?wi(G):So,P.state=c.memoizedState,G=p.getDerivedStateFromProps,typeof G=="function"&&(Pc(c,p,G,x),P.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(G=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),G!==P.state&&id.enqueueReplaceState(P,P.state,null),ur(c,x,P,S),Va(),P.state=c.memoizedState),typeof P.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){P=c.stateNode;var Z=c.memoizedProps,me=Pl(p,Z);P.props=me;var Pe=P.context,He=p.contextType;G=So,typeof He=="object"&&He!==null&&(G=wi(He));var Qe=p.getDerivedStateFromProps;He=typeof Qe=="function"||typeof P.getSnapshotBeforeUpdate=="function",Z=c.pendingProps!==Z,He||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(Z||Pe!==G)&&Kg(c,P,x,G),ms=!1;var Me=c.memoizedState;P.state=Me,ur(c,x,P,S),Va(),Pe=c.memoizedState,Z||Me!==Pe||ms?(typeof Qe=="function"&&(Pc(c,p,Qe,x),Pe=c.memoizedState),(me=ms||rd(c,p,me,x,Me,Pe,G))?(He||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(c.flags|=4194308)):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Pe),P.props=x,P.state=Pe,P.context=G,x=me):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{P=c.stateNode,Cc(s,c),G=c.memoizedProps,He=Pl(p,G),P.props=He,Qe=c.pendingProps,Me=P.context,Pe=p.contextType,me=So,typeof Pe=="object"&&Pe!==null&&(me=wi(Pe)),Z=p.getDerivedStateFromProps,(Pe=typeof Z=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(G!==Qe||Me!==me)&&Kg(c,P,x,me),ms=!1,Me=c.memoizedState,P.state=Me,ur(c,x,P,S),Va();var De=c.memoizedState;G!==Qe||Me!==De||ms||s!==null&&s.dependencies!==null&&pf(s.dependencies)?(typeof Z=="function"&&(Pc(c,p,Z,x),De=c.memoizedState),(He=ms||rd(c,p,He,x,Me,De,me)||s!==null&&s.dependencies!==null&&pf(s.dependencies))?(Pe||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(x,De,me),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(x,De,me)),typeof P.componentDidUpdate=="function"&&(c.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof P.componentDidUpdate!="function"||G===s.memoizedProps&&Me===s.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||G===s.memoizedProps&&Me===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=De),P.props=x,P.state=De,P.context=me,x=He):(typeof P.componentDidUpdate!="function"||G===s.memoizedProps&&Me===s.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||G===s.memoizedProps&&Me===s.memoizedState||(c.flags|=1024),x=!1)}return P=x,Rt(s,c),x=(c.flags&128)!==0,P||x?(P=c.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:P.render(),c.flags|=1,s!==null&&x?(c.child=Fo(c,s.child,null,S),c.child=Fo(c,null,p,S)):oi(s,c,p,S),c.memoizedState=P.state,s=c.child):s=Ys(s,c,S),s}function ny(s,c,p,x){return Ou(),c.flags|=256,oi(s,c,p,x),c.child}var ld={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bf(s){return{baseLanes:s,cachePool:Tg()}}function Gi(s,c,p){return s=s!==null?s.childLanes&~p:0,c&&(s|=va),s}function iy(s,c,p){var x=c.pendingProps,S=!1,P=(c.flags&128)!==0,G;if((G=P)||(G=s!==null&&s.memoizedState===null?!1:(Ni.current&2)!==0),G&&(S=!0,c.flags&=-129),G=(c.flags&32)!==0,c.flags&=-33,s===null){if(bn){if(S?xa(c):Gs(),bn){var Z=di,me;if(me=Z){e:{for(me=Z,Z=Tr;me.nodeType!==8;){if(!Z){Z=null;break e}if(me=Wa(me.nextSibling),me===null){Z=null;break e}}Z=me}Z!==null?(c.memoizedState={dehydrated:Z,treeContext:li!==null?{id:ui,overflow:zs}:null,retryLane:536870912,hydrationErrors:null},me=kr(18,null,null,0),me.stateNode=Z,me.return=c,c.child=me,Ii=c,di=null,me=!0):me=!1}me||ma(c)}if(Z=c.memoizedState,Z!==null&&(Z=Z.dehydrated,Z!==null))return Sr(Z)?c.lanes=32:c.lanes=536870912,null;ys(c)}return Z=x.children,x=x.fallback,S?(Gs(),S=c.mode,Z=od({mode:"hidden",children:Z},S),x=_o(x,S,p,null),Z.return=c,x.return=c,Z.sibling=x,c.child=Z,S=c.child,S.memoizedState=Bf(p),S.childLanes=Gi(s,G,p),c.memoizedState=ld,x):(xa(c),Up(c,Z))}if(me=s.memoizedState,me!==null&&(Z=me.dehydrated,Z!==null)){if(P)c.flags&256?(xa(c),c.flags&=-257,c=qp(s,c,p)):c.memoizedState!==null?(Gs(),c.child=s.child,c.flags|=128,c=null):(Gs(),S=x.fallback,Z=c.mode,x=od({mode:"visible",children:x.children},Z),S=_o(S,Z,p,null),S.flags|=2,x.return=c,S.return=c,x.sibling=S,c.child=x,Fo(c,s.child,null,p),x=c.child,x.memoizedState=Bf(p),x.childLanes=Gi(s,G,p),c.memoizedState=ld,c=S);else if(xa(c),Sr(Z)){if(G=Z.nextSibling&&Z.nextSibling.dataset,G)var Pe=G.dgst;G=Pe,x=Error(r(419)),x.stack="",x.digest=G,_l({value:x,source:null,stack:null}),c=qp(s,c,p)}else if(Hi||Fu(s,c,p,!1),G=(p&s.childLanes)!==0,Hi||G){if(G=ii,G!==null&&(x=p&-p,x=(x&42)!==0?1:Ot(x),x=(x&(G.suspendedLanes|p))!==0?0:x,x!==0&&x!==me.retryLane))throw me.retryLane=x,No(s,x),ra(G,s,x),ty;Z.data==="$?"||sm(),c=qp(s,c,p)}else Z.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=me.treeContext,di=Wa(Z.nextSibling),Ii=c,bn=!0,Ua=null,Tr=!1,s!==null&&(ha[pa++]=ui,ha[pa++]=zs,ha[pa++]=li,ui=s.id,zs=s.overflow,li=c),c=Up(c,x.children),c.flags|=4096);return c}return S?(Gs(),S=x.fallback,Z=c.mode,me=s.child,Pe=me.sibling,x=br(me,{mode:"hidden",children:x.children}),x.subtreeFlags=me.subtreeFlags&65011712,Pe!==null?S=br(Pe,S):(S=_o(S,Z,p,null),S.flags|=2),S.return=c,x.return=c,x.sibling=S,c.child=x,x=S,S=c.child,Z=s.child.memoizedState,Z===null?Z=Bf(p):(me=Z.cachePool,me!==null?(Pe=Xn._currentValue,me=me.parent!==Pe?{parent:Pe,pool:Pe}:me):me=Tg(),Z={baseLanes:Z.baseLanes|p,cachePool:me}),S.memoizedState=Z,S.childLanes=Gi(s,G,p),c.memoizedState=ld,x):(xa(c),p=s.child,s=p.sibling,p=br(p,{mode:"visible",children:x.children}),p.return=c,p.sibling=null,s!==null&&(G=c.deletions,G===null?(c.deletions=[s],c.flags|=16):G.push(s)),c.child=p,c.memoizedState=null,p)}function Up(s,c){return c=od({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function od(s,c){return s=kr(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function qp(s,c,p){return Fo(c,s.child,null,p),s=Up(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Vp(s,c,p){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),Er(s.return,c,p)}function Hp(s,c,p,x,S){var P=s.memoizedState;P===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:S}:(P.isBackwards=c,P.rendering=null,P.renderingStartTime=0,P.last=x,P.tail=p,P.tailMode=S)}function ry(s,c,p){var x=c.pendingProps,S=x.revealOrder,P=x.tail;if(oi(s,c,x.children,p),x=Ni.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Vp(s,p,c);else if(s.tag===19)Vp(s,p,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(I(Ni,x),S){case"forwards":for(p=c.child,S=null;p!==null;)s=p.alternate,s!==null&&nd(s)===null&&(S=p),p=p.sibling;p=S,p===null?(S=c.child,c.child=null):(S=p.sibling,p.sibling=null),Hp(c,!1,S,p,P);break;case"backwards":for(p=null,S=c.child,c.child=null;S!==null;){if(s=S.alternate,s!==null&&nd(s)===null){c.child=S;break}s=S.sibling,S.sibling=p,p=S,S=s}Hp(c,!0,p,null,P);break;case"together":Hp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ys(s,c,p){if(s!==null&&(c.dependencies=s.dependencies),Ll|=c.lanes,(p&c.childLanes)===0)if(s!==null){if(Fu(s,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,p=br(s,s.pendingProps),c.child=p,p.return=c;s.sibling!==null;)s=s.sibling,p=p.sibling=br(s,s.pendingProps),p.return=c;p.sibling=null}return c.child}function Ga(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&pf(s)))}function Nr(s,c,p){switch(c.tag){case 3:ye(c,c.stateNode.containerInfo),Zr(c,Xn,s.memoizedState.cache),Ou();break;case 27:case 5:Ze(c);break;case 4:ye(c,c.stateNode.containerInfo);break;case 10:Zr(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(xa(c),c.flags|=128,null):(p&c.child.childLanes)!==0?iy(s,c,p):(xa(c),s=Ys(s,c,p),s!==null?s.sibling:null);xa(c);break;case 19:var S=(s.flags&128)!==0;if(x=(p&c.childLanes)!==0,x||(Fu(s,c,p,!1),x=(p&c.childLanes)!==0),S){if(x)return ry(s,c,p);c.flags|=128}if(S=c.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),I(Ni,Ni.current),x)break;return null;case 22:case 23:return c.lanes=0,sd(s,c,p);case 24:Zr(c,Xn,s.memoizedState.cache)}return Ys(s,c,p)}function Uf(s,c,p){if(s!==null)if(s.memoizedProps!==c.pendingProps)Hi=!0;else{if(!Ga(s,p)&&(c.flags&128)===0)return Hi=!1,Nr(s,c,p);Hi=(s.flags&131072)!==0}else Hi=!1,bn&&(c.flags&1048576)!==0&&fp(c,Iu,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,S=x._init;if(x=S(x._payload),c.type=x,typeof x=="function")jo(x)?(s=Pl(x,s),c.tag=1,c=Dl(null,c,x,s,p)):(c.tag=0,c=Dc(null,c,x,s,p));else{if(x!=null){if(S=x.$$typeof,S===V){c.tag=11,c=Of(null,c,x,s,p);break e}else if(S===B){c.tag=14,c=Ff(null,c,x,s,p);break e}}throw c=ne(x)||x,Error(r(306,c,""))}}return c;case 0:return Dc(s,c,c.type,c.pendingProps,p);case 1:return x=c.type,S=Pl(x,c.pendingProps),Dl(s,c,x,S,p);case 3:e:{if(ye(c,c.stateNode.containerInfo),s===null)throw Error(r(387));x=c.pendingProps;var P=c.memoizedState;S=P.element,Cc(s,c),ur(c,x,null,p);var G=c.memoizedState;if(x=G.cache,Zr(c,Xn,x),x!==P.cache&&fn(c,[Xn],p,!0),Va(),x=G.element,P.isDehydrated)if(P={element:x,isDehydrated:!1,cache:G.cache},c.updateQueue.baseState=P,c.memoizedState=P,c.flags&256){c=ny(s,c,x,p);break e}else if(x!==S){S=Vi(Error(r(424)),c),_l(S),c=ny(s,c,x,p);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(di=Wa(s.firstChild),Ii=c,bn=!0,Ua=null,Tr=!0,p=Qg(c,null,x,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Ou(),x===S){c=Ys(s,c,p);break e}oi(s,c,x,p)}c=c.child}return c;case 26:return Rt(s,c),s===null?(p=ex(c.type,null,c.pendingProps,null))?c.memoizedState=p:bn||(p=c.type,s=c.pendingProps,x=qo(le.current).createElement(p),x[Dt]=c,x[kt]=s,Fi(x,p,s),Gn(x),c.stateNode=x):c.memoizedState=ex(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return Ze(c),s===null&&bn&&(x=c.stateNode=Ky(c.type,c.pendingProps,le.current),Ii=c,Tr=!0,S=di,wa(c.type)?(xm=S,di=Wa(x.firstChild)):di=S),oi(s,c,c.pendingProps.children,p),Rt(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&bn&&((S=x=di)&&(x=Qy(x,c.type,c.pendingProps,Tr),x!==null?(c.stateNode=x,Ii=c,di=Wa(x.firstChild),Tr=!1,S=!0):S=!1),S||ma(c)),Ze(c),S=c.type,P=c.pendingProps,G=s!==null?s.memoizedProps:null,x=P.children,ah(S,P)?x=null:G!==null&&ah(S,G)&&(c.flags|=32),c.memoizedState!==null&&(S=vp(s,c,wp,null,null,p),Kc._currentValue=S),Rt(s,c),oi(s,c,x,p),c.child;case 6:return s===null&&bn&&((s=p=di)&&(p=lh(p,c.pendingProps,Tr),p!==null?(c.stateNode=p,Ii=c,di=null,s=!0):s=!1),s||ma(c)),null;case 13:return iy(s,c,p);case 4:return ye(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=Fo(c,null,x,p):oi(s,c,x,p),c.child;case 11:return Of(s,c,c.type,c.pendingProps,p);case 7:return oi(s,c,c.pendingProps,p),c.child;case 8:return oi(s,c,c.pendingProps.children,p),c.child;case 12:return oi(s,c,c.pendingProps.children,p),c.child;case 10:return x=c.pendingProps,Zr(c,c.type,x.value),oi(s,c,x.children,p),c.child;case 9:return S=c.type._context,x=c.pendingProps.children,To(c),S=wi(S),x=x(S),c.flags|=1,oi(s,c,x,p),c.child;case 14:return Ff(s,c,c.type,c.pendingProps,p);case 15:return $f(s,c,c.type,c.pendingProps,p);case 19:return ry(s,c,p);case 31:return x=c.pendingProps,p=c.mode,x={mode:x.mode,children:x.children},s===null?(p=od(x,p),p.ref=c.ref,c.child=p,p.return=c,c=p):(p=br(s.child,x),p.ref=c.ref,c.child=p,p.return=c,c=p),c;case 22:return sd(s,c,p);case 24:return To(c),x=wi(Xn),s===null?(S=Bs(),S===null&&(S=ii,P=pp(),S.pooledCache=P,P.refCount++,P!==null&&(S.pooledCacheLanes|=p),S=P),c.memoizedState={parent:x,cache:S},Ao(c),Zr(c,Xn,S)):((s.lanes&p)!==0&&(Cc(s,c),ur(c,null,null,p),Va()),S=s.memoizedState,P=c.memoizedState,S.parent!==x?(S={parent:x,cache:x},c.memoizedState=S,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=S),Zr(c,Xn,x)):(x=P.cache,Zr(c,Xn,x),x!==S.cache&&fn(c,[Xn],p,!0))),oi(s,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Ws(s){s.flags|=4}function qf(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!$i(c)){if(c=ta.current,c!==null&&((Tn&4194048)===Tn?wr!==null:(Tn&62914560)!==Tn&&(Tn&536870912)===0||c!==wr))throw _c=gp,Eg;s.flags|=8192}}function Vf(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?Be():536870912,s.lanes|=c,$c|=c)}function cd(s,c){if(!bn)switch(s.tailMode){case"hidden":c=s.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Zn(s){var c=s.alternate!==null&&s.alternate.child===s.child,p=0,x=0;if(c)for(var S=s.child;S!==null;)p|=S.lanes|S.childLanes,x|=S.subtreeFlags&65011712,x|=S.flags&65011712,S.return=s,S=S.sibling;else for(S=s.child;S!==null;)p|=S.lanes|S.childLanes,x|=S.subtreeFlags,x|=S.flags,S.return=s,S=S.sibling;return s.subtreeFlags|=x,s.childLanes=p,c}function ay(s,c,p){var x=c.pendingProps;switch(Ru(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(c),null;case 1:return Zn(c),null;case 3:return p=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),ga(Xn),Re(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Lu(c)?Ws(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,jg())),Zn(c),null;case 26:return p=c.memoizedState,s===null?(Ws(c),p!==null?(Zn(c),qf(c,p)):(Zn(c),c.flags&=-16777217)):p?p!==s.memoizedState?(Ws(c),Zn(c),qf(c,p)):(Zn(c),c.flags&=-16777217):(s.memoizedProps!==x&&Ws(c),Zn(c),c.flags&=-16777217),null;case 27:at(c),p=le.current;var S=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Ws(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Zn(c),null}s=ce.current,Lu(c)?Ng(c):(s=Ky(S,x,p),c.stateNode=s,Ws(c))}return Zn(c),null;case 5:if(at(c),p=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Ws(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Zn(c),null}if(s=ce.current,Lu(c))Ng(c);else{switch(S=qo(le.current),s){case 1:s=S.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:s=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":s=S.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":s=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":s=S.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?S.createElement("select",{is:x.is}):S.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?S.createElement(p,{is:x.is}):S.createElement(p)}}s[Dt]=c,s[kt]=x;e:for(S=c.child;S!==null;){if(S.tag===5||S.tag===6)s.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===c)break e;for(;S.sibling===null;){if(S.return===null||S.return===c)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}c.stateNode=s;e:switch(Fi(s,p,x),p){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ws(c)}}return Zn(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&Ws(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(s=le.current,Lu(c)){if(s=c.stateNode,p=c.memoizedProps,x=null,S=Ii,S!==null)switch(S.tag){case 27:case 5:x=S.memoizedProps}s[Dt]=c,s=!!(s.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||Hy(s.nodeValue,p)),s||ma(c)}else s=qo(s).createTextNode(x),s[Dt]=c,c.stateNode=s}return Zn(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(S=Lu(c),x!==null&&x.dehydrated!==null){if(s===null){if(!S)throw Error(r(318));if(S=c.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(r(317));S[Dt]=c}else Ou(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Zn(c),S=!1}else S=jg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=S),S=!0;if(!S)return c.flags&256?(ys(c),c):(ys(c),null)}if(ys(c),(c.flags&128)!==0)return c.lanes=p,c;if(p=x!==null,s=s!==null&&s.memoizedState!==null,p){x=c.child,S=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(S=x.alternate.memoizedState.cachePool.pool);var P=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(P=x.memoizedState.cachePool.pool),P!==S&&(x.flags|=2048)}return p!==s&&p&&(c.child.flags|=8192),Vf(c,c.updateQueue),Zn(c),null;case 4:return Re(),s===null&&pm(c.stateNode.containerInfo),Zn(c),null;case 10:return ga(c.type),Zn(c),null;case 19:if(ie(Ni),S=c.memoizedState,S===null)return Zn(c),null;if(x=(c.flags&128)!==0,P=S.rendering,P===null)if(x)cd(S,!1);else{if(Si!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(P=nd(s),P!==null){for(c.flags|=128,cd(S,!1),s=P.updateQueue,c.updateQueue=s,Vf(c,s),c.subtreeFlags=0,s=p,p=c.child;p!==null;)Mu(p,s),p=p.sibling;return I(Ni,Ni.current&1|2),c.child}s=s.sibling}S.tail!==null&&it()>zc&&(c.flags|=128,x=!0,cd(S,!1),c.lanes=4194304)}else{if(!x)if(s=nd(P),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,Vf(c,s),cd(S,!0),S.tail===null&&S.tailMode==="hidden"&&!P.alternate&&!bn)return Zn(c),null}else 2*it()-S.renderingStartTime>zc&&p!==536870912&&(c.flags|=128,x=!0,cd(S,!1),c.lanes=4194304);S.isBackwards?(P.sibling=c.child,c.child=P):(s=S.last,s!==null?s.sibling=P:c.child=P,S.last=P)}return S.tail!==null?(c=S.tail,S.rendering=c,S.tail=c.sibling,S.renderingStartTime=it(),c.sibling=null,s=Ni.current,I(Ni,x?s&1|2:s&1),c):(Zn(c),null);case 22:case 23:return ys(c),bp(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(p&536870912)!==0&&(c.flags&128)===0&&(Zn(c),c.subtreeFlags&6&&(c.flags|=8192)):Zn(c),p=c.updateQueue,p!==null&&Vf(c,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==p&&(c.flags|=2048),s!==null&&ie(Eo),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),ga(Xn),Zn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function sy(s,c){switch(Ru(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return ga(Xn),Re(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return at(c),null;case 13:if(ys(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Ou()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return ie(Ni),null;case 4:return Re(),null;case 10:return ga(c.type),null;case 22:case 23:return ys(c),bp(),s!==null&&ie(Eo),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return ga(Xn),null;case 25:return null;default:return null}}function ly(s,c){switch(Ru(c),c.tag){case 3:ga(Xn),Re();break;case 26:case 27:case 5:at(c);break;case 4:Re();break;case 13:ys(c);break;case 19:ie(Ni);break;case 10:ga(c.type);break;case 22:case 23:ys(c),bp(),s!==null&&ie(Eo);break;case 24:ga(Xn)}}function ud(s,c){try{var p=c.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var S=x.next;p=S;do{if((p.tag&s)===s){x=void 0;var P=p.create,G=p.inst;x=P(),G.destroy=x}p=p.next}while(p!==S)}}catch(Z){ei(c,c.return,Z)}}function Ml(s,c,p){try{var x=c.updateQueue,S=x!==null?x.lastEffect:null;if(S!==null){var P=S.next;x=P;do{if((x.tag&s)===s){var G=x.inst,Z=G.destroy;if(Z!==void 0){G.destroy=void 0,S=c;var me=p,Pe=Z;try{Pe()}catch(He){ei(S,me,He)}}}x=x.next}while(x!==P)}}catch(He){ei(c,c.return,He)}}function oy(s){var c=s.updateQueue;if(c!==null){var p=s.stateNode;try{xp(c,p)}catch(x){ei(s,s.return,x)}}}function Gp(s,c,p){p.props=Pl(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(x){ei(s,c,x)}}function Mc(s,c){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof p=="function"?s.refCleanup=p(x):p.current=x}}catch(S){ei(s,c,S)}}function bs(s,c){var p=s.ref,x=s.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(S){ei(s,c,S)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(S){ei(s,c,S)}else p.current=null}function Hf(s){var c=s.type,p=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(S){ei(s,s.return,S)}}function Gf(s,c,p){try{var x=s.stateNode;f0(x,s.type,p,c),x[kt]=c}catch(S){ei(s,s.return,S)}}function Ic(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&wa(s.type)||s.tag===4}function dd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Ic(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&wa(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Yf(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(s,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(s),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=ih));else if(x!==4&&(x===27&&wa(s.type)&&(p=s.stateNode,c=null),s=s.child,s!==null))for(Yf(s,c,p),s=s.sibling;s!==null;)Yf(s,c,p),s=s.sibling}function fd(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?p.insertBefore(s,c):p.appendChild(s);else if(x!==4&&(x===27&&wa(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(fd(s,c,p),s=s.sibling;s!==null;)fd(s,c,p),s=s.sibling}function hd(s){var c=s.stateNode,p=s.memoizedProps;try{for(var x=s.type,S=c.attributes;S.length;)c.removeAttributeNode(S[0]);Fi(c,x,p),c[Dt]=s,c[kt]=p}catch(P){ei(s,s.return,P)}}var vs=!1,Ln=!1,Qs=!1,cy=typeof WeakSet=="function"?WeakSet:Set,Li=null;function Xb(s,c){if(s=s.containerInfo,Ya=dh,s=Eu(s),Au(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var S=x.anchorOffset,P=x.focusNode;x=x.focusOffset;try{p.nodeType,P.nodeType}catch{p=null;break e}var G=0,Z=-1,me=-1,Pe=0,He=0,Qe=s,Me=null;t:for(;;){for(var De;Qe!==p||S!==0&&Qe.nodeType!==3||(Z=G+S),Qe!==P||x!==0&&Qe.nodeType!==3||(me=G+x),Qe.nodeType===3&&(G+=Qe.nodeValue.length),(De=Qe.firstChild)!==null;)Me=Qe,Qe=De;for(;;){if(Qe===s)break t;if(Me===p&&++Pe===S&&(Z=G),Me===P&&++He===x&&(me=G),(De=Qe.nextSibling)!==null)break;Qe=Me,Me=Qe.parentNode}Qe=De}p=Z===-1||me===-1?null:{start:Z,end:me}}else p=null}p=p||{start:0,end:0}}else p=null;for(rh={focusedElem:s,selectionRange:p},dh=!1,Li=c;Li!==null;)if(c=Li,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,Li=s;else for(;Li!==null;){switch(c=Li,P=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&P!==null){s=void 0,p=c,S=P.memoizedProps,P=P.memoizedState,x=p.stateNode;try{var zt=Pl(p.type,S,p.elementType===p.type);s=x.getSnapshotBeforeUpdate(zt,P),x.__reactInternalSnapshotBeforeUpdate=s}catch($t){ei(p,p.return,$t)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,p=s.nodeType,p===9)ym(s);else if(p===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ym(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=c.sibling,s!==null){s.return=c.return,Li=s;break}Li=c.return}}function uy(s,c,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:Il(s,p),x&4&&ud(5,p);break;case 1:if(Il(s,p),x&4)if(s=p.stateNode,c===null)try{s.componentDidMount()}catch(G){ei(p,p.return,G)}else{var S=Pl(p.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(S,c,s.__reactInternalSnapshotBeforeUpdate)}catch(G){ei(p,p.return,G)}}x&64&&oy(p),x&512&&Mc(p,p.return);break;case 3:if(Il(s,p),x&64&&(s=p.updateQueue,s!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{xp(s,c)}catch(G){ei(p,p.return,G)}}break;case 27:c===null&&x&4&&hd(p);case 26:case 5:Il(s,p),c===null&&x&4&&Hf(p),x&512&&Mc(p,p.return);break;case 12:Il(s,p);break;case 13:Il(s,p),x&4&&hy(s,p),x&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Xf.bind(null,p),Gc(s,p))));break;case 22:if(x=p.memoizedState!==null||vs,!x){c=c!==null&&c.memoizedState!==null||Ln,S=vs;var P=Ln;vs=x,(Ln=c)&&!P?Ks(s,p,(p.subtreeFlags&8772)!==0):Il(s,p),vs=S,Ln=P}break;case 30:break;default:Il(s,p)}}function dy(s){var c=s.alternate;c!==null&&(s.alternate=null,dy(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&Bi(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var fi=null,Ir=!1;function Js(s,c,p){for(p=p.child;p!==null;)fy(s,c,p),p=p.sibling}function fy(s,c,p){if(fe&&typeof fe.onCommitFiberUnmount=="function")try{fe.onCommitFiberUnmount(K,p)}catch{}switch(p.tag){case 26:Ln||bs(p,c),Js(s,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Ln||bs(p,c);var x=fi,S=Ir;wa(p.type)&&(fi=p.stateNode,Ir=!1),Js(s,c,p),jd(p.stateNode),fi=x,Ir=S;break;case 5:Ln||bs(p,c);case 6:if(x=fi,S=Ir,fi=null,Js(s,c,p),fi=x,Ir=S,fi!==null)if(Ir)try{(fi.nodeType===9?fi.body:fi.nodeName==="HTML"?fi.ownerDocument.body:fi).removeChild(p.stateNode)}catch(P){ei(p,c,P)}else try{fi.removeChild(p.stateNode)}catch(P){ei(p,c,P)}break;case 18:fi!==null&&(Ir?(s=fi,sh(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,p.stateNode),Dd(s)):sh(fi,p.stateNode));break;case 4:x=fi,S=Ir,fi=p.stateNode.containerInfo,Ir=!0,Js(s,c,p),fi=x,Ir=S;break;case 0:case 11:case 14:case 15:Ln||Ml(2,p,c),Ln||Ml(4,p,c),Js(s,c,p);break;case 1:Ln||(bs(p,c),x=p.stateNode,typeof x.componentWillUnmount=="function"&&Gp(p,c,x)),Js(s,c,p);break;case 21:Js(s,c,p);break;case 22:Ln=(x=Ln)||p.memoizedState!==null,Js(s,c,p),Ln=x;break;default:Js(s,c,p)}}function hy(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Dd(s)}catch(p){ei(c,c.return,p)}}function Zb(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new cy),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new cy),c;default:throw Error(r(435,s.tag))}}function Yp(s,c){var p=Zb(s);c.forEach(function(x){var S=a0.bind(null,s,x);p.has(x)||(p.add(x),x.then(S,S))})}function na(s,c){var p=c.deletions;if(p!==null)for(var x=0;x<p.length;x++){var S=p[x],P=s,G=c,Z=G;e:for(;Z!==null;){switch(Z.tag){case 27:if(wa(Z.type)){fi=Z.stateNode,Ir=!1;break e}break;case 5:fi=Z.stateNode,Ir=!1;break e;case 3:case 4:fi=Z.stateNode.containerInfo,Ir=!0;break e}Z=Z.return}if(fi===null)throw Error(r(160));fy(P,G,S),fi=null,Ir=!1,P=S.alternate,P!==null&&(P.return=null),S.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Wp(c,s),c=c.sibling}var ba=null;function Wp(s,c){var p=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:na(c,s),Rr(s),x&4&&(Ml(3,s,s.return),ud(3,s),Ml(5,s,s.return));break;case 1:na(c,s),Rr(s),x&512&&(Ln||p===null||bs(p,p.return)),x&64&&vs&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var S=ba;if(na(c,s),Rr(s),x&512&&(Ln||p===null||bs(p,p.return)),x&4){var P=p!==null?p.memoizedState:null;if(x=s.memoizedState,p===null)if(x===null)if(s.stateNode===null){e:{x=s.type,p=s.memoizedProps,S=S.ownerDocument||S;t:switch(x){case"title":P=S.getElementsByTagName("title")[0],(!P||P[On]||P[Dt]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=S.createElement(x),S.head.insertBefore(P,S.querySelector("head > title"))),Fi(P,x,p),P[Dt]=s,Gn(P),x=P;break e;case"link":var G=ix("link","href",S).get(x+(p.href||""));if(G){for(var Z=0;Z<G.length;Z++)if(P=G[Z],P.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&P.getAttribute("rel")===(p.rel==null?null:p.rel)&&P.getAttribute("title")===(p.title==null?null:p.title)&&P.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){G.splice(Z,1);break t}}P=S.createElement(x),Fi(P,x,p),S.head.appendChild(P);break;case"meta":if(G=ix("meta","content",S).get(x+(p.content||""))){for(Z=0;Z<G.length;Z++)if(P=G[Z],P.getAttribute("content")===(p.content==null?null:""+p.content)&&P.getAttribute("name")===(p.name==null?null:p.name)&&P.getAttribute("property")===(p.property==null?null:p.property)&&P.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&P.getAttribute("charset")===(p.charSet==null?null:p.charSet)){G.splice(Z,1);break t}}P=S.createElement(x),Fi(P,x,p),S.head.appendChild(P);break;default:throw Error(r(468,x))}P[Dt]=s,Gn(P),x=P}s.stateNode=x}else rx(S,s.type,s.stateNode);else s.stateNode=nx(S,x,s.memoizedProps);else P!==x?(P===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):P.count--,x===null?rx(S,s.type,s.stateNode):nx(S,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Gf(s,s.memoizedProps,p.memoizedProps)}break;case 27:na(c,s),Rr(s),x&512&&(Ln||p===null||bs(p,p.return)),p!==null&&x&4&&Gf(s,s.memoizedProps,p.memoizedProps);break;case 5:if(na(c,s),Rr(s),x&512&&(Ln||p===null||bs(p,p.return)),s.flags&32){S=s.stateNode;try{Yr(S,"")}catch(De){ei(s,s.return,De)}}x&4&&s.stateNode!=null&&(S=s.memoizedProps,Gf(s,S,p!==null?p.memoizedProps:S)),x&1024&&(Qs=!0);break;case 6:if(na(c,s),Rr(s),x&4){if(s.stateNode===null)throw Error(r(162));x=s.memoizedProps,p=s.stateNode;try{p.nodeValue=x}catch(De){ei(s,s.return,De)}}break;case 3:if(Jc=null,S=ba,ba=nn(c.containerInfo),na(c,s),ba=S,Rr(s),x&4&&p!==null&&p.memoizedState.isDehydrated)try{Dd(c.containerInfo)}catch(De){ei(s,s.return,De)}Qs&&(Qs=!1,py(s));break;case 4:x=ba,ba=nn(s.stateNode.containerInfo),na(c,s),Rr(s),ba=x;break;case 12:na(c,s),Rr(s);break;case 13:na(c,s),Rr(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(tm=it()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Yp(s,x)));break;case 22:S=s.memoizedState!==null;var me=p!==null&&p.memoizedState!==null,Pe=vs,He=Ln;if(vs=Pe||S,Ln=He||me,na(c,s),Ln=He,vs=Pe,Rr(s),x&8192)e:for(c=s.stateNode,c._visibility=S?c._visibility&-2:c._visibility|1,S&&(p===null||me||vs||Ln||Bo(s)),p=null,c=s;;){if(c.tag===5||c.tag===26){if(p===null){me=p=c;try{if(P=me.stateNode,S)G=P.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{Z=me.stateNode;var Qe=me.memoizedProps.style,Me=Qe!=null&&Qe.hasOwnProperty("display")?Qe.display:null;Z.style.display=Me==null||typeof Me=="boolean"?"":(""+Me).trim()}}catch(De){ei(me,me.return,De)}}}else if(c.tag===6){if(p===null){me=c;try{me.stateNode.nodeValue=S?"":me.memoizedProps}catch(De){ei(me,me.return,De)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Yp(s,p))));break;case 19:na(c,s),Rr(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Yp(s,x)));break;case 30:break;case 21:break;default:na(c,s),Rr(s)}}function Rr(s){var c=s.flags;if(c&2){try{for(var p,x=s.return;x!==null;){if(Ic(x)){p=x;break}x=x.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var S=p.stateNode,P=dd(s);fd(s,P,S);break;case 5:var G=p.stateNode;p.flags&32&&(Yr(G,""),p.flags&=-33);var Z=dd(s);fd(s,Z,G);break;case 3:case 4:var me=p.stateNode.containerInfo,Pe=dd(s);Yf(s,Pe,me);break;default:throw Error(r(161))}}catch(He){ei(s,s.return,He)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function py(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;py(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function Il(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)uy(s,c.alternate,c),c=c.sibling}function Bo(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:Ml(4,c,c.return),Bo(c);break;case 1:bs(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&Gp(c,c.return,p),Bo(c);break;case 27:jd(c.stateNode);case 26:case 5:bs(c,c.return),Bo(c);break;case 22:c.memoizedState===null&&Bo(c);break;case 30:Bo(c);break;default:Bo(c)}s=s.sibling}}function Ks(s,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,S=s,P=c,G=P.flags;switch(P.tag){case 0:case 11:case 15:Ks(S,P,p),ud(4,P);break;case 1:if(Ks(S,P,p),x=P,S=x.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Pe){ei(x,x.return,Pe)}if(x=P,S=x.updateQueue,S!==null){var Z=x.stateNode;try{var me=S.shared.hiddenCallbacks;if(me!==null)for(S.shared.hiddenCallbacks=null,S=0;S<me.length;S++)Mg(me[S],Z)}catch(Pe){ei(x,x.return,Pe)}}p&&G&64&&oy(P),Mc(P,P.return);break;case 27:hd(P);case 26:case 5:Ks(S,P,p),p&&x===null&&G&4&&Hf(P),Mc(P,P.return);break;case 12:Ks(S,P,p);break;case 13:Ks(S,P,p),p&&G&4&&hy(S,P);break;case 22:P.memoizedState===null&&Ks(S,P,p),Mc(P,P.return);break;case 30:break;default:Ks(S,P,p)}c=c.sibling}}function Qp(s,c){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&$u(p))}function Jp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&$u(s))}function ws(s,c,p,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)my(s,c,p,x),c=c.sibling}function my(s,c,p,x){var S=c.flags;switch(c.tag){case 0:case 11:case 15:ws(s,c,p,x),S&2048&&ud(9,c);break;case 1:ws(s,c,p,x);break;case 3:ws(s,c,p,x),S&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&$u(s)));break;case 12:if(S&2048){ws(s,c,p,x),s=c.stateNode;try{var P=c.memoizedProps,G=P.id,Z=P.onPostCommit;typeof Z=="function"&&Z(G,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(me){ei(c,c.return,me)}}else ws(s,c,p,x);break;case 13:ws(s,c,p,x);break;case 23:break;case 22:P=c.stateNode,G=c.alternate,c.memoizedState!==null?P._visibility&2?ws(s,c,p,x):pd(s,c):P._visibility&2?ws(s,c,p,x):(P._visibility|=2,Rc(s,c,p,x,(c.subtreeFlags&10256)!==0)),S&2048&&Qp(G,c);break;case 24:ws(s,c,p,x),S&2048&&Jp(c.alternate,c);break;default:ws(s,c,p,x)}}function Rc(s,c,p,x,S){for(S=S&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var P=s,G=c,Z=p,me=x,Pe=G.flags;switch(G.tag){case 0:case 11:case 15:Rc(P,G,Z,me,S),ud(8,G);break;case 23:break;case 22:var He=G.stateNode;G.memoizedState!==null?He._visibility&2?Rc(P,G,Z,me,S):pd(P,G):(He._visibility|=2,Rc(P,G,Z,me,S)),S&&Pe&2048&&Qp(G.alternate,G);break;case 24:Rc(P,G,Z,me,S),S&&Pe&2048&&Jp(G.alternate,G);break;default:Rc(P,G,Z,me,S)}c=c.sibling}}function pd(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=s,x=c,S=x.flags;switch(x.tag){case 22:pd(p,x),S&2048&&Qp(x.alternate,x);break;case 24:pd(p,x),S&2048&&Jp(x.alternate,x);break;default:pd(p,x)}c=c.sibling}}var fr=8192;function Lc(s){if(s.subtreeFlags&fr)for(s=s.child;s!==null;)gy(s),s=s.sibling}function gy(s){switch(s.tag){case 26:Lc(s),s.flags&fr&&s.memoizedState!==null&&j0(ba,s.memoizedState,s.memoizedProps);break;case 5:Lc(s);break;case 3:case 4:var c=ba;ba=nn(s.stateNode.containerInfo),Lc(s),ba=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=fr,fr=16777216,Lc(s),fr=c):Lc(s));break;default:Lc(s)}}function yy(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Oc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Li=x,by(x,s)}yy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)xy(s),s=s.sibling}function xy(s){switch(s.tag){case 0:case 11:case 15:Oc(s),s.flags&2048&&Ml(9,s,s.return);break;case 3:Oc(s);break;case 12:Oc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,Wf(s)):Oc(s);break;default:Oc(s)}}function Wf(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Li=x,by(x,s)}yy(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:Ml(8,c,c.return),Wf(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,Wf(c));break;default:Wf(c)}s=s.sibling}}function by(s,c){for(;Li!==null;){var p=Li;switch(p.tag){case 0:case 11:case 15:Ml(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:$u(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,Li=x;else e:for(p=s;Li!==null;){x=Li;var S=x.sibling,P=x.return;if(dy(x),x===p){Li=null;break e}if(S!==null){S.return=P,Li=S;break e}Li=P}}}var e0={getCacheForType:function(s){var c=wi(Xn),p=c.data.get(s);return p===void 0&&(p=s(),c.data.set(s,p)),p}},Kp=typeof WeakMap=="function"?WeakMap:Map,$n=0,ii=null,mn=null,Tn=0,zn=0,ia=null,Rl=!1,Fc=!1,Xp=!1,Xs=0,Si=0,Ll=0,Uo=0,Zp=0,va=0,$c=0,md=null,Lr=null,em=!1,tm=0,zc=1/0,gd=null,Ol=null,rr=0,Fl=null,Bc=null,Uc=0,nm=0,im=null,vy=null,qc=0,rm=null;function hr(){if(($n&2)!==0&&Tn!==0)return Tn&-Tn;if(J.T!==null){var s=jc;return s!==0?s:th()}return _t()}function wy(){va===0&&(va=(Tn&536870912)===0||bn?qe():536870912);var s=ta.current;return s!==null&&(s.flags|=32),va}function ra(s,c,p){(s===ii&&(zn===2||zn===9)||s.cancelPendingCommit!==null)&&(Vc(s,0),$l(s,Tn,va,!1)),st(s,p),(($n&2)===0||s!==ii)&&(s===ii&&(($n&2)===0&&(Uo|=p),Si===4&&$l(s,Tn,va,!1)),Ns(s))}function Ny(s,c,p){if(($n&6)!==0)throw Error(r(327));var x=!p&&(c&124)===0&&(c&s.expiredLanes)===0||ht(s,c),S=x?i0(s,c):lm(s,c,!0),P=x;do{if(S===0){Fc&&!x&&$l(s,c,0,!1);break}else{if(p=s.current.alternate,P&&!t0(p)){S=lm(s,c,!1),P=!1;continue}if(S===2){if(P=c,s.errorRecoveryDisabledLanes&P)var G=0;else G=s.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){c=G;e:{var Z=s;S=md;var me=Z.current.memoizedState.isDehydrated;if(me&&(Vc(Z,G).flags|=256),G=lm(Z,G,!1),G!==2){if(Xp&&!me){Z.errorRecoveryDisabledLanes|=P,Uo|=P,S=4;break e}P=Lr,Lr=S,P!==null&&(Lr===null?Lr=P:Lr.push.apply(Lr,P))}S=G}if(P=!1,S!==2)continue}}if(S===1){Vc(s,0),$l(s,c,0,!0);break}e:{switch(x=s,P=S,P){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:$l(x,c,va,!Rl);break e;case 2:Lr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(S=tm+300-it(),10<S)){if($l(x,c,va,!Rl),Ve(x,0,!0)!==0)break e;x.timeoutHandle=Gy(Sy.bind(null,x,p,Lr,gd,em,c,va,Uo,$c,Rl,P,2,-0,0),S);break e}Sy(x,p,Lr,gd,em,c,va,Uo,$c,Rl,P,0,-0,0)}}break}while(!0);Ns(s)}function Sy(s,c,p,x,S,P,G,Z,me,Pe,He,Qe,Me,De){if(s.timeoutHandle=-1,Qe=c.subtreeFlags,(Qe&8192||(Qe&16785408)===16785408)&&(Yi={stylesheets:null,count:0,unsuspend:S0},gy(c),Qe=_0(),Qe!==null)){s.cancelPendingCommit=Qe(yd.bind(null,s,c,P,p,x,S,G,Z,me,He,1,Me,De)),$l(s,P,G,!Pe);return}yd(s,c,P,p,x,S,G,Z,me)}function t0(s){for(var c=s;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var S=p[x],P=S.getSnapshot;S=S.value;try{if(!xr(P(),S))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function $l(s,c,p,x){c&=~Zp,c&=~Uo,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var S=c;0<S;){var P=31-Ie(S),G=1<<P;x[P]=-1,S&=~G}p!==0&&tn(s,p,c)}function Qf(){return($n&6)===0?(vd(0),!1):!0}function am(){if(mn!==null){if(zn===0)var s=mn.return;else s=mn,X=Cl=null,vf(s),Ri=null,Mr=0,s=mn;for(;s!==null;)ly(s.alternate,s),s=s.return;mn=null}}function Vc(s,c){var p=s.timeoutHandle;p!==-1&&(s.timeoutHandle=-1,p0(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),am(),ii=s,mn=p=br(s.current,null),Tn=c,zn=0,ia=null,Rl=!1,Fc=ht(s,c),Xp=!1,$c=va=Zp=Uo=Ll=Si=0,Lr=md=null,em=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var S=31-Ie(x),P=1<<S;c|=s[S],x&=~P}return Xs=c,wo(),p}function jy(s,c){on=null,J.H=ed,c===vr||c===yf?(c=Pg(),zn=3):c===Eg?(c=Pg(),zn=4):zn=c===ty?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,ia=c,mn===null&&(Si=1,ad(s,Vi(c,s.current)))}function _y(){var s=J.H;return J.H=ed,s===null?ed:s}function Cy(){var s=J.A;return J.A=e0,s}function sm(){Si=4,Rl||(Tn&4194048)!==Tn&&ta.current!==null||(Fc=!0),(Ll&134217727)===0&&(Uo&134217727)===0||ii===null||$l(ii,Tn,va,!1)}function lm(s,c,p){var x=$n;$n|=2;var S=_y(),P=Cy();(ii!==s||Tn!==c)&&(gd=null,Vc(s,c)),c=!1;var G=Si;e:do try{if(zn!==0&&mn!==null){var Z=mn,me=ia;switch(zn){case 8:am(),G=6;break e;case 3:case 2:case 9:case 6:ta.current===null&&(c=!0);var Pe=zn;if(zn=0,ia=null,Hc(s,Z,me,Pe),p&&Fc){G=0;break e}break;default:Pe=zn,zn=0,ia=null,Hc(s,Z,me,Pe)}}n0(),G=Si;break}catch(He){jy(s,He)}while(!0);return c&&s.shellSuspendCounter++,X=Cl=null,$n=x,J.H=S,J.A=P,mn===null&&(ii=null,Tn=0,wo()),G}function n0(){for(;mn!==null;)om(mn)}function i0(s,c){var p=$n;$n|=2;var x=_y(),S=Cy();ii!==s||Tn!==c?(gd=null,zc=it()+500,Vc(s,c)):Fc=ht(s,c);e:do try{if(zn!==0&&mn!==null){c=mn;var P=ia;t:switch(zn){case 1:zn=0,ia=null,Hc(s,c,P,1);break;case 2:case 9:if(Ag(P)){zn=0,ia=null,Ty(c);break}c=function(){zn!==2&&zn!==9||ii!==s||(zn=7),Ns(s)},P.then(c,c);break e;case 3:zn=7;break e;case 4:zn=5;break e;case 7:Ag(P)?(zn=0,ia=null,Ty(c)):(zn=0,ia=null,Hc(s,c,P,7));break;case 5:var G=null;switch(mn.tag){case 26:G=mn.memoizedState;case 5:case 27:var Z=mn;if(!G||$i(G)){zn=0,ia=null;var me=Z.sibling;if(me!==null)mn=me;else{var Pe=Z.return;Pe!==null?(mn=Pe,Jf(Pe)):mn=null}break t}}zn=0,ia=null,Hc(s,c,P,5);break;case 6:zn=0,ia=null,Hc(s,c,P,6);break;case 8:am(),Si=6;break e;default:throw Error(r(462))}}ky();break}catch(He){jy(s,He)}while(!0);return X=Cl=null,J.H=x,J.A=S,$n=p,mn!==null?0:(ii=null,Tn=0,wo(),Si)}function ky(){for(;mn!==null&&!Fe();)om(mn)}function om(s){var c=Uf(s.alternate,s,Xs);s.memoizedProps=s.pendingProps,c===null?Jf(s):mn=c}function Ty(s){var c=s,p=c.alternate;switch(c.tag){case 15:case 0:c=zf(p,c,c.pendingProps,c.type,void 0,Tn);break;case 11:c=zf(p,c,c.pendingProps,c.type.render,c.ref,Tn);break;case 5:vf(c);default:ly(p,c),c=mn=Mu(c,Xs),c=Uf(p,c,Xs)}s.memoizedProps=s.pendingProps,c===null?Jf(s):mn=c}function Hc(s,c,p,x){X=Cl=null,vf(c),Ri=null,Mr=0;var S=c.return;try{if(ey(s,S,c,p,Tn)){Si=1,ad(s,Vi(p,s.current)),mn=null;return}}catch(P){if(S!==null)throw mn=S,P;Si=1,ad(s,Vi(p,s.current)),mn=null;return}c.flags&32768?(bn||x===1?s=!0:Fc||(Tn&536870912)!==0?s=!1:(Rl=s=!0,(x===2||x===9||x===3||x===6)&&(x=ta.current,x!==null&&x.tag===13&&(x.flags|=16384))),Ey(c,s)):Jf(c)}function Jf(s){var c=s;do{if((c.flags&32768)!==0){Ey(c,Rl);return}s=c.return;var p=ay(c.alternate,c,Xs);if(p!==null){mn=p;return}if(c=c.sibling,c!==null){mn=c;return}mn=c=s}while(c!==null);Si===0&&(Si=5)}function Ey(s,c){do{var p=sy(s.alternate,s);if(p!==null){p.flags&=32767,mn=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(s=s.sibling,s!==null)){mn=s;return}mn=s=p}while(s!==null);Si=6,mn=null}function yd(s,c,p,x,S,P,G,Z,me){s.cancelPendingCommit=null;do Kf();while(rr!==0);if(($n&6)!==0)throw Error(r(327));if(c!==null){if(c===s.current)throw Error(r(177));if(P=c.lanes|c.childLanes,P|=up,dt(s,p,P,G,Z,me),s===ii&&(mn=ii=null,Tn=0),Bc=c,Fl=s,Uc=p,nm=P,im=S,vy=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Oy(ct,function(){return Iy(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=J.T,J.T=null,S=q.p,q.p=2,G=$n,$n|=4;try{Xb(s,c,p)}finally{$n=G,q.p=S,J.T=x}}rr=1,Ay(),Py(),Dy()}}function Ay(){if(rr===1){rr=0;var s=Fl,c=Bc,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=J.T,J.T=null;var x=q.p;q.p=2;var S=$n;$n|=4;try{Wp(c,s);var P=rh,G=Eu(s.containerInfo),Z=P.focusedElem,me=P.selectionRange;if(G!==Z&&Z&&Z.ownerDocument&&cf(Z.ownerDocument.documentElement,Z)){if(me!==null&&Au(Z)){var Pe=me.start,He=me.end;if(He===void 0&&(He=Pe),"selectionStart"in Z)Z.selectionStart=Pe,Z.selectionEnd=Math.min(He,Z.value.length);else{var Qe=Z.ownerDocument||document,Me=Qe&&Qe.defaultView||window;if(Me.getSelection){var De=Me.getSelection(),zt=Z.textContent.length,$t=Math.min(me.start,zt),Qn=me.end===void 0?$t:Math.min(me.end,zt);!De.extend&&$t>Qn&&(G=Qn,Qn=$t,$t=G);var Ce=Xr(Z,$t),ve=Xr(Z,Qn);if(Ce&&ve&&(De.rangeCount!==1||De.anchorNode!==Ce.node||De.anchorOffset!==Ce.offset||De.focusNode!==ve.node||De.focusOffset!==ve.offset)){var Ee=Qe.createRange();Ee.setStart(Ce.node,Ce.offset),De.removeAllRanges(),$t>Qn?(De.addRange(Ee),De.extend(ve.node,ve.offset)):(Ee.setEnd(ve.node,ve.offset),De.addRange(Ee))}}}}for(Qe=[],De=Z;De=De.parentNode;)De.nodeType===1&&Qe.push({element:De,left:De.scrollLeft,top:De.scrollTop});for(typeof Z.focus=="function"&&Z.focus(),Z=0;Z<Qe.length;Z++){var Ge=Qe[Z];Ge.element.scrollLeft=Ge.left,Ge.element.scrollTop=Ge.top}}dh=!!Ya,rh=Ya=null}finally{$n=S,q.p=x,J.T=p}}s.current=c,rr=2}}function Py(){if(rr===2){rr=0;var s=Fl,c=Bc,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=J.T,J.T=null;var x=q.p;q.p=2;var S=$n;$n|=4;try{uy(s,c.alternate,c)}finally{$n=S,q.p=x,J.T=p}}rr=3}}function Dy(){if(rr===4||rr===3){rr=0,Xe();var s=Fl,c=Bc,p=Uc,x=vy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?rr=5:(rr=0,Bc=Fl=null,My(s,s.pendingLanes));var S=s.pendingLanes;if(S===0&&(Ol=null),Vt(p),c=c.stateNode,fe&&typeof fe.onCommitFiberRoot=="function")try{fe.onCommitFiberRoot(K,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=J.T,S=q.p,q.p=2,J.T=null;try{for(var P=s.onRecoverableError,G=0;G<x.length;G++){var Z=x[G];P(Z.value,{componentStack:Z.stack})}}finally{J.T=c,q.p=S}}(Uc&3)!==0&&Kf(),Ns(s),S=s.pendingLanes,(p&4194090)!==0&&(S&42)!==0?s===rm?qc++:(qc=0,rm=s):qc=0,vd(0)}}function My(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,$u(c)))}function Kf(s){return Ay(),Py(),Dy(),Iy()}function Iy(){if(rr!==5)return!1;var s=Fl,c=nm;nm=0;var p=Vt(Uc),x=J.T,S=q.p;try{q.p=32>p?32:p,J.T=null,p=im,im=null;var P=Fl,G=Uc;if(rr=0,Bc=Fl=null,Uc=0,($n&6)!==0)throw Error(r(331));var Z=$n;if($n|=4,xy(P.current),my(P,P.current,G,p),$n=Z,vd(0,!1),fe&&typeof fe.onPostCommitFiberRoot=="function")try{fe.onPostCommitFiberRoot(K,P)}catch{}return!0}finally{q.p=S,J.T=x,My(s,c)}}function Ry(s,c,p){c=Vi(p,c),c=Lf(s.stateNode,c,2),s=Us(s,c,2),s!==null&&(st(s,2),Ns(s))}function ei(s,c,p){if(s.tag===3)Ry(s,s,p);else for(;c!==null;){if(c.tag===3){Ry(c,s,p);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ol===null||!Ol.has(x))){s=Vi(p,s),p=Bp(2),x=Us(c,p,2),x!==null&&(Zg(p,x,c,s),st(x,2),Ns(x));break}}c=c.return}}function cm(s,c,p){var x=s.pingCache;if(x===null){x=s.pingCache=new Kp;var S=new Set;x.set(c,S)}else S=x.get(c),S===void 0&&(S=new Set,x.set(c,S));S.has(p)||(Xp=!0,S.add(p),s=r0.bind(null,s,c,p),c.then(s,s))}function r0(s,c,p){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,ii===s&&(Tn&p)===p&&(Si===4||Si===3&&(Tn&62914560)===Tn&&300>it()-tm?($n&2)===0&&Vc(s,0):Zp|=p,$c===Tn&&($c=0)),Ns(s)}function Ly(s,c){c===0&&(c=Be()),s=No(s,c),s!==null&&(st(s,c),Ns(s))}function Xf(s){var c=s.memoizedState,p=0;c!==null&&(p=c.retryLane),Ly(s,p)}function a0(s,c){var p=0;switch(s.tag){case 13:var x=s.stateNode,S=s.memoizedState;S!==null&&(p=S.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),Ly(s,p)}function Oy(s,c){return Te(s,c)}var xd=null,zl=null,Zf=!1,bd=!1,eh=!1,Bl=0;function Ns(s){s!==zl&&s.next===null&&(zl===null?xd=zl=s:zl=zl.next=s),bd=!0,Zf||(Zf=!0,um())}function vd(s,c){if(!eh&&bd){eh=!0;do for(var p=!1,x=xd;x!==null;){if(s!==0){var S=x.pendingLanes;if(S===0)var P=0;else{var G=x.suspendedLanes,Z=x.pingedLanes;P=(1<<31-Ie(42|s)+1)-1,P&=S&~(G&~Z),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(p=!0,$y(x,P))}else P=Tn,P=Ve(x,x===ii?P:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(P&3)===0||ht(x,P)||(p=!0,$y(x,P));x=x.next}while(p);eh=!1}}function s0(){wd()}function wd(){bd=Zf=!1;var s=0;Bl!==0&&(h0()&&(s=Bl),Bl=0);for(var c=it(),p=null,x=xd;x!==null;){var S=x.next,P=Nd(x,c);P===0?(x.next=null,p===null?xd=S:p.next=S,S===null&&(zl=p)):(p=x,(s!==0||(P&3)!==0)&&(bd=!0)),x=S}vd(s)}function Nd(s,c){for(var p=s.suspendedLanes,x=s.pingedLanes,S=s.expirationTimes,P=s.pendingLanes&-62914561;0<P;){var G=31-Ie(P),Z=1<<G,me=S[G];me===-1?((Z&p)===0||(Z&x)!==0)&&(S[G]=Se(Z,c)):me<=c&&(s.expiredLanes|=Z),P&=~Z}if(c=ii,p=Tn,p=Ve(s,s===c?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,p===0||s===c&&(zn===2||zn===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&we(x),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||ht(s,p)){if(c=p&-p,c===s.callbackPriority)return c;switch(x!==null&&we(x),Vt(p)){case 2:case 8:p=ze;break;case 32:p=ct;break;case 268435456:p=bt;break;default:p=ct}return x=Fy.bind(null,s),p=Te(p,x),s.callbackPriority=c,s.callbackNode=p,c}return x!==null&&x!==null&&we(x),s.callbackPriority=2,s.callbackNode=null,2}function Fy(s,c){if(rr!==0&&rr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(Kf()&&s.callbackNode!==p)return null;var x=Tn;return x=Ve(s,s===ii?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(Ny(s,x,c),Nd(s,it()),s.callbackNode!=null&&s.callbackNode===p?Fy.bind(null,s):null)}function $y(s,c){if(Kf())return null;Ny(s,c,!0)}function um(){m0(function(){($n&6)!==0?Te(Ke,s0):wd()})}function th(){return Bl===0&&(Bl=qe()),Bl}function zy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ca(""+s)}function By(s,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,s.id&&p.setAttribute("form",s.id),c.parentNode.insertBefore(p,c),s=new FormData(s),p.parentNode.removeChild(p),s}function l0(s,c,p,x,S){if(c==="submit"&&p&&p.stateNode===S){var P=zy((S[kt]||null).action),G=x.submitter;G&&(c=(c=G[kt]||null)?zy(c.formAction):G.getAttribute("formAction"),c!==null&&(P=c,G=null));var Z=new fo("action","action",null,x,S);s.push({event:Z,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Bl!==0){var me=G?By(S,G):new FormData(S);Xu(p,{pending:!0,data:me,method:S.method,action:P},null,me)}}else typeof P=="function"&&(Z.preventDefault(),me=G?By(S,G):new FormData(S),Xu(p,{pending:!0,data:me,method:S.method,action:P},P,me))},currentTarget:S}]})}}for(var dm=0;dm<Qt.length;dm++){var fm=Qt[dm],o0=fm.toLowerCase(),c0=fm[0].toUpperCase()+fm.slice(1);cr(o0,"on"+c0)}cr(se,"onAnimationEnd"),cr(pe,"onAnimationIteration"),cr(de,"onAnimationStart"),cr("dblclick","onDoubleClick"),cr("focusin","onFocus"),cr("focusout","onBlur"),cr(_e,"onTransitionRun"),cr(rt,"onTransitionStart"),cr(xt,"onTransitionCancel"),cr(Ct,"onTransitionEnd"),er("onMouseEnter",["mouseout","mouseover"]),er("onMouseLeave",["mouseout","mouseover"]),er("onPointerEnter",["pointerout","pointerover"]),er("onPointerLeave",["pointerout","pointerover"]),Ia("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ia("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ia("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ia("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ia("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ia("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sd));function Uy(s,c){c=(c&4)!==0;for(var p=0;p<s.length;p++){var x=s[p],S=x.event;x=x.listeners;e:{var P=void 0;if(c)for(var G=x.length-1;0<=G;G--){var Z=x[G],me=Z.instance,Pe=Z.currentTarget;if(Z=Z.listener,me!==P&&S.isPropagationStopped())break e;P=Z,S.currentTarget=Pe;try{P(S)}catch(He){$o(He)}S.currentTarget=null,P=me}else for(G=0;G<x.length;G++){if(Z=x[G],me=Z.instance,Pe=Z.currentTarget,Z=Z.listener,me!==P&&S.isPropagationStopped())break e;P=Z,S.currentTarget=Pe;try{P(S)}catch(He){$o(He)}S.currentTarget=null,P=me}}}}function gn(s,c){var p=c[Hn];p===void 0&&(p=c[Hn]=new Set);var x=s+"__bubble";p.has(x)||(qy(c,s,2,!1),p.add(x))}function hm(s,c,p){var x=0;c&&(x|=4),qy(p,s,x,c)}var Or="_reactListening"+Math.random().toString(36).slice(2);function pm(s){if(!s[Or]){s[Or]=!0,Es.forEach(function(p){p!=="selectionchange"&&(u0.has(p)||hm(p,!1,s),hm(p,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[Or]||(c[Or]=!0,hm("selectionchange",!1,c))}}function qy(s,c,p,x){switch(ox(c)){case 2:var S=T0;break;case 8:S=Xc;break;default:S=jm}p=S.bind(null,c,p,s),S=void 0,!La||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(S=!0),x?S!==void 0?s.addEventListener(c,p,{capture:!0,passive:S}):s.addEventListener(c,p,!0):S!==void 0?s.addEventListener(c,p,{passive:S}):s.addEventListener(c,p,!1)}function Zs(s,c,p,x,S){var P=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var G=x.tag;if(G===3||G===4){var Z=x.stateNode.containerInfo;if(Z===S)break;if(G===4)for(G=x.return;G!==null;){var me=G.tag;if((me===3||me===4)&&G.stateNode.containerInfo===S)return;G=G.return}for(;Z!==null;){if(G=Xi(Z),G===null)return;if(me=G.tag,me===5||me===6||me===26||me===27){x=P=G;continue e}Z=Z.parentNode}}x=x.return}dc(function(){var Pe=P,He=oo(p),Qe=[];e:{var Me=vt.get(s);if(Me!==void 0){var De=fo,zt=s;switch(s){case"keypress":if(Dn(p)===0)break e;case"keydown":case"keyup":De=wl;break;case"focusin":zt="focus",De=bl;break;case"focusout":zt="blur",De=bl;break;case"beforeblur":case"afterblur":De=bl;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":De=os;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":De=cs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":De=pc;break;case se:case pe:case de:De=Rs;break;case Ct:De=sp;break;case"scroll":case"scrollend":De=wu;break;case"wheel":De=op;break;case"copy":case"cut":case"paste":De=Fa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":De=Kr;break;case"toggle":case"beforetoggle":De=mc}var $t=(c&4)!==0,Qn=!$t&&(s==="scroll"||s==="scrollend"),Ce=$t?Me!==null?Me+"Capture":null:Me;$t=[];for(var ve=Pe,Ee;ve!==null;){var Ge=ve;if(Ee=Ge.stateNode,Ge=Ge.tag,Ge!==5&&Ge!==26&&Ge!==27||Ee===null||Ce===null||(Ge=yl(ve,Ce),Ge!=null&&$t.push(Jt(ve,Ge,Ee))),Qn)break;ve=ve.return}0<$t.length&&(Me=new De(Me,zt,null,p,He),Qe.push({event:Me,listeners:$t}))}}if((c&7)===0){e:{if(Me=s==="mouseover"||s==="pointerover",De=s==="mouseout"||s==="pointerout",Me&&p!==Ms&&(zt=p.relatedTarget||p.fromElement)&&(Xi(zt)||zt[It]))break e;if((De||Me)&&(Me=He.window===He?He:(Me=He.ownerDocument)?Me.defaultView||Me.parentWindow:window,De?(zt=p.relatedTarget||p.toElement,De=Pe,zt=zt?Xi(zt):null,zt!==null&&(Qn=l(zt),$t=zt.tag,zt!==Qn||$t!==5&&$t!==27&&$t!==6)&&(zt=null)):(De=null,zt=Pe),De!==zt)){if($t=os,Ge="onMouseLeave",Ce="onMouseEnter",ve="mouse",(s==="pointerout"||s==="pointerover")&&($t=Kr,Ge="onPointerLeave",Ce="onPointerEnter",ve="pointer"),Qn=De==null?Me:pr(De),Ee=zt==null?Me:pr(zt),Me=new $t(Ge,ve+"leave",De,p,He),Me.target=Qn,Me.relatedTarget=Ee,Ge=null,Xi(He)===Pe&&($t=new $t(Ce,ve+"enter",zt,p,He),$t.target=Ee,$t.relatedTarget=Qn,Ge=$t),Qn=Ge,De&&zt)t:{for($t=De,Ce=zt,ve=0,Ee=$t;Ee;Ee=Oi(Ee))ve++;for(Ee=0,Ge=Ce;Ge;Ge=Oi(Ge))Ee++;for(;0<ve-Ee;)$t=Oi($t),ve--;for(;0<Ee-ve;)Ce=Oi(Ce),Ee--;for(;ve--;){if($t===Ce||Ce!==null&&$t===Ce.alternate)break t;$t=Oi($t),Ce=Oi(Ce)}$t=null}else $t=null;De!==null&&ji(Qe,Me,De,$t,!1),zt!==null&&Qn!==null&&ji(Qe,Qn,zt,$t,!0)}}e:{if(Me=Pe?pr(Pe):window,De=Me.nodeName&&Me.nodeName.toLowerCase(),De==="select"||De==="input"&&Me.type==="file")var St=rf;else if(xo(Me))if(af)St=cp;else{St=ps;var hn=of}else De=Me.nodeName,!De||De.toLowerCase()!=="input"||Me.type!=="checkbox"&&Me.type!=="radio"?Pe&&gl(Pe.elementType)&&(St=rf):St=$a;if(St&&(St=St(s,Pe))){Ls(Qe,St,p,He);break e}hn&&hn(s,Me,Pe),s==="focusout"&&Pe&&Me.type==="number"&&Pe.memoizedProps.value!=null&&as(Me,"number",Me.value)}switch(hn=Pe?pr(Pe):window,s){case"focusin":(xo(hn)||hn.contentEditable==="true")&&(Fs=hn,za=Pe,Ne=null);break;case"focusout":Ne=za=Fs=null;break;case"mousedown":Ue=!0;break;case"contextmenu":case"mouseup":case"dragend":Ue=!1,Oe(Qe,p,He);break;case"selectionchange":if(uf)break;case"keydown":case"keyup":Oe(Qe,p,He)}var Pt;if(Cu)e:{switch(s){case"compositionstart":var Bt="onCompositionStart";break e;case"compositionend":Bt="onCompositionEnd";break e;case"compositionupdate":Bt="onCompositionUpdate";break e}Bt=void 0}else ir?yo(s,p)&&(Bt="onCompositionEnd"):s==="keydown"&&p.keyCode===229&&(Bt="onCompositionStart");Bt&&(gc&&p.locale!=="ko"&&(ir||Bt!=="onCompositionStart"?Bt==="onCompositionEnd"&&ir&&(Pt=hc()):(Qr=He,fc="value"in Qr?Qr.value:Qr.textContent,ir=!0)),hn=nh(Pe,Bt),0<hn.length&&(Bt=new lr(Bt,s,null,p,He),Qe.push({event:Bt,listeners:hn}),Pt?Bt.data=Pt:(Pt=yc(p),Pt!==null&&(Bt.data=Pt)))),(Pt=tf?ds(s,p):da(s,p))&&(Bt=nh(Pe,"onBeforeInput"),0<Bt.length&&(hn=new lr("onBeforeInput","beforeinput",null,p,He),Qe.push({event:hn,listeners:Bt}),hn.data=Pt)),l0(Qe,s,Pe,p,He)}Uy(Qe,c)})}function Jt(s,c,p){return{instance:s,listener:c,currentTarget:p}}function nh(s,c){for(var p=c+"Capture",x=[];s!==null;){var S=s,P=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||P===null||(S=yl(s,p),S!=null&&x.unshift(Jt(s,S,P)),S=yl(s,c),S!=null&&x.push(Jt(s,S,P))),s.tag===3)return x;s=s.return}return[]}function Oi(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function ji(s,c,p,x,S){for(var P=c._reactName,G=[];p!==null&&p!==x;){var Z=p,me=Z.alternate,Pe=Z.stateNode;if(Z=Z.tag,me!==null&&me===x)break;Z!==5&&Z!==26&&Z!==27||Pe===null||(me=Pe,S?(Pe=yl(p,P),Pe!=null&&G.unshift(Jt(p,Pe,me))):S||(Pe=yl(p,P),Pe!=null&&G.push(Jt(p,Pe,me)))),p=p.return}G.length!==0&&s.push({event:c,listeners:G})}var d0=/\r\n?/g,Ul=/\u0000|\uFFFD/g;function Vy(s){return(typeof s=="string"?s:""+s).replace(d0,`
`).replace(Ul,"")}function Hy(s,c){return c=Vy(c),Vy(s)===c}function ih(){}function Wn(s,c,p,x,S,P){switch(p){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||Yr(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&Yr(s,""+x);break;case"className":dl(s,"class",x);break;case"tabIndex":dl(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":dl(s,p,x);break;case"style":vu(s,x,P);break;case"data":if(c!=="object"){dl(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||p!=="href")){s.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=ca(""+x),s.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(p==="formAction"?(c!=="input"&&Wn(s,c,"name",S.name,S,null),Wn(s,c,"formEncType",S.formEncType,S,null),Wn(s,c,"formMethod",S.formMethod,S,null),Wn(s,c,"formTarget",S.formTarget,S,null)):(Wn(s,c,"encType",S.encType,S,null),Wn(s,c,"method",S.method,S,null),Wn(s,c,"target",S.target,S,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=ca(""+x),s.setAttribute(p,x);break;case"onClick":x!=null&&(s.onclick=ih);break;case"onScroll":x!=null&&gn("scroll",s);break;case"onScrollEnd":x!=null&&gn("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(S.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}p=ca(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""+x):s.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""):s.removeAttribute(p);break;case"capture":case"download":x===!0?s.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,x):s.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(p,x):s.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(p):s.setAttribute(p,x);break;case"popover":gn("beforetoggle",s),gn("toggle",s),ul(s,"popover",x);break;case"xlinkActuate":Gr(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Gr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Gr(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Gr(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Gr(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Gr(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Gr(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Gr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Gr(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":ul(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=cc.get(p)||p,ul(s,p,x))}}function mm(s,c,p,x,S,P){switch(p){case"style":vu(s,x,P);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(S.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"children":typeof x=="string"?Yr(s,x):(typeof x=="number"||typeof x=="bigint")&&Yr(s,""+x);break;case"onScroll":x!=null&&gn("scroll",s);break;case"onScrollEnd":x!=null&&gn("scrollend",s);break;case"onClick":x!=null&&(s.onclick=ih);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Hr.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(S=p.endsWith("Capture"),c=p.slice(2,S?p.length-7:void 0),P=s[kt]||null,P=P!=null?P[p]:null,typeof P=="function"&&s.removeEventListener(c,P,S),typeof x=="function")){typeof P!="function"&&P!==null&&(p in s?s[p]=null:s.hasAttribute(p)&&s.removeAttribute(p)),s.addEventListener(c,x,S);break e}p in s?s[p]=x:x===!0?s.setAttribute(p,""):ul(s,p,x)}}}function Fi(s,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gn("error",s),gn("load",s);var x=!1,S=!1,P;for(P in p)if(p.hasOwnProperty(P)){var G=p[P];if(G!=null)switch(P){case"src":x=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Wn(s,c,P,G,p,null)}}S&&Wn(s,c,"srcSet",p.srcSet,p,null),x&&Wn(s,c,"src",p.src,p,null);return;case"input":gn("invalid",s);var Z=P=G=S=null,me=null,Pe=null;for(x in p)if(p.hasOwnProperty(x)){var He=p[x];if(He!=null)switch(x){case"name":S=He;break;case"type":G=He;break;case"checked":me=He;break;case"defaultChecked":Pe=He;break;case"value":P=He;break;case"defaultValue":Z=He;break;case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(r(137,c));break;default:Wn(s,c,x,He,p,null)}}oc(s,P,Z,me,Pe,G,S,!1),lc(s);return;case"select":gn("invalid",s),x=G=P=null;for(S in p)if(p.hasOwnProperty(S)&&(Z=p[S],Z!=null))switch(S){case"value":P=Z;break;case"defaultValue":G=Z;break;case"multiple":x=Z;default:Wn(s,c,S,Z,p,null)}c=P,p=G,s.multiple=!!x,c!=null?Ds(s,!!x,c,!1):p!=null&&Ds(s,!!x,p,!0);return;case"textarea":gn("invalid",s),P=S=x=null;for(G in p)if(p.hasOwnProperty(G)&&(Z=p[G],Z!=null))switch(G){case"value":x=Z;break;case"defaultValue":S=Z;break;case"children":P=Z;break;case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(91));break;default:Wn(s,c,G,Z,p,null)}lo(s,x,S,P),lc(s);return;case"option":for(me in p)if(p.hasOwnProperty(me)&&(x=p[me],x!=null))switch(me){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Wn(s,c,me,x,p,null)}return;case"dialog":gn("beforetoggle",s),gn("toggle",s),gn("cancel",s),gn("close",s);break;case"iframe":case"object":gn("load",s);break;case"video":case"audio":for(x=0;x<Sd.length;x++)gn(Sd[x],s);break;case"image":gn("error",s),gn("load",s);break;case"details":gn("toggle",s);break;case"embed":case"source":case"link":gn("error",s),gn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Pe in p)if(p.hasOwnProperty(Pe)&&(x=p[Pe],x!=null))switch(Pe){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Wn(s,c,Pe,x,p,null)}return;default:if(gl(c)){for(He in p)p.hasOwnProperty(He)&&(x=p[He],x!==void 0&&mm(s,c,He,x,p,void 0));return}}for(Z in p)p.hasOwnProperty(Z)&&(x=p[Z],x!=null&&Wn(s,c,Z,x,p,null))}function f0(s,c,p,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,P=null,G=null,Z=null,me=null,Pe=null,He=null;for(De in p){var Qe=p[De];if(p.hasOwnProperty(De)&&Qe!=null)switch(De){case"checked":break;case"value":break;case"defaultValue":me=Qe;default:x.hasOwnProperty(De)||Wn(s,c,De,null,x,Qe)}}for(var Me in x){var De=x[Me];if(Qe=p[Me],x.hasOwnProperty(Me)&&(De!=null||Qe!=null))switch(Me){case"type":P=De;break;case"name":S=De;break;case"checked":Pe=De;break;case"defaultChecked":He=De;break;case"value":G=De;break;case"defaultValue":Z=De;break;case"children":case"dangerouslySetInnerHTML":if(De!=null)throw Error(r(137,c));break;default:De!==Qe&&Wn(s,c,Me,De,x,Qe)}}Ps(s,G,Z,me,Pe,He,P,S);return;case"select":De=G=Z=Me=null;for(P in p)if(me=p[P],p.hasOwnProperty(P)&&me!=null)switch(P){case"value":break;case"multiple":De=me;default:x.hasOwnProperty(P)||Wn(s,c,P,null,x,me)}for(S in x)if(P=x[S],me=p[S],x.hasOwnProperty(S)&&(P!=null||me!=null))switch(S){case"value":Me=P;break;case"defaultValue":Z=P;break;case"multiple":G=P;default:P!==me&&Wn(s,c,S,P,x,me)}c=Z,p=G,x=De,Me!=null?Ds(s,!!p,Me,!1):!!x!=!!p&&(c!=null?Ds(s,!!p,c,!0):Ds(s,!!p,p?[]:"",!1));return;case"textarea":De=Me=null;for(Z in p)if(S=p[Z],p.hasOwnProperty(Z)&&S!=null&&!x.hasOwnProperty(Z))switch(Z){case"value":break;case"children":break;default:Wn(s,c,Z,null,x,S)}for(G in x)if(S=x[G],P=p[G],x.hasOwnProperty(G)&&(S!=null||P!=null))switch(G){case"value":Me=S;break;case"defaultValue":De=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(r(91));break;default:S!==P&&Wn(s,c,G,S,x,P)}pl(s,Me,De);return;case"option":for(var zt in p)if(Me=p[zt],p.hasOwnProperty(zt)&&Me!=null&&!x.hasOwnProperty(zt))switch(zt){case"selected":s.selected=!1;break;default:Wn(s,c,zt,null,x,Me)}for(me in x)if(Me=x[me],De=p[me],x.hasOwnProperty(me)&&Me!==De&&(Me!=null||De!=null))switch(me){case"selected":s.selected=Me&&typeof Me!="function"&&typeof Me!="symbol";break;default:Wn(s,c,me,Me,x,De)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $t in p)Me=p[$t],p.hasOwnProperty($t)&&Me!=null&&!x.hasOwnProperty($t)&&Wn(s,c,$t,null,x,Me);for(Pe in x)if(Me=x[Pe],De=p[Pe],x.hasOwnProperty(Pe)&&Me!==De&&(Me!=null||De!=null))switch(Pe){case"children":case"dangerouslySetInnerHTML":if(Me!=null)throw Error(r(137,c));break;default:Wn(s,c,Pe,Me,x,De)}return;default:if(gl(c)){for(var Qn in p)Me=p[Qn],p.hasOwnProperty(Qn)&&Me!==void 0&&!x.hasOwnProperty(Qn)&&mm(s,c,Qn,void 0,x,Me);for(He in x)Me=x[He],De=p[He],!x.hasOwnProperty(He)||Me===De||Me===void 0&&De===void 0||mm(s,c,He,Me,x,De);return}}for(var Ce in p)Me=p[Ce],p.hasOwnProperty(Ce)&&Me!=null&&!x.hasOwnProperty(Ce)&&Wn(s,c,Ce,null,x,Me);for(Qe in x)Me=x[Qe],De=p[Qe],!x.hasOwnProperty(Qe)||Me===De||Me==null&&De==null||Wn(s,c,Qe,Me,x,De)}var Ya=null,rh=null;function qo(s){return s.nodeType===9?s:s.ownerDocument}function hi(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bi(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function ah(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var gm=null;function h0(){var s=window.event;return s&&s.type==="popstate"?s===gm?!1:(gm=s,!0):(gm=null,!1)}var Gy=typeof setTimeout=="function"?setTimeout:void 0,p0=typeof clearTimeout=="function"?clearTimeout:void 0,Yy=typeof Promise=="function"?Promise:void 0,m0=typeof queueMicrotask=="function"?queueMicrotask:typeof Yy<"u"?function(s){return Yy.resolve(null).then(s).catch(Wy)}:Gy;function Wy(s){setTimeout(function(){throw s})}function wa(s){return s==="head"}function sh(s,c){var p=c,x=0,S=0;do{var P=p.nextSibling;if(s.removeChild(p),P&&P.nodeType===8)if(p=P.data,p==="/$"){if(0<x&&8>x){p=x;var G=s.ownerDocument;if(p&1&&jd(G.documentElement),p&2&&jd(G.body),p&4)for(p=G.head,jd(p),G=p.firstChild;G;){var Z=G.nextSibling,me=G.nodeName;G[On]||me==="SCRIPT"||me==="STYLE"||me==="LINK"&&G.rel.toLowerCase()==="stylesheet"||p.removeChild(G),G=Z}}if(S===0){s.removeChild(P),Dd(c);return}S--}else p==="$"||p==="$?"||p==="$!"?S++:x=p.charCodeAt(0)-48;else x=0;p=P}while(p);Dd(c)}function ym(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":ym(p),Bi(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}s.removeChild(p)}}function Qy(s,c,p,x){for(;s.nodeType===1;){var S=p;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[On])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(P=s.getAttribute("rel"),P==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(P!==S.rel||s.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||s.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||s.getAttribute("title")!==(S.title==null?null:S.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(P=s.getAttribute("src"),(P!==(S.src==null?null:S.src)||s.getAttribute("type")!==(S.type==null?null:S.type)||s.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&P&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var P=S.name==null?null:""+S.name;if(S.type==="hidden"&&s.getAttribute("name")===P)return s}else return s;if(s=Wa(s.nextSibling),s===null)break}return null}function lh(s,c,p){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!p||(s=Wa(s.nextSibling),s===null))return null;return s}function Sr(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Gc(s,c){var p=s.ownerDocument;if(s.data!=="$?"||p.readyState==="complete")c();else{var x=function(){c(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Wa(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var xm=null;function Jy(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var p=s.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return s;c--}else p==="/$"&&c++}s=s.previousSibling}return null}function Ky(s,c,p){switch(c=qo(p),s){case"html":if(s=c.documentElement,!s)throw Error(r(452));return s;case"head":if(s=c.head,!s)throw Error(r(453));return s;case"body":if(s=c.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function jd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);Bi(s)}var aa=new Map,Ss=new Set;function nn(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var js=q.d;q.d={f:Na,r:Xy,D:g0,C:Zy,L:oh,m:y0,X:b0,S:x0,M:v0};function Na(){var s=js.f(),c=Qf();return s||c}function Xy(s){var c=Zi(s);c!==null&&c.tag===5&&c.type==="form"?Df(c):js.r(s)}var Yc=typeof document>"u"?null:document;function Mn(s,c,p){var x=Yc;if(x&&typeof c=="string"&&c){var S=gr(c);S='link[rel="'+s+'"][href="'+S+'"]',typeof p=="string"&&(S+='[crossorigin="'+p+'"]'),Ss.has(S)||(Ss.add(S),s={rel:s,crossOrigin:p,href:c},x.querySelector(S)===null&&(c=x.createElement("link"),Fi(c,"link",s),Gn(c),x.head.appendChild(c)))}}function g0(s){js.D(s),Mn("dns-prefetch",s,null)}function Zy(s,c){js.C(s,c),Mn("preconnect",s,c)}function oh(s,c,p){js.L(s,c,p);var x=Yc;if(x&&s&&c){var S='link[rel="preload"][as="'+gr(c)+'"]';c==="image"&&p&&p.imageSrcSet?(S+='[imagesrcset="'+gr(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(S+='[imagesizes="'+gr(p.imageSizes)+'"]')):S+='[href="'+gr(s)+'"]';var P=S;switch(c){case"style":P=Wc(s);break;case"script":P=Qc(s)}aa.has(P)||(s=h({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:s,as:c},p),aa.set(P,s),x.querySelector(S)!==null||c==="style"&&x.querySelector(_d(P))||c==="script"&&x.querySelector(Cd(P))||(c=x.createElement("link"),Fi(c,"link",s),Gn(c),x.head.appendChild(c)))}}function y0(s,c){js.m(s,c);var p=Yc;if(p&&s){var x=c&&typeof c.as=="string"?c.as:"script",S='link[rel="modulepreload"][as="'+gr(x)+'"][href="'+gr(s)+'"]',P=S;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=Qc(s)}if(!aa.has(P)&&(s=h({rel:"modulepreload",href:s},c),aa.set(P,s),p.querySelector(S)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Cd(P)))return}x=p.createElement("link"),Fi(x,"link",s),Gn(x),p.head.appendChild(x)}}}function x0(s,c,p){js.S(s,c,p);var x=Yc;if(x&&s){var S=Ui(x).hoistableStyles,P=Wc(s);c=c||"default";var G=S.get(P);if(!G){var Z={loading:0,preload:null};if(G=x.querySelector(_d(P)))Z.loading=5;else{s=h({rel:"stylesheet",href:s,"data-precedence":c},p),(p=aa.get(P))&&kd(s,p);var me=G=x.createElement("link");Gn(me),Fi(me,"link",s),me._p=new Promise(function(Pe,He){me.onload=Pe,me.onerror=He}),me.addEventListener("load",function(){Z.loading|=1}),me.addEventListener("error",function(){Z.loading|=2}),Z.loading|=4,ch(G,c,x)}G={type:"stylesheet",instance:G,count:1,state:Z},S.set(P,G)}}}function b0(s,c){js.X(s,c);var p=Yc;if(p&&s){var x=Ui(p).hoistableScripts,S=Qc(s),P=x.get(S);P||(P=p.querySelector(Cd(S)),P||(s=h({src:s,async:!0},c),(c=aa.get(S))&&bm(s,c),P=p.createElement("script"),Gn(P),Fi(P,"link",s),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(S,P))}}function v0(s,c){js.M(s,c);var p=Yc;if(p&&s){var x=Ui(p).hoistableScripts,S=Qc(s),P=x.get(S);P||(P=p.querySelector(Cd(S)),P||(s=h({src:s,async:!0,type:"module"},c),(c=aa.get(S))&&bm(s,c),P=p.createElement("script"),Gn(P),Fi(P,"link",s),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(S,P))}}function ex(s,c,p,x){var S=(S=le.current)?nn(S):null;if(!S)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=Wc(p.href),p=Ui(S).hoistableStyles,x=p.get(c),x||(x={type:"style",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){s=Wc(p.href);var P=Ui(S).hoistableStyles,G=P.get(s);if(G||(S=S.ownerDocument||S,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(s,G),(P=S.querySelector(_d(s)))&&!P._p&&(G.instance=P,G.state.loading=5),aa.has(s)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},aa.set(s,p),P||w0(S,s,p,G.state))),c&&x===null)throw Error(r(528,""));return G}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Qc(p),p=Ui(S).hoistableScripts,x=p.get(c),x||(x={type:"script",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Wc(s){return'href="'+gr(s)+'"'}function _d(s){return'link[rel="stylesheet"]['+s+"]"}function tx(s){return h({},s,{"data-precedence":s.precedence,precedence:null})}function w0(s,c,p,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),Fi(c,"link",p),Gn(c),s.head.appendChild(c))}function Qc(s){return'[src="'+gr(s)+'"]'}function Cd(s){return"script[async]"+s}function nx(s,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+gr(p.href)+'"]');if(x)return c.instance=x,Gn(x),x;var S=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),Gn(x),Fi(x,"style",S),ch(x,p.precedence,s),c.instance=x;case"stylesheet":S=Wc(p.href);var P=s.querySelector(_d(S));if(P)return c.state.loading|=4,c.instance=P,Gn(P),P;x=tx(p),(S=aa.get(S))&&kd(x,S),P=(s.ownerDocument||s).createElement("link"),Gn(P);var G=P;return G._p=new Promise(function(Z,me){G.onload=Z,G.onerror=me}),Fi(P,"link",x),c.state.loading|=4,ch(P,p.precedence,s),c.instance=P;case"script":return P=Qc(p.src),(S=s.querySelector(Cd(P)))?(c.instance=S,Gn(S),S):(x=p,(S=aa.get(P))&&(x=h({},p),bm(x,S)),s=s.ownerDocument||s,S=s.createElement("script"),Gn(S),Fi(S,"link",x),s.head.appendChild(S),c.instance=S);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,ch(x,p.precedence,s));return c.instance}function ch(s,c,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=x.length?x[x.length-1]:null,P=S,G=0;G<x.length;G++){var Z=x[G];if(Z.dataset.precedence===c)P=Z;else if(P!==S)break}P?P.parentNode.insertBefore(s,P.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(s,c.firstChild))}function kd(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function bm(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var Jc=null;function ix(s,c,p){if(Jc===null){var x=new Map,S=Jc=new Map;S.set(p,x)}else S=Jc,x=S.get(p),x||(x=new Map,S.set(p,x));if(x.has(s))return x;for(x.set(s,null),p=p.getElementsByTagName(s),S=0;S<p.length;S++){var P=p[S];if(!(P[On]||P[Dt]||s==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var G=P.getAttribute(c)||"";G=s+G;var Z=x.get(G);Z?Z.push(P):x.set(G,[P])}}return x}function rx(s,c,p){s=s.ownerDocument||s,s.head.insertBefore(p,c==="title"?s.querySelector("head > title"):null)}function N0(s,c,p){if(p===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function $i(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Yi=null;function S0(){}function j0(s,c,p){if(Yi===null)throw Error(r(475));var x=Yi;if(c.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var S=Wc(p.href),P=s.querySelector(_d(S));if(P){s=P._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Td.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=P,Gn(P);return}P=s.ownerDocument||s,p=tx(p),(S=aa.get(S))&&kd(p,S),P=P.createElement("link"),Gn(P);var G=P;G._p=new Promise(function(Z,me){G.onload=Z,G.onerror=me}),Fi(P,"link",p),c.instance=P}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=Td.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function _0(){if(Yi===null)throw Error(r(475));var s=Yi;return s.stylesheets&&s.count===0&&vm(s,s.stylesheets),0<s.count?function(c){var p=setTimeout(function(){if(s.stylesheets&&vm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(p)}}:null}function Td(){if(this.count--,this.count===0){if(this.stylesheets)vm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var uh=null;function vm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,uh=new Map,c.forEach(C0,s),uh=null,Td.call(s))}function C0(s,c){if(!(c.state.loading&4)){var p=uh.get(s);if(p)var x=p.get(null);else{p=new Map,uh.set(s,p);for(var S=s.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<S.length;P++){var G=S[P];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(p.set(G.dataset.precedence,G),x=G)}x&&p.set(null,x)}S=c.instance,G=S.getAttribute("data-precedence"),P=p.get(G)||x,P===x&&p.set(null,S),p.set(G,S),this.count++,x=Td.bind(this),S.addEventListener("load",x),S.addEventListener("error",x),P?P.parentNode.insertBefore(S,P.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(S,s.firstChild)),c.state.loading|=4}}var Kc={$$typeof:M,Provider:null,Consumer:null,_currentValue:H,_currentValue2:H,_threadCount:0};function k0(s,c,p,x,S,P,G,Z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=tt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tt(0),this.hiddenUpdates=tt(null),this.identifierPrefix=x,this.onUncaughtError=S,this.onCaughtError=P,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function ax(s,c,p,x,S,P,G,Z,me,Pe,He,Qe){return s=new k0(s,c,p,G,Z,me,Pe,Qe),c=1,P===!0&&(c|=24),P=kr(3,null,null,c),s.current=P,P.stateNode=s,c=pp(),c.refCount++,s.pooledCache=c,c.refCount++,P.memoizedState={element:x,isDehydrated:p,cache:c},Ao(P),s}function sx(s){return s?(s=So,s):So}function wm(s,c,p,x,S,P){S=sx(S),x.context===null?x.context=S:x.pendingContext=S,x=kl(c),x.payload={element:p},P=P===void 0?null:P,P!==null&&(x.callback=P),p=Us(s,x,c),p!==null&&(ra(p,s,c),Bu(p,s,c))}function Nm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<c?p:c}}function Sm(s,c){Nm(s,c),(s=s.alternate)&&Nm(s,c)}function lx(s){if(s.tag===13){var c=No(s,67108864);c!==null&&ra(c,s,67108864),Sm(s,67108864)}}var dh=!0;function T0(s,c,p,x){var S=J.T;J.T=null;var P=q.p;try{q.p=2,jm(s,c,p,x)}finally{q.p=P,J.T=S}}function Xc(s,c,p,x){var S=J.T;J.T=null;var P=q.p;try{q.p=8,jm(s,c,p,x)}finally{q.p=P,J.T=S}}function jm(s,c,p,x){if(dh){var S=_m(x);if(S===null)Zs(s,c,x,fh,p),cx(s,x);else if(A0(S,s,c,p,x))x.stopPropagation();else if(cx(s,x),c&4&&-1<E0.indexOf(s)){for(;S!==null;){var P=Zi(S);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var G=nt(P.pendingLanes);if(G!==0){var Z=P;for(Z.pendingLanes|=2,Z.entangledLanes|=2;G;){var me=1<<31-Ie(G);Z.entanglements[1]|=me,G&=~me}Ns(P),($n&6)===0&&(zc=it()+500,vd(0))}}break;case 13:Z=No(P,2),Z!==null&&ra(Z,P,2),Qf(),Sm(P,2)}if(P=_m(x),P===null&&Zs(s,c,x,fh,p),P===S)break;S=P}S!==null&&x.stopPropagation()}else Zs(s,c,x,null,p)}}function _m(s){return s=oo(s),Cm(s)}var fh=null;function Cm(s){if(fh=null,s=Xi(s),s!==null){var c=l(s);if(c===null)s=null;else{var p=c.tag;if(p===13){if(s=o(c),s!==null)return s;s=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return fh=s,null}function ox(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(je()){case Ke:return 2;case ze:return 8;case ct:case Tt:return 32;case bt:return 268435456;default:return 32}default:return 32}}var hh=!1,el=null,ql=null,Vl=null,Ed=new Map,Ad=new Map,Hl=[],E0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function cx(s,c){switch(s){case"focusin":case"focusout":el=null;break;case"dragenter":case"dragleave":ql=null;break;case"mouseover":case"mouseout":Vl=null;break;case"pointerover":case"pointerout":Ed.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ad.delete(c.pointerId)}}function Pd(s,c,p,x,S,P){return s===null||s.nativeEvent!==P?(s={blockedOn:c,domEventName:p,eventSystemFlags:x,nativeEvent:P,targetContainers:[S]},c!==null&&(c=Zi(c),c!==null&&lx(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,S!==null&&c.indexOf(S)===-1&&c.push(S),s)}function A0(s,c,p,x,S){switch(c){case"focusin":return el=Pd(el,s,c,p,x,S),!0;case"dragenter":return ql=Pd(ql,s,c,p,x,S),!0;case"mouseover":return Vl=Pd(Vl,s,c,p,x,S),!0;case"pointerover":var P=S.pointerId;return Ed.set(P,Pd(Ed.get(P)||null,s,c,p,x,S)),!0;case"gotpointercapture":return P=S.pointerId,Ad.set(P,Pd(Ad.get(P)||null,s,c,p,x,S)),!0}return!1}function ux(s){var c=Xi(s.target);if(c!==null){var p=l(c);if(p!==null){if(c=p.tag,c===13){if(c=o(p),c!==null){s.blockedOn=c,Wt(s.priority,function(){if(p.tag===13){var x=hr();x=Ot(x);var S=No(p,x);S!==null&&ra(S,p,x),Sm(p,x)}});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){s.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ph(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var p=_m(s.nativeEvent);if(p===null){p=s.nativeEvent;var x=new p.constructor(p.type,p);Ms=x,p.target.dispatchEvent(x),Ms=null}else return c=Zi(p),c!==null&&lx(c),s.blockedOn=p,!1;c.shift()}return!0}function dx(s,c,p){ph(s)&&p.delete(c)}function P0(){hh=!1,el!==null&&ph(el)&&(el=null),ql!==null&&ph(ql)&&(ql=null),Vl!==null&&ph(Vl)&&(Vl=null),Ed.forEach(dx),Ad.forEach(dx)}function mh(s,c){s.blockedOn===c&&(s.blockedOn=null,hh||(hh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,P0)))}var gh=null;function fx(s){gh!==s&&(gh=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){gh===s&&(gh=null);for(var c=0;c<s.length;c+=3){var p=s[c],x=s[c+1],S=s[c+2];if(typeof x!="function"){if(Cm(x||p)===null)continue;break}var P=Zi(p);P!==null&&(s.splice(c,3),c-=3,Xu(P,{pending:!0,data:S,method:p.method,action:x},x,S))}}))}function Dd(s){function c(me){return mh(me,s)}el!==null&&mh(el,s),ql!==null&&mh(ql,s),Vl!==null&&mh(Vl,s),Ed.forEach(c),Ad.forEach(c);for(var p=0;p<Hl.length;p++){var x=Hl[p];x.blockedOn===s&&(x.blockedOn=null)}for(;0<Hl.length&&(p=Hl[0],p.blockedOn===null);)ux(p),p.blockedOn===null&&Hl.shift();if(p=(s.ownerDocument||s).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var S=p[x],P=p[x+1],G=S[kt]||null;if(typeof P=="function")G||fx(p);else if(G){var Z=null;if(P&&P.hasAttribute("formAction")){if(S=P,G=P[kt]||null)Z=G.formAction;else if(Cm(S)!==null)continue}else Z=G.action;typeof Z=="function"?p[x+1]=Z:(p.splice(x,3),x-=3),fx(p)}}}function km(s){this._internalRoot=s}yh.prototype.render=km.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,x=hr();wm(p,x,s,c,null,null)},yh.prototype.unmount=km.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;wm(s.current,2,null,s,null,null),Qf(),c[It]=null}};function yh(s){this._internalRoot=s}yh.prototype.unstable_scheduleHydration=function(s){if(s){var c=_t();s={blockedOn:null,target:s,priority:c};for(var p=0;p<Hl.length&&c!==0&&c<Hl[p].priority;p++);Hl.splice(p,0,s),p===0&&ux(s)}};var hx=n.version;if(hx!=="19.1.0")throw Error(r(527,hx,"19.1.0"));q.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=u(c),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var D0={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xh.isDisabled&&xh.supportsFiber)try{K=xh.inject(D0),fe=xh}catch{}}return Em.createRoot=function(s,c){if(!a(s))throw Error(r(299));var p=!1,x="",S=zp,P=Rf,G=Xg,Z=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(S=c.onUncaughtError),c.onCaughtError!==void 0&&(P=c.onCaughtError),c.onRecoverableError!==void 0&&(G=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(Z=c.unstable_transitionCallbacks)),c=ax(s,1,!1,null,null,p,x,S,P,G,Z,null),s[It]=c.current,pm(s),new km(c)},Em.hydrateRoot=function(s,c,p){if(!a(s))throw Error(r(299));var x=!1,S="",P=zp,G=Rf,Z=Xg,me=null,Pe=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(S=p.identifierPrefix),p.onUncaughtError!==void 0&&(P=p.onUncaughtError),p.onCaughtError!==void 0&&(G=p.onCaughtError),p.onRecoverableError!==void 0&&(Z=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(me=p.unstable_transitionCallbacks),p.formState!==void 0&&(Pe=p.formState)),c=ax(s,1,!0,c,p??null,x,S,P,G,Z,me,Pe),c.context=sx(null),p=c.current,x=hr(),x=Ot(x),S=kl(x),S.callback=null,Us(p,S,x),p=x,c.current.lanes=p,st(c,p),Ns(c),s[It]=c.current,pm(s),new yh(c)},Em.version="19.1.0",Em}var fN;function SA(){if(fN)return F0.exports;fN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),F0.exports=NA(),F0.exports}var jA=SA(),Am={},hN;function _A(){if(hN)return Am;hN=1,Object.defineProperty(Am,"__esModule",{value:!0}),Am.parse=o,Am.serialize=d;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,l=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function o(b,v){const N=new l,C=b.length;if(C<2)return N;const A=(v==null?void 0:v.decode)||h;let T=0;do{const D=b.indexOf("=",T);if(D===-1)break;const M=b.indexOf(";",T),V=M===-1?C:M;if(D>V){T=b.lastIndexOf(";",D-1)+1;continue}const F=f(b,T,D),z=u(b,D,F),B=b.slice(F,z);if(N[B]===void 0){let U=f(b,D+1,V),R=u(b,V,U);const O=A(b.slice(U,R));N[B]=O}T=V+1}while(T<C);return N}function f(b,v,N){do{const C=b.charCodeAt(v);if(C!==32&&C!==9)return v}while(++v<N);return N}function u(b,v,N){for(;v>N;){const C=b.charCodeAt(--v);if(C!==32&&C!==9)return v+1}return N}function d(b,v,N){const C=(N==null?void 0:N.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const A=C(v);if(!n.test(A))throw new TypeError(`argument val is invalid: ${v}`);let T=b+"="+A;if(!N)return T;if(N.maxAge!==void 0){if(!Number.isInteger(N.maxAge))throw new TypeError(`option maxAge is invalid: ${N.maxAge}`);T+="; Max-Age="+N.maxAge}if(N.domain){if(!t.test(N.domain))throw new TypeError(`option domain is invalid: ${N.domain}`);T+="; Domain="+N.domain}if(N.path){if(!r.test(N.path))throw new TypeError(`option path is invalid: ${N.path}`);T+="; Path="+N.path}if(N.expires){if(!g(N.expires)||!Number.isFinite(N.expires.valueOf()))throw new TypeError(`option expires is invalid: ${N.expires}`);T+="; Expires="+N.expires.toUTCString()}if(N.httpOnly&&(T+="; HttpOnly"),N.secure&&(T+="; Secure"),N.partitioned&&(T+="; Partitioned"),N.priority)switch(typeof N.priority=="string"?N.priority.toLowerCase():void 0){case"low":T+="; Priority=Low";break;case"medium":T+="; Priority=Medium";break;case"high":T+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${N.priority}`)}if(N.sameSite)switch(typeof N.sameSite=="string"?N.sameSite.toLowerCase():N.sameSite){case!0:case"strict":T+="; SameSite=Strict";break;case"lax":T+="; SameSite=Lax";break;case"none":T+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${N.sameSite}`)}return T}function h(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Am}_A();var pN="popstate";function CA(e={}){function n(r,a){let{pathname:l,search:o,hash:f}=r.location;return Vv("",{pathname:l,search:o,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:eg(a)}return TA(n,t,null,e)}function _i(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function al(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function kA(){return Math.random().toString(36).substring(2,10)}function mN(e,n){return{usr:e.state,key:e.key,idx:n}}function Vv(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Wh(n):n,state:t,key:n&&n.key||r||kA()}}function eg({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Wh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function TA(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:l=!1}=r,o=a.history,f="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function g(){f="POP";let A=h(),T=A==null?null:A-d;d=A,u&&u({action:f,location:C.location,delta:T})}function b(A,T){f="PUSH";let D=Vv(C.location,A,T);d=h()+1;let M=mN(D,d),V=C.createHref(D);try{o.pushState(M,"",V)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(V)}l&&u&&u({action:f,location:C.location,delta:1})}function v(A,T){f="REPLACE";let D=Vv(C.location,A,T);d=h();let M=mN(D,d),V=C.createHref(D);o.replaceState(M,"",V),l&&u&&u({action:f,location:C.location,delta:0})}function N(A){return EA(A)}let C={get action(){return f},get location(){return e(a,o)},listen(A){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(pN,g),u=A,()=>{a.removeEventListener(pN,g),u=null}},createHref(A){return n(a,A)},createURL:N,encodeLocation(A){let T=N(A);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:b,replace:v,go(A){return o.go(A)}};return C}function EA(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),_i(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:eg(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function pC(e,n,t="/"){return AA(e,n,t,!1)}function AA(e,n,t,r){let a=typeof n=="string"?Wh(n):n,l=Jo(a.pathname||"/",t);if(l==null)return null;let o=mC(e);PA(o);let f=null;for(let u=0;f==null&&u<o.length;++u){let d=UA(l);f=zA(o[u],d,r)}return f}function mC(e,n=[],t=[],r=""){let a=(l,o,f)=>{let u={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};u.relativePath.startsWith("/")&&(_i(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length));let d=Wo([r,u.relativePath]),h=t.concat(u);l.children&&l.children.length>0&&(_i(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),mC(l.children,n,h,d)),!(l.path==null&&!l.index)&&n.push({path:d,score:FA(d,l.index),routesMeta:h})};return e.forEach((l,o)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,o);else for(let u of gC(l.path))a(l,o,u)}),n}function gC(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(r.length===0)return a?[l,""]:[l];let o=gC(r.join("/")),f=[];return f.push(...o.map(u=>u===""?l:[l,u].join("/"))),a&&f.push(...o),f.map(u=>e.startsWith("/")&&u===""?"/":u)}function PA(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:$A(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var DA=/^:[\w-]+$/,MA=3,IA=2,RA=1,LA=10,OA=-2,gN=e=>e==="*";function FA(e,n){let t=e.split("/"),r=t.length;return t.some(gN)&&(r+=OA),n&&(r+=IA),t.filter(a=>!gN(a)).reduce((a,l)=>a+(DA.test(l)?MA:l===""?RA:LA),r)}function $A(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function zA(e,n,t=!1){let{routesMeta:r}=e,a={},l="/",o=[];for(let f=0;f<r.length;++f){let u=r[f],d=f===r.length-1,h=l==="/"?n:n.slice(l.length)||"/",g=Jx({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),b=u.route;if(!g&&d&&t&&!r[r.length-1].route.index&&(g=Jx({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!g)return null;Object.assign(a,g.params),o.push({params:a,pathname:Wo([l,g.pathname]),pathnameBase:GA(Wo([l,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(l=Wo([l,g.pathnameBase]))}return o}function Jx(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=BA(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let l=a[0],o=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:g},b)=>{if(h==="*"){let N=f[b]||"";o=l.slice(0,l.length-N.length).replace(/(.)\/+$/,"$1")}const v=f[b];return g&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:l,pathnameBase:o,pattern:e}}function BA(e,n=!1,t=!0){al(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,f,u)=>(r.push({paramName:f,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function UA(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return al(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Jo(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function qA(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Wh(e):e;return{pathname:t?t.startsWith("/")?t:VA(t,n):n,search:YA(r),hash:WA(a)}}function VA(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function U0(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function HA(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function J1(e){let n=HA(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function K1(e,n,t,r=!1){let a;typeof e=="string"?a=Wh(e):(a={...e},_i(!a.pathname||!a.pathname.includes("?"),U0("?","pathname","search",a)),_i(!a.pathname||!a.pathname.includes("#"),U0("#","pathname","hash",a)),_i(!a.search||!a.search.includes("#"),U0("#","search","hash",a)));let l=e===""||a.pathname==="",o=l?"/":a.pathname,f;if(o==null)f=t;else{let g=n.length-1;if(!r&&o.startsWith("..")){let b=o.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}f=g>=0?n[g]:"/"}let u=qA(a,f),d=o&&o!=="/"&&o.endsWith("/"),h=(l||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Wo=e=>e.join("/").replace(/\/\/+/g,"/"),GA=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),YA=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,WA=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function QA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var yC=["POST","PUT","PATCH","DELETE"];new Set(yC);var JA=["GET",...yC];new Set(JA);var Qh=w.createContext(null);Qh.displayName="DataRouter";var jb=w.createContext(null);jb.displayName="DataRouterState";var xC=w.createContext({isTransitioning:!1});xC.displayName="ViewTransition";var KA=w.createContext(new Map);KA.displayName="Fetchers";var XA=w.createContext(null);XA.displayName="Await";var ll=w.createContext(null);ll.displayName="Navigation";var ug=w.createContext(null);ug.displayName="Location";var ol=w.createContext({outlet:null,matches:[],isDataRoute:!1});ol.displayName="Route";var X1=w.createContext(null);X1.displayName="RouteError";function ZA(e,{relative:n}={}){_i(Jh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(ll),{hash:a,pathname:l,search:o}=dg(e,{relative:n}),f=l;return t!=="/"&&(f=l==="/"?t:Wo([t,l])),r.createHref({pathname:f,search:o,hash:a})}function Jh(){return w.useContext(ug)!=null}function _r(){return _i(Jh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(ug).location}var bC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function vC(e){w.useContext(ll).static||w.useLayoutEffect(e)}function Mt(){let{isDataRoute:e}=w.useContext(ol);return e?fP():eP()}function eP(){_i(Jh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(Qh),{basename:n,navigator:t}=w.useContext(ll),{matches:r}=w.useContext(ol),{pathname:a}=_r(),l=JSON.stringify(J1(r)),o=w.useRef(!1);return vC(()=>{o.current=!0}),w.useCallback((u,d={})=>{if(al(o.current,bC),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=K1(u,JSON.parse(l),a,d.relative==="path");e==null&&n!=="/"&&(h.pathname=h.pathname==="/"?n:Wo([n,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[n,t,l,a,e])}w.createContext(null);function qr(){let{matches:e}=w.useContext(ol),n=e[e.length-1];return n?n.params:{}}function dg(e,{relative:n}={}){let{matches:t}=w.useContext(ol),{pathname:r}=_r(),a=JSON.stringify(J1(t));return w.useMemo(()=>K1(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function tP(e,n){return wC(e,n)}function wC(e,n,t,r){var D;_i(Jh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:l}=w.useContext(ll),{matches:o}=w.useContext(ol),f=o[o.length-1],u=f?f.params:{},d=f?f.pathname:"/",h=f?f.pathnameBase:"/",g=f&&f.route;{let M=g&&g.path||"";NC(d,!g||M.endsWith("*")||M.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${M}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${M}"> to <Route path="${M==="/"?"*":`${M}/*`}">.`)}let b=_r(),v;if(n){let M=typeof n=="string"?Wh(n):n;_i(h==="/"||((D=M.pathname)==null?void 0:D.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${M.pathname}" was given in the \`location\` prop.`),v=M}else v=b;let N=v.pathname||"/",C=N;if(h!=="/"){let M=h.replace(/^\//,"").split("/");C="/"+N.replace(/^\//,"").split("/").slice(M.length).join("/")}let A=!l&&t&&t.matches&&t.matches.length>0?t.matches:pC(e,{pathname:C});al(g||A!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),al(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=sP(A&&A.map(M=>Object.assign({},M,{params:Object.assign({},u,M.params),pathname:Wo([h,a.encodeLocation?a.encodeLocation(M.pathname).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?h:Wo([h,a.encodeLocation?a.encodeLocation(M.pathnameBase).pathname:M.pathnameBase])})),o,t,r);return n&&T?w.createElement(ug.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},T):T}function nP(){let e=dP(),n=QA(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},l={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:l},"ErrorBoundary")," or"," ",w.createElement("code",{style:l},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,o)}var iP=w.createElement(nP,null),rP=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(ol.Provider,{value:this.props.routeContext},w.createElement(X1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function aP({routeContext:e,match:n,children:t}){let r=w.useContext(Qh);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(ol.Provider,{value:e},t)}function sP(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,l=t==null?void 0:t.errors;if(l!=null){let u=a.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);_i(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let o=!1,f=-1;if(t)for(let u=0;u<a.length;u++){let d=a[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(f=u),d.route.id){let{loaderData:h,errors:g}=t,b=d.route.loader&&!h.hasOwnProperty(d.route.id)&&(!g||g[d.route.id]===void 0);if(d.route.lazy||b){o=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}return a.reduceRight((u,d,h)=>{let g,b=!1,v=null,N=null;t&&(g=l&&d.route.id?l[d.route.id]:void 0,v=d.route.errorElement||iP,o&&(f<0&&h===0?(NC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,N=null):f===h&&(b=!0,N=d.route.hydrateFallbackElement||null)));let C=n.concat(a.slice(0,h+1)),A=()=>{let T;return g?T=v:b?T=N:d.route.Component?T=w.createElement(d.route.Component,null):d.route.element?T=d.route.element:T=u,w.createElement(aP,{match:d,routeContext:{outlet:u,matches:C,isDataRoute:t!=null},children:T})};return t&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?w.createElement(rP,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:A(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):A()},null)}function Z1(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lP(e){let n=w.useContext(Qh);return _i(n,Z1(e)),n}function oP(e){let n=w.useContext(jb);return _i(n,Z1(e)),n}function cP(e){let n=w.useContext(ol);return _i(n,Z1(e)),n}function ew(e){let n=cP(e),t=n.matches[n.matches.length-1];return _i(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function uP(){return ew("useRouteId")}function dP(){var r;let e=w.useContext(X1),n=oP("useRouteError"),t=ew("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function fP(){let{router:e}=lP("useNavigate"),n=ew("useNavigate"),t=w.useRef(!1);return vC(()=>{t.current=!0}),w.useCallback(async(a,l={})=>{al(t.current,bC),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...l}))},[e,n])}var yN={};function NC(e,n,t){!n&&!yN[e]&&(yN[e]=!0,al(!1,t))}w.memo(hP);function hP({routes:e,future:n,state:t}){return wC(e,void 0,t,n)}function In({to:e,replace:n,state:t,relative:r}){_i(Jh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(ll);al(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=w.useContext(ol),{pathname:o}=_r(),f=Mt(),u=K1(e,J1(l),o,r==="path"),d=JSON.stringify(u);return w.useEffect(()=>{f(JSON.parse(d),{replace:n,state:t,relative:r})},[f,d,r,n,t]),null}function pt(e){_i(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function pP({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:l=!1}){_i(!Jh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),f=w.useMemo(()=>({basename:o,navigator:a,static:l,future:{}}),[o,a,l]);typeof t=="string"&&(t=Wh(t));let{pathname:u="/",search:d="",hash:h="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let N=Jo(u,o);return N==null?null:{location:{pathname:N,search:d,hash:h,state:g,key:b},navigationType:r}},[o,u,d,h,g,b,r]);return al(v!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(ll.Provider,{value:f},w.createElement(ug.Provider,{children:n,value:v}))}function kh({children:e,location:n}){return tP(Hv(e),n)}function Hv(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let l=[...n,a];if(r.type===w.Fragment){t.push.apply(t,Hv(r.props.children,l));return}_i(r.type===pt,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),_i(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Hv(r.props.children,l)),t.push(o)}),t}var zx="get",Bx="application/x-www-form-urlencoded";function _b(e){return e!=null&&typeof e.tagName=="string"}function mP(e){return _b(e)&&e.tagName.toLowerCase()==="button"}function gP(e){return _b(e)&&e.tagName.toLowerCase()==="form"}function yP(e){return _b(e)&&e.tagName.toLowerCase()==="input"}function xP(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function bP(e,n){return e.button===0&&(!n||n==="_self")&&!xP(e)}var px=null;function vP(){if(px===null)try{new FormData(document.createElement("form"),0),px=!1}catch{px=!0}return px}var wP=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function q0(e){return e!=null&&!wP.has(e)?(al(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bx}"`),null):e}function NP(e,n){let t,r,a,l,o;if(gP(e)){let f=e.getAttribute("action");r=f?Jo(f,n):null,t=e.getAttribute("method")||zx,a=q0(e.getAttribute("enctype"))||Bx,l=new FormData(e)}else if(mP(e)||yP(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||f.getAttribute("action");if(r=u?Jo(u,n):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||zx,a=q0(e.getAttribute("formenctype"))||q0(f.getAttribute("enctype"))||Bx,l=new FormData(f,e),!vP()){let{name:d,type:h,value:g}=e;if(h==="image"){let b=d?`${d}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else d&&l.append(d,g)}}else{if(_b(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=zx,r=null,a=Bx,o=e}return l&&a==="text/plain"&&(o=l,l=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:l,body:o}}function tw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function SP(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jP(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function _P(e,n,t){let r=await Promise.all(e.map(async a=>{let l=n.routes[a.route.id];if(l){let o=await SP(l,t);return o.links?o.links():[]}return[]}));return EP(r.flat(1).filter(jP).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function xN(e,n,t,r,a,l){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,f=(u,d)=>{var h;return t[d].pathname!==u.pathname||((h=t[d].route.path)==null?void 0:h.endsWith("*"))&&t[d].params["*"]!==u.params["*"]};return l==="assets"?n.filter((u,d)=>o(u,d)||f(u,d)):l==="data"?n.filter((u,d)=>{var g;let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||f(u,d))return!0;if(u.route.shouldRevalidate){let b=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function CP(e,n,{includeHydrateFallback:t}={}){return kP(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function kP(e){return[...new Set(e)]}function TP(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function EP(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let l=JSON.stringify(TP(a));return t.has(l)||(t.add(l),r.push({key:l,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var AP=new Set([100,101,204,205]);function PP(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Jo(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function SC(){let e=w.useContext(Qh);return tw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function DP(){let e=w.useContext(jb);return tw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var nw=w.createContext(void 0);nw.displayName="FrameworkContext";function jC(){let e=w.useContext(nw);return tw(e,"You must render this element inside a <HydratedRouter> element"),e}function MP(e,n){let t=w.useContext(nw),[r,a]=w.useState(!1),[l,o]=w.useState(!1),{onFocus:f,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let C=T=>{T.forEach(D=>{o(D.isIntersecting)})},A=new IntersectionObserver(C,{threshold:.5});return b.current&&A.observe(b.current),()=>{A.disconnect()}}},[e]),w.useEffect(()=>{if(r){let C=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(C)}}},[r]);let v=()=>{a(!0)},N=()=>{a(!1),o(!1)};return t?e!=="intent"?[l,b,{}]:[l,b,{onFocus:Pm(f,v),onBlur:Pm(u,N),onMouseEnter:Pm(d,v),onMouseLeave:Pm(h,N),onTouchStart:Pm(g,v)}]:[!1,b,{}]}function Pm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function IP({page:e,...n}){let{router:t}=SC(),r=w.useMemo(()=>pC(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(LP,{page:e,matches:r,...n}):null}function RP(e){let{manifest:n,routeModules:t}=jC(),[r,a]=w.useState([]);return w.useEffect(()=>{let l=!1;return _P(e,n,t).then(o=>{l||a(o)}),()=>{l=!0}},[e,n,t]),r}function LP({page:e,matches:n,...t}){let r=_r(),{manifest:a,routeModules:l}=jC(),{basename:o}=SC(),{loaderData:f,matches:u}=DP(),d=w.useMemo(()=>xN(e,n,u,a,r,"data"),[e,n,u,a,r]),h=w.useMemo(()=>xN(e,n,u,a,r,"assets"),[e,n,u,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let N=new Set,C=!1;if(n.forEach(T=>{var M;let D=a.routes[T.route.id];!D||!D.hasLoader||(!d.some(V=>V.route.id===T.route.id)&&T.route.id in f&&((M=l[T.route.id])!=null&&M.shouldRevalidate)||D.hasClientLoader?C=!0:N.add(T.route.id))}),N.size===0)return[];let A=PP(e,o);return C&&N.size>0&&A.searchParams.set("_routes",n.filter(T=>N.has(T.route.id)).map(T=>T.route.id).join(",")),[A.pathname+A.search]},[o,f,r,a,d,n,e,l]),b=w.useMemo(()=>CP(h,a),[h,a]),v=RP(h);return w.createElement(w.Fragment,null,g.map(N=>w.createElement("link",{key:N,rel:"prefetch",as:"fetch",href:N,...t})),b.map(N=>w.createElement("link",{key:N,rel:"modulepreload",href:N,...t})),v.map(({key:N,link:C})=>w.createElement("link",{key:N,...C})))}function OP(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var _C=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{_C&&(window.__reactRouterVersion="7.6.0")}catch{}function FP({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=CA({window:t,v5Compat:!0}));let a=r.current,[l,o]=w.useState({action:a.action,location:a.location}),f=w.useCallback(u=>{w.startTransition(()=>o(u))},[o]);return w.useLayoutEffect(()=>a.listen(f),[a,f]),w.createElement(pP,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a})}var CC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ts=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:l,replace:o,state:f,target:u,to:d,preventScrollReset:h,viewTransition:g,...b},v){let{basename:N}=w.useContext(ll),C=typeof d=="string"&&CC.test(d),A,T=!1;if(typeof d=="string"&&C&&(A=d,_C))try{let R=new URL(window.location.href),O=d.startsWith("//")?new URL(R.protocol+d):new URL(d),$=Jo(O.pathname,N);O.origin===R.origin&&$!=null?d=$+O.search+O.hash:T=!0}catch{al(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let D=ZA(d,{relative:a}),[M,V,F]=MP(r,b),z=UP(d,{replace:o,state:f,target:u,preventScrollReset:h,relative:a,viewTransition:g});function B(R){n&&n(R),R.defaultPrevented||z(R)}let U=w.createElement("a",{...b,...F,href:A||D,onClick:T||l?n:B,ref:OP(v,V),target:u,"data-discover":!C&&t==="render"?"true":void 0});return M&&!C?w.createElement(w.Fragment,null,U,w.createElement(IP,{page:D})):U});Ts.displayName="Link";var $P=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:l,to:o,viewTransition:f,children:u,...d},h){let g=dg(o,{relative:d.relative}),b=_r(),v=w.useContext(jb),{navigator:N,basename:C}=w.useContext(ll),A=v!=null&&YP(g)&&f===!0,T=N.encodeLocation?N.encodeLocation(g).pathname:g.pathname,D=b.pathname,M=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(D=D.toLowerCase(),M=M?M.toLowerCase():null,T=T.toLowerCase()),M&&C&&(M=Jo(M,C)||M);const V=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let F=D===T||!a&&D.startsWith(T)&&D.charAt(V)==="/",z=M!=null&&(M===T||!a&&M.startsWith(T)&&M.charAt(T.length)==="/"),B={isActive:F,isPending:z,isTransitioning:A},U=F?n:void 0,R;typeof r=="function"?R=r(B):R=[r,F?"active":null,z?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let O=typeof l=="function"?l(B):l;return w.createElement(Ts,{...d,"aria-current":U,className:R,ref:h,style:O,to:o,viewTransition:f},typeof u=="function"?u(B):u)});$P.displayName="NavLink";var zP=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:l,method:o=zx,action:f,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:g,...b},v)=>{let N=HP(),C=GP(f,{relative:d}),A=o.toLowerCase()==="get"?"get":"post",T=typeof f=="string"&&CC.test(f),D=M=>{if(u&&u(M),M.defaultPrevented)return;M.preventDefault();let V=M.nativeEvent.submitter,F=(V==null?void 0:V.getAttribute("formmethod"))||o;N(V||M.currentTarget,{fetcherKey:n,method:F,navigate:t,replace:a,state:l,relative:d,preventScrollReset:h,viewTransition:g})};return w.createElement("form",{ref:v,method:A,action:C,onSubmit:r?u:D,...b,"data-discover":!T&&e==="render"?"true":void 0})});zP.displayName="Form";function BP(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kC(e){let n=w.useContext(Qh);return _i(n,BP(e)),n}function UP(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:l,viewTransition:o}={}){let f=Mt(),u=_r(),d=dg(e,{relative:l});return w.useCallback(h=>{if(bP(h,n)){h.preventDefault();let g=t!==void 0?t:eg(u)===eg(d);f(e,{replace:g,state:r,preventScrollReset:a,relative:l,viewTransition:o})}},[u,f,d,t,r,n,e,a,l,o])}var qP=0,VP=()=>`__${String(++qP)}__`;function HP(){let{router:e}=kC("useSubmit"),{basename:n}=w.useContext(ll),t=uP();return w.useCallback(async(r,a={})=>{let{action:l,method:o,encType:f,formData:u,body:d}=NP(r,n);if(a.navigate===!1){let h=a.fetcherKey||VP();await e.fetch(h,t,a.action||l,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||o,formEncType:a.encType||f,flushSync:a.flushSync})}else await e.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||o,formEncType:a.encType||f,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function GP(e,{relative:n}={}){let{basename:t}=w.useContext(ll),r=w.useContext(ol);_i(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),l={...dg(e||".",{relative:n})},o=_r();if(e==null){l.search=o.search;let f=new URLSearchParams(l.search),u=f.getAll("index");if(u.some(h=>h==="")){f.delete("index"),u.filter(g=>g).forEach(g=>f.append("index",g));let h=f.toString();l.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:Wo([t,l.pathname])),eg(l)}function YP(e,n={}){let t=w.useContext(xC);_i(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=kC("useViewTransitionState"),a=dg(e,{relative:n.relative});if(!t.isTransitioning)return!1;let l=Jo(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Jo(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Jx(a.pathname,o)!=null||Jx(a.pathname,l)!=null}[...AP];var WP=hC();class QP extends w.Component{constructor(){super(...arguments);ri(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}class JP{constructor(){ri(this,"requestCount",0);ri(this,"listeners",[])}subscribe(n){return this.listeners.push(n),()=>{this.listeners=this.listeners.filter(t=>t!==n)}}notify(){const n=this.requestCount>0;this.listeners.forEach(t=>t(n))}addRequest(){this.requestCount++,this.notify()}removeRequest(){this.requestCount--,this.requestCount<0&&(this.requestCount=0),this.notify()}}const nl=new JP,KP="https://backend.newtons.in",XP=()=>localStorage.getItem("authToken"),ue=async(e,n={})=>{const t=XP(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let l=e.startsWith("/")?e:`/${e}`;l.startsWith("/api/")||(l=`/api${l}`);const o=`${KP}${l}`;nl.addRequest();try{console.log(`Making API call to: ${o}`);const f=await fetch(o,{...n,headers:a});if(f.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!f.ok){let u=`HTTP error! status: ${f.status}`;try{const d=await f.json();u=(d==null?void 0:d.message)||(d==null?void 0:d.error)||u}catch{}throw console.error(`API Error: ${f.status} ${f.statusText} - ${u}`),new Error(u)}return f}catch(f){throw f instanceof TypeError&&f.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",f):console.error("API Fetch Error:",f),f}finally{nl.removeRequest()}},ZP=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[l,o]=w.useState(null),[f,u]=w.useState(!1),d=Mt(),h=async g=>{g.preventDefault(),u(!0),o(null);try{const b=await ue("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!b.ok){let N=`Login failed with status: ${b.status}`;try{N=(await b.json()).message||N}catch{try{const A=await b.text();A&&(N=`${N} - ${A}`)}catch{}}throw new Error(N)}const v=await b.json();console.log("Login successful:",v),localStorage.setItem("authToken",v.token),localStorage.setItem("currentUser",JSON.stringify(v.user)),v.user.clinic_id&&localStorage.setItem("currentClinicId",v.user.clinic_id),e(v.user),v.user.role==="doctor"?d("/dashboard/queue"):d("/dashboard")}catch(b){console.error("Login failed:",b),o(b.message||"Login failed. Please check your credentials.")}finally{u(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Sign in to Newtons OPD Zero"}),i.jsxs("form",{onSubmit:h,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email address"}),i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:g=>t(g.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Password"}),i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:g=>a(g.target.value),className:"auth-text-input",placeholder:"Password"})]}),l&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:l})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:f,className:"auth-submit-button",children:f?"Signing in...":"Sign In"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(Ts,{to:"/register",className:"auth-navigation-link",children:"Register a new clinic"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},eD=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,l]=w.useState(""),[o,f]=w.useState(""),[u,d]=w.useState(null),[h,g]=w.useState(!1),b=Mt(),v=async N=>{N.preventDefault(),g(!0),d(null);try{const C=await ue("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:o})}),A=await C.json();if(!C.ok)throw new Error(A.message||`HTTP error! status: ${C.status}`);console.log("Registration successful:",A),alert("Registration successful! Please log in."),b("/login")}catch(C){console.error("Registration failed:",C),d(C.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:N=>n(N.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:N=>r(N.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:N=>l(N.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:o,onChange:N=>f(N.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),u&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:u})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:h,className:"auth-submit-button",children:h?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(Ts,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var TC={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},bN=qn.createContext&&qn.createContext(TC),tD=["attr","size","title"];function nD(e,n){if(e==null)return{};var t=iD(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function iD(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function Kx(){return Kx=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Kx.apply(this,arguments)}function vN(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Xx(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?vN(Object(t),!0).forEach(function(r){rD(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):vN(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function rD(e,n,t){return n=aD(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function aD(e){var n=sD(e,"string");return typeof n=="symbol"?n:n+""}function sD(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function EC(e){return e&&e.map((n,t)=>qn.createElement(n.tag,Xx({key:t},n.attr),EC(n.child)))}function is(e){return n=>qn.createElement(lD,Kx({attr:Xx({},e.attr)},n),EC(e.child))}function lD(e){var n=t=>{var{attr:r,size:a,title:l}=e,o=nD(e,tD),f=a||t.size||"1em",u;return t.className&&(u=t.className),e.className&&(u=(u?u+" ":"")+e.className),qn.createElement("svg",Kx({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:u,style:Xx(Xx({color:e.color||t.color},t.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),l&&qn.createElement("title",null,l),e.children)};return bN!==void 0?qn.createElement(bN.Consumer,null,t=>n(t)):n(TC)}function Dm(e){return is({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function oD(e){return is({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function wN(e){return is({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function Th(e){return is({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function mx(e){return is({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function gx(e){return is({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function yx(e){return is({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Eh(e){return is({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function AC(e){return is({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function NN(e){return is({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function PC(e){return is({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function V0(e){return is({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function bh(e){return is({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const iw={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:Th},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:mx},{path:"/dashboard/users",name:"User Management",icon:bh}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:Th}]},{title:"Staff Management",links:[{path:"/dashboard/staff",name:"Manage Staff",icon:bh},{path:"/dashboard/staff/add",name:"Add Staff",icon:V0}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:mx},{path:"/dashboard/patients",name:"All Patients",icon:bh},{path:"/dashboard/patients/search",name:"Search Patient",icon:Eh}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Dm},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:yx},{path:"/dashboard/purchase",name:"Add Drug",icon:yx},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Dm},{path:"/dashboard/distributors",name:"Distributor Management",icon:bh}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:NN},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:gx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:gx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:Eh},{path:"/dashboard/add-patient",name:"Add Patient",icon:mx},{path:"/manage-admission",name:"Manage Admission",icon:V0}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:wN},{path:"/billing",name:"Billing",icon:gx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:NN}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:Th}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:bh},{path:"/dashboard/patients/add",name:"Add Patient",icon:mx},{path:"/dashboard/patients/search",name:"Search Patient",icon:Eh}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:gx},{path:"/manage-admission",name:"Manage Admission",icon:V0}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:Th},{path:"/lab-inventory",name:"Lab Test Inventory",icon:wN},{path:"/lab/search-report",name:"Search Lab Report",icon:Eh}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:Th},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:yx},{path:"/dashboard/purchase",name:"Add Drug",icon:yx},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:Dm},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Dm},{path:"/dashboard/distributors",name:"Distributor Management",icon:bh}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Dm},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:oD},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:Eh}]}]},cD=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const l=_r(),[o,f]=w.useState(""),u=iw[t]||[],[d,h]=w.useState(500),g=w.useRef(!1),b=w.useCallback(A=>{g.current=!0,A.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),N=w.useCallback(A=>{if(g.current){const T=window.innerWidth-A.clientX;T>250&&T<window.innerWidth*.8&&h(T)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",N),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",v)}),[N,v]);const C=u.map(A=>({...A,links:A.links.filter(T=>T.name.toLowerCase().includes(o.toLowerCase()))})).filter(A=>A.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${d}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(Ts,{to:"/dashboard",className:"home-button",onClick:a,title:"Go to Dashboard",children:i.jsx(Th,{})}),i.jsxs("div",{className:"search-container",children:[i.jsx(Eh,{className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:o,onChange:A=>f(A.target.value)})]}),i.jsx("button",{className:"side-panel-close-button",onClick:a,"aria-label":"Close panel",children:i.jsx(PC,{})})]}),i.jsx("nav",{children:C.map((A,T)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:A.title}),i.jsx("ul",{className:"sub-page-list",children:A.links.map(D=>{const M=D.icon;return i.jsx("li",{children:i.jsxs(Ts,{to:D.path,className:l.pathname===D.path?"active":"",onClick:a,children:[M&&i.jsx(M,{})," ",i.jsx("span",{children:D.name})]})},D.path)})})]},T))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("div",{className:"user-name",children:["Welcome back, ",i.jsx("strong",{children:e.name})]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(AC,{})," Sign Out"]})]})]})},uD=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:l})=>{const o=_r(),f=l[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"mobile-close-button",onClick:a,"aria-label":"Close panel",children:i.jsx(PC,{})})]}),i.jsx("nav",{children:f.map((u,d)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:u.title}),i.jsx("ul",{className:"sub-page-list",children:u.links.map(h=>{const g=h.icon;return i.jsx("li",{children:i.jsxs(Ts,{to:h.path,className:o.pathname===h.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",h.name]})},h.path)})})]},d))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("div",{className:"user-name",children:["Welcome back, ",i.jsx("strong",{children:e.name})]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(AC,{})," Sign Out"]})]})]})]})};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dD=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),fD=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),SN=e=>{const n=fD(e);return n.charAt(0).toUpperCase()+n.slice(1)},DC=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var hD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pD=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:o,...f},u)=>w.createElement("svg",{ref:u,...hD,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:DC("lucide",a),...f},[...o.map(([d,h])=>w.createElement(d,h)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=(e,n)=>{const t=w.forwardRef(({className:r,...a},l)=>w.createElement(pD,{ref:l,iconNode:n,className:DC(`lucide-${dD(SN(e))}`,`lucide-${e}`,r),...a}));return t.displayName=SN(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mD=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],jN=ut("activity",mD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gD=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],iu=ut("arrow-down",gD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yD=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],an=ut("arrow-left",yD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xD=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],bD=ut("arrow-right",xD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vD=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Ho=ut("arrow-up",vD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wD=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],_N=ut("banknote",wD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ND=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],rw=ut("beaker",ND);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SD=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],jD=ut("bed-double",SD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _D=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],CD=ut("bell",_D);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kD=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],TD=ut("bell-ring",kD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ED=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],Gv=ut("brain",ED);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AD=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],PD=ut("building",AD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],MD=ut("calendar-check-2",DD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ID=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],RD=ut("calendar-days",ID);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ud=ut("calendar",LD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],FD=ut("chart-no-axes-column",OD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],tg=ut("check",$D);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zD=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Zx=ut("chevron-down",zD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Cb=ut("chevron-left",BD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],fg=ut("chevron-right",UD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Yv=ut("chevron-up",qD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ni=ut("circle-alert",VD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ta=ut("circle-check-big",HD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],YD=ut("circle-minus",GD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Yo=ut("circle-plus",WD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],JD=ut("circle-user",QD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],CN=ut("clipboard-list",KD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],MC=ut("clipboard",XD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],eM=ut("clock",ZD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],nM=ut("copy",tM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=[["polyline",{points:"9 10 4 15 9 20",key:"r3jprv"}],["path",{d:"M20 4v7a4 4 0 0 1-4 4H4",key:"6o5b7l"}]],rM=ut("corner-down-left",iM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],zd=ut("credit-card",aM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Bd=ut("dollar-sign",sM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lM=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],IC=ut("eye",lM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],kN=ut("file-check",oM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ea=ut("file-text",cM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Wv=ut("flask-conical",uM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],RC=ut("funnel",dM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ph=ut("hash",fM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hM=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],LC=ut("house",hM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ks=ut("info",pM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mM=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],gM=ut("key",mM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],xM=ut("list-ordered",yM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],vM=ut("list",bM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Rh=ut("loader-circle",wM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],SM=ut("lock",NM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],_M=ut("message-square",jM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CM=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],kM=ut("mic-off",CM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TM=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],OC=ut("mic",TM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EM=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],AM=ut("monitor",EM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PM=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],DM=ut("package-open",PM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MM=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ko=ut("package",MM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IM=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],RM=ut("paperclip",IM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LM=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],OM=ut("pause",LM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FM=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],ru=ut("pencil",FM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Xo=ut("pill",$M);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],BM=ut("play",zM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],eo=ut("plus",UM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],il=ut("printer",qM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],qd=ut("refresh-cw",VM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],GM=ut("repeat",HM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YM=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],WM=ut("rotate-ccw",YM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],uu=ut("save",QM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Ci=ut("search",JM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],XM=ut("send",KM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZM=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],eb=ut("server-crash",ZM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],hg=ut("settings",eI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],FC=ut("share-2",tI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],$C=ut("shopping-cart",nI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],H0=ut("smartphone",iI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],du=ut("square-pen",rI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],sI=ut("stethoscope",aI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],oI=ut("tag",lI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Pi=ut("trash-2",cI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],dI=ut("trending-up",uI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],zC=ut("triangle-alert",fI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],pI=ut("truck",hI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],gI=ut("upload",mI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],BC=ut("user-check",yI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],UC=ut("user-plus",xI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],to=ut("user",bI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],cu=ut("users",vI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],NI=ut("video",wI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Dh=ut("wallet",SI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],gi=ut("x",jI),_I="_container_qoi3n_3",CI="_title_qoi3n_25",kI="_filtersContainer_qoi3n_43",TI="_dateInputLabel_qoi3n_81",EI="_dateInput_qoi3n_81",AI="_fetchButton_qoi3n_147",PI="_summarySection_qoi3n_197",DI="_totalRevenue_qoi3n_209",MI="_totalRevenueAmount_qoi3n_279",II="_revenueGrid_qoi3n_303",RI="_revenueCard_qoi3n_327",LI="_revenueCardTitle_qoi3n_365",OI="_revenueCardAmount_qoi3n_389",FI="_revenueCardList_qoi3n_411",$I="_tableSectionTitle_qoi3n_483",zI="_tableContainer_qoi3n_511",BI="_styledTable_qoi3n_537",UI="_capitalize_qoi3n_629",qI="_errorAlert_qoi3n_639",VI="_loadingContainer_qoi3n_663",HI="_breathingBall_qoi3n_683",GI="_noDataMessage_qoi3n_733",rn={container:_I,title:CI,filtersContainer:kI,dateInputLabel:TI,dateInput:EI,fetchButton:AI,summarySection:PI,totalRevenue:DI,totalRevenueAmount:MI,revenueGrid:II,revenueCard:RI,revenueCardTitle:LI,revenueCardAmount:OI,revenueCardList:FI,tableSectionTitle:$I,tableContainer:zI,styledTable:BI,capitalize:UI,errorAlert:qI,loadingContainer:VI,breathingBall:HI,noDataMessage:GI},YI=()=>{const e=new Date().toISOString().split("T")[0],[n,t]=w.useState(e),[r,a]=w.useState(e),[l,o]=w.useState([]),[f,u]=w.useState([]),[d,h]=w.useState([]),[g,b]=w.useState(0),[v,N]=w.useState(0),[C,A]=w.useState(null),[T,D]=w.useState({reception:{},pharmacy:{},lab:{}}),[M,V]=w.useState(!1),[F,z]=w.useState(null),B=async()=>{if(V(!0),z(null),o([]),u([]),h([]),b(0),N(0),A(null),D({reception:{},pharmacy:{},lab:{}}),!n||!r){z("Please select both start and end dates."),V(!1);return}if(new Date(n)>new Date(r)){z("Start date cannot be after end date."),V(!1);return}try{const[R,O,$]=await Promise.all([ue(`/api/bills?startDate=${n}&endDate=${r}`),ue(`/api/payment/admission?startDate=${n}&endDate=${r}`),ue(`/api/subscriptions/transactions/manual?startDate=${n}&endDate=${r}`)]);if(!R.ok){const ie=await R.json().catch(()=>({}));throw new Error(`Bills fetch error: ${ie.message||R.statusText}`)}if(!O.ok){const ie=await O.json().catch(()=>({}));throw new Error(`Admission Payments fetch error: ${ie.message||O.statusText}`)}if(!$.ok){const ie=await $.json().catch(()=>({}));throw new Error(`Manual Subscriptions fetch error: ${ie.message||$.statusText}`)}const W=await R.json(),te=await O.json(),ne=await $.json(),re=W.bills||[],J=te.admissionPayments||[],q=ne||[];o(re),u(J),h(q);let H=0,ee=0;const E={consultation:0,pharmacy:0,lab:0,other:0},Q={reception:{},pharmacy:{},lab:{}};re.forEach(ie=>{if(ie.status==="paid"||ie.type==="pharmacy_return"){const I=parseFloat(ie.amount.toString()),ce=ie.payment_mode||"Unknown";let xe=ie.type||"other";xe==="pharmacy_return"&&(ee+=I,xe="pharmacy"),H+=I,E.hasOwnProperty(xe)?E[xe]=(E[xe]||0)+I:E.other=(E.other||0)+I,xe==="pharmacy"?Q.pharmacy[ce]=(Q.pharmacy[ce]||0)+I:xe==="lab"?Q.lab[ce]=(Q.lab[ce]||0)+I:Q.reception[ce]=(Q.reception[ce]||0)+I}}),J.forEach(ie=>{const I=parseFloat(ie.amount_paid.toString()),ce=ie.payment_mode||"Unknown";H+=I,Q.reception[ce]=(Q.reception[ce]||0)+I}),q.forEach(ie=>{var xe,le;const I=parseFloat(((le=(xe=ie.subscriptionPlan)==null?void 0:xe.price)==null?void 0:le.toString())??"0"),ce=ie.subscription_payment_method||"Unknown";H+=I,Q.reception[ce]=(Q.reception[ce]||0)+I}),A(E),D(Q),b(H),N(ee)}catch(R){console.error("Failed to fetch money flow data:",R),z(R.message||"Failed to fetch data. Check console for details.")}finally{V(!1)}},U=()=>{B()};return i.jsxs("div",{className:rn.container,children:[i.jsxs("header",{className:rn.header,children:[i.jsx("h2",{className:rn.title,children:"Money Flow Analysis"}),i.jsxs("div",{className:rn.filtersContainer,children:[i.jsxs("div",{className:rn.filterGroup,children:[i.jsx("label",{htmlFor:"start-date-money",className:rn.dateInputLabel,children:"Start Date"}),i.jsx("div",{style:{position:"relative"},children:i.jsx("input",{type:"date",id:"start-date-money",value:n,onChange:R=>t(R.target.value),className:rn.dateInput})})]}),i.jsxs("div",{className:rn.filterGroup,children:[i.jsx("label",{htmlFor:"end-date-money",className:rn.dateInputLabel,children:"End Date"}),i.jsx("input",{type:"date",id:"end-date-money",value:r,onChange:R=>a(R.target.value),className:rn.dateInput})]}),i.jsx("button",{onClick:U,disabled:M,className:rn.fetchButton,children:M?"Processing...":"Generate Analysis"})]})]}),F&&i.jsxs("div",{className:rn.errorAlert,role:"alert",children:[i.jsx(ni,{size:20}),i.jsx("span",{children:F})]}),!M&&!F&&(l.length>0||f.length>0||d.length>0)&&i.jsxs("main",{className:rn.summarySection,children:[i.jsxs("section",{className:rn.totalRevenue,children:[i.jsxs("span",{children:["Total Paid Revenue (",n," to ",r,")"]}),i.jsxs("div",{className:rn.totalRevenueAmount,children:["",g.toLocaleString("en-IN",{minimumFractionDigits:2})]})]}),C&&T&&i.jsxs("div",{className:rn.revenueGrid,children:[i.jsxs("div",{className:rn.revenueCard,children:[i.jsxs("div",{className:rn.revenueCardTitle,children:[i.jsx(jN,{size:16,color:"var(--Primary-60)"}),i.jsx("span",{children:"Reception"})]}),i.jsxs("div",{className:rn.revenueCardAmount,children:["",(C.consultation+(C.other||0)).toLocaleString("en-IN",{minimumFractionDigits:0})]}),i.jsx("ul",{className:rn.revenueCardList,children:Object.entries(T.reception).map(([R,O])=>i.jsxs("li",{children:[i.jsx("span",{className:rn.capitalize,children:R}),i.jsxs("span",{children:["",O.toFixed(2)]})]},`reception-${R}`))})]}),i.jsxs("div",{className:rn.revenueCard,children:[i.jsxs("div",{className:rn.revenueCardTitle,children:[i.jsx($C,{size:16,color:"#A78BFA"}),i.jsx("span",{children:"Pharmacy"})]}),i.jsxs("div",{className:rn.revenueCardAmount,children:["",C.pharmacy.toLocaleString("en-IN",{minimumFractionDigits:0})]}),i.jsxs("ul",{className:rn.revenueCardList,children:[Object.entries(T.pharmacy).map(([R,O])=>i.jsxs("li",{children:[i.jsx("span",{className:rn.capitalize,children:R}),i.jsxs("span",{children:["",O.toFixed(2)]})]},`pharmacy-${R}`)),v<0&&i.jsxs("li",{style:{borderTop:"1px dashed #eee",marginTop:"0.5rem",paddingTop:"0.5rem"},children:[i.jsx("span",{children:"Returns"}),i.jsxs("span",{style:{color:"var(--Danger)"},children:["-",Math.abs(v).toFixed(2)]})]})]})]}),i.jsxs("div",{className:rn.revenueCard,children:[i.jsxs("div",{className:rn.revenueCardTitle,children:[i.jsx(dI,{size:16,color:"#5EEAD4"}),i.jsx("span",{children:"Lab Revenue"})]}),i.jsxs("div",{className:rn.revenueCardAmount,children:["",C.lab.toLocaleString("en-IN",{minimumFractionDigits:0})]}),i.jsx("ul",{className:rn.revenueCardList,children:Object.entries(T.lab).map(([R,O])=>i.jsxs("li",{children:[i.jsx("span",{className:rn.capitalize,children:R}),i.jsxs("span",{children:["",O.toFixed(2)]})]},`lab-${R}`))})]})]}),i.jsxs("h4",{className:rn.tableSectionTitle,children:[i.jsx(Ea,{size:20})," Settled Invoices"]}),i.jsx("div",{className:rn.tableContainer,children:i.jsxs("table",{className:rn.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Bill ID"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Department"}),i.jsx("th",{children:"Payment"}),i.jsx("th",{style:{textAlign:"right"},children:"Amount"})]})}),i.jsx("tbody",{children:l.filter(R=>R.status==="paid"||R.type==="pharmacy_return").map(R=>i.jsxs("tr",{children:[i.jsxs("td",{style:{opacity:.7},children:[i.jsx(Ud,{size:14,style:{marginRight:"6px"}}),new Date(R.createdAt).toLocaleDateString()]}),i.jsxs("td",{children:["#",R.id]}),i.jsx("td",{children:R.patient_id}),i.jsx("td",{className:rn.capitalize,children:i.jsx("span",{style:{fontSize:"0.8rem",padding:"2px 8px",borderRadius:"4px",background:"var(--Neutral-10)",color:"var(--Neutral-70)"},children:R.type.replace("_"," ")})}),i.jsxs("td",{className:rn.capitalize,children:[i.jsx(zd,{size:14,style:{marginRight:"6px",opacity:.5}}),R.payment_mode]}),i.jsxs("td",{style:{textAlign:"right",fontWeight:600},children:["",parseFloat(R.amount.toString()).toFixed(2)]})]},`bill-${R.id}`))})]})}),i.jsxs("h4",{className:rn.tableSectionTitle,children:[i.jsx(jN,{size:20})," IPD Payments"]}),i.jsx("div",{className:rn.tableContainer,children:i.jsxs("table",{className:rn.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Ref ID"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Method"}),i.jsx("th",{style:{textAlign:"right"},children:"Amount"})]})}),i.jsxs("tbody",{children:[f.map(R=>{var O;return i.jsxs("tr",{children:[i.jsx("td",{style:{opacity:.7},children:new Date(R.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["#",R.id]}),i.jsx("td",{children:((O=R.Patient)==null?void 0:O.name)??R.patient_id}),i.jsx("td",{className:rn.capitalize,children:R.payment_mode}),i.jsxs("td",{style:{textAlign:"right",fontWeight:600},children:["",parseFloat(R.amount_paid.toString()).toFixed(2)]})]},`admission-${R.id}`)}),f.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{textAlign:"center",opacity:.5},children:"No IPD settlements found."})})]})]})}),i.jsxs("h4",{className:rn.tableSectionTitle,children:[i.jsx(zd,{size:20})," Subscription Plans"]}),i.jsx("div",{className:rn.tableContainer,children:i.jsxs("table",{className:rn.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Start Date"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Plan Type"}),i.jsx("th",{style:{textAlign:"right"},children:"Settlement"})]})}),i.jsxs("tbody",{children:[d.map(R=>{var O,$,W;return i.jsxs("tr",{children:[i.jsx("td",{style:{opacity:.7},children:new Date(R.subscription_start_date).toLocaleDateString()}),i.jsxs("td",{children:[R.name," ",i.jsxs("span",{style:{opacity:.5},children:["#",R.id]})]}),i.jsx("td",{children:((O=R.subscriptionPlan)==null?void 0:O.name)??"Standard Plan"}),i.jsxs("td",{style:{textAlign:"right",fontWeight:600},children:["",parseFloat(((W=($=R.subscriptionPlan)==null?void 0:$.price)==null?void 0:W.toString())??"0").toFixed(2)]})]},`sub-patient-${R.id}`)}),d.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,style:{textAlign:"center",opacity:.5},children:"No subscriptions processed."})})]})]})})]}),M&&i.jsxs("div",{className:rn.loadingContainer,children:[i.jsx("div",{className:rn.breathingBall}),i.jsx("p",{children:"Compiling Financial Report..."})]}),!M&&!F&&l.length===0&&f.length===0&&d.length===0&&i.jsxs("div",{className:rn.noDataMessage,children:[i.jsx(Ea,{size:40,style:{marginBottom:"1rem",opacity:.2}}),i.jsx("p",{children:"No financial records found for this period. Try adjusting the date range."})]})]})},WI=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},tb=()=>localStorage.getItem("authToken"),aw=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!1),[a,l]=w.useState(null),[o,f]=w.useState(!1),[u,d]=w.useState(null),h=w.useRef(null),[g,b]=w.useState(!1),[v,N]=w.useState(null),[C,A]=w.useState(!1),[T,D]=w.useState(!1),[M,V]=w.useState(null),[F,z]=w.useState({name:"",description:"",price:"",default_parameters:[]}),B=w.useCallback(async()=>{r(!0),l(null),d(null),N(null);try{const ie=await ue("/api/lab-tests");if(!ie.ok)throw new Error(`HTTP error! status: ${ie.status}`);const I=await ie.json();n(I)}catch(ie){console.error("Error fetching lab tests:",ie),l(ie.message||"Failed to fetch lab tests.")}finally{r(!1)}},[]);w.useEffect(()=>{B()},[B]);const U=ie=>{const{name:I,value:ce}=ie.target;z(xe=>({...xe,[I]:ce}))},R=(ie,I,ce)=>{const xe=[...F.default_parameters],le=xe[ie];if(I==="type")switch(le.type=ce,ce){case"number":le.defaultValue=0,le.lower_limit=null,le.upper_limit=null,le.unit="";break;case"boolean":le.defaultValue=!1,le.lower_limit=void 0,le.upper_limit=void 0,le.unit=void 0;break;case"string":default:le.defaultValue="",le.lower_limit=void 0,le.upper_limit=void 0,le.unit=void 0;break}else I==="defaultValue"?le.type==="number"?le.defaultValue=parseFloat(ce)||0:(le.type,le.defaultValue=ce):I==="lower_limit"||I==="upper_limit"?le[I]=ce===""?null:parseFloat(ce):le[I]=ce;z(ge=>({...ge,default_parameters:xe}))},O=()=>{z(ie=>({...ie,default_parameters:[...ie.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},$=ie=>{z(I=>({...I,default_parameters:I.default_parameters.filter((ce,xe)=>xe!==ie)}))},W=async ie=>{ie.preventDefault(),r(!0),l(null);const I=M!==null,ce=I?`/api/lab-tests/${M}`:"/api/lab-tests",xe=I?"PUT":"POST";try{const le=await ue(ce,{method:xe,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:F.name,description:F.description,price:parseFloat(F.price),default_parameters:F.default_parameters})});if(!le.ok){const ge=await le.json();throw new Error(ge.message||`HTTP error! status: ${le.status}`)}D(!1),V(null),z({name:"",description:"",price:"",default_parameters:[]}),B()}catch(le){console.error(`Error ${I?"updating":"adding"} lab test:`,le),l(le.message||`Failed to ${I?"update":"add"} lab test.`)}finally{r(!1)}},te=()=>{V(null),z({name:"",description:"",price:"",default_parameters:[]}),D(!0)},ne=ie=>{if(M===ie.id)V(null);else{V(ie.id);const I=(ie.default_parameters||[]).map(ce=>({...ce,unit:ce.unit||"",lower_limit:ce.lower_limit===void 0?null:ce.lower_limit,upper_limit:ce.upper_limit===void 0?null:ce.upper_limit}));z({name:ie.name,description:ie.description||"",price:ie.price,default_parameters:I}),D(!1)}},re=async ie=>{if(window.confirm("Are you sure you want to delete this lab test?")){r(!0),l(null);try{const I=await ue(`/api/lab-tests/${ie}`,{method:"DELETE"});if(!I.ok){const ce=await I.json();throw new Error(ce.message||`HTTP error! status: ${I.status}`)}B()}catch(I){console.error("Error deleting lab test:",I),l(I.message||"Failed to delete lab test.")}finally{r(!1)}}},J=()=>{D(!1),V(null),l(null),z({name:"",description:"",price:"",default_parameters:[]})},q=async ie=>{if(!ie){d("No file selected.");return}f(!0),d(null),l(null);const I=new FormData;I.append("file",ie);try{const ce=await ue("/api/lab-tests/import",{method:"POST",body:I});if(!ce.ok){const xe=await ce.json();throw new Error(xe.message||`Import failed: ${ce.statusText}`)}B()}catch(ce){console.error("Error importing lab tests from Excel:",ce),d(ce.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},H=async ie=>{if(ie.target.files&&ie.target.files[0]){const I=ie.target.files[0];await q(I),ie.target&&(ie.target.value="")}},ee=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){b(!0),N(null),l(null);try{const ie=await ue("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!ie.ok){const I=await ie.json();throw new Error(I.message||`Default import failed: ${ie.statusText}`)}B()}catch(ie){console.error("Error importing default lab tests:",ie),N(ie.message||"Failed to import default lab tests.")}finally{b(!1)}}},E=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){A(!0),l(null),d(null),N(null);try{const ie=await ue("/api/lab-tests/all",{method:"DELETE"});if(!ie.ok){const I=await ie.json();throw new Error(I.message||`Delete all failed: ${ie.statusText}`)}B()}catch(ie){console.error("Error deleting all lab tests:",ie),l(ie.message||"Failed to delete all lab tests.")}finally{A(!1)}}},Q=t||o||g||C;return i.jsxs("div",{className:"lab-inventory-card",children:[i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:te,className:"lab-inventory-button",disabled:Q,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var ie;return(ie=h.current)==null?void 0:ie.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:Q,children:o?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:h,onChange:H,accept:".xlsx, .xls",style:{display:"none"},disabled:o}),i.jsx("button",{onClick:ee,className:"lab-inventory-button lab-inventory-button-secondary",disabled:Q,children:g?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-danger",disabled:Q,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:C?"Deleting All...":"Delete All Tests"})]}),a&&i.jsx("div",{className:"error-text mb-4",children:a}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),v&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",v]}),T&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:W,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:U,className:"lab-inventory-input",required:!0,disabled:Q})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:U,rows:3,className:"lab-inventory-input",disabled:Q})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:U,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:Q})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),F.default_parameters.map((ie,I)=>{var ce,xe;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:ie.name,onChange:le=>R(I,"name",le.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:ie.type,onChange:le=>R(I,"type",le.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),ie.type==="boolean"?i.jsxs("select",{value:ie.defaultValue.toString(),onChange:le=>R(I,"defaultValue",le.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:ie.type==="number"?"number":"text",placeholder:"Default Value",value:ie.defaultValue.toString(),onChange:le=>R(I,"defaultValue",le.target.value),className:"lab-inventory-input"}),ie.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:ie.lower_limit===null?"":((ce=ie.lower_limit)==null?void 0:ce.toString())??"",onChange:le=>R(I,"lower_limit",le.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:ie.upper_limit===null?"":((xe=ie.upper_limit)==null?void 0:xe.toString())??"",onChange:le=>R(I,"upper_limit",le.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:ie.unit||"",onChange:le=>R(I,"unit",le.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>$(I),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},I)}),i.jsx("button",{type:"button",onClick:O,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:J,className:"lab-inventory-button lab-inventory-button-secondary",disabled:Q,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:Q,children:t?"Saving...":"Add Test"})]})]})]}),Q&&!T&&i.jsxs("p",{className:"loading-text",children:[" ",o?"Importing Excel data...":g?"Importing default data...":"Loading tests..."]}),!Q&&e.length===0&&!a&&!u&&!v&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!Q&&e.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:e.map(ie=>{const I=M===ie.id,ce=ie.price&&typeof ie.price=="string"?parseFloat(ie.price):NaN,xe=isNaN(ce)?"0.00":ce.toFixed(2);return i.jsxs(qn.Fragment,{children:[i.jsxs("tr",{onClick:()=>ne(ie),style:{cursor:"pointer"},children:[i.jsx("td",{children:ie.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:ie.description||"-"}),i.jsxs("td",{children:["",xe]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:le=>{le.stopPropagation(),ne(ie)},className:"lab-inventory-link",disabled:Q,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:le=>{le.stopPropagation(),re(ie.id)},className:"lab-inventory-link",disabled:Q,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),I&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:W,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:U,className:"lab-inventory-input",required:!0,disabled:Q})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:U,rows:3,className:"lab-inventory-input",disabled:Q})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:U,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:Q})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),F.default_parameters.map((le,ge)=>{var ye,Re;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:le.name,onChange:Ze=>R(ge,"name",Ze.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:le.type,onChange:Ze=>R(ge,"type",Ze.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),le.type==="boolean"?i.jsxs("select",{value:le.defaultValue.toString(),onChange:Ze=>R(ge,"defaultValue",Ze.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:le.type==="number"?"number":"text",placeholder:"Default Value",value:le.defaultValue.toString(),onChange:Ze=>R(ge,"defaultValue",Ze.target.value),className:"lab-inventory-input"}),le.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:le.lower_limit===null?"":((ye=le.lower_limit)==null?void 0:ye.toString())??"",onChange:Ze=>R(ge,"lower_limit",Ze.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:le.upper_limit===null?"":((Re=le.upper_limit)==null?void 0:Re.toString())??"",onChange:Ze=>R(ge,"upper_limit",Ze.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:le.unit||"",onChange:Ze=>R(ge,"unit",Ze.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>$(ge),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},ge)}),i.jsx("button",{type:"button",onClick:O,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:J,className:"lab-inventory-button lab-inventory-button-secondary",disabled:Q,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:Q,children:t?"Saving...":"Update Test"})]})]})]})})})]},ie.id)})})]})]})]})},qC=6048e5,QI=864e5,VC=6e4,HC=36e5,TN=Symbol.for("constructDateFrom");function sl(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&TN in e?e[TN](n):e instanceof Date?new e.constructor(n):new Date(n)}function Ur(e,n){return sl(n||e,e)}function Qv(e,n,t){const r=Ur(e,t==null?void 0:t.in);if(isNaN(n))return sl(e,NaN);if(!n)return r;const a=r.getDate(),l=sl(e,r.getTime());l.setMonth(r.getMonth()+n+1,0);const o=l.getDate();return a>=o?l:(r.setFullYear(l.getFullYear(),l.getMonth(),a),r)}let JI={};function kb(){return JI}function ng(e,n){var f,u,d,h;const t=kb(),r=(n==null?void 0:n.weekStartsOn)??((u=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:u.weekStartsOn)??t.weekStartsOn??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,a=Ur(e,n==null?void 0:n.in),l=a.getDay(),o=(l<r?7:0)+l-r;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function nb(e,n){return ng(e,{...n,weekStartsOn:1})}function GC(e,n){const t=Ur(e,n==null?void 0:n.in),r=t.getFullYear(),a=sl(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const l=nb(a),o=sl(t,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const f=nb(o);return t.getTime()>=l.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function EN(e){const n=Ur(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function KI(e,...n){const t=sl.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function AN(e,n){const t=Ur(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function XI(e,n,t){const[r,a]=KI(t==null?void 0:t.in,e,n),l=AN(r),o=AN(a),f=+l-EN(l),u=+o-EN(o);return Math.round((f-u)/QI)}function ZI(e,n){const t=GC(e,n),r=sl(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),nb(r)}function e4(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ig(e){return!(!e4(e)&&typeof e!="number"||isNaN(+Ur(e)))}function t4(e,n){const t=Ur(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const n4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},i4=(e,n,t)=>{let r;const a=n4[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function G0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const r4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},a4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},s4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},l4={date:G0({formats:r4,defaultWidth:"full"}),time:G0({formats:a4,defaultWidth:"full"}),dateTime:G0({formats:s4,defaultWidth:"full"})},o4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},c4=(e,n,t,r)=>o4[e];function Mm(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,f=t!=null&&t.width?String(t.width):o;a=e.formattingValues[f]||e.formattingValues[o]}else{const o=e.defaultWidth,f=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[f]||e.values[o]}const l=e.argumentCallback?e.argumentCallback(n):n;return a[l]}}const u4={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},d4={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},f4={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},h4={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},p4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},m4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},g4=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},y4={ordinalNumber:g4,era:Mm({values:u4,defaultWidth:"wide"}),quarter:Mm({values:d4,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Mm({values:f4,defaultWidth:"wide"}),day:Mm({values:h4,defaultWidth:"wide"}),dayPeriod:Mm({values:p4,defaultWidth:"wide",formattingValues:m4,defaultFormattingWidth:"wide"})};function Im(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],l=n.match(a);if(!l)return null;const o=l[0],f=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(f)?b4(f,g=>g.test(o)):x4(f,g=>g.test(o));let d;d=e.valueCallback?e.valueCallback(u):u,d=t.valueCallback?t.valueCallback(d):d;const h=n.slice(o.length);return{value:d,rest:h}}}function x4(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function b4(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function v4(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],l=n.match(e.parsePattern);if(!l)return null;let o=e.valueCallback?e.valueCallback(l[0]):l[0];o=t.valueCallback?t.valueCallback(o):o;const f=n.slice(a.length);return{value:o,rest:f}}}const w4=/^(\d+)(th|st|nd|rd)?/i,N4=/\d+/i,S4={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},j4={any:[/^b/i,/^(a|c)/i]},_4={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},C4={any:[/1/i,/2/i,/3/i,/4/i]},k4={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},T4={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},E4={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},A4={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},P4={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},D4={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},M4={ordinalNumber:v4({matchPattern:w4,parsePattern:N4,valueCallback:e=>parseInt(e,10)}),era:Im({matchPatterns:S4,defaultMatchWidth:"wide",parsePatterns:j4,defaultParseWidth:"any"}),quarter:Im({matchPatterns:_4,defaultMatchWidth:"wide",parsePatterns:C4,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Im({matchPatterns:k4,defaultMatchWidth:"wide",parsePatterns:T4,defaultParseWidth:"any"}),day:Im({matchPatterns:E4,defaultMatchWidth:"wide",parsePatterns:A4,defaultParseWidth:"any"}),dayPeriod:Im({matchPatterns:P4,defaultMatchWidth:"any",parsePatterns:D4,defaultParseWidth:"any"})},I4={code:"en-US",formatDistance:i4,formatLong:l4,formatRelative:c4,localize:y4,match:M4,options:{weekStartsOn:0,firstWeekContainsDate:1}};function R4(e,n){const t=Ur(e,n==null?void 0:n.in);return XI(t,t4(t))+1}function L4(e,n){const t=Ur(e,n==null?void 0:n.in),r=+nb(t)-+ZI(t);return Math.round(r/qC)+1}function YC(e,n){var h,g,b,v;const t=Ur(e,n==null?void 0:n.in),r=t.getFullYear(),a=kb(),l=(n==null?void 0:n.firstWeekContainsDate)??((g=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,o=sl((n==null?void 0:n.in)||e,0);o.setFullYear(r+1,0,l),o.setHours(0,0,0,0);const f=ng(o,n),u=sl((n==null?void 0:n.in)||e,0);u.setFullYear(r,0,l),u.setHours(0,0,0,0);const d=ng(u,n);return+t>=+f?r+1:+t>=+d?r:r-1}function O4(e,n){var f,u,d,h;const t=kb(),r=(n==null?void 0:n.firstWeekContainsDate)??((u=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:u.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,a=YC(e,n),l=sl((n==null?void 0:n.in)||e,0);return l.setFullYear(a,0,r),l.setHours(0,0,0,0),ng(l,n)}function F4(e,n){const t=Ur(e,n==null?void 0:n.in),r=+ng(t,n)-+O4(t,n);return Math.round(r/qC)+1}function ti(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const Zc={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return ti(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):ti(t+1,2)},d(e,n){return ti(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return ti(e.getHours()%12||12,n.length)},H(e,n){return ti(e.getHours(),n.length)},m(e,n){return ti(e.getMinutes(),n.length)},s(e,n){return ti(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return ti(a,n.length)}},vh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},PN={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return Zc.y(e,n)},Y:function(e,n,t,r){const a=YC(e,r),l=a>0?a:1-a;if(n==="YY"){const o=l%100;return ti(o,2)}return n==="Yo"?t.ordinalNumber(l,{unit:"year"}):ti(l,n.length)},R:function(e,n){const t=GC(e);return ti(t,n.length)},u:function(e,n){const t=e.getFullYear();return ti(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return ti(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return ti(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return Zc.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return ti(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=F4(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):ti(a,n.length)},I:function(e,n,t){const r=L4(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):ti(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):Zc.d(e,n)},D:function(e,n,t){const r=R4(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):ti(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),l=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(l);case"ee":return ti(l,2);case"eo":return t.ordinalNumber(l,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),l=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(l);case"cc":return ti(l,n.length);case"co":return t.ordinalNumber(l,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return ti(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=vh.noon:r===0?a=vh.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=vh.evening:r>=12?a=vh.afternoon:r>=4?a=vh.morning:a=vh.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Zc.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):Zc.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):ti(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):ti(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):Zc.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):Zc.s(e,n)},S:function(e,n){return Zc.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return MN(r);case"XXXX":case"XX":return Ld(r);case"XXXXX":case"XXX":default:return Ld(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return MN(r);case"xxxx":case"xx":return Ld(r);case"xxxxx":case"xxx":default:return Ld(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+DN(r,":");case"OOOO":default:return"GMT"+Ld(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+DN(r,":");case"zzzz":default:return"GMT"+Ld(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return ti(r,n.length)},T:function(e,n,t){return ti(+e,n.length)}};function DN(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),l=r%60;return l===0?t+String(a):t+String(a)+n+ti(l,2)}function MN(e,n){return e%60===0?(e>0?"-":"+")+ti(Math.abs(e)/60,2):Ld(e,n)}function Ld(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=ti(Math.trunc(r/60),2),l=ti(r%60,2);return t+a+n+l}const IN=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},WC=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},$4=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return IN(e,n);let l;switch(r){case"P":l=n.dateTime({width:"short"});break;case"PP":l=n.dateTime({width:"medium"});break;case"PPP":l=n.dateTime({width:"long"});break;case"PPPP":default:l=n.dateTime({width:"full"});break}return l.replace("{{date}}",IN(r,n)).replace("{{time}}",WC(a,n))},z4={p:WC,P:$4},B4=/^D+$/,U4=/^Y+$/,q4=["D","DD","YY","YYYY"];function V4(e){return B4.test(e)}function H4(e){return U4.test(e)}function G4(e,n,t){const r=Y4(e,n,t);if(console.warn(r),q4.includes(e))throw new RangeError(r)}function Y4(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const W4=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Q4=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,J4=/^'([^]*?)'?$/,K4=/''/g,X4=/[a-zA-Z]/;function Bh(e,n,t){var h,g,b,v;const r=kb(),a=r.locale??I4,l=r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,o=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,f=Ur(e,t==null?void 0:t.in);if(!ig(f))throw new RangeError("Invalid time value");let u=n.match(Q4).map(N=>{const C=N[0];if(C==="p"||C==="P"){const A=z4[C];return A(N,a.formatLong)}return N}).join("").match(W4).map(N=>{if(N==="''")return{isToken:!1,value:"'"};const C=N[0];if(C==="'")return{isToken:!1,value:Z4(N)};if(PN[C])return{isToken:!0,value:N};if(C.match(X4))throw new RangeError("Format string contains an unescaped latin alphabet character `"+C+"`");return{isToken:!1,value:N}});a.localize.preprocessor&&(u=a.localize.preprocessor(f,u));const d={firstWeekContainsDate:l,weekStartsOn:o,locale:a};return u.map(N=>{if(!N.isToken)return N.value;const C=N.value;(H4(C)||V4(C))&&G4(C,n,String(e));const A=PN[C[0]];return A(f,C,a.localize,d)}).join("")}function Z4(e){const n=e.match(J4);return n?n[1].replace(K4,"'"):e}function $d(e,n){return+Ur(e)<+Ur(n)}function ib(e,n){const t=()=>sl(n==null?void 0:n.in,NaN),a=iR(e);let l;if(a.date){const d=rR(a.date,2);l=aR(d.restDateString,d.year)}if(!l||isNaN(+l))return t();const o=+l;let f=0,u;if(a.time&&(f=sR(a.time),isNaN(f)))return t();if(a.timezone){if(u=lR(a.timezone),isNaN(u))return t()}else{const d=new Date(o+f),h=Ur(0,n==null?void 0:n.in);return h.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),h.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),h}return Ur(o+f+u,n==null?void 0:n.in)}const xx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},eR=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,tR=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,nR=/^([+-])(\d{2})(?::?(\d{2}))?$/;function iR(e){const n={},t=e.split(xx.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],xx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(xx.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=xx.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function rR(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,l=r[2]?parseInt(r[2]):null;return{year:l===null?a:l*100,restDateString:e.slice((r[1]||r[2]).length)}}function aR(e,n){if(n===null)return new Date(NaN);const t=e.match(eR);if(!t)return new Date(NaN);const r=!!t[4],a=Rm(t[1]),l=Rm(t[2])-1,o=Rm(t[3]),f=Rm(t[4]),u=Rm(t[5])-1;if(r)return fR(n,f,u)?oR(n,f,u):new Date(NaN);{const d=new Date(0);return!uR(n,l,o)||!dR(n,a)?new Date(NaN):(d.setUTCFullYear(n,l,Math.max(a,o)),d)}}function Rm(e){return e?parseInt(e):1}function sR(e){const n=e.match(tR);if(!n)return NaN;const t=Y0(n[1]),r=Y0(n[2]),a=Y0(n[3]);return hR(t,r,a)?t*HC+r*VC+a*1e3:NaN}function Y0(e){return e&&parseFloat(e.replace(",","."))||0}function lR(e){if(e==="Z")return 0;const n=e.match(nR);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return pR(r,a)?t*(r*HC+a*VC):NaN}function oR(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,l=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+l),r}const cR=[31,null,31,30,31,30,31,31,30,31,30,31];function QC(e){return e%400===0||e%4===0&&e%100!==0}function uR(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(cR[n]||(QC(e)?29:28))}function dR(e,n){return n>=1&&n<=(QC(e)?366:365)}function fR(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function hR(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function pR(e,n){return n>=0&&n<=59}const RN=10,mR=3,JC=()=>{const e=Mt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[l,o]=w.useState(""),[f,u]=w.useState(!0),[d,h]=w.useState(null),[g,b]=w.useState(new Set),[v,N]=w.useState("all"),C=async()=>{try{const oe=await ue("/api/inventory/download-csv");if(!oe.ok)throw new Error(`Failed to download CSV: ${oe.statusText}`);const K=await oe.blob(),fe=window.URL.createObjectURL(K),Ae=document.createElement("a");Ae.href=fe,Ae.download="pharmacy_inventory.csv",document.body.appendChild(Ae),Ae.click(),Ae.remove(),window.URL.revokeObjectURL(fe)}catch(oe){console.error("Failed to download CSV:",oe),h(oe.message||"Failed to download inventory CSV. Please try again.")}},[A,T]=w.useState(!1),[D,M]=w.useState(!1),[V,F]=w.useState(null),[z,B]=w.useState(!1),[U,R]=w.useState(new Set),[O,$]=w.useState(null),[W,te]=w.useState(0),[ne,re]=w.useState(!1),[J,q]=w.useState(null),[H,ee]=w.useState(1),[E,Q]=w.useState(!1),ie=w.useCallback(async()=>{u(!0),h(null);try{const oe=await ue("/api/drugs");if(!oe.ok)throw new Error(`Failed to fetch drugs: ${oe.statusText} (${oe.status})`);let K=await oe.json();K=K.map(fe=>({...fe,price:parseFloat(String(fe.price))||0,buying_price:fe.buying_price!==null&&fe.buying_price!==void 0?parseFloat(String(fe.buying_price)):null,quantity_in_stock:parseInt(String(fe.quantity_in_stock),10)||0,gst:fe.gst!==null&&fe.gst!==void 0?parseFloat(String(fe.gst)):null,margin:fe.margin!==null&&fe.margin!==void 0?parseFloat(String(fe.margin)):null,discount:fe.discount!==null&&fe.discount!==void 0?parseFloat(String(fe.discount)):null})),t(K),a(K)}catch(oe){console.error("Failed to fetch drugs:",oe),h(oe.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{ie()},[ie]),w.useEffect(()=>{const oe=l.toLowerCase();let K=n.filter(Ie=>{var nt,Ve,ht,Se,qe;const Ye=((nt=Ie.name)==null?void 0:nt.toLowerCase())||"",ft=((Ve=Ie.description)==null?void 0:Ve.toLowerCase())||"",gt=((ht=Ie.supplier)==null?void 0:ht.toLowerCase())||"",jt=((Se=Ie.box_number)==null?void 0:Se.toLowerCase())||"",$e=((qe=Ie.brand_name)==null?void 0:qe.toLowerCase())||"";return Ye.includes(oe)||ft.includes(oe)||gt.includes(oe)||jt.includes(oe)||$e.includes(oe)});const fe=new Date,Ae=Qv(fe,mR);v==="low-stock"?K=K.filter(Ie=>Ie.quantity_in_stock<=RN):v==="near-expiry"?K=K.filter(Ie=>{if(!Ie.expiry_date)return!1;const Ye=ib(Ie.expiry_date);return ig(Ye)&&$d(Ye,Ae)&&!$d(Ye,fe)}):v==="expired"&&(K=K.filter(Ie=>{if(!Ie.expiry_date)return!1;const Ye=ib(Ie.expiry_date);return ig(Ye)&&$d(Ye,fe)})),a(K)},[l,n,v]);const I=()=>{T(!1),$(null)},ce=oe=>{te(parseInt(oe.target.value,10)||0)},xe=async oe=>{if(oe.preventDefault(),h(null),!O||!O.id||W===0){h("No drug selected or adjustment amount is zero.");return}try{const K=await ue(`/api/drugs/${O.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:W})});if(!K.ok){const Ae=await K.json();throw new Error(Ae.message||`Failed to adjust stock: ${K.statusText}`)}const fe=await K.json();t(Ae=>Ae.map(Ie=>Ie.id===fe.id?fe:Ie)),I(),alert(`Stock for "${fe.name}" adjusted successfully. New stock: ${fe.quantity_in_stock}`)}catch(K){console.error("Failed to adjust stock:",K),h(K.message||"Failed to adjust stock. Please try again.")}},le=oe=>{F(oe),M(!0)},ge=()=>{M(!1),F(null)},ye=async()=>{if(!V||!V.id){h("No drug selected for deletion.");return}u(!0),h(null);try{const oe=await ue(`/api/drugs/${V.id}`,{method:"DELETE"});if(!oe.ok){const K=await oe.json();throw new Error(K.message||`Failed to delete drug: ${oe.statusText}`)}alert(`Drug "${V.name}" deleted successfully.`),ie(),ge()}catch(oe){console.error("Failed to delete drug:",oe),h(oe.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},Re=()=>{B(!0)},Ze=()=>{B(!1)},[at,Le]=w.useState(!1),Te=()=>{U.size>0&&Le(!0)},we=()=>{Le(!1)},Fe=async()=>{if(U.size===0){h("No drugs selected for deletion.");return}u(!0),h(null);try{const oe=await ue("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(U)})});if(!oe.ok){const K=await oe.json();throw new Error(K.message||`Failed to delete selected drugs: ${oe.statusText}`)}alert(`${U.size} drug(s) deleted successfully.`),ie(),R(new Set),we()}catch(oe){console.error("Failed to delete selected drugs:",oe),h(oe.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},Xe=async()=>{u(!0),h(null);try{const oe=await ue("/api/drugs/all",{method:"DELETE"});if(!oe.ok){const K=await oe.json();throw new Error(K.message||`Failed to delete all drugs: ${oe.statusText}`)}alert("All drugs deleted successfully."),ie(),Ze()}catch(oe){console.error("Failed to delete all drugs:",oe),h(oe.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},it=oe=>{if(!oe)return null;const K=oe.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return K?parseInt(K[1],10):null},je=oe=>{q(oe),ee(1),re(!0)},Ke=()=>{re(!1),q(null),ee(1)},ze=oe=>{ee(parseInt(oe.target.value,10)||0)},ct=async oe=>{if(oe.preventDefault(),h(null),!J||!J.id||H<=0){h("No drug selected or invalid number of packs to convert.");return}const K=it(J.unit);if(!K||K<=0){h(`Cannot convert "${J.name}" to loose. Invalid pack unit: ${J.unit||"N/A"}.`);return}if(H>(J.quantity_in_stock??0)){h(`Cannot convert ${H} packs. Only ${J.quantity_in_stock??0} packs are in stock.`);return}try{const fe=await ue(`/api/drugs/${J.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:H,packSize:K})});if(!fe.ok){const Ie=await fe.json();throw new Error(Ie.message||`Failed to convert to loose: ${fe.statusText}`)}const Ae=await fe.json();t(Ie=>Ie.map(Ye=>Ye.id===Ae.id?Ae:Ye)),Ke(),alert(`Converted ${H} pack(s) of "${Ae.name}" to loose. New stock: ${Ae.quantity_in_stock} packs, ${Ae.loose??0} loose units.`)}catch(fe){console.error("Failed to convert to loose:",fe),h(fe.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},Tt=()=>{Q(!0)},bt=()=>{Q(!1)},en=async()=>{u(!0),h(null);try{const oe=await ue("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!oe.ok){const K=await oe.json();throw new Error(K.message||`Failed to add default medications: ${oe.statusText}`)}alert("Default medications added successfully."),ie(),bt()}catch(oe){console.error("Failed to add default medications:",oe),h(oe.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):d?i.jsxs("div",{className:"error-indicator",children:["Error: ",d]}):i.jsxs("div",{className:"pharmacy-inventory-page",children:[i.jsxs("div",{className:"inventory-header-controls",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:i.jsx(an,{size:24})}),i.jsx("h2",{className:"inventory-page-title",children:"Pharmacy Inventory"})]}),i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",children:[i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-drug-button",children:[i.jsx(Yo,{size:18,className:"button-icon"}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-purchase-button",children:[i.jsx(Yo,{size:18,className:"button-icon"}),"Open Purchase Page"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"action-button view-distributors-button",children:[i.jsx(Yo,{size:18,className:"button-icon"}),"View Distributors"]})]}),i.jsxs("div",{className:"action-group-right",children:[i.jsx("button",{onClick:C,className:"action-button download-csv-button",children:"Download CSV"}),i.jsxs("button",{onClick:Tt,className:"action-button add-defaults-button",children:[i.jsx(Yo,{size:18,className:"button-icon"}),"Add Default Medications"]}),i.jsxs("button",{onClick:Te,className:"action-button delete-selected-drugs-button",disabled:U.size===0,children:[i.jsx(Pi,{size:18,className:"button-icon"}),"Delete Selected (",U.size,")"]}),i.jsxs("button",{onClick:Re,className:"action-button delete-all-drugs-button",children:[i.jsx(Pi,{size:18,className:"button-icon"}),"Delete All Drugs"]})]})]})]}),i.jsxs("div",{className:"search-bar-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drugs by name, brand, description, or supplier...",value:l,onChange:oe=>o(oe.target.value),className:"inventory-search-input"}),i.jsx(Ci,{size:18,className:"search-input-icon"})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"filter-option",className:"sr-only",children:"Filter Inventory"}),i.jsxs("select",{id:"filter-option",value:v,onChange:oe=>N(oe.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:oe=>{if(oe.target.checked){const K=new Set(r.map(fe=>fe.id));R(K)}else R(new Set)},checked:U.size===r.length&&r.length>0,disabled:r.length===0})}),i.jsx("th",{className:"drug-name-header",children:"Drug Name"}),i.jsx("th",{className:"brand-name-header",children:"Brand Name"}),i.jsx("th",{className:"pack-header",children:"Pack"}),i.jsx("th",{className:"expiry-header",children:"Expiry"}),i.jsx("th",{className:"text-stock qty-header",children:"Stock"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"Rate"}),i.jsx("th",{className:"box-number-header",children:"Box Number"}),i.jsx("th",{className:"discount-header",children:"Discount (%)"}),i.jsx("th",{className:"margin-header",children:"Margin (%)"}),i.jsx("th",{className:"hidden-loose-price",children:"Loose Price"}),i.jsx("th",{className:"actions-cell",children:"Actions"}),i.jsx("th",{className:"expand-collapse-header"})]})}),i.jsxs("tbody",{children:[r.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:15,children:"No drugs found matching your search."})}),r.map(oe=>i.jsxs(i.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const K=new Set(g);K.has(oe.id)&&oe.id!==void 0?K.delete(oe.id):oe.id!==void 0&&K.add(oe.id),b(K)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:K=>K.stopPropagation(),checked:U.has(oe.id),onChange:()=>{const K=new Set(U);K.has(oe.id)?K.delete(oe.id):K.add(oe.id),R(K)}})}),i.jsx("td",{className:"drug-name-cell",children:oe.name||"-"}),i.jsx("td",{className:"brand-name-cell",children:oe.brand_name||"-"}),i.jsx("td",{className:"text-muted pack-cell",children:oe.unit||"-"}),i.jsx("td",{className:"text-muted",children:oe.expiry_date?new Date(oe.expiry_date).toLocaleDateString():"-"}),i.jsxs("td",{className:`text-stock ${oe.quantity_in_stock<=RN?"low-stock":""}`,children:[i.jsxs("div",{children:[oe.quantity_in_stock," packs"]}),i.jsx("div",{className:"loose-quantity",children:oe.loose!==null&&oe.loose!==void 0?`${oe.loose} loose`:""})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof oe.price=="number"?oe.price.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:oe.buying_price!==null&&oe.buying_price!==void 0?`${oe.buying_price.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:oe.box_number||"-"}),i.jsx("td",{className:"text-muted",children:oe.discount!==null&&oe.discount!==void 0?`${oe.discount.toFixed(2)}%`:"-"}),i.jsx("td",{className:"text-muted",children:(()=>{const K=oe.price||0,fe=oe.buying_price||0,Ae=oe.discount||0,Ie=oe.gst||0,ft=fe*(1-Ae/100)*(1+Ie/100),gt=K-ft;return`${(K>0?gt/K*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"text-muted hidden-loose-price",children:(()=>{const K=it(oe.unit);return K&&K>0&&typeof oe.price=="number"?`${(oe.price/K).toFixed(2)}`:"N/A"})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:()=>e(`/dashboard/inventory/edit/${oe.id}`),className:"action-icon-button",title:"Edit Drug",children:i.jsx(du,{size:18})}),i.jsx("button",{onClick:()=>le(oe),className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(Pi,{size:18})}),i.jsx("button",{onClick:()=>{$(oe),T(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(YD,{size:18})}),i.jsx("button",{onClick:()=>je(oe),className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!oe.unit||it(oe.unit)===null,children:i.jsx(DM,{size:18})})]})}),i.jsx("td",{className:"expand-collapse-cell",children:g.has(oe.id)?i.jsx(Yv,{size:20}):i.jsx(Zx,{size:20})})]},oe.id),g.has(oe.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:15,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Drug Name:"})," ",oe.name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",oe.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",oe.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Brand Name:"})," ",oe.brand_name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",oe.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",oe.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",oe.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose:"})," ",oe.loose!==null&&oe.loose!==void 0?oe.loose:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const K=it(oe.unit);return K&&K>0&&typeof oe.price=="number"?`${(oe.price/K).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",oe.gst!==null&&oe.gst!==void 0?`${oe.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Discount:"})," ",oe.discount!==null&&oe.discount!==void 0?`${oe.discount.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Calculated Margin:"}),(()=>{const K=oe.price||0,fe=oe.buying_price||0,Ae=oe.discount||0,Ie=oe.gst||0,ft=fe*(1-Ae/100)*(1+Ie/100),gt=K-ft;return`${(K>0?gt/K*100:0).toFixed(2)}%`})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(oe.last_updated).toLocaleString()]})]})})})]}))]})]})}),D&&V&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ge,className:"modal-close-button",children:i.jsx(gi,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:V.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ge,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:ye,className:"button-delete",children:"Delete"})]})]})}),A&&O&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:I,className:"modal-close-button",children:i.jsx(gi,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:O.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",O.quantity_in_stock]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("form",{onSubmit:xe,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:W,onChange:ce,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:I,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),z&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ze,className:"modal-close-button",children:i.jsx(gi,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ze,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Xe,className:"button-delete",children:"Delete All"})]})]})}),at&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:we,className:"modal-close-button",children:i.jsx(gi,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:U.size})," selected drug(s)? This action cannot be undone."]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:we,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Fe,className:"button-delete",children:"Delete Selected"})]})]})}),ne&&J&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ke,className:"modal-close-button",children:i.jsx(gi,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert Pack to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:J.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Packs in Stock: ",J.quantity_in_stock??0,i.jsx("br",{}),"Current Loose Units: ",J.loose??0,i.jsx("br",{}),"Pack Size: ",it(J.unit)||"N/A"," units per pack"]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("form",{onSubmit:ct,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packs-to-convert",className:"form-label",children:"Number of Packs to Convert"}),i.jsx("input",{type:"number",name:"packs-to-convert",id:"packs-to-convert",required:!0,min:"1",step:"1",value:H,onChange:ze,placeholder:"e.g., 1",className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["This will reduce pack quantity by ",H," and add ",H*(it(J.unit)||0)," to loose quantity."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ke,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert to Loose"})]})]})]})}),E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:bt,className:"modal-close-button",children:i.jsx(gi,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:bt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:en,className:"button-submit",children:"Add Defaults"})]})]})})]})},gR="_container_1ihgb_1",yR="_title_1ihgb_17",xR="_dateRangeContainer_1ihgb_31",bR="_dateInputLabel_1ihgb_51",vR="_dateInput_1ihgb_51",wR="_fetchButton_1ihgb_87",NR="_sectionTitle_1ihgb_123",SR="_tableContainer_1ihgb_137",jR="_analysisTable_1ihgb_153",_R="_textRight_1ihgb_217",CR="_textGreen_1ihgb_225",kR="_textRed_1ihgb_233",TR="_textOrange_1ihgb_249",ER="_alertBox_1ihgb_265",AR="_alertBoxError_1ihgb_283",PR="_alertBoxIcon_1ihgb_295",DR="_loadingContainer_1ihgb_303",MR="_viewSwitcher_1ihgb_321",IR="_viewButton_1ihgb_339",RR="_viewButtonActive_1ihgb_365",LR="_viewButtonInactive_1ihgb_383",OR="_reasonDistribution_1ihgb_497",FR="_totalRow_1ihgb_513",un={container:gR,title:yR,dateRangeContainer:xR,dateInputLabel:bR,dateInput:vR,fetchButton:wR,sectionTitle:NR,tableContainer:SR,analysisTable:jR,textRight:_R,textGreen:CR,textRed:kR,textOrange:TR,alertBox:ER,alertBoxError:AR,alertBoxIcon:PR,loadingContainer:DR,viewSwitcher:MR,viewButton:IR,viewButtonActive:RR,viewButtonInactive:LR,reasonDistribution:OR,totalRow:FR},Jv=()=>{const e=Mt(),n=new Date().toISOString().split("T")[0],[t,r]=w.useState(n),[a,l]=w.useState(n),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState("analysis"),N=async()=>{if(d(!0),g(null),f(null),!t||!a){g("Please select both start and end dates."),d(!1);return}if(new Date(t)>new Date(a)){g("Start date cannot be after end date."),d(!1);return}try{const T=WI();if(!T){g("Clinic ID not found. Please log in again."),d(!1);return}const D=await ue(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${T}`);if(!D.ok){const V=await D.json();throw new Error(V.message||`HTTP error! status: ${D.status}`)}const M=await D.json();f(M)}catch(T){console.error("Failed to fetch comprehensive inventory analysis data:",T),g(T.message||"Failed to fetch data. Check console for details.")}finally{d(!1)}},C=()=>{N()},A=T=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(T);return i.jsxs("div",{className:un.container,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[" ",i.jsx("h2",{className:un.title,children:"Inventory Analysis & Management"}),i.jsx("button",{onClick:()=>e(-1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 text-sm",children:"Back"})]}),i.jsxs("div",{className:un.viewSwitcher,children:[i.jsxs("button",{onClick:()=>v("analysis"),className:`${un.viewButton} ${b==="analysis"?un.viewButtonActive:un.viewButtonInactive}`,children:[i.jsx(FD,{size:16})," ","Analysis"]}),i.jsxs("button",{onClick:()=>v("labInventory"),className:`${un.viewButton} ${b==="labInventory"?un.viewButtonActive:un.viewButtonInactive}`,children:[i.jsx(rw,{size:16}),"Lab Test Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:`${un.viewButton} ${b==="pharmacyInventory"?un.viewButtonActive:un.viewButtonInactive}`,children:[i.jsx(Xo,{size:16}),"Pharmacy Inventory"]})]}),b==="analysis"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:un.dateRangeContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-inventory",className:un.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-inventory",value:t,onChange:T=>r(T.target.value),className:un.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-inventory",className:un.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-inventory",value:a,onChange:T=>l(T.target.value),className:un.dateInput})]}),i.jsx("button",{onClick:C,disabled:u,className:un.fetchButton,children:u?"Loading...":"Fetch Comprehensive Analysis"})]}),h&&i.jsxs("div",{className:`${un.alertBox} ${un.alertBoxError}`,role:"alert",children:[i.jsx("div",{className:un.alertBoxIcon,children:i.jsx(ni,{size:18})}),i.jsxs("div",{children:[" ",i.jsxs("span",{children:["Error: ",h]})]})]}),u&&i.jsxs("div",{className:un.loadingContainer,children:[" ",i.jsx("p",{children:"Loading data..."})]}),o&&!u&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:un.sectionTitle,children:["Pharmacy Inventory Changes (",o.startDate," to ",o.endDate,")"]}),o.pharmacyAnalysis.length>0?i.jsx("div",{className:un.tableContainer,children:i.jsxs("table",{className:un.analysisTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Drug Name"}),i.jsx("th",{children:"Unit"}),i.jsx("th",{className:un.textRight,children:"Price"}),i.jsx("th",{children:"Qty In (+)"}),i.jsx("th",{className:un.textRight,children:"Packs Out (-)"}),i.jsx("th",{className:un.textRight,children:"Loose Qty Out (-)"}),i.jsx("th",{className:un.textRight,children:"Packs Converted"})]})}),i.jsx("tbody",{children:o.pharmacyAnalysis.map(T=>i.jsxs("tr",{children:[i.jsx("td",{children:T.name}),i.jsx("td",{children:T.unit||"N/A"}),i.jsx("td",{className:un.textRight,children:A(T.price)}),i.jsxs("td",{className:un.textGreen,children:[" ",i.jsxs("div",{className:un.reasonDistribution,children:[Object.entries(T.quantity_in_by_reason).map(([D,M])=>i.jsxs("div",{children:[i.jsxs("span",{children:[D,":"]}),i.jsx("span",{children:M})]},D)),Object.keys(T.quantity_in_by_reason).length>0&&i.jsxs("div",{className:un.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:T.quantity_in})]})]})]}),i.jsxs("td",{className:un.textRed,children:[" ",i.jsxs("div",{className:un.reasonDistribution,children:[Object.entries(T.quantity_out_by_reason||{}).map(([D,M])=>i.jsxs("div",{children:[i.jsxs("span",{children:[D,":"]}),i.jsx("span",{children:M})]},D)),Object.keys(T.quantity_out_by_reason||{}).length>0&&i.jsxs("div",{className:un.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:T.quantity_out})]}),(!T.quantity_out_by_reason||Object.keys(T.quantity_out_by_reason).length===0)&&i.jsx("div",{className:un.textRight,children:T.quantity_out})]})]}),i.jsx("td",{className:`${un.textRed} ${un.textRight}`,children:T.loose_quantity_out}),i.jsx("td",{className:`${un.textOrange} ${un.textRight}`,children:T.quantity_converted})]},T.drug_id))})]})}):i.jsx("p",{className:"text-gray-500",children:"No pharmacy inventory changes found for the selected period."})]})]})]}),b==="labInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(aw,{})]}),b==="pharmacyInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(JC,{})]})]})};var W0,LN;function $R(){if(LN)return W0;LN=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,o=/^0o[0-7]+$/i,f=parseInt,u=typeof lu=="object"&&lu&&lu.Object===Object&&lu,d=typeof self=="object"&&self&&self.Object===Object&&self,h=u||d||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,N=Math.min,C=function(){return h.Date.now()};function A(F,z,B){var U,R,O,$,W,te,ne=0,re=!1,J=!1,q=!0;if(typeof F!="function")throw new TypeError(e);z=V(z)||0,T(B)&&(re=!!B.leading,J="maxWait"in B,O=J?v(V(B.maxWait)||0,z):O,q="trailing"in B?!!B.trailing:q);function H(ge){var ye=U,Re=R;return U=R=void 0,ne=ge,$=F.apply(Re,ye),$}function ee(ge){return ne=ge,W=setTimeout(ie,z),re?H(ge):$}function E(ge){var ye=ge-te,Re=ge-ne,Ze=z-ye;return J?N(Ze,O-Re):Ze}function Q(ge){var ye=ge-te,Re=ge-ne;return te===void 0||ye>=z||ye<0||J&&Re>=O}function ie(){var ge=C();if(Q(ge))return I(ge);W=setTimeout(ie,E(ge))}function I(ge){return W=void 0,q&&U?H(ge):(U=R=void 0,$)}function ce(){W!==void 0&&clearTimeout(W),ne=0,U=te=R=W=void 0}function xe(){return W===void 0?$:I(C())}function le(){var ge=C(),ye=Q(ge);if(U=arguments,R=this,te=ge,ye){if(W===void 0)return ee(te);if(J)return W=setTimeout(ie,z),H(te)}return W===void 0&&(W=setTimeout(ie,z)),$}return le.cancel=ce,le.flush=xe,le}function T(F){var z=typeof F;return!!F&&(z=="object"||z=="function")}function D(F){return!!F&&typeof F=="object"}function M(F){return typeof F=="symbol"||D(F)&&b.call(F)==t}function V(F){if(typeof F=="number")return F;if(M(F))return n;if(T(F)){var z=typeof F.valueOf=="function"?F.valueOf():F;F=T(z)?z+"":z}if(typeof F!="string")return F===0?F:+F;F=F.replace(r,"");var B=l.test(F);return B||o.test(F)?f(F.slice(2),B?2:8):a.test(F)?n:+F}return W0=A,W0}var zR=$R();const Tb=Yd(zR),sw=async()=>{const e=await ue("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},BR=async e=>{const n=await ue(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},UR=async e=>{const n=await ue(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},qR=async e=>{const n=await ue(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},VR=async e=>{const n=await ue("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},HR=async(e,n)=>{const t=await ue(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},GR=async e=>{const n=await ue(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},YR=async e=>{const n=await ue("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},WR=async()=>{try{const e=await ue("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},KC=async()=>{const e=await ue("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()};var Q0={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var ON;function QR(){return ON||(ON=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var l="",o=0;o<arguments.length;o++){var f=arguments[o];f&&(l=a(l,r(f)))}return l}function r(l){if(typeof l=="string"||typeof l=="number")return l;if(typeof l!="object")return"";if(Array.isArray(l))return t.apply(null,l);if(l.toString!==Object.prototype.toString&&!l.toString.toString().includes("[native code]"))return l.toString();var o="";for(var f in l)n.call(l,f)&&l[f]&&(o=a(o,f));return o}function a(l,o){return o?l?l+" "+o:l+o:l}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(Q0)),Q0.exports}var JR=QR();const ou=Yd(JR);function Vd(e){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Vd(e)}function KR(e,n){if(Vd(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(Vd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function XC(e){var n=KR(e,"string");return Vd(n)=="symbol"?n:n+""}function Gm(e,n,t){return(n=XC(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function FN(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Ut(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?FN(Object(t),!0).forEach(function(r){Gm(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):FN(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function XR(e){if(Array.isArray(e))return e}function ZR(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,l,o,f=[],u=!0,d=!1;try{if(l=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=l.call(t)).done)&&(f.push(r.value),f.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(d)throw a}}return f}}function Kv(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function ZC(e,n){if(e){if(typeof e=="string")return Kv(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Kv(e,n):void 0}}function e3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qo(e,n){return XR(e)||ZR(e,n)||ZC(e,n)||e3()}function t3(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function tc(e,n){if(e==null)return{};var t,r,a=t3(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var n3=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function i3(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,l=e.defaultValue,o=l===void 0?null:l,f=e.inputValue,u=e.menuIsOpen,d=e.onChange,h=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,N=tc(e,n3),C=w.useState(f!==void 0?f:t),A=Qo(C,2),T=A[0],D=A[1],M=w.useState(u!==void 0?u:a),V=Qo(M,2),F=V[0],z=V[1],B=w.useState(v!==void 0?v:o),U=Qo(B,2),R=U[0],O=U[1],$=w.useCallback(function(H,ee){typeof d=="function"&&d(H,ee),O(H)},[d]),W=w.useCallback(function(H,ee){var E;typeof h=="function"&&(E=h(H,ee)),D(E!==void 0?E:H)},[h]),te=w.useCallback(function(){typeof b=="function"&&b(),z(!0)},[b]),ne=w.useCallback(function(){typeof g=="function"&&g(),z(!1)},[g]),re=f!==void 0?f:T,J=u!==void 0?u:F,q=v!==void 0?v:R;return Ut(Ut({},N),{},{inputValue:re,menuIsOpen:J,onChange:$,onInputChange:W,onMenuClose:ne,onMenuOpen:te,value:q})}function Yt(){return Yt=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Yt.apply(null,arguments)}function r3(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function $N(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,XC(r.key),r)}}function a3(e,n,t){return n&&$N(e.prototype,n),t&&$N(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xv(e,n){return Xv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Xv(e,n)}function s3(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Xv(e,n)}function rb(e){return rb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},rb(e)}function e2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(e2=function(){return!!e})()}function l3(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o3(e,n){if(n&&(Vd(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l3(e)}function c3(e){var n=e2();return function(){var t,r=rb(e);if(n){var a=rb(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return o3(this,t)}}function u3(e){if(Array.isArray(e))return Kv(e)}function d3(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function f3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lw(e){return u3(e)||d3(e)||ZC(e)||f3()}function h3(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function p3(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var m3=function(){function e(t){var r=this;this._insertTag=function(a){var l;r.tags.length===0?r.insertionPoint?l=r.insertionPoint.nextSibling:r.prepend?l=r.container.firstChild:l=r.before:l=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,l),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(p3(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var l=h3(a);try{l.insertRule(r,l.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),$r="-ms-",ab="-moz-",Bn="-webkit-",t2="comm",ow="rule",cw="decl",g3="@import",n2="@keyframes",y3="@layer",x3=Math.abs,Eb=String.fromCharCode,b3=Object.assign;function v3(e,n){return jr(e,0)^45?(((n<<2^jr(e,0))<<2^jr(e,1))<<2^jr(e,2))<<2^jr(e,3):0}function i2(e){return e.trim()}function w3(e,n){return(e=n.exec(e))?e[0]:e}function Un(e,n,t){return e.replace(n,t)}function Zv(e,n){return e.indexOf(n)}function jr(e,n){return e.charCodeAt(n)|0}function rg(e,n,t){return e.slice(n,t)}function Ql(e){return e.length}function uw(e){return e.length}function bx(e,n){return n.push(e),e}function N3(e,n){return e.map(n).join("")}var Ab=1,Uh=1,r2=0,Aa=0,Ki=0,Kh="";function Pb(e,n,t,r,a,l,o){return{value:e,root:n,parent:t,type:r,props:a,children:l,line:Ab,column:Uh,length:o,return:""}}function Lm(e,n){return b3(Pb("",null,null,"",null,null,0),e,{length:-e.length},n)}function S3(){return Ki}function j3(){return Ki=Aa>0?jr(Kh,--Aa):0,Uh--,Ki===10&&(Uh=1,Ab--),Ki}function ts(){return Ki=Aa<r2?jr(Kh,Aa++):0,Uh++,Ki===10&&(Uh=1,Ab++),Ki}function Zl(){return jr(Kh,Aa)}function Ux(){return Aa}function pg(e,n){return rg(Kh,e,n)}function ag(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function a2(e){return Ab=Uh=1,r2=Ql(Kh=e),Aa=0,[]}function s2(e){return Kh="",e}function qx(e){return i2(pg(Aa-1,e1(e===91?e+2:e===40?e+1:e)))}function _3(e){for(;(Ki=Zl())&&Ki<33;)ts();return ag(e)>2||ag(Ki)>3?"":" "}function C3(e,n){for(;--n&&ts()&&!(Ki<48||Ki>102||Ki>57&&Ki<65||Ki>70&&Ki<97););return pg(e,Ux()+(n<6&&Zl()==32&&ts()==32))}function e1(e){for(;ts();)switch(Ki){case e:return Aa;case 34:case 39:e!==34&&e!==39&&e1(Ki);break;case 40:e===41&&e1(e);break;case 92:ts();break}return Aa}function k3(e,n){for(;ts()&&e+Ki!==57;)if(e+Ki===84&&Zl()===47)break;return"/*"+pg(n,Aa-1)+"*"+Eb(e===47?e:ts())}function T3(e){for(;!ag(Zl());)ts();return pg(e,Aa)}function E3(e){return s2(Vx("",null,null,null,[""],e=a2(e),0,[0],e))}function Vx(e,n,t,r,a,l,o,f,u){for(var d=0,h=0,g=o,b=0,v=0,N=0,C=1,A=1,T=1,D=0,M="",V=a,F=l,z=r,B=M;A;)switch(N=D,D=ts()){case 40:if(N!=108&&jr(B,g-1)==58){Zv(B+=Un(qx(D),"&","&\f"),"&\f")!=-1&&(T=-1);break}case 34:case 39:case 91:B+=qx(D);break;case 9:case 10:case 13:case 32:B+=_3(N);break;case 92:B+=C3(Ux()-1,7);continue;case 47:switch(Zl()){case 42:case 47:bx(A3(k3(ts(),Ux()),n,t),u);break;default:B+="/"}break;case 123*C:f[d++]=Ql(B)*T;case 125*C:case 59:case 0:switch(D){case 0:case 125:A=0;case 59+h:T==-1&&(B=Un(B,/\f/g,"")),v>0&&Ql(B)-g&&bx(v>32?BN(B+";",r,t,g-1):BN(Un(B," ","")+";",r,t,g-2),u);break;case 59:B+=";";default:if(bx(z=zN(B,n,t,d,h,a,f,M,V=[],F=[],g),l),D===123)if(h===0)Vx(B,n,z,z,V,l,g,f,F);else switch(b===99&&jr(B,3)===110?100:b){case 100:case 108:case 109:case 115:Vx(e,z,z,r&&bx(zN(e,z,z,0,0,a,f,M,a,V=[],g),F),a,F,g,f,r?V:F);break;default:Vx(B,z,z,z,[""],F,0,f,F)}}d=h=v=0,C=T=1,M=B="",g=o;break;case 58:g=1+Ql(B),v=N;default:if(C<1){if(D==123)--C;else if(D==125&&C++==0&&j3()==125)continue}switch(B+=Eb(D),D*C){case 38:T=h>0?1:(B+="\f",-1);break;case 44:f[d++]=(Ql(B)-1)*T,T=1;break;case 64:Zl()===45&&(B+=qx(ts())),b=Zl(),h=g=Ql(M=B+=T3(Ux())),D++;break;case 45:N===45&&Ql(B)==2&&(C=0)}}return l}function zN(e,n,t,r,a,l,o,f,u,d,h){for(var g=a-1,b=a===0?l:[""],v=uw(b),N=0,C=0,A=0;N<r;++N)for(var T=0,D=rg(e,g+1,g=x3(C=o[N])),M=e;T<v;++T)(M=i2(C>0?b[T]+" "+D:Un(D,/&\f/g,b[T])))&&(u[A++]=M);return Pb(e,n,t,a===0?ow:f,u,d,h)}function A3(e,n,t){return Pb(e,n,t,t2,Eb(S3()),rg(e,2,-2),0)}function BN(e,n,t,r){return Pb(e,n,t,cw,rg(e,0,r),rg(e,r+1,-1),r)}function Lh(e,n){for(var t="",r=uw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function P3(e,n,t,r){switch(e.type){case y3:if(e.children.length)break;case g3:case cw:return e.return=e.return||e.value;case t2:return"";case n2:return e.return=e.value+"{"+Lh(e.children,r)+"}";case ow:e.value=e.props.join(",")}return Ql(t=Lh(e.children,r))?e.return=e.value+"{"+t+"}":""}function D3(e){var n=uw(e);return function(t,r,a,l){for(var o="",f=0;f<n;f++)o+=e[f](t,r,a,l)||"";return o}}function M3(e){return function(n){n.root||(n=n.return)&&e(n)}}function I3(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var R3=function(n,t,r){for(var a=0,l=0;a=l,l=Zl(),a===38&&l===12&&(t[r]=1),!ag(l);)ts();return pg(n,Aa)},L3=function(n,t){var r=-1,a=44;do switch(ag(a)){case 0:a===38&&Zl()===12&&(t[r]=1),n[r]+=R3(Aa-1,t,r);break;case 2:n[r]+=qx(a);break;case 4:if(a===44){n[++r]=Zl()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Eb(a)}while(a=ts());return n},O3=function(n,t){return s2(L3(a2(n),t))},UN=new WeakMap,F3=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!UN.get(r))&&!a){UN.set(n,!0);for(var l=[],o=O3(t,l),f=r.props,u=0,d=0;u<o.length;u++)for(var h=0;h<f.length;h++,d++)n.props[d]=l[u]?o[u].replace(/&\f/g,f[h]):f[h]+" "+o[u]}}},$3=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function l2(e,n){switch(v3(e,n)){case 5103:return Bn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Bn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Bn+e+ab+e+$r+e+e;case 6828:case 4268:return Bn+e+$r+e+e;case 6165:return Bn+e+$r+"flex-"+e+e;case 5187:return Bn+e+Un(e,/(\w+).+(:[^]+)/,Bn+"box-$1$2"+$r+"flex-$1$2")+e;case 5443:return Bn+e+$r+"flex-item-"+Un(e,/flex-|-self/,"")+e;case 4675:return Bn+e+$r+"flex-line-pack"+Un(e,/align-content|flex-|-self/,"")+e;case 5548:return Bn+e+$r+Un(e,"shrink","negative")+e;case 5292:return Bn+e+$r+Un(e,"basis","preferred-size")+e;case 6060:return Bn+"box-"+Un(e,"-grow","")+Bn+e+$r+Un(e,"grow","positive")+e;case 4554:return Bn+Un(e,/([^-])(transform)/g,"$1"+Bn+"$2")+e;case 6187:return Un(Un(Un(e,/(zoom-|grab)/,Bn+"$1"),/(image-set)/,Bn+"$1"),e,"")+e;case 5495:case 3959:return Un(e,/(image-set\([^]*)/,Bn+"$1$`$1");case 4968:return Un(Un(e,/(.+:)(flex-)?(.*)/,Bn+"box-pack:$3"+$r+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Bn+e+e;case 4095:case 3583:case 4068:case 2532:return Un(e,/(.+)-inline(.+)/,Bn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ql(e)-1-n>6)switch(jr(e,n+1)){case 109:if(jr(e,n+4)!==45)break;case 102:return Un(e,/(.+:)(.+)-([^]+)/,"$1"+Bn+"$2-$3$1"+ab+(jr(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~Zv(e,"stretch")?l2(Un(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(jr(e,n+1)!==115)break;case 6444:switch(jr(e,Ql(e)-3-(~Zv(e,"!important")&&10))){case 107:return Un(e,":",":"+Bn)+e;case 101:return Un(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Bn+(jr(e,14)===45?"inline-":"")+"box$3$1"+Bn+"$2$3$1"+$r+"$2box$3")+e}break;case 5936:switch(jr(e,n+11)){case 114:return Bn+e+$r+Un(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Bn+e+$r+Un(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Bn+e+$r+Un(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Bn+e+$r+e+e}return e}var z3=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case cw:n.return=l2(n.value,n.length);break;case n2:return Lh([Lm(n,{value:Un(n.value,"@","@"+Bn)})],a);case ow:if(n.length)return N3(n.props,function(l){switch(w3(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Lh([Lm(n,{props:[Un(l,/:(read-\w+)/,":"+ab+"$1")]})],a);case"::placeholder":return Lh([Lm(n,{props:[Un(l,/:(plac\w+)/,":"+Bn+"input-$1")]}),Lm(n,{props:[Un(l,/:(plac\w+)/,":"+ab+"$1")]}),Lm(n,{props:[Un(l,/:(plac\w+)/,$r+"input-$1")]})],a)}return""})}},B3=[z3],U3=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(C){var A=C.getAttribute("data-emotion");A.indexOf(" ")!==-1&&(document.head.appendChild(C),C.setAttribute("data-s",""))})}var a=n.stylisPlugins||B3,l={},o,f=[];o=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(C){for(var A=C.getAttribute("data-emotion").split(" "),T=1;T<A.length;T++)l[A[T]]=!0;f.push(C)});var u,d=[F3,$3];{var h,g=[P3,M3(function(C){h.insert(C)})],b=D3(d.concat(a,g)),v=function(A){return Lh(E3(A),b)};u=function(A,T,D,M){h=D,v(A?A+"{"+T.styles+"}":T.styles),M&&(N.inserted[T.name]=!0)}}var N={key:t,sheet:new m3({key:t,container:o,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:l,registered:{},insert:u};return N.sheet.hydrate(f),N},J0={exports:{}},Jn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qN;function q3(){if(qN)return Jn;qN=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,l=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,f=e?Symbol.for("react.context"):60110,u=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,N=e?Symbol.for("react.lazy"):60116,C=e?Symbol.for("react.block"):60121,A=e?Symbol.for("react.fundamental"):60117,T=e?Symbol.for("react.responder"):60118,D=e?Symbol.for("react.scope"):60119;function M(F){if(typeof F=="object"&&F!==null){var z=F.$$typeof;switch(z){case n:switch(F=F.type,F){case u:case d:case r:case l:case a:case g:return F;default:switch(F=F&&F.$$typeof,F){case f:case h:case N:case v:case o:return F;default:return z}}case t:return z}}}function V(F){return M(F)===d}return Jn.AsyncMode=u,Jn.ConcurrentMode=d,Jn.ContextConsumer=f,Jn.ContextProvider=o,Jn.Element=n,Jn.ForwardRef=h,Jn.Fragment=r,Jn.Lazy=N,Jn.Memo=v,Jn.Portal=t,Jn.Profiler=l,Jn.StrictMode=a,Jn.Suspense=g,Jn.isAsyncMode=function(F){return V(F)||M(F)===u},Jn.isConcurrentMode=V,Jn.isContextConsumer=function(F){return M(F)===f},Jn.isContextProvider=function(F){return M(F)===o},Jn.isElement=function(F){return typeof F=="object"&&F!==null&&F.$$typeof===n},Jn.isForwardRef=function(F){return M(F)===h},Jn.isFragment=function(F){return M(F)===r},Jn.isLazy=function(F){return M(F)===N},Jn.isMemo=function(F){return M(F)===v},Jn.isPortal=function(F){return M(F)===t},Jn.isProfiler=function(F){return M(F)===l},Jn.isStrictMode=function(F){return M(F)===a},Jn.isSuspense=function(F){return M(F)===g},Jn.isValidElementType=function(F){return typeof F=="string"||typeof F=="function"||F===r||F===d||F===l||F===a||F===g||F===b||typeof F=="object"&&F!==null&&(F.$$typeof===N||F.$$typeof===v||F.$$typeof===o||F.$$typeof===f||F.$$typeof===h||F.$$typeof===A||F.$$typeof===T||F.$$typeof===D||F.$$typeof===C)},Jn.typeOf=M,Jn}var VN;function V3(){return VN||(VN=1,J0.exports=q3()),J0.exports}var K0,HN;function H3(){if(HN)return K0;HN=1;var e=V3(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};l[e.ForwardRef]=r,l[e.Memo]=a;function o(N){return e.isMemo(N)?a:l[N.$$typeof]||n}var f=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(N,C,A){if(typeof C!="string"){if(b){var T=g(C);T&&T!==b&&v(N,T,A)}var D=u(C);d&&(D=D.concat(d(C)));for(var M=o(N),V=o(C),F=0;F<D.length;++F){var z=D[F];if(!t[z]&&!(A&&A[z])&&!(V&&V[z])&&!(M&&M[z])){var B=h(C,z);try{f(N,z,B)}catch{}}}}return N}return K0=v,K0}H3();var G3=!0;function Y3(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var o2=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||G3===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},W3=function(n,t,r){o2(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var l=t;do n.insert(t===l?"."+a:"",l,n.sheet,!0),l=l.next;while(l!==void 0)}};function Q3(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var J3={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},K3=/[A-Z]|^ms/g,X3=/_EMO_([^_]+?)_([^]*?)_EMO_/g,c2=function(n){return n.charCodeAt(1)===45},GN=function(n){return n!=null&&typeof n!="boolean"},X0=I3(function(e){return c2(e)?e:e.replace(K3,"-$&").toLowerCase()}),YN=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(X3,function(r,a,l){return Jl={name:a,styles:l,next:Jl},a})}return J3[n]!==1&&!c2(n)&&typeof t=="number"&&t!==0?t+"px":t};function sg(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return Jl={name:a.name,styles:a.styles,next:Jl},a.name;var l=t;if(l.styles!==void 0){var o=l.next;if(o!==void 0)for(;o!==void 0;)Jl={name:o.name,styles:o.styles,next:Jl},o=o.next;var f=l.styles+";";return f}return Z3(e,n,t)}case"function":{if(e!==void 0){var u=Jl,d=t(e);return Jl=u,sg(e,n,d)}break}}var h=t;return h}function Z3(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=sg(e,n,t[a])+";";else for(var l in t){var o=t[l];if(typeof o!="object"){var f=o;GN(f)&&(r+=X0(l)+":"+YN(l,f)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&n==null)for(var u=0;u<o.length;u++)GN(o[u])&&(r+=X0(l)+":"+YN(l,o[u])+";");else{var d=sg(e,n,o);switch(l){case"animation":case"animationName":{r+=X0(l)+":"+d+";";break}default:r+=l+"{"+d+"}"}}}return r}var WN=/label:\s*([^\s;{]+)\s*(;|$)/g,Jl;function u2(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";Jl=void 0;var l=e[0];if(l==null||l.raw===void 0)r=!1,a+=sg(t,n,l);else{var o=l;a+=o[0]}for(var f=1;f<e.length;f++)if(a+=sg(t,n,e[f]),r){var u=l;a+=u[f]}WN.lastIndex=0;for(var d="",h;(h=WN.exec(a))!==null;)d+="-"+h[1];var g=Q3(a)+d;return{name:g,styles:a,next:Jl}}var eL=function(n){return n()},tL=sN.useInsertionEffect?sN.useInsertionEffect:!1,nL=tL||eL,d2=w.createContext(typeof HTMLElement<"u"?U3({key:"css"}):null);d2.Provider;var iL=function(n){return w.forwardRef(function(t,r){var a=w.useContext(d2);return n(t,a,r)})},rL=w.createContext({}),dw={}.hasOwnProperty,t1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",aL=function(n,t){var r={};for(var a in t)dw.call(t,a)&&(r[a]=t[a]);return r[t1]=n,r},sL=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return o2(t,r,a),nL(function(){return W3(t,r,a)}),null},lL=iL(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[t1],l=[r],o="";typeof e.className=="string"?o=Y3(n.registered,l,e.className):e.className!=null&&(o=e.className+" ");var f=u2(l,void 0,w.useContext(rL));o+=n.key+"-"+f.name;var u={};for(var d in e)dw.call(e,d)&&d!=="css"&&d!==t1&&(u[d]=e[d]);return u.className=o,t&&(u.ref=t),w.createElement(w.Fragment,null,w.createElement(sL,{cache:n,serialized:f,isStringTag:typeof a=="string"}),w.createElement(a,u))}),oL=lL,Lt=function(n,t){var r=arguments;if(t==null||!dw.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,l=new Array(a);l[0]=oL,l[1]=aL(n,t);for(var o=2;o<a;o++)l[o]=r[o];return w.createElement.apply(null,l)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(Lt||(Lt={}));function fw(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return u2(n)}function cL(){var e=fw.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function uL(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const dL=Math.min,fL=Math.max,sb=Math.round,vx=Math.floor,lb=e=>({x:e,y:e});function hL(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function Db(){return typeof window<"u"}function f2(e){return p2(e)?(e.nodeName||"").toLowerCase():"#document"}function Zo(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function h2(e){var n;return(n=(p2(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function p2(e){return Db()?e instanceof Node||e instanceof Zo(e).Node:!1}function pL(e){return Db()?e instanceof Element||e instanceof Zo(e).Element:!1}function hw(e){return Db()?e instanceof HTMLElement||e instanceof Zo(e).HTMLElement:!1}function QN(e){return!Db()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Zo(e).ShadowRoot}const mL=new Set(["inline","contents"]);function m2(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=pw(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!mL.has(a)}function gL(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const yL=new Set(["html","body","#document"]);function xL(e){return yL.has(f2(e))}function pw(e){return Zo(e).getComputedStyle(e)}function bL(e){if(f2(e)==="html")return e;const n=e.assignedSlot||e.parentNode||QN(e)&&e.host||h2(e);return QN(n)?n.host:n}function g2(e){const n=bL(e);return xL(n)?e.ownerDocument?e.ownerDocument.body:e.body:hw(n)&&m2(n)?n:g2(n)}function ob(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=g2(e),l=a===((r=e.ownerDocument)==null?void 0:r.body),o=Zo(a);if(l){const f=n1(o);return n.concat(o,o.visualViewport||[],m2(a)?a:[],f&&t?ob(f):[])}return n.concat(a,ob(a,[],t))}function n1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function vL(e){const n=pw(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=hw(e),l=a?e.offsetWidth:t,o=a?e.offsetHeight:r,f=sb(t)!==l||sb(r)!==o;return f&&(t=l,r=o),{width:t,height:r,$:f}}function mw(e){return pL(e)?e:e.contextElement}function JN(e){const n=mw(e);if(!hw(n))return lb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:l}=vL(n);let o=(l?sb(t.width):t.width)/r,f=(l?sb(t.height):t.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!f||!Number.isFinite(f))&&(f=1),{x:o,y:f}}const wL=lb(0);function NL(e){const n=Zo(e);return!gL()||!n.visualViewport?wL:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function SL(e,n,t){return!1}function KN(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),l=mw(e);let o=lb(1);n&&(o=JN(e));const f=SL()?NL(l):lb(0);let u=(a.left+f.x)/o.x,d=(a.top+f.y)/o.y,h=a.width/o.x,g=a.height/o.y;if(l){const b=Zo(l),v=r;let N=b,C=n1(N);for(;C&&r&&v!==N;){const A=JN(C),T=C.getBoundingClientRect(),D=pw(C),M=T.left+(C.clientLeft+parseFloat(D.paddingLeft))*A.x,V=T.top+(C.clientTop+parseFloat(D.paddingTop))*A.y;u*=A.x,d*=A.y,h*=A.x,g*=A.y,u+=M,d+=V,N=Zo(C),C=n1(N)}}return hL({width:h,height:g,x:u,y:d})}function y2(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function jL(e,n){let t=null,r;const a=h2(e);function l(){var f;clearTimeout(r),(f=t)==null||f.disconnect(),t=null}function o(f,u){f===void 0&&(f=!1),u===void 0&&(u=1),l();const d=e.getBoundingClientRect(),{left:h,top:g,width:b,height:v}=d;if(f||n(),!b||!v)return;const N=vx(g),C=vx(a.clientWidth-(h+b)),A=vx(a.clientHeight-(g+v)),T=vx(h),M={rootMargin:-N+"px "+-C+"px "+-A+"px "+-T+"px",threshold:fL(0,dL(1,u))||1};let V=!0;function F(z){const B=z[0].intersectionRatio;if(B!==u){if(!V)return o();B?o(!1,B):r=setTimeout(()=>{o(!1,1e-7)},1e3)}B===1&&!y2(d,e.getBoundingClientRect())&&o(),V=!1}try{t=new IntersectionObserver(F,{...M,root:a.ownerDocument})}catch{t=new IntersectionObserver(F,M)}t.observe(e)}return o(!0),l}function _L(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:f=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,d=mw(e),h=a||l?[...d?ob(d):[],...ob(n)]:[];h.forEach(T=>{a&&T.addEventListener("scroll",t,{passive:!0}),l&&T.addEventListener("resize",t)});const g=d&&f?jL(d,t):null;let b=-1,v=null;o&&(v=new ResizeObserver(T=>{let[D]=T;D&&D.target===d&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var M;(M=v)==null||M.observe(n)})),t()}),d&&!u&&v.observe(d),v.observe(n));let N,C=u?KN(e):null;u&&A();function A(){const T=KN(e);C&&!y2(C,T)&&t(),C=T,N=requestAnimationFrame(A)}return t(),()=>{var T;h.forEach(D=>{a&&D.removeEventListener("scroll",t),l&&D.removeEventListener("resize",t)}),g==null||g(),(T=v)==null||T.disconnect(),v=null,u&&cancelAnimationFrame(N)}}var i1=w.useLayoutEffect,CL=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],cb=function(){};function kL(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function TL(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var l=[].concat(r);if(n&&e)for(var o in n)n.hasOwnProperty(o)&&n[o]&&l.push("".concat(kL(e,o)));return l.filter(function(f){return f}).map(function(f){return String(f).trim()}).join(" ")}var XN=function(n){return OL(n)?n.filter(Boolean):Vd(n)==="object"&&n!==null?[n]:[]},x2=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=tc(n,CL);return Ut({},t)},Di=function(n,t,r){var a=n.cx,l=n.getStyles,o=n.getClassNames,f=n.className;return{css:l(t,n),className:a(r??{},o(t,n),f)}};function Mb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function EL(e){return Mb(e)?window.innerHeight:e.clientHeight}function b2(e){return Mb(e)?window.pageYOffset:e.scrollTop}function ub(e,n){if(Mb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function AL(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function PL(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function wx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:cb,a=b2(e),l=n-a,o=10,f=0;function u(){f+=o;var d=PL(f,a,l,t);ub(e,d),f<t?window.requestAnimationFrame(u):r(e)}u()}function ZN(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?ub(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&ub(e,Math.max(n.offsetTop-a,0))}function DL(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function eS(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function ML(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var v2=!1,IL={get passive(){return v2=!0}},Nx=typeof window<"u"?window:{};Nx.addEventListener&&Nx.removeEventListener&&(Nx.addEventListener("p",cb,IL),Nx.removeEventListener("p",cb,!1));var RL=v2;function LL(e){return e!=null}function OL(e){return Array.isArray(e)}function Sx(e,n,t){return e?n:t}var FL=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var l=Object.entries(n).filter(function(o){var f=Qo(o,1),u=f[0];return!r.includes(u)});return l.reduce(function(o,f){var u=Qo(f,2),d=u[0],h=u[1];return o[d]=h,o},{})},$L=["children","innerProps"],zL=["children","innerProps"];function BL(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,l=e.shouldScroll,o=e.isFixedPosition,f=e.controlHeight,u=AL(t),d={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return d;var h=u.getBoundingClientRect(),g=h.height,b=t.getBoundingClientRect(),v=b.bottom,N=b.height,C=b.top,A=t.offsetParent.getBoundingClientRect(),T=A.top,D=o?window.innerHeight:EL(u),M=b2(u),V=parseInt(getComputedStyle(t).marginBottom,10),F=parseInt(getComputedStyle(t).marginTop,10),z=T-F,B=D-C,U=z+M,R=g-M-C,O=v-D+M+V,$=M+C-F,W=160;switch(a){case"auto":case"bottom":if(B>=N)return{placement:"bottom",maxHeight:n};if(R>=N&&!o)return l&&wx(u,O,W),{placement:"bottom",maxHeight:n};if(!o&&R>=r||o&&B>=r){l&&wx(u,O,W);var te=o?B-V:R-V;return{placement:"bottom",maxHeight:te}}if(a==="auto"||o){var ne=n,re=o?z:U;return re>=r&&(ne=Math.min(re-V-f,n)),{placement:"top",maxHeight:ne}}if(a==="bottom")return l&&ub(u,O),{placement:"bottom",maxHeight:n};break;case"top":if(z>=N)return{placement:"top",maxHeight:n};if(U>=N&&!o)return l&&wx(u,$,W),{placement:"top",maxHeight:n};if(!o&&U>=r||o&&z>=r){var J=n;return(!o&&U>=r||o&&z>=r)&&(J=o?z-F:U-F),l&&wx(u,$,W),{placement:"top",maxHeight:J}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return d}function UL(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var w2=function(n){return n==="auto"?"bottom":n},qL=function(n,t){var r,a=n.placement,l=n.theme,o=l.borderRadius,f=l.spacing,u=l.colors;return Ut((r={label:"menu"},Gm(r,UL(a),"100%"),Gm(r,"position","absolute"),Gm(r,"width","100%"),Gm(r,"zIndex",1),r),t?{}:{backgroundColor:u.neutral0,borderRadius:o,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:f.menuGutter,marginTop:f.menuGutter})},N2=w.createContext(null),VL=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,l=n.menuPlacement,o=n.menuPosition,f=n.menuShouldScrollIntoView,u=n.theme,d=w.useContext(N2)||{},h=d.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=Qo(b,2),N=v[0],C=v[1],A=w.useState(null),T=Qo(A,2),D=T[0],M=T[1],V=u.spacing.controlHeight;return i1(function(){var F=g.current;if(F){var z=o==="fixed",B=f&&!z,U=BL({maxHeight:a,menuEl:F,minHeight:r,placement:l,shouldScroll:B,isFixedPosition:z,controlHeight:V});C(U.maxHeight),M(U.placement),h==null||h(U.placement)}},[a,l,o,f,r,h,V]),t({ref:g,placerProps:Ut(Ut({},n),{},{placement:D||w2(l),maxHeight:N})})},HL=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return Lt("div",Yt({},Di(n,"menu",{menu:!0}),{ref:r},a),t)},GL=HL,YL=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return Ut({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},WL=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,l=n.isMulti;return Lt("div",Yt({},Di(n,"menuList",{"menu-list":!0,"menu-list--is-multi":l}),{ref:a},r),t)},S2=function(n,t){var r=n.theme,a=r.spacing.baseUnit,l=r.colors;return Ut({textAlign:"center"},t?{}:{color:l.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},QL=S2,JL=S2,KL=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,l=tc(n,$L);return Lt("div",Yt({},Di(Ut(Ut({},l),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},XL=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,l=tc(n,zL);return Lt("div",Yt({},Di(Ut(Ut({},l),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},ZL=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},eO=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,l=n.innerProps,o=n.menuPlacement,f=n.menuPosition,u=w.useRef(null),d=w.useRef(null),h=w.useState(w2(o)),g=Qo(h,2),b=g[0],v=g[1],N=w.useMemo(function(){return{setPortalPlacement:v}},[]),C=w.useState(null),A=Qo(C,2),T=A[0],D=A[1],M=w.useCallback(function(){if(a){var B=DL(a),U=f==="fixed"?0:window.pageYOffset,R=B[b]+U;(R!==(T==null?void 0:T.offset)||B.left!==(T==null?void 0:T.rect.left)||B.width!==(T==null?void 0:T.rect.width))&&D({offset:R,rect:B})}},[a,f,b,T==null?void 0:T.offset,T==null?void 0:T.rect.left,T==null?void 0:T.rect.width]);i1(function(){M()},[M]);var V=w.useCallback(function(){typeof d.current=="function"&&(d.current(),d.current=null),a&&u.current&&(d.current=_L(a,u.current,M,{elementResize:"ResizeObserver"in window}))},[a,M]);i1(function(){V()},[V]);var F=w.useCallback(function(B){u.current=B,V()},[V]);if(!t&&f!=="fixed"||!T)return null;var z=Lt("div",Yt({ref:F},Di(Ut(Ut({},n),{},{offset:T.offset,position:f,rect:T.rect}),"menuPortal",{"menu-portal":!0}),l),r);return Lt(N2.Provider,{value:N},t?WP.createPortal(z,t):z)},tO=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},nO=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,l=n.isRtl;return Lt("div",Yt({},Di(n,"container",{"--is-disabled":a,"--is-rtl":l}),r),t)},iO=function(n,t){var r=n.theme.spacing,a=n.isMulti,l=n.hasValue,o=n.selectProps.controlShouldRenderValue;return Ut({alignItems:"center",display:a&&l&&o?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},rO=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,l=n.hasValue;return Lt("div",Yt({},Di(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":l}),r),t)},aO=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},sO=function(n){var t=n.children,r=n.innerProps;return Lt("div",Yt({},Di(n,"indicatorsContainer",{indicators:!0}),r),t)},tS,lO=["size"],oO=["innerProps","isRtl","size"],cO={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},j2=function(n){var t=n.size,r=tc(n,lO);return Lt("svg",Yt({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:cO},r))},gw=function(n){return Lt(j2,Yt({size:20},n),Lt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},_2=function(n){return Lt(j2,Yt({size:20},n),Lt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},C2=function(n,t){var r=n.isFocused,a=n.theme,l=a.spacing.baseUnit,o=a.colors;return Ut({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?o.neutral60:o.neutral20,padding:l*2,":hover":{color:r?o.neutral80:o.neutral40}})},uO=C2,dO=function(n){var t=n.children,r=n.innerProps;return Lt("div",Yt({},Di(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||Lt(_2,null))},fO=C2,hO=function(n){var t=n.children,r=n.innerProps;return Lt("div",Yt({},Di(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||Lt(gw,null))},pO=function(n,t){var r=n.isDisabled,a=n.theme,l=a.spacing.baseUnit,o=a.colors;return Ut({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?o.neutral10:o.neutral20,marginBottom:l*2,marginTop:l*2})},mO=function(n){var t=n.innerProps;return Lt("span",Yt({},t,Di(n,"indicatorSeparator",{"indicator-separator":!0})))},gO=cL(tS||(tS=uL([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),yO=function(n,t){var r=n.isFocused,a=n.size,l=n.theme,o=l.colors,f=l.spacing.baseUnit;return Ut({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?o.neutral60:o.neutral20,padding:f*2})},Z0=function(n){var t=n.delay,r=n.offset;return Lt("span",{css:fw({animation:"".concat(gO," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},xO=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,l=a===void 0?4:a,o=tc(n,oO);return Lt("div",Yt({},Di(Ut(Ut({},o),{},{innerProps:t,isRtl:r,size:l}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Lt(Z0,{delay:0,offset:r}),Lt(Z0,{delay:160,offset:!0}),Lt(Z0,{delay:320,offset:!r}))},bO=function(n,t){var r=n.isDisabled,a=n.isFocused,l=n.theme,o=l.colors,f=l.borderRadius,u=l.spacing;return Ut({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:u.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?o.neutral5:o.neutral0,borderColor:r?o.neutral10:a?o.primary:o.neutral20,borderRadius:f,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(o.primary):void 0,"&:hover":{borderColor:a?o.primary:o.neutral30}})},vO=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,l=n.innerRef,o=n.innerProps,f=n.menuIsOpen;return Lt("div",Yt({ref:l},Di(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":f}),o,{"aria-disabled":r||void 0}),t)},wO=vO,NO=["data"],SO=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},jO=function(n){var t=n.children,r=n.cx,a=n.getStyles,l=n.getClassNames,o=n.Heading,f=n.headingProps,u=n.innerProps,d=n.label,h=n.theme,g=n.selectProps;return Lt("div",Yt({},Di(n,"group",{group:!0}),u),Lt(o,Yt({},f,{selectProps:g,theme:h,getStyles:a,getClassNames:l,cx:r}),d),Lt("div",null,t))},_O=function(n,t){var r=n.theme,a=r.colors,l=r.spacing;return Ut({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:l.baseUnit*3,paddingRight:l.baseUnit*3,textTransform:"uppercase"})},CO=function(n){var t=x2(n);t.data;var r=tc(t,NO);return Lt("div",Yt({},Di(n,"groupHeading",{"group-heading":!0}),r))},kO=jO,TO=["innerRef","isDisabled","isHidden","inputClassName"],EO=function(n,t){var r=n.isDisabled,a=n.value,l=n.theme,o=l.spacing,f=l.colors;return Ut(Ut({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},AO),t?{}:{margin:o.baseUnit/2,paddingBottom:o.baseUnit/2,paddingTop:o.baseUnit/2,color:f.neutral80})},k2={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},AO={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Ut({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},k2)},PO=function(n){return Ut({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},k2)},DO=function(n){var t=n.cx,r=n.value,a=x2(n),l=a.innerRef,o=a.isDisabled,f=a.isHidden,u=a.inputClassName,d=tc(a,TO);return Lt("div",Yt({},Di(n,"input",{"input-container":!0}),{"data-value":r||""}),Lt("input",Yt({className:t({input:!0},u),ref:l,style:PO(f),disabled:o},d)))},MO=DO,IO=function(n,t){var r=n.theme,a=r.spacing,l=r.borderRadius,o=r.colors;return Ut({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:o.neutral10,borderRadius:l/2,margin:a.baseUnit/2})},RO=function(n,t){var r=n.theme,a=r.borderRadius,l=r.colors,o=n.cropWithEllipsis;return Ut({overflow:"hidden",textOverflow:o||o===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:l.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},LO=function(n,t){var r=n.theme,a=r.spacing,l=r.borderRadius,o=r.colors,f=n.isFocused;return Ut({alignItems:"center",display:"flex"},t?{}:{borderRadius:l/2,backgroundColor:f?o.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}})},T2=function(n){var t=n.children,r=n.innerProps;return Lt("div",r,t)},OO=T2,FO=T2;function $O(e){var n=e.children,t=e.innerProps;return Lt("div",Yt({role:"button"},t),n||Lt(gw,{size:14}))}var zO=function(n){var t=n.children,r=n.components,a=n.data,l=n.innerProps,o=n.isDisabled,f=n.removeProps,u=n.selectProps,d=r.Container,h=r.Label,g=r.Remove;return Lt(d,{data:a,innerProps:Ut(Ut({},Di(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":o})),l),selectProps:u},Lt(h,{data:a,innerProps:Ut({},Di(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:u},t),Lt(g,{data:a,innerProps:Ut(Ut({},Di(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},f),selectProps:u}))},BO=zO,UO=function(n,t){var r=n.isDisabled,a=n.isFocused,l=n.isSelected,o=n.theme,f=o.spacing,u=o.colors;return Ut({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:l?u.primary:a?u.primary25:"transparent",color:r?u.neutral20:l?u.neutral0:"inherit",padding:"".concat(f.baseUnit*2,"px ").concat(f.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:l?u.primary:u.primary50}})},qO=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,l=n.isSelected,o=n.innerRef,f=n.innerProps;return Lt("div",Yt({},Di(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":l}),{ref:o,"aria-disabled":r},f),t)},VO=qO,HO=function(n,t){var r=n.theme,a=r.spacing,l=r.colors;return Ut({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:l.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},GO=function(n){var t=n.children,r=n.innerProps;return Lt("div",Yt({},Di(n,"placeholder",{placeholder:!0}),r),t)},YO=GO,WO=function(n,t){var r=n.isDisabled,a=n.theme,l=a.spacing,o=a.colors;return Ut({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?o.neutral40:o.neutral80,marginLeft:l.baseUnit/2,marginRight:l.baseUnit/2})},QO=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return Lt("div",Yt({},Di(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},JO=QO,KO={ClearIndicator:hO,Control:wO,DropdownIndicator:dO,DownChevron:_2,CrossIcon:gw,Group:kO,GroupHeading:CO,IndicatorsContainer:sO,IndicatorSeparator:mO,Input:MO,LoadingIndicator:xO,Menu:GL,MenuList:WL,MenuPortal:eO,LoadingMessage:XL,NoOptionsMessage:KL,MultiValue:BO,MultiValueContainer:OO,MultiValueLabel:FO,MultiValueRemove:$O,Option:VO,Placeholder:YO,SelectContainer:nO,SingleValue:JO,ValueContainer:rO},XO=function(n){return Ut(Ut({},KO),n.components)},nS=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function ZO(e,n){return!!(e===n||nS(e)&&nS(n))}function eF(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!ZO(e[t],n[t]))return!1;return!0}function tF(e,n){n===void 0&&(n=eF);var t=null;function r(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var o=e.apply(this,a);return t={lastResult:o,lastArgs:a,lastThis:this},o}return r.clear=function(){t=null},r}var nF={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},iF=function(n){return Lt("span",Yt({css:nF},n))},iS=iF,rF={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,l=n.context,o=n.isInitialFocus;switch(l){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return o?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,l=n.labels,o=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(l.length>1?"s":""," ").concat(l.join(","),", selected.");case"select-option":return o?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,l=n.label,o=l===void 0?"":l,f=n.selectValue,u=n.isDisabled,d=n.isSelected,h=n.isAppleDevice,g=function(C,A){return C&&C.length?"".concat(C.indexOf(A)+1," of ").concat(C.length):""};if(t==="value"&&f)return"value ".concat(o," focused, ").concat(g(f,r),".");if(t==="menu"&&h){var b=u?" disabled":"",v="".concat(d?" selected":"").concat(b);return"".concat(o).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},aF=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,l=n.focusableOptions,o=n.isFocused,f=n.selectValue,u=n.selectProps,d=n.id,h=n.isAppleDevice,g=u.ariaLiveMessages,b=u.getOptionLabel,v=u.inputValue,N=u.isMulti,C=u.isOptionDisabled,A=u.isSearchable,T=u.menuIsOpen,D=u.options,M=u.screenReaderStatus,V=u.tabSelectsValue,F=u.isLoading,z=u["aria-label"],B=u["aria-live"],U=w.useMemo(function(){return Ut(Ut({},rF),g||{})},[g]),R=w.useMemo(function(){var re="";if(t&&U.onChange){var J=t.option,q=t.options,H=t.removedValue,ee=t.removedValues,E=t.value,Q=function(ye){return Array.isArray(ye)?null:ye},ie=H||J||Q(E),I=ie?b(ie):"",ce=q||ee||void 0,xe=ce?ce.map(b):[],le=Ut({isDisabled:ie&&C(ie,f),label:I,labels:xe},t);re=U.onChange(le)}return re},[t,U,C,f,b]),O=w.useMemo(function(){var re="",J=r||a,q=!!(r&&f&&f.includes(r));if(J&&U.onFocus){var H={focused:J,label:b(J),isDisabled:C(J,f),isSelected:q,options:l,context:J===r?"menu":"value",selectValue:f,isAppleDevice:h};re=U.onFocus(H)}return re},[r,a,b,C,U,l,f,h]),$=w.useMemo(function(){var re="";if(T&&D.length&&!F&&U.onFilter){var J=M({count:l.length});re=U.onFilter({inputValue:v,resultsMessage:J})}return re},[l,v,T,U,D,M,F]),W=(t==null?void 0:t.action)==="initial-input-focus",te=w.useMemo(function(){var re="";if(U.guidance){var J=a?"value":T?"menu":"input";re=U.guidance({"aria-label":z,context:J,isDisabled:r&&C(r,f),isMulti:N,isSearchable:A,tabSelectsValue:V,isInitialFocus:W})}return re},[z,r,a,N,C,A,T,U,f,V,W]),ne=Lt(w.Fragment,null,Lt("span",{id:"aria-selection"},R),Lt("span",{id:"aria-focused"},O),Lt("span",{id:"aria-results"},$),Lt("span",{id:"aria-guidance"},te));return Lt(w.Fragment,null,Lt(iS,{id:d},W&&ne),Lt(iS,{"aria-live":B,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},o&&!W&&ne))},sF=aF,r1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],lF=new RegExp("["+r1.map(function(e){return e.letters}).join("")+"]","g"),E2={};for(var ev=0;ev<r1.length;ev++)for(var tv=r1[ev],nv=0;nv<tv.letters.length;nv++)E2[tv.letters[nv]]=tv.base;var A2=function(n){return n.replace(lF,function(t){return E2[t]})},oF=tF(A2),rS=function(n){return n.replace(/^\s+|\s+$/g,"")},cF=function(n){return"".concat(n.label," ").concat(n.value)},uF=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=Ut({ignoreCase:!0,ignoreAccents:!0,stringify:cF,trim:!0,matchFrom:"any"},n),l=a.ignoreCase,o=a.ignoreAccents,f=a.stringify,u=a.trim,d=a.matchFrom,h=u?rS(r):r,g=u?rS(f(t)):f(t);return l&&(h=h.toLowerCase(),g=g.toLowerCase()),o&&(h=oF(h),g=A2(g)),d==="start"?g.substr(0,h.length)===h:g.indexOf(h)>-1}},dF=["innerRef"];function fF(e){var n=e.innerRef,t=tc(e,dF),r=FL(t,"onExited","in","enter","exit","appear");return Lt("input",Yt({ref:n},r,{css:fw({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var hF=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function pF(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,l=e.onTopLeave,o=w.useRef(!1),f=w.useRef(!1),u=w.useRef(0),d=w.useRef(null),h=w.useCallback(function(A,T){if(d.current!==null){var D=d.current,M=D.scrollTop,V=D.scrollHeight,F=D.clientHeight,z=d.current,B=T>0,U=V-F-M,R=!1;U>T&&o.current&&(r&&r(A),o.current=!1),B&&f.current&&(l&&l(A),f.current=!1),B&&T>U?(t&&!o.current&&t(A),z.scrollTop=V,R=!0,o.current=!0):!B&&-T>M&&(a&&!f.current&&a(A),z.scrollTop=0,R=!0,f.current=!0),R&&hF(A)}},[t,r,a,l]),g=w.useCallback(function(A){h(A,A.deltaY)},[h]),b=w.useCallback(function(A){u.current=A.changedTouches[0].clientY},[]),v=w.useCallback(function(A){var T=u.current-A.changedTouches[0].clientY;h(A,T)},[h]),N=w.useCallback(function(A){if(A){var T=RL?{passive:!1}:!1;A.addEventListener("wheel",g,T),A.addEventListener("touchstart",b,T),A.addEventListener("touchmove",v,T)}},[v,b,g]),C=w.useCallback(function(A){A&&(A.removeEventListener("wheel",g,!1),A.removeEventListener("touchstart",b,!1),A.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var A=d.current;return N(A),function(){C(A)}}},[n,N,C]),function(A){d.current=A}}var aS=["boxSizing","height","overflow","paddingRight","position"],sS={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function lS(e){e.cancelable&&e.preventDefault()}function oS(e){e.stopPropagation()}function cS(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function uS(){return"ontouchstart"in window||navigator.maxTouchPoints}var dS=!!(typeof window<"u"&&window.document&&window.document.createElement),Om=0,wh={capture:!1,passive:!1};function mF(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),l=w.useRef(null),o=w.useCallback(function(u){if(dS){var d=document.body,h=d&&d.style;if(r&&aS.forEach(function(N){var C=h&&h[N];a.current[N]=C}),r&&Om<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(sS).forEach(function(N){var C=sS[N];h&&(h[N]=C)}),h&&(h.paddingRight="".concat(v,"px"))}d&&uS()&&(d.addEventListener("touchmove",lS,wh),u&&(u.addEventListener("touchstart",cS,wh),u.addEventListener("touchmove",oS,wh))),Om+=1}},[r]),f=w.useCallback(function(u){if(dS){var d=document.body,h=d&&d.style;Om=Math.max(Om-1,0),r&&Om<1&&aS.forEach(function(g){var b=a.current[g];h&&(h[g]=b)}),d&&uS()&&(d.removeEventListener("touchmove",lS,wh),u&&(u.removeEventListener("touchstart",cS,wh),u.removeEventListener("touchmove",oS,wh)))}},[r]);return w.useEffect(function(){if(n){var u=l.current;return o(u),function(){f(u)}}},[n,o,f]),function(u){l.current=u}}var gF=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},yF={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function xF(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,l=e.onBottomArrive,o=e.onBottomLeave,f=e.onTopArrive,u=e.onTopLeave,d=pF({isEnabled:a,onBottomArrive:l,onBottomLeave:o,onTopArrive:f,onTopLeave:u}),h=mF({isEnabled:t}),g=function(v){d(v),h(v)};return Lt(w.Fragment,null,t&&Lt("div",{onClick:gF,css:yF}),n(g))}var bF={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},vF=function(n){var t=n.name,r=n.onFocus;return Lt("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:bF,value:"",onChange:function(){}})},wF=vF;function yw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function NF(){return yw(/^iPhone/i)}function P2(){return yw(/^Mac/i)}function SF(){return yw(/^iPad/i)||P2()&&navigator.maxTouchPoints>1}function jF(){return NF()||SF()}function _F(){return P2()||jF()}var CF=function(n){return n.label},kF=function(n){return n.label},TF=function(n){return n.value},EF=function(n){return!!n.isDisabled},AF={clearIndicator:fO,container:tO,control:bO,dropdownIndicator:uO,group:SO,groupHeading:_O,indicatorsContainer:aO,indicatorSeparator:pO,input:EO,loadingIndicator:yO,loadingMessage:JL,menu:qL,menuList:YL,menuPortal:ZL,multiValue:IO,multiValueLabel:RO,multiValueRemove:LO,noOptionsMessage:QL,option:UO,placeholder:HO,singleValue:WO,valueContainer:iO},PF={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},DF=4,D2=4,MF=38,IF=D2*2,RF={baseUnit:D2,controlHeight:MF,menuGutter:IF},iv={borderRadius:DF,colors:PF,spacing:RF},LF={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:eS(),captureMenuScroll:!eS(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:uF(),formatGroupLabel:CF,getOptionLabel:kF,getOptionValue:TF,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:EF,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!ML(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function fS(e,n,t,r){var a=R2(e,n,t),l=L2(e,n,t),o=I2(e,n),f=db(e,n);return{type:"option",data:n,isDisabled:a,isSelected:l,label:o,value:f,index:r}}function Hx(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(o,f){return fS(e,o,n,f)}).filter(function(o){return pS(e,o)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var l=fS(e,t,n,r);return pS(e,l)?l:void 0}).filter(LL)}function M2(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,lw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function hS(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,lw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function OF(e,n){return M2(Hx(e,n))}function pS(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,l=n.isSelected,o=n.label,f=n.value;return(!F2(e)||!l)&&O2(e,{label:o,value:f,data:a},r)}function FF(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var l=n.indexOf(t);if(l>-1)return t;if(a<n.length)return n[a]}return null}function $F(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var rv=function(n,t){var r,a=(r=n.find(function(l){return l.data===t}))===null||r===void 0?void 0:r.id;return a||null},I2=function(n,t){return n.getOptionLabel(t)},db=function(n,t){return n.getOptionValue(t)};function R2(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function L2(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=db(e,n);return t.some(function(a){return db(e,a)===r})}function O2(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var F2=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},zF=1,$2=function(e){s3(t,e);var n=c3(t);function t(r){var a;if(r3(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(u){a.controlRef=u},a.focusedOptionRef=null,a.getFocusedOptionRef=function(u){a.focusedOptionRef=u},a.menuListRef=null,a.getMenuListRef=function(u){a.menuListRef=u},a.inputRef=null,a.getInputRef=function(u){a.inputRef=u},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(u,d){var h=a.props,g=h.onChange,b=h.name;d.name=b,a.ariaOnChange(u,d),g(u,d)},a.setValue=function(u,d,h){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,N=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:N}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(u,{action:d,option:h})},a.selectOption=function(u){var d=a.props,h=d.blurInputOnSelect,g=d.isMulti,b=d.name,v=a.state.selectValue,N=g&&a.isOptionSelected(u,v),C=a.isOptionDisabled(u,v);if(N){var A=a.getOptionValue(u);a.setValue(v.filter(function(T){return a.getOptionValue(T)!==A}),"deselect-option",u)}else if(!C)g?a.setValue([].concat(lw(v),[u]),"select-option",u):a.setValue(u,"select-option");else{a.ariaOnChange(u,{action:"select-option",option:u,name:b});return}h&&a.blurInput()},a.removeValue=function(u){var d=a.props.isMulti,h=a.state.selectValue,g=a.getOptionValue(u),b=h.filter(function(N){return a.getOptionValue(N)!==g}),v=Sx(d,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:u}),a.focusInput()},a.clearValue=function(){var u=a.state.selectValue;a.onChange(Sx(a.props.isMulti,[],null),{action:"clear",removedValues:u})},a.popValue=function(){var u=a.props.isMulti,d=a.state.selectValue,h=d[d.length-1],g=d.slice(0,d.length-1),b=Sx(u,g,g[0]||null);h&&a.onChange(b,{action:"pop-value",removedValue:h})},a.getFocusedOptionId=function(u){return rv(a.state.focusableOptionsWithIds,u)},a.getFocusableOptionsWithIds=function(){return hS(Hx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return TL.apply(void 0,[a.props.classNamePrefix].concat(d))},a.getOptionLabel=function(u){return I2(a.props,u)},a.getOptionValue=function(u){return db(a.props,u)},a.getStyles=function(u,d){var h=a.props.unstyled,g=AF[u](d,h);g.boxSizing="border-box";var b=a.props.styles[u];return b?b(g,d):g},a.getClassNames=function(u,d){var h,g;return(h=(g=a.props.classNames)[u])===null||h===void 0?void 0:h.call(g,d)},a.getElementId=function(u){return"".concat(a.state.instancePrefix,"-").concat(u)},a.getComponents=function(){return XO(a.props)},a.buildCategorizedOptions=function(){return Hx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return M2(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(u,d){a.setState({ariaSelection:Ut({value:u},d)})},a.onMenuMouseDown=function(u){u.button===0&&(u.stopPropagation(),u.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(u){a.blockOptionHover=!1},a.onControlMouseDown=function(u){if(!u.defaultPrevented){var d=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&a.onMenuClose():d&&a.openMenu("first"):(d&&(a.openAfterFocus=!0),a.focusInput()),u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&u.preventDefault()}},a.onDropdownIndicatorMouseDown=function(u){if(!(u&&u.type==="mousedown"&&u.button!==0)&&!a.props.isDisabled){var d=a.props,h=d.isMulti,g=d.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!h}),a.onMenuClose()):a.openMenu("first"),u.preventDefault()}},a.onClearIndicatorMouseDown=function(u){u&&u.type==="mousedown"&&u.button!==0||(a.clearValue(),u.preventDefault(),a.openAfterFocus=!1,u.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(u){typeof a.props.closeMenuOnScroll=="boolean"?u.target instanceof HTMLElement&&Mb(u.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(u)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(u){var d=u.touches,h=d&&d.item(0);h&&(a.initialTouchX=h.clientX,a.initialTouchY=h.clientY,a.userIsDragging=!1)},a.onTouchMove=function(u){var d=u.touches,h=d&&d.item(0);if(h){var g=Math.abs(h.clientX-a.initialTouchX),b=Math.abs(h.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(u){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(u.target)&&a.menuListRef&&!a.menuListRef.contains(u.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(u){a.userIsDragging||a.onControlMouseDown(u)},a.onClearIndicatorTouchEnd=function(u){a.userIsDragging||a.onClearIndicatorMouseDown(u)},a.onDropdownIndicatorTouchEnd=function(u){a.userIsDragging||a.onDropdownIndicatorMouseDown(u)},a.handleInputChange=function(u){var d=a.props.inputValue,h=u.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(h,{action:"input-change",prevInputValue:d}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(u){a.props.onFocus&&a.props.onFocus(u),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(u){var d=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(u),a.onInputChange("",{action:"input-blur",prevInputValue:d}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(u){if(!(a.blockOptionHover||a.state.focusedOption===u)){var d=a.getFocusableOptions(),h=d.indexOf(u);a.setState({focusedOption:u,focusedOptionId:h>-1?a.getFocusedOptionId(u):null})}},a.shouldHideSelectedOptions=function(){return F2(a.props)},a.onValueInputFocus=function(u){u.preventDefault(),u.stopPropagation(),a.focus()},a.onKeyDown=function(u){var d=a.props,h=d.isMulti,g=d.backspaceRemovesValue,b=d.escapeClearsValue,v=d.inputValue,N=d.isClearable,C=d.isDisabled,A=d.menuIsOpen,T=d.onKeyDown,D=d.tabSelectsValue,M=d.openMenuOnFocus,V=a.state,F=V.focusedOption,z=V.focusedValue,B=V.selectValue;if(!C&&!(typeof T=="function"&&(T(u),u.defaultPrevented))){switch(a.blockOptionHover=!0,u.key){case"ArrowLeft":if(!h||v)return;a.focusValue("previous");break;case"ArrowRight":if(!h||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if(z)a.removeValue(z);else{if(!g)return;h?a.popValue():N&&a.clearValue()}break;case"Tab":if(a.isComposing||u.shiftKey||!A||!D||!F||M&&a.isOptionSelected(F,B))return;a.selectOption(F);break;case"Enter":if(u.keyCode===229)break;if(A){if(!F||a.isComposing)return;a.selectOption(F);break}return;case"Escape":A?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):N&&b&&a.clearValue();break;case" ":if(v)return;if(!A){a.openMenu("first");break}if(!F)return;a.selectOption(F);break;case"ArrowUp":A?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":A?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!A)return;a.focusOption("pageup");break;case"PageDown":if(!A)return;a.focusOption("pagedown");break;case"Home":if(!A)return;a.focusOption("first");break;case"End":if(!A)return;a.focusOption("last");break;default:return}u.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++zF),a.state.selectValue=XN(r.value),r.menuIsOpen&&a.state.selectValue.length){var l=a.getFocusableOptionsWithIds(),o=a.buildFocusableOptions(),f=o.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=l,a.state.focusedOption=o[f],a.state.focusedOptionId=rv(l,o[f])}return a}return a3(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&ZN(this.menuListRef,this.focusedOptionRef),_F()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var l=this.props,o=l.isDisabled,f=l.menuIsOpen,u=this.state.isFocused;(u&&!o&&a.isDisabled||u&&f&&!a.menuIsOpen)&&this.focusInput(),u&&o&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!u&&!o&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(ZN(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,l){this.props.onInputChange(a,l)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var l=this,o=this.state,f=o.selectValue,u=o.isFocused,d=this.buildFocusableOptions(),h=a==="first"?0:d.length-1;if(!this.props.isMulti){var g=d.indexOf(f[0]);g>-1&&(h=g)}this.scrollToFocusedOptionOnUpdate=!(u&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:d[h],focusedOptionId:this.getFocusedOptionId(d[h])},function(){return l.onMenuOpen()})}},{key:"focusValue",value:function(a){var l=this.state,o=l.selectValue,f=l.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var u=o.indexOf(f);f||(u=-1);var d=o.length-1,h=-1;if(o.length){switch(a){case"previous":u===0?h=0:u===-1?h=d:h=u-1;break;case"next":u>-1&&u<d&&(h=u+1);break}this.setState({inputIsHidden:h!==-1,focusedValue:o[h]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",l=this.props.pageSize,o=this.state.focusedOption,f=this.getFocusableOptions();if(f.length){var u=0,d=f.indexOf(o);o||(d=-1),a==="up"?u=d>0?d-1:f.length-1:a==="down"?u=(d+1)%f.length:a==="pageup"?(u=d-l,u<0&&(u=0)):a==="pagedown"?(u=d+l,u>f.length-1&&(u=f.length-1)):a==="last"&&(u=f.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:f[u],focusedValue:null,focusedOptionId:this.getFocusedOptionId(f[u])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(iv):Ut(Ut({},iv),this.props.theme):iv}},{key:"getCommonProps",value:function(){var a=this.clearValue,l=this.cx,o=this.getStyles,f=this.getClassNames,u=this.getValue,d=this.selectOption,h=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,N=g.options,C=this.hasValue();return{clearValue:a,cx:l,getStyles:o,getClassNames:f,getValue:u,hasValue:C,isMulti:b,isRtl:v,options:N,selectOption:d,selectProps:g,setValue:h,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,l=a.isClearable,o=a.isMulti;return l===void 0?o:l}},{key:"isOptionDisabled",value:function(a,l){return R2(this.props,a,l)}},{key:"isOptionSelected",value:function(a,l){return L2(this.props,a,l)}},{key:"filterOption",value:function(a,l){return O2(this.props,a,l)}},{key:"formatOptionLabel",value:function(a,l){if(typeof this.props.formatOptionLabel=="function"){var o=this.props.inputValue,f=this.state.selectValue;return this.props.formatOptionLabel(a,{context:l,inputValue:o,selectValue:f})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,l=a.isDisabled,o=a.isSearchable,f=a.inputId,u=a.inputValue,d=a.tabIndex,h=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),N=v.Input,C=this.state,A=C.inputIsHidden,T=C.ariaSelection,D=this.commonProps,M=f||this.getElementId("input"),V=Ut(Ut(Ut({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!o&&{"aria-readonly":!0}),this.hasValue()?(T==null?void 0:T.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return o?w.createElement(N,Yt({},D,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:M,innerRef:this.getInputRef,isDisabled:l,isHidden:A,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:d,form:h,type:"text",value:u},V)):w.createElement(fF,Yt({id:M,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:cb,onFocus:this.onInputFocus,disabled:l,tabIndex:d,inputMode:"none",form:h,value:""},V))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,l=this.getComponents(),o=l.MultiValue,f=l.MultiValueContainer,u=l.MultiValueLabel,d=l.MultiValueRemove,h=l.SingleValue,g=l.Placeholder,b=this.commonProps,v=this.props,N=v.controlShouldRenderValue,C=v.isDisabled,A=v.isMulti,T=v.inputValue,D=v.placeholder,M=this.state,V=M.selectValue,F=M.focusedValue,z=M.isFocused;if(!this.hasValue()||!N)return T?null:w.createElement(g,Yt({},b,{key:"placeholder",isDisabled:C,isFocused:z,innerProps:{id:this.getElementId("placeholder")}}),D);if(A)return V.map(function(U,R){var O=U===F,$="".concat(a.getOptionLabel(U),"-").concat(a.getOptionValue(U));return w.createElement(o,Yt({},b,{components:{Container:f,Label:u,Remove:d},isFocused:O,isDisabled:C,key:$,index:R,removeProps:{onClick:function(){return a.removeValue(U)},onTouchEnd:function(){return a.removeValue(U)},onMouseDown:function(te){te.preventDefault()}},data:U}),a.formatOptionLabel(U,"value"))});if(T)return null;var B=V[0];return w.createElement(h,Yt({},b,{data:B,isDisabled:C}),this.formatOptionLabel(B,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),l=a.ClearIndicator,o=this.commonProps,f=this.props,u=f.isDisabled,d=f.isLoading,h=this.state.isFocused;if(!this.isClearable()||!l||u||!this.hasValue()||d)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(l,Yt({},o,{innerProps:g,isFocused:h}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),l=a.LoadingIndicator,o=this.commonProps,f=this.props,u=f.isDisabled,d=f.isLoading,h=this.state.isFocused;if(!l||!d)return null;var g={"aria-hidden":"true"};return w.createElement(l,Yt({},o,{innerProps:g,isDisabled:u,isFocused:h}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),l=a.DropdownIndicator,o=a.IndicatorSeparator;if(!l||!o)return null;var f=this.commonProps,u=this.props.isDisabled,d=this.state.isFocused;return w.createElement(o,Yt({},f,{isDisabled:u,isFocused:d}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),l=a.DropdownIndicator;if(!l)return null;var o=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused,d={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(l,Yt({},o,{innerProps:d,isDisabled:f,isFocused:u}))}},{key:"renderMenu",value:function(){var a=this,l=this.getComponents(),o=l.Group,f=l.GroupHeading,u=l.Menu,d=l.MenuList,h=l.MenuPortal,g=l.LoadingMessage,b=l.NoOptionsMessage,v=l.Option,N=this.commonProps,C=this.state.focusedOption,A=this.props,T=A.captureMenuScroll,D=A.inputValue,M=A.isLoading,V=A.loadingMessage,F=A.minMenuHeight,z=A.maxMenuHeight,B=A.menuIsOpen,U=A.menuPlacement,R=A.menuPosition,O=A.menuPortalTarget,$=A.menuShouldBlockScroll,W=A.menuShouldScrollIntoView,te=A.noOptionsMessage,ne=A.onMenuScrollToTop,re=A.onMenuScrollToBottom;if(!B)return null;var J=function(I,ce){var xe=I.type,le=I.data,ge=I.isDisabled,ye=I.isSelected,Re=I.label,Ze=I.value,at=C===le,Le=ge?void 0:function(){return a.onOptionHover(le)},Te=ge?void 0:function(){return a.selectOption(le)},we="".concat(a.getElementId("option"),"-").concat(ce),Fe={id:we,onClick:Te,onMouseMove:Le,onMouseOver:Le,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:ye};return w.createElement(v,Yt({},N,{innerProps:Fe,data:le,isDisabled:ge,isSelected:ye,key:we,label:Re,type:xe,value:Ze,isFocused:at,innerRef:at?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(I.data,"menu"))},q;if(this.hasOptions())q=this.getCategorizedOptions().map(function(ie){if(ie.type==="group"){var I=ie.data,ce=ie.options,xe=ie.index,le="".concat(a.getElementId("group"),"-").concat(xe),ge="".concat(le,"-heading");return w.createElement(o,Yt({},N,{key:le,data:I,options:ce,Heading:f,headingProps:{id:ge,data:ie.data},label:a.formatGroupLabel(ie.data)}),ie.options.map(function(ye){return J(ye,"".concat(xe,"-").concat(ye.index))}))}else if(ie.type==="option")return J(ie,"".concat(ie.index))});else if(M){var H=V({inputValue:D});if(H===null)return null;q=w.createElement(g,N,H)}else{var ee=te({inputValue:D});if(ee===null)return null;q=w.createElement(b,N,ee)}var E={minMenuHeight:F,maxMenuHeight:z,menuPlacement:U,menuPosition:R,menuShouldScrollIntoView:W},Q=w.createElement(VL,Yt({},N,E),function(ie){var I=ie.ref,ce=ie.placerProps,xe=ce.placement,le=ce.maxHeight;return w.createElement(u,Yt({},N,E,{innerRef:I,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:M,placement:xe}),w.createElement(xF,{captureEnabled:T,onTopArrive:ne,onBottomArrive:re,lockEnabled:$},function(ge){return w.createElement(d,Yt({},N,{innerRef:function(Re){a.getMenuListRef(Re),ge(Re)},innerProps:{role:"listbox","aria-multiselectable":N.isMulti,id:a.getElementId("listbox")},isLoading:M,maxHeight:le,focusedOption:C}),q)}))});return O||R==="fixed"?w.createElement(h,Yt({},N,{appendTo:O,controlElement:this.controlRef,menuPlacement:U,menuPosition:R}),Q):Q}},{key:"renderFormField",value:function(){var a=this,l=this.props,o=l.delimiter,f=l.isDisabled,u=l.isMulti,d=l.name,h=l.required,g=this.state.selectValue;if(h&&!this.hasValue()&&!f)return w.createElement(wF,{name:d,onFocus:this.onValueInputFocus});if(!(!d||f))if(u)if(o){var b=g.map(function(C){return a.getOptionValue(C)}).join(o);return w.createElement("input",{name:d,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(C,A){return w.createElement("input",{key:"i-".concat(A),name:d,type:"hidden",value:a.getOptionValue(C)})}):w.createElement("input",{name:d,type:"hidden",value:""});return w.createElement("div",null,v)}else{var N=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:d,type:"hidden",value:N})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,l=this.state,o=l.ariaSelection,f=l.focusedOption,u=l.focusedValue,d=l.isFocused,h=l.selectValue,g=this.getFocusableOptions();return w.createElement(sF,Yt({},a,{id:this.getElementId("live-region"),ariaSelection:o,focusedOption:f,focusedValue:u,isFocused:d,selectValue:h,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),l=a.Control,o=a.IndicatorsContainer,f=a.SelectContainer,u=a.ValueContainer,d=this.props,h=d.className,g=d.id,b=d.isDisabled,v=d.menuIsOpen,N=this.state.isFocused,C=this.commonProps=this.getCommonProps();return w.createElement(f,Yt({},C,{className:h,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:N}),this.renderLiveRegion(),w.createElement(l,Yt({},C,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:N,menuIsOpen:v}),w.createElement(u,Yt({},C,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(o,Yt({},C,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,l){var o=l.prevProps,f=l.clearFocusValueOnUpdate,u=l.inputIsHiddenAfterUpdate,d=l.ariaSelection,h=l.isFocused,g=l.prevWasFocused,b=l.instancePrefix,v=a.options,N=a.value,C=a.menuIsOpen,A=a.inputValue,T=a.isMulti,D=XN(N),M={};if(o&&(N!==o.value||v!==o.options||C!==o.menuIsOpen||A!==o.inputValue)){var V=C?OF(a,D):[],F=C?hS(Hx(a,D),"".concat(b,"-option")):[],z=f?FF(l,D):null,B=$F(l,V),U=rv(F,B);M={selectValue:D,focusedOption:B,focusedOptionId:U,focusableOptionsWithIds:F,focusedValue:z,clearFocusValueOnUpdate:!1}}var R=u!=null&&a!==o?{inputIsHidden:u,inputIsHiddenAfterUpdate:void 0}:{},O=d,$=h&&g;return h&&!$&&(O={value:Sx(T,D,D[0]||null),options:D,action:"initial-input-focus"},$=!g),(d==null?void 0:d.action)==="initial-input-focus"&&(O=null),Ut(Ut(Ut({},M),R),{},{prevProps:a,ariaSelection:O,prevWasFocused:$})}}]),t}(w.Component);$2.defaultProps=LF;var BF=w.forwardRef(function(e,n){var t=i3(e);return w.createElement($2,Yt({ref:n},t))}),UF=BF;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let qF,VF;function HF(){return{geminiUrl:qF,vertexUrl:VF}}function GF(e,n,t){var r,a,l;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=HF();return e.vertexai?(a=o.vertexUrl)!==null&&a!==void 0?a:n:(l=o.geminiUrl)!==null&&l!==void 0?l:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mg{}function Xt(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const l=n[a];return l!=null?String(l):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function _(e,n,t){for(let l=0;l<n.length-1;l++){const o=n[l];if(o.endsWith("[]")){const f=o.slice(0,-2);if(!(f in e))if(Array.isArray(t))e[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[f])){const u=e[f];if(Array.isArray(t))for(let d=0;d<u.length;d++){const h=u[d];_(h,n.slice(l+1),t[d])}else for(const d of u)_(d,n.slice(l+1),t)}return}else if(o.endsWith("[0]")){const f=o.slice(0,-3);f in e||(e[f]=[{}]);const u=e[f];_(u[0],n.slice(l+1),t);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function j(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const l=e[a];return Array.isArray(l)?l.map(o=>j(o,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ki(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function z2(e,n){const t=ki(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function B2(e,n){return Array.isArray(n)?n.map(t=>fb(e,t)):[fb(e,n)]}function fb(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function YF(e,n){const t=fb(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function WF(e,n){const t=fb(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function mS(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function U2(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>mS(e,t)):[mS(e,n)]}function a1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function gS(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function yS(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Ca(e,n){if(n==null)throw new Error("ContentUnion is required");return a1(n)?n:{role:"user",parts:U2(e,n)}}function q2(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=Ca(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=Ca(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>Ca(e,t)):[Ca(e,n)]}function hu(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(gS(n)||yS(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ca(e,n)]}const t=[],r=[],a=a1(n[0]);for(const l of n){const o=a1(l);if(o!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(l);else{if(gS(l)||yS(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(l)}}return a||t.push({role:"user",parts:U2(e,r)}),t}function V2(e,n){return n}function H2(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Ib(e,n){return n}function Rb(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function QF(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function pu(e,n){if(typeof n!="string")throw new Error("name must be a string");return QF(e,n,"cachedContents")}function G2(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function mu(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function JF(e){return e!=null&&typeof e=="object"&&"name"in e}function KF(e){return e!=null&&typeof e=="object"&&"video"in e}function XF(e){return e!=null&&typeof e=="object"&&"uri"in e}function Y2(e,n){var t;let r;if(JF(n)&&(r=n.name),!(XF(n)&&(r=n.uri,r===void 0))&&!(KF(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const l=r.split("files/")[1].match(/[a-z0-9]+/);if(l===null)throw new Error(`Could not extract file name from URI ${r}`);r=l[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function W2(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function Q2(e,n){for(const t of["models","tunedModels","publisherModels"])if(ZF(n,t))return n[t];return[]}function ZF(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e6(e,n){const t={};if(j(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function t6(e,n){const t={};if(j(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],e6(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&_(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&_(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&_(t,["text"],h),t}function xS(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>t6(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function n6(){return{}}function i6(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function r6(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],i6(e,r)),t}function a6(e,n){const t={};if(j(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");j(n,["googleSearch"])!=null&&_(t,["googleSearch"],n6());const a=j(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],r6(e,a)),j(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(j(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=j(n,["codeExecution"]);l!=null&&_(t,["codeExecution"],l);const o=j(n,["functionDeclarations"]);return o!=null&&_(t,["functionDeclarations"],o),t}function s6(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function l6(e,n){const t={},r=j(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],s6(e,r)),j(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function o6(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const l=j(n,["expireTime"]);t!==void 0&&l!=null&&_(t,["expireTime"],l);const o=j(n,["displayName"]);t!==void 0&&o!=null&&_(t,["displayName"],o);const f=j(n,["contents"]);if(t!==void 0&&f!=null){let g=hu(e,f);Array.isArray(g)&&(g=g.map(b=>xS(e,b))),_(t,["contents"],g)}const u=j(n,["systemInstruction"]);t!==void 0&&u!=null&&_(t,["systemInstruction"],xS(e,Ca(e,u)));const d=j(n,["tools"]);if(t!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(b=>a6(e,b))),_(t,["tools"],g)}const h=j(n,["toolConfig"]);return t!==void 0&&h!=null&&_(t,["toolConfig"],l6(e,h)),r}function c6(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["model"],z2(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],o6(e,a,t)),t}function u6(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function d6(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function f6(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const l=j(n,["expireTime"]);return t!==void 0&&l!=null&&_(t,["expireTime"],l),r}function h6(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],f6(e,a,t)),t}function p6(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);return t!==void 0&&l!=null&&_(t,["_query","pageToken"],l),r}function m6(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],p6(e,r,t)),t}function g6(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&_(t,["mimeType"],l),t}function y6(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&_(t,["inlineData"],g6(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&_(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&_(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function bS(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>y6(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function x6(){return{}}function b6(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function v6(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],b6(e,r)),t}function w6(){return{}}function N6(e,n){const t={},r=j(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function S6(e,n){const t={},r=j(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],N6(e,r));const a=j(n,["authType"]);a!=null&&_(t,["authType"],a);const l=j(n,["googleServiceAccountConfig"]);l!=null&&_(t,["googleServiceAccountConfig"],l);const o=j(n,["httpBasicAuthConfig"]);o!=null&&_(t,["httpBasicAuthConfig"],o);const f=j(n,["oauthConfig"]);f!=null&&_(t,["oauthConfig"],f);const u=j(n,["oidcConfig"]);return u!=null&&_(t,["oidcConfig"],u),t}function j6(e,n){const t={},r=j(n,["authConfig"]);return r!=null&&_(t,["authConfig"],S6(e,r)),t}function _6(e,n){const t={},r=j(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),j(n,["googleSearch"])!=null&&_(t,["googleSearch"],x6());const l=j(n,["googleSearchRetrieval"]);l!=null&&_(t,["googleSearchRetrieval"],v6(e,l)),j(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],w6());const f=j(n,["googleMaps"]);f!=null&&_(t,["googleMaps"],j6(e,f));const u=j(n,["codeExecution"]);u!=null&&_(t,["codeExecution"],u);const d=j(n,["functionDeclarations"]);return d!=null&&_(t,["functionDeclarations"],d),t}function C6(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function k6(e,n){const t={},r=j(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=j(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function T6(e,n){const t={},r=j(n,["latLng"]);return r!=null&&_(t,["latLng"],k6(e,r)),t}function E6(e,n){const t={},r=j(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],C6(e,r));const a=j(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],T6(e,a)),t}function A6(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const l=j(n,["expireTime"]);t!==void 0&&l!=null&&_(t,["expireTime"],l);const o=j(n,["displayName"]);t!==void 0&&o!=null&&_(t,["displayName"],o);const f=j(n,["contents"]);if(t!==void 0&&f!=null){let g=hu(e,f);Array.isArray(g)&&(g=g.map(b=>bS(e,b))),_(t,["contents"],g)}const u=j(n,["systemInstruction"]);t!==void 0&&u!=null&&_(t,["systemInstruction"],bS(e,Ca(e,u)));const d=j(n,["tools"]);if(t!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(b=>_6(e,b))),_(t,["tools"],g)}const h=j(n,["toolConfig"]);return t!==void 0&&h!=null&&_(t,["toolConfig"],E6(e,h)),r}function P6(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["model"],z2(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],A6(e,a,t)),t}function D6(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function M6(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function I6(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const l=j(n,["expireTime"]);return t!==void 0&&l!=null&&_(t,["expireTime"],l),r}function R6(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],I6(e,a,t)),t}function L6(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);return t!==void 0&&l!=null&&_(t,["_query","pageToken"],l),r}function O6(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],L6(e,r,t)),t}function Gx(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const l=j(n,["model"]);l!=null&&_(t,["model"],l);const o=j(n,["createTime"]);o!=null&&_(t,["createTime"],o);const f=j(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=j(n,["expireTime"]);u!=null&&_(t,["expireTime"],u);const d=j(n,["usageMetadata"]);return d!=null&&_(t,["usageMetadata"],d),t}function F6(){return{}}function $6(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>Gx(e,o))),_(t,["cachedContents"],l)}return t}function Yx(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const l=j(n,["model"]);l!=null&&_(t,["model"],l);const o=j(n,["createTime"]);o!=null&&_(t,["createTime"],o);const f=j(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=j(n,["expireTime"]);u!=null&&_(t,["expireTime"],u);const d=j(n,["usageMetadata"]);return d!=null&&_(t,["usageMetadata"],d),t}function z6(){return{}}function B6(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>Yx(e,o))),_(t,["cachedContents"],l)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var qh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(qh||(qh={}));class Lb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,l;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(l=(a=o.config)===null||a===void 0?void 0:a.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var vS;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(vS||(vS={}));var wS;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(wS||(wS={}));var NS;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(NS||(NS={}));var SS;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(SS||(SS={}));var jS;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(jS||(jS={}));var _S;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(_S||(_S={}));var CS;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(CS||(CS={}));var Vh;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Vh||(Vh={}));var kS;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(kS||(kS={}));var TS;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(TS||(TS={}));var ES;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(ES||(ES={}));var AS;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(AS||(AS={}));var PS;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(PS||(PS={}));var Hh;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Hh||(Hh={}));var s1;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(s1||(s1={}));var l1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(l1||(l1={}));var DS;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(DS||(DS={}));var MS;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(MS||(MS={}));var IS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(IS||(IS={}));var RS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(RS||(RS={}));var LS;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(LS||(LS={}));var OS;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(OS||(OS={}));var FS;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(FS||(FS={}));var $S;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})($S||($S={}));var zS;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(zS||(zS={}));var BS;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(BS||(BS={}));var US;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(US||(US={}));var qS;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(qS||(qS={}));var VS;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(VS||(VS={}));var HS;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(HS||(HS={}));var GS;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(GS||(GS={}));var YS;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(YS||(YS={}));var WS;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(WS||(WS={}));var QS;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(QS||(QS={}));class jx{get text(){var n,t,r,a,l,o,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const g=[];for(const b of(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)!==null&&u!==void 0?u:[]){for(const[v,N]of Object.entries(b))v!=="text"&&v!=="thought"&&(N!==null||N!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;h=!0,d+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var n,t,r,a,l,o,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const g of(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)!==null&&u!==void 0?u:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&h.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(d+=atob(g.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var n,t,r,a,l,o,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var n,t,r,a,l,o,f,u,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var n,t,r,a,l,o,f,u,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class JS{}class KS{}class U6{}class q6{}class XS{}class ZS{}class ej{}class V6{}class tj{}class nj{}class ij{}class H6{}class o1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class G6{}class Y6{}class W6{get text(){var n,t,r;let a="",l=!1;const o=[];for(const f of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(f))u!=="text"&&u!=="thought"&&d!==null&&o.push(u);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;l=!0,a+=f.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?a:void 0}get data(){var n,t,r;let a="";const l=[];for(const o of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,u]of Object.entries(o))f!=="inlineData"&&u!==null&&l.push(f);o.inlineData&&typeof o.inlineData.data=="string"&&(a+=atob(o.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Q6 extends mg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Lb(qh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=P6(this.apiClient,n);return f=Xt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Yx(this.apiClient,h))}else{const d=c6(this.apiClient,n);return f=Xt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Gx(this.apiClient,h))}}async get(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=D6(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Yx(this.apiClient,h))}else{const d=u6(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Gx(this.apiClient,h))}}async delete(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=M6(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=z6(),g=new nj;return Object.assign(g,h),g})}else{const d=d6(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(()=>{const h=F6(),g=new nj;return Object.assign(g,h),g})}}async update(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=R6(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Yx(this.apiClient,h))}else{const d=h6(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Gx(this.apiClient,h))}}async listInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=O6(this.apiClient,n);return f=Xt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=B6(this.apiClient,h),b=new ij;return Object.assign(b,g),b})}else{const d=m6(this.apiClient,n);return f=Xt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=$6(this.apiClient,h),b=new ij;return Object.assign(b,g),b})}}}function rj(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function zr(e){return this instanceof zr?(this.v=e,this):new zr(e)}function hb(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",o),a[Symbol.asyncIterator]=function(){return this},a;function o(v){return function(N){return Promise.resolve(N).then(v,g)}}function f(v,N){r[v]&&(a[v]=function(C){return new Promise(function(A,T){l.push([v,C,A,T])>1||u(v,C)})},N&&(a[v]=N(a[v])))}function u(v,N){try{d(r[v](N))}catch(C){b(l[0][3],C)}}function d(v){v.value instanceof zr?Promise.resolve(v.value.v).then(h,g):b(l[0][2],v)}function h(v){u("next",v)}function g(v){u("throw",v)}function b(v,N){v(N),l.shift(),l.length&&u(l[0][0],l[0][1])}}function c1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof rj=="function"?rj(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(l){t[l]=e[l]&&function(o){return new Promise(function(f,u){o=e[l](o),a(f,u,o.done,o.value)})}}function a(l,o,f,u){Promise.resolve(u).then(function(d){l({value:d,done:f})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function J6(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:J2(t)}function J2(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function K6(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function X6(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const l=[];let o=!0;for(;r<t&&e[r].role==="model";)l.push(e[r]),o&&!J2(e[r])&&(o=!1),r++;o&&(n.push(a),n.push(...l))}return n}class Z6{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new e5(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class e5{constructor(n,t,r,a={},l=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=l,this.sendPromise=Promise.resolve(),K6(l)}async sendMessage(n){var t;await this.sendPromise;const r=Ca(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,o;const u=(o=(l=(await a).candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content,d=u?[u]:[];this.recordHistory(r,d)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=Ca(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const l=await a;return this.processStreamResponse(l,r)}getHistory(n=!1){return n?X6(this.history):this.history}processStreamResponse(n,t){var r,a;return hb(this,arguments,function*(){var o,f,u,d;const h=[];try{for(var g=!0,b=c1(n),v;v=yield zr(b.next()),o=v.done,!o;g=!0){d=v.value,g=!1;const N=d;if(J6(N)){const C=(a=(r=N.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;C!==void 0&&h.push(C)}yield yield zr(N)}}catch(N){f={error:N}}finally{try{!g&&!o&&(u=b.return)&&(yield zr(u.call(b)))}finally{if(f)throw f.error}}this.recordHistory(t,h)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function t5(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);return t!==void 0&&l!=null&&_(t,["_query","pageToken"],l),r}function n5(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],t5(e,r,t)),t}function i5(e,n){const t={},r=j(n,["details"]);r!=null&&_(t,["details"],r);const a=j(n,["message"]);a!=null&&_(t,["message"],a);const l=j(n,["code"]);return l!=null&&_(t,["code"],l),t}function r5(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const l=j(n,["mimeType"]);l!=null&&_(t,["mimeType"],l);const o=j(n,["sizeBytes"]);o!=null&&_(t,["sizeBytes"],o);const f=j(n,["createTime"]);f!=null&&_(t,["createTime"],f);const u=j(n,["expirationTime"]);u!=null&&_(t,["expirationTime"],u);const d=j(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const h=j(n,["sha256Hash"]);h!=null&&_(t,["sha256Hash"],h);const g=j(n,["uri"]);g!=null&&_(t,["uri"],g);const b=j(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=j(n,["state"]);v!=null&&_(t,["state"],v);const N=j(n,["source"]);N!=null&&_(t,["source"],N);const C=j(n,["videoMetadata"]);C!=null&&_(t,["videoMetadata"],C);const A=j(n,["error"]);return A!=null&&_(t,["error"],i5(e,A)),t}function a5(e,n){const t={},r=j(n,["file"]);r!=null&&_(t,["file"],r5(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function s5(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","file"],Y2(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function l5(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","file"],Y2(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function o5(e,n){const t={},r=j(n,["details"]);r!=null&&_(t,["details"],r);const a=j(n,["message"]);a!=null&&_(t,["message"],a);const l=j(n,["code"]);return l!=null&&_(t,["code"],l),t}function u1(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const l=j(n,["mimeType"]);l!=null&&_(t,["mimeType"],l);const o=j(n,["sizeBytes"]);o!=null&&_(t,["sizeBytes"],o);const f=j(n,["createTime"]);f!=null&&_(t,["createTime"],f);const u=j(n,["expirationTime"]);u!=null&&_(t,["expirationTime"],u);const d=j(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const h=j(n,["sha256Hash"]);h!=null&&_(t,["sha256Hash"],h);const g=j(n,["uri"]);g!=null&&_(t,["uri"],g);const b=j(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=j(n,["state"]);v!=null&&_(t,["state"],v);const N=j(n,["source"]);N!=null&&_(t,["source"],N);const C=j(n,["videoMetadata"]);C!=null&&_(t,["videoMetadata"],C);const A=j(n,["error"]);return A!=null&&_(t,["error"],o5(e,A)),t}function c5(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["files"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>u1(e,o))),_(t,["files"],l)}return t}function u5(){return{}}function d5(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class f5 extends mg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Lb(qh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>u1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=n5(this.apiClient,n);return l=Xt("files",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=c5(this.apiClient,u),h=new H6;return Object.assign(h,d),h})}}async createInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=a5(this.apiClient,n);return l=Xt("upload/v1beta/files",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(()=>{const u=u5(),d=new G6;return Object.assign(d,u),d})}}async get(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=s5(this.apiClient,n);return l=Xt("files/{file}",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>u1(this.apiClient,u))}}async delete(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=l5(this.apiClient,n);return l=Xt("files/{file}",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(()=>{const u=d5(),d=new Y6;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function h5(e,n){const t={};if(j(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function p5(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&_(t,["mimeType"],l),t}function m5(e,n){const t={};if(j(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],h5(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&_(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&_(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&_(t,["text"],h),t}function g5(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&_(t,["inlineData"],p5(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&_(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&_(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function y5(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>m5(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function x5(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>g5(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function b5(){return{}}function v5(){return{}}function w5(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function N5(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function S5(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],w5(e,r)),t}function j5(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],N5(e,r)),t}function _5(){return{}}function C5(e,n){const t={},r=j(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function k5(e,n){const t={},r=j(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],C5(e,r));const a=j(n,["authType"]);a!=null&&_(t,["authType"],a);const l=j(n,["googleServiceAccountConfig"]);l!=null&&_(t,["googleServiceAccountConfig"],l);const o=j(n,["httpBasicAuthConfig"]);o!=null&&_(t,["httpBasicAuthConfig"],o);const f=j(n,["oauthConfig"]);f!=null&&_(t,["oauthConfig"],f);const u=j(n,["oidcConfig"]);return u!=null&&_(t,["oidcConfig"],u),t}function T5(e,n){const t={},r=j(n,["authConfig"]);return r!=null&&_(t,["authConfig"],k5(e,r)),t}function E5(e,n){const t={};if(j(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");j(n,["googleSearch"])!=null&&_(t,["googleSearch"],b5());const a=j(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],S5(e,a)),j(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(j(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=j(n,["codeExecution"]);l!=null&&_(t,["codeExecution"],l);const o=j(n,["functionDeclarations"]);return o!=null&&_(t,["functionDeclarations"],o),t}function A5(e,n){const t={},r=j(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),j(n,["googleSearch"])!=null&&_(t,["googleSearch"],v5());const l=j(n,["googleSearchRetrieval"]);l!=null&&_(t,["googleSearchRetrieval"],j5(e,l)),j(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],_5());const f=j(n,["googleMaps"]);f!=null&&_(t,["googleMaps"],T5(e,f));const u=j(n,["codeExecution"]);u!=null&&_(t,["codeExecution"],u);const d=j(n,["functionDeclarations"]);return d!=null&&_(t,["functionDeclarations"],d),t}function P5(e,n){const t={},r=j(n,["handle"]);if(r!=null&&_(t,["handle"],r),j(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function D5(e,n){const t={},r=j(n,["handle"]);r!=null&&_(t,["handle"],r);const a=j(n,["transparent"]);return a!=null&&_(t,["transparent"],a),t}function aj(){return{}}function sj(){return{}}function M5(e,n){const t={},r=j(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=j(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const l=j(n,["endOfSpeechSensitivity"]);l!=null&&_(t,["endOfSpeechSensitivity"],l);const o=j(n,["prefixPaddingMs"]);o!=null&&_(t,["prefixPaddingMs"],o);const f=j(n,["silenceDurationMs"]);return f!=null&&_(t,["silenceDurationMs"],f),t}function I5(e,n){const t={},r=j(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=j(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const l=j(n,["endOfSpeechSensitivity"]);l!=null&&_(t,["endOfSpeechSensitivity"],l);const o=j(n,["prefixPaddingMs"]);o!=null&&_(t,["prefixPaddingMs"],o);const f=j(n,["silenceDurationMs"]);return f!=null&&_(t,["silenceDurationMs"],f),t}function R5(e,n){const t={},r=j(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],M5(e,r));const a=j(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const l=j(n,["turnCoverage"]);return l!=null&&_(t,["turnCoverage"],l),t}function L5(e,n){const t={},r=j(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],I5(e,r));const a=j(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const l=j(n,["turnCoverage"]);return l!=null&&_(t,["turnCoverage"],l),t}function O5(e,n){const t={},r=j(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function F5(e,n){const t={},r=j(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function $5(e,n){const t={},r=j(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=j(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],O5(e,a)),t}function z5(e,n){const t={},r=j(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=j(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],F5(e,a)),t}function B5(e,n,t){const r={},a=j(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const l=j(n,["responseModalities"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","responseModalities"],l);const o=j(n,["temperature"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","temperature"],o);const f=j(n,["topP"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topP"],f);const u=j(n,["topK"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","topK"],u);const d=j(n,["maxOutputTokens"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","maxOutputTokens"],d);const h=j(n,["mediaResolution"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","mediaResolution"],h);const g=j(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=j(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=j(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],y5(e,Ca(e,v)));const N=j(n,["tools"]);if(t!==void 0&&N!=null){let V=Rb(e,N);Array.isArray(V)&&(V=V.map(F=>E5(e,Ib(e,F)))),_(t,["setup","tools"],V)}const C=j(n,["sessionResumption"]);t!==void 0&&C!=null&&_(t,["setup","sessionResumption"],P5(e,C));const A=j(n,["inputAudioTranscription"]);t!==void 0&&A!=null&&_(t,["setup","inputAudioTranscription"],aj());const T=j(n,["outputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","outputAudioTranscription"],aj());const D=j(n,["realtimeInputConfig"]);t!==void 0&&D!=null&&_(t,["setup","realtimeInputConfig"],R5(e,D));const M=j(n,["contextWindowCompression"]);return t!==void 0&&M!=null&&_(t,["setup","contextWindowCompression"],$5(e,M)),r}function U5(e,n,t){const r={},a=j(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const l=j(n,["responseModalities"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","responseModalities"],l);const o=j(n,["temperature"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","temperature"],o);const f=j(n,["topP"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topP"],f);const u=j(n,["topK"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","topK"],u);const d=j(n,["maxOutputTokens"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","maxOutputTokens"],d);const h=j(n,["mediaResolution"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","mediaResolution"],h);const g=j(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=j(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=j(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],x5(e,Ca(e,v)));const N=j(n,["tools"]);if(t!==void 0&&N!=null){let V=Rb(e,N);Array.isArray(V)&&(V=V.map(F=>A5(e,Ib(e,F)))),_(t,["setup","tools"],V)}const C=j(n,["sessionResumption"]);t!==void 0&&C!=null&&_(t,["setup","sessionResumption"],D5(e,C));const A=j(n,["inputAudioTranscription"]);t!==void 0&&A!=null&&_(t,["setup","inputAudioTranscription"],sj());const T=j(n,["outputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","outputAudioTranscription"],sj());const D=j(n,["realtimeInputConfig"]);t!==void 0&&D!=null&&_(t,["setup","realtimeInputConfig"],L5(e,D));const M=j(n,["contextWindowCompression"]);return t!==void 0&&M!=null&&_(t,["setup","contextWindowCompression"],z5(e,M)),r}function q5(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["setup","model"],ki(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],B5(e,a,t)),t}function V5(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["setup","model"],ki(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],U5(e,a,t)),t}function H5(){return{}}function G5(){return{}}function Y5(){return{}}function W5(){return{}}function Q5(e,n){const t={},r=j(n,["media"]);r!=null&&_(t,["mediaChunks"],B2(e,r));const a=j(n,["audio"]);a!=null&&_(t,["audio"],WF(e,a));const l=j(n,["audioStreamEnd"]);l!=null&&_(t,["audioStreamEnd"],l);const o=j(n,["video"]);o!=null&&_(t,["video"],YF(e,o));const f=j(n,["text"]);return f!=null&&_(t,["text"],f),j(n,["activityStart"])!=null&&_(t,["activityStart"],H5()),j(n,["activityEnd"])!=null&&_(t,["activityEnd"],Y5()),t}function J5(e,n){const t={},r=j(n,["media"]);if(r!=null&&_(t,["mediaChunks"],B2(e,r)),j(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=j(n,["audioStreamEnd"]);if(a!=null&&_(t,["audioStreamEnd"],a),j(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(j(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return j(n,["activityStart"])!=null&&_(t,["activityStart"],G5()),j(n,["activityEnd"])!=null&&_(t,["activityEnd"],W5()),t}function K5(){return{}}function X5(){return{}}function Z5(e,n){const t={},r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function e$(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&_(t,["mimeType"],l),t}function t$(e,n){const t={},r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],Z5(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&_(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&_(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&_(t,["text"],h),t}function n$(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&_(t,["inlineData"],e$(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&_(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&_(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function i$(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>t$(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function r$(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>n$(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function lj(e,n){const t={},r=j(n,["text"]);r!=null&&_(t,["text"],r);const a=j(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function oj(e,n){const t={},r=j(n,["text"]);r!=null&&_(t,["text"],r);const a=j(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function a$(e,n){const t={},r=j(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],i$(e,r));const a=j(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const l=j(n,["interrupted"]);l!=null&&_(t,["interrupted"],l);const o=j(n,["groundingMetadata"]);o!=null&&_(t,["groundingMetadata"],o);const f=j(n,["generationComplete"]);f!=null&&_(t,["generationComplete"],f);const u=j(n,["inputTranscription"]);u!=null&&_(t,["inputTranscription"],lj(e,u));const d=j(n,["outputTranscription"]);return d!=null&&_(t,["outputTranscription"],lj(e,d)),t}function s$(e,n){const t={},r=j(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],r$(e,r));const a=j(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const l=j(n,["interrupted"]);l!=null&&_(t,["interrupted"],l);const o=j(n,["groundingMetadata"]);o!=null&&_(t,["groundingMetadata"],o);const f=j(n,["generationComplete"]);f!=null&&_(t,["generationComplete"],f);const u=j(n,["inputTranscription"]);u!=null&&_(t,["inputTranscription"],oj(e,u));const d=j(n,["outputTranscription"]);return d!=null&&_(t,["outputTranscription"],oj(e,d)),t}function l$(e,n){const t={},r=j(n,["id"]);r!=null&&_(t,["id"],r);const a=j(n,["args"]);a!=null&&_(t,["args"],a);const l=j(n,["name"]);return l!=null&&_(t,["name"],l),t}function o$(e,n){const t={},r=j(n,["args"]);r!=null&&_(t,["args"],r);const a=j(n,["name"]);return a!=null&&_(t,["name"],a),t}function c$(e,n){const t={},r=j(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l$(e,l))),_(t,["functionCalls"],a)}return t}function u$(e,n){const t={},r=j(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>o$(e,l))),_(t,["functionCalls"],a)}return t}function d$(e,n){const t={},r=j(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function f$(e,n){const t={},r=j(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function _x(e,n){const t={},r=j(n,["modality"]);r!=null&&_(t,["modality"],r);const a=j(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function Cx(e,n){const t={},r=j(n,["modality"]);r!=null&&_(t,["modality"],r);const a=j(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function h$(e,n){const t={},r=j(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=j(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const l=j(n,["responseTokenCount"]);l!=null&&_(t,["responseTokenCount"],l);const o=j(n,["toolUsePromptTokenCount"]);o!=null&&_(t,["toolUsePromptTokenCount"],o);const f=j(n,["thoughtsTokenCount"]);f!=null&&_(t,["thoughtsTokenCount"],f);const u=j(n,["totalTokenCount"]);u!=null&&_(t,["totalTokenCount"],u);const d=j(n,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(N=>_x(e,N))),_(t,["promptTokensDetails"],v)}const h=j(n,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(N=>_x(e,N))),_(t,["cacheTokensDetails"],v)}const g=j(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(N=>_x(e,N))),_(t,["responseTokensDetails"],v)}const b=j(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(N=>_x(e,N))),_(t,["toolUsePromptTokensDetails"],v)}return t}function p$(e,n){const t={},r=j(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=j(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const l=j(n,["candidatesTokenCount"]);l!=null&&_(t,["responseTokenCount"],l);const o=j(n,["toolUsePromptTokenCount"]);o!=null&&_(t,["toolUsePromptTokenCount"],o);const f=j(n,["thoughtsTokenCount"]);f!=null&&_(t,["thoughtsTokenCount"],f);const u=j(n,["totalTokenCount"]);u!=null&&_(t,["totalTokenCount"],u);const d=j(n,["promptTokensDetails"]);if(d!=null){let N=d;Array.isArray(N)&&(N=N.map(C=>Cx(e,C))),_(t,["promptTokensDetails"],N)}const h=j(n,["cacheTokensDetails"]);if(h!=null){let N=h;Array.isArray(N)&&(N=N.map(C=>Cx(e,C))),_(t,["cacheTokensDetails"],N)}const g=j(n,["candidatesTokensDetails"]);if(g!=null){let N=g;Array.isArray(N)&&(N=N.map(C=>Cx(e,C))),_(t,["responseTokensDetails"],N)}const b=j(n,["toolUsePromptTokensDetails"]);if(b!=null){let N=b;Array.isArray(N)&&(N=N.map(C=>Cx(e,C))),_(t,["toolUsePromptTokensDetails"],N)}const v=j(n,["trafficType"]);return v!=null&&_(t,["trafficType"],v),t}function m$(e,n){const t={},r=j(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function g$(e,n){const t={},r=j(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function y$(e,n){const t={},r=j(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=j(n,["resumable"]);a!=null&&_(t,["resumable"],a);const l=j(n,["lastConsumedClientMessageIndex"]);return l!=null&&_(t,["lastConsumedClientMessageIndex"],l),t}function x$(e,n){const t={},r=j(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=j(n,["resumable"]);a!=null&&_(t,["resumable"],a);const l=j(n,["lastConsumedClientMessageIndex"]);return l!=null&&_(t,["lastConsumedClientMessageIndex"],l),t}function b$(e,n){const t={};j(n,["setupComplete"])!=null&&_(t,["setupComplete"],K5());const a=j(n,["serverContent"]);a!=null&&_(t,["serverContent"],a$(e,a));const l=j(n,["toolCall"]);l!=null&&_(t,["toolCall"],c$(e,l));const o=j(n,["toolCallCancellation"]);o!=null&&_(t,["toolCallCancellation"],d$(e,o));const f=j(n,["usageMetadata"]);f!=null&&_(t,["usageMetadata"],h$(e,f));const u=j(n,["goAway"]);u!=null&&_(t,["goAway"],m$(e,u));const d=j(n,["sessionResumptionUpdate"]);return d!=null&&_(t,["sessionResumptionUpdate"],y$(e,d)),t}function v$(e,n){const t={};j(n,["setupComplete"])!=null&&_(t,["setupComplete"],X5());const a=j(n,["serverContent"]);a!=null&&_(t,["serverContent"],s$(e,a));const l=j(n,["toolCall"]);l!=null&&_(t,["toolCall"],u$(e,l));const o=j(n,["toolCallCancellation"]);o!=null&&_(t,["toolCallCancellation"],f$(e,o));const f=j(n,["usageMetadata"]);f!=null&&_(t,["usageMetadata"],p$(e,f));const u=j(n,["goAway"]);u!=null&&_(t,["goAway"],g$(e,u));const d=j(n,["sessionResumptionUpdate"]);return d!=null&&_(t,["sessionResumptionUpdate"],x$(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function w$(e,n){const t={};if(j(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function N$(e,n){const t={};if(j(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],w$(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&_(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&_(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&_(t,["text"],h),t}function Ob(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>N$(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function S$(e,n){const t={};if(j(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=j(n,["category"]);r!=null&&_(t,["category"],r);const a=j(n,["threshold"]);return a!=null&&_(t,["threshold"],a),t}function j$(){return{}}function _$(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function C$(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],_$(e,r)),t}function k$(e,n){const t={};if(j(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");j(n,["googleSearch"])!=null&&_(t,["googleSearch"],j$());const a=j(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],C$(e,a)),j(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(j(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=j(n,["codeExecution"]);l!=null&&_(t,["codeExecution"],l);const o=j(n,["functionDeclarations"]);return o!=null&&_(t,["functionDeclarations"],o),t}function T$(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function E$(e,n){const t={},r=j(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],T$(e,r)),j(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function A$(e,n){const t={},r=j(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function P$(e,n){const t={},r=j(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],A$(e,r)),t}function D$(e,n){const t={},r=j(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],P$(e,r));const a=j(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function M$(e,n){const t={},r=j(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=j(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function I$(e,n,t){const r={},a=j(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Ob(e,Ca(e,a)));const l=j(n,["temperature"]);l!=null&&_(r,["temperature"],l);const o=j(n,["topP"]);o!=null&&_(r,["topP"],o);const f=j(n,["topK"]);f!=null&&_(r,["topK"],f);const u=j(n,["candidateCount"]);u!=null&&_(r,["candidateCount"],u);const d=j(n,["maxOutputTokens"]);d!=null&&_(r,["maxOutputTokens"],d);const h=j(n,["stopSequences"]);h!=null&&_(r,["stopSequences"],h);const g=j(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=j(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=j(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const N=j(n,["frequencyPenalty"]);N!=null&&_(r,["frequencyPenalty"],N);const C=j(n,["seed"]);C!=null&&_(r,["seed"],C);const A=j(n,["responseMimeType"]);A!=null&&_(r,["responseMimeType"],A);const T=j(n,["responseSchema"]);if(T!=null&&_(r,["responseSchema"],V2(e,T)),j(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(j(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const D=j(n,["safetySettings"]);if(t!==void 0&&D!=null){let O=D;Array.isArray(O)&&(O=O.map($=>S$(e,$))),_(t,["safetySettings"],O)}const M=j(n,["tools"]);if(t!==void 0&&M!=null){let O=Rb(e,M);Array.isArray(O)&&(O=O.map($=>k$(e,Ib(e,$)))),_(t,["tools"],O)}const V=j(n,["toolConfig"]);if(t!==void 0&&V!=null&&_(t,["toolConfig"],E$(e,V)),j(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=j(n,["cachedContent"]);t!==void 0&&F!=null&&_(t,["cachedContent"],pu(e,F));const z=j(n,["responseModalities"]);z!=null&&_(r,["responseModalities"],z);const B=j(n,["mediaResolution"]);B!=null&&_(r,["mediaResolution"],B);const U=j(n,["speechConfig"]);if(U!=null&&_(r,["speechConfig"],D$(e,H2(e,U))),j(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=j(n,["thinkingConfig"]);return R!=null&&_(r,["thinkingConfig"],M$(e,R)),r}function cj(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["contents"]);if(a!=null){let o=hu(e,a);Array.isArray(o)&&(o=o.map(f=>Ob(e,f))),_(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&_(t,["generationConfig"],I$(e,l,t)),t}function R$(e,n,t){const r={},a=j(n,["taskType"]);t!==void 0&&a!=null&&_(t,["requests[]","taskType"],a);const l=j(n,["title"]);t!==void 0&&l!=null&&_(t,["requests[]","title"],l);const o=j(n,["outputDimensionality"]);if(t!==void 0&&o!=null&&_(t,["requests[]","outputDimensionality"],o),j(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(j(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function L$(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["contents"]);a!=null&&_(t,["requests[]","content"],q2(e,a));const l=j(n,["config"]);l!=null&&_(t,["config"],R$(e,l,t));const o=j(n,["model"]);return o!==void 0&&_(t,["requests[]","model"],ki(e,o)),t}function O$(e,n,t){const r={};if(j(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(j(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=j(n,["numberOfImages"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const l=j(n,["aspectRatio"]);t!==void 0&&l!=null&&_(t,["parameters","aspectRatio"],l);const o=j(n,["guidanceScale"]);if(t!==void 0&&o!=null&&_(t,["parameters","guidanceScale"],o),j(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const f=j(n,["safetyFilterLevel"]);t!==void 0&&f!=null&&_(t,["parameters","safetySetting"],f);const u=j(n,["personGeneration"]);t!==void 0&&u!=null&&_(t,["parameters","personGeneration"],u);const d=j(n,["includeSafetyAttributes"]);t!==void 0&&d!=null&&_(t,["parameters","includeSafetyAttributes"],d);const h=j(n,["includeRaiReason"]);t!==void 0&&h!=null&&_(t,["parameters","includeRaiReason"],h);const g=j(n,["language"]);t!==void 0&&g!=null&&_(t,["parameters","language"],g);const b=j(n,["outputMimeType"]);t!==void 0&&b!=null&&_(t,["parameters","outputOptions","mimeType"],b);const v=j(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&_(t,["parameters","outputOptions","compressionQuality"],v),j(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(j(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function F$(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const l=j(n,["config"]);return l!=null&&_(t,["config"],O$(e,l,t)),t}function $$(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],ki(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function z$(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);t!==void 0&&l!=null&&_(t,["_query","pageToken"],l);const o=j(n,["filter"]);t!==void 0&&o!=null&&_(t,["_query","filter"],o);const f=j(n,["queryBase"]);return t!==void 0&&f!=null&&_(t,["_url","models_url"],W2(e,f)),r}function B$(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],z$(e,r,t)),t}function U$(e,n,t){const r={},a=j(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const l=j(n,["description"]);t!==void 0&&l!=null&&_(t,["description"],l);const o=j(n,["defaultCheckpointId"]);return t!==void 0&&o!=null&&_(t,["defaultCheckpointId"],o),r}function q$(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],ki(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],U$(e,a,t)),t}function V$(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],ki(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function H$(e,n){const t={};if(j(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(j(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(j(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function G$(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["contents"]);if(a!=null){let o=hu(e,a);Array.isArray(o)&&(o=o.map(f=>Ob(e,f))),_(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&_(t,["config"],H$(e,l)),t}function Y$(e,n){const t={};if(j(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=j(n,["imageBytes"]);r!=null&&_(t,["bytesBase64Encoded"],mu(e,r));const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function W$(e,n,t){const r={},a=j(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a),j(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(j(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=j(n,["durationSeconds"]);if(t!==void 0&&l!=null&&_(t,["parameters","durationSeconds"],l),j(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=j(n,["aspectRatio"]);if(t!==void 0&&o!=null&&_(t,["parameters","aspectRatio"],o),j(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const f=j(n,["personGeneration"]);if(t!==void 0&&f!=null&&_(t,["parameters","personGeneration"],f),j(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=j(n,["negativePrompt"]);if(t!==void 0&&u!=null&&_(t,["parameters","negativePrompt"],u),j(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Q$(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const l=j(n,["image"]);l!=null&&_(t,["instances[0]","image"],Y$(e,l));const o=j(n,["config"]);return o!=null&&_(t,["config"],W$(e,o,t)),t}function J$(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&_(t,["mimeType"],l),t}function K$(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&_(t,["inlineData"],J$(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&_(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&_(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function Xh(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>K$(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function X$(e,n){const t={},r=j(n,["featureSelectionPreference"]);return r!=null&&_(t,["featureSelectionPreference"],r),t}function Z$(e,n){const t={},r=j(n,["method"]);r!=null&&_(t,["method"],r);const a=j(n,["category"]);a!=null&&_(t,["category"],a);const l=j(n,["threshold"]);return l!=null&&_(t,["threshold"],l),t}function ez(){return{}}function tz(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function nz(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],tz(e,r)),t}function iz(){return{}}function rz(e,n){const t={},r=j(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function az(e,n){const t={},r=j(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],rz(e,r));const a=j(n,["authType"]);a!=null&&_(t,["authType"],a);const l=j(n,["googleServiceAccountConfig"]);l!=null&&_(t,["googleServiceAccountConfig"],l);const o=j(n,["httpBasicAuthConfig"]);o!=null&&_(t,["httpBasicAuthConfig"],o);const f=j(n,["oauthConfig"]);f!=null&&_(t,["oauthConfig"],f);const u=j(n,["oidcConfig"]);return u!=null&&_(t,["oidcConfig"],u),t}function sz(e,n){const t={},r=j(n,["authConfig"]);return r!=null&&_(t,["authConfig"],az(e,r)),t}function K2(e,n){const t={},r=j(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),j(n,["googleSearch"])!=null&&_(t,["googleSearch"],ez());const l=j(n,["googleSearchRetrieval"]);l!=null&&_(t,["googleSearchRetrieval"],nz(e,l)),j(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],iz());const f=j(n,["googleMaps"]);f!=null&&_(t,["googleMaps"],sz(e,f));const u=j(n,["codeExecution"]);u!=null&&_(t,["codeExecution"],u);const d=j(n,["functionDeclarations"]);return d!=null&&_(t,["functionDeclarations"],d),t}function lz(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function oz(e,n){const t={},r=j(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=j(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function cz(e,n){const t={},r=j(n,["latLng"]);return r!=null&&_(t,["latLng"],oz(e,r)),t}function uz(e,n){const t={},r=j(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],lz(e,r));const a=j(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],cz(e,a)),t}function dz(e,n){const t={},r=j(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function fz(e,n){const t={},r=j(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],dz(e,r)),t}function hz(e,n){const t={},r=j(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],fz(e,r));const a=j(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function pz(e,n){const t={},r=j(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=j(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function mz(e,n,t){const r={},a=j(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Xh(e,Ca(e,a)));const l=j(n,["temperature"]);l!=null&&_(r,["temperature"],l);const o=j(n,["topP"]);o!=null&&_(r,["topP"],o);const f=j(n,["topK"]);f!=null&&_(r,["topK"],f);const u=j(n,["candidateCount"]);u!=null&&_(r,["candidateCount"],u);const d=j(n,["maxOutputTokens"]);d!=null&&_(r,["maxOutputTokens"],d);const h=j(n,["stopSequences"]);h!=null&&_(r,["stopSequences"],h);const g=j(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=j(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=j(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const N=j(n,["frequencyPenalty"]);N!=null&&_(r,["frequencyPenalty"],N);const C=j(n,["seed"]);C!=null&&_(r,["seed"],C);const A=j(n,["responseMimeType"]);A!=null&&_(r,["responseMimeType"],A);const T=j(n,["responseSchema"]);T!=null&&_(r,["responseSchema"],V2(e,T));const D=j(n,["routingConfig"]);D!=null&&_(r,["routingConfig"],D);const M=j(n,["modelSelectionConfig"]);M!=null&&_(r,["modelConfig"],X$(e,M));const V=j(n,["safetySettings"]);if(t!==void 0&&V!=null){let ne=V;Array.isArray(ne)&&(ne=ne.map(re=>Z$(e,re))),_(t,["safetySettings"],ne)}const F=j(n,["tools"]);if(t!==void 0&&F!=null){let ne=Rb(e,F);Array.isArray(ne)&&(ne=ne.map(re=>K2(e,Ib(e,re)))),_(t,["tools"],ne)}const z=j(n,["toolConfig"]);t!==void 0&&z!=null&&_(t,["toolConfig"],uz(e,z));const B=j(n,["labels"]);t!==void 0&&B!=null&&_(t,["labels"],B);const U=j(n,["cachedContent"]);t!==void 0&&U!=null&&_(t,["cachedContent"],pu(e,U));const R=j(n,["responseModalities"]);R!=null&&_(r,["responseModalities"],R);const O=j(n,["mediaResolution"]);O!=null&&_(r,["mediaResolution"],O);const $=j(n,["speechConfig"]);$!=null&&_(r,["speechConfig"],hz(e,H2(e,$)));const W=j(n,["audioTimestamp"]);W!=null&&_(r,["audioTimestamp"],W);const te=j(n,["thinkingConfig"]);return te!=null&&_(r,["thinkingConfig"],pz(e,te)),r}function uj(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["contents"]);if(a!=null){let o=hu(e,a);Array.isArray(o)&&(o=o.map(f=>Xh(e,f))),_(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&_(t,["generationConfig"],mz(e,l,t)),t}function gz(e,n,t){const r={},a=j(n,["taskType"]);t!==void 0&&a!=null&&_(t,["instances[]","task_type"],a);const l=j(n,["title"]);t!==void 0&&l!=null&&_(t,["instances[]","title"],l);const o=j(n,["outputDimensionality"]);t!==void 0&&o!=null&&_(t,["parameters","outputDimensionality"],o);const f=j(n,["mimeType"]);t!==void 0&&f!=null&&_(t,["instances[]","mimeType"],f);const u=j(n,["autoTruncate"]);return t!==void 0&&u!=null&&_(t,["parameters","autoTruncate"],u),r}function yz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["contents"]);a!=null&&_(t,["instances[]","content"],q2(e,a));const l=j(n,["config"]);return l!=null&&_(t,["config"],gz(e,l,t)),t}function xz(e,n,t){const r={},a=j(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const l=j(n,["negativePrompt"]);t!==void 0&&l!=null&&_(t,["parameters","negativePrompt"],l);const o=j(n,["numberOfImages"]);t!==void 0&&o!=null&&_(t,["parameters","sampleCount"],o);const f=j(n,["aspectRatio"]);t!==void 0&&f!=null&&_(t,["parameters","aspectRatio"],f);const u=j(n,["guidanceScale"]);t!==void 0&&u!=null&&_(t,["parameters","guidanceScale"],u);const d=j(n,["seed"]);t!==void 0&&d!=null&&_(t,["parameters","seed"],d);const h=j(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&_(t,["parameters","safetySetting"],h);const g=j(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=j(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=j(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const N=j(n,["language"]);t!==void 0&&N!=null&&_(t,["parameters","language"],N);const C=j(n,["outputMimeType"]);t!==void 0&&C!=null&&_(t,["parameters","outputOptions","mimeType"],C);const A=j(n,["outputCompressionQuality"]);t!==void 0&&A!=null&&_(t,["parameters","outputOptions","compressionQuality"],A);const T=j(n,["addWatermark"]);t!==void 0&&T!=null&&_(t,["parameters","addWatermark"],T);const D=j(n,["enhancePrompt"]);return t!==void 0&&D!=null&&_(t,["parameters","enhancePrompt"],D),r}function bz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const l=j(n,["config"]);return l!=null&&_(t,["config"],xz(e,l,t)),t}function xw(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=j(n,["imageBytes"]);a!=null&&_(t,["bytesBase64Encoded"],mu(e,a));const l=j(n,["mimeType"]);return l!=null&&_(t,["mimeType"],l),t}function vz(e,n){const t={},r=j(n,["maskMode"]);r!=null&&_(t,["maskMode"],r);const a=j(n,["segmentationClasses"]);a!=null&&_(t,["maskClasses"],a);const l=j(n,["maskDilation"]);return l!=null&&_(t,["dilation"],l),t}function wz(e,n){const t={},r=j(n,["controlType"]);r!=null&&_(t,["controlType"],r);const a=j(n,["enableControlImageComputation"]);return a!=null&&_(t,["computeControl"],a),t}function Nz(e,n){const t={},r=j(n,["styleDescription"]);return r!=null&&_(t,["styleDescription"],r),t}function Sz(e,n){const t={},r=j(n,["subjectType"]);r!=null&&_(t,["subjectType"],r);const a=j(n,["subjectDescription"]);return a!=null&&_(t,["subjectDescription"],a),t}function jz(e,n){const t={},r=j(n,["referenceImage"]);r!=null&&_(t,["referenceImage"],xw(e,r));const a=j(n,["referenceId"]);a!=null&&_(t,["referenceId"],a);const l=j(n,["referenceType"]);l!=null&&_(t,["referenceType"],l);const o=j(n,["maskImageConfig"]);o!=null&&_(t,["maskImageConfig"],vz(e,o));const f=j(n,["controlImageConfig"]);f!=null&&_(t,["controlImageConfig"],wz(e,f));const u=j(n,["styleImageConfig"]);u!=null&&_(t,["styleImageConfig"],Nz(e,u));const d=j(n,["subjectImageConfig"]);return d!=null&&_(t,["subjectImageConfig"],Sz(e,d)),t}function _z(e,n,t){const r={},a=j(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const l=j(n,["negativePrompt"]);t!==void 0&&l!=null&&_(t,["parameters","negativePrompt"],l);const o=j(n,["numberOfImages"]);t!==void 0&&o!=null&&_(t,["parameters","sampleCount"],o);const f=j(n,["aspectRatio"]);t!==void 0&&f!=null&&_(t,["parameters","aspectRatio"],f);const u=j(n,["guidanceScale"]);t!==void 0&&u!=null&&_(t,["parameters","guidanceScale"],u);const d=j(n,["seed"]);t!==void 0&&d!=null&&_(t,["parameters","seed"],d);const h=j(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&_(t,["parameters","safetySetting"],h);const g=j(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=j(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=j(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const N=j(n,["language"]);t!==void 0&&N!=null&&_(t,["parameters","language"],N);const C=j(n,["outputMimeType"]);t!==void 0&&C!=null&&_(t,["parameters","outputOptions","mimeType"],C);const A=j(n,["outputCompressionQuality"]);t!==void 0&&A!=null&&_(t,["parameters","outputOptions","compressionQuality"],A);const T=j(n,["editMode"]);t!==void 0&&T!=null&&_(t,["parameters","editMode"],T);const D=j(n,["baseSteps"]);return t!==void 0&&D!=null&&_(t,["parameters","editConfig","baseSteps"],D),r}function Cz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const l=j(n,["referenceImages"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(u=>jz(e,u))),_(t,["instances[0]","referenceImages"],f)}const o=j(n,["config"]);return o!=null&&_(t,["config"],_z(e,o,t)),t}function kz(e,n,t){const r={},a=j(n,["includeRaiReason"]);t!==void 0&&a!=null&&_(t,["parameters","includeRaiReason"],a);const l=j(n,["outputMimeType"]);t!==void 0&&l!=null&&_(t,["parameters","outputOptions","mimeType"],l);const o=j(n,["outputCompressionQuality"]);t!==void 0&&o!=null&&_(t,["parameters","outputOptions","compressionQuality"],o);const f=j(n,["numberOfImages"]);t!==void 0&&f!=null&&_(t,["parameters","sampleCount"],f);const u=j(n,["mode"]);return t!==void 0&&u!=null&&_(t,["parameters","mode"],u),r}function Tz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["image"]);a!=null&&_(t,["instances[0]","image"],xw(e,a));const l=j(n,["upscaleFactor"]);l!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],l);const o=j(n,["config"]);return o!=null&&_(t,["config"],kz(e,o,t)),t}function Ez(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],ki(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function Az(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);t!==void 0&&l!=null&&_(t,["_query","pageToken"],l);const o=j(n,["filter"]);t!==void 0&&o!=null&&_(t,["_query","filter"],o);const f=j(n,["queryBase"]);return t!==void 0&&f!=null&&_(t,["_url","models_url"],W2(e,f)),r}function Pz(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],Az(e,r,t)),t}function Dz(e,n,t){const r={},a=j(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const l=j(n,["description"]);t!==void 0&&l!=null&&_(t,["description"],l);const o=j(n,["defaultCheckpointId"]);return t!==void 0&&o!=null&&_(t,["defaultCheckpointId"],o),r}function Mz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],Dz(e,a,t)),t}function Iz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],ki(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function Rz(e,n,t){const r={},a=j(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Xh(e,Ca(e,a)));const l=j(n,["tools"]);if(t!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(u=>K2(e,u))),_(t,["tools"],f)}const o=j(n,["generationConfig"]);return t!==void 0&&o!=null&&_(t,["generationConfig"],o),r}function Lz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["contents"]);if(a!=null){let o=hu(e,a);Array.isArray(o)&&(o=o.map(f=>Xh(e,f))),_(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&_(t,["config"],Rz(e,l,t)),t}function Oz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["contents"]);if(a!=null){let o=hu(e,a);Array.isArray(o)&&(o=o.map(f=>Xh(e,f))),_(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&_(t,["config"],l),t}function Fz(e,n,t){const r={},a=j(n,["numberOfVideos"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const l=j(n,["outputGcsUri"]);t!==void 0&&l!=null&&_(t,["parameters","storageUri"],l);const o=j(n,["fps"]);t!==void 0&&o!=null&&_(t,["parameters","fps"],o);const f=j(n,["durationSeconds"]);t!==void 0&&f!=null&&_(t,["parameters","durationSeconds"],f);const u=j(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const d=j(n,["aspectRatio"]);t!==void 0&&d!=null&&_(t,["parameters","aspectRatio"],d);const h=j(n,["resolution"]);t!==void 0&&h!=null&&_(t,["parameters","resolution"],h);const g=j(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=j(n,["pubsubTopic"]);t!==void 0&&b!=null&&_(t,["parameters","pubsubTopic"],b);const v=j(n,["negativePrompt"]);t!==void 0&&v!=null&&_(t,["parameters","negativePrompt"],v);const N=j(n,["enhancePrompt"]);return t!==void 0&&N!=null&&_(t,["parameters","enhancePrompt"],N),r}function $z(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],ki(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const l=j(n,["image"]);l!=null&&_(t,["instances[0]","image"],xw(e,l));const o=j(n,["config"]);return o!=null&&_(t,["config"],Fz(e,o,t)),t}function zz(e,n){const t={},r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function Bz(e,n){const t={},r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],zz(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&_(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&_(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&_(t,["text"],h),t}function Uz(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>Bz(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function qz(e,n){const t={},r=j(n,["citationSources"]);return r!=null&&_(t,["citations"],r),t}function Vz(e,n){const t={},r=j(n,["content"]);r!=null&&_(t,["content"],Uz(e,r));const a=j(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],qz(e,a));const l=j(n,["tokenCount"]);l!=null&&_(t,["tokenCount"],l);const o=j(n,["finishReason"]);o!=null&&_(t,["finishReason"],o);const f=j(n,["avgLogprobs"]);f!=null&&_(t,["avgLogprobs"],f);const u=j(n,["groundingMetadata"]);u!=null&&_(t,["groundingMetadata"],u);const d=j(n,["index"]);d!=null&&_(t,["index"],d);const h=j(n,["logprobsResult"]);h!=null&&_(t,["logprobsResult"],h);const g=j(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function dj(e,n){const t={},r=j(n,["candidates"]);if(r!=null){let f=r;Array.isArray(f)&&(f=f.map(u=>Vz(e,u))),_(t,["candidates"],f)}const a=j(n,["modelVersion"]);a!=null&&_(t,["modelVersion"],a);const l=j(n,["promptFeedback"]);l!=null&&_(t,["promptFeedback"],l);const o=j(n,["usageMetadata"]);return o!=null&&_(t,["usageMetadata"],o),t}function Hz(e,n){const t={},r=j(n,["values"]);return r!=null&&_(t,["values"],r),t}function Gz(){return{}}function Yz(e,n){const t={},r=j(n,["embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>Hz(e,o))),_(t,["embeddings"],l)}return j(n,["metadata"])!=null&&_(t,["metadata"],Gz()),t}function Wz(e,n){const t={},r=j(n,["bytesBase64Encoded"]);r!=null&&_(t,["imageBytes"],mu(e,r));const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function X2(e,n){const t={},r=j(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=j(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const l=j(n,["contentType"]);return l!=null&&_(t,["contentType"],l),t}function Qz(e,n){const t={},r=j(n,["_self"]);r!=null&&_(t,["image"],Wz(e,r));const a=j(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const l=j(n,["_self"]);return l!=null&&_(t,["safetyAttributes"],X2(e,l)),t}function Jz(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>Qz(e,o))),_(t,["generatedImages"],l)}const a=j(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],X2(e,a)),t}function Kz(e,n){const t={},r=j(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=j(n,["createTime"]);a!=null&&_(t,["createTime"],a);const l=j(n,["updateTime"]);return l!=null&&_(t,["updateTime"],l),t}function d1(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const l=j(n,["description"]);l!=null&&_(t,["description"],l);const o=j(n,["version"]);o!=null&&_(t,["version"],o);const f=j(n,["_self"]);f!=null&&_(t,["tunedModelInfo"],Kz(e,f));const u=j(n,["inputTokenLimit"]);u!=null&&_(t,["inputTokenLimit"],u);const d=j(n,["outputTokenLimit"]);d!=null&&_(t,["outputTokenLimit"],d);const h=j(n,["supportedGenerationMethods"]);return h!=null&&_(t,["supportedActions"],h),t}function Xz(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["_self"]);if(a!=null){let l=Q2(e,a);Array.isArray(l)&&(l=l.map(o=>d1(e,o))),_(t,["models"],l)}return t}function Zz(){return{}}function e8(e,n){const t={},r=j(n,["totalTokens"]);r!=null&&_(t,["totalTokens"],r);const a=j(n,["cachedContentTokenCount"]);return a!=null&&_(t,["cachedContentTokenCount"],a),t}function t8(e,n){const t={},r=j(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=j(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],mu(e,a));const l=j(n,["encoding"]);return l!=null&&_(t,["mimeType"],l),t}function n8(e,n){const t={},r=j(n,["_self"]);return r!=null&&_(t,["video"],t8(e,r)),t}function i8(e,n){const t={},r=j(n,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>n8(e,f))),_(t,["generatedVideos"],o)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const l=j(n,["raiMediaFilteredReasons"]);return l!=null&&_(t,["raiMediaFilteredReasons"],l),t}function r8(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const l=j(n,["done"]);l!=null&&_(t,["done"],l);const o=j(n,["error"]);o!=null&&_(t,["error"],o);const f=j(n,["response","generateVideoResponse"]);return f!=null&&_(t,["response"],i8(e,f)),t}function a8(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&_(t,["mimeType"],l),t}function s8(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&_(t,["inlineData"],a8(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&_(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&_(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function l8(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>s8(e,o))),_(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function o8(e,n){const t={},r=j(n,["citations"]);return r!=null&&_(t,["citations"],r),t}function c8(e,n){const t={},r=j(n,["content"]);r!=null&&_(t,["content"],l8(e,r));const a=j(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],o8(e,a));const l=j(n,["finishMessage"]);l!=null&&_(t,["finishMessage"],l);const o=j(n,["finishReason"]);o!=null&&_(t,["finishReason"],o);const f=j(n,["avgLogprobs"]);f!=null&&_(t,["avgLogprobs"],f);const u=j(n,["groundingMetadata"]);u!=null&&_(t,["groundingMetadata"],u);const d=j(n,["index"]);d!=null&&_(t,["index"],d);const h=j(n,["logprobsResult"]);h!=null&&_(t,["logprobsResult"],h);const g=j(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function fj(e,n){const t={},r=j(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>c8(e,h))),_(t,["candidates"],d)}const a=j(n,["createTime"]);a!=null&&_(t,["createTime"],a);const l=j(n,["responseId"]);l!=null&&_(t,["responseId"],l);const o=j(n,["modelVersion"]);o!=null&&_(t,["modelVersion"],o);const f=j(n,["promptFeedback"]);f!=null&&_(t,["promptFeedback"],f);const u=j(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function u8(e,n){const t={},r=j(n,["truncated"]);r!=null&&_(t,["truncated"],r);const a=j(n,["token_count"]);return a!=null&&_(t,["tokenCount"],a),t}function d8(e,n){const t={},r=j(n,["values"]);r!=null&&_(t,["values"],r);const a=j(n,["statistics"]);return a!=null&&_(t,["statistics"],u8(e,a)),t}function f8(e,n){const t={},r=j(n,["billableCharacterCount"]);return r!=null&&_(t,["billableCharacterCount"],r),t}function h8(e,n){const t={},r=j(n,["predictions[]","embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>d8(e,o))),_(t,["embeddings"],l)}const a=j(n,["metadata"]);return a!=null&&_(t,["metadata"],f8(e,a)),t}function p8(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=j(n,["bytesBase64Encoded"]);a!=null&&_(t,["imageBytes"],mu(e,a));const l=j(n,["mimeType"]);return l!=null&&_(t,["mimeType"],l),t}function Z2(e,n){const t={},r=j(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=j(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const l=j(n,["contentType"]);return l!=null&&_(t,["contentType"],l),t}function bw(e,n){const t={},r=j(n,["_self"]);r!=null&&_(t,["image"],p8(e,r));const a=j(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const l=j(n,["_self"]);l!=null&&_(t,["safetyAttributes"],Z2(e,l));const o=j(n,["prompt"]);return o!=null&&_(t,["enhancedPrompt"],o),t}function m8(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>bw(e,o))),_(t,["generatedImages"],l)}const a=j(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],Z2(e,a)),t}function g8(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>bw(e,l))),_(t,["generatedImages"],a)}return t}function y8(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>bw(e,l))),_(t,["generatedImages"],a)}return t}function x8(e,n){const t={},r=j(n,["endpoint"]);r!=null&&_(t,["name"],r);const a=j(n,["deployedModelId"]);return a!=null&&_(t,["deployedModelId"],a),t}function b8(e,n){const t={},r=j(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&_(t,["baseModel"],r);const a=j(n,["createTime"]);a!=null&&_(t,["createTime"],a);const l=j(n,["updateTime"]);return l!=null&&_(t,["updateTime"],l),t}function v8(e,n){const t={},r=j(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=j(n,["epoch"]);a!=null&&_(t,["epoch"],a);const l=j(n,["step"]);return l!=null&&_(t,["step"],l),t}function f1(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const l=j(n,["description"]);l!=null&&_(t,["description"],l);const o=j(n,["versionId"]);o!=null&&_(t,["version"],o);const f=j(n,["deployedModels"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(v=>x8(e,v))),_(t,["endpoints"],b)}const u=j(n,["labels"]);u!=null&&_(t,["labels"],u);const d=j(n,["_self"]);d!=null&&_(t,["tunedModelInfo"],b8(e,d));const h=j(n,["defaultCheckpointId"]);h!=null&&_(t,["defaultCheckpointId"],h);const g=j(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>v8(e,v))),_(t,["checkpoints"],b)}return t}function w8(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["_self"]);if(a!=null){let l=Q2(e,a);Array.isArray(l)&&(l=l.map(o=>f1(e,o))),_(t,["models"],l)}return t}function N8(){return{}}function S8(e,n){const t={},r=j(n,["totalTokens"]);return r!=null&&_(t,["totalTokens"],r),t}function j8(e,n){const t={},r=j(n,["tokensInfo"]);return r!=null&&_(t,["tokensInfo"],r),t}function _8(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=j(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],mu(e,a));const l=j(n,["mimeType"]);return l!=null&&_(t,["mimeType"],l),t}function C8(e,n){const t={},r=j(n,["_self"]);return r!=null&&_(t,["video"],_8(e,r)),t}function k8(e,n){const t={},r=j(n,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>C8(e,f))),_(t,["generatedVideos"],o)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const l=j(n,["raiMediaFilteredReasons"]);return l!=null&&_(t,["raiMediaFilteredReasons"],l),t}function T8(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const l=j(n,["done"]);l!=null&&_(t,["done"],l);const o=j(n,["error"]);o!=null&&_(t,["error"],o);const f=j(n,["response"]);return f!=null&&_(t,["response"],k8(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const E8="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function A8(e,n,t){const r=new W6;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const l=v$(e,a);Object.assign(r,l)}else{const l=b$(e,a);Object.assign(r,l)}n(r)}class P8{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,l;const o=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let u;const d=R8(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())u=`${o}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{const V=this.apiClient.getApiKey();u=`${o}/ws/google.ai.generativelanguage.${f}.GenerativeService.BidiGenerateContent?key=${V}`}let h=()=>{};const g=new Promise(V=>{h=V}),b=n.callbacks,v=function(){var V;(V=b==null?void 0:b.onopen)===null||V===void 0||V.call(b),h({})},N=this.apiClient,C={onopen:v,onmessage:V=>{A8(N,b.onmessage,V)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(V){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(V){}},A=this.webSocketFactory.create(u,I8(d),C);A.connect(),await g;let T=ki(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&T.startsWith("publishers/")){const V=this.apiClient.getProject(),F=this.apiClient.getLocation();T=`projects/${V}/locations/${F}/`+T}let D={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[Hh.AUDIO]}:n.config.responseModalities=[Hh.AUDIO]),!((l=n.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const M={model:T,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?D=V5(this.apiClient,M):D=q5(this.apiClient,M),delete D.config,A.send(JSON.stringify(D)),new M8(A,this.apiClient)}}const D8={turnComplete:!0};class M8{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=hu(n,t.turns),n.isVertexAI()?r=r.map(a=>Xh(n,a)):r=r.map(a=>Ob(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const l of r){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!n.isVertexAI()&&!("id"in l))throw new Error(E8)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},D8),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:J5(this.apiClient,n)}:t={realtimeInput:Q5(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function I8(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function R8(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class L8 extends mg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let l;const o=[];if(r!=null&&r.generatedImages)for(const u of r.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((a=u==null?void 0:u.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?l=u==null?void 0:u.safetyAttributes:o.push(u);let f;return l?f={generatedImages:o,positivePromptSafetyAttributes:l}:f={generatedImages:o},f}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Lb(qh.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=uj(this.apiClient,n);return f=Xt("{model}:generateContent",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=fj(this.apiClient,h),b=new jx;return Object.assign(b,g),b})}else{const d=cj(this.apiClient,n);return f=Xt("{model}:generateContent",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=dj(this.apiClient,h),b=new jx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=uj(this.apiClient,n);f=Xt("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(g){return hb(this,arguments,function*(){var b,v,N,C;try{for(var A=!0,T=c1(g),D;D=yield zr(T.next()),b=D.done,!b;A=!0){C=D.value,A=!1;const V=fj(h,yield zr(C.json())),F=new jx;Object.assign(F,V),yield yield zr(F)}}catch(M){v={error:M}}finally{try{!A&&!b&&(N=T.return)&&(yield zr(N.call(T)))}finally{if(v)throw v.error}}})})}else{const d=cj(this.apiClient,n);f=Xt("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}),o.then(function(g){return hb(this,arguments,function*(){var b,v,N,C;try{for(var A=!0,T=c1(g),D;D=yield zr(T.next()),b=D.done,!b;A=!0){C=D.value,A=!1;const V=dj(h,yield zr(C.json())),F=new jx;Object.assign(F,V),yield yield zr(F)}}catch(M){v={error:M}}finally{try{!A&&!b&&(N=T.return)&&(yield zr(N.call(T)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=yz(this.apiClient,n);return f=Xt("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=h8(this.apiClient,h),b=new JS;return Object.assign(b,g),b})}else{const d=L$(this.apiClient,n);return f=Xt("{model}:batchEmbedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Yz(this.apiClient,h),b=new JS;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=bz(this.apiClient,n);return f=Xt("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=m8(this.apiClient,h),b=new KS;return Object.assign(b,g),b})}else{const d=F$(this.apiClient,n);return f=Xt("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Jz(this.apiClient,h),b=new KS;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=Cz(this.apiClient,n);return l=Xt("{model}:predict",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=g8(this.apiClient,u),h=new U6;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=Tz(this.apiClient,n);return l=Xt("{model}:predict",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=y8(this.apiClient,u),h=new q6;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Ez(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>f1(this.apiClient,h))}else{const d=$$(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>d1(this.apiClient,h))}}async listInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Pz(this.apiClient,n);return f=Xt("{models_url}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=w8(this.apiClient,h),b=new XS;return Object.assign(b,g),b})}else{const d=B$(this.apiClient,n);return f=Xt("{models_url}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Xz(this.apiClient,h),b=new XS;return Object.assign(b,g),b})}}async update(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Mz(this.apiClient,n);return f=Xt("{model}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>f1(this.apiClient,h))}else{const d=q$(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>d1(this.apiClient,h))}}async delete(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Iz(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=N8(),g=new ZS;return Object.assign(g,h),g})}else{const d=V$(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(()=>{const h=Zz(),g=new ZS;return Object.assign(g,h),g})}}async countTokens(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Lz(this.apiClient,n);return f=Xt("{model}:countTokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=S8(this.apiClient,h),b=new ej;return Object.assign(b,g),b})}else{const d=G$(this.apiClient,n);return f=Xt("{model}:countTokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=e8(this.apiClient,h),b=new ej;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=Oz(this.apiClient,n);return l=Xt("{model}:computeTokens",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=j8(this.apiClient,u),h=new V6;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=$z(this.apiClient,n);return f=Xt("{model}:predictLongRunning",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>T8(this.apiClient,h))}else{const d=Q$(this.apiClient,n);return f=Xt("{model}:predictLongRunning",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>r8(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function O8(e,n){const t={},r=j(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function F8(e,n){const t={},r=j(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function $8(e,n){const t={},r=j(n,["operationName"]);r!=null&&_(t,["operationName"],r);const a=j(n,["resourceName"]);a!=null&&_(t,["_url","resourceName"],a);const l=j(n,["config"]);return l!=null&&_(t,["config"],l),t}function z8(e,n){const t={},r=j(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=j(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],mu(e,a));const l=j(n,["encoding"]);return l!=null&&_(t,["mimeType"],l),t}function B8(e,n){const t={},r=j(n,["_self"]);return r!=null&&_(t,["video"],z8(e,r)),t}function U8(e,n){const t={},r=j(n,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>B8(e,f))),_(t,["generatedVideos"],o)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const l=j(n,["raiMediaFilteredReasons"]);return l!=null&&_(t,["raiMediaFilteredReasons"],l),t}function q8(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const l=j(n,["done"]);l!=null&&_(t,["done"],l);const o=j(n,["error"]);o!=null&&_(t,["error"],o);const f=j(n,["response","generateVideoResponse"]);return f!=null&&_(t,["response"],U8(e,f)),t}function V8(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=j(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],mu(e,a));const l=j(n,["mimeType"]);return l!=null&&_(t,["mimeType"],l),t}function H8(e,n){const t={},r=j(n,["_self"]);return r!=null&&_(t,["video"],V8(e,r)),t}function G8(e,n){const t={},r=j(n,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>H8(e,f))),_(t,["generatedVideos"],o)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const l=j(n,["raiMediaFilteredReasons"]);return l!=null&&_(t,["raiMediaFilteredReasons"],l),t}function hj(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const l=j(n,["done"]);l!=null&&_(t,["done"],l);const o=j(n,["error"]);o!=null&&_(t,["error"],o);const f=j(n,["response"]);return f!=null&&_(t,["response"],G8(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Y8 extends mg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let l;return r&&"httpOptions"in r&&(l=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=F8(this.apiClient,n);return f=Xt("{operationName}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>hj(this.apiClient,h))}else{const d=O8(this.apiClient,n);return f=Xt("{operationName}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>q8(this.apiClient,h))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=$8(this.apiClient,n);return l=Xt("{resourceName}:fetchPredictOperation",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>hj(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const W8="Content-Type",Q8="X-Server-Timeout",J8="User-Agent",K8="x-goog-api-client",X8="0.14.1",Z8=`google-genai-sdk/${X8}`,eB="v1beta1",tB="v1beta",pj=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class ek extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class h1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class nB{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:eB,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:tB,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[o,f]of Object.entries(n.queryParams))a.searchParams.append(o,String(f));let l={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=n.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,n.abortSignal),this.unaryApiCall(a,l,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,l]of Object.entries(t))typeof l=="object"?r[a]=Object.assign(Object.assign({},r[a]),l):l!==void 0&&(r[a]=l);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let l={};return l.body=n.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,n.abortSignal),this.streamApiCall(a,l,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,l=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=l}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await mj(a),new o1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await mj(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return hb(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let o="";for(;;){const{done:f,value:u}=yield zr(a.read());if(f){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=l.decode(u);try{const g=JSON.parse(d);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,N=b.code,C=`got status: ${v}. ${JSON.stringify(g)}`;if(N>=400&&N<500)throw new ek(C);if(N>=500&&N<600)throw new h1(C)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}o+=d;let h=o.match(pj);for(;h;){const g=h[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield zr(new o1(b)),o=o.slice(h[0].length),h=o.match(pj)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=Z8+" "+this.clientOptions.userAgentExtra;return n[J8]=t,n[K8]=t,n[W8]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(Q8,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const l=this.clientOptions.uploader,o=await l.stat(n);a.sizeBytes=String(o.size);const f=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:o.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=f;const u=await this.fetchUploadUrl(a,t);return l.upload(n,u,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const l={file:n},o=await this.request({path:Xt("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:a});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function mj(e){var n;if(e===void 0)throw new h1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const l=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new ek(l):t>=500&&t<600?new h1(l):new Error(l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iB(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function rB(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);t!==void 0&&l!=null&&_(t,["_query","pageToken"],l);const o=j(n,["filter"]);return t!==void 0&&o!=null&&_(t,["_query","filter"],o),r}function aB(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],rB(e,r,t)),t}function sB(e,n){const t={},r=j(n,["textInput"]);r!=null&&_(t,["textInput"],r);const a=j(n,["output"]);return a!=null&&_(t,["output"],a),t}function lB(e,n){const t={};if(j(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=j(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>sB(e,l))),_(t,["examples","examples"],a)}return t}function oB(e,n,t){const r={};if(j(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=j(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&_(t,["displayName"],a),j(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=j(n,["epochCount"]);t!==void 0&&l!=null&&_(t,["tuningTask","hyperparameters","epochCount"],l);const o=j(n,["learningRateMultiplier"]);if(o!=null&&_(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),j(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(j(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const f=j(n,["batchSize"]);t!==void 0&&f!=null&&_(t,["tuningTask","hyperparameters","batchSize"],f);const u=j(n,["learningRate"]);return t!==void 0&&u!=null&&_(t,["tuningTask","hyperparameters","learningRate"],u),r}function cB(e,n){const t={},r=j(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=j(n,["trainingDataset"]);a!=null&&_(t,["tuningTask","trainingData"],lB(e,a));const l=j(n,["config"]);return l!=null&&_(t,["config"],oB(e,l,t)),t}function uB(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function dB(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);t!==void 0&&l!=null&&_(t,["_query","pageToken"],l);const o=j(n,["filter"]);return t!==void 0&&o!=null&&_(t,["_query","filter"],o),r}function fB(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],dB(e,r,t)),t}function hB(e,n,t){const r={},a=j(n,["gcsUri"]);if(t!==void 0&&a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],a),j(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function pB(e,n){const t={},r=j(n,["gcsUri"]);return r!=null&&_(t,["validationDatasetUri"],r),t}function mB(e,n,t){const r={},a=j(n,["validationDataset"]);t!==void 0&&a!=null&&_(t,["supervisedTuningSpec"],pB(e,a));const l=j(n,["tunedModelDisplayName"]);t!==void 0&&l!=null&&_(t,["tunedModelDisplayName"],l);const o=j(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const f=j(n,["epochCount"]);t!==void 0&&f!=null&&_(t,["supervisedTuningSpec","hyperParameters","epochCount"],f);const u=j(n,["learningRateMultiplier"]);t!==void 0&&u!=null&&_(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const d=j(n,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&_(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=j(n,["adapterSize"]);if(t!==void 0&&h!=null&&_(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),j(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(j(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function gB(e,n){const t={},r=j(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=j(n,["trainingDataset"]);a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],hB(e,a,t));const l=j(n,["config"]);return l!=null&&_(t,["config"],mB(e,l,t)),t}function yB(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["model"],r);const a=j(n,["name"]);return a!=null&&_(t,["endpoint"],a),t}function tk(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["state"]);a!=null&&_(t,["state"],G2(e,a));const l=j(n,["createTime"]);l!=null&&_(t,["createTime"],l);const o=j(n,["tuningTask","startTime"]);o!=null&&_(t,["startTime"],o);const f=j(n,["tuningTask","completeTime"]);f!=null&&_(t,["endTime"],f);const u=j(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const d=j(n,["description"]);d!=null&&_(t,["description"],d);const h=j(n,["baseModel"]);h!=null&&_(t,["baseModel"],h);const g=j(n,["_self"]);g!=null&&_(t,["tunedModel"],yB(e,g));const b=j(n,["distillationSpec"]);b!=null&&_(t,["distillationSpec"],b);const v=j(n,["experiment"]);v!=null&&_(t,["experiment"],v);const N=j(n,["labels"]);N!=null&&_(t,["labels"],N);const C=j(n,["pipelineJob"]);C!=null&&_(t,["pipelineJob"],C);const A=j(n,["tunedModelDisplayName"]);return A!=null&&_(t,["tunedModelDisplayName"],A),t}function xB(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>tk(e,o))),_(t,["tuningJobs"],l)}return t}function bB(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const l=j(n,["done"]);l!=null&&_(t,["done"],l);const o=j(n,["error"]);return o!=null&&_(t,["error"],o),t}function vB(e,n){const t={},r=j(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=j(n,["epoch"]);a!=null&&_(t,["epoch"],a);const l=j(n,["step"]);l!=null&&_(t,["step"],l);const o=j(n,["endpoint"]);return o!=null&&_(t,["endpoint"],o),t}function wB(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["model"],r);const a=j(n,["endpoint"]);a!=null&&_(t,["endpoint"],a);const l=j(n,["checkpoints"]);if(l!=null){let o=l;Array.isArray(o)&&(o=o.map(f=>vB(e,f))),_(t,["checkpoints"],o)}return t}function p1(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["state"]);a!=null&&_(t,["state"],G2(e,a));const l=j(n,["createTime"]);l!=null&&_(t,["createTime"],l);const o=j(n,["startTime"]);o!=null&&_(t,["startTime"],o);const f=j(n,["endTime"]);f!=null&&_(t,["endTime"],f);const u=j(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const d=j(n,["error"]);d!=null&&_(t,["error"],d);const h=j(n,["description"]);h!=null&&_(t,["description"],h);const g=j(n,["baseModel"]);g!=null&&_(t,["baseModel"],g);const b=j(n,["tunedModel"]);b!=null&&_(t,["tunedModel"],wB(e,b));const v=j(n,["supervisedTuningSpec"]);v!=null&&_(t,["supervisedTuningSpec"],v);const N=j(n,["tuningDataStats"]);N!=null&&_(t,["tuningDataStats"],N);const C=j(n,["encryptionSpec"]);C!=null&&_(t,["encryptionSpec"],C);const A=j(n,["partnerModelTuningSpec"]);A!=null&&_(t,["partnerModelTuningSpec"],A);const T=j(n,["distillationSpec"]);T!=null&&_(t,["distillationSpec"],T);const D=j(n,["experiment"]);D!=null&&_(t,["experiment"],D);const M=j(n,["labels"]);M!=null&&_(t,["labels"],M);const V=j(n,["pipelineJob"]);V!=null&&_(t,["pipelineJob"],V);const F=j(n,["tunedModelDisplayName"]);return F!=null&&_(t,["tunedModelDisplayName"],F),t}function NB(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>p1(e,o))),_(t,["tuningJobs"],l)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SB extends mg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Lb(qh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:l1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=uB(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>p1(this.apiClient,h))}else{const d=iB(this.apiClient,n);return f=Xt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>tk(this.apiClient,h))}}async listInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=fB(this.apiClient,n);return f=Xt("tuningJobs",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=NB(this.apiClient,h),b=new tj;return Object.assign(b,g),b})}else{const d=aB(this.apiClient,n);return f=Xt("tunedModels",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=xB(this.apiClient,h),b=new tj;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=gB(this.apiClient,n);return l=Xt("tuningJobs",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>p1(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=cB(this.apiClient,n);return l=Xt("tunedModels",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>bB(this.apiClient,u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jB{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const _B=1024*1024*8,CB=3,kB=1e3,TB=2,av="x-goog-upload-status";async function EB(e,n,t){var r,a,l;let o=0,f=0,u=new o1(new Response),d="upload";for(o=e.size;f<o;){const g=Math.min(_B,o-f),b=e.slice(f,f+g);f+g>=o&&(d+=", finalize");let v=0,N=kB;for(;v<CB&&(u=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(f),"Content-Length":String(g)}}}),!(!((r=u==null?void 0:u.headers)===null||r===void 0)&&r[av]));)v++,await PB(N),N=N*TB;if(f+=g,((a=u==null?void 0:u.headers)===null||a===void 0?void 0:a[av])!=="active")break;if(o<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(u==null?void 0:u.json());if(((l=u==null?void 0:u.headers)===null||l===void 0?void 0:l[av])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function AB(e){return{size:e.size,type:e.type}}function PB(e){return new Promise(n=>setTimeout(n,e))}class DB{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await EB(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await AB(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MB{create(n,t,r){return new IB(n,t,r)}}class IB{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gj="x-goog-api-key";class RB{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(gj)===null&&n.append(gj,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const LB="gl-node/";class nk{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=GF(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new RB(this.apiKey);this.apiClient=new nB({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:LB+"web",uploader:new DB,downloader:new jB}),this.models=new L8(this.apiClient),this.live=new P8(this.apiClient,a,new MB),this.chats=new Z6(this.models,this.apiClient),this.caches=new Q6(this.apiClient),this.files=new f5(this.apiClient),this.operations=new Y8(this.apiClient),this.tunings=new SB(this.apiClient)}}const Nh=new Map,ik=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&Nh.has(n.id)){const a=Nh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Nh.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&Nh.has(n.id)){const a=Nh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Nh.set(n.id,r),r}}})();function OB(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const FB=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,rk=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,kx=new Map,m1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var sv={exports:{}},yj;function $B(){return yj||(yj=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(u,d,h){this.fn=u,this.context=d,this.once=h||!1}function l(u,d,h,g,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,g||u,b),N=t?t+d:d;return u._events[N]?u._events[N].fn?u._events[N]=[u._events[N],v]:u._events[N].push(v):(u._events[N]=v,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function f(){this._events=new r,this._eventsCount=0}f.prototype.eventNames=function(){var d=[],h,g;if(this._eventsCount===0)return d;for(g in h=this._events)n.call(h,g)&&d.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},f.prototype.listeners=function(d){var h=t?t+d:d,g=this._events[h];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,N=new Array(v);b<v;b++)N[b]=g[b].fn;return N},f.prototype.listenerCount=function(d){var h=t?t+d:d,g=this._events[h];return g?g.fn?1:g.length:0},f.prototype.emit=function(d,h,g,b,v,N){var C=t?t+d:d;if(!this._events[C])return!1;var A=this._events[C],T=arguments.length,D,M;if(A.fn){switch(A.once&&this.removeListener(d,A.fn,void 0,!0),T){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,h),!0;case 3:return A.fn.call(A.context,h,g),!0;case 4:return A.fn.call(A.context,h,g,b),!0;case 5:return A.fn.call(A.context,h,g,b,v),!0;case 6:return A.fn.call(A.context,h,g,b,v,N),!0}for(M=1,D=new Array(T-1);M<T;M++)D[M-1]=arguments[M];A.fn.apply(A.context,D)}else{var V=A.length,F;for(M=0;M<V;M++)switch(A[M].once&&this.removeListener(d,A[M].fn,void 0,!0),T){case 1:A[M].fn.call(A[M].context);break;case 2:A[M].fn.call(A[M].context,h);break;case 3:A[M].fn.call(A[M].context,h,g);break;case 4:A[M].fn.call(A[M].context,h,g,b);break;default:if(!D)for(F=1,D=new Array(T-1);F<T;F++)D[F-1]=arguments[F];A[M].fn.apply(A[M].context,D)}}return!0},f.prototype.on=function(d,h,g){return l(this,d,h,g,!1)},f.prototype.once=function(d,h,g){return l(this,d,h,g,!0)},f.prototype.removeListener=function(d,h,g,b){var v=t?t+d:d;if(!this._events[v])return this;if(!h)return o(this,v),this;var N=this._events[v];if(N.fn)N.fn===h&&(!b||N.once)&&(!g||N.context===g)&&o(this,v);else{for(var C=0,A=[],T=N.length;C<T;C++)(N[C].fn!==h||b&&!N[C].once||g&&N[C].context!==g)&&A.push(N[C]);A.length?this._events[v]=A.length===1?A[0]:A:o(this,v)}return this},f.prototype.removeAllListeners=function(d){var h;return d?(h=t?t+d:d,this._events[h]&&o(this,h)):(this._events=new r,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=t,f.EventEmitter=f,e.exports=f}(sv)),sv.exports}var zB=$B();const ak=Yd(zB);function BB(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class sk extends ak{constructor(t=16e3){super();ri(this,"stream");ri(this,"audioContext");ri(this,"source");ri(this,"recording",!1);ri(this,"recordingWorklet");ri(this,"vuWorklet");ri(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await ik({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=m1(r,FB);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async o=>{const f=o.data.data.int16arrayBuffer;if(f){const u=BB(f);this.emit("data",u)}},this.source.connect(this.recordingWorklet);const l="vu-meter";await this.audioContext.audioWorklet.addModule(m1(l,rk)),this.vuWorklet=new AudioWorkletNode(this.audioContext,l),this.vuWorklet.port.onmessage=o=>{this.emit("volume",o.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(l=>l.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const UB=3,qB=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const l=()=>{r.current.forEach((o,f)=>{o&&(o.style.height=`${Math.min(24,4+n*(f===1?400:60))}px`)}),a=window.setTimeout(l,100)};return l(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:ou("audioPulse",{active:e,hover:t}),children:Array(UB).fill(null).map((a,l)=>i.jsx("div",{ref:o=>{r.current[l]=o},style:{animationDelay:`${l*133}ms`}},l))})};var Ym={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var VB=Ym.exports,xj;function HB(){return xj||(xj=1,function(e,n){(function(){var t,r="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",f="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",d=500,h="__lodash_placeholder__",g=1,b=2,v=4,N=1,C=2,A=1,T=2,D=4,M=8,V=16,F=32,z=64,B=128,U=256,R=512,O=30,$="...",W=800,te=16,ne=1,re=2,J=3,q=1/0,H=9007199254740991,ee=17976931348623157e292,E=NaN,Q=4294967295,ie=Q-1,I=Q>>>1,ce=[["ary",B],["bind",A],["bindKey",T],["curry",M],["curryRight",V],["flip",R],["partial",F],["partialRight",z],["rearg",U]],xe="[object Arguments]",le="[object Array]",ge="[object AsyncFunction]",ye="[object Boolean]",Re="[object Date]",Ze="[object DOMException]",at="[object Error]",Le="[object Function]",Te="[object GeneratorFunction]",we="[object Map]",Fe="[object Number]",Xe="[object Null]",it="[object Object]",je="[object Promise]",Ke="[object Proxy]",ze="[object RegExp]",ct="[object Set]",Tt="[object String]",bt="[object Symbol]",en="[object Undefined]",oe="[object WeakMap]",K="[object WeakSet]",fe="[object ArrayBuffer]",Ae="[object DataView]",Ie="[object Float32Array]",Ye="[object Float64Array]",ft="[object Int8Array]",gt="[object Int16Array]",jt="[object Int32Array]",$e="[object Uint8Array]",nt="[object Uint8ClampedArray]",Ve="[object Uint16Array]",ht="[object Uint32Array]",Se=/\b__p \+= '';/g,qe=/\b(__p \+=) '' \+/g,Be=/(__e\(.*?\)|\b__t\)) \+\n'';/g,tt=/&(?:amp|lt|gt|quot|#39);/g,st=/[&<>"']/g,dt=RegExp(tt.source),tn=RegExp(st.source),Nt=/<%-([\s\S]+?)%>/g,Ot=/<%([\s\S]+?)%>/g,Vt=/<%=([\s\S]+?)%>/g,_t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Wt=/^\w*$/,Et=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dt=/[\\^$.*+?()[\]{}|]/g,kt=RegExp(Dt.source),It=/^\s+/,Hn=/\s/,Ti=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,sr=/\{\n\/\* \[wrapped with (.+)\] \*/,Rn=/,? & /,On=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Bi=/[()=,{}\[\]\/\s]/,Xi=/\\(\\)?/g,Zi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pr=/\w*$/,Ui=/^[-+]0x[0-9a-f]+$/i,Gn=/^0b[01]+$/i,Es=/^\[object .+?Constructor\]$/,Hr=/^0o[0-7]+$/i,Ia=/^(?:0|[1-9]\d*)$/,er=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,oa=/($^)/,ro=/['\n\r\u2028\u2029\\]/g,cl="\\ud800-\\udfff",Kd="\\u0300-\\u036f",ul="\\ufe20-\\ufe2f",dl="\\u20d0-\\u20ff",Gr=Kd+ul+dl,ao="\\u2700-\\u27bf",fl="a-z\\xdf-\\xf6\\xf8-\\xff",hl="\\xac\\xb1\\xd7\\xf7",bu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ic="\\u2000-\\u206f",rp=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rc="A-Z\\xc0-\\xd6\\xd8-\\xde",mr="\\ufe0e\\ufe0f",ac=hl+bu+ic+rp,sc="[']",lc="["+cl+"]",As="["+ac+"]",rs="["+Gr+"]",so="\\d+",gr="["+ao+"]",Ps="["+fl+"]",oc="[^"+cl+ac+so+ao+fl+rc+"]",as="\\ud83c[\\udffb-\\udfff]",Ds="(?:"+rs+"|"+as+")",pl="[^"+cl+"]",lo="(?:\\ud83c[\\udde6-\\uddff]){2}",Yr="[\\ud800-\\udbff][\\udc00-\\udfff]",Ra="["+rc+"]",ml="\\u200d",vu="(?:"+Ps+"|"+oc+")",gl="(?:"+Ra+"|"+oc+")",cc="(?:"+sc+"(?:d|ll|m|re|s|t|ve))?",uc="(?:"+sc+"(?:D|LL|M|RE|S|T|VE))?",ca=Ds+"?",Ms="["+mr+"]?",oo="(?:"+ml+"(?:"+[pl,lo,Yr].join("|")+")"+Ms+ca+")*",ss="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ls="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",co=Ms+ca+oo,Wr="(?:"+[gr,lo,Yr].join("|")+")"+co,dc="(?:"+[pl+rs+"?",rs,lo,Yr,lc].join("|")+")",yl=RegExp(sc,"g"),tr=RegExp(rs,"g"),La=RegExp(as+"(?="+as+")|"+dc+co,"g"),uo=RegExp([Ra+"?"+Ps+"+"+cc+"(?="+[As,Ra,"$"].join("|")+")",gl+"+"+uc+"(?="+[As,Ra+vu,"$"].join("|")+")",Ra+"?"+vu+"+"+cc,Ra+"+"+uc,ls,ss,so,Wr].join("|"),"g"),Qr=RegExp("["+ml+cl+Gr+mr+"]"),fc=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,xl=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],hc=-1,Dn={};Dn[Ie]=Dn[Ye]=Dn[ft]=Dn[gt]=Dn[jt]=Dn[$e]=Dn[nt]=Dn[Ve]=Dn[ht]=!0,Dn[xe]=Dn[le]=Dn[fe]=Dn[ye]=Dn[Ae]=Dn[Re]=Dn[at]=Dn[Le]=Dn[we]=Dn[Fe]=Dn[it]=Dn[ze]=Dn[ct]=Dn[Tt]=Dn[oe]=!1;var Cn={};Cn[xe]=Cn[le]=Cn[fe]=Cn[Ae]=Cn[ye]=Cn[Re]=Cn[Ie]=Cn[Ye]=Cn[ft]=Cn[gt]=Cn[jt]=Cn[we]=Cn[Fe]=Cn[it]=Cn[ze]=Cn[ct]=Cn[Tt]=Cn[bt]=Cn[$e]=Cn[nt]=Cn[Ve]=Cn[ht]=!0,Cn[at]=Cn[Le]=Cn[oe]=!1;var Xd={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},qi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Oa={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},kn=parseFloat,wu=parseInt,Is=typeof lu=="object"&&lu&&lu.Object===Object&&lu,ho=typeof self=="object"&&self&&self.Object===Object&&self,Kn=Is||ho||Function("return this")(),ua=n&&!n.nodeType&&n,os=ua&&!0&&e&&!e.nodeType&&e,Nu=os&&os.exports===ua,cs=Nu&&Is.process,yr=function(){try{var Ne=os&&os.require&&os.require("util").types;return Ne||cs&&cs.binding&&cs.binding("util")}catch{}}(),bl=yr&&yr.isArrayBuffer,po=yr&&yr.isDate,Rs=yr&&yr.isMap,Su=yr&&yr.isRegExp,Fa=yr&&yr.isSet,mo=yr&&yr.isTypedArray;function lr(Ne,Ue,Oe){switch(Oe.length){case 0:return Ne.call(Ue);case 1:return Ne.call(Ue,Oe[0]);case 2:return Ne.call(Ue,Oe[0],Oe[1]);case 3:return Ne.call(Ue,Oe[0],Oe[1],Oe[2])}return Ne.apply(Ue,Oe)}function ap(Ne,Ue,Oe,mt){for(var Ft=-1,yn=Ne==null?0:Ne.length;++Ft<yn;){var xi=Ne[Ft];Ue(mt,xi,Oe(xi),Ne)}return mt}function nr(Ne,Ue){for(var Oe=-1,mt=Ne==null?0:Ne.length;++Oe<mt&&Ue(Ne[Oe],Oe,Ne)!==!1;);return Ne}function vl(Ne,Ue){for(var Oe=Ne==null?0:Ne.length;Oe--&&Ue(Ne[Oe],Oe,Ne)!==!1;);return Ne}function Zd(Ne,Ue){for(var Oe=-1,mt=Ne==null?0:Ne.length;++Oe<mt;)if(!Ue(Ne[Oe],Oe,Ne))return!1;return!0}function Jr(Ne,Ue){for(var Oe=-1,mt=Ne==null?0:Ne.length,Ft=0,yn=[];++Oe<mt;){var xi=Ne[Oe];Ue(xi,Oe,Ne)&&(yn[Ft++]=xi)}return yn}function us(Ne,Ue){var Oe=Ne==null?0:Ne.length;return!!Oe&&Nl(Ne,Ue,0)>-1}function wl(Ne,Ue,Oe){for(var mt=-1,Ft=Ne==null?0:Ne.length;++mt<Ft;)if(Oe(Ue,Ne[mt]))return!0;return!1}function Yn(Ne,Ue){for(var Oe=-1,mt=Ne==null?0:Ne.length,Ft=Array(mt);++Oe<mt;)Ft[Oe]=Ue(Ne[Oe],Oe,Ne);return Ft}function Kr(Ne,Ue){for(var Oe=-1,mt=Ue.length,Ft=Ne.length;++Oe<mt;)Ne[Ft+Oe]=Ue[Oe];return Ne}function ju(Ne,Ue,Oe,mt){var Ft=-1,yn=Ne==null?0:Ne.length;for(mt&&yn&&(Oe=Ne[++Ft]);++Ft<yn;)Oe=Ue(Oe,Ne[Ft],Ft,Ne);return Oe}function pc(Ne,Ue,Oe,mt){var Ft=Ne==null?0:Ne.length;for(mt&&Ft&&(Oe=Ne[--Ft]);Ft--;)Oe=Ue(Oe,Ne[Ft],Ft,Ne);return Oe}function _u(Ne,Ue){for(var Oe=-1,mt=Ne==null?0:Ne.length;++Oe<mt;)if(Ue(Ne[Oe],Oe,Ne))return!0;return!1}var sp=gc("length");function lp(Ne){return Ne.split("")}function op(Ne){return Ne.match(On)||[]}function ef(Ne,Ue,Oe){var mt;return Oe(Ne,function(Ft,yn,xi){if(Ue(Ft,yn,xi))return mt=yn,!1}),mt}function mc(Ne,Ue,Oe,mt){for(var Ft=Ne.length,yn=Oe+(mt?1:-1);mt?yn--:++yn<Ft;)if(Ue(Ne[yn],yn,Ne))return yn;return-1}function Nl(Ne,Ue,Oe){return Ue===Ue?Tu(Ne,Ue,Oe):mc(Ne,Sl,Oe)}function Cu(Ne,Ue,Oe,mt){for(var Ft=Oe-1,yn=Ne.length;++Ft<yn;)if(mt(Ne[Ft],Ue))return Ft;return-1}function Sl(Ne){return Ne!==Ne}function tf(Ne,Ue){var Oe=Ne==null?0:Ne.length;return Oe?yc(Ne,Ue)/Oe:E}function gc(Ne){return function(Ue){return Ue==null?t:Ue[Ne]}}function go(Ne){return function(Ue){return Ne==null?t:Ne[Ue]}}function ku(Ne,Ue,Oe,mt,Ft){return Ft(Ne,function(yn,xi,xn){Oe=mt?(mt=!1,yn):Ue(Oe,yn,xi,xn)}),Oe}function yo(Ne,Ue){var Oe=Ne.length;for(Ne.sort(Ue);Oe--;)Ne[Oe]=Ne[Oe].value;return Ne}function yc(Ne,Ue){for(var Oe,mt=-1,Ft=Ne.length;++mt<Ft;){var yn=Ue(Ne[mt]);yn!==t&&(Oe=Oe===t?yn:Oe+yn)}return Oe}function ir(Ne,Ue){for(var Oe=-1,mt=Array(Ne);++Oe<Ne;)mt[Oe]=Ue(Oe);return mt}function ds(Ne,Ue){return Yn(Ue,function(Oe){return[Oe,Ne[Oe]]})}function da(Ne){return Ne&&Ne.slice(0,Xr(Ne)+1).replace(It,"")}function or(Ne){return function(Ue){return Ne(Ue)}}function xo(Ne,Ue){return Yn(Ue,function(Oe){return Ne[Oe]})}function Ls(Ne,Ue){return Ne.has(Ue)}function Os(Ne,Ue){for(var Oe=-1,mt=Ne.length;++Oe<mt&&Nl(Ue,Ne[Oe],0)>-1;);return Oe}function fs(Ne,Ue){for(var Oe=Ne.length;Oe--&&Nl(Ue,Ne[Oe],0)>-1;);return Oe}function nf(Ne,Ue){for(var Oe=Ne.length,mt=0;Oe--;)Ne[Oe]===Ue&&++mt;return mt}var bo=go(Xd),rf=go(qi);function af(Ne){return"\\"+fo[Ne]}function xc(Ne,Ue){return Ne==null?t:Ne[Ue]}function hs(Ne){return Qr.test(Ne)}function sf(Ne){return fc.test(Ne)}function lf(Ne){for(var Ue,Oe=[];!(Ue=Ne.next()).done;)Oe.push(Ue.value);return Oe}function bc(Ne){var Ue=-1,Oe=Array(Ne.size);return Ne.forEach(function(mt,Ft){Oe[++Ue]=[Ft,mt]}),Oe}function of(Ne,Ue){return function(Oe){return Ne(Ue(Oe))}}function ps(Ne,Ue){for(var Oe=-1,mt=Ne.length,Ft=0,yn=[];++Oe<mt;){var xi=Ne[Oe];(xi===Ue||xi===h)&&(Ne[Oe]=h,yn[Ft++]=Oe)}return yn}function $a(Ne){var Ue=-1,Oe=Array(Ne.size);return Ne.forEach(function(mt){Oe[++Ue]=mt}),Oe}function cp(Ne){var Ue=-1,Oe=Array(Ne.size);return Ne.forEach(function(mt){Oe[++Ue]=[mt,mt]}),Oe}function Tu(Ne,Ue,Oe){for(var mt=Oe-1,Ft=Ne.length;++mt<Ft;)if(Ne[mt]===Ue)return mt;return-1}function xr(Ne,Ue,Oe){for(var mt=Oe+1;mt--;)if(Ne[mt]===Ue)return mt;return mt}function fa(Ne){return hs(Ne)?Eu(Ne):sp(Ne)}function Cr(Ne){return hs(Ne)?Au(Ne):lp(Ne)}function Xr(Ne){for(var Ue=Ne.length;Ue--&&Hn.test(Ne.charAt(Ue)););return Ue}var cf=go(Oa);function Eu(Ne){for(var Ue=La.lastIndex=0;La.test(Ne);)++Ue;return Ue}function Au(Ne){return Ne.match(La)||[]}function uf(Ne){return Ne.match(uo)||[]}var Fs=function Ne(Ue){Ue=Ue==null?Kn:za.defaults(Kn.Object(),Ue,za.pick(Kn,xl));var Oe=Ue.Array,mt=Ue.Date,Ft=Ue.Error,yn=Ue.Function,xi=Ue.Math,xn=Ue.Object,se=Ue.RegExp,pe=Ue.String,de=Ue.TypeError,_e=Oe.prototype,rt=yn.prototype,xt=xn.prototype,Ct=Ue["__core-js_shared__"],vt=rt.toString,Qt=xt.hasOwnProperty,cr=0,vo=function(){var m=/[^.]+$/.exec(Ct&&Ct.keys&&Ct.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Vi=xt.toString,Mi=vt.call(xn),vc=Kn._,up=se("^"+vt.call(Qt).replace(Dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wo=Nu?Ue.Buffer:t,Ba=Ue.Symbol,wc=Ue.Uint8Array,No=wo?wo.allocUnsafe:t,Pu=of(xn.getPrototypeOf,xn),Du=xn.create,So=xt.propertyIsEnumerable,df=_e.splice,kr=Ba?Ba.isConcatSpreadable:t,jo=Ba?Ba.iterator:t,br=Ba?Ba.toStringTag:t,Mu=function(){try{var m=Dl(xn,"defineProperty");return m({},"",{}),m}catch{}}(),ff=Ue.clearTimeout!==Kn.clearTimeout&&Ue.clearTimeout,_o=mt&&mt.now!==Kn.Date.now&&mt.now,dp=Ue.setTimeout!==Kn.setTimeout&&Ue.setTimeout,Nc=xi.ceil,$s=xi.floor,jl=xn.getOwnPropertySymbols,hf=wo?wo.isBuffer:t,Iu=Ue.isFinite,ha=_e.join,pa=of(xn.keys,xn),li=xi.max,ui=xi.min,zs=mt.now,Co=Ue.parseInt,fp=xi.random,hp=_e.reverse,Ru=Dl(Ue,"DataView"),Ii=Dl(Ue,"Map"),di=Dl(Ue,"Promise"),bn=Dl(Ue,"Set"),Ua=Dl(Ue,"WeakMap"),Tr=Dl(xn,"create"),Sc=Ua&&new Ua,ma={},Ng=Qs(Ru),Sg=Qs(Ii),Lu=Qs(di),Ou=Qs(bn),jg=Qs(Ua),_l=Ba?Ba.prototype:t,ko=_l?_l.valueOf:t,Cl=_l?_l.toString:t;function X(m){if(bi(m)&&!Jt(m)&&!(m instanceof fn)){if(m instanceof Er)return m;if(Qt.call(m,"__wrapped__"))return Li(m)}return new Er(m)}var Zr=function(){function m(){}return function(y){if(!hi(y))return{};if(Du)return Du(y);m.prototype=y;var k=new m;return m.prototype=t,k}}();function ga(){}function Er(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}X.templateSettings={escape:Nt,evaluate:Ot,interpolate:Vt,variable:"",imports:{_:X}},X.prototype=ga.prototype,X.prototype.constructor=X,Er.prototype=Zr(ga.prototype),Er.prototype.constructor=Er;function fn(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Q,this.__views__=[]}function Fu(){var m=new fn(this.__wrapped__);return m.__actions__=Ri(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=Ri(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=Ri(this.__views__),m}function pf(){if(this.__filtered__){var m=new fn(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function To(){var m=this.__wrapped__.value(),y=this.__dir__,k=Jt(m),L=y<0,Y=k?m.length:0,ae=iy(0,Y,this.__views__),he=ae.start,be=ae.end,ke=be-he,We=L?be:he-1,Je=this.__iteratees__,et=Je.length,yt=0,At=ui(ke,this.__takeCount__);if(!k||!L&&Y==ke&&At==ke)return qg(m,this.__actions__);var Ht=[];e:for(;ke--&&yt<At;){We+=y;for(var pn=-1,Gt=m[We];++pn<et;){var Nn=Je[pn],An=Nn.iteratee,Qa=Nn.type,sa=An(Gt);if(Qa==re)Gt=sa;else if(!sa){if(Qa==ne)continue e;break e}}Ht[yt++]=Gt}return Ht}fn.prototype=Zr(ga.prototype),fn.prototype.constructor=fn;function wi(m){var y=-1,k=m==null?0:m.length;for(this.clear();++y<k;){var L=m[y];this.set(L[0],L[1])}}function mf(){this.__data__=Tr?Tr(null):{},this.size=0}function _g(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function Gb(m){var y=this.__data__;if(Tr){var k=y[m];return k===u?t:k}return Qt.call(y,m)?y[m]:t}function Yb(m){var y=this.__data__;return Tr?y[m]!==t:Qt.call(y,m)}function Wb(m,y){var k=this.__data__;return this.size+=this.has(m)?0:1,k[m]=Tr&&y===t?u:y,this}wi.prototype.clear=mf,wi.prototype.delete=_g,wi.prototype.get=Gb,wi.prototype.has=Yb,wi.prototype.set=Wb;function Xn(m){var y=-1,k=m==null?0:m.length;for(this.clear();++y<k;){var L=m[y];this.set(L[0],L[1])}}function pp(){this.__data__=[],this.size=0}function $u(m){var y=this.__data__,k=Cc(y,m);if(k<0)return!1;var L=y.length-1;return k==L?y.pop():df.call(y,k,1),--this.size,!0}function zu(m){var y=this.__data__,k=Cc(y,m);return k<0?t:y[k][1]}function mp(m){return Cc(this.__data__,m)>-1}function jc(m,y){var k=this.__data__,L=Cc(k,m);return L<0?(++this.size,k.push([m,y])):k[L][1]=y,this}Xn.prototype.clear=pp,Xn.prototype.delete=$u,Xn.prototype.get=zu,Xn.prototype.has=mp,Xn.prototype.set=jc;function Ar(m){var y=-1,k=m==null?0:m.length;for(this.clear();++y<k;){var L=m[y];this.set(L[0],L[1])}}function Qb(){this.size=0,this.__data__={hash:new wi,map:new(Ii||Xn),string:new wi}}function Cg(m){var y=Dc(this,m).delete(m);return this.size-=y?1:0,y}function Jb(m){return Dc(this,m).get(m)}function kg(m){return Dc(this,m).has(m)}function Eo(m,y){var k=Dc(this,m),L=k.size;return k.set(m,y),this.size+=k.size==L?0:1,this}Ar.prototype.clear=Qb,Ar.prototype.delete=Cg,Ar.prototype.get=Jb,Ar.prototype.has=kg,Ar.prototype.set=Eo;function Bs(m){var y=-1,k=m==null?0:m.length;for(this.__data__=new Ar;++y<k;)this.add(m[y])}function gf(m){return this.__data__.set(m,u),this}function Tg(m){return this.__data__.has(m)}Bs.prototype.add=Bs.prototype.push=gf,Bs.prototype.has=Tg;function vr(m){var y=this.__data__=new Xn(m);this.size=y.size}function Eg(){this.__data__=new Xn,this.size=0}function yf(m){var y=this.__data__,k=y.delete(m);return this.size=y.size,k}function gp(m){return this.__data__.get(m)}function Ag(m){return this.__data__.has(m)}function xf(m,y){var k=this.__data__;if(k instanceof Xn){var L=k.__data__;if(!Ii||L.length<a-1)return L.push([m,y]),this.size=++k.size,this;k=this.__data__=new Ar(L)}return k.set(m,y),this.size=k.size,this}vr.prototype.clear=Eg,vr.prototype.delete=yf,vr.prototype.get=gp,vr.prototype.has=Ag,vr.prototype.set=xf;function yp(m,y){var k=Jt(m),L=!k&&Zs(m),Y=!k&&!L&&Ul(m),ae=!k&&!L&&!Y&&Gc(m),he=k||L||Y||ae,be=he?ir(m.length,pe):[],ke=be.length;for(var We in m)(y||Qt.call(m,We))&&!(he&&(We=="length"||Y&&(We=="offset"||We=="parent")||ae&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||Ga(We,ke)))&&be.push(We);return be}function _c(m){var y=m.length;return y?m[Tf(0,y-1)]:t}function Pg(m,y){return hd(Ri(m),Va(y,0,m.length))}function Dg(m){return hd(Ri(m))}function ms(m,y,k){(k!==t&&!Or(m[y],k)||k===t&&!(y in m))&&qa(m,y,k)}function Ao(m,y,k){var L=m[y];(!(Qt.call(m,y)&&Or(L,k))||k===t&&!(y in m))&&qa(m,y,k)}function Cc(m,y){for(var k=m.length;k--;)if(Or(m[k][0],y))return k;return-1}function kl(m,y,k,L){return qs(m,function(Y,ae,he){y(L,Y,k(Y),he)}),L}function Us(m,y){return m&&Mr(y,$i(y),m)}function Bu(m,y){return m&&Mr(y,Yi(y),m)}function qa(m,y,k){y=="__proto__"&&Mu?Mu(m,y,{configurable:!0,enumerable:!0,value:k,writable:!0}):m[y]=k}function Uu(m,y){for(var k=-1,L=y.length,Y=Oe(L),ae=m==null;++k<L;)Y[k]=ae?t:kd(m,y[k]);return Y}function Va(m,y,k){return m===m&&(k!==t&&(m=m<=k?m:k),y!==t&&(m=m>=y?m:y)),m}function ur(m,y,k,L,Y,ae){var he,be=y&g,ke=y&b,We=y&v;if(k&&(he=Y?k(m,L,Y,ae):k(m)),he!==t)return he;if(!hi(m))return m;var Je=Jt(m);if(Je){if(he=qp(m),!be)return Ri(m,he)}else{var et=Gi(m),yt=et==Le||et==Te;if(Ul(m))return Rp(m,be);if(et==it||et==xe||yt&&!Y){if(he=ke||yt?{}:Vp(m),!be)return ke?td(m,Bu(he,m)):If(m,Us(he,m))}else{if(!Cn[et])return Y?m:{};he=Hp(m,et,be)}}ae||(ae=new vr);var At=ae.get(m);if(At)return At;ae.set(m,he),Qy(m)?m.forEach(function(Gt){he.add(ur(Gt,y,k,Gt,m,ae))}):ah(m)&&m.forEach(function(Gt,Nn){he.set(Nn,ur(Gt,y,k,Nn,m,ae))});var Ht=We?ke?Ff:Of:ke?Yi:$i,pn=Je?t:Ht(m);return nr(pn||m,function(Gt,Nn){pn&&(Nn=Gt,Gt=m[Nn]),Ao(he,Nn,ur(Gt,y,k,Nn,m,ae))}),he}function Mg(m){var y=$i(m);return function(k){return xp(k,m,y)}}function xp(m,y,k){var L=k.length;if(m==null)return!L;for(m=xn(m);L--;){var Y=k[L],ae=y[Y],he=m[Y];if(he===t&&!(Y in m)||!ae(he))return!1}return!0}function Po(m,y,k){if(typeof m!="function")throw new de(o);return Ic(function(){m.apply(t,k)},y)}function Tl(m,y,k,L){var Y=-1,ae=us,he=!0,be=m.length,ke=[],We=y.length;if(!be)return ke;k&&(y=Yn(y,or(k))),L?(ae=wl,he=!1):y.length>=a&&(ae=Ls,he=!1,y=new Bs(y));e:for(;++Y<be;){var Je=m[Y],et=k==null?Je:k(Je);if(Je=L||Je!==0?Je:0,he&&et===et){for(var yt=We;yt--;)if(y[yt]===et)continue e;ke.push(Je)}else ae(y,et,L)||ke.push(Je)}return ke}var qs=$p(dr),bf=$p(Tc,!0);function bp(m,y){var k=!0;return qs(m,function(L,Y,ae){return k=!!y(L,Y,ae),k}),k}function Ha(m,y,k){for(var L=-1,Y=m.length;++L<Y;){var ae=m[L],he=y(ae);if(he!=null&&(be===t?he===he&&!Sr(he):k(he,be)))var be=he,ke=ae}return ke}function on(m,y,k,L){var Y=m.length;for(k=nn(k),k<0&&(k=-k>Y?0:Y+k),L=L===t||L>Y?Y:nn(L),L<0&&(L+=Y),L=k>L?0:js(L);k<L;)m[k++]=y;return m}function Fn(m,y){var k=[];return qs(m,function(L,Y,ae){y(L,Y,ae)&&k.push(L)}),k}function vn(m,y,k,L,Y){var ae=-1,he=m.length;for(k||(k=Ys),Y||(Y=[]);++ae<he;){var be=m[ae];y>0&&k(be)?y>1?vn(be,y-1,k,L,Y):Kr(Y,be):L||(Y[Y.length]=be)}return Y}var kc=Fo(),Do=Fo(!0);function dr(m,y){return m&&kc(m,y,$i)}function Tc(m,y){return m&&Do(m,y,$i)}function El(m,y){return Jr(y,function(k){return Ya(m[k])})}function ya(m,y){y=Hs(y,m);for(var k=0,L=y.length;m!=null&&k<L;)m=m[Ln(y[k++])];return k&&k==L?m:t}function Ig(m,y,k){var L=y(m);return Jt(m)?L:Kr(L,k(m))}function wn(m){return m==null?m===t?en:Xe:br&&br in xn(m)?ny(m):oy(m)}function qu(m,y){return m>y}function vp(m,y){return m!=null&&Qt.call(m,y)}function Rg(m,y){return m!=null&&y in xn(m)}function Lg(m,y,k){return m>=ui(y,k)&&m<li(y,k)}function wp(m,y,k){for(var L=k?wl:us,Y=m[0].length,ae=m.length,he=ae,be=Oe(ae),ke=1/0,We=[];he--;){var Je=m[he];he&&y&&(Je=Yn(Je,or(y))),ke=ui(Je.length,ke),be[he]=!k&&(y||Y>=120&&Je.length>=120)?new Bs(he&&Je):t}Je=m[0];var et=-1,yt=be[0];e:for(;++et<Y&&We.length<ke;){var At=Je[et],Ht=y?y(At):At;if(At=k||At!==0?At:0,!(yt?Ls(yt,Ht):L(We,Ht,k))){for(he=ae;--he;){var pn=be[he];if(!(pn?Ls(pn,Ht):L(m[he],Ht,k)))continue e}yt&&yt.push(Ht),We.push(At)}}return We}function Np(m,y,k,L){return dr(m,function(Y,ae,he){y(L,k(Y),ae,he)}),L}function Mo(m,y,k){y=Hs(y,m),m=Mc(m,y);var L=m==null?m:m[Ln(fr(y))];return L==null?t:lr(L,m,k)}function vf(m){return bi(m)&&wn(m)==xe}function Pr(m){return bi(m)&&wn(m)==fe}function Ei(m){return bi(m)&&wn(m)==Re}function Io(m,y,k,L,Y){return m===y?!0:m==null||y==null||!bi(m)&&!bi(y)?m!==m&&y!==y:Vu(m,y,k,L,Io,Y)}function Vu(m,y,k,L,Y,ae){var he=Jt(m),be=Jt(y),ke=he?le:Gi(m),We=be?le:Gi(y);ke=ke==xe?it:ke,We=We==xe?it:We;var Je=ke==it,et=We==it,yt=ke==We;if(yt&&Ul(m)){if(!Ul(y))return!1;he=!0,Je=!1}if(yt&&!Je)return ae||(ae=new vr),he||Gc(m)?ey(m,y,k,L,Y,ae):ty(m,y,ke,k,L,Y,ae);if(!(k&N)){var At=Je&&Qt.call(m,"__wrapped__"),Ht=et&&Qt.call(y,"__wrapped__");if(At||Ht){var pn=At?m.value():m,Gt=Ht?y.value():y;return ae||(ae=new vr),Y(pn,Gt,k,L,ae)}}return yt?(ae||(ae=new vr),Hi(m,y,k,L,Y,ae)):!1}function wf(m){return bi(m)&&Gi(m)==we}function Hu(m,y,k,L){var Y=k.length,ae=Y,he=!L;if(m==null)return!ae;for(m=xn(m);Y--;){var be=k[Y];if(he&&be[2]?be[1]!==m[be[0]]:!(be[0]in m))return!1}for(;++Y<ae;){be=k[Y];var ke=be[0],We=m[ke],Je=be[1];if(he&&be[2]){if(We===t&&!(ke in m))return!1}else{var et=new vr;if(L)var yt=L(We,Je,ke,m,y,et);if(!(yt===t?Io(Je,We,N|C,L,et):yt))return!1}}return!0}function gs(m){if(!hi(m)||Vf(m))return!1;var y=Ya(m)?up:Es;return y.test(Qs(m))}function Nf(m){return bi(m)&&wn(m)==ze}function Sp(m){return bi(m)&&Gi(m)==ct}function jp(m){return bi(m)&&qo(m.length)&&!!Dn[wn(m)]}function _p(m){return typeof m=="function"?m:m==null?De:typeof m=="object"?Jt(m)?_f(m[0],m[1]):kp(m):En(m)}function Sf(m){if(!Zn(m))return pa(m);var y=[];for(var k in xn(m))Qt.call(m,k)&&k!="constructor"&&y.push(k);return y}function Og(m){if(!hi(m))return Ml(m);var y=Zn(m),k=[];for(var L in m)L=="constructor"&&(y||!Qt.call(m,L))||k.push(L);return k}function jf(m,y){return m<y}function Cp(m,y){var k=-1,L=Oi(m)?Oe(m.length):[];return qs(m,function(Y,ae,he){L[++k]=y(Y,ae,he)}),L}function kp(m){var y=zf(m);return y.length==1&&y[0][2]?sy(y[0][0],y[0][1]):function(k){return k===m||Hu(k,m,y)}}function _f(m,y){return Uf(m)&&ay(y)?sy(Ln(m),y):function(k){var L=kd(k,m);return L===t&&L===y?Jc(k,m):Io(y,L,N|C)}}function Gu(m,y,k,L,Y){m!==y&&kc(y,function(ae,he){if(Y||(Y=new vr),hi(ae))Kb(m,y,he,k,Gu,L,Y);else{var be=L?L(Hf(m,he),ae,he+"",m,y,Y):t;be===t&&(be=ae),ms(m,he,be)}},Yi)}function Kb(m,y,k,L,Y,ae,he){var be=Hf(m,k),ke=Hf(y,k),We=he.get(ke);if(We){ms(m,k,We);return}var Je=ae?ae(be,ke,k+"",m,y,he):t,et=Je===t;if(et){var yt=Jt(ke),At=!yt&&Ul(ke),Ht=!yt&&!At&&Gc(ke);Je=ke,yt||At||Ht?Jt(be)?Je=be:ji(be)?Je=Ri(be):At?(et=!1,Je=Rp(ke,!0)):Ht?(et=!1,Je=Op(ke,!0)):Je=[]:wa(ke)||Zs(ke)?(Je=be,Zs(be)?Je=Xy(be):(!hi(be)||Ya(be))&&(Je=Vp(ke))):et=!1}et&&(he.set(ke,Je),Y(Je,ke,L,ae,he),he.delete(ke)),ms(m,k,Je)}function Tp(m,y){var k=m.length;if(k)return y+=y<0?k:0,Ga(y,k)?m[y]:t}function Ep(m,y,k){y.length?y=Yn(y,function(ae){return Jt(ae)?function(he){return ya(he,ae.length===1?ae[0]:ae)}:ae}):y=[De];var L=-1;y=Yn(y,or(Rt()));var Y=Cp(m,function(ae,he,be){var ke=Yn(y,function(We){return We(ae)});return{criteria:ke,index:++L,value:ae}});return yo(Y,function(ae,he){return Yg(ae,he,k)})}function Fg(m,y){return Cf(m,y,function(k,L){return Jc(m,L)})}function Cf(m,y,k){for(var L=-1,Y=y.length,ae={};++L<Y;){var he=y[L],be=ya(m,he);k(be,he)&&Ac(ae,Hs(he,m),be)}return ae}function $g(m){return function(y){return ya(y,m)}}function kf(m,y,k,L){var Y=L?Cu:Nl,ae=-1,he=y.length,be=m;for(m===y&&(y=Ri(y)),k&&(be=Yn(m,or(k)));++ae<he;)for(var ke=0,We=y[ae],Je=k?k(We):We;(ke=Y(be,Je,ke,L))>-1;)be!==m&&df.call(be,ke,1),df.call(m,ke,1);return m}function Ap(m,y){for(var k=m?y.length:0,L=k-1;k--;){var Y=y[k];if(k==L||Y!==ae){var ae=Y;Ga(Y)?df.call(m,Y,1):Ju(m,Y)}}return m}function Tf(m,y){return m+$s(fp()*(y-m+1))}function zg(m,y,k,L){for(var Y=-1,ae=li(Nc((y-m)/(k||1)),0),he=Oe(ae);ae--;)he[L?ae:++Y]=m,m+=k;return he}function Pp(m,y){var k="";if(!m||y<1||y>H)return k;do y%2&&(k+=m),y=$s(y/2),y&&(m+=m);while(y);return k}function sn(m,y){return dd(Gp(m,y,De),m+"")}function Ec(m){return _c(Xc(m))}function Ef(m,y){var k=Xc(m);return hd(k,Va(y,0,k.length))}function Ac(m,y,k,L){if(!hi(m))return m;y=Hs(y,m);for(var Y=-1,ae=y.length,he=ae-1,be=m;be!=null&&++Y<ae;){var ke=Ln(y[Y]),We=k;if(ke==="__proto__"||ke==="constructor"||ke==="prototype")return m;if(Y!=he){var Je=be[ke];We=L?L(Je,ke,be):t,We===t&&(We=hi(Je)?Je:Ga(y[Y+1])?[]:{})}Ao(be,ke,We),be=be[ke]}return m}var Yu=Sc?function(m,y){return Sc.set(m,y),m}:De,Wu=Mu?function(m,y){return Mu(m,"toString",{configurable:!0,enumerable:!1,value:Pe(y),writable:!0})}:De;function Bg(m){return hd(Xc(m))}function ea(m,y,k){var L=-1,Y=m.length;y<0&&(y=-y>Y?0:Y+y),k=k>Y?Y:k,k<0&&(k+=Y),Y=y>k?0:k-y>>>0,y>>>=0;for(var ae=Oe(Y);++L<Y;)ae[L]=m[L+y];return ae}function Ug(m,y){var k;return qs(m,function(L,Y,ae){return k=y(L,Y,ae),!k}),!!k}function Qu(m,y,k){var L=0,Y=m==null?L:m.length;if(typeof y=="number"&&y===y&&Y<=I){for(;L<Y;){var ae=L+Y>>>1,he=m[ae];he!==null&&!Sr(he)&&(k?he<=y:he<y)?L=ae+1:Y=ae}return Y}return Af(m,y,De,k)}function Af(m,y,k,L){var Y=0,ae=m==null?0:m.length;if(ae===0)return 0;y=k(y);for(var he=y!==y,be=y===null,ke=Sr(y),We=y===t;Y<ae;){var Je=$s((Y+ae)/2),et=k(m[Je]),yt=et!==t,At=et===null,Ht=et===et,pn=Sr(et);if(he)var Gt=L||Ht;else We?Gt=Ht&&(L||yt):be?Gt=Ht&&yt&&(L||!At):ke?Gt=Ht&&yt&&!At&&(L||!pn):At||pn?Gt=!1:Gt=L?et<=y:et<y;Gt?Y=Je+1:ae=Je}return ui(ae,ie)}function Dp(m,y){for(var k=-1,L=m.length,Y=0,ae=[];++k<L;){var he=m[k],be=y?y(he):he;if(!k||!Or(be,ke)){var ke=be;ae[Y++]=he===0?0:he}}return ae}function Pf(m){return typeof m=="number"?m:Sr(m)?E:+m}function Dr(m){if(typeof m=="string")return m;if(Jt(m))return Yn(m,Dr)+"";if(Sr(m))return Cl?Cl.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Vs(m,y,k){var L=-1,Y=us,ae=m.length,he=!0,be=[],ke=be;if(k)he=!1,Y=wl;else if(ae>=a){var We=y?null:Xg(m);if(We)return $a(We);he=!1,Y=Ls,ke=new Bs}else ke=y?[]:be;e:for(;++L<ae;){var Je=m[L],et=y?y(Je):Je;if(Je=k||Je!==0?Je:0,he&&et===et){for(var yt=ke.length;yt--;)if(ke[yt]===et)continue e;y&&ke.push(et),be.push(Je)}else Y(ke,et,k)||(ke!==be&&ke.push(et),be.push(Je))}return be}function Ju(m,y){return y=Hs(y,m),m=Mc(m,y),m==null||delete m[Ln(fr(y))]}function Mp(m,y,k,L){return Ac(m,y,k(ya(m,y)),L)}function Ku(m,y,k,L){for(var Y=m.length,ae=L?Y:-1;(L?ae--:++ae<Y)&&y(m[ae],ae,m););return k?ea(m,L?0:ae,L?ae+1:Y):ea(m,L?ae+1:0,L?Y:ae)}function qg(m,y){var k=m;return k instanceof fn&&(k=k.value()),ju(y,function(L,Y){return Y.func.apply(Y.thisArg,Kr([L],Y.args))},k)}function Xu(m,y,k){var L=m.length;if(L<2)return L?Vs(m[0]):[];for(var Y=-1,ae=Oe(L);++Y<L;)for(var he=m[Y],be=-1;++be<L;)be!=Y&&(ae[Y]=Tl(ae[Y]||he,m[be],y,k));return Vs(vn(ae,1),y,k)}function Ip(m,y,k){for(var L=-1,Y=m.length,ae=y.length,he={};++L<Y;){var be=L<ae?y[L]:t;k(he,m[L],be)}return he}function Df(m){return ji(m)?m:[]}function Zu(m){return typeof m=="function"?m:De}function Hs(m,y){return Jt(m)?m:Uf(m,y)?[m]:vs(Mn(m))}var Vg=sn;function Al(m,y,k){var L=m.length;return k=k===t?L:k,!y&&k>=L?m:ea(m,y,k)}var Hg=ff||function(m){return Kn.clearTimeout(m)};function Rp(m,y){if(y)return m.slice();var k=m.length,L=No?No(k):new m.constructor(k);return m.copy(L),L}function Ro(m){var y=new m.constructor(m.byteLength);return new wc(y).set(new wc(m)),y}function Lp(m,y){var k=y?Ro(m.buffer):m.buffer;return new m.constructor(k,m.byteOffset,m.byteLength)}function Mf(m){var y=new m.constructor(m.source,pr.exec(m));return y.lastIndex=m.lastIndex,y}function Gg(m){return ko?xn(ko.call(m)):{}}function Op(m,y){var k=y?Ro(m.buffer):m.buffer;return new m.constructor(k,m.byteOffset,m.length)}function ed(m,y){if(m!==y){var k=m!==t,L=m===null,Y=m===m,ae=Sr(m),he=y!==t,be=y===null,ke=y===y,We=Sr(y);if(!be&&!We&&!ae&&m>y||ae&&he&&ke&&!be&&!We||L&&he&&ke||!k&&ke||!Y)return 1;if(!L&&!ae&&!We&&m<y||We&&k&&Y&&!L&&!ae||be&&k&&Y||!he&&Y||!ke)return-1}return 0}function Yg(m,y,k){for(var L=-1,Y=m.criteria,ae=y.criteria,he=Y.length,be=k.length;++L<he;){var ke=ed(Y[L],ae[L]);if(ke){if(L>=be)return ke;var We=k[L];return ke*(We=="desc"?-1:1)}}return m.index-y.index}function Fp(m,y,k,L){for(var Y=-1,ae=m.length,he=k.length,be=-1,ke=y.length,We=li(ae-he,0),Je=Oe(ke+We),et=!L;++be<ke;)Je[be]=y[be];for(;++Y<he;)(et||Y<ae)&&(Je[k[Y]]=m[Y]);for(;We--;)Je[be++]=m[Y++];return Je}function Wg(m,y,k,L){for(var Y=-1,ae=m.length,he=-1,be=k.length,ke=-1,We=y.length,Je=li(ae-be,0),et=Oe(Je+We),yt=!L;++Y<Je;)et[Y]=m[Y];for(var At=Y;++ke<We;)et[At+ke]=y[ke];for(;++he<be;)(yt||Y<ae)&&(et[At+k[he]]=m[Y++]);return et}function Ri(m,y){var k=-1,L=m.length;for(y||(y=Oe(L));++k<L;)y[k]=m[k];return y}function Mr(m,y,k,L){var Y=!k;k||(k={});for(var ae=-1,he=y.length;++ae<he;){var be=y[ae],ke=L?L(k[be],m[be],be,k,m):t;ke===t&&(ke=m[be]),Y?qa(k,be,ke):Ao(k,be,ke)}return k}function If(m,y){return Mr(m,ld(m),y)}function td(m,y){return Mr(m,Bf(m),y)}function Lo(m,y){return function(k,L){var Y=Jt(k)?ap:kl,ae=y?y():{};return Y(k,m,Rt(L,2),ae)}}function Oo(m){return sn(function(y,k){var L=-1,Y=k.length,ae=Y>1?k[Y-1]:t,he=Y>2?k[2]:t;for(ae=m.length>3&&typeof ae=="function"?(Y--,ae):t,he&&Nr(k[0],k[1],he)&&(ae=Y<3?t:ae,Y=1),y=xn(y);++L<Y;){var be=k[L];be&&m(y,be,L,ae)}return y})}function $p(m,y){return function(k,L){if(k==null)return k;if(!Oi(k))return m(k,L);for(var Y=k.length,ae=y?Y:-1,he=xn(k);(y?ae--:++ae<Y)&&L(he[ae],ae,he)!==!1;);return k}}function Fo(m){return function(y,k,L){for(var Y=-1,ae=xn(y),he=L(y),be=he.length;be--;){var ke=he[m?be:++Y];if(k(ae[ke],ke,ae)===!1)break}return y}}function Qg(m,y,k){var L=y&A,Y=xa(m);function ae(){var he=this&&this!==Kn&&this instanceof ae?Y:m;return he.apply(L?k:this,arguments)}return ae}function ta(m){return function(y){y=Mn(y);var k=hs(y)?Cr(y):t,L=k?k[0]:y.charAt(0),Y=k?Al(k,1).join(""):y.slice(1);return L[m]()+Y}}function wr(m){return function(y){return ju(S(el(y).replace(yl,"")),m,"")}}function xa(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var k=Zr(m.prototype),L=m.apply(k,y);return hi(L)?L:k}}function Jg(m,y,k){var L=xa(m);function Y(){for(var ae=arguments.length,he=Oe(ae),be=ae,ke=zo(Y);be--;)he[be]=arguments[be];var We=ae<3&&he[0]!==ke&&he[ae-1]!==ke?[]:ps(he,ke);if(ae-=We.length,ae<k)return zp(m,y,Ni,Y.placeholder,t,he,We,t,t,k-ae);var Je=this&&this!==Kn&&this instanceof Y?L:m;return lr(Je,this,he)}return Y}function Gs(m){return function(y,k,L){var Y=xn(y);if(!Oi(y)){var ae=Rt(k,3);y=$i(y),k=function(be){return ae(Y[be],be,Y)}}var he=m(y,k,L);return he>-1?Y[ae?y[he]:he]:t}}function ys(m){return oi(function(y){var k=y.length,L=k,Y=Er.prototype.thru;for(m&&y.reverse();L--;){var ae=y[L];if(typeof ae!="function")throw new de(o);if(Y&&!he&&sd(ae)=="wrapper")var he=new Er([],!0)}for(L=he?L:k;++L<k;){ae=y[L];var be=sd(ae),ke=be=="wrapper"?$f(ae):t;ke&&qf(ke[0])&&ke[1]==(B|M|F|U)&&!ke[4].length&&ke[9]==1?he=he[sd(ke[0])].apply(he,ke[3]):he=ae.length==1&&qf(ae)?he[be]():he.thru(ae)}return function(){var We=arguments,Je=We[0];if(he&&We.length==1&&Jt(Je))return he.plant(Je).value();for(var et=0,yt=k?y[et].apply(this,We):Je;++et<k;)yt=y[et].call(this,yt);return yt}})}function Ni(m,y,k,L,Y,ae,he,be,ke,We){var Je=y&B,et=y&A,yt=y&T,At=y&(M|V),Ht=y&R,pn=yt?t:xa(m);function Gt(){for(var Nn=arguments.length,An=Oe(Nn),Qa=Nn;Qa--;)An[Qa]=arguments[Qa];if(At)var sa=zo(Gt),Ja=nf(An,sa);if(L&&(An=Fp(An,L,Y,At)),ae&&(An=Wg(An,ae,he,At)),Nn-=Ja,At&&Nn<We){var zi=ps(An,sa);return zp(m,y,Ni,Gt.placeholder,k,An,zi,be,ke,We-Nn)}var tl=et?k:this,Vo=yt?tl[m]:m;return Nn=An.length,be?An=bs(An,be):Ht&&Nn>1&&An.reverse(),Je&&ke<Nn&&(An.length=ke),this&&this!==Kn&&this instanceof Gt&&(Vo=pn||xa(Vo)),Vo.apply(tl,An)}return Gt}function nd(m,y){return function(k,L){return Np(k,m,y(L),{})}}function Pc(m,y){return function(k,L){var Y;if(k===t&&L===t)return y;if(k!==t&&(Y=k),L!==t){if(Y===t)return L;typeof k=="string"||typeof L=="string"?(k=Dr(k),L=Dr(L)):(k=Pf(k),L=Pf(L)),Y=m(k,L)}return Y}}function id(m){return oi(function(y){return y=Yn(y,or(Rt())),sn(function(k){var L=this;return m(y,function(Y){return lr(Y,L,k)})})})}function rd(m,y){y=y===t?" ":Dr(y);var k=y.length;if(k<2)return k?Pp(y,m):y;var L=Pp(y,Nc(m/fa(y)));return hs(y)?Al(Cr(L),0,m).join(""):L.slice(0,m)}function Kg(m,y,k,L){var Y=y&A,ae=xa(m);function he(){for(var be=-1,ke=arguments.length,We=-1,Je=L.length,et=Oe(Je+ke),yt=this&&this!==Kn&&this instanceof he?ae:m;++We<Je;)et[We]=L[We];for(;ke--;)et[We++]=arguments[++be];return lr(yt,Y?k:this,et)}return he}function Pl(m){return function(y,k,L){return L&&typeof L!="number"&&Nr(y,k,L)&&(k=L=t),y=Ss(y),k===t?(k=y,y=0):k=Ss(k),L=L===t?y<k?1:-1:Ss(L),zg(y,k,L,m)}}function $o(m){return function(y,k){return typeof y=="string"&&typeof k=="string"||(y=Na(y),k=Na(k)),m(y,k)}}function zp(m,y,k,L,Y,ae,he,be,ke,We){var Je=y&M,et=Je?he:t,yt=Je?t:he,At=Je?ae:t,Ht=Je?t:ae;y|=Je?F:z,y&=~(Je?z:F),y&D||(y&=-4);var pn=[m,y,Y,At,et,Ht,yt,be,ke,We],Gt=k.apply(t,pn);return qf(m)&&Gf(Gt,pn),Gt.placeholder=L,Yf(Gt,m,y)}function Rf(m){var y=xi[m];return function(k,L){if(k=Na(k),L=L==null?0:ui(nn(L),292),L&&Iu(k)){var Y=(Mn(k)+"e").split("e"),ae=y(Y[0]+"e"+(+Y[1]+L));return Y=(Mn(ae)+"e").split("e"),+(Y[0]+"e"+(+Y[1]-L))}return y(k)}}var Xg=bn&&1/$a(new bn([,-0]))[1]==q?function(m){return new bn(m)}:St;function ad(m){return function(y){var k=Gi(y);return k==we?bc(y):k==ct?cp(y):ds(y,m(y))}}function xs(m,y,k,L,Y,ae,he,be){var ke=y&T;if(!ke&&typeof m!="function")throw new de(o);var We=L?L.length:0;if(We||(y&=-97,L=Y=t),he=he===t?he:li(nn(he),0),be=be===t?be:nn(be),We-=Y?Y.length:0,y&z){var Je=L,et=Y;L=Y=t}var yt=ke?t:$f(m),At=[m,y,k,L,Y,Je,et,ae,he,be];if(yt&&ud(At,yt),m=At[0],y=At[1],k=At[2],L=At[3],Y=At[4],be=At[9]=At[9]===t?ke?0:m.length:li(At[9]-We,0),!be&&y&(M|V)&&(y&=-25),!y||y==A)var Ht=Qg(m,y,k);else y==M||y==V?Ht=Jg(m,y,be):(y==F||y==(A|F))&&!Y.length?Ht=Kg(m,y,k,L):Ht=Ni.apply(t,At);var pn=yt?Yu:Gf;return Yf(pn(Ht,At),m,y)}function Lf(m,y,k,L){return m===t||Or(m,xt[k])&&!Qt.call(L,k)?y:m}function Bp(m,y,k,L,Y,ae){return hi(m)&&hi(y)&&(ae.set(y,m),Gu(m,y,t,Bp,ae),ae.delete(y)),m}function Zg(m){return wa(m)?t:m}function ey(m,y,k,L,Y,ae){var he=k&N,be=m.length,ke=y.length;if(be!=ke&&!(he&&ke>be))return!1;var We=ae.get(m),Je=ae.get(y);if(We&&Je)return We==y&&Je==m;var et=-1,yt=!0,At=k&C?new Bs:t;for(ae.set(m,y),ae.set(y,m);++et<be;){var Ht=m[et],pn=y[et];if(L)var Gt=he?L(pn,Ht,et,y,m,ae):L(Ht,pn,et,m,y,ae);if(Gt!==t){if(Gt)continue;yt=!1;break}if(At){if(!_u(y,function(Nn,An){if(!Ls(At,An)&&(Ht===Nn||Y(Ht,Nn,k,L,ae)))return At.push(An)})){yt=!1;break}}else if(!(Ht===pn||Y(Ht,pn,k,L,ae))){yt=!1;break}}return ae.delete(m),ae.delete(y),yt}function ty(m,y,k,L,Y,ae,he){switch(k){case Ae:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case fe:return!(m.byteLength!=y.byteLength||!ae(new wc(m),new wc(y)));case ye:case Re:case Fe:return Or(+m,+y);case at:return m.name==y.name&&m.message==y.message;case ze:case Tt:return m==y+"";case we:var be=bc;case ct:var ke=L&N;if(be||(be=$a),m.size!=y.size&&!ke)return!1;var We=he.get(m);if(We)return We==y;L|=C,he.set(m,y);var Je=ey(be(m),be(y),L,Y,ae,he);return he.delete(m),Je;case bt:if(ko)return ko.call(m)==ko.call(y)}return!1}function Hi(m,y,k,L,Y,ae){var he=k&N,be=Of(m),ke=be.length,We=Of(y),Je=We.length;if(ke!=Je&&!he)return!1;for(var et=ke;et--;){var yt=be[et];if(!(he?yt in y:Qt.call(y,yt)))return!1}var At=ae.get(m),Ht=ae.get(y);if(At&&Ht)return At==y&&Ht==m;var pn=!0;ae.set(m,y),ae.set(y,m);for(var Gt=he;++et<ke;){yt=be[et];var Nn=m[yt],An=y[yt];if(L)var Qa=he?L(An,Nn,yt,y,m,ae):L(Nn,An,yt,m,y,ae);if(!(Qa===t?Nn===An||Y(Nn,An,k,L,ae):Qa)){pn=!1;break}Gt||(Gt=yt=="constructor")}if(pn&&!Gt){var sa=m.constructor,Ja=y.constructor;sa!=Ja&&"constructor"in m&&"constructor"in y&&!(typeof sa=="function"&&sa instanceof sa&&typeof Ja=="function"&&Ja instanceof Ja)&&(pn=!1)}return ae.delete(m),ae.delete(y),pn}function oi(m){return dd(Gp(m,t,Rr),m+"")}function Of(m){return Ig(m,$i,ld)}function Ff(m){return Ig(m,Yi,Bf)}var $f=Sc?function(m){return Sc.get(m)}:St;function sd(m){for(var y=m.name+"",k=ma[y],L=Qt.call(ma,y)?k.length:0;L--;){var Y=k[L],ae=Y.func;if(ae==null||ae==m)return Y.name}return y}function zo(m){var y=Qt.call(X,"placeholder")?X:m;return y.placeholder}function Rt(){var m=X.iteratee||zt;return m=m===zt?_p:m,arguments.length?m(arguments[0],arguments[1]):m}function Dc(m,y){var k=m.__data__;return Ws(y)?k[typeof y=="string"?"string":"hash"]:k.map}function zf(m){for(var y=$i(m),k=y.length;k--;){var L=y[k],Y=m[L];y[k]=[L,Y,ay(Y)]}return y}function Dl(m,y){var k=xc(m,y);return gs(k)?k:t}function ny(m){var y=Qt.call(m,br),k=m[br];try{m[br]=t;var L=!0}catch{}var Y=Vi.call(m);return L&&(y?m[br]=k:delete m[br]),Y}var ld=jl?function(m){return m==null?[]:(m=xn(m),Jr(jl(m),function(y){return So.call(m,y)}))}:I0,Bf=jl?function(m){for(var y=[];m;)Kr(y,ld(m)),m=Pu(m);return y}:I0,Gi=wn;(Ru&&Gi(new Ru(new ArrayBuffer(1)))!=Ae||Ii&&Gi(new Ii)!=we||di&&Gi(di.resolve())!=je||bn&&Gi(new bn)!=ct||Ua&&Gi(new Ua)!=oe)&&(Gi=function(m){var y=wn(m),k=y==it?m.constructor:t,L=k?Qs(k):"";if(L)switch(L){case Ng:return Ae;case Sg:return we;case Lu:return je;case Ou:return ct;case jg:return oe}return y});function iy(m,y,k){for(var L=-1,Y=k.length;++L<Y;){var ae=k[L],he=ae.size;switch(ae.type){case"drop":m+=he;break;case"dropRight":y-=he;break;case"take":y=ui(y,m+he);break;case"takeRight":m=li(m,y-he);break}}return{start:m,end:y}}function Up(m){var y=m.match(sr);return y?y[1].split(Rn):[]}function od(m,y,k){y=Hs(y,m);for(var L=-1,Y=y.length,ae=!1;++L<Y;){var he=Ln(y[L]);if(!(ae=m!=null&&k(m,he)))break;m=m[he]}return ae||++L!=Y?ae:(Y=m==null?0:m.length,!!Y&&qo(Y)&&Ga(he,Y)&&(Jt(m)||Zs(m)))}function qp(m){var y=m.length,k=new m.constructor(y);return y&&typeof m[0]=="string"&&Qt.call(m,"index")&&(k.index=m.index,k.input=m.input),k}function Vp(m){return typeof m.constructor=="function"&&!Zn(m)?Zr(Pu(m)):{}}function Hp(m,y,k){var L=m.constructor;switch(y){case fe:return Ro(m);case ye:case Re:return new L(+m);case Ae:return Lp(m,k);case Ie:case Ye:case ft:case gt:case jt:case $e:case nt:case Ve:case ht:return Op(m,k);case we:return new L;case Fe:case Tt:return new L(m);case ze:return Mf(m);case ct:return new L;case bt:return Gg(m)}}function ry(m,y){var k=y.length;if(!k)return m;var L=k-1;return y[L]=(k>1?"& ":"")+y[L],y=y.join(k>2?", ":" "),m.replace(Ti,`{
/* [wrapped with `+y+`] */
`)}function Ys(m){return Jt(m)||Zs(m)||!!(kr&&m&&m[kr])}function Ga(m,y){var k=typeof m;return y=y??H,!!y&&(k=="number"||k!="symbol"&&Ia.test(m))&&m>-1&&m%1==0&&m<y}function Nr(m,y,k){if(!hi(k))return!1;var L=typeof y;return(L=="number"?Oi(k)&&Ga(y,k.length):L=="string"&&y in k)?Or(k[y],m):!1}function Uf(m,y){if(Jt(m))return!1;var k=typeof m;return k=="number"||k=="symbol"||k=="boolean"||m==null||Sr(m)?!0:Wt.test(m)||!_t.test(m)||y!=null&&m in xn(y)}function Ws(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function qf(m){var y=sd(m),k=X[y];if(typeof k!="function"||!(y in fn.prototype))return!1;if(m===k)return!0;var L=$f(k);return!!L&&m===L[0]}function Vf(m){return!!vo&&vo in m}var cd=Ct?Ya:R0;function Zn(m){var y=m&&m.constructor,k=typeof y=="function"&&y.prototype||xt;return m===k}function ay(m){return m===m&&!hi(m)}function sy(m,y){return function(k){return k==null?!1:k[m]===y&&(y!==t||m in xn(k))}}function ly(m){var y=wd(m,function(L){return k.size===d&&k.clear(),L}),k=y.cache;return y}function ud(m,y){var k=m[1],L=y[1],Y=k|L,ae=Y<(A|T|B),he=L==B&&k==M||L==B&&k==U&&m[7].length<=y[8]||L==(B|U)&&y[7].length<=y[8]&&k==M;if(!(ae||he))return m;L&A&&(m[2]=y[2],Y|=k&A?0:D);var be=y[3];if(be){var ke=m[3];m[3]=ke?Fp(ke,be,y[4]):be,m[4]=ke?ps(m[3],h):y[4]}return be=y[5],be&&(ke=m[5],m[5]=ke?Wg(ke,be,y[6]):be,m[6]=ke?ps(m[5],h):y[6]),be=y[7],be&&(m[7]=be),L&B&&(m[8]=m[8]==null?y[8]:ui(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=Y,m}function Ml(m){var y=[];if(m!=null)for(var k in xn(m))y.push(k);return y}function oy(m){return Vi.call(m)}function Gp(m,y,k){return y=li(y===t?m.length-1:y,0),function(){for(var L=arguments,Y=-1,ae=li(L.length-y,0),he=Oe(ae);++Y<ae;)he[Y]=L[y+Y];Y=-1;for(var be=Oe(y+1);++Y<y;)be[Y]=L[Y];return be[y]=k(he),lr(m,this,be)}}function Mc(m,y){return y.length<2?m:ya(m,ea(y,0,-1))}function bs(m,y){for(var k=m.length,L=ui(y.length,k),Y=Ri(m);L--;){var ae=y[L];m[L]=Ga(ae,k)?Y[ae]:t}return m}function Hf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Gf=fd(Yu),Ic=dp||function(m,y){return Kn.setTimeout(m,y)},dd=fd(Wu);function Yf(m,y,k){var L=y+"";return dd(m,ry(L,cy(Up(L),k)))}function fd(m){var y=0,k=0;return function(){var L=zs(),Y=te-(L-k);if(k=L,Y>0){if(++y>=W)return arguments[0]}else y=0;return m.apply(t,arguments)}}function hd(m,y){var k=-1,L=m.length,Y=L-1;for(y=y===t?L:y;++k<y;){var ae=Tf(k,Y),he=m[ae];m[ae]=m[k],m[k]=he}return m.length=y,m}var vs=ly(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(Et,function(k,L,Y,ae){y.push(Y?ae.replace(Xi,"$1"):L||k)}),y});function Ln(m){if(typeof m=="string"||Sr(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Qs(m){if(m!=null){try{return vt.call(m)}catch{}try{return m+""}catch{}}return""}function cy(m,y){return nr(ce,function(k){var L="_."+k[0];y&k[1]&&!us(m,L)&&m.push(L)}),m.sort()}function Li(m){if(m instanceof fn)return m.clone();var y=new Er(m.__wrapped__,m.__chain__);return y.__actions__=Ri(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function Xb(m,y,k){(k?Nr(m,y,k):y===t)?y=1:y=li(nn(y),0);var L=m==null?0:m.length;if(!L||y<1)return[];for(var Y=0,ae=0,he=Oe(Nc(L/y));Y<L;)he[ae++]=ea(m,Y,Y+=y);return he}function uy(m){for(var y=-1,k=m==null?0:m.length,L=0,Y=[];++y<k;){var ae=m[y];ae&&(Y[L++]=ae)}return Y}function dy(){var m=arguments.length;if(!m)return[];for(var y=Oe(m-1),k=arguments[0],L=m;L--;)y[L-1]=arguments[L];return Kr(Jt(k)?Ri(k):[k],vn(y,1))}var fi=sn(function(m,y){return ji(m)?Tl(m,vn(y,1,ji,!0)):[]}),Ir=sn(function(m,y){var k=fr(y);return ji(k)&&(k=t),ji(m)?Tl(m,vn(y,1,ji,!0),Rt(k,2)):[]}),Js=sn(function(m,y){var k=fr(y);return ji(k)&&(k=t),ji(m)?Tl(m,vn(y,1,ji,!0),t,k):[]});function fy(m,y,k){var L=m==null?0:m.length;return L?(y=k||y===t?1:nn(y),ea(m,y<0?0:y,L)):[]}function hy(m,y,k){var L=m==null?0:m.length;return L?(y=k||y===t?1:nn(y),y=L-y,ea(m,0,y<0?0:y)):[]}function Zb(m,y){return m&&m.length?Ku(m,Rt(y,3),!0,!0):[]}function Yp(m,y){return m&&m.length?Ku(m,Rt(y,3),!0):[]}function na(m,y,k,L){var Y=m==null?0:m.length;return Y?(k&&typeof k!="number"&&Nr(m,y,k)&&(k=0,L=Y),on(m,y,k,L)):[]}function ba(m,y,k){var L=m==null?0:m.length;if(!L)return-1;var Y=k==null?0:nn(k);return Y<0&&(Y=li(L+Y,0)),mc(m,Rt(y,3),Y)}function Wp(m,y,k){var L=m==null?0:m.length;if(!L)return-1;var Y=L-1;return k!==t&&(Y=nn(k),Y=k<0?li(L+Y,0):ui(Y,L-1)),mc(m,Rt(y,3),Y,!0)}function Rr(m){var y=m==null?0:m.length;return y?vn(m,1):[]}function py(m){var y=m==null?0:m.length;return y?vn(m,q):[]}function Il(m,y){var k=m==null?0:m.length;return k?(y=y===t?1:nn(y),vn(m,y)):[]}function Bo(m){for(var y=-1,k=m==null?0:m.length,L={};++y<k;){var Y=m[y];L[Y[0]]=Y[1]}return L}function Ks(m){return m&&m.length?m[0]:t}function Qp(m,y,k){var L=m==null?0:m.length;if(!L)return-1;var Y=k==null?0:nn(k);return Y<0&&(Y=li(L+Y,0)),Nl(m,y,Y)}function Jp(m){var y=m==null?0:m.length;return y?ea(m,0,-1):[]}var ws=sn(function(m){var y=Yn(m,Df);return y.length&&y[0]===m[0]?wp(y):[]}),my=sn(function(m){var y=fr(m),k=Yn(m,Df);return y===fr(k)?y=t:k.pop(),k.length&&k[0]===m[0]?wp(k,Rt(y,2)):[]}),Rc=sn(function(m){var y=fr(m),k=Yn(m,Df);return y=typeof y=="function"?y:t,y&&k.pop(),k.length&&k[0]===m[0]?wp(k,t,y):[]});function pd(m,y){return m==null?"":ha.call(m,y)}function fr(m){var y=m==null?0:m.length;return y?m[y-1]:t}function Lc(m,y,k){var L=m==null?0:m.length;if(!L)return-1;var Y=L;return k!==t&&(Y=nn(k),Y=Y<0?li(L+Y,0):ui(Y,L-1)),y===y?xr(m,y,Y):mc(m,Sl,Y,!0)}function gy(m,y){return m&&m.length?Tp(m,nn(y)):t}var yy=sn(Oc);function Oc(m,y){return m&&m.length&&y&&y.length?kf(m,y):m}function xy(m,y,k){return m&&m.length&&y&&y.length?kf(m,y,Rt(k,2)):m}function Wf(m,y,k){return m&&m.length&&y&&y.length?kf(m,y,t,k):m}var by=oi(function(m,y){var k=m==null?0:m.length,L=Uu(m,y);return Ap(m,Yn(y,function(Y){return Ga(Y,k)?+Y:Y}).sort(ed)),L});function e0(m,y){var k=[];if(!(m&&m.length))return k;var L=-1,Y=[],ae=m.length;for(y=Rt(y,3);++L<ae;){var he=m[L];y(he,L,m)&&(k.push(he),Y.push(L))}return Ap(m,Y),k}function Kp(m){return m==null?m:hp.call(m)}function $n(m,y,k){var L=m==null?0:m.length;return L?(k&&typeof k!="number"&&Nr(m,y,k)?(y=0,k=L):(y=y==null?0:nn(y),k=k===t?L:nn(k)),ea(m,y,k)):[]}function ii(m,y){return Qu(m,y)}function mn(m,y,k){return Af(m,y,Rt(k,2))}function Tn(m,y){var k=m==null?0:m.length;if(k){var L=Qu(m,y);if(L<k&&Or(m[L],y))return L}return-1}function zn(m,y){return Qu(m,y,!0)}function ia(m,y,k){return Af(m,y,Rt(k,2),!0)}function Rl(m,y){var k=m==null?0:m.length;if(k){var L=Qu(m,y,!0)-1;if(Or(m[L],y))return L}return-1}function Fc(m){return m&&m.length?Dp(m):[]}function Xp(m,y){return m&&m.length?Dp(m,Rt(y,2)):[]}function Xs(m){var y=m==null?0:m.length;return y?ea(m,1,y):[]}function Si(m,y,k){return m&&m.length?(y=k||y===t?1:nn(y),ea(m,0,y<0?0:y)):[]}function Ll(m,y,k){var L=m==null?0:m.length;return L?(y=k||y===t?1:nn(y),y=L-y,ea(m,y<0?0:y,L)):[]}function Uo(m,y){return m&&m.length?Ku(m,Rt(y,3),!1,!0):[]}function Zp(m,y){return m&&m.length?Ku(m,Rt(y,3)):[]}var va=sn(function(m){return Vs(vn(m,1,ji,!0))}),$c=sn(function(m){var y=fr(m);return ji(y)&&(y=t),Vs(vn(m,1,ji,!0),Rt(y,2))}),md=sn(function(m){var y=fr(m);return y=typeof y=="function"?y:t,Vs(vn(m,1,ji,!0),t,y)});function Lr(m){return m&&m.length?Vs(m):[]}function em(m,y){return m&&m.length?Vs(m,Rt(y,2)):[]}function tm(m,y){return y=typeof y=="function"?y:t,m&&m.length?Vs(m,t,y):[]}function zc(m){if(!(m&&m.length))return[];var y=0;return m=Jr(m,function(k){if(ji(k))return y=li(k.length,y),!0}),ir(y,function(k){return Yn(m,gc(k))})}function gd(m,y){if(!(m&&m.length))return[];var k=zc(m);return y==null?k:Yn(k,function(L){return lr(y,t,L)})}var Ol=sn(function(m,y){return ji(m)?Tl(m,y):[]}),rr=sn(function(m){return Xu(Jr(m,ji))}),Fl=sn(function(m){var y=fr(m);return ji(y)&&(y=t),Xu(Jr(m,ji),Rt(y,2))}),Bc=sn(function(m){var y=fr(m);return y=typeof y=="function"?y:t,Xu(Jr(m,ji),t,y)}),Uc=sn(zc);function nm(m,y){return Ip(m||[],y||[],Ao)}function im(m,y){return Ip(m||[],y||[],Ac)}var vy=sn(function(m){var y=m.length,k=y>1?m[y-1]:t;return k=typeof k=="function"?(m.pop(),k):t,gd(m,k)});function qc(m){var y=X(m);return y.__chain__=!0,y}function rm(m,y){return y(m),m}function hr(m,y){return y(m)}var wy=oi(function(m){var y=m.length,k=y?m[0]:0,L=this.__wrapped__,Y=function(ae){return Uu(ae,m)};return y>1||this.__actions__.length||!(L instanceof fn)||!Ga(k)?this.thru(Y):(L=L.slice(k,+k+(y?1:0)),L.__actions__.push({func:hr,args:[Y],thisArg:t}),new Er(L,this.__chain__).thru(function(ae){return y&&!ae.length&&ae.push(t),ae}))});function ra(){return qc(this)}function Ny(){return new Er(this.value(),this.__chain__)}function Sy(){this.__values__===t&&(this.__values__=aa(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function t0(){return this}function $l(m){for(var y,k=this;k instanceof ga;){var L=Li(k);L.__index__=0,L.__values__=t,y?Y.__wrapped__=L:y=L;var Y=L;k=k.__wrapped__}return Y.__wrapped__=m,y}function Qf(){var m=this.__wrapped__;if(m instanceof fn){var y=m;return this.__actions__.length&&(y=new fn(this)),y=y.reverse(),y.__actions__.push({func:hr,args:[Kp],thisArg:t}),new Er(y,this.__chain__)}return this.thru(Kp)}function am(){return qg(this.__wrapped__,this.__actions__)}var Vc=Lo(function(m,y,k){Qt.call(m,k)?++m[k]:qa(m,k,1)});function jy(m,y,k){var L=Jt(m)?Zd:bp;return k&&Nr(m,y,k)&&(y=t),L(m,Rt(y,3))}function _y(m,y){var k=Jt(m)?Jr:Fn;return k(m,Rt(y,3))}var Cy=Gs(ba),sm=Gs(Wp);function lm(m,y){return vn(yd(m,y),1)}function n0(m,y){return vn(yd(m,y),q)}function i0(m,y,k){return k=k===t?1:nn(k),vn(yd(m,y),k)}function ky(m,y){var k=Jt(m)?nr:qs;return k(m,Rt(y,3))}function om(m,y){var k=Jt(m)?vl:bf;return k(m,Rt(y,3))}var Ty=Lo(function(m,y,k){Qt.call(m,k)?m[k].push(y):qa(m,k,[y])});function Hc(m,y,k,L){m=Oi(m)?m:Xc(m),k=k&&!L?nn(k):0;var Y=m.length;return k<0&&(k=li(Y+k,0)),lh(m)?k<=Y&&m.indexOf(y,k)>-1:!!Y&&Nl(m,y,k)>-1}var Jf=sn(function(m,y,k){var L=-1,Y=typeof y=="function",ae=Oi(m)?Oe(m.length):[];return qs(m,function(he){ae[++L]=Y?lr(y,he,k):Mo(he,y,k)}),ae}),Ey=Lo(function(m,y,k){qa(m,k,y)});function yd(m,y){var k=Jt(m)?Yn:Cp;return k(m,Rt(y,3))}function Ay(m,y,k,L){return m==null?[]:(Jt(y)||(y=y==null?[]:[y]),k=L?t:k,Jt(k)||(k=k==null?[]:[k]),Ep(m,y,k))}var Py=Lo(function(m,y,k){m[k?0:1].push(y)},function(){return[[],[]]});function Dy(m,y,k){var L=Jt(m)?ju:ku,Y=arguments.length<3;return L(m,Rt(y,4),k,Y,qs)}function My(m,y,k){var L=Jt(m)?pc:ku,Y=arguments.length<3;return L(m,Rt(y,4),k,Y,bf)}function Kf(m,y){var k=Jt(m)?Jr:Fn;return k(m,Nd(Rt(y,3)))}function Iy(m){var y=Jt(m)?_c:Ec;return y(m)}function Ry(m,y,k){(k?Nr(m,y,k):y===t)?y=1:y=nn(y);var L=Jt(m)?Pg:Ef;return L(m,y)}function ei(m){var y=Jt(m)?Dg:Bg;return y(m)}function cm(m){if(m==null)return 0;if(Oi(m))return lh(m)?fa(m):m.length;var y=Gi(m);return y==we||y==ct?m.size:Sf(m).length}function r0(m,y,k){var L=Jt(m)?_u:Ug;return k&&Nr(m,y,k)&&(y=t),L(m,Rt(y,3))}var Ly=sn(function(m,y){if(m==null)return[];var k=y.length;return k>1&&Nr(m,y[0],y[1])?y=[]:k>2&&Nr(y[0],y[1],y[2])&&(y=[y[0]]),Ep(m,vn(y,1),[])}),Xf=_o||function(){return Kn.Date.now()};function a0(m,y){if(typeof y!="function")throw new de(o);return m=nn(m),function(){if(--m<1)return y.apply(this,arguments)}}function Oy(m,y,k){return y=k?t:y,y=m&&y==null?m.length:y,xs(m,B,t,t,t,t,y)}function xd(m,y){var k;if(typeof y!="function")throw new de(o);return m=nn(m),function(){return--m>0&&(k=y.apply(this,arguments)),m<=1&&(y=t),k}}var zl=sn(function(m,y,k){var L=A;if(k.length){var Y=ps(k,zo(zl));L|=F}return xs(m,L,y,k,Y)}),Zf=sn(function(m,y,k){var L=A|T;if(k.length){var Y=ps(k,zo(Zf));L|=F}return xs(y,L,m,k,Y)});function bd(m,y,k){y=k?t:y;var L=xs(m,M,t,t,t,t,t,y);return L.placeholder=bd.placeholder,L}function eh(m,y,k){y=k?t:y;var L=xs(m,V,t,t,t,t,t,y);return L.placeholder=eh.placeholder,L}function Bl(m,y,k){var L,Y,ae,he,be,ke,We=0,Je=!1,et=!1,yt=!0;if(typeof m!="function")throw new de(o);y=Na(y)||0,hi(k)&&(Je=!!k.leading,et="maxWait"in k,ae=et?li(Na(k.maxWait)||0,y):ae,yt="trailing"in k?!!k.trailing:yt);function At(zi){var tl=L,Vo=Y;return L=Y=t,We=zi,he=m.apply(Vo,tl),he}function Ht(zi){return We=zi,be=Ic(Nn,y),Je?At(zi):he}function pn(zi){var tl=zi-ke,Vo=zi-We,tN=y-tl;return et?ui(tN,ae-Vo):tN}function Gt(zi){var tl=zi-ke,Vo=zi-We;return ke===t||tl>=y||tl<0||et&&Vo>=ae}function Nn(){var zi=Xf();if(Gt(zi))return An(zi);be=Ic(Nn,pn(zi))}function An(zi){return be=t,yt&&L?At(zi):(L=Y=t,he)}function Qa(){be!==t&&Hg(be),We=0,L=ke=Y=be=t}function sa(){return be===t?he:An(Xf())}function Ja(){var zi=Xf(),tl=Gt(zi);if(L=arguments,Y=this,ke=zi,tl){if(be===t)return Ht(ke);if(et)return Hg(be),be=Ic(Nn,y),At(ke)}return be===t&&(be=Ic(Nn,y)),he}return Ja.cancel=Qa,Ja.flush=sa,Ja}var Ns=sn(function(m,y){return Po(m,1,y)}),vd=sn(function(m,y,k){return Po(m,Na(y)||0,k)});function s0(m){return xs(m,R)}function wd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new de(o);var k=function(){var L=arguments,Y=y?y.apply(this,L):L[0],ae=k.cache;if(ae.has(Y))return ae.get(Y);var he=m.apply(this,L);return k.cache=ae.set(Y,he)||ae,he};return k.cache=new(wd.Cache||Ar),k}wd.Cache=Ar;function Nd(m){if(typeof m!="function")throw new de(o);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Fy(m){return xd(2,m)}var $y=Vg(function(m,y){y=y.length==1&&Jt(y[0])?Yn(y[0],or(Rt())):Yn(vn(y,1),or(Rt()));var k=y.length;return sn(function(L){for(var Y=-1,ae=ui(L.length,k);++Y<ae;)L[Y]=y[Y].call(this,L[Y]);return lr(m,this,L)})}),um=sn(function(m,y){var k=ps(y,zo(um));return xs(m,F,t,y,k)}),th=sn(function(m,y){var k=ps(y,zo(th));return xs(m,z,t,y,k)}),zy=oi(function(m,y){return xs(m,U,t,t,t,y)});function By(m,y){if(typeof m!="function")throw new de(o);return y=y===t?y:nn(y),sn(m,y)}function l0(m,y){if(typeof m!="function")throw new de(o);return y=y==null?0:li(nn(y),0),sn(function(k){var L=k[y],Y=Al(k,0,y);return L&&Kr(Y,L),lr(m,this,Y)})}function dm(m,y,k){var L=!0,Y=!0;if(typeof m!="function")throw new de(o);return hi(k)&&(L="leading"in k?!!k.leading:L,Y="trailing"in k?!!k.trailing:Y),Bl(m,y,{leading:L,maxWait:y,trailing:Y})}function fm(m){return Oy(m,1)}function o0(m,y){return um(Zu(y),m)}function c0(){if(!arguments.length)return[];var m=arguments[0];return Jt(m)?m:[m]}function Sd(m){return ur(m,v)}function u0(m,y){return y=typeof y=="function"?y:t,ur(m,v,y)}function Uy(m){return ur(m,g|v)}function gn(m,y){return y=typeof y=="function"?y:t,ur(m,g|v,y)}function hm(m,y){return y==null||xp(m,y,$i(y))}function Or(m,y){return m===y||m!==m&&y!==y}var pm=$o(qu),qy=$o(function(m,y){return m>=y}),Zs=vf(function(){return arguments}())?vf:function(m){return bi(m)&&Qt.call(m,"callee")&&!So.call(m,"callee")},Jt=Oe.isArray,nh=bl?or(bl):Pr;function Oi(m){return m!=null&&qo(m.length)&&!Ya(m)}function ji(m){return bi(m)&&Oi(m)}function d0(m){return m===!0||m===!1||bi(m)&&wn(m)==ye}var Ul=hf||R0,Vy=po?or(po):Ei;function Hy(m){return bi(m)&&m.nodeType===1&&!wa(m)}function ih(m){if(m==null)return!0;if(Oi(m)&&(Jt(m)||typeof m=="string"||typeof m.splice=="function"||Ul(m)||Gc(m)||Zs(m)))return!m.length;var y=Gi(m);if(y==we||y==ct)return!m.size;if(Zn(m))return!Sf(m).length;for(var k in m)if(Qt.call(m,k))return!1;return!0}function Wn(m,y){return Io(m,y)}function mm(m,y,k){k=typeof k=="function"?k:t;var L=k?k(m,y):t;return L===t?Io(m,y,t,k):!!L}function Fi(m){if(!bi(m))return!1;var y=wn(m);return y==at||y==Ze||typeof m.message=="string"&&typeof m.name=="string"&&!wa(m)}function f0(m){return typeof m=="number"&&Iu(m)}function Ya(m){if(!hi(m))return!1;var y=wn(m);return y==Le||y==Te||y==ge||y==Ke}function rh(m){return typeof m=="number"&&m==nn(m)}function qo(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=H}function hi(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function bi(m){return m!=null&&typeof m=="object"}var ah=Rs?or(Rs):wf;function gm(m,y){return m===y||Hu(m,y,zf(y))}function h0(m,y,k){return k=typeof k=="function"?k:t,Hu(m,y,zf(y),k)}function Gy(m){return Wy(m)&&m!=+m}function p0(m){if(cd(m))throw new Ft(l);return gs(m)}function Yy(m){return m===null}function m0(m){return m==null}function Wy(m){return typeof m=="number"||bi(m)&&wn(m)==Fe}function wa(m){if(!bi(m)||wn(m)!=it)return!1;var y=Pu(m);if(y===null)return!0;var k=Qt.call(y,"constructor")&&y.constructor;return typeof k=="function"&&k instanceof k&&vt.call(k)==Mi}var sh=Su?or(Su):Nf;function ym(m){return rh(m)&&m>=-9007199254740991&&m<=H}var Qy=Fa?or(Fa):Sp;function lh(m){return typeof m=="string"||!Jt(m)&&bi(m)&&wn(m)==Tt}function Sr(m){return typeof m=="symbol"||bi(m)&&wn(m)==bt}var Gc=mo?or(mo):jp;function Wa(m){return m===t}function xm(m){return bi(m)&&Gi(m)==oe}function Jy(m){return bi(m)&&wn(m)==K}var Ky=$o(jf),jd=$o(function(m,y){return m<=y});function aa(m){if(!m)return[];if(Oi(m))return lh(m)?Cr(m):Ri(m);if(jo&&m[jo])return lf(m[jo]());var y=Gi(m),k=y==we?bc:y==ct?$a:Xc;return k(m)}function Ss(m){if(!m)return m===0?m:0;if(m=Na(m),m===q||m===-1/0){var y=m<0?-1:1;return y*ee}return m===m?m:0}function nn(m){var y=Ss(m),k=y%1;return y===y?k?y-k:y:0}function js(m){return m?Va(nn(m),0,Q):0}function Na(m){if(typeof m=="number")return m;if(Sr(m))return E;if(hi(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=hi(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=da(m);var k=Gn.test(m);return k||Hr.test(m)?wu(m.slice(2),k?2:8):Ui.test(m)?E:+m}function Xy(m){return Mr(m,Yi(m))}function Yc(m){return m?Va(nn(m),-9007199254740991,H):m===0?m:0}function Mn(m){return m==null?"":Dr(m)}var g0=Oo(function(m,y){if(Zn(y)||Oi(y)){Mr(y,$i(y),m);return}for(var k in y)Qt.call(y,k)&&Ao(m,k,y[k])}),Zy=Oo(function(m,y){Mr(y,Yi(y),m)}),oh=Oo(function(m,y,k,L){Mr(y,Yi(y),m,L)}),y0=Oo(function(m,y,k,L){Mr(y,$i(y),m,L)}),x0=oi(Uu);function b0(m,y){var k=Zr(m);return y==null?k:Us(k,y)}var v0=sn(function(m,y){m=xn(m);var k=-1,L=y.length,Y=L>2?y[2]:t;for(Y&&Nr(y[0],y[1],Y)&&(L=1);++k<L;)for(var ae=y[k],he=Yi(ae),be=-1,ke=he.length;++be<ke;){var We=he[be],Je=m[We];(Je===t||Or(Je,xt[We])&&!Qt.call(m,We))&&(m[We]=ae[We])}return m}),ex=sn(function(m){return m.push(t,Bp),lr(Td,t,m)});function Wc(m,y){return ef(m,Rt(y,3),dr)}function _d(m,y){return ef(m,Rt(y,3),Tc)}function tx(m,y){return m==null?m:kc(m,Rt(y,3),Yi)}function w0(m,y){return m==null?m:Do(m,Rt(y,3),Yi)}function Qc(m,y){return m&&dr(m,Rt(y,3))}function Cd(m,y){return m&&Tc(m,Rt(y,3))}function nx(m){return m==null?[]:El(m,$i(m))}function ch(m){return m==null?[]:El(m,Yi(m))}function kd(m,y,k){var L=m==null?t:ya(m,y);return L===t?k:L}function bm(m,y){return m!=null&&od(m,y,vp)}function Jc(m,y){return m!=null&&od(m,y,Rg)}var ix=nd(function(m,y,k){y!=null&&typeof y.toString!="function"&&(y=Vi.call(y)),m[y]=k},Pe(De)),rx=nd(function(m,y,k){y!=null&&typeof y.toString!="function"&&(y=Vi.call(y)),Qt.call(m,y)?m[y].push(k):m[y]=[k]},Rt),N0=sn(Mo);function $i(m){return Oi(m)?yp(m):Sf(m)}function Yi(m){return Oi(m)?yp(m,!0):Og(m)}function S0(m,y){var k={};return y=Rt(y,3),dr(m,function(L,Y,ae){qa(k,y(L,Y,ae),L)}),k}function j0(m,y){var k={};return y=Rt(y,3),dr(m,function(L,Y,ae){qa(k,Y,y(L,Y,ae))}),k}var _0=Oo(function(m,y,k){Gu(m,y,k)}),Td=Oo(function(m,y,k,L){Gu(m,y,k,L)}),uh=oi(function(m,y){var k={};if(m==null)return k;var L=!1;y=Yn(y,function(ae){return ae=Hs(ae,m),L||(L=ae.length>1),ae}),Mr(m,Ff(m),k),L&&(k=ur(k,g|b|v,Zg));for(var Y=y.length;Y--;)Ju(k,y[Y]);return k});function vm(m,y){return Kc(m,Nd(Rt(y)))}var C0=oi(function(m,y){return m==null?{}:Fg(m,y)});function Kc(m,y){if(m==null)return{};var k=Yn(Ff(m),function(L){return[L]});return y=Rt(y),Cf(m,k,function(L,Y){return y(L,Y[0])})}function k0(m,y,k){y=Hs(y,m);var L=-1,Y=y.length;for(Y||(Y=1,m=t);++L<Y;){var ae=m==null?t:m[Ln(y[L])];ae===t&&(L=Y,ae=k),m=Ya(ae)?ae.call(m):ae}return m}function ax(m,y,k){return m==null?m:Ac(m,y,k)}function sx(m,y,k,L){return L=typeof L=="function"?L:t,m==null?m:Ac(m,y,k,L)}var wm=ad($i),Nm=ad(Yi);function Sm(m,y,k){var L=Jt(m),Y=L||Ul(m)||Gc(m);if(y=Rt(y,4),k==null){var ae=m&&m.constructor;Y?k=L?new ae:[]:hi(m)?k=Ya(ae)?Zr(Pu(m)):{}:k={}}return(Y?nr:dr)(m,function(he,be,ke){return y(k,he,be,ke)}),k}function lx(m,y){return m==null?!0:Ju(m,y)}function dh(m,y,k){return m==null?m:Mp(m,y,Zu(k))}function T0(m,y,k,L){return L=typeof L=="function"?L:t,m==null?m:Mp(m,y,Zu(k),L)}function Xc(m){return m==null?[]:xo(m,$i(m))}function jm(m){return m==null?[]:xo(m,Yi(m))}function _m(m,y,k){return k===t&&(k=y,y=t),k!==t&&(k=Na(k),k=k===k?k:0),y!==t&&(y=Na(y),y=y===y?y:0),Va(Na(m),y,k)}function fh(m,y,k){return y=Ss(y),k===t?(k=y,y=0):k=Ss(k),m=Na(m),Lg(m,y,k)}function Cm(m,y,k){if(k&&typeof k!="boolean"&&Nr(m,y,k)&&(y=k=t),k===t&&(typeof y=="boolean"?(k=y,y=t):typeof m=="boolean"&&(k=m,m=t)),m===t&&y===t?(m=0,y=1):(m=Ss(m),y===t?(y=m,m=0):y=Ss(y)),m>y){var L=m;m=y,y=L}if(k||m%1||y%1){var Y=fp();return ui(m+Y*(y-m+kn("1e-"+((Y+"").length-1))),y)}return Tf(m,y)}var ox=wr(function(m,y,k){return y=y.toLowerCase(),m+(k?hh(y):y)});function hh(m){return x(Mn(m).toLowerCase())}function el(m){return m=Mn(m),m&&m.replace(er,bo).replace(tr,"")}function ql(m,y,k){m=Mn(m),y=Dr(y);var L=m.length;k=k===t?L:Va(nn(k),0,L);var Y=k;return k-=y.length,k>=0&&m.slice(k,Y)==y}function Vl(m){return m=Mn(m),m&&tn.test(m)?m.replace(st,rf):m}function Ed(m){return m=Mn(m),m&&kt.test(m)?m.replace(Dt,"\\$&"):m}var Ad=wr(function(m,y,k){return m+(k?"-":"")+y.toLowerCase()}),Hl=wr(function(m,y,k){return m+(k?" ":"")+y.toLowerCase()}),E0=ta("toLowerCase");function cx(m,y,k){m=Mn(m),y=nn(y);var L=y?fa(m):0;if(!y||L>=y)return m;var Y=(y-L)/2;return rd($s(Y),k)+m+rd(Nc(Y),k)}function Pd(m,y,k){m=Mn(m),y=nn(y);var L=y?fa(m):0;return y&&L<y?m+rd(y-L,k):m}function A0(m,y,k){m=Mn(m),y=nn(y);var L=y?fa(m):0;return y&&L<y?rd(y-L,k)+m:m}function ux(m,y,k){return k||y==null?y=0:y&&(y=+y),Co(Mn(m).replace(It,""),y||0)}function ph(m,y,k){return(k?Nr(m,y,k):y===t)?y=1:y=nn(y),Pp(Mn(m),y)}function dx(){var m=arguments,y=Mn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var P0=wr(function(m,y,k){return m+(k?"_":"")+y.toLowerCase()});function mh(m,y,k){return k&&typeof k!="number"&&Nr(m,y,k)&&(y=k=t),k=k===t?Q:k>>>0,k?(m=Mn(m),m&&(typeof y=="string"||y!=null&&!sh(y))&&(y=Dr(y),!y&&hs(m))?Al(Cr(m),0,k):m.split(y,k)):[]}var gh=wr(function(m,y,k){return m+(k?" ":"")+x(y)});function fx(m,y,k){return m=Mn(m),k=k==null?0:Va(nn(k),0,m.length),y=Dr(y),m.slice(k,k+y.length)==y}function Dd(m,y,k){var L=X.templateSettings;k&&Nr(m,y,k)&&(y=t),m=Mn(m),y=oh({},y,L,Lf);var Y=oh({},y.imports,L.imports,Lf),ae=$i(Y),he=xo(Y,ae),be,ke,We=0,Je=y.interpolate||oa,et="__p += '",yt=se((y.escape||oa).source+"|"+Je.source+"|"+(Je===Vt?Zi:oa).source+"|"+(y.evaluate||oa).source+"|$","g"),At="//# sourceURL="+(Qt.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++hc+"]")+`
`;m.replace(yt,function(Gt,Nn,An,Qa,sa,Ja){return An||(An=Qa),et+=m.slice(We,Ja).replace(ro,af),Nn&&(be=!0,et+=`' +
__e(`+Nn+`) +
'`),sa&&(ke=!0,et+=`';
`+sa+`;
__p += '`),An&&(et+=`' +
((__t = (`+An+`)) == null ? '' : __t) +
'`),We=Ja+Gt.length,Gt}),et+=`';
`;var Ht=Qt.call(y,"variable")&&y.variable;if(!Ht)et=`with (obj) {
`+et+`
}
`;else if(Bi.test(Ht))throw new Ft(f);et=(ke?et.replace(Se,""):et).replace(qe,"$1").replace(Be,"$1;"),et="function("+(Ht||"obj")+`) {
`+(Ht?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(be?", __e = _.escape":"")+(ke?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+et+`return __p
}`;var pn=P(function(){return yn(ae,At+"return "+et).apply(t,he)});if(pn.source=et,Fi(pn))throw pn;return pn}function km(m){return Mn(m).toLowerCase()}function yh(m){return Mn(m).toUpperCase()}function hx(m,y,k){if(m=Mn(m),m&&(k||y===t))return da(m);if(!m||!(y=Dr(y)))return m;var L=Cr(m),Y=Cr(y),ae=Os(L,Y),he=fs(L,Y)+1;return Al(L,ae,he).join("")}function D0(m,y,k){if(m=Mn(m),m&&(k||y===t))return m.slice(0,Xr(m)+1);if(!m||!(y=Dr(y)))return m;var L=Cr(m),Y=fs(L,Cr(y))+1;return Al(L,0,Y).join("")}function xh(m,y,k){if(m=Mn(m),m&&(k||y===t))return m.replace(It,"");if(!m||!(y=Dr(y)))return m;var L=Cr(m),Y=Os(L,Cr(y));return Al(L,Y).join("")}function s(m,y){var k=O,L=$;if(hi(y)){var Y="separator"in y?y.separator:Y;k="length"in y?nn(y.length):k,L="omission"in y?Dr(y.omission):L}m=Mn(m);var ae=m.length;if(hs(m)){var he=Cr(m);ae=he.length}if(k>=ae)return m;var be=k-fa(L);if(be<1)return L;var ke=he?Al(he,0,be).join(""):m.slice(0,be);if(Y===t)return ke+L;if(he&&(be+=ke.length-be),sh(Y)){if(m.slice(be).search(Y)){var We,Je=ke;for(Y.global||(Y=se(Y.source,Mn(pr.exec(Y))+"g")),Y.lastIndex=0;We=Y.exec(Je);)var et=We.index;ke=ke.slice(0,et===t?be:et)}}else if(m.indexOf(Dr(Y),be)!=be){var yt=ke.lastIndexOf(Y);yt>-1&&(ke=ke.slice(0,yt))}return ke+L}function c(m){return m=Mn(m),m&&dt.test(m)?m.replace(tt,cf):m}var p=wr(function(m,y,k){return m+(k?" ":"")+y.toUpperCase()}),x=ta("toUpperCase");function S(m,y,k){return m=Mn(m),y=k?t:y,y===t?sf(m)?uf(m):op(m):m.match(y)||[]}var P=sn(function(m,y){try{return lr(m,t,y)}catch(k){return Fi(k)?k:new Ft(k)}}),G=oi(function(m,y){return nr(y,function(k){k=Ln(k),qa(m,k,zl(m[k],m))}),m});function Z(m){var y=m==null?0:m.length,k=Rt();return m=y?Yn(m,function(L){if(typeof L[1]!="function")throw new de(o);return[k(L[0]),L[1]]}):[],sn(function(L){for(var Y=-1;++Y<y;){var ae=m[Y];if(lr(ae[0],this,L))return lr(ae[1],this,L)}})}function me(m){return Mg(ur(m,g))}function Pe(m){return function(){return m}}function He(m,y){return m==null||m!==m?y:m}var Qe=ys(),Me=ys(!0);function De(m){return m}function zt(m){return _p(typeof m=="function"?m:ur(m,g))}function $t(m){return kp(ur(m,g))}function Qn(m,y){return _f(m,ur(y,g))}var Ce=sn(function(m,y){return function(k){return Mo(k,m,y)}}),ve=sn(function(m,y){return function(k){return Mo(m,k,y)}});function Ee(m,y,k){var L=$i(y),Y=El(y,L);k==null&&!(hi(y)&&(Y.length||!L.length))&&(k=y,y=m,m=this,Y=El(y,$i(y)));var ae=!(hi(k)&&"chain"in k)||!!k.chain,he=Ya(m);return nr(Y,function(be){var ke=y[be];m[be]=ke,he&&(m.prototype[be]=function(){var We=this.__chain__;if(ae||We){var Je=m(this.__wrapped__),et=Je.__actions__=Ri(this.__actions__);return et.push({func:ke,args:arguments,thisArg:m}),Je.__chain__=We,Je}return ke.apply(m,Kr([this.value()],arguments))})}),m}function Ge(){return Kn._===this&&(Kn._=vc),this}function St(){}function hn(m){return m=nn(m),sn(function(y){return Tp(y,m)})}var Pt=id(Yn),Bt=id(Zd),Wi=id(_u);function En(m){return Uf(m)?gc(Ln(m)):$g(m)}function Gl(m){return function(y){return m==null?t:ya(m,y)}}var M0=Pl(),HE=Pl(!0);function I0(){return[]}function R0(){return!1}function GE(){return{}}function YE(){return""}function WE(){return!0}function QE(m,y){if(m=nn(m),m<1||m>H)return[];var k=Q,L=ui(m,Q);y=Rt(y),m-=Q;for(var Y=ir(L,y);++k<m;)y(k);return Y}function JE(m){return Jt(m)?Yn(m,Ln):Sr(m)?[m]:Ri(vs(Mn(m)))}function KE(m){var y=++cr;return Mn(m)+y}var XE=Pc(function(m,y){return m+y},0),ZE=Rf("ceil"),eA=Pc(function(m,y){return m/y},1),tA=Rf("floor");function nA(m){return m&&m.length?Ha(m,De,qu):t}function iA(m,y){return m&&m.length?Ha(m,Rt(y,2),qu):t}function rA(m){return tf(m,De)}function aA(m,y){return tf(m,Rt(y,2))}function sA(m){return m&&m.length?Ha(m,De,jf):t}function lA(m,y){return m&&m.length?Ha(m,Rt(y,2),jf):t}var oA=Pc(function(m,y){return m*y},1),cA=Rf("round"),uA=Pc(function(m,y){return m-y},0);function dA(m){return m&&m.length?yc(m,De):0}function fA(m,y){return m&&m.length?yc(m,Rt(y,2)):0}return X.after=a0,X.ary=Oy,X.assign=g0,X.assignIn=Zy,X.assignInWith=oh,X.assignWith=y0,X.at=x0,X.before=xd,X.bind=zl,X.bindAll=G,X.bindKey=Zf,X.castArray=c0,X.chain=qc,X.chunk=Xb,X.compact=uy,X.concat=dy,X.cond=Z,X.conforms=me,X.constant=Pe,X.countBy=Vc,X.create=b0,X.curry=bd,X.curryRight=eh,X.debounce=Bl,X.defaults=v0,X.defaultsDeep=ex,X.defer=Ns,X.delay=vd,X.difference=fi,X.differenceBy=Ir,X.differenceWith=Js,X.drop=fy,X.dropRight=hy,X.dropRightWhile=Zb,X.dropWhile=Yp,X.fill=na,X.filter=_y,X.flatMap=lm,X.flatMapDeep=n0,X.flatMapDepth=i0,X.flatten=Rr,X.flattenDeep=py,X.flattenDepth=Il,X.flip=s0,X.flow=Qe,X.flowRight=Me,X.fromPairs=Bo,X.functions=nx,X.functionsIn=ch,X.groupBy=Ty,X.initial=Jp,X.intersection=ws,X.intersectionBy=my,X.intersectionWith=Rc,X.invert=ix,X.invertBy=rx,X.invokeMap=Jf,X.iteratee=zt,X.keyBy=Ey,X.keys=$i,X.keysIn=Yi,X.map=yd,X.mapKeys=S0,X.mapValues=j0,X.matches=$t,X.matchesProperty=Qn,X.memoize=wd,X.merge=_0,X.mergeWith=Td,X.method=Ce,X.methodOf=ve,X.mixin=Ee,X.negate=Nd,X.nthArg=hn,X.omit=uh,X.omitBy=vm,X.once=Fy,X.orderBy=Ay,X.over=Pt,X.overArgs=$y,X.overEvery=Bt,X.overSome=Wi,X.partial=um,X.partialRight=th,X.partition=Py,X.pick=C0,X.pickBy=Kc,X.property=En,X.propertyOf=Gl,X.pull=yy,X.pullAll=Oc,X.pullAllBy=xy,X.pullAllWith=Wf,X.pullAt=by,X.range=M0,X.rangeRight=HE,X.rearg=zy,X.reject=Kf,X.remove=e0,X.rest=By,X.reverse=Kp,X.sampleSize=Ry,X.set=ax,X.setWith=sx,X.shuffle=ei,X.slice=$n,X.sortBy=Ly,X.sortedUniq=Fc,X.sortedUniqBy=Xp,X.split=mh,X.spread=l0,X.tail=Xs,X.take=Si,X.takeRight=Ll,X.takeRightWhile=Uo,X.takeWhile=Zp,X.tap=rm,X.throttle=dm,X.thru=hr,X.toArray=aa,X.toPairs=wm,X.toPairsIn=Nm,X.toPath=JE,X.toPlainObject=Xy,X.transform=Sm,X.unary=fm,X.union=va,X.unionBy=$c,X.unionWith=md,X.uniq=Lr,X.uniqBy=em,X.uniqWith=tm,X.unset=lx,X.unzip=zc,X.unzipWith=gd,X.update=dh,X.updateWith=T0,X.values=Xc,X.valuesIn=jm,X.without=Ol,X.words=S,X.wrap=o0,X.xor=rr,X.xorBy=Fl,X.xorWith=Bc,X.zip=Uc,X.zipObject=nm,X.zipObjectDeep=im,X.zipWith=vy,X.entries=wm,X.entriesIn=Nm,X.extend=Zy,X.extendWith=oh,Ee(X,X),X.add=XE,X.attempt=P,X.camelCase=ox,X.capitalize=hh,X.ceil=ZE,X.clamp=_m,X.clone=Sd,X.cloneDeep=Uy,X.cloneDeepWith=gn,X.cloneWith=u0,X.conformsTo=hm,X.deburr=el,X.defaultTo=He,X.divide=eA,X.endsWith=ql,X.eq=Or,X.escape=Vl,X.escapeRegExp=Ed,X.every=jy,X.find=Cy,X.findIndex=ba,X.findKey=Wc,X.findLast=sm,X.findLastIndex=Wp,X.findLastKey=_d,X.floor=tA,X.forEach=ky,X.forEachRight=om,X.forIn=tx,X.forInRight=w0,X.forOwn=Qc,X.forOwnRight=Cd,X.get=kd,X.gt=pm,X.gte=qy,X.has=bm,X.hasIn=Jc,X.head=Ks,X.identity=De,X.includes=Hc,X.indexOf=Qp,X.inRange=fh,X.invoke=N0,X.isArguments=Zs,X.isArray=Jt,X.isArrayBuffer=nh,X.isArrayLike=Oi,X.isArrayLikeObject=ji,X.isBoolean=d0,X.isBuffer=Ul,X.isDate=Vy,X.isElement=Hy,X.isEmpty=ih,X.isEqual=Wn,X.isEqualWith=mm,X.isError=Fi,X.isFinite=f0,X.isFunction=Ya,X.isInteger=rh,X.isLength=qo,X.isMap=ah,X.isMatch=gm,X.isMatchWith=h0,X.isNaN=Gy,X.isNative=p0,X.isNil=m0,X.isNull=Yy,X.isNumber=Wy,X.isObject=hi,X.isObjectLike=bi,X.isPlainObject=wa,X.isRegExp=sh,X.isSafeInteger=ym,X.isSet=Qy,X.isString=lh,X.isSymbol=Sr,X.isTypedArray=Gc,X.isUndefined=Wa,X.isWeakMap=xm,X.isWeakSet=Jy,X.join=pd,X.kebabCase=Ad,X.last=fr,X.lastIndexOf=Lc,X.lowerCase=Hl,X.lowerFirst=E0,X.lt=Ky,X.lte=jd,X.max=nA,X.maxBy=iA,X.mean=rA,X.meanBy=aA,X.min=sA,X.minBy=lA,X.stubArray=I0,X.stubFalse=R0,X.stubObject=GE,X.stubString=YE,X.stubTrue=WE,X.multiply=oA,X.nth=gy,X.noConflict=Ge,X.noop=St,X.now=Xf,X.pad=cx,X.padEnd=Pd,X.padStart=A0,X.parseInt=ux,X.random=Cm,X.reduce=Dy,X.reduceRight=My,X.repeat=ph,X.replace=dx,X.result=k0,X.round=cA,X.runInContext=Ne,X.sample=Iy,X.size=cm,X.snakeCase=P0,X.some=r0,X.sortedIndex=ii,X.sortedIndexBy=mn,X.sortedIndexOf=Tn,X.sortedLastIndex=zn,X.sortedLastIndexBy=ia,X.sortedLastIndexOf=Rl,X.startCase=gh,X.startsWith=fx,X.subtract=uA,X.sum=dA,X.sumBy=fA,X.template=Dd,X.times=QE,X.toFinite=Ss,X.toInteger=nn,X.toLength=js,X.toLower=km,X.toNumber=Na,X.toSafeInteger=Yc,X.toString=Mn,X.toUpper=yh,X.trim=hx,X.trimEnd=D0,X.trimStart=xh,X.truncate=s,X.unescape=c,X.uniqueId=KE,X.upperCase=p,X.upperFirst=x,X.each=ky,X.eachRight=om,X.first=Ks,Ee(X,function(){var m={};return dr(X,function(y,k){Qt.call(X.prototype,k)||(m[k]=y)}),m}(),{chain:!1}),X.VERSION=r,nr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){X[m].placeholder=X}),nr(["drop","take"],function(m,y){fn.prototype[m]=function(k){k=k===t?1:li(nn(k),0);var L=this.__filtered__&&!y?new fn(this):this.clone();return L.__filtered__?L.__takeCount__=ui(k,L.__takeCount__):L.__views__.push({size:ui(k,Q),type:m+(L.__dir__<0?"Right":"")}),L},fn.prototype[m+"Right"]=function(k){return this.reverse()[m](k).reverse()}}),nr(["filter","map","takeWhile"],function(m,y){var k=y+1,L=k==ne||k==J;fn.prototype[m]=function(Y){var ae=this.clone();return ae.__iteratees__.push({iteratee:Rt(Y,3),type:k}),ae.__filtered__=ae.__filtered__||L,ae}}),nr(["head","last"],function(m,y){var k="take"+(y?"Right":"");fn.prototype[m]=function(){return this[k](1).value()[0]}}),nr(["initial","tail"],function(m,y){var k="drop"+(y?"":"Right");fn.prototype[m]=function(){return this.__filtered__?new fn(this):this[k](1)}}),fn.prototype.compact=function(){return this.filter(De)},fn.prototype.find=function(m){return this.filter(m).head()},fn.prototype.findLast=function(m){return this.reverse().find(m)},fn.prototype.invokeMap=sn(function(m,y){return typeof m=="function"?new fn(this):this.map(function(k){return Mo(k,m,y)})}),fn.prototype.reject=function(m){return this.filter(Nd(Rt(m)))},fn.prototype.slice=function(m,y){m=nn(m);var k=this;return k.__filtered__&&(m>0||y<0)?new fn(k):(m<0?k=k.takeRight(-m):m&&(k=k.drop(m)),y!==t&&(y=nn(y),k=y<0?k.dropRight(-y):k.take(y-m)),k)},fn.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},fn.prototype.toArray=function(){return this.take(Q)},dr(fn.prototype,function(m,y){var k=/^(?:filter|find|map|reject)|While$/.test(y),L=/^(?:head|last)$/.test(y),Y=X[L?"take"+(y=="last"?"Right":""):y],ae=L||/^find/.test(y);Y&&(X.prototype[y]=function(){var he=this.__wrapped__,be=L?[1]:arguments,ke=he instanceof fn,We=be[0],Je=ke||Jt(he),et=function(Nn){var An=Y.apply(X,Kr([Nn],be));return L&&yt?An[0]:An};Je&&k&&typeof We=="function"&&We.length!=1&&(ke=Je=!1);var yt=this.__chain__,At=!!this.__actions__.length,Ht=ae&&!yt,pn=ke&&!At;if(!ae&&Je){he=pn?he:new fn(this);var Gt=m.apply(he,be);return Gt.__actions__.push({func:hr,args:[et],thisArg:t}),new Er(Gt,yt)}return Ht&&pn?m.apply(this,be):(Gt=this.thru(et),Ht?L?Gt.value()[0]:Gt.value():Gt)})}),nr(["pop","push","shift","sort","splice","unshift"],function(m){var y=_e[m],k=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",L=/^(?:pop|shift)$/.test(m);X.prototype[m]=function(){var Y=arguments;if(L&&!this.__chain__){var ae=this.value();return y.apply(Jt(ae)?ae:[],Y)}return this[k](function(he){return y.apply(Jt(he)?he:[],Y)})}}),dr(fn.prototype,function(m,y){var k=X[y];if(k){var L=k.name+"";Qt.call(ma,L)||(ma[L]=[]),ma[L].push({name:y,func:k})}}),ma[Ni(t,T).name]=[{name:"wrapper",func:t}],fn.prototype.clone=Fu,fn.prototype.reverse=pf,fn.prototype.value=To,X.prototype.at=wy,X.prototype.chain=ra,X.prototype.commit=Ny,X.prototype.next=Sy,X.prototype.plant=$l,X.prototype.reverse=Qf,X.prototype.toJSON=X.prototype.valueOf=X.prototype.value=am,X.prototype.first=X.prototype.head,jo&&(X.prototype[jo]=t0),X},za=Fs();os?((os.exports=za)._=za,ua._=za):Kn._=za}).call(VB)}(Ym,Ym.exports)),Ym.exports}var lk=HB();class GB{constructor(n){ri(this,"sampleRate",24e3);ri(this,"bufferSize",7680);ri(this,"audioQueue",[]);ri(this,"isPlaying",!1);ri(this,"isStreamComplete",!1);ri(this,"checkInterval",null);ri(this,"scheduledTime",0);ri(this,"initialBufferTime",.1);ri(this,"gainNode");ri(this,"source");ri(this,"endOfQueueAudioSource",null);ri(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=kx.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(kx.set(this.context,{}),a=kx.get(this.context)),a[n]={handlers:[r]};const l=m1(n,t);await this.context.audioWorklet.addModule(l);const o=new AudioWorkletNode(this.context,n);return a[n].node=o,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const l=r.getInt16(a*2,!0);t[a]=l/32768}catch(l){console.error(l)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const l=kx.get(this.context);l&&Object.entries(l).forEach(([,f])=>{const{node:u,handlers:d}=f;u&&(a.connect(u),u.port.onmessage=function(h){d.forEach(g=>{g.call(u.port,h)})},u.connect(this.context.destination))});const o=Math.max(this.scheduledTime,this.context.currentTime);a.start(o),this.scheduledTime=o+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function YB(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(u=>u.addEventListener("ended",f)),()=>{e.getTracks().forEach(u=>u.removeEventListener("ended",f))}},[e]),{type:"screen",start:async()=>{const f=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function WB(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(u=>u.addEventListener("ended",f)),()=>{e.getTracks().forEach(u=>u.removeEventListener("ended",f))}},[e]),{type:"webcam",start:async()=>{const f=await navigator.mediaDevices.getUserMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class QB extends ak{constructor(t){super();ri(this,"client");ri(this,"_status","disconnected");ri(this,"_session",null);ri(this,"_model",null);ri(this,"config",null);this.client=new nk(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(l){return console.error("Error connecting to GenAI Live:",l),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let l=((r=a.modelTurn)==null?void 0:r.parts)||[];const o=l.filter(h=>{var g;return h.inlineData&&((g=h.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),f=o.map(h=>{var g;return(g=h.inlineData)==null?void 0:g.data}),u=lk.difference(l,o);if(f.forEach(h=>{if(h){const g=OB(h);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!u.length)return;l=u;const d={modelTurn:{parts:l}};this.emit("content",d),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var o;let r=!1,a=!1;for(const f of t)if((o=this.session)==null||o.sendRealtimeInput({media:f}),f.mimeType.includes("audio")&&(r=!0),f.mimeType.includes("image")&&(a=!0),r&&a)break;const l=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",l)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function JB(e){const n=w.useMemo(()=>new QB(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[l,o]=w.useState({}),[f,u]=w.useState(!1),[d,h]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||ik({id:"audio-out"}).then(C=>{t.current=new GB(C),t.current.addWorklet("vumeter-out",rk,A=>{h(A.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const C=()=>{u(!0)},A=()=>{u(!1)},T=F=>{console.error("error",F)},D=()=>{var F;return(F=t.current)==null?void 0:F.stop()},M=F=>{var z;return(z=t.current)==null?void 0:z.addPCM16(new Uint8Array(F))},V=F=>{if(console.log("Received content event:",F),F.modelTurn&&F.modelTurn.parts){const z=F.modelTurn.parts.filter(B=>"text"in B&&B.text&&!B.thought);if(z.length>0){const B=z.map(U=>U.text).join(" ");b(B),console.log("AI Summary received:",B)}}};return n.on("error",T).on("open",C).on("close",A).on("interrupted",D).on("audio",M).on("content",V),()=>{n.off("error",T).off("open",C).off("close",A).off("interrupted",D).off("audio",M).off("content",V).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!l)throw new Error("config has not been set");n.disconnect(),await n.connect(r,l)},[n,l,r]),N=w.useCallback(async()=>{n.disconnect(),u(!1)},[u,n]);return{client:n,config:l,setConfig:o,model:r,setModel:a,connected:f,connect:v,disconnect:N,volume:d,aiSummary:g}}const ok=w.createContext(void 0),vw=({options:e,children:n})=>{const t=JB(e);return i.jsx(ok.Provider,{value:t,children:n})},Wd=()=>{const e=w.useContext(ok);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e},bj=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function KB(){const{config:e,setConfig:n}=Wd();w.useEffect(()=>{var f,u,d;const l=((d=(u=(f=e.speechConfig)==null?void 0:f.voiceConfig)==null?void 0:u.prebuiltVoiceConfig)==null?void 0:d.voiceName)||"Atari02";r({value:l,label:l})},[e]);const[t,r]=w.useState(bj[5]),a=w.useCallback(l=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:l}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(UF,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:bj,onChange:l=>{r(l),l&&a(l.value)}})]})}function XB(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=Wd(),l=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(d=>Array.isArray(d.functionDeclarations)).map(d=>d.functionDeclarations).filter(d=>!!d).flat():[],[t]),o=w.useMemo(()=>{var d;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(h=>typeof h=="string"?h:h.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((d=t.systemInstruction.parts)==null?void 0:d.map(h=>h.text).join(`
`))||"":""},[t]),f=w.useCallback(d=>{const h={...t,systemInstruction:d.target.value};r(h)},[t,r]),u=w.useCallback((d,h)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const N=v;return Array.isArray(N.functionDeclarations)?{...v,functionDeclarations:N.functionDeclarations.map(C=>C.name===d?{...C,description:h}:C)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsx("div",{className:"mode-selectors",children:i.jsx(KB,{})}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:f,value:o}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:l.map((d,h)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:d.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=d.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:d.description,onBlur:b=>u(d.name,b.target.value)},`fd-${d.description}`)]},`function-${h}`)})})})]})})]})}const vj=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function ZB({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const l=[WB(),YB()],[o,f]=w.useState(null),[u,d]=l,[h,g]=w.useState(0),[b]=w.useState(()=>new sk),[v,N]=w.useState(!1),C=w.useRef(null),A=w.useRef(null),{client:T,connected:D,connect:M,disconnect:V,volume:F}=Wd();w.useEffect(()=>{!D&&A.current&&A.current.focus()},[D]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(h*200,8))}px`)},[h]),w.useEffect(()=>{const B=U=>{T.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:U}])};return D&&!v&&b?b.on("data",B).on("volume",g).start():b.stop(),()=>{b.off("data",B).off("volume",g)}},[D,T,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=o);let B=-1;function U(){const R=e.current,O=C.current;if(!R||!O)return;const $=O.getContext("2d");if(O.width=R.videoWidth*.25,O.height=R.videoHeight*.25,O.width+O.height>0){$.drawImage(R,0,0,O.width,O.height);const W=O.toDataURL("image/jpeg",1),te=W.slice(W.indexOf(",")+1,1/0);T.sendRealtimeInput([{mimeType:"image/jpeg",data:te}])}D&&(B=window.setTimeout(U,1e3/.5))}return D&&o!==null&&requestAnimationFrame(U),()=>{clearTimeout(B)}},[D,o,T,e]);const z=B=>async()=>{if(B){const U=await B.start();f(U),t(U)}else f(null),t(null);l.filter(U=>U!==B).forEach(U=>U.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:C}),i.jsxs("nav",{className:ou("actions-nav",{disabled:!D}),children:[i.jsx("button",{className:ou("action-button mic-button",{recording:!v&&D}),onClick:()=>N(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(qB,{volume:F,active:D,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(vj,{isStreaming:d.isStreaming,start:z(d),stop:z(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(vj,{isStreaming:u.isStreaming,start:z(u),stop:z(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:ou("connection-container",{connected:D}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:A,className:ou("action-button connect-toggle",{connected:D}),onClick:D?V:M,children:i.jsx("span",{className:"material-symbols-outlined filled",children:D?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(XB,{}):""]})}const wj={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Vh.OBJECT,properties:{summary:{type:Vh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},eU=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:l,setModel:o}=Wd();return w.useEffect(()=>{o("models/gemini-2.5-flash-live-preview"),l({responseModalities:[Hh.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[wj]}]})},[l,o]),w.useEffect(()=>{const f=u=>{if(!u.functionCalls)return;const d=u.functionCalls.find(h=>h.name===wj.name);if(d){const h=d.args.summary;r(h)}u.functionCalls.length&&setTimeout(()=>{var h;return a.sendToolResponse({functionResponses:(h=u.functionCalls)==null?void 0:h.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",f),()=>{a.off("toolcall",f)}},[a]),w.useEffect(()=>{if(t){const f=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${f}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${f}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})};async function tU(){const e=tb();if(!e)throw new Error("Authentication token not found. Please log in.");try{const r=(await(await ue("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using clinic-specific Live API key."),r}catch(n){console.warn("Failed to fetch clinic-specific Live API key, trying global fallback.",n)}try{const r=(await(await ue("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using global Live API key."),r}catch(n){console.warn("Failed to fetch global Live API key.",n)}throw new Error("Live API key not found. Please contact your administrator.")}function nU(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const o=await tU();a({apiKey:o})}catch(o){console.error("Error setting Live API options:",o)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(vw,{options:r,children:i.jsx(iU,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const iU=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[l,o]=w.useState(null),{connected:f,client:u,connect:d,config:h,model:g}=Wd(),[b,v]=w.useState(""),N=w.useRef(null),[C,A]=w.useState(!1);w.useEffect(()=>{const D=window.matchMedia("(prefers-color-scheme: dark)"),M=V=>{document.documentElement.setAttribute("data-theme",V.matches?"dark":"light")};return M(D),D.addEventListener("change",M),()=>D.removeEventListener("change",M)},[]),w.useEffect(()=>{const D=new URLSearchParams(window.location.search),M={};for(const[V,F]of D.entries())V==="token_number"?o(F):M[V]=F;a(M)},[]),w.useEffect(()=>{Object.keys(h).length>0&&g&&d()},[d,h,g]),w.useEffect(()=>{if(f&&r&&!C){const D=JSON.stringify(r,null,2);u.send([{text:D}]),v(""),A(!0)}},[f,r,u,C]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const T=()=>{u.send([{text:b}]),v(""),N.current&&(N.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(eU,{patientData:r,tokenNumber:l}),i.jsx("video",{className:ou("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:ou("input-container",{disabled:!f}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:N,onKeyDown:D=>{D.key==="Enter"&&!D.shiftKey&&(D.preventDefault(),D.stopPropagation(),T())},onChange:D=>v(D.target.value),value:b}),i.jsx("span",{className:ou("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:T,children:"send"})]})}),i.jsx(ZB,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},Nj="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",rU=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},aU=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},l)=>{var z;const{connected:o,connect:f,disconnect:u,client:d,volume:h}=Wd(),[g,b]=w.useState(!1),[v,N]=w.useState(!1),[C,A]=w.useState(!1),[T]=w.useState(()=>new sk),D=async()=>{o?await u():(await f(),r.trim()&&a())};w.useEffect(()=>{const B=U=>{d.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:U}])};return o&&!g?T.on("data",B).start():T.stop(),()=>{T.off("data",B),T.stop()}},[o,d,g,T]);const M=w.useCallback(async()=>{if(v)F==null||F.getTracks().forEach(B=>B.stop()),t(null),N(!1);else try{const B=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),N(!0)}catch(B){console.error("Error accessing webcam:",B),N(!1)}},[v,t,e]),V=w.useCallback(async()=>{if(C)F==null||F.getTracks().forEach(B=>B.stop()),t(null),A(!1);else try{const B=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),A(!0)}catch(B){console.error("Error accessing screen share:",B),A(!1)}},[C,t,e]),F=(z=e.current)==null?void 0:z.srcObject;return w.useEffect(()=>()=>{F&&F.getTracks().forEach(B=>B.stop())},[F]),w.useImperativeHandle(l,()=>({handleConnect:D})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!o,className:`live-api-control-button ${o&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(kM,{className:"w-5 h-5"}):i.jsx(OC,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(rU,{volume:h,active:o})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:V,disabled:!o,className:`live-api-control-button ${C?"video-active":"video-inactive"}`,"aria-label":C?"Stop screen share":"Start screen share",children:i.jsx(AM,{className:"w-5 h-5"})}),i.jsx("button",{onClick:M,disabled:!o,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(NI,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${o?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:o?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:D,className:`live-api-connect-button ${o?"connected":"disconnected"}`,children:o?i.jsxs(i.Fragment,{children:[i.jsx(OM,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(BM,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),sU=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:r})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:r.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[r," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",r," Reception Assistant"]})]}),n&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:n})]}),!1,t&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),Sj={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Vh.OBJECT,properties:{summary:{type:Vh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},lU=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a,aiLanguage:l})=>{const o=w.useRef(null),f=w.useRef(null),[u,d]=w.useState(null),[h,g]=w.useState("hi"),{client:b,connected:v,aiSummary:N,setConfig:C,setModel:A,disconnect:T}=Wd(),[D,M]=w.useState(null),V=w.useMemo(()=>{let B=`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, and sex(dont ask for sex ,detect automatically through voice recognition).

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in ${l||"English"}.dont write the ${l||"English"} words in english.donot use function calls in the middle of the conversation`;return n&&(B+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[Hh.AUDIO],mediaResolution:s1.MEDIA_RESOLUTION_MEDIUM,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},contextWindowCompression:{triggerTokens:"25600",slidingWindow:{targetTokens:"12800"}},systemInstruction:{parts:[{text:B+`

IMPORTANT: Do not verbalize your internal thought process. Only speak the final response to the user. Do not include any 'Thinking' or internal narration in the audio response.`}]},tools:[{functionDeclarations:[Sj]}]}},[n,l]);w.useEffect(()=>{A("models/gemini-2.5-flash-native-audio-preview-12-2025"),C(V);const B=setTimeout(()=>{f.current&&!v&&f.current.handleConnect()},2e3);return()=>clearTimeout(B)},[C,A,V,v]),w.useEffect(()=>()=>{v&&T()},[v,T]),w.useEffect(()=>{const B=U=>{if(U.modelTurn&&U.modelTurn.parts){for(const R of U.modelTurn.parts)if(R.executableCode){const O=R.executableCode.code,$=/summary=["'](.*?)["']/.exec(O);if($&&$[1]){const W=$[1];M(W),r(W)}}}};return b.on("content",B),()=>{b.off("content",B)}},[b,r]),w.useEffect(()=>{const B=U=>{if(!U.functionCalls)return;const R=U.functionCalls.find(O=>O.name===Sj.name);if(R){const O=R.args.summary;M(O),r(O)}U.functionCalls.length&&setTimeout(()=>{var O;return b.sendToolResponse({functionResponses:(O=U.functionCalls)==null?void 0:O.map($=>({response:{output:{success:!0}},id:$.id,name:$.name}))})},200)};return b.on("toolcall",B),()=>{b.off("toolcall",B)}},[b,r]);const F=()=>{h.trim()&&(b.send([{text:h}]),g(""))},z=B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),F())};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(gi,{className:"w-6 h-6"})})})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(sU,{patientData:n,tokenNumber:t,aiSummary:D??N,clinicName:a}),u&&i.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:h,onChange:B=>g(B.target.value),onKeyDown:z,placeholder:"Type your message here...",disabled:!v,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:F,disabled:!v||!h.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(XM,{className:"w-5 h-5"})})]})}),i.jsx(aU,{ref:f,videoRef:o,supportsVideo:!0,onVideoStreamChange:d,textInput:h,onSubmitTextInput:F})]})})]})})},ck=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,l]=w.useState(null),[o,f]=w.useState("Newtons Ai"),[u,d]=w.useState(""),[h,g]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{const C=await(await ue("/api/clinics/settings")).json();C.gemini_api_key?l(C.gemini_api_key):l(Nj),C.name&&C.name!==""?f(C.name):f("Newtons Ai"),d(C.aiLanguage||"")}catch(N){console.error("Failed to fetch clinic settings, using default API key and unknown clinic name:",N),l(Nj),f("Newtons Ai"),d("")}finally{g(!1)}})()},[]),h)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content live-api-loading-container",children:[i.jsxs("div",{className:"live-api-loading-spinner",children:[i.jsx("div",{className:"live-api-spinner-ring"}),i.jsx("div",{className:"live-api-spinner-ring"}),i.jsx("div",{className:"live-api-spinner-ring"})]}),i.jsx("div",{className:"live-api-loading-text",children:"Initializing Live API"})]})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const b={apiKey:a};return i.jsx(vw,{options:b,children:i.jsx(lU,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:o,aiLanguage:u})})},oU=({onClose:e})=>{const n=Mt(),t=()=>{e(),n("/start-clinic-subscription")};return i.jsx("div",{className:"go-pro-modal-overlay",children:i.jsxs("div",{className:"go-pro-modal-content",children:[i.jsx("button",{onClick:e,className:"go-pro-modal-close-button",children:i.jsx(gi,{size:24})}),i.jsx("h2",{className:"go-pro-modal-title",children:"Voice AI Agent for Pro Members Only"}),i.jsx("p",{className:"go-pro-modal-message",children:"Unlock the full potential of our Voice AI Agent by upgrading to a Pro subscription. Enjoy advanced features and seamless patient interactions."}),i.jsx("button",{onClick:t,className:"go-pro-button",children:"Go Pro Now"})]})})},cU="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",uU={apiKey:cU},Mh=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,l]=w.useState([]),[o,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState(null),[N,C]=w.useState(!1),[A,T]=w.useState(null),D=w.useRef(null),[M,V]=w.useState(!1),[F,z]=w.useState(!1),[B,U]=w.useState(null),[R,O]=w.useState(null),[$,W]=w.useState(null),[te,ne]=w.useState(!1),[re,J]=w.useState(!0),q=Mt(),H=_r();w.useEffect(()=>{(async()=>{try{const ye=await KC();W(ye.hasProPlan)}catch(ye){console.error("Error fetching pro status:",ye),W(!1)}})(),ee()},[]);const ee=async()=>{try{const ge=new URLSearchParams({page:"1",limit:"4",sortBy:"created_at",sortOrder:"desc"}),ye=await ue(`/api/patients?${ge.toString()}`);if(ye.ok){const Re=await ye.json();l(Re.patients)}}catch(ge){console.error("Error fetching recent patients:",ge)}},E=w.useCallback(async ge=>{const ye=ge||e;if(!ye.trim()){T("Please enter complaint details.");return}C(!0),T(null);try{const Re=await ue("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!Re.ok){const Te=await Re.json().catch(()=>({message:"Failed to create patient"}));if(Re.status===403&&Te.message.includes("Patient limit")){q("/start-clinic-subscription",{state:{errorMessage:Te.message}});return}throw new Error(Te.message||`Failed to create patient: ${Re.statusText}`)}const Ze=await Re.json();if(!Ze||!Ze.id)throw new Error("Failed to create new patient or retrieve patient ID.");const at=await ue("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:Ze.id,complaint:ye})});if(!at.ok){const Te=await at.text();throw new Error(`Failed to create queue entry: ${Te||at.statusText}`)}const Le=await at.json();if(!Le||!Le.id)throw new Error("Failed to create new complaint record or retrieve record ID.");q(`/dashboard/edit-complaint/${Le.id}`,{state:{initialComplaint:ye,patientId:Ze.id}})}catch(Re){console.error("Error starting new complaint:",Re),Re.message.includes("Patient limit")?(T(`Error: ${Re.message}. Please upgrade your plan.`),q("/start-clinic-subscription")):T(`Error: ${Re.message||"Failed to start new complaint process."}`)}finally{C(!1)}},[e,q]);w.useEffect(()=>{const ge=D.current;ge&&(ge.style.height="auto",ge.style.height=`${ge.scrollHeight}px`);const Re=new URLSearchParams(H.search).get("caseDetails");if(Re){const Ze=decodeURIComponent(Re);Ze!==e&&(n(Ze),V(!0))}},[H.search,e]),w.useEffect(()=>{M&&e.trim()&&(q(H.pathname,{replace:!0}),E(e),V(!1))},[M,e,E,q,H.pathname]),w.useEffect(()=>{const ge=D.current;ge&&(ge.style.height="auto",ge.style.height=`${ge.scrollHeight}px`)},[e]),w.useEffect(()=>{B&&(n(B),z(!1),E(B),U(null))},[B,E]),w.useEffect(()=>{const ge=D.current;ge&&ge.focus({preventScroll:!0})},[]);const Q=()=>{J(!1)},ie=()=>{if($===!1){ne(!0);return}O({id:null,token:null,name:"New Case",age:null,gender:null}),z(!0)},I=w.useMemo(()=>Tb(async ge=>{const ye=ge.trim(),Re=/^\d+$/.test(ye),Ze=ye.split(/\s+/).length;if(ye.length<2||Re&&ye.length>10||!Re&&Ze>2){r([]),f(!1),d(null);return}f(!0),d(null);try{const at=new URLSearchParams({search:encodeURIComponent(ge),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),Le=await ue(`/api/patients?${at.toString()}`);if(!Le.ok){const we=await Le.text();throw new Error(`API Error (${Le.status}): ${we||Le.statusText}`)}const Te=await Le.json();r(Te.patients)}catch(at){console.error("Error searching patients:",at),d(at.message||"Failed to search patients."),r([])}finally{f(!1)}},300),[]),ce=ge=>{const ye=ge.target.value;n(ye);const Re=ye.trim(),Ze=/^\d+$/.test(Re),at=Re.split(/\s+/).length;Re.length>=2&&!(Ze&&Re.length>10||!Ze&&at>2)?f(!0):(f(!1),r([])),J(!0),I(ye)},xe=ge=>{ge.key==="Enter"&&!ge.shiftKey&&(ge.preventDefault(),t.length>0&&!o?le(t[0]):e.trim()&&!o&&E(e))},le=async ge=>{r([]),n(""),g(!0),v(null);try{const ye=await ue(`/api/queue/patient/${ge.id}/latest`);if(ye.ok){const at=await ye.json();if(at!=null&&at._id){if(at!=null&&at._id){q(`/dashboard/edit-complaint/${at._id}`,{state:{patientId:ge.id}}),g(!1);return}g(!1);return}}else if(ye.status!==404){const at=await ye.text();throw new Error(`Failed to fetch queue entry: ${at||ye.statusText} (${ye.status})`)}const Re=await ue("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:ge.id})});if(!Re.ok){const at=await Re.text();throw new Error(`Failed to create queue entry: ${at||Re.statusText} (${Re.status})`)}const Ze=await Re.json();if(Ze!=null&&Ze.id)q(`/dashboard/edit-complaint/${Ze.id}`,{state:{patientId:ge.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(ye){console.error("Error processing patient selection:",ye),v(ye.message||"An error occurred while processing the selection.")}finally{g(!1)}};return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>q("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsx("button",{onClick:()=>q(-1),className:"back-button",children:i.jsx(an,{size:16})})]}),i.jsxs("div",{className:"patient-search-content-box",children:[u&&i.jsx("p",{className:"patient-search-error",children:u}),b&&i.jsx("p",{className:"patient-search-error",children:b}),A&&i.jsx("p",{className:"patient-search-error",children:A})]}),!e&&a.length>0&&i.jsxs("div",{className:"recent-patients-section",children:[i.jsx("div",{className:"recent-patients-grid",children:a.map((ge,ye)=>i.jsxs("div",{onClick:()=>le(ge),className:"recent-patient-card",style:{"--i":ye},children:[i.jsxs("div",{className:"recent-patient-info",children:[i.jsx("span",{className:"recent-patient-name",children:ge.name}),i.jsxs("span",{className:"recent-patient-details",children:[ge.age?`${ge.age} yrs`:"",ge.age&&ge.gender?" / ":"",ge.gender||""]})]}),i.jsxs("div",{className:"recent-patient-token",children:["#",ge.token]})]},ge.id))}),i.jsx("h2",{className:"recent-patients-title",children:"Newly Registered"})]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&re&&i.jsx("div",{className:"search-results-backdrop",onClick:Q}),t.length>0&&re&&!h&&!N&&i.jsx("ul",{className:"patient-search-results-list",children:t.map((ge,ye)=>i.jsxs("li",{onClick:()=>le(ge),className:"patient-search-result-item",style:{"--i":ye},children:[i.jsx("div",{className:"patient-search-result-item-name-container",children:i.jsxs("div",{className:"patient-search-result-item-primary-info",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["#",ge.token]}),i.jsx("span",{className:"patient-search-result-item-name",children:ge.name}),i.jsxs("span",{className:"patient-search-result-item-meta",children:[ge.age?`${ge.age}y`:"",ge.age&&ge.gender?"  ":"",ge.gender||""]})]})}),i.jsx("div",{className:"patient-search-result-item-chevron",children:i.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("polyline",{points:"9 18 15 12 9 6"})})})]},ge.id))}),e.length>=2&&!o&&t.length===0&&!u&&!h&&i.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),i.jsxs("div",{className:"chat-input-controls",children:[i.jsx("textarea",{ref:D,placeholder:"Search or Create Case: Name, Age, Sex, Complaint...",value:e,onChange:ce,onKeyDown:xe,onFocus:()=>J(!0),onClick:()=>J(!0),className:"chat-input",disabled:h||N,rows:1}),i.jsx("button",{onClick:e.trim()?()=>E(e):ie,className:`chat-submit-button ${N||o?"opacity-50":""}`,disabled:N||o||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:N||o?i.jsxs("div",{className:"spinner-dots",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}):e.trim()?i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),F&&i.jsx(vw,{options:uU,children:i.jsx(ck,{onClose:()=>z(!1),patientData:R,tokenNumber:null,onAiSummaryChange:U})}),te&&i.jsx(oU,{onClose:()=>ne(!1)})]})},dU=()=>{const e=Mt(),[n,t]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[r,a]=w.useState(!0),[l,o]=w.useState(!1),[f,u]=w.useState(null),[d,h]=w.useState(null);w.useEffect(()=>{(async()=>{a(!0),u(null);try{const N=await ue("/api/clinics/settings");if(!N.ok){const A=await N.json();throw new Error(A.message||"Failed to fetch clinic settings.")}const C=await N.json();t({admissionCharge:parseFloat(C.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(C.perDayCharge||0).toFixed(2),otherCharges:parseFloat(C.otherCharges||0).toFixed(2),aiMemory:C.aiMemory||"",clinicWideSystemPrompt:C.clinicWideSystemPrompt||"",gemini_api_key:C.gemini_api_key||"",low_stock_threshold:C.low_stock_threshold!==void 0&&C.low_stock_threshold!==null?String(C.low_stock_threshold):"10",aiLanguage:C.aiLanguage||"",name:C.name||"",logoUrl:C.logoUrl||"",upi_id:C.upi_id||"",address:C.address||"",notes:C.notes||""})}catch(N){console.error("Error fetching settings:",N),u(`Failed to load settings: ${N.message}`),t({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"Unknown Clinic",logoUrl:"",upi_id:"",address:"",notes:""})}finally{a(!1)}})()},[]);const g=v=>{const{name:N,value:C}=v.target;t(A=>({...A,[N]:C}))},b=async v=>{v.preventDefault(),u(null),h(null),o(!0);const N=parseFloat(n.admissionCharge),C=parseFloat(n.perDayCharge),A=parseFloat(n.otherCharges),T=parseInt(n.low_stock_threshold);if(isNaN(N)||N<0||isNaN(C)||C<0||isNaN(A)||A<0){u("Invalid charge amount. Please enter non-negative numbers for all fields."),o(!1);return}if(isNaN(T)||T<0){u("Invalid low stock threshold. Please enter a non-negative number."),o(!1);return}try{const D=await ue("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:n.name,admissionCharge:N,perDayCharge:C,otherCharges:A,aiMemory:n.aiMemory,clinicWideSystemPrompt:n.clinicWideSystemPrompt,gemini_api_key:n.gemini_api_key,low_stock_threshold:T,aiLanguage:n.aiLanguage,logoUrl:n.logoUrl,upi_id:n.upi_id,address:n.address,notes:n.notes})});if(!D.ok){const V=await D.json();throw new Error(V.message||"Failed to update settings.")}const M=await D.json();t({admissionCharge:parseFloat(M.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(M.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(M.settings.otherCharges).toFixed(2),aiMemory:M.settings.aiMemory||"",clinicWideSystemPrompt:M.settings.clinicWideSystemPrompt||"",gemini_api_key:M.settings.gemini_api_key||"",low_stock_threshold:M.settings.low_stock_threshold!==void 0&&M.settings.low_stock_threshold!==null?String(M.settings.low_stock_threshold):"10",aiLanguage:M.settings.aiLanguage||"",name:M.settings.name||"",logoUrl:M.settings.logoUrl||"",upi_id:M.settings.upi_id||"",address:M.settings.address||"",notes:M.settings.notes||""}),h("Clinic settings updated successfully!"),setTimeout(()=>h(null),3e3)}catch(D){console.error("Error updating settings:",D),u(`Update failed: ${D.message}`)}finally{o(!1)}};return r?i.jsxs("div",{className:"loading-animation-container",children:[i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"loading-text",children:"Loading settings..."})]}):i.jsxs("div",{className:"clinic-settings-container",children:[i.jsxs("div",{className:"clinic-settings-header-container",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",children:i.jsx(an,{size:24})}),i.jsxs("h3",{className:"clinic-settings-header",children:[i.jsx(hg,{size:24}),"Clinic Settings"]})]}),f&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-error",role:"alert",children:f}),d&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-success",role:"alert",children:d}),i.jsxs("form",{onSubmit:b,className:"clinic-settings-form",children:[i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"name",className:"clinic-settings-label",children:"Clinic Name"}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"e.g., My Awesome Clinic"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"admissionCharge",className:"clinic-settings-label",children:[i.jsx(Bd,{size:16})," Admission Charge ()"]}),i.jsx("input",{type:"number",id:"admissionCharge",name:"admissionCharge",value:n.admissionCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:l,placeholder:"e.g., 500.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"perDayCharge",className:"clinic-settings-label",children:[i.jsx(Bd,{size:16})," Per Day Charge ()"]}),i.jsx("input",{type:"number",id:"perDayCharge",name:"perDayCharge",value:n.perDayCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:l,placeholder:"e.g., 1000.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"otherCharges",className:"clinic-settings-label",children:[i.jsx(Bd,{size:16})," Other Charges (Default/Misc.) ()"]}),i.jsx("input",{type:"number",id:"otherCharges",name:"otherCharges",value:n.otherCharges,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:l,placeholder:"e.g., 50.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"low_stock_threshold",className:"clinic-settings-label",children:[i.jsx(CD,{size:16})," Low Stock Notification Threshold"]}),i.jsx("input",{type:"number",id:"low_stock_threshold",name:"low_stock_threshold",value:n.low_stock_threshold,onChange:g,className:"clinic-settings-input",min:"0",required:!0,disabled:l,placeholder:"e.g., 10"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Set the minimum quantity of a drug to trigger a low stock notification."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"aiMemory",className:"clinic-settings-label",children:[i.jsx(Gv,{size:16})," AI Memory (Plain Text)"]}),i.jsx("textarea",{id:"aiMemory",name:"aiMemory",value:n.aiMemory,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter any clinic-wide notes or context for the AI..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter clinic-wide AI memory data as plain text."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"clinicWideSystemPrompt",className:"clinic-settings-label",children:[i.jsx(_M,{size:16})," Clinic-Wide AI System Prompt"]}),i.jsx("textarea",{id:"clinicWideSystemPrompt",name:"clinicWideSystemPrompt",value:n.clinicWideSystemPrompt,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter the system prompt for the AI that will apply to all interactions within this clinic..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"This prompt will be used as the base instruction for the AI across the clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"aiLanguage",className:"clinic-settings-label",children:"AI Language"}),i.jsxs("select",{id:"aiLanguage",name:"aiLanguage",value:n.aiLanguage,onChange:g,className:"clinic-settings-input",disabled:l,children:[i.jsx("option",{value:"",children:"Select Language"}),i.jsx("option",{value:"English",children:"English"}),i.jsx("option",{value:"Hindi",children:"Hindi"}),i.jsx("option",{value:"Telugu",children:"Telugu"}),i.jsx("option",{value:"Tamil",children:"Tamil"}),i.jsx("option",{value:"Kannada",children:"Kannada"}),i.jsx("option",{value:"Malayalam",children:"Malayalam"}),i.jsx("option",{value:"Bengali",children:"Bengali"}),i.jsx("option",{value:"Gujarati",children:"Gujarati"}),i.jsx("option",{value:"Marathi",children:"Marathi"}),i.jsx("option",{value:"Punjabi",children:"Punjabi"})]}),i.jsx("p",{className:"clinic-settings-help-text",children:"Specify the language for AI interactions."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"logoUrl",className:"clinic-settings-label",children:"Clinic Logo URL"}),i.jsx("input",{type:"url",id:"logoUrl",name:"logoUrl",value:n.logoUrl,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"e.g., https://example.com/logo.png"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the URL for your clinic's logo."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"upi_id",className:"clinic-settings-label",children:"UPI ID"}),i.jsx("input",{type:"text",id:"upi_id",name:"upi_id",value:n.upi_id,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"e.g., yourclinic@upi"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your clinic's UPI ID for payments."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"address",className:"clinic-settings-label",children:"Clinic Address"}),i.jsx("textarea",{id:"address",name:"address",value:n.address,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter your clinic's full address"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the physical address of your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"notes",className:"clinic-settings-label",children:"Other Clinic Details/Notes"}),i.jsx("textarea",{id:"notes",name:"notes",value:n.notes,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter any other relevant clinic details or notes"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Add any additional information or notes about your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"gemini_api_key",className:"clinic-settings-label",children:[i.jsx(Gv,{size:16})," Gemini API Key"]}),i.jsx("input",{type:"text",id:"gemini_api_key",name:"gemini_api_key",value:n.gemini_api_key,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"Enter your Gemini API key"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your Gemini API key to enable AI features."})]}),i.jsx("div",{className:"clinic-settings-button-container",children:i.jsxs("button",{type:"submit",className:"clinic-settings-button",disabled:l,children:[i.jsx(uu,{size:18})," ",l?"Saving...":"Save Settings"]})})]})]})},fU=({})=>{const e=Mt(),[n,t]=w.useState("patientSearch"),[r]=w.useState(!1),[a,l]=w.useState(null),[o,f]=w.useState(null);return w.useEffect(()=>{if(o){const u=setTimeout(()=>f(null),5e3);return()=>clearTimeout(u)}},[o]),r?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",o&&i.jsxs("div",{className:`alert-box ${o.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:o.type==="success"?i.jsx(Ta,{size:18}):i.jsx(ni,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:o.message})}),i.jsx("button",{onClick:()=>f(null),className:"alert-box-close",children:i.jsx(gi,{size:16})})]}),a&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(ni,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:a})}),i.jsx("button",{onClick:()=>l(null),className:"alert-box-close",children:i.jsx(gi,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[i.jsx(LC,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/staff"),className:"admin-nav-button",children:[i.jsx(cu,{})," Staff"]}),i.jsx("button",{onClick:()=>t("moneyFlow"),className:`admin-nav-button ${n==="moneyFlow"?"active":""}`,children:"Money"}),i.jsx("button",{onClick:()=>t("inventory"),className:`admin-nav-button ${n==="inventory"?"active":""}`,children:"Inventory"}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>t("clinicSettings"),className:`admin-nav-button ${n==="clinicSettings"?"active":""}`,children:[i.jsx(hg,{})," Settings"]}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(zd,{})," Patient Subscriptions"]}),i.jsxs("button",{onClick:()=>e("/dashboard/add-pharmacy-order"),className:"admin-nav-button",children:[i.jsx(Xo,{})," Order Meds"]}),i.jsx("button",{onClick:()=>e("/dashboard/recurring-medications"),className:"admin-nav-button",children:"Daily Meds"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(MC,{})," Order Tests"]}),i.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-nav-button",children:[i.jsx(cu,{})," All Patients"]})]}),i.jsxs("div",{className:"space-y-6",children:[" ",n==="patientSearch"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(Mh,{})}),n==="moneyFlow"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(YI,{})}),n==="inventory"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(Jv,{})}),n==="clinicSettings"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(dU,{})})]})]})},eu=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},hU=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},Sh=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:l,noDataText:o})=>{const f=w.useMemo(()=>{const u={};t.forEach(h=>{if(isNaN(h.date.getTime())){u["Unknown Date"]||(u["Unknown Date"]=[]),u["Unknown Date"].push(h);return}const g=hU(h.originalDateString);u[g]||(u[g]=[]),u[g].push(h)});const d=Object.keys(u);return d.sort((h,g)=>{if(h==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=C=>{const A=C.split(" ");if(A.length===3){const D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(A[1]);if(D!==-1)return new Date(parseInt(A[2]),D,parseInt(A[0]))}return new Date(C)},v=b(h),N=b(g);if(!isNaN(v.getTime())&&!isNaN(N.getTime()))return N.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(h)}),d.map(h=>({date:h,items:u[h]}))},[t]);return i.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded-md border border-gray-200",children:[i.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 border-b border-gray-300 pb-1 flex items-center",children:[" ",n&&i.jsx(n,{size:14,className:"mr-1.5 text-indigo-600"})," ",e]}),a&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:l}),!a&&t.length===0&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:o}),!a&&t.length>0&&i.jsxs("div",{className:"space-y-2",children:[" ",f.map(({date:u,items:d})=>i.jsxs("div",{className:"pl-0.5",children:[" ",i.jsxs("h5",{className:"text-[11px] font-medium text-indigo-700 mb-1 bg-indigo-50 px-1 py-0.5 rounded-sm inline-block",children:[" ",u]}),i.jsx("div",{className:"space-y-1 pl-1.5 border-l-2 border-indigo-200 ml-0.5",children:d.map((h,g)=>i.jsxs("div",{className:"text-xs py-0 flex items-start",children:[" ",i.jsx("div",{className:"flex-grow mr-1",children:r(h)})," "]},`${h.type}-${h.originalDateString}-${g}`))})]},u))]})]})},lv=()=>{var re,J;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[N,C]=w.useState(!1),[A,T]=w.useState(null),{patientId:D}=qr(),M=Mt(),V=w.useCallback(async q=>{g(null),f(null),d(null),C(!0),T(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const H=await ue(`/api/patients/${q}`);if(!H.ok)throw new Error(`Patient details fetch failed (${H.status})`);const ee=await H.json();f(ee);const E=await ue(`/api/queue/patient/${q}/latest`);if(!E.ok&&E.status!==404)throw new Error(`Queue entry fetch failed (${E.status})`);if(E.ok){const Q=await E.json();d(Q)}await F(q)}catch(H){console.error("Error fetching specific patient data:",H),g(H.message||"Failed to load patient data."),T(H.message||"Failed to load patient history.")}finally{C(!1)}},[]),F=w.useCallback(async q=>{C(!0),T(null);try{const[H,ee,E,Q]=await Promise.all([ue(`/api/queue/patient/${q}/complaints`),ue(`/api/lab/patient/${q}`),ue(`/api/lab/orders/patient/${q}?status=pending`),ue(`/api/pharmacy-orders/patient/${q}`)]),ie=H.ok?await H.json():[],I=ee.ok?await ee.json():[],ce=E.ok?await E.json():[],xe=Q.ok?await Q.json():[];v({pastComplaints:ie||[],labReports:I||[],pendingLabOrders:ce||[],pharmacyOrders:xe||[]})}catch(H){console.error("Error fetching patient history:",H),T(H.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{C(!1)}},[]),z=w.useCallback(async()=>{r(!0),l(null);try{const q=await ue("/api/queue/doctor");if(!q.ok){const ee=await q.text();throw new Error(`API Error (${q.status}): ${ee||q.statusText}`)}const H=await q.json();if(H===null||typeof H!="object"||typeof H.waitingCount!="number")throw console.error("Invalid queue data format:",H),new Error("Invalid queue data format received");n({currentPatient:H.currentPatient||null,nextPatient:H.nextPatient||null,waitingCount:H.waitingCount})}catch(q){console.error("Error fetching queue data:",q),l(q.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let q=null;return D?(V(D),n({currentPatient:null,nextPatient:null,waitingCount:0})):(z(),q=setInterval(z,1e4),f(null),d(null)),()=>{q&&clearInterval(q)}},[D,V,z]),w.useEffect(()=>{var q;!D&&((q=e.currentPatient)!=null&&q.patientId)?F(e.currentPatient.patientId):!D&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),C(!1),T(null))},[D,(re=e.currentPatient)==null?void 0:re.patientId,F]);const B=((J=e.currentPatient)==null?void 0:J.patientId)||(D?parseInt(D,10):null),U=w.useMemo(()=>{if(!B||!b.pastComplaints)return[];const q=b.pastComplaints.map(H=>({date:new Date(H.createdAt),type:"Complaint",data:H,originalDateString:H.createdAt})).filter(H=>!isNaN(H.date.getTime()));return q.sort((H,ee)=>ee.date.getTime()-H.date.getTime()),q},[B,b.pastComplaints]),R=w.useMemo(()=>{if(!B)return[];const q=[];return(b.pendingLabOrders??[]).forEach(H=>{const ee=new Date(H.createdAt);isNaN(ee.getTime())||q.push({date:ee,type:"Lab Order (Pending)",data:H,originalDateString:H.createdAt})}),(b.labReports??[]).forEach(H=>{const ee=H.reportCreatedAt?new Date(H.reportCreatedAt):null;ee&&!isNaN(ee.getTime())&&q.push({date:ee,type:"Lab Report",data:H,originalDateString:H.reportCreatedAt})}),q.sort((H,ee)=>ee.date.getTime()-H.date.getTime()),q},[B,b.pendingLabOrders,b.labReports]),O=w.useMemo(()=>{if(!B||!b.pharmacyOrders)return[];const q=b.pharmacyOrders.map(H=>({date:new Date(H.date),type:"Pharmacy Order",data:H,originalDateString:H.date})).filter(H=>!isNaN(H.date.getTime()));return q.sort((H,ee)=>ee.date.getTime()-H.date.getTime()),q},[B,b.pharmacyOrders]),$=async()=>{r(!0),l(null);try{await ue("/api/queue/doctor/next",{method:"POST"}),await z()}catch(q){console.error("Error calling next patient:",q),l(q.message||"Failed to call next patient.")}finally{r(!1)}},W=async()=>{if(!(!e.currentPatient||D)){r(!0),l(null);try{await ue(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await z(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),C(!1),T(null)}catch(q){console.error("Error completing consultation:",q),l(q.message||"Failed to complete consultation.")}finally{r(!1)}}},te=q=>{switch(q){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return q}};let ne=null;return e.currentPatient&&(ne=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-teal-500",children:[i.jsx("h2",{className:"text-xl text-teal-700 font-semibold mb-3",children:"NOW SEEING:"}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:"flex-grow md:w-1/2",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-1",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600",children:[i.jsx("span",{className:"font-bold",children:e.currentPatient.age})," | ",i.jsx("span",{className:"font-bold",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0",children:[i.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-700 mb-1",children:e.currentPatient.token}),i.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:te(e.currentPatient.status)})]})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex justify-end space-x-3 border-t pt-4",children:[i.jsx("button",{onClick:()=>{var H;const q=(H=e.currentPatient)==null?void 0:H._id;q&&M(`/dashboard/edit-complaint/${q}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Edit Complaint / AI"}),i.jsx("button",{onClick:W,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success disabled:opacity-50 disabled:cursor-not-allowed",children:"Complete Consultation"})]})]})," ",i.jsxs("div",{className:"complaint-section md:w-1/2 mt-4 md:mt-0 border-t md:border-t-0 md:border-l md:pl-6 pt-4 md:pt-0",children:[i.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-2",children:"Context & History:"}),A&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:A}),i.jsxs("div",{className:"space-y-2 pr-2",children:[i.jsx(Sh,{title:"Complaints History",icon:Ea,items:U,isLoading:N,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:q=>i.jsxs("span",{className:"block text-xs",children:[q.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",eu(q.originalDateString),")"]})]})}),i.jsx(Sh,{title:"Lab History (Orders & Reports)",icon:Wv,items:R,isLoading:N,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:q=>q.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(CN,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",q.data.tests.map(H=>H.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",q.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",eu(q.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(kN,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",q.data.testName," - ",q.data.reportFindings.substring(0,50),q.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",eu(q.originalDateString),")"]})]})]})}),i.jsx(Sh,{title:"Pharmacy Order History",icon:Ko,items:O,isLoading:N,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:q=>i.jsxs("span",{className:"block text-xs",children:[q.data.medications.map(H=>`${H.name} (Qty: ${H.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",q.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",eu(q.originalDateString),")"]})]})}),U.length===0&&R.length===0&&O.length===0&&!N&&i.jsx("p",{className:"text-gray-500 italic text-xs mt-2 px-1",children:"No history found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>M(-1),className:"back-button mr-4",children:i.jsx(an,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),D?i.jsxs(i.Fragment,{children:[h&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:h}),o&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-purple-500",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold",children:"Patient Record:"}),i.jsx("button",{onClick:()=>M("/dashboard/doctor"),className:"text-sm text-blue-600 hover:underline",children:"Back to Queue"})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-1 md:mb-2",children:o.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600 mb-3 md:mb-4",children:["Age: ",o.age??"N/A"," | ",o.gender??"N/A"]}),i.jsxs("div",{className:"mt-3 md:mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[i.jsx("label",{className:"font-medium block mb-1 text-sm text-gray-600",children:"Latest Queue Entry:"}),u?i.jsxs("div",{className:"space-y-2",children:[" ",i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words",children:[i.jsxs("span",{className:"font-medium text-gray-700",children:["(",u.age," / ",u.gender,")"]}),": ",u.complaint||i.jsx("span",{className:"text-gray-400 italic",children:"No complaint"}),i.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${u.status==="consulting"?"bg-teal-100 text-teal-800":u.status==="seen"?"bg-green-100 text-green-800":u.status==="waiting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:te(u.status)})]}),u.status==="consulting"&&u._id&&i.jsx("button",{onClick:()=>M(`/dashboard/edit-complaint/${u._id}`),className:"ml-4 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded flex-shrink-0",children:"Edit"})]}),u.case_summary&&i.jsxs("p",{className:"text-xs text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",u.case_summary]})]}):i.jsx("p",{className:"text-gray-500 italic text-sm",children:"No queue entry found for this patient today."})]}),i.jsxs("div",{className:"mt-4 border-t pt-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Patient History:"}),A&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:A}),i.jsx(Sh,{title:"Complaints History",icon:Ea,items:U,isLoading:N,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:q=>i.jsxs("span",{className:"block text-xs",children:[" ",q.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",eu(q.originalDateString),")"]})]})}),i.jsx(Sh,{title:"Lab History (Orders & Reports)",icon:Wv,items:R,isLoading:N,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:q=>q.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(CN,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",q.data.tests.map(H=>H.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",q.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",eu(q.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(kN,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",q.data.testName," - ",q.data.reportFindings.substring(0,50),q.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",eu(q.originalDateString),")"]})]})]})}),i.jsx(Sh,{title:"Pharmacy Order History",icon:Ko,items:O,isLoading:N,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:q=>i.jsxs("span",{className:"block text-xs",children:[" ",q.data.medications.map(H=>`${H.name} (Qty: ${H.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",q.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",eu(q.originalDateString),")"]})]})}),U.length===0&&R.length===0&&O.length===0&&!N&&i.jsx("p",{className:"text-gray-500 italic text-sm mt-2",children:"No history found."})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>M("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx(UC,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>M("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:ne||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:te(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:$,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},uk=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,l]=w.useState(null),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState(!1),[N,C]=w.useState(!1),[A,T]=w.useState(null),D=Mt(),M=w.useCallback(lk.debounce(async O=>{if(O.trim().length<2){r([]),C(!1);return}C(!0),T(null);try{const $=new URLSearchParams({search:encodeURIComponent(O),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),W=await ue(`/api/patients?${$.toString()}`);if(!W.ok){const ne=await W.text();throw new Error(`API Error (${W.status}): ${ne||W.statusText||"Failed to fetch patients"}`)}const te=await W.json();r(te.patients)}catch($){T($ instanceof Error?$.message:"An unknown error occurred while searching patients"),r([])}finally{C(!1)}},500),[]);w.useEffect(()=>(e?(C(!0),M(e)):(r([]),M.cancel()),()=>{M.cancel()}),[e,M]);const V=O=>{l(O),n(""),r([]),T(null),f(null),d(null),g(null),v(!1)},F=async()=>{if(!a){T("No patient selected.");return}T(null),C(!0);try{const O=await ue(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!O.ok){const W=await O.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(W.message||"Failed to admit patient")}const $=await O.json();alert($.message||"Patient admitted successfully!"),$.bill&&$.bill.id?D(`/patient/${a.id}/admission-bill/${$.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),T("Admission successful, but couldn't navigate to billing."),l($.patient))}catch(O){T(O instanceof Error?O.message:"Failed to admit patient")}finally{C(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){f(null),g(null);return}v(!0),d(null),f(null),g(null);try{const $=await ue(`/api/patients/${a.id}/active-bill?type=admission`);if(!$.ok)throw $.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const W=await $.json(),te=W==null?void 0:W.id;if(!te)throw new Error("Active admission bill ID not found in response.");f(te);const ne=await ue(`/api/bills/${te}`);if(!ne.ok)throw new Error(`Failed to fetch bill details (ID: ${te}). Status: ${ne.status}`);const re=await ne.json();if(re&&re.calculated)g(re.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",re),new Error("Fetched bill details are incomplete (missing calculated data).")}catch($){d($ instanceof Error?$.message:"An unknown error occurred while fetching bill details."),f(null),g(null)}finally{v(!1)}})()},[a]);const z=async()=>{if(!a){T("No patient selected.");return}if(!a.admission_date||a.discharge_date){T("Patient is not currently admitted.");return}T(null),C(!0);try{const O=await ue(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!O.ok){const W=await O.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(W.message||"Failed to discharge patient")}const $=await O.json();alert($.message||"Patient discharged successfully!"),$.patient?l($.patient):(console.error("Discharge successful, but updated patient info missing in response."),l(null),T("Discharge successful, but couldn't update patient details locally."))}catch(O){T(O instanceof Error?O.message:"Failed to discharge patient")}finally{C(!1)}},B=()=>{if(!a||!o){T("Cannot navigate to billing: Patient or Bill ID missing.");return}D(`/patient/${a.id}/admission-bill/${o}`)};let U="",R=null;if(a){const O=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,$=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(U=`Patient admitted on: ${O}`,R=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",u&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:u})," ",!b&&h&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(h.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(h.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(h.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:B,disabled:N||b||!o,className:`admission-button admission-button-secondary ${N||b||!o?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!o&&!u?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:z,disabled:N||b,className:`admission-button admission-button-danger ${N||b?"opacity-50 cursor-not-allowed":""}`,children:N?"Processing...":"Discharge Patient"})]})]})):(U=`Patient admitted on ${O} and discharged on ${$}.`,R=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(U="Patient is not admitted.",R=i.jsx("button",{onClick:F,disabled:N,className:`admission-button ${N?"opacity-50 cursor-not-allowed":""}`,children:N?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>D(-1),className:"back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:O=>n(O.target.value),placeholder:"Start typing to search...",className:"admission-input"}),N&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(O=>i.jsxs("li",{onClick:()=>V(O),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",O.name," (Token: ",O.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[O.admission_date?`Admitted: ${new Date(O.admission_date).toLocaleDateString()}`:"Not Admitted",O.discharge_date?`, Discharged: ${new Date(O.discharge_date).toLocaleDateString()}`:""]})]},O.id))]}),t.length===0&&e&&!N&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>l(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:U})," ",A&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:A})," ",R]})]})},ov=15,g1=()=>{const e=Mt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[l,o]=w.useState(null),[f,u]=w.useState(""),[d,h]=w.useState(1),[g,b]=w.useState(1),[v,N]=w.useState(0),[C,A]=w.useState("created_at"),[T,D]=w.useState("desc"),[M,V]=w.useState(""),[F,z]=w.useState(!1),[B,U]=w.useState(null),[R,O]=w.useState([]),[$,W]=w.useState(""),[te,ne]=w.useState(!1),[re,J]=w.useState(null),[q,H]=w.useState(null),[ee,E]=w.useState(!0),[Q,ie]=w.useState(null),[I,ce]=w.useState(f);w.useEffect(()=>{const we=setTimeout(()=>{ce(f),h(1)},500);return()=>{clearTimeout(we)}},[f]);const xe=w.useCallback(async()=>{E(!0),ie(null);try{const we=await ue("/api/subscriptions");if(!we.ok){let Xe=`Failed to fetch subscription plans (${we.status})`;try{Xe=(await we.json()).message||Xe}catch{}throw new Error(Xe)}const Fe=await we.json();O(Fe)}catch(we){console.error("Error fetching subscription plans:",we),ie(we.message||"An unknown error occurred while fetching plans."),O([])}finally{E(!1)}},[]),le=w.useCallback(async(we,Fe,Xe,it,je)=>{a(!0),o(null);try{const Ke=new URLSearchParams({page:we.toString(),limit:ov.toString(),sortBy:Xe,sortOrder:it});Fe&&Ke.append("search",Fe),je&&Ke.append("gender",je);const ze=await ue(`/api/patients?${Ke.toString()}`);if(!ze.ok){const Tt=await ze.json();throw new Error(Tt.message||"Failed to fetch patients")}const ct=await ze.json();t(ct.patients),N(ct.totalCount),h(ct.currentPage),b(ct.totalPages)}catch(Ke){console.error("Error fetching patients:",Ke),o(`Failed to load patients: ${Ke.message}`),t([]),N(0),h(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{le(d,I,C,T,M),xe()},[d,I,C,T,M,le,xe]);const ge=we=>{const Fe=C===we&&T==="asc"?"desc":"asc";A(we),D(Fe),h(1)},ye=we=>{try{return new Date(we).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},Re=()=>{z(!1),U(null),W(""),J(null),ne(!1)},Ze=async(we,Fe)=>{t(Xe=>Xe.map(it=>it.id===we?{...it,insurance_type:Fe}:it));try{const Xe=await ue(`/api/patients/${we}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Fe})});if(!Xe.ok){const it=await Xe.json();throw new Error(it.message||"Failed to update insurance type")}}catch(Xe){console.error("Error updating insurance type:",Xe),le(d,I,C,T,M)}},at=(we,Fe)=>{const Xe=new Date(we),it=Fe.interval||1;switch(Fe.period){case"daily":Xe.setDate(we.getDate()+it);break;case"weekly":Xe.setDate(we.getDate()+it*7);break;case"monthly":Xe.setMonth(we.getMonth()+it);break;case"yearly":Xe.setFullYear(we.getFullYear()+it);break;default:console.warn(`Unknown subscription period: ${Fe.period}. Defaulting to 1 month.`),Xe.setMonth(we.getMonth()+1)}return Xe},Le=async()=>{if(!B||!$){J("Please select a subscription plan.");return}const we=R.find(Fe=>Fe.id===$);if(!we){J("Selected plan details not found.");return}ne(!0),J(null);try{const Fe=new Date,Xe=at(Fe,we),it={subscription_plan_id:$,subscription_status:"active",subscription_start_date:Fe.toISOString(),subscription_end_date:Xe.toISOString(),subscription_payment_method:"manual"},je=await ue(`/api/patients/${B.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(it)});if(!je.ok){const Ke=await je.json();throw new Error(Ke.message||"Failed to update patient subscription")}Re(),le(d,I,C,T,M)}catch(Fe){console.error("Error starting subscription:",Fe),J(`Failed to start subscription: ${Fe.message}`)}finally{ne(!1)}},Te=async we=>{if(!q){H(we.id);try{const Fe=await ue(`/api/queue/patient/${we.id}/latest`);if(Fe.ok){const je=await Fe.json();if(je!=null&&je._id){e(`/dashboard/edit-complaint/${je._id}`,{state:{patientId:we.id}});return}}else if(Fe.status!==404){const je=await Fe.text();throw new Error(`Failed to fetch queue entry: ${je||Fe.statusText}`)}const Xe=await ue("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:we.id})});if(!Xe.ok){const je=await Xe.text();throw new Error(`Failed to create queue entry: ${je||Xe.statusText}`)}const it=await Xe.json();if(it!=null&&it.id)e(`/dashboard/edit-complaint/${it.id}`,{state:{patientId:we.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(Fe){console.error("Error processing patient selection:",Fe),alert(Fe.message||"An error occurred while processing the selection.")}finally{H(null)}}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(to,{size:28}),"All Registered Patients"]}),l&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:l})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:ee?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):Q?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",Q]}):R.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:R.map(we=>i.jsxs("li",{children:[i.jsx("strong",{children:we.name}),": ",we.price," / ",we.interval," ",we.period,we.interval>1?"s":"",we.description&&i.jsx("span",{className:"plan-description",children:we.description})]},we.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:f,onChange:we=>u(we.target.value)}),i.jsx(Ci,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(RC,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:M,onChange:we=>V(we.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:I?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>ge("name"),children:["Name",C==="name"&&(T==="asc"?i.jsx(Ho,{size:14,className:"sort-icon"}):i.jsx(iu,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>ge("created_at"),children:["Registered On",C==="created_at"&&(T==="asc"?i.jsx(Ho,{size:14,className:"sort-icon"}):i.jsx(iu,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(we=>i.jsxs("tr",{onClick:()=>Te(we),className:`patient-row ${q===we.id?"navigating":""}`,style:{cursor:"pointer",opacity:q===we.id?.7:1},children:[i.jsx("td",{children:we.token??"-"}),i.jsx("td",{className:"patient-name",children:we.name}),i.jsx("td",{children:we.age??"-"}),i.jsx("td",{children:we.gender??"-"}),i.jsx("td",{children:we.phone??"-"}),i.jsx("td",{children:we.address??"-"}),i.jsx("td",{children:ye(we.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${we.subscription_status==="active"?"active":we.subscription_status==="cancelled"||we.subscription_status==="expired"?"inactive":"none"}`,children:we.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:we.insurance_type,onChange:Fe=>Ze(we.id,Fe.target.value),onClick:Fe=>Fe.stopPropagation(),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:Fe=>{Fe.stopPropagation(),e(`/start-subscription/${we.id}`)},className:"action-button",children:"Start Sub"})})]},we.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(d-1)*ov+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(d*ov,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>h(we=>Math.max(we-1,1)),disabled:d===1||r,className:"pagination-button",children:[i.jsx(Cb,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:d})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>h(we=>Math.min(we+1,g)),disabled:d===g||r,className:"pagination-button",children:["Next",i.jsx(fg,{size:16,className:"next-icon"})]})]})]})]}),F&&B&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",B.name]}),i.jsx("button",{onClick:Re,className:"subscription-modal-close-button",children:i.jsx(gi,{size:24})})]}),re&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:re})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:$,onChange:we=>W(we.target.value),className:"form-select",disabled:te||ee||Q!==null||R.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),ee?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):Q?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):R.length>0?R.map(we=>i.jsxs("option",{value:we.id,children:[we.name," - ",we.price," (",we.interval," ",we.period,we.interval>1?"s":"",")"]},we.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),Q&&i.jsx("p",{className:"error-message",children:Q}),R.length===0&&!ee&&!Q&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:Re,disabled:te,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:Le,disabled:!$||te,className:"subscription-modal-button submit",children:te?"Starting...":"Start Subscription"})]})]})})]})},dk=()=>{const e=Mt(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,l]=w.useState([]),[o,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>Tb(async T=>{if(T.trim().length<2){l([]),f(!1),d(null);return}f(!0),d(null);try{const D=new URLSearchParams({search:encodeURIComponent(T),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),M=await ue(`/api/patients?${D.toString()}`);if(!M.ok){const F=await M.text();throw new Error(`API Error (${M.status}): ${F||M.statusText}`)}const V=await M.json();l(V.patients)}catch(D){console.error("Error searching patients:",D),d(D.message||"Failed to search patients."),l([])}finally{f(!1)}},300),[]),N=T=>{const D=T.target.value;r(D),g(b.test(D)),f(!0),v(D)},C=w.useCallback(T=>{e("/billing",{state:{patientId:T.id,patientName:T.name}})},[e]),A=w.useCallback(async()=>{if(!t||!h){d("Invalid phone number to create a new patient.");return}f(!0),d(null);try{const D=await ue("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!D.ok){const V=await D.json();throw new Error(V.message||`Failed to create patient: ${D.statusText}`)}const M=await D.json();alert(`New patient "direct pharmacy" created with phone ${M.phone}.`),C(M)}catch(T){console.error("Error creating new patient:",T),d(T.message||"Failed to create new patient.")}finally{f(!1)}},[t,h,C]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(an,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:N,className:"custom-text-input mt-1",autoFocus:!0}),o&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),u&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:u}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(T=>i.jsxs("li",{onClick:()=>C({id:T.id,name:T.name,token:T.token,age:T.age,gender:T.gender,phone:T.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",T.token]}),T.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[T.age?`${T.age} yrs`:"Age N/A",T.gender?` / ${T.gender}`:" / Gender N/A",T.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",T.phone]})]})]}),T.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",T.phone]})]},T.id))})}),t.length>=2&&!o&&a.length===0&&!u&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),h&&i.jsx("button",{type:"button",onClick:A,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:o,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!o&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},fk=({currentUser:e})=>{const n=Mt(),[t,r]=w.useState("select_patient"),[a,l]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[o,f]=w.useState(null),[u,d]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState(""),[N,C]=w.useState([]),[A,T]=w.useState(""),[D,M]=w.useState([]),[V,F]=w.useState(!1),[z,B]=w.useState(null),[U,R]=w.useState(null),[O,$]=w.useState(null),[W,te]=w.useState(!1),[ne,re]=w.useState(!1),[J,q]=w.useState(!1),H=/^\+?[0-9\s\-().]{7,20}$/,ee=/^[a-zA-Z\s'-]{2,}$/,E=w.useCallback(async()=>{if(!(u.length>0)){te(!0),$(null);try{const Te=await ue("/api/lab-tests");if(!Te.ok)throw new Error("Failed to fetch lab tests");const we=await Te.json();d(we)}catch(Te){console.error("Failed to fetch available lab tests:",Te),$("Could not load lab test list: "+Te.message),d([])}finally{te(!1)}}},[u.length]);w.useEffect(()=>{if(!b){C([]);return}const Te=b.toLowerCase();C(u.filter(we=>we.name.toLowerCase().includes(Te)||we.description&&we.description.toLowerCase().includes(Te)).slice(0,10))},[b,u]);const Q=w.useCallback(Te=>{const we={id:Te.id,name:Te.name,token:Te.token,age:Te.age,gender:Te.gender,phone:Te.phone};f(we),r("create_order"),g([]),v(""),C([]),$(null),E()},[E]),ie=w.useMemo(()=>Tb(async Te=>{if(Te.trim().length<2){M([]),F(!1),B(null);return}F(!0),B(null);try{const we=new URLSearchParams({search:encodeURIComponent(Te),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Fe=await ue(`/api/patients?${we.toString()}`);if(!Fe.ok){const it=await Fe.text();throw new Error(`API Error (${Fe.status}): ${it||Fe.statusText}`)}const Xe=await Fe.json();M(Xe.patients)}catch(we){console.error("Error searching lab patients:",we),B(we.message||"Failed to search lab patients."),M([])}finally{F(!1)}},300),[H,ee]),I=Te=>{const we=Te.target.value;T(we),re(H.test(we)),q(ee.test(we)&&!H.test(we)),F(!0),ie(we)},ce=w.useCallback(async Te=>{if(!A||Te==="phone"&&!ne||Te==="name"&&!J){B(`Invalid ${Te} to create a new patient.`);return}F(!0),B(null);try{const Xe=await(await ue("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Te==="name"?A:"direct lab",phone:Te==="phone"?A:null,age:null,gender:null,token:null})})).json();alert(`New patient "${Xe.name}" created with ${Te==="phone"?`phone ${Xe.phone}`:`name ${Xe.name}`}.`),Q({id:Xe.id,name:Xe.name,token:Xe.token??null,age:Xe.age??null,gender:Xe.gender??null,phone:Xe.phone})}catch(we){console.error("Error creating new patient:",we);const Fe=we.message||"";if(Fe.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:Fe}});return}B(Fe||"Failed to create new patient.")}finally{F(!1)}},[A,ne,J,Q]),xe=()=>{l({name:"",age:void 0,gender:null,phone:"",address:""}),R(null),r("create_patient"),f(null)},le=()=>{r("select_patient"),f(null),T(""),M([]),B(null)},ge=Te=>{const{name:we,value:Fe}=Te.target;l(Xe=>({...Xe,[we]:we==="age"?Fe?parseInt(Fe,10):void 0:Fe}))},ye=async Te=>{if(Te.preventDefault(),R(null),!a.name){R("Patient Name is required.");return}const we={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const Xe=await(await ue("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(we)})).json();Q({id:Xe.id,name:Xe.name,token:Xe.token??null,age:Xe.age??null,gender:Xe.gender??null,phone:Xe.phone})}catch(Fe){console.error("Failed to create patient:",Fe);const Xe=Fe.message||"";if(Xe.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:Xe}});return}R(Xe||"Failed to create patient. Please try again.")}},Re=Te=>{if(h.some(we=>we.id===Te.id)){$(`${Te.name} is already in the order.`),setTimeout(()=>$(null),3e3),v(""),C([]);return}g(we=>[...we,{...Te}]),v(""),C([])},Ze=Te=>{g(we=>we.filter(Fe=>Fe.id!==Te))},at=async Te=>{if(Te.preventDefault(),$(null),!o){$("No patient selected.");return}if(h.length===0){$("No lab tests selected.");return}const we={patient_id:o.id,tests:h.map(Fe=>({id:Fe.id,name:Fe.name,price:Fe.price}))};try{const Fe=await ue("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(we)});if(!Fe.ok){const it=await Fe.json();throw new Error(it.message||`Failed to create lab order: ${Fe.statusText}`)}await Fe.json();let Xe=o.queueId;if(!Xe){const it=await ue(`/api/queue/patient/${o.id}/latest`);if(it.ok){const je=await it.json();je!=null&&je._id&&(Xe=je._id)}}if(!Xe){const it=await ue("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:o.id})});if(!it.ok){const Ke=await it.text();throw new Error(`Failed to create queue entry for redirection: ${Ke||it.statusText}`)}const je=await it.json();je!=null&&je.id&&(Xe=je.id)}alert(`Lab order created successfully for ${o.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${Xe}`,{state:{patientId:o.id}})}catch(Fe){console.error("Failed to create lab order:",Fe),$(Fe.message||"Failed to create lab order.")}};w.useEffect(()=>{E()},[E]);const Le=()=>h.reduce((Te,we)=>Te+parseFloat(we.price),0).toFixed(2);return i.jsxs("div",{className:"create-lab-order-page",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:i.jsx(an,{size:20})}),i.jsx("h1",{children:"Create New Lab Order"}),i.jsx("div",{className:"w-10"})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"patient-selection-container",children:[t==="select_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",style:{justifyContent:"center"},children:"Select Patient"}),i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Ci,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token, or Phone...",value:A,onChange:I,className:"custom-text-input",autoFocus:!0})]}),V&&i.jsx("div",{className:"loading-text",style:{marginTop:"1rem"},children:"detail..."}),z&&i.jsx("div",{className:"error-text",children:z}),D.length>0&&i.jsx("div",{className:"search-results-dropdown",style:{position:"relative",boxShadow:"none",borderTop:"none",maxHeight:"40vh"},children:D.map(Te=>i.jsxs("div",{onClick:()=>Q(Te),className:"search-result-item",children:[i.jsxs("div",{children:[Te.token&&i.jsxs("span",{className:"token-badge",children:["#",Te.token]}),i.jsx("span",{style:{fontWeight:500},children:Te.name})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"var(--text-secondary)"},children:[Te.age?`${Te.age}y`:"",Te.gender?` / ${Te.gender}`:"",Te.phone?` / ${Te.phone}`:""]})]},Te.id))}),A.length>=2&&!V&&D.length===0&&!z&&i.jsxs("div",{style:{marginTop:"1.5rem"},children:[i.jsxs("p",{className:"no-data",children:['No patients found matching "',A,'".']}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginTop:"10px"},children:[ne&&i.jsxs("button",{type:"button",onClick:()=>ce("phone"),className:"btn-primary",children:["Create Patient with Phone ",A]}),J&&i.jsxs("button",{type:"button",onClick:()=>ce("name"),className:"btn-primary",children:['Create Patient with Name "',A,'"']})]})]}),i.jsx("div",{className:"or-divider",children:"OR"}),i.jsxs("button",{onClick:xe,className:"btn-secondary",style:{width:"100%"},children:[i.jsx(eo,{size:18,style:{marginRight:"8px",verticalAlign:"text-bottom"}}),"Register New Patient manually"]})]}),t==="create_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",style:{justifyContent:"space-between"},children:[i.jsx("span",{children:"Register New Patient"}),i.jsx("button",{onClick:le,className:"action-link-btn",children:"Back to Search"})]}),U&&i.jsx("div",{className:"error-text",children:U}),i.jsxs("form",{onSubmit:ye,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-name",children:"Name *"}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:ge,className:"form-input",placeholder:"Patient Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:ge,className:"form-input",placeholder:"Age"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:ge,className:"form-select",children:[i.jsx("option",{value:"",children:"Select..."})," ",i.jsx("option",{value:"M",children:"Male"})," ",i.jsx("option",{value:"F",children:"Female"})," ",i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-phone",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:ge,className:"form-input",placeholder:"Phone Number"})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-address",children:"Address"}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:ge,className:"form-textarea",placeholder:"Address (Optional)"})]})]}),i.jsxs("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[i.jsx("button",{type:"button",onClick:le,className:"btn-secondary",children:" Cancel "}),i.jsx("button",{type:"submit",className:"btn-primary",children:" Create & Proceed "})]})]})]})]}),t==="create_order"&&o&&i.jsxs("div",{className:"lab-order-grid",children:[i.jsx("div",{className:"left-column",children:i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",children:"Add Lab Tests"}),i.jsxs("div",{className:"search-input-wrapper",style:{marginBottom:"1.5rem"},children:[i.jsx(Ci,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search available lab tests...",value:b,onChange:Te=>v(Te.target.value),className:"custom-text-input",disabled:W,autoFocus:!0}),W&&i.jsx("span",{style:{position:"absolute",right:"15px",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Loading..."}),b&&N.length>0&&i.jsx("div",{className:"search-results-dropdown",children:N.map(Te=>i.jsxs("div",{onClick:()=>Re(Te),className:"search-result-item",children:[i.jsx("span",{children:Te.name}),i.jsxs("span",{style:{fontWeight:600,color:"var(--primary-color)"},children:["",parseFloat(Te.price).toFixed(2)]})]},Te.id))}),b&&N.length===0&&!W&&i.jsx("div",{className:"search-results-dropdown",style:{padding:"1rem",color:"var(--text-secondary)",textAlign:"center"},children:"No tests found."})]}),O&&i.jsxs("div",{className:"error-text",style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(ni,{size:18})," ",O]}),i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Test Name"}),i.jsx("th",{style:{width:"100px",textAlign:"right"},children:"Price"}),i.jsx("th",{style:{width:"60px",textAlign:"center"},children:"Action"})]})}),i.jsx("tbody",{children:h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"no-data",children:"No tests added yet. Search above to add."})}):h.map(Te=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("span",{style:{fontWeight:500},children:Te.name})}),i.jsxs("td",{style:{textAlign:"right",fontWeight:600},children:["",parseFloat(Te.price).toFixed(2)]}),i.jsx("td",{style:{textAlign:"center"},children:i.jsx("button",{type:"button",onClick:()=>Ze(Te.id),className:"delete-btn",title:"Remove",children:i.jsx(Pi,{size:16})})})]},Te.id))})]})})]})}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"patient-card",children:[i.jsx("div",{className:"patient-avatar",children:i.jsx(to,{size:32})}),i.jsx("h3",{className:"patient-name",children:o.name}),i.jsxs("div",{className:"patient-info-text",children:[o.age?`${o.age} yrs`:"",o.gender?`  ${o.gender}`:""]}),o.phone&&i.jsx("div",{className:"patient-info-text",style:{marginTop:"4px"},children:o.phone}),i.jsx("button",{onClick:le,className:"change-patient-btn",children:"Change Patient"})]}),i.jsxs("div",{className:"order-summary-container",children:[i.jsx("h3",{className:"section-title",style:{marginBottom:"1rem"},children:"Order Summary"}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Tests"}),i.jsx("span",{children:h.length})]}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Total Amount"}),i.jsxs("span",{className:"total-value",children:["",Le()]})]}),i.jsx("button",{onClick:at,disabled:h.length===0,className:"create-order-btn",children:"Confirm Order"}),i.jsx("button",{type:"button",onClick:()=>n(-1),className:"btn-secondary",style:{width:"100%",marginTop:"1rem",border:"none",color:"var(--text-secondary)"},children:"Cancel"})]})]})]})]})},pU=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[l,o]=w.useState([]),[f,u]=w.useState(!0),[d,h]=w.useState([]),[g,b]=w.useState(!1),[v,N]=w.useState(null),[C,A]=w.useState(null),T=Mt(),D=async()=>{u(!0),A(null);let R=[];try{const O=await ue("/api/queue");if(!O.ok){const te=await O.json();throw new Error(te.message||"Failed to fetch queue")}R=await O.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(R,null,2));const $=R.map(async te=>{if(!te.patient_id)return console.warn(`Queue entry ${te.id} has no patient_id.`),te;try{const ne=await ue(`/api/patients/${te.patient_id}`);if(!ne.ok)return console.error(`Failed to fetch patient details for ${te.patient_id}: ${ne.status}`),te;const re=await ne.json();return{...te,Patient:{...te.Patient??{},...re}}}catch(ne){return console.error(`Error fetching patient details for ${te.patient_id}:`,ne),te}}),W=await Promise.all($);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(W,null,2)),W.sort((te,ne)=>{var ee,E;const re=((ee=te.Patient)==null?void 0:ee.subscription_status)==="active",J=((E=ne.Patient)==null?void 0:E.subscription_status)==="active";if(re&&!J)return-1;if(!re&&J)return 1;const q=te.created_at?new Date(te.created_at).getTime():0,H=ne.created_at?new Date(ne.created_at).getTime():0;return q-H}),console.log("Sorted Queue Data:",JSON.stringify(W,null,2)),o(W)}catch(O){console.error("Error in fetchQueue process:",O),A(`Failed to load queue: ${O.message}`),o(R)}finally{u(!1)}},M=async()=>{b(!0),A(null);try{const R=await ue("/api/staff?role=doctor");if(!R.ok){const $=await R.json();throw new Error($.message||"Failed to fetch doctors")}const O=await R.json();h(O.filter($=>$.active))}catch(R){console.error("Error fetching doctors:",R),A(`Failed to fetch doctors: ${R.message}`)}finally{b(!1)}};w.useEffect(()=>{n==="queue"&&(D(),M()),N(null)},[n]);const V=w.useCallback(async(R,O)=>{if(console.log(`Attempting to assign doctor ${O} to queue ${R}`),A(null),N(null),!O){console.log("No doctor ID provided, skipping assignment.");return}const $=l.find(ne=>ne.id===R);if(!$){console.error(`Queue entry ${R} not found in local state.`),A("Queue entry not found.");return}if($.doctor_id===O){console.log(`Queue ${R} already assigned to doctor ${O}. Skipping.`);return}const W=async ne=>{if(!ne||!ne.id||!ne.name){A("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",ne);return}const re=async()=>{try{const J={status:"waiting",doctorId:O},q=await ue(`/api/queue/${R}/status`,{method:"PATCH",body:JSON.stringify(J)}),H=await q.json();if(!q.ok)throw new Error(H.message||`HTTP error! status: ${q.status}`);const ee=d.find(E=>E.id===O);return console.log(`Successfully assigned doctor ${ee==null?void 0:ee.name} to queue ${R}.`),o(E=>E.map(Q=>Q.id===R?{...Q,doctor_id:O,status:H.status||Q.status,User:ee?{name:ee.name}:null,Patient:ne}:Q)),!0}catch(J){return console.error(`Error assigning doctor for queue ${R}:`,J),A(`Failed to assign doctor: ${J.message}`),!1}};ne.subscription_status==="active"?(console.log(`Patient ${ne.name} (ID: ${ne.id}) has active subscription. Assigning doctor directly.`),await re()):(console.log(`Patient ${ne.name} (ID: ${ne.id}) does not have active subscription (Status: ${ne.subscription_status}). Navigating to billing first.`),console.log(`Navigating to billing for patient ${ne.name} (ID: ${ne.id}), queue ID: ${R}, doctor ID: ${O}`),T("/billing",{state:{patientId:ne.id,queueId:R,patientName:ne.name,doctorId:O,billType:"consultation",finalizeQueueAssignment:!0}}))},te=$.Patient;if(te&&te.id&&te.name)console.log("Patient details found in state. Proceeding with assignment."),await W(te);else{console.warn(`Patient details missing for queue entry ${R}. Fetching patient ${$.patient_id}...`);try{const ne=await ue(`/api/patients/${$.patient_id}`);if(!ne.ok){const J=await ne.json().catch(()=>({}));throw new Error(J.message||`Failed to fetch patient details (status ${ne.status})`)}const re=await ne.json();console.log("Successfully fetched patient details:",re),await W(re)}catch(ne){console.error(`Failed to fetch patient details for patient ID ${$.patient_id}:`,ne),A(`Failed to fetch required patient details: ${ne.message}`)}}},[d,l,T]),F=async(R,O)=>{A(null);const $=O==="consulting"?"start consultation":"complete visit";try{const W=l.find(J=>J.id===R);if(!W&&O==="consulting")throw new Error("Queue entry not found to start consultation.");let te={status:O};if(O==="consulting"){if(!(W!=null&&W.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");te.doctorId=W.doctor_id}const ne=await ue(`/api/queue/${R}/status`,{method:"PATCH",body:JSON.stringify(te)}),re=await ne.json();if(!ne.ok)throw new Error(re.message||`HTTP error! status: ${ne.status}`);o(J=>J.map(q=>q.id===R?{...q,status:O}:q))}catch(W){console.error(`Error trying to ${$}:`,W),A(`Failed to ${$}: ${W.message}`)}},z=[{id:"queue",label:"Queue",icon:i.jsx(cu,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(Ci,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(jD,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(vM,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(MC,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(Yo,{size:20})}],B=R=>{try{return new Date(R).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},U=l.filter(R=>{var O,$;return($=(O=R.Patient)==null?void 0:O.name)==null?void 0:$.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[C&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:C})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",z.map(R=>i.jsxs("button",{className:`reception-tab-button ${n===R.id?"active":""}`,onClick:()=>t(R.id),children:[i.jsx("span",{children:R.icon}),R.label]},R.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:R=>a(R.target.value)}),i.jsx(Ci,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:l.filter(R=>R.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:l.filter(R=>R.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:l.filter(R=>R.status==="seen").length})," "]})]})]}),f?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):U.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:U.map(R=>{var O,$,W,te,ne,re,J,q,H,ee,E;return i.jsxs("tr",{onClick:()=>T(`/dashboard/edit-complaint/${R.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",R.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:((O=R.Patient)==null?void 0:O.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[($=R.Patient)!=null&&$.age?`${R.Patient.age} yrs, `:"",((W=R.Patient)==null?void 0:W.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((te=R.Patient)==null?void 0:te.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:R.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((ne=R.Patient)==null?void 0:ne.subscription_status)==="active"?"status-active":((re=R.Patient)==null?void 0:re.subscription_status)==="cancelled"||((J=R.Patient)==null?void 0:J.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((q=R.Patient)==null?void 0:q.subscription_status)??"None"}),R.Patient&&R.Patient.id&&R.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:Q=>{Q.stopPropagation(),R.Patient&&T(`/start-subscription/${R.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:B(R.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===R.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:Q=>Q.stopPropagation(),children:i.jsxs("select",{value:"",onChange:Q=>V(R.id,Q.target.value),onBlur:()=>N(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):d.length>0?d.map(Q=>i.jsx("option",{value:Q.id,children:Q.name},Q.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:Q=>Q.stopPropagation(),children:[" ",R.status==="waiting"&&i.jsx(i.Fragment,{children:(H=R.User)!=null&&H.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:R.User.name}),i.jsx("button",{onClick:()=>F(R.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):d.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):d.length===1?i.jsxs("button",{onClick:()=>V(R.id,d[0].id),className:"action-button btn-assign",children:["Assign ",d[0].name]}):i.jsx("button",{onClick:()=>N(R.id),className:"action-button btn-assign",children:"Assign"})}),R.status==="consulting"&&i.jsxs(i.Fragment,{children:[((ee=R.User)==null?void 0:ee.name)&&i.jsx("span",{className:"doctor-name-display",children:R.User.name}),i.jsx("button",{onClick:()=>F(R.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),R.status==="seen"&&i.jsxs(i.Fragment,{children:[((E=R.User)==null?void 0:E.name)&&i.jsx("span",{className:"doctor-name-display",children:R.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),R.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},R.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(fk,{currentUser:e}),i.jsxs("button",{onClick:()=>T("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(Ci,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(Mh,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(uk,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(g1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(dk,{})})]})})},mU=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([l,o])=>{var h;const f=(h=r.default_parameters)==null?void 0:h.find(g=>g.name===l);let u=String(o),d="";if(f){const g=f.unit?` _${f.unit}_`:"";if(f.type==="boolean"){const b=o===!0||o==="true";u=b?"*Reactive*":"Non-Reactive",b||(d="`Normal: Non-Reactive`")}else if(f.type==="number"){const b=typeof o=="string"?parseFloat(o):typeof o=="number"?o:NaN;if(f.lower_limit!=null||f.upper_limit!=null){let v=[];f.lower_limit!=null&&v.push(`${f.lower_limit}`),f.upper_limit!=null&&v.push(`${f.upper_limit}`),d=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(f.lower_limit!=null&&b<f.lower_limit||f.upper_limit!=null&&b>f.upper_limit)&&(u=`*${u}*`)}}f.unit&&(u+=g)}n+=`${l}: ${u}
`,d&&((f==null?void 0:f.type)==="boolean"&&(o===!0||o==="true")||(n+=`${d}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},ww=e=>{var o;if(!((o=e==null?void 0:e.Patient)!=null&&o.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=mU(e),r=`Hello ${n},

Your lab report is ready.

${t}`,l=`https://wa.me/${gU(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(l,"_blank")},gU=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},yU=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState("orders"),[h,g]=w.useState(1),[b]=w.useState(20),[v,N]=w.useState(0),C=w.useMemo(()=>Math.ceil(v/b),[v,b]),A=w.useCallback(async(U=1,R="")=>{l(!0),f(null);try{const O=new URLSearchParams({page:String(U),limit:String(b)});R&&O.append("search",R);const $=await ue(`/api/lab?${O.toString()}`);if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const W=await $.json(),te=W.orders.map(ne=>{var re,J;return{id:ne.id,labTokenNumber:String(ne.lab_token_number??"N/A"),patientName:((re=ne.Patient)==null?void 0:re.name)||"N/A",patientId:ne.patient_id,patientTokenNumber:String(((J=ne.Patient)==null?void 0:J.patient_token_number)??"N/A"),tests:(ne.tests||[]).map(q=>q.name||"Unknown Test"),date:Bh(new Date(ne.createdAt),"yyyy-MM-dd"),status:ne.status,reportId:ne.reportId,billId:ne.billId}});n(te),N(W.totalCount),g(U)}catch(O){console.error("Failed to fetch lab orders:",O),f(O instanceof Error?O.message:"An unknown error occurred"),n([]),N(0)}finally{l(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${h}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),A(h,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[A,h,t]),w.useEffect(()=>{const U=setTimeout(()=>{t.length>=2?h!==1&&g(1):t.length<2&&h!==1&&g(1)},1e3);return()=>{clearTimeout(U)}},[t]);const T=async(U,R)=>{console.log(`Updating order ${U} to status ${R}`);try{const O=await ue(`/api/lab/${U}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:R})});if(!O.ok){const $=await O.json();throw new Error($.message||`Failed to update status: ${O.status}`)}if(R==="completed"){const $=await ue(`/api/lab/orders/${U}/report`);if($.ok){const W=await $.json();ww(W)}}await A(h,t),console.log(`Order ${U} status updated to ${R}, refetching page ${h}`)}catch(O){console.error("Error updating status:",O),alert(`Failed to update status: ${O instanceof Error?O.message:"Unknown error"}`)}},D=Mt(),M=U=>{if(!U){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}U.billId?(console.log(`Navigating to existing bill for Bill ID: ${U.billId}, Patient: ${U.patientName}`),D("/billing",{state:{billId:U.billId,patientId:U.patientId,patientName:U.patientName,billType:"lab"}})):(console.log(`Navigating to create new bill for Lab Order ID: ${U.id}, Patient: ${U.patientName}`),D("/lab-billing",{state:{labOrderId:U.id}}))},V=U=>{U&&U.id?D(`/lab/report/${U.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},F=U=>{switch(U){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:U,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(o)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(ni,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:o}),i.jsx("button",{onClick:()=>A(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const z=()=>{h>1&&g(U=>U-1)},B=()=>{h<C&&g(U=>U+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>D(-1),className:"back-button mr-4",children:i.jsx(an,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>d("orders"),className:`lab-inventory-button ${u==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(LC,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>D("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>d("inventory"),className:`lab-inventory-button ${u==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(rw,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),u==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:U=>r(U.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(Ci,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!o&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!o&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!o&&e.map(U=>{const R=F(U.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:U.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",U.patientTokenNumber]})]}),i.jsx("td",{children:U.tests.map((O,$)=>i.jsx("div",{children:O},$))}),i.jsx("td",{className:"hidden md:table-cell",children:U.date}),i.jsx("td",{children:i.jsx("span",{className:R.className,children:R.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[U.status==="pending"&&i.jsx("button",{onClick:()=>M(U),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),U.status==="billed"&&i.jsx("button",{onClick:()=>T(U.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),U.status==="collected"&&i.jsx("button",{onClick:()=>T(U.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(U.status==="processing"||U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>V(U),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>T(U.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(U.status==="completed"||U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>{U.id?D(`/lab/view-report/${U.id}`):(console.error("Attempted to view report for an order with no ID:",U),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},U.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!o&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!o&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!o&&e.map(U=>{const R=F(U.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:U.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",U.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:U.date})]}),i.jsx("span",{className:`${R.className} lab-card-status-pill`,children:R.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),U.tests.map((O,$)=>i.jsx("div",{className:"lab-card-test-item",children:O},$)),U.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[U.status==="pending"&&i.jsx("button",{onClick:()=>M(U),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),U.status==="billed"&&i.jsx("button",{onClick:()=>T(U.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),U.status==="collected"&&i.jsx("button",{onClick:()=>T(U.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(U.status==="processing"||U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>V(U),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>T(U.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(U.status==="completed"||U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>{U.id?D(`/lab/view-report/${U.id}`):(console.error("Attempted to view report for an order with no ID:",U),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},U.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(h-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(h*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:z,disabled:h===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(Cb,{size:18})}),i.jsxs("span",{children:["Page ",h," of ",C]}),i.jsx("button",{onClick:B,disabled:h===C,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(fg,{size:18})})]})]})]}),u==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(aw,{})]})]})]})},xU=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,l]=w.useState(!0),[o,f]=w.useState(null),u=Mt(),d=w.useRef(null),[h,g]=w.useState(1),[b,v]=w.useState(1),[N,C]=w.useState(0),A=10,T=w.useCallback(async(B,U,R)=>{l(!0),f(null);try{let O=`/api/pharmacy-orders?page=${B}&limit=${U}`;R&&R.trim()!==""&&(O+=`&search=${encodeURIComponent(R.trim())}`);const $=await ue(O);if(!$.ok)throw new Error(`Failed to fetch orders: ${$.statusText} (${$.status})`);const W=await $.json();if(W&&Array.isArray(W.orders)&&typeof W.totalOrders=="number"&&typeof W.totalPages=="number")console.log("Fetched pharmacy orders data:",W.orders),n(W.orders),C(W.totalOrders),v(W.totalPages),g(W.currentPage||B);else throw console.error("Received data does not match expected paginated structure:",W),new Error("Invalid data format received from API")}catch(O){console.error("Failed to fetch pharmacy orders:",O),f(O.message||"Failed to fetch orders. Please try again."),n([]),v(1),C(0)}finally{l(!1)}},[]);w.useEffect(()=>(d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{const B=t===""?h:1;t!==""&&h!==1&&g(1),T(B,A,t)},500),()=>{d.current&&clearTimeout(d.current)}),[t,h,T,A]);const D=B=>{u(`/dashboard/edit-pharmacy-order/${B}`)},M=B=>{f(null),console.log(`Preparing billing navigation for order: ${B}`);const U=e.find(R=>R.id===B);if(U){const R=U.medications.map(O=>{const $=O.price??0;return(O.price===void 0||O.price===null)&&console.warn(`Medication "${O.name}" in order ${B} is missing a price. Defaulting to 0.`),{name:O.name,pack_quantity:O.pack_quantity,loose_quantity:O.loose_quantity,price:$,pack_price:O.pack_price,loose_price:O.loose_price,total_price:O.total_price,isLoose:O.isLoose,unit:O.unit,drug_id:O.drug_id?String(O.drug_id):null,tabletsPerDay:O.tabletsPerDay,numberOfDays:O.numberOfDays,directions_to_use:O.directions_to_use,discount_percentage:0,batch:O.batch,expiry_date:O.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:R}),u(`/dashboard/pharmacy-billing/${B}`,{state:{initialItems:R}})}else console.error(`Order with ID ${B} not found.`),f(`Order with ID ${B} not found.`),alert(`Error: Could not find order ${B} to bill.`)},V=async(B,U)=>{f(null);const R=e.find($=>$.id===B);if(!R){f(`Order with ID ${B} not found.`);return}const O={status:U,medications:R.medications};try{const $=await ue(`/api/pharmacy-orders/${B}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)});if(!$.ok){const te=await $.text();throw new Error(`Failed to update status: ${$.statusText} (${$.status}) - ${te}`)}const W=await $.json();n(te=>te.map(ne=>ne.id===W.id?{...ne,status:W.status}:ne))}catch($){console.error("Failed to update order status:",$),f($.message||`Failed to update status for order ${B}.`),alert(`Error updating status for order ${B}: ${$.message||"Please try again."}`)}},F=B=>{switch(B){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},z=B=>{u(`/dashboard/orders/${B.id}`)};return a&&e.length===0&&!o?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):o&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",o]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>u("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(Yo,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>u("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx(Ko,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>u("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(Gv,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>u("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx(Ko,{size:16}),"Distributors"]}),i.jsxs("button",{onClick:()=>u("/dashboard/recurring-medications"),className:"pharmacy-action-button btn-refill-reminders",title:"View Recurring Medications",children:[i.jsx(TD,{size:16}),"Recurring Meds"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:B=>r(B.target.value),className:"pharmacy-search-input"}),i.jsx(Ci,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[o&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",o]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!o&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(B=>i.jsxs("tr",{onClick:()=>z(B),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:B.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:B.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[B.medications.map((U,R)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[U.name," (Packs: ",U.pack_quantity,", Loose: ",U.loose_quantity,", ",U.tabletsPerDay??"N/A","x",U.numberOfDays??"N/A","d)",U.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",U.box_number,")"]})]}),U.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",U.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[U.pack_price!==void 0&&`Pack Price: ${Number(U.pack_price).toFixed(2)}`,U.loose_price!==void 0&&` | Loose Price: ${Number(U.loose_price).toFixed(2)}`,U.total_price!==void 0&&` | Item Total: ${Number(U.total_price).toFixed(2)}`]})]},R)),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(B.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(B.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:F(B.status),children:B.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:U=>{U.stopPropagation(),D(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(du,{size:14})," Edit"]}),i.jsxs("button",{onClick:U=>{U.stopPropagation(),M(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Bd,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:U=>{U.stopPropagation(),V(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ta,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:U=>{U.stopPropagation(),V(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:U=>{U.stopPropagation(),z(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},B.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(B=>{const U=F(B.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>z(B),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:B.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:["Token: ",B.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(B.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:U,children:B.status}),B.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(B.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[B.medications.slice(0,2).map((R,O)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${R.name} (Packs: ${R.pack_quantity}, Loose: ${R.loose_quantity}, ${R.tabletsPerDay??"N/A"}x${R.numberOfDays??"N/A"}d)`,children:[R.name," (Packs: ",R.pack_quantity,", Loose: ",R.loose_quantity,", ",R.tabletsPerDay??"N/A","x",R.numberOfDays??"N/A","d)",R.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",R.box_number,")"]})]}),R.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${R.directions_to_use}`,children:["Directions: ",R.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[R.pack_price!==void 0&&`Pack Price: ${Number(R.pack_price).toFixed(2)}`,R.loose_price!==void 0&&` | Loose Price: ${Number(R.loose_price).toFixed(2)}`,R.total_price!==void 0&&` | Item Total: ${Number(R.total_price).toFixed(2)}`]})]},O)),B.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",B.medications.length-2," more"]}),B.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:R=>{R.stopPropagation(),D(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(du,{size:14})," Edit"]}),i.jsxs("button",{onClick:R=>{R.stopPropagation(),M(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Bd,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:R=>{R.stopPropagation(),V(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ta,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:R=>{R.stopPropagation(),V(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:R=>{R.stopPropagation(),z(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},B.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(h-1)*A+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(h*A,N)})," ","of ",i.jsx("span",{className:"font-medium",children:N})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(Cb,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",h," of ",b]}),i.jsxs("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(fg,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},bU=()=>{const e=Mt();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},vU=()=>{const{id:e}=qr(),n=Mt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),N=w.useRef(null),C=w.useCallback(async()=>{if(!e){f("Drug ID is missing."),l(!1);return}l(!0),f(null);try{const M=await ue(`/api/drugs/${e}`);if(!M.ok){const F=await M.json();throw new Error(F.message||`Failed to fetch drug: ${M.statusText}`)}let V=await M.json();V={...V,name:V.name||"",brand_name:V.brand_name||"",price:parseFloat(String(V.price))||0,buying_price:V.buying_price!==null&&V.buying_price!==void 0?parseFloat(String(V.buying_price)):null,quantity_in_stock:parseInt(String(V.quantity_in_stock),10)||0,gst:V.gst!==null&&V.gst!==void 0?parseFloat(String(V.gst)):null,margin:V.margin!==null&&V.margin!==void 0?parseFloat(String(V.margin)):null,discount:V.discount!==null&&V.discount!==void 0?parseFloat(String(V.discount)):null,batch:V.batch||"",hsn_code:V.hsn_code||"",mfg:V.mfg||"",loose:V.loose!==null&&V.loose!==void 0?parseInt(String(V.loose),10):null},r(V)}catch(M){console.error("Failed to fetch drug:",M),f(M.message||"Failed to load drug data. Please try again.")}finally{l(!1)}},[e]);w.useEffect(()=>{C()},[C]),w.useEffect(()=>{const M=F=>{F.key==="Tab"&&v.current===document.activeElement&&(h||(g(!0),setTimeout(()=>{var z;(z=N.current)==null||z.focus()},0),F.preventDefault()))},V=F=>{b.current&&!b.current.contains(F.target)&&g(!1)};return document.addEventListener("keydown",M),document.addEventListener("mousedown",V),()=>{document.removeEventListener("keydown",M),document.removeEventListener("mousedown",V)}},[h]);const A=M=>{const{name:V,value:F,type:z}=M.target;r(B=>B?{...B,[V]:z==="number"?parseFloat(F)||null:F}:null)},T=()=>{n(-1)},D=async M=>{if(M.preventDefault(),f(null),d(!0),!t||!t.id){f("Cannot edit drug: No drug data available."),d(!1);return}if(t.price===void 0||t.quantity_in_stock===void 0){f("Price and Stock Quantity are required."),d(!1);return}const V={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,buying_price:t.buying_price===0?null:t.buying_price,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const F=await ue(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});if(!F.ok){const B=await F.json();throw new Error(B.message||`Failed to update drug: ${F.statusText}`)}const z=await F.json();alert(`Drug "${z.name}" updated successfully!`),n(-1)}catch(F){console.error("Failed to update drug:",F),f(F.message||"Failed to update drug. Please try again.")}finally{d(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):o&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",o]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:T,className:"cancel-button",title:"Go Back",children:i.jsx(gi,{size:24})})]}),o&&i.jsx("div",{className:"error-message-submit",children:o}),i.jsxs("form",{onSubmit:D,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ks,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:A,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ks,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:A,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ks,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"edit-price",required:!0,step:"0.01",min:"0",value:t.price,onChange:A,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ks,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"edit-quantity_in_stock",required:!0,step:"1",min:"0",value:t.quantity_in_stock,onChange:A,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"edit-unit",value:t.unit||"",onChange:A,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:A,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:A,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!h),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),h&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:A,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:A,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"edit-buying_price",step:"0.01",min:"0",value:t.buying_price??"",onChange:A,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:N})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:A,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:A,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:A,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:A,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:A,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:A,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:A,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:T,disabled:u,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:u,className:"form-button submit-form-button",tabIndex:20,children:u?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},y1=()=>{const e=Mt(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState([]),[v,N]=w.useState(null),[C,A]=w.useState(!1),[T,D]=w.useState([]),[M,V]=w.useState(!0);w.useEffect(()=>{(async()=>{V(!0);try{const $=await ue("/api/staff?role=doctor");if(!$.ok)throw new Error("Failed to fetch doctors");const W=await $.json();D(W),W.length>0&&t(te=>({...te,doctorId:""}))}catch($){console.error("Error fetching doctors:",$),o(`Failed to load doctors: ${$.message}`)}finally{V(!1)}})()},[]);const F=w.useCallback(async()=>{if(d.trim()){A(!0),o(null),b([]);try{const O=encodeURIComponent(d.trim()),$=await ue(`/api/patients?search=${O}&limit=10`);if(!$.ok){const te=await $.json().catch(()=>({message:"Failed to search patients"}));throw new Error(te.message||"Failed to search patients")}const W=await $.json();W&&Array.isArray(W.patients)?b(W.patients):(console.error("Unexpected response format from patient search:",W),b([]))}catch(O){console.error("Error searching patients:",O),o(`Search failed: ${O.message}`)}finally{A(!1)}}},[d]);w.useEffect(()=>{if(d.trim().length<2){b([]),o(null);return}const O=setTimeout(()=>{F()},300);return()=>clearTimeout(O)},[d,F]);const z=O=>{N(O),h(""),b([]),o(null),t($=>({...$,name:"",age:"",gender:"",phone:""}))},B=()=>{N(null),h(""),b([]),o(null),t(O=>({...O,name:"",age:"",gender:"",phone:""}))},U=O=>{const{name:$,value:W}=O.target;t(te=>({...te,[$]:W}))},R=async O=>{var $;O.preventDefault(),o(null),u(null),a(!0);try{let W,te;if(v)W=v.id,te=v.name,console.log(`Adding existing patient ${W} to queue.`);else{console.log("Registering new patient...");const q=await ue("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!q.ok){const ee=await q.json();if(q.status===403&&ee.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:ee.message}});return}throw new Error(ee.message||"Failed to register patient")}const H=await q.json();W=H.id,te=H.name,console.log(`New patient ${W} registered.`)}const ne=n.doctorId||null;console.log(`Adding patient ${W} to general queue first (Assignment pending payment)`);const re=await ue("/api/queue",{method:"POST",body:JSON.stringify({patientId:W,complaint:n.complaint||null,doctorId:null})});if(!re.ok){const q=await re.json();throw new Error(q.message||"Failed to add patient to queue")}const J=await re.json();if(console.log(`Patient added to queue, entry ID: ${J.id}`),N(null),h(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),ne){const q=(($=T.find(ee=>ee.id===ne))==null?void 0:$.name)||"Selected Doctor",H=v?`Existing patient "${te}" added to queue. Redirecting to billing for Dr. ${q}...`:`Patient "${te}" registered and added to queue. Redirecting to billing for Dr. ${q}...`;u(H),e("/billing",{state:{patientId:W,queueId:J.id,patientName:te,doctorId:ne,billType:"consultation",finalizeQueueAssignment:!0}})}else{const q=v?`Existing patient "${te}" added to the general queue.`:`Patient "${te}" registered and added to the general queue.`;u(q)}}catch(W){console.error("Error in add/queue process:",W),W.message.includes("Patient limit")?(o(`Operation failed: ${W.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):o(`Operation failed: ${W.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:i.jsx(an,{size:20,className:"btn-icon"})})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx(UC,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:d,onChange:O=>h(O.target.value),className:"form-input",disabled:r||!!v}),i.jsx(Ci,{size:18,className:`${C?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:B,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(gi,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map(O=>i.jsxs("li",{onClick:()=>z(O),children:[O.name," (ID: ",O.id,", Phone: ",O.phone||"N/A",")"]},O.id))}),d.length>=2&&g.length===0&&!C&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',d,'". You can register them below.']}),C&&d.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),l&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:l})]}),f&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:f})]}),i.jsxs("form",{onSubmit:R,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:U,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:U,onBlur:O=>{O.target.value===""&&t($=>({...$,age:"0"}))},className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:U,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:U,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:U,className:`form-select ${M?"opacity-50":""}`,disabled:r||M,children:[i.jsx("option",{value:"",children:M?"Loading doctors...":T.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),T.map(O=>i.jsx("option",{value:O.id,children:O.name},O.id))]}),T.length===0&&!M&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:U,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("button",{type:"submit",className:`btn btn-primary floating-action-btn ${r||M?"disabled":""}`,disabled:r||M,children:[i.jsx(BC,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})},wU=({clinicId:e})=>{const n=Mt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,l]=w.useState(null),[o,f]=w.useState(!1);w.useEffect(()=>{l(e?null:"Clinic information is missing. Please ensure you are logged in correctly.")},[e]);const u=h=>{const{name:g,value:b}=h.target;r(v=>{const N={...v,[g]:b};return g==="role"&&b!=="doctor"&&(N.opd_fee=""),N})},d=async h=>{if(h.preventDefault(),l(null),!t.name||!t.email||!t.role||!t.password){l("Please fill in all required fields (Name, Email, Role, and Password).");return}if(!e){l("Clinic session not found. Please refresh and try again.");return}const g={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(g.role==="doctor"&&t.opd_fee&&isNaN(g.opd_fee)){l("Please enter a valid amount for the OPD Fee.");return}f(!0);try{const b=await ue("/api/staff",{method:"POST",body:JSON.stringify(g)});if(!b.ok){const v=await b.json();throw new Error(v.message||"The server encountered an error while adding staff.")}n(-1)}catch(b){l(b.message)}finally{f(!1)}};return i.jsxs("div",{className:"staff-page-container",children:[i.jsx("header",{className:"staff-header",children:i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:i.jsx(an,{size:20})}),i.jsx("h1",{children:"Add Staff Member"})]}),i.jsx("p",{className:"subtitle",children:"Register a new professional to your clinic's team."})]})}),a&&i.jsxs("div",{className:"mb-8 p-4 rounded-xl bg-rose-50 text-rose-700 border border-rose-100 flex items-center animate-in fade-in slide-in-from-top-2",children:[i.jsx(ni,{size:20,className:"mr-3 shrink-0"}),i.jsx("span",{className:"font-medium text-sm",children:a}),i.jsx("button",{onClick:()=>l(null),className:"ml-auto text-rose-400 hover:text-rose-600",children:""})]}),i.jsxs("form",{onSubmit:d,className:`staff-form ${e?"":"opacity-40 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:u,required:!0,disabled:o||!e,placeholder:"Dr. John Doe / Receptionist Jane"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:u,required:!0,disabled:o||!e,placeholder:"staff@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:u,required:!0,disabled:o||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:u,required:!0,disabled:o||!e,placeholder:"Create a secure password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group animate-in fade-in zoom-in-95",children:[i.jsx("label",{htmlFor:"opd_fee",children:"Consultation Fee ()"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:u,step:"0.01",min:"0",placeholder:"e.g. 500",disabled:o||!e})]}),i.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-6 border-t border-slate-100 dark:border-slate-800 full-width",children:[i.jsxs("button",{type:"submit",className:"staff-btn staff-btn-primary px-8",disabled:o||!e,children:[o?i.jsx(Rh,{size:18,className:"animate-spin"}):i.jsx(eo,{size:18}),i.jsx("span",{children:o?"Registering...":"Register Staff"})]}),i.jsx("button",{type:"button",onClick:()=>n(-1),className:"staff-btn staff-btn-secondary",disabled:o,children:"Cancel"})]})]})]})},NU=()=>{const{id:e}=qr(),n=Mt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,l]=w.useState(""),[o,f]=w.useState(!0),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),N=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),f(!1);return}f(!0),g(null),v(null);try{const D=await ue(`/staff/${e}`);if(!D.ok){const V=await D.json();throw new Error(V.message||`HTTP error! status: ${D.status}`)}const M=await D.json();r({name:M.name,email:M.email,role:M.role,opd_fee:M.opd_fee??"",active:M.active})}catch(D){g(`Failed to load staff details: ${D.message}`)}finally{f(!1)}},[e]);w.useEffect(()=>{N()},[N]);const C=D=>{const{name:M,value:V,type:F}=D.target;if(F==="checkbox"){const{checked:z}=D.target;r(B=>({...B,[M]:z}))}else r(z=>({...z,[M]:V}))},A=D=>{l(D.target.value)},T=async D=>{if(D.preventDefault(),!e){g("Staff identifier is missing.");return}d(!0),g(null),v(null);const M={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const V=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(V!==null&&isNaN(V)){g("Consultation fee must be a valid number."),d(!1);return}M.opd_fee=V}else M.opd_fee=null;a.trim()!==""&&(M.password=a.trim());try{const V=await ue(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!V.ok){const F=await V.json();throw new Error(F.message||`Error status: ${V.status}`)}v("Profile updated successfully!"),l(""),setTimeout(()=>n(-1),1500)}catch(V){g(`Failed to update profile: ${V.message}`)}finally{d(!1)}};return o?i.jsx("div",{className:"flex justify-center items-center h-screen bg-transparent",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"breathing-ball",style:{background:"var(--staff-primary)"}})}),i.jsx("span",{className:"mt-4 text-xl text-teal-600 font-medium tracking-tight",children:"Accessing staff records..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[i.jsx("header",{className:"staff-header",children:i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:i.jsx(an,{size:20})}),i.jsx("h1",{children:"Edit Staff Profile"})]}),i.jsxs("p",{className:"subtitle",children:["Update credentials and preferences for ",t.name,"."]})]})}),h&&i.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-rose-50 text-rose-700 border border-rose-100 flex items-center animate-in fade-in slide-in-from-top-2",children:[i.jsx(ni,{size:20,className:"mr-3"}),i.jsx("span",{className:"font-semibold text-sm",children:h})]}),b&&i.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-emerald-50 text-emerald-700 border border-emerald-100 flex items-center animate-in fade-in slide-in-from-top-2",children:[i.jsx(Ta,{size:20,className:"mr-3"}),i.jsx("span",{className:"font-semibold text-sm",children:b})]}),i.jsxs("form",{onSubmit:T,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:C,required:!0,placeholder:"John Doe"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:C,required:!0,placeholder:"johndoe@clinic.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:C,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group animate-in fade-in zoom-in-95",children:[i.jsx("label",{htmlFor:"opd_fee",children:"Consultation Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:C,min:"0",step:"0.01",placeholder:"e.g. 500"})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"password",children:"Update Password"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:A,placeholder:"Leave blank to keep existing password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Only fill this if you want to reset the staff member's password."})]}),i.jsxs("div",{className:"checkbox-group full-width",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:C}),i.jsxs("label",{htmlFor:"active",className:"mb-0 cursor-pointer select-none",children:[i.jsx("span",{className:"font-bold",children:"Account Active"}),i.jsx("p",{className:"text-xs text-slate-500 font-normal mt-1",children:"Deactivated staff cannot log into the system."})]})]}),i.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-6 border-t border-slate-100 dark:border-slate-800 full-width",children:[i.jsxs("button",{type:"submit",className:"staff-btn staff-btn-primary px-8",disabled:u,children:[u?i.jsx(Rh,{className:"animate-spin",size:18}):i.jsx(uu,{size:18}),i.jsx("span",{children:u?"Saving...":"Save Changes"})]}),i.jsx("button",{type:"button",onClick:()=>n(-1),className:"staff-btn staff-btn-secondary",disabled:u,children:"Discard"})]})]})]})};function SU(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const jU=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,_U=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,CU={};function jj(e,n){return(CU.jsx?_U:jU).test(e)}const kU=/[ \t\n\f\r]/g;function TU(e){return typeof e=="object"?e.type==="text"?_j(e.value):!1:_j(e)}function _j(e){return e.replace(kU,"")===""}let gg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};gg.prototype.normal={};gg.prototype.property={};gg.prototype.space=void 0;function hk(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new gg(t,r,n)}function x1(e){return e.toLowerCase()}let Pa=class{constructor(n,t){this.attribute=t,this.property=n}};Pa.prototype.attribute="";Pa.prototype.booleanish=!1;Pa.prototype.boolean=!1;Pa.prototype.commaOrSpaceSeparated=!1;Pa.prototype.commaSeparated=!1;Pa.prototype.defined=!1;Pa.prototype.mustUseProperty=!1;Pa.prototype.number=!1;Pa.prototype.overloadedBoolean=!1;Pa.prototype.property="";Pa.prototype.spaceSeparated=!1;Pa.prototype.space=void 0;let EU=0;const ln=Qd(),Qi=Qd(),pk=Qd(),lt=Qd(),pi=Qd(),Oh=Qd(),Ka=Qd();function Qd(){return 2**++EU}const b1=Object.freeze(Object.defineProperty({__proto__:null,boolean:ln,booleanish:Qi,commaOrSpaceSeparated:Ka,commaSeparated:Oh,number:lt,overloadedBoolean:pk,spaceSeparated:pi},Symbol.toStringTag,{value:"Module"})),cv=Object.keys(b1);let Nw=class extends Pa{constructor(n,t,r,a){let l=-1;if(super(n,t),Cj(this,"space",a),typeof r=="number")for(;++l<cv.length;){const o=cv[l];Cj(this,cv[l],(r&b1[o])===b1[o])}}};Nw.prototype.defined=!0;function Cj(e,n,t){t&&(e[n]=t)}function Zh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const l=new Nw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(l.mustUseProperty=!0),n[r]=l,t[x1(r)]=r,t[x1(l.attribute)]=r}return new gg(n,t,e.space)}const mk=Zh({properties:{ariaActiveDescendant:null,ariaAtomic:Qi,ariaAutoComplete:null,ariaBusy:Qi,ariaChecked:Qi,ariaColCount:lt,ariaColIndex:lt,ariaColSpan:lt,ariaControls:pi,ariaCurrent:null,ariaDescribedBy:pi,ariaDetails:null,ariaDisabled:Qi,ariaDropEffect:pi,ariaErrorMessage:null,ariaExpanded:Qi,ariaFlowTo:pi,ariaGrabbed:Qi,ariaHasPopup:null,ariaHidden:Qi,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:pi,ariaLevel:lt,ariaLive:null,ariaModal:Qi,ariaMultiLine:Qi,ariaMultiSelectable:Qi,ariaOrientation:null,ariaOwns:pi,ariaPlaceholder:null,ariaPosInSet:lt,ariaPressed:Qi,ariaReadOnly:Qi,ariaRelevant:null,ariaRequired:Qi,ariaRoleDescription:pi,ariaRowCount:lt,ariaRowIndex:lt,ariaRowSpan:lt,ariaSelected:Qi,ariaSetSize:lt,ariaSort:null,ariaValueMax:lt,ariaValueMin:lt,ariaValueNow:lt,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function gk(e,n){return n in e?e[n]:n}function yk(e,n){return gk(e,n.toLowerCase())}const AU=Zh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Oh,acceptCharset:pi,accessKey:pi,action:null,allow:null,allowFullScreen:ln,allowPaymentRequest:ln,allowUserMedia:ln,alt:null,as:null,async:ln,autoCapitalize:null,autoComplete:pi,autoFocus:ln,autoPlay:ln,blocking:pi,capture:null,charSet:null,checked:ln,cite:null,className:pi,cols:lt,colSpan:null,content:null,contentEditable:Qi,controls:ln,controlsList:pi,coords:lt|Oh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:ln,defer:ln,dir:null,dirName:null,disabled:ln,download:pk,draggable:Qi,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:ln,formTarget:null,headers:pi,height:lt,hidden:ln,high:lt,href:null,hrefLang:null,htmlFor:pi,httpEquiv:pi,id:null,imageSizes:null,imageSrcSet:null,inert:ln,inputMode:null,integrity:null,is:null,isMap:ln,itemId:null,itemProp:pi,itemRef:pi,itemScope:ln,itemType:pi,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:ln,low:lt,manifest:null,max:null,maxLength:lt,media:null,method:null,min:null,minLength:lt,multiple:ln,muted:ln,name:null,nonce:null,noModule:ln,noValidate:ln,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:ln,optimum:lt,pattern:null,ping:pi,placeholder:null,playsInline:ln,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:ln,referrerPolicy:null,rel:pi,required:ln,reversed:ln,rows:lt,rowSpan:lt,sandbox:pi,scope:null,scoped:ln,seamless:ln,selected:ln,shadowRootClonable:ln,shadowRootDelegatesFocus:ln,shadowRootMode:null,shape:null,size:lt,sizes:null,slot:null,span:lt,spellCheck:Qi,src:null,srcDoc:null,srcLang:null,srcSet:null,start:lt,step:null,style:null,tabIndex:lt,target:null,title:null,translate:null,type:null,typeMustMatch:ln,useMap:null,value:Qi,width:lt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:pi,axis:null,background:null,bgColor:null,border:lt,borderColor:null,bottomMargin:lt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:ln,declare:ln,event:null,face:null,frame:null,frameBorder:null,hSpace:lt,leftMargin:lt,link:null,longDesc:null,lowSrc:null,marginHeight:lt,marginWidth:lt,noResize:ln,noHref:ln,noShade:ln,noWrap:ln,object:null,profile:null,prompt:null,rev:null,rightMargin:lt,rules:null,scheme:null,scrolling:Qi,standby:null,summary:null,text:null,topMargin:lt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:lt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:ln,disableRemotePlayback:ln,prefix:null,property:null,results:lt,security:null,unselectable:null},space:"html",transform:yk}),PU=Zh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ka,accentHeight:lt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:lt,amplitude:lt,arabicForm:null,ascent:lt,attributeName:null,attributeType:null,azimuth:lt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:lt,by:null,calcMode:null,capHeight:lt,className:pi,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:lt,diffuseConstant:lt,direction:null,display:null,dur:null,divisor:lt,dominantBaseline:null,download:ln,dx:null,dy:null,edgeMode:null,editable:null,elevation:lt,enableBackground:null,end:null,event:null,exponent:lt,externalResourcesRequired:null,fill:null,fillOpacity:lt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Oh,g2:Oh,glyphName:Oh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:lt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:lt,horizOriginX:lt,horizOriginY:lt,id:null,ideographic:lt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:lt,k:lt,k1:lt,k2:lt,k3:lt,k4:lt,kernelMatrix:Ka,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:lt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:lt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:lt,overlineThickness:lt,paintOrder:null,panose1:null,path:null,pathLength:lt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:pi,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:lt,pointsAtY:lt,pointsAtZ:lt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ka,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ka,rev:Ka,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ka,requiredFeatures:Ka,requiredFonts:Ka,requiredFormats:Ka,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:lt,specularExponent:lt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:lt,strikethroughThickness:lt,string:null,stroke:null,strokeDashArray:Ka,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:lt,strokeOpacity:lt,strokeWidth:null,style:null,surfaceScale:lt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ka,tabIndex:lt,tableValues:null,target:null,targetX:lt,targetY:lt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ka,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:lt,underlineThickness:lt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:lt,values:null,vAlphabetic:lt,vMathematical:lt,vectorEffect:null,vHanging:lt,vIdeographic:lt,version:null,vertAdvY:lt,vertOriginX:lt,vertOriginY:lt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:lt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:gk}),xk=Zh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),bk=Zh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:yk}),vk=Zh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),DU={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},MU=/[A-Z]/g,kj=/-[a-z]/g,IU=/^data[-\w.:]+$/i;function RU(e,n){const t=x1(n);let r=n,a=Pa;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&IU.test(n)){if(n.charAt(4)==="-"){const l=n.slice(5).replace(kj,OU);r="data"+l.charAt(0).toUpperCase()+l.slice(1)}else{const l=n.slice(4);if(!kj.test(l)){let o=l.replace(MU,LU);o.charAt(0)!=="-"&&(o="-"+o),n="data"+o}}a=Nw}return new a(r,n)}function LU(e){return"-"+e.toLowerCase()}function OU(e){return e.charAt(1).toUpperCase()}const FU=hk([mk,AU,xk,bk,vk],"html"),Sw=hk([mk,PU,xk,bk,vk],"svg");function $U(e){return e.join(" ").trim()}var jh={},uv,Tj;function zU(){if(Tj)return uv;Tj=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,l=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,f=/^\s+|\s+$/g,u=`
`,d="/",h="*",g="",b="comment",v="declaration";uv=function(C,A){if(typeof C!="string")throw new TypeError("First argument must be a string");if(!C)return[];A=A||{};var T=1,D=1;function M(te){var ne=te.match(n);ne&&(T+=ne.length);var re=te.lastIndexOf(u);D=~re?te.length-re:D+te.length}function V(){var te={line:T,column:D};return function(ne){return ne.position=new F(te),U(),ne}}function F(te){this.start=te,this.end={line:T,column:D},this.source=A.source}F.prototype.content=C;function z(te){var ne=new Error(A.source+":"+T+":"+D+": "+te);if(ne.reason=te,ne.filename=A.source,ne.line=T,ne.column=D,ne.source=C,!A.silent)throw ne}function B(te){var ne=te.exec(C);if(ne){var re=ne[0];return M(re),C=C.slice(re.length),ne}}function U(){B(t)}function R(te){var ne;for(te=te||[];ne=O();)ne!==!1&&te.push(ne);return te}function O(){var te=V();if(!(d!=C.charAt(0)||h!=C.charAt(1))){for(var ne=2;g!=C.charAt(ne)&&(h!=C.charAt(ne)||d!=C.charAt(ne+1));)++ne;if(ne+=2,g===C.charAt(ne-1))return z("End of comment missing");var re=C.slice(2,ne-2);return D+=2,M(re),C=C.slice(ne),D+=2,te({type:b,comment:re})}}function $(){var te=V(),ne=B(r);if(ne){if(O(),!B(a))return z("property missing ':'");var re=B(l),J=te({type:v,property:N(ne[0].replace(e,g)),value:re?N(re[0].replace(e,g)):g});return B(o),J}}function W(){var te=[];R(te);for(var ne;ne=$();)ne!==!1&&(te.push(ne),R(te));return te}return U(),W()};function N(C){return C?C.replace(f,g):g}return uv}var Ej;function BU(){if(Ej)return jh;Ej=1;var e=jh&&jh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jh,"__esModule",{value:!0}),jh.default=t;var n=e(zU());function t(r,a){var l=null;if(!r||typeof r!="string")return l;var o=(0,n.default)(r),f=typeof a=="function";return o.forEach(function(u){if(u.type==="declaration"){var d=u.property,h=u.value;f?a(d,h,u):h&&(l=l||{},l[d]=h)}}),l}return jh}var Fm={},Aj;function UU(){if(Aj)return Fm;Aj=1,Object.defineProperty(Fm,"__esModule",{value:!0}),Fm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,l=function(d){return!d||t.test(d)||e.test(d)},o=function(d,h){return h.toUpperCase()},f=function(d,h){return"".concat(h,"-")},u=function(d,h){return h===void 0&&(h={}),l(d)?d:(d=d.toLowerCase(),h.reactCompat?d=d.replace(a,f):d=d.replace(r,f),d.replace(n,o))};return Fm.camelCase=u,Fm}var $m,Pj;function qU(){if(Pj)return $m;Pj=1;var e=$m&&$m.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(BU()),t=UU();function r(a,l){var o={};return!a||typeof a!="string"||(0,n.default)(a,function(f,u){f&&u&&(o[(0,t.camelCase)(f,l)]=u)}),o}return r.default=r,$m=r,$m}var VU=qU();const HU=Yd(VU),wk=Nk("end"),jw=Nk("start");function Nk(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function GU(e){const n=jw(e),t=wk(e);if(n&&t)return{start:n,end:t}}function Wm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Dj(e.position):"start"in e||"end"in e?Dj(e):"line"in e||"column"in e?v1(e):""}function v1(e){return Mj(e&&e.line)+":"+Mj(e&&e.column)}function Dj(e){return v1(e&&e.start)+"-"+v1(e&&e.end)}function Mj(e){return e&&typeof e=="number"?e:1}let Vr=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",l={},o=!1;if(t&&("line"in t&&"column"in t?l={place:t}:"start"in t&&"end"in t?l={place:t}:"type"in t?l={ancestors:[t],place:t.position}:l={...t}),typeof n=="string"?a=n:!l.cause&&n&&(o=!0,a=n.message,l.cause=n),!l.ruleId&&!l.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?l.ruleId=r:(l.source=r.slice(0,u),l.ruleId=r.slice(u+1))}if(!l.place&&l.ancestors&&l.ancestors){const u=l.ancestors[l.ancestors.length-1];u&&(l.place=u.position)}const f=l.place&&"start"in l.place?l.place.start:l.place;this.ancestors=l.ancestors||void 0,this.cause=l.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=f?f.line:void 0,this.name=Wm(l.place)||"1:1",this.place=l.place||void 0,this.reason=this.message,this.ruleId=l.ruleId||void 0,this.source=l.source||void 0,this.stack=o&&l.cause&&typeof l.cause.stack=="string"?l.cause.stack:"",this.actual,this.expected,this.note,this.url}};Vr.prototype.file="";Vr.prototype.name="";Vr.prototype.reason="";Vr.prototype.message="";Vr.prototype.stack="";Vr.prototype.column=void 0;Vr.prototype.line=void 0;Vr.prototype.ancestors=void 0;Vr.prototype.cause=void 0;Vr.prototype.fatal=void 0;Vr.prototype.place=void 0;Vr.prototype.ruleId=void 0;Vr.prototype.source=void 0;const _w={}.hasOwnProperty,YU=new Map,WU=/[A-Z]/g,QU=new Set(["table","tbody","thead","tfoot","tr"]),JU=new Set(["td","th"]),Sk="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function KU(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=aq(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=rq(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?Sw:FU,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},l=jk(a,e,void 0);return l&&typeof l!="string"?l:a.create(e,a.Fragment,{children:l||void 0},void 0)}function jk(e,n,t){if(n.type==="element")return XU(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return ZU(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return tq(e,n,t);if(n.type==="mdxjsEsm")return eq(e,n);if(n.type==="root")return nq(e,n,t);if(n.type==="text")return iq(e,n)}function XU(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=Sw,e.schema=a),e.ancestors.push(n);const l=Ck(e,n.tagName,!1),o=sq(e,n);let f=kw(e,n);return QU.has(n.tagName)&&(f=f.filter(function(u){return typeof u=="string"?!TU(u):!0})),_k(e,o,l,n),Cw(o,f),e.ancestors.pop(),e.schema=r,e.create(n,l,o,t)}function ZU(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}lg(e,n.position)}function eq(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);lg(e,n.position)}function tq(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=Sw,e.schema=a),e.ancestors.push(n);const l=n.name===null?e.Fragment:Ck(e,n.name,!0),o=lq(e,n),f=kw(e,n);return _k(e,o,l,n),Cw(o,f),e.ancestors.pop(),e.schema=r,e.create(n,l,o,t)}function nq(e,n,t){const r={};return Cw(r,kw(e,n)),e.create(n,e.Fragment,r,t)}function iq(e,n){return n.value}function _k(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function Cw(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function rq(e,n,t){return r;function r(a,l,o,f){const d=Array.isArray(o.children)?t:n;return f?d(l,o,f):d(l,o)}}function aq(e,n){return t;function t(r,a,l,o){const f=Array.isArray(l.children),u=jw(r);return n(a,l,o,f,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function sq(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&_w.call(n.properties,a)){const l=oq(e,a,n.properties[a]);if(l){const[o,f]=l;e.tableCellAlignToStyle&&o==="align"&&typeof f=="string"&&JU.has(n.tagName)?r=f:t[o]=f}}if(r){const l=t.style||(t.style={});l[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function lq(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const l=r.data.estree.body[0];l.type;const o=l.expression;o.type;const f=o.properties[0];f.type,Object.assign(t,e.evaluater.evaluateExpression(f.argument))}else lg(e,n.position);else{const a=r.name;let l;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const f=r.value.data.estree.body[0];f.type,l=e.evaluater.evaluateExpression(f.expression)}else lg(e,n.position);else l=r.value===null?!0:r.value;t[a]=l}return t}function kw(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:YU;for(;++r<n.children.length;){const l=n.children[r];let o;if(e.passKeys){const u=l.type==="element"?l.tagName:l.type==="mdxJsxFlowElement"||l.type==="mdxJsxTextElement"?l.name:void 0;if(u){const d=a.get(u)||0;o=u+"-"+d,a.set(u,d+1)}}const f=jk(e,l,o);f!==void 0&&t.push(f)}return t}function oq(e,n,t){const r=RU(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?SU(t):$U(t)),r.property==="style"){let a=typeof t=="object"?t:cq(e,String(t));return e.stylePropertyNameCase==="css"&&(a=uq(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?DU[r.property]||r.property:r.attribute,t]}}function cq(e,n){try{return HU(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new Vr("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=Sk+"#cannot-parse-style-attribute",a}}function Ck(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let l=-1,o;for(;++l<a.length;){const f=jj(a[l])?{type:"Identifier",name:a[l]}:{type:"Literal",value:a[l]};o=o?{type:"MemberExpression",object:o,property:f,computed:!!(l&&f.type==="Literal"),optional:!1}:f}r=o}else r=jj(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return _w.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);lg(e)}function lg(e,n){const t=new Vr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=Sk+"#cannot-handle-mdx-estrees-without-createevaluater",t}function uq(e){const n={};let t;for(t in e)_w.call(e,t)&&(n[dq(t)]=e[t]);return n}function dq(e){let n=e.replace(WU,fq);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function fq(e){return"-"+e.toLowerCase()}const dv={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},hq={};function Tw(e,n){const t=hq,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return kk(e,r,a)}function kk(e,n,t){if(pq(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Ij(e.children,n,t)}return Array.isArray(e)?Ij(e,n,t):""}function Ij(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=kk(e[a],n,t);return r.join("")}function pq(e){return!!(e&&typeof e=="object")}const Rj=document.createElement("i");function Ew(e){const n="&"+e+";";Rj.innerHTML=n;const t=Rj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function ns(e,n,t,r){const a=e.length;let l=0,o;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)o=Array.from(r),o.unshift(n,t),e.splice(...o);else for(t&&e.splice(n,t);l<r.length;)o=r.slice(l,l+1e4),o.unshift(n,0),e.splice(...o),l+=1e4,n+=1e4}function _s(e,n){return e.length>0?(ns(e,e.length,0,n),e):n}const Lj={}.hasOwnProperty;function Tk(e){const n={};let t=-1;for(;++t<e.length;)mq(n,e[t]);return n}function mq(e,n){let t;for(t in n){const a=(Lj.call(e,t)?e[t]:void 0)||(e[t]={}),l=n[t];let o;if(l)for(o in l){Lj.call(a,o)||(a[o]=[]);const f=l[o];gq(a[o],Array.isArray(f)?f:f?[f]:[])}}}function gq(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);ns(e,0,0,r)}function Ek(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function rl(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const la=gu(/[A-Za-z]/),Br=gu(/[\dA-Za-z]/),yq=gu(/[#-'*+\--9=?A-Z^-~]/);function pb(e){return e!==null&&(e<32||e===127)}const w1=gu(/\d/),xq=gu(/[\dA-Fa-f]/),bq=gu(/[!-/:-@[-`{-~]/);function qt(e){return e!==null&&e<-2}function ci(e){return e!==null&&(e<0||e===32)}function _n(e){return e===-2||e===-1||e===32}const Fb=gu(new RegExp("\\p{P}|\\p{S}","u")),Hd=gu(/\s/);function gu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function ep(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const l=e.charCodeAt(t);let o="";if(l===37&&Br(e.charCodeAt(t+1))&&Br(e.charCodeAt(t+2)))a=2;else if(l<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(l))||(o=String.fromCharCode(l));else if(l>55295&&l<57344){const f=e.charCodeAt(t+1);l<56320&&f>56319&&f<57344?(o=String.fromCharCode(l,f),a=1):o=""}else o=String.fromCharCode(l);o&&(n.push(e.slice(r,t),encodeURIComponent(o)),r=t+a+1,o=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function Pn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let l=0;return o;function o(u){return _n(u)?(e.enter(t),f(u)):n(u)}function f(u){return _n(u)&&l++<a?(e.consume(u),f):(e.exit(t),n(u))}}const vq={tokenize:wq};function wq(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Pn(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),l(f)}function l(f){const u=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=u),t=u,o(f)}function o(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return qt(f)?(e.consume(f),e.exit("chunkText"),l):(e.consume(f),o)}}const Nq={tokenize:Sq},Oj={tokenize:jq};function Sq(e){const n=this,t=[];let r=0,a,l,o;return f;function f(M){if(r<t.length){const V=t[r];return n.containerState=V[1],e.attempt(V[0].continuation,u,d)(M)}return d(M)}function u(M){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&D();const V=n.events.length;let F=V,z;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){z=n.events[F][1].end;break}T(r);let B=V;for(;B<n.events.length;)n.events[B][1].end={...z},B++;return ns(n.events,F+1,0,n.events.slice(V)),n.events.length=B,d(M)}return f(M)}function d(M){if(r===t.length){if(!a)return b(M);if(a.currentConstruct&&a.currentConstruct.concrete)return N(M);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(Oj,h,g)(M)}function h(M){return a&&D(),T(r),b(M)}function g(M){return n.parser.lazy[n.now().line]=r!==t.length,o=n.now().offset,N(M)}function b(M){return n.containerState={},e.attempt(Oj,v,N)(M)}function v(M){return r++,t.push([n.currentConstruct,n.containerState]),b(M)}function N(M){if(M===null){a&&D(),T(0),e.consume(M);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:l}),C(M)}function C(M){if(M===null){A(e.exit("chunkFlow"),!0),T(0),e.consume(M);return}return qt(M)?(e.consume(M),A(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(M),C)}function A(M,V){const F=n.sliceStream(M);if(V&&F.push(null),M.previous=l,l&&(l.next=M),l=M,a.defineSkip(M.start),a.write(F),n.parser.lazy[M.start.line]){let z=a.events.length;for(;z--;)if(a.events[z][1].start.offset<o&&(!a.events[z][1].end||a.events[z][1].end.offset>o))return;const B=n.events.length;let U=B,R,O;for(;U--;)if(n.events[U][0]==="exit"&&n.events[U][1].type==="chunkFlow"){if(R){O=n.events[U][1].end;break}R=!0}for(T(r),z=B;z<n.events.length;)n.events[z][1].end={...O},z++;ns(n.events,U+1,0,n.events.slice(B)),n.events.length=z}}function T(M){let V=t.length;for(;V-- >M;){const F=t[V];n.containerState=F[1],F[0].exit.call(n,e)}t.length=M}function D(){a.write([null]),l=void 0,a=void 0,n.containerState._closeFlow=void 0}}function jq(e,n,t){return Pn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Gh(e){if(e===null||ci(e)||Hd(e))return 1;if(Fb(e))return 2}function $b(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const l=e[a].resolveAll;l&&!r.includes(l)&&(n=l(n,t),r.push(l))}return n}const N1={name:"attention",resolveAll:_q,tokenize:Cq};function _q(e,n){let t=-1,r,a,l,o,f,u,d,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;u=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};Fj(g,-u),Fj(b,u),o={type:u>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:u>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},l={type:u>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:u>1?"strong":"emphasis",start:{...o.start},end:{...f.end}},e[r][1].end={...o.start},e[t][1].start={...f.end},d=[],e[r][1].end.offset-e[r][1].start.offset&&(d=_s(d,[["enter",e[r][1],n],["exit",e[r][1],n]])),d=_s(d,[["enter",a,n],["enter",o,n],["exit",o,n],["enter",l,n]]),d=_s(d,$b(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),d=_s(d,[["exit",l,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,d=_s(d,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,ns(e,r-1,t-r+3,d),t=r+d.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function Cq(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Gh(r);let l;return o;function o(u){return l=u,e.enter("attentionSequence"),f(u)}function f(u){if(u===l)return e.consume(u),f;const d=e.exit("attentionSequence"),h=Gh(u),g=!h||h===2&&a||t.includes(u),b=!a||a===2&&h||t.includes(r);return d._open=!!(l===42?g:g&&(a||!b)),d._close=!!(l===42?b:b&&(h||!g)),n(u)}}function Fj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const kq={name:"autolink",tokenize:Tq};function Tq(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l}function l(v){return la(v)?(e.consume(v),o):v===64?t(v):d(v)}function o(v){return v===43||v===45||v===46||Br(v)?(r=1,f(v)):d(v)}function f(v){return v===58?(e.consume(v),r=0,u):(v===43||v===45||v===46||Br(v))&&r++<32?(e.consume(v),f):(r=0,d(v))}function u(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||pb(v)?t(v):(e.consume(v),u)}function d(v){return v===64?(e.consume(v),h):yq(v)?(e.consume(v),d):t(v)}function h(v){return Br(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Br(v))&&r++<63){const N=v===45?b:g;return e.consume(v),N}return t(v)}}const yg={partial:!0,tokenize:Eq};function Eq(e,n,t){return r;function r(l){return _n(l)?Pn(e,a,"linePrefix")(l):a(l)}function a(l){return l===null||qt(l)?n(l):t(l)}}const Ak={continuation:{tokenize:Pq},exit:Dq,name:"blockQuote",tokenize:Aq};function Aq(e,n,t){const r=this;return a;function a(o){if(o===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),l}return t(o)}function l(o){return _n(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(o))}}function Pq(e,n,t){const r=this;return a;function a(o){return _n(o)?Pn(e,l,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):l(o)}function l(o){return e.attempt(Ak,n,t)(o)}}function Dq(e){e.exit("blockQuote")}const Pk={name:"characterEscape",tokenize:Mq};function Mq(e,n,t){return r;function r(l){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(l),e.exit("escapeMarker"),a}function a(l){return bq(l)?(e.enter("characterEscapeValue"),e.consume(l),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(l)}}const Dk={name:"characterReference",tokenize:Iq};function Iq(e,n,t){const r=this;let a=0,l,o;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),u}function u(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),l=31,o=Br,h(g))}function d(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),l=6,o=xq,h):(e.enter("characterReferenceValue"),l=7,o=w1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return o===Br&&!Ew(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return o(g)&&a++<l?(e.consume(g),h):t(g)}}const $j={partial:!0,tokenize:Lq},zj={concrete:!0,name:"codeFenced",tokenize:Rq};function Rq(e,n,t){const r=this,a={partial:!0,tokenize:F};let l=0,o=0,f;return u;function u(z){return d(z)}function d(z){const B=r.events[r.events.length-1];return l=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,f=z,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(z)}function h(z){return z===f?(o++,e.consume(z),h):o<3?t(z):(e.exit("codeFencedFenceSequence"),_n(z)?Pn(e,g,"whitespace")(z):g(z))}function g(z){return z===null||qt(z)?(e.exit("codeFencedFence"),r.interrupt?n(z):e.check($j,C,V)(z)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(z))}function b(z){return z===null||qt(z)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(z)):_n(z)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Pn(e,v,"whitespace")(z)):z===96&&z===f?t(z):(e.consume(z),b)}function v(z){return z===null||qt(z)?g(z):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),N(z))}function N(z){return z===null||qt(z)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(z)):z===96&&z===f?t(z):(e.consume(z),N)}function C(z){return e.attempt(a,V,A)(z)}function A(z){return e.enter("lineEnding"),e.consume(z),e.exit("lineEnding"),T}function T(z){return l>0&&_n(z)?Pn(e,D,"linePrefix",l+1)(z):D(z)}function D(z){return z===null||qt(z)?e.check($j,C,V)(z):(e.enter("codeFlowValue"),M(z))}function M(z){return z===null||qt(z)?(e.exit("codeFlowValue"),D(z)):(e.consume(z),M)}function V(z){return e.exit("codeFenced"),n(z)}function F(z,B,U){let R=0;return O;function O(re){return z.enter("lineEnding"),z.consume(re),z.exit("lineEnding"),$}function $(re){return z.enter("codeFencedFence"),_n(re)?Pn(z,W,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(re):W(re)}function W(re){return re===f?(z.enter("codeFencedFenceSequence"),te(re)):U(re)}function te(re){return re===f?(R++,z.consume(re),te):R>=o?(z.exit("codeFencedFenceSequence"),_n(re)?Pn(z,ne,"whitespace")(re):ne(re)):U(re)}function ne(re){return re===null||qt(re)?(z.exit("codeFencedFence"),B(re)):U(re)}}}function Lq(e,n,t){const r=this;return a;function a(o){return o===null?t(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}const fv={name:"codeIndented",tokenize:Fq},Oq={partial:!0,tokenize:$q};function Fq(e,n,t){const r=this;return a;function a(d){return e.enter("codeIndented"),Pn(e,l,"linePrefix",5)(d)}function l(d){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?o(d):t(d)}function o(d){return d===null?u(d):qt(d)?e.attempt(Oq,o,u)(d):(e.enter("codeFlowValue"),f(d))}function f(d){return d===null||qt(d)?(e.exit("codeFlowValue"),o(d)):(e.consume(d),f)}function u(d){return e.exit("codeIndented"),n(d)}}function $q(e,n,t){const r=this;return a;function a(o){return r.parser.lazy[r.now().line]?t(o):qt(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):Pn(e,l,"linePrefix",5)(o)}function l(o){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):qt(o)?a(o):t(o)}}const zq={name:"codeText",previous:Uq,resolve:Bq,tokenize:qq};function Bq(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function Uq(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function qq(e,n,t){let r=0,a,l;return o;function o(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),u(g))}function u(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),u):g===96?(l=e.enter("codeTextSequence"),a=0,h(g)):qt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),u):(e.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||qt(g)?(e.exit("codeTextData"),u(g)):(e.consume(g),d)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(l.type="codeTextData",d(g))}}let Vq=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const l=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&zm(this.left,r),l.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),zm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),zm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);zm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);zm(this.left,t.reverse())}}};function zm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function Mk(e){const n={};let t=-1,r,a,l,o,f,u,d;const h=new Vq(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,l=0,l<u.length&&u[l][1].type==="lineEndingBlank"&&(l+=2),l<u.length&&u[l][1].type==="content"))for(;++l<u.length&&u[l][1].type!=="content";)u[l][1].type==="chunkText"&&(u[l][1]._isInFirstContentOfListItem=!0,l++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,Hq(h,t)),t=n[t],d=!0);else if(r[1]._container){for(l=t,a=void 0;l--;)if(o=h.get(l),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),o[1].type="lineEnding",a=l);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return ns(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!d}function Hq(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const l=[];let o=t._tokenizer;o||(o=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const f=o.events,u=[],d={};let h,g,b=-1,v=t,N=0,C=0;const A=[C];for(;v;){for(;e.get(++a)[1]!==v;);l.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&o.defineSkip(v.start),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(h),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(C=b+1,A.push(C),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(o.events=[],v?(v._tokenizer=void 0,v.previous=void 0):A.pop(),b=A.length;b--;){const T=f.slice(A[b],A[b+1]),D=l.pop();u.push([D,D+T.length-1]),e.splice(D,2,T)}for(u.reverse(),b=-1;++b<u.length;)d[N+u[b][0]]=N+u[b][1],N+=u[b][1]-u[b][0]-1;return d}const Gq={resolve:Wq,tokenize:Qq},Yq={partial:!0,tokenize:Jq};function Wq(e){return Mk(e),e}function Qq(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?l(f):qt(f)?e.check(Yq,o,l)(f):(e.consume(f),a)}function l(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function o(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function Jq(e,n,t){const r=this;return a;function a(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Pn(e,l,"linePrefix")}function l(o){if(o===null||qt(o))return t(o);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):e.interrupt(r.parser.constructs.flow,t,n)(o)}}function Ik(e,n,t,r,a,l,o,f,u){const d=u||Number.POSITIVE_INFINITY;let h=0;return g;function g(T){return T===60?(e.enter(r),e.enter(a),e.enter(l),e.consume(T),e.exit(l),b):T===null||T===32||T===41||pb(T)?t(T):(e.enter(r),e.enter(o),e.enter(f),e.enter("chunkString",{contentType:"string"}),C(T))}function b(T){return T===62?(e.enter(l),e.consume(T),e.exit(l),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(T))}function v(T){return T===62?(e.exit("chunkString"),e.exit(f),b(T)):T===null||T===60||qt(T)?t(T):(e.consume(T),T===92?N:v)}function N(T){return T===60||T===62||T===92?(e.consume(T),v):v(T)}function C(T){return!h&&(T===null||T===41||ci(T))?(e.exit("chunkString"),e.exit(f),e.exit(o),e.exit(r),n(T)):h<d&&T===40?(e.consume(T),h++,C):T===41?(e.consume(T),h--,C):T===null||T===32||T===40||pb(T)?t(T):(e.consume(T),T===92?A:C)}function A(T){return T===40||T===41||T===92?(e.consume(T),C):C(T)}}function Rk(e,n,t,r,a,l){const o=this;let f=0,u;return d;function d(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(l),h}function h(v){return f>999||v===null||v===91||v===93&&!u||v===94&&!f&&"_hiddenFootnoteSupport"in o.parser.constructs?t(v):v===93?(e.exit(l),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):qt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||qt(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),u||(u=!_n(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function Lk(e,n,t,r,a,l){let o;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),o=b===40?41:b,u):t(b)}function u(b){return b===o?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(l),d(b))}function d(b){return b===o?(e.exit(l),u(o)):b===null?t(b):qt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),Pn(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===o||b===null||qt(b)?(e.exit("chunkString"),d(b)):(e.consume(b),b===92?g:h)}function g(b){return b===o||b===92?(e.consume(b),h):h(b)}}function Qm(e,n){let t;return r;function r(a){return qt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):_n(a)?Pn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const Kq={name:"definition",tokenize:Zq},Xq={partial:!0,tokenize:e9};function Zq(e,n,t){const r=this;let a;return l;function l(v){return e.enter("definition"),o(v)}function o(v){return Rk.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=rl(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),u):t(v)}function u(v){return ci(v)?Qm(e,d)(v):d(v)}function d(v){return Ik(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(Xq,g,g)(v)}function g(v){return _n(v)?Pn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||qt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function e9(e,n,t){return r;function r(f){return ci(f)?Qm(e,a)(f):t(f)}function a(f){return Lk(e,l,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function l(f){return _n(f)?Pn(e,o,"whitespace")(f):o(f)}function o(f){return f===null||qt(f)?n(f):t(f)}}const t9={name:"hardBreakEscape",tokenize:n9};function n9(e,n,t){return r;function r(l){return e.enter("hardBreakEscape"),e.consume(l),a}function a(l){return qt(l)?(e.exit("hardBreakEscape"),n(l)):t(l)}}const i9={name:"headingAtx",resolve:r9,tokenize:a9};function r9(e,n){let t=e.length-2,r=3,a,l;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},l={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},ns(e,r,t-r+1,[["enter",a,n],["enter",l,n],["exit",l,n],["exit",a,n]])),e}function a9(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),l(h)}function l(h){return e.enter("atxHeadingSequence"),o(h)}function o(h){return h===35&&r++<6?(e.consume(h),o):h===null||ci(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),u(h)):h===null||qt(h)?(e.exit("atxHeading"),n(h)):_n(h)?Pn(e,f,"whitespace")(h):(e.enter("atxHeadingText"),d(h))}function u(h){return h===35?(e.consume(h),u):(e.exit("atxHeadingSequence"),f(h))}function d(h){return h===null||h===35||ci(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),d)}}const s9=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Bj=["pre","script","style","textarea"],l9={concrete:!0,name:"htmlFlow",resolveTo:u9,tokenize:d9},o9={partial:!0,tokenize:h9},c9={partial:!0,tokenize:f9};function u9(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function d9(e,n,t){const r=this;let a,l,o,f,u;return d;function d(I){return h(I)}function h(I){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(I),g}function g(I){return I===33?(e.consume(I),b):I===47?(e.consume(I),l=!0,C):I===63?(e.consume(I),a=3,r.interrupt?n:E):la(I)?(e.consume(I),o=String.fromCharCode(I),A):t(I)}function b(I){return I===45?(e.consume(I),a=2,v):I===91?(e.consume(I),a=5,f=0,N):la(I)?(e.consume(I),a=4,r.interrupt?n:E):t(I)}function v(I){return I===45?(e.consume(I),r.interrupt?n:E):t(I)}function N(I){const ce="CDATA[";return I===ce.charCodeAt(f++)?(e.consume(I),f===ce.length?r.interrupt?n:W:N):t(I)}function C(I){return la(I)?(e.consume(I),o=String.fromCharCode(I),A):t(I)}function A(I){if(I===null||I===47||I===62||ci(I)){const ce=I===47,xe=o.toLowerCase();return!ce&&!l&&Bj.includes(xe)?(a=1,r.interrupt?n(I):W(I)):s9.includes(o.toLowerCase())?(a=6,ce?(e.consume(I),T):r.interrupt?n(I):W(I)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(I):l?D(I):M(I))}return I===45||Br(I)?(e.consume(I),o+=String.fromCharCode(I),A):t(I)}function T(I){return I===62?(e.consume(I),r.interrupt?n:W):t(I)}function D(I){return _n(I)?(e.consume(I),D):O(I)}function M(I){return I===47?(e.consume(I),O):I===58||I===95||la(I)?(e.consume(I),V):_n(I)?(e.consume(I),M):O(I)}function V(I){return I===45||I===46||I===58||I===95||Br(I)?(e.consume(I),V):F(I)}function F(I){return I===61?(e.consume(I),z):_n(I)?(e.consume(I),F):M(I)}function z(I){return I===null||I===60||I===61||I===62||I===96?t(I):I===34||I===39?(e.consume(I),u=I,B):_n(I)?(e.consume(I),z):U(I)}function B(I){return I===u?(e.consume(I),u=null,R):I===null||qt(I)?t(I):(e.consume(I),B)}function U(I){return I===null||I===34||I===39||I===47||I===60||I===61||I===62||I===96||ci(I)?F(I):(e.consume(I),U)}function R(I){return I===47||I===62||_n(I)?M(I):t(I)}function O(I){return I===62?(e.consume(I),$):t(I)}function $(I){return I===null||qt(I)?W(I):_n(I)?(e.consume(I),$):t(I)}function W(I){return I===45&&a===2?(e.consume(I),J):I===60&&a===1?(e.consume(I),q):I===62&&a===4?(e.consume(I),Q):I===63&&a===3?(e.consume(I),E):I===93&&a===5?(e.consume(I),ee):qt(I)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(o9,ie,te)(I)):I===null||qt(I)?(e.exit("htmlFlowData"),te(I)):(e.consume(I),W)}function te(I){return e.check(c9,ne,ie)(I)}function ne(I){return e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),re}function re(I){return I===null||qt(I)?te(I):(e.enter("htmlFlowData"),W(I))}function J(I){return I===45?(e.consume(I),E):W(I)}function q(I){return I===47?(e.consume(I),o="",H):W(I)}function H(I){if(I===62){const ce=o.toLowerCase();return Bj.includes(ce)?(e.consume(I),Q):W(I)}return la(I)&&o.length<8?(e.consume(I),o+=String.fromCharCode(I),H):W(I)}function ee(I){return I===93?(e.consume(I),E):W(I)}function E(I){return I===62?(e.consume(I),Q):I===45&&a===2?(e.consume(I),E):W(I)}function Q(I){return I===null||qt(I)?(e.exit("htmlFlowData"),ie(I)):(e.consume(I),Q)}function ie(I){return e.exit("htmlFlow"),n(I)}}function f9(e,n,t){const r=this;return a;function a(o){return qt(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l):t(o)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}function h9(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(yg,n,t)}}const p9={name:"htmlText",tokenize:m9};function m9(e,n,t){const r=this;let a,l,o;return f;function f(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),u}function u(E){return E===33?(e.consume(E),d):E===47?(e.consume(E),F):E===63?(e.consume(E),M):la(E)?(e.consume(E),U):t(E)}function d(E){return E===45?(e.consume(E),h):E===91?(e.consume(E),l=0,N):la(E)?(e.consume(E),D):t(E)}function h(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):qt(E)?(o=g,q(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?J(E):E===45?b(E):g(E)}function N(E){const Q="CDATA[";return E===Q.charCodeAt(l++)?(e.consume(E),l===Q.length?C:N):t(E)}function C(E){return E===null?t(E):E===93?(e.consume(E),A):qt(E)?(o=C,q(E)):(e.consume(E),C)}function A(E){return E===93?(e.consume(E),T):C(E)}function T(E){return E===62?J(E):E===93?(e.consume(E),T):C(E)}function D(E){return E===null||E===62?J(E):qt(E)?(o=D,q(E)):(e.consume(E),D)}function M(E){return E===null?t(E):E===63?(e.consume(E),V):qt(E)?(o=M,q(E)):(e.consume(E),M)}function V(E){return E===62?J(E):M(E)}function F(E){return la(E)?(e.consume(E),z):t(E)}function z(E){return E===45||Br(E)?(e.consume(E),z):B(E)}function B(E){return qt(E)?(o=B,q(E)):_n(E)?(e.consume(E),B):J(E)}function U(E){return E===45||Br(E)?(e.consume(E),U):E===47||E===62||ci(E)?R(E):t(E)}function R(E){return E===47?(e.consume(E),J):E===58||E===95||la(E)?(e.consume(E),O):qt(E)?(o=R,q(E)):_n(E)?(e.consume(E),R):J(E)}function O(E){return E===45||E===46||E===58||E===95||Br(E)?(e.consume(E),O):$(E)}function $(E){return E===61?(e.consume(E),W):qt(E)?(o=$,q(E)):_n(E)?(e.consume(E),$):R(E)}function W(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,te):qt(E)?(o=W,q(E)):_n(E)?(e.consume(E),W):(e.consume(E),ne)}function te(E){return E===a?(e.consume(E),a=void 0,re):E===null?t(E):qt(E)?(o=te,q(E)):(e.consume(E),te)}function ne(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||ci(E)?R(E):(e.consume(E),ne)}function re(E){return E===47||E===62||ci(E)?R(E):t(E)}function J(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function q(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),H}function H(E){return _n(E)?Pn(e,ee,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):ee(E)}function ee(E){return e.enter("htmlTextData"),o(E)}}const Aw={name:"labelEnd",resolveAll:b9,resolveTo:v9,tokenize:w9},g9={tokenize:N9},y9={tokenize:S9},x9={tokenize:j9};function b9(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&ns(e,0,e.length,t),e}function v9(e,n){let t=e.length,r=0,a,l,o,f;for(;t--;)if(a=e[t][1],l){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(o){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(l=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(o=t);const u={type:e[l][1].type==="labelLink"?"link":"image",start:{...e[l][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[l][1].start},end:{...e[o][1].end}},h={type:"labelText",start:{...e[l+r+2][1].end},end:{...e[o-2][1].start}};return f=[["enter",u,n],["enter",d,n]],f=_s(f,e.slice(l+1,l+r+3)),f=_s(f,[["enter",h,n]]),f=_s(f,$b(n.parser.constructs.insideSpan.null,e.slice(l+r+4,o-3),n)),f=_s(f,[["exit",h,n],e[o-2],e[o-1],["exit",d,n]]),f=_s(f,e.slice(o+1)),f=_s(f,[["exit",u,n]]),ns(e,l,e.length,f),e}function w9(e,n,t){const r=this;let a=r.events.length,l,o;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){l=r.events[a][1];break}return f;function f(b){return l?l._inactive?g(b):(o=r.parser.defined.includes(rl(r.sliceSerialize({start:l.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),u):t(b)}function u(b){return b===40?e.attempt(g9,h,o?h:g)(b):b===91?e.attempt(y9,h,o?d:g)(b):o?h(b):g(b)}function d(b){return e.attempt(x9,h,g)(b)}function h(b){return n(b)}function g(b){return l._balanced=!0,t(b)}}function N9(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return ci(g)?Qm(e,l)(g):l(g)}function l(g){return g===41?h(g):Ik(e,o,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function o(g){return ci(g)?Qm(e,u)(g):h(g)}function f(g){return t(g)}function u(g){return g===34||g===39||g===40?Lk(e,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function d(g){return ci(g)?Qm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function S9(e,n,t){const r=this;return a;function a(f){return Rk.call(r,e,l,o,"reference","referenceMarker","referenceString")(f)}function l(f){return r.parser.defined.includes(rl(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function o(f){return t(f)}}function j9(e,n,t){return r;function r(l){return e.enter("reference"),e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),a}function a(l){return l===93?(e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),e.exit("reference"),n):t(l)}}const _9={name:"labelStartImage",resolveAll:Aw.resolveAll,tokenize:C9};function C9(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),l}function l(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),o):t(f)}function o(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const k9={name:"labelStartLink",resolveAll:Aw.resolveAll,tokenize:T9};function T9(e,n,t){const r=this;return a;function a(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),l}function l(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(o):n(o)}}const hv={name:"lineEnding",tokenize:E9};function E9(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Pn(e,n,"linePrefix")}}const Wx={name:"thematicBreak",tokenize:A9};function A9(e,n,t){let r=0,a;return l;function l(d){return e.enter("thematicBreak"),o(d)}function o(d){return a=d,f(d)}function f(d){return d===a?(e.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||qt(d))?(e.exit("thematicBreak"),n(d)):t(d)}function u(d){return d===a?(e.consume(d),r++,u):(e.exit("thematicBreakSequence"),_n(d)?Pn(e,f,"whitespace")(d):f(d))}}const ja={continuation:{tokenize:I9},exit:L9,name:"list",tokenize:M9},P9={partial:!0,tokenize:O9},D9={partial:!0,tokenize:R9};function M9(e,n,t){const r=this,a=r.events[r.events.length-1];let l=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,o=0;return f;function f(v){const N=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(N==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:w1(v)){if(r.containerState.type||(r.containerState.type=N,e.enter(N,{_container:!0})),N==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Wx,t,d)(v):d(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(v)}return t(v)}function u(v){return w1(v)&&++o<10?(e.consume(v),u):(!r.interrupt||o<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),d(v)):t(v)}function d(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(yg,r.interrupt?t:h,e.attempt(P9,b,g))}function h(v){return r.containerState.initialBlankLine=!0,l++,b(v)}function g(v){return _n(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=l+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function I9(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(yg,a,l);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Pn(e,n,"listItemIndent",r.containerState.size+1)(f)}function l(f){return r.containerState.furtherBlankLines||!_n(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(D9,n,o)(f))}function o(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,Pn(e,e.attempt(ja,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function R9(e,n,t){const r=this;return Pn(e,a,"listItemIndent",r.containerState.size+1);function a(l){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?n(l):t(l)}}function L9(e){e.exit(this.containerState.type)}function O9(e,n,t){const r=this;return Pn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(l){const o=r.events[r.events.length-1];return!_n(l)&&o&&o[1].type==="listItemPrefixWhitespace"?n(l):t(l)}}const Uj={name:"setextUnderline",resolveTo:F9,tokenize:$9};function F9(e,n){let t=e.length,r,a,l;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!l&&e[t][1].type==="definition"&&(l=t);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",l?(e.splice(a,0,["enter",o,n]),e.splice(l+1,0,["exit",e[r][1],n]),e[r][1].end={...e[l][1].end}):e[r][1]=o,e.push(["exit",o,n]),e}function $9(e,n,t){const r=this;let a;return l;function l(d){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=d,o(d)):t(d)}function o(d){return e.enter("setextHeadingLineSequence"),f(d)}function f(d){return d===a?(e.consume(d),f):(e.exit("setextHeadingLineSequence"),_n(d)?Pn(e,u,"lineSuffix")(d):u(d))}function u(d){return d===null||qt(d)?(e.exit("setextHeadingLine"),n(d)):t(d)}}const z9={tokenize:B9};function B9(e){const n=this,t=e.attempt(yg,r,e.attempt(this.parser.constructs.flowInitial,a,Pn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(Gq,a)),"linePrefix")));return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEndingBlank"),e.consume(l),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const U9={resolveAll:Fk()},q9=Ok("string"),V9=Ok("text");function Ok(e){return{resolveAll:Fk(e==="text"?H9:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],l=t.attempt(a,o,f);return o;function o(h){return d(h)?l(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),u}function u(h){return d(h)?(t.exit("data"),l(h)):(t.consume(h),u)}function d(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function Fk(e){return n;function n(t,r){let a=-1,l;for(;++a<=t.length;)l===void 0?t[a]&&t[a][1].type==="data"&&(l=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==l+2&&(t[l][1].end=t[a-1][1].end,t.splice(l+2,a-l-2),a=l+2),l=void 0);return e?e(t,r):t}}function H9(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let l=a.length,o=-1,f=0,u;for(;l--;){const d=a[l];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)f++,o--;if(o)break;o=-1}else if(d===-2)u=!0,f++;else if(d!==-1){l++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const d={type:t===e.length||u||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:l?o:r.start._bufferIndex+o,_index:r.start._index+l,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(e.splice(t,0,["enter",d,n],["exit",d,n]),t+=2)}t++}return e}const G9={42:ja,43:ja,45:ja,48:ja,49:ja,50:ja,51:ja,52:ja,53:ja,54:ja,55:ja,56:ja,57:ja,62:Ak},Y9={91:Kq},W9={[-2]:fv,[-1]:fv,32:fv},Q9={35:i9,42:Wx,45:[Uj,Wx],60:l9,61:Uj,95:Wx,96:zj,126:zj},J9={38:Dk,92:Pk},K9={[-5]:hv,[-4]:hv,[-3]:hv,33:_9,38:Dk,42:N1,60:[kq,p9],91:k9,92:[t9,Pk],93:Aw,95:N1,96:zq},X9={null:[N1,U9]},Z9={null:[42,95]},e7={null:[]},t7=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Z9,contentInitial:Y9,disable:e7,document:G9,flow:Q9,flowInitial:W9,insideSpan:X9,string:J9,text:K9},Symbol.toStringTag,{value:"Module"}));function n7(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},l=[];let o=[],f=[];const u={attempt:B(F),check:B(z),consume:D,enter:M,exit:V,interrupt:B(z,{interrupt:!0})},d={code:null,containerState:{},defineSkip:C,events:[],now:N,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(d,u);return n.resolveAll&&l.push(n),d;function g($){return o=_s(o,$),A(),o[o.length-1]!==null?[]:(U(n,0),d.events=$b(l,d.events,d),d.events)}function b($,W){return r7(v($),W)}function v($){return i7(o,$)}function N(){const{_bufferIndex:$,_index:W,line:te,column:ne,offset:re}=r;return{_bufferIndex:$,_index:W,line:te,column:ne,offset:re}}function C($){a[$.line]=$.column,O()}function A(){let $;for(;r._index<o.length;){const W=o[r._index];if(typeof W=="string")for($=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===$&&r._bufferIndex<W.length;)T(W.charCodeAt(r._bufferIndex));else T(W)}}function T($){h=h($)}function D($){qt($)?(r.line++,r.column=1,r.offset+=$===-3?2:1,O()):$!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=$}function M($,W){const te=W||{};return te.type=$,te.start=N(),d.events.push(["enter",te,d]),f.push(te),te}function V($){const W=f.pop();return W.end=N(),d.events.push(["exit",W,d]),W}function F($,W){U($,W.from)}function z($,W){W.restore()}function B($,W){return te;function te(ne,re,J){let q,H,ee,E;return Array.isArray(ne)?ie(ne):"tokenize"in ne?ie([ne]):Q(ne);function Q(le){return ge;function ge(ye){const Re=ye!==null&&le[ye],Ze=ye!==null&&le.null,at=[...Array.isArray(Re)?Re:Re?[Re]:[],...Array.isArray(Ze)?Ze:Ze?[Ze]:[]];return ie(at)(ye)}}function ie(le){return q=le,H=0,le.length===0?J:I(le[H])}function I(le){return ge;function ge(ye){return E=R(),ee=le,le.partial||(d.currentConstruct=le),le.name&&d.parser.constructs.disable.null.includes(le.name)?xe():le.tokenize.call(W?Object.assign(Object.create(d),W):d,u,ce,xe)(ye)}}function ce(le){return $(ee,E),re}function xe(le){return E.restore(),++H<q.length?I(q[H]):J}}}function U($,W){$.resolveAll&&!l.includes($)&&l.push($),$.resolve&&ns(d.events,W,d.events.length-W,$.resolve(d.events.slice(W),d)),$.resolveTo&&(d.events=$.resolveTo(d.events,d))}function R(){const $=N(),W=d.previous,te=d.currentConstruct,ne=d.events.length,re=Array.from(f);return{from:ne,restore:J};function J(){r=$,d.previous=W,d.currentConstruct=te,d.events.length=ne,f=re,O()}}function O(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function i7(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,l=n.end._bufferIndex;let o;if(t===a)o=[e[t].slice(r,l)];else{if(o=e.slice(t,a),r>-1){const f=o[0];typeof f=="string"?o[0]=f.slice(r):o.shift()}l>0&&o.push(e[a].slice(0,l))}return o}function r7(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const l=e[t];let o;if(typeof l=="string")o=l;else switch(l){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=n?" ":"	";break}case-1:{if(!n&&a)continue;o=" ";break}default:o=String.fromCharCode(l)}a=l===-2,r.push(o)}return r.join("")}function a7(e){const r={constructs:Tk([t7,...(e||{}).extensions||[]]),content:a(vq),defined:[],document:a(Nq),flow:a(z9),lazy:{},string:a(q9),text:a(V9)};return r;function a(l){return o;function o(f){return n7(r,l,f)}}}function s7(e){for(;!Mk(e););return e}const qj=/[\0\t\n\r]/g;function l7(){let e=1,n="",t=!0,r;return a;function a(l,o,f){const u=[];let d,h,g,b,v;for(l=n+(typeof l=="string"?l.toString():new TextDecoder(o||void 0).decode(l)),g=0,n="",t&&(l.charCodeAt(0)===65279&&g++,t=void 0);g<l.length;){if(qj.lastIndex=g,d=qj.exec(l),b=d&&d.index!==void 0?d.index:l.length,v=l.charCodeAt(b),!d){n=l.slice(g);break}if(v===10&&g===b&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),g<b&&(u.push(l.slice(g,b)),e+=b-g),v){case 0:{u.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,u.push(-2);e++<h;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&u.push(-5),n&&u.push(n),u.push(null)),u}}const o7=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function c7(e){return e.replace(o7,u7)}function u7(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),l=a===120||a===88;return Ek(t.slice(l?2:1),l?16:10)}return Ew(t)||e}const $k={}.hasOwnProperty;function d7(e,n,t){return typeof n!="string"&&(t=n,n=void 0),f7(t)(s7(a7(t).document().write(l7()(e,n,!0))))}function f7(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:l(Ke),autolinkProtocol:R,autolinkEmail:R,atxHeading:l(Fe),blockQuote:l(Ze),characterEscape:R,characterReference:R,codeFenced:l(at),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:l(at,o),codeText:l(Le,o),codeTextData:R,data:R,codeFlowValue:R,definition:l(Te),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:l(we),hardBreakEscape:l(Xe),hardBreakTrailing:l(Xe),htmlFlow:l(it,o),htmlFlowData:R,htmlText:l(it,o),htmlTextData:R,image:l(je),label:o,link:l(Ke),listItem:l(ct),listItemValue:b,listOrdered:l(ze,g),listUnordered:l(ze),paragraph:l(Tt),reference:I,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:l(Fe),strong:l(bt),thematicBreak:l(oe)},exit:{atxHeading:u(),atxHeadingSequence:F,autolink:u(),autolinkEmail:Re,autolinkProtocol:ye,blockQuote:u(),characterEscapeValue:O,characterReferenceMarkerHexadecimal:xe,characterReferenceMarkerNumeric:xe,characterReferenceValue:le,characterReference:ge,codeFenced:u(A),codeFencedFence:C,codeFencedFenceInfo:v,codeFencedFenceMeta:N,codeFlowValue:O,codeIndented:u(T),codeText:u(re),codeTextData:O,data:O,definition:u(),definitionDestinationString:V,definitionLabelString:D,definitionTitleString:M,emphasis:u(),hardBreakEscape:u(W),hardBreakTrailing:u(W),htmlFlow:u(te),htmlFlowData:O,htmlText:u(ne),htmlTextData:O,image:u(q),label:ee,labelText:H,lineEnding:$,link:u(J),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:ce,resourceDestinationString:E,resourceTitleString:Q,resource:ie,setextHeading:u(U),setextHeadingLineSequence:B,setextHeadingText:z,strong:u(),thematicBreak:u()}};zk(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(K){let fe={type:"root",children:[]};const Ae={stack:[fe],tokenStack:[],config:n,enter:f,exit:d,buffer:o,resume:h,data:t},Ie=[];let Ye=-1;for(;++Ye<K.length;)if(K[Ye][1].type==="listOrdered"||K[Ye][1].type==="listUnordered")if(K[Ye][0]==="enter")Ie.push(Ye);else{const ft=Ie.pop();Ye=a(K,ft,Ye)}for(Ye=-1;++Ye<K.length;){const ft=n[K[Ye][0]];$k.call(ft,K[Ye][1].type)&&ft[K[Ye][1].type].call(Object.assign({sliceSerialize:K[Ye][2].sliceSerialize},Ae),K[Ye][1])}if(Ae.tokenStack.length>0){const ft=Ae.tokenStack[Ae.tokenStack.length-1];(ft[1]||Vj).call(Ae,void 0,ft[0])}for(fe.position={start:tu(K.length>0?K[0][1].start:{line:1,column:1,offset:0}),end:tu(K.length>0?K[K.length-2][1].end:{line:1,column:1,offset:0})},Ye=-1;++Ye<n.transforms.length;)fe=n.transforms[Ye](fe)||fe;return fe}function a(K,fe,Ae){let Ie=fe-1,Ye=-1,ft=!1,gt,jt,$e,nt;for(;++Ie<=Ae;){const Ve=K[Ie];switch(Ve[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ve[0]==="enter"?Ye++:Ye--,nt=void 0;break}case"lineEndingBlank":{Ve[0]==="enter"&&(gt&&!nt&&!Ye&&!$e&&($e=Ie),nt=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:nt=void 0}if(!Ye&&Ve[0]==="enter"&&Ve[1].type==="listItemPrefix"||Ye===-1&&Ve[0]==="exit"&&(Ve[1].type==="listUnordered"||Ve[1].type==="listOrdered")){if(gt){let ht=Ie;for(jt=void 0;ht--;){const Se=K[ht];if(Se[1].type==="lineEnding"||Se[1].type==="lineEndingBlank"){if(Se[0]==="exit")continue;jt&&(K[jt][1].type="lineEndingBlank",ft=!0),Se[1].type="lineEnding",jt=ht}else if(!(Se[1].type==="linePrefix"||Se[1].type==="blockQuotePrefix"||Se[1].type==="blockQuotePrefixWhitespace"||Se[1].type==="blockQuoteMarker"||Se[1].type==="listItemIndent"))break}$e&&(!jt||$e<jt)&&(gt._spread=!0),gt.end=Object.assign({},jt?K[jt][1].start:Ve[1].end),K.splice(jt||Ie,0,["exit",gt,Ve[2]]),Ie++,Ae++}if(Ve[1].type==="listItemPrefix"){const ht={type:"listItem",_spread:!1,start:Object.assign({},Ve[1].start),end:void 0};gt=ht,K.splice(Ie,0,["enter",ht,Ve[2]]),Ie++,Ae++,$e=void 0,nt=!0}}}return K[fe][1]._spread=ft,Ae}function l(K,fe){return Ae;function Ae(Ie){f.call(this,K(Ie),Ie),fe&&fe.call(this,Ie)}}function o(){this.stack.push({type:"fragment",children:[]})}function f(K,fe,Ae){this.stack[this.stack.length-1].children.push(K),this.stack.push(K),this.tokenStack.push([fe,Ae||void 0]),K.position={start:tu(fe.start),end:void 0}}function u(K){return fe;function fe(Ae){K&&K.call(this,Ae),d.call(this,Ae)}}function d(K,fe){const Ae=this.stack.pop(),Ie=this.tokenStack.pop();if(Ie)Ie[0].type!==K.type&&(fe?fe.call(this,K,Ie[0]):(Ie[1]||Vj).call(this,K,Ie[0]));else throw new Error("Cannot close `"+K.type+"` ("+Wm({start:K.start,end:K.end})+"): its not open");Ae.position.end=tu(K.end)}function h(){return Tw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(K){if(this.data.expectingFirstListItemValue){const fe=this.stack[this.stack.length-2];fe.start=Number.parseInt(this.sliceSerialize(K),10),this.data.expectingFirstListItemValue=void 0}}function v(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.lang=K}function N(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.meta=K}function C(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function A(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function T(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K.replace(/(\r?\n|\r)$/g,"")}function D(K){const fe=this.resume(),Ae=this.stack[this.stack.length-1];Ae.label=fe,Ae.identifier=rl(this.sliceSerialize(K)).toLowerCase()}function M(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.title=K}function V(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.url=K}function F(K){const fe=this.stack[this.stack.length-1];if(!fe.depth){const Ae=this.sliceSerialize(K).length;fe.depth=Ae}}function z(){this.data.setextHeadingSlurpLineEnding=!0}function B(K){const fe=this.stack[this.stack.length-1];fe.depth=this.sliceSerialize(K).codePointAt(0)===61?1:2}function U(){this.data.setextHeadingSlurpLineEnding=void 0}function R(K){const Ae=this.stack[this.stack.length-1].children;let Ie=Ae[Ae.length-1];(!Ie||Ie.type!=="text")&&(Ie=en(),Ie.position={start:tu(K.start),end:void 0},Ae.push(Ie)),this.stack.push(Ie)}function O(K){const fe=this.stack.pop();fe.value+=this.sliceSerialize(K),fe.position.end=tu(K.end)}function $(K){const fe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ae=fe.children[fe.children.length-1];Ae.position.end=tu(K.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(fe.type)&&(R.call(this,K),O.call(this,K))}function W(){this.data.atHardBreak=!0}function te(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K}function ne(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K}function re(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K}function J(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=fe,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function q(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=fe,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function H(K){const fe=this.sliceSerialize(K),Ae=this.stack[this.stack.length-2];Ae.label=c7(fe),Ae.identifier=rl(fe).toLowerCase()}function ee(){const K=this.stack[this.stack.length-1],fe=this.resume(),Ae=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ae.type==="link"){const Ie=K.children;Ae.children=Ie}else Ae.alt=fe}function E(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.url=K}function Q(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.title=K}function ie(){this.data.inReference=void 0}function I(){this.data.referenceType="collapsed"}function ce(K){const fe=this.resume(),Ae=this.stack[this.stack.length-1];Ae.label=fe,Ae.identifier=rl(this.sliceSerialize(K)).toLowerCase(),this.data.referenceType="full"}function xe(K){this.data.characterReferenceType=K.type}function le(K){const fe=this.sliceSerialize(K),Ae=this.data.characterReferenceType;let Ie;Ae?(Ie=Ek(fe,Ae==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ie=Ew(fe);const Ye=this.stack[this.stack.length-1];Ye.value+=Ie}function ge(K){const fe=this.stack.pop();fe.position.end=tu(K.end)}function ye(K){O.call(this,K);const fe=this.stack[this.stack.length-1];fe.url=this.sliceSerialize(K)}function Re(K){O.call(this,K);const fe=this.stack[this.stack.length-1];fe.url="mailto:"+this.sliceSerialize(K)}function Ze(){return{type:"blockquote",children:[]}}function at(){return{type:"code",lang:null,meta:null,value:""}}function Le(){return{type:"inlineCode",value:""}}function Te(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function we(){return{type:"emphasis",children:[]}}function Fe(){return{type:"heading",depth:0,children:[]}}function Xe(){return{type:"break"}}function it(){return{type:"html",value:""}}function je(){return{type:"image",title:null,url:"",alt:null}}function Ke(){return{type:"link",title:null,url:"",children:[]}}function ze(K){return{type:"list",ordered:K.type==="listOrdered",start:null,spread:K._spread,children:[]}}function ct(K){return{type:"listItem",spread:K._spread,checked:null,children:[]}}function Tt(){return{type:"paragraph",children:[]}}function bt(){return{type:"strong",children:[]}}function en(){return{type:"text",value:""}}function oe(){return{type:"thematicBreak"}}}function tu(e){return{line:e.line,column:e.column,offset:e.offset}}function zk(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?zk(e,r):h7(e,r)}}function h7(e,n){let t;for(t in n)if($k.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function Vj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Wm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Wm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Wm({start:n.start,end:n.end})+") is still open")}function p7(e){const n=this;n.parser=t;function t(r){return d7(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function m7(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function g7(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function y7(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function x7(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function b7(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function v7(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=ep(r.toLowerCase()),l=e.footnoteOrder.indexOf(r);let o,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=l+1,f+=1,e.footnoteCounts.set(r,f);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(n,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(n,d),e.applyData(n,d)}function w7(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function N7(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function Bk(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),l=a[0];l&&l.type==="text"?l.value="["+l.value:a.unshift({type:"text",value:"["});const o=a[a.length-1];return o&&o.type==="text"?o.value+=r:a.push({type:"text",value:r}),a}function S7(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return Bk(e,n);const a={src:ep(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,l),e.applyData(n,l)}function j7(e,n){const t={src:ep(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function _7(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function C7(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return Bk(e,n);const a={href:ep(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,l),e.applyData(n,l)}function k7(e,n){const t={href:ep(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function T7(e,n,t){const r=e.all(n),a=t?E7(t):Uk(n),l={},o=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),l.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?o.push(...h.children):o.push(h)}const u=r[r.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:l,children:o};return e.patch(n,d),e.applyData(n,d)}function E7(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=Uk(t[r])}return n}function Uk(e){const n=e.spread;return n??e.children.length>1}function A7(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const o=r[a];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const l={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,l),e.applyData(n,l)}function P7(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function D7(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function M7(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function I7(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],o),a.push(o)}if(t.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=jw(n.children[1]),u=wk(n.children[n.children.length-1]);f&&u&&(o.position={start:f,end:u}),a.push(o)}const l={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,l),e.applyData(n,l)}function R7(e,n,t){const r=t?t.children:void 0,l=(r?r.indexOf(n):1)===0?"th":"td",o=t&&t.type==="table"?t.align:void 0,f=o?o.length:n.children.length;let u=-1;const d=[];for(;++u<f;){const g=n.children[u],b={},v=o?o[u]:void 0;v&&(b.align=v);let N={type:"element",tagName:l,properties:b,children:[]};g&&(N.children=e.all(g),e.patch(g,N),N=e.applyData(g,N)),d.push(N)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(n,h),e.applyData(n,h)}function L7(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Hj=9,Gj=32;function O7(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const l=[];for(;r;)l.push(Yj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return l.push(Yj(n.slice(a),a>0,!1)),l.join("")}function Yj(e,n,t){let r=0,a=e.length;if(n){let l=e.codePointAt(r);for(;l===Hj||l===Gj;)r++,l=e.codePointAt(r)}if(t){let l=e.codePointAt(a-1);for(;l===Hj||l===Gj;)a--,l=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function F7(e,n){const t={type:"text",value:O7(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function $7(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const z7={blockquote:m7,break:g7,code:y7,delete:x7,emphasis:b7,footnoteReference:v7,heading:w7,html:N7,imageReference:S7,image:j7,inlineCode:_7,linkReference:C7,link:k7,listItem:T7,list:A7,paragraph:P7,root:D7,strong:M7,table:I7,tableCell:L7,tableRow:R7,text:F7,thematicBreak:$7,toml:Tx,yaml:Tx,definition:Tx,footnoteDefinition:Tx};function Tx(){}const qk=-1,zb=0,Jm=1,mb=2,Pw=3,Dw=4,Mw=5,Iw=6,Vk=7,Hk=8,Wj=typeof self=="object"?self:globalThis,B7=(e,n)=>{const t=(a,l)=>(e.set(l,a),a),r=a=>{if(e.has(a))return e.get(a);const[l,o]=n[a];switch(l){case zb:case qk:return t(o,a);case Jm:{const f=t([],a);for(const u of o)f.push(r(u));return f}case mb:{const f=t({},a);for(const[u,d]of o)f[r(u)]=r(d);return f}case Pw:return t(new Date(o),a);case Dw:{const{source:f,flags:u}=o;return t(new RegExp(f,u),a)}case Mw:{const f=t(new Map,a);for(const[u,d]of o)f.set(r(u),r(d));return f}case Iw:{const f=t(new Set,a);for(const u of o)f.add(r(u));return f}case Vk:{const{name:f,message:u}=o;return t(new Wj[f](u),a)}case Hk:return t(BigInt(o),a);case"BigInt":return t(Object(BigInt(o)),a);case"ArrayBuffer":return t(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:f}=new Uint8Array(o);return t(new DataView(f),o)}}return t(new Wj[l](o),a)};return r},Qj=e=>B7(new Map,e)(0),_h="",{toString:U7}={},{keys:q7}=Object,Bm=e=>{const n=typeof e;if(n!=="object"||!e)return[zb,n];const t=U7.call(e).slice(8,-1);switch(t){case"Array":return[Jm,_h];case"Object":return[mb,_h];case"Date":return[Pw,_h];case"RegExp":return[Dw,_h];case"Map":return[Mw,_h];case"Set":return[Iw,_h];case"DataView":return[Jm,t]}return t.includes("Array")?[Jm,t]:t.includes("Error")?[Vk,t]:[mb,t]},Ex=([e,n])=>e===zb&&(n==="function"||n==="symbol"),V7=(e,n,t,r)=>{const a=(o,f)=>{const u=r.push(o)-1;return t.set(f,u),u},l=o=>{if(t.has(o))return t.get(o);let[f,u]=Bm(o);switch(f){case zb:{let h=o;switch(u){case"bigint":f=Hk,h=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);h=null;break;case"undefined":return a([qk],o)}return a([f,h],o)}case Jm:{if(u){let b=o;return u==="DataView"?b=new Uint8Array(o.buffer):u==="ArrayBuffer"&&(b=new Uint8Array(o)),a([u,[...b]],o)}const h=[],g=a([f,h],o);for(const b of o)h.push(l(b));return g}case mb:{if(u)switch(u){case"BigInt":return a([u,o.toString()],o);case"Boolean":case"Number":case"String":return a([u,o.valueOf()],o)}if(n&&"toJSON"in o)return l(o.toJSON());const h=[],g=a([f,h],o);for(const b of q7(o))(e||!Ex(Bm(o[b])))&&h.push([l(b),l(o[b])]);return g}case Pw:return a([f,o.toISOString()],o);case Dw:{const{source:h,flags:g}=o;return a([f,{source:h,flags:g}],o)}case Mw:{const h=[],g=a([f,h],o);for(const[b,v]of o)(e||!(Ex(Bm(b))||Ex(Bm(v))))&&h.push([l(b),l(v)]);return g}case Iw:{const h=[],g=a([f,h],o);for(const b of o)(e||!Ex(Bm(b)))&&h.push(l(b));return g}}const{message:d}=o;return a([f,{name:u,message:d}],o)};return l},Jj=(e,{json:n,lossy:t}={})=>{const r=[];return V7(!(n||t),!!n,new Map,r)(e),r},gb=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?Qj(Jj(e,n)):structuredClone(e):(e,n)=>Qj(Jj(e,n));function H7(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function G7(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function Y7(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||H7,r=e.options.footnoteBackLabel||G7,a=e.options.footnoteLabel||"Footnotes",l=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let u=-1;for(;++u<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[u]);if(!d)continue;const h=e.all(d),g=String(d.identifier).toUpperCase(),b=ep(g.toLowerCase());let v=0;const N=[],C=e.footnoteCounts.get(g);for(;C!==void 0&&++v<=C;){N.length>0&&N.push({type:"text",value:" "});let D=typeof t=="string"?t:t(u,v);typeof D=="string"&&(D={type:"text",value:D}),N.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,v),className:["data-footnote-backref"]},children:Array.isArray(D)?D:[D]})}const A=h[h.length-1];if(A&&A.type==="element"&&A.tagName==="p"){const D=A.children[A.children.length-1];D&&D.type==="text"?D.value+=" ":A.children.push({type:"text",value:" "}),A.children.push(...N)}else h.push(...N);const T={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(d,T),f.push(T)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:l,properties:{...gb(o),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const Bb=function(e){if(e==null)return K7;if(typeof e=="function")return Ub(e);if(typeof e=="object")return Array.isArray(e)?W7(e):Q7(e);if(typeof e=="string")return J7(e);throw new Error("Expected function, string, or object as test")};function W7(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Bb(e[t]);return Ub(r);function r(...a){let l=-1;for(;++l<n.length;)if(n[l].apply(this,a))return!0;return!1}}function Q7(e){const n=e;return Ub(t);function t(r){const a=r;let l;for(l in e)if(a[l]!==n[l])return!1;return!0}}function J7(e){return Ub(n);function n(t){return t&&t.type===e}}function Ub(e){return n;function n(t,r,a){return!!(X7(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function K7(){return!0}function X7(e){return e!==null&&typeof e=="object"&&"type"in e}const Gk=[],Z7=!0,S1=!1,eV="skip";function Yk(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const l=Bb(a),o=r?-1:1;f(e,void 0,[])();function f(u,d,h){const g=u&&typeof u=="object"?u:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(u.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=Gk,N,C,A;if((!n||l(u,d,h[h.length-1]||void 0))&&(v=tV(t(u,h)),v[0]===S1))return v;if("children"in u&&u.children){const T=u;if(T.children&&v[0]!==eV)for(C=(r?T.children.length:-1)+o,A=h.concat(T);C>-1&&C<T.children.length;){const D=T.children[C];if(N=f(D,C,A)(),N[0]===S1)return N;C=typeof N[1]=="number"?N[1]:C+o}}return v}}}function tV(e){return Array.isArray(e)?e:typeof e=="number"?[Z7,e]:e==null?Gk:[e]}function Rw(e,n,t,r){let a,l,o;typeof n=="function"?(l=void 0,o=n,a=t):(l=n,o=t,a=r),Yk(e,l,f,a);function f(u,d){const h=d[d.length-1],g=h?h.children.indexOf(u):void 0;return o(u,g,h)}}const j1={}.hasOwnProperty,nV={};function iV(e,n){const t=n||nV,r=new Map,a=new Map,l=new Map,o={...z7,...t.handlers},f={all:d,applyData:aV,definitionById:r,footnoteById:a,footnoteCounts:l,footnoteOrder:[],handlers:o,one:u,options:t,patch:rV,wrap:lV};return Rw(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function u(h,g){const b=h.type,v=f.handlers[b];if(j1.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:C,...A}=h,T=gb(A);return T.children=f.all(h),T}return gb(h)}return(f.options.unknownHandler||sV)(f,h,g)}function d(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const N=f.one(b[v],h);if(N){if(v&&b[v-1].type==="break"&&(!Array.isArray(N)&&N.type==="text"&&(N.value=Kj(N.value)),!Array.isArray(N)&&N.type==="element")){const C=N.children[0];C&&C.type==="text"&&(C.value=Kj(C.value))}Array.isArray(N)?g.push(...N):g.push(N)}}}return g}}function rV(e,n){e.position&&(n.position=GU(e))}function aV(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,l=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const o="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:o}}t.type==="element"&&l&&Object.assign(t.properties,gb(l)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function sV(e,n){const t=n.data||{},r="value"in n&&!(j1.call(t,"hProperties")||j1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function lV(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Kj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function Xj(e,n){const t=iV(e,n),r=t.one(e,void 0),a=Y7(t),l=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&l.children.push({type:"text",value:`
`},a),l}function oV(e,n){return e&&"run"in e?async function(t,r){const a=Xj(t,{file:r,...n});await e.run(a,r)}:function(t,r){return Xj(t,{file:r,...e||n})}}function Zj(e){if(e)throw e}var pv,e_;function cV(){if(e_)return pv;e_=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):n.call(d)==="[object Array]"},l=function(d){if(!d||n.call(d)!=="[object Object]")return!1;var h=e.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&e.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!h&&!g)return!1;var b;for(b in d);return typeof b>"u"||e.call(d,b)},o=function(d,h){t&&h.name==="__proto__"?t(d,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):d[h.name]=h.newValue},f=function(d,h){if(h==="__proto__")if(e.call(d,h)){if(r)return r(d,h).value}else return;return d[h]};return pv=function u(){var d,h,g,b,v,N,C=arguments[0],A=1,T=arguments.length,D=!1;for(typeof C=="boolean"&&(D=C,C=arguments[1]||{},A=2),(C==null||typeof C!="object"&&typeof C!="function")&&(C={});A<T;++A)if(d=arguments[A],d!=null)for(h in d)g=f(C,h),b=f(d,h),C!==b&&(D&&b&&(l(b)||(v=a(b)))?(v?(v=!1,N=g&&a(g)?g:[]):N=g&&l(g)?g:{},o(C,{name:h,newValue:u(D,N,b)})):typeof b<"u"&&o(C,{name:h,newValue:b}));return C},pv}var uV=cV();const mv=Yd(uV);function _1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function dV(){const e=[],n={run:t,use:r};return n;function t(...a){let l=-1;const o=a.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);f(null,...a);function f(u,...d){const h=e[++l];let g=-1;if(u){o(u);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,h?fV(h,f)(...d):o(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function fV(e,n){let t;return r;function r(...o){const f=e.length>o.length;let u;f&&o.push(a);try{u=e.apply(this,o)}catch(d){const h=d;if(f&&t)throw h;return a(h)}f||(u&&u.then&&typeof u.then=="function"?u.then(l,a):u instanceof Error?a(u):l(u))}function a(o,...f){t||(t=!0,n(o,...f))}function l(o){a(null,o)}}const Yl={basename:hV,dirname:pV,extname:mV,join:gV,sep:"/"};function hV(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');xg(e);let t=0,r=-1,a=e.length,l;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else r<0&&(l=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let o=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else o<0&&(l=!0,o=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=o));return t===r?r=o:r<0&&(r=e.length),e.slice(t,r)}function pV(e){if(xg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function mV(e){xg(e);let n=e.length,t=-1,r=0,a=-1,l=0,o;for(;n--;){const f=e.codePointAt(n);if(f===47){if(o){r=n+1;break}continue}t<0&&(o=!0,t=n+1),f===46?a<0?a=n:l!==1&&(l=1):a>-1&&(l=-1)}return a<0||t<0||l===0||l===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function gV(...e){let n=-1,t;for(;++n<e.length;)xg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":yV(t)}function yV(e){xg(e);const n=e.codePointAt(0)===47;let t=xV(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function xV(e,n){let t="",r=0,a=-1,l=0,o=-1,f,u;for(;++o<=e.length;){if(o<e.length)f=e.codePointAt(o);else{if(f===47)break;f=47}if(f===47){if(!(a===o-1||l===1))if(a!==o-1&&l===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),a=o,l=0;continue}}else if(t.length>0){t="",r=0,a=o,l=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,o):t=e.slice(a+1,o),r=o-a-1;a=o,l=0}else f===46&&l>-1?l++:l=-1}return t}function xg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const bV={cwd:vV};function vV(){return"/"}function C1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function wV(e){if(typeof e=="string")e=new URL(e);else if(!C1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return NV(e)}function NV(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const gv=["history","path","basename","stem","extname","dirname"];let Wk=class{constructor(n){let t;n?C1(n)?t={path:n}:typeof n=="string"||SV(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":bV.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<gv.length;){const l=gv[r];l in t&&t[l]!==void 0&&t[l]!==null&&(this[l]=l==="history"?[...t[l]]:t[l])}let a;for(a in t)gv.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Yl.basename(this.path):void 0}set basename(n){xv(n,"basename"),yv(n,"basename"),this.path=Yl.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Yl.dirname(this.path):void 0}set dirname(n){t_(this.basename,"dirname"),this.path=Yl.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Yl.extname(this.path):void 0}set extname(n){if(yv(n,"extname"),t_(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Yl.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){C1(n)&&(n=wV(n)),xv(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Yl.basename(this.path,this.extname):void 0}set stem(n){xv(n,"stem"),yv(n,"stem"),this.path=Yl.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Vr(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function yv(e,n){if(e&&e.includes(Yl.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Yl.sep+"`")}function xv(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function t_(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function SV(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const jV=function(e){const r=this.constructor.prototype,a=r[e],l=function(){return a.apply(l,arguments)};return Object.setPrototypeOf(l,r),l},_V={}.hasOwnProperty;let CV=class Qk extends jV{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=dV()}copy(){const n=new Qk;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(mv(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(wv("data",this.frozen),this.namespace[n]=t,this):_V.call(this.namespace,n)&&this.namespace[n]||void 0:n?(wv("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Ax(n),r=this.parser||this.Parser;return bv("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),bv("process",this.parser||this.Parser),vv("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(l,o){const f=Ax(n),u=r.parse(f);r.run(u,f,function(h,g,b){if(h||!g||!b)return d(h);const v=g,N=r.stringify(v,b);EV(N)?b.value=N:b.result=N,d(h,b)});function d(h,g){h||!g?o(h):l?l(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),bv("processSync",this.parser||this.Parser),vv("processSync",this.compiler||this.Compiler),this.process(n,a),i_("processSync","process",t),r;function a(l,o){t=!0,Zj(l),r=o}}run(n,t,r){n_(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?l(void 0,r):new Promise(l);function l(o,f){const u=Ax(t);a.run(n,u,d);function d(h,g,b){const v=g||n;h?f(h):o?o(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,l),i_("runSync","run",r),a;function l(o,f){Zj(o),a=f,r=!0}}stringify(n,t){this.freeze();const r=Ax(t),a=this.compiler||this.Compiler;return vv("stringify",a),n_(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(wv("use",this.frozen),n!=null)if(typeof n=="function")u(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):o(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function l(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[h,...g]=d;u(h,g)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(d.plugins),d.settings&&(a.settings=mv(!0,a.settings,d.settings))}function f(d){let h=-1;if(d!=null)if(Array.isArray(d))for(;++h<d.length;){const g=d[h];l(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===d){b=g;break}if(b===-1)r.push([d,...h]);else if(h.length>0){let[v,...N]=h;const C=r[b][1];_1(C)&&_1(v)&&(v=mv(!0,C,v)),r[b]=[d,v,...N]}}}};const kV=new CV().freeze();function bv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function vv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function wv(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function n_(e){if(!_1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function i_(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Ax(e){return TV(e)?e:new Wk(e)}function TV(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function EV(e){return typeof e=="string"||AV(e)}function AV(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const PV="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",r_=[],a_={allowDangerousHtml:!0},DV=/^(https?|ircs?|mailto|xmpp)$/i,MV=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function su(e){const n=IV(e),t=RV(e);return LV(n.runSync(n.parse(t),t),e)}function IV(e){const n=e.rehypePlugins||r_,t=e.remarkPlugins||r_,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...a_}:a_;return kV().use(p7).use(t).use(oV,r).use(n)}function RV(e){const n=e.children||"",t=new Wk;return typeof n=="string"&&(t.value=n),t}function LV(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,l=n.disallowedElements,o=n.skipHtml,f=n.unwrapDisallowed,u=n.urlTransform||OV;for(const h of MV)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+PV+h.id,void 0);return Rw(e,d),KU(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function d(h,g,b){if(h.type==="raw"&&b&&typeof g=="number")return o?b.children.splice(g,1):b.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let v;for(v in dv)if(Object.hasOwn(dv,v)&&Object.hasOwn(h.properties,v)){const N=h.properties[v],C=dv[v];(C===null||C.includes(h.tagName))&&(h.properties[v]=u(String(N||""),v,h))}}if(h.type==="element"){let v=t?!t.includes(h.tagName):l?l.includes(h.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(h,g,b)),v&&b&&typeof g=="number")return f&&h.children?b.children.splice(g,1,...h.children):b.children.splice(g,1),g}}}function OV(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||DV.test(e.slice(0,n))?e:""}function s_(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function FV(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function $V(e,n,t){const a=Bb((t||{}).ignore||[]),l=zV(n);let o=-1;for(;++o<l.length;)Yk(e,"text",f);function f(d,h){let g=-1,b;for(;++g<h.length;){const v=h[g],N=b?b.children:void 0;if(a(v,N?N.indexOf(v):void 0,b))return;b=v}if(b)return u(d,h)}function u(d,h){const g=h[h.length-1],b=l[o][0],v=l[o][1];let N=0;const A=g.children.indexOf(d);let T=!1,D=[];b.lastIndex=0;let M=b.exec(d.value);for(;M;){const V=M.index,F={index:M.index,input:M.input,stack:[...h,d]};let z=v(...M,F);if(typeof z=="string"&&(z=z.length>0?{type:"text",value:z}:void 0),z===!1?b.lastIndex=V+1:(N!==V&&D.push({type:"text",value:d.value.slice(N,V)}),Array.isArray(z)?D.push(...z):z&&D.push(z),N=V+M[0].length,T=!0),!b.global)break;M=b.exec(d.value)}return T?(N<d.value.length&&D.push({type:"text",value:d.value.slice(N)}),g.children.splice(A,1,...D)):D=[d],A+D.length}}function zV(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([BV(a[0]),UV(a[1])])}return n}function BV(e){return typeof e=="string"?new RegExp(FV(e),"g"):e}function UV(e){return typeof e=="function"?e:function(){return e}}const Nv="phrasing",Sv=["autolink","link","image","label"];function qV(){return{transforms:[JV],enter:{literalAutolink:HV,literalAutolinkEmail:jv,literalAutolinkHttp:jv,literalAutolinkWww:jv},exit:{literalAutolink:QV,literalAutolinkEmail:WV,literalAutolinkHttp:GV,literalAutolinkWww:YV}}}function VV(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Nv,notInConstruct:Sv},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Nv,notInConstruct:Sv},{character:":",before:"[ps]",after:"\\/",inConstruct:Nv,notInConstruct:Sv}]}}function HV(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function jv(e){this.config.enter.autolinkProtocol.call(this,e)}function GV(e){this.config.exit.autolinkProtocol.call(this,e)}function YV(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function WV(e){this.config.exit.autolinkEmail.call(this,e)}function QV(e){this.exit(e)}function JV(e){$V(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,KV],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),XV]],{ignore:["link","linkReference"]})}function KV(e,n,t,r,a){let l="";if(!Jk(a)||(/^w/i.test(n)&&(t=n+t,n="",l="http://"),!ZV(t)))return!1;const o=eH(t+r);if(!o[0])return!1;const f={type:"link",title:null,url:l+n+o[0],children:[{type:"text",value:n+o[0]}]};return o[1]?[f,{type:"text",value:o[1]}]:f}function XV(e,n,t,r){return!Jk(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function ZV(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function eH(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=s_(e,"(");let l=s_(e,")");for(;r!==-1&&a>l;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),l++;return[e,t]}function Jk(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||Hd(t)||Fb(t))&&(!n||t!==47)}Kk.peek=cH;function tH(){this.buffer()}function nH(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function iH(){this.buffer()}function rH(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function aH(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=rl(this.sliceSerialize(e)).toLowerCase(),t.label=n}function sH(e){this.exit(e)}function lH(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=rl(this.sliceSerialize(e)).toLowerCase(),t.label=n}function oH(e){this.exit(e)}function cH(){return"["}function Kk(e,n,t,r){const a=t.createTracker(r);let l=a.move("[^");const o=t.enter("footnoteReference"),f=t.enter("reference");return l+=a.move(t.safe(t.associationId(e),{after:"]",before:l})),f(),o(),l+=a.move("]"),l}function uH(){return{enter:{gfmFootnoteCallString:tH,gfmFootnoteCall:nH,gfmFootnoteDefinitionLabelString:iH,gfmFootnoteDefinition:rH},exit:{gfmFootnoteCallString:aH,gfmFootnoteCall:sH,gfmFootnoteDefinitionLabelString:lH,gfmFootnoteDefinition:oH}}}function dH(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:Kk},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,l,o){const f=l.createTracker(o);let u=f.move("[^");const d=l.enter("footnoteDefinition"),h=l.enter("label");return u+=f.move(l.safe(l.associationId(r),{before:u,after:"]"})),h(),u+=f.move("]:"),r.children&&r.children.length>0&&(f.shift(4),u+=f.move((n?`
`:" ")+l.indentLines(l.containerFlow(r,f.current()),n?Xk:fH))),d(),u}}function fH(e,n,t){return n===0?e:Xk(e,n,t)}function Xk(e,n,t){return(t?"":"    ")+e}const hH=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Zk.peek=xH;function pH(){return{canContainEols:["delete"],enter:{strikethrough:gH},exit:{strikethrough:yH}}}function mH(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:hH}],handlers:{delete:Zk}}}function gH(e){this.enter({type:"delete",children:[]},e)}function yH(e){this.exit(e)}function Zk(e,n,t,r){const a=t.createTracker(r),l=t.enter("strikethrough");let o=a.move("~~");return o+=t.containerPhrasing(e,{...a.current(),before:o,after:"~"}),o+=a.move("~~"),l(),o}function xH(){return"~"}function bH(e){return e.length}function vH(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||bH,l=[],o=[],f=[],u=[];let d=0,h=-1;for(;++h<e.length;){const C=[],A=[];let T=-1;for(e[h].length>d&&(d=e[h].length);++T<e[h].length;){const D=wH(e[h][T]);if(t.alignDelimiters!==!1){const M=a(D);A[T]=M,(u[T]===void 0||M>u[T])&&(u[T]=M)}C.push(D)}o[h]=C,f[h]=A}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<d;)l[g]=l_(r[g]);else{const C=l_(r);for(;++g<d;)l[g]=C}g=-1;const b=[],v=[];for(;++g<d;){const C=l[g];let A="",T="";C===99?(A=":",T=":"):C===108?A=":":C===114&&(T=":");let D=t.alignDelimiters===!1?1:Math.max(1,u[g]-A.length-T.length);const M=A+"-".repeat(D)+T;t.alignDelimiters!==!1&&(D=A.length+D+T.length,D>u[g]&&(u[g]=D),v[g]=D),b[g]=M}o.splice(1,0,b),f.splice(1,0,v),h=-1;const N=[];for(;++h<o.length;){const C=o[h],A=f[h];g=-1;const T=[];for(;++g<d;){const D=C[g]||"";let M="",V="";if(t.alignDelimiters!==!1){const F=u[g]-(A[g]||0),z=l[g];z===114?M=" ".repeat(F):z===99?F%2?(M=" ".repeat(F/2+.5),V=" ".repeat(F/2-.5)):(M=" ".repeat(F/2),V=M):V=" ".repeat(F)}t.delimiterStart!==!1&&!g&&T.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&D==="")&&(t.delimiterStart!==!1||g)&&T.push(" "),t.alignDelimiters!==!1&&T.push(M),T.push(D),t.alignDelimiters!==!1&&T.push(V),t.padding!==!1&&T.push(" "),(t.delimiterEnd!==!1||g!==d-1)&&T.push("|")}N.push(t.delimiterEnd===!1?T.join("").replace(/ +$/,""):T.join(""))}return N.join(`
`)}function wH(e){return e==null?"":String(e)}function l_(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function NH(e,n,t,r){const a=t.enter("blockquote"),l=t.createTracker(r);l.move("> "),l.shift(2);const o=t.indentLines(t.containerFlow(e,l.current()),SH);return a(),o}function SH(e,n,t){return">"+(t?"":" ")+e}function jH(e,n){return o_(e,n.inConstruct,!0)&&!o_(e,n.notInConstruct,!1)}function o_(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function c_(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&jH(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function _H(e,n){const t=String(e);let r=t.indexOf(n),a=r,l=0,o=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++l>o&&(o=l):l=1,a=r+n.length,r=t.indexOf(n,a);return o}function CH(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function kH(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function TH(e,n,t,r){const a=kH(t),l=e.value||"",o=a==="`"?"GraveAccent":"Tilde";if(CH(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(l,EH);return g(),b}const f=t.createTracker(r),u=a.repeat(Math.max(_H(l,a)+1,3)),d=t.enter("codeFenced");let h=f.move(u);if(e.lang){const g=t.enter(`codeFencedLang${o}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${o}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),l&&(h+=f.move(l+`
`)),h+=f.move(u),d(),h}function EH(e,n,t){return(t?"":"    ")+e}function Lw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function AH(e,n,t,r){const a=Lw(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("definition");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("[");return d+=u.move(t.safe(t.associationId(e),{before:d,after:"]",...u.current()})),d+=u.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":`
`,...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),o(),d}function PH(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function og(e){return"&#x"+e.toString(16).toUpperCase()+";"}function yb(e,n,t){const r=Gh(e),a=Gh(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}eT.peek=DH;function eT(e,n,t,r){const a=PH(t),l=t.enter("emphasis"),o=t.createTracker(r),f=o.move(a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=yb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=og(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=yb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+og(g));const v=o.move(a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function DH(e,n,t){return t.options.emphasis||"*"}function MH(e,n){let t=!1;return Rw(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,S1}),!!((!e.depth||e.depth<3)&&Tw(e)&&(n.options.setext||t))}function IH(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),l=t.createTracker(r);if(MH(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...l.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const o="#".repeat(a),f=t.enter("headingAtx"),u=t.enter("phrasing");l.move(o+" ");let d=t.containerPhrasing(e,{before:"# ",after:`
`,...l.current()});return/^[\t ]/.test(d)&&(d=og(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,t.options.closeAtx&&(d+=" "+o),u(),f(),d}tT.peek=RH;function tT(e){return e.value||""}function RH(){return"<"}nT.peek=LH;function nT(e,n,t,r){const a=Lw(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("image");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("![");return d+=u.move(t.safe(e.alt,{before:d,after:"]",...u.current()})),d+=u.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":")",...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),d+=u.move(")"),o(),d}function LH(){return"!"}iT.peek=OH;function iT(e,n,t,r){const a=e.referenceType,l=t.enter("imageReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("![");const d=t.safe(e.alt,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function OH(){return"!"}rT.peek=FH;function rT(e,n,t){let r=e.value||"",a="`",l=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++l<t.unsafe.length;){const o=t.unsafe[l],f=t.compilePattern(o);let u;if(o.atBreak)for(;u=f.exec(r);){let d=u.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(u.index+1)}}return a+r+a}function FH(){return"`"}function aT(e,n){const t=Tw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}sT.peek=$H;function sT(e,n,t,r){const a=Lw(t),l=a==='"'?"Quote":"Apostrophe",o=t.createTracker(r);let f,u;if(aT(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=o.move("<");return g+=o.move(t.containerPhrasing(e,{before:g,after:">",...o.current()})),g+=o.move(">"),f(),t.stack=h,g}f=t.enter("link"),u=t.enter("label");let d=o.move("[");return d+=o.move(t.containerPhrasing(e,{before:d,after:"](",...o.current()})),d+=o.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=t.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(t.safe(e.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(u=t.enter("destinationRaw"),d+=o.move(t.safe(e.url,{before:d,after:e.title?" ":")",...o.current()}))),u(),e.title&&(u=t.enter(`title${l}`),d+=o.move(" "+a),d+=o.move(t.safe(e.title,{before:d,after:a,...o.current()})),d+=o.move(a),u()),d+=o.move(")"),f(),d}function $H(e,n,t){return aT(e,t)?"<":"["}lT.peek=zH;function lT(e,n,t,r){const a=e.referenceType,l=t.enter("linkReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("[");const d=t.containerPhrasing(e,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function zH(){return"["}function Ow(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function BH(e){const n=Ow(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function UH(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function oT(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function qH(e,n,t,r){const a=t.enter("list"),l=t.bulletCurrent;let o=e.ordered?UH(t):Ow(t);const f=e.ordered?o==="."?")":".":BH(t);let u=n&&t.bulletLastUsed?o===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(u=!0),oT(t)===o&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(o=f),t.bulletCurrent=o;const d=t.containerFlow(e,r);return t.bulletLastUsed=o,t.bulletCurrent=l,a(),d}function VH(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function HH(e,n,t,r){const a=VH(t);let l=t.bulletCurrent||Ow(t);n&&n.type==="list"&&n.ordered&&(l=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+l);let o=l.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(o=Math.ceil(o/4)*4);const f=t.createTracker(r);f.move(l+" ".repeat(o-l.length)),f.shift(o);const u=t.enter("listItem"),d=t.indentLines(t.containerFlow(e,f.current()),h);return u(),d;function h(g,b,v){return b?(v?"":" ".repeat(o))+g:(v?l:l+" ".repeat(o-l.length))+g}}function GH(e,n,t,r){const a=t.enter("paragraph"),l=t.enter("phrasing"),o=t.containerPhrasing(e,r);return l(),a(),o}const YH=Bb(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function WH(e,n,t,r){return(e.children.some(function(o){return YH(o)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function QH(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}cT.peek=JH;function cT(e,n,t,r){const a=QH(t),l=t.enter("strong"),o=t.createTracker(r),f=o.move(a+a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=yb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=og(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=yb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+og(g));const v=o.move(a+a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function JH(e,n,t){return t.options.strong||"*"}function KH(e,n,t,r){return t.safe(e.value,r)}function XH(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function ZH(e,n,t){const r=(oT(t)+(t.options.ruleSpaces?" ":"")).repeat(XH(t));return t.options.ruleSpaces?r.slice(0,-1):r}const uT={blockquote:NH,break:c_,code:TH,definition:AH,emphasis:eT,hardBreak:c_,heading:IH,html:tT,image:nT,imageReference:iT,inlineCode:rT,link:sT,linkReference:lT,list:qH,listItem:HH,paragraph:GH,root:WH,strong:cT,text:KH,thematicBreak:ZH};function eG(){return{enter:{table:tG,tableData:u_,tableHeader:u_,tableRow:iG},exit:{codeText:rG,table:nG,tableData:_v,tableHeader:_v,tableRow:_v}}}function tG(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function nG(e){this.exit(e),this.data.inTable=void 0}function iG(e){this.enter({type:"tableRow",children:[]},e)}function _v(e){this.exit(e)}function u_(e){this.enter({type:"tableCell",children:[]},e)}function rG(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,aG));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function aG(e,n){return n==="|"?n:e}function sG(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,l=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:o,tableCell:u,tableRow:f}};function o(v,N,C,A){return d(h(v,C,A),v.align)}function f(v,N,C,A){const T=g(v,C,A),D=d([T]);return D.slice(0,D.indexOf(`
`))}function u(v,N,C,A){const T=C.enter("tableCell"),D=C.enter("phrasing"),M=C.containerPhrasing(v,{...A,before:l,after:l});return D(),T(),M}function d(v,N){return vH(v,{align:N,alignDelimiters:r,padding:t,stringLength:a})}function h(v,N,C){const A=v.children;let T=-1;const D=[],M=N.enter("table");for(;++T<A.length;)D[T]=g(A[T],N,C);return M(),D}function g(v,N,C){const A=v.children;let T=-1;const D=[],M=N.enter("tableRow");for(;++T<A.length;)D[T]=u(A[T],v,N,C);return M(),D}function b(v,N,C){let A=uT.inlineCode(v,N,C);return C.stack.includes("tableCell")&&(A=A.replace(/\|/g,"\\$&")),A}}function lG(){return{exit:{taskListCheckValueChecked:d_,taskListCheckValueUnchecked:d_,paragraph:cG}}}function oG(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:uG}}}function d_(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function cG(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let l=-1,o;for(;++l<a.length;){const f=a[l];if(f.type==="paragraph"){o=f;break}}o===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function uG(e,n,t,r){const a=e.children[0],l=typeof e.checked=="boolean"&&a&&a.type==="paragraph",o="["+(e.checked?"x":" ")+"] ",f=t.createTracker(r);l&&f.move(o);let u=uT.listItem(e,n,t,{...r,...f.current()});return l&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),u;function d(h){return h+o}}function dG(){return[qV(),uH(),pH(),eG(),lG()]}function fG(e){return{extensions:[VV(),dH(e),mH(),sG(e),oG()]}}const hG={tokenize:bG,partial:!0},dT={tokenize:vG,partial:!0},fT={tokenize:wG,partial:!0},hT={tokenize:NG,partial:!0},pG={tokenize:SG,partial:!0},pT={name:"wwwAutolink",tokenize:yG,previous:gT},mT={name:"protocolAutolink",tokenize:xG,previous:yT},nc={name:"emailAutolink",tokenize:gG,previous:xT},io={};function mG(){return{text:io}}let Md=48;for(;Md<123;)io[Md]=nc,Md++,Md===58?Md=65:Md===91&&(Md=97);io[43]=nc;io[45]=nc;io[46]=nc;io[95]=nc;io[72]=[nc,mT];io[104]=[nc,mT];io[87]=[nc,pT];io[119]=[nc,pT];function gG(e,n,t){const r=this;let a,l;return o;function o(g){return!k1(g)||!xT.call(r,r.previous)||Fw(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),f(g))}function f(g){return k1(g)?(e.consume(g),f):g===64?(e.consume(g),u):t(g)}function u(g){return g===46?e.check(pG,h,d)(g):g===45||g===95||Br(g)?(l=!0,e.consume(g),u):h(g)}function d(g){return e.consume(g),a=!0,u}function h(g){return l&&a&&la(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function yG(e,n,t){const r=this;return a;function a(o){return o!==87&&o!==119||!gT.call(r,r.previous)||Fw(r.events)?t(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(hG,e.attempt(dT,e.attempt(fT,l),t),t)(o))}function l(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(o)}}function xG(e,n,t){const r=this;let a="",l=!1;return o;function o(g){return(g===72||g===104)&&yT.call(r,r.previous)&&!Fw(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),f):t(g)}function f(g){if(la(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),f;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),u}return t(g)}function u(g){return g===47?(e.consume(g),l?d:(l=!0,u)):t(g)}function d(g){return g===null||pb(g)||ci(g)||Hd(g)||Fb(g)?t(g):e.attempt(dT,e.attempt(fT,h),t)(g)}function h(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function bG(e,n,t){let r=0;return a;function a(o){return(o===87||o===119)&&r<3?(r++,e.consume(o),a):o===46&&r===3?(e.consume(o),l):t(o)}function l(o){return o===null?t(o):n(o)}}function vG(e,n,t){let r,a,l;return o;function o(d){return d===46||d===95?e.check(hT,u,f)(d):d===null||ci(d)||Hd(d)||d!==45&&Fb(d)?u(d):(l=!0,e.consume(d),o)}function f(d){return d===95?r=!0:(a=r,r=void 0),e.consume(d),o}function u(d){return a||r||!l?t(d):n(d)}}function wG(e,n){let t=0,r=0;return a;function a(o){return o===40?(t++,e.consume(o),a):o===41&&r<t?l(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(hT,n,l)(o):o===null||ci(o)||Hd(o)?n(o):(e.consume(o),a)}function l(o){return o===41&&r++,e.consume(o),a}}function NG(e,n,t){return r;function r(f){return f===33||f===34||f===39||f===41||f===42||f===44||f===46||f===58||f===59||f===63||f===95||f===126?(e.consume(f),r):f===38?(e.consume(f),l):f===93?(e.consume(f),a):f===60||f===null||ci(f)||Hd(f)?n(f):t(f)}function a(f){return f===null||f===40||f===91||ci(f)||Hd(f)?n(f):r(f)}function l(f){return la(f)?o(f):t(f)}function o(f){return f===59?(e.consume(f),r):la(f)?(e.consume(f),o):t(f)}}function SG(e,n,t){return r;function r(l){return e.consume(l),a}function a(l){return Br(l)?t(l):n(l)}}function gT(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||ci(e)}function yT(e){return!la(e)}function xT(e){return!(e===47||k1(e))}function k1(e){return e===43||e===45||e===46||e===95||Br(e)}function Fw(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const jG={tokenize:DG,partial:!0};function _G(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:EG,continuation:{tokenize:AG},exit:PG}},text:{91:{name:"gfmFootnoteCall",tokenize:TG},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:CG,resolveTo:kG}}}}function CG(e,n,t){const r=this;let a=r.events.length;const l=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;a--;){const u=r.events[a][1];if(u.type==="labelImage"){o=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return f;function f(u){if(!o||!o._balanced)return t(u);const d=rl(r.sliceSerialize({start:o.end,end:r.now()}));return d.codePointAt(0)!==94||!l.includes(d.slice(1))?t(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),n(u))}}function kG(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const l={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},l.start),end:Object.assign({},l.end)},f=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",l,n],["enter",o,n],["exit",o,n],["exit",l,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...f),e}function TG(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l=0,o;return f;function f(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),u}function u(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",d)}function d(g){if(l>999||g===93&&!o||g===null||g===91||ci(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(rl(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return ci(g)||(o=!0),l++,e.consume(g),g===92?h:d}function h(g){return g===91||g===92||g===93?(e.consume(g),l++,d):d(g)}}function EG(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l,o=0,f;return u;function u(N){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(N),e.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(N){return N===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(N),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):t(N)}function h(N){if(o>999||N===93&&!f||N===null||N===91||ci(N))return t(N);if(N===93){e.exit("chunkString");const C=e.exit("gfmFootnoteDefinitionLabelString");return l=rl(r.sliceSerialize(C)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(N),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return ci(N)||(f=!0),o++,e.consume(N),N===92?g:h}function g(N){return N===91||N===92||N===93?(e.consume(N),o++,h):h(N)}function b(N){return N===58?(e.enter("definitionMarker"),e.consume(N),e.exit("definitionMarker"),a.includes(l)||a.push(l),Pn(e,v,"gfmFootnoteDefinitionWhitespace")):t(N)}function v(N){return n(N)}}function AG(e,n,t){return e.check(yg,n,e.attempt(jG,n,t))}function PG(e){e.exit("gfmFootnoteDefinition")}function DG(e,n,t){const r=this;return Pn(e,a,"gfmFootnoteDefinitionIndent",5);function a(l){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?n(l):t(l)}}function MG(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:l,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(o,f){let u=-1;for(;++u<o.length;)if(o[u][0]==="enter"&&o[u][1].type==="strikethroughSequenceTemporary"&&o[u][1]._close){let d=u;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[u][1].end.offset-o[u][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[u][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[u][1].end)},g={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[u][1].start)},b=[["enter",h,f],["enter",o[d][1],f],["exit",o[d][1],f],["enter",g,f]],v=f.parser.constructs.insideSpan.null;v&&ns(b,b.length,0,$b(v,o.slice(d+1,u),f)),ns(b,b.length,0,[["exit",g,f],["enter",o[u][1],f],["exit",o[u][1],f],["exit",h,f]]),ns(o,d-1,u-d+3,b),u=d+b.length-2;break}}for(u=-1;++u<o.length;)o[u][1].type==="strikethroughSequenceTemporary"&&(o[u][1].type="data");return o}function l(o,f,u){const d=this.previous,h=this.events;let g=0;return b;function b(N){return d===126&&h[h.length-1][1].type!=="characterEscape"?u(N):(o.enter("strikethroughSequenceTemporary"),v(N))}function v(N){const C=Gh(d);if(N===126)return g>1?u(N):(o.consume(N),g++,v);if(g<2&&!t)return u(N);const A=o.exit("strikethroughSequenceTemporary"),T=Gh(N);return A._open=!T||T===2&&!!C,A._close=!C||C===2&&!!T,f(N)}}}class IG{constructor(){this.map=[]}add(n,t,r){RG(this,n,t,r)}consume(n){if(this.map.sort(function(l,o){return l[0]-o[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const l of a)n.push(l);a=r.pop()}this.map.length=0}}function RG(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function LG(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const l=r.length-1;r[l]=r[l]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function OG(){return{flow:{null:{name:"table",tokenize:FG,resolveAll:$G}}}}function FG(e,n,t){const r=this;let a=0,l=0,o;return f;function f(O){let $=r.events.length-1;for(;$>-1;){const ne=r.events[$][1].type;if(ne==="lineEnding"||ne==="linePrefix")$--;else break}const W=$>-1?r.events[$][1].type:null,te=W==="tableHead"||W==="tableRow"?z:u;return te===z&&r.parser.lazy[r.now().line]?t(O):te(O)}function u(O){return e.enter("tableHead"),e.enter("tableRow"),d(O)}function d(O){return O===124||(o=!0,l+=1),h(O)}function h(O){return O===null?t(O):qt(O)?l>1?(l=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(O),e.exit("lineEnding"),v):t(O):_n(O)?Pn(e,h,"whitespace")(O):(l+=1,o&&(o=!1,a+=1),O===124?(e.enter("tableCellDivider"),e.consume(O),e.exit("tableCellDivider"),o=!0,h):(e.enter("data"),g(O)))}function g(O){return O===null||O===124||ci(O)?(e.exit("data"),h(O)):(e.consume(O),O===92?b:g)}function b(O){return O===92||O===124?(e.consume(O),g):g(O)}function v(O){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(O):(e.enter("tableDelimiterRow"),o=!1,_n(O)?Pn(e,N,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(O):N(O))}function N(O){return O===45||O===58?A(O):O===124?(o=!0,e.enter("tableCellDivider"),e.consume(O),e.exit("tableCellDivider"),C):F(O)}function C(O){return _n(O)?Pn(e,A,"whitespace")(O):A(O)}function A(O){return O===58?(l+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(O),e.exit("tableDelimiterMarker"),T):O===45?(l+=1,T(O)):O===null||qt(O)?V(O):F(O)}function T(O){return O===45?(e.enter("tableDelimiterFiller"),D(O)):F(O)}function D(O){return O===45?(e.consume(O),D):O===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(O),e.exit("tableDelimiterMarker"),M):(e.exit("tableDelimiterFiller"),M(O))}function M(O){return _n(O)?Pn(e,V,"whitespace")(O):V(O)}function V(O){return O===124?N(O):O===null||qt(O)?!o||a!==l?F(O):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(O)):F(O)}function F(O){return t(O)}function z(O){return e.enter("tableRow"),B(O)}function B(O){return O===124?(e.enter("tableCellDivider"),e.consume(O),e.exit("tableCellDivider"),B):O===null||qt(O)?(e.exit("tableRow"),n(O)):_n(O)?Pn(e,B,"whitespace")(O):(e.enter("data"),U(O))}function U(O){return O===null||O===124||ci(O)?(e.exit("data"),B(O)):(e.consume(O),O===92?R:U)}function R(O){return O===92||O===124?(e.consume(O),U):U(O)}}function $G(e,n){let t=-1,r=!0,a=0,l=[0,0,0,0],o=[0,0,0,0],f=!1,u=0,d,h,g;const b=new IG;for(;++t<e.length;){const v=e[t],N=v[1];v[0]==="enter"?N.type==="tableHead"?(f=!1,u!==0&&(f_(b,n,u,d,h),h=void 0,u=0),d={type:"table",start:Object.assign({},N.start),end:Object.assign({},N.end)},b.add(t,0,[["enter",d,n]])):N.type==="tableRow"||N.type==="tableDelimiterRow"?(r=!0,g=void 0,l=[0,0,0,0],o=[0,t+1,0,0],f&&(f=!1,h={type:"tableBody",start:Object.assign({},N.start),end:Object.assign({},N.end)},b.add(t,0,[["enter",h,n]])),a=N.type==="tableDelimiterRow"?2:h?3:1):a&&(N.type==="data"||N.type==="tableDelimiterMarker"||N.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(l[1]!==0&&(o[0]=o[1],g=Px(b,n,l,a,void 0,g),l=[0,0,0,0]),o[2]=t)):N.type==="tableCellDivider"&&(r?r=!1:(l[1]!==0&&(o[0]=o[1],g=Px(b,n,l,a,void 0,g)),l=o,o=[l[1],t,0,0])):N.type==="tableHead"?(f=!0,u=t):N.type==="tableRow"||N.type==="tableDelimiterRow"?(u=t,l[1]!==0?(o[0]=o[1],g=Px(b,n,l,a,t,g)):o[1]!==0&&(g=Px(b,n,o,a,t,g)),a=0):a&&(N.type==="data"||N.type==="tableDelimiterMarker"||N.type==="tableDelimiterFiller")&&(o[3]=t)}for(u!==0&&f_(b,n,u,d,h),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=LG(n.events,t))}return e}function Px(e,n,t,r,a,l){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",f="tableContent";t[0]!==0&&(l.end=Object.assign({},Ah(n.events,t[0])),e.add(t[0],0,[["exit",l,n]]));const u=Ah(n.events,t[1]);if(l={type:o,start:Object.assign({},u),end:Object.assign({},u)},e.add(t[1],0,[["enter",l,n]]),t[2]!==0){const d=Ah(n.events,t[2]),h=Ah(n.events,t[3]),g={type:f,start:Object.assign({},d),end:Object.assign({},h)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const N=t[2]+1,C=t[3]-t[2]-1;e.add(N,C,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(l.end=Object.assign({},Ah(n.events,a)),e.add(a,0,[["exit",l,n]]),l=void 0),l}function f_(e,n,t,r,a){const l=[],o=Ah(n.events,t);a&&(a.end=Object.assign({},o),l.push(["exit",a,n])),r.end=Object.assign({},o),l.push(["exit",r,n]),e.add(t+1,0,l)}function Ah(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const zG={name:"tasklistCheck",tokenize:UG};function BG(){return{text:{91:zG}}}function UG(e,n,t){const r=this;return a;function a(u){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),l)}function l(u){return ci(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),o):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),o):t(u)}function o(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),f):t(u)}function f(u){return qt(u)?n(u):_n(u)?e.check({tokenize:qG},n,t)(u):t(u)}}function qG(e,n,t){return Pn(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function VG(e){return Tk([mG(),_G(),MG(e),OG(),BG()])}const HG={};function Go(e){const n=this,t=e||HG,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),l=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(VG(t)),l.push(dG()),o.push(fG(t))}const GG=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},YG=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},Cv=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,noDataText:l,onDeleteItem:o,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:d,onLabOrderTestChange:h,onLabOrderStatusChange:g,onEditPharmacyOrder:b,onPrintUnavailablePrescription:v,onBillLabOrder:N,onUpdateLabOrderStatus:C,onEnterLabReport:A,onViewLabReport:T,onMarkAsRecurring:D,labInventory:M=[],isSavingLabOrder:V=!1,expandedLabReports:F={},toggleLabReport:z=()=>{}})=>{const B=w.useMemo(()=>{const R={};n.forEach($=>{if(isNaN($.date.getTime())){R["Unknown Date"]||(R["Unknown Date"]=[]),R["Unknown Date"].push($);return}const W=GG($.originalDateString);R[W]||(R[W]=[]),R[W].push($)});const O=Object.keys(R);return O.sort(($,W)=>{if($==="Unknown Date")return 1;if(W==="Unknown Date")return-1;try{const te=new Date($.split(" ").reverse().join(" ")),ne=new Date(W.split(" ").reverse().join(" "));if(!isNaN(te.getTime())&&!isNaN(ne.getTime()))return ne.getTime()-te.getTime()}catch{}return W.localeCompare($)}),O.map($=>({date:$,items:R[$]}))},[n]),U=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:l}),a&&i.jsx("div",{className:"space-y-3",children:[1,2,3].map(R=>i.jsx("div",{className:"skeleton-block",style:{height:"80px"}},R))}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:B.map(({date:R,items:O})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:R}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:O.map(($,W)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",style:{"--i":W},children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t($,W,F,z)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[$.type==="Lab Order"&&!$.data.isEditing&&f&&i.jsx("button",{onClick:()=>f($.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:V,children:i.jsx(ru,{size:14})}),$.type==="Lab Order"&&$.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>u&&u($.data.id,$.data.editedTests,$.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:V,children:i.jsx(uu,{size:14})}),i.jsx("button",{onClick:()=>d&&d($.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:V,children:i.jsx(Pi,{size:14})})]}),$.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[$.data.status==="pending"&&N&&(()=>{const te=$.data.tests.reduce((ne,re)=>ne+(Number(re.price)||0),0).toFixed(2);return i.jsxs("button",{onClick:()=>N($.data),className:"lab-action-button btn-bill",title:`Pay total of ${te}`,children:["Pay (",te,")"]})})(),$.data.status==="billed"&&C&&i.jsx("button",{onClick:()=>C($.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),$.data.status==="collected"&&C&&i.jsx("button",{onClick:()=>C($.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),($.data.status==="processing"||$.data.status==="report_ready"||$.data.status==="reported")&&A&&i.jsx("button",{onClick:()=>A($.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),($.data.status==="report_ready"||$.data.status==="reported")&&C&&i.jsx("button",{onClick:()=>C($.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),($.data.status==="completed"||$.data.status==="report_ready"||$.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T($.data),className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]}),$.type==="Pharmacy Order"&&$.data.status==="pending"&&b&&i.jsx("button",{onClick:()=>b($.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:V,children:i.jsx(ru,{size:14})}),$.type==="Pharmacy Order"&&$.data.prescriptionForUnavailableDrugs&&v&&i.jsx("button",{onClick:()=>v($.data.prescriptionForUnavailableDrugs,`Prescription for Order ${$.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:V,children:i.jsx(il,{size:14})}),$.type==="Pharmacy Order"&&D&&i.jsx("button",{onClick:()=>D($.data.id),className:"text-teal-600 hover:text-teal-800 p-1 rounded hover:bg-teal-100 focus:outline-none focus:ring-1 focus:ring-teal-400",title:"Mark as Recurring Medication",disabled:V,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[i.jsx("path",{d:"m17 2 4 4-4 4"}),i.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),i.jsx("path",{d:"m7 22-4-4 4-4"}),i.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]})}),$.type==="Pharmacy Order"&&$.data.status==="pending"&&o&&i.jsx("button",{onClick:()=>o({type:$.type,data:$.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:V,children:i.jsx(Pi,{size:14})}),o&&["Complaint","Lab Order","Lab Report"].includes($.type)&&i.jsx("button",{onClick:()=>o({type:$.type,data:$.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${$.type.toLowerCase()}`,disabled:V,children:i.jsx(Pi,{size:14})})]})]}),$.type==="Lab Order"&&$.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:$.data.editedStatus||$.data.status,onChange:te=>g&&g($.data.id,te.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:V,children:U.map(te=>i.jsx("option",{value:te,children:te.replace(/_/g," ")},te))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),$.data.editedTests.map((te,ne)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:te.id,onChange:re=>{const J=M.find(q=>String(q.id)===re.target.value);J&&(h&&h($.data.id,ne,"id",J.id),h&&h($.data.id,ne,"name",J.name),h&&h($.data.id,ne,"price",J.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:V,children:[i.jsx("option",{value:"",children:"Select Test"}),M.map(re=>i.jsxs("option",{value:re.id,children:[re.name," (",re.price,")"]},re.id))]}),i.jsx("button",{onClick:()=>{const re=$.data.editedTests.filter((J,q)=>q!==ne);h&&h($.data.id,-1,"remove",re)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:V,children:i.jsx(Pi,{size:14})})]},ne)),i.jsx("button",{onClick:()=>{h&&h($.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:V,children:"Add Test"})]})]},`${$.type}-${$.originalDateString}-${W}`))})]},R))})]})},WG="_modalOverlay_1yna4_3",QG="_modalContent_1yna4_29",JG="_modalHeader_1yna4_57",KG="_modalTitle_1yna4_75",XG="_modalCloseButton_1yna4_87",ZG="_modalBody_1yna4_115",eY="_errorText_1yna4_129",tY="_formGroup_1yna4_147",nY="_inputField_1yna4_171",iY="_searchResultsCard_1yna4_213",rY="_searchResultsList_1yna4_241",aY="_searchResultItem_1yna4_253",sY="_searchResultPrice_1yna4_289",lY="_selectedTestsCard_1yna4_299",oY="_selectedTestsHeader_1yna4_319",cY="_noTestsMessage_1yna4_335",uY="_selectedTestsList_1yna4_351",dY="_selectedTestItem_1yna4_363",fY="_selectedTestName_1yna4_387",hY="_selectedTestPrice_1yna4_399",pY="_removeTestButton_1yna4_411",mY="_totalAmount_1yna4_437",gY="_modalFooter_1yna4_455",yY="_button_1yna4_473",xY="_buttonPrimary_1yna4_491",bY="_buttonSecondary_1yna4_513",ai={modalOverlay:WG,modalContent:QG,modalHeader:JG,modalTitle:KG,modalCloseButton:XG,modalBody:ZG,errorText:eY,formGroup:tY,inputField:nY,searchResultsCard:iY,searchResultsList:rY,searchResultItem:aY,searchResultPrice:sY,selectedTestsCard:lY,selectedTestsHeader:oY,noTestsMessage:cY,selectedTestsList:uY,selectedTestItem:dY,selectedTestName:fY,selectedTestPrice:hY,removeTestButton:pY,totalAmount:mY,modalFooter:gY,button:yY,buttonPrimary:xY,buttonSecondary:bY},vY=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState([]),[g,b]=w.useState(null),[v,N]=w.useState(!1);w.useEffect(()=>{if(!f){h([]);return}const D=f.toLowerCase();h(r.filter(M=>M.name.toLowerCase().includes(D)||M.description&&M.description.toLowerCase().includes(D)).slice(0,10))},[f,r]);const C=async()=>{if(!t){b("Patient ID is missing.");return}if(l.length===0){b("Please select at least one lab test.");return}N(!0),b(null);try{const D={patient_id:t,tests:l.map(V=>({id:V.id,name:V.name,price:V.price}))},M=await ue("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!M.ok){const V=await M.json().catch(()=>({}));throw new Error(V.message||`Failed to create lab order: ${M.statusText}`)}await M.json(),a(t),n(),o([]),u("")}catch(D){b(`Lab Order Creation Error: ${D.message}`)}finally{N(!1)}},A=D=>{if(l.some(M=>M.id===D.id)){b(`${D.name} is already in the order.`),setTimeout(()=>b(null),3e3),u(""),h([]);return}o(M=>[...M,{...D}]),u(""),h([])},T=D=>{o(M=>M.filter(V=>V.id!==D))};return e?i.jsx("div",{className:ai.modalOverlay,children:i.jsxs("div",{className:ai.modalContent,children:[i.jsxs("div",{className:ai.modalHeader,children:[i.jsx("h3",{className:ai.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:ai.modalCloseButton,children:i.jsx(gi,{size:20})})]}),i.jsxs("div",{className:ai.modalBody,children:[g&&i.jsx("div",{className:ai.errorText,children:g}),i.jsxs("div",{className:ai.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:f,onChange:D=>u(D.target.value),className:ai.inputField}),f&&d.length>0&&i.jsx("div",{className:ai.searchResultsCard,children:i.jsx("ul",{className:ai.searchResultsList,children:d.map(D=>i.jsxs("li",{onClick:()=>A(D),className:ai.searchResultItem,children:[i.jsx("span",{children:D.name}),i.jsxs("span",{className:ai.searchResultPrice,children:["(",parseFloat(String(D.price)).toFixed(2),")"]})]},D.id))})})]}),i.jsxs("div",{className:ai.selectedTestsCard,children:[i.jsx("h4",{className:ai.selectedTestsHeader,children:"Selected Tests"}),l.length===0?i.jsx("p",{className:ai.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:ai.selectedTestsList,children:l.map(D=>i.jsxs("li",{className:ai.selectedTestItem,children:[i.jsx("span",{className:ai.selectedTestName,children:D.name}),i.jsxs("span",{className:ai.selectedTestPrice,children:["",parseFloat(String(D.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>T(String(D.id)),className:ai.removeTestButton,title:"Remove Test",children:i.jsx(Pi,{size:16})})]},D.id))})]}),l.length>0&&i.jsxs("div",{className:ai.totalAmount,children:["Total: ",l.reduce((D,M)=>D+parseFloat(String(M.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:ai.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${ai.button} ${ai.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:C,disabled:l.length===0||v,className:`${ai.button} ${ai.buttonPrimary} ${l.length===0||v?ai.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},wY="_modalOverlay_7kwn4_3",NY="_modalContent_7kwn4_29",SY="_modalHeader_7kwn4_61",jY="_modalTitle_7kwn4_79",_Y="_modalCloseButton_7kwn4_93",CY="_modalBody_7kwn4_129",kY="_errorText_7kwn4_141",TY="_formGroup_7kwn4_161",EY="_stickySearchHeader_7kwn4_173",AY="_inputField_7kwn4_211",PY="_searchResultsCard_7kwn4_253",DY="_searchResultsList_7kwn4_281",MY="_searchResultItem_7kwn4_293",IY="_searchResultPrice_7kwn4_323",RY="_selectedTestsCard_7kwn4_335",LY="_selectedTestsHeader_7kwn4_351",OY="_noTestsMessage_7kwn4_375",FY="_selectedTestsList_7kwn4_395",$Y="_selectedTestItem_7kwn4_413",zY="_selectedTestHeader_7kwn4_441",BY="_selectedTestName_7kwn4_457",UY="_selectedTestInputs_7kwn4_469",qY="_inputGroup_7kwn4_481",VY="_quantityInput_7kwn4_503",HY="_removeTestButton_7kwn4_523",GY="_textareaField_7kwn4_559",YY="_modalFooter_7kwn4_573",WY="_button_7kwn4_591",QY="_buttonPrimary_7kwn4_615",JY="_buttonSecondary_7kwn4_637",KY="_buttonDisabled_7kwn4_659",Sn={modalOverlay:wY,modalContent:NY,modalHeader:SY,modalTitle:jY,modalCloseButton:_Y,modalBody:CY,errorText:kY,formGroup:TY,stickySearchHeader:EY,inputField:AY,searchResultsCard:PY,searchResultsList:DY,searchResultItem:MY,searchResultPrice:IY,selectedTestsCard:RY,selectedTestsHeader:LY,noTestsMessage:OY,selectedTestsList:FY,selectedTestItem:$Y,selectedTestHeader:zY,selectedTestName:BY,selectedTestInputs:UY,inputGroup:qY,quantityInput:VY,removeTestButton:HY,textareaField:GY,modalFooter:YY,button:WY,buttonPrimary:QY,buttonSecondary:JY,buttonDisabled:KY},XY=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState([]),[g,b]=w.useState(null),[v,N]=w.useState(!1),[C,A]=w.useState(""),T=w.useRef(null);w.useEffect(()=>{if(!f){h([]);return}const U=f.toLowerCase();h(r.filter(R=>R.name.toLowerCase().includes(U)).slice(0,10))},[f,r]),w.useEffect(()=>{T.current&&(T.current.style.height="auto",T.current.style.height=`${T.current.scrollHeight}px`)},[C]);const D=U=>{if(!U)return null;const R=U.match(/(?:\d+x)?(\d+)/);return R?parseInt(R[1],10):null},M=qn.useMemo(()=>l.reduce((U,R)=>{const O=R.pack_price||0,$=R.loose_price||0,W=(R.pack_quantity||0)*O,te=(R.loose_quantity||0)*$;return U+W+te},0),[l]),V=async()=>{if(!t){b("Patient ID is missing.");return}if(l.length===0&&!C.trim()){b("Please select at least one medication or provide a prescription.");return}N(!0),b(null);try{const U={patient_id:t,items:l.map(O=>({drug_id:O.drug_id,name:O.name,pack_quantity:O.pack_quantity||0,loose_quantity:O.loose_quantity||0,price:O.price,pack_price:O.pack_price||0,loose_price:O.loose_price||0,total_price:(O.pack_quantity||0)*(O.pack_price||0)+(O.loose_quantity||0)*(O.loose_price||0),unit:O.unit})),prescription_for_unavailable_drugs:C,status:"pending",date:new Date().toISOString(),order_total:M},R=await ue("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(!R.ok){const O=await R.json().catch(()=>({}));throw new Error(O.message||`Failed to create pharmacy order: ${R.statusText}`)}await R.json(),a(t),n(),o([]),u(""),A("")}catch(U){b(`Pharmacy Order Creation Error: ${U.message}`)}finally{N(!1)}},F=U=>{if(l.some(W=>W.drug_id===U.id)){b(`${U.name} is already in the order.`),setTimeout(()=>b(null),3e3),u(""),h([]);return}const R=D(U.unit),O=Number(U.price)||0,$=O/(R||1);o(W=>[...W,{drug_id:U.id,name:U.name,price:U.price,pack_price:O,loose_price:$,pack_quantity:1,loose_quantity:0,unit:U.unit}]),u(""),h([])},z=U=>{o(R=>R.filter(O=>O.drug_id!==U))},B=(U,R,O)=>{o($=>$.map(W=>W.drug_id===U?{...W,[R]:O}:W))};return e?i.jsx("div",{className:Sn.modalOverlay,children:i.jsxs("div",{className:Sn.modalContent,children:[i.jsxs("div",{className:Sn.modalHeader,children:[i.jsx("h3",{className:Sn.modalTitle,children:"Create New Pharmacy Order"}),i.jsx("button",{onClick:n,className:Sn.modalCloseButton,children:i.jsx(gi,{size:20})})]}),i.jsxs("div",{className:Sn.modalBody,children:[i.jsxs("div",{className:`${Sn.formGroup} ${Sn.stickySearchHeader}`,children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Medication"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:f,onChange:U=>u(U.target.value),className:Sn.inputField}),f&&d.length>0&&i.jsx("div",{className:Sn.searchResultsCard,children:i.jsx("ul",{className:Sn.searchResultsList,children:d.map(U=>i.jsxs("li",{onClick:()=>F(U),className:Sn.searchResultItem,children:[i.jsx("span",{children:U.name}),i.jsxs("span",{className:Sn.searchResultPrice,children:["(",parseFloat(String(U.price)).toFixed(2),")"]})]},U.id))})})]}),g&&i.jsx("div",{className:Sn.errorText,children:g}),i.jsxs("div",{className:Sn.selectedTestsCard,children:[i.jsx("h4",{className:Sn.selectedTestsHeader,children:"Selected Medications"}),l.length===0?i.jsx("p",{className:Sn.noTestsMessage,children:"No medications added yet."}):i.jsx("ul",{className:Sn.selectedTestsList,children:l.map(U=>i.jsxs("li",{className:Sn.selectedTestItem,children:[i.jsxs("div",{className:Sn.selectedTestHeader,children:[i.jsx("span",{className:Sn.selectedTestName,children:U.name}),i.jsx("button",{type:"button",onClick:()=>z(U.drug_id),className:Sn.removeTestButton,title:"Remove Medication",children:i.jsx(Pi,{size:16})})]}),i.jsxs("div",{className:Sn.selectedTestInputs,children:[i.jsxs("div",{className:Sn.inputGroup,children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:U.pack_quantity,onChange:R=>B(U.drug_id,"pack_quantity",parseInt(R.target.value)||0),className:Sn.quantityInput})]}),i.jsxs("div",{className:Sn.inputGroup,children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:U.loose_quantity,onChange:R=>B(U.drug_id,"loose_quantity",parseInt(R.target.value)||0),className:Sn.quantityInput})]})]})]},U.drug_id))})]}),l.length>0&&i.jsxs("div",{className:Sn.totalAmount,children:["Total: ",M.toFixed(2)]}),i.jsxs("div",{className:Sn.formGroup,style:{marginTop:"20px"},children:[i.jsx("label",{htmlFor:"prescription-notes",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-notes",ref:T,rows:1,value:C,onChange:U=>A(U.target.value),placeholder:"Enter any additional notes or prescription details...",className:`${Sn.inputField} ${Sn.textareaField}`})]})]}),i.jsxs("div",{className:Sn.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Sn.button} ${Sn.buttonSecondary}`,children:" Cancel "}),i.jsx("button",{type:"button",onClick:V,disabled:l.length===0&&!C.trim()||v,className:`${Sn.button} ${Sn.buttonPrimary} ${l.length===0&&!C.trim()||v?Sn.buttonDisabled:""}`,children:v?"Saving...":"Create Order"})]})]})}):null},ZY="_modalOverlay_13u8a_1",eW="_modalContent_13u8a_45",tW="_modalHeader_13u8a_99",nW="_modalTitle_13u8a_117",iW="_modalCloseButton_13u8a_139",rW="_modalBody_13u8a_177",aW="_section_13u8a_197",sW="_sectionTitle_13u8a_209",lW="_settingsGrid_13u8a_233",oW="_inputWrapper_13u8a_253",cW="_label_13u8a_265",uW="_inputGroup_13u8a_277",dW="_inputIcon_13u8a_289",fW="_inputField_13u8a_303",hW="_inputFieldWithAction_13u8a_327",pW="_selectField_13u8a_345",mW="_searchArea_13u8a_363",gW="_searchResults_13u8a_371",yW="_searchItem_13u8a_425",xW="_drugName_13u8a_461",bW="_drugInfo_13u8a_471",vW="_medList_13u8a_483",wW="_medCard_13u8a_495",NW="_medCardHeader_13u8a_529",SW="_medName_13u8a_541",jW="_medCardGrid_13u8a_553",_W="_removeMedBtn_13u8a_565",CW="_errorBanner_13u8a_595",kW="_modalFooter_13u8a_621",TW="_btn_13u8a_639",EW="_btnSecondary_13u8a_663",AW="_btnPrimary_13u8a_683",PW="_spinner_13u8a_717",DW="_noMeds_13u8a_747",wt={modalOverlay:ZY,modalContent:eW,modalHeader:tW,modalTitle:nW,modalCloseButton:iW,modalBody:rW,section:aW,sectionTitle:sW,settingsGrid:lW,inputWrapper:oW,label:cW,inputGroup:uW,inputIcon:dW,inputField:fW,inputFieldWithAction:hW,selectField:pW,searchArea:mW,searchResults:gW,searchItem:yW,drugName:xW,drugInfo:bW,medList:vW,medCard:wW,medCardHeader:NW,medName:SW,medCardGrid:jW,removeMedBtn:_W,errorBanner:CW,modalFooter:kW,btn:TW,btnSecondary:EW,btnPrimary:AW,spinner:PW,noMeds:DW},bT=({isOpen:e,onClose:n,recurringMedication:t,onUpdate:r,inventory:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(30),[d,h]=w.useState("active"),[g,b]=w.useState(""),[v,N]=w.useState(""),[C,A]=w.useState([]),[T,D]=w.useState(!1),[M,V]=w.useState(null);w.useEffect(()=>{e&&t&&(o([...t.medications]),u(t.frequency_days||30),h(t.status),b(new Date(t.next_delivery_date).toISOString().split("T")[0]),V(null))},[e,t]),w.useEffect(()=>{if(v.trim().length>1){const R=v.toLowerCase(),O=a.filter($=>$.name&&$.name.toLowerCase().includes(R)).slice(0,5);A(O)}else A([])},[v,a]);const F=R=>{if(l.some(W=>W.drug_id===R.id)){V(`${R.name} is already in the list.`);return}const $={drug_id:R.id,name:R.name,pack_quantity:1,loose_quantity:0,pack_price:R.price,unit:R.unit,total_price:R.price};o([...l,$]),N(""),A([]),V(null)},z=R=>{const O=[...l];O.splice(R,1),o(O)},B=(R,O,$)=>{const W=[...l];O==="pack_quantity"||O==="loose_quantity"||O==="tabletsPerDay"||O==="numberOfDays"?W[R]={...W[R],[O]:Math.max(0,Number($))}:W[R]={...W[R],[O]:$},o(W)},U=async()=>{if(l.length===0){V("Please add at least one medication.");return}D(!0),V(null);try{const R=await ue(`/api/recurring-medications/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({medications:l,frequency_days:f,status:d,next_delivery_date:g})});if(!R.ok){const $=await R.json();throw new Error($.message||"Failed to update recurring medication")}const O=await R.json();r(O),n()}catch(R){V(R.message)}finally{D(!1)}};return e?i.jsx("div",{className:wt.modalOverlay,children:i.jsxs("div",{className:wt.modalContent,children:[i.jsxs("div",{className:wt.modalHeader,children:[i.jsx("h2",{className:wt.modalTitle,children:"Edit Recurring Medication"}),i.jsx("button",{onClick:n,className:wt.modalCloseButton,title:"Close",children:i.jsx(gi,{size:24})})]}),i.jsxs("div",{className:wt.modalBody,children:[M&&i.jsxs("div",{className:wt.errorBanner,children:[i.jsx(ni,{size:18}),i.jsx("span",{children:M})]}),i.jsxs("div",{className:wt.section,children:[i.jsxs("div",{className:wt.sectionTitle,children:[i.jsx(qd,{size:14}),i.jsx("span",{children:"Subscription Settings"})]}),i.jsxs("div",{className:wt.settingsGrid,children:[i.jsxs("div",{className:wt.inputWrapper,children:[i.jsx("label",{className:wt.label,children:"Frequency (Days)"}),i.jsxs("div",{className:wt.inputGroup,children:[i.jsx(qd,{size:16,className:wt.inputIcon}),i.jsx("input",{type:"number",value:f,onChange:R=>u(parseInt(R.target.value,10)||1),className:wt.inputField,min:"1"})]})]}),i.jsxs("div",{className:wt.inputWrapper,children:[i.jsx("label",{className:wt.label,children:"Subscription Status"}),i.jsx("div",{className:wt.inputGroup,children:i.jsxs("select",{value:d,onChange:R=>h(R.target.value),className:`${wt.inputField} ${wt.inputFieldWithAction} ${wt.selectField}`,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})})]}),i.jsxs("div",{className:wt.inputWrapper,children:[i.jsx("label",{className:wt.label,children:"Next Delivery Date"}),i.jsxs("div",{className:wt.inputGroup,children:[i.jsx(Ud,{size:16,className:wt.inputIcon}),i.jsx("input",{type:"date",value:g,onChange:R=>b(R.target.value),className:wt.inputField})]})]})]})]}),i.jsxs("div",{className:wt.section,children:[i.jsxs("div",{className:wt.sectionTitle,children:[i.jsx(Ci,{size:14}),i.jsx("span",{children:"Add & Manage Medications"})]}),i.jsxs("div",{className:wt.searchArea,children:[i.jsxs("div",{className:wt.inputGroup,children:[i.jsx(Ci,{size:18,className:wt.inputIcon}),i.jsx("input",{type:"text",value:v,onChange:R=>N(R.target.value),placeholder:"Search pharmacy inventory...",className:wt.inputField})]}),C.length>0&&i.jsx("div",{className:wt.searchResults,children:C.map(R=>i.jsxs("div",{onClick:()=>F(R),className:wt.searchItem,children:[i.jsxs("div",{children:[i.jsx("div",{className:wt.drugName,children:R.name}),i.jsxs("div",{className:wt.drugInfo,children:["Stock: ",R.quantity_in_stock," | Unit: ",R.unit]})]}),i.jsxs("div",{className:wt.drugName,children:["",R.price]})]},R.id))})]}),i.jsxs("div",{className:wt.medList,children:[l.map((R,O)=>i.jsxs("div",{className:wt.medCard,children:[i.jsxs("div",{className:wt.medCardHeader,children:[i.jsx("span",{className:wt.medName,children:R.name}),i.jsx("button",{onClick:()=>z(O),className:wt.removeMedBtn,title:"Remove",children:i.jsx(Pi,{size:18})})]}),i.jsxs("div",{className:wt.medCardGrid,children:[i.jsxs("div",{className:wt.inputWrapper,children:[i.jsx("label",{className:wt.label,children:"Packs"}),i.jsx("input",{type:"number",value:R.pack_quantity||0,onChange:$=>B(O,"pack_quantity",$.target.value),className:`${wt.inputField} ${wt.inputFieldWithAction}`,placeholder:"0"})]}),i.jsxs("div",{className:wt.inputWrapper,children:[i.jsx("label",{className:wt.label,children:"Loose Qty"}),i.jsx("input",{type:"number",value:R.loose_quantity||0,onChange:$=>B(O,"loose_quantity",$.target.value),className:`${wt.inputField} ${wt.inputFieldWithAction}`,placeholder:"0"})]}),i.jsxs("div",{className:wt.inputWrapper,children:[i.jsx("label",{className:wt.label,children:"Days"}),i.jsx("input",{type:"number",value:R.numberOfDays||0,onChange:$=>B(O,"numberOfDays",$.target.value),className:`${wt.inputField} ${wt.inputFieldWithAction}`,placeholder:"0"})]}),i.jsxs("div",{className:wt.inputWrapper,children:[i.jsx("label",{className:wt.label,children:"Dosage (e.g. 1 tab/day for 10 days)"}),i.jsx("input",{type:"text",value:R.tabletsPerDay||"",onChange:$=>B(O,"tabletsPerDay",$.target.value),className:`${wt.inputField} ${wt.inputFieldWithAction}`,placeholder:"e.g. 1 tab/day..."})]}),i.jsxs("div",{className:wt.inputWrapper,children:[i.jsx("label",{className:wt.label,children:"Directions"}),i.jsx("input",{type:"text",value:R.directions_to_use||"",onChange:$=>B(O,"directions_to_use",$.target.value),className:`${wt.inputField} ${wt.inputFieldWithAction}`,placeholder:"Directions to use..."})]})]})]},O)),l.length===0&&i.jsxs("div",{className:wt.noMeds,children:[i.jsx(eo,{size:32,style:{marginBottom:"12px",opacity:.5}}),i.jsx("p",{children:"No medications added to this recurring subscription yet."})]})]})]})]}),i.jsxs("div",{className:wt.modalFooter,children:[i.jsx("button",{onClick:n,className:`${wt.btn} ${wt.btnSecondary}`,children:"Cancel"}),i.jsxs("button",{onClick:U,disabled:T,className:`${wt.btn} ${wt.btnPrimary}`,children:[T?i.jsx("div",{className:wt.spinner}):i.jsx(uu,{size:18}),T?"Saving Changes...":"Save Subscription"]})]})]})}):null},Dx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},Od=(e,n)=>{if(!e||!n||n.length===0)return;const t=Dx(e);let r=n.find(o=>Dx(o.name)===t);if(r)return r;let a=n.find(o=>Dx(o.name).includes(t));if(a)return a;let l=n.find(o=>t.includes(Dx(o.name)));if(l)return l},MW=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's unit/pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - **Patient Status & Queue Management:**
       - Use \`update_patient_status\` to manage patient admissions, discharge, and queue status.
       - \`status: "admit"\`: Use when a patient needs to be admitted to the clinic.
       - \`status: "discharge"\`: Use when an admitted patient is ready to leave.
       - \`status: "add_to_queue"\`: Use to add a patient to a specific queue (\`queue_type: "doctor" | "lab" | "pharmacy"\`).
       - \`status: "complete_consultation"\`: Use to mark the current doctor consultation as finished (sets status to 'seen').
       - Check the patient's current status and queue information provided in the prompt before suggesting these actions.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
    - **Recurring Medications Management:**
        - Use \`create_recurring_medication\` only when specifically asked to make a treatment or order recurring. It takes the same items structure as pharmacy orders but also requires \`frequency_days\` and \`next_delivery_date\`.
         - Use \`edit_recurring_medication\` to update an existing recurring medication entry. You must use \`serialNumber\` from the provided list.
        - Use \`delete_recurring_medication\` to stop/remove a recurring medication using its \`serialNumber\`.
    - **Lab Reports & Results Entry:**
        - Always check \`labHistory\` for existing orders.
        - If an order exists for a test (e.g., serial number 3), use \`edit_lab_report\` with \`serialNumber: 3\` to enter results.
        - If no order exists, use \`create_lab_report\` to automatically create the order and submit the report in one step.
        - Provide results in the \`results\` array, specifying the \`testName\` and a dictionary of \`parameters\` (key-value pairs of parameter name and value).
        - You can see the required parameters and their normal ranges in the \`Available Lab Tests\` inventory list.
    - **Action Wrappers:** Your JSON array **MUST** start with \`{ "action": "first_action" }\` and end with \`{ "action": "last_action" }\`. Any response not following this structure will be **IGNORED** by the system.
    - **No Action Required / Loop Prevention:** If the user's input does not require any of the specific actions listed above (e.g., simple conversation, acknowledgement, or if you have already performed the necessary actions and are just responding), you **MUST** use the \`blank_action\`. This is CRITICAL to prevent the system from getting stuck in a loop waiting for an action. Never return an empty JSON array; if nothing else applies, return \`[{ "action": "first_action" }, { "action": "blank_action" }, { "action": "last_action" }]\`.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "first_action" },
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "create_lab_report", "tests": [ { "name": "Test Name" } ], "results": [ { "testName": "Test Name", "parameters": { "ParamName": value } } ] },
  { "action": "edit_lab_report", "serialNumber": number, "results": [ { "testName": "Test Name", "parameters": { "ParamName": value } } ] },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
   { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." },
  { "action": "update_patient_status", "status": "admit" | "discharge" | "add_to_queue" | "complete_consultation", "queue_type": "doctor" | "lab" | "pharmacy" (optional, required if status is add_to_queue) },
  { "action": "create_recurring_medication", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "frequency_days": number, "next_delivery_date": "YYYY-MM-DD" },
  { "action": "edit_recurring_medication", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "active" | "paused" | "cancelled", "frequency_days": number, "next_delivery_date": "YYYY-MM-DD" },
  { "action": "delete_recurring_medication", "serialNumber": number },
  { "action": "blank_action" },
  { "action": "last_action" }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
      4. \`update_clinic_ai_memory\`
      5. \`update_patient_status\`
      6. \`create_lab_order\`
      7. \`edit_lab_order\`
      8. \`create_pharmacy_order\`
      9. \`edit_pharmacy_order\`
   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this tool format inside the standard JSON array with wrappers.
     \`\`\`json
[
  { "action": "first_action" },
  {
    "action": "ask_followup_question",
    "question": "Your clear, specific question here.",
    "options": ["Optional Answer 1", "Optional Answer 2"] // Optional
  },
  { "action": "last_action" }
]
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,IW="gemini-3-flash-preview";async function RW(){const e=tb();if(!e)throw new Error("Authentication token not found. Please log in.");try{const r=(await(await ue("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using clinic-specific Gemini API key."),r}catch(n){console.warn("Failed to fetch clinic-specific Gemini API key, trying global fallback.",n)}try{const r=(await(await ue("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using global Gemini API key."),r}catch(n){console.warn("Failed to fetch global Gemini API key.",n)}throw new Error("Gemini API key not found. Please contact your administrator.")}let kv=null;async function LW(){if(!kv){const e=await RW();kv=new nk({apiKey:e})}return kv}async function OW(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:l,patientGender:o,case_summary:f,case_summary_last_updated:u,clinic_ai_memory:d,clinic_ai_memory_last_updated:h,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:N,recurringMedications:C,pharmacyInventory:A,labInventory:T,patientStatus:D,isAdmitted:M,isInQueueToday:V,admissionDate:F,dischargeDate:z}=e;let B=`Patient Complaint: ${t}`;if(f&&(B+=`

--- Case Summary (Provided by Doctor) ---
${f}`,u))try{const q=new Date(u).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});B+=`
(Last Updated: ${q})`}catch{console.warn(`Could not format case_summary_last_updated: ${u}`),B+=`
(Last Updated: ${u})`}if(a&&(B+=`

Patient Name: ${a}`),l!=null&&(B+=`
Patient Age: ${l}`),o&&(B+=`
Patient Gender: ${o}`),D&&(B+=`
Patient Current Status: ${D}`),B+=`
Patient Admitted: ${M?"Yes":"No"}`,F&&(B+=`
Admission Date: ${F}`),z&&(B+=`
Discharge Date: ${z}`),B+=`
In Doctor Queue Today: ${V?"Yes":"No"}`,r)try{const q=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});B+=`

Current Interaction Time: ${q}`}catch{console.warn(`Could not format currentDateTime: ${r}`),B+=`

Current Interaction Time: ${r}`}if(d&&(B+=`

--- Clinic-wide AI Memory/Context ---
${d}`,h))try{const q=new Date(h).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});B+=`
(Last Updated: ${q})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${h}`),B+=`
(Last Updated: ${h})`}let U="";b&&Array.isArray(b)&&b.length>0&&(U=`

--- Lab History (Orders & Reports) ---
`,b.forEach(q=>{let H="Unknown Date";try{H=new Date(q.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${q.orderDate}`)}if(U+=`
Order #${q.serialNumber} Date: ${H} (Status: ${q.status})
`,U+=`Tests: ${q.tests.map(ee=>ee.name).join(", ")}
`,q.report){let ee="Unknown Date";try{ee=new Date(q.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${q.report.reportDate}`)}U+=`  -> Report Date: ${ee}
`,q.report.tests&&Array.isArray(q.report.tests)?(U+=`     Findings:
`,q.report.tests.forEach(E=>{U+=`       - Test: ${E.testName}
`,E.parameters&&Array.isArray(E.parameters)&&E.parameters.forEach(Q=>{U+=`         - ${Q.name}: ${Q.value} (Normal: ${Q.normal_range})
`})})):(U+=`     Findings: ${q.report.reportContent||"N/A"}
`,q.report.error&&(U+=`     Note: ${q.report.error}
`))}U+=`---
`}),B+=U);let R="";v&&Array.isArray(v)&&v.length>0&&(R=`

--- Recent Pharmacy Orders ---
`,v.forEach(q=>{let H="Unknown Date/Time";try{H=new Date(q.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${q.date}`)}R+=`
Order #${q.serialNumber} Date/Time: ${H} (Status: ${q.status})
`,R+=`Prescribed By: ${q.prescribedBy||"N/A"}
`,q.dispensedBy&&(R+=`Dispensed By: ${q.dispensedBy}
`),R+=`Medications:
`,q.medications.forEach(ee=>{R+=`  - ${ee.name} (Qty: ${ee.quantity}`,ee.tabletsPerDay&&(R+=`, ${ee.tabletsPerDay}/day`),ee.numberOfDays&&(R+=` for ${ee.numberOfDays} days`),R+=`)
`}),q.prescriptionForUnavailableDrugs&&(R+=`  Prescription for Unavailable Drugs: ${q.prescriptionForUnavailableDrugs}
`),R+=`---
`}),B+=R);let O="";N&&Array.isArray(N)&&N.length>0&&(O=`

--- Past Complaints History ---
`,N.forEach(q=>{let H="Unknown Date/Time";try{H=new Date(q.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${q.createdAt}`)}O+=`
Date/Time: ${H}
Complaint: ${q.complaint||"N/A"}
---
`}),B+=O);let $="";C&&Array.isArray(C)&&C.length>0&&($=`

--- Recurring Medications ---
`,C.forEach((q,H)=>{var ee;$+=`
#${H+1} Status: ${q.status}, Freq: ${q.frequency_days} days, Next: ${q.next_delivery_date}
`,(ee=q.medications)==null||ee.forEach(E=>{$+=`  - ${E.name} (Qty: ${E.pack_quantity||0}P / ${E.loose_quantity||0}L, ${E.tabletsPerDay}/day for ${E.numberOfDays} days)
`}),$+=`---
`}),B+=$);let W="";A&&Array.isArray(A)&&A.length>0&&(W=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,A.forEach(q=>{W+=`- ${q.name} (Pack: ${q.unit??"N/A"}): ${q.quantity_in_stock??"N/A"}
`}),B+=W);let te="";T&&Array.isArray(T)&&T.length>0&&(te=`

--- Available Lab Tests & Parameters (Use these for reports) ---
`,T.forEach(q=>{te+=`- ${q.name} (Price: ${q.price??"N/A"})
`,q.default_parameters&&Array.isArray(q.default_parameters)&&q.default_parameters.forEach(H=>{let ee="N/A";H.lower_limit!=null||H.upper_limit!=null?(ee="",H.lower_limit!=null&&(ee+=`> ${H.lower_limit}`),H.lower_limit!=null&&H.upper_limit!=null&&(ee+=" - "),H.upper_limit!=null&&(ee+=`< ${H.upper_limit}`),ee=ee.trim()):H.normal_range&&(ee=H.normal_range),te+=`  * ${H.name} (${H.unit||"unitless"}): [Normal Range: ${ee}]
`})}),B+=te);const ne=[{text:MW}];g&&g.trim()!==""&&ne.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const re=[{text:B}];if(n){const q=new FileReader,H=await new Promise((ee,E)=>{q.onloadend=()=>{typeof q.result=="string"?ee(q.result.split(",")[1]):E(new Error("Failed to read image file as base64."))},q.onerror=E,q.readAsDataURL(n)});re.push({inlineData:{mimeType:n.type,data:H}})}const J=[];ne.length>0&&J.push({role:"user",parts:ne}),J.push({role:"user",parts:re});try{const q={model:IW,contents:J,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},ee=await(await LW()).models.generateContentStream(q);let E="";for await(const Q of ee)if(Q&&typeof Q.text=="function"){const ie=Q.text;ie&&(E+=ie)}else Q&&Q.candidates&&Q.candidates[0]&&Q.candidates[0].content&&Q.candidates[0].content.parts&&Q.candidates[0].content.parts[0]&&Q.candidates[0].content.parts[0].text&&(E+=Q.candidates[0].content.parts[0].text);if(E&&E.trim()!=="")return E.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(q){console.error("Error calling Gemini API:",q);let H="Failed to get suggestion from Gemini.";throw q.message&&(H=`Error processing Gemini request: ${q.message}`),new Error(H)}}const Tv=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},FW=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},$W=(e,n,t)=>isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400?null:parseFloat((e-n-t/5).toFixed(2)),zW=(e,n)=>isNaN(e)||isNaN(n)||e<0||n<0?null:parseFloat((e-n).toFixed(2)),BW=(e,n)=>isNaN(e)||isNaN(n)||e<0||n<0?null:parseFloat((e-n).toFixed(2)),UW=(e,n,t)=>isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0?null:parseFloat((e-(n+t)).toFixed(2)),qW=(e,n,t)=>isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0?null:parseFloat((2*e+n/18+t/2.8).toFixed(2)),h_=(e,n,t)=>{const r={...e},a=parseFloat(r.Creatinine);if(!isNaN(a)&&n!==null&&t!==null){const T=FW(a,n,t);T!==null&&(r.eGFR=T)}const l=parseFloat(r["Total Cholesterol"]),o=parseFloat(r["HDL Cholesterol"]),f=parseFloat(r.Triglycerides);if(!isNaN(l)&&!isNaN(o)&&!isNaN(f)){const T=$W(l,o,f);T!==null&&(r["LDL Cholesterol"]=T)}const u=parseFloat(r["Total Bilirubin"]),d=parseFloat(r["Direct Bilirubin"]);if(!isNaN(u)&&!isNaN(d)){const T=zW(u,d);T!==null&&(r["Indirect Bilirubin"]=T)}const h=parseFloat(r["Total Protein"]),g=parseFloat(r.Albumin);if(!isNaN(h)&&!isNaN(g)){const T=BW(h,g);T!==null&&(r.Globulin=T)}const b=parseFloat(r.Sodium),v=parseFloat(r.Chloride),N=parseFloat(r.Bicarbonate);if(!isNaN(b)&&!isNaN(v)&&!isNaN(N)){const T=UW(b,v,N);T!==null&&(r["Anion Gap"]=T)}const C=parseFloat(r.Glucose),A=parseFloat(r.BUN);if(!isNaN(b)&&!isNaN(C)&&!isNaN(A)){const T=qW(b,C,A);T!==null&&(r.Osmolality=T)}return r},VW=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:l,userMessages:o,selectedImageFile:f,pendingLabOrders:u,labReports:d,pastComplaints:h,pharmacyOrders:g,recurringMedications:b,pharmacyInventory:v,labInventory:N,currentComplaint:C,setCurrentComplaint:A,setAiResponse:T,setAiResponseText:D,setAiResponseJsonString:M,setShowAiJsonDetails:V,setIsLoadingAi:F,setAiError:z,setIsSubmittingAiOrder:B,setAiOrderSubmissionStatus:U,setIsSubmittingAiLabOrder:R,setAiLabOrderSubmissionStatus:O,setIsSubmittingAiComplaint:$,setAiComplaintSubmissionStatus:W,setIsUpdatingCaseSummary:te,setAiCaseSummaryUpdateStatus:ne,setCaseSummary:re,setCaseSummaryUpdatedAt:J,setIsUpdatingAiMemoryByAI:q,setAiMemoryUpdateByAIStatus:H,setFollowUpQuestion:ee,setFollowUpOptions:E,setError:Q,setIsSavingAiResponse:ie,setSaveAiResponseError:I,fetchPharmacyOrdersData:ce,fetchPendingLabOrdersData:xe,fetchLabReportsData:le,fetchPastComplaintsData:ge,fetchRecurringMedicationsData:ye,fetchPatientDetails:Re,setClinicSettings:Ze,setEditedAiMemory:at,handleDeleteItem:Le,handleAdmitDischargePatient:Te,handleCompleteConsultation:we,handleAddToQueue:Fe,setCanUndoAi:Xe},it)=>{const[je,Ke]=qn.useState([]);let ze;const ct=async(Ae,Ie,Ye,ft=0)=>{let gt;const $e=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(nt=>{var Ve;return(Ve=Ie.message)==null?void 0:Ve.includes(nt)});Ye&&$e?gt=`AI Error: ${Ie.message}

${Ye}`:(gt=`I encountered a frontend error while trying to execute the '${Ae}' function. The error message is: "${Ie.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(Ae==="create_pharmacy_order"||Ae==="edit_pharmacy_order")&&(gt+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),Ye&&(gt+=`

The original AI response that caused the error was:
\`\`\`
${Ye}
\`\`\``)),await ze(gt,ft+1)},Tt=async(Ae,Ie,Ye)=>{var ht;let ft=!1;const gt=[];let jt=null;for(const Se of Ae){if(Se.action==="first_action"||Se.action==="last_action"){ft=!0,gt.push(Promise.resolve({action:Se.action,success:!0}));continue}if(Se.action==="ask_followup_question"){jt=Se,ft=!0,gt.push(Promise.resolve({action:"ask_followup_question",success:!0}));continue}Se.action==="update_clinic_ai_memory"&&typeof Se.memory_content=="string"?(ft=!0,gt.push((async()=>{q(!0),H("Processing AI mem...");try{if(!l)throw new Error("Clinic settings not loaded, cannot update AI memory.");const qe={...l,aiMemory:Se.memory_content.trim(),admissionCharge:l.admissionCharge,perDayCharge:l.perDayCharge,otherCharges:l.otherCharges,clinicWideSystemPrompt:l.clinicWideSystemPrompt},Be=await ue("/api/clinics/settings",{method:"PUT",body:JSON.stringify(qe)});if(!Be.ok){const st=await Be.json().catch(()=>({}));throw new Error(st.message||`AI-triggered clinic memory update failed: ${Be.statusText}`)}const tt=await Be.json();return Ze({admissionCharge:parseFloat(tt.settings.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(tt.settings.perDayCharge||0).toFixed(2),otherCharges:parseFloat(tt.settings.otherCharges||0).toFixed(2),aiMemory:tt.settings.aiMemory||"",aiMemoryUpdatedAt:tt.settings.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:tt.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:tt.settings.clinicWideSystemPromptUpdatedAt||null}),at(tt.settings.aiMemory||""),H("AI mem updated!"),{action:"update_clinic_ai_memory",success:!0}}catch(qe){return{action:"update_clinic_ai_memory",success:!1,error:qe}}finally{q(!1)}})())):Se.action==="create_pharmacy_order"&&(Array.isArray(Se.items)||Se.prescription_for_unavailable_drugs&&Se.prescription_for_unavailable_drugs.trim()!=="")?(ft=!0,gt.push((async()=>{B(!0),U("Processing order...");try{if(!n)throw new Error("Missing patient ID for pharmacy order.");const qe=[];let Be=null;if(Array.isArray(Se.items))for(const Nt of Se.items){const{pack_price:Ot,loose_price:Vt,total_price:_t,price:Wt,...Et}=Nt;let Dt;if(Et.drug_id?Dt=v.find(Ui=>Ui.id===Et.drug_id):Et.name&&(Dt=Od(Et.name,v)),!Dt){Be=`Drug "${Et.name||Et.drug_id||"Unknown"}" not found or no close match.`;break}let kt;const It=Et.tabletsPerDay;if(It&&Number(It)>0){const Ui=Number(It);Number.isInteger(Ui)?kt=Ui:kt=null}else kt=1;const Hn=Number(Et.numberOfDays)||1,Ti=Number(Et.pack_quantity)||0,sr=Number(Et.loose_quantity)||0;if(Ti<=0&&sr<=0){Be=`Invalid quantity for ${Dt.name}. Pack quantity or loose quantity must be greater than 0.`;break}const Rn=Dt.unit,On=Tv(Rn),Bi=Number(Dt.price),Xi=Bi,Zi=On>0?Bi/On:0,pr=Ti*Xi+sr*Zi;qe.push({drug_id:Dt.id?String(Dt.id):null,name:Dt.name,pack_quantity:Ti,loose_quantity:sr,tabletsPerDay:kt,numberOfDays:Hn,price:Bi,directions_to_use:Et.directions_to_use||void 0,box_number:Et.box_number||void 0,isLoose:Et.isLoose||void 0,unit:Rn||void 0,pack_price:parseFloat(Xi.toFixed(2)),loose_price:parseFloat(Zi.toFixed(2)),total_price:parseFloat(pr.toFixed(2))})}if(Be)throw new Error(Be);const tt=qe.reduce((Nt,Ot)=>Nt+Ot.total_price,0),st={patient_id:n,items:qe.map(({drug_id:Nt,name:Ot,pack_quantity:Vt,loose_quantity:_t,tabletsPerDay:Wt,numberOfDays:Et,directions_to_use:Dt,box_number:kt,isLoose:It,unit:Hn,pack_price:Ti,loose_price:sr,total_price:Rn})=>({drug_id:Nt,name:Ot,pack_quantity:Vt,loose_quantity:_t,tabletsPerDay:Wt,numberOfDays:Et,directions_to_use:Dt,box_number:kt,isLoose:It,unit:Hn,pack_price:Ti,loose_price:sr,total_price:Rn})),prescription_for_unavailable_drugs:Se.prescription_for_unavailable_drugs||null,order_total:parseFloat(tt.toFixed(2))},dt=await ue("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(st)});if(!dt.ok){const Nt=await dt.json().catch(()=>({}));throw new Error(Nt.message||`AI order creation failed: ${dt.statusText}`)}const tn=await dt.json();return U("Order created!"),n&&ce(n),{action:"create_pharmacy_order",success:!0,undo:async()=>{console.log(`Rolling back pharmacy order ${tn.id}`),await ue(`/api/pharmacy-orders/${tn.id}`,{method:"DELETE"}),n&&ce(n)}}}catch(qe){return{action:"create_pharmacy_order",success:!1,error:qe}}finally{B(!1)}})())):Se.action==="update_patient_details"?(ft=!0,gt.push((async()=>{F(!0),Q(null);try{if(!n)throw new Error("Missing patient ID for updating details.");const qe={...t},Be={};let tt=!1;if(Se.name!==void 0&&typeof Se.name=="string"&&(Be.name=Se.name,tt=!0),Se.age!==void 0&&typeof Se.age=="number"&&(Be.age=Se.age,tt=!0),Se.gender!==void 0&&typeof Se.gender=="string"){if(!["M","F","O",null,""].includes(Se.gender))throw new Error(`Invalid gender specified: "${Se.gender}". Use M, F, or O.`);Be.gender=Se.gender===""?null:Se.gender,tt=!0}if(Se.phone_number!==void 0&&(typeof Se.phone_number=="string"||Se.phone_number===null)&&(Be.phone_number=Se.phone_number,tt=!0),!tt)throw new Error("No valid patient details provided for update.");const st=await ue(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)});if(!st.ok){const dt=await st.json().catch(()=>({}));throw new Error(dt.message||`AI patient update failed: ${st.statusText}`)}return Re(n),{action:"update_patient_details",success:!0,undo:async()=>{console.log(`Reverting patient details for ${n}`);const dt={};Be.name!==void 0&&(dt.name=qe.name),Be.age!==void 0&&(dt.age=qe.age),Be.gender!==void 0&&(dt.gender=qe.gender),Be.phone_number!==void 0&&(dt.phone_number=qe.phone||null),await ue(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(dt)}),Re(n)}}}catch(qe){return{action:"update_patient_details",success:!1,error:qe}}finally{F(!1)}})())):Se.action==="create_lab_order"&&Array.isArray(Se.tests)&&Se.tests.length>0?(ft=!0,gt.push((async()=>{R(!0),O("Processing lab...");try{if(!n)throw new Error("Missing patient ID for lab order.");const qe=[];let Be=null;for(const Nt of Se.tests){let Ot;if(Nt.id?Ot=N.find(_t=>String(_t.id)===String(Nt.id)):Nt.name&&(Ot=Od(Nt.name,N)),!Ot){Be=`Lab test "${Nt.name||Nt.id||"Unknown"}" not found or no close match.`;break}const Vt=typeof Ot.price=="string"?parseFloat(Ot.price):Ot.price;qe.push({id:Ot.id,name:Ot.name,price:Vt,description:Ot.description,default_parameters:Ot.default_parameters})}if(Be)throw new Error(Be);const tt={patient_id:n,tests:qe.map(Nt=>({id:Nt.id,name:Nt.name,price:Nt.price}))},st=await ue("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(tt)});if(!st.ok){const Nt=await st.json().catch(()=>({}));throw new Error(Nt.message||`AI lab order creation failed: ${st.statusText}`)}const dt=await st.json(),tn=dt.labOrder?dt.labOrder.id:dt.id;return O("Success: Lab order created!"),n&&xe(n),{action:"create_lab_order",success:!0,undo:async()=>{console.log(`Rolling back lab order ${tn}`),tn?(await ue(`/api/lab/orders/${tn}`,{method:"DELETE"}),n&&xe(n)):console.error("Cannot rollback lab order: ID is missing.")}}}catch(qe){return{action:"create_lab_order",success:!1,error:qe}}finally{R(!1)}})())):Se.action==="edit_pharmacy_order"?(ft=!0,gt.push((async()=>{B(!0),U("Processing pharmacy order edit...");try{const qe=Se.serialNumber;let Be;if(qe?Be=[...g].sort((_t,Wt)=>{const Et=new Date(_t.date).getTime(),Dt=new Date(Wt.date).getTime();return Et-Dt})[qe-1]:Be=g.sort((Vt,_t)=>new Date(Vt.date).getTime()-new Date(_t.date).getTime()).find(Vt=>Vt.status==="pending"),!Be)throw new Error(`Pharmacy order with serial number ${qe} not found, or no pending order to edit.`);const tt=JSON.parse(JSON.stringify(Be)),st=Be.id,dt=Se.items,tn=Se.items_to_remove,Nt=Se.status,Ot=Se.prescription_for_unavailable_drugs;if((!dt||Array.isArray(dt)&&dt.length===0)&&!tn&&!Nt&&(!Ot||Ot.trim()===""))throw new Error("No items, items to remove, status, or unavailable drugs prescription provided for pharmacy order edit.");if(Nt==="cancelled")return await Le({type:"Pharmacy Order",data:Be}),U("Success: Pharmacy order cancelled and deleted!"),{action:"edit_pharmacy_order",success:!0,undo:async()=>{console.warn("Cannot fully undo pharmacy order deletion yet. It requires re-creation.")}};{let Vt=[...Be.medications];if(Array.isArray(tn)&&tn.length>0&&(Vt=Vt.filter(kt=>{const It=kt.name.toLowerCase().replace(/\s+/g," ").trim();return!tn.some(Hn=>{if(Hn.drug_id&&String(kt.drug_id)===String(Hn.drug_id))return!0;if(Hn.name){const Ti=Hn.name.toLowerCase().replace(/\s+/g," ").trim();return It===Ti}return!1})})),Array.isArray(dt)&&dt.length>0)for(const kt of dt){const{pack_price:It,loose_price:Hn,total_price:Ti,price:sr,...Rn}=kt;let On;if(Rn.drug_id?On=v.find(Hr=>Hr.id===String(Rn.drug_id)):Rn.name&&(On=Od(Rn.name,v)),!On)throw new Error(`Drug "${Rn.name||Rn.drug_id||"Unknown"}" not found or no close match for update.`);let Bi;const Xi=Rn.tabletsPerDay;if(Xi&&Number(Xi)>0){const Hr=Number(Xi);Number.isInteger(Hr)?Bi=Hr:Bi=null}else Bi=1;const Zi=Number(Rn.numberOfDays)||1,pr=Number(Rn.pack_quantity)||0,Ui=Number(Rn.loose_quantity)||0,Gn=Vt.findIndex(Hr=>Hr.drug_id&&Hr.drug_id===(On==null?void 0:On.id)||Hr.name.toLowerCase()===(On==null?void 0:On.name.toLowerCase()));if(pr<=0&&Ui<=0){Gn!==-1&&Vt.splice(Gn,1);continue}const Es={drug_id:On.id?String(On.id):null,name:On.name,pack_quantity:pr,loose_quantity:Ui,tabletsPerDay:Bi,numberOfDays:Zi,price:On.price,directions_to_use:Rn.directions_to_use||void 0,box_number:Rn.box_number||void 0,isLoose:Rn.isLoose||void 0,unit:On.unit||void 0};Gn!==-1?Vt[Gn]={...Vt[Gn],...Es}:Vt.push(Es)}const _t=Vt.map(kt=>{const It=v.find(Bi=>Bi.id===kt.drug_id),Hn=It?Tv(It.unit):1,Ti=Number(It==null?void 0:It.price)||0,sr=Ti,Rn=Hn>0?Ti/Hn:0,On=(kt.pack_quantity||0)*sr+(kt.loose_quantity||0)*Rn;return{...kt,pack_price:parseFloat(sr.toFixed(2)),loose_price:parseFloat(Rn.toFixed(2)),total_price:parseFloat(On.toFixed(2))}}),Wt=_t.reduce((kt,It)=>kt+It.total_price,0),Et={};if(_t.length>0?Et.items=_t.map(({drug_id:kt,name:It,pack_quantity:Hn,loose_quantity:Ti,tabletsPerDay:sr,numberOfDays:Rn,directions_to_use:On,box_number:Bi,isLoose:Xi,unit:Zi,pack_price:pr,loose_price:Ui,total_price:Gn})=>({drug_id:kt,name:It,pack_quantity:Hn,loose_quantity:Ti,tabletsPerDay:sr===null?null:sr,numberOfDays:Rn,directions_to_use:On,box_number:Bi,isLoose:Xi,unit:Zi,pack_price:pr,loose_price:Ui,total_price:Gn})):dt&&dt.length>0&&(Et.items=[]),Ot!==void 0&&(Et.prescription_for_unavailable_drugs=Ot),Et.order_total=parseFloat(Wt.toFixed(2)),Nt){if(!["pending","billed","dispensed","cancelled"].includes(Nt))throw new Error(`Invalid status for pharmacy order: ${Nt}.`);Et.status=Nt}const Dt=await ue(`/api/pharmacy-orders/${st}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Et)});if(!Dt.ok){const kt=await Dt.json().catch(()=>({}));throw new Error(kt.message||`AI pharmacy order edit failed: ${Dt.statusText}`)}return U("Success: Pharmacy order updated!"),n&&ce(n),{action:"edit_pharmacy_order",success:!0,undo:async()=>{console.log(`Reverting pharmacy order ${st}`);const kt={items:tt.medications.map(It=>({drug_id:It.drug_id,name:It.name,pack_quantity:It.pack_quantity,loose_quantity:It.loose_quantity,tabletsPerDay:It.tabletsPerDay,numberOfDays:It.numberOfDays,directions_to_use:It.directions_to_use,box_number:It.box_number,isLoose:It.isLoose,unit:It.unit,pack_price:It.pack_price,loose_price:It.loose_price,total_price:It.total_price})),status:tt.status,prescription_for_unavailable_drugs:tt.prescription_for_unavailable_drugs,order_total:tt.order_total};await ue(`/api/pharmacy-orders/${st}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(kt)}),n&&ce(n)}}}}catch(qe){return{action:"edit_pharmacy_order",success:!1,error:qe}}finally{B(!1)}})())):Se.action==="edit_lab_order"?(ft=!0,gt.push((async()=>{R(!0),O("Processing lab order edit...");try{const qe=u.sort((Nt,Ot)=>new Date(Ot.createdAt).getTime()-new Date(Nt.createdAt).getTime()).find(Nt=>Nt.status==="pending");if(!qe)throw new Error("No pending lab orders found to edit.");const Be=JSON.parse(JSON.stringify(qe)),tt=qe.id,st=Se.tests,dt=Se.items_to_remove,tn=Se.status;if(!st&&!dt&&!tn)throw new Error("No tests, items to remove, or status provided for lab order edit.");if(tn==="cancelled"){if(qe.report)throw new Error("Cannot delete lab order with an associated report. Please delete the report first.");return await Le({type:"Lab Order",data:qe}),O("Success: Lab order cancelled and deleted!"),{action:"edit_lab_order",success:!0,undo:async()=>{console.warn("Cannot fully undo lab order deletion yet. It requires re-creation.")}}}else{let Nt=[...qe.tests];if(Array.isArray(dt)&&dt.length>0&&(Nt=Nt.filter(Vt=>!dt.some(_t=>!!(_t.id&&String(Vt.id)===String(_t.id)||_t.name&&Vt.name.toLowerCase()===_t.name.toLowerCase())))),Array.isArray(st)&&st.length>0)for(const Vt of st){let _t;if(Vt.id?_t=N.find(kt=>String(kt.id)===String(Vt.id)):Vt.name&&(_t=Od(Vt.name,N)),!_t)throw new Error(`Lab test "${Vt.name||Vt.id||"Unknown"}" not found or no close match for update.`);const Wt=typeof _t.price=="string"?parseFloat(_t.price):_t.price,Et=Nt.findIndex(kt=>kt.id&&String(kt.id)===String(_t==null?void 0:_t.id)||kt.name.toLowerCase()===(_t==null?void 0:_t.name.toLowerCase())),Dt={id:_t.id,name:_t.name,price:Wt};Et!==-1?Nt[Et]={...Nt[Et],...Dt}:Nt.push(Dt)}const Ot=await ue(`/api/lab/orders/${tt}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tests:Nt,status:tn||qe.status})});if(!Ot.ok){const Vt=await Ot.json().catch(()=>({}));throw new Error(Vt.message||`AI lab order edit failed: ${Ot.statusText}`)}return O("Success: Lab order updated!"),n&&(xe(n),le(n)),{action:"edit_lab_order",success:!0,undo:async()=>{console.log(`Reverting lab order ${tt}`),await ue(`/api/lab/orders/${tt}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tests:Be.tests,status:Be.status})}),n&&(xe(n),le(n))}}}}catch(qe){return{action:"edit_lab_order",success:!1,error:qe}}finally{R(!1)}})())):Se.action==="edit_lab_report"?(ft=!0,gt.push((async()=>{var qe,Be;R(!0),O("Processing report edit...");try{const tt=Se.serialNumber;let st;if(tt){const kt=[...u??[],...d??[]].sort((Hn,Ti)=>new Date(Ti.createdAt).getTime()-new Date(Hn.createdAt).getTime());st=Array.from(new Map(kt.map(Hn=>[Hn.id,Hn])).values())[tt-1]}if(!st)throw new Error(`Lab order/report with serial number ${tt} not found.`);const dt=st.id,tn=st.report_content||((qe=st.report)==null?void 0:qe.report_content)||"{}",Nt=Se.results||[];let Ot={};try{Ot=JSON.parse(tn)}catch{Ot={}}const Vt=(t==null?void 0:t.gender)==="F"?"female":(t==null?void 0:t.gender)==="M"?"male":null,_t=(t==null?void 0:t.age)||null;for(const Dt of Nt){let kt=Dt.testId;if(!kt&&Dt.testName){const Hn=(Be=st.tests)==null?void 0:Be.find(Ti=>Ti.name.toLowerCase()===Dt.testName.toLowerCase());Hn&&(kt=Hn.id)}if(!kt)throw new Error(`Could not identify testId for "${Dt.testName||"Unknown test"}".`);Ot[kt]||(Ot[kt]={});let It={...Ot[kt],...Dt.parameters||{}};It=h_(It,_t,Vt),Ot[kt]=It}const Wt=JSON.stringify(Ot),Et=await ue(`/api/lab/${dt}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:Wt})});if(!Et.ok)throw new Error(`Report update failed: ${Et.statusText}`);return n&&(xe(n),le(n)),{action:"edit_lab_report",success:!0,undo:async()=>{await ue(`/api/lab/${dt}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:tn})}),n&&(xe(n),le(n))}}}catch(tt){return{action:"edit_lab_report",success:!1,error:tt}}finally{R(!1)}})())):Se.action==="create_lab_report"?(ft=!0,gt.push((async()=>{R(!0),O("Creating direct report...");let qe=null;try{if(!n)throw new Error("Missing patient ID.");const Be=[];for(const _t of Se.tests||[]){let Wt=_t.id?N.find(Et=>String(Et.id)===String(_t.id)):Od(_t.name,N);if(!Wt)throw new Error(`Lab test "${_t.name}" not found.`);Be.push({id:Wt.id,name:Wt.name,price:Wt.price})}const tt=await ue("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:Be})});if(!tt.ok)throw new Error("Failed to create lab order.");const st=await tt.json();qe=st.labOrder?st.labOrder.id:st.id;const dt=Se.results||[],tn={},Nt=(t==null?void 0:t.gender)==="F"?"female":(t==null?void 0:t.gender)==="M"?"male":null,Ot=(t==null?void 0:t.age)||null;for(const _t of dt){let Wt=_t.testId;if(!Wt&&_t.testName){const Et=Be.find(Dt=>Dt.name.toLowerCase()===_t.testName.toLowerCase());Et&&(Wt=Et.id)}if(Wt){let Et=_t.parameters||{};Et=h_(Et,Ot,Nt),tn[Wt]=Et}}if(!(await ue(`/api/lab/${qe}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(tn)})})).ok)throw new Error("Failed to submit report content.");return n&&(xe(n),le(n)),{action:"create_lab_report",success:!0,undo:async()=>{qe&&(await ue(`/api/lab/orders/${qe}`,{method:"DELETE"}),n&&(xe(n),le(n)))}}}catch(Be){return qe&&await ue(`/api/lab/orders/${qe}`,{method:"DELETE"}),{action:"create_lab_report",success:!1,error:Be}}finally{R(!1)}})())):Se.action==="create_recurring_medication"&&(Array.isArray(Se.items)||Se.prescription_for_unavailable_drugs&&Se.prescription_for_unavailable_drugs.trim()!=="")?(ft=!0,gt.push((async()=>{B(!0),U("Processing recurring order...");try{if(!n)throw new Error("Missing patient ID for recurring medication.");const qe=[];let Be=null;if(Array.isArray(Se.items))for(const tn of Se.items){let Nt=oe(tn,v);if(!Nt){Be=`Drug "${tn.name||tn.drug_id}" not found.`;break}const{pack_quantity:Ot,loose_quantity:Vt,tabletsPerDay:_t,numberOfDays:Wt,pack_price:Et,loose_price:Dt,total_price:kt}=K(tn,Nt);qe.push({drug_id:Nt.id,name:Nt.name,pack_quantity:Ot,loose_quantity:Vt,tabletsPerDay:_t,numberOfDays:Wt,price:Nt.price,directions_to_use:tn.directions_to_use,unit:Nt.unit,pack_price:Et,loose_price:Dt,total_price:kt})}if(Be)throw new Error(Be);const tt={patient_id:n,medications:qe,frequency_days:Se.frequency_days||30,next_delivery_date:Se.next_delivery_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],status:"active"},st=await ue("/api/recurring-medications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(tt)});if(!st.ok){const tn=await st.json().catch(()=>({}));throw new Error(tn.message||`AI recurring medication creation failed: ${st.statusText}`)}const dt=await st.json();return U("Recurring medication created!"),n&&ye(n),{action:"create_recurring_medication",success:!0,undo:async()=>{console.log(`Rolling back recurring medication ${dt.id}`),await ue(`/api/recurring-medications/${dt.id}`,{method:"DELETE"}),n&&ye(n)}}}catch(qe){return{action:"create_recurring_medication",success:!1,error:qe}}finally{B(!1)}})())):Se.action==="edit_recurring_medication"?(ft=!0,gt.push((async()=>{B(!0),U("Processing recurring edit...");try{const qe=Se.serialNumber,Be=Se.id;let tt;if(Be?tt=b.find(_t=>_t.id===Be):qe&&(tt=b[qe-1]),!tt)throw new Error("Recurring medication not found to edit.");const st=JSON.parse(JSON.stringify(tt)),dt=Se.items_to_remove,tn=Se.items;(Se.status==="stopped"||Se.status==="active")&&(tt.status=Se.status);let Nt=[...tt.medications];if(Array.isArray(dt)&&dt.length>0&&(Nt=Nt.filter(_t=>{const Wt=_t.name.toLowerCase().trim();return!dt.some(Et=>!!(Et.drug_id&&String(_t.drug_id)===String(Et.drug_id)||Et.name&&Et.name.toLowerCase().trim()===Wt))})),Array.isArray(tn)&&tn.length>0)for(const _t of tn){let Wt=oe(_t,v);if(!Wt)throw new Error(`Drug "${_t.name}" not found.`);const Et=K(_t,Wt),Dt={drug_id:Wt.id,name:Wt.name,...Et,directions_to_use:_t.directions_to_use,unit:Wt.unit},kt=Nt.findIndex(It=>It.drug_id===(Wt==null?void 0:Wt.id));kt!==-1?Nt[kt]={...Nt[kt],...Dt}:Nt.push(Dt)}const Ot={medications:Nt,status:tt.status,frequency_days:Se.frequency_days||tt.frequency_days,next_delivery_date:Se.next_delivery_date||tt.next_delivery_date},Vt=await ue(`/api/recurring-medications/${tt.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ot)});if(!Vt.ok){const _t=await Vt.json().catch(()=>({}));throw new Error(_t.message||`AI recurring med edit failed: ${Vt.statusText}`)}return U("Recurring medication updated!"),n&&ye(n),{action:"edit_recurring_medication",success:!0,undo:async()=>{console.log(`Reverting recurring medication ${tt.id}`),await ue(`/api/recurring-medications/${tt.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({medications:st.medications,status:st.status,frequency_days:st.frequency_days,next_delivery_date:st.next_delivery_date})}),n&&ye(n)}}}catch(qe){return{action:"edit_recurring_medication",success:!1,error:qe}}finally{B(!1)}})())):Se.action==="delete_recurring_medication"?(ft=!0,gt.push((async()=>{B(!0),U("Processing recurring deletion...");try{const qe=Se.serialNumber,Be=Se.id;let tt;if(Be?tt=b.find(dt=>dt.id===Be):qe&&(tt=b[qe-1]),!tt)throw new Error("Recurring medication not found.");const st=await ue(`/api/recurring-medications/${tt.id}`,{method:"DELETE"});if(!st.ok){const dt=await st.json().catch(()=>({}));throw new Error(dt.message||`AI recurring deletion failed: ${st.statusText}`)}return U("Recurring medication deleted!"),n&&ye(n),{action:"delete_recurring_medication",success:!0}}catch(qe){return{action:"delete_recurring_medication",success:!1,error:qe}}finally{B(!1)}})())):Se.action==="add_complaint_history"&&Se.complaint?(ft=!0,gt.push((async()=>{$(!0),W("Processing Hx...");try{if(!e)throw new Error("Missing Record ID for complaint history.");if(!Se.complaint||typeof Se.complaint!="string")throw new Error("Invalid AI complaint text.");const qe=C,Be={complaint:Se.complaint.trim()},tt=await ue(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)});if(!tt.ok){const dt=await tt.json().catch(()=>({}));throw new Error(dt.message||`AI complaint add failed: ${tt.statusText}`)}const st=await tt.json();return A(Be.complaint),W("Hx updated!"),n&&ge(n),{action:"add_complaint_history",success:!0,undo:async()=>{console.log(`Reverting complaint history for ${e}, restoring to: "${qe}"`),st.newHistoryId&&(console.log(`Deleting history entry ${st.newHistoryId}`),await ue(`/api/queue/doctor/complaint-history/${st.newHistoryId}`,{method:"DELETE"})),await ue(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:qe||"",skipHistory:!0})}),A(qe||""),n&&ge(n)}}}catch(qe){return{action:"add_complaint_history",success:!1,error:qe}}finally{$(!1)}})())):Se.action==="update_case_summary"&&Se.summary?(ft=!0,gt.push((async()=>{te(!0),ne("Processing summary...");try{if(!e)throw new Error("Missing Record ID for case summary update.");if(typeof Se.summary!="string")throw new Error("Invalid AI case summary text.");const qe=r,Be={case_summary:Se.summary.trim()},tt=await ue(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)});if(!tt.ok){const dt=await tt.json().catch(()=>({}));throw new Error(dt.message||`AI case summary update failed: ${tt.statusText}`)}const st=await tt.json();return re(st.case_summary),J(st.updatedAt),ne("Summary updated!"),{action:"update_case_summary",success:!0,undo:async()=>{console.log(`Reverting case summary for ${e}`),await ue(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:qe||""})}),re(qe||"")}}}catch(qe){return{action:"update_case_summary",success:!1,error:qe}}finally{te(!1)}})())):Se.action==="update_patient_status"?(ft=!0,gt.push((async()=>{try{const qe=Se.status;if(qe==="admit")t!=null&&t.discharge_date&&!(t!=null&&t.admission_date)?await Te():t!=null&&t.admission_date?console.log("Patient already admitted."):await Te();else if(qe==="discharge")t!=null&&t.admission_date&&!(t!=null&&t.discharge_date)?await Te():console.log("Patient already discharged or not admitted.");else if(qe==="complete_consultation")await we();else if(qe==="add_to_queue"){const Be=Se.queue_type;if(!Be||!["doctor","lab","pharmacy"].includes(Be))throw new Error(`Invalid or missing queue_type for add_to_queue action: ${Be}`);await Fe(Be)}else throw new Error(`Invalid status for update_patient_status: ${qe}`);return{action:"update_patient_status",success:!0,undo:async()=>{if(t&&n){console.log(`Reverting patient status for ${n}`);const Be={current_status:t.current_status,admission_date:t.admission_date,discharge_date:t.discharge_date};await ue(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)}),Re(n)}}}}catch(qe){return{action:"update_patient_status",success:!1,error:qe}}})())):Se.action==="blank_action"?(ft=!0,gt.push(Promise.resolve({action:"blank_action",success:!0}))):Se.action&&console.warn(`Unrecognized AI action: ${Se.action}`)}const $e=await Promise.allSettled(gt),nt=$e.filter(Se=>Se.status==="rejected"||Se.status==="fulfilled"&&!Se.value.success),Ve=$e.filter(Se=>Se.status==="fulfilled"&&Se.value.success);if(nt.length>0){console.log("Partial failure detected. Rolling back successful actions...");const Se=Ve.reverse();for(const st of Se)if(st.value.undo)try{await st.value.undo(),console.log(`Rolled back action: ${st.value.action}`)}catch(dt){console.error(`Failed to rollback action ${st.value.action}:`,dt)}const qe=nt.map(st=>{var dt,tn;return st.status==="rejected"?((dt=st.reason)==null?void 0:dt.message)||"Unknown error":((tn=st.value.error)==null?void 0:tn.message)||"Unknown error"}),Be=new Error(`Batch execution failed. Rolled back successful actions. Errors: ${qe.join("; ")}`),tt=((ht=nt[0].value)==null?void 0:ht.action)||"batch_execution";return await ct(tt,Be,Ie,Ye),!1}else{const Se=[];Ve.reverse().forEach(qe=>{qe.value.undo&&Se.push(qe.value.undo)}),Se.length>0&&(Ke(qe=>[...qe,Se]),Xe&&Xe(!0))}if(jt)typeof jt.question=="string"?(ee(jt.question),E(Array.isArray(jt.options)?jt.options:[])):console.warn("Invalid 'ask_followup_question' format.");else if(!ft)throw new Error("AI response did not result in a recognized or performed function call.");return!0},bt=async(Ae,Ie)=>{U(null),O(null),W(null),ne(null),H(null),ee(null),E([]),Q(null);const Ye=/```json\s*([\s\S]*?)\s*```/g;let ft;const gt=[];for(;(ft=Ye.exec(Ae))!==null;)ft[1]&&gt.push(ft[1]);if(gt.length===0){const jt=Ae.trim();if(jt.startsWith("{")&&jt.endsWith("}")||jt.startsWith("[")&&jt.endsWith("]"))gt.push(jt);else throw new Error("AI response did not contain a recognized function call.")}for(const jt of gt){let $e;try{$e=JSON.parse(jt)}catch(ht){await ct("parse_json_block",ht,Ae,Ie);return}const nt=Array.isArray($e)?$e:[$e];if(Array.isArray($e)){const ht=nt[0],Se=nt[nt.length-1];if(!ht||ht.action!=="first_action"||!Se||Se.action!=="last_action"){const qe=new Error("Invalid AI response: Each function call block must start with 'first_action' and end with 'last_action'.");await ct("wrapper_validation",qe,Ae,Ie);return}}if(!await Tt(nt,Ae,Ie))return}};ze=async(Ae,Ie=0)=>{if(Ie>1){z("AI call failed after multiple retries. Please try a different prompt."),F(!1);return}F(!0),z(null);let Ye;const gt=[...o,Ae].join(`

`);try{const jt=new Map;(u??[]).forEach(Be=>{jt.set(Be.id,{...Be})}),(d??[]).forEach(Be=>{if(!jt.has(Be.id))jt.set(Be.id,{id:Be.id,patient_id:Be.patient_id,tests:Be.tests,status:Be.status,createdAt:Be.createdAt,report:Be});else{const tt=jt.get(Be.id);tt&&(tt.report=Be,tt.status=Be.status)}});const $e=Array.from(jt.values());$e.sort((Be,tt)=>new Date(tt.createdAt).getTime()-new Date(Be.createdAt).getTime());const nt=$e.map((Be,tt)=>{let st=null;if(Be.report)try{const dt=typeof Be.report.report_content=="string"?Be.report.report_content:JSON.stringify(Be.report.report_content||{}),tn=JSON.parse(dt||"{}"),Nt=(Be.report.tests||[]).map(Ot=>{const Vt=tn[Ot.id]||{},_t=Wt=>({name:Wt.name,value:Vt[Wt.name]!==void 0?String(Vt[Wt.name]):String(Wt.defaultValue),normal_range:Wt.normal_range||"N/A"});return{testId:Ot.id,testName:Ot.name,parameters:(Ot.default_parameters||[]).map(_t)}});st={reportId:Be.report.reportId,reportDate:Be.report.report_date,tests:Nt}}catch{st={reportId:Be.report.reportId,reportDate:Be.report.report_date,reportContent:typeof Be.report.report_content=="string"?Be.report.report_content:JSON.stringify(Be.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:$e.length-tt,orderId:Be.id,orderDate:isNaN(new Date(Be.createdAt).getTime())?Be.createdAt:new Date(Be.createdAt).toISOString(),tests:Be.tests.map(dt=>({id:dt.id,name:dt.name,price:dt.price})),status:Be.status,report:st}}),Ve=h.map(Be=>{try{return{...Be,createdAt:isNaN(new Date(Be.createdAt).getTime())?Be.createdAt:new Date(Be.createdAt).toISOString()}}catch{return Be}}),Se=[...g].sort((Be,tt)=>{const st=new Date(Be.date).getTime(),dt=new Date(tt.date).getTime();return st-dt}).map((Be,tt)=>{try{return{serialNumber:tt+1,...Be,date:Be.date&&!isNaN(new Date(Be.date).getTime())?new Date(Be.date).toISOString():Be.date}}catch{return{serialNumber:tt+1,...Be}}}),qe={query:gt,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(l==null?void 0:l.aiMemory)||"",clinic_ai_memory_last_updated:l!=null&&l.aiMemoryUpdatedAt?new Date(l.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(l==null?void 0:l.clinicWideSystemPrompt)||"",labHistory:nt,pharmacyOrders:Se,pastComplaints:Ve,recurringMedications:b,pharmacyInventory:v,labInventory:N,patientStatus:t==null?void 0:t.current_status,isAdmitted:!!(t!=null&&t.admission_date)&&!(t!=null&&t.discharge_date),isInQueueToday:t==null?void 0:t.isInDoctorQueueToday,admissionDate:(t==null?void 0:t.admission_date)||null,dischargeDate:(t==null?void 0:t.discharge_date)||null};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(qe,null,2)),Ye=await OW(qe,f),Ye){T(Ye);const Be=/```json\s*([\s\S]*?)\s*```/,tt=Ye.match(Be);if(tt&&tt[1])D(Ye.replace(Be,"").trim()),M(tt[1].trim());else{const st=Ye.trim();if(st.startsWith("{")&&st.endsWith("}"))try{JSON.parse(st),D(""),M(st)}catch{D(st),M(null)}else if(st.startsWith("[")&&st.endsWith("]"))try{JSON.parse(st),D(""),M(st)}catch{D(st),M(null)}else D(st),M(null)}V(!1),n&&Ye&&await en(n,Ye),await bt(Ye,Ie),A("")}else throw new Error("Invalid AI response format.")}catch(jt){await ct("call_generative_api",jt,Ye,Ie)}finally{F(!1)}};const en=async(Ae,Ie)=>{ie(!0),I(null);try{const Ye={ai_response:Ie},ft=await ue(`/api/patients/${Ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ye)});if(!ft.ok){const gt=await ft.json().catch(()=>({}));throw new Error(gt.message||`Failed to save AI response to patient: ${ft.statusText}`)}}catch(Ye){I(`AI Response Save Error: ${Ye.message}`)}finally{ie(!1)}},oe=(Ae,Ie)=>{if(Ae.drug_id)return Ie.find(Ye=>Ye.id===String(Ae.drug_id));if(Ae.name)return Od(Ae.name,Ie)},K=(Ae,Ie)=>{const Ye=Number.isInteger(Number(Ae.tabletsPerDay))?Number(Ae.tabletsPerDay):1,ft=Number(Ae.numberOfDays)||1,gt=Number(Ae.pack_quantity)||0,jt=Number(Ae.loose_quantity)||0,$e=Tv(Ie.unit),nt=Number(Ie.price),Ve=nt,ht=$e>0?nt/$e:0,Se=gt*Ve+jt*ht;return{pack_quantity:gt,loose_quantity:jt,tabletsPerDay:Ye,numberOfDays:ft,pack_price:parseFloat(Ve.toFixed(2)),loose_price:parseFloat(ht.toFixed(2)),total_price:parseFloat(Se.toFixed(2))}},fe=async()=>{if(je.length===0)return;const Ae=je[je.length-1],Ie=je.slice(0,-1);Ke(Ie),Ie.length===0&&Xe&&Xe(!1),F(!0);try{console.log("Manual Undo: Executing undo functions...",Ae);for(const Ye of Ae)try{await Ye()}catch(ft){console.error("Error during manual undo:",ft)}console.log("Manual Undo Completed.")}finally{F(!1)}};return w.useImperativeHandle(it,()=>({callGenerativeApi:ze,undoLastBatch:fe})),null}),HW={};function $w(e,n){const t=HW,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return vT(e,r,a)}function vT(e,n,t){if(GW(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return p_(e.children,n,t)}return Array.isArray(e)?p_(e,n,t):""}function p_(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=vT(e[a],n,t);return r.join("")}function GW(e){return!!(e&&typeof e=="object")}const m_=document.createElement("i");function zw(e){const n="&"+e+";";m_.innerHTML=n;const t=m_.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function no(e,n,t,r){const a=e.length;let l=0,o;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)o=Array.from(r),o.unshift(n,t),e.splice(...o);else for(t&&e.splice(n,t);l<r.length;)o=r.slice(l,l+1e4),o.unshift(n,0),e.splice(...o),l+=1e4,n+=1e4}function Cs(e,n){return e.length>0?(no(e,e.length,0,n),e):n}const g_={}.hasOwnProperty;function YW(e){const n={};let t=-1;for(;++t<e.length;)WW(n,e[t]);return n}function WW(e,n){let t;for(t in n){const a=(g_.call(e,t)?e[t]:void 0)||(e[t]={}),l=n[t];let o;if(l)for(o in l){g_.call(a,o)||(a[o]=[]);const f=l[o];QW(a[o],Array.isArray(f)?f:f?[f]:[])}}}function QW(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);no(e,0,0,r)}function wT(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Fh(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Kl=yu(/[A-Za-z]/),es=yu(/[\dA-Za-z]/),JW=yu(/[#-'*+\--9=?A-Z^-~]/);function T1(e){return e!==null&&(e<32||e===127)}const E1=yu(/\d/),KW=yu(/[\dA-Fa-f]/),XW=yu(/[!-/:-@[-`{-~]/);function Zt(e){return e!==null&&e<-2}function ka(e){return e!==null&&(e<0||e===32)}function Vn(e){return e===-2||e===-1||e===32}const ZW=yu(new RegExp("\\p{P}|\\p{S}","u")),eQ=yu(/\s/);function yu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function tp(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const l=e.charCodeAt(t);let o="";if(l===37&&es(e.charCodeAt(t+1))&&es(e.charCodeAt(t+2)))a=2;else if(l<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(l))||(o=String.fromCharCode(l));else if(l>55295&&l<57344){const f=e.charCodeAt(t+1);l<56320&&f>56319&&f<57344?(o=String.fromCharCode(l,f),a=1):o=""}else o=String.fromCharCode(l);o&&(n.push(e.slice(r,t),encodeURIComponent(o)),r=t+a+1,o=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function yi(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let l=0;return o;function o(u){return Vn(u)?(e.enter(t),f(u)):n(u)}function f(u){return Vn(u)&&l++<a?(e.consume(u),f):(e.exit(t),n(u))}}const tQ={tokenize:nQ};function nQ(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),yi(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),l(f)}function l(f){const u=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=u),t=u,o(f)}function o(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return Zt(f)?(e.consume(f),e.exit("chunkText"),l):(e.consume(f),o)}}const iQ={tokenize:rQ},y_={tokenize:aQ};function rQ(e){const n=this,t=[];let r=0,a,l,o;return f;function f(M){if(r<t.length){const V=t[r];return n.containerState=V[1],e.attempt(V[0].continuation,u,d)(M)}return d(M)}function u(M){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&D();const V=n.events.length;let F=V,z;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){z=n.events[F][1].end;break}T(r);let B=V;for(;B<n.events.length;)n.events[B][1].end={...z},B++;return no(n.events,F+1,0,n.events.slice(V)),n.events.length=B,d(M)}return f(M)}function d(M){if(r===t.length){if(!a)return b(M);if(a.currentConstruct&&a.currentConstruct.concrete)return N(M);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(y_,h,g)(M)}function h(M){return a&&D(),T(r),b(M)}function g(M){return n.parser.lazy[n.now().line]=r!==t.length,o=n.now().offset,N(M)}function b(M){return n.containerState={},e.attempt(y_,v,N)(M)}function v(M){return r++,t.push([n.currentConstruct,n.containerState]),b(M)}function N(M){if(M===null){a&&D(),T(0),e.consume(M);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:l}),C(M)}function C(M){if(M===null){A(e.exit("chunkFlow"),!0),T(0),e.consume(M);return}return Zt(M)?(e.consume(M),A(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(M),C)}function A(M,V){const F=n.sliceStream(M);if(V&&F.push(null),M.previous=l,l&&(l.next=M),l=M,a.defineSkip(M.start),a.write(F),n.parser.lazy[M.start.line]){let z=a.events.length;for(;z--;)if(a.events[z][1].start.offset<o&&(!a.events[z][1].end||a.events[z][1].end.offset>o))return;const B=n.events.length;let U=B,R,O;for(;U--;)if(n.events[U][0]==="exit"&&n.events[U][1].type==="chunkFlow"){if(R){O=n.events[U][1].end;break}R=!0}for(T(r),z=B;z<n.events.length;)n.events[z][1].end={...O},z++;no(n.events,U+1,0,n.events.slice(B)),n.events.length=z}}function T(M){let V=t.length;for(;V-- >M;){const F=t[V];n.containerState=F[1],F[0].exit.call(n,e)}t.length=M}function D(){a.write([null]),l=void 0,a=void 0,n.containerState._closeFlow=void 0}}function aQ(e,n,t){return yi(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function xb(e){if(e===null||ka(e)||eQ(e))return 1;if(ZW(e))return 2}function Bw(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const l=e[a].resolveAll;l&&!r.includes(l)&&(n=l(n,t),r.push(l))}return n}const A1={name:"attention",resolveAll:sQ,tokenize:lQ};function sQ(e,n){let t=-1,r,a,l,o,f,u,d,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;u=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};x_(g,-u),x_(b,u),o={type:u>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:u>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},l={type:u>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:u>1?"strong":"emphasis",start:{...o.start},end:{...f.end}},e[r][1].end={...o.start},e[t][1].start={...f.end},d=[],e[r][1].end.offset-e[r][1].start.offset&&(d=Cs(d,[["enter",e[r][1],n],["exit",e[r][1],n]])),d=Cs(d,[["enter",a,n],["enter",o,n],["exit",o,n],["enter",l,n]]),d=Cs(d,Bw(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),d=Cs(d,[["exit",l,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,d=Cs(d,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,no(e,r-1,t-r+3,d),t=r+d.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function lQ(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=xb(r);let l;return o;function o(u){return l=u,e.enter("attentionSequence"),f(u)}function f(u){if(u===l)return e.consume(u),f;const d=e.exit("attentionSequence"),h=xb(u),g=!h||h===2&&a||t.includes(u),b=!a||a===2&&h||t.includes(r);return d._open=!!(l===42?g:g&&(a||!b)),d._close=!!(l===42?b:b&&(h||!g)),n(u)}}function x_(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const oQ={name:"autolink",tokenize:cQ};function cQ(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l}function l(v){return Kl(v)?(e.consume(v),o):v===64?t(v):d(v)}function o(v){return v===43||v===45||v===46||es(v)?(r=1,f(v)):d(v)}function f(v){return v===58?(e.consume(v),r=0,u):(v===43||v===45||v===46||es(v))&&r++<32?(e.consume(v),f):(r=0,d(v))}function u(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||T1(v)?t(v):(e.consume(v),u)}function d(v){return v===64?(e.consume(v),h):JW(v)?(e.consume(v),d):t(v)}function h(v){return es(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||es(v))&&r++<63){const N=v===45?b:g;return e.consume(v),N}return t(v)}}const qb={partial:!0,tokenize:uQ};function uQ(e,n,t){return r;function r(l){return Vn(l)?yi(e,a,"linePrefix")(l):a(l)}function a(l){return l===null||Zt(l)?n(l):t(l)}}const NT={continuation:{tokenize:fQ},exit:hQ,name:"blockQuote",tokenize:dQ};function dQ(e,n,t){const r=this;return a;function a(o){if(o===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),l}return t(o)}function l(o){return Vn(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(o))}}function fQ(e,n,t){const r=this;return a;function a(o){return Vn(o)?yi(e,l,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):l(o)}function l(o){return e.attempt(NT,n,t)(o)}}function hQ(e){e.exit("blockQuote")}const ST={name:"characterEscape",tokenize:pQ};function pQ(e,n,t){return r;function r(l){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(l),e.exit("escapeMarker"),a}function a(l){return XW(l)?(e.enter("characterEscapeValue"),e.consume(l),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(l)}}const jT={name:"characterReference",tokenize:mQ};function mQ(e,n,t){const r=this;let a=0,l,o;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),u}function u(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),l=31,o=es,h(g))}function d(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),l=6,o=KW,h):(e.enter("characterReferenceValue"),l=7,o=E1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return o===es&&!zw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return o(g)&&a++<l?(e.consume(g),h):t(g)}}const b_={partial:!0,tokenize:yQ},v_={concrete:!0,name:"codeFenced",tokenize:gQ};function gQ(e,n,t){const r=this,a={partial:!0,tokenize:F};let l=0,o=0,f;return u;function u(z){return d(z)}function d(z){const B=r.events[r.events.length-1];return l=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,f=z,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(z)}function h(z){return z===f?(o++,e.consume(z),h):o<3?t(z):(e.exit("codeFencedFenceSequence"),Vn(z)?yi(e,g,"whitespace")(z):g(z))}function g(z){return z===null||Zt(z)?(e.exit("codeFencedFence"),r.interrupt?n(z):e.check(b_,C,V)(z)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(z))}function b(z){return z===null||Zt(z)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(z)):Vn(z)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),yi(e,v,"whitespace")(z)):z===96&&z===f?t(z):(e.consume(z),b)}function v(z){return z===null||Zt(z)?g(z):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),N(z))}function N(z){return z===null||Zt(z)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(z)):z===96&&z===f?t(z):(e.consume(z),N)}function C(z){return e.attempt(a,V,A)(z)}function A(z){return e.enter("lineEnding"),e.consume(z),e.exit("lineEnding"),T}function T(z){return l>0&&Vn(z)?yi(e,D,"linePrefix",l+1)(z):D(z)}function D(z){return z===null||Zt(z)?e.check(b_,C,V)(z):(e.enter("codeFlowValue"),M(z))}function M(z){return z===null||Zt(z)?(e.exit("codeFlowValue"),D(z)):(e.consume(z),M)}function V(z){return e.exit("codeFenced"),n(z)}function F(z,B,U){let R=0;return O;function O(re){return z.enter("lineEnding"),z.consume(re),z.exit("lineEnding"),$}function $(re){return z.enter("codeFencedFence"),Vn(re)?yi(z,W,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(re):W(re)}function W(re){return re===f?(z.enter("codeFencedFenceSequence"),te(re)):U(re)}function te(re){return re===f?(R++,z.consume(re),te):R>=o?(z.exit("codeFencedFenceSequence"),Vn(re)?yi(z,ne,"whitespace")(re):ne(re)):U(re)}function ne(re){return re===null||Zt(re)?(z.exit("codeFencedFence"),B(re)):U(re)}}}function yQ(e,n,t){const r=this;return a;function a(o){return o===null?t(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}const Ev={name:"codeIndented",tokenize:bQ},xQ={partial:!0,tokenize:vQ};function bQ(e,n,t){const r=this;return a;function a(d){return e.enter("codeIndented"),yi(e,l,"linePrefix",5)(d)}function l(d){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?o(d):t(d)}function o(d){return d===null?u(d):Zt(d)?e.attempt(xQ,o,u)(d):(e.enter("codeFlowValue"),f(d))}function f(d){return d===null||Zt(d)?(e.exit("codeFlowValue"),o(d)):(e.consume(d),f)}function u(d){return e.exit("codeIndented"),n(d)}}function vQ(e,n,t){const r=this;return a;function a(o){return r.parser.lazy[r.now().line]?t(o):Zt(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):yi(e,l,"linePrefix",5)(o)}function l(o){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):Zt(o)?a(o):t(o)}}const wQ={name:"codeText",previous:SQ,resolve:NQ,tokenize:jQ};function NQ(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function SQ(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function jQ(e,n,t){let r=0,a,l;return o;function o(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),u(g))}function u(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),u):g===96?(l=e.enter("codeTextSequence"),a=0,h(g)):Zt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),u):(e.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||Zt(g)?(e.exit("codeTextData"),u(g)):(e.consume(g),d)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(l.type="codeTextData",d(g))}}class _Q{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const l=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Um(this.left,r),l.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Um(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Um(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Um(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Um(this.left,t.reverse())}}}function Um(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function _T(e){const n={};let t=-1,r,a,l,o,f,u,d;const h=new _Q(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,l=0,l<u.length&&u[l][1].type==="lineEndingBlank"&&(l+=2),l<u.length&&u[l][1].type==="content"))for(;++l<u.length&&u[l][1].type!=="content";)u[l][1].type==="chunkText"&&(u[l][1]._isInFirstContentOfListItem=!0,l++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,CQ(h,t)),t=n[t],d=!0);else if(r[1]._container){for(l=t,a=void 0;l--;)if(o=h.get(l),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),o[1].type="lineEnding",a=l);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return no(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!d}function CQ(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const l=[];let o=t._tokenizer;o||(o=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const f=o.events,u=[],d={};let h,g,b=-1,v=t,N=0,C=0;const A=[C];for(;v;){for(;e.get(++a)[1]!==v;);l.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&o.defineSkip(v.start),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(h),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(C=b+1,A.push(C),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(o.events=[],v?(v._tokenizer=void 0,v.previous=void 0):A.pop(),b=A.length;b--;){const T=f.slice(A[b],A[b+1]),D=l.pop();u.push([D,D+T.length-1]),e.splice(D,2,T)}for(u.reverse(),b=-1;++b<u.length;)d[N+u[b][0]]=N+u[b][1],N+=u[b][1]-u[b][0]-1;return d}const kQ={resolve:EQ,tokenize:AQ},TQ={partial:!0,tokenize:PQ};function EQ(e){return _T(e),e}function AQ(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?l(f):Zt(f)?e.check(TQ,o,l)(f):(e.consume(f),a)}function l(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function o(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function PQ(e,n,t){const r=this;return a;function a(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),yi(e,l,"linePrefix")}function l(o){if(o===null||Zt(o))return t(o);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):e.interrupt(r.parser.constructs.flow,t,n)(o)}}function CT(e,n,t,r,a,l,o,f,u){const d=u||Number.POSITIVE_INFINITY;let h=0;return g;function g(T){return T===60?(e.enter(r),e.enter(a),e.enter(l),e.consume(T),e.exit(l),b):T===null||T===32||T===41||T1(T)?t(T):(e.enter(r),e.enter(o),e.enter(f),e.enter("chunkString",{contentType:"string"}),C(T))}function b(T){return T===62?(e.enter(l),e.consume(T),e.exit(l),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(T))}function v(T){return T===62?(e.exit("chunkString"),e.exit(f),b(T)):T===null||T===60||Zt(T)?t(T):(e.consume(T),T===92?N:v)}function N(T){return T===60||T===62||T===92?(e.consume(T),v):v(T)}function C(T){return!h&&(T===null||T===41||ka(T))?(e.exit("chunkString"),e.exit(f),e.exit(o),e.exit(r),n(T)):h<d&&T===40?(e.consume(T),h++,C):T===41?(e.consume(T),h--,C):T===null||T===32||T===40||T1(T)?t(T):(e.consume(T),T===92?A:C)}function A(T){return T===40||T===41||T===92?(e.consume(T),C):C(T)}}function kT(e,n,t,r,a,l){const o=this;let f=0,u;return d;function d(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(l),h}function h(v){return f>999||v===null||v===91||v===93&&!u||v===94&&!f&&"_hiddenFootnoteSupport"in o.parser.constructs?t(v):v===93?(e.exit(l),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Zt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Zt(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),u||(u=!Vn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function TT(e,n,t,r,a,l){let o;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),o=b===40?41:b,u):t(b)}function u(b){return b===o?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(l),d(b))}function d(b){return b===o?(e.exit(l),u(o)):b===null?t(b):Zt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),yi(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===o||b===null||Zt(b)?(e.exit("chunkString"),d(b)):(e.consume(b),b===92?g:h)}function g(b){return b===o||b===92?(e.consume(b),h):h(b)}}function Km(e,n){let t;return r;function r(a){return Zt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):Vn(a)?yi(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const DQ={name:"definition",tokenize:IQ},MQ={partial:!0,tokenize:RQ};function IQ(e,n,t){const r=this;let a;return l;function l(v){return e.enter("definition"),o(v)}function o(v){return kT.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=Fh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),u):t(v)}function u(v){return ka(v)?Km(e,d)(v):d(v)}function d(v){return CT(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(MQ,g,g)(v)}function g(v){return Vn(v)?yi(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Zt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function RQ(e,n,t){return r;function r(f){return ka(f)?Km(e,a)(f):t(f)}function a(f){return TT(e,l,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function l(f){return Vn(f)?yi(e,o,"whitespace")(f):o(f)}function o(f){return f===null||Zt(f)?n(f):t(f)}}const LQ={name:"hardBreakEscape",tokenize:OQ};function OQ(e,n,t){return r;function r(l){return e.enter("hardBreakEscape"),e.consume(l),a}function a(l){return Zt(l)?(e.exit("hardBreakEscape"),n(l)):t(l)}}const FQ={name:"headingAtx",resolve:$Q,tokenize:zQ};function $Q(e,n){let t=e.length-2,r=3,a,l;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},l={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},no(e,r,t-r+1,[["enter",a,n],["enter",l,n],["exit",l,n],["exit",a,n]])),e}function zQ(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),l(h)}function l(h){return e.enter("atxHeadingSequence"),o(h)}function o(h){return h===35&&r++<6?(e.consume(h),o):h===null||ka(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),u(h)):h===null||Zt(h)?(e.exit("atxHeading"),n(h)):Vn(h)?yi(e,f,"whitespace")(h):(e.enter("atxHeadingText"),d(h))}function u(h){return h===35?(e.consume(h),u):(e.exit("atxHeadingSequence"),f(h))}function d(h){return h===null||h===35||ka(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),d)}}const BQ=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],w_=["pre","script","style","textarea"],UQ={concrete:!0,name:"htmlFlow",resolveTo:HQ,tokenize:GQ},qQ={partial:!0,tokenize:WQ},VQ={partial:!0,tokenize:YQ};function HQ(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function GQ(e,n,t){const r=this;let a,l,o,f,u;return d;function d(I){return h(I)}function h(I){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(I),g}function g(I){return I===33?(e.consume(I),b):I===47?(e.consume(I),l=!0,C):I===63?(e.consume(I),a=3,r.interrupt?n:E):Kl(I)?(e.consume(I),o=String.fromCharCode(I),A):t(I)}function b(I){return I===45?(e.consume(I),a=2,v):I===91?(e.consume(I),a=5,f=0,N):Kl(I)?(e.consume(I),a=4,r.interrupt?n:E):t(I)}function v(I){return I===45?(e.consume(I),r.interrupt?n:E):t(I)}function N(I){const ce="CDATA[";return I===ce.charCodeAt(f++)?(e.consume(I),f===ce.length?r.interrupt?n:W:N):t(I)}function C(I){return Kl(I)?(e.consume(I),o=String.fromCharCode(I),A):t(I)}function A(I){if(I===null||I===47||I===62||ka(I)){const ce=I===47,xe=o.toLowerCase();return!ce&&!l&&w_.includes(xe)?(a=1,r.interrupt?n(I):W(I)):BQ.includes(o.toLowerCase())?(a=6,ce?(e.consume(I),T):r.interrupt?n(I):W(I)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(I):l?D(I):M(I))}return I===45||es(I)?(e.consume(I),o+=String.fromCharCode(I),A):t(I)}function T(I){return I===62?(e.consume(I),r.interrupt?n:W):t(I)}function D(I){return Vn(I)?(e.consume(I),D):O(I)}function M(I){return I===47?(e.consume(I),O):I===58||I===95||Kl(I)?(e.consume(I),V):Vn(I)?(e.consume(I),M):O(I)}function V(I){return I===45||I===46||I===58||I===95||es(I)?(e.consume(I),V):F(I)}function F(I){return I===61?(e.consume(I),z):Vn(I)?(e.consume(I),F):M(I)}function z(I){return I===null||I===60||I===61||I===62||I===96?t(I):I===34||I===39?(e.consume(I),u=I,B):Vn(I)?(e.consume(I),z):U(I)}function B(I){return I===u?(e.consume(I),u=null,R):I===null||Zt(I)?t(I):(e.consume(I),B)}function U(I){return I===null||I===34||I===39||I===47||I===60||I===61||I===62||I===96||ka(I)?F(I):(e.consume(I),U)}function R(I){return I===47||I===62||Vn(I)?M(I):t(I)}function O(I){return I===62?(e.consume(I),$):t(I)}function $(I){return I===null||Zt(I)?W(I):Vn(I)?(e.consume(I),$):t(I)}function W(I){return I===45&&a===2?(e.consume(I),J):I===60&&a===1?(e.consume(I),q):I===62&&a===4?(e.consume(I),Q):I===63&&a===3?(e.consume(I),E):I===93&&a===5?(e.consume(I),ee):Zt(I)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(qQ,ie,te)(I)):I===null||Zt(I)?(e.exit("htmlFlowData"),te(I)):(e.consume(I),W)}function te(I){return e.check(VQ,ne,ie)(I)}function ne(I){return e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),re}function re(I){return I===null||Zt(I)?te(I):(e.enter("htmlFlowData"),W(I))}function J(I){return I===45?(e.consume(I),E):W(I)}function q(I){return I===47?(e.consume(I),o="",H):W(I)}function H(I){if(I===62){const ce=o.toLowerCase();return w_.includes(ce)?(e.consume(I),Q):W(I)}return Kl(I)&&o.length<8?(e.consume(I),o+=String.fromCharCode(I),H):W(I)}function ee(I){return I===93?(e.consume(I),E):W(I)}function E(I){return I===62?(e.consume(I),Q):I===45&&a===2?(e.consume(I),E):W(I)}function Q(I){return I===null||Zt(I)?(e.exit("htmlFlowData"),ie(I)):(e.consume(I),Q)}function ie(I){return e.exit("htmlFlow"),n(I)}}function YQ(e,n,t){const r=this;return a;function a(o){return Zt(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l):t(o)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}function WQ(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(qb,n,t)}}const QQ={name:"htmlText",tokenize:JQ};function JQ(e,n,t){const r=this;let a,l,o;return f;function f(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),u}function u(E){return E===33?(e.consume(E),d):E===47?(e.consume(E),F):E===63?(e.consume(E),M):Kl(E)?(e.consume(E),U):t(E)}function d(E){return E===45?(e.consume(E),h):E===91?(e.consume(E),l=0,N):Kl(E)?(e.consume(E),D):t(E)}function h(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Zt(E)?(o=g,q(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?J(E):E===45?b(E):g(E)}function N(E){const Q="CDATA[";return E===Q.charCodeAt(l++)?(e.consume(E),l===Q.length?C:N):t(E)}function C(E){return E===null?t(E):E===93?(e.consume(E),A):Zt(E)?(o=C,q(E)):(e.consume(E),C)}function A(E){return E===93?(e.consume(E),T):C(E)}function T(E){return E===62?J(E):E===93?(e.consume(E),T):C(E)}function D(E){return E===null||E===62?J(E):Zt(E)?(o=D,q(E)):(e.consume(E),D)}function M(E){return E===null?t(E):E===63?(e.consume(E),V):Zt(E)?(o=M,q(E)):(e.consume(E),M)}function V(E){return E===62?J(E):M(E)}function F(E){return Kl(E)?(e.consume(E),z):t(E)}function z(E){return E===45||es(E)?(e.consume(E),z):B(E)}function B(E){return Zt(E)?(o=B,q(E)):Vn(E)?(e.consume(E),B):J(E)}function U(E){return E===45||es(E)?(e.consume(E),U):E===47||E===62||ka(E)?R(E):t(E)}function R(E){return E===47?(e.consume(E),J):E===58||E===95||Kl(E)?(e.consume(E),O):Zt(E)?(o=R,q(E)):Vn(E)?(e.consume(E),R):J(E)}function O(E){return E===45||E===46||E===58||E===95||es(E)?(e.consume(E),O):$(E)}function $(E){return E===61?(e.consume(E),W):Zt(E)?(o=$,q(E)):Vn(E)?(e.consume(E),$):R(E)}function W(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,te):Zt(E)?(o=W,q(E)):Vn(E)?(e.consume(E),W):(e.consume(E),ne)}function te(E){return E===a?(e.consume(E),a=void 0,re):E===null?t(E):Zt(E)?(o=te,q(E)):(e.consume(E),te)}function ne(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||ka(E)?R(E):(e.consume(E),ne)}function re(E){return E===47||E===62||ka(E)?R(E):t(E)}function J(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function q(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),H}function H(E){return Vn(E)?yi(e,ee,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):ee(E)}function ee(E){return e.enter("htmlTextData"),o(E)}}const Uw={name:"labelEnd",resolveAll:eJ,resolveTo:tJ,tokenize:nJ},KQ={tokenize:iJ},XQ={tokenize:rJ},ZQ={tokenize:aJ};function eJ(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&no(e,0,e.length,t),e}function tJ(e,n){let t=e.length,r=0,a,l,o,f;for(;t--;)if(a=e[t][1],l){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(o){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(l=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(o=t);const u={type:e[l][1].type==="labelLink"?"link":"image",start:{...e[l][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[l][1].start},end:{...e[o][1].end}},h={type:"labelText",start:{...e[l+r+2][1].end},end:{...e[o-2][1].start}};return f=[["enter",u,n],["enter",d,n]],f=Cs(f,e.slice(l+1,l+r+3)),f=Cs(f,[["enter",h,n]]),f=Cs(f,Bw(n.parser.constructs.insideSpan.null,e.slice(l+r+4,o-3),n)),f=Cs(f,[["exit",h,n],e[o-2],e[o-1],["exit",d,n]]),f=Cs(f,e.slice(o+1)),f=Cs(f,[["exit",u,n]]),no(e,l,e.length,f),e}function nJ(e,n,t){const r=this;let a=r.events.length,l,o;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){l=r.events[a][1];break}return f;function f(b){return l?l._inactive?g(b):(o=r.parser.defined.includes(Fh(r.sliceSerialize({start:l.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),u):t(b)}function u(b){return b===40?e.attempt(KQ,h,o?h:g)(b):b===91?e.attempt(XQ,h,o?d:g)(b):o?h(b):g(b)}function d(b){return e.attempt(ZQ,h,g)(b)}function h(b){return n(b)}function g(b){return l._balanced=!0,t(b)}}function iJ(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return ka(g)?Km(e,l)(g):l(g)}function l(g){return g===41?h(g):CT(e,o,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function o(g){return ka(g)?Km(e,u)(g):h(g)}function f(g){return t(g)}function u(g){return g===34||g===39||g===40?TT(e,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function d(g){return ka(g)?Km(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function rJ(e,n,t){const r=this;return a;function a(f){return kT.call(r,e,l,o,"reference","referenceMarker","referenceString")(f)}function l(f){return r.parser.defined.includes(Fh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function o(f){return t(f)}}function aJ(e,n,t){return r;function r(l){return e.enter("reference"),e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),a}function a(l){return l===93?(e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),e.exit("reference"),n):t(l)}}const sJ={name:"labelStartImage",resolveAll:Uw.resolveAll,tokenize:lJ};function lJ(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),l}function l(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),o):t(f)}function o(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const oJ={name:"labelStartLink",resolveAll:Uw.resolveAll,tokenize:cJ};function cJ(e,n,t){const r=this;return a;function a(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),l}function l(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(o):n(o)}}const Av={name:"lineEnding",tokenize:uJ};function uJ(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),yi(e,n,"linePrefix")}}const Qx={name:"thematicBreak",tokenize:dJ};function dJ(e,n,t){let r=0,a;return l;function l(d){return e.enter("thematicBreak"),o(d)}function o(d){return a=d,f(d)}function f(d){return d===a?(e.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||Zt(d))?(e.exit("thematicBreak"),n(d)):t(d)}function u(d){return d===a?(e.consume(d),r++,u):(e.exit("thematicBreakSequence"),Vn(d)?yi(e,f,"whitespace")(d):f(d))}}const _a={continuation:{tokenize:mJ},exit:yJ,name:"list",tokenize:pJ},fJ={partial:!0,tokenize:xJ},hJ={partial:!0,tokenize:gJ};function pJ(e,n,t){const r=this,a=r.events[r.events.length-1];let l=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,o=0;return f;function f(v){const N=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(N==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:E1(v)){if(r.containerState.type||(r.containerState.type=N,e.enter(N,{_container:!0})),N==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Qx,t,d)(v):d(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(v)}return t(v)}function u(v){return E1(v)&&++o<10?(e.consume(v),u):(!r.interrupt||o<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),d(v)):t(v)}function d(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(qb,r.interrupt?t:h,e.attempt(fJ,b,g))}function h(v){return r.containerState.initialBlankLine=!0,l++,b(v)}function g(v){return Vn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=l+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function mJ(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(qb,a,l);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,yi(e,n,"listItemIndent",r.containerState.size+1)(f)}function l(f){return r.containerState.furtherBlankLines||!Vn(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(hJ,n,o)(f))}function o(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,yi(e,e.attempt(_a,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function gJ(e,n,t){const r=this;return yi(e,a,"listItemIndent",r.containerState.size+1);function a(l){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?n(l):t(l)}}function yJ(e){e.exit(this.containerState.type)}function xJ(e,n,t){const r=this;return yi(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(l){const o=r.events[r.events.length-1];return!Vn(l)&&o&&o[1].type==="listItemPrefixWhitespace"?n(l):t(l)}}const N_={name:"setextUnderline",resolveTo:bJ,tokenize:vJ};function bJ(e,n){let t=e.length,r,a,l;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!l&&e[t][1].type==="definition"&&(l=t);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",l?(e.splice(a,0,["enter",o,n]),e.splice(l+1,0,["exit",e[r][1],n]),e[r][1].end={...e[l][1].end}):e[r][1]=o,e.push(["exit",o,n]),e}function vJ(e,n,t){const r=this;let a;return l;function l(d){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=d,o(d)):t(d)}function o(d){return e.enter("setextHeadingLineSequence"),f(d)}function f(d){return d===a?(e.consume(d),f):(e.exit("setextHeadingLineSequence"),Vn(d)?yi(e,u,"lineSuffix")(d):u(d))}function u(d){return d===null||Zt(d)?(e.exit("setextHeadingLine"),n(d)):t(d)}}const wJ={tokenize:NJ};function NJ(e){const n=this,t=e.attempt(qb,r,e.attempt(this.parser.constructs.flowInitial,a,yi(e,e.attempt(this.parser.constructs.flow,a,e.attempt(kQ,a)),"linePrefix")));return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEndingBlank"),e.consume(l),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const SJ={resolveAll:AT()},jJ=ET("string"),_J=ET("text");function ET(e){return{resolveAll:AT(e==="text"?CJ:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],l=t.attempt(a,o,f);return o;function o(h){return d(h)?l(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),u}function u(h){return d(h)?(t.exit("data"),l(h)):(t.consume(h),u)}function d(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function AT(e){return n;function n(t,r){let a=-1,l;for(;++a<=t.length;)l===void 0?t[a]&&t[a][1].type==="data"&&(l=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==l+2&&(t[l][1].end=t[a-1][1].end,t.splice(l+2,a-l-2),a=l+2),l=void 0);return e?e(t,r):t}}function CJ(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let l=a.length,o=-1,f=0,u;for(;l--;){const d=a[l];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)f++,o--;if(o)break;o=-1}else if(d===-2)u=!0,f++;else if(d!==-1){l++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const d={type:t===e.length||u||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:l?o:r.start._bufferIndex+o,_index:r.start._index+l,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(e.splice(t,0,["enter",d,n],["exit",d,n]),t+=2)}t++}return e}const kJ={42:_a,43:_a,45:_a,48:_a,49:_a,50:_a,51:_a,52:_a,53:_a,54:_a,55:_a,56:_a,57:_a,62:NT},TJ={91:DQ},EJ={[-2]:Ev,[-1]:Ev,32:Ev},AJ={35:FQ,42:Qx,45:[N_,Qx],60:UQ,61:N_,95:Qx,96:v_,126:v_},PJ={38:jT,92:ST},DJ={[-5]:Av,[-4]:Av,[-3]:Av,33:sJ,38:jT,42:A1,60:[oQ,QQ],91:oJ,92:[LQ,ST],93:Uw,95:A1,96:wQ},MJ={null:[A1,SJ]},IJ={null:[42,95]},RJ={null:[]},LJ=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:IJ,contentInitial:TJ,disable:RJ,document:kJ,flow:AJ,flowInitial:EJ,insideSpan:MJ,string:PJ,text:DJ},Symbol.toStringTag,{value:"Module"}));function OJ(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},l=[];let o=[],f=[];const u={attempt:B(F),check:B(z),consume:D,enter:M,exit:V,interrupt:B(z,{interrupt:!0})},d={code:null,containerState:{},defineSkip:C,events:[],now:N,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(d,u);return n.resolveAll&&l.push(n),d;function g($){return o=Cs(o,$),A(),o[o.length-1]!==null?[]:(U(n,0),d.events=Bw(l,d.events,d),d.events)}function b($,W){return $J(v($),W)}function v($){return FJ(o,$)}function N(){const{_bufferIndex:$,_index:W,line:te,column:ne,offset:re}=r;return{_bufferIndex:$,_index:W,line:te,column:ne,offset:re}}function C($){a[$.line]=$.column,O()}function A(){let $;for(;r._index<o.length;){const W=o[r._index];if(typeof W=="string")for($=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===$&&r._bufferIndex<W.length;)T(W.charCodeAt(r._bufferIndex));else T(W)}}function T($){h=h($)}function D($){Zt($)?(r.line++,r.column=1,r.offset+=$===-3?2:1,O()):$!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=$}function M($,W){const te=W||{};return te.type=$,te.start=N(),d.events.push(["enter",te,d]),f.push(te),te}function V($){const W=f.pop();return W.end=N(),d.events.push(["exit",W,d]),W}function F($,W){U($,W.from)}function z($,W){W.restore()}function B($,W){return te;function te(ne,re,J){let q,H,ee,E;return Array.isArray(ne)?ie(ne):"tokenize"in ne?ie([ne]):Q(ne);function Q(le){return ge;function ge(ye){const Re=ye!==null&&le[ye],Ze=ye!==null&&le.null,at=[...Array.isArray(Re)?Re:Re?[Re]:[],...Array.isArray(Ze)?Ze:Ze?[Ze]:[]];return ie(at)(ye)}}function ie(le){return q=le,H=0,le.length===0?J:I(le[H])}function I(le){return ge;function ge(ye){return E=R(),ee=le,le.partial||(d.currentConstruct=le),le.name&&d.parser.constructs.disable.null.includes(le.name)?xe():le.tokenize.call(W?Object.assign(Object.create(d),W):d,u,ce,xe)(ye)}}function ce(le){return $(ee,E),re}function xe(le){return E.restore(),++H<q.length?I(q[H]):J}}}function U($,W){$.resolveAll&&!l.includes($)&&l.push($),$.resolve&&no(d.events,W,d.events.length-W,$.resolve(d.events.slice(W),d)),$.resolveTo&&(d.events=$.resolveTo(d.events,d))}function R(){const $=N(),W=d.previous,te=d.currentConstruct,ne=d.events.length,re=Array.from(f);return{from:ne,restore:J};function J(){r=$,d.previous=W,d.currentConstruct=te,d.events.length=ne,f=re,O()}}function O(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function FJ(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,l=n.end._bufferIndex;let o;if(t===a)o=[e[t].slice(r,l)];else{if(o=e.slice(t,a),r>-1){const f=o[0];typeof f=="string"?o[0]=f.slice(r):o.shift()}l>0&&o.push(e[a].slice(0,l))}return o}function $J(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const l=e[t];let o;if(typeof l=="string")o=l;else switch(l){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=n?" ":"	";break}case-1:{if(!n&&a)continue;o=" ";break}default:o=String.fromCharCode(l)}a=l===-2,r.push(o)}return r.join("")}function zJ(e){const r={constructs:YW([LJ,...(e||{}).extensions||[]]),content:a(tQ),defined:[],document:a(iQ),flow:a(wJ),lazy:{},string:a(jJ),text:a(_J)};return r;function a(l){return o;function o(f){return OJ(r,l,f)}}}function BJ(e){for(;!_T(e););return e}const S_=/[\0\t\n\r]/g;function UJ(){let e=1,n="",t=!0,r;return a;function a(l,o,f){const u=[];let d,h,g,b,v;for(l=n+(typeof l=="string"?l.toString():new TextDecoder(o||void 0).decode(l)),g=0,n="",t&&(l.charCodeAt(0)===65279&&g++,t=void 0);g<l.length;){if(S_.lastIndex=g,d=S_.exec(l),b=d&&d.index!==void 0?d.index:l.length,v=l.charCodeAt(b),!d){n=l.slice(g);break}if(v===10&&g===b&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),g<b&&(u.push(l.slice(g,b)),e+=b-g),v){case 0:{u.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,u.push(-2);e++<h;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&u.push(-5),n&&u.push(n),u.push(null)),u}}const qJ=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function PT(e){return e.replace(qJ,VJ)}function VJ(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),l=a===120||a===88;return wT(t.slice(l?2:1),l?16:10)}return zw(t)||e}function Xm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?j_(e.position):"start"in e||"end"in e?j_(e):"line"in e||"column"in e?P1(e):""}function P1(e){return __(e&&e.line)+":"+__(e&&e.column)}function j_(e){return P1(e&&e.start)+"-"+P1(e&&e.end)}function __(e){return e&&typeof e=="number"?e:1}const DT={}.hasOwnProperty;function HJ(e,n,t){return typeof n!="string"&&(t=n,n=void 0),GJ(t)(BJ(zJ(t).document().write(UJ()(e,n,!0))))}function GJ(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:l(Ke),autolinkProtocol:R,autolinkEmail:R,atxHeading:l(Fe),blockQuote:l(Ze),characterEscape:R,characterReference:R,codeFenced:l(at),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:l(at,o),codeText:l(Le,o),codeTextData:R,data:R,codeFlowValue:R,definition:l(Te),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:l(we),hardBreakEscape:l(Xe),hardBreakTrailing:l(Xe),htmlFlow:l(it,o),htmlFlowData:R,htmlText:l(it,o),htmlTextData:R,image:l(je),label:o,link:l(Ke),listItem:l(ct),listItemValue:b,listOrdered:l(ze,g),listUnordered:l(ze),paragraph:l(Tt),reference:I,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:l(Fe),strong:l(bt),thematicBreak:l(oe)},exit:{atxHeading:u(),atxHeadingSequence:F,autolink:u(),autolinkEmail:Re,autolinkProtocol:ye,blockQuote:u(),characterEscapeValue:O,characterReferenceMarkerHexadecimal:xe,characterReferenceMarkerNumeric:xe,characterReferenceValue:le,characterReference:ge,codeFenced:u(A),codeFencedFence:C,codeFencedFenceInfo:v,codeFencedFenceMeta:N,codeFlowValue:O,codeIndented:u(T),codeText:u(re),codeTextData:O,data:O,definition:u(),definitionDestinationString:V,definitionLabelString:D,definitionTitleString:M,emphasis:u(),hardBreakEscape:u(W),hardBreakTrailing:u(W),htmlFlow:u(te),htmlFlowData:O,htmlText:u(ne),htmlTextData:O,image:u(q),label:ee,labelText:H,lineEnding:$,link:u(J),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:ce,resourceDestinationString:E,resourceTitleString:Q,resource:ie,setextHeading:u(U),setextHeadingLineSequence:B,setextHeadingText:z,strong:u(),thematicBreak:u()}};MT(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(K){let fe={type:"root",children:[]};const Ae={stack:[fe],tokenStack:[],config:n,enter:f,exit:d,buffer:o,resume:h,data:t},Ie=[];let Ye=-1;for(;++Ye<K.length;)if(K[Ye][1].type==="listOrdered"||K[Ye][1].type==="listUnordered")if(K[Ye][0]==="enter")Ie.push(Ye);else{const ft=Ie.pop();Ye=a(K,ft,Ye)}for(Ye=-1;++Ye<K.length;){const ft=n[K[Ye][0]];DT.call(ft,K[Ye][1].type)&&ft[K[Ye][1].type].call(Object.assign({sliceSerialize:K[Ye][2].sliceSerialize},Ae),K[Ye][1])}if(Ae.tokenStack.length>0){const ft=Ae.tokenStack[Ae.tokenStack.length-1];(ft[1]||C_).call(Ae,void 0,ft[0])}for(fe.position={start:nu(K.length>0?K[0][1].start:{line:1,column:1,offset:0}),end:nu(K.length>0?K[K.length-2][1].end:{line:1,column:1,offset:0})},Ye=-1;++Ye<n.transforms.length;)fe=n.transforms[Ye](fe)||fe;return fe}function a(K,fe,Ae){let Ie=fe-1,Ye=-1,ft=!1,gt,jt,$e,nt;for(;++Ie<=Ae;){const Ve=K[Ie];switch(Ve[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ve[0]==="enter"?Ye++:Ye--,nt=void 0;break}case"lineEndingBlank":{Ve[0]==="enter"&&(gt&&!nt&&!Ye&&!$e&&($e=Ie),nt=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:nt=void 0}if(!Ye&&Ve[0]==="enter"&&Ve[1].type==="listItemPrefix"||Ye===-1&&Ve[0]==="exit"&&(Ve[1].type==="listUnordered"||Ve[1].type==="listOrdered")){if(gt){let ht=Ie;for(jt=void 0;ht--;){const Se=K[ht];if(Se[1].type==="lineEnding"||Se[1].type==="lineEndingBlank"){if(Se[0]==="exit")continue;jt&&(K[jt][1].type="lineEndingBlank",ft=!0),Se[1].type="lineEnding",jt=ht}else if(!(Se[1].type==="linePrefix"||Se[1].type==="blockQuotePrefix"||Se[1].type==="blockQuotePrefixWhitespace"||Se[1].type==="blockQuoteMarker"||Se[1].type==="listItemIndent"))break}$e&&(!jt||$e<jt)&&(gt._spread=!0),gt.end=Object.assign({},jt?K[jt][1].start:Ve[1].end),K.splice(jt||Ie,0,["exit",gt,Ve[2]]),Ie++,Ae++}if(Ve[1].type==="listItemPrefix"){const ht={type:"listItem",_spread:!1,start:Object.assign({},Ve[1].start),end:void 0};gt=ht,K.splice(Ie,0,["enter",ht,Ve[2]]),Ie++,Ae++,$e=void 0,nt=!0}}}return K[fe][1]._spread=ft,Ae}function l(K,fe){return Ae;function Ae(Ie){f.call(this,K(Ie),Ie),fe&&fe.call(this,Ie)}}function o(){this.stack.push({type:"fragment",children:[]})}function f(K,fe,Ae){this.stack[this.stack.length-1].children.push(K),this.stack.push(K),this.tokenStack.push([fe,Ae||void 0]),K.position={start:nu(fe.start),end:void 0}}function u(K){return fe;function fe(Ae){K&&K.call(this,Ae),d.call(this,Ae)}}function d(K,fe){const Ae=this.stack.pop(),Ie=this.tokenStack.pop();if(Ie)Ie[0].type!==K.type&&(fe?fe.call(this,K,Ie[0]):(Ie[1]||C_).call(this,K,Ie[0]));else throw new Error("Cannot close `"+K.type+"` ("+Xm({start:K.start,end:K.end})+"): its not open");Ae.position.end=nu(K.end)}function h(){return $w(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(K){if(this.data.expectingFirstListItemValue){const fe=this.stack[this.stack.length-2];fe.start=Number.parseInt(this.sliceSerialize(K),10),this.data.expectingFirstListItemValue=void 0}}function v(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.lang=K}function N(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.meta=K}function C(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function A(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function T(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K.replace(/(\r?\n|\r)$/g,"")}function D(K){const fe=this.resume(),Ae=this.stack[this.stack.length-1];Ae.label=fe,Ae.identifier=Fh(this.sliceSerialize(K)).toLowerCase()}function M(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.title=K}function V(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.url=K}function F(K){const fe=this.stack[this.stack.length-1];if(!fe.depth){const Ae=this.sliceSerialize(K).length;fe.depth=Ae}}function z(){this.data.setextHeadingSlurpLineEnding=!0}function B(K){const fe=this.stack[this.stack.length-1];fe.depth=this.sliceSerialize(K).codePointAt(0)===61?1:2}function U(){this.data.setextHeadingSlurpLineEnding=void 0}function R(K){const Ae=this.stack[this.stack.length-1].children;let Ie=Ae[Ae.length-1];(!Ie||Ie.type!=="text")&&(Ie=en(),Ie.position={start:nu(K.start),end:void 0},Ae.push(Ie)),this.stack.push(Ie)}function O(K){const fe=this.stack.pop();fe.value+=this.sliceSerialize(K),fe.position.end=nu(K.end)}function $(K){const fe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ae=fe.children[fe.children.length-1];Ae.position.end=nu(K.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(fe.type)&&(R.call(this,K),O.call(this,K))}function W(){this.data.atHardBreak=!0}function te(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K}function ne(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K}function re(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.value=K}function J(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=fe,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function q(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=fe,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function H(K){const fe=this.sliceSerialize(K),Ae=this.stack[this.stack.length-2];Ae.label=PT(fe),Ae.identifier=Fh(fe).toLowerCase()}function ee(){const K=this.stack[this.stack.length-1],fe=this.resume(),Ae=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ae.type==="link"){const Ie=K.children;Ae.children=Ie}else Ae.alt=fe}function E(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.url=K}function Q(){const K=this.resume(),fe=this.stack[this.stack.length-1];fe.title=K}function ie(){this.data.inReference=void 0}function I(){this.data.referenceType="collapsed"}function ce(K){const fe=this.resume(),Ae=this.stack[this.stack.length-1];Ae.label=fe,Ae.identifier=Fh(this.sliceSerialize(K)).toLowerCase(),this.data.referenceType="full"}function xe(K){this.data.characterReferenceType=K.type}function le(K){const fe=this.sliceSerialize(K),Ae=this.data.characterReferenceType;let Ie;Ae?(Ie=wT(fe,Ae==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ie=zw(fe);const Ye=this.stack[this.stack.length-1];Ye.value+=Ie}function ge(K){const fe=this.stack.pop();fe.position.end=nu(K.end)}function ye(K){O.call(this,K);const fe=this.stack[this.stack.length-1];fe.url=this.sliceSerialize(K)}function Re(K){O.call(this,K);const fe=this.stack[this.stack.length-1];fe.url="mailto:"+this.sliceSerialize(K)}function Ze(){return{type:"blockquote",children:[]}}function at(){return{type:"code",lang:null,meta:null,value:""}}function Le(){return{type:"inlineCode",value:""}}function Te(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function we(){return{type:"emphasis",children:[]}}function Fe(){return{type:"heading",depth:0,children:[]}}function Xe(){return{type:"break"}}function it(){return{type:"html",value:""}}function je(){return{type:"image",title:null,url:"",alt:null}}function Ke(){return{type:"link",title:null,url:"",children:[]}}function ze(K){return{type:"list",ordered:K.type==="listOrdered",start:null,spread:K._spread,children:[]}}function ct(K){return{type:"listItem",spread:K._spread,checked:null,children:[]}}function Tt(){return{type:"paragraph",children:[]}}function bt(){return{type:"strong",children:[]}}function en(){return{type:"text",value:""}}function oe(){return{type:"thematicBreak"}}}function nu(e){return{line:e.line,column:e.column,offset:e.offset}}function MT(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?MT(e,r):YJ(e,r)}}function YJ(e,n){let t;for(t in n)if(DT.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function C_(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Xm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Xm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Xm({start:n.start,end:n.end})+") is still open")}function WJ(e){const n=this;n.parser=t;function t(r){return HJ(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const k_={}.hasOwnProperty;function IT(e,n){const t=n||{};function r(a,...l){let o=r.invalid;const f=r.handlers;if(a&&k_.call(a,e)){const u=String(a[e]);o=k_.call(f,u)?f[u]:r.unknown}if(o)return o.call(this,a,...l)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const QJ={}.hasOwnProperty;function RT(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)RT(e,n.extensions[t]);for(r in n)if(QJ.call(n,r))switch(r){case"extensions":break;case"unsafe":{T_(e[r],n[r]);break}case"join":{T_(e[r],n[r]);break}case"handlers":{JJ(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function T_(e,n){n&&e.push(...n)}function JJ(e,n){n&&Object.assign(e,n)}function KJ(e,n,t,r){const a=t.enter("blockquote"),l=t.createTracker(r);l.move("> "),l.shift(2);const o=t.indentLines(t.containerFlow(e,l.current()),XJ);return a(),o}function XJ(e,n,t){return">"+(t?"":" ")+e}function LT(e,n){return E_(e,n.inConstruct,!0)&&!E_(e,n.notInConstruct,!1)}function E_(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function A_(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&LT(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function ZJ(e,n){const t=String(e);let r=t.indexOf(n),a=r,l=0,o=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++l>o&&(o=l):l=1,a=r+n.length,r=t.indexOf(n,a);return o}function D1(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function eK(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function tK(e,n,t,r){const a=eK(t),l=e.value||"",o=a==="`"?"GraveAccent":"Tilde";if(D1(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(l,nK);return g(),b}const f=t.createTracker(r),u=a.repeat(Math.max(ZJ(l,a)+1,3)),d=t.enter("codeFenced");let h=f.move(u);if(e.lang){const g=t.enter(`codeFencedLang${o}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${o}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),l&&(h+=f.move(l+`
`)),h+=f.move(u),d(),h}function nK(e,n,t){return(t?"":"    ")+e}function qw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function iK(e,n,t,r){const a=qw(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("definition");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("[");return d+=u.move(t.safe(t.associationId(e),{before:d,after:"]",...u.current()})),d+=u.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":`
`,...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),o(),d}function rK(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function fu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function bb(e,n,t){const r=xb(e),a=xb(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}OT.peek=aK;function OT(e,n,t,r){const a=rK(t),l=t.enter("emphasis"),o=t.createTracker(r),f=o.move(a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=bb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=fu(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=bb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+fu(g));const v=o.move(a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function aK(e,n,t){return t.options.emphasis||"*"}const Vw=function(e){if(e==null)return cK;if(typeof e=="function")return Vb(e);if(typeof e=="object")return Array.isArray(e)?sK(e):lK(e);if(typeof e=="string")return oK(e);throw new Error("Expected function, string, or object as test")};function sK(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Vw(e[t]);return Vb(r);function r(...a){let l=-1;for(;++l<n.length;)if(n[l].apply(this,a))return!0;return!1}}function lK(e){const n=e;return Vb(t);function t(r){const a=r;let l;for(l in e)if(a[l]!==n[l])return!1;return!0}}function oK(e){return Vb(n);function n(t){return t&&t.type===e}}function Vb(e){return n;function n(t,r,a){return!!(uK(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function cK(){return!0}function uK(e){return e!==null&&typeof e=="object"&&"type"in e}const FT=[],dK=!0,M1=!1,fK="skip";function hK(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const l=Vw(a),o=r?-1:1;f(e,void 0,[])();function f(u,d,h){const g=u&&typeof u=="object"?u:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(u.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=FT,N,C,A;if((!n||l(u,d,h[h.length-1]||void 0))&&(v=pK(t(u,h)),v[0]===M1))return v;if("children"in u&&u.children){const T=u;if(T.children&&v[0]!==fK)for(C=(r?T.children.length:-1)+o,A=h.concat(T);C>-1&&C<T.children.length;){const D=T.children[C];if(N=f(D,C,A)(),N[0]===M1)return N;C=typeof N[1]=="number"?N[1]:C+o}}return v}}}function pK(e){return Array.isArray(e)?e:typeof e=="number"?[dK,e]:e==null?FT:[e]}function $T(e,n,t,r){let a,l,o;typeof n=="function"?(l=void 0,o=n,a=t):(l=n,o=t,a=r),hK(e,l,f,a);function f(u,d){const h=d[d.length-1],g=h?h.children.indexOf(u):void 0;return o(u,g,h)}}function zT(e,n){let t=!1;return $T(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,M1}),!!((!e.depth||e.depth<3)&&$w(e)&&(n.options.setext||t))}function mK(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),l=t.createTracker(r);if(zT(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...l.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const o="#".repeat(a),f=t.enter("headingAtx"),u=t.enter("phrasing");l.move(o+" ");let d=t.containerPhrasing(e,{before:"# ",after:`
`,...l.current()});return/^[\t ]/.test(d)&&(d=fu(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,t.options.closeAtx&&(d+=" "+o),u(),f(),d}BT.peek=gK;function BT(e){return e.value||""}function gK(){return"<"}UT.peek=yK;function UT(e,n,t,r){const a=qw(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("image");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("![");return d+=u.move(t.safe(e.alt,{before:d,after:"]",...u.current()})),d+=u.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":")",...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),d+=u.move(")"),o(),d}function yK(){return"!"}qT.peek=xK;function qT(e,n,t,r){const a=e.referenceType,l=t.enter("imageReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("![");const d=t.safe(e.alt,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function xK(){return"!"}VT.peek=bK;function VT(e,n,t){let r=e.value||"",a="`",l=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++l<t.unsafe.length;){const o=t.unsafe[l],f=t.compilePattern(o);let u;if(o.atBreak)for(;u=f.exec(r);){let d=u.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(u.index+1)}}return a+r+a}function bK(){return"`"}function HT(e,n){const t=$w(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}GT.peek=vK;function GT(e,n,t,r){const a=qw(t),l=a==='"'?"Quote":"Apostrophe",o=t.createTracker(r);let f,u;if(HT(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=o.move("<");return g+=o.move(t.containerPhrasing(e,{before:g,after:">",...o.current()})),g+=o.move(">"),f(),t.stack=h,g}f=t.enter("link"),u=t.enter("label");let d=o.move("[");return d+=o.move(t.containerPhrasing(e,{before:d,after:"](",...o.current()})),d+=o.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=t.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(t.safe(e.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(u=t.enter("destinationRaw"),d+=o.move(t.safe(e.url,{before:d,after:e.title?" ":")",...o.current()}))),u(),e.title&&(u=t.enter(`title${l}`),d+=o.move(" "+a),d+=o.move(t.safe(e.title,{before:d,after:a,...o.current()})),d+=o.move(a),u()),d+=o.move(")"),f(),d}function vK(e,n,t){return HT(e,t)?"<":"["}YT.peek=wK;function YT(e,n,t,r){const a=e.referenceType,l=t.enter("linkReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("[");const d=t.containerPhrasing(e,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function wK(){return"["}function Hw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function NK(e){const n=Hw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function SK(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function WT(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function jK(e,n,t,r){const a=t.enter("list"),l=t.bulletCurrent;let o=e.ordered?SK(t):Hw(t);const f=e.ordered?o==="."?")":".":NK(t);let u=n&&t.bulletLastUsed?o===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(u=!0),WT(t)===o&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(o=f),t.bulletCurrent=o;const d=t.containerFlow(e,r);return t.bulletLastUsed=o,t.bulletCurrent=l,a(),d}function _K(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function CK(e,n,t,r){const a=_K(t);let l=t.bulletCurrent||Hw(t);n&&n.type==="list"&&n.ordered&&(l=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+l);let o=l.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(o=Math.ceil(o/4)*4);const f=t.createTracker(r);f.move(l+" ".repeat(o-l.length)),f.shift(o);const u=t.enter("listItem"),d=t.indentLines(t.containerFlow(e,f.current()),h);return u(),d;function h(g,b,v){return b?(v?"":" ".repeat(o))+g:(v?l:l+" ".repeat(o-l.length))+g}}function kK(e,n,t,r){const a=t.enter("paragraph"),l=t.enter("phrasing"),o=t.containerPhrasing(e,r);return l(),a(),o}const TK=Vw(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function EK(e,n,t,r){return(e.children.some(function(o){return TK(o)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function AK(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}QT.peek=PK;function QT(e,n,t,r){const a=AK(t),l=t.enter("strong"),o=t.createTracker(r),f=o.move(a+a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=bb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=fu(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=bb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+fu(g));const v=o.move(a+a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function PK(e,n,t){return t.options.strong||"*"}function DK(e,n,t,r){return t.safe(e.value,r)}function MK(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function IK(e,n,t){const r=(WT(t)+(t.options.ruleSpaces?" ":"")).repeat(MK(t));return t.options.ruleSpaces?r.slice(0,-1):r}const RK={blockquote:KJ,break:A_,code:tK,definition:iK,emphasis:OT,hardBreak:A_,heading:mK,html:BT,image:UT,imageReference:qT,inlineCode:VT,link:GT,linkReference:YT,list:jK,listItem:CK,paragraph:kK,root:EK,strong:QT,text:DK,thematicBreak:IK},LK=[OK];function OK(e,n,t,r){if(n.type==="code"&&D1(n,r)&&(e.type==="list"||e.type===n.type&&D1(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&zT(n,r))?void 0:t.spread?1:0}const Id=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],FK=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Id},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Id},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Id},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Id},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Id},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Id},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Id},{atBreak:!0,character:"~"}];function $K(e){return e.label||!e.identifier?e.label||"":PT(e.identifier)}function zK(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function BK(e,n,t){const r=n.indexStack,a=e.children||[],l=[];let o=-1,f=t.before,u;r.push(-1);let d=n.createTracker(t);for(;++o<a.length;){const h=a[o];let g;if(r[r.length-1]=o,o+1<a.length){let N=n.handle.handlers[a[o+1].type];N&&N.peek&&(N=N.peek),g=N?N(a[o+1],e,n,{before:"",after:"",...d.current()}).charAt(0):""}else g=t.after;l.length>0&&(f==="\r"||f===`
`)&&h.type==="html"&&(l[l.length-1]=l[l.length-1].replace(/(\r?\n|\r)$/," "),f=" ",d=n.createTracker(t),d.move(l.join("")));let b=n.handle(h,e,n,{...d.current(),after:g,before:f});u&&u===b.slice(0,1)&&(b=fu(u.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,u=void 0,v&&(l.length>0&&v.before&&f===l[l.length-1].slice(-1)&&(l[l.length-1]=l[l.length-1].slice(0,-1)+fu(f.charCodeAt(0))),v.after&&(u=g)),d.move(b),l.push(b),f=b.slice(-1)}return r.pop(),l.join("")}function UK(e,n,t){const r=n.indexStack,a=e.children||[],l=n.createTracker(t),o=[];let f=-1;for(r.push(-1);++f<a.length;){const u=a[f];r[r.length-1]=f,o.push(l.move(n.handle(u,e,n,{before:`
`,after:`
`,...l.current()}))),u.type!=="list"&&(n.bulletLastUsed=void 0),f<a.length-1&&o.push(l.move(qK(u,a[f+1],e,n)))}return r.pop(),o.join("")}function qK(e,n,t,r){let a=r.join.length;for(;a--;){const l=r.join[a](e,n,t,r);if(l===!0||l===1)break;if(typeof l=="number")return`
`.repeat(1+l);if(l===!1)return`

<!---->

`}return`

`}const VK=/\r?\n|\r/g;function HK(e,n){const t=[];let r=0,a=0,l;for(;l=VK.exec(e);)o(e.slice(r,l.index)),t.push(l[0]),r=l.index+l[0].length,a++;return o(e.slice(r)),t.join("");function o(f){t.push(n(f,a,!f))}}function GK(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],l=[],o={};let f=-1;for(;++f<e.unsafe.length;){const h=e.unsafe[f];if(!LT(e.stack,h))continue;const g=e.compilePattern(h);let b;for(;b=g.exec(r);){const v="before"in h||!!h.atBreak,N="after"in h,C=b.index+(v?b[1].length:0);a.includes(C)?(o[C].before&&!v&&(o[C].before=!1),o[C].after&&!N&&(o[C].after=!1)):(a.push(C),o[C]={before:v,after:N})}}a.sort(YK);let u=t.before?t.before.length:0;const d=r.length-(t.after?t.after.length:0);for(f=-1;++f<a.length;){const h=a[f];h<u||h>=d||h+1<d&&a[f+1]===h+1&&o[h].after&&!o[h+1].before&&!o[h+1].after||a[f-1]===h-1&&o[h].before&&!o[h-1].before&&!o[h-1].after||(u!==h&&l.push(P_(r.slice(u,h),"\\")),u=h,/[!-/:-@[-`{-~]/.test(r.charAt(h))&&(!t.encode||!t.encode.includes(r.charAt(h)))?l.push("\\"):(l.push(fu(r.charCodeAt(h))),u++))}return l.push(P_(r.slice(u,d),t.after)),l.join("")}function YK(e,n){return e-n}function P_(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],l=e+n;let o=-1,f=0,u;for(;u=t.exec(l);)r.push(u.index);for(;++o<r.length;)f!==r[o]&&a.push(e.slice(f,r[o])),a.push("\\"),f=r[o];return a.push(e.slice(f)),a.join("")}function WK(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,l=t.column||1;return{move:u,current:o,shift:f};function o(){return{now:{line:a,column:l},lineShift:r}}function f(d){r+=d}function u(d){const h=d||"",g=h.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,l=g.length===1?l+b.length:1+b.length+r,h}}function QK(e,n){const t=n||{},r={associationId:$K,containerPhrasing:ZK,containerFlow:eX,createTracker:WK,compilePattern:zK,enter:l,handlers:{...RK},handle:void 0,indentLines:HK,indexStack:[],join:[...LK],options:{},safe:tX,stack:[],unsafe:[...FK]};RT(r,t),r.options.tightDefinitions&&r.join.push(XK),r.handle=IT("type",{invalid:JK,unknown:KK,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function l(o){return r.stack.push(o),f;function f(){r.stack.pop()}}}function JK(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function KK(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function XK(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function ZK(e,n){return BK(e,this,n)}function eX(e,n){return UK(e,this,n)}function tX(e,n){return GK(this,e,n)}function nX(e){const n=this;n.compiler=t;function t(r){return QK(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function D_(e){if(e)throw e}var Pv,M_;function iX(){if(M_)return Pv;M_=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):n.call(d)==="[object Array]"},l=function(d){if(!d||n.call(d)!=="[object Object]")return!1;var h=e.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&e.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!h&&!g)return!1;var b;for(b in d);return typeof b>"u"||e.call(d,b)},o=function(d,h){t&&h.name==="__proto__"?t(d,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):d[h.name]=h.newValue},f=function(d,h){if(h==="__proto__")if(e.call(d,h)){if(r)return r(d,h).value}else return;return d[h]};return Pv=function u(){var d,h,g,b,v,N,C=arguments[0],A=1,T=arguments.length,D=!1;for(typeof C=="boolean"&&(D=C,C=arguments[1]||{},A=2),(C==null||typeof C!="object"&&typeof C!="function")&&(C={});A<T;++A)if(d=arguments[A],d!=null)for(h in d)g=f(C,h),b=f(d,h),C!==b&&(D&&b&&(l(b)||(v=a(b)))?(v?(v=!1,N=g&&a(g)?g:[]):N=g&&l(g)?g:{},o(C,{name:h,newValue:u(D,N,b)})):typeof b<"u"&&o(C,{name:h,newValue:b}));return C},Pv}var rX=iX();const Dv=Yd(rX);function I1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function aX(){const e=[],n={run:t,use:r};return n;function t(...a){let l=-1;const o=a.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);f(null,...a);function f(u,...d){const h=e[++l];let g=-1;if(u){o(u);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,h?sX(h,f)(...d):o(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function sX(e,n){let t;return r;function r(...o){const f=e.length>o.length;let u;f&&o.push(a);try{u=e.apply(this,o)}catch(d){const h=d;if(f&&t)throw h;return a(h)}f||(u&&u.then&&typeof u.then=="function"?u.then(l,a):u instanceof Error?a(u):l(u))}function a(o,...f){t||(t=!0,n(o,...f))}function l(o){a(null,o)}}class Da extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",l={},o=!1;if(t&&("line"in t&&"column"in t?l={place:t}:"start"in t&&"end"in t?l={place:t}:"type"in t?l={ancestors:[t],place:t.position}:l={...t}),typeof n=="string"?a=n:!l.cause&&n&&(o=!0,a=n.message,l.cause=n),!l.ruleId&&!l.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?l.ruleId=r:(l.source=r.slice(0,u),l.ruleId=r.slice(u+1))}if(!l.place&&l.ancestors&&l.ancestors){const u=l.ancestors[l.ancestors.length-1];u&&(l.place=u.position)}const f=l.place&&"start"in l.place?l.place.start:l.place;this.ancestors=l.ancestors||void 0,this.cause=l.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=f?f.line:void 0,this.name=Xm(l.place)||"1:1",this.place=l.place||void 0,this.reason=this.message,this.ruleId=l.ruleId||void 0,this.source=l.source||void 0,this.stack=o&&l.cause&&typeof l.cause.stack=="string"?l.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Da.prototype.file="";Da.prototype.name="";Da.prototype.reason="";Da.prototype.message="";Da.prototype.stack="";Da.prototype.column=void 0;Da.prototype.line=void 0;Da.prototype.ancestors=void 0;Da.prototype.cause=void 0;Da.prototype.fatal=void 0;Da.prototype.place=void 0;Da.prototype.ruleId=void 0;Da.prototype.source=void 0;const Wl={basename:lX,dirname:oX,extname:cX,join:uX,sep:"/"};function lX(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');bg(e);let t=0,r=-1,a=e.length,l;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else r<0&&(l=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let o=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else o<0&&(l=!0,o=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=o));return t===r?r=o:r<0&&(r=e.length),e.slice(t,r)}function oX(e){if(bg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function cX(e){bg(e);let n=e.length,t=-1,r=0,a=-1,l=0,o;for(;n--;){const f=e.codePointAt(n);if(f===47){if(o){r=n+1;break}continue}t<0&&(o=!0,t=n+1),f===46?a<0?a=n:l!==1&&(l=1):a>-1&&(l=-1)}return a<0||t<0||l===0||l===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function uX(...e){let n=-1,t;for(;++n<e.length;)bg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":dX(t)}function dX(e){bg(e);const n=e.codePointAt(0)===47;let t=fX(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function fX(e,n){let t="",r=0,a=-1,l=0,o=-1,f,u;for(;++o<=e.length;){if(o<e.length)f=e.codePointAt(o);else{if(f===47)break;f=47}if(f===47){if(!(a===o-1||l===1))if(a!==o-1&&l===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),a=o,l=0;continue}}else if(t.length>0){t="",r=0,a=o,l=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,o):t=e.slice(a+1,o),r=o-a-1;a=o,l=0}else f===46&&l>-1?l++:l=-1}return t}function bg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const hX={cwd:pX};function pX(){return"/"}function R1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function mX(e){if(typeof e=="string")e=new URL(e);else if(!R1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return gX(e)}function gX(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const Mv=["history","path","basename","stem","extname","dirname"];class yX{constructor(n){let t;n?R1(n)?t={path:n}:typeof n=="string"||xX(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":hX.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Mv.length;){const l=Mv[r];l in t&&t[l]!==void 0&&t[l]!==null&&(this[l]=l==="history"?[...t[l]]:t[l])}let a;for(a in t)Mv.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Wl.basename(this.path):void 0}set basename(n){Rv(n,"basename"),Iv(n,"basename"),this.path=Wl.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Wl.dirname(this.path):void 0}set dirname(n){I_(this.basename,"dirname"),this.path=Wl.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Wl.extname(this.path):void 0}set extname(n){if(Iv(n,"extname"),I_(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Wl.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){R1(n)&&(n=mX(n)),Rv(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Wl.basename(this.path,this.extname):void 0}set stem(n){Rv(n,"stem"),Iv(n,"stem"),this.path=Wl.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Da(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function Iv(e,n){if(e&&e.includes(Wl.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Wl.sep+"`")}function Rv(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function I_(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function xX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const bX=function(e){const r=this.constructor.prototype,a=r[e],l=function(){return a.apply(l,arguments)};return Object.setPrototypeOf(l,r),l},vX={}.hasOwnProperty;class Gw extends bX{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=aX()}copy(){const n=new Gw;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(Dv(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(Fv("data",this.frozen),this.namespace[n]=t,this):vX.call(this.namespace,n)&&this.namespace[n]||void 0:n?(Fv("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Mx(n),r=this.parser||this.Parser;return Lv("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),Lv("process",this.parser||this.Parser),Ov("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(l,o){const f=Mx(n),u=r.parse(f);r.run(u,f,function(h,g,b){if(h||!g||!b)return d(h);const v=g,N=r.stringify(v,b);SX(N)?b.value=N:b.result=N,d(h,b)});function d(h,g){h||!g?o(h):l?l(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),Lv("processSync",this.parser||this.Parser),Ov("processSync",this.compiler||this.Compiler),this.process(n,a),L_("processSync","process",t),r;function a(l,o){t=!0,D_(l),r=o}}run(n,t,r){R_(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?l(void 0,r):new Promise(l);function l(o,f){const u=Mx(t);a.run(n,u,d);function d(h,g,b){const v=g||n;h?f(h):o?o(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,l),L_("runSync","run",r),a;function l(o,f){D_(o),a=f,r=!0}}stringify(n,t){this.freeze();const r=Mx(t),a=this.compiler||this.Compiler;return Ov("stringify",a),R_(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(Fv("use",this.frozen),n!=null)if(typeof n=="function")u(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):o(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function l(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[h,...g]=d;u(h,g)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(d.plugins),d.settings&&(a.settings=Dv(!0,a.settings,d.settings))}function f(d){let h=-1;if(d!=null)if(Array.isArray(d))for(;++h<d.length;){const g=d[h];l(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===d){b=g;break}if(b===-1)r.push([d,...h]);else if(h.length>0){let[v,...N]=h;const C=r[b][1];I1(C)&&I1(v)&&(v=Dv(!0,C,v)),r[b]=[d,v,...N]}}}}const wX=new Gw().freeze();function Lv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Ov(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Fv(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function R_(e){if(!I1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function L_(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Mx(e){return NX(e)?e:new yX(e)}function NX(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function SX(e){return typeof e=="string"||jX(e)}function jX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const _X=wX().use(WJ).use(nX).freeze(),JT=-1,Hb=0,Zm=1,vb=2,Yw=3,Ww=4,Qw=5,Jw=6,KT=7,XT=8,O_=typeof self=="object"?self:globalThis,CX=(e,n)=>{const t=(a,l)=>(e.set(l,a),a),r=a=>{if(e.has(a))return e.get(a);const[l,o]=n[a];switch(l){case Hb:case JT:return t(o,a);case Zm:{const f=t([],a);for(const u of o)f.push(r(u));return f}case vb:{const f=t({},a);for(const[u,d]of o)f[r(u)]=r(d);return f}case Yw:return t(new Date(o),a);case Ww:{const{source:f,flags:u}=o;return t(new RegExp(f,u),a)}case Qw:{const f=t(new Map,a);for(const[u,d]of o)f.set(r(u),r(d));return f}case Jw:{const f=t(new Set,a);for(const u of o)f.add(r(u));return f}case KT:{const{name:f,message:u}=o;return t(new O_[f](u),a)}case XT:return t(BigInt(o),a);case"BigInt":return t(Object(BigInt(o)),a);case"ArrayBuffer":return t(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:f}=new Uint8Array(o);return t(new DataView(f),o)}}return t(new O_[l](o),a)};return r},F_=e=>CX(new Map,e)(0),Ch="",{toString:kX}={},{keys:TX}=Object,qm=e=>{const n=typeof e;if(n!=="object"||!e)return[Hb,n];const t=kX.call(e).slice(8,-1);switch(t){case"Array":return[Zm,Ch];case"Object":return[vb,Ch];case"Date":return[Yw,Ch];case"RegExp":return[Ww,Ch];case"Map":return[Qw,Ch];case"Set":return[Jw,Ch];case"DataView":return[Zm,t]}return t.includes("Array")?[Zm,t]:t.includes("Error")?[KT,t]:[vb,t]},Ix=([e,n])=>e===Hb&&(n==="function"||n==="symbol"),EX=(e,n,t,r)=>{const a=(o,f)=>{const u=r.push(o)-1;return t.set(f,u),u},l=o=>{if(t.has(o))return t.get(o);let[f,u]=qm(o);switch(f){case Hb:{let h=o;switch(u){case"bigint":f=XT,h=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);h=null;break;case"undefined":return a([JT],o)}return a([f,h],o)}case Zm:{if(u){let b=o;return u==="DataView"?b=new Uint8Array(o.buffer):u==="ArrayBuffer"&&(b=new Uint8Array(o)),a([u,[...b]],o)}const h=[],g=a([f,h],o);for(const b of o)h.push(l(b));return g}case vb:{if(u)switch(u){case"BigInt":return a([u,o.toString()],o);case"Boolean":case"Number":case"String":return a([u,o.valueOf()],o)}if(n&&"toJSON"in o)return l(o.toJSON());const h=[],g=a([f,h],o);for(const b of TX(o))(e||!Ix(qm(o[b])))&&h.push([l(b),l(o[b])]);return g}case Yw:return a([f,o.toISOString()],o);case Ww:{const{source:h,flags:g}=o;return a([f,{source:h,flags:g}],o)}case Qw:{const h=[],g=a([f,h],o);for(const[b,v]of o)(e||!(Ix(qm(b))||Ix(qm(v))))&&h.push([l(b),l(v)]);return g}case Jw:{const h=[],g=a([f,h],o);for(const b of o)(e||!Ix(qm(b)))&&h.push(l(b));return g}}const{message:d}=o;return a([f,{name:u,message:d}],o)};return l},$_=(e,{json:n,lossy:t}={})=>{const r=[];return EX(!(n||t),!!n,new Map,r)(e),r},cg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?F_($_(e,n)):structuredClone(e):(e,n)=>F_($_(e,n)),ZT=tE("end"),eE=tE("start");function tE(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function nE(e){const n=eE(e),t=ZT(e);if(n&&t)return{start:n,end:t}}const Rd=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],z_={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Rd,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Rd],h2:[["className","sr-only"]],img:[...Rd,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Rd,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Rd],table:[...Rd],ul:[...Rd,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},au={}.hasOwnProperty;function AX(e,n){let t={type:"root",children:[]};const r={schema:n?{...z_,...n}:z_,stack:[]},a=iE(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function iE(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return PX(e,t);case"doctype":return DX(e,t);case"element":return MX(e,t);case"root":return IX(e,t);case"text":return RX(e,t)}}}function PX(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),l={type:"comment",value:r<0?t:t.slice(0,r)};return vg(l,n),l}}function DX(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return vg(t,n),t}}function MX(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=rE(e,n.children),a=LX(e,n.properties);e.stack.pop();let l=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(l=!0,e.schema.ancestors&&au.call(e.schema.ancestors,t))){const f=e.schema.ancestors[t];let u=-1;for(l=!1;++u<f.length;)e.stack.includes(f[u])&&(l=!0)}if(!l)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const o={type:"element",tagName:t,properties:a,children:r};return vg(o,n),o}function IX(e,n){const r={type:"root",children:rE(e,n.children)};return vg(r,n),r}function RX(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return vg(r,n),r}function rE(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const l=iE(e,r[a]);l&&(Array.isArray(l)?t.push(...l):t.push(l))}}return t}function LX(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,l=r&&au.call(r,t)?r[t]:void 0,o=r&&au.call(r,"*")?r["*"]:void 0,f=n&&typeof n=="object"?n:{},u={};let d;for(d in f)if(au.call(f,d)){const h=f[d];let g=B_(e,U_(l,d),d,h);g==null&&(g=B_(e,U_(o,d),d,h)),g!=null&&(u[d]=g)}if(a&&au.call(a,t)){const h=a[t];for(d in h)au.call(h,d)&&!au.call(u,d)&&(u[d]=h[d])}return u}function B_(e,n,t,r){return n?Array.isArray(r)?OX(e,n,t,r):aE(e,n,t,r):void 0}function OX(e,n,t,r){let a=-1;const l=[];for(;++a<r.length;){const o=aE(e,n,t,r[a]);(typeof o=="number"||typeof o=="string")&&l.push(o)}return l}function aE(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&FX(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,l=0;for(;++l<n.length;){const o=n[l];if(o&&typeof o=="object"&&"flags"in o){if(o.test(String(r))){a=!0;break}}else if(o===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function FX(e,n,t){const r=e.schema.protocols&&au.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),l=a.indexOf(":"),o=a.indexOf("?"),f=a.indexOf("#"),u=a.indexOf("/");if(l<0||u>-1&&l>u||o>-1&&l>o||f>-1&&l>f)return!0;let d=-1;for(;++d<r.length;){const h=r[d];if(l===h.length&&a.slice(0,h.length)===h)return!0}return!1}function vg(e,n){const t=nE(n);n.data&&(e.data=cg(n.data)),t&&(e.position=t)}function U_(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],l=typeof a=="string"?a:a[0];if(l===n)return a;l==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function $X(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function zX(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function BX(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function UX(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function qX(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function VX(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=tp(r.toLowerCase()),l=e.footnoteOrder.indexOf(r);let o,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=l+1,f+=1,e.footnoteCounts.set(r,f);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(n,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(n,d),e.applyData(n,d)}function HX(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function GX(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function sE(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),l=a[0];l&&l.type==="text"?l.value="["+l.value:a.unshift({type:"text",value:"["});const o=a[a.length-1];return o&&o.type==="text"?o.value+=r:a.push({type:"text",value:r}),a}function YX(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return sE(e,n);const a={src:tp(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,l),e.applyData(n,l)}function WX(e,n){const t={src:tp(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function QX(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function JX(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return sE(e,n);const a={href:tp(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,l),e.applyData(n,l)}function KX(e,n){const t={href:tp(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function XX(e,n,t){const r=e.all(n),a=t?ZX(t):lE(n),l={},o=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),l.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?o.push(...h.children):o.push(h)}const u=r[r.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:l,children:o};return e.patch(n,d),e.applyData(n,d)}function ZX(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=lE(t[r])}return n}function lE(e){const n=e.spread;return n??e.children.length>1}function eZ(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const o=r[a];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const l={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,l),e.applyData(n,l)}function tZ(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function nZ(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function iZ(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function rZ(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],o),a.push(o)}if(t.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=eE(n.children[1]),u=ZT(n.children[n.children.length-1]);f&&u&&(o.position={start:f,end:u}),a.push(o)}const l={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,l),e.applyData(n,l)}function aZ(e,n,t){const r=t?t.children:void 0,l=(r?r.indexOf(n):1)===0?"th":"td",o=t&&t.type==="table"?t.align:void 0,f=o?o.length:n.children.length;let u=-1;const d=[];for(;++u<f;){const g=n.children[u],b={},v=o?o[u]:void 0;v&&(b.align=v);let N={type:"element",tagName:l,properties:b,children:[]};g&&(N.children=e.all(g),e.patch(g,N),N=e.applyData(g,N)),d.push(N)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(n,h),e.applyData(n,h)}function sZ(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const q_=9,V_=32;function lZ(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const l=[];for(;r;)l.push(H_(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return l.push(H_(n.slice(a),a>0,!1)),l.join("")}function H_(e,n,t){let r=0,a=e.length;if(n){let l=e.codePointAt(r);for(;l===q_||l===V_;)r++,l=e.codePointAt(r)}if(t){let l=e.codePointAt(a-1);for(;l===q_||l===V_;)a--,l=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function oZ(e,n){const t={type:"text",value:lZ(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function cZ(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const uZ={blockquote:$X,break:zX,code:BX,delete:UX,emphasis:qX,footnoteReference:VX,heading:HX,html:GX,imageReference:YX,image:WX,inlineCode:QX,linkReference:JX,link:KX,listItem:XX,list:eZ,paragraph:tZ,root:nZ,strong:iZ,table:rZ,tableCell:sZ,tableRow:aZ,text:oZ,thematicBreak:cZ,toml:Rx,yaml:Rx,definition:Rx,footnoteDefinition:Rx};function Rx(){}function dZ(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function fZ(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function hZ(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||dZ,r=e.options.footnoteBackLabel||fZ,a=e.options.footnoteLabel||"Footnotes",l=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let u=-1;for(;++u<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[u]);if(!d)continue;const h=e.all(d),g=String(d.identifier).toUpperCase(),b=tp(g.toLowerCase());let v=0;const N=[],C=e.footnoteCounts.get(g);for(;C!==void 0&&++v<=C;){N.length>0&&N.push({type:"text",value:" "});let D=typeof t=="string"?t:t(u,v);typeof D=="string"&&(D={type:"text",value:D}),N.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,v),className:["data-footnote-backref"]},children:Array.isArray(D)?D:[D]})}const A=h[h.length-1];if(A&&A.type==="element"&&A.tagName==="p"){const D=A.children[A.children.length-1];D&&D.type==="text"?D.value+=" ":A.children.push({type:"text",value:" "}),A.children.push(...N)}else h.push(...N);const T={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(d,T),f.push(T)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:l,properties:{...cg(o),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const L1={}.hasOwnProperty,pZ={};function mZ(e,n){const t=n||pZ,r=new Map,a=new Map,l=new Map,o={...uZ,...t.handlers},f={all:d,applyData:yZ,definitionById:r,footnoteById:a,footnoteCounts:l,footnoteOrder:[],handlers:o,one:u,options:t,patch:gZ,wrap:bZ};return $T(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function u(h,g){const b=h.type,v=f.handlers[b];if(L1.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:C,...A}=h,T=cg(A);return T.children=f.all(h),T}return cg(h)}return(f.options.unknownHandler||xZ)(f,h,g)}function d(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const N=f.one(b[v],h);if(N){if(v&&b[v-1].type==="break"&&(!Array.isArray(N)&&N.type==="text"&&(N.value=G_(N.value)),!Array.isArray(N)&&N.type==="element")){const C=N.children[0];C&&C.type==="text"&&(C.value=G_(C.value))}Array.isArray(N)?g.push(...N):g.push(N)}}}return g}}function gZ(e,n){e.position&&(n.position=nE(e))}function yZ(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,l=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const o="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:o}}t.type==="element"&&l&&Object.assign(t.properties,cg(l)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function xZ(e,n){const t=n.data||{},r="value"in n&&!(L1.call(t,"hProperties")||L1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function bZ(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function G_(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function vZ(e,n){const t=mZ(e,n),r=t.one(e,void 0),a=hZ(t),l=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&l.children.push({type:"text",value:`
`},a),l}const wZ=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class wg{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}wg.prototype.normal={};wg.prototype.property={};wg.prototype.space=void 0;function oE(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new wg(t,r,n)}function O1(e){return e.toLowerCase()}class Ma{constructor(n,t){this.attribute=t,this.property=n}}Ma.prototype.attribute="";Ma.prototype.booleanish=!1;Ma.prototype.boolean=!1;Ma.prototype.commaOrSpaceSeparated=!1;Ma.prototype.commaSeparated=!1;Ma.prototype.defined=!1;Ma.prototype.mustUseProperty=!1;Ma.prototype.number=!1;Ma.prototype.overloadedBoolean=!1;Ma.prototype.property="";Ma.prototype.spaceSeparated=!1;Ma.prototype.space=void 0;let NZ=0;const dn=Jd(),Ji=Jd(),F1=Jd(),ot=Jd(),mi=Jd(),$h=Jd(),Xa=Jd();function Jd(){return 2**++NZ}const $1=Object.freeze(Object.defineProperty({__proto__:null,boolean:dn,booleanish:Ji,commaOrSpaceSeparated:Xa,commaSeparated:$h,number:ot,overloadedBoolean:F1,spaceSeparated:mi},Symbol.toStringTag,{value:"Module"})),$v=Object.keys($1);class Kw extends Ma{constructor(n,t,r,a){let l=-1;if(super(n,t),Y_(this,"space",a),typeof r=="number")for(;++l<$v.length;){const o=$v[l];Y_(this,$v[l],(r&$1[o])===$1[o])}}}Kw.prototype.defined=!0;function Y_(e,n,t){t&&(e[n]=t)}function np(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const l=new Kw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(l.mustUseProperty=!0),n[r]=l,t[O1(r)]=r,t[O1(l.attribute)]=r}return new wg(n,t,e.space)}const cE=np({properties:{ariaActiveDescendant:null,ariaAtomic:Ji,ariaAutoComplete:null,ariaBusy:Ji,ariaChecked:Ji,ariaColCount:ot,ariaColIndex:ot,ariaColSpan:ot,ariaControls:mi,ariaCurrent:null,ariaDescribedBy:mi,ariaDetails:null,ariaDisabled:Ji,ariaDropEffect:mi,ariaErrorMessage:null,ariaExpanded:Ji,ariaFlowTo:mi,ariaGrabbed:Ji,ariaHasPopup:null,ariaHidden:Ji,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:mi,ariaLevel:ot,ariaLive:null,ariaModal:Ji,ariaMultiLine:Ji,ariaMultiSelectable:Ji,ariaOrientation:null,ariaOwns:mi,ariaPlaceholder:null,ariaPosInSet:ot,ariaPressed:Ji,ariaReadOnly:Ji,ariaRelevant:null,ariaRequired:Ji,ariaRoleDescription:mi,ariaRowCount:ot,ariaRowIndex:ot,ariaRowSpan:ot,ariaSelected:Ji,ariaSetSize:ot,ariaSort:null,ariaValueMax:ot,ariaValueMin:ot,ariaValueNow:ot,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function uE(e,n){return n in e?e[n]:n}function dE(e,n){return uE(e,n.toLowerCase())}const SZ=np({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:$h,acceptCharset:mi,accessKey:mi,action:null,allow:null,allowFullScreen:dn,allowPaymentRequest:dn,allowUserMedia:dn,alt:null,as:null,async:dn,autoCapitalize:null,autoComplete:mi,autoFocus:dn,autoPlay:dn,blocking:mi,capture:null,charSet:null,checked:dn,cite:null,className:mi,cols:ot,colSpan:null,content:null,contentEditable:Ji,controls:dn,controlsList:mi,coords:ot|$h,crossOrigin:null,data:null,dateTime:null,decoding:null,default:dn,defer:dn,dir:null,dirName:null,disabled:dn,download:F1,draggable:Ji,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:dn,formTarget:null,headers:mi,height:ot,hidden:F1,high:ot,href:null,hrefLang:null,htmlFor:mi,httpEquiv:mi,id:null,imageSizes:null,imageSrcSet:null,inert:dn,inputMode:null,integrity:null,is:null,isMap:dn,itemId:null,itemProp:mi,itemRef:mi,itemScope:dn,itemType:mi,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:dn,low:ot,manifest:null,max:null,maxLength:ot,media:null,method:null,min:null,minLength:ot,multiple:dn,muted:dn,name:null,nonce:null,noModule:dn,noValidate:dn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:dn,optimum:ot,pattern:null,ping:mi,placeholder:null,playsInline:dn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:dn,referrerPolicy:null,rel:mi,required:dn,reversed:dn,rows:ot,rowSpan:ot,sandbox:mi,scope:null,scoped:dn,seamless:dn,selected:dn,shadowRootClonable:dn,shadowRootDelegatesFocus:dn,shadowRootMode:null,shape:null,size:ot,sizes:null,slot:null,span:ot,spellCheck:Ji,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ot,step:null,style:null,tabIndex:ot,target:null,title:null,translate:null,type:null,typeMustMatch:dn,useMap:null,value:Ji,width:ot,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:mi,axis:null,background:null,bgColor:null,border:ot,borderColor:null,bottomMargin:ot,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:dn,declare:dn,event:null,face:null,frame:null,frameBorder:null,hSpace:ot,leftMargin:ot,link:null,longDesc:null,lowSrc:null,marginHeight:ot,marginWidth:ot,noResize:dn,noHref:dn,noShade:dn,noWrap:dn,object:null,profile:null,prompt:null,rev:null,rightMargin:ot,rules:null,scheme:null,scrolling:Ji,standby:null,summary:null,text:null,topMargin:ot,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ot,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:dn,disableRemotePlayback:dn,prefix:null,property:null,results:ot,security:null,unselectable:null},space:"html",transform:dE}),jZ=np({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Xa,accentHeight:ot,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ot,amplitude:ot,arabicForm:null,ascent:ot,attributeName:null,attributeType:null,azimuth:ot,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ot,by:null,calcMode:null,capHeight:ot,className:mi,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ot,diffuseConstant:ot,direction:null,display:null,dur:null,divisor:ot,dominantBaseline:null,download:dn,dx:null,dy:null,edgeMode:null,editable:null,elevation:ot,enableBackground:null,end:null,event:null,exponent:ot,externalResourcesRequired:null,fill:null,fillOpacity:ot,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:$h,g2:$h,glyphName:$h,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ot,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ot,horizOriginX:ot,horizOriginY:ot,id:null,ideographic:ot,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ot,k:ot,k1:ot,k2:ot,k3:ot,k4:ot,kernelMatrix:Xa,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ot,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ot,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ot,overlineThickness:ot,paintOrder:null,panose1:null,path:null,pathLength:ot,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:mi,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ot,pointsAtY:ot,pointsAtZ:ot,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Xa,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Xa,rev:Xa,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Xa,requiredFeatures:Xa,requiredFonts:Xa,requiredFormats:Xa,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ot,specularExponent:ot,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ot,strikethroughThickness:ot,string:null,stroke:null,strokeDashArray:Xa,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ot,strokeOpacity:ot,strokeWidth:null,style:null,surfaceScale:ot,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Xa,tabIndex:ot,tableValues:null,target:null,targetX:ot,targetY:ot,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Xa,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ot,underlineThickness:ot,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ot,values:null,vAlphabetic:ot,vMathematical:ot,vectorEffect:null,vHanging:ot,vIdeographic:ot,version:null,vertAdvY:ot,vertOriginX:ot,vertOriginY:ot,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ot,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:uE}),fE=np({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),hE=np({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:dE}),pE=np({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),_Z=/[A-Z]/g,W_=/-[a-z]/g,CZ=/^data[-\w.:]+$/i;function kZ(e,n){const t=O1(n);let r=n,a=Ma;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&CZ.test(n)){if(n.charAt(4)==="-"){const l=n.slice(5).replace(W_,EZ);r="data"+l.charAt(0).toUpperCase()+l.slice(1)}else{const l=n.slice(4);if(!W_.test(l)){let o=l.replace(_Z,TZ);o.charAt(0)!=="-"&&(o="-"+o),n="data"+o}}a=Kw}return new a(r,n)}function TZ(e){return"-"+e.toLowerCase()}function EZ(e){return e.charAt(1).toUpperCase()}const AZ=oE([cE,SZ,fE,hE,pE],"html"),mE=oE([cE,jZ,fE,hE,pE],"svg"),PZ=/["&'<>`]/g,DZ=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,MZ=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,IZ=/[|\\{}()[\]^$+*?.]/g,Q_=new WeakMap;function RZ(e,n){if(e=e.replace(n.subset?LZ(n.subset):PZ,r),n.subset||n.escapeOnly)return e;return e.replace(DZ,t).replace(MZ,r);function t(a,l,o){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,o.charCodeAt(l+2),n)}function r(a,l,o){return n.format(a.charCodeAt(0),o.charCodeAt(l+1),n)}}function LZ(e){let n=Q_.get(e);return n||(n=OZ(e),Q_.set(e,n)),n}function OZ(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(IZ,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const FZ=/[\dA-Fa-f]/;function $Z(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!FZ.test(String.fromCharCode(n))?r:r+";"}const zZ=/\d/;function BZ(e,n,t){const r="&#"+String(e);return t&&n&&!zZ.test(String.fromCharCode(n))?r:r+";"}const UZ=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],zv={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},qZ=["cent","copy","divide","gt","lt","not","para","times"],gE={}.hasOwnProperty,z1={};let Lx;for(Lx in zv)gE.call(zv,Lx)&&(z1[zv[Lx]]=Lx);const VZ=/[^\dA-Za-z]/;function HZ(e,n,t,r){const a=String.fromCharCode(e);if(gE.call(z1,a)){const l=z1[a],o="&"+l;return t&&UZ.includes(l)&&!qZ.includes(l)&&(!r||n&&n!==61&&VZ.test(String.fromCharCode(n)))?o:o+";"}return""}function GZ(e,n,t){let r=$Z(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=HZ(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const l=BZ(e,n,t.omitOptionalSemicolons);l.length<r.length&&(r=l)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function zh(e,n){return RZ(e,Object.assign({format:GZ},n))}const YZ=/^>|^->|<!--|-->|--!>|<!-$/g,WZ=[">"],QZ=["<",">"];function JZ(e,n,t,r){return r.settings.bogusComments?"<?"+zh(e.value,Object.assign({},r.settings.characterReferences,{subset:WZ}))+">":"<!--"+e.value.replace(YZ,a)+"-->";function a(l){return zh(l,Object.assign({},r.settings.characterReferences,{subset:QZ}))}}function KZ(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function J_(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function XZ(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function ZZ(e){return e.join(" ").trim()}const eee=/[ \t\n\f\r]/g;function Xw(e){return typeof e=="object"?e.type==="text"?K_(e.value):!1:K_(e)}function K_(e){return e.replace(eee,"")===""}const ar=xE(1),yE=xE(-1),tee=[];function xE(e){return n;function n(t,r,a){const l=t?t.children:tee;let o=(r||0)+e,f=l[o];if(!a)for(;f&&Xw(f);)o+=e,f=l[o];return f}}const nee={}.hasOwnProperty;function bE(e){return n;function n(t,r,a){return nee.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const Zw=bE({body:ree,caption:Bv,colgroup:Bv,dd:oee,dt:lee,head:Bv,html:iee,li:see,optgroup:cee,option:uee,p:aee,rp:X_,rt:X_,tbody:fee,td:Z_,tfoot:hee,th:Z_,thead:dee,tr:pee});function Bv(e,n,t){const r=ar(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&Xw(r.value.charAt(0)))}function iee(e,n,t){const r=ar(t,n);return!r||r.type!=="comment"}function ree(e,n,t){const r=ar(t,n);return!r||r.type!=="comment"}function aee(e,n,t){const r=ar(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function see(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&r.tagName==="li"}function lee(e,n,t){const r=ar(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function oee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function X_(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function cee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function uee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function dee(e,n,t){const r=ar(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function fee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function hee(e,n,t){return!ar(t,n)}function pee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function Z_(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const mee=bE({body:xee,colgroup:bee,head:yee,html:gee,tbody:vee});function gee(e){const n=ar(e,-1);return!n||n.type!=="comment"}function yee(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function xee(e){const n=ar(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&Xw(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function bee(e,n,t){const r=yE(t,n),a=ar(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&Zw(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function vee(e,n,t){const r=yE(t,n),a=ar(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&Zw(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Ox={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function wee(e,n,t,r){const a=r.schema,l=a.space==="svg"?!1:r.settings.omitOptionalTags;let o=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const f=[];let u;a.space==="html"&&e.tagName==="svg"&&(r.schema=mE);const d=Nee(r,e.properties),h=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,h&&(o=!1),(d||!l||!mee(e,n,t))&&(f.push("<",e.tagName,d?" "+d:""),o&&(a.space==="svg"||r.settings.closeSelfClosing)&&(u=d.charAt(d.length-1),(!r.settings.tightSelfClosing||u==="/"||u&&u!=='"'&&u!=="'")&&f.push(" "),f.push("/")),f.push(">")),f.push(h),!o&&(!l||!Zw(e,n,t))&&f.push("</"+e.tagName+">"),f.join("")}function Nee(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const l=See(e,a,n[a]);l&&t.push(l)}}for(;++r<t.length;){const l=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&l!=='"'&&l!=="'"&&(t[r]+=" ")}return t.join("")}function See(e,n,t){const r=kZ(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,l=e.settings.allowDangerousCharacters?0:1;let o=e.quote,f;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const u=zh(r.attribute,Object.assign({},e.settings.characterReferences,{subset:Ox.name[a][l]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?XZ:ZZ)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?u:(e.settings.preferUnquoted&&(f=zh(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Ox.unquoted[a][l]}))),f!==t&&(e.settings.quoteSmart&&J_(t,o)>J_(t,e.alternative)&&(o=e.alternative),f=o+zh(t,Object.assign({},e.settings.characterReferences,{subset:(o==="'"?Ox.single:Ox.double)[a][l],attribute:!0}))+o),u+(f&&"="+f))}const jee=["<","&"];function vE(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:zh(e.value,Object.assign({},r.settings.characterReferences,{subset:jee}))}function _ee(e,n,t,r){return r.settings.allowDangerousHtml?e.value:vE(e,n,t,r)}function Cee(e,n,t,r){return r.all(e)}const kee=IT("type",{invalid:Tee,unknown:Eee,handlers:{comment:JZ,doctype:KZ,element:wee,raw:_ee,root:Cee,text:vE}});function Tee(e){throw new Error("Expected node, not `"+e+"`")}function Eee(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const Aee={},Pee={},Dee=[];function Mee(e,n){const t=n||Aee,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:Iee,all:Ree,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||wZ,characterReferences:t.characterReferences||Pee,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?mE:AZ,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function Iee(e,n,t){return kee(e,n,t,this)}function Ree(e){const n=[],t=e&&e.children||Dee;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const Lee={};function Oee(e){const n=this,{handlers:t,sanitize:r,...a}=e||Lee;let l=!1,o;typeof r=="boolean"?l=!r:r&&(o=r),n.compiler=f;function f(u,d){const h=vZ(u,{handlers:t,allowDangerousHtml:l}),g=l?h:AX(h,o),b=Mee(g,{...a,allowDangerousHtml:l});return d.extname&&(d.extname=".html"),u&&u.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const Fee=()=>{var yn,xi,xn;const{recordId:e}=qr(),n=Mt(),t=_r(),[r,a]=w.useState(""),[l]=w.useState([]),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(void 0),[b,v]=w.useState(void 0),[N,C]=w.useState(null),[A,T]=w.useState(!1),[D,M]=w.useState(""),[V,F]=w.useState(!1),[z,B]=w.useState(null),[U,R]=w.useState(null),[O,$]=w.useState(!1),[W,te]=w.useState(!1),[ne,re]=w.useState(null),[J,q]=w.useState(""),[H,ee]=w.useState(""),[E,Q]=w.useState(null),[ie,I]=w.useState(!1),[ce,xe]=w.useState(!1),[le,ge]=w.useState(null),[ye,Re]=w.useState(!1),[Ze,at]=w.useState(null),[Le,Te]=w.useState(window.innerHeight),[we,Fe]=w.useState([]),[Xe,it]=w.useState(!1),[je,Ke]=w.useState(null),[ze,ct]=w.useState([]),[Tt,bt]=w.useState([]),[en,oe]=w.useState(!1),[K,fe]=w.useState(null),Ae=w.useRef(null),Ie=w.useRef(null),Ye=w.useRef(!1),ft=w.useRef(null),[gt,jt]=w.useState(50),[$e,nt]=w.useState(!1),Ve=w.useRef(null),ht=w.useRef(null),Se=150,[qe,Be]=w.useState([]),[tt,st]=w.useState([]),[dt,tn]=w.useState(!1),[Nt,Ot]=w.useState(null),[Vt,_t]=w.useState(!1),[Wt,Et]=w.useState(null),[Dt,kt]=w.useState(!1),[It,Hn]=w.useState(null),[Ti,sr]=w.useState(!1),[Rn,On]=w.useState(null),[Bi,Xi]=w.useState(!1),[Zi,pr]=w.useState(null),[Ui,Gn]=w.useState(!1),[Es,Hr]=w.useState(null),[Ia,er]=w.useState([]),[oa,ro]=w.useState(!1),[cl,Kd]=w.useState(null),[ul,dl]=w.useState(!1),[Gr,ao]=w.useState(null),[fl,hl]=w.useState({}),[bu,ic]=w.useState(!1),[rp,rc]=w.useState(!1),[mr,ac]=w.useState(!1),[sc,lc]=w.useState(null),[As,rs]=w.useState(!1),[so,gr]=w.useState(!1),[Ps,oc]=w.useState(!1),[as,Ds]=w.useState(!1),[pl,lo]=w.useState(!1),[Yr,Ra]=w.useState(!1),ml=w.useMemo(()=>(u==null?void 0:u.admission_date)&&!(u!=null&&u.discharge_date),[u]),[vu,gl]=w.useState(!1),[cc,uc]=w.useState(""),[ca,Ms]=w.useState(void 0),[oo,ss]=w.useState(void 0),[ls,co]=w.useState(void 0),[Wr,dc]=w.useState(!1),[yl,tr]=w.useState(null),[La,uo]=w.useState(!1),Qr=w.useRef(null),[fc,xl]=w.useState(null),[hc,Dn]=w.useState(null),Cn=w.useRef(null),[Xd,qi]=w.useState(!1),[Oa,fo]=w.useState(!1),[kn,wu]=w.useState(null),[Is,ho]=w.useState(""),[Kn,ua]=w.useState(""),[os,Nu]=w.useState(!0),[cs,yr]=w.useState(!1),[bl,po]=w.useState(!1),[Rs,Su]=w.useState(!1),[Fa,mo]=w.useState([]),[lr,ap]=w.useState(!1),nr=w.useRef(null),vl=async se=>{try{const pe=await ue(`/api/patients/${se}`);if(!pe.ok){const _e=await pe.json().catch(()=>({}));throw new Error(_e.message||`Failed to fetch patient details: ${pe.status}`)}const de=await pe.json();if(d(de),g(de.age),v(de.gender),q(de.ai_response||""),d(_e=>_e?{..._e,current_status:de.current_status,admission_date:de.admission_date,discharge_date:de.discharge_date}:{...de,current_status:de.current_status,admission_date:de.admission_date,discharge_date:de.discharge_date}),de.insurance_type&&d(_e=>_e?{..._e,insurance_type:de.insurance_type}:{...de}),pc(se),de.ai_response){const _e=/```json\s*([\s\S]*?)\s*```/,rt=de.ai_response.match(_e);if(rt&&rt[1])ee(de.ai_response.replace(_e,"").trim()),Q(rt[1].trim());else{const xt=de.ai_response.trim();if(xt.startsWith("{")&&xt.endsWith("}"))try{JSON.parse(xt),ee(""),Q(xt)}catch{ee(xt),Q(null)}else if(xt.startsWith("[")&&xt.endsWith("]"))try{JSON.parse(xt),ee(""),Q(xt)}catch{ee(xt),Q(null)}else ee(xt),Q(null)}}else ee(""),Q(null)}catch{d(null),q(""),ee(""),Q(null)}},Zd=async(se,pe)=>{d(de=>de?{...de,insurance_type:pe}:null);try{const de=await ue(`/api/patients/${se}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:pe})});if(!de.ok){const _e=await de.json();throw new Error(_e.message||"Failed to update insurance type")}}catch(de){console.error("Error updating insurance type:",de),se&&vl(se)}},Jr=async se=>{oe(!0),fe(null),bt([]);try{const pe=await ue(`/api/queue/patient/${se}/complaints`);if(!pe.ok){const _e=await pe.json().catch(()=>({}));throw new Error(_e.message||`HTTP error! status: ${pe.status}`)}const de=await pe.json();bt(de||[])}catch(pe){fe(`Past complaints error: ${pe.message}`)}finally{oe(!1)}},us=async se=>{ct([]);try{const pe=await ue(`/api/pharmacy-orders/patient/${se}`);if(!pe.ok){const _e=await pe.json().catch(()=>({}));throw new Error(_e.message||`HTTP error! status: ${pe.status}`)}const de=await pe.json();ct(de||[])}catch{}},wl=async se=>{ro(!0),Kd(null),er([]);try{const pe=await ue(`/api/lab/orders/patient/${se}`);if(!pe.ok){const _e=await pe.json().catch(()=>({}));throw new Error(_e.message||`HTTP error! status: ${pe.status}`)}const de=await pe.json();er(de||[])}catch(pe){Kd(`Pending labs error: ${pe.message}`)}finally{ro(!1)}},Yn=async se=>{it(!0),Ke(null),Fe([]);try{const pe=await ue(`/api/lab/patient/${se}`);if(!pe.ok){const _e=await pe.json().catch(()=>({}));throw new Error(_e.message||`HTTP error! status: ${pe.status}`)}const de=await pe.json();Fe(de||[])}catch(pe){Ke(`Lab reports error: ${pe.message}`)}finally{it(!1)}},Kr=async se=>{try{const pe=await ue(`/api/recurring-medications?patientId=${se}`);if(!pe.ok){const _e=await pe.json().catch(()=>({}));throw new Error(_e.message||`Failed to fetch recurring medications: ${pe.status}`)}const de=await pe.json();mo(de.recurringMedications||[])}catch(pe){console.error("Error fetching recurring medications:",pe)}},ju=async se=>{$(!0),oe(!0),ro(!0),it(!0),ct([]);try{const pe=await ue(`/api/patients/${se}/context`);if(!pe.ok){const rt=await pe.json().catch(()=>({}));throw new Error(rt.message||`Failed to fetch patient context: ${pe.status}`)}const de=await pe.json(),_e=de.patient;if(d(_e),g(_e.age),v(_e.gender),q(_e.ai_response||""),pc(se),_e.ai_response){const rt=/```json\s*([\s\S]*?)\s*```/,xt=_e.ai_response.match(rt);if(xt&&xt[1])ee(_e.ai_response.replace(rt,"").trim()),Q(xt[1].trim());else{const Ct=_e.ai_response.trim();if(Ct.startsWith("{")&&Ct.endsWith("}"))try{JSON.parse(Ct),ee(""),Q(Ct)}catch{ee(Ct),Q(null)}else if(Ct.startsWith("[")&&Ct.endsWith("]"))try{JSON.parse(Ct),ee(""),Q(Ct)}catch{ee(Ct),Q(null)}else ee(Ct),Q(null)}}else ee(""),Q(null);bt(de.pastComplaints||[]),ct(de.pharmacyOrders||[]),er(de.labOrders||[]),Fe(de.labReports||[]),mo(de.recurringMedications||[])}catch(pe){console.error("Error fetching patient context:",pe),re(pe.message),d(null),q(""),ee(""),Q(null),bt([]),ct([]),er([]),Fe([]),mo([])}finally{$(!1),oe(!1),ro(!1),it(!1)}},pc=async se=>{try{const pe=await ue(`/api/queue/patient/${se}/latest`);if(!pe.ok){const _e=await pe.json().catch(()=>({}));throw new Error(_e.message||`Failed to fetch queue status: ${pe.status}`)}const de=await pe.json();if(de){const _e=new Date(de.createdAt),rt=new Date,xt=_e.getDate()===rt.getDate()&&_e.getMonth()===rt.getMonth()&&_e.getFullYear()===rt.getFullYear(),Ct=["waiting","consulting"].includes(de.status);Ra(xt&&Ct)}else Ra(!1)}catch(pe){console.error("Error checking patient queue status:",pe),Ra(!1)}},_u=se=>{n(`/dashboard/edit-pharmacy-order/${se}`)},sp=se=>{re(null),console.log(`Preparing billing navigation for order: ${se}`);const pe=ze.find(de=>de.id===se);if(pe){const de=pe.medications.map(_e=>{const rt=_e.price??0;return(_e.price===void 0||_e.price===null)&&console.warn(`Medication "${_e.name}" in order ${se} is missing a price. Defaulting to 0.`),{name:_e.name,pack_quantity:_e.pack_quantity,loose_quantity:_e.loose_quantity,price:rt,pack_price:_e.pack_price,loose_price:_e.loose_price,total_price:Number(_e.total_price)||0,isLoose:_e.isLoose,unit:_e.unit,drug_id:_e.drug_id?String(_e.drug_id):null,tabletsPerDay:_e.tabletsPerDay,numberOfDays:_e.numberOfDays,directions_to_use:_e.directions_to_use,discount_percentage:_e.discount_percentage??0,batch:_e.batch,expiry_date:_e.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:de}),n(`/dashboard/pharmacy-billing/${se}`,{state:{initialItems:de}})}else console.error(`Order with ID ${se} not found.`),re(`Order with ID ${se} not found.`),alert(`Error: Could not find order ${se} to bill.`)},lp=async(se,pe)=>{re(null);const de=ze.find(rt=>rt.id===se);if(!de){re(`Order with ID ${se} not found.`);return}const _e={status:pe,medications:de.medications};try{const rt=await ue(`/api/pharmacy-orders/${se}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(_e)});if(!rt.ok){const Ct=await rt.text();throw new Error(`Failed to update status: ${rt.statusText} (${rt.status}) - ${Ct}`)}const xt=await rt.json();ct(Ct=>Ct.map(vt=>vt.id===xt.id?xt:vt)),o&&us(o)}catch(rt){console.error("Failed to update order status:",rt),re(rt.message||`Failed to update status for order ${se}.`),alert(`Error updating status for order ${se}: ${rt.message||"Please try again."}`)}},op=async se=>{re(null);try{const pe=await ue(`/api/pharmacy-orders/${se}/recurring`,{method:"POST"});if(!pe.ok){const de=await pe.json().catch(()=>({}));throw new Error(de.message||"Failed to mark order as recurring")}o&&Kr(o)}catch(pe){console.error("Failed to mark order as recurring:",pe),re(pe.message||`Failed to mark order ${se} as recurring.`),alert(`Error: ${pe.message||"Please try again."}`)}},ef=se=>{lc(se),ac(!0)},mc=async se=>{if(window.confirm("Are you sure you want to delete this recurring medication?"))try{if(!(await ue(`/api/recurring-medications/${se}`,{method:"DELETE"})).ok)throw new Error("Failed to delete recurring medication");mo(de=>de.filter(_e=>_e.id!==se))}catch(pe){console.error("Error deleting recurring medication:",pe),alert("Failed to delete. Please try again.")}},Nl=se=>{er(pe=>pe.map(de=>de.id===se?{...de,isEditing:!0,editedTests:[...de.tests],editedStatus:de.status}:{...de,isEditing:!1}))},Cu=se=>{er(pe=>pe.map(de=>de.id===se?{...de,isEditing:!1,editedTests:void 0,editedStatus:void 0}:de))},Sl=(se,pe,de,_e)=>{er(rt=>rt.map(xt=>{if(xt.id===se){const Ct=xt.editedTests?[...xt.editedTests]:[...xt.tests];if(de==="add")return{...xt,editedTests:[...Ct,{id:"",name:"",price:0}]};if(de==="remove")return{...xt,editedTests:_e};if(pe!==-1){const vt={...Ct[pe],[de]:_e};return Ct[pe]=vt,{...xt,editedTests:Ct}}}return xt}))},tf=(se,pe)=>{er(de=>de.map(_e=>_e.id===se?{..._e,editedStatus:pe}:_e))},gc=se=>{if(!se||!se.id){console.error("Cannot navigate to billing: Lab Order data or ID is missing."),alert("Could not open billing page: Lab Order information is missing.");return}n("/lab-billing",{state:{labOrderId:se.id}})},go=se=>{se&&se.id?n(`/lab/report/${se.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the lab report page: Lab Order information is missing."))},ku=async(se,pe,de)=>{rs(!0),re(null);try{if(!pe||pe.length===0)throw new Error("Lab order must have at least one test.");for(const xt of pe)if(!xt.id||!xt.name||isNaN(xt.price)||xt.price<0)throw new Error(`Invalid test data: ${JSON.stringify(xt)}. Each test must have id, name, and a valid price.`);const _e={tests:pe,status:de},rt=await ue(`/api/lab/orders/${se}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(_e)});if(!rt.ok){const xt=await rt.json().catch(()=>({}));throw new Error(xt.message||`Failed to update lab order: ${rt.statusText}`)}o&&wl(o),er(xt=>xt.map(Ct=>Ct.id===se?{...Ct,isEditing:!1,editedTests:void 0,editedStatus:void 0}:Ct))}catch(_e){re(`Lab Order Save Error: ${_e.message}`)}finally{rs(!1)}},yo=async se=>{if(!window.confirm(`Are you sure you want to delete this ${se.type.toLowerCase()} record? This action cannot be undone.`))return;dl(!0),ao(null);let de=null,_e;const rt=se.type;try{switch(rt){case"Complaint":if(_e=se.data.id,!_e)throw new Error("Complaint ID is missing.");de=`/api/patients/complaints/${_e}`;break;case"Lab Order":if(_e=se.data.id,!_e)throw new Error("Lab Order ID is missing.");de=`/api/lab/orders/${_e}`;break;case"Lab Report":if(_e=se.data.reportId,!_e)throw new Error("Lab Report ID is missing.");de=`/api/lab/reports/${_e}`;break;case"Pharmacy Order":if(_e=se.data.id,!_e)throw new Error("Pharmacy Order ID is missing.");de=`/api/pharmacy-orders/${_e}`;break;default:throw new Error(`Deletion not supported for item type: ${rt}`)}if(!de)throw new Error(`Could not determine delete URL for type: ${rt}`);const xt=await ue(de,{method:"DELETE"});if(!xt.ok){const Ct=await xt.json().catch(()=>({}));throw new Error(Ct.message||`Failed to delete ${rt}: ${xt.statusText}`)}o&&(rt==="Complaint"?Jr(o):rt==="Lab Order"?(wl(o),Yn(o)):rt==="Lab Report"?Yn(o):rt==="Pharmacy Order"&&us(o))}catch(xt){ao(`Delete Error (${rt}): ${xt.message}`),ul&&dl(!1)}finally{dl(!1)}},yc=async()=>{if(!o)return;if(ze.filter(pe=>pe.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}fo(!0);try{const pe=await ue(`/api/pharmacy-orders/patient/${o}/merge-pending`,{method:"POST"});if(!pe.ok){const de=await pe.json().catch(()=>({}));throw new Error(de.message||"Failed to merge orders")}us(o)}catch(pe){re(`Merge Error: ${pe.message}`)}finally{fo(!1)}},ir=w.useMemo(()=>{if(!o||!Tt)return[];const se=Tt.map(pe=>({date:new Date(pe.createdAt),type:"Complaint",data:pe,originalDateString:pe.createdAt})).filter(pe=>!isNaN(pe.date.getTime()));return se.sort((pe,de)=>de.date.getTime()-pe.date.getTime()),se},[o,Tt]),ds=w.useMemo(()=>{if(!o)return[];const se=new Map;(Ia??[]).forEach(de=>{se.set(de.id,{...de})}),(we??[]).forEach(de=>{if(!se.has(de.id))se.set(de.id,{id:de.id,patient_id:de.patient_id,tests:de.tests,status:de.status,createdAt:de.createdAt,report:de});else{const _e=se.get(de.id);_e&&(_e.report=de,_e.status=de.status)}});let pe=Array.from(se.values());return pe.sort((de,_e)=>new Date(de.createdAt).getTime()-new Date(_e.createdAt).getTime()),pe=pe.map((de,_e)=>({...de,serialNumber:_e+1})),pe.map(de=>({date:new Date(de.createdAt),type:"Lab Order",data:de,originalDateString:de.createdAt}))},[o,Ia,we]),da=w.useMemo(()=>{if(!o||!ze)return[];const se=ze.map(pe=>({date:new Date(pe.date),type:"Pharmacy Order",data:pe,originalDateString:pe.date})).filter(pe=>!isNaN(pe.date.getTime()));return se.sort((pe,de)=>de.date.getTime()-pe.date.getTime()),se},[o,ze]),[or,xo]=w.useState(null),[Ls,Os]=w.useState([]),[fs,nf]=w.useState(""),bo=(se,pe)=>{if(!se||!se.report_content||!pe)return"";try{const de=JSON.parse(se.report_content||"{}");if(typeof de!="object"||de===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${se.report_content}</pre>`;let _e="";return pe.forEach(rt=>{de[rt.id]?(_e+=`<h5 class="font-semibold text-sm mt-2 mb-1">${rt.name}</h5>`,_e+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(de[rt.id]).map(([xt,Ct])=>{var cr;const vt=(cr=rt.default_parameters)==null?void 0:cr.find(vo=>vo.name===xt);let Qt="N/A";vt&&vt.type==="number"&&(vt.lower_limit!=null||vt.upper_limit!=null)?(Qt="",vt.lower_limit!=null&&(Qt+=` > ${vt.lower_limit}`),vt.lower_limit!=null&&vt.upper_limit!=null&&(Qt+=" - "),vt.upper_limit!=null&&(Qt+=` < ${vt.upper_limit}`),Qt=Qt.trim()||"N/A"):(vt==null?void 0:vt.type)==="boolean"?Qt="N/A":vt!=null&&vt.normal_range&&(Qt=vt.normal_range),_e+=`<tr><td>${xt}</td><td>${String(Ct)} ${(vt==null?void 0:vt.unit)||""}</td><td>${Qt}</td></tr>`}),_e+="</tbody></table>"):_e+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${rt.name}.</p>`}),_e}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${se.report_content}</pre>`}};w.useEffect(()=>{const se=()=>{Te(window.innerHeight)};return window.addEventListener("resize",se),se(),()=>window.removeEventListener("resize",se)},[]),w.useEffect(()=>{const se=de=>{if(!$e||!ht.current||!Ve.current)return;const _e=Ve.current.getBoundingClientRect(),xt=de.clientX-ht.current.x;let Ct=ht.current.initialWidth-xt;const vt=_e.width-Se-10;Ct=Math.max(Se,Ct),Ct=Math.min(Ct,vt);const Qt=Ct/_e.width*100;jt(Qt)},pe=()=>{nt(!1),ht.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return $e&&(window.addEventListener("mousemove",se),window.addEventListener("mouseup",pe),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",se),window.removeEventListener("mouseup",pe),document.body.style.cursor="",document.body.style.userSelect=""}},[$e]);const rf=se=>{if(!Ve.current)return;se.preventDefault();const pe=Ve.current.querySelector(".edit-complaint-context-column");pe&&(ht.current={x:se.clientX,initialWidth:pe.offsetWidth},nt(!0))},af=()=>{jt(50)},xc=w.useCallback(async()=>{te(!0),re(null);try{const se=await ue("/api/queue/doctor/new",{method:"POST"});if(!se.ok){const de=await se.json().catch(()=>({}));throw new Error(de.message||`Failed to create record: ${se.statusText}`)}const pe=await se.json();if(!pe.recordId)throw new Error("New record ID not received from server.");n(`/edit-complaint/${pe.recordId}`,{replace:!0})}catch(se){re(`Failed to create new complaint record: ${se.message}`)}finally{te(!1)}},[n]);w.useEffect(()=>{(async()=>{Nu(!0);try{const pe=await ue("/api/clinics/settings");if(!pe.ok){const _e=await pe.json().catch(()=>({}));throw new Error(_e.message||"Failed to fetch clinic settings.")}const de=await pe.json();wu({admissionCharge:parseFloat(de.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(de.perDayCharge||0).toFixed(2),otherCharges:parseFloat(de.otherCharges||0).toFixed(2),aiMemory:de.aiMemory||"",aiMemoryUpdatedAt:de.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:de.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:de.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:de.gemini_api_key||""}),ho(de.aiMemory||""),ua(de.clinicWideSystemPrompt||"")}catch{}finally{Nu(!1)}})()},[]),w.useEffect(()=>{var pe,de;(pe=t.state)!=null&&pe.patientId&&f(Number(t.state.patientId)),(de=t.state)!=null&&de.initialComplaint&&a(t.state.initialComplaint),e?(async _e=>{var rt;$(!0),re(null);try{const xt=await ue(`/api/queue/doctor/complaint/${_e}`);if(!xt.ok){const vt=await xt.json().catch(()=>({}));throw new Error(vt.message||`HTTP error! status: ${xt.status}`)}const Ct=await xt.json();f(vt=>vt===Ct.patientId?vt:Ct.patientId),g(Ct.age),v(Ct.gender),C(Ct.case_summary||null),R(Ct.updatedAt||null)}catch{re("Failed to load current complaint details."),(rt=t.state)!=null&&rt.patientId||f(null),g(void 0),v(void 0),C(null),R(null)}finally{$(!1)}})(e):xc()},[e,xc,(yn=t.state)==null?void 0:yn.initialComplaint,(xi=t.state)==null?void 0:xi.patientId]),w.useEffect(()=>{o?ju(o):(d(null),bt([]),ct([]),er([]),Fe([]),R(null),Ra(!1))},[o]),w.useEffect(()=>{var de;const se=(de=t.state)==null?void 0:de.initialComplaint;se&&e&&(!O&&!en&&!oa&&!Xe&&!dt)&&!Ye.current&&r===se&&(Ye.current=!0,$a(),n(t.pathname,{replace:!0,state:{}}))},[(xn=t.state)==null?void 0:xn.initialComplaint,e,r,O,en,oa,Xe,dt,n]);const hs=()=>{M(N||""),T(!0),B(null)},sf=()=>{T(!1),M(""),B(null)},lf=async()=>{if(!e){B("Missing Record ID.");return}F(!0),B(null);try{const se=await ue(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:D.trim()})});if(!se.ok){const de=await se.json().catch(()=>({}));throw new Error(de.message||`Failed to save case summary: ${se.statusText}`)}const pe=await se.json();C(pe.case_summary||D.trim()),R(pe.updatedAt||null),T(!1)}catch(se){B(`Save Error: ${se.message}`)}finally{F(!1)}};w.useEffect(()=>{(async()=>{tn(!0),Ot(null);try{const[pe,de]=await Promise.all([ue("/api/drugs"),ue("/api/lab-tests")]);if(!pe.ok)throw new Error(`Pharmacy inventory error! status: ${pe.status}`);const _e=await pe.json();if(Be(_e||[]),!de.ok)throw new Error(`Lab inventory error! status: ${de.status}`);const rt=await de.json();st(rt||[])}catch(pe){Ot(pe.message)}finally{tn(!1)}})()},[]);const bc=async()=>{if(!kn)return;if(Is===kn.aiMemory&&Kn===kn.clinicWideSystemPrompt){po(!1);return}const se=Is!==kn.aiMemory,pe=Kn!==kn.clinicWideSystemPrompt;se&&yr(!0),pe&&Su(!0);try{const de={...kn};se&&(de.aiMemory=Is),pe&&(de.clinicWideSystemPrompt=Kn);const _e=await ue("/api/clinics/settings",{method:"PUT",body:JSON.stringify(de)});if(!_e.ok){const xt=await _e.json().catch(()=>({}));throw new Error(xt.message||"Failed to update clinic settings.")}const rt=await _e.json();wu({admissionCharge:parseFloat(rt.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(rt.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(rt.settings.otherCharges).toFixed(2),aiMemory:rt.settings.aiMemory||"",aiMemoryUpdatedAt:rt.settings.aiMemoryUpdatedAt||(kn==null?void 0:kn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:rt.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:rt.settings.clinicWideSystemPromptUpdatedAt||(kn==null?void 0:kn.clinicWideSystemPromptUpdatedAt)||null}),se&&ho(rt.settings.aiMemory||""),pe&&(ua(rt.settings.clinicWideSystemPrompt||""),po(!1))}catch{}finally{se&&yr(!1),pe&&Su(!1)}},of=()=>{kn&&(ua(kn.clinicWideSystemPrompt||""),po(!0))},ps=()=>{po(!1),kn&&ua(kn.clinicWideSystemPrompt||"")},$a=async se=>{const pe=se??r;nr.current&&await nr.current.callGenerativeApi(pe)},cp=se=>{navigator.clipboard.writeText(se).then(()=>{}).catch(pe=>{console.error("Failed to copy text: ",pe)})},Tu=(se,pe)=>{const de=window.open("","_blank");de&&(de.document.write(`
        <html>
          <head>
            <title>${pe}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${pe}</h2>
            <div id="print-content">${se}</div>
          </body>
        </html>
      `),de.document.close(),de.print())},xr=()=>{if(J){const se=_X().use(Go).use(Oee).processSync(H).toString();Tu(`<div class="prose">${se}</div>`,"AI Response")}};w.useEffect(()=>{if(u){let se=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${u.name||"N/A"}</p>
          <p><strong>Token:</strong> ${u.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${u.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${u.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${u.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${u.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${u.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${u.admission_date?new Date(u.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${u.discharge_date?new Date(u.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${N||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${ir.length>0?`
            <ul>
              ${ir.map(pe=>`<li>${new Date(pe.originalDateString).toLocaleDateString()}: ${pe.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${da.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${da.map(pe=>pe.data.medications.map((de,_e)=>`
                    <tr>
                      ${_e===0?`<td rowspan="${pe.data.medications.length}">${new Date(pe.originalDateString).toLocaleDateString()}</td>`:""}
                      ${_e===0?`<td rowspan="${pe.data.medications.length}">${pe.data.status}</td>`:""}
                      <td><strong>${de.name}</strong></td>
                      <td>
                        ${de.pack_quantity!==void 0&&de.pack_quantity>0?`Packs: ${de.pack_quantity}`:""}
                        ${de.pack_quantity!==void 0&&de.pack_quantity>0&&de.loose_quantity!==void 0&&de.loose_quantity>0?", ":""}
                        ${de.loose_quantity!==void 0&&de.loose_quantity>0?`Loose: ${de.loose_quantity}`:""}
                      </td>
                      <td>${de.tabletsPerDay&&de.numberOfDays?`${de.tabletsPerDay} tab/day for ${de.numberOfDays} days`:"N/A"}</td>
                      <td>${de.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${ds.length>0?`
            ${ds.map(pe=>{const de=pe.data.tests.map(rt=>rt.name).join(", ");let _e="";return pe.data.report&&(_e=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(pe.data.report.report_date).toLocaleDateString()})</h4>
                    ${bo(pe.data.report,pe.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(pe.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${pe.data.status}</p>
                  <p><strong>Tests:</strong> ${de}</p>
                  ${_e}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;nf(se)}else nf("")},[u,N,ir,da,ds,bo]);const fa=()=>{fs&&Tu(fs,`Patient Details - ${u==null?void 0:u.name}`)},Cr=se=>{a(se),xo(null),Os([]),setTimeout(()=>{$a(se)},0)},Xr=O||ce||ye||W||Wr||As||ul||so||Ps||as||pl||Oa,cf=()=>{a("reports came,please anaylse"),setTimeout(()=>{$a()},0)},Eu=se=>{hl(pe=>({...pe,[se]:!pe[se]}))},Au=se=>{se.key==="Enter"&&!se.shiftKey&&(se.preventDefault(),!Xr&&!dt&&!W&&r.trim()&&e&&$a())};w.useEffect(()=>{const se=window.SpeechRecognition||window.webkitSpeechRecognition;if(!se){xl("Speech recognition not supported in this browser.");return}const pe=new se;return pe.continuous=!0,pe.interimResults=!0,pe.lang="en-US",pe.onresult=de=>{let _e="";for(let rt=de.resultIndex;rt<de.results.length;++rt)de.results[rt].isFinal&&(_e+=de.results[rt][0].transcript);_e&&a(rt=>rt+(rt.endsWith(" ")||rt===""?"":" ")+_e)},pe.onerror=de=>{xl(`Speech error: ${de.error}`),uo(!1)},pe.onend=()=>{},Qr.current=pe,()=>{Qr.current&&Qr.current.stop()}},[]);const uf=async()=>{if(o)if(ml){oc(!0);try{const se=await ue(`/api/patients/${o}/discharge`,{method:"POST"});if(!se.ok){const pe=await se.json().catch(()=>({}));throw new Error(pe.message||`Failed to discharge patient: ${se.status}`)}vl(o)}catch(se){re(`Discharge Error: ${se.message}`)}finally{oc(!1)}}else{gr(!0);try{const se=await ue(`/api/patients/${o}/admit`,{method:"POST"});if(!se.ok){const pe=await se.json().catch(()=>({}));throw new Error(pe.message||`Failed to admit patient: ${se.status}`)}vl(o)}catch(se){re(`Admit Error: ${se.message}`)}finally{gr(!1)}}},Fs=async se=>{if(o){Ds(!0);try{const de=await ue("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:o})});if(!de.ok){const _e=await de.json().catch(()=>({}));throw new Error(_e.message||`Failed to add patient to ${se} queue: ${de.status}`)}o&&(vl(o),pc(o))}catch(pe){re(`Add to Queue Error: ${pe.message}`)}finally{Ds(!1)}}},za=async()=>{if(e){lo(!0),re(null);try{const se=await ue(`/api/queue/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!se.ok){const pe=await se.json().catch(()=>({}));throw new Error(pe.message||"Failed to complete consultation")}o&&(vl(o),pc(o))}catch(se){re(`Error completing consultation: ${se.message}`)}finally{lo(!1)}}},Ne=async()=>{if(!o){tr("Missing Patient ID.");return}if(!u){tr("Patient details not loaded.");return}dc(!0),tr(null);try{const se={};let pe=!1;if(cc!==u.name&&(se.name=cc,pe=!0),ca!==u.age&&(se.age=ca===""?0:typeof ca=="string"?parseInt(ca,10)||0:ca,pe=!0),oo!==u.gender&&(se.gender=oo,pe=!0),ls!==u.phone&&(se.phone=ls,pe=!0),!pe){tr("No changes detected."),dc(!1),gl(!1);return}const de=await ue(`/api/patients/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(se)});if(!de.ok){const rt=await de.json().catch(()=>({}));throw new Error(rt.message||`Failed to update patient details: ${de.statusText}`)}const _e=await de.json();d(_e),g(_e.age),v(_e.gender),uc(_e.name),Ms(_e.age),ss(_e.gender),co(_e.phone),gl(!1)}catch(se){tr(`Save Error: ${se.message}`)}finally{dc(!1)}},Ue=w.useCallback(()=>{if(!u)return null;const se={token_number:u.patient_token_number||"N/A",name:u.name||"N/A",age:u.age||"N/A",gender:u.gender||"N/A",phone:u.phone||"N/A"};return ir.length>0?se.complaints_history=ir.map(pe=>`${pe.data.complaint} (${new Date(pe.originalDateString).toLocaleDateString()})`).join("; "):se.complaints_history="No past complaints.",da.length>0?se.pharmacy_orders_history=da.map(pe=>`Order: ${pe.data.medications.map(_e=>{let rt=`${_e.name}`;return _e.pack_quantity!==void 0&&_e.pack_quantity>0&&(rt+=` Packs: ${_e.pack_quantity}`),_e.loose_quantity!==void 0&&_e.loose_quantity>0&&(rt+=` Loose: ${_e.loose_quantity}`),rt}).join(", ")} (${pe.data.status}, ${new Date(pe.originalDateString).toLocaleDateString()})`).join("; "):se.pharmacy_orders_history="No pharmacy orders.",ds.length>0?se.lab_orders_history=ds.map(pe=>{let _e=`Lab Order: ${pe.data.tests.map(rt=>rt.name).join(", ")} (${pe.data.status}, ${new Date(pe.originalDateString).toLocaleDateString()})`;return pe.data.report&&(_e+=` - Report: ${pe.data.report.report_content} (${new Date(pe.data.report.report_date).toLocaleDateString()})`),_e}).join("; "):se.lab_orders_history="No lab history.",Fa&&Fa.length>0?se.recurring_medications=Fa.map(pe=>`${pe.medications.map(_e=>_e.name).join(", ")} (Freq: ${pe.frequency_days}d, Next: ${new Date(pe.next_delivery_date).toLocaleDateString()})`).join("; "):se.recurring_medications="No recurring medications.",se},[u,ir,da,ds,Fa]),Oe=()=>{if(!u){xl("Patient details are required to use the Live API.");return}qi(!0)},mt=()=>{var se;(se=Cn.current)==null||se.click()},Ft=se=>{var de;const pe=(de=se.target.files)==null?void 0:de[0];pe&&Dn(pe)};return i.jsxs("div",{className:"edit-complaint-page",style:{height:`${Le}px`},children:[i.jsx(VW,{ref:nr,recordId:e,patientId:o,patientDetails:u,caseSummary:N,caseSummaryUpdatedAt:U,clinicSettings:kn,userMessages:l,selectedImageFile:hc,pendingLabOrders:Ia,labReports:we,pastComplaints:Tt,recurringMedications:Fa,pharmacyOrders:ze,pharmacyInventory:qe,labInventory:tt,setCurrentComplaint:a,setAiResponse:q,setAiResponseText:ee,setAiResponseJsonString:Q,setShowAiJsonDetails:I,setIsLoadingAi:xe,setAiError:ge,setIsSubmittingAiOrder:_t,setAiOrderSubmissionStatus:Et,setIsSubmittingAiLabOrder:kt,setAiLabOrderSubmissionStatus:Hn,setIsSubmittingAiComplaint:sr,setAiComplaintSubmissionStatus:On,setIsUpdatingCaseSummary:Xi,setAiCaseSummaryUpdateStatus:pr,setCaseSummary:C,setCaseSummaryUpdatedAt:R,setIsUpdatingAiMemoryByAI:Gn,setAiMemoryUpdateByAIStatus:Hr,setFollowUpQuestion:xo,setFollowUpOptions:Os,setError:re,setIsSavingAiResponse:Re,setSaveAiResponseError:at,fetchPharmacyOrdersData:us,fetchPendingLabOrdersData:wl,fetchLabReportsData:Yn,fetchPastComplaintsData:Jr,fetchRecurringMedicationsData:Kr,fetchPatientDetails:vl,setClinicSettings:wu,setEditedAiMemory:ho,handleDeleteItem:yo,handleAdmitDischargePatient:uf,handleCompleteConsultation:za,handleAddToQueue:Fs,setCanUndoAi:ap}),Xd&&u&&i.jsx(ck,{onClose:()=>qi(!1),patientData:Ue(),tokenNumber:u.patient_token_number?String(u.patient_token_number):null,onAiSummaryChange:se=>{se&&(a(se),$a(se),qi(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>n(-1),disabled:Xr,className:"back-button",title:"Go Back",children:i.jsx(an,{size:18})}),i.jsx("span",{ref:ft,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),O&&!u&&i.jsx("div",{className:"edit-complaint-patient-details skeleton",style:{width:"300px",height:"2.5rem"}}),u&&i.jsx("div",{className:"edit-complaint-patient-details-wrapper",children:vu?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:cc,onChange:se=>uc(se.target.value),placeholder:"Name",className:"edit-input",disabled:Wr}),i.jsx("input",{type:"number",value:ca??"",onChange:se=>Ms(se.target.value),onBlur:se=>{se.target.value===""&&Ms(0)},placeholder:"Age",className:"edit-input",disabled:Wr}),i.jsxs("select",{value:oo??"",onChange:se=>ss(se.target.value||null),className:"edit-input",disabled:Wr,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:ls??"",onChange:se=>co(se.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Wr}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{gl(!1),tr(null)},className:"button-secondary",disabled:Wr,children:"Cancel"}),i.jsx("button",{onClick:Ne,className:"button-primary blue",disabled:Wr,children:Wr?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]}),yl&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:yl})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[i.jsx("button",{onClick:()=>{gl(!0),uc(u.name||""),Ms(u.age),ss(u.gender),co(u.phone),tr(null)},className:"edit-patient-btn",title:"Edit Patient Details",disabled:Wr,children:i.jsx(ru,{size:12})}),i.jsx("span",{className:"patient-name",children:u.name??"N/A"}),u.patient_token_number!==null&&i.jsxs("span",{className:"patient-token",children:["#",u.patient_token_number]}),i.jsx("button",{onClick:fa,disabled:!fs,title:"Print All Patient Details",className:"icon-button small ml-2",children:i.jsx(il,{size:14})}),i.jsxs("div",{className:"patient-meta",children:[i.jsxs("span",{className:"meta-item",children:[u.age??"N/A"," yrs"]}),i.jsx("span",{className:"meta-divider",children:"|"}),i.jsx("span",{className:"meta-item",children:u.gender??"O"}),u.phone&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"meta-divider",children:"|"}),i.jsx("span",{className:"meta-item",children:u.phone})]}),(u==null?void 0:u.insurance_type)&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"meta-divider",children:"|"}),i.jsx("div",{className:"insurance-type-container inline-block ml-1",children:i.jsx("span",{onClick:()=>{const se={cash:"insurance",insurance:"no_cash_insurance",no_cash_insurance:"cash"}[u.insurance_type||"cash"];Zd(u.id,se)},className:"insurance-type-toggle cursor-pointer hover:text-blue-600 select-none",style:{fontSize:"0.75rem",fontWeight:600},title:"Click to cycle: Cash -> Ins. -> None",children:{cash:"Cash",insurance:"Ins.",no_cash_insurance:"None"}[u.insurance_type||"cash"]})})]})]})]})}),!u&&h!==void 0&&b!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[h??"N/A"," / ",b??"N/A"]}),i.jsx("div",{style:{width:"64px"}})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:Ve,children:[i.jsxs("div",{className:"edit-complaint-main-column",style:{flex:`0 0 calc(${100-gt}% - 4px)`},children:[ne&&i.jsxs("div",{className:"general-error-message",children:["Error: ",ne]}),W&&i.jsx("div",{className:"ai-function-status info text-center",children:"Creating record..."}),le&&i.jsx("div",{className:"ai-error-message",children:le}),Wt&&i.jsxs("div",{className:`ai-function-status ${Wt.toLowerCase().includes("error:")?"error":Wt.toLowerCase().startsWith("order created")||Wt.toLowerCase().startsWith("success:")?"success":"info"}`,children:[Vt&&i.jsx("span",{className:"animate-spin",role:"status"}),Wt]}),It&&i.jsxs("div",{className:`ai-function-status ${It.toLowerCase().includes("error:")?"error":It.toLowerCase().startsWith("success:")||It.toLowerCase().startsWith("lab order created")?"success":"info"}`,children:[Dt&&i.jsx("span",{className:"animate-spin",role:"status"}),It]}),Rn&&i.jsxs("div",{className:`ai-function-status ${Rn.toLowerCase().includes("error:")?"error":"info"}`,children:[Ti&&i.jsx("span",{className:"animate-spin",role:"status"}),Rn]}),Zi&&i.jsxs("div",{className:`ai-function-status ${Zi.toLowerCase().includes("error:")?"error":"info"}`,children:[Bi&&i.jsx("span",{className:"animate-spin",role:"status"}),Zi]}),Es&&i.jsxs("div",{className:`ai-function-status ${Es.toLowerCase().includes("error:")?"error":"info"}`,children:[Ui&&i.jsx("span",{className:"animate-spin",role:"status"}),Es]}),Ze&&i.jsxs("div",{className:"general-error-message",children:["Error saving AI response: ",Ze]}),ye&&i.jsx("div",{className:"ai-function-status info text-center",children:"Saving AI response..."}),(H||E)&&i.jsxs("div",{ref:Ae,className:`${E?"ai-function-call-block":"ai-response-container"} group`,children:[H&&i.jsx(su,{remarkPlugins:[Go],children:H}),E&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>I(!ie),className:"ai-json-toggle-button",children:[ie?i.jsx(Yv,{size:14,className:"mr-1"}):i.jsx(Zx,{size:14,className:"mr-1"}),ie?"Hide":"Show"," AI Function Call Details"]}),ie&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(E),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>cp(J),disabled:!J,title:"Copy Full AI Response",children:i.jsx(nM,{size:12})}),i.jsx("button",{onClick:xr,disabled:!J,title:"Print AI Response",children:i.jsx(il,{size:12})})]})]})]}),i.jsx("div",{className:`draggable-divider ${$e?"active":""}`,onMouseDown:rf,onDoubleClick:af,title:"Drag to resize. Double-click to reset."}),i.jsx("div",{className:"edit-complaint-context-column",style:{flex:`0 0 calc(${gt}% - 4px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsx("div",{className:"ai-context-section",children:O&&!u?i.jsxs("div",{className:"space-y-2 mt-2",children:[i.jsx("div",{className:"skeleton-text"}),i.jsx("div",{className:"skeleton-text short"})]}):i.jsxs(i.Fragment,{children:[(u==null?void 0:u.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(u.admission_date).toLocaleDateString()]}),(u==null?void 0:u.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(u.discharge_date).toLocaleDateString()]}),(u==null?void 0:u.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:u.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsxs("button",{onClick:uf,className:`admit-discharge-button ${ml?"discharge":"admit"}`,title:ml?"Discharge Patient":"Admit Patient",disabled:!o||so||Ps,children:[(so||Ps)&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),so?"Admitting...":Ps?"Discharging...":ml?"Discharge":"Admit"]}),i.jsxs("button",{onClick:()=>Fs("doctor"),className:`queue-status-button ${Yr?"in-queue":"add-to-queue"}`,title:Yr?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!o||as||Yr,children:[as&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),as?"Adding...":Yr?"In Queue":"Add to Queue"]}),i.jsxs("button",{onClick:za,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:pl,children:[pl&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),pl?"Completing...":"Complete Consultation"]})]})]})}),i.jsxs("div",{className:"ai-context-section border-t border-gray-100 dark:border-gray-800 pt-4",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Recurring Medications"}),O&&Fa.length===0?i.jsxs("div",{className:"space-y-2 mt-2",children:[i.jsx("div",{className:"skeleton-text"}),i.jsx("div",{className:"skeleton-text short"})]}):Fa.length>0?i.jsx("div",{className:"recurring-meds-container space-y-3 mt-2",children:Fa.map((se,pe)=>i.jsxs("div",{className:"ai-context-item flex flex-col p-3 rounded-lg border border-gray-100 dark:border-gray-800",style:{"--i":pe},children:[i.jsxs("div",{className:"flex justify-between items-center mb-2 pb-2 border-b border-gray-50 dark:border-gray-800",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-xs font-semibold text-gray-500",children:["#",pe+1," Status:"]}),i.jsx("span",{className:`status-badge text-[10px] uppercase font-bold px-1.5 py-0.5 rounded ${se.status==="active"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":se.status==="paused"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:se.status})]}),i.jsxs("div",{className:"flex space-x-1",children:[i.jsx("button",{onClick:()=>ef(se),className:"icon-button small",title:"Edit Recurring Medication",children:i.jsx(ru,{size:12})}),i.jsx("button",{onClick:()=>mc(se.id),className:"icon-button small text-red-500",title:"Delete Recurring Medication",children:i.jsx(Pi,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-[11px] table-fixed",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left w-[40%]",children:"Medications"}),i.jsx("th",{className:"py-1 px-2 text-left w-[20%]",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left w-[40%]",children:"Freq / Next"})]})}),i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{className:"py-2 px-2 align-top",children:i.jsx("div",{className:"space-y-2",children:se.medications.map((de,_e)=>i.jsxs("div",{className:"flex flex-col border-b border-gray-50 dark:border-gray-800/50 last:border-0 pb-1 last:pb-0",children:[i.jsx("strong",{className:"break-words leading-tight",children:de.name}),i.jsx("div",{className:"flex flex-wrap gap-x-2 text-gray-500 text-[10px]",children:i.jsxs("span",{children:[de.pack_quantity?`${de.pack_quantity}p`:"",de.pack_quantity&&de.loose_quantity?" + ":"",de.loose_quantity?`${de.loose_quantity}l`:""]})}),de.directions_to_use&&i.jsx("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 italic mt-0.5 line-clamp-2",title:de.directions_to_use,children:de.directions_to_use})]},_e))})}),i.jsx("td",{className:"py-2 px-2 align-top",children:i.jsx("div",{className:"space-y-2",children:se.medications.map((de,_e)=>i.jsx("div",{className:"flex flex-col border-b border-gray-50 dark:border-gray-800/50 last:border-0 pb-1 last:pb-0 h-[32px] justify-center",children:de.tabletsPerDay?`${de.tabletsPerDay} / day`:"-"},_e))})}),i.jsxs("td",{className:"py-2 px-2 align-top italic text-gray-500 break-words leading-tight",children:[i.jsxs("div",{className:"font-semibold text-gray-700 dark:text-gray-300",children:["Every ",se.frequency_days,"d"]}),i.jsxs("div",{className:"text-[10px] not-italic mt-1 text-gray-400",children:["Next: ",new Date(se.next_delivery_date).toLocaleDateString()]}),se.last_delivery_date&&i.jsxs("div",{className:"text-[9px] not-italic mt-0.5 text-gray-400",children:["Last: ",new Date(se.last_delivery_date).toLocaleDateString()]})]})]})})]})})]},se.id))}):i.jsx("p",{className:"ai-context-text italic text-gray-400 mt-2",children:"No recurring medications."})]}),i.jsx(Cv,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[lr&&i.jsxs("button",{onClick:()=>{var se;return(se=nr.current)==null?void 0:se.undoLastBatch()},className:"flex items-center justify-center bg-red-100 hover:bg-red-200 text-red-700 border border-red-200 rounded text-xs px-2 py-1 transition-colors",disabled:Xr,title:"Undo Last AI Batch",children:[i.jsx(WM,{size:12,className:"mr-1"})," Undo AI"]}),i.jsx("button",{onClick:yc,className:"action-button primary",disabled:Oa||ze.filter(se=>se.status==="pending").length<2,title:"Merge all pending orders into one",children:Oa?i.jsx(i.Fragment,{children:i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"})}):"Merge Orders"}),i.jsxs("button",{onClick:()=>rc(!0),className:"action-button success",title:"Manually create a new pharmacy order",disabled:!o,children:[i.jsx(eo,{size:12})," Add Pharmacy Order"]})]}),items:da,isLoading:O,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(se,pe)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",da.length-pe,". Order Status: (",se.data.status,")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(se.originalDateString).toLocaleDateString(),")"]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>_u(se.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(ru,{size:12})}),se.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>Tu(se.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(il,{size:12})}),i.jsx("button",{onClick:()=>yo({type:"Pharmacy Order",data:se.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(Pi,{size:12})}),i.jsx("button",{onClick:()=>op(se.data.id),className:"icon-button small",title:"Mark as Recurring Medication",disabled:As,children:i.jsx(GM,{size:12})}),se.data.status==="pending"&&i.jsx("button",{onClick:()=>sp(se.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:As,children:i.jsx(Bd,{size:12})}),se.data.status==="billed"&&i.jsx("button",{onClick:()=>lp(se.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:As,children:i.jsx(Ta,{size:12})}),se.data.status==="dispensed"&&i.jsx("button",{onClick:async()=>{var de;try{const _e=await ue(`/api/bills?patientId=${se.data.patientId}`);if(!_e.ok)throw new Error("Failed to fetch bills");const xt=(de=(await _e.json()).bills)==null?void 0:de.find(Ct=>Ct.related_id===se.data.id&&Ct.type==="pharmacy");xt?n(`/dashboard/bills/${xt.id}`):alert("Bill not found for this order.")}catch(_e){console.error("Error fetching bill:",_e),alert("Failed to fetch bill. Please try again.")}},className:"icon-button small",title:"View Bill",children:i.jsx(IC,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:se.data.medications.map((de,_e)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:de.name})}),i.jsxs("td",{className:"py-1 px-2",children:[de.pack_quantity!==void 0&&de.pack_quantity>0&&`Packs: ${de.pack_quantity}`,de.pack_quantity!==void 0&&de.pack_quantity>0&&de.loose_quantity!==void 0&&de.loose_quantity>0&&", ",de.loose_quantity!==void 0&&de.loose_quantity>0&&`Loose: ${de.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:de.tabletsPerDay&&de.numberOfDays?`${de.tabletsPerDay} tab/day for ${de.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:de.directions_to_use||"N/A"})]},de.drug_id||de.name||_e))})]})}),se.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",se.data.prescriptionForUnavailableDrugs]})]})}),i.jsx(XY,{isOpen:rp,onClose:()=>rc(!1),patientId:o,pharmacyInventory:qe,fetchPharmacyOrdersData:us}),i.jsx(Cv,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:cf,className:"action-button primary",title:"Tell AI to analyse the reports",disabled:Xr,children:"Analyse Reports"}),i.jsx("button",{onClick:()=>ic(!0),className:"action-button success",title:"Manually create a new lab order",disabled:!o,children:"Create Lab Order"})]}),items:ds,onSaveLabOrder:ku,onCancelEditLabOrder:Cu,onLabOrderTestChange:Sl,onLabOrderStatusChange:tf,onBillLabOrder:gc,labInventory:tt,isSavingLabOrder:As,isLoading:oa||Xe,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:fl,toggleLabReport:Eu,renderItemContent:(se,pe)=>{const de=YG(se.data.report?se.data.report.status:se.data.status);return i.jsxs("div",{className:"ai-context-text",children:[i.jsxs("span",{onClick:()=>go(se.data),style:{cursor:"pointer"},className:"hover:text-blue-600",title:"Click to open lab report",children:[se.data.serialNumber,". ",i.jsx("span",{className:"font-medium",children:"[Order]"})," ",se.data.tests&&se.data.tests.length>0?se.data.tests.map(_e=>i.jsxs("strong",{children:[_e.name," (",_e.price,")"]},_e.id||_e.name)).reduce((_e,rt)=>[_e,", ",rt]):i.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",se.data.tests&&se.data.tests.length>0&&i.jsxs("span",{className:"font-bold ml-2",children:["Total: ",se.data.tests.reduce((_e,rt)=>_e+(Number(rt.price)||0),0).toFixed(2)]}),"(",i.jsx("span",{className:de.className,children:de.text}),")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(se.originalDateString).toLocaleDateString(),")"]})]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[i.jsx("button",{onClick:()=>go(se.data),className:"icon-button small",title:"Manage Lab Report",children:i.jsx(Ea,{size:12})}),i.jsx("button",{onClick:()=>Nl(se.data.id),className:"icon-button small",title:"Edit Order Details",children:i.jsx(ru,{size:12})}),i.jsx("button",{onClick:()=>yo({type:"Lab Order",data:se.data}),className:"icon-button small text-red-500",title:"Delete Lab Order",children:i.jsx(Pi,{size:12})})]}),se.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(se.data.report.report_date).toLocaleDateString(),")"]}),i.jsx("button",{onClick:()=>Eu(se.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:fl[se.data.report.reportId]?"Collapse Report":"Expand Report",children:fl[se.data.report.reportId]?i.jsx(Yv,{size:14}):i.jsx(Zx,{size:14})})]}),fl[se.data.report.reportId]&&(()=>{try{const _e=JSON.parse(se.data.report.report_content||"{}");return typeof _e=="object"&&_e!==null&&se.data.report.tests?se.data.report.tests.map(rt=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:rt.name}),_e[rt.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(_e[rt.id]).map(([xt,Ct])=>{var Vi;const vt=(Vi=rt.default_parameters)==null?void 0:Vi.find(Mi=>Mi.name===xt),Qt=typeof Ct=="string"?parseFloat(Ct):typeof Ct=="number"?Ct:NaN,cr=(vt==null?void 0:vt.type)==="number"&&!isNaN(Qt)&&Ct!==""&&Ct!==null&&Ct!==void 0&&(vt.lower_limit!=null&&Qt<vt.lower_limit||vt.upper_limit!=null&&Qt>vt.upper_limit),vo=(vt==null?void 0:vt.type)==="boolean"&&(Ct===!0||Ct==="true");return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:xt}),i.jsxs("td",{className:`py-1 px-2 ${cr?"abnormal-result":""} ${vo?"reactive-result":""}`,children:[String(Ct)," ",(vt==null?void 0:vt.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(vt&&vt.type==="number"&&(vt.lower_limit!=null||vt.upper_limit!=null)){let Mi="";return vt.lower_limit!=null&&(Mi+=` > ${vt.lower_limit}`),vt.lower_limit!=null&&vt.upper_limit!=null&&(Mi+=" - "),vt.upper_limit!=null&&(Mi+=` < ${vt.upper_limit}`),Mi.trim()||"N/A"}else if((vt==null?void 0:vt.type)==="boolean")return"Non-Reactive";return(vt==null?void 0:vt.normal_range)||"N/A"})()})]},xt)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},rt.id)):i.jsx(su,{remarkPlugins:[Go],children:se.data.report.report_content})}catch{return i.jsx(su,{remarkPlugins:[Go],children:se.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(vY,{isOpen:bu,onClose:()=>ic(!1),patientId:o,labInventory:tt,fetchPendingLabOrdersData:wl}),sc&&i.jsx(bT,{isOpen:mr,onClose:()=>ac(!1),recurringMedication:sc,onUpdate:()=>o&&Kr(o),inventory:qe}),i.jsx(Cv,{title:"Complaints History",items:ir,isLoading:en,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(se,pe)=>i.jsxs("span",{className:"ai-context-text",children:[se.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(se.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:yo}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(hg,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!bl&&i.jsx("button",{onClick:of,className:"edit-button",title:"Edit System Prompt",disabled:os||cs||Rs,children:i.jsx(ru,{size:14})})]}),bl&&kn?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:Kn,onChange:se=>ua(se.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:cs||Rs}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:ps,disabled:cs||Rs,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:bc,disabled:cs||Rs||Is===kn.aiMemory&&Kn===kn.clinicWideSystemPrompt,className:"button-primary purple",children:[Rs||cs?i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}):i.jsx(uu,{size:14,className:"mr-1"}),Rs||cs?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:kn!=null&&kn.clinicWideSystemPrompt?i.jsx(su,{remarkPlugins:[Go],children:kn.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!bl&&(kn==null?void 0:kn.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(kn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!A&&i.jsx("button",{onClick:hs,className:"edit-button",title:"Edit Case Summary",disabled:O||V,children:i.jsx(ru,{size:14})})]}),A?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:D,onChange:se=>M(se.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:V}),z&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:z}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:sf,disabled:V,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:lf,disabled:V||D===N,className:"button-primary blue",children:V?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:N?i.jsx(su,{remarkPlugins:[Go],components:{},children:N}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),U&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(U).toLocaleDateString()]})]})]}),ir.length===0&&ds.length===0&&da.length===0&&!(en||oa||Xe)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),ul&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),Gr&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:Gr})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsxs("div",{className:"status-messages-container",children:[je&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:je}),K&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:K}),cl&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:cl}),Nt&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Nt})]}),e&&!W&&i.jsxs(w.Fragment,{children:[or&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:or}),Ls.length>0&&i.jsx("div",{className:"options-grid",children:Ls.map((se,pe)=>i.jsx("button",{onClick:()=>Cr(se),className:"option-button",children:se},pe))})]}),fc&&i.jsx("div",{className:"speech-error-display",children:fc}),hc&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",hc.name]}),i.jsx("button",{onClick:()=>{Dn(null),Cn.current&&(Cn.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:Cn,onChange:Ft,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:Ie,className:"complaint-textarea",value:r,onChange:se=>a(se.target.value),onKeyDown:Au,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:Xr||!e||La}),i.jsxs("div",{className:"chat-input-actions-container",children:[o&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>n(`/patient/${o}/lab-reports`),disabled:Xe||!o,className:"icon-button",title:"View Lab Reports",children:i.jsx(Ea,{size:14})}),i.jsx("button",{onClick:()=>n("/inventory"),disabled:dt,className:"icon-button",title:"View Inventory",children:i.jsx(Ko,{size:14})})]}),i.jsx("button",{type:"button",onClick:mt,disabled:Xr||!e||La,className:"icon-button",title:"Attach Image",children:i.jsx(RM,{size:14})}),i.jsx("button",{type:"button",onClick:Oe,disabled:Xr||!e||!Qr.current,className:`mic-button ${La?"listening":""}`,title:La?"Stop":"Mic",children:i.jsx(OC,{size:14})}),i.jsx("button",{onClick:()=>$a(),disabled:Xr||dt||W||!r.trim()||!e||La||O||en||oa,className:`send-button ${ce||O||dt||en||oa?"loading":""}`,title:Xr||dt||W?"Processing...":"Save & Ask AI",children:ce||O||dt||en||oa?i.jsx("span",{className:"animate-spin",role:"status","aria-label":"loading"}):i.jsx(Ho,{size:14})})]})]})})]})]})]})},$ee=()=>{const{patientId:e}=qr(),n=Mt(),[t,r]=w.useState([]),[a,l]=w.useState(null),[o,f]=w.useState(!1),[u,d]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided.");return}f(!0),d(null);try{const b=await ue(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();l({name:v.name,age:v.age,gender:v.gender});const N=await ue(`/api/patients/${e}/complaints`);if(N.ok){const A=(await N.json()).sort((T,D)=>new Date(D.createdAt).getTime()-new Date(T.createdAt).getTime());r(A)}else if(N.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${N.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),d(`Failed to load data. ${b.message}`),r([]),l(null)}finally{f(!1)}})()},[e]);const h=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),u&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",u]}),o&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!o&&t.length===0&&!u&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!o&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>h(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Fx=500,eC="defaultConsultationFee",zee=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:l=[],billType:o="other",relatedId:f,initialStatus:u="pending",initialDiscountPercentage:d=0,readOnlyMode:h=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[N,C]=w.useState(null),[A,T]=w.useState([]),D=w.useRef(null),[M,V]=w.useState(""),[F,z]=w.useState(""),[B,U]=w.useState(1),[R,O]=w.useState(d),[$,W]=w.useState("cash"),[te,ne]=w.useState(!1),[re,J]=w.useState(null),[q,H]=w.useState(!1),[ee,E]=w.useState(!1),[Q,ie]=w.useState(!1),[I,ce]=w.useState(null),[,xe]=w.useState([]),[le,ge]=w.useState(null),[ye,Re]=w.useState(""),[Ze,at]=w.useState("cash"),[Le,Te]=w.useState(!1),[we,Fe]=w.useState(Fx),[Xe,it]=w.useState(Fx.toString()),je=n?"view_pay":"create";w.useEffect(()=>{const $e=localStorage.getItem(eC),nt=$e?parseFloat($e):Fx;isNaN(nt)||(Fe(nt),it(nt.toString()))},[]);const Ke=l.length===0;w.useEffect(()=>{e?(async()=>{ne(!0),J(null);try{const nt=await ue(`/api/patients/${e}`);if(!nt.ok){const ht=await nt.json().catch(()=>({}));throw new Error(ht.message||"Failed to fetch patient details")}const Ve=await nt.json();C(Ve)}catch(nt){J(`Failed to load patient details: ${nt.message}`),C(null)}finally{ne(!1)}})():C(null)},[e]),w.useEffect(()=>{n?(async()=>{ie(!0),J(null),ce(null),xe([]),ge(null);try{const nt=await ue(`/api/bills/${n}`);if(!nt.ok){const ht=await nt.json().catch(()=>({}));throw new Error(ht.message||"Failed to fetch bill details")}const Ve=await nt.json();if(!Ve.bill||!Ve.payments||!Ve.calculated)throw new Error("Invalid bill details structure.");ce(Ve.bill),xe(Ve.payments),ge(Ve.calculated),O(Ve.bill.discount_percentage!==void 0&&Ve.bill.discount_percentage!==null?parseFloat(Ve.bill.discount_percentage.toString()):0),!N&&Ve.bill.patient_id&&ze(Ve.bill.patient_id.toString())}catch(nt){J(`Failed to load bill details: ${nt.message}`),ce(null),xe([]),ge(null)}finally{ie(!1)}})():(ce(null),xe([]),ge(null))},[n]);const ze=async $e=>{ne(!0);try{const nt=await ue(`/api/patients/${$e}`);if(!nt.ok)throw new Error("Failed to fetch patient");const Ve=await nt.json();C(Ve)}catch(nt){console.error("Error fetching patient details:",nt),C(null)}finally{ne(!1)}},ct=w.useCallback(async $e=>{E(!0),J(null);const nt=$e.filter(Ve=>Ve.drug_id!=null).map(async Ve=>{try{const ht=await ue(`/api/drugs/${Ve.drug_id}`);if(!ht.ok)throw new Error(`Drug ${Ve.drug_id} not found.`);const Se=await ht.json();return{...Ve,price:Se.price,total:Se.price*Ve.quantity}}catch{return J(Se=>`${Se?Se+"; ":""}Failed to fetch price for ${Ve.name}`),Ve}});try{const Ve=await Promise.all(nt);T(ht=>{const Se=new Map(Ve.map(qe=>[qe.id,qe]));return ht.map(qe=>Se.get(qe.id)||qe)})}catch{}finally{E(!1)}},[ue]);w.useEffect(()=>{if(n){T([]),D.current=null;return}D.current!==null&&JSON.stringify(l)===JSON.stringify(D.current)||(async()=>{let Ve=[];if(l&&l.length>0)Ve=l.map((ht,Se)=>({...ht,id:`initial-${Se}-${Date.now()}`})),W(u==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),O(d),o==="pharmacy"&&!h&&await ct(Ve);else if(e&&Ke&&o==="consultation"){let ht=we;if(g)try{const Se=await ue(`/api/staff/${g}`);if(!Se.ok){const Be=await Se.json().catch(()=>({}));throw new Error(Be.message||"Doctor not found or error fetching fee")}const qe=await Se.json();qe.opd_fee!=null&&!isNaN(parseFloat(String(qe.opd_fee)))&&parseFloat(String(qe.opd_fee))>=0&&(ht=parseFloat(String(qe.opd_fee)))}catch(Se){J(qe=>`${qe?qe+"; ":""}Could not fetch doctor's fee, using default. (${Se.message})`)}Ve=[{id:Date.now(),name:"Consultation Fee",price:ht,quantity:1,total:ht*1,drug_id:null}],W(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else Ve=[],W(v==="no_cash_insurance"?"no_cash_insurance":"cash");T(Ve),D.current=l})()},[n,e,g,l,o,we,Ke,u,h,ct,d,v]);const Tt=()=>{const $e=parseFloat(F);if(!h)if(M&&!isNaN($e)&&$e>=0&&B>0){if(M.trim().toLowerCase()==="consultation fee"&&A.some(Ve=>Ve.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const nt={id:Date.now(),name:M.trim(),price:$e,quantity:B,total:$e*B,drug_id:null};T([...A,nt]),V(""),z(""),U(1)}else alert("Invalid item details.")},bt=$e=>{h||T(A.filter(nt=>nt.id!==$e))},en=w.useMemo(()=>{let $e=A.reduce((Ve,ht)=>Ve+ht.total,0);const nt=typeof R=="string"?parseFloat(R)||0:R;return je==="create"&&nt>0&&($e=$e*(1-nt/100)),(le==null?void 0:le.totalDue)!==void 0&&(le==null?void 0:le.totalDue)!==null?le.totalDue:$e},[A,le,R,je]),oe=w.useMemo(()=>(le==null?void 0:le.totalPaid)??0,[le]),K=w.useMemo(()=>(le==null?void 0:le.balance)!==void 0&&(le==null?void 0:le.balance)!==null?le.balance:en-oe,[le,en,oe]),fe=()=>{const $e=parseFloat(Xe);!isNaN($e)&&$e>=0?(Fe($e),localStorage.setItem(eC,$e.toString()),alert(`Default Fee set to ${$e.toFixed(2)}`)):alert("Invalid fee amount.")},Ae=async($e,nt)=>{H(!0),J(null);try{const Ve=await ue("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:nt,billId:$e})}),ht=await Ve.json();if(!Ve.ok||!ht.order)throw new Error(ht.message||"Failed to create Razorpay order.");const{key_id:Se,order:qe}=ht,Be={key:Se,amount:qe.amount,currency:qe.currency,name:"Newtons OPD Zero Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:qe.id,handler:async function(tt){try{const st=await ue("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:tt.razorpay_payment_id,razorpay_order_id:tt.razorpay_order_id,razorpay_signature:tt.razorpay_signature,billId:$e})}),dt=await st.json();if(st.ok&&dt.success)alert("Payment Successful!"),r&&r($e),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(dt.message||"Payment verification failed.")}catch(st){J(`Payment verification failed: ${st.message}. Contact support.`)}finally{H(!1)}},prefill:{name:(N==null?void 0:N.name)||""},notes:{bill_id:$e,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){J("Payment cancelled."),H(!1)}}};if(window.Razorpay)new window.Razorpay(Be).open();else throw new Error("Razorpay SDK not loaded.")}catch(Ve){J(`Failed to initiate online payment: ${Ve.message}`),H(!1)}},Ie=async()=>{if(!n){J("Bill ID is missing.");return}if(!ye||isNaN(parseFloat(ye))||parseFloat(ye)<=0){J("Please enter a valid positive payment amount.");return}Te(!0),J(null);const $e={amount_paid:parseFloat(ye),payment_mode:Ze};try{const nt=await ue(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($e)}),Ve=await nt.json();if(!nt.ok)throw new Error(Ve.message||`Failed to record payment (Status: ${nt.status})`);alert(`Payment of ${$e.amount_paid.toFixed(2)} recorded.`),Re(""),a?a():console.log("Payment recorded.")}catch(nt){J(`Failed to record payment: ${nt.message}`)}finally{Te(!1)}},Ye=async()=>{if(je==="view_pay")return;if(!e){J("Patient ID is missing for creating a bill.");return}if(A.length===0){J("Cannot finalize an empty bill.");return}H(!0),J(null);const $e=en,nt=A.map(({id:Ve,...ht})=>ht);if($==="online"){const Ve={patientId:e,queueId:t||null,items:nt,amount:$e,paymentMode:"online",type:o,related_id:f||b||null,status:"pending",discountPercentage:Number(R)||0,labOrderId:b||null};try{const ht=await ue("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ve)}),Se=await ht.json();if(!ht.ok)throw new Error(Se.message||"Failed to create pending bill.");Ae(Se.id,Math.round($e*100))}catch(ht){J(`Failed to create pending bill: ${ht.message}`),H(!1)}}else{const Ve="paid";if(!$){J("Payment mode required."),H(!1);return}const ht={patientId:e,queueId:t||null,items:nt,amount:$e,paymentMode:$,type:o,related_id:f||b||null,status:Ve,discountPercentage:Number(R)||0,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const Se=await ue("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ht)}),qe=await Se.json();if(!Se.ok)throw new Error(qe.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(qe.id),H(!1)}catch(Se){J(`Failed to process bill: ${Se.message}`),H(!1)}}},ft=(I==null?void 0:I.type)??o,gt=(I==null?void 0:I.status)??u,jt=je==="view_pay"&&I&&gt==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):te||je==="view_pay"&&Q?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):je==="view_pay"&&!I&&!Q&&re?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",re]}):je==="create"&&!N&&!te&&re?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",re]}):i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:je==="create"?b?"New Lab Bill":"New Bill":"Bill Analysis"}),je==="create"&&o==="consultation"&&!h&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",children:"Default Fee"}),i.jsx("input",{id:"defaultFee",type:"number",value:Xe,onChange:$e=>it($e.target.value),placeholder:Fx.toString(),disabled:h}),i.jsx("button",{onClick:fe,title:"Save Fee",disabled:h,children:i.jsx(uu,{size:16})})]})]}),re&&!Q&&!Le&&i.jsxs("div",{className:"error-box",role:"alert",children:[i.jsx(ni,{size:18}),i.jsx("span",{children:re})]}),i.jsxs("div",{className:"billing-layout-grid",children:[i.jsxs("div",{className:"billing-left-column",children:[N&&i.jsxs("div",{className:"billing-card",children:[i.jsxs("h3",{children:[i.jsx(ks,{size:18})," Patient Case"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",fontSize:"0.9rem"},children:[i.jsxs("div",{children:[i.jsx("span",{style:{opacity:.7},children:"Name:"})," ",i.jsx("strong",{children:N.name})]}),i.jsxs("div",{children:[i.jsx("span",{style:{opacity:.7},children:"ID:"})," ",i.jsxs("strong",{children:["#",N.id]})]}),i.jsxs("div",{children:[i.jsx("span",{style:{opacity:.7},children:"Age/Sex:"})," ",i.jsxs("strong",{children:[N.age||"N/A"," / ",N.gender||"N/A"]})]}),v&&i.jsxs("div",{children:[i.jsx("span",{style:{opacity:.7},children:"Type:"})," ",i.jsx("strong",{className:"capitalize",children:v})]})]})]}),i.jsxs("div",{className:"billing-card",style:{flexGrow:1},children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:"Bill Particulars"}),je==="create"&&o==="pharmacy"&&!h&&A.some($e=>$e.drug_id!=null)&&i.jsxs("button",{onClick:()=>ct(A),disabled:ee,className:"refresh-prices-button",children:[i.jsx(qd,{size:14,className:ee?"animate-spin":""}),i.jsx("span",{children:"Sync Prices"})]})]}),je==="view_pay"&&I&&i.jsxs("div",{className:"bill-info-bar",style:{background:"transparent",border:"none",padding:"0 0 1rem 0"},children:[i.jsx("span",{className:`status-badge ${gt==="paid"?"status-paid":"status-pending"}`,children:gt}),i.jsxs("span",{style:{fontSize:"0.85rem",color:"var(--billing-text-soft)"},children:["ID: #",I.id," | ",ft]})]}),i.jsx("div",{className:"bill-items-container",children:i.jsxs("table",{className:"billing-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"#"}),i.jsx("th",{children:"Description"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{style:{textAlign:"right"},children:"Total"}),!h&&je==="create"&&i.jsx("th",{style:{width:"40px"}})]})}),i.jsxs("tbody",{children:[je==="create"&&!ee&&A.map(($e,nt)=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:"30px",opacity:.5},children:nt+1}),i.jsx("td",{className:"item-name-cell",children:$e.name}),i.jsx("td",{className:"item-qty-cell",children:$e.quantity}),i.jsxs("td",{className:"item-price-cell",children:["",$e.total.toFixed(2)]}),!h&&i.jsx("td",{children:typeof $e.id=="number"&&$e.name!=="Consultation Fee"?i.jsx("button",{onClick:()=>bt($e.id),className:"btn-remove",title:"Remove",children:i.jsx(Pi,{size:16})}):i.jsx(SM,{size:14,style:{opacity:.3}})})]},$e.id)),je==="view_pay"&&I&&I.items.map(($e,nt)=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:"30px",opacity:.5},children:nt+1}),i.jsx("td",{className:"item-name-cell",children:$e.name}),i.jsx("td",{className:"item-qty-cell",children:$e.quantity}),i.jsxs("td",{className:"item-price-cell",children:["",($e.total??$e.price*$e.quantity).toFixed(2)]})]},nt)),(je==="create"?A.length:(I==null?void 0:I.items.length)||0)===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{textAlign:"center",padding:"2rem",opacity:.5},children:"No particulars added yet."})})]})]})}),je==="create"&&!h&&i.jsxs("div",{className:"add-item-modern-form",style:{marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"1px solid var(--billing-border)"},children:[i.jsxs("div",{className:"form-field",children:[i.jsx("label",{children:"Add Particular"}),i.jsx("input",{type:"text",value:M,onChange:$e=>V($e.target.value),placeholder:"Service description...",className:"modern-input"})]}),i.jsxs("div",{className:"form-field",children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:B,onChange:$e=>U(parseInt($e.target.value)||1),placeholder:"1",className:"modern-input"})]}),i.jsxs("div",{className:"form-field",children:[i.jsx("label",{children:"Price"}),i.jsx("input",{type:"number",value:F,onChange:$e=>z($e.target.value),placeholder:"0.00",className:"modern-input"})]}),i.jsxs("button",{onClick:Tt,className:"btn-add-item",children:[i.jsx(eo,{size:18})," Add"]})]})]})]}),i.jsxs("div",{className:"billing-right-column",children:[i.jsxs("div",{className:"summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h3",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{className:"summary-label",children:"Subtotal"}),i.jsxs("span",{className:"summary-value",children:["",A.reduce(($e,nt)=>$e+nt.price*nt.quantity,0).toFixed(2)]})]}),i.jsxs("div",{className:"discount-control",children:[i.jsx(Dh,{size:18}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{fontSize:"0.75rem",opacity:.8,fontWeight:600},children:"DISCOUNT %"}),je==="create"&&!h?i.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:R,onChange:$e=>O($e.target.value),onBlur:$e=>{$e.target.value===""&&O(0)}}):i.jsxs("span",{style:{fontWeight:700},children:[Number(R).toFixed(1),"%"]})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsx("div",{style:{fontSize:"0.75rem",opacity:.8},children:"SAVINGS"}),i.jsxs("div",{style:{fontWeight:700},children:["-",(A.reduce(($e,nt)=>$e+nt.price*nt.quantity,0)-en).toFixed(0)]})]})]}),i.jsxs("div",{className:"summary-row grand-total",children:[i.jsx("span",{className:"summary-label",children:"GRAND TOTAL"}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{className:"total-amount",children:["",en.toFixed(0)]}),i.jsx("div",{style:{fontSize:"0.8rem",opacity:.8},children:"Total Payable Amount"})]})]}),je==="view_pay"&&le&&i.jsxs("div",{style:{marginTop:"1rem",borderTop:"1px solid rgba(255,255,255,0.2)",paddingTop:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[i.jsxs("div",{className:"summary-row",style:{opacity:.9},children:[i.jsx("span",{children:"Paid Amount"}),i.jsxs("span",{children:["",oe.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",style:{fontWeight:700},children:[i.jsx("span",{children:"Balance Due"}),i.jsxs("span",{children:["",K.toFixed(2)]})]})]})]}),i.jsxs("div",{className:"payment-card",children:[i.jsxs("h3",{children:[i.jsx(zd,{size:18})," Local Settlement"]}),je==="create"&&!h&&i.jsxs("div",{className:"billing-actions",children:[i.jsx("div",{className:"payment-grid",children:[{id:"cash",label:"Cash",icon:i.jsx(_N,{size:20})},{id:"upi",label:"UPI",icon:i.jsx(H0,{size:20})},{id:"card",label:"Card",icon:i.jsx(zd,{size:20})},{id:"online",label:"Razorpay",icon:i.jsx(H0,{size:20})},{id:"no_cash_insurance",label:"Insurance",icon:i.jsx(Dh,{size:20})},{id:"credit",label:"Credit",icon:i.jsx(Dh,{size:20})}].map($e=>i.jsxs("label",{className:"payment-option",children:[i.jsx("input",{type:"radio",name:"paymentMode",value:$e.id,checked:$===$e.id,onChange:()=>W($e.id)}),i.jsxs("div",{className:"payment-btn",children:[$e.icon,i.jsx("span",{children:$e.label})]})]},$e.id))}),i.jsx("button",{onClick:Ye,disabled:q||A.length===0,className:"btn-primary",children:q?"Generating Bill...":$==="online"?"Pay Online & Finalize":"Complete Settlement"})]}),je==="view_pay"&&jt&&!h&&i.jsxs("div",{className:"billing-actions",children:[i.jsxs("div",{className:"form-field",style:{marginBottom:"1rem"},children:[i.jsx("label",{children:"Settle Amount"}),i.jsx("input",{type:"number",value:ye,onChange:$e=>Re($e.target.value),onBlur:$e=>{$e.target.value===""&&Re("0")},placeholder:`Balance: ${K.toFixed(0)}`,className:"modern-input"})]}),i.jsx("div",{className:"payment-grid",children:[{id:"cash",label:"Cash",icon:i.jsx(_N,{size:20})},{id:"upi",label:"UPI",icon:i.jsx(H0,{size:20})},{id:"card",label:"Card",icon:i.jsx(zd,{size:20})},{id:"no_cash_insurance",label:"Insurance",icon:i.jsx(Dh,{size:20})}].map($e=>i.jsxs("label",{className:"payment-option",children:[i.jsx("input",{type:"radio",name:"paymentMode",value:$e.id,checked:Ze===$e.id,onChange:()=>at($e.id)}),i.jsxs("div",{className:"payment-btn",children:[$e.icon,i.jsx("span",{children:$e.label})]})]},$e.id))}),i.jsx("button",{onClick:Ie,disabled:Le||!ye||parseFloat(ye)<=0||parseFloat(ye)>K+.1,className:"btn-secondary",children:Le?"Settling...":"Record Payment"})]}),gt==="paid"&&i.jsx("div",{className:"status-badge status-paid",style:{textAlign:"center",width:"100%",padding:"1rem"},children:"This invoice is fully settled."}),gt==="cancelled"&&i.jsx("div",{className:"status-badge status-cancelled",style:{textAlign:"center",width:"100%",padding:"1rem"},children:"This invoice was cancelled."})]})]})]})]})},Bee=()=>{const e=Mt(),n=_r(),{patientId:t,queueId:r,initialItems:a,billType:l,relatedId:o,initialStatus:f,initialDiscountPercentage:u,doctorId:d,billId:h,labOrderId:g}=n.state||{},[b,v]=w.useState(null),[N,C]=w.useState(null),[A,T]=w.useState(null),[D,M]=w.useState(null),[V,F]=w.useState(null),[z,B]=w.useState(null),[U,R]=w.useState(!0),[O,$]=w.useState(null);if(w.useEffect(()=>{(async()=>{if(!t&&!h){R(!1);return}R(!0),$(null);try{let J=t;if(h){const q=await ue(`/api/bills/${h}`);if(!q.ok){const ee=await q.json().catch(()=>({}));throw new Error(ee.message||"Failed to fetch bill details")}const H=await q.json();H.bill&&(C(H.bill.items||[]),T(H.bill.status),M(H.bill.type),F(H.bill.related_id),B(H.bill.discount_percentage?parseFloat(H.bill.discount_percentage):0),H.bill.patient_id&&(J=H.bill.patient_id.toString()))}if(J){const q=await ue(`/api/patients/${J}`);if(q.ok){const H=await q.json();v(H.insurance_type??null)}}}catch(J){console.error("Error loading billing details:",J),$(J.message||"Failed to load details")}finally{R(!1)}})()},[h,t,g]),!t&&!h&&!U)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(eb,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient/Bill Information"}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(U)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(O)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(eb,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:O}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const te=(A??f)==="paid",ne=async re=>{var J,q;if((J=n.state)!=null&&J.finalizeQueueAssignment&&r&&d)try{const H={status:"waiting",doctorId:d};(await ue(`/api/queue/${r}/status`,{method:"PATCH",body:JSON.stringify(H)})).ok?console.log("Queue assigned successfully after payment."):console.error("Failed to assign queue after payment.")}catch(H){console.error("Error finalizing queue assignment:",H)}(q=n.state)!=null&&q.finalizeQueueAssignment?e("/dashboard",{state:{activeTab:"queue"}}):e(-1)};return i.jsx(zee,{patientId:t,labOrderId:g,queueId:r,doctorId:d,billId:h,initialItems:N??a,billType:D??l,relatedId:V??o,initialStatus:A??f,initialDiscountPercentage:z??u,readOnlyMode:te,patientInsuranceType:b??void 0,onBillCreated:ne,onBillUpdated:()=>e(-1)})},Uee=({patientId:e,labOrderId:n,onBillingSuccess:t,initialItems:r,patientName:a})=>{const[l]=w.useState(r),[o,f]=w.useState(0),[u,d]=w.useState("cash"),[h,g]=w.useState(null),[b,v]=w.useState(!1),N=w.useMemo(()=>{const A=l.reduce((D,M)=>D+M.total,0),T=typeof o=="string"?parseFloat(o)||0:o;return A*(1-T/100)},[l,o]),C=async()=>{if(l.length===0){g("Cannot finalize an empty bill.");return}v(!0),g(null);const A={patientId:e,items:l,amount:N,paymentMode:u,type:"lab",related_id:n,status:"paid",discountPercentage:Number(o)||0,labOrderId:n};try{const T=await ue("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),D=await T.json();if(!T.ok)throw new Error(D.message||"Failed to create bill.");alert("Bill created successfully!");const M=window.open("","_blank");if(M){const V=`
                    <html>
                        <head>
                            <title>Lab Bill</title>
                            <style>
                                body { font-family: sans-serif; }
                                .bill-container { max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc; }
                                .bill-header { text-align: center; margin-bottom: 20px; }
                                .bill-item { display: flex; justify-content: space-between; padding: 5px 0; }
                                .bill-total { text-align: right; margin-top: 20px; font-weight: bold; }
                            </style>
                        </head>
                        <body>
                            <div class="bill-container">
                                <div class="bill-header">
                                    <h2>Lab Bill for ${a}</h2>
                                </div>
                                <div class="bill-items-list">
                                    ${l.map(F=>`
                                        <div class="bill-item">
                                            <span>${F.name}</span>
                                            <span>${F.total.toFixed(2)}</span>
                                        </div>
                                    `).join("")}
                                </div>
                                <div class="bill-total">
                                    Total: ${N.toFixed(2)}
                                </div>
                            </div>
                        </body>
                    </html>
                `;M.document.write(V),M.document.close(),M.print()}t()}catch(T){g(`Failed to process bill: ${T.message}`)}finally{v(!1)}};return i.jsxs("div",{className:"billing-layout",children:[i.jsx("main",{className:"order-content",children:i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),l.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PRICE"})]})}),i.jsx("tbody",{children:l.map((A,T)=>i.jsxs("tr",{children:[i.jsx("td",{children:T+1}),i.jsx("td",{children:A.name}),i.jsx("td",{children:A.total.toFixed(2)})]},T))})]}):i.jsx("p",{children:"No lab tests in this order."})]})}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",l.reduce((A,T)=>A+T.total,0).toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:o,onChange:A=>f(A.target.value),onBlur:A=>{A.target.value===""&&f(0)},min:"0",max:"100",className:"discount-input-total",disabled:b}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",N.toFixed(2)]})]}),h&&i.jsx("p",{className:"error-message",style:{color:"red",textAlign:"center"},children:h}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:u,onChange:A=>d(A.target.value),className:"payment-mode-select",disabled:b,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("div",{className:"bill-actions",children:i.jsx("button",{onClick:C,className:"primary-button",disabled:b||l.length===0,children:b?"Processing...":"Finalise and Bill"})})]})})]})},qee=()=>{const e=Mt(),n=_r(),{labOrderId:t}=n.state||{},[r,a]=w.useState(null),[l,o]=w.useState(""),[f,u]=w.useState(null),[d,h]=w.useState(null),[g,b]=w.useState(null),[v,N]=w.useState(!0),[C,A]=w.useState(null);w.useEffect(()=>{if(!t){console.error("LabBillingPage loaded without a labOrderId."),e("/");return}(async()=>{N(!0),A(null);try{const M=await ue(`/api/lab/${t}`);if(!M.ok){const z=await M.json().catch(()=>({}));throw new Error(z.message||`Failed to fetch lab order details (Status: ${M.status})`)}const V=await M.json(),F=(V.tests||[]).filter(z=>z&&typeof z.name=="string"&&z.price!==void 0&&z.id!==void 0).map(z=>{const B=parseFloat(z.price||"0"),U=!isNaN(B)&&isFinite(B)?B:0;return{drug_id:z.id,name:z.name,price:U,quantity:1,total:U,type:"lab_test"}});if(b(F),V.patient_id){a(V.patient_id);const z=await ue(`/api/patients/${V.patient_id}`);if(z.ok){const B=await z.json();o(B.name),u(B.phone??null),h(B.insurance_type??null)}else o("Patient (Not Found)")}else throw new Error("Lab order does not have an associated patient.")}catch(M){console.error("Error fetching lab billing details:",M),A(`Failed to load details: ${M.message}`)}finally{N(!1)}})()},[t,e]);const T=()=>{console.log(`Lab billing process completed for Lab Order ID: ${t}`),e(-1)};return t?v?i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Lab Bill..."})}):C?i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(eb,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Lab Bill"}),i.jsx("p",{className:"text-sm text-center mb-4",children:C}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]}):i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(an,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsx("div",{className:"billing-layout",children:i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," ",l]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Phone:"})," ",f||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Lab Order ID:"})," ",t]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Insurance:"})," ",d?d.replace(/_/g," "):"N/A"]})]})]}),r&&g&&i.jsx(Uee,{patientId:r,labOrderId:t,onBillingSuccess:T,initialItems:g,patientInsuranceType:d,patientName:l})]})})]})}):i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(eb,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Lab Order Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the lab billing page without a lab order ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]})},Vee=()=>{const{patientId:e}=qr(),n=Mt(),[t,r]=w.useState([]),[a,l]=w.useState(!1),[o,f]=w.useState(null),[u,d]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){f("Patient ID not provided in URL.");return}l(!0),f(null),r([]);try{try{const v=await ue(`/api/patients/${e}`);if(v.ok){const N=await v.json();d(N.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await ue(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),f(`Failed to load pharmacy orders: ${g.message}`)}finally{l(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(an,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(Ko,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",u&&`for ${u}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),o&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:o}),!a&&t.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(h=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(h.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",h.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",h.prescribedBy||"N/A"]}),h.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",h.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:h.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},h.id))})]})},tC=()=>{const e=Mt(),n=_r(),[t,r]=w.useState(null),[a,l]=w.useState([]),[o,f]=w.useState([]),[u,d]=w.useState(""),[h,g]=w.useState([]),[b,v]=w.useState(null),[N,C]=w.useState(!1),[A,T]=w.useState(null),[D,M]=w.useState(!0),[V,F]=w.useState(""),[z,B]=w.useState([]),[U,R]=w.useState(!1),[O,$]=w.useState(null),[W,te]=w.useState(!1),[ne,re]=w.useState(!1),[J,q]=w.useState([]),H=/^\+?[0-9\s\-().]{7,20}$/,ee=/^[a-zA-Z\s'-]{2,}$/,E=w.useCallback(async()=>{try{const je=await ue("/api/drugs");if(!je.ok)throw new Error("Failed to fetch drugs");const Ke=await je.json();l(Ke)}catch(je){console.error("Failed to fetch available drugs:",je),v("Could not load drug list. "+je.message)}},[]),Q=w.useCallback(async je=>{try{const Ke=await ue(`/api/pharmacy-orders/patient/${je}`);if(!Ke.ok){const ct=await Ke.json().catch(()=>({}));throw new Error(ct.message||`HTTP error! status: ${Ke.status}`)}const ze=await Ke.json();q(ze||[])}catch(Ke){console.error("Failed to fetch previous pharmacy orders:",Ke)}finally{}},[]);w.useEffect(()=>{var je;E(),(je=n.state)!=null&&je.patient?ce(n.state.patient):M(!0)},[E,n.state]),w.useEffect(()=>{t!=null&&t.id?Q(t.id):q([])},[t,Q]),w.useEffect(()=>{if(!u){g([]);return}const je=u.toLowerCase();g(a.filter(Ke=>{const ze=Ke.name&&Ke.name.toLowerCase().includes(je),ct=Ke.brand_name&&Ke.brand_name.toLowerCase().includes(je);return ze||ct}).slice(0,10))},[u,a]);const ie=w.useMemo(()=>Tb(async je=>{if(je.trim().length<2){B([]),R(!1),$(null);return}R(!0),$(null);try{const Ke=new URLSearchParams({search:encodeURIComponent(je),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),ze=await ue(`/api/patients?${Ke.toString()}`);if(!ze.ok)throw new Error("API Error");const ct=await ze.json();B(ct.patients)}catch(Ke){console.error("Error searching patients:",Ke),$(Ke.message||"Failed to search patients."),B([])}finally{R(!1)}},300),[H]),I=je=>{const Ke=je.target.value;F(Ke),te(H.test(Ke)),re(ee.test(Ke)&&!H.test(Ke)),R(!0),ie(Ke)},ce=w.useCallback(je=>{r(je),M(!1),F(""),B([]),$(null)},[]),xe=w.useCallback(async je=>{if(!V||je==="phone"&&!W||je==="name"&&!ne){$(`Invalid ${je} to create a new patient.`);return}R(!0),$(null);try{const ct=await(await ue("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:je==="name"?V:"direct pharmacy",phone:je==="phone"?V:null,age:null,gender:null,token:null})})).json();ce(ct)}catch(Ke){const ze=Ke.message||"";if(ze.toLowerCase().includes("patient limit")){e("/start-clinic-subscription",{state:{errorMessage:ze}});return}$(ze||"Failed to create new patient.")}finally{R(!1)}},[V,W,ne,ce]),le=()=>{r(null),M(!0),f([]),v(null),q([])},ge=je=>{if(!je)return null;const Ke=je.match(/(?:\d+x)?(\d+)/);return Ke?parseInt(Ke[1],10):null},ye=je=>{if(o.some(Ke=>Ke.drug_id===je.id)){v(`${je.name||je.brand_name} is already in the order.`),setTimeout(()=>v(null),3e3),d(""),g([]);return}f(Ke=>[...Ke,{drug_id:je.id,name:je.name||je.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,price:Number(je.price)||0,originalPrice:Number(je.price)||0,stock:je.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(je.price)||0)/(ge(je.unit)||1),unit:je.unit}]),d(""),g([])},Re=()=>{const je=u.trim();je&&e("/dashboard/inventory/add",{state:{initialDrugName:je}})},Ze=je=>{f(Ke=>Ke.filter(ze=>(ze.drug_id??ze.name)!==je))},at=(je,Ke)=>{f(ze=>ze.map(ct=>{if((ct.drug_id??ct.name)===je&&ct.isLoose){const Tt=ge(ct.unit),bt=parseInt(Ke,10),en=isNaN(bt)?Ke:Math.max(0,bt),oe=(isNaN(bt)?0:en)*(Tt??1)+(Number(ct.looseUnits)||0);return{...ct,loosePacks:en,looseQuantity:oe}}return ct}))},Le=je=>{f(Ke=>Ke.map(ze=>(ze.drug_id??ze.name)===je&&ze.loosePacks===""?{...ze,loosePacks:0}:ze))},Te=(je,Ke)=>{f(ze=>ze.map(ct=>{if((ct.drug_id??ct.name)===je&&ct.isLoose){const Tt=ge(ct.unit),bt=parseInt(Ke,10),en=isNaN(bt)?Ke:Math.max(0,bt),oe=(Number(ct.loosePacks)||0)*(Tt??1)+(isNaN(bt)?0:en);return{...ct,looseUnits:en,looseQuantity:oe}}return ct}))},we=je=>{f(Ke=>Ke.map(ze=>(ze.drug_id??ze.name)===je&&ze.looseUnits===""?{...ze,looseUnits:0}:ze))},Fe=je=>{const Ke=[];je.medications.forEach(ze=>{if(!o.find(Tt=>Tt.drug_id&&ze.drug_id&&Tt.drug_id===ze.drug_id||Tt.name.toLowerCase()===ze.name.toLowerCase())){let Tt=ze.drug_id,bt=ze.drug_id?a.find(en=>en.id===ze.drug_id):void 0;if(!bt&&ze.name){const en=a.find(oe=>oe.name&&oe.name.toLowerCase()===ze.name.toLowerCase());en?(Tt=en.id,bt=en):Tt&&(Tt=null)}Ke.push({drug_id:Tt,name:ze.name,pack_quantity:ze.pack_quantity??0,loose_quantity:ze.loose_quantity??0,directions_to_use:ze.directions_to_use,tabletsPerDay:ze.tabletsPerDay??1,numberOfDays:ze.numberOfDays??1,price:bt?bt.price:ze.price,stock:bt?bt.quantity_in_stock:ze.stock,isLoose:!0,loosePacks:0,looseUnits:(ze.pack_quantity??0)*(ge((bt==null?void 0:bt.unit)||ze.unit)??1)+(ze.loose_quantity??0),looseQuantity:(ze.pack_quantity??0)*(ge((bt==null?void 0:bt.unit)||ze.unit)??1)+(ze.loose_quantity??0),pricePerLooseUnit:(bt?Number(bt.price):Number(ze.price)||0)/(ge((bt==null?void 0:bt.unit)||ze.unit)||1),unit:(bt==null?void 0:bt.unit)||ze.unit})}}),f(ze=>[...ze,...Ke]),je.prescriptionForUnavailableDrugs&&(!A||!A.includes(je.prescriptionForUnavailableDrugs))&&T(ze=>ze?`${ze}

-- From previous order --
${je.prescriptionForUnavailableDrugs}`:je.prescriptionForUnavailableDrugs),v("Medications from previous order added."),setTimeout(()=>v(null),3e3)},Xe=async je=>{if(je.preventDefault(),v(null),C(!0),!t){v("No patient selected."),C(!1);return}if(o.length===0&&!(A!=null&&A.trim())){v("Add medication or prescription notes."),C(!1);return}const Ke={patient_id:t.id,items:o.map(ze=>{const ct=Number(ze.price??0),Tt=Number(ze.pricePerLooseUnit??0),bt=Number((Tt*(ze.looseQuantity??0)).toFixed(2));return{drug_id:ze.drug_id||null,name:ze.name,pack_quantity:Number(ze.loosePacks)||0,loose_quantity:Number(ze.looseUnits)||0,pack_price:ct,loose_price:Tt,total_price:bt,price:Number(ze.originalPrice??0),directions_to_use:ze.directions_to_use??null,tabletsPerDay:Number(ze.tabletsPerDay??1),numberOfDays:Number(ze.numberOfDays??1)}}),order_total:it,prescription_for_unavailable_drugs:A};try{const ze=await ue("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ke)});if(!ze.ok)throw new Error("Order creation failed");await ze.json(),alert(`Order created successfully for ${t.name}!`);let ct=t.queueId;if(!ct)try{const Tt=await ue(`/api/queue/patient/${t.id}/latest`);if(Tt.ok){const bt=await Tt.json();bt!=null&&bt._id&&(ct=bt._id)}}catch(Tt){console.error("Error checking queue:",Tt)}if(!ct)try{const Tt=await ue("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:t.id})});if(Tt.ok){const bt=await Tt.json();bt!=null&&bt.id&&(ct=bt.id)}}catch(Tt){console.error("Error creating queue:",Tt)}ct?e(`/dashboard/edit-complaint/${ct}`,{state:{patientId:t.id}}):e(-1)}catch(ze){v(ze.message||"Failed to create order.")}finally{C(!1)}},it=w.useMemo(()=>o.reduce((je,Ke)=>{const ze=Ke.isLoose?Ke.pricePerLooseUnit??0:Ke.price??0,ct=Ke.isLoose?Ke.looseQuantity??0:Ke.quantity??0;return je+ze*ct},0),[o]);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-8 max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:i.jsx(an,{size:20})}),i.jsx("h2",{children:"Create Pharmacy Order"})]})}),b&&i.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-4 rounded-xl mb-6 flex items-start gap-3 animate-fade-in",children:[i.jsx(ni,{className:"shrink-0 mt-0.5",size:18}),i.jsx("span",{children:b})]}),D&&i.jsx("div",{className:"max-w-2xl mx-auto mt-10",children:i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(to,{size:20,className:"text-indigo-400"})," Select Patient"]}),i.jsxs("div",{className:"patient-search-container",children:[i.jsxs("div",{className:"pharmacy-search-bar",children:[i.jsx(Ci,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token # or Phone...",value:V,onChange:I,className:"pharmacy-search-input",autoFocus:!0}),U&&i.jsx("div",{className:"pr-4 text-xs text-indigo-400 animate-pulse",children:"Searching..."})]}),O&&i.jsx("p",{className:"text-red-400 text-sm mt-2 pl-1 animate-fadeIn",children:O}),z.length>0&&i.jsx("div",{className:"search-results-dropdown",children:z.map(je=>i.jsxs("div",{onClick:()=>ce(je),className:"search-result-item",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("span",{className:"text-white font-medium flex items-center",children:[i.jsxs("span",{className:"token-badge",children:["#",je.token]}),je.name]}),i.jsxs("span",{className:"text-xs text-gray-400 mt-1 pl-1",children:[je.gender,"  ",je.age," yrs  ",je.phone||"No phone"]})]}),i.jsx(Zx,{size:16,className:"text-gray-600 -rotate-90"})]},je.id))}),!U&&V.length>2&&z.length===0&&i.jsxs("div",{className:"mt-4 p-4 bg-zinc-800/50 rounded-lg text-center border border-dashed border-zinc-700",children:[i.jsxs("p",{className:"text-gray-400 mb-3 text-sm",children:['No patient found matching "',V,'"']}),i.jsxs("div",{className:"flex justify-center gap-3",children:[W&&i.jsx("button",{onClick:()=>xe("phone"),className:"px-4 py-2 bg-green-600/20 text-green-400 border border-green-600/50 rounded-lg text-sm hover:bg-green-600/30 transition-colors",children:"Create with Phone"}),ne&&i.jsx("button",{onClick:()=>xe("name"),className:"px-4 py-2 bg-indigo-600/20 text-indigo-400 border border-indigo-600/50 rounded-lg text-sm hover:bg-indigo-600/30 transition-colors",children:"Create with Name"})]})]})]})]})}),!D&&t&&i.jsxs("form",{onSubmit:Xe,className:"pharmacy-order-grid animate-fade-in",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel mb-6",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ci,{size:18,className:"text-indigo-400"})," Add Medication"]}),i.jsxs("div",{className:"relative drug-search-container",children:[i.jsxs("div",{className:"pharmacy-search-bar",children:[i.jsx(Ci,{className:"search-icon",size:18}),i.jsx("input",{type:"text",placeholder:"Search for drugs...",value:u,onChange:je=>d(je.target.value),className:"pharmacy-search-input"})]}),h.length>0&&i.jsx("div",{className:"search-results-dropdown",children:h.map(je=>i.jsx("div",{onClick:()=>ye(je),className:"search-result-item",children:i.jsxs("div",{className:"flex justify-between w-full",children:[i.jsxs("div",{children:[i.jsx("span",{className:"drug-name",children:je.name||je.brand_name}),i.jsxs("span",{className:"drug-meta text-xs",children:["Stock: ",je.quantity_in_stock]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("span",{className:"text-indigo-300 font-mono",children:["",Number(je.price).toFixed(2)]})})]})},je.id))}),u&&h.length===0&&!a.find(je=>{var Ke;return((Ke=je.name)==null?void 0:Ke.toLowerCase())===u.toLowerCase()})&&i.jsx("div",{className:"search-results-dropdown p-2",children:i.jsxs("button",{type:"button",onClick:Re,className:"w-full text-left px-4 py-2 text-indigo-400 hover:bg-zinc-800 rounded-lg text-sm transition-colors",children:['+ Add "',u,'" to Inventory']})})]})]}),i.jsxs("div",{className:"content-panel min-h-[400px]",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Xo,{size:18,className:"text-indigo-400"})," Order Items (",o.length,")"]}),o.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx(Xo,{size:48,className:"empty-icon mx-auto",strokeWidth:1}),i.jsx("p",{className:"empty-text",children:"No medications added yet"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Search above to add items to the order"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"30%"},children:"Drug Name"}),i.jsx("th",{children:"Dosage / Directions"}),i.jsx("th",{children:"Qty (Packs/Loose)"}),i.jsx("th",{children:"Price"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:o.map((je,Ke)=>{const ze=je.drug_id??je.name,ct=(je.pricePerLooseUnit??0)*(je.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsxs("td",{children:[i.jsx("span",{className:"drug-name",children:je.name}),i.jsxs("span",{className:"drug-meta",children:["Stock: ",je.stock,"  Box of ",ge(je.unit)||1]})]}),i.jsx("td",{children:i.jsx("div",{className:"flex flex-col gap-2",children:i.jsx("input",{type:"text",placeholder:"Directions...",value:je.directions_to_use||"",onChange:Tt=>{const bt=Tt.target.value;f(en=>en.map(oe=>(oe.drug_id??oe.name)===ze?{...oe,directions_to_use:bt}:oe))},className:"table-input w-full"})})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Pks:"}),i.jsx("input",{type:"number",min:"0",value:je.loosePacks,onChange:Tt=>at(ze,Tt.target.value),onBlur:()=>Le(ze),className:"table-input medium"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Unit:"}),i.jsx("input",{type:"number",min:"0",value:je.looseUnits,onChange:Tt=>Te(ze,Tt.target.value),onBlur:()=>we(ze),className:"table-input medium"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono text-sm",children:["",ct.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>Ze(ze),className:"delete-btn opacity-0 group-hover:opacity-100",title:"Remove Item",children:i.jsx(Pi,{size:16})})})]},`${ze}-${Ke}`)})})]})})]}),i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ea,{size:18,className:"text-indigo-400"})," Additional Notes / Prescription"]}),i.jsx("textarea",{value:A??"",onChange:je=>T(je.target.value||null),placeholder:"Enter notes for unavailable drugs or special instructions...",className:"custom-text-input bg-zinc-900/50 min-h-[100px] border border-zinc-800 rounded-lg resize-y"})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"patient-card mb-6",children:[i.jsx("div",{className:"patient-avatar",children:t.name.charAt(0).toUpperCase()}),i.jsx("h3",{className:"patient-name",children:t.name}),i.jsx("div",{className:"patient-meta",children:i.jsxs("span",{children:["Token: #",t.token]})}),i.jsxs("div",{className:"patient-detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Age / Gender"}),i.jsxs("p",{children:[t.age||"--"," / ",t.gender||"--"]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Phone"}),i.jsx("p",{children:t.phone||"--"})]})]}),i.jsx("button",{type:"button",onClick:le,className:"change-patient-btn",children:"Change Patient"})]}),J.length>0&&i.jsxs("div",{className:"content-panel mb-6 p-4",children:[i.jsxs("div",{className:"section-title text-sm mb-3",children:[i.jsx(eM,{size:16,className:"text-indigo-400"})," Recent Orders"]}),i.jsx("div",{className:"max-h-[200px] overflow-y-auto pr-1 custom-scrollbar",children:J.map(je=>i.jsxs("div",{className:`prev-order-item status-${je.status}`,children:[i.jsxs("div",{className:"prev-order-header",children:[i.jsx("span",{className:"prev-order-date",children:new Date(je.date).toLocaleDateString()}),i.jsx("span",{className:`status-badge ${je.status}`,children:je.status})]}),i.jsx("div",{className:"text-xs text-gray-500 mb-2 truncate",children:je.medications.map(Ke=>Ke.name).join(", ")}),i.jsx("button",{type:"button",onClick:()=>Fe(je),className:"add-prev-btn",children:"+ Add items"})]},je.id))})]}),i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Dh,{size:18,className:"text-indigo-400"})," Summary"]}),i.jsx("div",{className:"summary-details",children:i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Items"}),i.jsx("span",{children:o.length})]})}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",it.toFixed(2)]})]}),i.jsxs("button",{type:"submit",disabled:N||o.length===0&&!A,className:"create-order-btn",children:[N?i.jsx("div",{className:"spinner"}):i.jsx(tg,{size:20}),N?"Processing...":"Create Order"]})]})]})]})]})},wE=()=>{const{orderId:e}=qr(),n=Mt(),[t,r]=w.useState(null),[a,l]=w.useState(null),[o,f]=w.useState([]),[u,d]=w.useState([]),[h,g]=w.useState(""),[b,v]=w.useState([]),[N,C]=w.useState(null),[A,T]=w.useState(!1),[D,M]=w.useState(null),[V,F]=w.useState(!0),z=H=>{if(!H)return null;const ee=H.match(/(?:\d+x)?(\d+)/);return ee?parseInt(ee[1],10):null},B=w.useCallback(async()=>{F(!0);try{const H=await ue(`/api/pharmacy-orders/${e}`);if(!H.ok)throw new Error("Failed to fetch order details");const ee=await H.json();r(ee),l({id:ee.patientId,name:ee.patientName||"N/A",token:ee.patientTokenNumber}),M(ee.prescriptionForUnavailableDrugs);const E=ee.medications.map(Q=>{const ie=z(Q.unit),I=Q.pack_quantity*(ie??1)+Q.loose_quantity;return{...Q,isLoose:!0,loosePacks:Q.pack_quantity,looseUnits:Q.loose_quantity,looseQuantity:I,pack_price:Q.pack_price,loose_price:Q.loose_price,total_price:Q.total_price,pricePerLooseUnit:Q.loose_price,originalPrice:Q.pack_price,box_number:Q.box_number,unit:Q.unit,batch:Q.batch,expiry_date:Q.expiry_date,discount_percentage:Q.discount_percentage}});d(E)}catch(H){C("Could not load order details. "+H.message)}finally{F(!1)}},[e]),U=w.useCallback(async()=>{try{const H=await ue("/api/drugs");if(!H.ok)throw new Error("Failed to fetch drugs");const ee=await H.json();f(ee)}catch(H){C("Could not load drug list. "+H.message)}},[]);w.useEffect(()=>{B(),U()},[B,U]),w.useEffect(()=>{if(!h){v([]);return}const H=h.toLowerCase();v(o.filter(ee=>{const E=ee.name&&ee.name.toLowerCase().includes(H),Q=ee.brand_name&&ee.brand_name.toLowerCase().includes(H);return E||Q}).slice(0,10))},[h,o]);const R=H=>{if(u.some(ee=>ee.drug_id===H.id)){C(`${H.name||H.brand_name} is already in the order.`),setTimeout(()=>C(null),3e3),g(""),v([]);return}d(ee=>[...ee,{drug_id:H.id,name:H.name||H.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(H.price)||0,loose_price:(Number(H.price)||0)/(z(H.unit)||1),total_price:(Number(H.price)||0)/(z(H.unit)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:H.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(H.price)||0)/(z(H.unit)||1),originalPrice:Number(H.price)||0,unit:H.unit}]),g(""),v([])},O=H=>{d(ee=>ee.filter(E=>(E.drug_id??E.name)!==H))},$=(H,ee)=>{d(E=>E.map(Q=>{if((Q.drug_id??Q.name)===H&&Q.isLoose){const ie=z(Q.unit),I=parseInt(ee,10),ce=isNaN(I)?ee:Math.max(0,I),xe=(isNaN(I)?0:ce)*(ie??1)+(Number(Q.looseUnits)||0);return{...Q,loosePacks:ce,looseQuantity:xe,pack_quantity:isNaN(I)?0:ce}}return Q}))},W=H=>{d(ee=>ee.map(E=>(E.drug_id??E.name)===H&&E.loosePacks===""?{...E,loosePacks:0}:E))},te=(H,ee)=>{d(E=>E.map(Q=>{if((Q.drug_id??Q.name)===H&&Q.isLoose){const ie=z(Q.unit),I=parseInt(ee,10),ce=isNaN(I)?ee:Math.max(0,I),xe=(Number(Q.loosePacks)||0)*(ie??1)+(isNaN(I)?0:ce);return{...Q,looseUnits:ce,looseQuantity:xe,loose_quantity:isNaN(I)?0:ce}}return Q}))},ne=H=>{d(ee=>ee.map(E=>(E.drug_id??E.name)===H&&E.looseUnits===""?{...E,looseUnits:0}:E))},re=w.useMemo(()=>u.reduce((H,ee)=>{const E=ee.loose_price??0,Q=ee.looseQuantity??0;return H+E*Q},0),[u]),J=(Number(re)||0).toFixed(2),q=async H=>{if(H.preventDefault(),C(null),T(!0),u.length===0&&!(D!=null&&D.trim())){C("Please add at least one medication or provide a prescription."),T(!1);return}const ee={items:u.map(E=>({drug_id:E.drug_id??null,name:E.name,pack_quantity:Number(E.loosePacks)||0,loose_quantity:Number(E.looseUnits)||0,pack_price:E.pack_price??0,loose_price:E.loose_price??0,total_price:(E.loose_price??0)*(E.looseQuantity??0),discount_percentage:E.discount_percentage??0,directions_to_use:E.directions_to_use??null,tabletsPerDay:E.tabletsPerDay??1,numberOfDays:E.numberOfDays??1})),prescription_for_unavailable_drugs:D,order_total:re};try{if(!(await ue(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})).ok)throw new Error("Failed to update order");alert("Pharmacy order updated successfully!"),n(-1)}catch(E){C(E.message||"Failed to update order.")}finally{T(!1)}};return V?i.jsx("div",{className:"add-pharmacy-order-page flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"spinner mb-4 mx-auto"}),i.jsx("p",{className:"text-gray-400 animate-pulse",children:"Loading order details..."})]})}):t?i.jsxs("div",{className:"add-pharmacy-order-page max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header px-4 md:px-8",children:i.jsxs("div",{className:"flex items-center justify-between w-full",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(an,{size:20})}),i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h2",{className:"m-0 bg-transparent -webkit-text-fill-color-current text-indigo-500 font-bold text-lg md:text-xl",children:"Edit Order"}),i.jsx("span",{className:"text-gray-400 font-light px-2 hidden md:block",children:"|"}),i.jsxs("div",{className:"header-patient-info flex items-center gap-2",children:[i.jsx("span",{className:"text-slate-800 dark:text-gray-200 font-bold text-lg md:text-xl",children:a==null?void 0:a.name}),i.jsxs("span",{className:"bg-indigo-500/10 text-indigo-400 px-2.5 py-0.5 rounded-full font-bold text-xs",children:["#",(a==null?void 0:a.token)||"N/A"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[i.jsx(Ud,{size:12,className:"text-gray-500"}),i.jsxs("span",{className:"text-xs text-gray-500",children:["Order Date: ",new Date(t.date).toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"})]})]})]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx("span",{className:`status-badge ${t.status}`,children:t.status})})]})}),i.jsxs("form",{onSubmit:q,className:"pharmacy-order-grid animate-fade-in px-4 md:px-8",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel search-panel mb-8",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ci,{size:20,className:"text-indigo-400"}),i.jsx("span",{children:"Find & Add Medication"})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"pharmacy-search-bar",children:[i.jsx(Ci,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by name or brand...",value:h,onChange:H=>g(H.target.value),className:"pharmacy-search-input"})]}),b.length>0&&i.jsx("div",{className:"search-results-dropdown",children:b.map(H=>i.jsxs("div",{onClick:()=>R(H),className:"search-result-item",children:[i.jsxs("div",{children:[i.jsx("div",{className:"drug-name-result",children:H.name||H.brand_name}),i.jsxs("div",{className:"drug-stock-result flex items-center gap-1",children:[i.jsx(Ko,{size:12})," Stock: ",H.quantity_in_stock]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"text-indigo-400 font-bold",children:["",Number(H.price).toFixed(2)]}),i.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-tighter",children:"per unit"})]})]},H.id))})]})]}),i.jsxs("div",{className:"content-panel min-h-[450px]",children:[i.jsx("div",{className:"section-title flex justify-between items-center",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Xo,{size:20,className:"text-indigo-400"}),i.jsx("span",{children:"Medications in Order"}),i.jsxs("span",{className:"bg-indigo-500/10 text-indigo-400 text-xs px-2 py-0.5 rounded-full ml-2",children:[u.length," items"]})]})}),u.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"p-6 bg-indigo-500/5 rounded-full mb-4",children:i.jsx(Xo,{size:48,className:"empty-icon",strokeWidth:1})}),i.jsx("p",{className:"empty-text",children:"No medications added yet"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Search and add drugs from the panel above"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"35%"},children:"Medication"}),i.jsx("th",{style:{width:"25%"},children:"Directions"}),i.jsx("th",{style:{width:"25%"},children:"Quantity"}),i.jsx("th",{style:{width:"10%"},children:"Subtotal"}),i.jsx("th",{style:{width:"5%"}})]})}),i.jsx("tbody",{children:u.map((H,ee)=>{const E=H.drug_id??H.name,Q=(H.loose_price??0)*(H.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsx("td",{children:i.jsxs("div",{className:"drug-info-cell",children:[i.jsx("span",{className:"drug-name",children:H.name}),i.jsxs("div",{className:"drug-meta",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ko,{size:12})," Stock: ",H.stock]}),i.jsx("span",{className:"text-gray-600",children:""}),i.jsxs("span",{className:"flex items-center gap-1 text-xs px-1.5 py-0.5 bg-zinc-800 rounded",children:["BOX OF ",z(H.unit)||1]})]})]})}),i.jsx("td",{children:i.jsx("input",{type:"text",placeholder:"e.g. 1-0-1 after food",value:H.directions_to_use||"",onChange:ie=>{const I=ie.target.value;d(ce=>ce.map(xe=>(xe.drug_id??xe.name)===E?{...xe,directions_to_use:I}:xe))},className:"table-input"})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"qty-label",children:"PACKS"}),i.jsx("input",{type:"number",min:"0",value:H.loosePacks,onChange:ie=>$(E,ie.target.value),onBlur:()=>W(E),className:"table-input"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"qty-label",children:"UNITS"}),i.jsx("input",{type:"number",min:"0",value:H.looseUnits,onChange:ie=>te(E,ie.target.value),onBlur:()=>ne(E),className:"table-input"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono font-bold text-indigo-400",children:["",Q.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>O(E),className:"delete-btn",title:"Remove Item",children:i.jsx(Pi,{size:16})})})]},`${E}-${ee}`)})})]})})]}),i.jsxs("div",{className:"content-panel mt-8",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(ks,{size:18,className:"text-indigo-400"}),i.jsx("span",{children:"Additional Prescription Notes"})]}),i.jsx("textarea",{rows:3,value:D??"",onChange:H=>M(H.target.value||null),placeholder:"Add notes about unavailable drugs, special instructions, etc...",className:"table-input w-full resize-none min-h-[100px]"})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Dh,{size:20,className:"text-indigo-400"}),i.jsx("span",{children:"Billing Summary"})]}),i.jsxs("div",{className:"summary-details",children:[i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Medications Count"}),i.jsx("span",{className:"text-slate-700 dark:text-gray-200 font-bold",children:u.length})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Tax (Inc.)"}),i.jsx("span",{className:"text-slate-700 dark:text-gray-200",children:"0.00"})]})]}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",J]})]}),N&&i.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl flex items-start gap-3 text-sm text-red-400 animate-pulse mt-4",children:[i.jsx(ni,{size:18,className:"shrink-0"}),i.jsx("span",{children:N})]}),i.jsxs("button",{type:"submit",disabled:A,className:`floating-action-btn w-full mt-6 py-4 rounded-xl font-bold flex items-center justify-center gap-2 ${A?"opacity-70 cursor-not-allowed":""}`,style:{position:"relative",bottom:"auto",right:"auto"},children:[A?i.jsx("div",{className:"spinner"}):i.jsx(tg,{size:22}),A?"Updating Order...":"Confirm Changes"]})]}),i.jsx("p",{className:"px-4 text-xs text-gray-500 text-center leading-relaxed",children:"By updating this order, stock levels will be adjusted accordingly once the order is dispensed."})]})]})]}):i.jsx("div",{className:"add-pharmacy-order-page flex items-center justify-center",children:i.jsxs("div",{className:"content-panel text-center max-w-md",children:[i.jsx(ni,{size:48,className:"text-red-500 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-bold mb-2",children:"Order Not Found"}),i.jsx("p",{className:"text-gray-400 mb-6",children:"We couldn't find the pharmacy order you're looking for."}),i.jsx("button",{onClick:()=>n(-1),className:"back-button mx-auto",children:i.jsx(an,{size:20})})]})})},Hee=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Gee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},Yee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Wee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Qee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},Jee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},nC=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),iC=()=>{var ne,re,J;const{orderId:e}=qr(),n=Mt(),[t,r]=w.useState(null),[a,l]=w.useState({}),[o,f]=w.useState(!0),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),[N,C]=w.useState(null),[A,T]=w.useState({}),[D,M]=w.useState(null),V=q=>{const H=document.querySelector(`[data-test-id='${q}']`);H&&(document.body.classList.add("printing-single-test"),H.classList.add("printing"),window.print())};w.useEffect(()=>{const q=()=>{document.body.classList.remove("printing-single-test");const H=document.querySelector(".printing");H&&H.classList.remove("printing")};return window.addEventListener("afterprint",q),()=>{window.removeEventListener("afterprint",q)}},[]);const F=()=>{t&&ww(t)},z=w.useCallback(async q=>{var H;try{const ee=await ue(`/api/patients/${q}`);if(!ee.ok)throw new Error(`Failed to fetch patient details: ${ee.status}`);const E=await ee.json();v(E.age),C(((H=E.sex)==null?void 0:H.toLowerCase())==="female"?"female":"male")}catch(ee){console.error("Error fetching patient details:",ee),v(null),C(null)}},[]),B=w.useCallback(async()=>{if(e){f(!0),g(null);try{const q=await ue(`/api/lab/${e}`);if(!q.ok){const E=await q.json().catch(()=>({message:`HTTP error! status: ${q.status}`}));throw new Error(E.message||`HTTP error! status: ${q.status}`)}const H=await q.json();r(H),H.patient_id&&z(H.patient_id);const ee={};if(H.tests&&H.tests.forEach(E=>{ee[E.id]={},E.default_parameters&&E.default_parameters.length>0?E.default_parameters.forEach(Q=>{ee[E.id][Q.name]=Q.defaultValue}):ee[E.id].report_content=""}),H.report_content)try{const E=JSON.parse(H.report_content);if(typeof E=="object"&&E!==null&&!Array.isArray(E)){const Q={...ee};Object.keys(E).forEach(ie=>{Q[ie]?Q[ie]={...Q[ie],...E[ie]}:Q[ie]=E[ie]}),l(Q)}else console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),l(ee)}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),l(ee)}else l(ee)}catch(q){console.error("Failed to fetch lab order details:",q),g(q instanceof Error?q.message:"An unknown error occurred while fetching order details.")}finally{f(!1)}}},[e,z]);w.useEffect(()=>{e?B():(g("No Order ID provided in the URL."),f(!1))},[e,B]);const U=(q,H,ee)=>{l(E=>{var it,je,Ke,ze,ct,Tt,bt,en,oe,K,fe,Ae,Ie,Ye,ft,gt,jt,$e,nt;const Q={...E,[q]:{...E[q],[H]:ee}},ie=parseFloat((it=Q[q])==null?void 0:it.Creatinine),I=b,ce=N;if(H==="Creatinine"&&!isNaN(ie)&&I!==null&&ce!==null){const Ve=Hee(ie,I,ce);Ve!==null&&((je=t==null?void 0:t.tests.find(Se=>Se.id===q))!=null&&je.default_parameters.find(Se=>Se.name==="eGFR"))&&(Q[q].eGFR=Ve)}const xe=parseFloat((Ke=Q[q])==null?void 0:Ke["Total Cholesterol"]),le=parseFloat((ze=Q[q])==null?void 0:ze["HDL Cholesterol"]),ge=parseFloat((ct=Q[q])==null?void 0:ct.Triglycerides);if((H==="Total Cholesterol"||H==="HDL Cholesterol"||H==="Triglycerides")&&!isNaN(xe)&&!isNaN(le)&&!isNaN(ge)){const Ve=Gee(xe,le,ge);Ve!==null&&((Tt=t==null?void 0:t.tests.find(Se=>Se.id===q))!=null&&Tt.default_parameters.find(Se=>Se.name==="LDL Cholesterol"))&&(Q[q]["LDL Cholesterol"]=Ve)}const ye=parseFloat((bt=Q[q])==null?void 0:bt["Total Bilirubin"]),Re=parseFloat((en=Q[q])==null?void 0:en["Direct Bilirubin"]);if((H==="Total Bilirubin"||H==="Direct Bilirubin")&&!isNaN(ye)&&!isNaN(Re)){const Ve=Yee(ye,Re);Ve!==null&&((oe=t==null?void 0:t.tests.find(Se=>Se.id===q))!=null&&oe.default_parameters.find(Se=>Se.name==="Indirect Bilirubin"))&&(Q[q]["Indirect Bilirubin"]=Ve)}const Ze=parseFloat((K=Q[q])==null?void 0:K["Total Protein"]),at=parseFloat((fe=Q[q])==null?void 0:fe.Albumin);if((H==="Total Protein"||H==="Albumin")&&!isNaN(Ze)&&!isNaN(at)){const Ve=Wee(Ze,at);Ve!==null&&((Ae=t==null?void 0:t.tests.find(Se=>Se.id===q))!=null&&Ae.default_parameters.find(Se=>Se.name==="Globulin"))&&(Q[q].Globulin=Ve)}const Le=parseFloat((Ie=Q[q])==null?void 0:Ie.Sodium),Te=parseFloat((Ye=Q[q])==null?void 0:Ye.Chloride),we=parseFloat((ft=Q[q])==null?void 0:ft.Bicarbonate);if((H==="Sodium"||H==="Chloride"||H==="Bicarbonate")&&!isNaN(Le)&&!isNaN(Te)&&!isNaN(we)){const Ve=Qee(Le,Te,we);Ve!==null&&((gt=t==null?void 0:t.tests.find(Se=>Se.id===q))!=null&&gt.default_parameters.find(Se=>Se.name==="Anion Gap"))&&(Q[q]["Anion Gap"]=Ve)}const Fe=parseFloat((jt=Q[q])==null?void 0:jt.Glucose),Xe=parseFloat(($e=Q[q])==null?void 0:$e.BUN);if((H==="Sodium"||H==="Glucose"||H==="BUN")&&!isNaN(Le)&&!isNaN(Fe)&&!isNaN(Xe)){const Ve=Jee(Le,Fe,Xe);Ve!==null&&((nt=t==null?void 0:t.tests.find(Se=>Se.id===q))!=null&&nt.default_parameters.find(Se=>Se.name==="Osmolality"))&&(Q[q].Osmolality=Ve)}return Q})},R=async(q,H)=>{if(!e){alert("Cannot submit report without an Order ID.");return}if(!a[q]||Object.keys(a[q]).length===0){alert(`Please enter data for ${H} before saving.`);return}M(q),g(null);try{const E={...t!=null&&t.report_content?JSON.parse(t.report_content):{}};E[q]=a[q];const Q=await ue(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(E)})});if(!Q.ok){const ie=await Q.json().catch(()=>({message:`Submission failed: ${Q.status}`}));throw new Error(ie.message||`Submission failed: ${Q.status}`)}t&&r({...t,report_content:JSON.stringify(E)}),alert(`Report for ${H} saved successfully!`)}catch(ee){console.error(`Error submitting report for ${H}:`,ee),alert(`Failed to save report for ${H}: ${ee instanceof Error?ee.message:"Unknown error"}`)}finally{M(null)}},O=async()=>{if(Object.keys(a).length===0){alert("Report content cannot be empty.");return}if(!e){alert("Cannot submit report without an Order ID.");return}d(!0),g(null);try{const q=await ue(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(a)})});if(!q.ok){const H=await q.json().catch(()=>({message:`Submission failed: ${q.status}`}));throw new Error(H.message||`Submission failed: ${q.status}`)}alert("Report submitted successfully!"),n(-1)}catch(q){console.error("Error submitting report:",q),g(q instanceof Error?q.message:"An unknown error occurred during submission.")}finally{d(!1)}};if(o)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(Rh,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(h&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(ni,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:h}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(ks,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const $=(ne=t==null?void 0:t.Patient)==null?void 0:ne.name,W=(re=t==null?void 0:t.Patient)==null?void 0:re.patient_token_number,te=`Enter Report for Order #${(t==null?void 0:t.lab_token_number)??e}`;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:te})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button",disabled:u,"aria-label":"Print report",children:[i.jsx(il,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:F,className:"lab-inventory-button",disabled:u||!((J=t==null?void 0:t.Patient)!=null&&J.phone)||!(t!=null&&t.report_content),"aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(FC,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:u,children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),t&&i.jsxs("div",{className:"lab-inventory-card printable-section patient-info-section",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(ks,{size:18,className:"no-print",style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(to,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",$??"N/A"," (Token: ",W??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(Ea,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Token:"})," ",t.lab_token_number??"N/A"]}),i.jsxs("div",{children:[i.jsx(MD,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",Bh(new Date(t.createdAt),"PPpp")]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(xM,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(q=>q.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:Xee(t.status),children:Kee(t.status)})]})]})]}),i.jsxs("div",{className:"printable-section",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(Ea,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),"Lab Report"]}),t==null?void 0:t.tests.map(q=>{var H;return i.jsxs("div",{"data-test-id":q.id,className:"lab-inventory-card test-report-container",style:{marginBottom:"15px"},children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:q.name}),i.jsx("div",{className:"no-print",style:{display:"flex",gap:"10px"},children:i.jsx("button",{onClick:()=>V(q.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${q.name}`,children:i.jsx(il,{size:16})})})]}),q.default_parameters&&q.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:q.default_parameters.map(ee=>{var ce,xe,le;const E=(ce=a[q.id])==null?void 0:ce[ee.name],Q=typeof E=="string"?parseFloat(E):typeof E=="number"?E:NaN,ie=ee.type==="number"&&!isNaN(Q)&&E!==""&&E!==null&&E!==void 0&&(ee.lower_limit!=null&&Q<ee.lower_limit||ee.upper_limit!=null&&Q>ee.upper_limit),I=ee.type==="boolean"&&(E===!0||E==="true");return i.jsxs("tr",{children:[i.jsxs("td",{style:{fontWeight:"500"},children:[ee.name,ee.unit&&i.jsxs("span",{style:{color:"#6b7280",fontSize:"0.9em"},children:[" (",ee.unit,")"]})]}),i.jsxs("td",{className:`${ie?"abnormal-result":""} ${I?"reactive-result":""}`,children:[i.jsxs("div",{className:"no-print",children:[ee.type==="boolean"?i.jsxs("select",{id:`${q.id}-${ee.name}`,value:(E==null?void 0:E.toString())??"false",onChange:ge=>U(q.id,ee.name,ge.target.value==="true"),className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:u,children:[i.jsx("option",{value:"false",children:"Non-Reactive"}),i.jsx("option",{value:"true",children:"Reactive"})]}):i.jsx("input",{id:`${q.id}-${ee.name}`,type:ee.type==="number"?"number":"text",value:E??"",onChange:ge=>{U(q.id,ee.name,ge.target.value)},onBlur:ge=>{ee.type==="number"&&ge.target.value===""&&U(q.id,ee.name,0)},className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:u||nC(ee.name)&&!((xe=A[q.id])!=null&&xe[ee.name]),placeholder:`Enter ${ee.name.toLowerCase()}`}),nC(ee.name)&&i.jsx("button",{type:"button",onClick:()=>T(ge=>{var ye;return{...ge,[q.id]:{...ge[q.id]||{},[ee.name]:!((ye=ge[q.id])!=null&&ye[ee.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.75em",padding:"3px 8px",marginTop:"5px"},disabled:u,children:(le=A[q.id])!=null&&le[ee.name]?"Lock":"Edit"})]}),i.jsx("span",{className:"print-only",children:ee.type==="boolean"?E===!0||E==="true"?"Reactive":"Non-Reactive":`${E??""} ${ee.unit??""}`})]}),i.jsx("td",{style:{color:"#6b7280",fontSize:"0.9em"},children:ee.type==="number"&&(ee.lower_limit!==null||ee.upper_limit!==null)?i.jsxs(i.Fragment,{children:[ee.lower_limit!=null&&`> ${ee.lower_limit}`,ee.lower_limit!=null&&ee.upper_limit!=null&&" - ",ee.upper_limit!=null&&`< ${ee.upper_limit}`,ee.unit&&` ${ee.unit}`]}):ee.type==="boolean"?"Non-Reactive":"N/A"})]},ee.name)})})]})}):i.jsxs("div",{className:"lab-inventory-form-group no-print",children:[i.jsx("label",{htmlFor:`${q.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${q.id}-report_content`,value:((H=a[q.id])==null?void 0:H.report_content)??"",onChange:ee=>U(q.id,"report_content",ee.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${q.name}...`,disabled:u})]}),i.jsx("div",{className:"no-print",style:{marginTop:"15px",textAlign:"right"},children:i.jsx("button",{type:"button",onClick:()=>R(q.id,q.name),disabled:u||D===q.id,className:"lab-inventory-button",style:{fontSize:"0.9em",padding:"8px 16px"},children:D===q.id?i.jsxs(i.Fragment,{children:[i.jsx(Rh,{className:"animate-spin mr-2",size:14})," Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(uu,{size:14,style:{marginRight:"5px"}})," Save ",q.name]})})})]},q.id)}),h&&i.jsxs("p",{className:"error-text no-print",style:{marginTop:"10px"},children:[i.jsx(ni,{size:15,className:"inline mr-1"}),h]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:u,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:O,disabled:u||Object.keys(a).length===0,className:"lab-inventory-button",children:u?i.jsxs(i.Fragment,{children:[i.jsx(Rh,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(uu,{size:16,style:{marginRight:"5px"}})," Submit All Reports"]})})]})]})})},Kee=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",Xee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},Zee=()=>{const{orderId:e}=qr(),n=Mt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),u=w.useCallback(async g=>{if(!g){f("No Order ID specified in the URL."),l(!1),r(null);return}l(!0),f(null),r(null);try{console.log(`Fetching order details for ID: ${g}`);const b=await ue(`/api/lab/orders/${g}/report`);if(!b.ok){let N;try{N=await b.json()}catch{N={message:`Server returned status ${b.status}`}}throw console.error("Fetch order details error response:",N),new Error(N.message||`Failed to fetch order details: ${b.status}`)}const v=await b.json();if(console.log("Received order data:",v),!v)throw console.error("Invalid order data structure:",v),new Error("Invalid order data received from server.");r(v)}catch(b){console.error("Error fetching order details:",b),f(b instanceof Error?b.message:"An unknown error occurred while fetching the order details")}finally{l(!1)}},[ue]);w.useEffect(()=>{u(e)},[e,u]);const d=g=>{const b=document.querySelector(`[data-test-id='${g}']`);b&&(document.body.classList.add("printing-single-test"),b.classList.add("printing"),window.print())};w.useEffect(()=>{const g=()=>{document.body.classList.remove("printing-single-test");const b=document.querySelector(".printing");b&&b.classList.remove("printing")};return window.addEventListener("afterprint",g),()=>{window.removeEventListener("afterprint",g)}},[]);const h=()=>{t&&ww(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(Ts,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(Ci,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(il,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:h,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(FC,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),o&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(ni,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:o}),e&&i.jsx("button",{onClick:()=>u(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!o&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(to,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!o&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Ea,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const g=JSON.parse(t.report_content||"{}");return typeof g=="object"&&g!==null&&t.tests?t.tests.map(b=>i.jsxs("div",{"data-test-id":b.id,className:"test-report-container",style:{marginBottom:"20px"},children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:b.name}),i.jsx("button",{onClick:()=>d(b.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${b.name}`,children:i.jsx(il,{size:16})})]}),g[b.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(g[b.id]).map(([v,N])=>{var V;const C=(V=b.default_parameters)==null?void 0:V.find(F=>F.name===v),A=typeof N=="string"?parseFloat(N):typeof N=="number"?N:NaN,T=(C==null?void 0:C.type)==="number"&&!isNaN(A)&&(C.lower_limit!=null&&A<C.lower_limit||C.upper_limit!=null&&A>C.upper_limit),D=(C==null?void 0:C.type)==="boolean"?N===!0||N==="true"?"Reactive":"Non-Reactive":String(N),M=(C==null?void 0:C.type)==="boolean"&&(N===!0||N==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:v}),i.jsxs("td",{className:`${T?"abnormal-result":""} ${M?"reactive-result":""}`,children:[D," ",C==null?void 0:C.unit]}),i.jsx("td",{children:C&&C.type==="number"&&(C.lower_limit!==null||C.upper_limit!==null)?i.jsxs(i.Fragment,{children:[C.lower_limit!=null&&` > ${C.lower_limit}`,C.lower_limit!=null&&C.upper_limit!=null&&" - ",C.upper_limit!=null&&` < ${C.upper_limit}`,C.unit&&` ${C.unit}`]}):((C==null?void 0:C.type)==="boolean","N/A")})]},v)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},b.id)):i.jsx(su,{remarkPlugins:[Go],children:t.report_content})}catch{return i.jsx(su,{remarkPlugins:[Go],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!o&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!o&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(Ts,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},ete=()=>{const e=Mt(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[l,o]=w.useState([]),[f,u]=w.useState(null),[d,h]=w.useState(n);w.useEffect(()=>{const C=setTimeout(()=>{h(n)},500);return()=>{clearTimeout(C)}},[n]),w.useEffect(()=>{g()},[d]);const g=async()=>{const C=n.trim();if(!C){o([]),u(null);return}a(!0),u(null),o([]),console.log(`Searching for: ${C}`);try{const A=await ue("/api/lab");if(!A.ok){let z;try{z=await A.json()}catch{z={message:`Server returned status ${A.status}`}}throw console.error("Search fetch error response:",z),new Error(z.message||`HTTP error! status: ${A.status}`)}const{orders:T}=await A.json();console.log("Received lab orders for search:",T);const M=T.filter(z=>!!z.report_content).map(z=>{var B,U;return{id:z.id,labTokenNumber:String(z.lab_token_number??"N/A"),patientName:((B=z.Patient)==null?void 0:B.name)||"N/A",patientId:z.patient_id,patientTokenNumber:String(((U=z.Patient)==null?void 0:U.patient_token_number)??"N/A"),tests:(z.tests||[]).map(R=>R.name||"Unknown Test"),date:Bh(new Date(z.createdAt),"yyyy-MM-dd"),status:z.status}}),V=n.toLowerCase(),F=M.filter(z=>{var R,O,$,W,te;const B=String(z.labTokenNumber).toLowerCase(),U=String(z.patientTokenNumber).toLowerCase();return(((R=z.patientName)==null?void 0:R.toLowerCase())||"").includes(V)||B.includes(V)||U.includes(V)||((($=(O=z.tests)==null?void 0:O.join(" "))==null?void 0:$.toLowerCase())||"").includes(V)||(((W=z.id)==null?void 0:W.toLowerCase())||"").includes(V)||(((te=z.patientId)==null?void 0:te.toLowerCase())||"").includes(V)});console.log("Filtered search results:",F),o(F),F.length===0&&C?u(`No matching reports found for "${C}".`):u(null)}catch(A){console.error("Failed to search lab reports:",A),u(A instanceof Error?A.message:"An unknown error occurred during search")}finally{a(!1)}},b=C=>{console.log(`Result clicked, navigating to view report for order ID: ${C}`),e(`/lab/view-report/${C}`)},v=C=>{switch(C){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:C,color:"text-gray-600 bg-gray-100"}}},N=C=>{switch(C){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(Ci,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:C=>t(C.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),f&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(ni,{size:20,className:"inline mr-2"})," ",f]}),l.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:l.map(C=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(C.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(JD,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),C.patientName," (Token: ",C.patientTokenNumber,")"]}),i.jsx("span",{className:N(C.status),children:v(C.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(Ea,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",C.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(oI,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",C.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(RD,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",C.date]})]})]},C.id))}),!r&&l.length===0&&!f&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&l.length===0&&!f&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},tte=()=>{const{patientId:e}=qr(),n=Mt(),[t,r]=w.useState([]),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){f("Patient ID is missing from the URL."),l(!1);return}l(!0),f(null),r([]),g(null);try{const N=await ue(`/api/patients/${e}`);if(N.ok){const T=await N.json();g(T.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const C=await ue(`/api/lab/patient/${e}`);if(!C.ok){const T=await C.json().catch(()=>({}));throw new Error(T.message||`HTTP error! status: ${C.status}`)}const A=await C.json();r(A||[])}catch(N){console.error("Error fetching data:",N),f(`Failed to load data: ${N.message}`)}finally{l(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",h?`for ${h}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await ue("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const C=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(C.message||`Failed to create new lab order: ${v.status}`)}const N=await v.json();n(`/lab/enter-report/${N.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(Yo,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(an,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(Rh,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):o?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(zC,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:o})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Ea,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(Ts,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):u?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",u.report_date?Bh(new Date(u.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>d(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(an,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(u.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(su,{remarkPlugins:[Go],children:u.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:N=>N.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(Ea,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Bh(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(N=>N.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:ite(v.status),children:nte(v.status)}),i.jsx(fg,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},nte=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},ite=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},NE=()=>{const e=Mt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[l,o]=w.useState(!1),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState("all"),v=10,N=1;w.useEffect(()=>{(async()=>{o(!0),u(null);try{console.log("Fetching pharmacy inventory for view page...");const T=await ue("/api/drugs");if(!T.ok)throw new Error(`HTTP error! status: ${T.status}`);const D=await T.json();console.log("Fetched Pharmacy Inventory for view page:",D),t(D||[])}catch(T){console.error("Error fetching pharmacy inventory:",T),u("Failed to load pharmacy inventory.")}finally{}})()},[]),w.useEffect(()=>{(async()=>{try{console.log("Fetching lab inventory for view page...");const T=await ue("/api/lab-tests");if(!T.ok)throw new Error(`HTTP error! status: ${T.status}`);const D=await T.json();console.log("Fetched Lab Inventory for view page:",D),a(D||[])}catch(T){console.error("Error fetching lab inventory:",T),u(D=>D?`${D} & Failed to load lab inventory.`:"Failed to load lab inventory.")}finally{o(!1)}})()},[]);const C=w.useMemo(()=>{let A=n;return d&&(A=A.filter(T=>T.name.toLowerCase().includes(d.toLowerCase()))),g!=="all"&&(A=A.filter(T=>{const D=(T.quantity_in_stock??1/0)<=v;let M=!1,V=!1;if(T.expiry_date)try{const F=ib(T.expiry_date);if(ig(F)){const z=Qv(new Date,N),B=new Date;B.setHours(0,0,0,0),V=$d(F,B),M=!V&&$d(F,z)}}catch(F){console.error("Error parsing expiry date for filter:",T.expiry_date,F),M=!0}else M=!0;switch(g){case"low-stock":return D;case"near-expiry":return M;case"expired":return V;default:return!0}})),A},[n,d,g]);return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"lab-inventory-header",children:[i.jsx("h1",{children:"Inventory Overview"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary",title:"Go Back",children:[i.jsx(an,{size:18,style:{marginRight:"5px"}})," Back"]})]}),l&&i.jsx("p",{className:"loading-text",children:"Loading inventory..."}),f&&i.jsx("p",{className:"error-text",children:f}),!l&&!f&&i.jsxs("div",{className:"inventory-sections-container",children:[i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("div",{className:"inventory-section__header-bar",children:[i.jsxs("h2",{className:"lab-inventory-header",children:[i.jsx(Xo,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Pharmacy Inventory"]}),i.jsxs("div",{className:"inventory-section__controls",children:[" ",i.jsxs("div",{className:"inventory-section__search-area",children:[i.jsx("input",{type:"text",placeholder:"Search drugs...",value:d,onChange:A=>h(A.target.value),className:"lab-inventory-input",style:{marginRight:"5px",marginBottom:"0"}}),i.jsx(Ci,{size:18,style:{color:"#777"}})]}),i.jsxs("div",{className:"inventory-section__filter-area",children:[" ",i.jsxs("select",{value:g,onChange:A=>b(A.target.value),className:"lab-inventory-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]})]}),C.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Stock"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Buying Price"}),i.jsx("th",{children:"Selling Price"})]})}),i.jsx("tbody",{children:C.map(A=>{let T="N/A",D="";const M=(A.quantity_in_stock??1/0)<=v;if(A.expiry_date)try{const V=ib(A.expiry_date);if(ig(V)){T=Bh(V,"dd/MM/yyyy");const F=Qv(new Date,1),z=new Date;z.setHours(0,0,0,0),$d(V,z)?D="highlight-expired":$d(V,F)&&(D="highlight-near-expiry")}else T="Invalid Date",D="highlight-near-expiry"}catch(V){console.error("Error parsing expiry date:",A.expiry_date,V),T="Error Parsing",D="highlight-near-expiry"}else D="highlight-near-expiry";return i.jsxs("tr",{children:[i.jsx("td",{children:A.name}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${M?"highlight-low-stock":""}`,children:A.quantity_in_stock??"N/A"})}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${D}`,children:T})}),i.jsx("td",{className:"price-text",children:A.buying_price?`${A.buying_price}`:"N/A"}),i.jsx("td",{className:"price-text",children:A.price?`${A.price}`:"N/A"})]},A.id)})})]})]})]}):i.jsx("p",{className:"no-data-message",children:d?`No drugs found matching "${d}".`:"No pharmacy inventory data available."})]}),i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("h2",{className:"lab-inventory-header inventory-section__lab-title",children:[i.jsx(rw,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Lab Test Inventory"]}),r.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"})]})}),i.jsx("tbody",{children:r.map(A=>i.jsxs("tr",{children:[i.jsx("td",{children:A.name}),i.jsx("td",{className:"price-text",children:A.price?`${A.price}`:"N/A"})]},A.id))})]})]})]}):i.jsx("p",{className:"no-data-message",children:"No lab test inventory data available."})]})]})]})},rte=({fetchWithAuth:e})=>{const n=Mt(),[t,r]=w.useState(!0),[a,l]=w.useState([]),[o,f]=w.useState(""),[u,d]=w.useState(null),[h,g]=w.useState(null),b=w.useCallback(async()=>{r(!0),d(null);try{const A=await(await e("/staff")).json();l(A.map(T=>({...T,id:T._id||T.id})))}catch(C){d(`Failed to load staff data: ${C.message}`),l([])}finally{r(!1)}},[e]);w.useEffect(()=>{b()},[b]),w.useEffect(()=>{if(h){const C=setTimeout(()=>g(null),5e3);return()=>clearTimeout(C)}},[h]);const v=a.filter(C=>C.name.toLowerCase().includes(o.toLowerCase())||C.email.toLowerCase().includes(o.toLowerCase())||C.role.toLowerCase().includes(o.toLowerCase())),N=C=>{switch(C){case"doctor":return{bg:"rgba(59, 130, 246, 0.1)",text:"#3b82f6",icon:i.jsx(sI,{size:14})};case"receptionist":return{bg:"rgba(16, 185, 129, 0.1)",text:"#10b981",icon:i.jsx(BC,{size:14})};case"pharmacy":return{bg:"rgba(139, 92, 246, 0.1)",text:"#8b5cf6",icon:i.jsx(Xo,{size:14})};case"lab":return{bg:"rgba(245, 158, 11, 0.1)",text:"#f59e0b",icon:i.jsx(Wv,{size:14})};case"admin":return{bg:"rgba(71, 85, 105, 0.1)",text:"#475569",icon:i.jsx(hg,{size:14})};default:return{bg:"rgba(203, 213, 225, 0.1)",text:"#64748b",icon:i.jsx(cu,{size:14})}}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-transparent",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"breathing-ball",style:{background:"var(--staff-primary)"}})}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Initialising Staff Records..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[h&&i.jsxs("div",{className:`mb-6 p-4 rounded-xl flex items-center animate-in slide-in-from-top-4 duration-300 ${h.type==="success"?"bg-emerald-50 text-emerald-700 border border-emerald-100":"bg-rose-50 text-rose-700 border border-rose-100"}`,children:[h.type==="success"?i.jsx(Ta,{size:20,className:"mr-3"}):i.jsx(ni,{size:20,className:"mr-3"}),i.jsx("span",{className:"font-medium",children:h.message})]}),u&&i.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-rose-50 text-rose-700 border border-rose-100 flex items-center",children:[i.jsx(ni,{size:20,className:"mr-3"}),i.jsx("span",{className:"font-medium",children:u})]}),i.jsxs("header",{className:"staff-header",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:i.jsx(an,{size:20})}),i.jsx("h1",{children:"Staff Management"})]}),i.jsx("p",{className:"subtitle",children:"Overview and manage your clinic's professional team."})]}),i.jsxs("div",{className:"staff-header-actions",children:[i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Search staff...",className:"pl-10 pr-4 py-2 bg-gray-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm focus:ring-2 focus:ring-teal-500 transition-all outline-none",value:o,onChange:C=>f(C.target.value)}),i.jsx(cu,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"staff-btn staff-btn-primary",children:[i.jsx(eo,{size:18})," ",i.jsx("span",{children:"Add Member"})]})]})]}),i.jsx("div",{className:"staff-table-wrapper",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Member"}),i.jsx("th",{className:"hidden lg:table-cell",children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"Consultation Fee"}),i.jsx("th",{className:"hidden sm:table-cell",children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:v.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-12",children:i.jsxs("div",{className:"flex flex-col items-center text-slate-400",children:[i.jsx(cu,{size:48,className:"mb-4 opacity-20"}),i.jsx("p",{className:"text-lg font-medium",children:"No staff members found"}),i.jsx("p",{className:"text-sm",children:"Try adjusting your search or add a new team member."})]})})}):v.map(C=>{const A=N(C.role);return i.jsxs("tr",{children:[i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-100",children:C.name}),i.jsx("span",{className:"text-xs text-slate-500",children:C.email})]})}),i.jsx("td",{className:"hidden lg:table-cell",children:i.jsxs("span",{className:"role-pill",style:{backgroundColor:A.bg,color:A.text},children:[A.icon,C.role.charAt(0).toUpperCase()+C.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:C.role==="doctor"?i.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:C.opd_fee?`${parseFloat(String(C.opd_fee)).toLocaleString("en-IN",{minimumFractionDigits:2})}`:""}):i.jsx("span",{className:"text-slate-400 italic text-sm",children:"N/A"})}),i.jsx("td",{className:"hidden sm:table-cell",children:i.jsxs("div",{className:`flex items-center gap-2 ${C.status==="active"?"status-active text-emerald-600":"status-inactive text-rose-600"} text-xs font-bold uppercase tracking-wider`,children:[i.jsx("div",{className:"status-indicator"}),C.status||"active"]})}),i.jsx("td",{className:"text-right",children:i.jsx("button",{onClick:()=>n(`/dashboard/staff/edit/${C.id}`),className:"p-2 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 transition-colors",disabled:C.role==="admin",title:"Edit Profile",children:i.jsx(du,{size:18})})})]},C.id)})})]})})]})},ate=()=>{var C,A,T,D,M,V,F,z,B,U,R,O,$,W;const{patientId:e,billId:n}=qr(),t=Mt(),[r,a]=w.useState(null),[l,o]=w.useState(!0),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState("cash"),v=((C=r==null?void 0:r.patient)==null?void 0:C.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{o(!0),u(null);try{const ne=await ue(`/api/bills/${n}`);if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const re=await ne.json();if(!re||!re.bill||!re.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(re.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",re.bill.type),new Error(`Unexpected bill type received: ${re.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(re,null,2));const J=Array.isArray(re.admissionPayments)?re.admissionPayments:[];console.log("Processed admissionPaymentsData:",J);const q={...re.bill,amount:re.bill.amount,AdmissionPayments:J,calculated:re.calculated,patient:re.bill.Patient?{id:re.bill.Patient.id,name:re.bill.Patient.name,admission_date:re.bill.Patient.admission_date,discharge_date:re.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(q,null,2)),a(q)}catch(ne){console.error("Failed to fetch admission bill details:",ne),u(ne instanceof Error?ne.message:"An unknown error occurred")}finally{o(!1)}})():(u("Bill ID is missing."),o(!1))},[n,e]);const N=async te=>{var ne;if(te.preventDefault(),!e||!d||isNaN(parseFloat(d))||parseFloat(d)<=0||parseFloat(d)>(((ne=r==null?void 0:r.calculated)==null?void 0:ne.balance)??0)){u("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}u(null);try{const re=await ue(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(d),payment_mode:g})});if(!re.ok){const H=await re.json();throw new Error(H.message||`HTTP error! status: ${re.status}`)}const q=await(await ue(`/api/bills/${n}`)).json();if(q&&q.bill&&q.calculated&&q.admissionPayments)a({...q.bill,amount:parseFloat(q.bill.amount),AdmissionPayments:q.admissionPayments,calculated:q.calculated,patient:q.bill.Patient?{id:q.bill.Patient.id,name:q.bill.Patient.name,admission_date:q.bill.Patient.admission_date,discharge_date:q.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");h("")}catch(re){console.error("Failed to submit payment:",re),u(re instanceof Error?re.message:"Failed to record payment")}};return l?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):f?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",f]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((A=r.patient)==null?void 0:A.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(T=r.patient)!=null&&T.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((D=r.patient)==null?void 0:D.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((M=r.status)==null?void 0:M.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((V=r==null?void 0:r.calculated)==null?void 0:V.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number((F=r==null?void 0:r.calculated)==null?void 0:F.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number((z=r==null?void 0:r.calculated)==null?void 0:z.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((B=r==null?void 0:r.calculated)==null?void 0:B.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((U=r==null?void 0:r.calculated)==null?void 0:U.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:N,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:d,onChange:te=>h(te.target.value),onBlur:te=>{te.target.value===""&&h("0")},placeholder:`Max ${(Number((R=r==null?void 0:r.calculated)==null?void 0:R.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((O=r==null?void 0:r.calculated)==null?void 0:O.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:te=>b(te.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:l||!d||parseFloat(d)<=0||parseFloat(d)>(Number(($=r==null?void 0:r.calculated)==null?void 0:$.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(W=r==null?void 0:r.AdmissionPayments)==null?void 0:W.map(te=>{if(!te||typeof te!="object")return null;let ne="Invalid Date";try{te.payment_date&&!isNaN(new Date(te.payment_date).getTime())&&(ne=new Date(te.payment_date).toLocaleString())}catch(re){console.error("Error formatting payment date:",te.payment_date,re)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:te.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ne}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(te.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:te.payment_mode??"N/A"})]},te.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var ste=Object.defineProperty,wb=Object.getOwnPropertySymbols,SE=Object.prototype.hasOwnProperty,jE=Object.prototype.propertyIsEnumerable,rC=(e,n,t)=>n in e?ste(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,B1=(e,n)=>{for(var t in n||(n={}))SE.call(n,t)&&rC(e,t,n[t]);if(wb)for(var t of wb(n))jE.call(n,t)&&rC(e,t,n[t]);return e},U1=(e,n)=>{var t={};for(var r in e)SE.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&wb)for(var r of wb(e))n.indexOf(r)<0&&jE.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Gd;(e=>{const n=class jn{constructor(u,d,h,g){if(this.version=u,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],u<jn.MIN_VERSION||u>jn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=u*4+17;let b=[];for(let N=0;N<this.size;N++)b.push(!1);for(let N=0;N<this.size;N++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(h);if(this.drawCodewords(v),g==-1){let N=1e9;for(let C=0;C<8;C++){this.applyMask(C),this.drawFormatBits(C);const A=this.getPenaltyScore();A<N&&(g=C,N=A),this.applyMask(C)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(u,d){const h=e.QrSegment.makeSegments(u);return jn.encodeSegments(h,d)}static encodeBinary(u,d){const h=e.QrSegment.makeBytes(u);return jn.encodeSegments([h],d)}static encodeSegments(u,d,h=1,g=40,b=-1,v=!0){if(!(jn.MIN_VERSION<=h&&h<=g&&g<=jn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let N,C;for(N=h;;N++){const M=jn.getNumDataCodewords(N,d)*8,V=o.getTotalBits(u,N);if(V<=M){C=V;break}if(N>=g)throw new RangeError("Data too long")}for(const M of[jn.Ecc.MEDIUM,jn.Ecc.QUARTILE,jn.Ecc.HIGH])v&&C<=jn.getNumDataCodewords(N,M)*8&&(d=M);let A=[];for(const M of u){t(M.mode.modeBits,4,A),t(M.numChars,M.mode.numCharCountBits(N),A);for(const V of M.getData())A.push(V)}a(A.length==C);const T=jn.getNumDataCodewords(N,d)*8;a(A.length<=T),t(0,Math.min(4,T-A.length),A),t(0,(8-A.length%8)%8,A),a(A.length%8==0);for(let M=236;A.length<T;M^=253)t(M,8,A);let D=[];for(;D.length*8<A.length;)D.push(0);return A.forEach((M,V)=>D[V>>>3]|=M<<7-(V&7)),new jn(N,d,D,b)}getModule(u,d){return 0<=u&&u<this.size&&0<=d&&d<this.size&&this.modules[d][u]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const u=this.getAlignmentPatternPositions(),d=u.length;for(let h=0;h<d;h++)for(let g=0;g<d;g++)h==0&&g==0||h==0&&g==d-1||h==d-1&&g==0||this.drawAlignmentPattern(u[h],u[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(u){const d=this.errorCorrectionLevel.formatBits<<3|u;let h=d;for(let b=0;b<10;b++)h=h<<1^(h>>>9)*1335;const g=(d<<10|h)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let u=this.version;for(let h=0;h<12;h++)u=u<<1^(u>>>11)*7973;const d=this.version<<12|u;a(d>>>18==0);for(let h=0;h<18;h++){const g=r(d,h),b=this.size-11+h%3,v=Math.floor(h/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(u,d){for(let h=-4;h<=4;h++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(h)),v=u+g,N=d+h;0<=v&&v<this.size&&0<=N&&N<this.size&&this.setFunctionModule(v,N,b!=2&&b!=4)}}drawAlignmentPattern(u,d){for(let h=-2;h<=2;h++)for(let g=-2;g<=2;g++)this.setFunctionModule(u+g,d+h,Math.max(Math.abs(g),Math.abs(h))!=1)}setFunctionModule(u,d,h){this.modules[d][u]=h,this.isFunction[d][u]=!0}addEccAndInterleave(u){const d=this.version,h=this.errorCorrectionLevel;if(u.length!=jn.getNumDataCodewords(d,h))throw new RangeError("Invalid argument");const g=jn.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][d],b=jn.ECC_CODEWORDS_PER_BLOCK[h.ordinal][d],v=Math.floor(jn.getNumRawDataModules(d)/8),N=g-v%g,C=Math.floor(v/g);let A=[];const T=jn.reedSolomonComputeDivisor(b);for(let M=0,V=0;M<g;M++){let F=u.slice(V,V+C-b+(M<N?0:1));V+=F.length;const z=jn.reedSolomonComputeRemainder(F,T);M<N&&F.push(0),A.push(F.concat(z))}let D=[];for(let M=0;M<A[0].length;M++)A.forEach((V,F)=>{(M!=C-b||F>=N)&&D.push(V[M])});return a(D.length==v),D}drawCodewords(u){if(u.length!=Math.floor(jn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=h-b,C=(h+1&2)==0?this.size-1-g:g;!this.isFunction[C][v]&&d<u.length*8&&(this.modules[C][v]=r(u[d>>>3],7-(d&7)),d++)}}a(d==u.length*8)}applyMask(u){if(u<0||u>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let h=0;h<this.size;h++){let g;switch(u){case 0:g=(h+d)%2==0;break;case 1:g=d%2==0;break;case 2:g=h%3==0;break;case 3:g=(h+d)%3==0;break;case 4:g=(Math.floor(h/3)+Math.floor(d/2))%2==0;break;case 5:g=h*d%2+h*d%3==0;break;case 6:g=(h*d%2+h*d%3)%2==0;break;case 7:g=((h+d)%2+h*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][h]&&g&&(this.modules[d][h]=!this.modules[d][h])}}getPenaltyScore(){let u=0;for(let b=0;b<this.size;b++){let v=!1,N=0,C=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[b][A]==v?(N++,N==5?u+=jn.PENALTY_N1:N>5&&u++):(this.finderPenaltyAddHistory(N,C),v||(u+=this.finderPenaltyCountPatterns(C)*jn.PENALTY_N3),v=this.modules[b][A],N=1);u+=this.finderPenaltyTerminateAndCount(v,N,C)*jn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,N=0,C=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[A][b]==v?(N++,N==5?u+=jn.PENALTY_N1:N>5&&u++):(this.finderPenaltyAddHistory(N,C),v||(u+=this.finderPenaltyCountPatterns(C)*jn.PENALTY_N3),v=this.modules[A][b],N=1);u+=this.finderPenaltyTerminateAndCount(v,N,C)*jn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const N=this.modules[b][v];N==this.modules[b][v+1]&&N==this.modules[b+1][v]&&N==this.modules[b+1][v+1]&&(u+=jn.PENALTY_N2)}let d=0;for(const b of this.modules)d=b.reduce((v,N)=>v+(N?1:0),d);const h=this.size*this.size,g=Math.ceil(Math.abs(d*20-h*10)/h)-1;return a(0<=g&&g<=9),u+=g*jn.PENALTY_N4,a(0<=u&&u<=2568888),u}getAlignmentPatternPositions(){if(this.version==1)return[];{const u=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(u*2-2))*2;let h=[6];for(let g=this.size-7;h.length<u;g-=d)h.splice(1,0,g);return h}}static getNumRawDataModules(u){if(u<jn.MIN_VERSION||u>jn.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*u+128)*u+64;if(u>=2){const h=Math.floor(u/7)+2;d-=(25*h-10)*h-55,u>=7&&(d-=36)}return a(208<=d&&d<=29648),d}static getNumDataCodewords(u,d){return Math.floor(jn.getNumRawDataModules(u)/8)-jn.ECC_CODEWORDS_PER_BLOCK[d.ordinal][u]*jn.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][u]}static reedSolomonComputeDivisor(u){if(u<1||u>255)throw new RangeError("Degree out of range");let d=[];for(let g=0;g<u-1;g++)d.push(0);d.push(1);let h=1;for(let g=0;g<u;g++){for(let b=0;b<d.length;b++)d[b]=jn.reedSolomonMultiply(d[b],h),b+1<d.length&&(d[b]^=d[b+1]);h=jn.reedSolomonMultiply(h,2)}return d}static reedSolomonComputeRemainder(u,d){let h=d.map(g=>0);for(const g of u){const b=g^h.shift();h.push(0),d.forEach((v,N)=>h[N]^=jn.reedSolomonMultiply(v,b))}return h}static reedSolomonMultiply(u,d){if(u>>>8||d>>>8)throw new RangeError("Byte out of range");let h=0;for(let g=7;g>=0;g--)h=h<<1^(h>>>7)*285,h^=(d>>>g&1)*u;return a(h>>>8==0),h}finderPenaltyCountPatterns(u){const d=u[1];a(d<=this.size*3);const h=d>0&&u[2]==d&&u[3]==d*3&&u[4]==d&&u[5]==d;return(h&&u[0]>=d*4&&u[6]>=d?1:0)+(h&&u[6]>=d*4&&u[0]>=d?1:0)}finderPenaltyTerminateAndCount(u,d,h){return u&&(this.finderPenaltyAddHistory(d,h),d=0),d+=this.size,this.finderPenaltyAddHistory(d,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(u,d){d[0]==0&&(u+=this.size),d.pop(),d.unshift(u)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(f,u,d){if(u<0||u>31||f>>>u)throw new RangeError("Value out of range");for(let h=u-1;h>=0;h--)d.push(f>>>h&1)}function r(f,u){return(f>>>u&1)!=0}function a(f){if(!f)throw new Error("Assertion error")}const l=class Ai{constructor(u,d,h){if(this.mode=u,this.numChars=d,this.bitData=h,d<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(u){let d=[];for(const h of u)t(h,8,d);return new Ai(Ai.Mode.BYTE,u.length,d)}static makeNumeric(u){if(!Ai.isNumeric(u))throw new RangeError("String contains non-numeric characters");let d=[];for(let h=0;h<u.length;){const g=Math.min(u.length-h,3);t(parseInt(u.substring(h,h+g),10),g*3+1,d),h+=g}return new Ai(Ai.Mode.NUMERIC,u.length,d)}static makeAlphanumeric(u){if(!Ai.isAlphanumeric(u))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],h;for(h=0;h+2<=u.length;h+=2){let g=Ai.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h))*45;g+=Ai.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h+1)),t(g,11,d)}return h<u.length&&t(Ai.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h)),6,d),new Ai(Ai.Mode.ALPHANUMERIC,u.length,d)}static makeSegments(u){return u==""?[]:Ai.isNumeric(u)?[Ai.makeNumeric(u)]:Ai.isAlphanumeric(u)?[Ai.makeAlphanumeric(u)]:[Ai.makeBytes(Ai.toUtf8ByteArray(u))]}static makeEci(u){let d=[];if(u<0)throw new RangeError("ECI assignment value out of range");if(u<128)t(u,8,d);else if(u<16384)t(2,2,d),t(u,14,d);else if(u<1e6)t(6,3,d),t(u,21,d);else throw new RangeError("ECI assignment value out of range");return new Ai(Ai.Mode.ECI,0,d)}static isNumeric(u){return Ai.NUMERIC_REGEX.test(u)}static isAlphanumeric(u){return Ai.ALPHANUMERIC_REGEX.test(u)}getData(){return this.bitData.slice()}static getTotalBits(u,d){let h=0;for(const g of u){const b=g.mode.numCharCountBits(d);if(g.numChars>=1<<b)return 1/0;h+=4+b+g.bitData.length}return h}static toUtf8ByteArray(u){u=encodeURI(u);let d=[];for(let h=0;h<u.length;h++)u.charAt(h)!="%"?d.push(u.charCodeAt(h)):(d.push(parseInt(u.substring(h+1,h+3),16)),h+=2);return d}};l.NUMERIC_REGEX=/^[0-9]*$/,l.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,l.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=l;e.QrSegment=l})(Gd||(Gd={}));(e=>{(n=>{const t=class{constructor(a,l){this.ordinal=a,this.formatBits=l}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(Gd||(Gd={}));(e=>{(n=>{const t=class{constructor(a,l){this.modeBits=a,this.numBitsCharCount=l}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Gd||(Gd={}));var Ih=Gd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var lte={L:Ih.QrCode.Ecc.LOW,M:Ih.QrCode.Ecc.MEDIUM,Q:Ih.QrCode.Ecc.QUARTILE,H:Ih.QrCode.Ecc.HIGH},_E=128,CE="L",kE="#FFFFFF",TE="#000000",EE=!1,AE=1,ote=4,cte=0,ute=.1;function PE(e,n=0){const t=[];return e.forEach(function(r,a){let l=null;r.forEach(function(o,f){if(!o&&l!==null){t.push(`M${l+n} ${a+n}h${f-l}v1H${l+n}z`),l=null;return}if(f===r.length-1){if(!o)return;l===null?t.push(`M${f+n},${a+n} h1v1H${f+n}z`):t.push(`M${l+n},${a+n} h${f+1-l}v1H${l+n}z`);return}o&&l===null&&(l=f)})}),t.join("")}function DE(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,l)=>l<n.x||l>=n.x+n.w?a:!1))}function dte(e,n,t,r){if(r==null)return null;const a=e.length+t*2,l=Math.floor(n*ute),o=a/n,f=(r.width||l)*o,u=(r.height||l)*o,d=r.x==null?e.length/2-f/2:r.x*o,h=r.y==null?e.length/2-u/2:r.y*o,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let N=Math.floor(d),C=Math.floor(h),A=Math.ceil(f+d-N),T=Math.ceil(u+h-C);b={x:N,y:C,w:A,h:T}}const v=r.crossOrigin;return{x:d,y:h,h:u,w:f,excavation:b,opacity:g,crossOrigin:v}}function fte(e,n){return n!=null?Math.max(Math.floor(n),0):e?ote:cte}function ME({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:l,size:o,boostLevel:f}){let u=qn.useMemo(()=>{const N=(Array.isArray(e)?e:[e]).reduce((C,A)=>(C.push(...Ih.QrSegment.makeSegments(A)),C),[]);return Ih.QrCode.encodeSegments(N,lte[n],t,void 0,void 0,f)},[e,n,t,f]);const{cells:d,margin:h,numCells:g,calculatedImageSettings:b}=qn.useMemo(()=>{let v=u.getModules();const N=fte(r,a),C=v.length+N*2,A=dte(v,o,N,l);return{cells:v,margin:N,numCells:C,calculatedImageSettings:A}},[u,o,l,r,a]);return{qrcode:u,margin:h,cells:d,numCells:g,calculatedImageSettings:b}}var hte=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Yh=qn.forwardRef(function(n,t){const r=n,{value:a,size:l=_E,level:o=CE,bgColor:f=kE,fgColor:u=TE,includeMargin:d=EE,minVersion:h=AE,boostLevel:g,marginSize:b,imageSettings:v}=r,C=U1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:A}=C,T=U1(C,["style"]),D=v==null?void 0:v.src,M=qn.useRef(null),V=qn.useRef(null),F=qn.useCallback(ne=>{M.current=ne,typeof t=="function"?t(ne):t&&(t.current=ne)},[t]),[z,B]=qn.useState(!1),{margin:U,cells:R,numCells:O,calculatedImageSettings:$}=ME({value:a,level:o,minVersion:h,boostLevel:g,includeMargin:d,marginSize:b,imageSettings:v,size:l});qn.useEffect(()=>{if(M.current!=null){const ne=M.current,re=ne.getContext("2d");if(!re)return;let J=R;const q=V.current,H=$!=null&&q!==null&&q.complete&&q.naturalHeight!==0&&q.naturalWidth!==0;H&&$.excavation!=null&&(J=DE(R,$.excavation));const ee=window.devicePixelRatio||1;ne.height=ne.width=l*ee;const E=l/O*ee;re.scale(E,E),re.fillStyle=f,re.fillRect(0,0,O,O),re.fillStyle=u,hte?re.fill(new Path2D(PE(J,U))):R.forEach(function(Q,ie){Q.forEach(function(I,ce){I&&re.fillRect(ce+U,ie+U,1,1)})}),$&&(re.globalAlpha=$.opacity),H&&re.drawImage(q,$.x+U,$.y+U,$.w,$.h)}}),qn.useEffect(()=>{B(!1)},[D]);const W=B1({height:l,width:l},A);let te=null;return D!=null&&(te=qn.createElement("img",{src:D,key:D,style:{display:"none"},onLoad:()=>{B(!0)},ref:V,crossOrigin:$==null?void 0:$.crossOrigin})),qn.createElement(qn.Fragment,null,qn.createElement("canvas",B1({style:W,height:l,width:l,ref:F,role:"img"},T)),te)});Yh.displayName="QRCodeCanvas";var pte=qn.forwardRef(function(n,t){const r=n,{value:a,size:l=_E,level:o=CE,bgColor:f=kE,fgColor:u=TE,includeMargin:d=EE,minVersion:h=AE,boostLevel:g,title:b,marginSize:v,imageSettings:N}=r,C=U1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:A,cells:T,numCells:D,calculatedImageSettings:M}=ME({value:a,level:o,minVersion:h,boostLevel:g,includeMargin:d,marginSize:v,imageSettings:N,size:l});let V=T,F=null;N!=null&&M!=null&&(M.excavation!=null&&(V=DE(T,M.excavation)),F=qn.createElement("image",{href:N.src,height:M.h,width:M.w,x:M.x+A,y:M.y+A,preserveAspectRatio:"none",opacity:M.opacity,crossOrigin:M.crossOrigin}));const z=PE(V,A);return qn.createElement("svg",B1({height:l,width:l,viewBox:`0 0 ${D} ${D}`,ref:t,role:"img"},C),!!b&&qn.createElement("title",null,b),qn.createElement("path",{fill:f,d:`M0,0 h${D}v${D}H0z`,shapeRendering:"crispEdges"}),qn.createElement("path",{fill:u,d:z,shapeRendering:"crispEdges"}),F)});pte.displayName="QRCodeSVG";const mte=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},gte=()=>{const{orderId:e}=qr(),n=Mt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState({}),[b,v]=w.useState(""),[N,C]=w.useState(""),[A,T]=w.useState("cash"),D=w.useMemo(()=>(t==null?void 0:t.medications.reduce(($,W)=>{const te=W.total_price??0,ne=te*(W.discount_percentage??0)/100;return $+te-ne},0))??0,[t==null?void 0:t.medications]),M=5,V=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce(($,W,te)=>{var ee,E;const ne=W.drug_id??`index-${te}`,re=((ee=h[ne])==null?void 0:ee.pack)||0,J=((E=h[ne])==null?void 0:E.loose)||0,q=W.pack_price??0,H=W.loose_price??0;return $+re*q+J*H},0),[t,h]),F=w.useCallback(async()=>{if(!e){f("Order ID is missing."),l(!1);return}l(!0),f(null);try{const $=await ue(`/api/pharmacy-orders/${e}`);if(!$.ok)throw $.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${$.statusText} (${$.status})`);const W=await $.json();console.log("Fetched order data after return:",W);const ne=W.medications.map(J=>J.pack_price&&J.loose_price&&J.loose_price>0?{...J,unitsPerPack:Math.round(J.pack_price/J.loose_price)}:{...J,unitsPerPack:0}).map(J=>({...J,discount_percentage:J.discount_percentage??0}));r({...W,medications:ne});const re={};ne.forEach((J,q)=>{const H=J.drug_id??`index-${q}`;re[H]={pack:0,loose:0}}),g(re)}catch($){console.error("Failed to fetch order details:",$),f($.message||"Failed to load order details.")}finally{l(!1)}},[e]);w.useEffect(()=>{F()},[F]),w.useEffect(()=>{(async()=>{try{const W=await ue("/api/clinics/settings");if(!W.ok)throw new Error("Failed to fetch clinic settings");const te=await W.json();console.log("Fetched clinic settings:",te),v(te.upi_id||"")}catch(W){console.error("Error fetching clinic settings:",W)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const $=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;C($)}else C("")},[t==null?void 0:t.order_total,b]);const z=($,W)=>{r(te=>{if(!te)return null;const ne=te.medications.map((J,q)=>(J.drug_id??`index-${q}`)===$?{...J,discount_percentage:isNaN(W)?0:W}:J),re=ne.reduce((J,q)=>{const H=q.total_price??0,ee=H*(q.discount_percentage??0)/100;return J+H-ee},0);return{...te,medications:ne,order_total:re}})},B=($,W,te)=>{g(ne=>{const re=te.unitsPerPack||0,q=te.pack_quantity*re+te.loose_quantity,H=Math.max(0,Math.min(W,q));let ee=0,E=H;return re>0&&(ee=Math.floor(H/re),E=H%re),{...ne,[$]:{pack:ee,loose:E}}})},U=async()=>{const $=t==null?void 0:t.medications.map((W,te)=>{var q,H;const ne=W.drug_id??`index-${te}`,re=((q=h[ne])==null?void 0:q.pack)||0,J=((H=h[ne])==null?void 0:H.loose)||0;return re>0||J>0?{drug_id:W.drug_id,name:W.name,pack_quantity:W.pack_quantity,loose_quantity:W.loose_quantity,returnPackQuantity:re,returnLooseQuantity:J}:null}).filter(W=>W!==null);if(!$||$.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!$){alert("Could not prepare items for return.");return}d(!0),f(null);try{const W=await ue(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:$})}),te=await W.json();if(!W.ok)throw new Error(te.message||`Failed to process return: ${W.statusText}`);alert("Return processed successfully! Stock has been updated.");const ne={};t==null||t.medications.forEach((re,J)=>{const q=re.drug_id??`index-${J}`;ne[q]={pack:0,loose:0}}),g(ne),F()}catch(W){console.error("Failed to process return:",W),f(W.message||"An error occurred while processing the return."),alert(`Error processing return: ${W.message||"Unknown error"}`)}finally{d(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(o)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(an,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",o]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(an,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const R=()=>{window.print()},O=mte(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(an,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:R,className:"print-button",children:[i.jsx(il,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${O.text} ${O.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map(($,W)=>{var ee,E,Q,ie,I,ce;const te=$.drug_id??`index-${W}`,ne=$.total_price??0,re=ne*($.discount_percentage??0)/100,J=ne-re,q=((ee=h[te])==null?void 0:ee.pack)||0,H=((E=h[te])==null?void 0:E.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:$.name}),i.jsx("td",{children:$.pack_quantity??0}),i.jsx("td",{children:((Q=$.pack_price)==null?void 0:Q.toFixed(2))??"N/A"}),i.jsx("td",{children:$.loose_quantity??0}),i.jsx("td",{children:((ie=$.loose_price)==null?void 0:ie.toFixed(2))??"N/A"}),i.jsx("td",{children:((I=$.price)==null?void 0:I.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((ce=$.price)==null?void 0:ce.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:$.discount_percentage??0,onChange:xe=>z(te,parseFloat(xe.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[$.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[M.toFixed(1),"%"]}),i.jsx("td",{children:J.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:$.pack_quantity,value:q,onChange:xe=>{const ge=(parseInt(xe.target.value,10)||0)*($.unitsPerPack||0)+H;B(te,ge,$)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:$.loose_quantity+$.pack_quantity*($.unitsPerPack||0)-q*($.unitsPerPack||0),value:H,onChange:xe=>{const le=parseInt(xe.target.value,10)||0,ge=q*($.unitsPerPack||0)+le;B(te,ge,$)},className:"return-quantity-input"})})]})]},te)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",D.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",D.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:A,onChange:$=>T($.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),N&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Yh,{value:N,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[V>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",V.toFixed(2)]}),i.jsx("button",{onClick:U,disabled:Object.values(h).every($=>$.pack===0&&$.loose===0)||u,className:"process-return-button",children:u?i.jsxs(i.Fragment,{children:[i.jsx(qd,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(qd,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},yte=async()=>{const e=await ue("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},xte=async e=>{const n=await ue(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},bte=async e=>{const n=await ue("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},vte=async(e,n)=>{const t=await ue(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},wte=async e=>{const n=await ue(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},Nte=async(e,n)=>{const t=await ue("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},Ste=()=>{const e=Mt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null),d=w.useCallback(async()=>{a(!0),o(null);try{const g=await yte();t(g)}catch(g){o(g.message||"Failed to fetch subscription plans."),u({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{d()},[d]),w.useEffect(()=>{if(f){const g=setTimeout(()=>u(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(u(null),o(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),o(null),u(null);try{await wte(g),u({type:"success",message:"Plan deactivated successfully!"}),d()}catch(b){o(b.message||"Failed to deactivate plan."),u({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ta,{size:18,className:"mr-2 text-green-500"}):i.jsx(ni,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(gi,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(eo,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&l&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:l}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(du,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Pi,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},jte=()=>{const e=Mt(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>u(null),5e3);return()=>clearTimeout(b)}},[f]);const d=b=>{const{name:v,value:N}=b.target;t(C=>({...C,[v]:N}))},h=async b=>{if(b.preventDefault(),a(!0),o(null),u(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){o("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await bte(n),u({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const N=v.message||"Failed to create plan.";o(N),u({type:"error",message:N})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ta,{size:18,className:"mr-2 text-green-500"}):i.jsx(ni,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(gi,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),l&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:l}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:d})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:d,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:d,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:d})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},_te=()=>{const{id:e}=qr(),n=Mt(),[t,r]=w.useState(null),[a,l]=w.useState({}),[o,f]=w.useState(!1),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),N=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),d(!1);return}d(!0),g(null);try{const D=await xte(e);r(D),l({name:D.name,description:D.description||"",price:D.price,period:D.period,interval:D.interval,razorpay_plan_id:D.razorpay_plan_id||"",status:D.status})}catch(D){g(D.message||"Failed to fetch plan details."),v({type:"error",message:D.message||"Failed to fetch plan details."})}finally{d(!1)}},[e]);w.useEffect(()=>{N()},[N]),w.useEffect(()=>{if(b){const D=setTimeout(()=>v(null),5e3);return()=>clearTimeout(D)}},[b]);const C=D=>{const{name:M,value:V}=D.target;l(F=>({...F,[M]:V}))},A=async D=>{if(D.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await vte(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(M){const V=M.message||"Failed to update plan.";g(V),v({type:"error",message:V})}finally{f(!1)}},T=()=>{n(-1)};return u?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ta,{size:18,className:"mr-2"}):i.jsx(ni,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(gi,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:A,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:C,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:C})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:C,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:C,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:C,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:C})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:C,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:T,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:o,className:"subscription-btn",children:[o?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,o?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},Cte=()=>{const{patientId:e}=qr(),n=Mt(),[t,r]=w.useState(null),[a,l]=w.useState([]),[o,f]=w.useState(""),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState("manual"),[N,C]=w.useState(!1),[A,T]=w.useState(null),D=w.useCallback(async()=>{d(!0),g(null);try{const F=await ue(`/api/patients/${e}`);if(!F.ok){const R=await F.json();throw new Error(R.message||"Failed to fetch patient details")}const z=await F.json();r(z);const B=await ue("/api/subscriptions");if(!B.ok){const R=await B.json();throw new Error(R.message||"Failed to fetch subscription plans")}const U=await B.json();l(U.filter(R=>R.status==="active"))}catch(F){console.error("Error fetching data:",F),g(`Failed to load data: ${F.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{e?D():(g("Patient ID is missing."),d(!1))},[e,D]);const M=(F,z)=>{const B=new Date(F),U=z.interval||1;switch(z.period){case"daily":B.setDate(F.getDate()+U);break;case"weekly":B.setDate(F.getDate()+U*7);break;case"monthly":B.setMonth(F.getMonth()+U);break;case"yearly":B.setFullYear(F.getFullYear()+U);break;default:console.warn(`Unknown subscription period: ${z.period}. Defaulting to 1 month.`),B.setMonth(F.getMonth()+1)}return B},V=async()=>{if(!e||!o){T("Please select a subscription plan.");return}const F=a.find(z=>z.id===o);if(!F){T("Selected plan details not found.");return}C(!0),T(null);try{const z=new Date,B=M(z,F);if(b==="manual"){const U={subscription_plan_id:o,subscription_status:"active",subscription_start_date:z.toISOString(),subscription_end_date:B.toISOString(),subscription_payment_method:"manual"},R=await ue(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(!R.ok){const O=await R.json();throw new Error(O.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",F);const U=await Nte(e,o);if(U&&U.short_url)window.location.href=U.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch(z){console.error("Error starting subscription:",z),T(`Failed to start subscription: ${z.message}`),C(!1)}};return u?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):h?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:h})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(to,{size:28})," ","Start Subscription for ",t.name]}),A&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:A})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map(F=>i.jsxs("div",{className:`subscription-plan-card ${o===F.id?"selected-plan":""}`,onClick:()=>f(F.id),children:[i.jsx("h3",{children:F.name}),i.jsxs("p",{className:"price",children:["",F.price]}),i.jsxs("p",{className:"duration",children:["Every ",F.interval," ",F.period,F.interval>1?"s":""]}),F.description&&i.jsx("p",{children:F.description})]},F.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:V,disabled:!o||N||a.length===0,className:"subscription-btn",children:[N&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),N?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16}),"Back"]})]})},kte=()=>{const e=Mt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null),d=w.useCallback(async()=>{a(!0),o(null);try{const g=await sw();t(g)}catch(g){o(g.message||"Failed to fetch clinic subscription plans."),u({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{d()},[d]),w.useEffect(()=>{if(f){const g=setTimeout(()=>u(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(u(null),o(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),o(null),u(null);try{await GR(g),u({type:"success",message:"Clinic plan deactivated successfully!"}),d()}catch(b){o(b.message||"Failed to deactivate clinic plan."),u({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ta,{size:18,className:"mr-2 text-green-500"}):i.jsx(ni,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(gi,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(an,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(eo,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&l&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:l}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(du,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Pi,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},Tte=()=>{const e=Mt(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>u(null),5e3);return()=>clearTimeout(b)}},[f]);const d=b=>{const{name:v,value:N,type:C}=b.target;t(A=>({...A,[v]:C==="number"?parseFloat(N):N}))},h=async b=>{if(b.preventDefault(),a(!0),o(null),u(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){o("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await VR(n),u({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const N=v.message||"Failed to create clinic plan.";o(N),u({type:"error",message:N})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ta,{size:18,className:"mr-2 text-green-500"}):i.jsx(ni,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(gi,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),l&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:l}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:d})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:d,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:d,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:d})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Ete=()=>{const{id:e}=qr(),n=Mt(),[t,r]=w.useState(null),[a,l]=w.useState({}),[o,f]=w.useState(!1),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),N=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),d(!1);return}d(!0),g(null);try{const D=await qR(e);r(D),l({name:D.name,description:D.description||"",price:Number(D.price),period:D.period,interval:Number(D.interval),razorpay_plan_id:D.razorpay_plan_id||"",status:D.status})}catch(D){g(D.message||"Failed to fetch clinic plan details."),v({type:"error",message:D.message||"Failed to fetch plan details."})}finally{d(!1)}},[e]);w.useEffect(()=>{N()},[N]),w.useEffect(()=>{if(b){const D=setTimeout(()=>v(null),5e3);return()=>clearTimeout(D)}},[b]);const C=D=>{const{name:M,value:V,type:F}=D.target;l(z=>({...z,[M]:F==="number"?parseFloat(V):V}))},A=async D=>{if(D.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await HR(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(M){const V=M.message||"Failed to update clinic plan.";g(V),v({type:"error",message:V})}finally{f(!1)}},T=()=>{n(-1)};return u?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ta,{size:18,className:"mr-2"}):i.jsx(ni,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(gi,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:A,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:C,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:C})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:C,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:C,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:C,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:C})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:C,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:T,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:o,className:"subscription-btn",children:[o?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,o?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},Ate=()=>{const e=Mt(),[n,t]=w.useState([]),[r,a]=w.useState(""),[l,o]=w.useState(!0),[f,u]=w.useState(null),[d,h]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{u(null);try{const A=(await sw()).filter(T=>T.status==="active");t(A),A.length>0&&!r&&a(A[0].id)}catch(C){console.error("Error fetching plans:",C),u(`Failed to load subscription plans: ${C.message}`)}},[]);w.useEffect(()=>{(async()=>{o(!0);try{const A=await WR();if(A&&A.short_url){window.location.href=A.short_url,u("You have a pending subscription. Redirecting to payment...");return}await v()}catch(A){console.error("Error during initial page load:",A),u(`An unexpected error occurred: ${A.message}`)}finally{o(!1)}})()},[v]);const N=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const C=n.find(A=>A.id===r);if(!C){b("Selected plan details not found.");return}h(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",C);const A=await YR(r);if(A&&A.short_url)window.location.href=A.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(A){console.error("Error starting clinic subscription:",A),b(`Failed to start clinic subscription: ${A.message}`),h(!1)}};return l?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):f?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:f})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(PD,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(C=>i.jsxs("div",{className:`subscription-plan-card ${r===C.id?"selected-plan":""}`,onClick:()=>a(C.id),children:[i.jsx("h3",{children:C.name}),i.jsxs("p",{className:"price",children:["",Number(C.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",C.interval," ",C.period,C.interval>1?"s":""]}),C.description&&i.jsx("p",{children:C.description})]},C.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:N,disabled:!r||d||n.length===0,className:"subscription-btn",children:[d&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),d?"Initiating Payment...":"Buy Pro Plan"]})})]})},Pte=()=>{const e=Mt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[l,o]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(null),[v,N]=w.useState({name:"",email:"",password:"",role:"user"}),[C,A]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[T,D]=w.useState(""),[M,V]=w.useState(""),[F,z]=w.useState({}),[B,U]=w.useState(!1),[R,O]=w.useState(null),[$,W]=w.useState([]),[te,ne]=w.useState(""),[re,J]=w.useState(!1),[q,H]=w.useState(null);w.useEffect(()=>{const ye=setTimeout(()=>{V(T)},500);return()=>{clearTimeout(ye)}},[T]),w.useEffect(()=>{ee(M)},[M]);const ee=async(ye="")=>{a(!0);try{const Re=ye?`/api/users?search=${encodeURIComponent(ye)}`:"/api/users",at=await(await ue(Re)).json();if(t(at),at.length>0){const Le=[...new Set(at.map(we=>we.clinic_id).filter(we=>!!we))],Te={};await Promise.all(Le.map(async we=>{try{const Fe=await UR(we);Te[we]=Fe}catch(Fe){console.error(`Failed to fetch subscription status for clinic ${we}`,Fe),Te[we]={hasProPlan:!1}}})),z(Te)}o(null)}catch(Re){o("Failed to fetch users."),console.error(Re)}finally{a(!1)}},E=async ye=>{ye.preventDefault();try{await ue("/users",{method:"POST",body:JSON.stringify(v)}),u(!1),N({name:"",email:"",password:"",role:"user"}),ee()}catch(Re){o("Failed to add user."),console.error(Re)}},Q=async ye=>{if(ye.preventDefault(),!g)return;const{password:Re,confirmPassword:Ze,...at}=C,Le={...at};if(Re){if(Re.length<6){o("Password must be at least 6 characters long.");return}if(Re!==Ze){o("Passwords do not match.");return}Le.password=Re}try{await ue(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Le)}),h(!1),b(null),A({...C,password:"",confirmPassword:""}),ee()}catch(Te){o("Failed to update user."),console.error(Te)}},ie=async ye=>{if(window.confirm("Are you sure you want to delete this user?"))try{await ue(`/users/${ye}`,{method:"DELETE"}),ee()}catch(Re){o("Failed to delete user."),console.error(Re)}},I=ye=>{b(ye),A({name:ye.name,email:ye.email,role:ye.role,password:"",confirmPassword:""}),h(!0)},ce=async()=>{J(!0);try{const ye=await sw();W(ye),ye.length>0&&ne(ye[0].id),H(null)}catch(ye){H("Failed to fetch subscription plans."),console.error(ye)}finally{J(!1)}},xe=ye=>{O(ye),U(!0),ce()},le=async ye=>{if(ye.preventDefault(),!R||!te){o("Please select a clinic and a plan.");return}try{await ue("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:R,planId:te})}),U(!1),O(null),ne(""),ee(),o(null)}catch(Re){o("Failed to manually activate clinic subscription."),console.error(Re)}},ge=async ye=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await BR(ye),ee(),o(null)}catch(Re){o("Failed to cancel subscription."),console.error(Re)}};return r?i.jsx("div",{children:"Loading users..."}):l?i.jsx("div",{className:"error-message",children:l}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(an,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:T,onChange:ye=>D(ye.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>u(!0),className:"add-user-button",children:"Add New User"})]}),f&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>u(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:ye=>N({...v,name:ye.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:ye=>N({...v,email:ye.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:ye=>N({...v,password:ye.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:ye=>N({...v,role:ye.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),d&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>h(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:Q,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:C.name,onChange:ye=>A({...C,name:ye.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:C.email,onChange:ye=>A({...C,email:ye.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:C.role,onChange:ye=>A({...C,role:ye.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:C.password,onChange:ye=>A({...C,password:ye.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:C.confirmPassword,onChange:ye=>A({...C,confirmPassword:ye.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),B&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>U(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),re&&i.jsx("div",{children:"Loading plans..."}),q&&i.jsx("div",{className:"error-message",children:q}),!re&&!q&&$.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!re&&!q&&$.length>0&&i.jsxs("form",{onSubmit:le,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:te,onChange:ye=>ne(ye.target.value),required:!0,children:$.map(ye=>i.jsxs("option",{value:ye.id,children:[ye.name," - $",ye.price,"/",ye.interval," ",ye.period]},ye.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(ye=>{const Re=ye.clinic_id||"N/A",Ze=Re!=="N/A"?F[Re]:null,at=(Ze==null?void 0:Ze.hasProPlan)??!1,Le=at?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:ye.name}),i.jsx("td",{children:ye.email}),i.jsx("td",{children:ye.role}),i.jsx("td",{children:Re}),i.jsx("td",{children:Re!=="N/A"?i.jsx("span",{className:at?"pro-badge":"standard-badge",children:Le}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>I(ye),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>ie(ye.id),className:"delete-button",children:"Delete"}),ye.clinic_id&&!at&&i.jsx("button",{onClick:()=>xe(ye.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),ye.clinic_id&&at&&i.jsx("button",{onClick:()=>ge(ye.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},ye.id)})})]})]})},Dte=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(!0),[a,l]=w.useState(null);w.useEffect(()=>{(async()=>{try{const u=tb();if(!u)throw new Error("Authentication token not found.");const h=await(await ue("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${u}`}})).json();n(h.gemini_api_key||"")}catch(u){console.error("Error fetching Gemini API key:",u),l({type:"error",text:"Failed to fetch Gemini API key."})}finally{r(!1)}})()},[]);const o=async()=>{r(!0),l(null);try{const f=tb();if(!f)throw new Error("Authentication token not found.");await ue("/api/super-admin-settings/gemini-api-key",{method:"PUT",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"},body:JSON.stringify({gemini_api_key:e})}),l({type:"success",text:"Gemini API key updated successfully!"})}catch(f){console.error("Error updating Gemini API key:",f),l({type:"error",text:"Failed to update Gemini API key."})}finally{r(!1)}};return i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(hg,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(Ts,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(Bd,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(Ts,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(cu,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),i.jsxs("div",{className:"admin-panel-card",children:[i.jsx(gM,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Global Gemini API Key"}),i.jsx("p",{children:"Set the global default Gemini API key."}),i.jsxs("div",{className:"flex flex-col mt-4",children:[i.jsx("input",{type:"password",value:e,onChange:f=>n(f.target.value),placeholder:"Enter Global Gemini API Key",className:"p-2 border border-gray-300 rounded mb-2",disabled:t}),i.jsx("button",{onClick:o,className:"bg-blue-500 text-white p-2 rounded hover:bg-blue-600 disabled:bg-blue-300",disabled:t,children:t?"Saving...":"Save Global API Key"}),a&&i.jsx("p",{className:`mt-2 text-sm ${a.type==="success"?"text-green-600":"text-red-600"}`,children:a.text})]})]})]})]})},Vm="tutorialCurrentStep",IE=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[r,a]=w.useState(""),[l,o]=w.useState(""),[f,u]=w.useState(""),[d,h]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!r||!l||!f){e(!1,"Please fill all fields.");return}h(!0);try{const v=await ue("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:l,role:g,password:f})});if(v.ok)e(!0,`Successfully added "${r}" as a ${g}!`),a(""),o(""),u(""),n&&n(g);else{const N=await v.json();e(!1,`Failed to add staff: ${N.message||v.statusText}`)}}catch(v){console.error("Error adding staff:",v),e(!1,`Error adding staff: ${v instanceof Error?v.message:String(v)}`)}finally{h(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Add a New Staff Member"}),i.jsx("input",{type:"text",placeholder:"Staff Name",value:r,onChange:v=>a(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"email",placeholder:"Email",value:l,onChange:v=>o(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"password",placeholder:"Password",value:f,onChange:v=>u(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"text",placeholder:"Role",value:g==="lab"?"Lab Technician":g==="pharmacy"?"Pharmacist":"Receptionist",className:"tutorial-input",disabled:!0}),i.jsx("button",{onClick:b,className:"tutorial-button primary",disabled:d,children:d?"Adding...":"Add Staff"})]})},Mte=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[l,o]=w.useState(!1),f=async()=>{t(!0);try{const u=await ue("/api/drugs/import-defaults",{method:"POST"});if(u.ok){const d=await u.json(),h=d.drugs?d.drugs.map(g=>g.name):[];a(h),o(!0),e(!0,`Default medications imported: Added ${d.details.added}, Updated ${d.details.updated}.`,"pharmacyImport")}else{const d=await u.json();e(!1,`Failed to import default medications: ${d.message||u.statusText}`)}}catch(u){console.error("Error importing default medications:",u),e(!1,`Error importing default medications: ${u instanceof Error?u.message:String(u)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Medications"}),i.jsx("p",{children:"Click the button below to populate your pharmacy inventory with a list of common medications."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-pills"})," Import Default Drugs"]})}),l&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Medications Imported:"}),i.jsx("ul",{children:r.map((u,d)=>i.jsx("li",{children:u},d))})]})]})},Ite=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[l,o]=w.useState(!1),f=async()=>{t(!0);try{const u=await ue("/api/lab-tests/import-defaults",{method:"POST"});if(u.ok){const d=await u.json(),h=d.tests?d.tests.map(g=>g.name):[];a(h),o(!0),e(!0,`Default lab tests imported: Added ${d.details.added}, Updated ${d.details.updated}.`,"labImport")}else{const d=await u.json();e(!1,`Failed to import default lab tests: ${d.message||u.statusText}`)}}catch(u){console.error("Error importing default lab tests:",u),e(!1,`Error importing default lab tests: ${u instanceof Error?u.message:String(u)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Lab Tests"}),i.jsx("p",{children:"Click the button below to populate your lab test inventory with a list of common tests."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-flask"})," Import Default Lab Tests"]})}),l&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Tests Imported:"}),i.jsx("ul",{children:r.map((u,d)=>i.jsx("li",{children:u},d))})]})]})},Hm=[{title:"Welcome to Your Admin Dashboard!",description:"This quick tour will guide you through essential features to get your clinic set up.",actionText:"Let's Start!",actionPath:null,component:null},{title:"Step 1: Manage Pharmacy Inventory",description:"Set up your pharmacy by adding drugs, managing stock levels, and importing default drug lists. This ensures smooth prescription fulfillment. Import default medications now!",actionText:"Go to Pharmacy Inventory",actionPath:"/dashboard/inventory",component:Mte},{title:"Step 2: Manage Lab Test Inventory",description:"Configure your laboratory by adding available lab tests and importing default test lists. This is crucial for accurate diagnostics. Import default lab tests now!",actionText:"Go to Lab Test Inventory",actionPath:"/lab-inventory",component:Ite},{title:"Step 3: Add Staff Members (Optional)",description:"You can add your clinic's staff, including doctors, receptionists, lab technicians, and pharmacists. Each role has specific permissions. You can skip this step for now.",actionText:"Go to Staff Management",actionPath:null,component:IE},{title:"You're All Set!",description:"You've completed the basic setup tour. Now, try out the AI-powered complaint analysis feature!",actionText:"Try the AI!",actionPath:"/edit-complaints",component:null}],Rte=({onClose:e,onMarkAsSeen:n})=>{const[t,r]=w.useState(()=>{const F=localStorage.getItem(Vm);return F?parseInt(F,10):0}),[a,l]=w.useState(null),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(4),N=Mt();w.useEffect(()=>{if(localStorage.setItem(Vm,t.toString()),l(null),f(null),t===0){v(4);const F=setTimeout(()=>{r(B=>B+1)},4e3),z=setInterval(()=>{v(B=>B-1)},1e3);return()=>{clearTimeout(F),clearInterval(z)}}},[t]);const C=(F,z,B)=>{f(F),l(z),F&&(B==="pharmacyImport"||B==="labImport")&&r(U=>U+1)},A=()=>{},T=()=>{n(),e(),localStorage.removeItem(Vm)},D=async()=>{const F=Hm[t];if(V&&F.actionPath==="/edit-complaints"){d(!0),g(null);try{const z=await ue("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - AI Entry",age:null,gender:null,phone:null,address:null})});if(!z.ok){const W=await z.text();throw new Error(`Failed to create patient: ${W||z.statusText} (${z.status})`)}const B=await z.json();if(!B||!B.id)throw new Error("Failed to create new patient or retrieve patient ID.");const U=B.id,R=await ue("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:U,complaint:""})});if(!R.ok){const W=await R.text();throw new Error(`Failed to create queue entry: ${W||R.statusText} (${R.status})`)}const O=await R.json();if(!O||!O.id)throw new Error("Failed to create new complaint record or retrieve record ID.");const $=O.id;N(`/dashboard/edit-complaint/${$}`),e(),n(),localStorage.removeItem(Vm)}catch(z){console.error("Error starting new AI complaint:",z);const B=`Error: ${z.message||"Failed to start new AI complaint process."}`;g(B)}finally{d(!1)}}else F.actionPath&&(N(F.actionPath),e(),t===Hm.length-1&&(n(),localStorage.removeItem(Vm)))},M=Hm[t],V=t===Hm.length-1;return i.jsx("div",{className:"tutorial-modal-overlay",children:i.jsxs("div",{className:"tutorial-modal-content",children:[i.jsxs("div",{className:"tutorial-step-indicator",children:["Step ",t+1," of ",Hm.length]}),i.jsxs("div",{className:"tutorial-content-wrapper",children:[i.jsx("h2",{children:M.title}),i.jsx("p",{children:M.description}),M.component&&i.jsxs("div",{className:"tutorial-interactive-area",children:[t===3?i.jsx(IE,{onActionComplete:C,onStaffAdded:A,requiredRole:null}):i.jsx(M.component,{onActionComplete:C}),a&&i.jsxs("p",{className:`tutorial-message ${o?"success":"error"}`,children:[o?i.jsx("i",{className:"fas fa-check-circle",style:{marginRight:"8px"}}):i.jsx("i",{className:"fas fa-exclamation-circle",style:{marginRight:"8px"}}),a]})]}),h&&i.jsxs("p",{className:"tutorial-message error",children:[i.jsx("i",{className:"fas fa-exclamation-triangle",style:{marginRight:"8px"}})," ",h]}),i.jsxs("div",{className:"tutorial-modal-actions",children:[i.jsx("button",{onClick:T,className:"tutorial-button secondary",disabled:u,children:"Skip Data Entry"}),t===3&&i.jsx("button",{onClick:()=>r(t+1),className:"tutorial-button secondary",children:"Next Step"}),M.actionPath&&i.jsx("button",{onClick:D,className:"tutorial-button action",disabled:u,children:u?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-spinner fa-spin",style:{marginRight:"8px"}})," Creating..."]}):i.jsxs(i.Fragment,{children:[M.actionText," ",i.jsx("i",{className:"fas fa-arrow-right",style:{marginLeft:"8px"}})]})})]}),t===0&&i.jsxs("div",{className:"tutorial-countdown-indicator",children:[i.jsx("i",{className:"fas fa-clock"})," Next step in ",b,"s"]})]},t)]})})},Lte=(e,n,t)=>{const r=Math.abs(e.getTime()-n.getTime());return Math.ceil(r/(1e3*60*60*24))<=t},aC=e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/))return new Date(e);const n=e.split("/");if(n.length===3){const t=parseInt(n[0],10),r=parseInt(n[1],10)-1,a=parseInt(n[2],10),l=new Date(a,r,t),o=parseInt(n[0],10)-1,f=parseInt(n[1],10),u=parseInt(n[2],10),d=new Date(u,o,f),h=!isNaN(l.getTime()),g=!isNaN(d.getTime());if(h&&g)return l;if(h)return l;if(g)return d}return new Date(e)},RE=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState(""),[u,d]=w.useState(""),[h,g]=w.useState(1),[b]=w.useState(10),v=new Date,N=Mt();w.useEffect(()=>{(async()=>{r(!0);try{const O=await ue("/api/pharmacy-orders/refill-reminders");if(O.ok){const $=await O.json();n($)}else l("Failed to fetch refill reminders.")}catch{l("An error occurred while fetching data.")}finally{r(!1)}})()},[]);const C=U=>{f(U.target.value),g(1)},A=U=>{d(U.target.value),g(1)},T=e.filter(U=>{const R=o?U.medicationRefillDates.some($=>{const W=aC($.refillDate);return!isNaN(W.getTime())&&W.toISOString().split("T")[0]===o}):!0,O=u?U.patientName.toLowerCase().includes(u.toLowerCase())||U.patientPhoneNumber.includes(u)||U.items.some($=>$.name.toLowerCase().includes(u.toLowerCase())):!0;return R&&O}),D=h*b,M=D-b,V=T.slice(M,D),F=Math.ceil(T.length/b),z=U=>g(U),B=async U=>{try{const R=await ue(`/api/queue/patient/${U}/latest`);if(R.ok){const $=await R.json();if($!=null&&$._id){N(`/dashboard/edit-complaint/${$._id}`,{state:{patientId:U}});return}}const O=await ue("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:U})});if(O.ok){const $=await O.json();$!=null&&$.id&&N(`/dashboard/edit-complaint/${$.id}`,{state:{patientId:U}})}}catch(R){console.error("Error handling row click:",R),l("Failed to navigate to patient complaint.")}};return t?i.jsx("div",{children:"Loading..."}):a?i.jsx("div",{children:a}):i.jsxs("div",{className:"refill-reminders-container",children:[i.jsx("h1",{children:"Refill Reminders"}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"filter-container",children:[i.jsx("label",{htmlFor:"refillDate",children:"Filter by Refill Date: "}),i.jsx("input",{type:"date",id:"refillDate",value:o,onChange:C})]}),i.jsxs("div",{className:"search-container",children:[i.jsx("label",{htmlFor:"search",children:"Search: "}),i.jsx("input",{type:"text",id:"search",placeholder:"Search by patient name, phone, or medication",value:u,onChange:A})]})]}),i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Patient Phone Number"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{children:"Refill Dates"})]})}),i.jsx("tbody",{children:V.length>0?V.map(U=>i.jsxs("tr",{onClick:()=>B(U.patientId),style:{cursor:"pointer"},children:[i.jsx("td",{children:U.patientName}),i.jsx("td",{children:U.patientPhoneNumber}),i.jsxs("td",{children:[i.jsx("ul",{children:U.items.map((R,O)=>i.jsxs("li",{children:[R.name," (Qty: ",R.quantity,")",R.tabletsPerDay&&i.jsxs("span",{children:[" - ",R.tabletsPerDay," / day"]}),R.numberOfDays&&i.jsxs("span",{children:[" for ",R.numberOfDays," days"]})]},O))}),i.jsxs("div",{children:["Last Updated: ",new Date(U.updatedAt).toLocaleDateString()]}),U.prescription_for_unavailable_drugs&&i.jsxs("div",{className:"unavailable-prescription",children:[i.jsx("strong",{children:"Unavailable:"})," ",U.prescription_for_unavailable_drugs]})]}),i.jsx("td",{children:i.jsx("ul",{children:U.medicationRefillDates.map((R,O)=>{const $=aC(R.refillDate),W=!isNaN($.getTime())&&Lte($,v,2);return i.jsxs("li",{className:W?"highlight-refill-date":"",children:[R.name,": ",isNaN($.getTime())?"Invalid Date":$.toLocaleDateString()]},O)})})})]},U.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:"No refill reminders found."})})})]}),i.jsxs("div",{className:"pagination-container",children:[i.jsx("button",{onClick:()=>z(h-1),disabled:h===1,children:"Previous"}),Array.from({length:F},(U,R)=>i.jsx("button",{onClick:()=>z(R+1),className:h===R+1?"active":"",children:R+1},R+1)),i.jsx("button",{onClick:()=>z(h+1),disabled:h===F,children:"Next"})]})]})},Ote=()=>{const e=Mt(),n=_r();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const o=await ue(`/api/patients?search=${r}&limit=1`);if(!o.ok)throw new Error("Failed to fetch patient by token");const u=(await o.json()).patients[0];if(!u)throw new Error("Patient with the given token not found");const d=await ue(`/api/queue/patient/${u.id}/latest`);if(d.ok){const b=await d.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a,patientId:u.id}});return}}const h=await ue("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:u.id,complaint:a})});if(!h.ok)throw new Error("Failed to create queue entry");const g=await h.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a,patientId:u.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(o){console.error("Error handling complaint URL:",o),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},Fte=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState("all"),[u,d]=w.useState(""),h=w.useCallback(async()=>{r(!0),l(null);try{const C=await ue("/api/notifications?all=true");if(C.ok){const T=(await C.json()).sort((D,M)=>{const V={expired_drug:1,near_expiry_drug:2,low_stock:3},F=V[D.type]||99,z=V[M.type]||99;return F!==z?F-z:new Date(M.created_at).getTime()-new Date(D.created_at).getTime()});n(T)}else l("Failed to fetch notifications."),console.error("Failed to fetch notifications:",C.statusText)}catch(C){l("Error fetching notifications."),console.error("Error fetching notifications:",C)}finally{r(!1)}},[]);w.useEffect(()=>{h()},[h]);const g=async C=>{try{const A=await ue(`/api/notifications/${C}/read`,{method:"PUT"});A.ok?n(T=>T.map(D=>D.id===C?{...D,is_read:!0}:D)):console.error("Failed to mark notification as read:",A.statusText)}catch(A){console.error("Error marking notification as read:",A)}},b=async(C,A)=>{if(window.confirm("Are you sure you want to delete this drug from the inventory? This action cannot be undone."))try{const T=await ue(`/api/drugs/${C}`,{method:"DELETE"});if(T.ok)alert("Drug deleted successfully."),await g(A);else{const D=await T.json();alert(`Failed to delete drug: ${D.message||T.statusText}`)}}catch(T){console.error("Error deleting drug:",T),alert("An error occurred while trying to delete the drug.")}},v=async()=>{try{const C=e.filter(T=>!T.is_read).map(T=>T.id);if(C.length===0)return;const A=await ue("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:C})});A.ok?n(T=>T.map(D=>({...D,is_read:!0}))):console.error("Failed to mark all notifications as read:",A.statusText)}catch(C){console.error("Error marking all notifications as read:",C)}},N=e.filter(C=>{const A=C.message.toLowerCase().includes(u.toLowerCase()),T=o==="all"||o==="unread"&&!C.is_read||o==="expired"&&(C.type==="expired_drug"||C.type==="near_expiry_drug");return A&&T});return t?i.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?i.jsx("div",{className:"notifications-page-container error-message",children:a}):i.jsxs("div",{className:"notifications-page-container",children:[i.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),i.jsxs("div",{className:"notifications-controls",children:[i.jsxs("div",{className:"filters-group",children:[i.jsx("input",{type:"text",placeholder:"Search notifications...",value:u,onChange:C=>d(C.target.value),className:"search-input"}),i.jsxs("select",{value:o,onChange:C=>f(C.target.value),className:"type-filter",children:[i.jsx("option",{value:"all",children:"All Notifications"}),i.jsx("option",{value:"unread",children:"Unread Only"}),i.jsx("option",{value:"expired",children:"Expiry Alerts"})]})]}),i.jsx("div",{className:"notifications-actions",children:i.jsx("button",{onClick:v,disabled:e.every(C=>C.is_read),className:"mark-all-read-button",children:"Mark All As Read"})})]}),N.length===0?i.jsx("p",{className:"no-notifications-message",children:"No notifications matching your criteria."}):i.jsx("ul",{className:"notifications-list",children:N.map(C=>i.jsxs("li",{className:`notification-item ${C.is_read?"read":"unread"}`,children:[i.jsxs("div",{className:"notification-main",children:[i.jsxs("div",{className:"notification-content",children:[i.jsx("span",{className:`notification-badge ${C.type}`,children:C.type.replace(/_/g," ")}),i.jsx("p",{className:"notification-message",children:C.message})]}),i.jsxs("div",{className:"notification-fix-actions",children:[(C.type==="expired_drug"||C.type==="near_expiry_drug")&&C.related_entity_id&&i.jsx("button",{onClick:()=>b(C.related_entity_id,C.id),className:"fix-button delete-drug",title:`Delete this ${C.type==="expired_drug"?"expired":"near expiry"} drug from inventory`,children:"Delete from Inventory"}),C.type==="low_stock"&&i.jsx("button",{className:"fix-button restock-drug",onClick:()=>window.location.href="/dashboard/inventory",children:"Restock"})]})]}),i.jsxs("div",{className:"notification-meta",children:[i.jsx("span",{className:"notification-timestamp",children:new Date(C.created_at).toLocaleString()}),!C.is_read&&i.jsx("button",{onClick:()=>g(C.id),className:"mark-read-button",children:"Mark as Read"})]})]},C.id))})]})},sC=()=>{const e=Mt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[l,o]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(!1),[v,N]=w.useState(!1),[C,A]=w.useState(!1),[T,D]=w.useState(null),[M,V]=w.useState([]),[F,z]=w.useState(null),[B,U]=w.useState(""),[R,O]=w.useState(""),[$,W]=w.useState(""),[te,ne]=w.useState(""),[re,J]=w.useState(""),[q,H]=w.useState(""),[ee,E]=w.useState(""),[Q,ie]=w.useState(""),[I,ce]=w.useState(""),[xe,le]=w.useState(""),[ge,ye]=w.useState(""),Re=w.useCallback(async()=>{a(!0),o(null);try{const oe=await ue("/api/distributors");if(!oe.ok)throw new Error(`Failed to fetch distributors: ${oe.statusText}`);const K=await oe.json();t(K)}catch(oe){console.error("Failed to fetch distributors:",oe),o(oe.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{Re()},[Re]);const Ze=async oe=>{oe.preventDefault(),o(null);try{const K=await ue("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:R,phone:$,email:te,address:re,gst_number:q,drug_license_number:ee})});if(!K.ok){const fe=await K.json();throw new Error(fe.message||"Failed to add distributor.")}alert("Distributor added successfully!"),Xe(),Re()}catch(K){console.error("Error adding distributor:",K),o(K.message||"Failed to add distributor.")}},at=async oe=>{if(oe.preventDefault(),o(null),!!T)try{const K=await ue(`/api/distributors/${T.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:R,phone:$,email:te,address:re,gst_number:q,drug_license_number:ee})});if(!K.ok){const fe=await K.json();throw new Error(fe.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),je(),Re()}catch(K){console.error("Error updating distributor:",K),o(K.message||"Failed to update distributor.")}},Le=async()=>{if(o(null),!!T)try{const oe=await ue(`/api/distributors/${T.id}`,{method:"DELETE"});if(!oe.ok){const K=await oe.json();throw new Error(K.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),ze(),Re()}catch(oe){console.error("Error deleting distributor:",oe),o(oe.message||"Failed to delete distributor.")}},Te=w.useCallback(async oe=>{o(null);try{const K=await ue(`/api/distributors/${oe}/payments`);if(!K.ok)throw new Error(`Failed to fetch payments: ${K.statusText}`);const Ae=(await K.json()).map(ft=>({...ft,order_value:parseFloat(ft.order_value),amount_paid:parseFloat(ft.amount_paid),balance_remaining:parseFloat(ft.balance_remaining)}));V(Ae);const Ie=await ue(`/api/distributors/${oe}/balance`);if(!Ie.ok)throw new Error(`Failed to fetch balance: ${Ie.statusText}`);const Ye=await Ie.json();z({totalOrderValue:parseFloat(Ye.totalOrderValue),totalAmountPaid:parseFloat(Ye.totalAmountPaid),remainingBalance:parseFloat(Ye.remainingBalance)})}catch(K){console.error("Error fetching payments/balance:",K),o(K.message||"Failed to load payments or balance.")}},[]),we=async oe=>{if(oe.preventDefault(),o(null),!!T)try{const K=await ue(`/api/distributors/${T.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:Q,order_value:parseFloat(I||"0"),amount_paid:parseFloat(xe||"0"),notes:ge})});if(!K.ok){const fe=await K.json();throw new Error(fe.message||"Failed to add payment.")}alert("Payment added successfully!"),en(),Te(T.id)}catch(K){console.error("Error adding payment:",K),o(K.message||"Failed to add payment.")}},Fe=()=>{U(""),O(""),W(""),ne(""),J(""),H(""),E(""),o(null),u(!0)},Xe=()=>{u(!1)},it=oe=>{D(oe),U(oe.name),O(oe.contact_person||""),W(oe.phone||""),ne(oe.email||""),J(oe.address||""),H(oe.gst_number||""),E(oe.drug_license_number||""),o(null),h(!0)},je=()=>{h(!1),D(null)},Ke=oe=>{D(oe),o(null),b(!0)},ze=()=>{b(!1),D(null)},ct=oe=>{D(oe),Te(oe.id),o(null),N(!0)},Tt=()=>{N(!1),D(null),V([]),z(null)},bt=oe=>{D(oe),ie(new Date().toISOString().split("T")[0]),ce("0"),le("0"),ye(""),o(null),A(!0)},en=()=>{A(!1),D(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):l?i.jsxs("div",{className:"error-indicator",children:["Error: ",l]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:i.jsx(an,{size:24})}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const oe=n.reduce((fe,Ae)=>fe+parseFloat(Ae.remainingBalance||"0"),0),K=oe>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${K}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",oe.toFixed(2)]})})(),i.jsxs("button",{onClick:Fe,className:"add-distributor-button",children:[i.jsx(Yo,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(oe=>i.jsxs("tr",{children:[i.jsx("td",{children:oe.name}),i.jsx("td",{children:oe.contact_person||"-"}),i.jsx("td",{children:oe.phone||"-"}),i.jsx("td",{children:oe.email||"-"}),i.jsx("td",{children:oe.address||"-"}),i.jsx("td",{children:oe.gst_number||"-"})," ",i.jsx("td",{children:oe.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(oe.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",oe.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>ct(oe),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(IC,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>bt(oe),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(Yo,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>it(oe),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(du,{size:16})}),i.jsx("button",{onClick:()=>Ke(oe),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(Pi,{size:16})})]})})]},oe.id))})]})}),f&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Xe,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("form",{onSubmit:Ze,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:B,onChange:oe=>U(oe.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:R,onChange:oe=>O(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:$,onChange:oe=>W(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:te,onChange:oe=>ne(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:re,onChange:oe=>J(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:q,onChange:oe=>H(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:ee,onChange:oe=>E(oe.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Xe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),d&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:je,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("form",{onSubmit:at,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:B,onChange:oe=>U(oe.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:R,onChange:oe=>O(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:$,onChange:oe=>W(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:te,onChange:oe=>ne(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:re,onChange:oe=>J(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:q,onChange:oe=>H(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:ee,onChange:oe=>E(oe.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:je,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ze,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',T.name,'"?']}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ze,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Le,className:"button-delete",children:"Delete"})]})]})}),v&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:Tt,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",T.name]}),l&&i.jsx("div",{className:"modal-error-message",children:l}),F&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",F.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",F.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",F.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),M.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:M.map(oe=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(oe.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",oe.order_value.toFixed(2)]}),i.jsxs("td",{children:["",oe.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",oe.balance_remaining.toFixed(2)]}),i.jsx("td",{children:oe.notes||"-"})]},oe.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:Tt,className:"button-cancel",children:"Close"})})]})}),C&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:en,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",T.name]}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("form",{onSubmit:we,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:Q,onChange:oe=>ie(oe.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:I,onChange:oe=>ce(oe.target.value),onBlur:oe=>{oe.target.value===""&&ce("0")},step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:xe,onChange:oe=>le(oe.target.value),onBlur:oe=>{oe.target.value===""&&le("0")},step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:ge,onChange:oe=>ye(oe.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:en,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},$te=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[l,o]=w.useState({});if(w.useEffect(()=>{e&&u()},[e,t,a]),!e)return null;const f=(h,g)=>{o(b=>({...b,[h]:g}))},u=()=>{const h={};t.forEach(g=>{const b=a.map(N=>({name:N})),v=Od(g,b);v&&(h[g]=v.name)}),o(h)},d=()=>{const h={};for(const g in l)l[g]&&l[g]!=="none"&&(h[g]=l[g]);r(h),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsxs("div",{className:"modal-body",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(gi,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:u,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((h,g)=>i.jsxs(qn.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:h}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:l[h]||"",onChange:b=>f(h,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,N=>N.toUpperCase())," "]},v))]})})]},g))]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:d,className:"button-submit",children:"Confirm Mapping"})]})]})})},zte=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[l,o]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),o(null),u(!1),h(!1))},[e]),w.useEffect(()=>{const T=M=>{M.key==="Tab"&&b.current===document.activeElement&&(d||(h(!0),setTimeout(()=>{var V;(V=v.current)==null||V.focus()},0),M.preventDefault()))},D=M=>{g.current&&!g.current.contains(M.target)&&h(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",D),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",D)}},[d]);const N=T=>{const{name:D,value:M}=T.target;a(V=>({...V,[D]:M}))},C=T=>{const{name:D,value:M}=T.target;a(M===""?V=>({...V,[D]:0}):V=>({...V,[D]:parseFloat(M)||0}))},A=T=>{if(T.preventDefault(),o(null),u(!0),r.price===void 0||r.quantity_in_stock===void 0){o("MRP and Stock Quantity are required."),u(!1);return}const D={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,buying_price:r.buying_price===0?null:r.buying_price,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(D),u(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(gi,{size:24})})]}),l&&i.jsx("div",{className:"error-message",children:l}),i.jsxs("form",{onSubmit:A,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ks,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:N,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ks,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:N,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ks,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"price",required:!0,step:"0.01",min:"0",value:r.price??"",onChange:N,onBlur:C,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ks,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"quantity_in_stock",required:!0,step:"1",min:"0",value:r.quantity_in_stock??"",onChange:N,onBlur:C,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"unit",value:r.unit||"",onChange:N,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:N,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:N,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>h(!d),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),d&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:N,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"buying_price",step:"0.01",min:"0",value:r.buying_price??"",onChange:N,onBlur:C,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:N,onBlur:C,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:N,onBlur:C,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:N,onBlur:C,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:N,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:N,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:N,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:N,onBlur:C,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:f,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:f?"Adding...":"Add Drug"})]})]})]})}):null},Bte=e=>{if(!e)return null;const n=String(e).trim().toLowerCase();if(!n)return null;const t={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12",january:"01",february:"02",march:"03",april:"04",june:"06",july:"07",august:"08",september:"09",october:"10",november:"11",december:"12"};let r,a,l;const o=n.match(/^(\d{1,2})[\s\-./]*([a-z]{3})[a-z]*[\s\-./]*(\d{2,4})$/),f=n.match(/^([a-z]{3})[a-z]*[\s\-./]*(\d{1,2})[\s\-./]*(\d{2,4})$/),u=n.match(/^(\d{1,2})[\s\-./]+(\d{1,2})[\s\-./]+(\d{2,4})$/);if(o)r=o[1],a=t[o[2].substring(0,3)],l=o[3];else if(f)a=t[f[1].substring(0,3)],r=f[2],l=f[3];else if(u)r=u[1],a=u[2],l=u[3];else{const h=Date.parse(n);return isNaN(h)?null:new Date(h).toISOString().split("T")[0]}if(!r||!a||!l)return null;l.length===2&&(l=(parseInt(l)<50?"20":"19")+l),r=r.padStart(2,"0"),a=a.padStart(2,"0");const d=new Date(parseInt(l),parseInt(a)-1,parseInt(r));return d.getFullYear()===parseInt(l)&&d.getMonth()===parseInt(a)-1&&d.getDate()===parseInt(r)?`${l}-${a}-${r}`:null},Ute=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r,lastAddMethod:a})=>{const l=w.useRef(new Map),[o,f]=w.useState(e.length);w.useEffect(()=>{var d;if(e.length>o&&a==="manual"){const h=e.length-1;(d=l.current.get(`${h}-name`))==null||d.focus()}f(e.length)},[e.length,o,a]);const u=(d,h,g)=>{const b=h===e.length-1;b&&d.key==="Enter"&&(d.preventDefault(),r()),b&&d.key==="Tab"&&g==="box_number"&&!d.shiftKey&&(d.preventDefault(),r())};return i.jsxs("table",{className:"data-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"40px"},children:"#"}),i.jsx("th",{style:{minWidth:"180px"},children:"Drug Name"}),i.jsx("th",{style:{minWidth:"120px"},children:"Brand"}),i.jsx("th",{style:{minWidth:"100px"},children:"Batch"}),i.jsx("th",{style:{minWidth:"130px"},children:"Expiry"}),i.jsx("th",{style:{minWidth:"70px"},children:"Qty"}),i.jsx("th",{style:{minWidth:"70px"},children:"Free"}),i.jsx("th",{style:{minWidth:"70px"},children:"Unit"}),i.jsx("th",{style:{minWidth:"90px"},children:"Buy "}),i.jsx("th",{style:{minWidth:"90px"},children:"MRP "}),i.jsx("th",{style:{minWidth:"60px"},children:"Disc%"}),i.jsx("th",{style:{minWidth:"60px"},children:"GST%"}),i.jsx("th",{style:{minWidth:"70px"},children:"Mrgn%"}),i.jsx("th",{style:{minWidth:"80px"},children:"HSN"}),i.jsx("th",{style:{minWidth:"80px"},children:"Mfg"}),i.jsx("th",{style:{minWidth:"80px"},children:"Rack"}),i.jsx("th",{className:"sticky-col-right",style:{width:"50px",textAlign:"center"},children:i.jsx(Pi,{size:16})})]})}),i.jsx("tbody",{children:e.map((d,h)=>i.jsxs("tr",{children:[i.jsx("td",{style:{textAlign:"center",color:"var(--text-tertiary)",fontWeight:600,fontSize:"0.85rem"},children:h+1}),i.jsx("td",{children:i.jsx("input",{ref:g=>{l.current.set(`${h}-name`,g)},className:"table-input",value:d.name||"",placeholder:"Name",onChange:g=>n(g,d.id||"","name"),onKeyDown:g=>u(g,h,"name"),autoComplete:"off"})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.brand_name||"",placeholder:"Brand",onChange:g=>n(g,d.id||"","brand_name"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.batch||"",placeholder:"Batch",onChange:g=>n(g,d.id||"","batch"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"date",className:"table-input",value:d.expiry_date||"",onChange:g=>n(g,d.id||"","expiry_date"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.quantity_in_stock??"",placeholder:"0",onChange:g=>n(g,d.id||"","quantity_in_stock"),onBlur:g=>n(g,d.id||"","quantity_in_stock"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.loose??"",placeholder:"0",onChange:g=>n(g,d.id||"","loose"),onBlur:g=>n(g,d.id||"","loose"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.unit||"",placeholder:"Tab/Strip",onChange:g=>n(g,d.id||"","unit"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.buying_price??"",placeholder:"0.00",onChange:g=>n(g,d.id||"","buying_price"),onBlur:g=>n(g,d.id||"","buying_price"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.price??"",placeholder:"0.00",onChange:g=>n(g,d.id||"","price"),onBlur:g=>n(g,d.id||"","price"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.discount??"",placeholder:"0",onChange:g=>n(g,d.id||"","discount"),onBlur:g=>n(g,d.id||"","discount"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.gst??"",placeholder:"5",onChange:g=>n(g,d.id||"","gst"),onBlur:g=>n(g,d.id||"","gst"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.margin||"",placeholder:"0",onChange:g=>n(g,d.id||"","margin"),onKeyDown:g=>u(g,h),readOnly:!0,style:{color:"var(--secondary)",fontWeight:"bold",cursor:"default"}})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.hsn_code||"",placeholder:"HSN",onChange:g=>n(g,d.id||"","hsn_code"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.mfg||"",placeholder:"Mfg",onChange:g=>n(g,d.id||"","mfg"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.box_number||"",placeholder:"Rack",onChange:g=>n(g,d.id||"","box_number"),onKeyDown:g=>u(g,h,"box_number")})}),i.jsx("td",{className:"sticky-col-right",style:{textAlign:"center"},children:i.jsx("button",{onClick:()=>t(d.id||""),className:"delete-row-btn",tabIndex:-1,title:"Remove Row",children:i.jsx(Pi,{size:16})})})]},d.id))})]})},lC=()=>{const e=Mt(),[,n]=w.useState(!1),t=w.useRef(null),[r,a]=w.useState(""),[l,o]=w.useState([]),[f,u]=w.useState(null),[d,h]=w.useState(!1),g=w.useRef(null),[b,v]=w.useState(!1),[N,C]=w.useState(!1),[A,T]=w.useState([]),[D,M]=w.useState(null),[V,F]=w.useState(null),[z,B]=w.useState(0),[U,R]=w.useState([]),[O,$]=w.useState("manual"),W=["name","description","price","quantity_in_stock","unit","supplier","expiry_date","buying_price","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],te=w.useCallback((ce,xe="manual")=>{const le=ce||(f?f.name:"");$(xe),R(ge=>[...ge,{id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",supplier:le,expiry_date:"",buying_price:0,box_number:"",gst:5,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""}])},[f]),ne=ce=>R(xe=>xe.filter(le=>le.id!==ce)),re=(ce,xe,le)=>{const{value:ge}=ce.target;R(ye=>(ye.findIndex(Ze=>Ze.id===xe)===ye.length-1&&ge.trim()!==""&&setTimeout(()=>te(void 0,"auto"),0),ye.map(Ze=>{if(Ze.id===xe){let at=ge;["price","quantity_in_stock","buying_price","gst","margin","discount","loose"].includes(le)?ce.type==="blur"?at=parseFloat(ge)||0:at=ge:le==="expiry_date"&&(at=ge.trim()===""?null:ge);const Le={...Ze,[le]:at};if(f&&(Le.supplier=f.name),["buying_price","price","gst"].includes(le)){const Te=Number(le==="buying_price"?at:Le.buying_price),we=Number(le==="price"?at:Le.price),Fe=Number(le==="gst"?at:Le.gst);if(we&&we>0&&Te!==void 0&&Te!==null){const Xe=Te*(1+(Fe||0)/100);Le.margin=parseFloat(((we-Xe)/we*100).toFixed(2))}}return Le}return Ze})))},J=w.useCallback(()=>U.reduce((ce,xe)=>{const le=Number(xe.quantity_in_stock)||0,ge=Number(xe.buying_price)||0,ye=Number(xe.gst)||0,Re=Number(xe.discount)||0;let Ze=ge*(1-Re/100),at=le*Ze;return at+=at*(ye/100),ce+at},0),[U]),q=async()=>{if(!f){F("Select a distributor.");return}const ce=U.filter(xe=>xe.name&&xe.name.trim()!==""||Number(xe.buying_price)>0);if(ce.length===0){F("No valid items.");return}n(!0),F(null),nl.addRequest();try{for(const ge of ce){const ye={...ge,price:Number(ge.price),quantity_in_stock:Number(ge.quantity_in_stock),buying_price:Number(ge.buying_price),gst:Number(ge.gst),margin:Number(ge.margin),discount:Number(ge.discount),loose:Number(ge.loose),supplier:f.name,expiry_date:ge.expiry_date||null,distributorId:f.id};if(!(await ue("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ye)})).ok)throw new Error(`Failed to add ${ge.name}`)}const xe=J();if(!(await ue(`/api/distributors/${f.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:new Date().toISOString().split("T")[0],order_value:xe,amount_paid:z,notes:`Purchase - ${ce.length} items`})})).ok)throw new Error("Payment record failed.");R([]),u(null),a(""),B(0),alert("Success!"),e("/dashboard/inventory")}catch(xe){F(xe.message||"Failed.")}finally{n(!1),nl.removeRequest()}},H=async ce=>{var ge,ye;const xe=(ge=ce.target.files)==null?void 0:ge[0];if(!xe)return;n(!0),nl.addRequest(),F(null),M(xe);const le=(ye=xe.name.split(".").pop())==null?void 0:ye.toLowerCase();if(["xlsx","xls","csv"].includes(le||"")){const Re=new FormData;Re.append("inventoryFile",xe);try{const Ze=await ue("/api/drugs/get-file-headers",{method:"POST",body:Re});if(!Ze.ok)throw new Error("Failed headers");const{headers:at}=await Ze.json();T(at),v(!0)}catch(Ze){F(Ze.message),M(null)}finally{n(!1),nl.removeRequest()}}else if(["pdf","png","jpg","jpeg"].includes(le||"")){const Re=new FormData;Re.append("file",xe),Re.append("output_type","csv");const Ze="00841ac4-b279-11f0-ab55-0a3a41e3fad1";try{const at=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:{Authorization:`Bearer ${Ze}`},body:Re});if(!at.ok)throw new Error("OCR Failed");const Le=await at.json();if(!Le.success||!Le.content)throw new Error("No data from OCR");let Te=Le.content.split(`
`).filter(je=>!je.startsWith("#")&&je.trim()).join(`
`);const we=new File([Te],"ocr.csv",{type:"text/csv"}),Fe=new FormData;Fe.append("inventoryFile",we);const Xe=await ue("/api/drugs/get-file-headers",{method:"POST",body:Fe});if(!Xe.ok)throw new Error("Failed parsing OCR CSV");const{headers:it}=await Xe.json();T(it),M(we),v(!0)}catch(at){F(at.message),M(null)}finally{n(!1),nl.removeRequest()}}else F("Unsupported file"),n(!1),nl.removeRequest()},ee=async ce=>{if(!D)return;n(!0),nl.addRequest();const xe=new FormData;xe.append("inventoryFile",D),xe.append("columnMapping",JSON.stringify(ce));try{const le=await ue("/api/drugs/parse-excel",{method:"POST",body:xe});if(!le.ok)throw new Error("Parse Failed");const ye=(await le.json()).map(Re=>({...Re,id:Date.now().toString()+Math.random(),supplier:(f==null?void 0:f.name)||Re.supplier,expiry_date:Bte(Re.expiry_date)}));R(Re=>[...Re,...ye])}catch(le){F(le.message)}finally{n(!1),nl.removeRequest(),v(!1),t.current&&(t.current.value="")}},E=w.useCallback(async ce=>{const xe=ce.trim()===""?"/api/distributors":`/api/distributors?search=${encodeURIComponent(ce)}`;try{const le=await ue(xe);if(le.ok){const ge=await le.json();o(ce.trim()===""?ge.slice(0,4):ge)}}catch(le){console.error(le)}},[]),Q=ce=>{const xe=ce.target.value;a(xe),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{E(xe),h(!0)},300)},ie=()=>{r.trim()===""&&E(""),h(!0)},I=ce=>{u(ce),a(""),h(!1),o([]),R(xe=>xe.map(le=>({...le,supplier:ce.name}))),U.length===0&&te(ce.name,"manual")};return i.jsxs("div",{className:"purchase-page",children:[i.jsx("div",{className:"purchase-header",children:i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>e(-1),className:"icon-btn",children:i.jsx(an,{size:20})}),i.jsx("h2",{className:"purchase-page-title",children:"New Purchase"})]})}),V&&i.jsxs("div",{className:"error-banner",style:{background:"var(--danger-bg)",color:"var(--danger)",padding:"12px",borderRadius:"8px",marginBottom:"20px",display:"flex",gap:"10px"},children:[i.jsx(ni,{size:20}),i.jsx("span",{children:V})]}),i.jsxs("div",{className:"purchase-controls-grid",children:[i.jsxs("div",{className:"control-card",children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("h3",{children:[i.jsx(pI,{size:20,className:"card-icon"})," Distributor"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"icon-btn",style:{width:"auto",borderRadius:"6px",fontSize:"0.8rem",padding:"6px 12px"},children:[i.jsx(cu,{size:16})," Manage"]})]}),f?i.jsxs("div",{className:"selected-distributor-card",children:[i.jsxs("div",{children:[i.jsx("strong",{children:f.name}),i.jsx("br",{}),i.jsx("span",{style:{opacity:.8},children:f.contact_person})]}),i.jsx("button",{onClick:()=>u(null),style:{background:"none",border:"none",color:"var(--primary)",fontWeight:"bold",cursor:"pointer"},children:"Change"})]}):i.jsxs("div",{className:"distributor-search-wrapper",children:[i.jsxs("div",{className:"search-input-group",children:[i.jsx(Ci,{size:18,className:"search-input-icon"}),i.jsx("input",{className:"distributor-input",placeholder:"Search...",value:r,onChange:Q,onFocus:ie})]}),d&&l.length>0&&i.jsx("ul",{className:"search-dropdown",children:l.map(ce=>i.jsx("li",{onClick:()=>I(ce),children:ce.name},ce.id))})]})]}),i.jsxs("div",{className:"control-card",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[i.jsx(gI,{size:20,className:"card-icon"})," Import & Actions"]})}),i.jsxs("div",{className:"action-buttons-row",children:[i.jsx("input",{ref:t,type:"file",hidden:!0,accept:".xlsx,.xls,.csv,.pdf,.png,.jpg",onChange:H}),i.jsxs("button",{onClick:()=>{var ce;return(ce=t.current)==null?void 0:ce.click()},disabled:!f,className:"btn-base btn-primary",children:[i.jsx(Ea,{size:18})," Import File"]}),i.jsxs("button",{onClick:()=>C(!0),disabled:!f,className:"btn-base btn-manual",children:[i.jsx(eo,{size:18})," Manual"]})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",marginTop:"8px",textAlign:"center"},children:"Supports Excel, CSV, PDF, Images"})]})]}),i.jsx($te,{isOpen:b,onClose:()=>v(!1),excelHeaders:A,onConfirm:ee,availableFields:W}),N&&i.jsx(zte,{isOpen:N,onClose:()=>C(!1),onDrugAddedToPurchase:ce=>{R(xe=>[...xe,{...ce,id:Date.now().toString(),supplier:(f==null?void 0:f.name)||""}]),C(!1)}}),i.jsxs("div",{className:"table-container",children:[i.jsx("div",{className:"table-header-title",children:i.jsxs("h3",{children:["Items (",U.length,")"]})}),i.jsx("div",{className:"table-scroll-wrapper",children:i.jsx(Ute,{purchaseRows:U,onCellChange:re,onRemoveDrug:ne,onAddEmptyRow:()=>te(void 0,"manual"),lastAddMethod:O})}),U.length===0&&i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"var(--text-tertiary)"},children:"Select distributor to start."})]}),i.jsxs("div",{className:"purchase-footer",children:[i.jsxs("button",{onClick:()=>te(void 0,"manual"),className:"btn-base btn-secondary",style:{width:"auto",flex:0},children:[i.jsx(eo,{size:16})," Add Row"]}),i.jsxs("div",{className:"footer-right",children:[i.jsxs("div",{className:"financial-input-group",children:[i.jsx("label",{children:"Paid:"}),i.jsx("input",{type:"number",value:z,onChange:ce=>B(parseFloat(ce.target.value)||0),className:"amount-paid-input"})]}),i.jsxs("div",{className:"total-display",children:[i.jsx("span",{children:"Total"}),i.jsxs("span",{className:"total-value",children:["",J().toFixed(2)]})]}),i.jsxs("button",{onClick:q,className:"submit-btn success",disabled:U.length===0,children:[i.jsx(tg,{size:20,className:"btn-icon"}),"Submit Purchase"]})]})]})]})},qte=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},Vte=()=>{const e=Mt(),n=_r(),[t,r]=w.useState(null),[a,l]=w.useState([]),[o,f]=w.useState(!0),[u,d]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState("cash"),[N,C]=w.useState(""),[A,T]=w.useState(""),[D,M]=w.useState(""),[V,F]=w.useState(""),[z,B]=w.useState(""),[U,R]=w.useState(0),O=w.useRef(!1),$=Q=>{if(R(Q),Q!==""){const ie=Math.max(0,Math.min(100,parseFloat(Q)||0));O.current=!0;const I=a.map(ce=>({...ce,discount_percentage:ie}));l(I)}},W=()=>{if(U==="")$("0");else{const Q=Math.max(0,Math.min(100,parseFloat(String(U))||0));R(Q)}},te=(Q,ie)=>{const I=[...a];I[Q].discount_percentage=ie,l(I)},ne=Q=>{const ie=[...a],I=ie[Q].discount_percentage;I===""?ie[Q].discount_percentage=0:ie[Q].discount_percentage=Math.max(0,Math.min(100,parseFloat(String(I))||0)),l(ie)};w.useEffect(()=>{if(O.current){O.current=!1;return}const Q=a.reduce((ce,xe)=>ce+(xe.total_price??0),0);if(Q===0){R(0);return}const I=a.reduce((ce,xe)=>{const ge=(xe.total_price??0)*((Number(xe.discount_percentage)??0)/100);return ce+ge},0)/Q*100;R(ce=>Math.abs(Number(ce)-I)>.01?I:ce)},[a]);const re=async()=>{if(!t)return d("No order data available to bill."),null;if(a.length===0)return d("Cannot bill an empty order."),null;g(!0),d(null);try{const Q=a.map(le=>{const ge=(le.pricePerLooseUnit??0)*(le.looseQuantity??0),ye=ge*((Number(le.discount_percentage)||0)/100),Re=ge-ye;return{name:le.name,pack_quantity:le.loosePacks??0,loose_quantity:le.looseUnits??0,price:le.originalPrice??0,pack_price:le.originalPrice??0,loose_price:le.pricePerLooseUnit??0,total:Re,drug_id:le.drug_id,discount_percentage:Number(le.discount_percentage)??0,batch:le.batch,expiry_date:le.expiry_date}}),ie={patientId:t.patientId,queueId:t.id,items:Q,amount:E,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:Number(U)},I=await ue("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ie)}),ce=await I.json();if(!I.ok||!ce.id)throw new Error(ce.message||"Failed to create bill.");const xe=await ue(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ce.id,medications:a})});if(!xe.ok){const le=await xe.text();throw new Error(`Failed to update pharmacy order status: ${xe.statusText} - ${le}`)}return r(le=>le?{...le,status:"billed",bill_id:ce.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${ce.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:ce.id},initialItems:a}}),ce.id}catch(Q){return console.error("Billing process failed:",Q),d(Q.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},J=()=>{window.print()},q=async()=>{await re()&&(window.print(),e(-1))};w.useEffect(()=>{const Q=n.pathname.split("/"),ie=Q[Q.length-1];ie?(async()=>{try{const ce=await ue(`/api/pharmacy-orders/${ie}`);if(!ce.ok)throw new Error("Failed to fetch pharmacy order details");const xe=await ce.json();r(xe);const le=xe.medications.map(ge=>{const ye=qte(ge.unit),Re=(ge.pack_quantity??0)*ye+(ge.loose_quantity??0);return{...ge,isLoose:!0,loosePacks:ge.pack_quantity??0,looseUnits:ge.loose_quantity??0,looseQuantity:Re,pack_price:Number(ge.pack_price)||0,loose_price:Number(ge.loose_price)||0,total_price:Number(ge.total_price)||0,pricePerLooseUnit:Number(ge.loose_price)||0,originalPrice:Number(ge.pack_price)||0,discount_percentage:Number(ge.discount_percentage)??0,directions_to_use:ge.directions_to_use,tabletsPerDay:ge.tabletsPerDay,numberOfDays:ge.numberOfDays,batch:ge.batch,expiry_date:ge.expiry_date}});l(le)}catch(ce){console.error("Failed to fetch order:",ce),d(ce.message||"Failed to load order details.")}finally{f(!1)}})():(d("No pharmacy order ID provided."),f(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const ie=await ue("/api/clinics/settings");if(!ie.ok)throw new Error("Failed to fetch clinic settings");const I=await ie.json();T(I.upi_id||""),M(I.name||""),F(I.address||""),B(I.notes||"")}catch(ie){console.error("Error fetching clinic settings:",ie)}})()},[]);const H=w.useMemo(()=>a.reduce((Q,ie)=>Q+(ie.total_price??0),0),[a]),ee=w.useMemo(()=>a.reduce((Q,ie)=>{const ce=(ie.total_price??0)*(Number(ie.discount_percentage)??0)/100;return Q+ce},0),[a]),E=w.useMemo(()=>H-ee,[H,ee]);return w.useEffect(()=>{if(E>0&&A){const Q=`upi://pay?pa=${A}&pn=ClinicName&am=${E.toFixed(2)}&cu=INR`;C(Q)}else C("")},[E,A]),o?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):u?i.jsxs("div",{className:"error-message-box",children:["Error: ",u]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:D?`${D} Pharmacy`:"Pharmacy Bill"}),(V||z)&&i.jsxs("div",{className:"clinic-details-print",children:[V&&i.jsx("span",{className:"small-text clinic-address",children:V}),z&&i.jsx("span",{className:"small-text clinic-notes",children:z})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(to,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ph,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ud,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(an,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(to,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ph,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(Xo,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ud,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((Q,ie)=>{var ge,ye;const I=Q.total_price??0,ce=I*(Number(Q.discount_percentage)||0)/100,xe=I-ce;return i.jsxs("tr",{children:[i.jsx("td",{children:ie+1}),i.jsx("td",{children:Q.name}),i.jsx("td",{children:Q.batch||"N/A"}),i.jsx("td",{children:Q.expiry_date?new Date(Q.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",Q.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",Q.looseUnits??0]})]}),i.jsx("td",{children:((ge=Q.originalPrice)==null?void 0:ge.toFixed(2))??"N/A"}),i.jsx("td",{children:((ye=Q.pricePerLooseUnit)==null?void 0:ye.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:Q.discount_percentage??0,onChange:Re=>te(ie,Re.target.value),onBlur:()=>ne(ie),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:xe.toFixed(2)})]},ie)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[N&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Yh,{value:N,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",H.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",Number(U).toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",ee.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(E*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",E.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",H.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",ee.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:U,onChange:Q=>$(Q.target.value),onBlur:W,min:"0",max:"100",className:"discount-input-total",disabled:h||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",E.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:N?i.jsxs(i.Fragment,{children:[i.jsx(Yh,{value:N,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:Q=>v(Q.target.value),className:"payment-mode-select",disabled:h||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:J,className:"secondary-button print-preview-button no-print",disabled:h||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:q,className:"primary-button",disabled:h||a.length===0,children:h?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},Hte=()=>{var V,F,z,B,U;const{billId:e}=qr(),n=Mt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(""),[h,g]=w.useState(""),[b,v]=w.useState(""),[N,C]=w.useState("");w.useEffect(()=>{(async()=>{try{if(!e)throw new Error("Bill ID is missing");const O=await ue(`/api/bills/${e}`);if(!O.ok)throw new Error("Failed to fetch bill details");const $=await O.json();r($.bill);const W=await ue("/api/clinics/settings");if(W.ok){const te=await W.json();if(d(te.name||""),g(te.address||""),v(te.notes||""),te.upi_id&&$.amount>0){const ne=`upi://pay?pa=${te.upi_id}&pn=${encodeURIComponent(te.name||"Clinic")}&am=${Number($.amount).toFixed(2)}&cu=INR`;C(ne)}}}catch(O){console.error("Error fetching data:",O),f(O.message||"Failed to load bill details.")}finally{l(!1)}})()},[e]);const A=()=>{window.print()};if(a)return i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."});if(o)return i.jsxs("div",{className:"error-message-box",children:["Error: ",o]});if(!t)return i.jsx("div",{className:"error-message-box",children:"No bill found."});const T=(t.items||[]).reduce((R,O)=>{const $=(Number(O.pack_price)||0)*(Number(O.pack_quantity)||0),W=(Number(O.loose_price)||0)*(Number(O.loose_quantity)||0);return R+$+W},0),D=T-Number(t.amount),M=Number(t.amount)*.05;return i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:u?`${u} Pharmacy`:"Pharmacy Bill"}),(h||b)&&i.jsxs("div",{className:"clinic-details-print",children:[h&&i.jsx("span",{className:"small-text clinic-address",children:h}),b&&i.jsx("span",{className:"small-text clinic-notes",children:b})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(to,{size:16})," Patient Name"]})," ",((V=t.Patient)==null?void 0:V.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ph,{size:16})," Token"]})," ",((F=t.Patient)==null?void 0:F.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ud,{size:16})," Bill Date"]})," ",new Date(t.createdAt).toLocaleDateString()]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ph,{size:16})," Bill No"]})," ",((z=t.id)==null?void 0:z.slice(0,8).toUpperCase())||"N/A"]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(an,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"View Bill"}),i.jsxs("button",{onClick:A,className:"primary-button",style:{marginLeft:"auto",width:"auto",padding:"0.5rem 1rem"},children:[i.jsx(il,{size:16,style:{marginRight:"8px"}})," Print"]})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Bill Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(to,{size:16})," Patient Name"]})," ",((B=t.Patient)==null?void 0:B.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ph,{size:16})," Token"]})," ",((U=t.Patient)==null?void 0:U.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ph,{size:16})," Bill ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ud,{size:16})," Date"]})," ",new Date(t.createdAt).toLocaleString()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Status"})," ",i.jsx("span",{className:"status-badge status-billed",children:t.status})]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Items"})}),t.items&&t.items.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:t.items.map((R,O)=>{const $=Number(R.total)||0,W=5;let te="N/A";if(R.expiry_date)try{te=new Date(R.expiry_date).toLocaleDateString()}catch{}return i.jsxs("tr",{children:[i.jsx("td",{children:O+1}),i.jsx("td",{children:R.name}),i.jsx("td",{children:R.batch||"N/A"}),i.jsx("td",{children:te}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",R.pack_quantity??0]}),i.jsxs("div",{children:["Loose: ",R.loose_quantity??0]})]}),i.jsx("td",{children:Number(R.pack_price||0).toFixed(2)}),i.jsx("td",{children:Number(R.loose_price||0).toFixed(2)}),i.jsxs("td",{children:[Number(R.discount_percentage||0),"%"]}),i.jsxs("td",{children:[W.toFixed(1),"%"]}),i.jsx("td",{children:$.toFixed(2)})]},O)})})]}):i.jsx("p",{children:"No items in this bill."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[N&&i.jsxs("div",{className:"qr-code-container qr-code-printable-section",children:[i.jsx(Yh,{value:N,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",T.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Discount"}),i.jsxs("span",{children:["- ",D.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",M.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",Number(t.amount).toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Payment Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",T.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",D.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",Number(t.amount).toFixed(2)]})]}),i.jsxs("div",{className:"payment-mode-section",style:{marginTop:"1rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px"},children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Mode:"})," ",(t.payment_mode||"N/A").toUpperCase()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Status:"})," ",(t.status||"N/A").toUpperCase()]})]}),i.jsx("div",{className:"qr-code-container",children:N&&i.jsxs(i.Fragment,{children:[i.jsx(Yh,{value:N,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})}),i.jsx("div",{className:"bill-actions",children:i.jsxs("button",{onClick:A,className:"primary-button",style:{width:"100%"},children:[i.jsx(il,{size:16,style:{marginRight:"8px"}})," Print Bill"]})})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})})};function ec(e){return Array.isArray?Array.isArray(e):FE(e)==="[object Array]"}function Gte(e){if(typeof e=="string")return e;let n=e+"";return n=="0"&&1/e==-1/0?"-0":n}function Yte(e){return e==null?"":Gte(e)}function Xl(e){return typeof e=="string"}function LE(e){return typeof e=="number"}function Wte(e){return e===!0||e===!1||Qte(e)&&FE(e)=="[object Boolean]"}function OE(e){return typeof e=="object"}function Qte(e){return OE(e)&&e!==null}function Za(e){return e!=null}function Uv(e){return!e.trim().length}function FE(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Jte="Incorrect 'index' type",Kte=e=>`Invalid value for key ${e}`,Xte=e=>`Pattern length exceeds max of ${e}.`,Zte=e=>`Missing ${e} property in key`,ene=e=>`Property 'weight' in key '${e}' must be a positive integer`,oC=Object.prototype.hasOwnProperty;class tne{constructor(n){this._keys=[],this._keyMap={};let t=0;n.forEach(r=>{let a=$E(r);this._keys.push(a),this._keyMap[a.id]=a,t+=a.weight}),this._keys.forEach(r=>{r.weight/=t})}get(n){return this._keyMap[n]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function $E(e){let n=null,t=null,r=null,a=1,l=null;if(Xl(e)||ec(e))r=e,n=cC(e),t=q1(e);else{if(!oC.call(e,"name"))throw new Error(Zte("name"));const o=e.name;if(r=o,oC.call(e,"weight")&&(a=e.weight,a<=0))throw new Error(ene(o));n=cC(o),t=q1(o),l=e.getFn}return{path:n,id:t,weight:a,src:r,getFn:l}}function cC(e){return ec(e)?e:e.split(".")}function q1(e){return ec(e)?e.join("."):e}function nne(e,n){let t=[],r=!1;const a=(l,o,f)=>{if(Za(l))if(!o[f])t.push(l);else{let u=o[f];const d=l[u];if(!Za(d))return;if(f===o.length-1&&(Xl(d)||LE(d)||Wte(d)))t.push(Yte(d));else if(ec(d)){r=!0;for(let h=0,g=d.length;h<g;h+=1)a(d[h],o,f+1)}else o.length&&a(d,o,f+1)}};return a(e,Xl(n)?n.split("."):n,0),r?t:t[0]}const ine={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},rne={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,n)=>e.score===n.score?e.idx<n.idx?-1:1:e.score<n.score?-1:1},ane={location:0,threshold:.6,distance:100},sne={useExtendedSearch:!1,getFn:nne,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Kt={...rne,...ine,...ane,...sne};const lne=/[^ ]+/g;function one(e=1,n=3){const t=new Map,r=Math.pow(10,n);return{get(a){const l=a.match(lne).length;if(t.has(l))return t.get(l);const o=1/Math.pow(l,.5*e),f=parseFloat(Math.round(o*r)/r);return t.set(l,f),f},clear(){t.clear()}}}class eN{constructor({getFn:n=Kt.getFn,fieldNormWeight:t=Kt.fieldNormWeight}={}){this.norm=one(t,3),this.getFn=n,this.isCreated=!1,this.setIndexRecords()}setSources(n=[]){this.docs=n}setIndexRecords(n=[]){this.records=n}setKeys(n=[]){this.keys=n,this._keysMap={},n.forEach((t,r)=>{this._keysMap[t.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Xl(this.docs[0])?this.docs.forEach((n,t)=>{this._addString(n,t)}):this.docs.forEach((n,t)=>{this._addObject(n,t)}),this.norm.clear())}add(n){const t=this.size();Xl(n)?this._addString(n,t):this._addObject(n,t)}removeAt(n){this.records.splice(n,1);for(let t=n,r=this.size();t<r;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(n,t){return n[this._keysMap[t]]}size(){return this.records.length}_addString(n,t){if(!Za(n)||Uv(n))return;let r={v:n,i:t,n:this.norm.get(n)};this.records.push(r)}_addObject(n,t){let r={i:t,$:{}};this.keys.forEach((a,l)=>{let o=a.getFn?a.getFn(n):this.getFn(n,a.path);if(Za(o)){if(ec(o)){let f=[];const u=[{nestedArrIndex:-1,value:o}];for(;u.length;){const{nestedArrIndex:d,value:h}=u.pop();if(Za(h))if(Xl(h)&&!Uv(h)){let g={v:h,i:d,n:this.norm.get(h)};f.push(g)}else ec(h)&&h.forEach((g,b)=>{u.push({nestedArrIndex:b,value:g})})}r.$[l]=f}else if(Xl(o)&&!Uv(o)){let f={v:o,n:this.norm.get(o)};r.$[l]=f}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function zE(e,n,{getFn:t=Kt.getFn,fieldNormWeight:r=Kt.fieldNormWeight}={}){const a=new eN({getFn:t,fieldNormWeight:r});return a.setKeys(e.map($E)),a.setSources(n),a.create(),a}function cne(e,{getFn:n=Kt.getFn,fieldNormWeight:t=Kt.fieldNormWeight}={}){const{keys:r,records:a}=e,l=new eN({getFn:n,fieldNormWeight:t});return l.setKeys(r),l.setIndexRecords(a),l}function $x(e,{errors:n=0,currentLocation:t=0,expectedLocation:r=0,distance:a=Kt.distance,ignoreLocation:l=Kt.ignoreLocation}={}){const o=n/e.length;if(l)return o;const f=Math.abs(r-t);return a?o+f/a:f?1:o}function une(e=[],n=Kt.minMatchCharLength){let t=[],r=-1,a=-1,l=0;for(let o=e.length;l<o;l+=1){let f=e[l];f&&r===-1?r=l:!f&&r!==-1&&(a=l-1,a-r+1>=n&&t.push([r,a]),r=-1)}return e[l-1]&&l-r>=n&&t.push([r,l-1]),t}const Fd=32;function dne(e,n,t,{location:r=Kt.location,distance:a=Kt.distance,threshold:l=Kt.threshold,findAllMatches:o=Kt.findAllMatches,minMatchCharLength:f=Kt.minMatchCharLength,includeMatches:u=Kt.includeMatches,ignoreLocation:d=Kt.ignoreLocation}={}){if(n.length>Fd)throw new Error(Xte(Fd));const h=n.length,g=e.length,b=Math.max(0,Math.min(r,g));let v=l,N=b;const C=f>1||u,A=C?Array(g):[];let T;for(;(T=e.indexOf(n,N))>-1;){let B=$x(n,{currentLocation:T,expectedLocation:b,distance:a,ignoreLocation:d});if(v=Math.min(B,v),N=T+h,C){let U=0;for(;U<h;)A[T+U]=1,U+=1}}N=-1;let D=[],M=1,V=h+g;const F=1<<h-1;for(let B=0;B<h;B+=1){let U=0,R=V;for(;U<R;)$x(n,{errors:B,currentLocation:b+R,expectedLocation:b,distance:a,ignoreLocation:d})<=v?U=R:V=R,R=Math.floor((V-U)/2+U);V=R;let O=Math.max(1,b-R+1),$=o?g:Math.min(b+R,g)+h,W=Array($+2);W[$+1]=(1<<B)-1;for(let ne=$;ne>=O;ne-=1){let re=ne-1,J=t[e.charAt(re)];if(C&&(A[re]=+!!J),W[ne]=(W[ne+1]<<1|1)&J,B&&(W[ne]|=(D[ne+1]|D[ne])<<1|1|D[ne+1]),W[ne]&F&&(M=$x(n,{errors:B,currentLocation:re,expectedLocation:b,distance:a,ignoreLocation:d}),M<=v)){if(v=M,N=re,N<=b)break;O=Math.max(1,2*b-N)}}if($x(n,{errors:B+1,currentLocation:b,expectedLocation:b,distance:a,ignoreLocation:d})>v)break;D=W}const z={isMatch:N>=0,score:Math.max(.001,M)};if(C){const B=une(A,f);B.length?u&&(z.indices=B):z.isMatch=!1}return z}function fne(e){let n={};for(let t=0,r=e.length;t<r;t+=1){const a=e.charAt(t);n[a]=(n[a]||0)|1<<r-t-1}return n}const Nb=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class BE{constructor(n,{location:t=Kt.location,threshold:r=Kt.threshold,distance:a=Kt.distance,includeMatches:l=Kt.includeMatches,findAllMatches:o=Kt.findAllMatches,minMatchCharLength:f=Kt.minMatchCharLength,isCaseSensitive:u=Kt.isCaseSensitive,ignoreDiacritics:d=Kt.ignoreDiacritics,ignoreLocation:h=Kt.ignoreLocation}={}){if(this.options={location:t,threshold:r,distance:a,includeMatches:l,findAllMatches:o,minMatchCharLength:f,isCaseSensitive:u,ignoreDiacritics:d,ignoreLocation:h},n=u?n:n.toLowerCase(),n=d?Nb(n):n,this.pattern=n,this.chunks=[],!this.pattern.length)return;const g=(v,N)=>{this.chunks.push({pattern:v,alphabet:fne(v),startIndex:N})},b=this.pattern.length;if(b>Fd){let v=0;const N=b%Fd,C=b-N;for(;v<C;)g(this.pattern.substr(v,Fd),v),v+=Fd;if(N){const A=b-Fd;g(this.pattern.substr(A),A)}}else g(this.pattern,0)}searchIn(n){const{isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a}=this.options;if(n=t?n:n.toLowerCase(),n=r?Nb(n):n,this.pattern===n){let C={isMatch:!0,score:0};return a&&(C.indices=[[0,n.length-1]]),C}const{location:l,distance:o,threshold:f,findAllMatches:u,minMatchCharLength:d,ignoreLocation:h}=this.options;let g=[],b=0,v=!1;this.chunks.forEach(({pattern:C,alphabet:A,startIndex:T})=>{const{isMatch:D,score:M,indices:V}=dne(n,C,A,{location:l+T,distance:o,threshold:f,findAllMatches:u,minMatchCharLength:d,includeMatches:a,ignoreLocation:h});D&&(v=!0),b+=M,D&&V&&(g=[...g,...V])});let N={isMatch:v,score:v?b/this.chunks.length:1};return v&&a&&(N.indices=g),N}}class xu{constructor(n){this.pattern=n}static isMultiMatch(n){return uC(n,this.multiRegex)}static isSingleMatch(n){return uC(n,this.singleRegex)}search(){}}function uC(e,n){const t=e.match(n);return t?t[1]:null}class hne extends xu{constructor(n){super(n)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(n){const t=n===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class pne extends xu{constructor(n){super(n)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(n){const r=n.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,n.length-1]}}}class mne extends xu{constructor(n){super(n)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(n){const t=n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class gne extends xu{constructor(n){super(n)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(n){const t=!n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class yne extends xu{constructor(n){super(n)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(n){const t=n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[n.length-this.pattern.length,n.length-1]}}}class xne extends xu{constructor(n){super(n)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(n){const t=!n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class UE extends xu{constructor(n,{location:t=Kt.location,threshold:r=Kt.threshold,distance:a=Kt.distance,includeMatches:l=Kt.includeMatches,findAllMatches:o=Kt.findAllMatches,minMatchCharLength:f=Kt.minMatchCharLength,isCaseSensitive:u=Kt.isCaseSensitive,ignoreDiacritics:d=Kt.ignoreDiacritics,ignoreLocation:h=Kt.ignoreLocation}={}){super(n),this._bitapSearch=new BE(n,{location:t,threshold:r,distance:a,includeMatches:l,findAllMatches:o,minMatchCharLength:f,isCaseSensitive:u,ignoreDiacritics:d,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(n){return this._bitapSearch.searchIn(n)}}class qE extends xu{constructor(n){super(n)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(n){let t=0,r;const a=[],l=this.pattern.length;for(;(r=n.indexOf(this.pattern,t))>-1;)t=r+l,a.push([r,t-1]);const o=!!a.length;return{isMatch:o,score:o?0:1,indices:a}}}const V1=[hne,qE,mne,gne,xne,yne,pne,UE],dC=V1.length,bne=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,vne="|";function wne(e,n={}){return e.split(vne).map(t=>{let r=t.trim().split(bne).filter(l=>l&&!!l.trim()),a=[];for(let l=0,o=r.length;l<o;l+=1){const f=r[l];let u=!1,d=-1;for(;!u&&++d<dC;){const h=V1[d];let g=h.isMultiMatch(f);g&&(a.push(new h(g,n)),u=!0)}if(!u)for(d=-1;++d<dC;){const h=V1[d];let g=h.isSingleMatch(f);if(g){a.push(new h(g,n));break}}}return a})}const Nne=new Set([UE.type,qE.type]);class Sne{constructor(n,{isCaseSensitive:t=Kt.isCaseSensitive,ignoreDiacritics:r=Kt.ignoreDiacritics,includeMatches:a=Kt.includeMatches,minMatchCharLength:l=Kt.minMatchCharLength,ignoreLocation:o=Kt.ignoreLocation,findAllMatches:f=Kt.findAllMatches,location:u=Kt.location,threshold:d=Kt.threshold,distance:h=Kt.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a,minMatchCharLength:l,findAllMatches:f,ignoreLocation:o,location:u,threshold:d,distance:h},n=t?n:n.toLowerCase(),n=r?Nb(n):n,this.pattern=n,this.query=wne(this.pattern,this.options)}static condition(n,t){return t.useExtendedSearch}searchIn(n){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:a,ignoreDiacritics:l}=this.options;n=a?n:n.toLowerCase(),n=l?Nb(n):n;let o=0,f=[],u=0;for(let d=0,h=t.length;d<h;d+=1){const g=t[d];f.length=0,o=0;for(let b=0,v=g.length;b<v;b+=1){const N=g[b],{isMatch:C,indices:A,score:T}=N.search(n);if(C){if(o+=1,u+=T,r){const D=N.constructor.type;Nne.has(D)?f=[...f,...A]:f.push(A)}}else{u=0,o=0,f.length=0;break}}if(o){let b={isMatch:!0,score:u/o};return r&&(b.indices=f),b}}return{isMatch:!1,score:1}}}const H1=[];function jne(...e){H1.push(...e)}function G1(e,n){for(let t=0,r=H1.length;t<r;t+=1){let a=H1[t];if(a.condition(e,n))return new a(e,n)}return new BE(e,n)}const Sb={AND:"$and",OR:"$or"},Y1={PATH:"$path",PATTERN:"$val"},W1=e=>!!(e[Sb.AND]||e[Sb.OR]),_ne=e=>!!e[Y1.PATH],Cne=e=>!ec(e)&&OE(e)&&!W1(e),fC=e=>({[Sb.AND]:Object.keys(e).map(n=>({[n]:e[n]}))});function VE(e,n,{auto:t=!0}={}){const r=a=>{let l=Object.keys(a);const o=_ne(a);if(!o&&l.length>1&&!W1(a))return r(fC(a));if(Cne(a)){const u=o?a[Y1.PATH]:l[0],d=o?a[Y1.PATTERN]:a[u];if(!Xl(d))throw new Error(Kte(u));const h={keyId:q1(u),pattern:d};return t&&(h.searcher=G1(d,n)),h}let f={children:[],operator:l[0]};return l.forEach(u=>{const d=a[u];ec(d)&&d.forEach(h=>{f.children.push(r(h))})}),f};return W1(e)||(e=fC(e)),r(e)}function kne(e,{ignoreFieldNorm:n=Kt.ignoreFieldNorm}){e.forEach(t=>{let r=1;t.matches.forEach(({key:a,norm:l,score:o})=>{const f=a?a.weight:null;r*=Math.pow(o===0&&f?Number.EPSILON:o,(f||1)*(n?1:l))}),t.score=r})}function Tne(e,n){const t=e.matches;n.matches=[],Za(t)&&t.forEach(r=>{if(!Za(r.indices)||!r.indices.length)return;const{indices:a,value:l}=r;let o={indices:a,value:l};r.key&&(o.key=r.key.src),r.idx>-1&&(o.refIndex=r.idx),n.matches.push(o)})}function Ene(e,n){n.score=e.score}function Ane(e,n,{includeMatches:t=Kt.includeMatches,includeScore:r=Kt.includeScore}={}){const a=[];return t&&a.push(Tne),r&&a.push(Ene),e.map(l=>{const{idx:o}=l,f={item:n[o],refIndex:o};return a.length&&a.forEach(u=>{u(l,f)}),f})}class ip{constructor(n,t={},r){this.options={...Kt,...t},this.options.useExtendedSearch,this._keyStore=new tne(this.options.keys),this.setCollection(n,r)}setCollection(n,t){if(this._docs=n,t&&!(t instanceof eN))throw new Error(Jte);this._myIndex=t||zE(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(n){Za(n)&&(this._docs.push(n),this._myIndex.add(n))}remove(n=()=>!1){const t=[];for(let r=0,a=this._docs.length;r<a;r+=1){const l=this._docs[r];n(l,r)&&(this.removeAt(r),r-=1,a-=1,t.push(l))}return t}removeAt(n){this._docs.splice(n,1),this._myIndex.removeAt(n)}getIndex(){return this._myIndex}search(n,{limit:t=-1}={}){const{includeMatches:r,includeScore:a,shouldSort:l,sortFn:o,ignoreFieldNorm:f}=this.options;let u=Xl(n)?Xl(this._docs[0])?this._searchStringList(n):this._searchObjectList(n):this._searchLogical(n);return kne(u,{ignoreFieldNorm:f}),l&&u.sort(o),LE(t)&&t>-1&&(u=u.slice(0,t)),Ane(u,this._docs,{includeMatches:r,includeScore:a})}_searchStringList(n){const t=G1(n,this.options),{records:r}=this._myIndex,a=[];return r.forEach(({v:l,i:o,n:f})=>{if(!Za(l))return;const{isMatch:u,score:d,indices:h}=t.searchIn(l);u&&a.push({item:l,idx:o,matches:[{score:d,value:l,norm:f,indices:h}]})}),a}_searchLogical(n){const t=VE(n,this.options),r=(f,u,d)=>{if(!f.children){const{keyId:g,searcher:b}=f,v=this._findMatches({key:this._keyStore.get(g),value:this._myIndex.getValueForItemAtKeyId(u,g),searcher:b});return v&&v.length?[{idx:d,item:u,matches:v}]:[]}const h=[];for(let g=0,b=f.children.length;g<b;g+=1){const v=f.children[g],N=r(v,u,d);if(N.length)h.push(...N);else if(f.operator===Sb.AND)return[]}return h},a=this._myIndex.records,l={},o=[];return a.forEach(({$:f,i:u})=>{if(Za(f)){let d=r(t,f,u);d.length&&(l[u]||(l[u]={idx:u,item:f,matches:[]},o.push(l[u])),d.forEach(({matches:h})=>{l[u].matches.push(...h)}))}}),o}_searchObjectList(n){const t=G1(n,this.options),{keys:r,records:a}=this._myIndex,l=[];return a.forEach(({$:o,i:f})=>{if(!Za(o))return;let u=[];r.forEach((d,h)=>{u.push(...this._findMatches({key:d,value:o[h],searcher:t}))}),u.length&&l.push({idx:f,item:o,matches:u})}),l}_findMatches({key:n,value:t,searcher:r}){if(!Za(t))return[];let a=[];if(ec(t))t.forEach(({v:l,i:o,n:f})=>{if(!Za(l))return;const{isMatch:u,score:d,indices:h}=r.searchIn(l);u&&a.push({score:d,key:n,value:l,idx:o,norm:f,indices:h})});else{const{v:l,n:o}=t,{isMatch:f,score:u,indices:d}=r.searchIn(l);f&&a.push({score:u,key:n,value:l,norm:o,indices:d})}return a}}ip.version="7.1.0";ip.createIndex=zE;ip.parseIndex=cne;ip.config=Kt;ip.parseQuery=VE;jne(Sne);const Pne="_modalOverlay_qkqmh_1",Dne="_modalContent_qkqmh_45",Mne="_modalHeader_qkqmh_99",Ine="_modalTitle_qkqmh_119",Rne="_modalCloseButton_qkqmh_141",Lne="_modalBody_qkqmh_179",One="_itemCard_qkqmh_199",Fne="_highConfidence_qkqmh_225",$ne="_mediumConfidence_qkqmh_235",zne="_lowConfidence_qkqmh_245",Bne="_itemLabel_qkqmh_255",Une="_itemName_qkqmh_273",qne="_itemQty_qkqmh_285",Vne="_statusIcon_qkqmh_299",Hne="_searchContainer_qkqmh_319",Gne="_searchWrapper_qkqmh_327",Yne="_searchInput_qkqmh_357",Wne="_searchResults_qkqmh_377",Qne="_searchItem_qkqmh_405",Jne="_matchedItemInfo_qkqmh_427",Kne="_errorText_qkqmh_453",Xne="_modalFooter_qkqmh_465",Zne="_btn_qkqmh_485",eie="_btnSecondary_qkqmh_509",tie="_btnPrimary_qkqmh_529",si={modalOverlay:Pne,modalContent:Dne,modalHeader:Mne,modalTitle:Ine,modalCloseButton:Rne,modalBody:Lne,itemCard:One,highConfidence:Fne,mediumConfidence:$ne,lowConfidence:zne,itemLabel:Bne,itemName:Une,itemQty:qne,statusIcon:Vne,searchContainer:Hne,searchWrapper:Gne,searchInput:Yne,searchResults:Wne,searchItem:Qne,matchedItemInfo:Jne,errorText:Kne,modalFooter:Xne,btn:Zne,btnSecondary:eie,btnPrimary:tie},nie=({isOpen:e,onClose:n,recurringItems:t,inventory:r,onCreateOrder:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState(null),[g,b]=w.useState([]),v=w.useMemo(()=>new ip(r,{keys:["name","composition"],threshold:.4,includeScore:!0}),[r]);w.useEffect(()=>{if(e&&t.length>0&&r.length>0){const T=t.map(D=>{const M=v.search(D.name);let V=null,F="none";if(M.length>0){V=M[0].item;const z=M[0].score||1;z<.1?F="high":z<.4?F="medium":F="low"}return{original:D,matchedDrug:V,confidence:F}});o(T)}},[e,t,r,v]),w.useEffect(()=>{if(f){const T=v.search(f).map(D=>D.item);b(T.slice(0,10))}else b([])},[f,v]);const N=(T,D)=>{o(M=>{const V=[...M];return V[T]={...V[T],matchedDrug:D,confidence:"high"},V}),h(null),u("")},C=()=>{const T=l.filter(D=>D.matchedDrug).map(D=>{const M=Number(D.matchedDrug.price),V=A(D.matchedDrug.unit),F=M/(V||1),z=D.original.pack_quantity||0,B=D.original.loose_quantity||0,U=z*M+B*F;return{drug_id:D.matchedDrug.id,name:D.matchedDrug.name,pack_quantity:z,loose_quantity:B,pack_price:M,loose_price:F,total_price:U,unit:D.matchedDrug.unit,tabletsPerDay:D.original.tabletsPerDay,numberOfDays:D.original.numberOfDays,directions_to_use:D.original.directions_to_use}});a(T)},A=T=>{if(!T)return 1;const D=T.match(/(?:\d+x)?(\d+)/);return D?parseInt(D[1],10):1};return e?i.jsx("div",{className:si.modalOverlay,children:i.jsxs("div",{className:si.modalContent,children:[i.jsxs("div",{className:si.modalHeader,children:[i.jsx("h2",{className:si.modalTitle,children:"Review Recurring Items"}),i.jsx("button",{onClick:n,className:si.modalCloseButton,title:"Close",children:i.jsx(gi,{size:24})})]}),i.jsx("div",{className:si.modalBody,children:i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:l.map((T,D)=>i.jsxs("div",{className:`${si.itemCard} ${T.confidence==="high"?si.highConfidence:T.confidence==="medium"?si.mediumConfidence:si.lowConfidence}`,children:[i.jsxs("div",{children:[i.jsx("p",{className:si.itemLabel,children:"Recurring Item"}),i.jsx("p",{className:si.itemName,children:T.original.name}),i.jsxs("p",{className:si.itemQty,children:["Qty: ",T.original.pack_quantity?`${T.original.pack_quantity} packs`:"",T.original.loose_quantity?` ${T.original.loose_quantity} loose`:""]})]}),i.jsx("div",{className:si.statusIcon,children:T.confidence==="high"?i.jsx(tg,{size:20,style:{color:"#22c55e"}}):i.jsx(zC,{size:20,style:{color:"#eab308"}})}),i.jsxs("div",{className:si.searchContainer,children:[i.jsx("p",{className:si.itemLabel,children:"Matched Inventory"}),d===D?i.jsxs("div",{className:si.searchContainer,children:[i.jsxs("div",{className:si.searchWrapper,children:[i.jsx(Ci,{size:16,style:{color:"#9ca3af"}}),i.jsx("input",{type:"text",value:f,onChange:M=>u(M.target.value),placeholder:"Search inventory...",className:si.searchInput,autoFocus:!0}),i.jsx("button",{onClick:()=>h(null),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af"},children:i.jsx(gi,{size:16})})]}),g.length>0&&i.jsx("div",{className:si.searchResults,children:g.map(M=>i.jsxs("div",{onClick:()=>N(D,M),className:si.searchItem,children:[i.jsx("div",{style:{fontWeight:600,fontSize:"0.875rem"},children:M.name}),i.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Stock: ",M.quantity_in_stock," | ",M.price]})]},M.id))})]}):i.jsx("div",{onClick:()=>{h(D),u("")},className:si.matchedItemInfo,children:T.matchedDrug?i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:700,color:"var(--heading-color)"},children:T.matchedDrug.name}),i.jsxs("p",{style:{fontSize:"0.75rem",color:"var(--secondary-text-color)"},children:["Stock: ",T.matchedDrug.quantity_in_stock," | ",T.matchedDrug.price]})]}):i.jsx("p",{className:si.errorText,children:"No match found. Click to search."})})]})]},D))})}),i.jsxs("div",{className:si.modalFooter,children:[i.jsx("button",{onClick:n,className:`${si.btn} ${si.btnSecondary}`,children:"Cancel"}),i.jsxs("button",{onClick:C,disabled:l.some(T=>!T.matchedDrug),className:`${si.btn} ${si.btnPrimary}`,children:[i.jsx(tg,{size:18}),"Create Order"]})]})]})}):null},qv=15,iie=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState(!1),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState([]),[N,C]=w.useState(null),[A,T]=w.useState(30),D=Mt(),[M,V]=w.useState(""),[F,z]=w.useState(""),[B,U]=w.useState(1),[R,O]=w.useState(1),[$,W]=w.useState(0),[te,ne]=w.useState("next_delivery_date"),[re,J]=w.useState("asc"),[q,H]=w.useState("");w.useEffect(()=>{const Le=setTimeout(()=>{z(M),U(1)},500);return()=>{clearTimeout(Le)}},[M]);const ee=w.useCallback(async(Le,Te,we,Fe,Xe)=>{r(!0),l(null);try{const it=new URLSearchParams({page:Le.toString(),limit:qv.toString(),sortBy:we,sortOrder:Fe});Te&&it.append("search",Te),Xe&&it.append("status",Xe);const je=await ue(`/api/recurring-medications?${it.toString()}`);if(!je.ok){const ze=await je.json().catch(()=>({}));throw new Error(ze.message||"Failed to fetch recurring medications")}const Ke=await je.json();n(Ke.recurringMedications),W(Ke.totalCount),U(Ke.currentPage),O(Ke.totalPages)}catch(it){l(it.message),n([]),W(0),U(1),O(1)}finally{r(!1)}},[]),E=async()=>{try{const Le=await ue("/api/drugs");if(Le.ok){const Te=await Le.json();v(Te)}}catch(Le){console.error("Failed to fetch inventory:",Le)}};w.useEffect(()=>{ee(B,F,te,re,q),E()},[B,F,te,re,q,ee]);const Q=Le=>{const Te=te===Le&&re==="asc"?"desc":"asc";ne(Le),J(Te),U(1)},ie=async(Le,Te)=>{try{if(!(await ue(`/api/recurring-medications/${Le}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:Te})})).ok)throw new Error("Failed to update status");ee(B,F,te,re,q)}catch(we){alert(`Error updating status: ${we.message}`)}},I=(Le,Te)=>{C(Le),T(Te)},ce=async Le=>{if(A<1||A>365){alert("Frequency must be between 1 and 365 days");return}try{const Te=await ue(`/api/recurring-medications/${Le}/frequency`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({frequency_days:A})});if(!Te.ok){const we=await Te.json().catch(()=>({}));throw new Error(we.message||"Failed to update frequency")}C(null),ee(B,F,te,re,q)}catch(Te){alert(`Error updating frequency: ${Te.message}`)}},xe=()=>{C(null)},le=Le=>{g(Le),f(!0),d(!1)},ge=Le=>{g(Le),d(!0),f(!1)},ye=Le=>{ee(B,F,te,re,q)},Re=async Le=>{if(h)try{const Te={patient_id:h.patient_id,items:Le,prescription_for_unavailable_drugs:"",status:"pending",date:new Date().toISOString(),order_total:Le.reduce((Fe,Xe)=>Fe+(Xe.total_price||Xe.pack_quantity*Xe.pack_price+Xe.loose_quantity*Xe.loose_price),0),recurring_medication_id:h.id},we=await ue("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Te)});if(!we.ok){const Fe=await we.json().catch(()=>({}));throw new Error(Fe.message||"Failed to create order")}alert("Order created successfully!"),f(!1),g(null),ee(B,F,te,re,q)}catch(Te){alert(`Failed to create order: ${Te.message}`)}},Ze=(Le,Te)=>{const we=Te.map(Fe=>({name:Fe.name,pack_quantity:Fe.pack_quantity,loose_quantity:Fe.loose_quantity,price:Fe.price,pack_price:Fe.pack_price,loose_price:Fe.loose_price,total_price:Number(Fe.total_price)||0,isLoose:Fe.isLoose,unit:Fe.unit,drug_id:Fe.drug_id?String(Fe.drug_id):null,tabletsPerDay:Fe.tabletsPerDay,numberOfDays:Fe.numberOfDays,directions_to_use:Fe.directions_to_use,discount_percentage:Fe.discount_percentage??0,batch:Fe.batch,expiry_date:Fe.expiry_date}));D(`/dashboard/pharmacy-billing/${Le}`,{state:{initialItems:we}})},at=async(Le,Te)=>{try{const we=await ue(`/api/pharmacy-orders/${Le}`);if(!we.ok)throw new Error("Failed to fetch order details");const Fe=await we.json(),Xe={status:Te,medications:Fe.medications},it=await ue(`/api/pharmacy-orders/${Le}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Xe)});if(!it.ok){const je=await it.text();throw new Error(`Failed to update status: ${it.statusText} (${it.status}) - ${je}`)}ee(B,F,te,re,q),alert(`Order marked as ${Te} successfully!`)}catch(we){console.error("Failed to update order status:",we),alert(`Error updating status: ${we.message}`)}};return i.jsxs("div",{className:"recurring-medications-page-container",children:[i.jsxs("div",{className:"recurring-medications-header",children:[i.jsxs("div",{className:"recurring-medications-header-left",children:[i.jsxs("button",{onClick:()=>D(-1),className:"recurring-medications-button recurring-medications-button-back",children:[i.jsx(an,{size:20}),"Back"]}),i.jsx("h1",{className:"recurring-medications-page-title",children:"Recurring Medications"})]}),i.jsxs("div",{className:"recurring-medications-header-controls",children:[i.jsxs("div",{className:"search-wrapper",children:[i.jsx(Ci,{size:18,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search patients...",value:M,onChange:Le=>V(Le.target.value)})]}),i.jsxs("div",{className:"filter-wrapper",children:[i.jsx(RC,{size:18,className:"filter-icon"}),i.jsxs("select",{id:"statusFilter",value:q,onChange:Le=>H(Le.target.value),children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),i.jsxs("button",{onClick:()=>ee(B,F,te,re,q),className:"recurring-medications-button recurring-medications-button-primary refresh-button",title:"Refresh Data",children:[i.jsx(qd,{size:18}),i.jsx("span",{children:"Refresh"})]})]})]}),i.jsxs("div",{className:"recurring-medications-summary-bar",children:[!t&&$>0&&i.jsxs("div",{className:"summary-text",children:["Found ",i.jsx("span",{className:"highlight-count",children:$})," recurring medication",$!==1?"s":"",(F||q)&&" matching criteria"]}),!t&&e.length>0&&i.jsxs("div",{className:"header-stats",children:[i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-dot active"}),i.jsxs("span",{children:["Active: ",i.jsx("span",{className:"stat-value",children:e.filter(Le=>Le.status==="active").length})]})]}),i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-dot paused"}),i.jsxs("span",{children:["Paused: ",i.jsx("span",{className:"stat-value",children:e.filter(Le=>Le.status==="paused").length})]})]}),i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-dot cancelled"}),i.jsxs("span",{children:["Cancelled: ",i.jsx("span",{className:"stat-value",children:e.filter(Le=>Le.status==="cancelled").length})]})]})]})]}),i.jsxs("div",{className:"recurring-medications-content-box",children:[a&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem 1.25rem",backgroundColor:"#fee2e2",border:"2px solid #fca5a5",borderRadius:"0.75rem",color:"#991b1b",marginBottom:"1.5rem",boxShadow:"0 2px 4px rgba(239, 68, 68, 0.1)"},children:[i.jsx(ni,{size:24,style:{flexShrink:0}}),i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"Error Loading Data"}),i.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:a})]})]}),t?i.jsx("div",{className:"recurring-medications-table-container",children:i.jsxs("table",{className:"recurring-medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{children:"Next Delivery"}),i.jsx("th",{children:"Frequency"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Last Order"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:[...Array(5)].map((Le,Te)=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"skeleton skeleton-title"}),i.jsx("div",{className:"skeleton skeleton-text"})]}),i.jsxs("td",{children:[i.jsx("div",{className:"skeleton skeleton-text"}),i.jsx("div",{className:"skeleton skeleton-text"})]}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-text",style:{width:"4rem"}})}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-text",style:{width:"6rem"}})}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-badge"})}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-text"})}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-text",style:{width:"3rem"}})})]},Te))})]})}):e.length===0?i.jsxs("div",{style:{textAlign:"center",padding:"4rem 2rem",background:"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",borderRadius:"1rem",border:"2px dashed #d1d5db",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[i.jsx("div",{style:{width:"4rem",height:"4rem",margin:"0 auto 1.5rem",borderRadius:"50%",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(ni,{size:32,style:{color:"#3b82f6"}})}),i.jsx("p",{style:{color:"#1f2937",fontSize:"1.125rem",fontWeight:600,marginBottom:"0.5rem"},children:F||q?"No matches found":"No recurring medications"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem"},children:F||q?"Try adjusting your search or filter criteria":"Recurring medications will appear here once created"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"recurring-medications-table-container",children:i.jsxs("table",{className:"recurring-medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>Q("patient_name"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Name"}),te==="patient_name"&&(re==="asc"?i.jsx(Ho,{size:12}):i.jsx(iu,{size:12}))]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem",fontSize:"0.75rem",color:"#6b7280"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>Q("patient_phone"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Phone"}),te==="patient_phone"&&(re==="asc"?i.jsx(Ho,{size:10}):i.jsx(iu,{size:10}))]}),i.jsx("span",{children:"|"}),i.jsxs("div",{className:"sortable-header",onClick:()=>Q("patient_token"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Token"}),te==="patient_token"&&(re==="asc"?i.jsx(Ho,{size:10}):i.jsx(iu,{size:10}))]})]})]})}),i.jsx("th",{children:"Medications"}),i.jsxs("th",{className:"sortable-header",onClick:()=>Q("next_delivery_date"),style:{cursor:"pointer",userSelect:"none"},children:["Next Delivery",te==="next_delivery_date"&&(re==="asc"?i.jsx(Ho,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(iu,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>Q("frequency_days"),style:{cursor:"pointer",userSelect:"none"},children:["Frequency",te==="frequency_days"&&(re==="asc"?i.jsx(Ho,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(iu,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>Q("status"),style:{cursor:"pointer",userSelect:"none"},children:["Status",te==="status"&&(re==="asc"?i.jsx(Ho,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(iu,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsx("th",{children:"Last Order"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(Le=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{style:{fontWeight:500,color:"#1f2937"},children:Le.patient_name}),i.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:Le.patient_phone}),i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Token: ",Le.patient_token]})]}),i.jsx("td",{children:i.jsx("div",{className:"med-list-compact",children:Le.medications.map((Te,we)=>i.jsxs("div",{className:"med-item-compact",children:[i.jsxs("div",{className:"med-name-primary",children:[Te.name,i.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:400,color:"#64748b",marginLeft:"0.25rem"},children:["(",Te.pack_quantity?`${Te.pack_quantity}p`:"",Te.pack_quantity&&Te.loose_quantity?" + ":"",Te.loose_quantity?`${Te.loose_quantity}l`:"",")"]})]}),i.jsxs("div",{className:"med-details-secondary",children:[Te.tabletsPerDay&&Te.numberOfDays?`${Te.tabletsPerDay} tab/day for ${Te.numberOfDays} days`:"",Te.directions_to_use&&`  ${Te.directions_to_use}`]})]},we))})}),i.jsx("td",{children:i.jsx("div",{style:{fontSize:"0.875rem"},children:new Date(Le.next_delivery_date).toLocaleDateString()})}),i.jsx("td",{children:N===Le.id?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsx("input",{type:"number",min:"1",max:"365",value:A,onChange:Te=>T(parseInt(Te.target.value,10)||1),style:{width:"4rem",padding:"0.25rem 0.5rem",border:"2px solid #6d28d9",borderRadius:"0.375rem",fontSize:"0.875rem",outline:"none"},autoFocus:!0,onKeyDown:Te=>{Te.key==="Enter"&&ce(Le.id),Te.key==="Escape"&&xe()}}),i.jsx("span",{style:{fontSize:"0.875rem",color:"#4b5563"},children:"days"}),i.jsx("button",{onClick:()=>ce(Le.id),style:{padding:"0.25rem 0.5rem",backgroundColor:"#22c55e",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Save (Enter)",children:""}),i.jsx("button",{onClick:xe,style:{padding:"0.25rem 0.5rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Cancel (Esc)",children:""})]}):i.jsxs("div",{onClick:()=>I(Le.id,Le.frequency_days||30),style:{fontSize:"0.875rem",color:"#4b5563",cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.375rem",transition:"all 0.2s ease",display:"inline-block"},onMouseEnter:Te=>{Te.currentTarget.style.backgroundColor="#f3f4f6",Te.currentTarget.style.color="#6d28d9"},onMouseLeave:Te=>{Te.currentTarget.style.backgroundColor="transparent",Te.currentTarget.style.color="#4b5563"},title:"Click to edit frequency",children:["Every ",Le.frequency_days||30," days "]})}),i.jsx("td",{children:i.jsxs("span",{className:`status-badge ${Le.status}`,children:[Le.status==="active"&&i.jsx(Ta,{size:10}),Le.status==="paused"&&i.jsx(qd,{size:10}),Le.status==="cancelled"&&i.jsx(ni,{size:10}),Le.status]})}),i.jsx("td",{children:Le.last_order?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[i.jsxs("div",{style:{fontSize:"0.875rem"},children:[i.jsx("span",{style:{fontWeight:500},children:"Status: "}),i.jsx("span",{className:`status-badge ${Le.last_order.status}`,children:Le.last_order.status})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:new Date(Le.last_order.date).toLocaleDateString()}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[Le.last_order.status==="pending"&&i.jsxs("button",{onClick:()=>Ze(Le.last_order.id,Le.medications),className:"small-action-button bill",children:[i.jsx(zd,{size:12})," Bill"]}),Le.last_order.status==="billed"&&i.jsxs("button",{onClick:()=>at(Le.last_order.id,"dispensed"),className:"small-action-button dispense",children:[i.jsx(Ko,{size:12})," Dispense"]}),Le.last_order.status==="dispensed"&&i.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#16a34a"},children:[i.jsx(Ta,{size:12})," Complete"]})]})]}):i.jsx("span",{style:{fontSize:"0.875rem",color:"#9ca3af"},children:"No recent order"})}),i.jsx("td",{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("select",{value:Le.status,onChange:Te=>ie(Le.id,Te.target.value),style:{fontSize:"0.875rem",borderColor:"#d1d5db",borderRadius:"0.375rem",padding:"0.25rem 0.5rem"},children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]}),i.jsx("button",{onClick:()=>ge(Le),className:"action-button",title:"Edit Recurring Medication",style:{color:"#6d28d9"},children:i.jsx(du,{size:18})}),i.jsx("button",{onClick:()=>le(Le),className:"action-button",title:"Create Order",children:i.jsx($C,{size:18})})]})})]},Le.id))})]})}),R>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing ",i.jsx("span",{children:(B-1)*qv+1})," to ",i.jsx("span",{children:Math.min(B*qv,$)})," of ",i.jsx("span",{children:$})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>U(Le=>Math.max(Le-1,1)),disabled:B===1||t,className:"pagination-button",children:[i.jsx(Cb,{size:14}),"Previous"]}),i.jsxs("div",{className:"pagination-page-info",children:["Page ",i.jsx("span",{children:B})," of ",i.jsx("span",{children:R})]}),i.jsxs("button",{onClick:()=>U(Le=>Math.min(Le+1,R)),disabled:B===R||t,className:"pagination-button",children:["Next",i.jsx(fg,{size:14})]})]})]})]})]}),h&&i.jsx(nie,{isOpen:o,onClose:()=>{f(!1),g(null)},recurringItems:h.medications,inventory:b,onCreateOrder:Re}),h&&i.jsx(bT,{isOpen:u,onClose:()=>{d(!1),g(null)},recurringMedication:h,onUpdate:ye,inventory:b})]})},rie="_overlay_ezztw_1",aie="_content_ezztw_45",sie="_header_ezztw_101",lie="_searchBar_ezztw_111",oie="_searchIcon_ezztw_151",cie="_input_ezztw_169",uie="_results_ezztw_205",die="_list_ezztw_215",fie="_listItem_ezztw_227",hie="_selected_ezztw_257",pie="_iconWrapper_ezztw_279",mie="_linkName_ezztw_315",gie="_arrowIcon_ezztw_327",yie="_noResults_ezztw_353",Sa={overlay:rie,content:aie,header:sie,searchBar:lie,searchIcon:oie,input:cie,results:uie,list:die,listItem:fie,selected:hie,iconWrapper:pie,linkName:mie,arrowIcon:gie,noResults:yie},xie=({isOpen:e,onClose:n,userRole:t})=>{const[r,a]=w.useState(""),[l,o]=w.useState(0),f=Mt(),u=w.useRef(null),d=w.useMemo(()=>(iw[t]||[]).flatMap(N=>N.links),[t]),h=w.useMemo(()=>r?d.filter(v=>v.name.toLowerCase().includes(r.toLowerCase())):[],[r,d]);w.useEffect(()=>{e&&(a(""),o(0),setTimeout(()=>{var v;return(v=u.current)==null?void 0:v.focus()},50))},[e]),w.useEffect(()=>{o(0)},[r]);const g=v=>{v.key==="ArrowDown"?(v.preventDefault(),o(N=>N<h.length-1?N+1:N)):v.key==="ArrowUp"?(v.preventDefault(),o(N=>N>0?N-1:N)):v.key==="Enter"&&h[l]?b(h[l].path):v.key==="Escape"&&n()},b=v=>{f(v),n()};return e?i.jsx("div",{className:Sa.overlay,onClick:n,children:i.jsxs("div",{className:Sa.content,onClick:v=>v.stopPropagation(),children:[i.jsx("div",{className:Sa.header,children:i.jsxs("div",{className:Sa.searchBar,children:[i.jsx(Ci,{size:20,className:Sa.searchIcon}),i.jsx("input",{ref:u,type:"text",placeholder:"Where would you like to go?",className:Sa.input,value:r,onChange:v=>a(v.target.value),onKeyDown:g})]})}),i.jsx("div",{className:Sa.results,children:h.length>0?i.jsx("ul",{className:Sa.list,children:h.map((v,N)=>{const C=v.icon||bD;return i.jsxs("li",{onClick:()=>b(v.path),className:`${Sa.listItem} ${N===l?Sa.selected:""}`,onMouseEnter:()=>o(N),children:[i.jsx("div",{className:Sa.iconWrapper,children:i.jsx(C,{size:18})}),i.jsx("span",{className:Sa.linkName,children:v.name}),N===l&&i.jsx(rM,{size:14,className:Sa.arrowIcon})]},v.path)})}):r&&i.jsxs("div",{className:Sa.noResults,children:[i.jsxs("p",{children:['No pages found matching "',r,'"']}),i.jsx("span",{className:"text-sm opacity-50",children:"Try searching for something else"})]})})]})}):null};function bie(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(!1),h=D=>{r(D),n(!0),D.role==="admin"&&!D.has_seen_tutorial&&d(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const D=localStorage.getItem("authToken"),M=localStorage.getItem("currentUser");if(D&&M)try{const V=JSON.parse(M);r(V),n(!0),V.role==="admin"&&!V.has_seen_tutorial&&d(!0)}catch(V){console.error("Error parsing stored user data:",V),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}l(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const M=await KC();f(M)}catch(M){console.error("Error fetching clinic pro plan status:",M),f({hasProPlan:!1})}else f(null)})()},[e,t]);const[b,v]=w.useState(null),[N,C]=w.useState(!1);w.useEffect(()=>{const D=M=>{M.preventDefault(),v(M),C(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",D),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),C(!1)),()=>{window.removeEventListener("beforeinstallprompt",D)}},[]),w.useEffect(()=>{const D=window.matchMedia("(prefers-color-scheme: dark)"),M=()=>{D.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return M(),D.addEventListener("change",M),()=>{D.removeEventListener("change",M),document.body.classList.remove("dark-mode")}},[]);const A=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const D=b;D.prompt();const{outcome:M}=await D.userChoice;console.log(`User response to the install prompt: ${M}`),v(null),C(!1)},[b]),T=async()=>{if(t)try{(await ue(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(M=>M?{...M,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),d(!1)):console.error("Failed to update tutorial status on backend.")}catch(D){console.error("Error marking tutorial as seen:",D)}};return a?i.jsx("div",{className:"initial-app-loading-screen",children:i.jsx("img",{src:"/logo.png",alt:"Loading App",className:"initial-app-loader-logo"})}):i.jsxs(FP,{children:[i.jsx(QP,{children:i.jsxs(kh,{children:[i.jsx(pt,{path:"/login",element:e?i.jsx(In,{to:"/dashboard"}):i.jsx(ZP,{onLoginSuccess:h})}),i.jsx(pt,{path:"/register",element:e?i.jsx(In,{to:"/dashboard"}):i.jsx(eD,{})}),i.jsx(pt,{path:"/handle-complaint-url",element:e?i.jsx(Ote,{}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/live-api",element:e?i.jsx(nU,{}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/create-lab-order",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(fk,{currentUser:t})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/manage-admission",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(uk,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/lab/report/:orderId",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(iC,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(iC,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/add-patient",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(y1,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/billing",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(Bee,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/lab-billing",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(qee,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(Fee,{}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(wE,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/*",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:vie(t.role,t,ue)}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(Zee,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/lab/search-report",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(ete,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(tte,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(Vee,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/inventory",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(NE,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/lab-inventory",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(aw,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx($ee,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(ate,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(Cte,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/start-clinic-subscription",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(Ate,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/refill-reminders",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(RE,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/notifications",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(Fte,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/create-custom-bill",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(dk,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(Vte,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/bills/:billId",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(Hte,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/recurring-medications",element:e&&t?i.jsx(vi,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:A,clinicProPlanStatus:o,children:i.jsx(iie,{})}):i.jsx(In,{to:"/login"})}),i.jsx(pt,{path:"*",element:i.jsx(In,{to:e?"/dashboard":"/login"})})]})}),u&&i.jsx(Rte,{onClose:()=>d(!1),onMarkAsSeen:T})]})}const vie=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(kh,{children:[i.jsx(pt,{index:!0,element:i.jsx(Dte,{})}),i.jsx(pt,{path:"clinic-subscriptions",element:i.jsx(kte,{})}),i.jsx(pt,{path:"clinic-subscriptions/add",element:i.jsx(Tte,{})}),i.jsx(pt,{path:"clinic-subscriptions/edit/:id",element:i.jsx(Ete,{})}),i.jsx(pt,{path:"users",element:i.jsx(Pte,{})})," ",i.jsx(pt,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(kh,{children:[i.jsx(pt,{index:!0,element:i.jsx(fU,{fetchWithAuth:t})}),i.jsx(pt,{path:"staff",element:i.jsx(rte,{fetchWithAuth:t})}),i.jsx(pt,{path:"staff/add",element:i.jsx(wU,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(pt,{path:"staff/edit/:id",element:i.jsx(NU,{})}),i.jsx(pt,{path:"patients/add",element:i.jsx(y1,{})}),i.jsx(pt,{path:"search-patient",element:i.jsx(Mh,{})}),i.jsx(pt,{path:"patients",element:i.jsx(g1,{})}),i.jsx(pt,{path:"analysis",element:i.jsx(Jv,{})}),i.jsx(pt,{path:"inventory",element:i.jsx(JC,{})}),i.jsx(pt,{path:"inventory/edit/:id",element:i.jsx(vU,{})}),i.jsx(pt,{path:"distributors",element:i.jsx(sC,{})}),i.jsx(pt,{path:"purchase",element:i.jsx(lC,{})})," ",i.jsx(pt,{path:"queue",element:i.jsx(lv,{})}),i.jsx(pt,{path:"subscriptions",element:i.jsx(Ste,{})}),i.jsx(pt,{path:"subscriptions/add",element:i.jsx(jte,{})}),i.jsx(pt,{path:"subscriptions/edit/:id",element:i.jsx(_te,{})}),i.jsx(pt,{path:"add-pharmacy-order",element:i.jsx(tC,{})}),i.jsx(pt,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(kh,{children:[i.jsx(pt,{index:!0,element:i.jsx(In,{to:"search-patient",replace:!0})}),i.jsx(pt,{path:"search-patient",element:i.jsx(Mh,{})}),i.jsx(pt,{path:"queue",element:i.jsx(lv,{})}),i.jsx(pt,{path:":patientId",element:i.jsx(lv,{})}),i.jsx(pt,{path:"add-patient",element:i.jsx(y1,{})}),i.jsx(pt,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(kh,{children:[i.jsx(pt,{index:!0,element:i.jsx(pU,{currentUser:n})}),i.jsx(pt,{path:"all-patients",element:i.jsx(g1,{})}),i.jsx(pt,{path:"search-patient",element:i.jsx(Mh,{})}),i.jsx(pt,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(yU,{});case"pharmacy":return i.jsxs(kh,{children:[i.jsx(pt,{index:!0,element:i.jsx(xU,{})}),i.jsx(pt,{path:"inventory",element:i.jsx(NE,{})}),i.jsx(pt,{path:"settings",element:i.jsx(bU,{})}),i.jsx(pt,{path:"add-order",element:i.jsx(tC,{})}),i.jsx(pt,{path:"edit-pharmacy-order/:orderId",element:i.jsx(wE,{})}),i.jsx(pt,{path:"analysis",element:i.jsx(Jv,{})}),i.jsx(pt,{path:"orders/:orderId",element:i.jsx(gte,{})}),i.jsx(pt,{path:"search-patient-records",element:i.jsx(Mh,{})}),i.jsx(pt,{path:"distributors",element:i.jsx(sC,{})}),i.jsx(pt,{path:"purchase",element:i.jsx(lC,{})})," ",i.jsx(pt,{path:"refill-reminders",element:i.jsx(RE,{})})," ",i.jsx(pt,{path:"*",element:i.jsx(In,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},vi=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:l})=>{const o=Mt(),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(window.innerWidth<=768),[v,N]=w.useState(!1),[C,A]=w.useState([]),[T,D]=w.useState(0),[M,V]=w.useState(!1),[F,z]=w.useState("Newtons Ai"),[B,U]=w.useState(null),[R,O]=w.useState(!1),$=w.useRef(null);w.useEffect(()=>{const H=()=>{b(window.innerWidth<=768)};return window.addEventListener("resize",H),()=>window.removeEventListener("resize",H)},[]),w.useEffect(()=>nl.subscribe(ee=>{O(ee)}),[]);const W=w.useCallback(async()=>{try{const H=await ue("/api/notifications");if(H.ok){const Q=(await H.json()).reduce((ie,I)=>{const ce=ie.find(xe=>xe.message===I.message);return ce?new Date(I.created_at)>new Date(ce.created_at)?ie.map(xe=>xe.message===I.message?I:xe):ie:[...ie,I]},[]).sort((ie,I)=>{const ce={expired_drug:1,near_expiry_drug:2,low_stock:3},xe=ce[ie.type]||99,le=ce[I.type]||99;return xe!==le?xe-le:new Date(I.created_at).getTime()-new Date(ie.created_at).getTime()});A(Q),D(Q.filter(ie=>!ie.is_read).length)}else console.error("Failed to fetch notifications:",H.statusText)}catch(H){console.error("Error fetching notifications:",H)}},[]);w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const ee=await ue("/api/clinics/settings");if(ee.ok){const E=await ee.json();E.name===""?z("Newtons Ai"):z(E.name),U(E.logoUrl)}else console.error("Failed to fetch clinic details for display:",ee.statusText),z("Newtons Ai"),U(null)}catch(ee){console.error("Error fetching clinic details for display:",ee),z("Newtons Ai"),U(null)}else z("Newtons Ai"),U(null)})()},[e==null?void 0:e.clinic_id]),w.useEffect(()=>{if(e!=null&&e.clinic_id){W();const H=setInterval(W,5*60*1e3);return()=>clearInterval(H)}},[e==null?void 0:e.clinic_id,W]);const te=()=>{u(!f),f||(h(!1),N(!1))},ne=()=>{h(!d),d||(u(!1),N(!1))},re=()=>{N(!v),v||(u(!1),h(!1))};w.useEffect(()=>{const H=ee=>{$.current&&!$.current.contains(ee.target)&&v&&N(!1)};return v&&document.addEventListener("mousedown",H),()=>{document.removeEventListener("mousedown",H)}},[v]);const J=async H=>{try{const ee=await ue(`/api/notifications/${H}/read`,{method:"PUT"});ee.ok?W():console.error("Failed to mark notification as read:",ee.statusText)}catch(ee){console.error("Error marking notification as read:",ee)}},q=async()=>{V(!0);try{const H=await ue("/api/notifications/trigger-all",{method:"POST"});H.ok?(console.log("Notification checks triggered successfully."),await W()):console.error("Failed to trigger notification checks:",H.statusText)}catch(H){console.error("Error triggering notification checks:",H)}finally{V(!1)}};return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[g&&R?i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}):i.jsx("a",{href:"#",onClick:H=>{H.preventDefault(),o("/dashboard")},className:"logo-container",children:i.jsx("img",{src:B||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:F}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[!g&&R&&i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}),r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),l&&(l.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>o("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),!g&&i.jsx("button",{className:"header-search-button",onClick:ne,"aria-label":"Search pages",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsxs("div",{className:"notifications-section",ref:$,children:[" ",i.jsxs("button",{className:`notification-icon ${T>0?"pulse-animation":""}`,"aria-label":`Notifications, ${T} unread`,onClick:re,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),T>0&&i.jsx("span",{className:"notification-count","aria-hidden":"true",children:T})]}),v&&i.jsxs("div",{className:"notifications-dropdown",children:[i.jsx("div",{className:"dropdown-header",children:"Notifications"}),i.jsx("ul",{className:"dropdown-list",children:C.length>0?C.map(H=>i.jsx("li",{className:`dropdown-item ${H.is_read?"read":"unread"}`,onClick:()=>J(H.id),children:i.jsxs("div",{className:"notification-item-content",children:[i.jsxs("div",{className:"notification-icon-wrapper",children:[H.type==="expired_drug"&&i.jsx("svg",{className:"type-icon error",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),H.type==="near_expiry_drug"&&i.jsx("svg",{className:"type-icon warning",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),H.type==="low_stock"&&i.jsx("svg",{className:"type-icon info",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),!["expired_drug","near_expiry_drug","low_stock"].includes(H.type)&&i.jsx("svg",{className:"type-icon default",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),i.jsxs("div",{className:"notification-text-wrapper",children:[i.jsx("p",{className:"notification-message-text",children:H.message}),i.jsx("span",{className:"notification-timestamp",children:new Date(H.created_at).toLocaleString()})]})]})},H.id)):i.jsx("li",{className:"dropdown-item",children:"No new notifications"})}),i.jsxs("div",{className:"dropdown-footer",children:[i.jsx("button",{onClick:()=>o("/dashboard/notifications"),children:"View All"}),(e.role==="admin"||e.role==="superadmin")&&i.jsx("button",{onClick:q,className:"fetch-all-button",disabled:M,children:M?"Fetching...":"Fetch All"})]})]})]}),i.jsx("button",{className:"hamburger-icon",onClick:te,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),i.jsx("main",{className:"main-content",children:t}),g?i.jsx(uD,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:te,roleNavigation:iw}):i.jsx(cD,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:te}),!g&&f&&i.jsx("div",{className:"side-panel-overlay",onClick:te}),i.jsx(xie,{isOpen:d,onClose:()=>h(!1),userRole:e.role})]})};jA.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(bie,{})}));
