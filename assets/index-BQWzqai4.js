var xP=Object.defineProperty;var bP=(e,n,t)=>n in e?xP(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Jn=(e,n,t)=>bP(e,typeof n!="symbol"?n+"":n,t);function vP(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wv={exports:{}},jm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jS;function wP(){if(jS)return jm;jS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var d in a)d!=="key"&&(o[d]=a[d])}else o=a;return a=o.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:o}}return jm.Fragment=n,jm.jsx=t,jm.jsxs=t,jm}var kS;function SP(){return kS||(kS=1,Wv.exports=wP()),Wv.exports}var i=SP(),Qv={exports:{}},Zt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TS;function NP(){if(TS)return Zt;TS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function b(E){return E===null||typeof E!="object"?null:(E=g&&E[g]||E["@@iterator"],typeof E=="function"?E:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function T(E,de,he){this.props=E,this.context=de,this.refs=k,this.updater=he||v}T.prototype.isReactComponent={},T.prototype.setState=function(E,de){if(typeof E!="object"&&typeof E!="function"&&E!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,E,de,"setState")},T.prototype.forceUpdate=function(E){this.updater.enqueueForceUpdate(this,E,"forceUpdate")};function P(){}P.prototype=T.prototype;function M(E,de,he){this.props=E,this.context=de,this.refs=k,this.updater=he||v}var R=M.prototype=new P;R.constructor=M,S(R,T.prototype),R.isPureReactComponent=!0;var z=Array.isArray,$={H:null,A:null,T:null,S:null,V:null},L=Object.prototype.hasOwnProperty;function B(E,de,he,D,me,Ce){return he=Ce.ref,{$$typeof:e,type:E,key:de,ref:he!==void 0?he:null,props:Ce}}function q(E,de){return B(E.type,de,void 0,void 0,void 0,E.props)}function W(E){return typeof E=="object"&&E!==null&&E.$$typeof===e}function I(E){var de={"=":"=0",":":"=2"};return"$"+E.replace(/[=:]/g,function(he){return de[he]})}var F=/\/+/g;function V(E,de){return typeof E=="object"&&E!==null&&E.key!=null?I(""+E.key):de.toString(36)}function ee(){}function ie(E){switch(E.status){case"fulfilled":return E.value;case"rejected":throw E.reason;default:switch(typeof E.status=="string"?E.then(ee,ee):(E.status="pending",E.then(function(de){E.status==="pending"&&(E.status="fulfilled",E.value=de)},function(de){E.status==="pending"&&(E.status="rejected",E.reason=de)})),E.status){case"fulfilled":return E.value;case"rejected":throw E.reason}}throw E}function Y(E,de,he,D,me){var Ce=typeof E;(Ce==="undefined"||Ce==="boolean")&&(E=null);var te=!1;if(E===null)te=!0;else switch(Ce){case"bigint":case"string":case"number":te=!0;break;case"object":switch(E.$$typeof){case e:case n:te=!0;break;case h:return te=E._init,Y(te(E._payload),de,he,D,me)}}if(te)return me=me(E),te=D===""?"."+V(E,0):D,z(me)?(he="",te!=null&&(he=te.replace(F,"$&/")+"/"),Y(me,de,he,"",function(xe){return xe})):me!=null&&(W(me)&&(me=q(me,he+(me.key==null||E&&E.key===me.key?"":(""+me.key).replace(F,"$&/")+"/")+te)),de.push(me)),1;te=0;var K=D===""?".":D+":";if(z(E))for(var J=0;J<E.length;J++)D=E[J],Ce=K+V(D,J),te+=Y(D,de,he,Ce,me);else if(J=b(E),typeof J=="function")for(E=J.call(E),J=0;!(D=E.next()).done;)D=D.value,Ce=K+V(D,J++),te+=Y(D,de,he,Ce,me);else if(Ce==="object"){if(typeof E.then=="function")return Y(ie(E),de,he,D,me);throw de=String(E),Error("Objects are not valid as a React child (found: "+(de==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":de)+"). If you meant to render a collection of children, use an array instead.")}return te}function Q(E,de,he){if(E==null)return E;var D=[],me=0;return Y(E,D,"","",function(Ce){return de.call(he,Ce,me++)}),D}function ne(E){if(E._status===-1){var de=E._result;de=de(),de.then(function(he){(E._status===0||E._status===-1)&&(E._status=1,E._result=he)},function(he){(E._status===0||E._status===-1)&&(E._status=2,E._result=he)}),E._status===-1&&(E._status=0,E._result=de)}if(E._status===1)return E._result.default;throw E._result}var le=typeof reportError=="function"?reportError:function(E){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var de=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof E=="object"&&E!==null&&typeof E.message=="string"?String(E.message):String(E),error:E});if(!window.dispatchEvent(de))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",E);return}console.error(E)};function oe(){}return Zt.Children={map:Q,forEach:function(E,de,he){Q(E,function(){de.apply(this,arguments)},he)},count:function(E){var de=0;return Q(E,function(){de++}),de},toArray:function(E){return Q(E,function(de){return de})||[]},only:function(E){if(!W(E))throw Error("React.Children.only expected to receive a single React element child.");return E}},Zt.Component=T,Zt.Fragment=t,Zt.Profiler=a,Zt.PureComponent=M,Zt.StrictMode=r,Zt.Suspense=f,Zt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,Zt.__COMPILER_RUNTIME={__proto__:null,c:function(E){return $.H.useMemoCache(E)}},Zt.cache=function(E){return function(){return E.apply(null,arguments)}},Zt.cloneElement=function(E,de,he){if(E==null)throw Error("The argument must be a React element, but you passed "+E+".");var D=S({},E.props),me=E.key,Ce=void 0;if(de!=null)for(te in de.ref!==void 0&&(Ce=void 0),de.key!==void 0&&(me=""+de.key),de)!L.call(de,te)||te==="key"||te==="__self"||te==="__source"||te==="ref"&&de.ref===void 0||(D[te]=de[te]);var te=arguments.length-2;if(te===1)D.children=he;else if(1<te){for(var K=Array(te),J=0;J<te;J++)K[J]=arguments[J+2];D.children=K}return B(E.type,me,void 0,void 0,Ce,D)},Zt.createContext=function(E){return E={$$typeof:l,_currentValue:E,_currentValue2:E,_threadCount:0,Provider:null,Consumer:null},E.Provider=E,E.Consumer={$$typeof:o,_context:E},E},Zt.createElement=function(E,de,he){var D,me={},Ce=null;if(de!=null)for(D in de.key!==void 0&&(Ce=""+de.key),de)L.call(de,D)&&D!=="key"&&D!=="__self"&&D!=="__source"&&(me[D]=de[D]);var te=arguments.length-2;if(te===1)me.children=he;else if(1<te){for(var K=Array(te),J=0;J<te;J++)K[J]=arguments[J+2];me.children=K}if(E&&E.defaultProps)for(D in te=E.defaultProps,te)me[D]===void 0&&(me[D]=te[D]);return B(E,Ce,void 0,void 0,null,me)},Zt.createRef=function(){return{current:null}},Zt.forwardRef=function(E){return{$$typeof:d,render:E}},Zt.isValidElement=W,Zt.lazy=function(E){return{$$typeof:h,_payload:{_status:-1,_result:E},_init:ne}},Zt.memo=function(E,de){return{$$typeof:u,type:E,compare:de===void 0?null:de}},Zt.startTransition=function(E){var de=$.T,he={};$.T=he;try{var D=E(),me=$.S;me!==null&&me(he,D),typeof D=="object"&&D!==null&&typeof D.then=="function"&&D.then(oe,le)}catch(Ce){le(Ce)}finally{$.T=de}},Zt.unstable_useCacheRefresh=function(){return $.H.useCacheRefresh()},Zt.use=function(E){return $.H.use(E)},Zt.useActionState=function(E,de,he){return $.H.useActionState(E,de,he)},Zt.useCallback=function(E,de){return $.H.useCallback(E,de)},Zt.useContext=function(E){return $.H.useContext(E)},Zt.useDebugValue=function(){},Zt.useDeferredValue=function(E,de){return $.H.useDeferredValue(E,de)},Zt.useEffect=function(E,de,he){var D=$.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return D.useEffect(E,de)},Zt.useId=function(){return $.H.useId()},Zt.useImperativeHandle=function(E,de,he){return $.H.useImperativeHandle(E,de,he)},Zt.useInsertionEffect=function(E,de){return $.H.useInsertionEffect(E,de)},Zt.useLayoutEffect=function(E,de){return $.H.useLayoutEffect(E,de)},Zt.useMemo=function(E,de){return $.H.useMemo(E,de)},Zt.useOptimistic=function(E,de){return $.H.useOptimistic(E,de)},Zt.useReducer=function(E,de,he){return $.H.useReducer(E,de,he)},Zt.useRef=function(E){return $.H.useRef(E)},Zt.useState=function(E){return $.H.useState(E)},Zt.useSyncExternalStore=function(E,de,he){return $.H.useSyncExternalStore(E,de,he)},Zt.useTransition=function(){return $.H.useTransition()},Zt.version="19.1.0",Zt}var ES;function pw(){return ES||(ES=1,Qv.exports=NP()),Qv.exports}var w=pw();const Tn=Wd(w),AS=vP({__proto__:null,default:Tn},[w]);var Jv={exports:{}},km={},Kv={exports:{}},Xv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PS;function CP(){return PS||(PS=1,function(e){function n(Q,ne){var le=Q.length;Q.push(ne);e:for(;0<le;){var oe=le-1>>>1,E=Q[oe];if(0<a(E,ne))Q[oe]=ne,Q[le]=E,le=oe;else break e}}function t(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var ne=Q[0],le=Q.pop();if(le!==ne){Q[0]=le;e:for(var oe=0,E=Q.length,de=E>>>1;oe<de;){var he=2*(oe+1)-1,D=Q[he],me=he+1,Ce=Q[me];if(0>a(D,le))me<E&&0>a(Ce,D)?(Q[oe]=Ce,Q[me]=le,oe=me):(Q[oe]=D,Q[he]=le,oe=he);else if(me<E&&0>a(Ce,le))Q[oe]=Ce,Q[me]=le,oe=me;else break e}}return ne}function a(Q,ne){var le=Q.sortIndex-ne.sortIndex;return le!==0?le:Q.id-ne.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var f=[],u=[],h=1,g=null,b=3,v=!1,S=!1,k=!1,T=!1,P=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function z(Q){for(var ne=t(u);ne!==null;){if(ne.callback===null)r(u);else if(ne.startTime<=Q)r(u),ne.sortIndex=ne.expirationTime,n(f,ne);else break;ne=t(u)}}function $(Q){if(k=!1,z(Q),!S)if(t(f)!==null)S=!0,L||(L=!0,V());else{var ne=t(u);ne!==null&&Y($,ne.startTime-Q)}}var L=!1,B=-1,q=5,W=-1;function I(){return T?!0:!(e.unstable_now()-W<q)}function F(){if(T=!1,L){var Q=e.unstable_now();W=Q;var ne=!0;try{e:{S=!1,k&&(k=!1,M(B),B=-1),v=!0;var le=b;try{t:{for(z(Q),g=t(f);g!==null&&!(g.expirationTime>Q&&I());){var oe=g.callback;if(typeof oe=="function"){g.callback=null,b=g.priorityLevel;var E=oe(g.expirationTime<=Q);if(Q=e.unstable_now(),typeof E=="function"){g.callback=E,z(Q),ne=!0;break t}g===t(f)&&r(f),z(Q)}else r(f);g=t(f)}if(g!==null)ne=!0;else{var de=t(u);de!==null&&Y($,de.startTime-Q),ne=!1}}break e}finally{g=null,b=le,v=!1}ne=void 0}}finally{ne?V():L=!1}}}var V;if(typeof R=="function")V=function(){R(F)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,ie=ee.port2;ee.port1.onmessage=F,V=function(){ie.postMessage(null)}}else V=function(){P(F,0)};function Y(Q,ne){B=P(function(){Q(e.unstable_now())},ne)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(Q){switch(b){case 1:case 2:case 3:var ne=3;break;default:ne=b}var le=b;b=ne;try{return Q()}finally{b=le}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(Q,ne){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var le=b;b=Q;try{return ne()}finally{b=le}},e.unstable_scheduleCallback=function(Q,ne,le){var oe=e.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?oe+le:oe):le=oe,Q){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=le+E,Q={id:h++,callback:ne,priorityLevel:Q,startTime:le,expirationTime:E,sortIndex:-1},le>oe?(Q.sortIndex=le,n(u,Q),t(f)===null&&Q===t(u)&&(k?(M(B),B=-1):k=!0,Y($,le-oe))):(Q.sortIndex=E,n(f,Q),S||v||(S=!0,L||(L=!0,V()))),Q},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(Q){var ne=b;return function(){var le=b;b=ne;try{return Q.apply(this,arguments)}finally{b=le}}}}(Xv)),Xv}var DS;function _P(){return DS||(DS=1,Kv.exports=CP()),Kv.exports}var Zv={exports:{}},Di={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IS;function jP(){if(IS)return Di;IS=1;var e=pw();function n(f){var u="https://react.dev/errors/"+f;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+f+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,u,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:f,containerInfo:u,implementation:h}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,u){if(f==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Di.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Di.createPortal=function(f,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(n(299));return o(f,u,null,h)},Di.flushSync=function(f){var u=l.T,h=r.p;try{if(l.T=null,r.p=2,f)return f()}finally{l.T=u,r.p=h,r.d.f()}},Di.preconnect=function(f,u){typeof f=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(f,u))},Di.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Di.preinit=function(f,u){if(typeof f=="string"&&u&&typeof u.as=="string"){var h=u.as,g=d(h,u.crossOrigin),b=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?r.d.S(f,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):h==="script"&&r.d.X(f,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Di.preinitModule=function(f,u){if(typeof f=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=d(u.as,u.crossOrigin);r.d.M(f,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(f)},Di.preload=function(f,u){if(typeof f=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,g=d(h,u.crossOrigin);r.d.L(f,h,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Di.preloadModule=function(f,u){if(typeof f=="string")if(u){var h=d(u.as,u.crossOrigin);r.d.m(f,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(f)},Di.requestFormReset=function(f){r.d.r(f)},Di.unstable_batchedUpdates=function(f,u){return f(u)},Di.useFormState=function(f,u,h){return l.H.useFormState(f,u,h)},Di.useFormStatus=function(){return l.H.useHostTransitionStatus()},Di.version="19.1.0",Di}var RS;function Xj(){if(RS)return Zv.exports;RS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Zv.exports=jP(),Zv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MS;function kP(){if(MS)return km;MS=1;var e=_P(),n=pw(),t=Xj();function r(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var c=s,p=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(p=c.return),s=c.return;while(s)}return c.tag===3?p:null}function l(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function d(s){if(o(s)!==s)throw Error(r(188))}function f(s){var c=s.alternate;if(!c){if(c=o(s),c===null)throw Error(r(188));return c!==s?null:s}for(var p=s,x=c;;){var N=p.return;if(N===null)break;var A=N.alternate;if(A===null){if(x=N.return,x!==null){p=x;continue}break}if(N.child===A.child){for(A=N.child;A;){if(A===p)return d(N),s;if(A===x)return d(N),c;A=A.sibling}throw Error(r(188))}if(p.return!==x.return)p=N,x=A;else{for(var U=!1,Z=N.child;Z;){if(Z===p){U=!0,p=N,x=A;break}if(Z===x){U=!0,x=N,p=A;break}Z=Z.sibling}if(!U){for(Z=A.child;Z;){if(Z===p){U=!0,p=A,x=N;break}if(Z===x){U=!0,x=A,p=N;break}Z=Z.sibling}if(!U)throw Error(r(189))}}if(p.alternate!==x)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:c}function u(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=u(s),c!==null)return c;s=s.sibling}return null}var h=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),R=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),W=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function V(s){return s===null||typeof s!="object"?null:(s=F&&s[F]||s["@@iterator"],typeof s=="function"?s:null)}var ee=Symbol.for("react.client.reference");function ie(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ee?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case $:return"Suspense";case L:return"SuspenseList";case W:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case R:return(s.displayName||"Context")+".Provider";case M:return(s._context.displayName||"Context")+".Consumer";case z:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case B:return c=s.displayName||null,c!==null?c:ie(s.type)||"Memo";case q:c=s._payload,s=s._init;try{return ie(s(c))}catch{}}return null}var Y=Array.isArray,Q=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},oe=[],E=-1;function de(s){return{current:s}}function he(s){0>E||(s.current=oe[E],oe[E]=null,E--)}function D(s,c){E++,oe[E]=s.current,s.current=c}var me=de(null),Ce=de(null),te=de(null),K=de(null);function J(s,c){switch(D(te,c),D(Ce,s),D(me,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?or(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=or(c),s=dr(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}he(me),D(me,s)}function xe(){he(me),he(Ce),he(te)}function He(s){s.memoizedState!==null&&D(K,s);var c=me.current,p=dr(c,s.type);c!==p&&(D(Ce,s),D(me,p))}function re(s){Ce.current===s&&(he(me),he(Ce)),K.current===s&&(he(K),tu._currentValue=le)}var Be=Object.prototype.hasOwnProperty,Ae=e.unstable_scheduleCallback,Ie=e.unstable_cancelCallback,Ye=e.unstable_shouldYield,at=e.unstable_requestPaint,Ze=e.unstable_now,Ke=e.unstable_getCurrentPriorityLevel,st=e.unstable_ImmediatePriority,yt=e.unstable_UserBlockingPriority,je=e.unstable_NormalPriority,Ge=e.unstable_LowPriority,_e=e.unstable_IdlePriority,pe=e.log,ce=e.unstable_setDisableYieldValue,G=null,fe=null;function Ne(s){if(typeof pe=="function"&&ce(s),fe&&typeof fe.setStrictMode=="function")try{fe.setStrictMode(G,s)}catch{}}var Le=Math.clz32?Math.clz32:St,tt=Math.log,xt=Math.LN2;function St(s){return s>>>=0,s===0?32:31-(tt(s)/xt|0)|0}var we=256,ye=4194304;function Oe(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function De(s,c,p){var x=s.pendingLanes;if(x===0)return 0;var N=0,A=s.suspendedLanes,U=s.pingedLanes;s=s.warmLanes;var Z=x&134217727;return Z!==0?(x=Z&~A,x!==0?N=Oe(x):(U&=Z,U!==0?N=Oe(U):p||(p=Z&~s,p!==0&&(N=Oe(p))))):(Z=x&~A,Z!==0?N=Oe(Z):U!==0?N=Oe(U):p||(p=x&~s,p!==0&&(N=Oe(p)))),N===0?0:c!==0&&c!==N&&(c&A)===0&&(A=N&-N,p=c&-c,A>=p||A===32&&(p&4194048)!==0)?c:N}function Ve(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function ot(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mt(){var s=we;return we<<=1,(we&4194048)===0&&(we=256),s}function Nt(){var s=ye;return ye<<=1,(ye&62914560)===0&&(ye=4194304),s}function cn(s){for(var c=[],p=0;31>p;p++)c.push(s);return c}function fn(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function wn(s,c,p,x,N,A){var U=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var Z=s.entanglements,Se=s.expirationTimes,$e=s.hiddenUpdates;for(p=U&~p;0<p;){var Je=31-Le(p),rt=1<<Je;Z[Je]=0,Se[Je]=-1;var Ue=$e[Je];if(Ue!==null)for($e[Je]=null,Je=0;Je<Ue.length;Je++){var ze=Ue[Je];ze!==null&&(ze.lane&=-536870913)}p&=~rt}x!==0&&Tt(s,x,0),A!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=A&~(U&~c))}function Tt(s,c,p){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-Le(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|p&4194090}function Ct(s,c){var p=s.entangledLanes|=c;for(s=s.entanglements;p;){var x=31-Le(p),N=1<<x;N&c|s[x]&c&&(s[x]|=c),p&=~N}}function Yt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function It(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Kn(){var s=ne.p;return s!==0?s:(s=window.event,s===void 0?32:dx(s.type))}function Yr(s,c){var p=ne.p;try{return ne.p=s,c()}finally{ne.p=p}}var hr=Math.random().toString(36).slice(2),An="__reactFiber$"+hr,Sr="__reactProps$"+hr,Xr="__reactContainer$"+hr,_s="__reactEvents$"+hr,Kd="__reactListeners$"+hr,Xd="__reactHandles$"+hr,Zd="__reactResources$"+hr,js="__reactMarker$"+hr;function xu(s){delete s[An],delete s[Sr],delete s[_s],delete s[Kd],delete s[Xd]}function va(s){var c=s[An];if(c)return c;for(var p=s.parentNode;p;){if(c=p[Xr]||p[An]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(s=Zy(s);s!==null;){if(p=s[An])return p;s=Zy(s)}return c}s=p,p=s.parentNode}return null}function ks(s){if(s=s[An]||s[Xr]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function Ts(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(r(33))}function Es(s){var c=s[Zd];return c||(c=s[Zd]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Nr(s){s[js]=!0}var ef=new Set,tf={};function As(s,c){co(s,c),co(s+"Capture",c)}function co(s,c){for(tf[s]=c,s=0;s<c.length;s++)ef.add(c[s])}var ec=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nf={},cl={};function ip(s){return Be.call(cl,s)?!0:Be.call(nf,s)?!1:ec.test(s)?cl[s]=!0:(nf[s]=!0,!1)}function tc(s,c,p){if(ip(c))if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+p)}}function uo(s,c,p){if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+p)}}function wr(s,c,p,x){if(x===null)s.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(p);return}s.setAttributeNS(c,p,""+x)}}var Ja,nc;function Ps(s){if(Ja===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);Ja=c&&c[1]||"",nc=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ja+s+nc}var rc=!1;function ul(s,c){if(!s||rc)return"";rc=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var rt=function(){throw Error()};if(Object.defineProperty(rt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(rt,[])}catch(ze){var Ue=ze}Reflect.construct(s,[],rt)}else{try{rt.call()}catch(ze){Ue=ze}s.call(rt.prototype)}}else{try{throw Error()}catch(ze){Ue=ze}(rt=s())&&typeof rt.catch=="function"&&rt.catch(function(){})}}catch(ze){if(ze&&Ue&&typeof ze.stack=="string")return[ze.stack,Ue.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=x.DetermineComponentFrameRoot(),U=A[0],Z=A[1];if(U&&Z){var Se=U.split(`
`),$e=Z.split(`
`);for(N=x=0;x<Se.length&&!Se[x].includes("DetermineComponentFrameRoot");)x++;for(;N<$e.length&&!$e[N].includes("DetermineComponentFrameRoot");)N++;if(x===Se.length||N===$e.length)for(x=Se.length-1,N=$e.length-1;1<=x&&0<=N&&Se[x]!==$e[N];)N--;for(;1<=x&&0<=N;x--,N--)if(Se[x]!==$e[N]){if(x!==1||N!==1)do if(x--,N--,0>N||Se[x]!==$e[N]){var Je=`
`+Se[x].replace(" at new "," at ");return s.displayName&&Je.includes("<anonymous>")&&(Je=Je.replace("<anonymous>",s.displayName)),Je}while(1<=x&&0<=N);break}}}finally{rc=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?Ps(p):""}function bu(s){switch(s.tag){case 26:case 27:case 5:return Ps(s.type);case 16:return Ps("Lazy");case 13:return Ps("Suspense");case 19:return Ps("SuspenseList");case 0:case 15:return ul(s.type,!1);case 11:return ul(s.type.render,!1);case 1:return ul(s.type,!0);case 31:return Ps("Activity");default:return""}}function ic(s){try{var c="";do c+=bu(s),s=s.return;while(s);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function Zr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function fo(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function vu(s){var c=fo(s)?"checked":"value",p=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,A=p.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return N.call(this)},set:function(U){x=""+U,A.call(this,U)}}),Object.defineProperty(s,c,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(U){x=""+U},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function ac(s){s._valueTracker||(s._valueTracker=vu(s))}function sc(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var p=c.getValue(),x="";return s&&(x=fo(s)?s.checked?"true":"false":s.value),s=x,s!==p?(c.setValue(s),!0):!1}function Ka(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var wu=/[\n"\\]/g;function di(s){return s.replace(wu,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function dl(s,c,p,x,N,A,U,Z){s.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?s.type=U:s.removeAttribute("type"),c!=null?U==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+Zr(c)):s.value!==""+Zr(c)&&(s.value=""+Zr(c)):U!=="submit"&&U!=="reset"||s.removeAttribute("value"),c!=null?fl(s,U,Zr(c)):p!=null?fl(s,U,Zr(p)):x!=null&&s.removeAttribute("value"),N==null&&A!=null&&(s.defaultChecked=!!A),N!=null&&(s.checked=N&&typeof N!="function"&&typeof N!="symbol"),Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?s.name=""+Zr(Z):s.removeAttribute("name")}function Su(s,c,p,x,N,A,U,Z){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.type=A),c!=null||p!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;p=p!=null?""+Zr(p):"",c=c!=null?""+Zr(c):p,Z||c===s.value||(s.value=c),s.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=Z?s.checked:!!x,s.defaultChecked=!!x,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(s.name=U)}function fl(s,c,p){c==="number"&&Ka(s.ownerDocument)===s||s.defaultValue===""+p||(s.defaultValue=""+p)}function wa(s,c,p,x){if(s=s.options,c){c={};for(var N=0;N<p.length;N++)c["$"+p[N]]=!0;for(p=0;p<s.length;p++)N=c.hasOwnProperty("$"+s[p].value),s[p].selected!==N&&(s[p].selected=N),N&&x&&(s[p].defaultSelected=!0)}else{for(p=""+Zr(p),c=null,N=0;N<s.length;N++){if(s[N].value===p){s[N].selected=!0,x&&(s[N].defaultSelected=!0);return}c!==null||s[N].disabled||(c=s[N])}c!==null&&(c.selected=!0)}}function oc(s,c,p){if(c!=null&&(c=""+Zr(c),c!==s.value&&(s.value=c),p==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=p!=null?""+Zr(p):""}function ho(s,c,p,x){if(c==null){if(x!=null){if(p!=null)throw Error(r(92));if(Y(x)){if(1<x.length)throw Error(r(93));x=x[0]}p=x}p==null&&(p=""),c=p}p=Zr(c),s.defaultValue=p,x=s.textContent,x===p&&x!==""&&x!==null&&(s.value=x)}function Sa(s,c){if(c){var p=s.firstChild;if(p&&p===s.lastChild&&p.nodeType===3){p.nodeValue=c;return}}s.textContent=c}var Xa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function lc(s,c,p){var x=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,p):typeof p!="number"||p===0||Xa.has(c)?c==="float"?s.cssFloat=p:s[c]=(""+p).trim():s[c]=p+"px"}function hl(s,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(s=s.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&p[N]!==x&&lc(s,N,x)}else for(var A in c)c.hasOwnProperty(A)&&lc(s,A,c[A])}function cc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uc=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Za(s){return Nu.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var es=null;function po(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ds=null,Na=null;function Cu(s){var c=ks(s);if(c&&(s=c.stateNode)){var p=s[Sr]||null;e:switch(s=c.stateNode,c.type){case"input":if(dl(s,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+di(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var x=p[c];if(x!==s&&x.form===s.form){var N=x[Sr]||null;if(!N)throw Error(r(90));dl(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<p.length;c++)x=p[c],x.form===s.form&&sc(x)}break e;case"textarea":oc(s,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&wa(s,!!p.multiple,c,!1)}}}var pl=!1;function dc(s,c,p){if(pl)return s(c,p);pl=!0;try{var x=s(c);return x}finally{if(pl=!1,(Ds!==null||Na!==null)&&(Jf(),Ds&&(c=Ds,s=Na,Na=Ds=null,Cu(c),s)))for(c=0;c<s.length;c++)Cu(s[c])}}function Is(s,c){var p=s.stateNode;if(p===null)return null;var x=p[Sr]||null;if(x===null)return null;p=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var $i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rs=!1;if($i)try{var Ms={};Object.defineProperty(Ms,"passive",{get:function(){Rs=!0}}),window.addEventListener("test",Ms,Ms),window.removeEventListener("test",Ms,Ms)}catch{Rs=!1}var Zi=null,ml=null,mo=null;function ea(){if(mo)return mo;var s,c=ml,p=c.length,x,N="value"in Zi?Zi.value:Zi.textContent,A=N.length;for(s=0;s<p&&c[s]===N[s];s++);var U=p-s;for(x=1;x<=U&&c[p-x]===N[A-x];x++);return mo=N.slice(s,1<x?1-x:void 0)}function jn(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function kn(){return!0}function ts(){return!1}function ei(s){function c(p,x,N,A,U){this._reactName=p,this._targetInst=N,this.type=x,this.nativeEvent=A,this.target=U,this.currentTarget=null;for(var Z in s)s.hasOwnProperty(Z)&&(p=s[Z],this[Z]=p?p(A):A[Z]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?kn:ts,this.isPropagationStopped=ts,this}return h(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=kn)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=kn)},persist:function(){},isPersistent:kn}),c}var Ca={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fc=ei(Ca),Os=h({},Ca,{view:0,detail:0}),gl=ei(Os),hc,go,nr,ns=h({},Os,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ri,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==nr&&(nr&&s.type==="mousemove"?(hc=s.screenX-nr.screenX,go=s.screenY-nr.screenY):go=hc=0,nr=s),hc)},movementY:function(s){return"movementY"in s?s.movementY:go}}),_a=ei(ns),_u=h({},ns,{dataTransfer:0}),pc=ei(_u),ti=h({},Os,{relatedTarget:0}),yl=ei(ti),xl=h({},Ca,{animationName:0,elapsedTime:0,pseudoElement:0}),bl=ei(xl),rf=h({},Ca,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),mc=ei(rf),gc=h({},Ca,{data:0}),Wr=ei(gc),Dn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ni={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xc(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=yc[s])?!!c[s]:!1}function ri(){return xc}var rs=h({},Os,{key:function(s){if(s.key){var c=Dn[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=jn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ni[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ri,charCode:function(s){return s.type==="keypress"?jn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?jn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ju=ei(rs),Vn=h({},ns,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ii=ei(Vn),bc=h({},Os,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ri}),ku=ei(bc),yo=h({},Ca,{propertyName:0,elapsedTime:0,pseudoElement:0}),xo=ei(yo),af=h({},ns,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ap=ei(af),Tu=h({},Ca,{newState:0,oldState:0}),is=ei(Tu),bo=[9,13,27,32],as=$i&&"CompositionEvent"in window,vo=null;$i&&"documentMode"in document&&(vo=document.documentMode);var Eu=$i&&"TextEvent"in window&&!vo,ja=$i&&(!as||vo&&8<vo&&11>=vo),ka=" ",Ls=!1;function Au(s,c){switch(s){case"keyup":return bo.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wo(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ta=!1;function vc(s,c){switch(s){case"compositionend":return wo(c);case"keypress":return c.which!==32?null:(Ls=!0,ka);case"textInput":return s=c.data,s===ka&&Ls?null:s;default:return null}}function Pu(s,c){if(Ta)return s==="compositionend"||!as&&Au(s,c)?(s=ea(),mo=ml=Zi=null,Ta=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return ja&&c.locale!=="ko"?null:c.data;default:return null}}var fi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wc(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!fi[s.type]:c==="textarea"}function So(s,c,p,x){Ds?Na?Na.push(x):Na=[x]:Ds=x,c=rh(c,"onChange"),0<c.length&&(p=new fc("onChange","change",null,p,x),s.push({event:p,listeners:c}))}var No=null,Co=null;function sp(s){Hy(s,0)}function Sc(s){var c=Ts(s);if(sc(c))return s}function sf(s,c){if(s==="change")return c}var of=!1;if($i){var Nc;if($i){var ss="oninput"in document;if(!ss){var vl=document.createElement("div");vl.setAttribute("oninput","return;"),ss=typeof vl.oninput=="function"}Nc=ss}else Nc=!1;of=Nc&&(!document.documentMode||9<document.documentMode)}function lf(){No&&(No.detachEvent("onpropertychange",zi),Co=No=null)}function zi(s){if(s.propertyName==="value"&&Sc(Co)){var c=[];So(c,Co,s,po(s)),dc(sp,c)}}function Ea(s,c,p){s==="focusin"?(lf(),No=c,Co=p,No.attachEvent("onpropertychange",zi)):s==="focusout"&&lf()}function Lr(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Sc(Co)}function wl(s,c){if(s==="click")return Sc(c)}function cf(s,c){if(s==="input"||s==="change")return Sc(c)}function uf(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var ai=typeof Object.is=="function"?Object.is:uf;function si(s,c){if(ai(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var p=Object.keys(s),x=Object.keys(c);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var N=p[x];if(!Be.call(c,N)||!ai(s[N],c[N]))return!1}return!0}function hi(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Cc(s,c){var p=hi(s);s=0;for(var x;p;){if(p.nodeType===3){if(x=s+p.textContent.length,s<=c&&x>=c)return{node:p,offset:c-s};s=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=hi(p)}}function df(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?df(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function Du(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=Ka(s.document);c instanceof s.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)s=c.contentWindow;else break;c=Ka(s.document)}return c}function Iu(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var op=$i&&"documentMode"in document&&11>=document.documentMode,_o=null,os=null,Pe=null,Qe=!1;function qe(s,c,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Qe||_o==null||_o!==Ka(x)||(x=_o,"selectionStart"in x&&Iu(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Pe&&si(Pe,x)||(Pe=x,x=rh(os,"onSelect"),0<x.length&&(c=new fc("onSelect","select",null,c,p),s.push({event:c,listeners:x}),c.target=_o)))}function ht(s,c){var p={};return p[s.toLowerCase()]=c.toLowerCase(),p["Webkit"+s]="webkit"+c,p["Moz"+s]="moz"+c,p}var Pt={animationend:ht("Animation","AnimationEnd"),animationiteration:ht("Animation","AnimationIteration"),animationstart:ht("Animation","AnimationStart"),transitionrun:ht("Transition","TransitionRun"),transitionstart:ht("Transition","TransitionStart"),transitioncancel:ht("Transition","TransitionCancel"),transitionend:ht("Transition","TransitionEnd")},hn={},rr={};$i&&(rr=document.createElement("div").style,"AnimationEvent"in window||(delete Pt.animationend.animation,delete Pt.animationiteration.animation,delete Pt.animationstart.animation),"TransitionEvent"in window||delete Pt.transitionend.transition);function pn(s){if(hn[s])return hn[s];if(!Pt[s])return s;var c=Pt[s],p;for(p in c)if(c.hasOwnProperty(p)&&p in rr)return hn[s]=c[p];return s}var pi=pn("animationend"),ff=pn("animationiteration"),mi=pn("animationstart"),Sl=pn("transitionrun"),lp=pn("transitionstart"),jo=pn("transitioncancel"),Nl=pn("transitionend"),Cl=new Map,Sn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Sn.push("scrollEnd");function Bi(s,c){Cl.set(s,c),As(c,[s])}var Ru=new WeakMap;function Qr(s,c){if(typeof s=="object"&&s!==null){var p=Ru.get(s);return p!==void 0?p:(c={value:s,source:c,stack:ic(c)},Ru.set(s,c),c)}return{value:s,source:c,stack:ic(c)}}var wi=[],Fs=0,_c=0;function ls(){for(var s=Fs,c=_c=Fs=0;c<s;){var p=wi[c];wi[c++]=null;var x=wi[c];wi[c++]=null;var N=wi[c];wi[c++]=null;var A=wi[c];if(wi[c++]=null,x!==null&&N!==null){var U=x.pending;U===null?N.next=N:(N.next=U.next,U.next=N),x.pending=N}A!==0&&Te(p,N,A)}}function ae(s,c,p,x){wi[Fs++]=s,wi[Fs++]=c,wi[Fs++]=p,wi[Fs++]=x,_c|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function be(s,c,p,x){return ae(s,c,p,x),et(s)}function ue(s,c){return ae(s,null,null,c),et(s)}function Te(s,c,p){s.lanes|=p;var x=s.alternate;x!==null&&(x.lanes|=p);for(var N=!1,A=s.return;A!==null;)A.childLanes|=p,x=A.alternate,x!==null&&(x.childLanes|=p),A.tag===22&&(s=A.stateNode,s===null||s._visibility&1||(N=!0)),s=A,A=A.return;return s.tag===3?(A=s.stateNode,N&&c!==null&&(N=31-Le(p),s=A.hiddenUpdates,x=s[N],x===null?s[N]=[c]:x.push(c),c.lane=p|536870912),A):null}function et(s){if(50<Yc)throw Yc=0,nm=null,Error(r(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var ft={};function kt(s,c,p,x){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wt(s,c,p,x){return new kt(s,c,p,x)}function pr(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Xn(s,c){var p=s.alternate;return p===null?(p=wt(s.tag,c,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=c,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,c=s.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function _l(s,c){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,c=p.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function hf(s,c,p,x,N,A){var U=0;if(x=s,typeof s=="function")pr(s)&&(U=1);else if(typeof s=="string")U=Rv(s,p,me.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case W:return s=wt(31,p,c,N),s.elementType=W,s.lanes=A,s;case S:return jl(p.children,N,A,c);case k:U=8,N|=24;break;case T:return s=wt(12,p,c,N|2),s.elementType=T,s.lanes=A,s;case $:return s=wt(13,p,c,N),s.elementType=$,s.lanes=A,s;case L:return s=wt(19,p,c,N),s.elementType=L,s.lanes=A,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case P:case R:U=10;break e;case M:U=9;break e;case z:U=11;break e;case B:U=14;break e;case q:U=16,x=null;break e}U=29,p=Error(r(130,s===null?"null":typeof s,"")),x=null}return c=wt(U,p,c,N),c.elementType=s,c.type=x,c.lanes=A,c}function jl(s,c,p,x){return s=wt(7,s,x,c),s.lanes=p,s}function cp(s,c,p){return s=wt(6,s,null,c),s.lanes=p,s}function jc(s,c,p){return c=wt(4,s.children!==null?s.children:[],s.key,c),c.lanes=p,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var $s=[],ko=0,pf=null,Mu=0,ta=[],na=0,Zn=null,ir=1,zs="";function kl(s,c){$s[ko++]=Mu,$s[ko++]=pf,pf=s,Mu=c}function up(s,c,p){ta[na++]=ir,ta[na++]=zs,ta[na++]=Zn,Zn=s;var x=ir;s=zs;var N=32-Le(x)-1;x&=~(1<<N),p+=1;var A=32-Le(c)+N;if(30<A){var U=N-N%5;A=(x&(1<<U)-1).toString(32),x>>=U,N-=U,ir=1<<32-Le(c)+N|p<<N|x,zs=A+s}else ir=1<<A|p<<N|x,zs=s}function dp(s){s.return!==null&&(kl(s,1),up(s,1,0))}function Ou(s){for(;s===pf;)pf=$s[--ko],$s[ko]=null,Mu=$s[--ko],$s[ko]=null;for(;s===Zn;)Zn=ta[--na],ta[na]=null,zs=ta[--na],ta[na]=null,ir=ta[--na],ta[na]=null}var Er=null,ar=null,un=!1,Aa=null,Si=!1,kc=Error(r(519));function ra(s){var c=Error(r(418,""));throw To(Qr(c,s)),kc}function _g(s){var c=s.stateNode,p=s.type,x=s.memoizedProps;switch(c[An]=s,c[Sr]=x,p){case"dialog":ln("cancel",c),ln("close",c);break;case"iframe":case"object":case"embed":ln("load",c);break;case"video":case"audio":for(p=0;p<Cd.length;p++)ln(Cd[p],c);break;case"source":ln("error",c);break;case"img":case"image":case"link":ln("error",c),ln("load",c);break;case"details":ln("toggle",c);break;case"input":ln("invalid",c),Su(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),ac(c);break;case"select":ln("invalid",c);break;case"textarea":ln("invalid",c),ho(c,x.value,x.defaultValue,x.children),ac(c)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||x.suppressHydrationWarning===!0||Wy(c.textContent,p)?(x.popover!=null&&(ln("beforetoggle",c),ln("toggle",c)),x.onScroll!=null&&ln("scroll",c),x.onScrollEnd!=null&&ln("scrollend",c),x.onClick!=null&&(c.onclick=ih),c=!0):c=!1,c||ra(s)}function jg(s){for(Er=s.return;Er;)switch(Er.tag){case 5:case 13:Si=!1;return;case 27:case 3:Si=!0;return;default:Er=Er.return}}function Lu(s){if(s!==Er)return!1;if(!un)return jg(s),un=!0,!1;var c=s.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=s.type,p=!(p!=="form"&&p!=="button")||sh(s.type,s.memoizedProps)),p=!p),p&&ar&&ra(s),jg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(p=s.data,p==="/$"){if(c===0){ar=Oa(s.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++;s=s.nextSibling}ar=null}}else c===27?(c=ar,ca(s.type)?(s=gm,gm=null,ar=s):ar=c):ar=Er?Oa(s.stateNode.nextSibling):null;return!0}function Fu(){ar=Er=null,un=!1}function kg(){var s=Aa;return s!==null&&(Ai===null?Ai=s:Ai.push.apply(Ai,s),Aa=null),s}function To(s){Aa===null?Aa=[s]:Aa.push(s)}var Tl=de(null),Eo=null,X=null;function Ui(s,c,p){D(Tl,c._currentValue),c._currentValue=p}function ia(s){s._currentValue=Tl.current,he(Tl)}function Ni(s,c,p){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===p)break;s=s.return}}function nn(s,c,p,x){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var A=N.dependencies;if(A!==null){var U=N.child;A=A.firstContext;e:for(;A!==null;){var Z=A;A=N;for(var Se=0;Se<c.length;Se++)if(Z.context===c[Se]){A.lanes|=p,Z=A.alternate,Z!==null&&(Z.lanes|=p),Ni(A.return,p,s),x||(U=null);break e}A=Z.next}}else if(N.tag===18){if(U=N.return,U===null)throw Error(r(341));U.lanes|=p,A=U.alternate,A!==null&&(A.lanes|=p),Ni(U,p,s),U=null}else U=N.child;if(U!==null)U.return=N;else for(U=N;U!==null;){if(U===s){U=null;break}if(N=U.sibling,N!==null){N.return=U.return,U=N;break}U=U.return}N=U}}function $u(s,c,p,x){s=null;for(var N=c,A=!1;N!==null;){if(!A){if((N.flags&524288)!==0)A=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var U=N.alternate;if(U===null)throw Error(r(387));if(U=U.memoizedProps,U!==null){var Z=N.type;ai(N.pendingProps.value,U.value)||(s!==null?s.push(Z):s=[Z])}}else if(N===K.current){if(U=N.alternate,U===null)throw Error(r(387));U.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(tu):s=[tu])}N=N.return}s!==null&&nn(c,s,p,x),c.flags|=262144}function mf(s){for(s=s.firstContext;s!==null;){if(!ai(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function El(s){Eo=s,X=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function mr(s){return Tg(Eo,s)}function gf(s,c){return Eo===null&&El(s),Tg(s,c)}function Tg(s,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},X===null){if(s===null)throw Error(r(308));X=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else X=X.next=c;return p}var iv=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(p,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(p){return p()})}},av=e.unstable_scheduleCallback,sv=e.unstable_NormalPriority,Hn={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fp(){return{controller:new iv,data:new Map,refCount:0}}function zu(s){s.refCount--,s.refCount===0&&av(sv,function(){s.controller.abort()})}var Bu=null,hp=0,Tc=0,Ci=null;function ov(s,c){if(Bu===null){var p=Bu=[];hp=0,Tc=nh(),Ci={status:"pending",value:void 0,then:function(x){p.push(x)}}}return hp++,c.then(Eg,Eg),c}function Eg(){if(--hp===0&&Bu!==null){Ci!==null&&(Ci.status="fulfilled");var s=Bu;Bu=null,Tc=0,Ci=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function lv(s,c){var p=[],x={status:"pending",value:null,reason:null,then:function(N){p.push(N)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<p.length;N++)(0,p[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<p.length;N++)(0,p[N])(void 0)}),x}var Ag=Q.S;Q.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&ov(s,c),Ag!==null&&Ag(s,c)};var Al=de(null);function Bs(){var s=Al.current;return s!==null?s:Qn.pooledCache}function yf(s,c){c===null?D(Al,Al.current):D(Al,c.pool)}function Pg(){var s=Bs();return s===null?null:{parent:Hn._currentValue,pool:s}}var gi=Error(r(460)),Dg=Error(r(474)),xf=Error(r(542)),pp={then:function(){}};function Ig(s){return s=s.status,s==="fulfilled"||s==="rejected"}function bf(){}function mp(s,c,p){switch(p=s[p],p===void 0?s.push(c):p!==c&&(c.then(bf,bf),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Mg(s),s;default:if(typeof c.status=="string")c.then(bf,bf);else{if(s=Qn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Mg(s),s}throw Ec=c,gi}}var Ec=null;function Rg(){if(Ec===null)throw Error(r(459));var s=Ec;return Ec=null,s}function Mg(s){if(s===gi||s===xf)throw Error(r(483))}var cs=!1;function Pl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ac(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ao(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Us(s,c,p){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Mn&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=et(s),Te(s,null,p),c}return ae(s,x,c,p),et(s)}function Uu(s,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Ct(s,p)}}function Pa(s,c){var p=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var N=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var U={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};A===null?N=A=U:A=A.next=U,p=p.next}while(p!==null);A===null?N=A=c:A=A.next=c}else N=A=c;p={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:A,shared:x.shared,callbacks:x.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=c:s.next=c,p.lastBaseUpdate=c}var qu=!1;function Da(){if(qu){var s=Ci;if(s!==null)throw s}}function oi(s,c,p,x){qu=!1;var N=s.updateQueue;cs=!1;var A=N.firstBaseUpdate,U=N.lastBaseUpdate,Z=N.shared.pending;if(Z!==null){N.shared.pending=null;var Se=Z,$e=Se.next;Se.next=null,U===null?A=$e:U.next=$e,U=Se;var Je=s.alternate;Je!==null&&(Je=Je.updateQueue,Z=Je.lastBaseUpdate,Z!==U&&(Z===null?Je.firstBaseUpdate=$e:Z.next=$e,Je.lastBaseUpdate=Se))}if(A!==null){var rt=N.baseState;U=0,Je=$e=Se=null,Z=A;do{var Ue=Z.lane&-536870913,ze=Ue!==Z.lane;if(ze?(bn&Ue)===Ue:(x&Ue)===Ue){Ue!==0&&Ue===Tc&&(qu=!0),Je!==null&&(Je=Je.next={lane:0,tag:Z.tag,payload:Z.payload,callback:null,next:null});e:{var Ot=s,Mt=Z;Ue=c;var Bn=p;switch(Mt.tag){case 1:if(Ot=Mt.payload,typeof Ot=="function"){rt=Ot.call(Bn,rt,Ue);break e}rt=Ot;break e;case 3:Ot.flags=Ot.flags&-65537|128;case 0:if(Ot=Mt.payload,Ue=typeof Ot=="function"?Ot.call(Bn,rt,Ue):Ot,Ue==null)break e;rt=h({},rt,Ue);break e;case 2:cs=!0}}Ue=Z.callback,Ue!==null&&(s.flags|=64,ze&&(s.flags|=8192),ze=N.callbacks,ze===null?N.callbacks=[Ue]:ze.push(Ue))}else ze={lane:Ue,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Je===null?($e=Je=ze,Se=rt):Je=Je.next=ze,U|=Ue;if(Z=Z.next,Z===null){if(Z=N.shared.pending,Z===null)break;ze=Z,Z=ze.next,ze.next=null,N.lastBaseUpdate=ze,N.shared.pending=null}}while(!0);Je===null&&(Se=rt),N.baseState=Se,N.firstBaseUpdate=$e,N.lastBaseUpdate=Je,A===null&&(N.shared.lanes=0),$o|=U,s.lanes=U,s.memoizedState=rt}}function Og(s,c){if(typeof s!="function")throw Error(r(191,s));s.call(c)}function gp(s,c){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Og(p[s],c)}var Dl=de(null),Po=de(0);function qs(s,c){s=Xs,D(Po,s),D(Dl,c),Xs=s|c.baseLanes}function vf(){D(Po,Xs),D(Dl,Dl.current)}function yp(){Xs=Po.current,he(Dl),he(Po)}var Ia=0,Xt=null,Rn=null,dn=null,Pc=!1,Il=!1,li=!1,Dc=0,Do=0,aa=null,Lg=0;function mn(){throw Error(r(321))}function Vu(s,c){if(c===null)return!1;for(var p=0;p<c.length&&p<s.length;p++)if(!ai(s[p],c[p]))return!1;return!0}function xp(s,c,p,x,N,A){return Ia=A,Xt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Q.H=s===null||s.memoizedState===null?Jg:Op,li=!1,A=p(x,N),li=!1,Il&&(A=$g(c,p,x,N)),Fg(s),A}function Fg(s){Q.H=td;var c=Rn!==null&&Rn.next!==null;if(Ia=0,dn=Rn=Xt=null,Pc=!1,Do=0,aa=null,c)throw Error(r(300));s===null||Fr||(s=s.dependencies,s!==null&&mf(s)&&(Fr=!0))}function $g(s,c,p,x){Xt=s;var N=0;do{if(Il&&(aa=null),Do=0,Il=!1,25<=N)throw Error(r(301));if(N+=1,dn=Rn=null,s.updateQueue!=null){var A=s.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}Q.H=Kg,A=c(p,x)}while(Il);return A}function bp(){var s=Q.H,c=s.useState()[0];return c=typeof c.then=="function"?Hu(c):c,s=s.useState()[0],(Rn!==null?Rn.memoizedState:null)!==s&&(Xt.flags|=1024),c}function vp(){var s=Dc!==0;return Dc=0,s}function Rl(s,c,p){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~p}function wf(s){if(Pc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}Pc=!1}Ia=0,dn=Rn=Xt=null,Il=!1,Do=Dc=0,aa=null}function _i(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?Xt.memoizedState=dn=s:dn=dn.next=s,dn}function Cr(){if(Rn===null){var s=Xt.alternate;s=s!==null?s.memoizedState:null}else s=Rn.next;var c=dn===null?Xt.memoizedState:dn.next;if(c!==null)dn=c,Rn=s;else{if(s===null)throw Xt.alternate===null?Error(r(467)):Error(r(310));Rn=s,s={memoizedState:Rn.memoizedState,baseState:Rn.baseState,baseQueue:Rn.baseQueue,queue:Rn.queue,next:null},dn===null?Xt.memoizedState=dn=s:dn=dn.next=s}return dn}function Ml(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Hu(s){var c=Do;return Do+=1,aa===null&&(aa=[]),s=mp(aa,s,c),c=Xt,(dn===null?c.memoizedState:dn.next)===null&&(c=c.alternate,Q.H=c===null||c.memoizedState===null?Jg:Op),s}function Sf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Hu(s);if(s.$$typeof===R)return mr(s)}throw Error(r(438,String(s)))}function Gu(s){var c=null,p=Xt.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var x=Xt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=Ml(),Xt.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(s),x=0;x<s;x++)p[x]=I;return c.index++,p}function us(s,c){return typeof c=="function"?c(s):c}function Nf(s){var c=Cr();return wp(c,Rn,s)}function wp(s,c,p){var x=s.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=p;var N=s.baseQueue,A=x.pending;if(A!==null){if(N!==null){var U=N.next;N.next=A.next,A.next=U}c.baseQueue=N=A,x.pending=null}if(A=s.baseState,N===null)s.memoizedState=A;else{c=N.next;var Z=U=null,Se=null,$e=c,Je=!1;do{var rt=$e.lane&-536870913;if(rt!==$e.lane?(bn&rt)===rt:(Ia&rt)===rt){var Ue=$e.revertLane;if(Ue===0)Se!==null&&(Se=Se.next={lane:0,revertLane:0,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null}),rt===Tc&&(Je=!0);else if((Ia&Ue)===Ue){$e=$e.next,Ue===Tc&&(Je=!0);continue}else rt={lane:0,revertLane:$e.revertLane,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},Se===null?(Z=Se=rt,U=A):Se=Se.next=rt,Xt.lanes|=Ue,$o|=Ue;rt=$e.action,li&&p(A,rt),A=$e.hasEagerState?$e.eagerState:p(A,rt)}else Ue={lane:rt,revertLane:$e.revertLane,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},Se===null?(Z=Se=Ue,U=A):Se=Se.next=Ue,Xt.lanes|=rt,$o|=rt;$e=$e.next}while($e!==null&&$e!==c);if(Se===null?U=A:Se.next=Z,!ai(A,s.memoizedState)&&(Fr=!0,Je&&(p=Ci,p!==null)))throw p;s.memoizedState=A,s.baseState=U,s.baseQueue=Se,x.lastRenderedState=A}return N===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function Sp(s){var c=Cr(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var x=p.dispatch,N=p.pending,A=c.memoizedState;if(N!==null){p.pending=null;var U=N=N.next;do A=s(A,U.action),U=U.next;while(U!==N);ai(A,c.memoizedState)||(Fr=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),p.lastRenderedState=A}return[A,x]}function Np(s,c,p){var x=Xt,N=Cr(),A=un;if(A){if(p===void 0)throw Error(r(407));p=p()}else p=c();var U=!ai((Rn||N).memoizedState,p);U&&(N.memoizedState=p,Fr=!0),N=N.queue;var Z=_f.bind(null,x,N,s);if(Qu(2048,8,Z,[s]),N.getSnapshot!==c||U||dn!==null&&dn.memoizedState.tag&1){if(x.flags|=2048,Ic(9,Af(),zg.bind(null,x,N,p,c),null),Qn===null)throw Error(r(349));A||(Ia&124)!==0||Cf(x,c,p)}return p}function Cf(s,c,p){s.flags|=16384,s={getSnapshot:c,value:p},c=Xt.updateQueue,c===null?(c=Ml(),Xt.updateQueue=c,c.stores=[s]):(p=c.stores,p===null?c.stores=[s]:p.push(s))}function zg(s,c,p,x){c.value=p,c.getSnapshot=x,Cp(c)&&_p(s)}function _f(s,c,p){return p(function(){Cp(c)&&_p(s)})}function Cp(s){var c=s.getSnapshot;s=s.value;try{var p=c();return!ai(s,p)}catch{return!0}}function _p(s){var c=ue(s,2);c!==null&&Yi(c,s,2)}function jf(s){var c=_i();if(typeof s=="function"){var p=s;if(s=p(),li){Ne(!0);try{p()}finally{Ne(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:s},c}function Yu(s,c,p,x){return s.baseState=p,wp(s,Rn,typeof x=="function"?x:us)}function cv(s,c,p,x,N){if(Rf(s))throw Error(r(485));if(s=c.action,s!==null){var A={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){A.listeners.push(U)}};Q.T!==null?p(!0):A.isTransition=!1,x(A),p=c.pending,p===null?(A.next=c.pending=A,jp(c,A)):(A.next=p.next,c.pending=p.next=A)}}function jp(s,c){var p=c.action,x=c.payload,N=s.state;if(c.isTransition){var A=Q.T,U={};Q.T=U;try{var Z=p(N,x),Se=Q.S;Se!==null&&Se(U,Z),kp(s,c,Z)}catch($e){kf(s,c,$e)}finally{Q.T=A}}else try{A=p(N,x),kp(s,c,A)}catch($e){kf(s,c,$e)}}function kp(s,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Bg(s,c,x)},function(x){return kf(s,c,x)}):Bg(s,c,p)}function Bg(s,c,p){c.status="fulfilled",c.value=p,Ug(c),s.state=p,c=s.pending,c!==null&&(p=c.next,p===c?s.pending=null:(p=p.next,c.next=p,jp(s,p)))}function kf(s,c,p){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=p,Ug(c),c=c.next;while(c!==x)}s.action=null}function Ug(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function Tf(s,c){return c}function Tp(s,c){if(un){var p=Qn.formState;if(p!==null){e:{var x=Xt;if(un){if(ar){t:{for(var N=ar,A=Si;N.nodeType!==8;){if(!A){N=null;break t}if(N=Oa(N.nextSibling),N===null){N=null;break t}}A=N.data,N=A==="F!"||A==="F"?N:null}if(N){ar=Oa(N.nextSibling),x=N.data==="F!";break e}}ra(x)}x=!1}x&&(c=p[0])}}return p=_i(),p.memoizedState=p.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tf,lastRenderedState:c},p.queue=x,p=Ip.bind(null,Xt,x),x.dispatch=p,x=jf(!1),A=Rp.bind(null,Xt,!1,x.queue),x=_i(),N={state:c,dispatch:null,action:s,pending:null},x.queue=N,p=cv.bind(null,Xt,N,A,p),N.dispatch=p,x.memoizedState=s,[c,p,!1]}function Ef(s){var c=Cr();return qg(c,Rn,s)}function qg(s,c,p){if(c=wp(s,c,Tf)[0],s=Nf(us)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Hu(c)}catch(U){throw U===gi?xf:U}else x=c;c=Cr();var N=c.queue,A=N.dispatch;return p!==c.memoizedState&&(Xt.flags|=2048,Ic(9,Af(),Ep.bind(null,N,p),null)),[x,A,s]}function Ep(s,c){s.action=c}function Wt(s){var c=Cr(),p=Rn;if(p!==null)return qg(c,p,s);Cr(),c=c.memoizedState,p=Cr();var x=p.queue.dispatch;return p.memoizedState=s,[c,x,!1]}function Ic(s,c,p,x){return s={tag:s,create:p,deps:x,inst:c,next:null},c=Xt.updateQueue,c===null&&(c=Ml(),Xt.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=s.next=s:(x=p.next,p.next=s,s.next=x,c.lastEffect=s),s}function Af(){return{destroy:void 0,resource:void 0}}function Rc(){return Cr().memoizedState}function Wu(s,c,p,x){var N=_i();x=x===void 0?null:x,Xt.flags|=s,N.memoizedState=Ic(1|c,Af(),p,x)}function Qu(s,c,p,x){var N=Cr();x=x===void 0?null:x;var A=N.memoizedState.inst;Rn!==null&&x!==null&&Vu(x,Rn.memoizedState.deps)?N.memoizedState=Ic(c,A,p,x):(Xt.flags|=s,N.memoizedState=Ic(1|c,A,p,x))}function Vg(s,c){Wu(8390656,8,s,c)}function qi(s,c){Qu(2048,8,s,c)}function Hg(s,c){return Qu(4,2,s,c)}function Ju(s,c){return Qu(4,4,s,c)}function Pf(s,c){if(typeof c=="function"){s=s();var p=c(s);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Ap(s,c,p){p=p!=null?p.concat([s]):null,Qu(4,4,Pf.bind(null,c,s),p)}function Df(){}function ji(s,c){var p=Cr();c=c===void 0?null:c;var x=p.memoizedState;return c!==null&&Vu(c,x[1])?x[0]:(p.memoizedState=[s,c],s)}function Vs(s,c){var p=Cr();c=c===void 0?null:c;var x=p.memoizedState;if(c!==null&&Vu(c,x[1]))return x[0];if(x=s(),li){Ne(!0);try{s()}finally{Ne(!1)}}return p.memoizedState=[x,c],x}function Ku(s,c,p){return p===void 0||(Ia&1073741824)!==0?s.memoizedState=c:(s.memoizedState=p,s=Cy(),Xt.lanes|=s,$o|=s,p)}function Pp(s,c,p,x){return ai(p,c)?p:Dl.current!==null?(s=Ku(s,p,x),ai(s,c)||(Fr=!0),s):(Ia&42)===0?(Fr=!0,s.memoizedState=p):(s=Cy(),Xt.lanes|=s,$o|=s,c)}function Xu(s,c,p,x,N){var A=ne.p;ne.p=A!==0&&8>A?A:8;var U=Q.T,Z={};Q.T=Z,Rp(s,!1,c,p);try{var Se=N(),$e=Q.S;if($e!==null&&$e(Z,Se),Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var Je=lv(Se,x);Ol(s,c,Je,ui(s))}else Ol(s,c,x,ui(s))}catch(rt){Ol(s,c,{then:function(){},status:"rejected",reason:rt},ui())}finally{ne.p=A,Q.T=U}}function Gg(){}function Zu(s,c,p,x){if(s.tag!==5)throw Error(r(476));var N=Dp(s).queue;Xu(s,N,c,le,p===null?Gg:function(){return If(s),p(x)})}function Dp(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:le},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:p},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function If(s){var c=Dp(s).next.queue;Ol(s,c,{},ui())}function ed(){return mr(tu)}function Hs(){return Cr().memoizedState}function Yg(){return Cr().memoizedState}function Io(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var p=ui();s=Ao(p);var x=Us(c,s,p);x!==null&&(Yi(x,c,p),Uu(x,c,p)),c={cache:fp()},s.payload=c;return}c=c.return}}function Wg(s,c,p){var x=ui();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Rf(s)?Qg(c,p):(p=be(s,c,p,x),p!==null&&(Yi(p,s,x),Mp(p,c,x)))}function Ip(s,c,p){var x=ui();Ol(s,c,p,x)}function Ol(s,c,p,x){var N={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Rf(s))Qg(c,N);else{var A=s.alternate;if(s.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var U=c.lastRenderedState,Z=A(U,p);if(N.hasEagerState=!0,N.eagerState=Z,ai(Z,U))return ae(s,c,N,0),Qn===null&&ls(),!1}catch{}finally{}if(p=be(s,c,N,x),p!==null)return Yi(p,s,x),Mp(p,c,x),!0}return!1}function Rp(s,c,p,x){if(x={lane:2,revertLane:nh(),action:x,hasEagerState:!1,eagerState:null,next:null},Rf(s)){if(c)throw Error(r(479))}else c=be(s,p,x,2),c!==null&&Yi(c,s,2)}function Rf(s){var c=s.alternate;return s===Xt||c!==null&&c===Xt}function Qg(s,c){Il=Pc=!0;var p=s.pending;p===null?c.next=c:(c.next=p.next,p.next=c),s.pending=c}function Mp(s,c,p){if((p&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Ct(s,p)}}var td={readContext:mr,use:Sf,useCallback:mn,useContext:mn,useEffect:mn,useImperativeHandle:mn,useLayoutEffect:mn,useInsertionEffect:mn,useMemo:mn,useReducer:mn,useRef:mn,useState:mn,useDebugValue:mn,useDeferredValue:mn,useTransition:mn,useSyncExternalStore:mn,useId:mn,useHostTransitionStatus:mn,useFormState:mn,useActionState:mn,useOptimistic:mn,useMemoCache:mn,useCacheRefresh:mn},Jg={readContext:mr,use:Sf,useCallback:function(s,c){return _i().memoizedState=[s,c===void 0?null:c],s},useContext:mr,useEffect:Vg,useImperativeHandle:function(s,c,p){p=p!=null?p.concat([s]):null,Wu(4194308,4,Pf.bind(null,c,s),p)},useLayoutEffect:function(s,c){return Wu(4194308,4,s,c)},useInsertionEffect:function(s,c){Wu(4,2,s,c)},useMemo:function(s,c){var p=_i();c=c===void 0?null:c;var x=s();if(li){Ne(!0);try{s()}finally{Ne(!1)}}return p.memoizedState=[x,c],x},useReducer:function(s,c,p){var x=_i();if(p!==void 0){var N=p(c);if(li){Ne(!0);try{p(c)}finally{Ne(!1)}}}else N=c;return x.memoizedState=x.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},x.queue=s,s=s.dispatch=Wg.bind(null,Xt,s),[x.memoizedState,s]},useRef:function(s){var c=_i();return s={current:s},c.memoizedState=s},useState:function(s){s=jf(s);var c=s.queue,p=Ip.bind(null,Xt,c);return c.dispatch=p,[s.memoizedState,p]},useDebugValue:Df,useDeferredValue:function(s,c){var p=_i();return Ku(p,s,c)},useTransition:function(){var s=jf(!1);return s=Xu.bind(null,Xt,s.queue,!0,!1),_i().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,p){var x=Xt,N=_i();if(un){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),Qn===null)throw Error(r(349));(bn&124)!==0||Cf(x,c,p)}N.memoizedState=p;var A={value:p,getSnapshot:c};return N.queue=A,Vg(_f.bind(null,x,A,s),[s]),x.flags|=2048,Ic(9,Af(),zg.bind(null,x,A,p,c),null),p},useId:function(){var s=_i(),c=Qn.identifierPrefix;if(un){var p=zs,x=ir;p=(x&~(1<<32-Le(x)-1)).toString(32)+p,c=""+c+"R"+p,p=Dc++,0<p&&(c+="H"+p.toString(32)),c+=""}else p=Lg++,c=""+c+"r"+p.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:ed,useFormState:Tp,useActionState:Tp,useOptimistic:function(s){var c=_i();c.memoizedState=c.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=Rp.bind(null,Xt,!0,p),p.dispatch=c,[s,c]},useMemoCache:Gu,useCacheRefresh:function(){return _i().memoizedState=Io.bind(null,Xt)}},Op={readContext:mr,use:Sf,useCallback:ji,useContext:mr,useEffect:qi,useImperativeHandle:Ap,useInsertionEffect:Hg,useLayoutEffect:Ju,useMemo:Vs,useReducer:Nf,useRef:Rc,useState:function(){return Nf(us)},useDebugValue:Df,useDeferredValue:function(s,c){var p=Cr();return Pp(p,Rn.memoizedState,s,c)},useTransition:function(){var s=Nf(us)[0],c=Cr().memoizedState;return[typeof s=="boolean"?s:Hu(s),c]},useSyncExternalStore:Np,useId:Hs,useHostTransitionStatus:ed,useFormState:Ef,useActionState:Ef,useOptimistic:function(s,c){var p=Cr();return Yu(p,Rn,s,c)},useMemoCache:Gu,useCacheRefresh:Yg},Kg={readContext:mr,use:Sf,useCallback:ji,useContext:mr,useEffect:qi,useImperativeHandle:Ap,useInsertionEffect:Hg,useLayoutEffect:Ju,useMemo:Vs,useReducer:Sp,useRef:Rc,useState:function(){return Sp(us)},useDebugValue:Df,useDeferredValue:function(s,c){var p=Cr();return Rn===null?Ku(p,s,c):Pp(p,Rn.memoizedState,s,c)},useTransition:function(){var s=Sp(us)[0],c=Cr().memoizedState;return[typeof s=="boolean"?s:Hu(s),c]},useSyncExternalStore:Np,useId:Hs,useHostTransitionStatus:ed,useFormState:Wt,useActionState:Wt,useOptimistic:function(s,c){var p=Cr();return Rn!==null?Yu(p,Rn,s,c):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:Gu,useCacheRefresh:Yg},Ar=null,ki=0;function Mf(s){var c=ki;return ki+=1,Ar===null&&(Ar=[]),mp(Ar,s,c)}function nd(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function Ll(s,c){throw c.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function Fl(s){var c=s._init;return c(s._payload)}function Lp(s){function c(Re,Ee){if(s){var Fe=Re.deletions;Fe===null?(Re.deletions=[Ee],Re.flags|=16):Fe.push(Ee)}}function p(Re,Ee){if(!s)return null;for(;Ee!==null;)c(Re,Ee),Ee=Ee.sibling;return null}function x(Re){for(var Ee=new Map;Re!==null;)Re.key!==null?Ee.set(Re.key,Re):Ee.set(Re.index,Re),Re=Re.sibling;return Ee}function N(Re,Ee){return Re=Xn(Re,Ee),Re.index=0,Re.sibling=null,Re}function A(Re,Ee,Fe){return Re.index=Fe,s?(Fe=Re.alternate,Fe!==null?(Fe=Fe.index,Fe<Ee?(Re.flags|=67108866,Ee):Fe):(Re.flags|=67108866,Ee)):(Re.flags|=1048576,Ee)}function U(Re){return s&&Re.alternate===null&&(Re.flags|=67108866),Re}function Z(Re,Ee,Fe,Xe){return Ee===null||Ee.tag!==6?(Ee=cp(Fe,Re.mode,Xe),Ee.return=Re,Ee):(Ee=N(Ee,Fe),Ee.return=Re,Ee)}function Se(Re,Ee,Fe,Xe){var bt=Fe.type;return bt===S?Je(Re,Ee,Fe.props.children,Xe,Fe.key):Ee!==null&&(Ee.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===q&&Fl(bt)===Ee.type)?(Ee=N(Ee,Fe.props),nd(Ee,Fe),Ee.return=Re,Ee):(Ee=hf(Fe.type,Fe.key,Fe.props,null,Re.mode,Xe),nd(Ee,Fe),Ee.return=Re,Ee)}function $e(Re,Ee,Fe,Xe){return Ee===null||Ee.tag!==4||Ee.stateNode.containerInfo!==Fe.containerInfo||Ee.stateNode.implementation!==Fe.implementation?(Ee=jc(Fe,Re.mode,Xe),Ee.return=Re,Ee):(Ee=N(Ee,Fe.children||[]),Ee.return=Re,Ee)}function Je(Re,Ee,Fe,Xe,bt){return Ee===null||Ee.tag!==7?(Ee=jl(Fe,Re.mode,Xe,bt),Ee.return=Re,Ee):(Ee=N(Ee,Fe),Ee.return=Re,Ee)}function rt(Re,Ee,Fe){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return Ee=cp(""+Ee,Re.mode,Fe),Ee.return=Re,Ee;if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case b:return Fe=hf(Ee.type,Ee.key,Ee.props,null,Re.mode,Fe),nd(Fe,Ee),Fe.return=Re,Fe;case v:return Ee=jc(Ee,Re.mode,Fe),Ee.return=Re,Ee;case q:var Xe=Ee._init;return Ee=Xe(Ee._payload),rt(Re,Ee,Fe)}if(Y(Ee)||V(Ee))return Ee=jl(Ee,Re.mode,Fe,null),Ee.return=Re,Ee;if(typeof Ee.then=="function")return rt(Re,Mf(Ee),Fe);if(Ee.$$typeof===R)return rt(Re,gf(Re,Ee),Fe);Ll(Re,Ee)}return null}function Ue(Re,Ee,Fe,Xe){var bt=Ee!==null?Ee.key:null;if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return bt!==null?null:Z(Re,Ee,""+Fe,Xe);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case b:return Fe.key===bt?Se(Re,Ee,Fe,Xe):null;case v:return Fe.key===bt?$e(Re,Ee,Fe,Xe):null;case q:return bt=Fe._init,Fe=bt(Fe._payload),Ue(Re,Ee,Fe,Xe)}if(Y(Fe)||V(Fe))return bt!==null?null:Je(Re,Ee,Fe,Xe,null);if(typeof Fe.then=="function")return Ue(Re,Ee,Mf(Fe),Xe);if(Fe.$$typeof===R)return Ue(Re,Ee,gf(Re,Fe),Xe);Ll(Re,Fe)}return null}function ze(Re,Ee,Fe,Xe,bt){if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number"||typeof Xe=="bigint")return Re=Re.get(Fe)||null,Z(Ee,Re,""+Xe,bt);if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case b:return Re=Re.get(Xe.key===null?Fe:Xe.key)||null,Se(Ee,Re,Xe,bt);case v:return Re=Re.get(Xe.key===null?Fe:Xe.key)||null,$e(Ee,Re,Xe,bt);case q:var rn=Xe._init;return Xe=rn(Xe._payload),ze(Re,Ee,Fe,Xe,bt)}if(Y(Xe)||V(Xe))return Re=Re.get(Fe)||null,Je(Ee,Re,Xe,bt,null);if(typeof Xe.then=="function")return ze(Re,Ee,Fe,Mf(Xe),bt);if(Xe.$$typeof===R)return ze(Re,Ee,Fe,gf(Ee,Xe),bt);Ll(Ee,Xe)}return null}function Ot(Re,Ee,Fe,Xe){for(var bt=null,rn=null,jt=Ee,Lt=Ee=0,Br=null;jt!==null&&Lt<Fe.length;Lt++){jt.index>Lt?(Br=jt,jt=null):Br=jt.sibling;var Nn=Ue(Re,jt,Fe[Lt],Xe);if(Nn===null){jt===null&&(jt=Br);break}s&&jt&&Nn.alternate===null&&c(Re,jt),Ee=A(Nn,Ee,Lt),rn===null?bt=Nn:rn.sibling=Nn,rn=Nn,jt=Br}if(Lt===Fe.length)return p(Re,jt),un&&kl(Re,Lt),bt;if(jt===null){for(;Lt<Fe.length;Lt++)jt=rt(Re,Fe[Lt],Xe),jt!==null&&(Ee=A(jt,Ee,Lt),rn===null?bt=jt:rn.sibling=jt,rn=jt);return un&&kl(Re,Lt),bt}for(jt=x(jt);Lt<Fe.length;Lt++)Br=ze(jt,Re,Lt,Fe[Lt],Xe),Br!==null&&(s&&Br.alternate!==null&&jt.delete(Br.key===null?Lt:Br.key),Ee=A(Br,Ee,Lt),rn===null?bt=Br:rn.sibling=Br,rn=Br);return s&&jt.forEach(function(Qo){return c(Re,Qo)}),un&&kl(Re,Lt),bt}function Mt(Re,Ee,Fe,Xe){if(Fe==null)throw Error(r(151));for(var bt=null,rn=null,jt=Ee,Lt=Ee=0,Br=null,Nn=Fe.next();jt!==null&&!Nn.done;Lt++,Nn=Fe.next()){jt.index>Lt?(Br=jt,jt=null):Br=jt.sibling;var Qo=Ue(Re,jt,Nn.value,Xe);if(Qo===null){jt===null&&(jt=Br);break}s&&jt&&Qo.alternate===null&&c(Re,jt),Ee=A(Qo,Ee,Lt),rn===null?bt=Qo:rn.sibling=Qo,rn=Qo,jt=Br}if(Nn.done)return p(Re,jt),un&&kl(Re,Lt),bt;if(jt===null){for(;!Nn.done;Lt++,Nn=Fe.next())Nn=rt(Re,Nn.value,Xe),Nn!==null&&(Ee=A(Nn,Ee,Lt),rn===null?bt=Nn:rn.sibling=Nn,rn=Nn);return un&&kl(Re,Lt),bt}for(jt=x(jt);!Nn.done;Lt++,Nn=Fe.next())Nn=ze(jt,Re,Lt,Nn.value,Xe),Nn!==null&&(s&&Nn.alternate!==null&&jt.delete(Nn.key===null?Lt:Nn.key),Ee=A(Nn,Ee,Lt),rn===null?bt=Nn:rn.sibling=Nn,rn=Nn);return s&&jt.forEach(function(Hv){return c(Re,Hv)}),un&&kl(Re,Lt),bt}function Bn(Re,Ee,Fe,Xe){if(typeof Fe=="object"&&Fe!==null&&Fe.type===S&&Fe.key===null&&(Fe=Fe.props.children),typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case b:e:{for(var bt=Fe.key;Ee!==null;){if(Ee.key===bt){if(bt=Fe.type,bt===S){if(Ee.tag===7){p(Re,Ee.sibling),Xe=N(Ee,Fe.props.children),Xe.return=Re,Re=Xe;break e}}else if(Ee.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===q&&Fl(bt)===Ee.type){p(Re,Ee.sibling),Xe=N(Ee,Fe.props),nd(Xe,Fe),Xe.return=Re,Re=Xe;break e}p(Re,Ee);break}else c(Re,Ee);Ee=Ee.sibling}Fe.type===S?(Xe=jl(Fe.props.children,Re.mode,Xe,Fe.key),Xe.return=Re,Re=Xe):(Xe=hf(Fe.type,Fe.key,Fe.props,null,Re.mode,Xe),nd(Xe,Fe),Xe.return=Re,Re=Xe)}return U(Re);case v:e:{for(bt=Fe.key;Ee!==null;){if(Ee.key===bt)if(Ee.tag===4&&Ee.stateNode.containerInfo===Fe.containerInfo&&Ee.stateNode.implementation===Fe.implementation){p(Re,Ee.sibling),Xe=N(Ee,Fe.children||[]),Xe.return=Re,Re=Xe;break e}else{p(Re,Ee);break}else c(Re,Ee);Ee=Ee.sibling}Xe=jc(Fe,Re.mode,Xe),Xe.return=Re,Re=Xe}return U(Re);case q:return bt=Fe._init,Fe=bt(Fe._payload),Bn(Re,Ee,Fe,Xe)}if(Y(Fe))return Ot(Re,Ee,Fe,Xe);if(V(Fe)){if(bt=V(Fe),typeof bt!="function")throw Error(r(150));return Fe=bt.call(Fe),Mt(Re,Ee,Fe,Xe)}if(typeof Fe.then=="function")return Bn(Re,Ee,Mf(Fe),Xe);if(Fe.$$typeof===R)return Bn(Re,Ee,gf(Re,Fe),Xe);Ll(Re,Fe)}return typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint"?(Fe=""+Fe,Ee!==null&&Ee.tag===6?(p(Re,Ee.sibling),Xe=N(Ee,Fe),Xe.return=Re,Re=Xe):(p(Re,Ee),Xe=cp(Fe,Re.mode,Xe),Xe.return=Re,Re=Xe),U(Re)):p(Re,Ee)}return function(Re,Ee,Fe,Xe){try{ki=0;var bt=Bn(Re,Ee,Fe,Xe);return Ar=null,bt}catch(jt){if(jt===gi||jt===xf)throw jt;var rn=wt(29,jt,null,Re.mode);return rn.lanes=Xe,rn.return=Re,rn}finally{}}}var $l=Lp(!0),Xg=Lp(!1),Vi=de(null),yi=null;function sa(s){var c=s.alternate;D(gr,gr.current&1),D(Vi,s),yi===null&&(c===null||Dl.current!==null||c.memoizedState!==null)&&(yi=s)}function Zg(s){if(s.tag===22){if(D(gr,gr.current),D(Vi,s),yi===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(yi=s)}}else Gs()}function Gs(){D(gr,gr.current),D(Vi,Vi.current)}function ds(s){he(Vi),yi===s&&(yi=null),he(gr)}var gr=de(0);function rd(s){for(var c=s;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||bi(p)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Mc(s,c,p,x){c=s.memoizedState,p=p(x,c),p=p==null?c:h({},c,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}var id={enqueueSetState:function(s,c,p){s=s._reactInternals;var x=ui(),N=Ao(x);N.payload=c,p!=null&&(N.callback=p),c=Us(s,N,x),c!==null&&(Yi(c,s,x),Uu(c,s,x))},enqueueReplaceState:function(s,c,p){s=s._reactInternals;var x=ui(),N=Ao(x);N.tag=1,N.payload=c,p!=null&&(N.callback=p),c=Us(s,N,x),c!==null&&(Yi(c,s,x),Uu(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var p=ui(),x=Ao(p);x.tag=2,c!=null&&(x.callback=c),c=Us(s,x,p),c!==null&&(Yi(c,s,p),Uu(c,s,p))}};function ad(s,c,p,x,N,A,U){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,A,U):c.prototype&&c.prototype.isPureReactComponent?!si(p,x)||!si(N,A):!0}function ey(s,c,p,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,x),c.state!==s&&id.enqueueReplaceState(c,c.state,null)}function Ro(s,c){var p=c;if("ref"in c){p={};for(var x in c)x!=="ref"&&(p[x]=c[x])}if(s=s.defaultProps){p===c&&(p=h({},p));for(var N in s)p[N]===void 0&&(p[N]=s[N])}return p}var zl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Fp(s){zl(s)}function Of(s){console.error(s)}function ty(s){zl(s)}function sd(s,c){try{var p=s.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function fs(s,c,p){try{var x=s.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Lf(s,c,p){return p=Ao(p),p.tag=3,p.payload={element:null},p.callback=function(){sd(s,c)},p}function $p(s){return s=Ao(s),s.tag=3,s}function ny(s,c,p,x){var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var A=x.value;s.payload=function(){return N(A)},s.callback=function(){fs(c,p,x)}}var U=p.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(s.callback=function(){fs(c,p,x),typeof N!="function"&&(zo===null?zo=new Set([this]):zo.add(this));var Z=x.stack;this.componentDidCatch(x.value,{componentStack:Z!==null?Z:""})})}function ry(s,c,p,x,N){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=p.alternate,c!==null&&$u(c,p,N,!0),p=Vi.current,p!==null){switch(p.tag){case 13:return yi===null?im():p.alternate===null&&yr===0&&(yr=3),p.flags&=-257,p.flags|=65536,p.lanes=N,x===pp?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([x]):c.add(x),om(s,x,N)),!1;case 22:return p.flags|=65536,x===pp?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([x]):p.add(x)),om(s,x,N)),!1}throw Error(r(435,p.tag))}return om(s,x,N),im(),!1}if(un)return c=Vi.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==kc&&(s=Error(r(422),{cause:x}),To(Qr(s,p)))):(x!==kc&&(c=Error(r(423),{cause:x}),To(Qr(c,p))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,x=Qr(x,p),N=Lf(s.stateNode,x,N),Pa(s,N),yr!==4&&(yr=2)),!1;var A=Error(r(520),{cause:x});if(A=Qr(A,p),gd===null?gd=[A]:gd.push(A),yr!==4&&(yr=2),c===null)return!0;x=Qr(x,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,s=N&-N,p.lanes|=s,s=Lf(p.stateNode,x,s),Pa(p,s),!1;case 1:if(c=p.type,A=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(zo===null||!zo.has(A))))return p.flags|=65536,N&=-N,p.lanes|=N,N=$p(N),ny(N,s,p,x),Pa(p,N),!1}p=p.return}while(p!==null);return!1}var iy=Error(r(461)),Fr=!1;function er(s,c,p,x){c.child=s===null?Xg(c,null,p,x):$l(c,s.child,p,x)}function Ff(s,c,p,x,N){p=p.render;var A=c.ref;if("ref"in x){var U={};for(var Z in x)Z!=="ref"&&(U[Z]=x[Z])}else U=x;return El(c),x=xp(s,c,p,U,A,N),Z=vp(),s!==null&&!Fr?(Rl(s,c,N),Ys(s,c,N)):(un&&Z&&dp(c),c.flags|=1,er(s,c,x,N),c.child)}function $f(s,c,p,x,N){if(s===null){var A=p.type;return typeof A=="function"&&!pr(A)&&A.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=A,zf(s,c,A,x,N)):(s=hf(p.type,null,x,c,c.mode,N),s.ref=c.ref,s.return=c,c.child=s)}if(A=s.child,!Ra(s,N)){var U=A.memoizedProps;if(p=p.compare,p=p!==null?p:si,p(U,x)&&s.ref===c.ref)return Ys(s,c,N)}return c.flags|=1,s=Xn(A,x),s.ref=c.ref,s.return=c,c.child=s}function zf(s,c,p,x,N){if(s!==null){var A=s.memoizedProps;if(si(A,x)&&s.ref===c.ref)if(Fr=!1,c.pendingProps=x=A,Ra(s,N))(s.flags&131072)!==0&&(Fr=!0);else return c.lanes=s.lanes,Ys(s,c,N)}return Oc(s,c,p,x,N)}function od(s,c,p){var x=c.pendingProps,N=x.children,A=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=A!==null?A.baseLanes|p:p,s!==null){for(N=c.child=s.child,A=0;N!==null;)A=A|N.lanes|N.childLanes,N=N.sibling;c.childLanes=A&~x}else c.childLanes=0,c.child=null;return Bl(s,c,x,p)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&yf(c,A!==null?A.cachePool:null),A!==null?qs(c,A):vf(),Zg(c);else return c.lanes=c.childLanes=536870912,Bl(s,c,A!==null?A.baseLanes|p:p,p)}else A!==null?(yf(c,A.cachePool),qs(c,A),Gs(),c.memoizedState=null):(s!==null&&yf(c,null),vf(),Gs());return er(s,c,N,p),c.child}function Bl(s,c,p,x){var N=Bs();return N=N===null?null:{parent:Hn._currentValue,pool:N},c.memoizedState={baseLanes:p,cachePool:N},s!==null&&yf(c,null),vf(),Zg(c),s!==null&&$u(s,c,x,!0),null}function Et(s,c){var p=c.ref;if(p===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(c.flags|=4194816)}}function Oc(s,c,p,x,N){return El(c),p=xp(s,c,p,x,void 0,N),x=vp(),s!==null&&!Fr?(Rl(s,c,N),Ys(s,c,N)):(un&&x&&dp(c),c.flags|=1,er(s,c,p,N),c.child)}function Bf(s,c,p,x,N,A){return El(c),c.updateQueue=null,p=$g(c,x,p,N),Fg(s),x=vp(),s!==null&&!Fr?(Rl(s,c,A),Ys(s,c,A)):(un&&x&&dp(c),c.flags|=1,er(s,c,p,A),c.child)}function Mo(s,c,p,x,N){if(El(c),c.stateNode===null){var A=ft,U=p.contextType;typeof U=="object"&&U!==null&&(A=mr(U)),A=new p(x,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=id,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=x,A.state=c.memoizedState,A.refs={},Pl(c),U=p.contextType,A.context=typeof U=="object"&&U!==null?mr(U):ft,A.state=c.memoizedState,U=p.getDerivedStateFromProps,typeof U=="function"&&(Mc(c,p,U,x),A.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(U=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),U!==A.state&&id.enqueueReplaceState(A,A.state,null),oi(c,x,A,N),Da(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){A=c.stateNode;var Z=c.memoizedProps,Se=Ro(p,Z);A.props=Se;var $e=A.context,Je=p.contextType;U=ft,typeof Je=="object"&&Je!==null&&(U=mr(Je));var rt=p.getDerivedStateFromProps;Je=typeof rt=="function"||typeof A.getSnapshotBeforeUpdate=="function",Z=c.pendingProps!==Z,Je||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(Z||$e!==U)&&ey(c,A,x,U),cs=!1;var Ue=c.memoizedState;A.state=Ue,oi(c,x,A,N),Da(),$e=c.memoizedState,Z||Ue!==$e||cs?(typeof rt=="function"&&(Mc(c,p,rt,x),$e=c.memoizedState),(Se=cs||ad(c,p,Se,x,Ue,$e,U))?(Je||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=$e),A.props=x,A.state=$e,A.context=U,x=Se):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{A=c.stateNode,Ac(s,c),U=c.memoizedProps,Je=Ro(p,U),A.props=Je,rt=c.pendingProps,Ue=A.context,$e=p.contextType,Se=ft,typeof $e=="object"&&$e!==null&&(Se=mr($e)),Z=p.getDerivedStateFromProps,($e=typeof Z=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==rt||Ue!==Se)&&ey(c,A,x,Se),cs=!1,Ue=c.memoizedState,A.state=Ue,oi(c,x,A,N),Da();var ze=c.memoizedState;U!==rt||Ue!==ze||cs||s!==null&&s.dependencies!==null&&mf(s.dependencies)?(typeof Z=="function"&&(Mc(c,p,Z,x),ze=c.memoizedState),(Je=cs||ad(c,p,Je,x,Ue,ze,Se)||s!==null&&s.dependencies!==null&&mf(s.dependencies))?($e||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(x,ze,Se),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(x,ze,Se)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=ze),A.props=x,A.state=ze,A.context=Se,x=Je):(typeof A.componentDidUpdate!="function"||U===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=1024),x=!1)}return A=x,Et(s,c),x=(c.flags&128)!==0,A||x?(A=c.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,s!==null&&x?(c.child=$l(c,s.child,null,N),c.child=$l(c,null,p,N)):er(s,c,p,N),c.memoizedState=A.state,s=c.child):s=Ys(s,c,N),s}function ay(s,c,p,x){return Fu(),c.flags|=256,er(s,c,p,x),c.child}var ld={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Uf(s){return{baseLanes:s,cachePool:Pg()}}function $r(s,c,p){return s=s!==null?s.childLanes&~p:0,c&&(s|=la),s}function sy(s,c,p){var x=c.pendingProps,N=!1,A=(c.flags&128)!==0,U;if((U=A)||(U=s!==null&&s.memoizedState===null?!1:(gr.current&2)!==0),U&&(N=!0,c.flags&=-129),U=(c.flags&32)!==0,c.flags&=-33,s===null){if(un){if(N?sa(c):Gs(),un){var Z=ar,Se;if(Se=Z){e:{for(Se=Z,Z=Si;Se.nodeType!==8;){if(!Z){Z=null;break e}if(Se=Oa(Se.nextSibling),Se===null){Z=null;break e}}Z=Se}Z!==null?(c.memoizedState={dehydrated:Z,treeContext:Zn!==null?{id:ir,overflow:zs}:null,retryLane:536870912,hydrationErrors:null},Se=wt(18,null,null,0),Se.stateNode=Z,Se.return=c,c.child=Se,Er=c,ar=null,Se=!0):Se=!1}Se||ra(c)}if(Z=c.memoizedState,Z!==null&&(Z=Z.dehydrated,Z!==null))return bi(Z)?c.lanes=32:c.lanes=536870912,null;ds(c)}return Z=x.children,x=x.fallback,N?(Gs(),N=c.mode,Z=cd({mode:"hidden",children:Z},N),x=jl(x,N,p,null),Z.return=c,x.return=c,Z.sibling=x,c.child=Z,N=c.child,N.memoizedState=Uf(p),N.childLanes=$r(s,U,p),c.memoizedState=ld,x):(sa(c),zp(c,Z))}if(Se=s.memoizedState,Se!==null&&(Z=Se.dehydrated,Z!==null)){if(A)c.flags&256?(sa(c),c.flags&=-257,c=Bp(s,c,p)):c.memoizedState!==null?(Gs(),c.child=s.child,c.flags|=128,c=null):(Gs(),N=x.fallback,Z=c.mode,x=cd({mode:"visible",children:x.children},Z),N=jl(N,Z,p,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,$l(c,s.child,null,p),x=c.child,x.memoizedState=Uf(p),x.childLanes=$r(s,U,p),c.memoizedState=ld,c=N);else if(sa(c),bi(Z)){if(U=Z.nextSibling&&Z.nextSibling.dataset,U)var $e=U.dgst;U=$e,x=Error(r(419)),x.stack="",x.digest=U,To({value:x,source:null,stack:null}),c=Bp(s,c,p)}else if(Fr||$u(s,c,p,!1),U=(p&s.childLanes)!==0,Fr||U){if(U=Qn,U!==null&&(x=p&-p,x=(x&42)!==0?1:Yt(x),x=(x&(U.suspendedLanes|p))!==0?0:x,x!==0&&x!==Se.retryLane))throw Se.retryLane=x,ue(s,x),Yi(U,s,x),iy;Z.data==="$?"||im(),c=Bp(s,c,p)}else Z.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=Se.treeContext,ar=Oa(Z.nextSibling),Er=c,un=!0,Aa=null,Si=!1,s!==null&&(ta[na++]=ir,ta[na++]=zs,ta[na++]=Zn,ir=s.id,zs=s.overflow,Zn=c),c=zp(c,x.children),c.flags|=4096);return c}return N?(Gs(),N=x.fallback,Z=c.mode,Se=s.child,$e=Se.sibling,x=Xn(Se,{mode:"hidden",children:x.children}),x.subtreeFlags=Se.subtreeFlags&65011712,$e!==null?N=Xn($e,N):(N=jl(N,Z,p,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,Z=s.child.memoizedState,Z===null?Z=Uf(p):(Se=Z.cachePool,Se!==null?($e=Hn._currentValue,Se=Se.parent!==$e?{parent:$e,pool:$e}:Se):Se=Pg(),Z={baseLanes:Z.baseLanes|p,cachePool:Se}),N.memoizedState=Z,N.childLanes=$r(s,U,p),c.memoizedState=ld,x):(sa(c),p=s.child,s=p.sibling,p=Xn(p,{mode:"visible",children:x.children}),p.return=c,p.sibling=null,s!==null&&(U=c.deletions,U===null?(c.deletions=[s],c.flags|=16):U.push(s)),c.child=p,c.memoizedState=null,p)}function zp(s,c){return c=cd({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function cd(s,c){return s=wt(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Bp(s,c,p){return $l(c,s.child,null,p),s=zp(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Up(s,c,p){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),Ni(s.return,c,p)}function qp(s,c,p,x,N){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:N}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=x,A.tail=p,A.tailMode=N)}function oy(s,c,p){var x=c.pendingProps,N=x.revealOrder,A=x.tail;if(er(s,c,x.children,p),x=gr.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Up(s,p,c);else if(s.tag===19)Up(s,p,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(D(gr,x),N){case"forwards":for(p=c.child,N=null;p!==null;)s=p.alternate,s!==null&&rd(s)===null&&(N=p),p=p.sibling;p=N,p===null?(N=c.child,c.child=null):(N=p.sibling,p.sibling=null),qp(c,!1,N,p,A);break;case"backwards":for(p=null,N=c.child,c.child=null;N!==null;){if(s=N.alternate,s!==null&&rd(s)===null){c.child=N;break}s=N.sibling,N.sibling=p,p=N,N=s}qp(c,!0,p,null,A);break;case"together":qp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ys(s,c,p){if(s!==null&&(c.dependencies=s.dependencies),$o|=c.lanes,(p&c.childLanes)===0)if(s!==null){if($u(s,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,p=Xn(s,s.pendingProps),c.child=p,p.return=c;s.sibling!==null;)s=s.sibling,p=p.sibling=Xn(s,s.pendingProps),p.return=c;p.sibling=null}return c.child}function Ra(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&mf(s)))}function xi(s,c,p){switch(c.tag){case 3:J(c,c.stateNode.containerInfo),Ui(c,Hn,s.memoizedState.cache),Fu();break;case 27:case 5:He(c);break;case 4:J(c,c.stateNode.containerInfo);break;case 10:Ui(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(sa(c),c.flags|=128,null):(p&c.child.childLanes)!==0?sy(s,c,p):(sa(c),s=Ys(s,c,p),s!==null?s.sibling:null);sa(c);break;case 19:var N=(s.flags&128)!==0;if(x=(p&c.childLanes)!==0,x||($u(s,c,p,!1),x=(p&c.childLanes)!==0),N){if(x)return oy(s,c,p);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),D(gr,gr.current),x)break;return null;case 22:case 23:return c.lanes=0,od(s,c,p);case 24:Ui(c,Hn,s.memoizedState.cache)}return Ys(s,c,p)}function qf(s,c,p){if(s!==null)if(s.memoizedProps!==c.pendingProps)Fr=!0;else{if(!Ra(s,p)&&(c.flags&128)===0)return Fr=!1,xi(s,c,p);Fr=(s.flags&131072)!==0}else Fr=!1,un&&(c.flags&1048576)!==0&&up(c,Mu,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")pr(x)?(s=Ro(x,s),c.tag=1,c=Mo(null,c,x,s,p)):(c.tag=0,c=Oc(null,c,x,s,p));else{if(x!=null){if(N=x.$$typeof,N===z){c.tag=11,c=Ff(null,c,x,s,p);break e}else if(N===B){c.tag=14,c=$f(null,c,x,s,p);break e}}throw c=ie(x)||x,Error(r(306,c,""))}}return c;case 0:return Oc(s,c,c.type,c.pendingProps,p);case 1:return x=c.type,N=Ro(x,c.pendingProps),Mo(s,c,x,N,p);case 3:e:{if(J(c,c.stateNode.containerInfo),s===null)throw Error(r(387));x=c.pendingProps;var A=c.memoizedState;N=A.element,Ac(s,c),oi(c,x,null,p);var U=c.memoizedState;if(x=U.cache,Ui(c,Hn,x),x!==A.cache&&nn(c,[Hn],p,!0),Da(),x=U.element,A.isDehydrated)if(A={element:x,isDehydrated:!1,cache:U.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=ay(s,c,x,p);break e}else if(x!==N){N=Qr(Error(r(424)),c),To(N),c=ay(s,c,x,p);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ar=Oa(s.firstChild),Er=c,un=!0,Aa=null,Si=!0,p=Xg(c,null,x,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Fu(),x===N){c=Ys(s,c,p);break e}er(s,c,x,p)}c=c.child}return c;case 26:return Et(s,c),s===null?(p=rx(c.type,null,c.pendingProps,null))?c.memoizedState=p:un||(p=c.type,s=c.pendingProps,x=Vl(te.current).createElement(p),x[An]=c,x[Sr]=s,Ir(x,p,s),Nr(x),c.stateNode=x):c.memoizedState=rx(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return He(c),s===null&&un&&(x=c.stateNode=ex(c.type,c.pendingProps,te.current),Er=c,Si=!0,N=ar,ca(c.type)?(gm=N,ar=Oa(x.firstChild)):ar=N),er(s,c,c.pendingProps.children,p),Et(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&un&&((N=x=ar)&&(x=Xy(x,c.type,c.pendingProps,Si),x!==null?(c.stateNode=x,Er=c,ar=Oa(x.firstChild),Si=!1,N=!0):N=!1),N||ra(c)),He(c),N=c.type,A=c.pendingProps,U=s!==null?s.memoizedProps:null,x=A.children,sh(N,A)?x=null:U!==null&&sh(N,U)&&(c.flags|=32),c.memoizedState!==null&&(N=xp(s,c,bp,null,null,p),tu._currentValue=N),Et(s,c),er(s,c,x,p),c.child;case 6:return s===null&&un&&((s=p=ar)&&(p=lh(p,c.pendingProps,Si),p!==null?(c.stateNode=p,Er=c,ar=null,s=!0):s=!1),s||ra(c)),null;case 13:return sy(s,c,p);case 4:return J(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=$l(c,null,x,p):er(s,c,x,p),c.child;case 11:return Ff(s,c,c.type,c.pendingProps,p);case 7:return er(s,c,c.pendingProps,p),c.child;case 8:return er(s,c,c.pendingProps.children,p),c.child;case 12:return er(s,c,c.pendingProps.children,p),c.child;case 10:return x=c.pendingProps,Ui(c,c.type,x.value),er(s,c,x.children,p),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,El(c),N=mr(N),x=x(N),c.flags|=1,er(s,c,x,p),c.child;case 14:return $f(s,c,c.type,c.pendingProps,p);case 15:return zf(s,c,c.type,c.pendingProps,p);case 19:return oy(s,c,p);case 31:return x=c.pendingProps,p=c.mode,x={mode:x.mode,children:x.children},s===null?(p=cd(x,p),p.ref=c.ref,c.child=p,p.return=c,c=p):(p=Xn(s.child,x),p.ref=c.ref,c.child=p,p.return=c,c=p),c;case 22:return od(s,c,p);case 24:return El(c),x=mr(Hn),s===null?(N=Bs(),N===null&&(N=Qn,A=fp(),N.pooledCache=A,A.refCount++,A!==null&&(N.pooledCacheLanes|=p),N=A),c.memoizedState={parent:x,cache:N},Pl(c),Ui(c,Hn,N)):((s.lanes&p)!==0&&(Ac(s,c),oi(c,null,null,p),Da()),N=s.memoizedState,A=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),Ui(c,Hn,x)):(x=A.cache,Ui(c,Hn,x),x!==N.cache&&nn(c,[Hn],p,!0))),er(s,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Ws(s){s.flags|=4}function Vf(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Rr(c)){if(c=Vi.current,c!==null&&((bn&4194048)===bn?yi!==null:(bn&62914560)!==bn&&(bn&536870912)===0||c!==yi))throw Ec=pp,Dg;s.flags|=8192}}function Hf(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?Nt():536870912,s.lanes|=c,qc|=c)}function ud(s,c){if(!un)switch(s.tailMode){case"hidden":c=s.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Gn(s){var c=s.alternate!==null&&s.alternate.child===s.child,p=0,x=0;if(c)for(var N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=x,s.childLanes=p,c}function ly(s,c,p){var x=c.pendingProps;switch(Ou(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gn(c),null;case 1:return Gn(c),null;case 3:return p=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),ia(Hn),xe(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Lu(c)?Ws(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,kg())),Gn(c),null;case 26:return p=c.memoizedState,s===null?(Ws(c),p!==null?(Gn(c),Vf(c,p)):(Gn(c),c.flags&=-16777217)):p?p!==s.memoizedState?(Ws(c),Gn(c),Vf(c,p)):(Gn(c),c.flags&=-16777217):(s.memoizedProps!==x&&Ws(c),Gn(c),c.flags&=-16777217),null;case 27:re(c),p=te.current;var N=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Ws(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Gn(c),null}s=me.current,Lu(c)?_g(c):(s=ex(N,x,p),c.stateNode=s,Ws(c))}return Gn(c),null;case 5:if(re(c),p=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Ws(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Gn(c),null}if(s=me.current,Lu(c))_g(c);else{switch(N=Vl(te.current),s){case 1:s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?N.createElement(p,{is:x.is}):N.createElement(p)}}s[An]=c,s[Sr]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)s.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=s;e:switch(Ir(s,p,x),p){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ws(c)}}return Gn(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&Ws(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(s=te.current,Lu(c)){if(s=c.stateNode,p=c.memoizedProps,x=null,N=Er,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}s[An]=c,s=!!(s.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||Wy(s.nodeValue,p)),s||ra(c)}else s=Vl(s).createTextNode(x),s[An]=c,c.stateNode=s}return Gn(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=Lu(c),x!==null&&x.dehydrated!==null){if(s===null){if(!N)throw Error(r(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[An]=c}else Fu(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Gn(c),N=!1}else N=kg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(ds(c),c):(ds(c),null)}if(ds(c),(c.flags&128)!==0)return c.lanes=p,c;if(p=x!==null,s=s!==null&&s.memoizedState!==null,p){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var A=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(A=x.memoizedState.cachePool.pool),A!==N&&(x.flags|=2048)}return p!==s&&p&&(c.child.flags|=8192),Hf(c,c.updateQueue),Gn(c),null;case 4:return xe(),s===null&&fm(c.stateNode.containerInfo),Gn(c),null;case 10:return ia(c.type),Gn(c),null;case 19:if(he(gr),N=c.memoizedState,N===null)return Gn(c),null;if(x=(c.flags&128)!==0,A=N.rendering,A===null)if(x)ud(N,!1);else{if(yr!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(A=rd(s),A!==null){for(c.flags|=128,ud(N,!1),s=A.updateQueue,c.updateQueue=s,Hf(c,s),c.subtreeFlags=0,s=p,p=c.child;p!==null;)_l(p,s),p=p.sibling;return D(gr,gr.current&1|2),c.child}s=s.sibling}N.tail!==null&&Ze()>Vc&&(c.flags|=128,x=!0,ud(N,!1),c.lanes=4194304)}else{if(!x)if(s=rd(A),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,Hf(c,s),ud(N,!0),N.tail===null&&N.tailMode==="hidden"&&!A.alternate&&!un)return Gn(c),null}else 2*Ze()-N.renderingStartTime>Vc&&p!==536870912&&(c.flags|=128,x=!0,ud(N,!1),c.lanes=4194304);N.isBackwards?(A.sibling=c.child,c.child=A):(s=N.last,s!==null?s.sibling=A:c.child=A,N.last=A)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=Ze(),c.sibling=null,s=gr.current,D(gr,x?s&1|2:s&1),c):(Gn(c),null);case 22:case 23:return ds(c),yp(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(p&536870912)!==0&&(c.flags&128)===0&&(Gn(c),c.subtreeFlags&6&&(c.flags|=8192)):Gn(c),p=c.updateQueue,p!==null&&Hf(c,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==p&&(c.flags|=2048),s!==null&&he(Al),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),ia(Hn),Gn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function cy(s,c){switch(Ou(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return ia(Hn),xe(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return re(c),null;case 13:if(ds(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Fu()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return he(gr),null;case 4:return xe(),null;case 10:return ia(c.type),null;case 22:case 23:return ds(c),yp(),s!==null&&he(Al),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return ia(Hn),null;case 25:return null;default:return null}}function uy(s,c){switch(Ou(c),c.tag){case 3:ia(Hn),xe();break;case 26:case 27:case 5:re(c);break;case 4:xe();break;case 13:ds(c);break;case 19:he(gr);break;case 10:ia(c.type);break;case 22:case 23:ds(c),yp(),s!==null&&he(Al);break;case 24:ia(Hn)}}function dd(s,c){try{var p=c.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var N=x.next;p=N;do{if((p.tag&s)===s){x=void 0;var A=p.create,U=p.inst;x=A(),U.destroy=x}p=p.next}while(p!==N)}}catch(Z){Yn(c,c.return,Z)}}function Oo(s,c,p){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var A=N.next;x=A;do{if((x.tag&s)===s){var U=x.inst,Z=U.destroy;if(Z!==void 0){U.destroy=void 0,N=c;var Se=p,$e=Z;try{$e()}catch(Je){Yn(N,Se,Je)}}}x=x.next}while(x!==A)}}catch(Je){Yn(c,c.return,Je)}}function dy(s){var c=s.updateQueue;if(c!==null){var p=s.stateNode;try{gp(c,p)}catch(x){Yn(s,s.return,x)}}}function Vp(s,c,p){p.props=Ro(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(x){Yn(s,c,x)}}function Lc(s,c){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof p=="function"?s.refCleanup=p(x):p.current=x}}catch(N){Yn(s,c,N)}}function hs(s,c){var p=s.ref,x=s.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(N){Yn(s,c,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(N){Yn(s,c,N)}else p.current=null}function Gf(s){var c=s.type,p=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(N){Yn(s,s.return,N)}}function Yf(s,c,p){try{var x=s.stateNode;Cv(x,s.type,p,c),x[Sr]=c}catch(N){Yn(s,s.return,N)}}function Fc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ca(s.type)||s.tag===4}function fd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Fc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ca(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Wf(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(s,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(s),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=ih));else if(x!==4&&(x===27&&ca(s.type)&&(p=s.stateNode,c=null),s=s.child,s!==null))for(Wf(s,c,p),s=s.sibling;s!==null;)Wf(s,c,p),s=s.sibling}function hd(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?p.insertBefore(s,c):p.appendChild(s);else if(x!==4&&(x===27&&ca(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(hd(s,c,p),s=s.sibling;s!==null;)hd(s,c,p),s=s.sibling}function pd(s){var c=s.stateNode,p=s.memoizedProps;try{for(var x=s.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);Ir(c,x,p),c[An]=s,c[Sr]=p}catch(A){Yn(s,s.return,A)}}var ps=!1,In=!1,Qs=!1,fy=typeof WeakSet=="function"?WeakSet:Set,Pr=null;function uv(s,c){if(s=s.containerInfo,Ma=fh,s=Du(s),Iu(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var N=x.anchorOffset,A=x.focusNode;x=x.focusOffset;try{p.nodeType,A.nodeType}catch{p=null;break e}var U=0,Z=-1,Se=-1,$e=0,Je=0,rt=s,Ue=null;t:for(;;){for(var ze;rt!==p||N!==0&&rt.nodeType!==3||(Z=U+N),rt!==A||x!==0&&rt.nodeType!==3||(Se=U+x),rt.nodeType===3&&(U+=rt.nodeValue.length),(ze=rt.firstChild)!==null;)Ue=rt,rt=ze;for(;;){if(rt===s)break t;if(Ue===p&&++$e===N&&(Z=U),Ue===A&&++Je===x&&(Se=U),(ze=rt.nextSibling)!==null)break;rt=Ue,Ue=rt.parentNode}rt=ze}p=Z===-1||Se===-1?null:{start:Z,end:Se}}else p=null}p=p||{start:0,end:0}}else p=null;for(ah={focusedElem:s,selectionRange:p},fh=!1,Pr=c;Pr!==null;)if(c=Pr,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,Pr=s;else for(;Pr!==null;){switch(c=Pr,A=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&A!==null){s=void 0,p=c,N=A.memoizedProps,A=A.memoizedState,x=p.stateNode;try{var Ot=Ro(p.type,N,p.elementType===p.type);s=x.getSnapshotBeforeUpdate(Ot,A),x.__reactInternalSnapshotBeforeUpdate=s}catch(Mt){Yn(p,p.return,Mt)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,p=s.nodeType,p===9)mm(s);else if(p===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":mm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=c.sibling,s!==null){s.return=c.return,Pr=s;break}Pr=c.return}}function hy(s,c,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:Lo(s,p),x&4&&dd(5,p);break;case 1:if(Lo(s,p),x&4)if(s=p.stateNode,c===null)try{s.componentDidMount()}catch(U){Yn(p,p.return,U)}else{var N=Ro(p.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(N,c,s.__reactInternalSnapshotBeforeUpdate)}catch(U){Yn(p,p.return,U)}}x&64&&dy(p),x&512&&Lc(p,p.return);break;case 3:if(Lo(s,p),x&64&&(s=p.updateQueue,s!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{gp(s,c)}catch(U){Yn(p,p.return,U)}}break;case 27:c===null&&x&4&&pd(p);case 26:case 5:Lo(s,p),c===null&&x&4&&Gf(p),x&512&&Lc(p,p.return);break;case 12:Lo(s,p);break;case 13:Lo(s,p),x&4&&gy(s,p),x&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Zf.bind(null,p),Jc(s,p))));break;case 22:if(x=p.memoizedState!==null||ps,!x){c=c!==null&&c.memoizedState!==null||In,N=ps;var A=In;ps=x,(In=c)&&!A?Ks(s,p,(p.subtreeFlags&8772)!==0):Lo(s,p),ps=N,In=A}break;case 30:break;default:Lo(s,p)}}function py(s){var c=s.alternate;c!==null&&(s.alternate=null,py(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&xu(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var sr=null,Ti=!1;function Js(s,c,p){for(p=p.child;p!==null;)my(s,c,p),p=p.sibling}function my(s,c,p){if(fe&&typeof fe.onCommitFiberUnmount=="function")try{fe.onCommitFiberUnmount(G,p)}catch{}switch(p.tag){case 26:In||hs(p,c),Js(s,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:In||hs(p,c);var x=sr,N=Ti;ca(p.type)&&(sr=p.stateNode,Ti=!1),Js(s,c,p),_d(p.stateNode),sr=x,Ti=N;break;case 5:In||hs(p,c);case 6:if(x=sr,N=Ti,sr=null,Js(s,c,p),sr=x,Ti=N,sr!==null)if(Ti)try{(sr.nodeType===9?sr.body:sr.nodeName==="HTML"?sr.ownerDocument.body:sr).removeChild(p.stateNode)}catch(A){Yn(p,c,A)}else try{sr.removeChild(p.stateNode)}catch(A){Yn(p,c,A)}break;case 18:sr!==null&&(Ti?(s=sr,oh(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,p.stateNode),Id(s)):oh(sr,p.stateNode));break;case 4:x=sr,N=Ti,sr=p.stateNode.containerInfo,Ti=!0,Js(s,c,p),sr=x,Ti=N;break;case 0:case 11:case 14:case 15:In||Oo(2,p,c),In||Oo(4,p,c),Js(s,c,p);break;case 1:In||(hs(p,c),x=p.stateNode,typeof x.componentWillUnmount=="function"&&Vp(p,c,x)),Js(s,c,p);break;case 21:Js(s,c,p);break;case 22:In=(x=In)||p.memoizedState!==null,Js(s,c,p),In=x;break;default:Js(s,c,p)}}function gy(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Id(s)}catch(p){Yn(c,c.return,p)}}function dv(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new fy),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new fy),c;default:throw Error(r(435,s.tag))}}function Hp(s,c){var p=dv(s);c.forEach(function(x){var N=yv.bind(null,s,x);p.has(x)||(p.add(x),x.then(N,N))})}function Hi(s,c){var p=c.deletions;if(p!==null)for(var x=0;x<p.length;x++){var N=p[x],A=s,U=c,Z=U;e:for(;Z!==null;){switch(Z.tag){case 27:if(ca(Z.type)){sr=Z.stateNode,Ti=!1;break e}break;case 5:sr=Z.stateNode,Ti=!1;break e;case 3:case 4:sr=Z.stateNode.containerInfo,Ti=!0;break e}Z=Z.return}if(sr===null)throw Error(r(160));my(A,U,N),sr=null,Ti=!1,A=N.alternate,A!==null&&(A.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Gp(c,s),c=c.sibling}var oa=null;function Gp(s,c){var p=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Hi(c,s),Ei(s),x&4&&(Oo(3,s,s.return),dd(3,s),Oo(5,s,s.return));break;case 1:Hi(c,s),Ei(s),x&512&&(In||p===null||hs(p,p.return)),x&64&&ps&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var N=oa;if(Hi(c,s),Ei(s),x&512&&(In||p===null||hs(p,p.return)),x&4){var A=p!==null?p.memoizedState:null;if(x=s.memoizedState,p===null)if(x===null)if(s.stateNode===null){e:{x=s.type,p=s.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":A=N.getElementsByTagName("title")[0],(!A||A[js]||A[An]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=N.createElement(x),N.head.insertBefore(A,N.querySelector("head > title"))),Ir(A,x,p),A[An]=s,Nr(A),x=A;break e;case"link":var U=sx("link","href",N).get(x+(p.href||""));if(U){for(var Z=0;Z<U.length;Z++)if(A=U[Z],A.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&A.getAttribute("rel")===(p.rel==null?null:p.rel)&&A.getAttribute("title")===(p.title==null?null:p.title)&&A.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){U.splice(Z,1);break t}}A=N.createElement(x),Ir(A,x,p),N.head.appendChild(A);break;case"meta":if(U=sx("meta","content",N).get(x+(p.content||""))){for(Z=0;Z<U.length;Z++)if(A=U[Z],A.getAttribute("content")===(p.content==null?null:""+p.content)&&A.getAttribute("name")===(p.name==null?null:p.name)&&A.getAttribute("property")===(p.property==null?null:p.property)&&A.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&A.getAttribute("charset")===(p.charSet==null?null:p.charSet)){U.splice(Z,1);break t}}A=N.createElement(x),Ir(A,x,p),N.head.appendChild(A);break;default:throw Error(r(468,x))}A[An]=s,Nr(A),x=A}s.stateNode=x}else ox(N,s.type,s.stateNode);else s.stateNode=ax(N,x,s.memoizedProps);else A!==x?(A===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):A.count--,x===null?ox(N,s.type,s.stateNode):ax(N,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Yf(s,s.memoizedProps,p.memoizedProps)}break;case 27:Hi(c,s),Ei(s),x&512&&(In||p===null||hs(p,p.return)),p!==null&&x&4&&Yf(s,s.memoizedProps,p.memoizedProps);break;case 5:if(Hi(c,s),Ei(s),x&512&&(In||p===null||hs(p,p.return)),s.flags&32){N=s.stateNode;try{Sa(N,"")}catch(ze){Yn(s,s.return,ze)}}x&4&&s.stateNode!=null&&(N=s.memoizedProps,Yf(s,N,p!==null?p.memoizedProps:N)),x&1024&&(Qs=!0);break;case 6:if(Hi(c,s),Ei(s),x&4){if(s.stateNode===null)throw Error(r(162));x=s.memoizedProps,p=s.stateNode;try{p.nodeValue=x}catch(ze){Yn(s,s.return,ze)}}break;case 3:if(eu=null,N=oa,oa=Gt(c.containerInfo),Hi(c,s),oa=N,Ei(s),x&4&&p!==null&&p.memoizedState.isDehydrated)try{Id(c.containerInfo)}catch(ze){Yn(s,s.return,ze)}Qs&&(Qs=!1,yy(s));break;case 4:x=oa,oa=Gt(s.stateNode.containerInfo),Hi(c,s),Ei(s),oa=x;break;case 12:Hi(c,s),Ei(s);break;case 13:Hi(c,s),Ei(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Zp=Ze()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Hp(s,x)));break;case 22:N=s.memoizedState!==null;var Se=p!==null&&p.memoizedState!==null,$e=ps,Je=In;if(ps=$e||N,In=Je||Se,Hi(c,s),In=Je,ps=$e,Ei(s),x&8192)e:for(c=s.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(p===null||Se||ps||In||Ul(s)),p=null,c=s;;){if(c.tag===5||c.tag===26){if(p===null){Se=p=c;try{if(A=Se.stateNode,N)U=A.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{Z=Se.stateNode;var rt=Se.memoizedProps.style,Ue=rt!=null&&rt.hasOwnProperty("display")?rt.display:null;Z.style.display=Ue==null||typeof Ue=="boolean"?"":(""+Ue).trim()}}catch(ze){Yn(Se,Se.return,ze)}}}else if(c.tag===6){if(p===null){Se=c;try{Se.stateNode.nodeValue=N?"":Se.memoizedProps}catch(ze){Yn(Se,Se.return,ze)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Hp(s,p))));break;case 19:Hi(c,s),Ei(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Hp(s,x)));break;case 30:break;case 21:break;default:Hi(c,s),Ei(s)}}function Ei(s){var c=s.flags;if(c&2){try{for(var p,x=s.return;x!==null;){if(Fc(x)){p=x;break}x=x.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var N=p.stateNode,A=fd(s);hd(s,A,N);break;case 5:var U=p.stateNode;p.flags&32&&(Sa(U,""),p.flags&=-33);var Z=fd(s);hd(s,Z,U);break;case 3:case 4:var Se=p.stateNode.containerInfo,$e=fd(s);Wf(s,$e,Se);break;default:throw Error(r(161))}}catch(Je){Yn(s,s.return,Je)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function yy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;yy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function Lo(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)hy(s,c.alternate,c),c=c.sibling}function Ul(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:Oo(4,c,c.return),Ul(c);break;case 1:hs(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&Vp(c,c.return,p),Ul(c);break;case 27:_d(c.stateNode);case 26:case 5:hs(c,c.return),Ul(c);break;case 22:c.memoizedState===null&&Ul(c);break;case 30:Ul(c);break;default:Ul(c)}s=s.sibling}}function Ks(s,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=s,A=c,U=A.flags;switch(A.tag){case 0:case 11:case 15:Ks(N,A,p),dd(4,A);break;case 1:if(Ks(N,A,p),x=A,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch($e){Yn(x,x.return,$e)}if(x=A,N=x.updateQueue,N!==null){var Z=x.stateNode;try{var Se=N.shared.hiddenCallbacks;if(Se!==null)for(N.shared.hiddenCallbacks=null,N=0;N<Se.length;N++)Og(Se[N],Z)}catch($e){Yn(x,x.return,$e)}}p&&U&64&&dy(A),Lc(A,A.return);break;case 27:pd(A);case 26:case 5:Ks(N,A,p),p&&x===null&&U&4&&Gf(A),Lc(A,A.return);break;case 12:Ks(N,A,p);break;case 13:Ks(N,A,p),p&&U&4&&gy(N,A);break;case 22:A.memoizedState===null&&Ks(N,A,p),Lc(A,A.return);break;case 30:break;default:Ks(N,A,p)}c=c.sibling}}function Yp(s,c){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&zu(p))}function Wp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&zu(s))}function ms(s,c,p,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)xy(s,c,p,x),c=c.sibling}function xy(s,c,p,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:ms(s,c,p,x),N&2048&&dd(9,c);break;case 1:ms(s,c,p,x);break;case 3:ms(s,c,p,x),N&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&zu(s)));break;case 12:if(N&2048){ms(s,c,p,x),s=c.stateNode;try{var A=c.memoizedProps,U=A.id,Z=A.onPostCommit;typeof Z=="function"&&Z(U,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Se){Yn(c,c.return,Se)}}else ms(s,c,p,x);break;case 13:ms(s,c,p,x);break;case 23:break;case 22:A=c.stateNode,U=c.alternate,c.memoizedState!==null?A._visibility&2?ms(s,c,p,x):md(s,c):A._visibility&2?ms(s,c,p,x):(A._visibility|=2,$c(s,c,p,x,(c.subtreeFlags&10256)!==0)),N&2048&&Yp(U,c);break;case 24:ms(s,c,p,x),N&2048&&Wp(c.alternate,c);break;default:ms(s,c,p,x)}}function $c(s,c,p,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=s,U=c,Z=p,Se=x,$e=U.flags;switch(U.tag){case 0:case 11:case 15:$c(A,U,Z,Se,N),dd(8,U);break;case 23:break;case 22:var Je=U.stateNode;U.memoizedState!==null?Je._visibility&2?$c(A,U,Z,Se,N):md(A,U):(Je._visibility|=2,$c(A,U,Z,Se,N)),N&&$e&2048&&Yp(U.alternate,U);break;case 24:$c(A,U,Z,Se,N),N&&$e&2048&&Wp(U.alternate,U);break;default:$c(A,U,Z,Se,N)}c=c.sibling}}function md(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=s,x=c,N=x.flags;switch(x.tag){case 22:md(p,x),N&2048&&Yp(x.alternate,x);break;case 24:md(p,x),N&2048&&Wp(x.alternate,x);break;default:md(p,x)}c=c.sibling}}var ci=8192;function zc(s){if(s.subtreeFlags&ci)for(s=s.child;s!==null;)by(s),s=s.sibling}function by(s){switch(s.tag){case 26:zc(s),s.flags&ci&&s.memoizedState!==null&&Ov(oa,s.memoizedState,s.memoizedProps);break;case 5:zc(s);break;case 3:case 4:var c=oa;oa=Gt(s.stateNode.containerInfo),zc(s),oa=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=ci,ci=16777216,zc(s),ci=c):zc(s));break;default:zc(s)}}function vy(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Bc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Pr=x,Sy(x,s)}vy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)wy(s),s=s.sibling}function wy(s){switch(s.tag){case 0:case 11:case 15:Bc(s),s.flags&2048&&Oo(9,s,s.return);break;case 3:Bc(s);break;case 12:Bc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,Qf(s)):Bc(s);break;default:Bc(s)}}function Qf(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Pr=x,Sy(x,s)}vy(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:Oo(8,c,c.return),Qf(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,Qf(c));break;default:Qf(c)}s=s.sibling}}function Sy(s,c){for(;Pr!==null;){var p=Pr;switch(p.tag){case 0:case 11:case 15:Oo(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:zu(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,Pr=x;else e:for(p=s;Pr!==null;){x=Pr;var N=x.sibling,A=x.return;if(py(x),x===p){Pr=null;break e}if(N!==null){N.return=A,Pr=N;break e}Pr=A}}}var fv={getCacheForType:function(s){var c=mr(Hn),p=c.data.get(s);return p===void 0&&(p=s(),c.data.set(s,p)),p}},Qp=typeof WeakMap=="function"?WeakMap:Map,Mn=0,Qn=null,on=null,bn=0,On=0,Gi=null,Fo=!1,Uc=!1,Jp=!1,Xs=0,yr=0,$o=0,ql=0,Kp=0,la=0,qc=0,gd=null,Ai=null,Xp=!1,Zp=0,Vc=1/0,yd=null,zo=null,Jr=0,Bo=null,Hc=null,Gc=0,em=0,tm=null,Ny=null,Yc=0,nm=null;function ui(){if((Mn&2)!==0&&bn!==0)return bn&-bn;if(Q.T!==null){var s=Tc;return s!==0?s:nh()}return Kn()}function Cy(){la===0&&(la=(bn&536870912)===0||un?mt():536870912);var s=Vi.current;return s!==null&&(s.flags|=32),la}function Yi(s,c,p){(s===Qn&&(On===2||On===9)||s.cancelPendingCommit!==null)&&(Wc(s,0),Uo(s,bn,la,!1)),fn(s,p),((Mn&2)===0||s!==Qn)&&(s===Qn&&((Mn&2)===0&&(ql|=p),yr===4&&Uo(s,bn,la,!1)),gs(s))}function _y(s,c,p){if((Mn&6)!==0)throw Error(r(327));var x=!p&&(c&124)===0&&(c&s.expiredLanes)===0||Ve(s,c),N=x?mv(s,c):am(s,c,!0),A=x;do{if(N===0){Uc&&!x&&Uo(s,c,0,!1);break}else{if(p=s.current.alternate,A&&!hv(p)){N=am(s,c,!1),A=!1;continue}if(N===2){if(A=c,s.errorRecoveryDisabledLanes&A)var U=0;else U=s.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){c=U;e:{var Z=s;N=gd;var Se=Z.current.memoizedState.isDehydrated;if(Se&&(Wc(Z,U).flags|=256),U=am(Z,U,!1),U!==2){if(Jp&&!Se){Z.errorRecoveryDisabledLanes|=A,ql|=A,N=4;break e}A=Ai,Ai=N,A!==null&&(Ai===null?Ai=A:Ai.push.apply(Ai,A))}N=U}if(A=!1,N!==2)continue}}if(N===1){Wc(s,0),Uo(s,c,0,!0);break}e:{switch(x=s,A=N,A){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Uo(x,c,la,!Fo);break e;case 2:Ai=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(N=Zp+300-Ze(),10<N)){if(Uo(x,c,la,!Fo),De(x,0,!0)!==0)break e;x.timeoutHandle=Qy(jy.bind(null,x,p,Ai,yd,Xp,c,la,ql,qc,Fo,A,2,-0,0),N);break e}jy(x,p,Ai,yd,Xp,c,la,ql,qc,Fo,A,0,-0,0)}}break}while(!0);gs(s)}function jy(s,c,p,x,N,A,U,Z,Se,$e,Je,rt,Ue,ze){if(s.timeoutHandle=-1,rt=c.subtreeFlags,(rt&8192||(rt&16785408)===16785408)&&(zr={stylesheets:null,count:0,unsuspend:Mv},by(c),rt=Lv(),rt!==null)){s.cancelPendingCommit=rt(xd.bind(null,s,c,A,p,x,N,U,Z,Se,Je,1,Ue,ze)),Uo(s,A,U,!$e);return}xd(s,c,A,p,x,N,U,Z,Se)}function hv(s){for(var c=s;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var N=p[x],A=N.getSnapshot;N=N.value;try{if(!ai(A(),N))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Uo(s,c,p,x){c&=~Kp,c&=~ql,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var N=c;0<N;){var A=31-Le(N),U=1<<A;x[A]=-1,N&=~U}p!==0&&Tt(s,p,c)}function Jf(){return(Mn&6)===0?(wd(0),!1):!0}function rm(){if(on!==null){if(On===0)var s=on.return;else s=on,X=Eo=null,wf(s),Ar=null,ki=0,s=on;for(;s!==null;)uy(s.alternate,s),s=s.return;on=null}}function Wc(s,c){var p=s.timeoutHandle;p!==-1&&(s.timeoutHandle=-1,jv(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),rm(),Qn=s,on=p=Xn(s.current,null),bn=c,On=0,Gi=null,Fo=!1,Uc=Ve(s,c),Jp=!1,qc=la=Kp=ql=$o=yr=0,Ai=gd=null,Xp=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var N=31-Le(x),A=1<<N;c|=s[N],x&=~A}return Xs=c,ls(),p}function ky(s,c){Xt=null,Q.H=td,c===gi||c===xf?(c=Rg(),On=3):c===Dg?(c=Rg(),On=4):On=c===iy?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Gi=c,on===null&&(yr=1,sd(s,Qr(c,s.current)))}function Ty(){var s=Q.H;return Q.H=td,s===null?td:s}function Ey(){var s=Q.A;return Q.A=fv,s}function im(){yr=4,Fo||(bn&4194048)!==bn&&Vi.current!==null||(Uc=!0),($o&134217727)===0&&(ql&134217727)===0||Qn===null||Uo(Qn,bn,la,!1)}function am(s,c,p){var x=Mn;Mn|=2;var N=Ty(),A=Ey();(Qn!==s||bn!==c)&&(yd=null,Wc(s,c)),c=!1;var U=yr;e:do try{if(On!==0&&on!==null){var Z=on,Se=Gi;switch(On){case 8:rm(),U=6;break e;case 3:case 2:case 9:case 6:Vi.current===null&&(c=!0);var $e=On;if(On=0,Gi=null,Qc(s,Z,Se,$e),p&&Uc){U=0;break e}break;default:$e=On,On=0,Gi=null,Qc(s,Z,Se,$e)}}pv(),U=yr;break}catch(Je){ky(s,Je)}while(!0);return c&&s.shellSuspendCounter++,X=Eo=null,Mn=x,Q.H=N,Q.A=A,on===null&&(Qn=null,bn=0,ls()),U}function pv(){for(;on!==null;)sm(on)}function mv(s,c){var p=Mn;Mn|=2;var x=Ty(),N=Ey();Qn!==s||bn!==c?(yd=null,Vc=Ze()+500,Wc(s,c)):Uc=Ve(s,c);e:do try{if(On!==0&&on!==null){c=on;var A=Gi;t:switch(On){case 1:On=0,Gi=null,Qc(s,c,A,1);break;case 2:case 9:if(Ig(A)){On=0,Gi=null,Py(c);break}c=function(){On!==2&&On!==9||Qn!==s||(On=7),gs(s)},A.then(c,c);break e;case 3:On=7;break e;case 4:On=5;break e;case 7:Ig(A)?(On=0,Gi=null,Py(c)):(On=0,Gi=null,Qc(s,c,A,7));break;case 5:var U=null;switch(on.tag){case 26:U=on.memoizedState;case 5:case 27:var Z=on;if(!U||Rr(U)){On=0,Gi=null;var Se=Z.sibling;if(Se!==null)on=Se;else{var $e=Z.return;$e!==null?(on=$e,Kf($e)):on=null}break t}}On=0,Gi=null,Qc(s,c,A,5);break;case 6:On=0,Gi=null,Qc(s,c,A,6);break;case 8:rm(),yr=6;break e;default:throw Error(r(462))}}Ay();break}catch(Je){ky(s,Je)}while(!0);return X=Eo=null,Q.H=x,Q.A=N,Mn=p,on!==null?0:(Qn=null,bn=0,ls(),yr)}function Ay(){for(;on!==null&&!Ye();)sm(on)}function sm(s){var c=qf(s.alternate,s,Xs);s.memoizedProps=s.pendingProps,c===null?Kf(s):on=c}function Py(s){var c=s,p=c.alternate;switch(c.tag){case 15:case 0:c=Bf(p,c,c.pendingProps,c.type,void 0,bn);break;case 11:c=Bf(p,c,c.pendingProps,c.type.render,c.ref,bn);break;case 5:wf(c);default:uy(p,c),c=on=_l(c,Xs),c=qf(p,c,Xs)}s.memoizedProps=s.pendingProps,c===null?Kf(s):on=c}function Qc(s,c,p,x){X=Eo=null,wf(c),Ar=null,ki=0;var N=c.return;try{if(ry(s,N,c,p,bn)){yr=1,sd(s,Qr(p,s.current)),on=null;return}}catch(A){if(N!==null)throw on=N,A;yr=1,sd(s,Qr(p,s.current)),on=null;return}c.flags&32768?(un||x===1?s=!0:Uc||(bn&536870912)!==0?s=!1:(Fo=s=!0,(x===2||x===9||x===3||x===6)&&(x=Vi.current,x!==null&&x.tag===13&&(x.flags|=16384))),Dy(c,s)):Kf(c)}function Kf(s){var c=s;do{if((c.flags&32768)!==0){Dy(c,Fo);return}s=c.return;var p=ly(c.alternate,c,Xs);if(p!==null){on=p;return}if(c=c.sibling,c!==null){on=c;return}on=c=s}while(c!==null);yr===0&&(yr=5)}function Dy(s,c){do{var p=cy(s.alternate,s);if(p!==null){p.flags&=32767,on=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(s=s.sibling,s!==null)){on=s;return}on=s=p}while(s!==null);yr=6,on=null}function xd(s,c,p,x,N,A,U,Z,Se){s.cancelPendingCommit=null;do Xf();while(Jr!==0);if((Mn&6)!==0)throw Error(r(327));if(c!==null){if(c===s.current)throw Error(r(177));if(A=c.lanes|c.childLanes,A|=_c,wn(s,p,A,U,Z,Se),s===Qn&&(on=Qn=null,bn=0),Hc=c,Bo=s,Gc=p,em=A,tm=N,Ny=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,zy(je,function(){return Ly(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=Q.T,Q.T=null,N=ne.p,ne.p=2,U=Mn,Mn|=4;try{uv(s,c,p)}finally{Mn=U,ne.p=N,Q.T=x}}Jr=1,Iy(),Ry(),My()}}function Iy(){if(Jr===1){Jr=0;var s=Bo,c=Hc,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=Q.T,Q.T=null;var x=ne.p;ne.p=2;var N=Mn;Mn|=4;try{Gp(c,s);var A=ah,U=Du(s.containerInfo),Z=A.focusedElem,Se=A.selectionRange;if(U!==Z&&Z&&Z.ownerDocument&&df(Z.ownerDocument.documentElement,Z)){if(Se!==null&&Iu(Z)){var $e=Se.start,Je=Se.end;if(Je===void 0&&(Je=$e),"selectionStart"in Z)Z.selectionStart=$e,Z.selectionEnd=Math.min(Je,Z.value.length);else{var rt=Z.ownerDocument||document,Ue=rt&&rt.defaultView||window;if(Ue.getSelection){var ze=Ue.getSelection(),Ot=Z.textContent.length,Mt=Math.min(Se.start,Ot),Bn=Se.end===void 0?Mt:Math.min(Se.end,Ot);!ze.extend&&Mt>Bn&&(U=Bn,Bn=Mt,Mt=U);var Re=Cc(Z,Mt),Ee=Cc(Z,Bn);if(Re&&Ee&&(ze.rangeCount!==1||ze.anchorNode!==Re.node||ze.anchorOffset!==Re.offset||ze.focusNode!==Ee.node||ze.focusOffset!==Ee.offset)){var Fe=rt.createRange();Fe.setStart(Re.node,Re.offset),ze.removeAllRanges(),Mt>Bn?(ze.addRange(Fe),ze.extend(Ee.node,Ee.offset)):(Fe.setEnd(Ee.node,Ee.offset),ze.addRange(Fe))}}}}for(rt=[],ze=Z;ze=ze.parentNode;)ze.nodeType===1&&rt.push({element:ze,left:ze.scrollLeft,top:ze.scrollTop});for(typeof Z.focus=="function"&&Z.focus(),Z=0;Z<rt.length;Z++){var Xe=rt[Z];Xe.element.scrollLeft=Xe.left,Xe.element.scrollTop=Xe.top}}fh=!!Ma,ah=Ma=null}finally{Mn=N,ne.p=x,Q.T=p}}s.current=c,Jr=2}}function Ry(){if(Jr===2){Jr=0;var s=Bo,c=Hc,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=Q.T,Q.T=null;var x=ne.p;ne.p=2;var N=Mn;Mn|=4;try{hy(s,c.alternate,c)}finally{Mn=N,ne.p=x,Q.T=p}}Jr=3}}function My(){if(Jr===4||Jr===3){Jr=0,at();var s=Bo,c=Hc,p=Gc,x=Ny;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Jr=5:(Jr=0,Hc=Bo=null,Oy(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(zo=null),It(p),c=c.stateNode,fe&&typeof fe.onCommitFiberRoot=="function")try{fe.onCommitFiberRoot(G,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=Q.T,N=ne.p,ne.p=2,Q.T=null;try{for(var A=s.onRecoverableError,U=0;U<x.length;U++){var Z=x[U];A(Z.value,{componentStack:Z.stack})}}finally{Q.T=c,ne.p=N}}(Gc&3)!==0&&Xf(),gs(s),N=s.pendingLanes,(p&4194090)!==0&&(N&42)!==0?s===nm?Yc++:(Yc=0,nm=s):Yc=0,wd(0)}}function Oy(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,zu(c)))}function Xf(s){return Iy(),Ry(),My(),Ly()}function Ly(){if(Jr!==5)return!1;var s=Bo,c=em;em=0;var p=It(Gc),x=Q.T,N=ne.p;try{ne.p=32>p?32:p,Q.T=null,p=tm,tm=null;var A=Bo,U=Gc;if(Jr=0,Hc=Bo=null,Gc=0,(Mn&6)!==0)throw Error(r(331));var Z=Mn;if(Mn|=4,wy(A.current),xy(A,A.current,U,p),Mn=Z,wd(0,!1),fe&&typeof fe.onPostCommitFiberRoot=="function")try{fe.onPostCommitFiberRoot(G,A)}catch{}return!0}finally{ne.p=N,Q.T=x,Oy(s,c)}}function Fy(s,c,p){c=Qr(p,c),c=Lf(s.stateNode,c,2),s=Us(s,c,2),s!==null&&(fn(s,2),gs(s))}function Yn(s,c,p){if(s.tag===3)Fy(s,s,p);else for(;c!==null;){if(c.tag===3){Fy(c,s,p);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(zo===null||!zo.has(x))){s=Qr(p,s),p=$p(2),x=Us(c,p,2),x!==null&&(ny(p,x,c,s),fn(x,2),gs(x));break}}c=c.return}}function om(s,c,p){var x=s.pingCache;if(x===null){x=s.pingCache=new Qp;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(p)||(Jp=!0,N.add(p),s=gv.bind(null,s,c,p),c.then(s,s))}function gv(s,c,p){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,Qn===s&&(bn&p)===p&&(yr===4||yr===3&&(bn&62914560)===bn&&300>Ze()-Zp?(Mn&2)===0&&Wc(s,0):Kp|=p,qc===bn&&(qc=0)),gs(s)}function $y(s,c){c===0&&(c=Nt()),s=ue(s,c),s!==null&&(fn(s,c),gs(s))}function Zf(s){var c=s.memoizedState,p=0;c!==null&&(p=c.retryLane),$y(s,p)}function yv(s,c){var p=0;switch(s.tag){case 13:var x=s.stateNode,N=s.memoizedState;N!==null&&(p=N.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),$y(s,p)}function zy(s,c){return Ae(s,c)}var bd=null,qo=null,eh=!1,vd=!1,th=!1,Vo=0;function gs(s){s!==qo&&s.next===null&&(qo===null?bd=qo=s:qo=qo.next=s),vd=!0,eh||(eh=!0,lm())}function wd(s,c){if(!th&&vd){th=!0;do for(var p=!1,x=bd;x!==null;){if(s!==0){var N=x.pendingLanes;if(N===0)var A=0;else{var U=x.suspendedLanes,Z=x.pingedLanes;A=(1<<31-Le(42|s)+1)-1,A&=N&~(U&~Z),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(p=!0,Uy(x,A))}else A=bn,A=De(x,x===Qn?A:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(A&3)===0||Ve(x,A)||(p=!0,Uy(x,A));x=x.next}while(p);th=!1}}function xv(){Sd()}function Sd(){vd=eh=!1;var s=0;Vo!==0&&(_v()&&(s=Vo),Vo=0);for(var c=Ze(),p=null,x=bd;x!==null;){var N=x.next,A=Nd(x,c);A===0?(x.next=null,p===null?bd=N:p.next=N,N===null&&(qo=p)):(p=x,(s!==0||(A&3)!==0)&&(vd=!0)),x=N}wd(s)}function Nd(s,c){for(var p=s.suspendedLanes,x=s.pingedLanes,N=s.expirationTimes,A=s.pendingLanes&-62914561;0<A;){var U=31-Le(A),Z=1<<U,Se=N[U];Se===-1?((Z&p)===0||(Z&x)!==0)&&(N[U]=ot(Z,c)):Se<=c&&(s.expiredLanes|=Z),A&=~Z}if(c=Qn,p=bn,p=De(s,s===c?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,p===0||s===c&&(On===2||On===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&Ie(x),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||Ve(s,p)){if(c=p&-p,c===s.callbackPriority)return c;switch(x!==null&&Ie(x),It(p)){case 2:case 8:p=yt;break;case 32:p=je;break;case 268435456:p=_e;break;default:p=je}return x=By.bind(null,s),p=Ae(p,x),s.callbackPriority=c,s.callbackNode=p,c}return x!==null&&x!==null&&Ie(x),s.callbackPriority=2,s.callbackNode=null,2}function By(s,c){if(Jr!==0&&Jr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(Xf()&&s.callbackNode!==p)return null;var x=bn;return x=De(s,s===Qn?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(_y(s,x,c),Nd(s,Ze()),s.callbackNode!=null&&s.callbackNode===p?By.bind(null,s):null)}function Uy(s,c){if(Xf())return null;_y(s,c,!0)}function lm(){kv(function(){(Mn&6)!==0?Ae(st,xv):Sd()})}function nh(){return Vo===0&&(Vo=mt()),Vo}function qy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Za(""+s)}function Vy(s,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,s.id&&p.setAttribute("form",s.id),c.parentNode.insertBefore(p,c),s=new FormData(s),p.parentNode.removeChild(p),s}function bv(s,c,p,x,N){if(c==="submit"&&p&&p.stateNode===N){var A=qy((N[Sr]||null).action),U=x.submitter;U&&(c=(c=U[Sr]||null)?qy(c.formAction):U.getAttribute("formAction"),c!==null&&(A=c,U=null));var Z=new fc("action","action",null,x,N);s.push({event:Z,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Vo!==0){var Se=U?Vy(N,U):new FormData(N);Zu(p,{pending:!0,data:Se,method:N.method,action:A},null,Se)}}else typeof A=="function"&&(Z.preventDefault(),Se=U?Vy(N,U):new FormData(N),Zu(p,{pending:!0,data:Se,method:N.method,action:A},A,Se))},currentTarget:N}]})}}for(var cm=0;cm<Sn.length;cm++){var um=Sn[cm],vv=um.toLowerCase(),wv=um[0].toUpperCase()+um.slice(1);Bi(vv,"on"+wv)}Bi(pi,"onAnimationEnd"),Bi(ff,"onAnimationIteration"),Bi(mi,"onAnimationStart"),Bi("dblclick","onDoubleClick"),Bi("focusin","onFocus"),Bi("focusout","onBlur"),Bi(Sl,"onTransitionRun"),Bi(lp,"onTransitionStart"),Bi(jo,"onTransitionCancel"),Bi(Nl,"onTransitionEnd"),co("onMouseEnter",["mouseout","mouseover"]),co("onMouseLeave",["mouseout","mouseover"]),co("onPointerEnter",["pointerout","pointerover"]),co("onPointerLeave",["pointerout","pointerover"]),As("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),As("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),As("onBeforeInput",["compositionend","keypress","textInput","paste"]),As("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),As("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),As("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Cd));function Hy(s,c){c=(c&4)!==0;for(var p=0;p<s.length;p++){var x=s[p],N=x.event;x=x.listeners;e:{var A=void 0;if(c)for(var U=x.length-1;0<=U;U--){var Z=x[U],Se=Z.instance,$e=Z.currentTarget;if(Z=Z.listener,Se!==A&&N.isPropagationStopped())break e;A=Z,N.currentTarget=$e;try{A(N)}catch(Je){zl(Je)}N.currentTarget=null,A=Se}else for(U=0;U<x.length;U++){if(Z=x[U],Se=Z.instance,$e=Z.currentTarget,Z=Z.listener,Se!==A&&N.isPropagationStopped())break e;A=Z,N.currentTarget=$e;try{A(N)}catch(Je){zl(Je)}N.currentTarget=null,A=Se}}}}function ln(s,c){var p=c[_s];p===void 0&&(p=c[_s]=new Set);var x=s+"__bubble";p.has(x)||(Gy(c,s,2,!1),p.add(x))}function dm(s,c,p){var x=0;c&&(x|=4),Gy(p,s,x,c)}var Pi="_reactListening"+Math.random().toString(36).slice(2);function fm(s){if(!s[Pi]){s[Pi]=!0,ef.forEach(function(p){p!=="selectionchange"&&(Sv.has(p)||dm(p,!1,s),dm(p,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[Pi]||(c[Pi]=!0,dm("selectionchange",!1,c))}}function Gy(s,c,p,x){switch(dx(c)){case 2:var N=zv;break;case 8:N=nu;break;default:N=Sm}p=N.bind(null,c,p,s),N=void 0,!Rs||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?s.addEventListener(c,p,{capture:!0,passive:N}):s.addEventListener(c,p,!0):N!==void 0?s.addEventListener(c,p,{passive:N}):s.addEventListener(c,p,!1)}function Zs(s,c,p,x,N){var A=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var U=x.tag;if(U===3||U===4){var Z=x.stateNode.containerInfo;if(Z===N)break;if(U===4)for(U=x.return;U!==null;){var Se=U.tag;if((Se===3||Se===4)&&U.stateNode.containerInfo===N)return;U=U.return}for(;Z!==null;){if(U=va(Z),U===null)return;if(Se=U.tag,Se===5||Se===6||Se===26||Se===27){x=A=U;continue e}Z=Z.parentNode}}x=x.return}dc(function(){var $e=A,Je=po(p),rt=[];e:{var Ue=Cl.get(s);if(Ue!==void 0){var ze=fc,Ot=s;switch(s){case"keypress":if(jn(p)===0)break e;case"keydown":case"keyup":ze=ju;break;case"focusin":Ot="focus",ze=yl;break;case"focusout":Ot="blur",ze=yl;break;case"beforeblur":case"afterblur":ze=yl;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ze=_a;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ze=pc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ze=ku;break;case pi:case ff:case mi:ze=bl;break;case Nl:ze=xo;break;case"scroll":case"scrollend":ze=gl;break;case"wheel":ze=ap;break;case"copy":case"cut":case"paste":ze=mc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ze=ii;break;case"toggle":case"beforetoggle":ze=is}var Mt=(c&4)!==0,Bn=!Mt&&(s==="scroll"||s==="scrollend"),Re=Mt?Ue!==null?Ue+"Capture":null:Ue;Mt=[];for(var Ee=$e,Fe;Ee!==null;){var Xe=Ee;if(Fe=Xe.stateNode,Xe=Xe.tag,Xe!==5&&Xe!==26&&Xe!==27||Fe===null||Re===null||(Xe=Is(Ee,Re),Xe!=null&&Mt.push(qt(Ee,Xe,Fe))),Bn)break;Ee=Ee.return}0<Mt.length&&(Ue=new ze(Ue,Ot,null,p,Je),rt.push({event:Ue,listeners:Mt}))}}if((c&7)===0){e:{if(Ue=s==="mouseover"||s==="pointerover",ze=s==="mouseout"||s==="pointerout",Ue&&p!==es&&(Ot=p.relatedTarget||p.fromElement)&&(va(Ot)||Ot[Xr]))break e;if((ze||Ue)&&(Ue=Je.window===Je?Je:(Ue=Je.ownerDocument)?Ue.defaultView||Ue.parentWindow:window,ze?(Ot=p.relatedTarget||p.toElement,ze=$e,Ot=Ot?va(Ot):null,Ot!==null&&(Bn=o(Ot),Mt=Ot.tag,Ot!==Bn||Mt!==5&&Mt!==27&&Mt!==6)&&(Ot=null)):(ze=null,Ot=$e),ze!==Ot)){if(Mt=_a,Xe="onMouseLeave",Re="onMouseEnter",Ee="mouse",(s==="pointerout"||s==="pointerover")&&(Mt=ii,Xe="onPointerLeave",Re="onPointerEnter",Ee="pointer"),Bn=ze==null?Ue:Ts(ze),Fe=Ot==null?Ue:Ts(Ot),Ue=new Mt(Xe,Ee+"leave",ze,p,Je),Ue.target=Bn,Ue.relatedTarget=Fe,Xe=null,va(Je)===$e&&(Mt=new Mt(Re,Ee+"enter",Ot,p,Je),Mt.target=Fe,Mt.relatedTarget=Bn,Xe=Mt),Bn=Xe,ze&&Ot)t:{for(Mt=ze,Re=Ot,Ee=0,Fe=Mt;Fe;Fe=Dr(Fe))Ee++;for(Fe=0,Xe=Re;Xe;Xe=Dr(Xe))Fe++;for(;0<Ee-Fe;)Mt=Dr(Mt),Ee--;for(;0<Fe-Ee;)Re=Dr(Re),Fe--;for(;Ee--;){if(Mt===Re||Re!==null&&Mt===Re.alternate)break t;Mt=Dr(Mt),Re=Dr(Re)}Mt=null}else Mt=null;ze!==null&&xr(rt,Ue,ze,Mt,!1),Ot!==null&&Bn!==null&&xr(rt,Bn,Ot,Mt,!0)}}e:{if(Ue=$e?Ts($e):window,ze=Ue.nodeName&&Ue.nodeName.toLowerCase(),ze==="select"||ze==="input"&&Ue.type==="file")var bt=sf;else if(wc(Ue))if(of)bt=cf;else{bt=Lr;var rn=Ea}else ze=Ue.nodeName,!ze||ze.toLowerCase()!=="input"||Ue.type!=="checkbox"&&Ue.type!=="radio"?$e&&cc($e.elementType)&&(bt=sf):bt=wl;if(bt&&(bt=bt(s,$e))){So(rt,bt,p,Je);break e}rn&&rn(s,Ue,$e),s==="focusout"&&$e&&Ue.type==="number"&&$e.memoizedProps.value!=null&&fl(Ue,"number",Ue.value)}switch(rn=$e?Ts($e):window,s){case"focusin":(wc(rn)||rn.contentEditable==="true")&&(_o=rn,os=$e,Pe=null);break;case"focusout":Pe=os=_o=null;break;case"mousedown":Qe=!0;break;case"contextmenu":case"mouseup":case"dragend":Qe=!1,qe(rt,p,Je);break;case"selectionchange":if(op)break;case"keydown":case"keyup":qe(rt,p,Je)}var jt;if(as)e:{switch(s){case"compositionstart":var Lt="onCompositionStart";break e;case"compositionend":Lt="onCompositionEnd";break e;case"compositionupdate":Lt="onCompositionUpdate";break e}Lt=void 0}else Ta?Au(s,p)&&(Lt="onCompositionEnd"):s==="keydown"&&p.keyCode===229&&(Lt="onCompositionStart");Lt&&(ja&&p.locale!=="ko"&&(Ta||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&Ta&&(jt=ea()):(Zi=Je,ml="value"in Zi?Zi.value:Zi.textContent,Ta=!0)),rn=rh($e,Lt),0<rn.length&&(Lt=new Wr(Lt,s,null,p,Je),rt.push({event:Lt,listeners:rn}),jt?Lt.data=jt:(jt=wo(p),jt!==null&&(Lt.data=jt)))),(jt=Eu?vc(s,p):Pu(s,p))&&(Lt=rh($e,"onBeforeInput"),0<Lt.length&&(rn=new Wr("onBeforeInput","beforeinput",null,p,Je),rt.push({event:rn,listeners:Lt}),rn.data=jt)),bv(rt,s,$e,p,Je)}Hy(rt,c)})}function qt(s,c,p){return{instance:s,listener:c,currentTarget:p}}function rh(s,c){for(var p=c+"Capture",x=[];s!==null;){var N=s,A=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||A===null||(N=Is(s,p),N!=null&&x.unshift(qt(s,N,A)),N=Is(s,c),N!=null&&x.push(qt(s,N,A))),s.tag===3)return x;s=s.return}return[]}function Dr(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function xr(s,c,p,x,N){for(var A=c._reactName,U=[];p!==null&&p!==x;){var Z=p,Se=Z.alternate,$e=Z.stateNode;if(Z=Z.tag,Se!==null&&Se===x)break;Z!==5&&Z!==26&&Z!==27||$e===null||(Se=$e,N?($e=Is(p,A),$e!=null&&U.unshift(qt(p,$e,Se))):N||($e=Is(p,A),$e!=null&&U.push(qt(p,$e,Se)))),p=p.return}U.length!==0&&s.push({event:c,listeners:U})}var Nv=/\r\n?/g,Ho=/\u0000|\uFFFD/g;function Yy(s){return(typeof s=="string"?s:""+s).replace(Nv,`
`).replace(Ho,"")}function Wy(s,c){return c=Yy(c),Yy(s)===c}function ih(){}function zn(s,c,p,x,N,A){switch(p){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||Sa(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&Sa(s,""+x);break;case"className":uo(s,"class",x);break;case"tabIndex":uo(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":uo(s,p,x);break;case"style":hl(s,x,A);break;case"data":if(c!=="object"){uo(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||p!=="href")){s.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=Za(""+x),s.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(p==="formAction"?(c!=="input"&&zn(s,c,"name",N.name,N,null),zn(s,c,"formEncType",N.formEncType,N,null),zn(s,c,"formMethod",N.formMethod,N,null),zn(s,c,"formTarget",N.formTarget,N,null)):(zn(s,c,"encType",N.encType,N,null),zn(s,c,"method",N.method,N,null),zn(s,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=Za(""+x),s.setAttribute(p,x);break;case"onClick":x!=null&&(s.onclick=ih);break;case"onScroll":x!=null&&ln("scroll",s);break;case"onScrollEnd":x!=null&&ln("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}p=Za(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""+x):s.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""):s.removeAttribute(p);break;case"capture":case"download":x===!0?s.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,x):s.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(p,x):s.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(p):s.setAttribute(p,x);break;case"popover":ln("beforetoggle",s),ln("toggle",s),tc(s,"popover",x);break;case"xlinkActuate":wr(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":wr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":wr(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":wr(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":wr(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":wr(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":wr(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":wr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":wr(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":tc(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=uc.get(p)||p,tc(s,p,x))}}function hm(s,c,p,x,N,A){switch(p){case"style":hl(s,x,A);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"children":typeof x=="string"?Sa(s,x):(typeof x=="number"||typeof x=="bigint")&&Sa(s,""+x);break;case"onScroll":x!=null&&ln("scroll",s);break;case"onScrollEnd":x!=null&&ln("scrollend",s);break;case"onClick":x!=null&&(s.onclick=ih);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!tf.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(N=p.endsWith("Capture"),c=p.slice(2,N?p.length-7:void 0),A=s[Sr]||null,A=A!=null?A[p]:null,typeof A=="function"&&s.removeEventListener(c,A,N),typeof x=="function")){typeof A!="function"&&A!==null&&(p in s?s[p]=null:s.hasAttribute(p)&&s.removeAttribute(p)),s.addEventListener(c,x,N);break e}p in s?s[p]=x:x===!0?s.setAttribute(p,""):tc(s,p,x)}}}function Ir(s,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ln("error",s),ln("load",s);var x=!1,N=!1,A;for(A in p)if(p.hasOwnProperty(A)){var U=p[A];if(U!=null)switch(A){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:zn(s,c,A,U,p,null)}}N&&zn(s,c,"srcSet",p.srcSet,p,null),x&&zn(s,c,"src",p.src,p,null);return;case"input":ln("invalid",s);var Z=A=U=N=null,Se=null,$e=null;for(x in p)if(p.hasOwnProperty(x)){var Je=p[x];if(Je!=null)switch(x){case"name":N=Je;break;case"type":U=Je;break;case"checked":Se=Je;break;case"defaultChecked":$e=Je;break;case"value":A=Je;break;case"defaultValue":Z=Je;break;case"children":case"dangerouslySetInnerHTML":if(Je!=null)throw Error(r(137,c));break;default:zn(s,c,x,Je,p,null)}}Su(s,A,Z,Se,$e,U,N,!1),ac(s);return;case"select":ln("invalid",s),x=U=A=null;for(N in p)if(p.hasOwnProperty(N)&&(Z=p[N],Z!=null))switch(N){case"value":A=Z;break;case"defaultValue":U=Z;break;case"multiple":x=Z;default:zn(s,c,N,Z,p,null)}c=A,p=U,s.multiple=!!x,c!=null?wa(s,!!x,c,!1):p!=null&&wa(s,!!x,p,!0);return;case"textarea":ln("invalid",s),A=N=x=null;for(U in p)if(p.hasOwnProperty(U)&&(Z=p[U],Z!=null))switch(U){case"value":x=Z;break;case"defaultValue":N=Z;break;case"children":A=Z;break;case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(91));break;default:zn(s,c,U,Z,p,null)}ho(s,x,N,A),ac(s);return;case"option":for(Se in p)if(p.hasOwnProperty(Se)&&(x=p[Se],x!=null))switch(Se){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:zn(s,c,Se,x,p,null)}return;case"dialog":ln("beforetoggle",s),ln("toggle",s),ln("cancel",s),ln("close",s);break;case"iframe":case"object":ln("load",s);break;case"video":case"audio":for(x=0;x<Cd.length;x++)ln(Cd[x],s);break;case"image":ln("error",s),ln("load",s);break;case"details":ln("toggle",s);break;case"embed":case"source":case"link":ln("error",s),ln("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($e in p)if(p.hasOwnProperty($e)&&(x=p[$e],x!=null))switch($e){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:zn(s,c,$e,x,p,null)}return;default:if(cc(c)){for(Je in p)p.hasOwnProperty(Je)&&(x=p[Je],x!==void 0&&hm(s,c,Je,x,p,void 0));return}}for(Z in p)p.hasOwnProperty(Z)&&(x=p[Z],x!=null&&zn(s,c,Z,x,p,null))}function Cv(s,c,p,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,A=null,U=null,Z=null,Se=null,$e=null,Je=null;for(ze in p){var rt=p[ze];if(p.hasOwnProperty(ze)&&rt!=null)switch(ze){case"checked":break;case"value":break;case"defaultValue":Se=rt;default:x.hasOwnProperty(ze)||zn(s,c,ze,null,x,rt)}}for(var Ue in x){var ze=x[Ue];if(rt=p[Ue],x.hasOwnProperty(Ue)&&(ze!=null||rt!=null))switch(Ue){case"type":A=ze;break;case"name":N=ze;break;case"checked":$e=ze;break;case"defaultChecked":Je=ze;break;case"value":U=ze;break;case"defaultValue":Z=ze;break;case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(r(137,c));break;default:ze!==rt&&zn(s,c,Ue,ze,x,rt)}}dl(s,U,Z,Se,$e,Je,A,N);return;case"select":ze=U=Z=Ue=null;for(A in p)if(Se=p[A],p.hasOwnProperty(A)&&Se!=null)switch(A){case"value":break;case"multiple":ze=Se;default:x.hasOwnProperty(A)||zn(s,c,A,null,x,Se)}for(N in x)if(A=x[N],Se=p[N],x.hasOwnProperty(N)&&(A!=null||Se!=null))switch(N){case"value":Ue=A;break;case"defaultValue":Z=A;break;case"multiple":U=A;default:A!==Se&&zn(s,c,N,A,x,Se)}c=Z,p=U,x=ze,Ue!=null?wa(s,!!p,Ue,!1):!!x!=!!p&&(c!=null?wa(s,!!p,c,!0):wa(s,!!p,p?[]:"",!1));return;case"textarea":ze=Ue=null;for(Z in p)if(N=p[Z],p.hasOwnProperty(Z)&&N!=null&&!x.hasOwnProperty(Z))switch(Z){case"value":break;case"children":break;default:zn(s,c,Z,null,x,N)}for(U in x)if(N=x[U],A=p[U],x.hasOwnProperty(U)&&(N!=null||A!=null))switch(U){case"value":Ue=N;break;case"defaultValue":ze=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==A&&zn(s,c,U,N,x,A)}oc(s,Ue,ze);return;case"option":for(var Ot in p)if(Ue=p[Ot],p.hasOwnProperty(Ot)&&Ue!=null&&!x.hasOwnProperty(Ot))switch(Ot){case"selected":s.selected=!1;break;default:zn(s,c,Ot,null,x,Ue)}for(Se in x)if(Ue=x[Se],ze=p[Se],x.hasOwnProperty(Se)&&Ue!==ze&&(Ue!=null||ze!=null))switch(Se){case"selected":s.selected=Ue&&typeof Ue!="function"&&typeof Ue!="symbol";break;default:zn(s,c,Se,Ue,x,ze)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mt in p)Ue=p[Mt],p.hasOwnProperty(Mt)&&Ue!=null&&!x.hasOwnProperty(Mt)&&zn(s,c,Mt,null,x,Ue);for($e in x)if(Ue=x[$e],ze=p[$e],x.hasOwnProperty($e)&&Ue!==ze&&(Ue!=null||ze!=null))switch($e){case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(r(137,c));break;default:zn(s,c,$e,Ue,x,ze)}return;default:if(cc(c)){for(var Bn in p)Ue=p[Bn],p.hasOwnProperty(Bn)&&Ue!==void 0&&!x.hasOwnProperty(Bn)&&hm(s,c,Bn,void 0,x,Ue);for(Je in x)Ue=x[Je],ze=p[Je],!x.hasOwnProperty(Je)||Ue===ze||Ue===void 0&&ze===void 0||hm(s,c,Je,Ue,x,ze);return}}for(var Re in p)Ue=p[Re],p.hasOwnProperty(Re)&&Ue!=null&&!x.hasOwnProperty(Re)&&zn(s,c,Re,null,x,Ue);for(rt in x)Ue=x[rt],ze=p[rt],!x.hasOwnProperty(rt)||Ue===ze||Ue==null&&ze==null||zn(s,c,rt,Ue,x,ze)}var Ma=null,ah=null;function Vl(s){return s.nodeType===9?s:s.ownerDocument}function or(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function dr(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function sh(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var pm=null;function _v(){var s=window.event;return s&&s.type==="popstate"?s===pm?!1:(pm=s,!0):(pm=null,!1)}var Qy=typeof setTimeout=="function"?setTimeout:void 0,jv=typeof clearTimeout=="function"?clearTimeout:void 0,Jy=typeof Promise=="function"?Promise:void 0,kv=typeof queueMicrotask=="function"?queueMicrotask:typeof Jy<"u"?function(s){return Jy.resolve(null).then(s).catch(Ky)}:Qy;function Ky(s){setTimeout(function(){throw s})}function ca(s){return s==="head"}function oh(s,c){var p=c,x=0,N=0;do{var A=p.nextSibling;if(s.removeChild(p),A&&A.nodeType===8)if(p=A.data,p==="/$"){if(0<x&&8>x){p=x;var U=s.ownerDocument;if(p&1&&_d(U.documentElement),p&2&&_d(U.body),p&4)for(p=U.head,_d(p),U=p.firstChild;U;){var Z=U.nextSibling,Se=U.nodeName;U[js]||Se==="SCRIPT"||Se==="STYLE"||Se==="LINK"&&U.rel.toLowerCase()==="stylesheet"||p.removeChild(U),U=Z}}if(N===0){s.removeChild(A),Id(c);return}N--}else p==="$"||p==="$?"||p==="$!"?N++:x=p.charCodeAt(0)-48;else x=0;p=A}while(p);Id(c)}function mm(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":mm(p),xu(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}s.removeChild(p)}}function Xy(s,c,p,x){for(;s.nodeType===1;){var N=p;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[js])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(A=s.getAttribute("rel"),A==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(A!==N.rel||s.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||s.getAttribute("title")!==(N.title==null?null:N.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(A=s.getAttribute("src"),(A!==(N.src==null?null:N.src)||s.getAttribute("type")!==(N.type==null?null:N.type)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&A&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var A=N.name==null?null:""+N.name;if(N.type==="hidden"&&s.getAttribute("name")===A)return s}else return s;if(s=Oa(s.nextSibling),s===null)break}return null}function lh(s,c,p){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!p||(s=Oa(s.nextSibling),s===null))return null;return s}function bi(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Jc(s,c){var p=s.ownerDocument;if(s.data!=="$?"||p.readyState==="complete")c();else{var x=function(){c(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Oa(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var gm=null;function Zy(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var p=s.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return s;c--}else p==="/$"&&c++}s=s.previousSibling}return null}function ex(s,c,p){switch(c=Vl(p),s){case"html":if(s=c.documentElement,!s)throw Error(r(452));return s;case"head":if(s=c.head,!s)throw Error(r(453));return s;case"body":if(s=c.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function _d(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);xu(s)}var Wi=new Map,ys=new Set;function Gt(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var xs=ne.d;ne.d={f:ua,r:tx,D:Tv,C:nx,L:ch,m:Ev,X:Pv,S:Av,M:Dv};function ua(){var s=xs.f(),c=Jf();return s||c}function tx(s){var c=ks(s);c!==null&&c.tag===5&&c.type==="form"?If(c):xs.r(s)}var Kc=typeof document>"u"?null:document;function Pn(s,c,p){var x=Kc;if(x&&typeof c=="string"&&c){var N=di(c);N='link[rel="'+s+'"][href="'+N+'"]',typeof p=="string"&&(N+='[crossorigin="'+p+'"]'),ys.has(N)||(ys.add(N),s={rel:s,crossOrigin:p,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),Ir(c,"link",s),Nr(c),x.head.appendChild(c)))}}function Tv(s){xs.D(s),Pn("dns-prefetch",s,null)}function nx(s,c){xs.C(s,c),Pn("preconnect",s,c)}function ch(s,c,p){xs.L(s,c,p);var x=Kc;if(x&&s&&c){var N='link[rel="preload"][as="'+di(c)+'"]';c==="image"&&p&&p.imageSrcSet?(N+='[imagesrcset="'+di(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(N+='[imagesizes="'+di(p.imageSizes)+'"]')):N+='[href="'+di(s)+'"]';var A=N;switch(c){case"style":A=Xc(s);break;case"script":A=Zc(s)}Wi.has(A)||(s=h({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:s,as:c},p),Wi.set(A,s),x.querySelector(N)!==null||c==="style"&&x.querySelector(jd(A))||c==="script"&&x.querySelector(kd(A))||(c=x.createElement("link"),Ir(c,"link",s),Nr(c),x.head.appendChild(c)))}}function Ev(s,c){xs.m(s,c);var p=Kc;if(p&&s){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+di(x)+'"][href="'+di(s)+'"]',A=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Zc(s)}if(!Wi.has(A)&&(s=h({rel:"modulepreload",href:s},c),Wi.set(A,s),p.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(kd(A)))return}x=p.createElement("link"),Ir(x,"link",s),Nr(x),p.head.appendChild(x)}}}function Av(s,c,p){xs.S(s,c,p);var x=Kc;if(x&&s){var N=Es(x).hoistableStyles,A=Xc(s);c=c||"default";var U=N.get(A);if(!U){var Z={loading:0,preload:null};if(U=x.querySelector(jd(A)))Z.loading=5;else{s=h({rel:"stylesheet",href:s,"data-precedence":c},p),(p=Wi.get(A))&&Td(s,p);var Se=U=x.createElement("link");Nr(Se),Ir(Se,"link",s),Se._p=new Promise(function($e,Je){Se.onload=$e,Se.onerror=Je}),Se.addEventListener("load",function(){Z.loading|=1}),Se.addEventListener("error",function(){Z.loading|=2}),Z.loading|=4,uh(U,c,x)}U={type:"stylesheet",instance:U,count:1,state:Z},N.set(A,U)}}}function Pv(s,c){xs.X(s,c);var p=Kc;if(p&&s){var x=Es(p).hoistableScripts,N=Zc(s),A=x.get(N);A||(A=p.querySelector(kd(N)),A||(s=h({src:s,async:!0},c),(c=Wi.get(N))&&ym(s,c),A=p.createElement("script"),Nr(A),Ir(A,"link",s),p.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function Dv(s,c){xs.M(s,c);var p=Kc;if(p&&s){var x=Es(p).hoistableScripts,N=Zc(s),A=x.get(N);A||(A=p.querySelector(kd(N)),A||(s=h({src:s,async:!0,type:"module"},c),(c=Wi.get(N))&&ym(s,c),A=p.createElement("script"),Nr(A),Ir(A,"link",s),p.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function rx(s,c,p,x){var N=(N=te.current)?Gt(N):null;if(!N)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=Xc(p.href),p=Es(N).hoistableStyles,x=p.get(c),x||(x={type:"style",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){s=Xc(p.href);var A=Es(N).hoistableStyles,U=A.get(s);if(U||(N=N.ownerDocument||N,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(s,U),(A=N.querySelector(jd(s)))&&!A._p&&(U.instance=A,U.state.loading=5),Wi.has(s)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Wi.set(s,p),A||Iv(N,s,p,U.state))),c&&x===null)throw Error(r(528,""));return U}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Zc(p),p=Es(N).hoistableScripts,x=p.get(c),x||(x={type:"script",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Xc(s){return'href="'+di(s)+'"'}function jd(s){return'link[rel="stylesheet"]['+s+"]"}function ix(s){return h({},s,{"data-precedence":s.precedence,precedence:null})}function Iv(s,c,p,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),Ir(c,"link",p),Nr(c),s.head.appendChild(c))}function Zc(s){return'[src="'+di(s)+'"]'}function kd(s){return"script[async]"+s}function ax(s,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+di(p.href)+'"]');if(x)return c.instance=x,Nr(x),x;var N=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),Nr(x),Ir(x,"style",N),uh(x,p.precedence,s),c.instance=x;case"stylesheet":N=Xc(p.href);var A=s.querySelector(jd(N));if(A)return c.state.loading|=4,c.instance=A,Nr(A),A;x=ix(p),(N=Wi.get(N))&&Td(x,N),A=(s.ownerDocument||s).createElement("link"),Nr(A);var U=A;return U._p=new Promise(function(Z,Se){U.onload=Z,U.onerror=Se}),Ir(A,"link",x),c.state.loading|=4,uh(A,p.precedence,s),c.instance=A;case"script":return A=Zc(p.src),(N=s.querySelector(kd(A)))?(c.instance=N,Nr(N),N):(x=p,(N=Wi.get(A))&&(x=h({},p),ym(x,N)),s=s.ownerDocument||s,N=s.createElement("script"),Nr(N),Ir(N,"link",x),s.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,uh(x,p.precedence,s));return c.instance}function uh(s,c,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,A=N,U=0;U<x.length;U++){var Z=x[U];if(Z.dataset.precedence===c)A=Z;else if(A!==N)break}A?A.parentNode.insertBefore(s,A.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(s,c.firstChild))}function Td(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function ym(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var eu=null;function sx(s,c,p){if(eu===null){var x=new Map,N=eu=new Map;N.set(p,x)}else N=eu,x=N.get(p),x||(x=new Map,N.set(p,x));if(x.has(s))return x;for(x.set(s,null),p=p.getElementsByTagName(s),N=0;N<p.length;N++){var A=p[N];if(!(A[js]||A[An]||s==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var U=A.getAttribute(c)||"";U=s+U;var Z=x.get(U);Z?Z.push(A):x.set(U,[A])}}return x}function ox(s,c,p){s=s.ownerDocument||s,s.head.insertBefore(p,c==="title"?s.querySelector("head > title"):null)}function Rv(s,c,p){if(p===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Rr(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var zr=null;function Mv(){}function Ov(s,c,p){if(zr===null)throw Error(r(475));var x=zr;if(c.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=Xc(p.href),A=s.querySelector(jd(N));if(A){s=A._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Ed.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=A,Nr(A);return}A=s.ownerDocument||s,p=ix(p),(N=Wi.get(N))&&Td(p,N),A=A.createElement("link"),Nr(A);var U=A;U._p=new Promise(function(Z,Se){U.onload=Z,U.onerror=Se}),Ir(A,"link",p),c.instance=A}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=Ed.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function Lv(){if(zr===null)throw Error(r(475));var s=zr;return s.stylesheets&&s.count===0&&xm(s,s.stylesheets),0<s.count?function(c){var p=setTimeout(function(){if(s.stylesheets&&xm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(p)}}:null}function Ed(){if(this.count--,this.count===0){if(this.stylesheets)xm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var dh=null;function xm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,dh=new Map,c.forEach(Fv,s),dh=null,Ed.call(s))}function Fv(s,c){if(!(c.state.loading&4)){var p=dh.get(s);if(p)var x=p.get(null);else{p=new Map,dh.set(s,p);for(var N=s.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<N.length;A++){var U=N[A];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(p.set(U.dataset.precedence,U),x=U)}x&&p.set(null,x)}N=c.instance,U=N.getAttribute("data-precedence"),A=p.get(U)||x,A===x&&p.set(null,N),p.set(U,N),this.count++,x=Ed.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),A?A.parentNode.insertBefore(N,A.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(N,s.firstChild)),c.state.loading|=4}}var tu={$$typeof:R,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function $v(s,c,p,x,N,A,U,Z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cn(0),this.hiddenUpdates=cn(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=A,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function lx(s,c,p,x,N,A,U,Z,Se,$e,Je,rt){return s=new $v(s,c,p,U,Z,Se,$e,rt),c=1,A===!0&&(c|=24),A=wt(3,null,null,c),s.current=A,A.stateNode=s,c=fp(),c.refCount++,s.pooledCache=c,c.refCount++,A.memoizedState={element:x,isDehydrated:p,cache:c},Pl(A),s}function cx(s){return s?(s=ft,s):ft}function bm(s,c,p,x,N,A){N=cx(N),x.context===null?x.context=N:x.pendingContext=N,x=Ao(c),x.payload={element:p},A=A===void 0?null:A,A!==null&&(x.callback=A),p=Us(s,x,c),p!==null&&(Yi(p,s,c),Uu(p,s,c))}function vm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<c?p:c}}function wm(s,c){vm(s,c),(s=s.alternate)&&vm(s,c)}function ux(s){if(s.tag===13){var c=ue(s,67108864);c!==null&&Yi(c,s,67108864),wm(s,67108864)}}var fh=!0;function zv(s,c,p,x){var N=Q.T;Q.T=null;var A=ne.p;try{ne.p=2,Sm(s,c,p,x)}finally{ne.p=A,Q.T=N}}function nu(s,c,p,x){var N=Q.T;Q.T=null;var A=ne.p;try{ne.p=8,Sm(s,c,p,x)}finally{ne.p=A,Q.T=N}}function Sm(s,c,p,x){if(fh){var N=Nm(x);if(N===null)Zs(s,c,x,hh,p),fx(s,x);else if(Uv(N,s,c,p,x))x.stopPropagation();else if(fx(s,x),c&4&&-1<Bv.indexOf(s)){for(;N!==null;){var A=ks(N);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var U=Oe(A.pendingLanes);if(U!==0){var Z=A;for(Z.pendingLanes|=2,Z.entangledLanes|=2;U;){var Se=1<<31-Le(U);Z.entanglements[1]|=Se,U&=~Se}gs(A),(Mn&6)===0&&(Vc=Ze()+500,wd(0))}}break;case 13:Z=ue(A,2),Z!==null&&Yi(Z,A,2),Jf(),wm(A,2)}if(A=Nm(x),A===null&&Zs(s,c,x,hh,p),A===N)break;N=A}N!==null&&x.stopPropagation()}else Zs(s,c,x,null,p)}}function Nm(s){return s=po(s),Cm(s)}var hh=null;function Cm(s){if(hh=null,s=va(s),s!==null){var c=o(s);if(c===null)s=null;else{var p=c.tag;if(p===13){if(s=l(c),s!==null)return s;s=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return hh=s,null}function dx(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ke()){case st:return 2;case yt:return 8;case je:case Ge:return 32;case _e:return 268435456;default:return 32}default:return 32}}var ph=!1,eo=null,Go=null,Yo=null,Ad=new Map,Pd=new Map,Wo=[],Bv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fx(s,c){switch(s){case"focusin":case"focusout":eo=null;break;case"dragenter":case"dragleave":Go=null;break;case"mouseover":case"mouseout":Yo=null;break;case"pointerover":case"pointerout":Ad.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pd.delete(c.pointerId)}}function Dd(s,c,p,x,N,A){return s===null||s.nativeEvent!==A?(s={blockedOn:c,domEventName:p,eventSystemFlags:x,nativeEvent:A,targetContainers:[N]},c!==null&&(c=ks(c),c!==null&&ux(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),s)}function Uv(s,c,p,x,N){switch(c){case"focusin":return eo=Dd(eo,s,c,p,x,N),!0;case"dragenter":return Go=Dd(Go,s,c,p,x,N),!0;case"mouseover":return Yo=Dd(Yo,s,c,p,x,N),!0;case"pointerover":var A=N.pointerId;return Ad.set(A,Dd(Ad.get(A)||null,s,c,p,x,N)),!0;case"gotpointercapture":return A=N.pointerId,Pd.set(A,Dd(Pd.get(A)||null,s,c,p,x,N)),!0}return!1}function hx(s){var c=va(s.target);if(c!==null){var p=o(c);if(p!==null){if(c=p.tag,c===13){if(c=l(p),c!==null){s.blockedOn=c,Yr(s.priority,function(){if(p.tag===13){var x=ui();x=Yt(x);var N=ue(p,x);N!==null&&Yi(N,p,x),wm(p,x)}});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){s.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}s.blockedOn=null}function mh(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var p=Nm(s.nativeEvent);if(p===null){p=s.nativeEvent;var x=new p.constructor(p.type,p);es=x,p.target.dispatchEvent(x),es=null}else return c=ks(p),c!==null&&ux(c),s.blockedOn=p,!1;c.shift()}return!0}function px(s,c,p){mh(s)&&p.delete(c)}function qv(){ph=!1,eo!==null&&mh(eo)&&(eo=null),Go!==null&&mh(Go)&&(Go=null),Yo!==null&&mh(Yo)&&(Yo=null),Ad.forEach(px),Pd.forEach(px)}function gh(s,c){s.blockedOn===c&&(s.blockedOn=null,ph||(ph=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,qv)))}var yh=null;function mx(s){yh!==s&&(yh=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){yh===s&&(yh=null);for(var c=0;c<s.length;c+=3){var p=s[c],x=s[c+1],N=s[c+2];if(typeof x!="function"){if(Cm(x||p)===null)continue;break}var A=ks(p);A!==null&&(s.splice(c,3),c-=3,Zu(A,{pending:!0,data:N,method:p.method,action:x},x,N))}}))}function Id(s){function c(Se){return gh(Se,s)}eo!==null&&gh(eo,s),Go!==null&&gh(Go,s),Yo!==null&&gh(Yo,s),Ad.forEach(c),Pd.forEach(c);for(var p=0;p<Wo.length;p++){var x=Wo[p];x.blockedOn===s&&(x.blockedOn=null)}for(;0<Wo.length&&(p=Wo[0],p.blockedOn===null);)hx(p),p.blockedOn===null&&Wo.shift();if(p=(s.ownerDocument||s).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var N=p[x],A=p[x+1],U=N[Sr]||null;if(typeof A=="function")U||mx(p);else if(U){var Z=null;if(A&&A.hasAttribute("formAction")){if(N=A,U=A[Sr]||null)Z=U.formAction;else if(Cm(N)!==null)continue}else Z=U.action;typeof Z=="function"?p[x+1]=Z:(p.splice(x,3),x-=3),mx(p)}}}function _m(s){this._internalRoot=s}xh.prototype.render=_m.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,x=ui();bm(p,x,s,c,null,null)},xh.prototype.unmount=_m.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;bm(s.current,2,null,s,null,null),Jf(),c[Xr]=null}};function xh(s){this._internalRoot=s}xh.prototype.unstable_scheduleHydration=function(s){if(s){var c=Kn();s={blockedOn:null,target:s,priority:c};for(var p=0;p<Wo.length&&c!==0&&c<Wo[p].priority;p++);Wo.splice(p,0,s),p===0&&hx(s)}};var gx=n.version;if(gx!=="19.1.0")throw Error(r(527,gx,"19.1.0"));ne.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=f(c),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var Vv={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bh.isDisabled&&bh.supportsFiber)try{G=bh.inject(Vv),fe=bh}catch{}}return km.createRoot=function(s,c){if(!a(s))throw Error(r(299));var p=!1,x="",N=Fp,A=Of,U=ty,Z=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(Z=c.unstable_transitionCallbacks)),c=lx(s,1,!1,null,null,p,x,N,A,U,Z,null),s[Xr]=c.current,fm(s),new _m(c)},km.hydrateRoot=function(s,c,p){if(!a(s))throw Error(r(299));var x=!1,N="",A=Fp,U=Of,Z=ty,Se=null,$e=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onUncaughtError!==void 0&&(A=p.onUncaughtError),p.onCaughtError!==void 0&&(U=p.onCaughtError),p.onRecoverableError!==void 0&&(Z=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(Se=p.unstable_transitionCallbacks),p.formState!==void 0&&($e=p.formState)),c=lx(s,1,!0,c,p??null,x,N,A,U,Z,Se,$e),c.context=cx(null),p=c.current,x=ui(),x=Yt(x),N=Ao(x),N.callback=null,Us(p,N,x),p=x,c.current.lanes=p,fn(c,p),gs(c),s[Xr]=c.current,fm(s),new xh(c)},km.version="19.1.0",km}var OS;function TP(){if(OS)return Jv.exports;OS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Jv.exports=kP(),Jv.exports}var EP=TP();const AP=({message:e="Newtons Ai HMS"})=>i.jsx("div",{className:"loading-container",children:i.jsxs("div",{className:"loading-content",children:[i.jsxs("div",{className:"spinner-ring",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}),i.jsx("div",{className:"loading-title",children:e}),i.jsx("div",{className:"loading-subtitle",children:"Loading your workspace..."})]})});function PP(e={}){const{nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a}=e,[o,l]=w.useState(!1),d=w.useRef(r);d.current=r;const f=w.useRef(a);return f.current=a,w.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",t&&(u.src+=`?hl=${t}`),u.async=!0,u.defer=!0,u.nonce=n,u.onload=()=>{var h;l(!0),(h=d.current)===null||h===void 0||h.call(d)},u.onerror=()=>{var h;l(!1),(h=f.current)===null||h===void 0||h.call(f)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[n]),o}const Zj=w.createContext(null);function DP({clientId:e,nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a,children:o}){const l=PP({nonce:n,onScriptLoadSuccess:r,onScriptLoadError:a,locale:t}),d=w.useMemo(()=>({locale:t,clientId:e,scriptLoadedSuccessfully:l}),[e,l]);return Tn.createElement(Zj.Provider,{value:d},o)}function IP(){const e=w.useContext(Zj);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function RP(e){var n;return(n=e==null?void 0:e.clientId)!==null&&n!==void 0?n:e==null?void 0:e.client_id}const MP={large:40,medium:32,small:20};function OP({onSuccess:e,onError:n,useOneTap:t,promptMomentNotification:r,type:a="standard",theme:o="outline",size:l="large",text:d,shape:f,logo_alignment:u,width:h,click_listener:g,state:b,containerProps:v,...S}){const k=w.useRef(null),{clientId:T,locale:P,scriptLoadedSuccessfully:M}=IP(),R=w.useRef(e);R.current=e;const z=w.useRef(n);z.current=n;const $=w.useRef(r);return $.current=r,w.useEffect(()=>{var L,B,q,W,I,F,V,ee,ie;if(M)return(q=(B=(L=window==null?void 0:window.google)===null||L===void 0?void 0:L.accounts)===null||B===void 0?void 0:B.id)===null||q===void 0||q.initialize({client_id:T,callback:Y=>{var Q;if(!(Y!=null&&Y.credential))return(Q=z.current)===null||Q===void 0?void 0:Q.call(z);const{credential:ne,select_by:le}=Y;R.current({credential:ne,clientId:RP(Y),select_by:le})},...S}),(F=(I=(W=window==null?void 0:window.google)===null||W===void 0?void 0:W.accounts)===null||I===void 0?void 0:I.id)===null||F===void 0||F.renderButton(k.current,{type:a,theme:o,size:l,text:d,shape:f,logo_alignment:u,width:h,locale:P,click_listener:g,state:b}),t&&((ie=(ee=(V=window==null?void 0:window.google)===null||V===void 0?void 0:V.accounts)===null||ee===void 0?void 0:ee.id)===null||ie===void 0||ie.prompt($.current)),()=>{var Y,Q,ne;t&&((ne=(Q=(Y=window==null?void 0:window.google)===null||Y===void 0?void 0:Y.accounts)===null||Q===void 0?void 0:Q.id)===null||ne===void 0||ne.cancel())}},[T,M,t,a,o,l,d,f,u,h,P]),Tn.createElement("div",{...v,ref:k,style:{height:MP[l],...v==null?void 0:v.style}})}var Tm={},LS;function LP(){if(LS)return Tm;LS=1,Object.defineProperty(Tm,"__esModule",{value:!0}),Tm.parse=l,Tm.serialize=u;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new o,k=b.length;if(k<2)return S;const T=(v==null?void 0:v.decode)||h;let P=0;do{const M=b.indexOf("=",P);if(M===-1)break;const R=b.indexOf(";",P),z=R===-1?k:R;if(M>z){P=b.lastIndexOf(";",M-1)+1;continue}const $=d(b,P,M),L=f(b,M,$),B=b.slice($,L);if(S[B]===void 0){let q=d(b,M+1,z),W=f(b,z,q);const I=T(b.slice(q,W));S[B]=I}P=z+1}while(P<k);return S}function d(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function f(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function u(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let P=b+"="+T;if(!S)return P;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);P+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);P+="; Domain="+S.domain}if(S.path){if(!r.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);P+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);P+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(P+="; HttpOnly"),S.secure&&(P+="; Secure"),S.partitioned&&(P+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":P+="; Priority=Low";break;case"medium":P+="; Priority=Medium";break;case"high":P+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":P+="; SameSite=Strict";break;case"lax":P+="; SameSite=Lax";break;case"none":P+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return P}function h(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Tm}LP();var FS="popstate";function FP(e={}){function n(r,a){let{pathname:o,search:l,hash:d}=r.location;return c1("",{pathname:o,search:l,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Zm(a)}return zP(n,t,null,e)}function br(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function ro(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function $P(){return Math.random().toString(36).substring(2,10)}function $S(e,n){return{usr:e.state,key:e.key,idx:n}}function c1(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Hh(n):n,state:t,key:n&&n.key||r||$P()}}function Zm({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Hh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function zP(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,l=a.history,d="POP",f=null,u=h();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function h(){return(l.state||{idx:null}).idx}function g(){d="POP";let T=h(),P=T==null?null:T-u;u=T,f&&f({action:d,location:k.location,delta:P})}function b(T,P){d="PUSH";let M=c1(k.location,T,P);u=h()+1;let R=$S(M,u),z=k.createHref(M);try{l.pushState(R,"",z)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;a.location.assign(z)}o&&f&&f({action:d,location:k.location,delta:1})}function v(T,P){d="REPLACE";let M=c1(k.location,T,P);u=h();let R=$S(M,u),z=k.createHref(M);l.replaceState(R,"",z),o&&f&&f({action:d,location:k.location,delta:0})}function S(T){return BP(T)}let k={get action(){return d},get location(){return e(a,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(FS,g),f=T,()=>{a.removeEventListener(FS,g),f=null}},createHref(T){return n(a,T)},createURL:S,encodeLocation(T){let P=S(T);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:b,replace:v,go(T){return l.go(T)}};return k}function BP(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),br(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Zm(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function ek(e,n,t="/"){return UP(e,n,t,!1)}function UP(e,n,t,r){let a=typeof n=="string"?Hh(n):n,o=Ql(a.pathname||"/",t);if(o==null)return null;let l=tk(e);qP(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let u=eD(o);d=XP(l[f],u,r)}return d}function tk(e,n=[],t=[],r=""){let a=(o,l,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(br(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length));let u=Yl([r,f.relativePath]),h=t.concat(f);o.children&&o.children.length>0&&(br(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),tk(o.children,n,h,u)),!(o.path==null&&!o.index)&&n.push({path:u,score:JP(u,o.index),routesMeta:h})};return e.forEach((o,l)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))a(o,l);else for(let f of nk(o.path))a(o,l,f)}),n}function nk(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let l=nk(r.join("/")),d=[];return d.push(...l.map(f=>f===""?o:[o,f].join("/"))),a&&d.push(...l),d.map(f=>e.startsWith("/")&&f===""?"/":f)}function qP(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:KP(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var VP=/^:[\w-]+$/,HP=3,GP=2,YP=1,WP=10,QP=-2,zS=e=>e==="*";function JP(e,n){let t=e.split("/"),r=t.length;return t.some(zS)&&(r+=QP),n&&(r+=GP),t.filter(a=>!zS(a)).reduce((a,o)=>a+(VP.test(o)?HP:o===""?YP:WP),r)}function KP(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function XP(e,n,t=!1){let{routesMeta:r}=e,a={},o="/",l=[];for(let d=0;d<r.length;++d){let f=r[d],u=d===r.length-1,h=o==="/"?n:n.slice(o.length)||"/",g=tb({path:f.relativePath,caseSensitive:f.caseSensitive,end:u},h),b=f.route;if(!g&&u&&t&&!r[r.length-1].route.index&&(g=tb({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},h)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:Yl([o,g.pathname]),pathnameBase:iD(Yl([o,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(o=Yl([o,g.pathnameBase]))}return l}function tb(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=ZP(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:r.reduce((u,{paramName:h,isOptional:g},b)=>{if(h==="*"){let S=d[b]||"";l=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const v=d[b];return g&&!v?u[h]=void 0:u[h]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:l,pattern:e}}function ZP(e,n=!1,t=!0){ro(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function eD(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return ro(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Ql(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function tD(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Hh(e):e;return{pathname:t?t.startsWith("/")?t:nD(t,n):n,search:aD(r),hash:sD(a)}}function nD(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function e0(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rD(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function mw(e){let n=rD(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function gw(e,n,t,r=!1){let a;typeof e=="string"?a=Hh(e):(a={...e},br(!a.pathname||!a.pathname.includes("?"),e0("?","pathname","search",a)),br(!a.pathname||!a.pathname.includes("#"),e0("#","pathname","hash",a)),br(!a.search||!a.search.includes("#"),e0("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,d;if(l==null)d=t;else{let g=n.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}d=g>=0?n[g]:"/"}let f=tD(a,d),u=l&&l!=="/"&&l.endsWith("/"),h=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(u||h)&&(f.pathname+="/"),f}var Yl=e=>e.join("/").replace(/\/\/+/g,"/"),iD=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),aD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,sD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function oD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var rk=["POST","PUT","PATCH","DELETE"];new Set(rk);var lD=["GET",...rk];new Set(lD);var Gh=w.createContext(null);Gh.displayName="DataRouter";var jb=w.createContext(null);jb.displayName="DataRouterState";var ik=w.createContext({isTransitioning:!1});ik.displayName="ViewTransition";var cD=w.createContext(new Map);cD.displayName="Fetchers";var uD=w.createContext(null);uD.displayName="Await";var oo=w.createContext(null);oo.displayName="Navigation";var ug=w.createContext(null);ug.displayName="Location";var Cs=w.createContext({outlet:null,matches:[],isDataRoute:!1});Cs.displayName="Route";var yw=w.createContext(null);yw.displayName="RouteError";function dD(e,{relative:n}={}){br(Yh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(oo),{hash:a,pathname:o,search:l}=dg(e,{relative:n}),d=o;return t!=="/"&&(d=o==="/"?t:Yl([t,o])),r.createHref({pathname:d,search:l,hash:a})}function Yh(){return w.useContext(ug)!=null}function Gr(){return br(Yh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(ug).location}var ak="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sk(e){w.useContext(oo).static||w.useLayoutEffect(e)}function Rt(){let{isDataRoute:e}=w.useContext(Cs);return e?jD():fD()}function fD(){br(Yh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(Gh),{basename:n,navigator:t}=w.useContext(oo),{matches:r}=w.useContext(Cs),{pathname:a}=Gr(),o=JSON.stringify(mw(r)),l=w.useRef(!1);return sk(()=>{l.current=!0}),w.useCallback((f,u={})=>{if(ro(l.current,ak),!l.current)return;if(typeof f=="number"){t.go(f);return}let h=gw(f,JSON.parse(o),a,u.relative==="path");e==null&&n!=="/"&&(h.pathname=h.pathname==="/"?n:Yl([n,h.pathname])),(u.replace?t.replace:t.push)(h,u.state,u)},[n,t,o,a,e])}var hD=w.createContext(null);function pD(e){let n=w.useContext(Cs).outlet;return n&&w.createElement(hD.Provider,{value:e},n)}function Xi(){let{matches:e}=w.useContext(Cs),n=e[e.length-1];return n?n.params:{}}function dg(e,{relative:n}={}){let{matches:t}=w.useContext(Cs),{pathname:r}=Gr(),a=JSON.stringify(mw(t));return w.useMemo(()=>gw(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function mD(e,n){return ok(e,n)}function ok(e,n,t,r){var M;br(Yh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=w.useContext(oo),{matches:l}=w.useContext(Cs),d=l[l.length-1],f=d?d.params:{},u=d?d.pathname:"/",h=d?d.pathnameBase:"/",g=d&&d.route;{let R=g&&g.path||"";lk(u,!g||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let b=Gr(),v;if(n){let R=typeof n=="string"?Hh(n):n;br(h==="/"||((M=R.pathname)==null?void 0:M.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${R.pathname}" was given in the \`location\` prop.`),v=R}else v=b;let S=v.pathname||"/",k=S;if(h!=="/"){let R=h.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(R.length).join("/")}let T=!o&&t&&t.matches&&t.matches.length>0?t.matches:ek(e,{pathname:k});ro(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),ro(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let P=vD(T&&T.map(R=>Object.assign({},R,{params:Object.assign({},f,R.params),pathname:Yl([h,a.encodeLocation?a.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?h:Yl([h,a.encodeLocation?a.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),l,t,r);return n&&P?w.createElement(ug.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},P):P}function gD(){let e=_D(),n=oD(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:o},"ErrorBoundary")," or"," ",w.createElement("code",{style:o},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var yD=w.createElement(gD,null),xD=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(Cs.Provider,{value:this.props.routeContext},w.createElement(yw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function bD({routeContext:e,match:n,children:t}){let r=w.useContext(Gh);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Cs.Provider,{value:e},t)}function vD(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,o=t==null?void 0:t.errors;if(o!=null){let f=a.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);br(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,d=-1;if(t)for(let f=0;f<a.length;f++){let u=a[f];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=f),u.route.id){let{loaderData:h,errors:g}=t,b=u.route.loader&&!h.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||b){l=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,u,h)=>{let g,b=!1,v=null,S=null;t&&(g=o&&u.route.id?o[u.route.id]:void 0,v=u.route.errorElement||yD,l&&(d<0&&h===0?(lk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):d===h&&(b=!0,S=u.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,h+1)),T=()=>{let P;return g?P=v:b?P=S:u.route.Component?P=w.createElement(u.route.Component,null):u.route.element?P=u.route.element:P=f,w.createElement(bD,{match:u,routeContext:{outlet:f,matches:k,isDataRoute:t!=null},children:P})};return t&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?w.createElement(xD,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function xw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wD(e){let n=w.useContext(Gh);return br(n,xw(e)),n}function SD(e){let n=w.useContext(jb);return br(n,xw(e)),n}function ND(e){let n=w.useContext(Cs);return br(n,xw(e)),n}function bw(e){let n=ND(e),t=n.matches[n.matches.length-1];return br(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function CD(){return bw("useRouteId")}function _D(){var r;let e=w.useContext(yw),n=SD("useRouteError"),t=bw("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function jD(){let{router:e}=wD("useNavigate"),n=bw("useNavigate"),t=w.useRef(!1);return sk(()=>{t.current=!0}),w.useCallback(async(a,o={})=>{ro(t.current,ak),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...o}))},[e,n])}var BS={};function lk(e,n,t){!n&&!BS[e]&&(BS[e]=!0,ro(!1,t))}w.memo(kD);function kD({routes:e,future:n,state:t}){return ok(e,void 0,t,n)}function vn({to:e,replace:n,state:t,relative:r}){br(Yh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(oo);ro(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=w.useContext(Cs),{pathname:l}=Gr(),d=Rt(),f=gw(e,mw(o),l,r==="path"),u=JSON.stringify(f);return w.useEffect(()=>{d(JSON.parse(u),{replace:n,state:t,relative:r})},[d,u,r,n,t]),null}function TD(e){return pD(e.context)}function pt(e){br(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ED({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:o=!1}){br(!Yh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=Hh(t));let{pathname:f="/",search:u="",hash:h="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=Ql(f,l);return S==null?null:{location:{pathname:S,search:u,hash:h,state:g,key:b},navigationType:r}},[l,f,u,h,g,b,r]);return ro(v!=null,`<Router basename="${l}"> is not able to match the URL "${f}${u}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(oo.Provider,{value:d},w.createElement(ug.Provider,{children:n,value:v}))}function kh({children:e,location:n}){return mD(u1(e),n)}function u1(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let o=[...n,a];if(r.type===w.Fragment){t.push.apply(t,u1(r.props.children,o));return}br(r.type===pt,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),br(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=u1(r.props.children,o)),t.push(l)}),t}var Ux="get",qx="application/x-www-form-urlencoded";function kb(e){return e!=null&&typeof e.tagName=="string"}function AD(e){return kb(e)&&e.tagName.toLowerCase()==="button"}function PD(e){return kb(e)&&e.tagName.toLowerCase()==="form"}function DD(e){return kb(e)&&e.tagName.toLowerCase()==="input"}function ID(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function RD(e,n){return e.button===0&&(!n||n==="_self")&&!ID(e)}var yx=null;function MD(){if(yx===null)try{new FormData(document.createElement("form"),0),yx=!1}catch{yx=!0}return yx}var OD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function t0(e){return e!=null&&!OD.has(e)?(ro(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${qx}"`),null):e}function LD(e,n){let t,r,a,o,l;if(PD(e)){let d=e.getAttribute("action");r=d?Ql(d,n):null,t=e.getAttribute("method")||Ux,a=t0(e.getAttribute("enctype"))||qx,o=new FormData(e)}else if(AD(e)||DD(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||d.getAttribute("action");if(r=f?Ql(f,n):null,t=e.getAttribute("formmethod")||d.getAttribute("method")||Ux,a=t0(e.getAttribute("formenctype"))||t0(d.getAttribute("enctype"))||qx,o=new FormData(d,e),!MD()){let{name:u,type:h,value:g}=e;if(h==="image"){let b=u?`${u}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else u&&o.append(u,g)}}else{if(kb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Ux,r=null,a=qx,l=e}return o&&a==="text/plain"&&(l=o,o=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:o,body:l}}function vw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function FD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function $D(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function zD(e,n,t){let r=await Promise.all(e.map(async a=>{let o=n.routes[a.route.id];if(o){let l=await FD(o,t);return l.links?l.links():[]}return[]}));return VD(r.flat(1).filter($D).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function US(e,n,t,r,a,o){let l=(f,u)=>t[u]?f.route.id!==t[u].route.id:!0,d=(f,u)=>{var h;return t[u].pathname!==f.pathname||((h=t[u].route.path)==null?void 0:h.endsWith("*"))&&t[u].params["*"]!==f.params["*"]};return o==="assets"?n.filter((f,u)=>l(f,u)||d(f,u)):o==="data"?n.filter((f,u)=>{var g;let h=r.routes[f.route.id];if(!h||!h.hasLoader)return!1;if(l(f,u)||d(f,u))return!0;if(f.route.shouldRevalidate){let b=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function BD(e,n,{includeHydrateFallback:t}={}){return UD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function UD(e){return[...new Set(e)]}function qD(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function VD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let o=JSON.stringify(qD(a));return t.has(o)||(t.add(o),r.push({key:o,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var HD=new Set([100,101,204,205]);function GD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Ql(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function ck(){let e=w.useContext(Gh);return vw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function YD(){let e=w.useContext(jb);return vw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var ww=w.createContext(void 0);ww.displayName="FrameworkContext";function uk(){let e=w.useContext(ww);return vw(e,"You must render this element inside a <HydratedRouter> element"),e}function WD(e,n){let t=w.useContext(ww),[r,a]=w.useState(!1),[o,l]=w.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:u,onMouseLeave:h,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=P=>{P.forEach(M=>{l(M.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[o,b,{}]:[o,b,{onFocus:Em(d,v),onBlur:Em(f,S),onMouseEnter:Em(u,v),onMouseLeave:Em(h,S),onTouchStart:Em(g,v)}]:[!1,b,{}]}function Em(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function QD({page:e,...n}){let{router:t}=ck(),r=w.useMemo(()=>ek(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(KD,{page:e,matches:r,...n}):null}function JD(e){let{manifest:n,routeModules:t}=uk(),[r,a]=w.useState([]);return w.useEffect(()=>{let o=!1;return zD(e,n,t).then(l=>{o||a(l)}),()=>{o=!0}},[e,n,t]),r}function KD({page:e,matches:n,...t}){let r=Gr(),{manifest:a,routeModules:o}=uk(),{basename:l}=ck(),{loaderData:d,matches:f}=YD(),u=w.useMemo(()=>US(e,n,f,a,r,"data"),[e,n,f,a,r]),h=w.useMemo(()=>US(e,n,f,a,r,"assets"),[e,n,f,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let S=new Set,k=!1;if(n.forEach(P=>{var R;let M=a.routes[P.route.id];!M||!M.hasLoader||(!u.some(z=>z.route.id===P.route.id)&&P.route.id in d&&((R=o[P.route.id])!=null&&R.shouldRevalidate)||M.hasClientLoader?k=!0:S.add(P.route.id))}),S.size===0)return[];let T=GD(e,l);return k&&S.size>0&&T.searchParams.set("_routes",n.filter(P=>S.has(P.route.id)).map(P=>P.route.id).join(",")),[T.pathname+T.search]},[l,d,r,a,u,n,e,o]),b=w.useMemo(()=>BD(h,a),[h,a]),v=JD(h);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function XD(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var dk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{dk&&(window.__reactRouterVersion="7.6.0")}catch{}function ZD({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=FP({window:t,v5Compat:!0}));let a=r.current,[o,l]=w.useState({action:a.action,location:a.location}),d=w.useCallback(f=>{w.startTransition(()=>l(f))},[l]);return w.useLayoutEffect(()=>a.listen(d),[a,d]),w.createElement(ED,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}var fk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ss=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:o,replace:l,state:d,target:f,to:u,preventScrollReset:h,viewTransition:g,...b},v){let{basename:S}=w.useContext(oo),k=typeof u=="string"&&fk.test(u),T,P=!1;if(typeof u=="string"&&k&&(T=u,dk))try{let W=new URL(window.location.href),I=u.startsWith("//")?new URL(W.protocol+u):new URL(u),F=Ql(I.pathname,S);I.origin===W.origin&&F!=null?u=F+I.search+I.hash:P=!0}catch{ro(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=dD(u,{relative:a}),[R,z,$]=WD(r,b),L=rI(u,{replace:l,state:d,target:f,preventScrollReset:h,relative:a,viewTransition:g});function B(W){n&&n(W),W.defaultPrevented||L(W)}let q=w.createElement("a",{...b,...$,href:T||M,onClick:P||o?n:B,ref:XD(v,z),target:f,"data-discover":!k&&t==="render"?"true":void 0});return R&&!k?w.createElement(w.Fragment,null,q,w.createElement(QD,{page:M})):q});Ss.displayName="Link";var eI=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:o,to:l,viewTransition:d,children:f,...u},h){let g=dg(l,{relative:u.relative}),b=Gr(),v=w.useContext(jb),{navigator:S,basename:k}=w.useContext(oo),T=v!=null&&lI(g)&&d===!0,P=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,M=b.pathname,R=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(M=M.toLowerCase(),R=R?R.toLowerCase():null,P=P.toLowerCase()),R&&k&&(R=Ql(R,k)||R);const z=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let $=M===P||!a&&M.startsWith(P)&&M.charAt(z)==="/",L=R!=null&&(R===P||!a&&R.startsWith(P)&&R.charAt(P.length)==="/"),B={isActive:$,isPending:L,isTransitioning:T},q=$?n:void 0,W;typeof r=="function"?W=r(B):W=[r,$?"active":null,L?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let I=typeof o=="function"?o(B):o;return w.createElement(Ss,{...u,"aria-current":q,className:W,ref:h,style:I,to:l,viewTransition:d},typeof f=="function"?f(B):f)});eI.displayName="NavLink";var tI=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:o,method:l=Ux,action:d,onSubmit:f,relative:u,preventScrollReset:h,viewTransition:g,...b},v)=>{let S=sI(),k=oI(d,{relative:u}),T=l.toLowerCase()==="get"?"get":"post",P=typeof d=="string"&&fk.test(d),M=R=>{if(f&&f(R),R.defaultPrevented)return;R.preventDefault();let z=R.nativeEvent.submitter,$=(z==null?void 0:z.getAttribute("formmethod"))||l;S(z||R.currentTarget,{fetcherKey:n,method:$,navigate:t,replace:a,state:o,relative:u,preventScrollReset:h,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:r?f:M,...b,"data-discover":!P&&e==="render"?"true":void 0})});tI.displayName="Form";function nI(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hk(e){let n=w.useContext(Gh);return br(n,nI(e)),n}function rI(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:o,viewTransition:l}={}){let d=Rt(),f=Gr(),u=dg(e,{relative:o});return w.useCallback(h=>{if(RD(h,n)){h.preventDefault();let g=t!==void 0?t:Zm(f)===Zm(u);d(e,{replace:g,state:r,preventScrollReset:a,relative:o,viewTransition:l})}},[f,d,u,t,r,n,e,a,o,l])}var iI=0,aI=()=>`__${String(++iI)}__`;function sI(){let{router:e}=hk("useSubmit"),{basename:n}=w.useContext(oo),t=CD();return w.useCallback(async(r,a={})=>{let{action:o,method:l,encType:d,formData:f,body:u}=LD(r,n);if(a.navigate===!1){let h=a.fetcherKey||aI();await e.fetch(h,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function oI(e,{relative:n}={}){let{basename:t}=w.useContext(oo),r=w.useContext(Cs);br(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...dg(e||".",{relative:n})},l=Gr();if(e==null){o.search=l.search;let d=new URLSearchParams(o.search),f=d.getAll("index");if(f.some(h=>h==="")){d.delete("index"),f.filter(g=>g).forEach(g=>d.append("index",g));let h=d.toString();o.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Yl([t,o.pathname])),Zm(o)}function lI(e,n={}){let t=w.useContext(ik);br(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=hk("useViewTransitionState"),a=dg(e,{relative:n.relative});if(!t.isTransitioning)return!1;let o=Ql(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=Ql(t.nextLocation.pathname,r)||t.nextLocation.pathname;return tb(a.pathname,l)!=null||tb(a.pathname,o)!=null}[...HD];var cI=Xj();class uI extends w.Component{constructor(){super(...arguments);Jn(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}const pk=w.createContext(void 0),dI=({children:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState({startDate:null,endDate:null}),[o,l]=w.useState(null),[d,f]=w.useState(null),[u,h]=w.useState(null),g=w.useCallback(()=>t(!0),[]),b=w.useCallback(()=>t(!1),[]),v=w.useCallback(()=>t(z=>!z),[]),S=w.useCallback(z=>{h(()=>z)},[]),k=w.useCallback(z=>{u?u(z):console.warn("Analysis navigator not registered")},[u]),[T,P]=w.useState(null),M=w.useCallback(z=>{P(()=>z)},[]),R=w.useCallback(async()=>T?await T():(console.warn("Analysis refresher not registered"),null),[T]);return i.jsx(pk.Provider,{value:{isOpen:n,openAssistant:g,closeAssistant:b,toggleAssistant:v,analysisDateRange:r,setAnalysisDateRange:a,analysisData:o,setAnalysisData:l,analysisNavigate:k,registerAnalysisNavigator:S,refreshAnalysis:R,registerAnalysisRefresher:M,pageContext:d,setPageContext:f},children:e})},Tb=()=>{const e=w.useContext(pk);if(e===void 0)throw new Error("useClinicAssistantContext must be used within a ClinicAssistantProvider");return e},mk=w.createContext(void 0),fI=({children:e})=>{const[n,t]=w.useState([]),[r,a]=w.useState(null),[o,l]=w.useState(""),[d,f]=w.useState(0),[u,h]=w.useState([]),g=w.useCallback(k=>{t(T=>[...T,k])},[]),b=w.useCallback((k,T)=>{t(P=>P.map(M=>M.id===k?{...M,...T}:M))},[]),v=w.useCallback(k=>{t(T=>T.filter(P=>P.id!==k))},[]),S=w.useCallback(()=>{t([]),a(null),l(""),f(0),h([])},[]);return i.jsx(mk.Provider,{value:{purchaseRows:n,setPurchaseRows:t,selectedDistributor:r,setSelectedDistributor:a,searchTerm:o,setSearchTerm:l,amountPaidToDistributor:d,setAmountPaidToDistributor:f,distributors:u,setDistributors:h,addPurchaseRow:g,updatePurchaseRow:b,removePurchaseRow:v,resetPurchase:S},children:e})},gk=()=>{const e=w.useContext(mk);if(!e)throw new Error("usePurchaseContext must be used within a PurchaseProvider");return e},yk=w.createContext(void 0),hI=({children:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(""),o=w.useCallback(()=>t(!0),[]),l=w.useCallback(()=>t(!1),[]),d=w.useCallback(()=>t(f=>!f),[]);return w.useEffect(()=>{const f=u=>{(u.ctrlKey||u.metaKey)&&u.key==="k"&&(u.preventDefault(),d()),u.key==="Escape"&&n&&l()};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[n,d,l]),i.jsx(yk.Provider,{value:{isOpen:n,openCommandBar:o,closeCommandBar:l,toggleCommandBar:d,preFilledQuery:r,setPreFilledQuery:a},children:e})},Lh=()=>{const e=w.useContext(yk);if(e===void 0)throw new Error("useCommandBar must be used within a CommandBarProvider");return e};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let pI,mI;function gI(){return{geminiUrl:pI,vertexUrl:mI}}function yI(e,n,t){var r,a,o;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=gI();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(o=l.geminiUrl)!==null&&o!==void 0?o:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fg{}function Vt(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const o=n[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function _(e,n,t){for(let o=0;o<n.length-1;o++){const l=n[o];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in e))if(Array.isArray(t))e[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[d])){const f=e[d];if(Array.isArray(t))for(let u=0;u<f.length;u++){const h=f[u];_(h,n.slice(o+1),t[u])}else for(const u of f)_(u,n.slice(o+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in e||(e[d]=[{}]);const f=e[d];_(f[0],n.slice(o+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const o=e[a];return Array.isArray(o)?o.map(l=>C(l,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vr(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function xk(e,n){const t=vr(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function bk(e,n){return Array.isArray(n)?n.map(t=>nb(e,t)):[nb(e,n)]}function nb(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function xI(e,n){const t=nb(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function bI(e,n){const t=nb(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function qS(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function vk(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>qS(e,t)):[qS(e,n)]}function d1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function VS(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function HS(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function ha(e,n){if(n==null)throw new Error("ContentUnion is required");return d1(n)?n:{role:"user",parts:vk(e,n)}}function wk(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=ha(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=ha(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>ha(e,t)):[ha(e,n)]}function fu(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(VS(n)||HS(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ha(e,n)]}const t=[],r=[],a=d1(n[0]);for(const o of n){const l=d1(o);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(o);else{if(VS(o)||HS(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(o)}}return a||t.push({role:"user",parts:vk(e,r)}),t}function Sk(e,n){return n}function Nk(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Eb(e,n){return n}function Ab(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function vI(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function hu(e,n){if(typeof n!="string")throw new Error("name must be a string");return vI(e,n,"cachedContents")}function Ck(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function pu(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function wI(e){return e!=null&&typeof e=="object"&&"name"in e}function SI(e){return e!=null&&typeof e=="object"&&"video"in e}function NI(e){return e!=null&&typeof e=="object"&&"uri"in e}function _k(e,n){var t;let r;if(wI(n)&&(r=n.name),!(NI(n)&&(r=n.uri,r===void 0))&&!(SI(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const o=r.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${r}`);r=o[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function jk(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function kk(e,n){for(const t of["models","tunedModels","publisherModels"])if(CI(n,t))return n[t];return[]}function CI(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _I(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function jI(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],_I(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function GS(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>jI(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function kI(){return{}}function TI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function EI(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],TI(e,r)),t}function AI(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],kI());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],EI(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function PI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function DI(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],PI(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function II(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=fu(e,d);Array.isArray(g)&&(g=g.map(b=>GS(e,b))),_(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&_(t,["systemInstruction"],GS(e,ha(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>AI(e,b))),_(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&_(t,["toolConfig"],DI(e,h)),r}function RI(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],xk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],II(e,a,t)),t}function MI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function OI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function LI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function FI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],LI(e,a,t)),t}function $I(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function zI(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],$I(e,r,t)),t}function BI(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function UI(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],BI(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function YS(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>UI(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function qI(){return{}}function VI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function HI(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],VI(e,r)),t}function GI(){return{}}function YI(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function WI(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],YI(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function QI(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],WI(e,r)),t}function JI(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],qI());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],HI(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],GI());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],QI(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function KI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function XI(e,n){const t={},r=C(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function ZI(e,n){const t={},r=C(n,["latLng"]);return r!=null&&_(t,["latLng"],XI(e,r)),t}function eR(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],KI(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],ZI(e,a)),t}function tR(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=fu(e,d);Array.isArray(g)&&(g=g.map(b=>YS(e,b))),_(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&_(t,["systemInstruction"],YS(e,ha(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>JI(e,b))),_(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&_(t,["toolConfig"],eR(e,h)),r}function nR(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],xk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],tR(e,a,t)),t}function rR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function iR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function aR(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function sR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],aR(e,a,t)),t}function oR(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function lR(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],oR(e,r,t)),t}function Vx(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["model"]);o!=null&&_(t,["model"],o);const l=C(n,["createTime"]);l!=null&&_(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&_(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function cR(){return{}}function uR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Vx(e,l))),_(t,["cachedContents"],o)}return t}function Hx(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["model"]);o!=null&&_(t,["model"],o);const l=C(n,["createTime"]);l!=null&&_(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&_(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function dR(){return{}}function fR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Hx(e,l))),_(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Fh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Fh||(Fh={}));class Pb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,o;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var WS;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(WS||(WS={}));var QS;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(QS||(QS={}));var JS;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(JS||(JS={}));var KS;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(KS||(KS={}));var XS;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(XS||(XS={}));var ZS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(ZS||(ZS={}));var eN;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(eN||(eN={}));var $h;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})($h||($h={}));var tN;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(tN||(tN={}));var nN;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(nN||(nN={}));var rN;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(rN||(rN={}));var iN;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(iN||(iN={}));var aN;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(aN||(aN={}));var uu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(uu||(uu={}));var sN;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(sN||(sN={}));var f1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(f1||(f1={}));var oN;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(oN||(oN={}));var lN;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(lN||(lN={}));var cN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(cN||(cN={}));var uN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(uN||(uN={}));var dN;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(dN||(dN={}));var fN;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(fN||(fN={}));var hN;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(hN||(hN={}));var pN;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(pN||(pN={}));var mN;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(mN||(mN={}));var gN;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(gN||(gN={}));var yN;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(yN||(yN={}));var xN;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(xN||(xN={}));var bN;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(bN||(bN={}));var vN;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(vN||(vN={}));var wN;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(wN||(wN={}));var SN;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(SN||(SN={}));var NN;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(NN||(NN={}));var CN;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(CN||(CN={}));class xx{get text(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",h=!1;const g=[];for(const b of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;h=!0,u+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?u:void 0}get data(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const h=[];for(const g of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&h.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(u+=atob(g.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.output}}class _N{}class jN{}class hR{}class pR{}class kN{}class TN{}class EN{}class mR{}class AN{}class PN{}class DN{}class gR{}class h1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class yR{}class xR{}class bR{get text(){var n,t,r;let a="",o=!1;const l=[];for(const d of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,u]of Object.entries(d))f!=="text"&&f!=="thought"&&u!==null&&l.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;o=!0,a+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var n,t,r;let a="";const o=[];for(const l of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(l))d!=="inlineData"&&f!==null&&o.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vR extends fg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Pb(Fh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=nR(this.apiClient,n);return d=Vt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>Hx(this.apiClient,h))}else{const u=RI(this.apiClient,n);return d=Vt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>Vx(this.apiClient,h))}}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=rR(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>Hx(this.apiClient,h))}else{const u=MI(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>Vx(this.apiClient,h))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=iR(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=dR(),g=new PN;return Object.assign(g,h),g})}else{const u=OI(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(()=>{const h=cR(),g=new PN;return Object.assign(g,h),g})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=sR(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>Hx(this.apiClient,h))}else{const u=FI(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>Vx(this.apiClient,h))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=lR(this.apiClient,n);return d=Vt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=fR(this.apiClient,h),b=new DN;return Object.assign(b,g),b})}else{const u=zI(this.apiClient,n);return d=Vt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=uR(this.apiClient,h),b=new DN;return Object.assign(b,g),b})}}}function IN(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ri(e){return this instanceof Ri?(this.v=e,this):new Ri(e)}function rb(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function d(v,S){r[v]&&(a[v]=function(k){return new Promise(function(T,P){o.push([v,k,T,P])>1||f(v,k)})},S&&(a[v]=S(a[v])))}function f(v,S){try{u(r[v](S))}catch(k){b(o[0][3],k)}}function u(v){v.value instanceof Ri?Promise.resolve(v.value.v).then(h,g):b(o[0][2],v)}function h(v){f("next",v)}function g(v){f("throw",v)}function b(v,S){v(S),o.shift(),o.length&&f(o[0][0],o[0][1])}}function p1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof IN=="function"?IN(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=e[o]&&function(l){return new Promise(function(d,f){l=e[o](l),a(d,f,l.done,l.value)})}}function a(o,l,d,f){Promise.resolve(f).then(function(u){o({value:u,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wR(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:Tk(t)}function Tk(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function SR(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function NR(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const o=[];let l=!0;for(;r<t&&e[r].role==="model";)o.push(e[r]),l&&!Tk(e[r])&&(l=!1),r++;l&&(n.push(a),n.push(...o))}return n}class CR{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new _R(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class _R{constructor(n,t,r,a={},o=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),SR(o)}async sendMessage(n){var t;await this.sendPromise;const r=ha(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l;const f=(l=(o=(await a).candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,u=f?[f]:[];this.recordHistory(r,u)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=ha(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,r)}getHistory(n=!1){return n?NR(this.history):this.history}processStreamResponse(n,t){var r,a;return rb(this,arguments,function*(){var l,d,f,u;const h=[];try{for(var g=!0,b=p1(n),v;v=yield Ri(b.next()),l=v.done,!l;g=!0){u=v.value,g=!1;const S=u;if(wR(S)){const k=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&h.push(k)}yield yield Ri(S)}}catch(S){d={error:S}}finally{try{!g&&!l&&(f=b.return)&&(yield Ri(f.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,h)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jR(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function kR(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],jR(e,r,t)),t}function TR(e,n){const t={},r=C(n,["details"]);r!=null&&_(t,["details"],r);const a=C(n,["message"]);a!=null&&_(t,["message"],a);const o=C(n,["code"]);return o!=null&&_(t,["code"],o),t}function ER(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&_(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&_(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const h=C(n,["sha256Hash"]);h!=null&&_(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&_(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&_(t,["state"],v);const S=C(n,["source"]);S!=null&&_(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&_(t,["error"],TR(e,T)),t}function AR(e,n){const t={},r=C(n,["file"]);r!=null&&_(t,["file"],ER(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function PR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","file"],_k(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function DR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","file"],_k(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function IR(e,n){const t={},r=C(n,["details"]);r!=null&&_(t,["details"],r);const a=C(n,["message"]);a!=null&&_(t,["message"],a);const o=C(n,["code"]);return o!=null&&_(t,["code"],o),t}function m1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&_(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&_(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const h=C(n,["sha256Hash"]);h!=null&&_(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&_(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&_(t,["state"],v);const S=C(n,["source"]);S!=null&&_(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&_(t,["error"],IR(e,T)),t}function RR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["files"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>m1(e,l))),_(t,["files"],o)}return t}function MR(){return{}}function OR(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LR extends fg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Pb(Fh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>m1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=kR(this.apiClient,n);return o=Vt("files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=RR(this.apiClient,f),h=new gR;return Object.assign(h,u),h})}}async createInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=AR(this.apiClient,n);return o=Vt("upload/v1beta/files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=MR(),u=new yR;return Object.assign(u,f),u})}}async get(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=PR(this.apiClient,n);return o=Vt("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>m1(this.apiClient,f))}}async delete(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=DR(this.apiClient,n);return o=Vt("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=OR(),u=new xR;return Object.assign(u,f),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FR(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function $R(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function zR(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],FR(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function BR(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],$R(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function UR(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>zR(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function qR(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>BR(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function VR(){return{}}function HR(){return{}}function GR(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function YR(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function WR(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],GR(e,r)),t}function QR(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],YR(e,r)),t}function JR(){return{}}function KR(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function XR(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],KR(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function ZR(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],XR(e,r)),t}function e4(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],VR());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],WR(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function t4(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],HR());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],QR(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],JR());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],ZR(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function n4(e,n){const t={},r=C(n,["handle"]);if(r!=null&&_(t,["handle"],r),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function r4(e,n){const t={},r=C(n,["handle"]);r!=null&&_(t,["handle"],r);const a=C(n,["transparent"]);return a!=null&&_(t,["transparent"],a),t}function RN(){return{}}function MN(){return{}}function i4(e,n){const t={},r=C(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&_(t,["silenceDurationMs"],d),t}function a4(e,n){const t={},r=C(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&_(t,["silenceDurationMs"],d),t}function s4(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],i4(e,r));const a=C(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function o4(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],a4(e,r));const a=C(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function l4(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function c4(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function u4(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],l4(e,a)),t}function d4(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],c4(e,a)),t}function f4(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],UR(e,ha(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let z=Ab(e,S);Array.isArray(z)&&(z=z.map($=>e4(e,Eb(e,$)))),_(t,["setup","tools"],z)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],n4(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],RN());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&_(t,["setup","outputAudioTranscription"],RN());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&_(t,["setup","realtimeInputConfig"],s4(e,M));const R=C(n,["contextWindowCompression"]);return t!==void 0&&R!=null&&_(t,["setup","contextWindowCompression"],u4(e,R)),r}function h4(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],qR(e,ha(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let z=Ab(e,S);Array.isArray(z)&&(z=z.map($=>t4(e,Eb(e,$)))),_(t,["setup","tools"],z)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],r4(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],MN());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&_(t,["setup","outputAudioTranscription"],MN());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&_(t,["setup","realtimeInputConfig"],o4(e,M));const R=C(n,["contextWindowCompression"]);return t!==void 0&&R!=null&&_(t,["setup","contextWindowCompression"],d4(e,R)),r}function p4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["setup","model"],vr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],f4(e,a,t)),t}function m4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["setup","model"],vr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],h4(e,a,t)),t}function g4(){return{}}function y4(){return{}}function x4(){return{}}function b4(){return{}}function v4(e,n){const t={},r=C(n,["media"]);r!=null&&_(t,["mediaChunks"],bk(e,r));const a=C(n,["audio"]);a!=null&&_(t,["audio"],bI(e,a));const o=C(n,["audioStreamEnd"]);o!=null&&_(t,["audioStreamEnd"],o);const l=C(n,["video"]);l!=null&&_(t,["video"],xI(e,l));const d=C(n,["text"]);return d!=null&&_(t,["text"],d),C(n,["activityStart"])!=null&&_(t,["activityStart"],g4()),C(n,["activityEnd"])!=null&&_(t,["activityEnd"],x4()),t}function w4(e,n){const t={},r=C(n,["media"]);if(r!=null&&_(t,["mediaChunks"],bk(e,r)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&_(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&_(t,["activityStart"],y4()),C(n,["activityEnd"])!=null&&_(t,["activityEnd"],b4()),t}function S4(){return{}}function N4(){return{}}function C4(e,n){const t={},r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function _4(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function j4(e,n){const t={},r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],C4(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function k4(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],_4(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function T4(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>j4(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function E4(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>k4(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function ON(e,n){const t={},r=C(n,["text"]);r!=null&&_(t,["text"],r);const a=C(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function LN(e,n){const t={},r=C(n,["text"]);r!=null&&_(t,["text"],r);const a=C(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function A4(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],T4(e,r));const a=C(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&_(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&_(t,["inputTranscription"],ON(e,f));const u=C(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],ON(e,u)),t}function P4(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],E4(e,r));const a=C(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&_(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&_(t,["inputTranscription"],LN(e,f));const u=C(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],LN(e,u)),t}function D4(e,n){const t={},r=C(n,["id"]);r!=null&&_(t,["id"],r);const a=C(n,["args"]);a!=null&&_(t,["args"],a);const o=C(n,["name"]);return o!=null&&_(t,["name"],o),t}function I4(e,n){const t={},r=C(n,["args"]);r!=null&&_(t,["args"],r);const a=C(n,["name"]);return a!=null&&_(t,["name"],a),t}function R4(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>D4(e,o))),_(t,["functionCalls"],a)}return t}function M4(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>I4(e,o))),_(t,["functionCalls"],a)}return t}function O4(e,n){const t={},r=C(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function L4(e,n){const t={},r=C(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function bx(e,n){const t={},r=C(n,["modality"]);r!=null&&_(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function vx(e,n){const t={},r=C(n,["modality"]);r!=null&&_(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function F4(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=C(n,["responseTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&_(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&_(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(S=>bx(e,S))),_(t,["promptTokensDetails"],v)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(S=>bx(e,S))),_(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>bx(e,S))),_(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>bx(e,S))),_(t,["toolUsePromptTokensDetails"],v)}return t}function $4(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=C(n,["candidatesTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&_(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&_(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(k=>vx(e,k))),_(t,["promptTokensDetails"],S)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(k=>vx(e,k))),_(t,["cacheTokensDetails"],S)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>vx(e,k))),_(t,["responseTokensDetails"],S)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>vx(e,k))),_(t,["toolUsePromptTokensDetails"],S)}const v=C(n,["trafficType"]);return v!=null&&_(t,["trafficType"],v),t}function z4(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function B4(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function U4(e,n){const t={},r=C(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function q4(e,n){const t={},r=C(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function V4(e,n){const t={};C(n,["setupComplete"])!=null&&_(t,["setupComplete"],S4());const a=C(n,["serverContent"]);a!=null&&_(t,["serverContent"],A4(e,a));const o=C(n,["toolCall"]);o!=null&&_(t,["toolCall"],R4(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],O4(e,l));const d=C(n,["usageMetadata"]);d!=null&&_(t,["usageMetadata"],F4(e,d));const f=C(n,["goAway"]);f!=null&&_(t,["goAway"],z4(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],U4(e,u)),t}function H4(e,n){const t={};C(n,["setupComplete"])!=null&&_(t,["setupComplete"],N4());const a=C(n,["serverContent"]);a!=null&&_(t,["serverContent"],P4(e,a));const o=C(n,["toolCall"]);o!=null&&_(t,["toolCall"],M4(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],L4(e,l));const d=C(n,["usageMetadata"]);d!=null&&_(t,["usageMetadata"],$4(e,d));const f=C(n,["goAway"]);f!=null&&_(t,["goAway"],B4(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],q4(e,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function G4(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function Y4(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],G4(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function Db(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Y4(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function W4(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=C(n,["category"]);r!=null&&_(t,["category"],r);const a=C(n,["threshold"]);return a!=null&&_(t,["threshold"],a),t}function Q4(){return{}}function J4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function K4(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],J4(e,r)),t}function X4(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],Q4());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],K4(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function Z4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function eM(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],Z4(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function tM(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function nM(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],tM(e,r)),t}function rM(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],nM(e,r));const a=C(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function iM(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function aM(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Db(e,ha(e,a)));const o=C(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&_(r,["topP"],l);const d=C(n,["topK"]);d!=null&&_(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&_(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const h=C(n,["stopSequences"]);h!=null&&_(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&_(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const P=C(n,["responseSchema"]);if(P!=null&&_(r,["responseSchema"],Sk(e,P)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=C(n,["safetySettings"]);if(t!==void 0&&M!=null){let I=M;Array.isArray(I)&&(I=I.map(F=>W4(e,F))),_(t,["safetySettings"],I)}const R=C(n,["tools"]);if(t!==void 0&&R!=null){let I=Ab(e,R);Array.isArray(I)&&(I=I.map(F=>X4(e,Eb(e,F)))),_(t,["tools"],I)}const z=C(n,["toolConfig"]);if(t!==void 0&&z!=null&&_(t,["toolConfig"],eM(e,z)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const $=C(n,["cachedContent"]);t!==void 0&&$!=null&&_(t,["cachedContent"],hu(e,$));const L=C(n,["responseModalities"]);L!=null&&_(r,["responseModalities"],L);const B=C(n,["mediaResolution"]);B!=null&&_(r,["mediaResolution"],B);const q=C(n,["speechConfig"]);if(q!=null&&_(r,["speechConfig"],rM(e,Nk(e,q))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const W=C(n,["thinkingConfig"]);return W!=null&&_(r,["thinkingConfig"],iM(e,W)),r}function FN(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Db(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["generationConfig"],aM(e,o,t)),t}function sM(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&_(t,["requests[]","taskType"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&_(t,["requests[]","title"],o);const l=C(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&_(t,["requests[]","outputDimensionality"],l),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function oM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["contents"]);a!=null&&_(t,["requests[]","content"],wk(e,a));const o=C(n,["config"]);o!=null&&_(t,["config"],sM(e,o,t));const l=C(n,["model"]);return l!==void 0&&_(t,["requests[]","model"],vr(e,l)),t}function lM(e,n,t){const r={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=C(n,["aspectRatio"]);t!==void 0&&o!=null&&_(t,["parameters","aspectRatio"],o);const l=C(n,["guidanceScale"]);if(t!==void 0&&l!=null&&_(t,["parameters","guidanceScale"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=C(n,["safetyFilterLevel"]);t!==void 0&&d!=null&&_(t,["parameters","safetySetting"],d);const f=C(n,["personGeneration"]);t!==void 0&&f!=null&&_(t,["parameters","personGeneration"],f);const u=C(n,["includeSafetyAttributes"]);t!==void 0&&u!=null&&_(t,["parameters","includeSafetyAttributes"],u);const h=C(n,["includeRaiReason"]);t!==void 0&&h!=null&&_(t,["parameters","includeRaiReason"],h);const g=C(n,["language"]);t!==void 0&&g!=null&&_(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&_(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&_(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function cM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],lM(e,o,t)),t}function uM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],vr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function dM(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&_(t,["_url","models_url"],jk(e,d)),r}function fM(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],dM(e,r,t)),t}function hM(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function pM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],vr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],hM(e,a,t)),t}function mM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],vr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function gM(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function yM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Db(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],gM(e,o)),t}function xM(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["imageBytes"]);r!=null&&_(t,["bytesBase64Encoded"],pu(e,r));const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function bM(e,n,t){const r={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=C(n,["durationSeconds"]);if(t!==void 0&&o!=null&&_(t,["parameters","durationSeconds"],o),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=C(n,["aspectRatio"]);if(t!==void 0&&l!=null&&_(t,["parameters","aspectRatio"],l),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const d=C(n,["personGeneration"]);if(t!==void 0&&d!=null&&_(t,["parameters","personGeneration"],d),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=C(n,["negativePrompt"]);if(t!==void 0&&f!=null&&_(t,["parameters","negativePrompt"],f),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function vM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&_(t,["instances[0]","image"],xM(e,o));const l=C(n,["config"]);return l!=null&&_(t,["config"],bM(e,l,t)),t}function wM(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function SM(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],wM(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function Wh(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>SM(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function NM(e,n){const t={},r=C(n,["featureSelectionPreference"]);return r!=null&&_(t,["featureSelectionPreference"],r),t}function CM(e,n){const t={},r=C(n,["method"]);r!=null&&_(t,["method"],r);const a=C(n,["category"]);a!=null&&_(t,["category"],a);const o=C(n,["threshold"]);return o!=null&&_(t,["threshold"],o),t}function _M(){return{}}function jM(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function kM(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],jM(e,r)),t}function TM(){return{}}function EM(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function AM(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],EM(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function PM(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],AM(e,r)),t}function Ek(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],_M());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],kM(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],TM());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],PM(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function DM(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function IM(e,n){const t={},r=C(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function RM(e,n){const t={},r=C(n,["latLng"]);return r!=null&&_(t,["latLng"],IM(e,r)),t}function MM(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],DM(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],RM(e,a)),t}function OM(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function LM(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],OM(e,r)),t}function FM(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],LM(e,r));const a=C(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function $M(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function zM(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Wh(e,ha(e,a)));const o=C(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&_(r,["topP"],l);const d=C(n,["topK"]);d!=null&&_(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&_(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const h=C(n,["stopSequences"]);h!=null&&_(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&_(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const P=C(n,["responseSchema"]);P!=null&&_(r,["responseSchema"],Sk(e,P));const M=C(n,["routingConfig"]);M!=null&&_(r,["routingConfig"],M);const R=C(n,["modelSelectionConfig"]);R!=null&&_(r,["modelConfig"],NM(e,R));const z=C(n,["safetySettings"]);if(t!==void 0&&z!=null){let ie=z;Array.isArray(ie)&&(ie=ie.map(Y=>CM(e,Y))),_(t,["safetySettings"],ie)}const $=C(n,["tools"]);if(t!==void 0&&$!=null){let ie=Ab(e,$);Array.isArray(ie)&&(ie=ie.map(Y=>Ek(e,Eb(e,Y)))),_(t,["tools"],ie)}const L=C(n,["toolConfig"]);t!==void 0&&L!=null&&_(t,["toolConfig"],MM(e,L));const B=C(n,["labels"]);t!==void 0&&B!=null&&_(t,["labels"],B);const q=C(n,["cachedContent"]);t!==void 0&&q!=null&&_(t,["cachedContent"],hu(e,q));const W=C(n,["responseModalities"]);W!=null&&_(r,["responseModalities"],W);const I=C(n,["mediaResolution"]);I!=null&&_(r,["mediaResolution"],I);const F=C(n,["speechConfig"]);F!=null&&_(r,["speechConfig"],FM(e,Nk(e,F)));const V=C(n,["audioTimestamp"]);V!=null&&_(r,["audioTimestamp"],V);const ee=C(n,["thinkingConfig"]);return ee!=null&&_(r,["thinkingConfig"],$M(e,ee)),r}function $N(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Wh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["generationConfig"],zM(e,o,t)),t}function BM(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&_(t,["instances[]","task_type"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&_(t,["instances[]","title"],o);const l=C(n,["outputDimensionality"]);t!==void 0&&l!=null&&_(t,["parameters","outputDimensionality"],l);const d=C(n,["mimeType"]);t!==void 0&&d!=null&&_(t,["instances[]","mimeType"],d);const f=C(n,["autoTruncate"]);return t!==void 0&&f!=null&&_(t,["parameters","autoTruncate"],f),r}function UM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["contents"]);a!=null&&_(t,["instances[]","content"],wk(e,a));const o=C(n,["config"]);return o!=null&&_(t,["config"],BM(e,o,t)),t}function qM(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&_(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&_(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&_(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["addWatermark"]);t!==void 0&&P!=null&&_(t,["parameters","addWatermark"],P);const M=C(n,["enhancePrompt"]);return t!==void 0&&M!=null&&_(t,["parameters","enhancePrompt"],M),r}function VM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],qM(e,o,t)),t}function Sw(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=C(n,["imageBytes"]);a!=null&&_(t,["bytesBase64Encoded"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function HM(e,n){const t={},r=C(n,["maskMode"]);r!=null&&_(t,["maskMode"],r);const a=C(n,["segmentationClasses"]);a!=null&&_(t,["maskClasses"],a);const o=C(n,["maskDilation"]);return o!=null&&_(t,["dilation"],o),t}function GM(e,n){const t={},r=C(n,["controlType"]);r!=null&&_(t,["controlType"],r);const a=C(n,["enableControlImageComputation"]);return a!=null&&_(t,["computeControl"],a),t}function YM(e,n){const t={},r=C(n,["styleDescription"]);return r!=null&&_(t,["styleDescription"],r),t}function WM(e,n){const t={},r=C(n,["subjectType"]);r!=null&&_(t,["subjectType"],r);const a=C(n,["subjectDescription"]);return a!=null&&_(t,["subjectDescription"],a),t}function QM(e,n){const t={},r=C(n,["referenceImage"]);r!=null&&_(t,["referenceImage"],Sw(e,r));const a=C(n,["referenceId"]);a!=null&&_(t,["referenceId"],a);const o=C(n,["referenceType"]);o!=null&&_(t,["referenceType"],o);const l=C(n,["maskImageConfig"]);l!=null&&_(t,["maskImageConfig"],HM(e,l));const d=C(n,["controlImageConfig"]);d!=null&&_(t,["controlImageConfig"],GM(e,d));const f=C(n,["styleImageConfig"]);f!=null&&_(t,["styleImageConfig"],YM(e,f));const u=C(n,["subjectImageConfig"]);return u!=null&&_(t,["subjectImageConfig"],WM(e,u)),t}function JM(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&_(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&_(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&_(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["editMode"]);t!==void 0&&P!=null&&_(t,["parameters","editMode"],P);const M=C(n,["baseSteps"]);return t!==void 0&&M!=null&&_(t,["parameters","editConfig","baseSteps"],M),r}function KM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["referenceImages"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>QM(e,f))),_(t,["instances[0]","referenceImages"],d)}const l=C(n,["config"]);return l!=null&&_(t,["config"],JM(e,l,t)),t}function XM(e,n,t){const r={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&_(t,["parameters","includeRaiReason"],a);const o=C(n,["outputMimeType"]);t!==void 0&&o!=null&&_(t,["parameters","outputOptions","mimeType"],o);const l=C(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&_(t,["parameters","outputOptions","compressionQuality"],l);const d=C(n,["numberOfImages"]);t!==void 0&&d!=null&&_(t,["parameters","sampleCount"],d);const f=C(n,["mode"]);return t!==void 0&&f!=null&&_(t,["parameters","mode"],f),r}function ZM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["image"]);a!=null&&_(t,["instances[0]","image"],Sw(e,a));const o=C(n,["upscaleFactor"]);o!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=C(n,["config"]);return l!=null&&_(t,["config"],XM(e,l,t)),t}function eO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],vr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function tO(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&_(t,["_url","models_url"],jk(e,d)),r}function nO(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],tO(e,r,t)),t}function rO(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function iO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],rO(e,a,t)),t}function aO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],vr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function sO(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Wh(e,ha(e,a)));const o=C(n,["tools"]);if(t!==void 0&&o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>Ek(e,f))),_(t,["tools"],d)}const l=C(n,["generationConfig"]);return t!==void 0&&l!=null&&_(t,["generationConfig"],l),r}function oO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Wh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],sO(e,o,t)),t}function lO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Wh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],o),t}function cO(e,n,t){const r={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=C(n,["outputGcsUri"]);t!==void 0&&o!=null&&_(t,["parameters","storageUri"],o);const l=C(n,["fps"]);t!==void 0&&l!=null&&_(t,["parameters","fps"],l);const d=C(n,["durationSeconds"]);t!==void 0&&d!=null&&_(t,["parameters","durationSeconds"],d);const f=C(n,["seed"]);t!==void 0&&f!=null&&_(t,["parameters","seed"],f);const u=C(n,["aspectRatio"]);t!==void 0&&u!=null&&_(t,["parameters","aspectRatio"],u);const h=C(n,["resolution"]);t!==void 0&&h!=null&&_(t,["parameters","resolution"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&_(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&_(t,["parameters","negativePrompt"],v);const S=C(n,["enhancePrompt"]);return t!==void 0&&S!=null&&_(t,["parameters","enhancePrompt"],S),r}function uO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],vr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&_(t,["instances[0]","image"],Sw(e,o));const l=C(n,["config"]);return l!=null&&_(t,["config"],cO(e,l,t)),t}function dO(e,n){const t={},r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function fO(e,n){const t={},r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],dO(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function hO(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>fO(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function pO(e,n){const t={},r=C(n,["citationSources"]);return r!=null&&_(t,["citations"],r),t}function mO(e,n){const t={},r=C(n,["content"]);r!=null&&_(t,["content"],hO(e,r));const a=C(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],pO(e,a));const o=C(n,["tokenCount"]);o!=null&&_(t,["tokenCount"],o);const l=C(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&_(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&_(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&_(t,["index"],u);const h=C(n,["logprobsResult"]);h!=null&&_(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function zN(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(f=>mO(e,f))),_(t,["candidates"],d)}const a=C(n,["modelVersion"]);a!=null&&_(t,["modelVersion"],a);const o=C(n,["promptFeedback"]);o!=null&&_(t,["promptFeedback"],o);const l=C(n,["usageMetadata"]);return l!=null&&_(t,["usageMetadata"],l),t}function gO(e,n){const t={},r=C(n,["values"]);return r!=null&&_(t,["values"],r),t}function yO(){return{}}function xO(e,n){const t={},r=C(n,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>gO(e,l))),_(t,["embeddings"],o)}return C(n,["metadata"])!=null&&_(t,["metadata"],yO()),t}function bO(e,n){const t={},r=C(n,["bytesBase64Encoded"]);r!=null&&_(t,["imageBytes"],pu(e,r));const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function Ak(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function vO(e,n){const t={},r=C(n,["_self"]);r!=null&&_(t,["image"],bO(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=C(n,["_self"]);return o!=null&&_(t,["safetyAttributes"],Ak(e,o)),t}function wO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>vO(e,l))),_(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],Ak(e,a)),t}function SO(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function g1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);o!=null&&_(t,["description"],o);const l=C(n,["version"]);l!=null&&_(t,["version"],l);const d=C(n,["_self"]);d!=null&&_(t,["tunedModelInfo"],SO(e,d));const f=C(n,["inputTokenLimit"]);f!=null&&_(t,["inputTokenLimit"],f);const u=C(n,["outputTokenLimit"]);u!=null&&_(t,["outputTokenLimit"],u);const h=C(n,["supportedGenerationMethods"]);return h!=null&&_(t,["supportedActions"],h),t}function NO(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=kk(e,a);Array.isArray(o)&&(o=o.map(l=>g1(e,l))),_(t,["models"],o)}return t}function CO(){return{}}function _O(e,n){const t={},r=C(n,["totalTokens"]);r!=null&&_(t,["totalTokens"],r);const a=C(n,["cachedContentTokenCount"]);return a!=null&&_(t,["cachedContentTokenCount"],a),t}function jO(e,n){const t={},r=C(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],pu(e,a));const o=C(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function kO(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],jO(e,r)),t}function TO(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>kO(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function EO(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&_(t,["response"],TO(e,d)),t}function AO(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function PO(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],AO(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function DO(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>PO(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function IO(e,n){const t={},r=C(n,["citations"]);return r!=null&&_(t,["citations"],r),t}function RO(e,n){const t={},r=C(n,["content"]);r!=null&&_(t,["content"],DO(e,r));const a=C(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],IO(e,a));const o=C(n,["finishMessage"]);o!=null&&_(t,["finishMessage"],o);const l=C(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&_(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&_(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&_(t,["index"],u);const h=C(n,["logprobsResult"]);h!=null&&_(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function BN(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>RO(e,h))),_(t,["candidates"],u)}const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["responseId"]);o!=null&&_(t,["responseId"],o);const l=C(n,["modelVersion"]);l!=null&&_(t,["modelVersion"],l);const d=C(n,["promptFeedback"]);d!=null&&_(t,["promptFeedback"],d);const f=C(n,["usageMetadata"]);return f!=null&&_(t,["usageMetadata"],f),t}function MO(e,n){const t={},r=C(n,["truncated"]);r!=null&&_(t,["truncated"],r);const a=C(n,["token_count"]);return a!=null&&_(t,["tokenCount"],a),t}function OO(e,n){const t={},r=C(n,["values"]);r!=null&&_(t,["values"],r);const a=C(n,["statistics"]);return a!=null&&_(t,["statistics"],MO(e,a)),t}function LO(e,n){const t={},r=C(n,["billableCharacterCount"]);return r!=null&&_(t,["billableCharacterCount"],r),t}function FO(e,n){const t={},r=C(n,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>OO(e,l))),_(t,["embeddings"],o)}const a=C(n,["metadata"]);return a!=null&&_(t,["metadata"],LO(e,a)),t}function $O(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["imageBytes"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function Pk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function Nw(e,n){const t={},r=C(n,["_self"]);r!=null&&_(t,["image"],$O(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=C(n,["_self"]);o!=null&&_(t,["safetyAttributes"],Pk(e,o));const l=C(n,["prompt"]);return l!=null&&_(t,["enhancedPrompt"],l),t}function zO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Nw(e,l))),_(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],Pk(e,a)),t}function BO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Nw(e,o))),_(t,["generatedImages"],a)}return t}function UO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Nw(e,o))),_(t,["generatedImages"],a)}return t}function qO(e,n){const t={},r=C(n,["endpoint"]);r!=null&&_(t,["name"],r);const a=C(n,["deployedModelId"]);return a!=null&&_(t,["deployedModelId"],a),t}function VO(e,n){const t={},r=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function HO(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=C(n,["step"]);return o!=null&&_(t,["step"],o),t}function y1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);o!=null&&_(t,["description"],o);const l=C(n,["versionId"]);l!=null&&_(t,["version"],l);const d=C(n,["deployedModels"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(v=>qO(e,v))),_(t,["endpoints"],b)}const f=C(n,["labels"]);f!=null&&_(t,["labels"],f);const u=C(n,["_self"]);u!=null&&_(t,["tunedModelInfo"],VO(e,u));const h=C(n,["defaultCheckpointId"]);h!=null&&_(t,["defaultCheckpointId"],h);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>HO(e,v))),_(t,["checkpoints"],b)}return t}function GO(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=kk(e,a);Array.isArray(o)&&(o=o.map(l=>y1(e,l))),_(t,["models"],o)}return t}function YO(){return{}}function WO(e,n){const t={},r=C(n,["totalTokens"]);return r!=null&&_(t,["totalTokens"],r),t}function QO(e,n){const t={},r=C(n,["tokensInfo"]);return r!=null&&_(t,["tokensInfo"],r),t}function JO(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function KO(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],JO(e,r)),t}function XO(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>KO(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function ZO(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response"]);return d!=null&&_(t,["response"],XO(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eL="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function tL(e,n,t){const r=new bR;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const o=H4(e,a);Object.assign(r,o)}else{const o=V4(e,a);Object.assign(r,o)}n(r)}class nL{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,o;const l=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const u=sL(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const z=this.apiClient.getApiKey();f=`${l}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${z}`}let h=()=>{};const g=new Promise(z=>{h=z}),b=n.callbacks,v=function(){var z;(z=b==null?void 0:b.onopen)===null||z===void 0||z.call(b),h({})},S=this.apiClient,k={onopen:v,onmessage:z=>{tL(S,b.onmessage,z)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(z){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(z){}},T=this.webSocketFactory.create(f,aL(u),k);T.connect(),await g;let P=vr(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const z=this.apiClient.getProject(),$=this.apiClient.getLocation();P=`projects/${z}/locations/${$}/`+P}let M={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[uu.AUDIO]}:n.config.responseModalities=[uu.AUDIO]),!((o=n.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const R={model:P,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?M=m4(this.apiClient,R):M=p4(this.apiClient,R),delete M.config,T.send(JSON.stringify(M)),new iL(T,this.apiClient)}}const rL={turnComplete:!0};class iL{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=fu(n,t.turns),n.isVertexAI()?r=r.map(a=>Wh(n,a)):r=r.map(a=>Db(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!n.isVertexAI()&&!("id"in o))throw new Error(eL)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},rL),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:w4(this.apiClient,n)}:t={realtimeInput:v4(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function aL(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function sL(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oL extends fg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let o;const l=[];if(r!=null&&r.generatedImages)for(const f of r.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((a=f==null?void 0:f.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=f==null?void 0:f.safetyAttributes:l.push(f);let d;return o?d={generatedImages:l,positivePromptSafetyAttributes:o}:d={generatedImages:l},d}),this.list=async t=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Pb(Fh.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=$N(this.apiClient,n);return d=Vt("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=BN(this.apiClient,h),b=new xx;return Object.assign(b,g),b})}else{const u=FN(this.apiClient,n);return d=Vt("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=zN(this.apiClient,h),b=new xx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=$N(this.apiClient,n);d=Vt("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const h=this.apiClient;return l=h.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(g){return rb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=p1(g),M;M=yield Ri(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const z=BN(h,yield Ri(k.json())),$=new xx;Object.assign($,z),yield yield Ri($)}}catch(R){v={error:R}}finally{try{!T&&!b&&(S=P.return)&&(yield Ri(S.call(P)))}finally{if(v)throw v.error}}})})}else{const u=FN(this.apiClient,n);d=Vt("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const h=this.apiClient;return l=h.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(g){return rb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=p1(g),M;M=yield Ri(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const z=zN(h,yield Ri(k.json())),$=new xx;Object.assign($,z),yield yield Ri($)}}catch(R){v={error:R}}finally{try{!T&&!b&&(S=P.return)&&(yield Ri(S.call(P)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=UM(this.apiClient,n);return d=Vt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=FO(this.apiClient,h),b=new _N;return Object.assign(b,g),b})}else{const u=oM(this.apiClient,n);return d=Vt("{model}:batchEmbedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=xO(this.apiClient,h),b=new _N;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=VM(this.apiClient,n);return d=Vt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=zO(this.apiClient,h),b=new jN;return Object.assign(b,g),b})}else{const u=cM(this.apiClient,n);return d=Vt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=wO(this.apiClient,h),b=new jN;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=KM(this.apiClient,n);return o=Vt("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=BO(this.apiClient,f),h=new hR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=ZM(this.apiClient,n);return o=Vt("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=UO(this.apiClient,f),h=new pR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=eO(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>y1(this.apiClient,h))}else{const u=uM(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>g1(this.apiClient,h))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=nO(this.apiClient,n);return d=Vt("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=GO(this.apiClient,h),b=new kN;return Object.assign(b,g),b})}else{const u=fM(this.apiClient,n);return d=Vt("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=NO(this.apiClient,h),b=new kN;return Object.assign(b,g),b})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=iO(this.apiClient,n);return d=Vt("{model}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>y1(this.apiClient,h))}else{const u=pM(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>g1(this.apiClient,h))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=aO(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=YO(),g=new TN;return Object.assign(g,h),g})}else{const u=mM(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(()=>{const h=CO(),g=new TN;return Object.assign(g,h),g})}}async countTokens(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=oO(this.apiClient,n);return d=Vt("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=WO(this.apiClient,h),b=new EN;return Object.assign(b,g),b})}else{const u=yM(this.apiClient,n);return d=Vt("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=_O(this.apiClient,h),b=new EN;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=lO(this.apiClient,n);return o=Vt("{model}:computeTokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=QO(this.apiClient,f),h=new mR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=uO(this.apiClient,n);return d=Vt("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>ZO(this.apiClient,h))}else{const u=vM(this.apiClient,n);return d=Vt("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>EO(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lL(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function cL(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function uL(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["operationName"],r);const a=C(n,["resourceName"]);a!=null&&_(t,["_url","resourceName"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],o),t}function dL(e,n){const t={},r=C(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],pu(e,a));const o=C(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function fL(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],dL(e,r)),t}function hL(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>fL(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function pL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&_(t,["response"],hL(e,d)),t}function mL(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function gL(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],mL(e,r)),t}function yL(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>gL(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function UN(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response"]);return d!=null&&_(t,["response"],yL(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xL extends fg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let o;return r&&"httpOptions"in r&&(o=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=cL(this.apiClient,n);return d=Vt("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>UN(this.apiClient,h))}else{const u=lL(this.apiClient,n);return d=Vt("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>pL(this.apiClient,h))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=uL(this.apiClient,n);return o=Vt("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>UN(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bL="Content-Type",vL="X-Server-Timeout",wL="User-Agent",SL="x-goog-api-client",NL="0.14.1",CL=`google-genai-sdk/${NL}`,_L="v1beta1",jL="v1beta",qN=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Dk extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class x1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class kL{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:_L,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:jL,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[l,d]of Object.entries(n.queryParams))a.searchParams.append(l,String(d));let o={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=n.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.unaryApiCall(a,o,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,o]of Object.entries(t))typeof o=="object"?r[a]=Object.assign(Object.assign({},r[a]),o):o!==void 0&&(r[a]=o);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=n.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.streamApiCall(a,o,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,o=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=o}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await VN(a),new h1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await VN(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return rb(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:d,value:f}=yield Ri(a.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(f);try{const g=JSON.parse(u);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new Dk(k);if(S>=500&&S<600)throw new x1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=u;let h=l.match(qN);for(;h;){const g=h[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Ri(new h1(b)),l=l.slice(h[0].length),h=l.match(qN)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=CL+" "+this.clientOptions.userAgentExtra;return n[wL]=t,n[SL]=t,n[bL]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(vL,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,l=await o.stat(n);a.sizeBytes=String(l.size);const d=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=d;const f=await this.fetchUploadUrl(a,t);return o.upload(n,f,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const o={file:n},l=await this.request({path:Vt("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function VN(e){var n;if(e===void 0)throw new x1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new Dk(o):t>=500&&t<600?new x1(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function EL(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function AL(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],EL(e,r,t)),t}function PL(e,n){const t={},r=C(n,["textInput"]);r!=null&&_(t,["textInput"],r);const a=C(n,["output"]);return a!=null&&_(t,["output"],a),t}function DL(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>PL(e,o))),_(t,["examples","examples"],a)}return t}function IL(e,n,t){const r={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&_(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=C(n,["epochCount"]);t!==void 0&&o!=null&&_(t,["tuningTask","hyperparameters","epochCount"],o);const l=C(n,["learningRateMultiplier"]);if(l!=null&&_(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=C(n,["batchSize"]);t!==void 0&&d!=null&&_(t,["tuningTask","hyperparameters","batchSize"],d);const f=C(n,["learningRate"]);return t!==void 0&&f!=null&&_(t,["tuningTask","hyperparameters","learningRate"],f),r}function RL(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&_(t,["tuningTask","trainingData"],DL(e,a));const o=C(n,["config"]);return o!=null&&_(t,["config"],IL(e,o,t)),t}function ML(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function OL(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function LL(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],OL(e,r,t)),t}function FL(e,n,t){const r={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function $L(e,n){const t={},r=C(n,["gcsUri"]);return r!=null&&_(t,["validationDatasetUri"],r),t}function zL(e,n,t){const r={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&_(t,["supervisedTuningSpec"],$L(e,a));const o=C(n,["tunedModelDisplayName"]);t!==void 0&&o!=null&&_(t,["tunedModelDisplayName"],o);const l=C(n,["description"]);t!==void 0&&l!=null&&_(t,["description"],l);const d=C(n,["epochCount"]);t!==void 0&&d!=null&&_(t,["supervisedTuningSpec","hyperParameters","epochCount"],d);const f=C(n,["learningRateMultiplier"]);t!==void 0&&f!=null&&_(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const u=C(n,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&_(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const h=C(n,["adapterSize"]);if(t!==void 0&&h!=null&&_(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function BL(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],FL(e,a,t));const o=C(n,["config"]);return o!=null&&_(t,["config"],zL(e,o,t)),t}function UL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["model"],r);const a=C(n,["name"]);return a!=null&&_(t,["endpoint"],a),t}function Ik(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["state"]);a!=null&&_(t,["state"],Ck(e,a));const o=C(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=C(n,["tuningTask","startTime"]);l!=null&&_(t,["startTime"],l);const d=C(n,["tuningTask","completeTime"]);d!=null&&_(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=C(n,["description"]);u!=null&&_(t,["description"],u);const h=C(n,["baseModel"]);h!=null&&_(t,["baseModel"],h);const g=C(n,["_self"]);g!=null&&_(t,["tunedModel"],UL(e,g));const b=C(n,["distillationSpec"]);b!=null&&_(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&_(t,["experiment"],v);const S=C(n,["labels"]);S!=null&&_(t,["labels"],S);const k=C(n,["pipelineJob"]);k!=null&&_(t,["pipelineJob"],k);const T=C(n,["tunedModelDisplayName"]);return T!=null&&_(t,["tunedModelDisplayName"],T),t}function qL(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["tunedModels"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Ik(e,l))),_(t,["tuningJobs"],o)}return t}function VL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);return l!=null&&_(t,["error"],l),t}function HL(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=C(n,["step"]);o!=null&&_(t,["step"],o);const l=C(n,["endpoint"]);return l!=null&&_(t,["endpoint"],l),t}function GL(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],r);const a=C(n,["endpoint"]);a!=null&&_(t,["endpoint"],a);const o=C(n,["checkpoints"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>HL(e,d))),_(t,["checkpoints"],l)}return t}function b1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["state"]);a!=null&&_(t,["state"],Ck(e,a));const o=C(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=C(n,["startTime"]);l!=null&&_(t,["startTime"],l);const d=C(n,["endTime"]);d!=null&&_(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=C(n,["error"]);u!=null&&_(t,["error"],u);const h=C(n,["description"]);h!=null&&_(t,["description"],h);const g=C(n,["baseModel"]);g!=null&&_(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&_(t,["tunedModel"],GL(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&_(t,["supervisedTuningSpec"],v);const S=C(n,["tuningDataStats"]);S!=null&&_(t,["tuningDataStats"],S);const k=C(n,["encryptionSpec"]);k!=null&&_(t,["encryptionSpec"],k);const T=C(n,["partnerModelTuningSpec"]);T!=null&&_(t,["partnerModelTuningSpec"],T);const P=C(n,["distillationSpec"]);P!=null&&_(t,["distillationSpec"],P);const M=C(n,["experiment"]);M!=null&&_(t,["experiment"],M);const R=C(n,["labels"]);R!=null&&_(t,["labels"],R);const z=C(n,["pipelineJob"]);z!=null&&_(t,["pipelineJob"],z);const $=C(n,["tunedModelDisplayName"]);return $!=null&&_(t,["tunedModelDisplayName"],$),t}function YL(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["tuningJobs"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>b1(e,l))),_(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WL extends fg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Pb(Fh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:f1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=ML(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>b1(this.apiClient,h))}else{const u=TL(this.apiClient,n);return d=Vt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>Ik(this.apiClient,h))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=LL(this.apiClient,n);return d=Vt("tuningJobs",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=YL(this.apiClient,h),b=new AN;return Object.assign(b,g),b})}else{const u=AL(this.apiClient,n);return d=Vt("tunedModels",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=qL(this.apiClient,h),b=new AN;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=BL(this.apiClient,n);return o=Vt("tuningJobs",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>b1(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=RL(this.apiClient,n);return o=Vt("tunedModels",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>VL(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class QL{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const JL=1024*1024*8,KL=3,XL=1e3,ZL=2,n0="x-goog-upload-status";async function e3(e,n,t){var r,a,o;let l=0,d=0,f=new h1(new Response),u="upload";for(l=e.size;d<l;){const g=Math.min(JL,l-d),b=e.slice(d,d+g);d+g>=l&&(u+=", finalize");let v=0,S=XL;for(;v<KL&&(f=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(d),"Content-Length":String(g)}}}),!(!((r=f==null?void 0:f.headers)===null||r===void 0)&&r[n0]));)v++,await n3(S),S=S*ZL;if(d+=g,((a=f==null?void 0:f.headers)===null||a===void 0?void 0:a[n0])!=="active")break;if(l<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(f==null?void 0:f.json());if(((o=f==null?void 0:f.headers)===null||o===void 0?void 0:o[n0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function t3(e){return{size:e.size,type:e.type}}function n3(e){return new Promise(n=>setTimeout(n,e))}class r3{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await e3(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await t3(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i3{create(n,t,r){return new a3(n,t,r)}}class a3{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const HN="x-goog-api-key";class s3{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(HN)===null&&n.append(HN,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const o3="gl-node/";class Cw{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=yI(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new s3(this.apiKey);this.apiClient=new kL({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:o3+"web",uploader:new r3,downloader:new QL}),this.models=new oL(this.apiClient),this.live=new nL(this.apiClient,a,new i3),this.chats=new CR(this.models,this.apiClient),this.caches=new vR(this.apiClient),this.files=new LR(this.apiClient),this.operations=new xL(this.apiClient),this.tunings=new WL(this.apiClient)}}const l3=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},_w=()=>localStorage.getItem("authToken");class c3{constructor(){Jn(this,"listeners",[]);Jn(this,"activeRequests",0)}subscribe(n){return this.listeners.push(n),n(this.activeRequests>0),()=>this.unsubscribe(n)}unsubscribe(n){this.listeners=this.listeners.filter(t=>t!==n)}notify(n){n?this.activeRequests++:this.activeRequests=Math.max(0,this.activeRequests-1);const t=this.activeRequests>0;this.listeners.forEach(r=>r(t))}}const v1=new c3,u3="https://backend.newtons.in",d3=()=>localStorage.getItem("authToken"),ge=async(e,n={})=>{const t=d3(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let o=e.startsWith("/")?e:`/${e}`;o.startsWith("/api/")||(o=`/api${o}`);const l=`${u3}${o}`;v1.notify(!0);try{console.log(`Making API call to: ${l}`);const d=await fetch(l,{...n,headers:a});if(d.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!d.ok){let f=`HTTP error! status: ${d.status}`;try{const u=await d.json();f=(u==null?void 0:u.message)||(u==null?void 0:u.error)||f}catch{}throw console.error(`API Error: ${d.status} ${d.statusText} - ${f}`),new Error(f)}return d}catch(d){throw d instanceof TypeError&&d.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",d):console.error("API Fetch Error:",d),d}finally{v1.notify(!1)}},r0="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",f3="models/gemini-3-flash-preview",h3=`You are an intelligent Clinic Hub Assistant for a Clinic Management System. Your role is to help the Clinic Administrator or Doctor manage their clinic ecosystem efficiently.

You have access to the current state of the clinic settings and the staff list. You can perform actions to update these settings or manage staff members.

**Capabilities:**
1.  **View Settings & Staff:** User can ask about current charges, clinic details, or staff members. Answer based on the provided context.
2.  **Update Settings:** Change fees, clinic name, address, etc.
3.  **Manage Staff:** Add new staff members or update existing ones.
4.  **Analyze Financials & Inventory:** Access the Analysis Dashboard to view revenue, expenses, and inventory movement. Set date ranges to filter data.
5.  **Manage Inventory:** Update pharmacy tokens (drugs) and lab tests. You will reference items by their **Serial Number** as provided in the context.
6.  **Purchase Management:** Search for distributors, select one, and build a purchase order by adding items. You can add multiple items at once. Editing items uses Serial Numbers.
7.  **Looping & Reasoning:** You should think step-by-step. If a user request involves multiple steps or if you need to check something after an action, you can continue the loop.
8.  **Follow-up:** If critical information is missing, ask the user.

**Interpretation Rules:**
- **Analysis Dates:** When the user asks for analysis (financial or inventory) for a specific time range (e.g., "last month", "yesterday"), you **MUST** include \`startDate\` and \`endDate\` in the \`navigate_to\` action for \`/dashboard/analysis\`.
- If the user says "add drug", "buy medicine", or "new stock", they **usually mean "Add Item to Purchase Order"** (use \`add_purchase_items\` or navigate to \`/dashboard/purchase\`).
- **Prerequisite:** If you are using ANY purchase tools (\`add_purchase_items\`, \`search_distributor_purchase\`, \`set_distributor_purchase\`, \`edit_purchase_items\`), you **MUST** include a \`navigate_to\` action with \`page: "/dashboard/purchase"\` as the **FIRST** action in your list, unless you are already on that page.
- **ONLY** use \`update_drug\` (create) if the user explicitly says "create new drug definition" or "add to master inventory".
- The correct route for purchasing is \`/dashboard/purchase\`.

**Action Tools:**
You can perform the following actions. Return a JSON array of actions.

\`\`\`json
[
  {
    "action": "update_clinic_settings",
    "updates": {
       "admissionCharge": "number string",
       "perDayCharge": "number string",
       "otherCharges": "number string",
       "name": "string",
       "address": "string",
       "notes": "string",
       "logoUrl": "string",
       "upi_id": "string",
       "low_stock_threshold": number,
        "clinicWideSystemPrompt": "string",
        "aiMemory": "string",
        "gemini_api_key": "string"
    }
  },
  {
    "action": "create_staff_member",
    "staff": {
       "name": "string",
       "email": "string",
       "role": "doctor" | "receptionist" | "pharmacy" | "lab",
       "password": "string",
       "opd_fee": number | null
    }
  },
  {
    "action": "update_staff_member",
    "id": "string | number", 
    "updates": {
       "name": "string",
       "email": "string",
       "role": "doctor" | "receptionist" | "pharmacy" | "lab",
       "password": "string",
       "opd_fee": number | null,
       "active": boolean
    }
  },
  {
    "action": "set_analysis_dates",
    "startDate": "YYYY-MM-DD",
    "endDate": "YYYY-MM-DD"
  },
  {
    "action": "navigate_to",
    "page": "/dashboard/inventory" | "/lab-inventory" | "/dashboard/queue" | "/dashboard/staff" | "/dashboard/purchase" | "/dashboard/analysis" | "/dashboard/clinic-hub" | "/billing" | "/dashboard/patients",
    "section": "financial" | "inventory" | "string (optional)",
    "startDate": "YYYY-MM-DD (optional, for analysis page)",
    "endDate": "YYYY-MM-DD (optional, for analysis page)"
  },
  {
    "action": "highlight_section",
    "elementId": "string"
  },
  {
    "action": "refresh_analysis"
  },
  {
    "action": "ask_followup_question",
    "question": "string"
  },
  {
    "action": "search_pharmacy_inventory",
    "query": "string (name, brand, or composition)"
  },
  {
    "action": "update_drug",
    "id": "number",
    "updates": {
       "name": "string",
       "brand_name": "string",
       "description": "string",
       "mrp": "number (MRP)",
       "stock": "number",
       "pack": "string (e.g. strip, bottle)",
       "supplier": "string",
       "expiry_date": "YYYY-MM-DD",
       "rate": "number",
       "box_number": "string",
       "gst": "number",
       "margin": "number",
       "discount": "number",
       "batch": "string",
       "hsn_code": "string",
       "mfg": "string",
       "loose": "number"
    }
  },
  {
    "action": "update_lab_test",
    "serial_number": 1,
    "updates": {
       "name": "string",
       "price": "number",
       "description": "string",
       "default_parameters": "array of objects { name, type, defaultValue, unit, lower_limit, upper_limit }"
    }
  },
  {
    "action": "search_distributor_purchase",
    "query": "string"
  },
  {
    "action": "set_distributor_purchase",
    "distributorId": "string"
  },
  {
    "action": "add_purchase_items",
    "items": [
        {
            "name": "string",
            "stock": "number (quantity)",
            "rate": "number (buying price)",
            "mrp": "number",
             "pack": "string", 
             "expiry_date": "YYYY-MM-DD",
             "batch": "string",
             "discount": "number",
             "gst": "number"
        }
    ]
  },
  {
    "action": "edit_purchase_items",
     "updates": [
         {
             "serial_number": "number (The Row # from context)",
             "field": "string (name, stock, rate, etc.)",
             "value": "string | number"
         }
     ]
  },
  {
    "action": "end_task",
    "summary": "string"
  },
  {
    "action": "open_new_case",
    "name": "string (Patient Name)",
    "age": "number (optional)",
    "gender": "M | F | O (optional)",
    "phone": "string (optional)",
    "complaint": "string (The medical complaint/reason)"
  }
]
\`\`\`

**Navigation Reference:**
- **Pharmacy Inventory:** \`/dashboard/inventory\`
- **Lab Inventory:** \`/lab-inventory\`
- **Doctor Queue:** \`/dashboard/queue\`
- **Staff Management:** \`/dashboard/staff\`
- **All Patients:** \`/dashboard/patients\`
- **Billing:** \`/billing\`
- **Purchase Page:** \`/dashboard/purchase\`
- **Analysis:** \`/dashboard/analysis\`
- **Clinic Hub:** \`/dashboard/clinic-hub\`
\`\`\`

**Rules:**
-   **Always** return a JSON array as the last part of your response.
-   If the user's request is satisfied, use the \`end_task\` action with a summary of what was done.
-   If you need more info, use \`ask_followup_question\`.
-   If you perform an action (like updating settings), and there's nothing else to do *immediately* but you want to confirm it's done, you can return the action. The system will execute it and call you back with the result. Then you can \`end_task\`.
-   For \`create_staff_member\`, if password is not provided by user, generate a secure random password and mention it in the summary.
-   Update numeric strings as strings (e.g., "500.00").
-   **CRITICAL DO's and DON'Ts:**
    -   **DO NOT** fill in empty fields (like \`gemini_api_key\`, \`logoUrl\`, \`upi_id\`, etc.) with fake, placeholder, or example data.
    -   **ONLY** update fields that the user *intentionally* asked to change.
    -   **PRESERVE** existing values for any fields not explicitly mentioned in the user's request.
    -   If a field is empty and the user didn't ask to set it, **leave it empty**.
    -   Do not invent values.
`;async function p3(){var t;if(!_w()&&r0)return r0;let n=null;try{const r=await ge("/api/clinics/settings");if(r.ok){const a=await r.json();(t=a.gemini_api_key)!=null&&t.trim()&&(n=a.gemini_api_key.trim())}}catch(r){console.warn("Error fetching updated key",r)}if(n)return n;try{const r=await ge("/api/global-settings/app_gemini_api_key");if(r.ok){const o=(await r.json()).value;if(o&&o.trim()!=="")return o.trim()}}catch(r){console.warn("Could not fetch global API key.",r)}return r0}let i0=null;async function m3(){if(!i0){const e=await p3();i0=new Cw({apiKey:e})}return i0}async function g3(e,n,t=[],r){var u,h,g,b,v;const a=await m3(),o=[];o.push({role:"user",parts:[{text:h3}]}),o.push({role:"model",parts:[{text:"Understood. I am ready to assist with Clinic Hub management."}]}),t.forEach(S=>{o.push({role:S.role,parts:[{text:S.text}]})});const f=[{text:`
    Context:
    ${`
    --- Current Clinic Context ---
    Settings: ${JSON.stringify(n.settings,null,2)}
    
    Staff List: ${JSON.stringify(n.staffList.map(S=>({id:S.id||S._id,name:S.name,role:S.role,email:S.email,active:S.active,opd_fee:S.opd_fee})),null,2)}
    
    Previous Action Results (if any): ${JSON.stringify(n.actionResults||[],null,2)}

    Analysis Data (if active): ${JSON.stringify(n.analysisData||{},null,2)}

    Pharmacy Inventory: ${n.pharmacyInventory?JSON.stringify(n.pharmacyInventory,null,2):"Not loaded. Use 'search_pharmacy_inventory' to find items."}

    Distributors List: ${JSON.stringify((n.distributors||[]).map(S=>({serial_number:S.serial_number,name:S.name,contact_person:S.contact_person,phone:S.phone,remainingBalance:S.remainingBalance})),null,2)}

    Lab Tests Inventory: ${JSON.stringify((n.labInventory||[]).map(S=>({serial:S.serial_number,name:S.name,price:S.price,description:S.description,default_parameters:S.default_parameters})),null,2)}

    Current Purchase Page Rows: ${JSON.stringify((n.purchaseRows||[]).map((S,k)=>({serial_number:k+1,name:S.name,stock:S.stock,rate:S.rate,mrp:S.mrp,net_value:(S.stock*S.rate).toFixed(2)})),null,2)}

    Current Application Page Context: ${n.pageContext?JSON.stringify(n.pageContext,null,2):"Unknown/General Dashboard"}
    `}

    User Query/Input:
    ${e}
    `}];if(r){const S=r.replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"");f.push({inlineData:{data:S,mimeType:"image/jpeg"}})}o.push({role:"user",parts:f});try{const S={model:f3,contents:o,generationConfig:{temperature:.7,maxOutputTokens:2048,responseMimeType:"text/plain"}},k=await a.models.generateContentStream(S);let T="";for await(const P of k){const M=P;M.text&&typeof M.text=="function"?T+=M.text():(v=(b=(g=(h=(u=M.candidates)==null?void 0:u[0])==null?void 0:h.content)==null?void 0:g.parts)==null?void 0:b[0])!=null&&v.text&&(T+=M.candidates[0].content.parts[0].text)}if(!T)throw new Error("Empty response from AI");return T}catch(S){throw console.error("Gemini Interaction Error:",S),new Error("Failed to communicate with AI Assistant.")}}const jw=({settings:e,staffList:n,onSettingsUpdate:t,onStaffUpdate:r,onHighlight:a})=>{const o=Rt(),{setAnalysisDateRange:l,analysisData:d,analysisNavigate:f,refreshAnalysis:u,pageContext:h}=Tb(),{setDistributors:g,setSelectedDistributor:b,setSearchTerm:v,addPurchaseRow:S,updatePurchaseRow:k,distributors:T,purchaseRows:P}=gk(),[M,R]=w.useState(""),z=w.useRef(d),$=w.useRef(P);w.useEffect(()=>{z.current=d},[d]),w.useEffect(()=>{$.current=P},[P]);const[L,B]=w.useState([]),[q,W]=w.useState(!1),[I,F]=w.useState(null),V=w.useRef(!1),ee=w.useRef(0),ie=5,Y=()=>{V.current=!1,W(!1),B(de=>[...de,{role:"system",text:" Task stopped by user."}])},Q=de=>{const he=new FileReader;he.onloadend=()=>{F(he.result)},he.readAsDataURL(de)},ne=()=>{F(null)},le=async(de,he,D=[],me)=>{var Ce,te,K;if(V.current){if(ee.current+=1,ee.current>ie){B(J=>[...J,{role:"system",text:" Task limit reached. Stopping automatically."}]),W(!1),V.current=!1;return}try{let J=e,xe=n,He=[],re=[],Be=[];try{const[_e,pe]=await Promise.all([ge("/api/clinics/settings"),ge("/staff")]);if(_e.ok&&pe.ok){const ce=await _e.json(),G=await pe.json(),[fe,Ne,Le]=await Promise.all([ge("/api/drugs"),ge("/api/lab-tests"),ge("/api/distributors")]);if(fe.ok){const tt=await fe.json();He=tt.drugs||tt||[]}Ne.ok&&(re=(await Ne.json()).map((xt,St)=>({...xt,serial_number:St+1}))),Le.ok&&(Be=(await Le.json()||[]).map((xt,St)=>({...xt,serial_number:St+1}))),J={...ce,admissionCharge:parseFloat(ce.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(ce.perDayCharge||0).toFixed(2),otherCharges:parseFloat(ce.otherCharges||0).toFixed(2),aiMemory:ce.aiMemory||"",clinicWideSystemPrompt:ce.clinicWideSystemPrompt||"",gemini_api_key:ce.gemini_api_key||"",low_stock_threshold:ce.low_stock_threshold!==void 0&&ce.low_stock_threshold!==null?String(ce.low_stock_threshold):"10",name:ce.name||"",logoUrl:ce.logoUrl||"",upi_id:ce.upi_id||"",address:ce.address||"",notes:ce.notes||"",clinic_id:ce.clinic_id},xe=G.map(tt=>({...tt,id:tt._id||tt.id}))}}catch(_e){console.warn("Failed to fetch fresh context for AI loop, falling back to props",_e)}const Ae={settings:J,staffList:xe,analysisData:z.current,pharmacyInventory:He.length>50?void 0:He,labInventory:re,distributors:Be,purchaseRows:$.current,actionResults:D,pageContext:h||void 0},Ie=he.filter(_e=>_e.role!=="system"),Ye=await g3(de,Ae,Ie,me);if(!V.current)return;let at=[];try{const _e=Ye.match(/\[[\s\S]*\]/);if(_e)at=JSON.parse(_e[0]);else{B(pe=>[...pe,{role:"model",text:Ye}]),W(!1),V.current=!1;return}}catch(_e){console.error("Failed to parse AI response",_e),B(pe=>[...pe,{role:"model",text:"I'm having trouble processing that. Please try again."}]),W(!1),V.current=!1;return}const Ze=[];let Ke=[],st=[];for(const _e of at){if(!V.current)break;if(_e.action==="end_task"){B(pe=>[...pe,{role:"model",text:_e.summary}]),W(!1),V.current=!1;return}if(_e.action==="ask_followup_question"){B(pe=>[...pe,{role:"model",text:_e.question}]),W(!1),V.current=!1;return}try{if(_e.action==="update_clinic_settings"){const pe=_e.updates;Object.keys(pe).forEach(fe=>Ke.push(`setting-${fe}`));const ce={...J,...pe},G={...ce,admissionCharge:parseFloat(ce.admissionCharge),perDayCharge:parseFloat(ce.perDayCharge),otherCharges:parseFloat(ce.otherCharges),low_stock_threshold:parseInt(ce.low_stock_threshold)};await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify(G)}),t&&t(),Ze.push({action:"update_clinic_settings",status:"success"}),st.push({role:"system",text:" Updated clinic settings"})}if(_e.action==="create_staff_member"&&(await ge("/api/staff",{method:"POST",body:JSON.stringify({..._e.staff,clinic_id:J.clinic_id})}),r&&r(),Ze.push({action:"create_staff_member",status:"success",name:_e.staff.name}),st.push({role:"system",text:` Created staff member: ${_e.staff.name}`})),_e.action==="update_staff_member"){const pe=_e.id;await ge(`/api/staff/${pe}`,{method:"PUT",body:JSON.stringify(_e.updates)}),r&&r(),Ke.push(`staff-member-${pe}`),Ze.push({action:"update_staff_member",status:"success",id:pe}),st.push({role:"system",text:" Updated staff member details"})}if(_e.action==="set_analysis_dates"){const{startDate:pe,endDate:ce}=_e;l({startDate:new Date(pe),endDate:new Date(ce)}),Ze.push({action:"set_analysis_dates",status:"success",startDate:pe,endDate:ce}),st.push({role:"system",text:` Set analysis dates: ${pe} to ${ce}`})}if(_e.action==="navigate_to"){let pe=_e.page;if(_e.page&&_e.page.includes("analysis")&&_e.startDate&&_e.endDate){const ce=pe.includes("?")?"&":"?";pe=`${pe}${ce}startDate=${_e.startDate}&endDate=${_e.endDate}`}else _e.page&&_e.page.includes("analysis")&&((Ce=z.current)!=null&&Ce.startDate)&&((te=z.current)!=null&&te.endDate);o(pe),_e.section&&setTimeout(()=>f(_e.section),500),Ze.push({action:"navigate_to",status:"success",page:pe}),st.push({role:"system",text:` Navigated to ${pe}`})}if(_e.action==="highlight_section"&&(Ke.push(_e.elementId),Ze.push({action:"highlight_section",status:"success",id:_e.elementId})),_e.action==="refresh_analysis"){st.push({role:"system",text:" Refreshing analysis data..."});const pe=await u();pe?(z.current=pe,Ze.push({action:"refresh_analysis",status:"success",summary:"Data refreshed successfully"}),st.push({role:"system",text:" Analysis data refreshed"})):(Ze.push({action:"refresh_analysis",status:"error",error:"No data returned"}),st.push({role:"system",text:" Failed to refresh analysis data"}))}if(_e.action==="search_pharmacy_inventory"){const pe=_e.query.toLowerCase(),ce=He.filter(fe=>fe.name&&fe.name.toLowerCase().includes(pe)||fe.brand_name&&fe.brand_name.toLowerCase().includes(pe)||fe.description&&fe.description.toLowerCase().includes(pe)),G=ce.slice(0,10);Ze.push({action:"search_pharmacy_inventory",status:"success",count:ce.length,results:G}),ce.length>0?st.push({role:"system",text:` Found ${ce.length} matches for "${_e.query}". Showing top ${G.length}.`}):st.push({role:"system",text:` No matches found for "${_e.query}"`})}if(_e.action==="update_drug"){const pe=_e.id;try{const ce=He.find(fe=>fe.id===pe);if(!ce)throw new Error(`Drug with ID ${pe} not found.`);const G={...ce,..._e.updates};await ge(`/api/drugs/${pe}`,{method:"PUT",body:JSON.stringify(G)}),Ze.push({action:"update_drug",status:"success",id:pe,updates:_e.updates}),st.push({role:"system",text:` Updated drug: ${ce.name}`})}catch(ce){Ze.push({action:"update_drug",status:"error",error:ce.message}),st.push({role:"system",text:` Failed to update drug: ${ce.message}`})}}if(_e.action==="update_lab_test"){const pe=re.find(ce=>ce.serial_number===_e.serial_number);if(pe){const ce={...pe,..._e.updates};await ge(`/api/lab-tests/${pe.id}`,{method:"PUT",body:JSON.stringify(ce)}),Ze.push({action:"update_lab_test",status:"success",item:pe.name}),st.push({role:"system",text:` Updated lab test: ${pe.name}`})}else Ze.push({action:"update_lab_test",status:"error",error:`Test with serial ${_e.serial_number} not found`}),st.push({role:"system",text:` Lab test with serial ${_e.serial_number} not found`})}if(_e.action==="search_distributor_purchase"){const pe=_e.query,ce=await ge(`/api/distributors?search=${encodeURIComponent(pe)}`);if(ce.ok){const G=await ce.json();g(G),v(pe),Ze.push({action:"search_distributor_purchase",status:"success",count:G.length,results:G}),st.push({role:"system",text:` Found ${G.length} distributors for "${pe}"`})}else Ze.push({action:"search_distributor_purchase",status:"error",error:ce.statusText}),st.push({role:"system",text:" Failed to search distributors"})}if(_e.action==="set_distributor_purchase"){const pe=_e.distributorId;let ce=T.find(G=>G.id===pe);ce?(b(ce),v(ce.name),Ze.push({action:"set_distributor_purchase",status:"success",distributor:ce.name}),st.push({role:"system",text:` Selected distributor: ${ce.name}`})):(Ze.push({action:"set_distributor_purchase",status:"error",error:"Distributor not found in current search results. Please search first."}),st.push({role:"system",text:" Distributor not found. Please search first."}))}if(_e.action==="add_purchase_items"){const pe=_e.items;let ce=0;pe.forEach(G=>{const Ne={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:G.name||"",composition:G.composition||"",description:G.description||"",mrp:G.mrp||0,stock:G.stock||0,pack:G.pack||"",supplier:"",expiry_date:G.expiry_date||"",rate:G.rate||0,box_number:G.box_number||"",gst:G.gst||0,margin:G.margin||0,discount:G.discount||0,brand_name:G.brand_name||"",batch:G.batch||"",hsn_code:G.hsn_code||"",mfg:G.mfg||"",loose:G.loose||0,last_updated:"",created_at:""};S(Ne),ce++}),Ze.push({action:"add_purchase_items",status:"success",count:ce}),st.push({role:"system",text:` Added ${ce} items to purchase list`})}if(_e.action==="edit_purchase_items"){const pe=_e.updates;let ce=0;const G=$.current||[];pe.forEach(fe=>{if(fe.serial_number){const Ne=fe.serial_number-1,Le=G[Ne];Le&&Le.id?(k(Le.id,{[fe.field]:fe.value}),ce++):(console.warn(`Row with serial number ${fe.serial_number} not found.`),st.push({role:"system",text:` Row #${fe.serial_number} not found.`}))}}),Ze.push({action:"edit_purchase_items",status:"success",count:ce}),st.push({role:"system",text:` Updated ${ce} items`})}if(_e.action==="open_new_case"){const{name:pe,age:ce,gender:G,complaint:fe,phone:Ne}=_e;try{const Le=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:pe||"New Patient",age:ce||null,gender:G||null,phone:Ne||null,address:null})});if(!Le.ok){const we=await Le.json().catch(()=>({}));throw Le.status===403&&((K=we.message)!=null&&K.includes("Patient limit"))?new Error(`Patient limit reached: ${we.message}`):new Error(we.message||"Failed to create patient")}const tt=await Le.json();if(!tt||!tt.id)throw new Error("Created patient has no ID");const xt=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:tt.id,complaint:fe||"New Case"})});if(!xt.ok)throw new Error("Failed to create queue entry");const St=await xt.json();o(`/dashboard/edit-complaint/${St.id}`,{state:{initialComplaint:fe}}),Ze.push({action:"open_new_case",status:"success",patientId:tt.id,queueId:St.id}),st.push({role:"system",text:` Opened new case for ${pe}`}),W(!1),V.current=!1;return}catch(Le){Le.message.includes("Patient limit")&&(o("/start-clinic-subscription"),st.push({role:"system",text:" Patient limit reached. Redirecting to subscription."})),Ze.push({action:"open_new_case",status:"error",error:Le.message}),st.push({role:"system",text:` Failed to open new case: ${Le.message}`})}}}catch(pe){console.error("Action execution failed",_e,pe),Ze.push({action:_e.action,status:"error",error:pe.message}),st.push({role:"system",text:` Failed to execute action: ${_e.action}`})}}Ke.length>0&&a&&setTimeout(()=>a(Ke),500),st.length>0&&B(_e=>[..._e,...st]);const yt=[...D,...Ze],je=`Reflecting on previous actions: ${JSON.stringify(Ze)}. What is the next step? If done, call end_task.`,Ge=[...he,...st,{role:"model",text:Ye},{role:"user",text:je}];await le(je,Ge,yt,void 0)}catch(J){console.error(J),B(xe=>[...xe,{role:"model",text:"Something went wrong."}]),W(!1),V.current=!1}}};return{chatQuery:M,setChatQuery:R,chatHistory:L,isProcessing:q,handleSendMessage:de=>{const he=de!==void 0?de:M;if(!he.trim()&&!I)return;V.current=!0,W(!0),ee.current=0;const D={role:"user",text:he};I&&(D.text+=" [Image Attached]"),B(Ce=>[...Ce,D]);const me=I||void 0;R(""),F(null),le(he,L,[],me)},refreshChat:()=>{B([]),R(""),W(!1),V.current=!1,ee.current=0,F(null)},stopGeneration:Y,selectedImage:I,handleImageSelect:Q,clearImage:ne}};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),x3=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),GN=e=>{const n=x3(e);return n.charAt(0).toUpperCase()+n.slice(1)},Rk=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var b3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...d},f)=>w.createElement("svg",{ref:f,...b3,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:Rk("lucide",a),...d},[...l.map(([u,h])=>w.createElement(u,h)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=(e,n)=>{const t=w.forwardRef(({className:r,...a},o)=>w.createElement(v3,{ref:o,iconNode:n,className:Rk(`lucide-${y3(GN(e))}`,`lucide-${e}`,r),...a}));return t.displayName=GN(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],YN=dt("activity",w3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],WN=dt("arrow-down",S3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],sn=dt("arrow-left",N3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],w1=dt("arrow-up",C3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],j3=dt("beaker",_3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],T3=dt("bed-double",k3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],eg=dt("bot",E3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],P3=dt("brain-circuit",A3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],Mk=dt("brain",D3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M12 11v4",key:"a6ujw6"}],["path",{d:"M14 13h-4",key:"1pl8zg"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M18 6v14",key:"1mu4gy"}],["path",{d:"M6 6v14",key:"1s15cj"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],R3=dt("briefcase-medical",I3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],O3=dt("building",M3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],QN=dt("calendar-check-2",L3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],$3=dt("calendar-days",F3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],zh=dt("calendar",z3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ib=dt("check",B3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],JN=dt("chevron-down",U3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ib=dt("chevron-left",q3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Qh=dt("chevron-right",V3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],KN=dt("chevron-up",H3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],jr=dt("circle-alert",G3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Wa=dt("circle-check-big",Y3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],Q3=dt("circle-minus",W3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],qa=dt("circle-plus",J3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],X3=dt("circle-user",K3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],kw=dt("clipboard-list",Z3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],S1=dt("clipboard",eF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],nF=dt("clock",tF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],iF=dt("copy",rF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Ok=dt("credit-card",aF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Bh=dt("dollar-sign",sF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],lF=dt("eye",oF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],uF=dt("file-check",cF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Jl=dt("file-text",dF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],io=dt("flask-conical",fF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],pF=dt("funnel",hF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],tg=dt("hash",mF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Lk=dt("house",gF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],rl=dt("info",yF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Fk=dt("key",xF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],vF=dt("layout-dashboard",bF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],$k=dt("layout-grid",wF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],NF=dt("list-ordered",SF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],_F=dt("list",CF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ao=dt("loader-circle",jF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],XN=dt("lock",kF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],zk=dt("map-pin",TF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],AF=dt("maximize-2",EF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],DF=dt("mic-off",PF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],hg=dt("mic",IF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],MF=dt("minimize-2",RF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],LF=dt("monitor",OF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],$F=dt("package-open",FF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Bd=dt("package",zF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],Rb=dt("paperclip",BF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],qF=dt("pause",UF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],a0=dt("pen",VF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HF=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Gl=dt("pencil",HF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],Bk=dt("phone",GF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Ud=dt("pill",YF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],QF=dt("play",WF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],al=dt("plus",JF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],tl=dt("printer",KF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],N1=dt("refresh-cw",XF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Uk=dt("rotate-cw",ZF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],qd=dt("save",e6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],kr=dt("search",t6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Mb=dt("send",n6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],ZN=dt("server-crash",r6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i6=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ob=dt("settings",i6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a6=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],qk=dt("share-2",a6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],o6=dt("shield-check",s6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l6=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],c6=dt("shield",l6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],C1=dt("shopping-cart",u6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d6=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],f6=dt("sparkles",d6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],sl=dt("square-pen",h6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p6=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],m6=dt("square",p6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g6=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],Vk=dt("stethoscope",g6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],x6=dt("table",y6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],v6=dt("tag",b6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w6=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Hr=dt("trash-2",w6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],N6=dt("triangle-alert",S6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C6=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],_6=dt("truck",C6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],k6=dt("upload",j6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],Tw=dt("user-check",T6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Ew=dt("user-plus",E6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A6=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ns=dt("user",A6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Jh=dt("users",P6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],I6=dt("video",D6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],_n=dt("x",R6);function M6(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const O6=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,L6=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,F6={};function eC(e,n){return(F6.jsx?L6:O6).test(e)}const $6=/[ \t\n\f\r]/g;function z6(e){return typeof e=="object"?e.type==="text"?tC(e.value):!1:tC(e)}function tC(e){return e.replace($6,"")===""}let pg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};pg.prototype.normal={};pg.prototype.property={};pg.prototype.space=void 0;function Hk(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new pg(t,r,n)}function _1(e){return e.toLowerCase()}let ya=class{constructor(n,t){this.attribute=t,this.property=n}};ya.prototype.attribute="";ya.prototype.booleanish=!1;ya.prototype.boolean=!1;ya.prototype.commaOrSpaceSeparated=!1;ya.prototype.commaSeparated=!1;ya.prototype.defined=!1;ya.prototype.mustUseProperty=!1;ya.prototype.number=!1;ya.prototype.overloadedBoolean=!1;ya.prototype.property="";ya.prototype.spaceSeparated=!1;ya.prototype.space=void 0;let B6=0;const Jt=Qd(),Ur=Qd(),Gk=Qd(),ct=Qd(),lr=Qd(),Dh=Qd(),za=Qd();function Qd(){return 2**++B6}const j1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Jt,booleanish:Ur,commaOrSpaceSeparated:za,commaSeparated:Dh,number:ct,overloadedBoolean:Gk,spaceSeparated:lr},Symbol.toStringTag,{value:"Module"})),s0=Object.keys(j1);let Aw=class extends ya{constructor(n,t,r,a){let o=-1;if(super(n,t),nC(this,"space",a),typeof r=="number")for(;++o<s0.length;){const l=s0[o];nC(this,s0[o],(r&j1[l])===j1[l])}}};Aw.prototype.defined=!0;function nC(e,n,t){t&&(e[n]=t)}function Kh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new Aw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[_1(r)]=r,t[_1(o.attribute)]=r}return new pg(n,t,e.space)}const Yk=Kh({properties:{ariaActiveDescendant:null,ariaAtomic:Ur,ariaAutoComplete:null,ariaBusy:Ur,ariaChecked:Ur,ariaColCount:ct,ariaColIndex:ct,ariaColSpan:ct,ariaControls:lr,ariaCurrent:null,ariaDescribedBy:lr,ariaDetails:null,ariaDisabled:Ur,ariaDropEffect:lr,ariaErrorMessage:null,ariaExpanded:Ur,ariaFlowTo:lr,ariaGrabbed:Ur,ariaHasPopup:null,ariaHidden:Ur,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:lr,ariaLevel:ct,ariaLive:null,ariaModal:Ur,ariaMultiLine:Ur,ariaMultiSelectable:Ur,ariaOrientation:null,ariaOwns:lr,ariaPlaceholder:null,ariaPosInSet:ct,ariaPressed:Ur,ariaReadOnly:Ur,ariaRelevant:null,ariaRequired:Ur,ariaRoleDescription:lr,ariaRowCount:ct,ariaRowIndex:ct,ariaRowSpan:ct,ariaSelected:Ur,ariaSetSize:ct,ariaSort:null,ariaValueMax:ct,ariaValueMin:ct,ariaValueNow:ct,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function Wk(e,n){return n in e?e[n]:n}function Qk(e,n){return Wk(e,n.toLowerCase())}const U6=Kh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Dh,acceptCharset:lr,accessKey:lr,action:null,allow:null,allowFullScreen:Jt,allowPaymentRequest:Jt,allowUserMedia:Jt,alt:null,as:null,async:Jt,autoCapitalize:null,autoComplete:lr,autoFocus:Jt,autoPlay:Jt,blocking:lr,capture:null,charSet:null,checked:Jt,cite:null,className:lr,cols:ct,colSpan:null,content:null,contentEditable:Ur,controls:Jt,controlsList:lr,coords:ct|Dh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Jt,defer:Jt,dir:null,dirName:null,disabled:Jt,download:Gk,draggable:Ur,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Jt,formTarget:null,headers:lr,height:ct,hidden:Jt,high:ct,href:null,hrefLang:null,htmlFor:lr,httpEquiv:lr,id:null,imageSizes:null,imageSrcSet:null,inert:Jt,inputMode:null,integrity:null,is:null,isMap:Jt,itemId:null,itemProp:lr,itemRef:lr,itemScope:Jt,itemType:lr,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Jt,low:ct,manifest:null,max:null,maxLength:ct,media:null,method:null,min:null,minLength:ct,multiple:Jt,muted:Jt,name:null,nonce:null,noModule:Jt,noValidate:Jt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Jt,optimum:ct,pattern:null,ping:lr,placeholder:null,playsInline:Jt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Jt,referrerPolicy:null,rel:lr,required:Jt,reversed:Jt,rows:ct,rowSpan:ct,sandbox:lr,scope:null,scoped:Jt,seamless:Jt,selected:Jt,shadowRootClonable:Jt,shadowRootDelegatesFocus:Jt,shadowRootMode:null,shape:null,size:ct,sizes:null,slot:null,span:ct,spellCheck:Ur,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ct,step:null,style:null,tabIndex:ct,target:null,title:null,translate:null,type:null,typeMustMatch:Jt,useMap:null,value:Ur,width:ct,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:lr,axis:null,background:null,bgColor:null,border:ct,borderColor:null,bottomMargin:ct,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Jt,declare:Jt,event:null,face:null,frame:null,frameBorder:null,hSpace:ct,leftMargin:ct,link:null,longDesc:null,lowSrc:null,marginHeight:ct,marginWidth:ct,noResize:Jt,noHref:Jt,noShade:Jt,noWrap:Jt,object:null,profile:null,prompt:null,rev:null,rightMargin:ct,rules:null,scheme:null,scrolling:Ur,standby:null,summary:null,text:null,topMargin:ct,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ct,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Jt,disableRemotePlayback:Jt,prefix:null,property:null,results:ct,security:null,unselectable:null},space:"html",transform:Qk}),q6=Kh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:za,accentHeight:ct,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ct,amplitude:ct,arabicForm:null,ascent:ct,attributeName:null,attributeType:null,azimuth:ct,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ct,by:null,calcMode:null,capHeight:ct,className:lr,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ct,diffuseConstant:ct,direction:null,display:null,dur:null,divisor:ct,dominantBaseline:null,download:Jt,dx:null,dy:null,edgeMode:null,editable:null,elevation:ct,enableBackground:null,end:null,event:null,exponent:ct,externalResourcesRequired:null,fill:null,fillOpacity:ct,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Dh,g2:Dh,glyphName:Dh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ct,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ct,horizOriginX:ct,horizOriginY:ct,id:null,ideographic:ct,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ct,k:ct,k1:ct,k2:ct,k3:ct,k4:ct,kernelMatrix:za,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ct,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ct,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ct,overlineThickness:ct,paintOrder:null,panose1:null,path:null,pathLength:ct,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:lr,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ct,pointsAtY:ct,pointsAtZ:ct,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:za,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:za,rev:za,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:za,requiredFeatures:za,requiredFonts:za,requiredFormats:za,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ct,specularExponent:ct,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ct,strikethroughThickness:ct,string:null,stroke:null,strokeDashArray:za,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ct,strokeOpacity:ct,strokeWidth:null,style:null,surfaceScale:ct,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:za,tabIndex:ct,tableValues:null,target:null,targetX:ct,targetY:ct,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:za,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ct,underlineThickness:ct,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ct,values:null,vAlphabetic:ct,vMathematical:ct,vectorEffect:null,vHanging:ct,vIdeographic:ct,version:null,vertAdvY:ct,vertOriginX:ct,vertOriginY:ct,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ct,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Wk}),Jk=Kh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),Kk=Kh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:Qk}),Xk=Kh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),V6={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},H6=/[A-Z]/g,rC=/-[a-z]/g,G6=/^data[-\w.:]+$/i;function Y6(e,n){const t=_1(n);let r=n,a=ya;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&G6.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(rC,Q6);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!rC.test(o)){let l=o.replace(H6,W6);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=Aw}return new a(r,n)}function W6(e){return"-"+e.toLowerCase()}function Q6(e){return e.charAt(1).toUpperCase()}const J6=Hk([Yk,U6,Jk,Kk,Xk],"html"),Pw=Hk([Yk,q6,Jk,Kk,Xk],"svg");function K6(e){return e.join(" ").trim()}var vh={},o0,iC;function X6(){if(iC)return o0;iC=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,d=/^\s+|\s+$/g,f=`
`,u="/",h="*",g="",b="comment",v="declaration";o0=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var P=1,M=1;function R(ee){var ie=ee.match(n);ie&&(P+=ie.length);var Y=ee.lastIndexOf(f);M=~Y?ee.length-Y:M+ee.length}function z(){var ee={line:P,column:M};return function(ie){return ie.position=new $(ee),q(),ie}}function $(ee){this.start=ee,this.end={line:P,column:M},this.source=T.source}$.prototype.content=k;function L(ee){var ie=new Error(T.source+":"+P+":"+M+": "+ee);if(ie.reason=ee,ie.filename=T.source,ie.line=P,ie.column=M,ie.source=k,!T.silent)throw ie}function B(ee){var ie=ee.exec(k);if(ie){var Y=ie[0];return R(Y),k=k.slice(Y.length),ie}}function q(){B(t)}function W(ee){var ie;for(ee=ee||[];ie=I();)ie!==!1&&ee.push(ie);return ee}function I(){var ee=z();if(!(u!=k.charAt(0)||h!=k.charAt(1))){for(var ie=2;g!=k.charAt(ie)&&(h!=k.charAt(ie)||u!=k.charAt(ie+1));)++ie;if(ie+=2,g===k.charAt(ie-1))return L("End of comment missing");var Y=k.slice(2,ie-2);return M+=2,R(Y),k=k.slice(ie),M+=2,ee({type:b,comment:Y})}}function F(){var ee=z(),ie=B(r);if(ie){if(I(),!B(a))return L("property missing ':'");var Y=B(o),Q=ee({type:v,property:S(ie[0].replace(e,g)),value:Y?S(Y[0].replace(e,g)):g});return B(l),Q}}function V(){var ee=[];W(ee);for(var ie;ie=F();)ie!==!1&&(ee.push(ie),W(ee));return ee}return q(),V()};function S(k){return k?k.replace(d,g):g}return o0}var aC;function Z6(){if(aC)return vh;aC=1;var e=vh&&vh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(vh,"__esModule",{value:!0}),vh.default=t;var n=e(X6());function t(r,a){var o=null;if(!r||typeof r!="string")return o;var l=(0,n.default)(r),d=typeof a=="function";return l.forEach(function(f){if(f.type==="declaration"){var u=f.property,h=f.value;d?a(u,h,f):h&&(o=o||{},o[u]=h)}}),o}return vh}var Am={},sC;function e$(){if(sC)return Am;sC=1,Object.defineProperty(Am,"__esModule",{value:!0}),Am.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,o=function(u){return!u||t.test(u)||e.test(u)},l=function(u,h){return h.toUpperCase()},d=function(u,h){return"".concat(h,"-")},f=function(u,h){return h===void 0&&(h={}),o(u)?u:(u=u.toLowerCase(),h.reactCompat?u=u.replace(a,d):u=u.replace(r,d),u.replace(n,l))};return Am.camelCase=f,Am}var Pm,oC;function t$(){if(oC)return Pm;oC=1;var e=Pm&&Pm.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(Z6()),t=e$();function r(a,o){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(d,f){d&&f&&(l[(0,t.camelCase)(d,o)]=f)}),l}return r.default=r,Pm=r,Pm}var n$=t$();const r$=Wd(n$),Zk=e2("end"),Dw=e2("start");function e2(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function i$(e){const n=Dw(e),t=Zk(e);if(n&&t)return{start:n,end:t}}function Ym(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?lC(e.position):"start"in e||"end"in e?lC(e):"line"in e||"column"in e?k1(e):""}function k1(e){return cC(e&&e.line)+":"+cC(e&&e.column)}function lC(e){return k1(e&&e.start)+"-"+k1(e&&e.end)}function cC(e){return e&&typeof e=="number"?e:1}let Fi=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=d?d.line:void 0,this.name=Ym(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}};Fi.prototype.file="";Fi.prototype.name="";Fi.prototype.reason="";Fi.prototype.message="";Fi.prototype.stack="";Fi.prototype.column=void 0;Fi.prototype.line=void 0;Fi.prototype.ancestors=void 0;Fi.prototype.cause=void 0;Fi.prototype.fatal=void 0;Fi.prototype.place=void 0;Fi.prototype.ruleId=void 0;Fi.prototype.source=void 0;const Iw={}.hasOwnProperty,a$=new Map,s$=/[A-Z]/g,o$=new Set(["table","tbody","thead","tfoot","tr"]),l$=new Set(["td","th"]),t2="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function c$(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=y$(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=g$(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?Pw:J6,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=n2(a,e,void 0);return o&&typeof o!="string"?o:a.create(e,a.Fragment,{children:o||void 0},void 0)}function n2(e,n,t){if(n.type==="element")return u$(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return d$(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return h$(e,n,t);if(n.type==="mdxjsEsm")return f$(e,n);if(n.type==="root")return p$(e,n,t);if(n.type==="text")return m$(e,n)}function u$(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=Pw,e.schema=a),e.ancestors.push(n);const o=i2(e,n.tagName,!1),l=x$(e,n);let d=Mw(e,n);return o$.has(n.tagName)&&(d=d.filter(function(f){return typeof f=="string"?!z6(f):!0})),r2(e,l,o,n),Rw(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function d$(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}ng(e,n.position)}function f$(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);ng(e,n.position)}function h$(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=Pw,e.schema=a),e.ancestors.push(n);const o=n.name===null?e.Fragment:i2(e,n.name,!0),l=b$(e,n),d=Mw(e,n);return r2(e,l,o,n),Rw(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function p$(e,n,t){const r={};return Rw(r,Mw(e,n)),e.create(n,e.Fragment,r,t)}function m$(e,n){return n.value}function r2(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function Rw(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function g$(e,n,t){return r;function r(a,o,l,d){const u=Array.isArray(l.children)?t:n;return d?u(o,l,d):u(o,l)}}function y$(e,n){return t;function t(r,a,o,l){const d=Array.isArray(o.children),f=Dw(r);return n(a,o,l,d,{columnNumber:f?f.column-1:void 0,fileName:e,lineNumber:f?f.line:void 0},void 0)}}function x$(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&Iw.call(n.properties,a)){const o=v$(e,a,n.properties[a]);if(o){const[l,d]=o;e.tableCellAlignToStyle&&l==="align"&&typeof d=="string"&&l$.has(n.tagName)?r=d:t[l]=d}}if(r){const o=t.style||(t.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function b$(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const o=r.data.estree.body[0];o.type;const l=o.expression;l.type;const d=l.properties[0];d.type,Object.assign(t,e.evaluater.evaluateExpression(d.argument))}else ng(e,n.position);else{const a=r.name;let o;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const d=r.value.data.estree.body[0];d.type,o=e.evaluater.evaluateExpression(d.expression)}else ng(e,n.position);else o=r.value===null?!0:r.value;t[a]=o}return t}function Mw(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:a$;for(;++r<n.children.length;){const o=n.children[r];let l;if(e.passKeys){const f=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(f){const u=a.get(f)||0;l=f+"-"+u,a.set(f,u+1)}}const d=n2(e,o,l);d!==void 0&&t.push(d)}return t}function v$(e,n,t){const r=Y6(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?M6(t):K6(t)),r.property==="style"){let a=typeof t=="object"?t:w$(e,String(t));return e.stylePropertyNameCase==="css"&&(a=S$(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?V6[r.property]||r.property:r.attribute,t]}}function w$(e,n){try{return r$(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new Fi("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=t2+"#cannot-parse-style-attribute",a}}function i2(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let o=-1,l;for(;++o<a.length;){const d=eC(a[o])?{type:"Identifier",name:a[o]}:{type:"Literal",value:a[o]};l=l?{type:"MemberExpression",object:l,property:d,computed:!!(o&&d.type==="Literal"),optional:!1}:d}r=l}else r=eC(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return Iw.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);ng(e)}function ng(e,n){const t=new Fi("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=t2+"#cannot-handle-mdx-estrees-without-createevaluater",t}function S$(e){const n={};let t;for(t in e)Iw.call(e,t)&&(n[N$(t)]=e[t]);return n}function N$(e){let n=e.replace(s$,C$);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function C$(e){return"-"+e.toLowerCase()}const l0={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},_$={};function Ow(e,n){const t=_$,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return a2(e,r,a)}function a2(e,n,t){if(j$(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return uC(e.children,n,t)}return Array.isArray(e)?uC(e,n,t):""}function uC(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=a2(e[a],n,t);return r.join("")}function j$(e){return!!(e&&typeof e=="object")}const dC=document.createElement("i");function Lw(e){const n="&"+e+";";dC.innerHTML=n;const t=dC.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Ha(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function bs(e,n){return e.length>0?(Ha(e,e.length,0,n),e):n}const fC={}.hasOwnProperty;function s2(e){const n={};let t=-1;for(;++t<e.length;)k$(n,e[t]);return n}function k$(e,n){let t;for(t in n){const a=(fC.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){fC.call(a,l)||(a[l]=[]);const d=o[l];T$(a[l],Array.isArray(d)?d:d?[d]:[])}}}function T$(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Ha(e,0,0,r)}function o2(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function no(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Ki=mu(/[A-Za-z]/),Oi=mu(/[\dA-Za-z]/),E$=mu(/[#-'*+\--9=?A-Z^-~]/);function ab(e){return e!==null&&(e<32||e===127)}const T1=mu(/\d/),A$=mu(/[\dA-Fa-f]/),P$=mu(/[!-/:-@[-`{-~]/);function Ft(e){return e!==null&&e<-2}function tr(e){return e!==null&&(e<0||e===32)}function xn(e){return e===-2||e===-1||e===32}const Lb=mu(new RegExp("\\p{P}|\\p{S}","u")),Vd=mu(/\s/);function mu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Xh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Oi(e.charCodeAt(t+1))&&Oi(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function En(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return xn(f)?(e.enter(t),d(f)):n(f)}function d(f){return xn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const D$={tokenize:I$};function I$(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),En(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Ft(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const R$={tokenize:M$},hC={tokenize:O$};function M$(e){const n=this,t=[];let r=0,a,o,l;return d;function d(R){if(r<t.length){const z=t[r];return n.containerState=z[1],e.attempt(z[0].continuation,f,u)(R)}return u(R)}function f(R){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const z=n.events.length;let $=z,L;for(;$--;)if(n.events[$][0]==="exit"&&n.events[$][1].type==="chunkFlow"){L=n.events[$][1].end;break}P(r);let B=z;for(;B<n.events.length;)n.events[B][1].end={...L},B++;return Ha(n.events,$+1,0,n.events.slice(z)),n.events.length=B,u(R)}return d(R)}function u(R){if(r===t.length){if(!a)return b(R);if(a.currentConstruct&&a.currentConstruct.concrete)return S(R);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(hC,h,g)(R)}function h(R){return a&&M(),P(r),b(R)}function g(R){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(R)}function b(R){return n.containerState={},e.attempt(hC,v,S)(R)}function v(R){return r++,t.push([n.currentConstruct,n.containerState]),b(R)}function S(R){if(R===null){a&&M(),P(0),e.consume(R);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(R)}function k(R){if(R===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(R);return}return Ft(R)?(e.consume(R),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(R),k)}function T(R,z){const $=n.sliceStream(R);if(z&&$.push(null),R.previous=o,o&&(o.next=R),o=R,a.defineSkip(R.start),a.write($),n.parser.lazy[R.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const B=n.events.length;let q=B,W,I;for(;q--;)if(n.events[q][0]==="exit"&&n.events[q][1].type==="chunkFlow"){if(W){I=n.events[q][1].end;break}W=!0}for(P(r),L=B;L<n.events.length;)n.events[L][1].end={...I},L++;Ha(n.events,q+1,0,n.events.slice(B)),n.events.length=L}}function P(R){let z=t.length;for(;z-- >R;){const $=t[z];n.containerState=$[1],$[0].exit.call(n,e)}t.length=R}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function O$(e,n,t){return En(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Uh(e){if(e===null||tr(e)||Vd(e))return 1;if(Lb(e))return 2}function Fb(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const E1={name:"attention",resolveAll:L$,tokenize:F$};function L$(e,n){let t=-1,r,a,o,l,d,f,u,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};pC(g,-f),pC(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=bs(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=bs(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=bs(u,Fb(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=bs(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,u=bs(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,Ha(e,r-1,t-r+3,u),t=r+u.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function F$(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Uh(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),h=Uh(f),g=!h||h===2&&a||t.includes(f),b=!a||a===2&&h||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(h||!g)),n(f)}}function pC(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const $$={name:"autolink",tokenize:z$};function z$(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Ki(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Oi(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||Oi(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||ab(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),h):E$(v)?(e.consume(v),u):t(v)}function h(v){return Oi(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Oi(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const mg={partial:!0,tokenize:B$};function B$(e,n,t){return r;function r(o){return xn(o)?En(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Ft(o)?n(o):t(o)}}const l2={continuation:{tokenize:q$},exit:V$,name:"blockQuote",tokenize:U$};function U$(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return xn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function q$(e,n,t){const r=this;return a;function a(l){return xn(l)?En(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(l2,n,t)(l)}}function V$(e){e.exit("blockQuote")}const c2={name:"characterEscape",tokenize:H$};function H$(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return P$(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const u2={name:"characterReference",tokenize:G$};function G$(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Oi,h(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=A$,h):(e.enter("characterReferenceValue"),o=7,l=T1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Oi&&!Lw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),h):t(g)}}const mC={partial:!0,tokenize:W$},gC={concrete:!0,name:"codeFenced",tokenize:Y$};function Y$(e,n,t){const r=this,a={partial:!0,tokenize:$};let o=0,l=0,d;return f;function f(L){return u(L)}function u(L){const B=r.events[r.events.length-1];return o=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,d=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(L)}function h(L){return L===d?(l++,e.consume(L),h):l<3?t(L):(e.exit("codeFencedFenceSequence"),xn(L)?En(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Ft(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(mC,k,z)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Ft(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):xn(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),En(e,v,"whitespace")(L)):L===96&&L===d?t(L):(e.consume(L),b)}function v(L){return L===null||Ft(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Ft(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===d?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,z,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),P}function P(L){return o>0&&xn(L)?En(e,M,"linePrefix",o+1)(L):M(L)}function M(L){return L===null||Ft(L)?e.check(mC,k,z)(L):(e.enter("codeFlowValue"),R(L))}function R(L){return L===null||Ft(L)?(e.exit("codeFlowValue"),M(L)):(e.consume(L),R)}function z(L){return e.exit("codeFenced"),n(L)}function $(L,B,q){let W=0;return I;function I(Y){return L.enter("lineEnding"),L.consume(Y),L.exit("lineEnding"),F}function F(Y){return L.enter("codeFencedFence"),xn(Y)?En(L,V,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Y):V(Y)}function V(Y){return Y===d?(L.enter("codeFencedFenceSequence"),ee(Y)):q(Y)}function ee(Y){return Y===d?(W++,L.consume(Y),ee):W>=l?(L.exit("codeFencedFenceSequence"),xn(Y)?En(L,ie,"whitespace")(Y):ie(Y)):q(Y)}function ie(Y){return Y===null||Ft(Y)?(L.exit("codeFencedFence"),B(Y)):q(Y)}}}function W$(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const c0={name:"codeIndented",tokenize:J$},Q$={partial:!0,tokenize:K$};function J$(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),En(e,o,"linePrefix",5)(u)}function o(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Ft(u)?e.attempt(Q$,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Ft(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function K$(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Ft(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):En(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Ft(l)?a(l):t(l)}}const X$={name:"codeText",previous:e5,resolve:Z$,tokenize:t5};function Z$(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function e5(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function t5(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,h(g)):Ft(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Ft(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}let n5=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Dm(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Dm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Dm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Dm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Dm(this.left,t.reverse())}}};function Dm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function d2(e){const n={};let t=-1,r,a,o,l,d,f,u;const h=new n5(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,r5(h,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=h.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},d=h.slice(a,t),d.unshift(r),h.splice(a,t-a+1,d))}}return Ha(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function r5(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let h,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const i5={resolve:s5,tokenize:o5},a5={partial:!0,tokenize:l5};function s5(e){return d2(e),e}function o5(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Ft(d)?e.check(a5,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function l5(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),En(e,o,"linePrefix")}function o(l){if(l===null||Ft(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function f2(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let h=0;return g;function g(P){return P===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||ab(P)?t(P):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||Ft(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!h&&(P===null||P===41||tr(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(P)):h<u&&P===40?(e.consume(P),h++,k):P===41?(e.consume(P),h--,k):P===null||P===32||P===40||ab(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function h2(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),h}function h(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Ft(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Ft(v)||d++>999?(e.exit("chunkString"),h(v)):(e.consume(v),f||(f=!xn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function p2(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Ft(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),En(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||Ft(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function Wm(e,n){let t;return r;function r(a){return Ft(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):xn(a)?En(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const c5={name:"definition",tokenize:d5},u5={partial:!0,tokenize:f5};function d5(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return h2.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=no(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return tr(v)?Wm(e,u)(v):u(v)}function u(v){return f2(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(u5,g,g)(v)}function g(v){return xn(v)?En(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Ft(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function f5(e,n,t){return r;function r(d){return tr(d)?Wm(e,a)(d):t(d)}function a(d){return p2(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return xn(d)?En(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Ft(d)?n(d):t(d)}}const h5={name:"hardBreakEscape",tokenize:p5};function p5(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Ft(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const m5={name:"headingAtx",resolve:g5,tokenize:y5};function g5(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Ha(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function y5(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),o(h)}function o(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||tr(h)?(e.exit("atxHeadingSequence"),d(h)):t(h)}function d(h){return h===35?(e.enter("atxHeadingSequence"),f(h)):h===null||Ft(h)?(e.exit("atxHeading"),n(h)):xn(h)?En(e,d,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function f(h){return h===35?(e.consume(h),f):(e.exit("atxHeadingSequence"),d(h))}function u(h){return h===null||h===35||tr(h)?(e.exit("atxHeadingText"),d(h)):(e.consume(h),u)}}const x5=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],yC=["pre","script","style","textarea"],b5={concrete:!0,name:"htmlFlow",resolveTo:S5,tokenize:N5},v5={partial:!0,tokenize:_5},w5={partial:!0,tokenize:C5};function S5(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function N5(e,n,t){const r=this;let a,o,l,d,f;return u;function u(D){return h(D)}function h(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,r.interrupt?n:E):Ki(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):Ki(D)?(e.consume(D),a=4,r.interrupt?n:E):t(D)}function v(D){return D===45?(e.consume(D),r.interrupt?n:E):t(D)}function S(D){const me="CDATA[";return D===me.charCodeAt(d++)?(e.consume(D),d===me.length?r.interrupt?n:V:S):t(D)}function k(D){return Ki(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||tr(D)){const me=D===47,Ce=l.toLowerCase();return!me&&!o&&yC.includes(Ce)?(a=1,r.interrupt?n(D):V(D)):x5.includes(l.toLowerCase())?(a=6,me?(e.consume(D),P):r.interrupt?n(D):V(D)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(D):o?M(D):R(D))}return D===45||Oi(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),r.interrupt?n:V):t(D)}function M(D){return xn(D)?(e.consume(D),M):I(D)}function R(D){return D===47?(e.consume(D),I):D===58||D===95||Ki(D)?(e.consume(D),z):xn(D)?(e.consume(D),R):I(D)}function z(D){return D===45||D===46||D===58||D===95||Oi(D)?(e.consume(D),z):$(D)}function $(D){return D===61?(e.consume(D),L):xn(D)?(e.consume(D),$):R(D)}function L(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,B):xn(D)?(e.consume(D),L):q(D)}function B(D){return D===f?(e.consume(D),f=null,W):D===null||Ft(D)?t(D):(e.consume(D),B)}function q(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||tr(D)?$(D):(e.consume(D),q)}function W(D){return D===47||D===62||xn(D)?R(D):t(D)}function I(D){return D===62?(e.consume(D),F):t(D)}function F(D){return D===null||Ft(D)?V(D):xn(D)?(e.consume(D),F):t(D)}function V(D){return D===45&&a===2?(e.consume(D),Q):D===60&&a===1?(e.consume(D),ne):D===62&&a===4?(e.consume(D),de):D===63&&a===3?(e.consume(D),E):D===93&&a===5?(e.consume(D),oe):Ft(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(v5,he,ee)(D)):D===null||Ft(D)?(e.exit("htmlFlowData"),ee(D)):(e.consume(D),V)}function ee(D){return e.check(w5,ie,he)(D)}function ie(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),Y}function Y(D){return D===null||Ft(D)?ee(D):(e.enter("htmlFlowData"),V(D))}function Q(D){return D===45?(e.consume(D),E):V(D)}function ne(D){return D===47?(e.consume(D),l="",le):V(D)}function le(D){if(D===62){const me=l.toLowerCase();return yC.includes(me)?(e.consume(D),de):V(D)}return Ki(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),le):V(D)}function oe(D){return D===93?(e.consume(D),E):V(D)}function E(D){return D===62?(e.consume(D),de):D===45&&a===2?(e.consume(D),E):V(D)}function de(D){return D===null||Ft(D)?(e.exit("htmlFlowData"),he(D)):(e.consume(D),de)}function he(D){return e.exit("htmlFlow"),n(D)}}function C5(e,n,t){const r=this;return a;function a(l){return Ft(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function _5(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(mg,n,t)}}const j5={name:"htmlText",tokenize:k5};function k5(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),$):E===63?(e.consume(E),R):Ki(E)?(e.consume(E),q):t(E)}function u(E){return E===45?(e.consume(E),h):E===91?(e.consume(E),o=0,S):Ki(E)?(e.consume(E),M):t(E)}function h(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Ft(E)?(l=g,ne(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?Q(E):E===45?b(E):g(E)}function S(E){const de="CDATA[";return E===de.charCodeAt(o++)?(e.consume(E),o===de.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Ft(E)?(l=k,ne(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),P):k(E)}function P(E){return E===62?Q(E):E===93?(e.consume(E),P):k(E)}function M(E){return E===null||E===62?Q(E):Ft(E)?(l=M,ne(E)):(e.consume(E),M)}function R(E){return E===null?t(E):E===63?(e.consume(E),z):Ft(E)?(l=R,ne(E)):(e.consume(E),R)}function z(E){return E===62?Q(E):R(E)}function $(E){return Ki(E)?(e.consume(E),L):t(E)}function L(E){return E===45||Oi(E)?(e.consume(E),L):B(E)}function B(E){return Ft(E)?(l=B,ne(E)):xn(E)?(e.consume(E),B):Q(E)}function q(E){return E===45||Oi(E)?(e.consume(E),q):E===47||E===62||tr(E)?W(E):t(E)}function W(E){return E===47?(e.consume(E),Q):E===58||E===95||Ki(E)?(e.consume(E),I):Ft(E)?(l=W,ne(E)):xn(E)?(e.consume(E),W):Q(E)}function I(E){return E===45||E===46||E===58||E===95||Oi(E)?(e.consume(E),I):F(E)}function F(E){return E===61?(e.consume(E),V):Ft(E)?(l=F,ne(E)):xn(E)?(e.consume(E),F):W(E)}function V(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,ee):Ft(E)?(l=V,ne(E)):xn(E)?(e.consume(E),V):(e.consume(E),ie)}function ee(E){return E===a?(e.consume(E),a=void 0,Y):E===null?t(E):Ft(E)?(l=ee,ne(E)):(e.consume(E),ee)}function ie(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||tr(E)?W(E):(e.consume(E),ie)}function Y(E){return E===47||E===62||tr(E)?W(E):t(E)}function Q(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function ne(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),le}function le(E){return xn(E)?En(e,oe,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):oe(E)}function oe(E){return e.enter("htmlTextData"),l(E)}}const Fw={name:"labelEnd",resolveAll:P5,resolveTo:D5,tokenize:I5},T5={tokenize:R5},E5={tokenize:M5},A5={tokenize:O5};function P5(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Ha(e,0,e.length,t),e}function D5(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=bs(d,e.slice(o+1,o+r+3)),d=bs(d,[["enter",h,n]]),d=bs(d,Fb(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=bs(d,[["exit",h,n],e[l-2],e[l-1],["exit",u,n]]),d=bs(d,e.slice(l+1)),d=bs(d,[["exit",f,n]]),Ha(e,o,e.length,d),e}function I5(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(no(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(T5,h,l?h:g)(b):b===91?e.attempt(E5,h,l?u:g)(b):l?h(b):g(b)}function u(b){return e.attempt(A5,h,g)(b)}function h(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function R5(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return tr(g)?Wm(e,o)(g):o(g)}function o(g){return g===41?h(g):f2(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return tr(g)?Wm(e,f)(g):h(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?p2(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function u(g){return tr(g)?Wm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function M5(e,n,t){const r=this;return a;function a(d){return h2.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes(no(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function O5(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const L5={name:"labelStartImage",resolveAll:Fw.resolveAll,tokenize:F5};function F5(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const $5={name:"labelStartLink",resolveAll:Fw.resolveAll,tokenize:z5};function z5(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const u0={name:"lineEnding",tokenize:B5};function B5(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),En(e,n,"linePrefix")}}const Gx={name:"thematicBreak",tokenize:U5};function U5(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Ft(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),xn(u)?En(e,d,"whitespace")(u):d(u))}}const da={continuation:{tokenize:G5},exit:W5,name:"list",tokenize:H5},q5={partial:!0,tokenize:Q5},V5={partial:!0,tokenize:Y5};function H5(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:T1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Gx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return T1(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(mg,r.interrupt?t:h,e.attempt(q5,b,g))}function h(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return xn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function G5(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(mg,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,En(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!xn(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(V5,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,En(e,e.attempt(da,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function Y5(e,n,t){const r=this;return En(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function W5(e){e.exit(this.containerState.type)}function Q5(e,n,t){const r=this;return En(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!xn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const xC={name:"setextUnderline",resolveTo:J5,tokenize:K5};function J5(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function K5(e,n,t){const r=this;let a;return o;function o(u){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),xn(u)?En(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Ft(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const X5={tokenize:Z5};function Z5(e){const n=this,t=e.attempt(mg,r,e.attempt(this.parser.constructs.flowInitial,a,En(e,e.attempt(this.parser.constructs.flow,a,e.attempt(i5,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const ez={resolveAll:g2()},tz=m2("string"),nz=m2("text");function m2(e){return{resolveAll:g2(e==="text"?rz:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(h){return u(h)?o(h):d(h)}function d(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),f}function f(h){return u(h)?(t.exit("data"),o(h)):(t.consume(h),f)}function u(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function g2(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function rz(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const iz={42:da,43:da,45:da,48:da,49:da,50:da,51:da,52:da,53:da,54:da,55:da,56:da,57:da,62:l2},az={91:c5},sz={[-2]:c0,[-1]:c0,32:c0},oz={35:m5,42:Gx,45:[xC,Gx],60:b5,61:xC,95:Gx,96:gC,126:gC},lz={38:u2,92:c2},cz={[-5]:u0,[-4]:u0,[-3]:u0,33:L5,38:u2,42:E1,60:[$$,j5],91:$5,92:[h5,c2],93:Fw,95:E1,96:X$},uz={null:[E1,ez]},dz={null:[42,95]},fz={null:[]},hz=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:dz,contentInitial:az,disable:fz,document:iz,flow:oz,flowInitial:sz,insideSpan:uz,string:lz,text:cz},Symbol.toStringTag,{value:"Module"}));function pz(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:B($),check:B(L),consume:M,enter:R,exit:z,interrupt:B(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(F){return l=bs(l,F),T(),l[l.length-1]!==null?[]:(q(n,0),u.events=Fb(o,u.events,u),u.events)}function b(F,V){return gz(v(F),V)}function v(F){return mz(l,F)}function S(){const{_bufferIndex:F,_index:V,line:ee,column:ie,offset:Y}=r;return{_bufferIndex:F,_index:V,line:ee,column:ie,offset:Y}}function k(F){a[F.line]=F.column,I()}function T(){let F;for(;r._index<l.length;){const V=l[r._index];if(typeof V=="string")for(F=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===F&&r._bufferIndex<V.length;)P(V.charCodeAt(r._bufferIndex));else P(V)}}function P(F){h=h(F)}function M(F){Ft(F)?(r.line++,r.column=1,r.offset+=F===-3?2:1,I()):F!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=F}function R(F,V){const ee=V||{};return ee.type=F,ee.start=S(),u.events.push(["enter",ee,u]),d.push(ee),ee}function z(F){const V=d.pop();return V.end=S(),u.events.push(["exit",V,u]),V}function $(F,V){q(F,V.from)}function L(F,V){V.restore()}function B(F,V){return ee;function ee(ie,Y,Q){let ne,le,oe,E;return Array.isArray(ie)?he(ie):"tokenize"in ie?he([ie]):de(ie);function de(te){return K;function K(J){const xe=J!==null&&te[J],He=J!==null&&te.null,re=[...Array.isArray(xe)?xe:xe?[xe]:[],...Array.isArray(He)?He:He?[He]:[]];return he(re)(J)}}function he(te){return ne=te,le=0,te.length===0?Q:D(te[le])}function D(te){return K;function K(J){return E=W(),oe=te,te.partial||(u.currentConstruct=te),te.name&&u.parser.constructs.disable.null.includes(te.name)?Ce():te.tokenize.call(V?Object.assign(Object.create(u),V):u,f,me,Ce)(J)}}function me(te){return F(oe,E),Y}function Ce(te){return E.restore(),++le<ne.length?D(ne[le]):Q}}}function q(F,V){F.resolveAll&&!o.includes(F)&&o.push(F),F.resolve&&Ha(u.events,V,u.events.length-V,F.resolve(u.events.slice(V),u)),F.resolveTo&&(u.events=F.resolveTo(u.events,u))}function W(){const F=S(),V=u.previous,ee=u.currentConstruct,ie=u.events.length,Y=Array.from(d);return{from:ie,restore:Q};function Q(){r=F,u.previous=V,u.currentConstruct=ee,u.events.length=ie,d=Y,I()}}function I(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function mz(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function gz(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function yz(e){const r={constructs:s2([hz,...(e||{}).extensions||[]]),content:a(D$),defined:[],document:a(R$),flow:a(X5),lazy:{},string:a(tz),text:a(nz)};return r;function a(o){return l;function l(d){return pz(r,o,d)}}}function xz(e){for(;!d2(e););return e}const bC=/[\0\t\n\r]/g;function bz(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,h,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(bC.lastIndex=g,u=bC.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,f.push(-2);e++<h;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const vz=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function wz(e){return e.replace(vz,Sz)}function Sz(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return o2(t.slice(o?2:1),o?16:10)}return Lw(t)||e}const y2={}.hasOwnProperty;function Nz(e,n,t){return typeof n!="string"&&(t=n,n=void 0),Cz(t)(xz(yz(t).document().write(bz()(e,n,!0))))}function Cz(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(st),autolinkProtocol:W,autolinkEmail:W,atxHeading:o(Ye),blockQuote:o(He),characterEscape:W,characterReference:W,codeFenced:o(re),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(re,l),codeText:o(Be,l),codeTextData:W,data:W,codeFlowValue:W,definition:o(Ae),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Ie),hardBreakEscape:o(at),hardBreakTrailing:o(at),htmlFlow:o(Ze,l),htmlFlowData:W,htmlText:o(Ze,l),htmlTextData:W,image:o(Ke),label:l,link:o(st),listItem:o(je),listItemValue:b,listOrdered:o(yt,g),listUnordered:o(yt),paragraph:o(Ge),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(Ye),strong:o(_e),thematicBreak:o(ce)},exit:{atxHeading:f(),atxHeadingSequence:$,autolink:f(),autolinkEmail:xe,autolinkProtocol:J,blockQuote:f(),characterEscapeValue:I,characterReferenceMarkerHexadecimal:Ce,characterReferenceMarkerNumeric:Ce,characterReferenceValue:te,characterReference:K,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:I,codeIndented:f(P),codeText:f(Y),codeTextData:I,data:I,definition:f(),definitionDestinationString:z,definitionLabelString:M,definitionTitleString:R,emphasis:f(),hardBreakEscape:f(V),hardBreakTrailing:f(V),htmlFlow:f(ee),htmlFlowData:I,htmlText:f(ie),htmlTextData:I,image:f(ne),label:oe,labelText:le,lineEnding:F,link:f(Q),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:me,resourceDestinationString:E,resourceTitleString:de,resource:he,setextHeading:f(q),setextHeadingLineSequence:B,setextHeadingText:L,strong:f(),thematicBreak:f()}};x2(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(G){let fe={type:"root",children:[]};const Ne={stack:[fe],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:h,data:t},Le=[];let tt=-1;for(;++tt<G.length;)if(G[tt][1].type==="listOrdered"||G[tt][1].type==="listUnordered")if(G[tt][0]==="enter")Le.push(tt);else{const xt=Le.pop();tt=a(G,xt,tt)}for(tt=-1;++tt<G.length;){const xt=n[G[tt][0]];y2.call(xt,G[tt][1].type)&&xt[G[tt][1].type].call(Object.assign({sliceSerialize:G[tt][2].sliceSerialize},Ne),G[tt][1])}if(Ne.tokenStack.length>0){const xt=Ne.tokenStack[Ne.tokenStack.length-1];(xt[1]||vC).call(Ne,void 0,xt[0])}for(fe.position={start:ru(G.length>0?G[0][1].start:{line:1,column:1,offset:0}),end:ru(G.length>0?G[G.length-2][1].end:{line:1,column:1,offset:0})},tt=-1;++tt<n.transforms.length;)fe=n.transforms[tt](fe)||fe;return fe}function a(G,fe,Ne){let Le=fe-1,tt=-1,xt=!1,St,we,ye,Oe;for(;++Le<=Ne;){const De=G[Le];switch(De[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{De[0]==="enter"?tt++:tt--,Oe=void 0;break}case"lineEndingBlank":{De[0]==="enter"&&(St&&!Oe&&!tt&&!ye&&(ye=Le),Oe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Oe=void 0}if(!tt&&De[0]==="enter"&&De[1].type==="listItemPrefix"||tt===-1&&De[0]==="exit"&&(De[1].type==="listUnordered"||De[1].type==="listOrdered")){if(St){let Ve=Le;for(we=void 0;Ve--;){const ot=G[Ve];if(ot[1].type==="lineEnding"||ot[1].type==="lineEndingBlank"){if(ot[0]==="exit")continue;we&&(G[we][1].type="lineEndingBlank",xt=!0),ot[1].type="lineEnding",we=Ve}else if(!(ot[1].type==="linePrefix"||ot[1].type==="blockQuotePrefix"||ot[1].type==="blockQuotePrefixWhitespace"||ot[1].type==="blockQuoteMarker"||ot[1].type==="listItemIndent"))break}ye&&(!we||ye<we)&&(St._spread=!0),St.end=Object.assign({},we?G[we][1].start:De[1].end),G.splice(we||Le,0,["exit",St,De[2]]),Le++,Ne++}if(De[1].type==="listItemPrefix"){const Ve={type:"listItem",_spread:!1,start:Object.assign({},De[1].start),end:void 0};St=Ve,G.splice(Le,0,["enter",Ve,De[2]]),Le++,Ne++,ye=void 0,Oe=!0}}}return G[fe][1]._spread=xt,Ne}function o(G,fe){return Ne;function Ne(Le){d.call(this,G(Le),Le),fe&&fe.call(this,Le)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(G,fe,Ne){this.stack[this.stack.length-1].children.push(G),this.stack.push(G),this.tokenStack.push([fe,Ne||void 0]),G.position={start:ru(fe.start),end:void 0}}function f(G){return fe;function fe(Ne){G&&G.call(this,Ne),u.call(this,Ne)}}function u(G,fe){const Ne=this.stack.pop(),Le=this.tokenStack.pop();if(Le)Le[0].type!==G.type&&(fe?fe.call(this,G,Le[0]):(Le[1]||vC).call(this,G,Le[0]));else throw new Error("Cannot close `"+G.type+"` ("+Ym({start:G.start,end:G.end})+"): its not open");Ne.position.end=ru(G.end)}function h(){return Ow(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(G){if(this.data.expectingFirstListItemValue){const fe=this.stack[this.stack.length-2];fe.start=Number.parseInt(this.sliceSerialize(G),10),this.data.expectingFirstListItemValue=void 0}}function v(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.lang=G}function S(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.meta=G}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G.replace(/(\r?\n|\r)$/g,"")}function M(G){const fe=this.resume(),Ne=this.stack[this.stack.length-1];Ne.label=fe,Ne.identifier=no(this.sliceSerialize(G)).toLowerCase()}function R(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.title=G}function z(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.url=G}function $(G){const fe=this.stack[this.stack.length-1];if(!fe.depth){const Ne=this.sliceSerialize(G).length;fe.depth=Ne}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function B(G){const fe=this.stack[this.stack.length-1];fe.depth=this.sliceSerialize(G).codePointAt(0)===61?1:2}function q(){this.data.setextHeadingSlurpLineEnding=void 0}function W(G){const Ne=this.stack[this.stack.length-1].children;let Le=Ne[Ne.length-1];(!Le||Le.type!=="text")&&(Le=pe(),Le.position={start:ru(G.start),end:void 0},Ne.push(Le)),this.stack.push(Le)}function I(G){const fe=this.stack.pop();fe.value+=this.sliceSerialize(G),fe.position.end=ru(G.end)}function F(G){const fe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ne=fe.children[fe.children.length-1];Ne.position.end=ru(G.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(fe.type)&&(W.call(this,G),I.call(this,G))}function V(){this.data.atHardBreak=!0}function ee(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G}function ie(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G}function Y(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G}function Q(){const G=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";G.type+="Reference",G.referenceType=fe,delete G.url,delete G.title}else delete G.identifier,delete G.label;this.data.referenceType=void 0}function ne(){const G=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";G.type+="Reference",G.referenceType=fe,delete G.url,delete G.title}else delete G.identifier,delete G.label;this.data.referenceType=void 0}function le(G){const fe=this.sliceSerialize(G),Ne=this.stack[this.stack.length-2];Ne.label=wz(fe),Ne.identifier=no(fe).toLowerCase()}function oe(){const G=this.stack[this.stack.length-1],fe=this.resume(),Ne=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ne.type==="link"){const Le=G.children;Ne.children=Le}else Ne.alt=fe}function E(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.url=G}function de(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.title=G}function he(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function me(G){const fe=this.resume(),Ne=this.stack[this.stack.length-1];Ne.label=fe,Ne.identifier=no(this.sliceSerialize(G)).toLowerCase(),this.data.referenceType="full"}function Ce(G){this.data.characterReferenceType=G.type}function te(G){const fe=this.sliceSerialize(G),Ne=this.data.characterReferenceType;let Le;Ne?(Le=o2(fe,Ne==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Le=Lw(fe);const tt=this.stack[this.stack.length-1];tt.value+=Le}function K(G){const fe=this.stack.pop();fe.position.end=ru(G.end)}function J(G){I.call(this,G);const fe=this.stack[this.stack.length-1];fe.url=this.sliceSerialize(G)}function xe(G){I.call(this,G);const fe=this.stack[this.stack.length-1];fe.url="mailto:"+this.sliceSerialize(G)}function He(){return{type:"blockquote",children:[]}}function re(){return{type:"code",lang:null,meta:null,value:""}}function Be(){return{type:"inlineCode",value:""}}function Ae(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ie(){return{type:"emphasis",children:[]}}function Ye(){return{type:"heading",depth:0,children:[]}}function at(){return{type:"break"}}function Ze(){return{type:"html",value:""}}function Ke(){return{type:"image",title:null,url:"",alt:null}}function st(){return{type:"link",title:null,url:"",children:[]}}function yt(G){return{type:"list",ordered:G.type==="listOrdered",start:null,spread:G._spread,children:[]}}function je(G){return{type:"listItem",spread:G._spread,checked:null,children:[]}}function Ge(){return{type:"paragraph",children:[]}}function _e(){return{type:"strong",children:[]}}function pe(){return{type:"text",value:""}}function ce(){return{type:"thematicBreak"}}}function ru(e){return{line:e.line,column:e.column,offset:e.offset}}function x2(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?x2(e,r):_z(e,r)}}function _z(e,n){let t;for(t in n)if(y2.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function vC(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Ym({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Ym({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Ym({start:n.start,end:n.end})+") is still open")}function jz(e){const n=this;n.parser=t;function t(r){return Nz(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function kz(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function Tz(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function Ez(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function Az(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Pz(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Dz(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Xh(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function Iz(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Rz(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function b2(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function Mz(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return b2(e,n);const a={src:Xh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function Oz(e,n){const t={src:Xh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function Lz(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function Fz(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return b2(e,n);const a={href:Xh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function $z(e,n){const t={href:Xh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function zz(e,n,t){const r=e.all(n),a=t?Bz(t):v2(n),o={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const h=r[d];(a||d!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function Bz(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=v2(t[r])}return n}function v2(e){const n=e.spread;return n??e.children.length>1}function Uz(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function qz(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Vz(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function Hz(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Gz(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=Dw(n.children[1]),f=Zk(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function Yz(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,h),e.applyData(n,h)}function Wz(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const wC=9,SC=32;function Qz(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(NC(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(NC(n.slice(a),a>0,!1)),o.join("")}function NC(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===wC||o===SC;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===wC||o===SC;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function Jz(e,n){const t={type:"text",value:Qz(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function Kz(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const Xz={blockquote:kz,break:Tz,code:Ez,delete:Az,emphasis:Pz,footnoteReference:Dz,heading:Iz,html:Rz,imageReference:Mz,image:Oz,inlineCode:Lz,linkReference:Fz,link:$z,listItem:zz,list:Uz,paragraph:qz,root:Vz,strong:Hz,table:Gz,tableCell:Wz,tableRow:Yz,text:Jz,thematicBreak:Kz,toml:wx,yaml:wx,definition:wx,footnoteDefinition:wx};function wx(){}const w2=-1,$b=0,Qm=1,sb=2,$w=3,zw=4,Bw=5,Uw=6,S2=7,N2=8,CC=typeof self=="object"?self:globalThis,Zz=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case $b:case w2:return t(l,a);case Qm:{const d=t([],a);for(const f of l)d.push(r(f));return d}case sb:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case $w:return t(new Date(l),a);case zw:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case Bw:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case Uw:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case S2:{const{name:d,message:f}=l;return t(new CC[d](f),a)}case N2:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new CC[o](l),a)};return r},_C=e=>Zz(new Map,e)(0),wh="",{toString:e8}={},{keys:t8}=Object,Im=e=>{const n=typeof e;if(n!=="object"||!e)return[$b,n];const t=e8.call(e).slice(8,-1);switch(t){case"Array":return[Qm,wh];case"Object":return[sb,wh];case"Date":return[$w,wh];case"RegExp":return[zw,wh];case"Map":return[Bw,wh];case"Set":return[Uw,wh];case"DataView":return[Qm,t]}return t.includes("Array")?[Qm,t]:t.includes("Error")?[S2,t]:[sb,t]},Sx=([e,n])=>e===$b&&(n==="function"||n==="symbol"),n8=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Im(l);switch(d){case $b:{let h=l;switch(f){case"bigint":d=N2,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);h=null;break;case"undefined":return a([w2],l)}return a([d,h],l)}case Qm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const h=[],g=a([d,h],l);for(const b of l)h.push(o(b));return g}case sb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const h=[],g=a([d,h],l);for(const b of t8(l))(e||!Sx(Im(l[b])))&&h.push([o(b),o(l[b])]);return g}case $w:return a([d,l.toISOString()],l);case zw:{const{source:h,flags:g}=l;return a([d,{source:h,flags:g}],l)}case Bw:{const h=[],g=a([d,h],l);for(const[b,v]of l)(e||!(Sx(Im(b))||Sx(Im(v))))&&h.push([o(b),o(v)]);return g}case Uw:{const h=[],g=a([d,h],l);for(const b of l)(e||!Sx(Im(b)))&&h.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},jC=(e,{json:n,lossy:t}={})=>{const r=[];return n8(!(n||t),!!n,new Map,r)(e),r},ob=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?_C(jC(e,n)):structuredClone(e):(e,n)=>_C(jC(e,n));function r8(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function i8(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function a8(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||r8,r=e.options.footnoteBackLabel||i8,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const h=e.all(u),g=String(u.identifier).toUpperCase(),b=Xh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else h.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...ob(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const zb=function(e){if(e==null)return c8;if(typeof e=="function")return Bb(e);if(typeof e=="object")return Array.isArray(e)?s8(e):o8(e);if(typeof e=="string")return l8(e);throw new Error("Expected function, string, or object as test")};function s8(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=zb(e[t]);return Bb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function o8(e){const n=e;return Bb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function l8(e){return Bb(n);function n(t){return t&&t.type===e}}function Bb(e){return n;function n(t,r,a){return!!(u8(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function c8(){return!0}function u8(e){return e!==null&&typeof e=="object"&&"type"in e}const C2=[],d8=!0,A1=!1,f8="skip";function _2(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=zb(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,h){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=C2,S,k,T;if((!n||o(f,u,h[h.length-1]||void 0))&&(v=h8(t(f,h)),v[0]===A1))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==f8)for(k=(r?P.children.length:-1)+l,T=h.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===A1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function h8(e){return Array.isArray(e)?e:typeof e=="number"?[d8,e]:e==null?C2:[e]}function qw(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),_2(e,o,d,a);function d(f,u){const h=u[u.length-1],g=h?h.children.indexOf(f):void 0;return l(f,g,h)}}const P1={}.hasOwnProperty,p8={};function m8(e,n){const t=n||p8,r=new Map,a=new Map,o=new Map,l={...Xz,...t.handlers},d={all:u,applyData:y8,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:g8,wrap:b8};return qw(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),d;function f(h,g){const b=h.type,v=d.handlers[b];if(P1.call(d.handlers,b)&&v)return v(d,h,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,P=ob(T);return P.children=d.all(h),P}return ob(h)}return(d.options.unknownHandler||x8)(d,h,g)}function u(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=kC(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=kC(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function g8(e,n){e.position&&(n.position=i$(e))}function y8(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,ob(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function x8(e,n){const t=n.data||{},r="value"in n&&!(P1.call(t,"hProperties")||P1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function b8(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function kC(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function TC(e,n){const t=m8(e,n),r=t.one(e,void 0),a=a8(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}function v8(e,n){return e&&"run"in e?async function(t,r){const a=TC(t,{file:r,...n});await e.run(a,r)}:function(t,r){return TC(t,{file:r,...e||n})}}function EC(e){if(e)throw e}var d0,AC;function w8(){if(AC)return d0;AC=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var h=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!h&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,h){t&&h.name==="__proto__"?t(u,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):u[h.name]=h.newValue},d=function(u,h){if(h==="__proto__")if(e.call(u,h)){if(r)return r(u,h).value}else return;return u[h]};return d0=function f(){var u,h,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(h in u)g=d(k,h),b=d(u,h),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:h,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},d0}var S8=w8();const f0=Wd(S8);function D1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function N8(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const h=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,h?C8(h,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function C8(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const h=u;if(d&&t)throw h;return a(h)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}const Ko={basename:_8,dirname:j8,extname:k8,join:T8,sep:"/"};function _8(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');gg(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function j8(e){if(gg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function k8(e){gg(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function T8(...e){let n=-1,t;for(;++n<e.length;)gg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":E8(t)}function E8(e){gg(e);const n=e.codePointAt(0)===47;let t=A8(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function A8(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function gg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const P8={cwd:D8};function D8(){return"/"}function I1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function I8(e){if(typeof e=="string")e=new URL(e);else if(!I1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return R8(e)}function R8(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const h0=["history","path","basename","stem","extname","dirname"];let j2=class{constructor(n){let t;n?I1(n)?t={path:n}:typeof n=="string"||M8(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":P8.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<h0.length;){const o=h0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)h0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Ko.basename(this.path):void 0}set basename(n){m0(n,"basename"),p0(n,"basename"),this.path=Ko.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Ko.dirname(this.path):void 0}set dirname(n){PC(this.basename,"dirname"),this.path=Ko.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Ko.extname(this.path):void 0}set extname(n){if(p0(n,"extname"),PC(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Ko.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){I1(n)&&(n=I8(n)),m0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Ko.basename(this.path,this.extname):void 0}set stem(n){m0(n,"stem"),p0(n,"stem"),this.path=Ko.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Fi(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function p0(e,n){if(e&&e.includes(Ko.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Ko.sep+"`")}function m0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function PC(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function M8(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const O8=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},L8={}.hasOwnProperty;let F8=class k2 extends O8{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=N8()}copy(){const n=new k2;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(f0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(x0("data",this.frozen),this.namespace[n]=t,this):L8.call(this.namespace,n)&&this.namespace[n]||void 0:n?(x0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Nx(n),r=this.parser||this.Parser;return g0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),g0("process",this.parser||this.Parser),y0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=Nx(n),f=r.parse(d);r.run(f,d,function(h,g,b){if(h||!g||!b)return u(h);const v=g,S=r.stringify(v,b);B8(S)?b.value=S:b.result=S,u(h,b)});function u(h,g){h||!g?l(h):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),g0("processSync",this.parser||this.Parser),y0("processSync",this.compiler||this.Compiler),this.process(n,a),IC("processSync","process",t),r;function a(o,l){t=!0,EC(o),r=l}}run(n,t,r){DC(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=Nx(t);a.run(n,f,u);function u(h,g,b){const v=g||n;h?d(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),IC("runSync","run",r),a;function o(l,d){EC(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=Nx(t),a=this.compiler||this.Compiler;return y0("stringify",a),DC(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(x0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...g]=u;f(h,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=f0(!0,a.settings,u.settings))}function d(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const g=u[h];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];D1(k)&&D1(v)&&(v=f0(!0,k,v)),r[b]=[u,v,...S]}}}};const $8=new F8().freeze();function g0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function y0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function x0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function DC(e){if(!D1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function IC(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Nx(e){return z8(e)?e:new j2(e)}function z8(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function B8(e){return typeof e=="string"||U8(e)}function U8(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const q8="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",RC=[],MC={allowDangerousHtml:!0},V8=/^(https?|ircs?|mailto|xmpp)$/i,H8=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function ws(e){const n=G8(e),t=Y8(e);return W8(n.runSync(n.parse(t),t),e)}function G8(e){const n=e.rehypePlugins||RC,t=e.remarkPlugins||RC,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...MC}:MC;return $8().use(jz).use(t).use(v8,r).use(n)}function Y8(e){const n=e.children||"",t=new j2;return typeof n=="string"&&(t.value=n),t}function W8(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,o=n.disallowedElements,l=n.skipHtml,d=n.unwrapDisallowed,f=n.urlTransform||Q8;for(const h of H8)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+q8+h.id,void 0);return qw(e,u),c$(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function u(h,g,b){if(h.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let v;for(v in l0)if(Object.hasOwn(l0,v)&&Object.hasOwn(h.properties,v)){const S=h.properties[v],k=l0[v];(k===null||k.includes(h.tagName))&&(h.properties[v]=f(String(S||""),v,h))}}if(h.type==="element"){let v=t?!t.includes(h.tagName):o?o.includes(h.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(h,g,b)),v&&b&&typeof g=="number")return d&&h.children?b.children.splice(g,1,...h.children):b.children.splice(g,1),g}}}function Q8(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||V8.test(e.slice(0,n))?e:""}function OC(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function J8(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function K8(e,n,t){const a=zb((t||{}).ignore||[]),o=X8(n);let l=-1;for(;++l<o.length;)_2(e,"text",d);function d(u,h){let g=-1,b;for(;++g<h.length;){const v=h[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return f(u,h)}function f(u,h){const g=h[h.length-1],b=o[l][0],v=o[l][1];let S=0;const T=g.children.indexOf(u);let P=!1,M=[];b.lastIndex=0;let R=b.exec(u.value);for(;R;){const z=R.index,$={index:R.index,input:R.input,stack:[...h,u]};let L=v(...R,$);if(typeof L=="string"&&(L=L.length>0?{type:"text",value:L}:void 0),L===!1?b.lastIndex=z+1:(S!==z&&M.push({type:"text",value:u.value.slice(S,z)}),Array.isArray(L)?M.push(...L):L&&M.push(L),S=z+R[0].length,P=!0),!b.global)break;R=b.exec(u.value)}return P?(S<u.value.length&&M.push({type:"text",value:u.value.slice(S)}),g.children.splice(T,1,...M)):M=[u],T+M.length}}function X8(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([Z8(a[0]),eB(a[1])])}return n}function Z8(e){return typeof e=="string"?new RegExp(J8(e),"g"):e}function eB(e){return typeof e=="function"?e:function(){return e}}const b0="phrasing",v0=["autolink","link","image","label"];function tB(){return{transforms:[lB],enter:{literalAutolink:rB,literalAutolinkEmail:w0,literalAutolinkHttp:w0,literalAutolinkWww:w0},exit:{literalAutolink:oB,literalAutolinkEmail:sB,literalAutolinkHttp:iB,literalAutolinkWww:aB}}}function nB(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:b0,notInConstruct:v0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:b0,notInConstruct:v0},{character:":",before:"[ps]",after:"\\/",inConstruct:b0,notInConstruct:v0}]}}function rB(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function w0(e){this.config.enter.autolinkProtocol.call(this,e)}function iB(e){this.config.exit.autolinkProtocol.call(this,e)}function aB(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function sB(e){this.config.exit.autolinkEmail.call(this,e)}function oB(e){this.exit(e)}function lB(e){K8(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,cB],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),uB]],{ignore:["link","linkReference"]})}function cB(e,n,t,r,a){let o="";if(!T2(a)||(/^w/i.test(n)&&(t=n+t,n="",o="http://"),!dB(t)))return!1;const l=fB(t+r);if(!l[0])return!1;const d={type:"link",title:null,url:o+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[d,{type:"text",value:l[1]}]:d}function uB(e,n,t,r){return!T2(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function dB(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function fB(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=OC(e,"(");let o=OC(e,")");for(;r!==-1&&a>o;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),o++;return[e,t]}function T2(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||Vd(t)||Lb(t))&&(!n||t!==47)}E2.peek=wB;function hB(){this.buffer()}function pB(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function mB(){this.buffer()}function gB(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function yB(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=no(this.sliceSerialize(e)).toLowerCase(),t.label=n}function xB(e){this.exit(e)}function bB(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=no(this.sliceSerialize(e)).toLowerCase(),t.label=n}function vB(e){this.exit(e)}function wB(){return"["}function E2(e,n,t,r){const a=t.createTracker(r);let o=a.move("[^");const l=t.enter("footnoteReference"),d=t.enter("reference");return o+=a.move(t.safe(t.associationId(e),{after:"]",before:o})),d(),l(),o+=a.move("]"),o}function SB(){return{enter:{gfmFootnoteCallString:hB,gfmFootnoteCall:pB,gfmFootnoteDefinitionLabelString:mB,gfmFootnoteDefinition:gB},exit:{gfmFootnoteCallString:yB,gfmFootnoteCall:xB,gfmFootnoteDefinitionLabelString:bB,gfmFootnoteDefinition:vB}}}function NB(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:E2},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,o,l){const d=o.createTracker(l);let f=d.move("[^");const u=o.enter("footnoteDefinition"),h=o.enter("label");return f+=d.move(o.safe(o.associationId(r),{before:f,after:"]"})),h(),f+=d.move("]:"),r.children&&r.children.length>0&&(d.shift(4),f+=d.move((n?`
`:" ")+o.indentLines(o.containerFlow(r,d.current()),n?A2:CB))),u(),f}}function CB(e,n,t){return n===0?e:A2(e,n,t)}function A2(e,n,t){return(t?"":"    ")+e}const _B=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];P2.peek=AB;function jB(){return{canContainEols:["delete"],enter:{strikethrough:TB},exit:{strikethrough:EB}}}function kB(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:_B}],handlers:{delete:P2}}}function TB(e){this.enter({type:"delete",children:[]},e)}function EB(e){this.exit(e)}function P2(e,n,t,r){const a=t.createTracker(r),o=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),o(),l}function AB(){return"~"}function PB(e){return e.length}function DB(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||PB,o=[],l=[],d=[],f=[];let u=0,h=-1;for(;++h<e.length;){const k=[],T=[];let P=-1;for(e[h].length>u&&(u=e[h].length);++P<e[h].length;){const M=IB(e[h][P]);if(t.alignDelimiters!==!1){const R=a(M);T[P]=R,(f[P]===void 0||R>f[P])&&(f[P]=R)}k.push(M)}l[h]=k,d[h]=T}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<u;)o[g]=LC(r[g]);else{const k=LC(r);for(;++g<u;)o[g]=k}g=-1;const b=[],v=[];for(;++g<u;){const k=o[g];let T="",P="";k===99?(T=":",P=":"):k===108?T=":":k===114&&(P=":");let M=t.alignDelimiters===!1?1:Math.max(1,f[g]-T.length-P.length);const R=T+"-".repeat(M)+P;t.alignDelimiters!==!1&&(M=T.length+M+P.length,M>f[g]&&(f[g]=M),v[g]=M),b[g]=R}l.splice(1,0,b),d.splice(1,0,v),h=-1;const S=[];for(;++h<l.length;){const k=l[h],T=d[h];g=-1;const P=[];for(;++g<u;){const M=k[g]||"";let R="",z="";if(t.alignDelimiters!==!1){const $=f[g]-(T[g]||0),L=o[g];L===114?R=" ".repeat($):L===99?$%2?(R=" ".repeat($/2+.5),z=" ".repeat($/2-.5)):(R=" ".repeat($/2),z=R):z=" ".repeat($)}t.delimiterStart!==!1&&!g&&P.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&M==="")&&(t.delimiterStart!==!1||g)&&P.push(" "),t.alignDelimiters!==!1&&P.push(R),P.push(M),t.alignDelimiters!==!1&&P.push(z),t.padding!==!1&&P.push(" "),(t.delimiterEnd!==!1||g!==u-1)&&P.push("|")}S.push(t.delimiterEnd===!1?P.join("").replace(/ +$/,""):P.join(""))}return S.join(`
`)}function IB(e){return e==null?"":String(e)}function LC(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function RB(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),MB);return a(),l}function MB(e,n,t){return">"+(t?"":" ")+e}function OB(e,n){return FC(e,n.inConstruct,!0)&&!FC(e,n.notInConstruct,!1)}function FC(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function $C(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&OB(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function LB(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function FB(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function $B(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function zB(e,n,t,r){const a=$B(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(FB(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,BB);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(LB(o,a)+1,3)),u=t.enter("codeFenced");let h=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=d.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=d.move(" "),h+=d.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...d.current()})),g()}return h+=d.move(`
`),o&&(h+=d.move(o+`
`)),h+=d.move(f),u(),h}function BB(e,n,t){return(t?"":"    ")+e}function Vw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function UB(e,n,t,r){const a=Vw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function qB(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function rg(e){return"&#x"+e.toString(16).toUpperCase()+";"}function lb(e,n,t){const r=Uh(e),a=Uh(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}D2.peek=VB;function D2(e,n,t,r){const a=qB(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=lb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=rg(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=lb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+rg(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function VB(e,n,t){return t.options.emphasis||"*"}function HB(e,n){let t=!1;return qw(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,A1}),!!((!e.depth||e.depth<3)&&Ow(e)&&(n.options.setext||t))}function GB(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(HB(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=rg(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}I2.peek=YB;function I2(e){return e.value||""}function YB(){return"<"}R2.peek=WB;function R2(e,n,t,r){const a=Vw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function WB(){return"!"}M2.peek=QB;function M2(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function QB(){return"!"}O2.peek=JB;function O2(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function JB(){return"`"}function L2(e,n){const t=Ow(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}F2.peek=KB;function F2(e,n,t,r){const a=Vw(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(L2(e,t)){const h=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=h,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function KB(e,n,t){return L2(e,t)?"<":"["}$2.peek=XB;function $2(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function XB(){return"["}function Hw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function ZB(e){const n=Hw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function eU(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function z2(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function tU(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?eU(t):Hw(t);const d=e.ordered?l==="."?")":".":ZB(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),z2(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function nU(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function rU(e,n,t,r){const a=nU(t);let o=t.bulletCurrent||Hw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),h);return f(),u;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function iU(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const aU=zb(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function sU(e,n,t,r){return(e.children.some(function(l){return aU(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function oU(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}B2.peek=lU;function B2(e,n,t,r){const a=oU(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=lb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=rg(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=lb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+rg(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function lU(e,n,t){return t.options.strong||"*"}function cU(e,n,t,r){return t.safe(e.value,r)}function uU(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function dU(e,n,t){const r=(z2(t)+(t.options.ruleSpaces?" ":"")).repeat(uU(t));return t.options.ruleSpaces?r.slice(0,-1):r}const U2={blockquote:RB,break:$C,code:zB,definition:UB,emphasis:D2,hardBreak:$C,heading:GB,html:I2,image:R2,imageReference:M2,inlineCode:O2,link:F2,linkReference:$2,list:tU,listItem:rU,paragraph:iU,root:sU,strong:B2,text:cU,thematicBreak:dU};function fU(){return{enter:{table:hU,tableData:zC,tableHeader:zC,tableRow:mU},exit:{codeText:gU,table:pU,tableData:S0,tableHeader:S0,tableRow:S0}}}function hU(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function pU(e){this.exit(e),this.data.inTable=void 0}function mU(e){this.enter({type:"tableRow",children:[]},e)}function S0(e){this.exit(e)}function zC(e){this.enter({type:"tableCell",children:[]},e)}function gU(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,yU));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function yU(e,n){return n==="|"?n:e}function xU(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,o=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:f,tableRow:d}};function l(v,S,k,T){return u(h(v,k,T),v.align)}function d(v,S,k,T){const P=g(v,k,T),M=u([P]);return M.slice(0,M.indexOf(`
`))}function f(v,S,k,T){const P=k.enter("tableCell"),M=k.enter("phrasing"),R=k.containerPhrasing(v,{...T,before:o,after:o});return M(),P(),R}function u(v,S){return DB(v,{align:S,alignDelimiters:r,padding:t,stringLength:a})}function h(v,S,k){const T=v.children;let P=-1;const M=[],R=S.enter("table");for(;++P<T.length;)M[P]=g(T[P],S,k);return R(),M}function g(v,S,k){const T=v.children;let P=-1;const M=[],R=S.enter("tableRow");for(;++P<T.length;)M[P]=f(T[P],v,S,k);return R(),M}function b(v,S,k){let T=U2.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function bU(){return{exit:{taskListCheckValueChecked:BC,taskListCheckValueUnchecked:BC,paragraph:wU}}}function vU(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:SU}}}function BC(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function wU(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let o=-1,l;for(;++o<a.length;){const d=a[o];if(d.type==="paragraph"){l=d;break}}l===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function SU(e,n,t,r){const a=e.children[0],o=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",d=t.createTracker(r);o&&d.move(l);let f=U2.listItem(e,n,t,{...r,...d.current()});return o&&(f=f.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),f;function u(h){return h+l}}function NU(){return[tB(),SB(),jB(),fU(),bU()]}function CU(e){return{extensions:[nB(),NB(e),kB(),xU(e),vU()]}}const _U={tokenize:PU,partial:!0},q2={tokenize:DU,partial:!0},V2={tokenize:IU,partial:!0},H2={tokenize:RU,partial:!0},jU={tokenize:MU,partial:!0},G2={name:"wwwAutolink",tokenize:EU,previous:W2},Y2={name:"protocolAutolink",tokenize:AU,previous:Q2},Xl={name:"emailAutolink",tokenize:TU,previous:J2},ll={};function kU(){return{text:ll}}let Rd=48;for(;Rd<123;)ll[Rd]=Xl,Rd++,Rd===58?Rd=65:Rd===91&&(Rd=97);ll[43]=Xl;ll[45]=Xl;ll[46]=Xl;ll[95]=Xl;ll[72]=[Xl,Y2];ll[104]=[Xl,Y2];ll[87]=[Xl,G2];ll[119]=[Xl,G2];function TU(e,n,t){const r=this;let a,o;return l;function l(g){return!R1(g)||!J2.call(r,r.previous)||Gw(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),d(g))}function d(g){return R1(g)?(e.consume(g),d):g===64?(e.consume(g),f):t(g)}function f(g){return g===46?e.check(jU,h,u)(g):g===45||g===95||Oi(g)?(o=!0,e.consume(g),f):h(g)}function u(g){return e.consume(g),a=!0,f}function h(g){return o&&a&&Ki(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function EU(e,n,t){const r=this;return a;function a(l){return l!==87&&l!==119||!W2.call(r,r.previous)||Gw(r.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(_U,e.attempt(q2,e.attempt(V2,o),t),t)(l))}function o(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function AU(e,n,t){const r=this;let a="",o=!1;return l;function l(g){return(g===72||g===104)&&Q2.call(r,r.previous)&&!Gw(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),d):t(g)}function d(g){if(Ki(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),d;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),f}return t(g)}function f(g){return g===47?(e.consume(g),o?u:(o=!0,f)):t(g)}function u(g){return g===null||ab(g)||tr(g)||Vd(g)||Lb(g)?t(g):e.attempt(q2,e.attempt(V2,h),t)(g)}function h(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function PU(e,n,t){let r=0;return a;function a(l){return(l===87||l===119)&&r<3?(r++,e.consume(l),a):l===46&&r===3?(e.consume(l),o):t(l)}function o(l){return l===null?t(l):n(l)}}function DU(e,n,t){let r,a,o;return l;function l(u){return u===46||u===95?e.check(H2,f,d)(u):u===null||tr(u)||Vd(u)||u!==45&&Lb(u)?f(u):(o=!0,e.consume(u),l)}function d(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),l}function f(u){return a||r||!o?t(u):n(u)}}function IU(e,n){let t=0,r=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&r<t?o(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(H2,n,o)(l):l===null||tr(l)||Vd(l)?n(l):(e.consume(l),a)}function o(l){return l===41&&r++,e.consume(l),a}}function RU(e,n,t){return r;function r(d){return d===33||d===34||d===39||d===41||d===42||d===44||d===46||d===58||d===59||d===63||d===95||d===126?(e.consume(d),r):d===38?(e.consume(d),o):d===93?(e.consume(d),a):d===60||d===null||tr(d)||Vd(d)?n(d):t(d)}function a(d){return d===null||d===40||d===91||tr(d)||Vd(d)?n(d):r(d)}function o(d){return Ki(d)?l(d):t(d)}function l(d){return d===59?(e.consume(d),r):Ki(d)?(e.consume(d),l):t(d)}}function MU(e,n,t){return r;function r(o){return e.consume(o),a}function a(o){return Oi(o)?t(o):n(o)}}function W2(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||tr(e)}function Q2(e){return!Ki(e)}function J2(e){return!(e===47||R1(e))}function R1(e){return e===43||e===45||e===46||e===95||Oi(e)}function Gw(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const OU={tokenize:VU,partial:!0};function LU(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:BU,continuation:{tokenize:UU},exit:qU}},text:{91:{name:"gfmFootnoteCall",tokenize:zU},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:FU,resolveTo:$U}}}}function FU(e,n,t){const r=this;let a=r.events.length;const o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l;for(;a--;){const f=r.events[a][1];if(f.type==="labelImage"){l=f;break}if(f.type==="gfmFootnoteCall"||f.type==="labelLink"||f.type==="label"||f.type==="image"||f.type==="link")break}return d;function d(f){if(!l||!l._balanced)return t(f);const u=no(r.sliceSerialize({start:l.end,end:r.now()}));return u.codePointAt(0)!==94||!o.includes(u.slice(1))?t(f):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(f),e.exit("gfmFootnoteCallLabelMarker"),n(f))}}function $U(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},d=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",o,n],["enter",l,n],["exit",l,n],["exit",o,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...d),e}function zU(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o=0,l;return d;function d(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),f}function f(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(g){if(o>999||g===93&&!l||g===null||g===91||tr(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(no(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return tr(g)||(l=!0),o++,e.consume(g),g===92?h:u}function h(g){return g===91||g===92||g===93?(e.consume(g),o++,u):u(g)}}function BU(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o,l=0,d;return f;function f(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):t(S)}function h(S){if(l>999||S===93&&!d||S===null||S===91||tr(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return o=no(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return tr(S)||(d=!0),l++,e.consume(S),S===92?g:h}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,h):h(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(o)||a.push(o),En(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function UU(e,n,t){return e.check(mg,n,e.attempt(OU,n,t))}function qU(e){e.exit("gfmFootnoteDefinition")}function VU(e,n,t){const r=this;return En(e,a,"gfmFootnoteDefinitionIndent",5);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(o):t(o)}}function HU(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:o,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(l,d){let f=-1;for(;++f<l.length;)if(l[f][0]==="enter"&&l[f][1].type==="strikethroughSequenceTemporary"&&l[f][1]._close){let u=f;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[f][1].end.offset-l[f][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[f][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[f][1].end)},g={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[f][1].start)},b=[["enter",h,d],["enter",l[u][1],d],["exit",l[u][1],d],["enter",g,d]],v=d.parser.constructs.insideSpan.null;v&&Ha(b,b.length,0,Fb(v,l.slice(u+1,f),d)),Ha(b,b.length,0,[["exit",g,d],["enter",l[f][1],d],["exit",l[f][1],d],["exit",h,d]]),Ha(l,u-1,f-u+3,b),f=u+b.length-2;break}}for(f=-1;++f<l.length;)l[f][1].type==="strikethroughSequenceTemporary"&&(l[f][1].type="data");return l}function o(l,d,f){const u=this.previous,h=this.events;let g=0;return b;function b(S){return u===126&&h[h.length-1][1].type!=="characterEscape"?f(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=Uh(u);if(S===126)return g>1?f(S):(l.consume(S),g++,v);if(g<2&&!t)return f(S);const T=l.exit("strikethroughSequenceTemporary"),P=Uh(S);return T._open=!P||P===2&&!!k,T._close=!k||k===2&&!!P,d(S)}}}class GU{constructor(){this.map=[]}add(n,t,r){YU(this,n,t,r)}consume(n){if(this.map.sort(function(o,l){return o[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const o of a)n.push(o);a=r.pop()}this.map.length=0}}function YU(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function WU(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const o=r.length-1;r[o]=r[o]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function QU(){return{flow:{null:{name:"table",tokenize:JU,resolveAll:KU}}}}function JU(e,n,t){const r=this;let a=0,o=0,l;return d;function d(I){let F=r.events.length-1;for(;F>-1;){const ie=r.events[F][1].type;if(ie==="lineEnding"||ie==="linePrefix")F--;else break}const V=F>-1?r.events[F][1].type:null,ee=V==="tableHead"||V==="tableRow"?L:f;return ee===L&&r.parser.lazy[r.now().line]?t(I):ee(I)}function f(I){return e.enter("tableHead"),e.enter("tableRow"),u(I)}function u(I){return I===124||(l=!0,o+=1),h(I)}function h(I){return I===null?t(I):Ft(I)?o>1?(o=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),v):t(I):xn(I)?En(e,h,"whitespace")(I):(o+=1,l&&(l=!1,a+=1),I===124?(e.enter("tableCellDivider"),e.consume(I),e.exit("tableCellDivider"),l=!0,h):(e.enter("data"),g(I)))}function g(I){return I===null||I===124||tr(I)?(e.exit("data"),h(I)):(e.consume(I),I===92?b:g)}function b(I){return I===92||I===124?(e.consume(I),g):g(I)}function v(I){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(I):(e.enter("tableDelimiterRow"),l=!1,xn(I)?En(e,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(I):S(I))}function S(I){return I===45||I===58?T(I):I===124?(l=!0,e.enter("tableCellDivider"),e.consume(I),e.exit("tableCellDivider"),k):$(I)}function k(I){return xn(I)?En(e,T,"whitespace")(I):T(I)}function T(I){return I===58?(o+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(I),e.exit("tableDelimiterMarker"),P):I===45?(o+=1,P(I)):I===null||Ft(I)?z(I):$(I)}function P(I){return I===45?(e.enter("tableDelimiterFiller"),M(I)):$(I)}function M(I){return I===45?(e.consume(I),M):I===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(I),e.exit("tableDelimiterMarker"),R):(e.exit("tableDelimiterFiller"),R(I))}function R(I){return xn(I)?En(e,z,"whitespace")(I):z(I)}function z(I){return I===124?S(I):I===null||Ft(I)?!l||a!==o?$(I):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(I)):$(I)}function $(I){return t(I)}function L(I){return e.enter("tableRow"),B(I)}function B(I){return I===124?(e.enter("tableCellDivider"),e.consume(I),e.exit("tableCellDivider"),B):I===null||Ft(I)?(e.exit("tableRow"),n(I)):xn(I)?En(e,B,"whitespace")(I):(e.enter("data"),q(I))}function q(I){return I===null||I===124||tr(I)?(e.exit("data"),B(I)):(e.consume(I),I===92?W:q)}function W(I){return I===92||I===124?(e.consume(I),q):q(I)}}function KU(e,n){let t=-1,r=!0,a=0,o=[0,0,0,0],l=[0,0,0,0],d=!1,f=0,u,h,g;const b=new GU;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(d=!1,f!==0&&(UC(b,n,f,u,h),h=void 0,f=0),u={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",u,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(r=!0,g=void 0,o=[0,0,0,0],l=[0,t+1,0,0],d&&(d=!1,h={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",h,n]])),a=S.type==="tableDelimiterRow"?2:h?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(r=!1,l[2]===0&&(o[1]!==0&&(l[0]=l[1],g=Cx(b,n,o,a,void 0,g),o=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(r?r=!1:(o[1]!==0&&(l[0]=l[1],g=Cx(b,n,o,a,void 0,g)),o=l,l=[o[1],t,0,0])):S.type==="tableHead"?(d=!0,f=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(f=t,o[1]!==0?(l[0]=l[1],g=Cx(b,n,o,a,t,g)):l[1]!==0&&(g=Cx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(f!==0&&UC(b,n,f,u,h),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=WU(n.events,t))}return e}function Cx(e,n,t,r,a,o){const l=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",d="tableContent";t[0]!==0&&(o.end=Object.assign({},Th(n.events,t[0])),e.add(t[0],0,[["exit",o,n]]));const f=Th(n.events,t[1]);if(o={type:l,start:Object.assign({},f),end:Object.assign({},f)},e.add(t[1],0,[["enter",o,n]]),t[2]!==0){const u=Th(n.events,t[2]),h=Th(n.events,t[3]),g={type:d,start:Object.assign({},u),end:Object.assign({},h)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(o.end=Object.assign({},Th(n.events,a)),e.add(a,0,[["exit",o,n]]),o=void 0),o}function UC(e,n,t,r,a){const o=[],l=Th(n.events,t);a&&(a.end=Object.assign({},l),o.push(["exit",a,n])),r.end=Object.assign({},l),o.push(["exit",r,n]),e.add(t+1,0,o)}function Th(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const XU={name:"tasklistCheck",tokenize:e7};function ZU(){return{text:{91:XU}}}function e7(e,n,t){const r=this;return a;function a(f){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(f):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),o)}function o(f){return tr(f)?(e.enter("taskListCheckValueUnchecked"),e.consume(f),e.exit("taskListCheckValueUnchecked"),l):f===88||f===120?(e.enter("taskListCheckValueChecked"),e.consume(f),e.exit("taskListCheckValueChecked"),l):t(f)}function l(f){return f===93?(e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),d):t(f)}function d(f){return Ft(f)?n(f):xn(f)?e.check({tokenize:t7},n,t)(f):t(f)}}function t7(e,n,t){return En(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function n7(e){return s2([kU(),LU(),HU(e),QU(),ZU()])}const r7={};function Ua(e){const n=this,t=e||r7,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),o=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),l=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(n7(t)),o.push(NU()),l.push(CU(t))}const i7="_container_plki7_3",a7="_header_plki7_21",s7="_titleGroup_plki7_41",o7="_title_plki7_41",l7="_closeButton_plki7_59",c7="_messageList_plki7_79",u7="_emptyState_plki7_108",d7="_emptyStateIcon_plki7_119",f7="_exampleContainer_plki7_145",h7="_exampleChip_plki7_153",p7="_messageRow_plki7_176",m7="_messageRowUser_plki7_194",g7="_messageRowModel_plki7_198",y7="_messageRowSystem_plki7_202",x7="_bubble_plki7_208",b7="_bubbleUser_plki7_224",v7="_bubbleModel_plki7_234",w7="_bubbleSystem_plki7_247",S7="_processingIndicator_plki7_330",N7="_spin_plki7_343",C7="_inputArea_plki7_358",_7="_imagePreviewContainer_plki7_365",j7="_inputContainer_plki7_376",k7="_inputField_plki7_393",T7="_sendButton_plki7_407",Un={container:i7,header:a7,titleGroup:s7,title:o7,closeButton:l7,messageList:c7,emptyState:u7,emptyStateIcon:d7,exampleContainer:f7,exampleChip:h7,messageRow:p7,messageRowUser:m7,messageRowModel:g7,messageRowSystem:y7,bubble:x7,bubbleUser:b7,bubbleModel:v7,bubbleSystem:w7,processingIndicator:S7,spin:N7,inputArea:C7,imagePreviewContainer:_7,inputContainer:j7,inputField:k7,sendButton:T7},K2=({onClose:e,settings:n,staffList:t,onSettingsUpdate:r,onStaffUpdate:a,onHighlight:o})=>{const{chatQuery:l,setChatQuery:d,chatHistory:f,isProcessing:u,handleSendMessage:h,refreshChat:g,stopGeneration:b,selectedImage:v,handleImageSelect:S,clearImage:k}=jw({settings:n,staffList:t,onSettingsUpdate:r,onStaffUpdate:a,onHighlight:o}),T=w.useRef(null),P=w.useRef(null),M=()=>{var L;(L=T.current)==null||L.scrollIntoView({behavior:"smooth"})};w.useEffect(()=>{M()},[f,u]);const R=L=>{var q;const B=(q=L.target.files)==null?void 0:q[0];B&&S(B)},z=["Check Paracetamol stock","Go to Pharmacy","Analysis for last month","Add nurse Sarah"],$=L=>{d(L)};return i.jsxs("div",{className:Un.container,children:[i.jsxs("header",{className:Un.header,children:[i.jsxs("div",{className:Un.titleGroup,children:[i.jsx(eg,{size:20,className:"text-violet-600"}),i.jsx("h3",{className:Un.title,children:"Clinic Assistant"})]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[i.jsx("button",{onClick:g,className:Un.closeButton,title:"Refresh Chat",children:i.jsx(Uk,{size:18})}),i.jsx("button",{onClick:e,className:Un.closeButton,title:"Close",children:i.jsx(_n,{size:20})})]})]}),i.jsxs("div",{className:Un.messageList,children:[f.length===0&&i.jsxs("div",{className:Un.emptyState,children:[i.jsx(eg,{size:48,className:Un.emptyStateIcon}),i.jsx("p",{children:"How can I help you manage the clinic today?"}),i.jsx("div",{className:Un.exampleContainer,children:z.map((L,B)=>i.jsx("button",{className:Un.exampleChip,onClick:()=>$(L),children:L},B))})]}),f.map((L,B)=>i.jsx("div",{className:`${Un.messageRow} ${L.role==="user"?Un.messageRowUser:L.role==="model"?Un.messageRowModel:Un.messageRowSystem}`,children:i.jsx("div",{className:`${Un.bubble} ${L.role==="user"?Un.bubbleUser:L.role==="model"?Un.bubbleModel:Un.bubbleSystem}`,children:L.role==="user"||L.role==="system"?L.text:i.jsx(ws,{remarkPlugins:[Ua],children:L.text})})},B)),u&&i.jsx("div",{className:`${Un.messageRow} ${Un.messageRowModel}`,children:i.jsxs("div",{className:Un.processingIndicator,children:[i.jsx(ao,{size:14,className:Un.spin}),"Thinking..."]})}),i.jsx("div",{ref:T})]}),i.jsxs("div",{className:Un.inputArea,children:[v&&i.jsxs("div",{className:Un.imagePreviewContainer,style:{marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("div",{style:{position:"relative",width:"60px",height:"60px",border:"1px solid #e5e7eb",borderRadius:"4px",overflow:"hidden"},children:[i.jsx("img",{src:v,alt:"Selected",style:{width:"100%",height:"100%",objectFit:"cover"}}),i.jsx("button",{onClick:k,style:{position:"absolute",top:0,right:0,background:"rgba(0,0,0,0.5)",color:"white",border:"none",cursor:"pointer",padding:"1px"},children:i.jsx(_n,{size:12})})]}),i.jsx("span",{style:{fontSize:"0.8rem",color:"#6b7280"},children:"Image attached"})]}),i.jsxs("div",{className:Un.inputContainer,children:[i.jsx("input",{type:"file",ref:P,onChange:R,accept:"image/*",style:{display:"none"}}),i.jsx("button",{className:Un.sendButton,onClick:()=>{var L;return(L=P.current)==null?void 0:L.click()},disabled:u,title:"Attach Image",style:{marginRight:"0.5rem",color:"#6b7280"},children:i.jsx(Rb,{size:18})}),i.jsx("input",{type:"text",className:Un.inputField,placeholder:"Type your request...",value:l,onChange:L=>d(L.target.value),onKeyDown:L=>L.key==="Enter"&&!u&&h(),disabled:u,autoFocus:!0}),u?i.jsx("button",{className:Un.sendButton,onClick:b,title:"Stop Generating",style:{color:"#ef4444"},children:i.jsx(m6,{size:18,fill:"currentColor"})}):i.jsx("button",{className:Un.sendButton,onClick:()=>h(),disabled:!l.trim()&&!v,children:i.jsx(Mb,{size:18})})]})]})]})};var N0,qC;function E7(){if(qC)return N0;qC=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,f=typeof lu=="object"&&lu&&lu.Object===Object&&lu,u=typeof self=="object"&&self&&self.Object===Object&&self,h=f||u||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return h.Date.now()};function T($,L,B){var q,W,I,F,V,ee,ie=0,Y=!1,Q=!1,ne=!0;if(typeof $!="function")throw new TypeError(e);L=z(L)||0,P(B)&&(Y=!!B.leading,Q="maxWait"in B,I=Q?v(z(B.maxWait)||0,L):I,ne="trailing"in B?!!B.trailing:ne);function le(K){var J=q,xe=W;return q=W=void 0,ie=K,F=$.apply(xe,J),F}function oe(K){return ie=K,V=setTimeout(he,L),Y?le(K):F}function E(K){var J=K-ee,xe=K-ie,He=L-J;return Q?S(He,I-xe):He}function de(K){var J=K-ee,xe=K-ie;return ee===void 0||J>=L||J<0||Q&&xe>=I}function he(){var K=k();if(de(K))return D(K);V=setTimeout(he,E(K))}function D(K){return V=void 0,ne&&q?le(K):(q=W=void 0,F)}function me(){V!==void 0&&clearTimeout(V),ie=0,q=ee=W=V=void 0}function Ce(){return V===void 0?F:D(k())}function te(){var K=k(),J=de(K);if(q=arguments,W=this,ee=K,J){if(V===void 0)return oe(ee);if(Q)return V=setTimeout(he,L),le(ee)}return V===void 0&&(V=setTimeout(he,L)),F}return te.cancel=me,te.flush=Ce,te}function P($){var L=typeof $;return!!$&&(L=="object"||L=="function")}function M($){return!!$&&typeof $=="object"}function R($){return typeof $=="symbol"||M($)&&b.call($)==t}function z($){if(typeof $=="number")return $;if(R($))return n;if(P($)){var L=typeof $.valueOf=="function"?$.valueOf():$;$=P(L)?L+"":L}if(typeof $!="string")return $===0?$:+$;$=$.replace(r,"");var B=o.test($);return B||l.test($)?d($.slice(2),B?2:8):a.test($)?n:+$}return N0=T,N0}var A7=E7();const yg=Wd(A7);var C0={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var VC;function P7(){return VC||(VC=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var d=arguments[l];d&&(o=a(o,r(d)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var d in o)n.call(o,d)&&o[d]&&(l=a(l,d));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(C0)),C0.exports}var D7=P7();const cu=Wd(D7);function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Hd(e)}function I7(e,n){if(Hd(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(Hd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function X2(e){var n=I7(e,"string");return Hd(n)=="symbol"?n:n+""}function qm(e,n,t){return(n=X2(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function HC(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function $t(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?HC(Object(t),!0).forEach(function(r){qm(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):HC(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function R7(e){if(Array.isArray(e))return e}function M7(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,o,l,d=[],f=!0,u=!1;try{if(o=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;f=!1}else for(;!(f=(r=o.call(t)).done)&&(d.push(r.value),d.length!==n);f=!0);}catch(h){u=!0,a=h}finally{try{if(!f&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return d}}function M1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function Z2(e,n){if(e){if(typeof e=="string")return M1(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?M1(e,n):void 0}}function O7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wl(e,n){return R7(e)||M7(e,n)||Z2(e,n)||O7()}function L7(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Zl(e,n){if(e==null)return{};var t,r,a=L7(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var F7=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function $7(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,o=e.defaultValue,l=o===void 0?null:o,d=e.inputValue,f=e.menuIsOpen,u=e.onChange,h=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=Zl(e,F7),k=w.useState(d!==void 0?d:t),T=Wl(k,2),P=T[0],M=T[1],R=w.useState(f!==void 0?f:a),z=Wl(R,2),$=z[0],L=z[1],B=w.useState(v!==void 0?v:l),q=Wl(B,2),W=q[0],I=q[1],F=w.useCallback(function(le,oe){typeof u=="function"&&u(le,oe),I(le)},[u]),V=w.useCallback(function(le,oe){var E;typeof h=="function"&&(E=h(le,oe)),M(E!==void 0?E:le)},[h]),ee=w.useCallback(function(){typeof b=="function"&&b(),L(!0)},[b]),ie=w.useCallback(function(){typeof g=="function"&&g(),L(!1)},[g]),Y=d!==void 0?d:P,Q=f!==void 0?f:$,ne=v!==void 0?v:W;return $t($t({},S),{},{inputValue:Y,menuIsOpen:Q,onChange:F,onInputChange:V,onMenuClose:ie,onMenuOpen:ee,value:ne})}function Ut(){return Ut=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Ut.apply(null,arguments)}function z7(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function GC(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,X2(r.key),r)}}function B7(e,n,t){return n&&GC(e.prototype,n),t&&GC(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function O1(e,n){return O1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},O1(e,n)}function U7(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&O1(e,n)}function cb(e){return cb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},cb(e)}function eT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eT=function(){return!!e})()}function q7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V7(e,n){if(n&&(Hd(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q7(e)}function H7(e){var n=eT();return function(){var t,r=cb(e);if(n){var a=cb(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return V7(this,t)}}function G7(e){if(Array.isArray(e))return M1(e)}function Y7(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function W7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yw(e){return G7(e)||Y7(e)||Z2(e)||W7()}function Q7(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function J7(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var K7=function(){function e(t){var r=this;this._insertTag=function(a){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,o),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(J7(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var o=Q7(a);try{o.insertRule(r,o.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Ii="-ms-",ub="-moz-",Ln="-webkit-",tT="comm",Ww="rule",Qw="decl",X7="@import",nT="@keyframes",Z7="@layer",e9=Math.abs,Ub=String.fromCharCode,t9=Object.assign;function n9(e,n){return vi(e,0)^45?(((n<<2^vi(e,0))<<2^vi(e,1))<<2^vi(e,2))<<2^vi(e,3):0}function rT(e){return e.trim()}function r9(e,n){return(e=n.exec(e))?e[0]:e}function Fn(e,n,t){return e.replace(n,t)}function L1(e,n){return e.indexOf(n)}function vi(e,n){return e.charCodeAt(n)|0}function ig(e,n,t){return e.slice(n,t)}function Zo(e){return e.length}function Jw(e){return e.length}function _x(e,n){return n.push(e),e}function i9(e,n){return e.map(n).join("")}var qb=1,qh=1,iT=0,ga=0,Vr=0,Zh="";function Vb(e,n,t,r,a,o,l){return{value:e,root:n,parent:t,type:r,props:a,children:o,line:qb,column:qh,length:l,return:""}}function Rm(e,n){return t9(Vb("",null,null,"",null,null,0),e,{length:-e.length},n)}function a9(){return Vr}function s9(){return Vr=ga>0?vi(Zh,--ga):0,qh--,Vr===10&&(qh=1,qb--),Vr}function Ga(){return Vr=ga<iT?vi(Zh,ga++):0,qh++,Vr===10&&(qh=1,qb++),Vr}function il(){return vi(Zh,ga)}function Yx(){return ga}function xg(e,n){return ig(Zh,e,n)}function ag(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function aT(e){return qb=qh=1,iT=Zo(Zh=e),ga=0,[]}function sT(e){return Zh="",e}function Wx(e){return rT(xg(ga-1,F1(e===91?e+2:e===40?e+1:e)))}function o9(e){for(;(Vr=il())&&Vr<33;)Ga();return ag(e)>2||ag(Vr)>3?"":" "}function l9(e,n){for(;--n&&Ga()&&!(Vr<48||Vr>102||Vr>57&&Vr<65||Vr>70&&Vr<97););return xg(e,Yx()+(n<6&&il()==32&&Ga()==32))}function F1(e){for(;Ga();)switch(Vr){case e:return ga;case 34:case 39:e!==34&&e!==39&&F1(Vr);break;case 40:e===41&&F1(e);break;case 92:Ga();break}return ga}function c9(e,n){for(;Ga()&&e+Vr!==57;)if(e+Vr===84&&il()===47)break;return"/*"+xg(n,ga-1)+"*"+Ub(e===47?e:Ga())}function u9(e){for(;!ag(il());)Ga();return xg(e,ga)}function d9(e){return sT(Qx("",null,null,null,[""],e=aT(e),0,[0],e))}function Qx(e,n,t,r,a,o,l,d,f){for(var u=0,h=0,g=l,b=0,v=0,S=0,k=1,T=1,P=1,M=0,R="",z=a,$=o,L=r,B=R;T;)switch(S=M,M=Ga()){case 40:if(S!=108&&vi(B,g-1)==58){L1(B+=Fn(Wx(M),"&","&\f"),"&\f")!=-1&&(P=-1);break}case 34:case 39:case 91:B+=Wx(M);break;case 9:case 10:case 13:case 32:B+=o9(S);break;case 92:B+=l9(Yx()-1,7);continue;case 47:switch(il()){case 42:case 47:_x(f9(c9(Ga(),Yx()),n,t),f);break;default:B+="/"}break;case 123*k:d[u++]=Zo(B)*P;case 125*k:case 59:case 0:switch(M){case 0:case 125:T=0;case 59+h:P==-1&&(B=Fn(B,/\f/g,"")),v>0&&Zo(B)-g&&_x(v>32?WC(B+";",r,t,g-1):WC(Fn(B," ","")+";",r,t,g-2),f);break;case 59:B+=";";default:if(_x(L=YC(B,n,t,u,h,a,d,R,z=[],$=[],g),o),M===123)if(h===0)Qx(B,n,L,L,z,o,g,d,$);else switch(b===99&&vi(B,3)===110?100:b){case 100:case 108:case 109:case 115:Qx(e,L,L,r&&_x(YC(e,L,L,0,0,a,d,R,a,z=[],g),$),a,$,g,d,r?z:$);break;default:Qx(B,L,L,L,[""],$,0,d,$)}}u=h=v=0,k=P=1,R=B="",g=l;break;case 58:g=1+Zo(B),v=S;default:if(k<1){if(M==123)--k;else if(M==125&&k++==0&&s9()==125)continue}switch(B+=Ub(M),M*k){case 38:P=h>0?1:(B+="\f",-1);break;case 44:d[u++]=(Zo(B)-1)*P,P=1;break;case 64:il()===45&&(B+=Wx(Ga())),b=il(),h=g=Zo(R=B+=u9(Yx())),M++;break;case 45:S===45&&Zo(B)==2&&(k=0)}}return o}function YC(e,n,t,r,a,o,l,d,f,u,h){for(var g=a-1,b=a===0?o:[""],v=Jw(b),S=0,k=0,T=0;S<r;++S)for(var P=0,M=ig(e,g+1,g=e9(k=l[S])),R=e;P<v;++P)(R=rT(k>0?b[P]+" "+M:Fn(M,/&\f/g,b[P])))&&(f[T++]=R);return Vb(e,n,t,a===0?Ww:d,f,u,h)}function f9(e,n,t){return Vb(e,n,t,tT,Ub(a9()),ig(e,2,-2),0)}function WC(e,n,t,r){return Vb(e,n,t,Qw,ig(e,0,r),ig(e,r+1,-1),r)}function Ih(e,n){for(var t="",r=Jw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function h9(e,n,t,r){switch(e.type){case Z7:if(e.children.length)break;case X7:case Qw:return e.return=e.return||e.value;case tT:return"";case nT:return e.return=e.value+"{"+Ih(e.children,r)+"}";case Ww:e.value=e.props.join(",")}return Zo(t=Ih(e.children,r))?e.return=e.value+"{"+t+"}":""}function p9(e){var n=Jw(e);return function(t,r,a,o){for(var l="",d=0;d<n;d++)l+=e[d](t,r,a,o)||"";return l}}function m9(e){return function(n){n.root||(n=n.return)&&e(n)}}function g9(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var y9=function(n,t,r){for(var a=0,o=0;a=o,o=il(),a===38&&o===12&&(t[r]=1),!ag(o);)Ga();return xg(n,ga)},x9=function(n,t){var r=-1,a=44;do switch(ag(a)){case 0:a===38&&il()===12&&(t[r]=1),n[r]+=y9(ga-1,t,r);break;case 2:n[r]+=Wx(a);break;case 4:if(a===44){n[++r]=il()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Ub(a)}while(a=Ga());return n},b9=function(n,t){return sT(x9(aT(n),t))},QC=new WeakMap,v9=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!QC.get(r))&&!a){QC.set(n,!0);for(var o=[],l=b9(t,o),d=r.props,f=0,u=0;f<l.length;f++)for(var h=0;h<d.length;h++,u++)n.props[u]=o[f]?l[f].replace(/&\f/g,d[h]):d[h]+" "+l[f]}}},w9=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function oT(e,n){switch(n9(e,n)){case 5103:return Ln+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ln+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Ln+e+ub+e+Ii+e+e;case 6828:case 4268:return Ln+e+Ii+e+e;case 6165:return Ln+e+Ii+"flex-"+e+e;case 5187:return Ln+e+Fn(e,/(\w+).+(:[^]+)/,Ln+"box-$1$2"+Ii+"flex-$1$2")+e;case 5443:return Ln+e+Ii+"flex-item-"+Fn(e,/flex-|-self/,"")+e;case 4675:return Ln+e+Ii+"flex-line-pack"+Fn(e,/align-content|flex-|-self/,"")+e;case 5548:return Ln+e+Ii+Fn(e,"shrink","negative")+e;case 5292:return Ln+e+Ii+Fn(e,"basis","preferred-size")+e;case 6060:return Ln+"box-"+Fn(e,"-grow","")+Ln+e+Ii+Fn(e,"grow","positive")+e;case 4554:return Ln+Fn(e,/([^-])(transform)/g,"$1"+Ln+"$2")+e;case 6187:return Fn(Fn(Fn(e,/(zoom-|grab)/,Ln+"$1"),/(image-set)/,Ln+"$1"),e,"")+e;case 5495:case 3959:return Fn(e,/(image-set\([^]*)/,Ln+"$1$`$1");case 4968:return Fn(Fn(e,/(.+:)(flex-)?(.*)/,Ln+"box-pack:$3"+Ii+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ln+e+e;case 4095:case 3583:case 4068:case 2532:return Fn(e,/(.+)-inline(.+)/,Ln+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Zo(e)-1-n>6)switch(vi(e,n+1)){case 109:if(vi(e,n+4)!==45)break;case 102:return Fn(e,/(.+:)(.+)-([^]+)/,"$1"+Ln+"$2-$3$1"+ub+(vi(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~L1(e,"stretch")?oT(Fn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(vi(e,n+1)!==115)break;case 6444:switch(vi(e,Zo(e)-3-(~L1(e,"!important")&&10))){case 107:return Fn(e,":",":"+Ln)+e;case 101:return Fn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ln+(vi(e,14)===45?"inline-":"")+"box$3$1"+Ln+"$2$3$1"+Ii+"$2box$3")+e}break;case 5936:switch(vi(e,n+11)){case 114:return Ln+e+Ii+Fn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Ln+e+Ii+Fn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Ln+e+Ii+Fn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Ln+e+Ii+e+e}return e}var S9=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case Qw:n.return=oT(n.value,n.length);break;case nT:return Ih([Rm(n,{value:Fn(n.value,"@","@"+Ln)})],a);case Ww:if(n.length)return i9(n.props,function(o){switch(r9(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ih([Rm(n,{props:[Fn(o,/:(read-\w+)/,":"+ub+"$1")]})],a);case"::placeholder":return Ih([Rm(n,{props:[Fn(o,/:(plac\w+)/,":"+Ln+"input-$1")]}),Rm(n,{props:[Fn(o,/:(plac\w+)/,":"+ub+"$1")]}),Rm(n,{props:[Fn(o,/:(plac\w+)/,Ii+"input-$1")]})],a)}return""})}},N9=[S9],C9=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||N9,o={},l,d=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),P=1;P<T.length;P++)o[T[P]]=!0;d.push(k)});var f,u=[v9,w9];{var h,g=[h9,m9(function(k){h.insert(k)})],b=p9(u.concat(a,g)),v=function(T){return Ih(d9(T),b)};f=function(T,P,M,R){h=M,v(T?T+"{"+P.styles+"}":P.styles),R&&(S.inserted[P.name]=!0)}}var S={key:t,sheet:new K7({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:o,registered:{},insert:f};return S.sheet.hydrate(d),S},_0={exports:{}},qn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JC;function _9(){if(JC)return qn;JC=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,P=e?Symbol.for("react.responder"):60118,M=e?Symbol.for("react.scope"):60119;function R($){if(typeof $=="object"&&$!==null){var L=$.$$typeof;switch(L){case n:switch($=$.type,$){case f:case u:case r:case o:case a:case g:return $;default:switch($=$&&$.$$typeof,$){case d:case h:case S:case v:case l:return $;default:return L}}case t:return L}}}function z($){return R($)===u}return qn.AsyncMode=f,qn.ConcurrentMode=u,qn.ContextConsumer=d,qn.ContextProvider=l,qn.Element=n,qn.ForwardRef=h,qn.Fragment=r,qn.Lazy=S,qn.Memo=v,qn.Portal=t,qn.Profiler=o,qn.StrictMode=a,qn.Suspense=g,qn.isAsyncMode=function($){return z($)||R($)===f},qn.isConcurrentMode=z,qn.isContextConsumer=function($){return R($)===d},qn.isContextProvider=function($){return R($)===l},qn.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===n},qn.isForwardRef=function($){return R($)===h},qn.isFragment=function($){return R($)===r},qn.isLazy=function($){return R($)===S},qn.isMemo=function($){return R($)===v},qn.isPortal=function($){return R($)===t},qn.isProfiler=function($){return R($)===o},qn.isStrictMode=function($){return R($)===a},qn.isSuspense=function($){return R($)===g},qn.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===r||$===u||$===o||$===a||$===g||$===b||typeof $=="object"&&$!==null&&($.$$typeof===S||$.$$typeof===v||$.$$typeof===l||$.$$typeof===d||$.$$typeof===h||$.$$typeof===T||$.$$typeof===P||$.$$typeof===M||$.$$typeof===k)},qn.typeOf=R,qn}var KC;function j9(){return KC||(KC=1,_0.exports=_9()),_0.exports}var j0,XC;function k9(){if(XC)return j0;XC=1;var e=j9(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[e.ForwardRef]=r,o[e.Memo]=a;function l(S){return e.isMemo(S)?a:o[S.$$typeof]||n}var d=Object.defineProperty,f=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,T){if(typeof k!="string"){if(b){var P=g(k);P&&P!==b&&v(S,P,T)}var M=f(k);u&&(M=M.concat(u(k)));for(var R=l(S),z=l(k),$=0;$<M.length;++$){var L=M[$];if(!t[L]&&!(T&&T[L])&&!(z&&z[L])&&!(R&&R[L])){var B=h(k,L);try{d(S,L,B)}catch{}}}}return S}return j0=v,j0}k9();var T9=!0;function E9(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var lT=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||T9===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},A9=function(n,t,r){lT(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var o=t;do n.insert(t===o?"."+a:"",o,n.sheet,!0),o=o.next;while(o!==void 0)}};function P9(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var D9={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},I9=/[A-Z]|^ms/g,R9=/_EMO_([^_]+?)_([^]*?)_EMO_/g,cT=function(n){return n.charCodeAt(1)===45},ZC=function(n){return n!=null&&typeof n!="boolean"},k0=g9(function(e){return cT(e)?e:e.replace(I9,"-$&").toLowerCase()}),e_=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(R9,function(r,a,o){return el={name:a,styles:o,next:el},a})}return D9[n]!==1&&!cT(n)&&typeof t=="number"&&t!==0?t+"px":t};function sg(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return el={name:a.name,styles:a.styles,next:el},a.name;var o=t;if(o.styles!==void 0){var l=o.next;if(l!==void 0)for(;l!==void 0;)el={name:l.name,styles:l.styles,next:el},l=l.next;var d=o.styles+";";return d}return M9(e,n,t)}case"function":{if(e!==void 0){var f=el,u=t(e);return el=f,sg(e,n,u)}break}}var h=t;return h}function M9(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=sg(e,n,t[a])+";";else for(var o in t){var l=t[o];if(typeof l!="object"){var d=l;ZC(d)&&(r+=k0(o)+":"+e_(o,d)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var f=0;f<l.length;f++)ZC(l[f])&&(r+=k0(o)+":"+e_(o,l[f])+";");else{var u=sg(e,n,l);switch(o){case"animation":case"animationName":{r+=k0(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var t_=/label:\s*([^\s;{]+)\s*(;|$)/g,el;function uT(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";el=void 0;var o=e[0];if(o==null||o.raw===void 0)r=!1,a+=sg(t,n,o);else{var l=o;a+=l[0]}for(var d=1;d<e.length;d++)if(a+=sg(t,n,e[d]),r){var f=o;a+=f[d]}t_.lastIndex=0;for(var u="",h;(h=t_.exec(a))!==null;)u+="-"+h[1];var g=P9(a)+u;return{name:g,styles:a,next:el}}var O9=function(n){return n()},L9=AS.useInsertionEffect?AS.useInsertionEffect:!1,F9=L9||O9,dT=w.createContext(typeof HTMLElement<"u"?C9({key:"css"}):null);dT.Provider;var $9=function(n){return w.forwardRef(function(t,r){var a=w.useContext(dT);return n(t,a,r)})},z9=w.createContext({}),Kw={}.hasOwnProperty,$1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",B9=function(n,t){var r={};for(var a in t)Kw.call(t,a)&&(r[a]=t[a]);return r[$1]=n,r},U9=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return lT(t,r,a),F9(function(){return A9(t,r,a)}),null},q9=$9(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[$1],o=[r],l="";typeof e.className=="string"?l=E9(n.registered,o,e.className):e.className!=null&&(l=e.className+" ");var d=uT(o,void 0,w.useContext(z9));l+=n.key+"-"+d.name;var f={};for(var u in e)Kw.call(e,u)&&u!=="css"&&u!==$1&&(f[u]=e[u]);return f.className=l,t&&(f.ref=t),w.createElement(w.Fragment,null,w.createElement(U9,{cache:n,serialized:d,isStringTag:typeof a=="string"}),w.createElement(a,f))}),V9=q9,Dt=function(n,t){var r=arguments;if(t==null||!Kw.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,o=new Array(a);o[0]=V9,o[1]=B9(n,t);for(var l=2;l<a;l++)o[l]=r[l];return w.createElement.apply(null,o)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(Dt||(Dt={}));function Xw(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return uT(n)}function H9(){var e=Xw.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function G9(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const Y9=Math.min,W9=Math.max,db=Math.round,jx=Math.floor,fb=e=>({x:e,y:e});function Q9(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function Hb(){return typeof window<"u"}function fT(e){return pT(e)?(e.nodeName||"").toLowerCase():"#document"}function Kl(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function hT(e){var n;return(n=(pT(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function pT(e){return Hb()?e instanceof Node||e instanceof Kl(e).Node:!1}function J9(e){return Hb()?e instanceof Element||e instanceof Kl(e).Element:!1}function Zw(e){return Hb()?e instanceof HTMLElement||e instanceof Kl(e).HTMLElement:!1}function n_(e){return!Hb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Kl(e).ShadowRoot}const K9=new Set(["inline","contents"]);function mT(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=eS(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!K9.has(a)}function X9(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Z9=new Set(["html","body","#document"]);function eq(e){return Z9.has(fT(e))}function eS(e){return Kl(e).getComputedStyle(e)}function tq(e){if(fT(e)==="html")return e;const n=e.assignedSlot||e.parentNode||n_(e)&&e.host||hT(e);return n_(n)?n.host:n}function gT(e){const n=tq(e);return eq(n)?e.ownerDocument?e.ownerDocument.body:e.body:Zw(n)&&mT(n)?n:gT(n)}function hb(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=gT(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Kl(a);if(o){const d=z1(l);return n.concat(l,l.visualViewport||[],mT(a)?a:[],d&&t?hb(d):[])}return n.concat(a,hb(a,[],t))}function z1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function nq(e){const n=eS(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Zw(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,d=db(t)!==o||db(r)!==l;return d&&(t=o,r=l),{width:t,height:r,$:d}}function tS(e){return J9(e)?e:e.contextElement}function r_(e){const n=tS(e);if(!Zw(n))return fb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=nq(n);let l=(o?db(t.width):t.width)/r,d=(o?db(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!d||!Number.isFinite(d))&&(d=1),{x:l,y:d}}const rq=fb(0);function iq(e){const n=Kl(e);return!X9()||!n.visualViewport?rq:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function aq(e,n,t){return!1}function i_(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=tS(e);let l=fb(1);n&&(l=r_(e));const d=aq()?iq(o):fb(0);let f=(a.left+d.x)/l.x,u=(a.top+d.y)/l.y,h=a.width/l.x,g=a.height/l.y;if(o){const b=Kl(o),v=r;let S=b,k=z1(S);for(;k&&r&&v!==S;){const T=r_(k),P=k.getBoundingClientRect(),M=eS(k),R=P.left+(k.clientLeft+parseFloat(M.paddingLeft))*T.x,z=P.top+(k.clientTop+parseFloat(M.paddingTop))*T.y;f*=T.x,u*=T.y,h*=T.x,g*=T.y,f+=R,u+=z,S=Kl(k),k=z1(S)}}return Q9({width:h,height:g,x:f,y:u})}function yT(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function sq(e,n){let t=null,r;const a=hT(e);function o(){var d;clearTimeout(r),(d=t)==null||d.disconnect(),t=null}function l(d,f){d===void 0&&(d=!1),f===void 0&&(f=1),o();const u=e.getBoundingClientRect(),{left:h,top:g,width:b,height:v}=u;if(d||n(),!b||!v)return;const S=jx(g),k=jx(a.clientWidth-(h+b)),T=jx(a.clientHeight-(g+v)),P=jx(h),R={rootMargin:-S+"px "+-k+"px "+-T+"px "+-P+"px",threshold:W9(0,Y9(1,f))||1};let z=!0;function $(L){const B=L[0].intersectionRatio;if(B!==f){if(!z)return l();B?l(!1,B):r=setTimeout(()=>{l(!1,1e-7)},1e3)}B===1&&!yT(u,e.getBoundingClientRect())&&l(),z=!1}try{t=new IntersectionObserver($,{...R,root:a.ownerDocument})}catch{t=new IntersectionObserver($,R)}t.observe(e)}return l(!0),o}function oq(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,u=tS(e),h=a||o?[...u?hb(u):[],...hb(n)]:[];h.forEach(P=>{a&&P.addEventListener("scroll",t,{passive:!0}),o&&P.addEventListener("resize",t)});const g=u&&d?sq(u,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(P=>{let[M]=P;M&&M.target===u&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var R;(R=v)==null||R.observe(n)})),t()}),u&&!f&&v.observe(u),v.observe(n));let S,k=f?i_(e):null;f&&T();function T(){const P=i_(e);k&&!yT(k,P)&&t(),k=P,S=requestAnimationFrame(T)}return t(),()=>{var P;h.forEach(M=>{a&&M.removeEventListener("scroll",t),o&&M.removeEventListener("resize",t)}),g==null||g(),(P=v)==null||P.disconnect(),v=null,f&&cancelAnimationFrame(S)}}var B1=w.useLayoutEffect,lq=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],pb=function(){};function cq(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function uq(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var o=[].concat(r);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&o.push("".concat(cq(e,l)));return o.filter(function(d){return d}).map(function(d){return String(d).trim()}).join(" ")}var a_=function(n){return bq(n)?n.filter(Boolean):Hd(n)==="object"&&n!==null?[n]:[]},xT=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=Zl(n,lq);return $t({},t)},Tr=function(n,t,r){var a=n.cx,o=n.getStyles,l=n.getClassNames,d=n.className;return{css:o(t,n),className:a(r??{},l(t,n),d)}};function Gb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function dq(e){return Gb(e)?window.innerHeight:e.clientHeight}function bT(e){return Gb(e)?window.pageYOffset:e.scrollTop}function mb(e,n){if(Gb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function fq(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function hq(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function kx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:pb,a=bT(e),o=n-a,l=10,d=0;function f(){d+=l;var u=hq(d,a,o,t);mb(e,u),d<t?window.requestAnimationFrame(f):r(e)}f()}function s_(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?mb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&mb(e,Math.max(n.offsetTop-a,0))}function pq(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function o_(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function mq(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var vT=!1,gq={get passive(){return vT=!0}},Tx=typeof window<"u"?window:{};Tx.addEventListener&&Tx.removeEventListener&&(Tx.addEventListener("p",pb,gq),Tx.removeEventListener("p",pb,!1));var yq=vT;function xq(e){return e!=null}function bq(e){return Array.isArray(e)}function Ex(e,n,t){return e?n:t}var vq=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var o=Object.entries(n).filter(function(l){var d=Wl(l,1),f=d[0];return!r.includes(f)});return o.reduce(function(l,d){var f=Wl(d,2),u=f[0],h=f[1];return l[u]=h,l},{})},wq=["children","innerProps"],Sq=["children","innerProps"];function Nq(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,o=e.shouldScroll,l=e.isFixedPosition,d=e.controlHeight,f=fq(t),u={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return u;var h=f.getBoundingClientRect(),g=h.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),P=T.top,M=l?window.innerHeight:dq(f),R=bT(f),z=parseInt(getComputedStyle(t).marginBottom,10),$=parseInt(getComputedStyle(t).marginTop,10),L=P-$,B=M-k,q=L+R,W=g-R-k,I=v-M+R+z,F=R+k-$,V=160;switch(a){case"auto":case"bottom":if(B>=S)return{placement:"bottom",maxHeight:n};if(W>=S&&!l)return o&&kx(f,I,V),{placement:"bottom",maxHeight:n};if(!l&&W>=r||l&&B>=r){o&&kx(f,I,V);var ee=l?B-z:W-z;return{placement:"bottom",maxHeight:ee}}if(a==="auto"||l){var ie=n,Y=l?L:q;return Y>=r&&(ie=Math.min(Y-z-d,n)),{placement:"top",maxHeight:ie}}if(a==="bottom")return o&&mb(f,I),{placement:"bottom",maxHeight:n};break;case"top":if(L>=S)return{placement:"top",maxHeight:n};if(q>=S&&!l)return o&&kx(f,F,V),{placement:"top",maxHeight:n};if(!l&&q>=r||l&&L>=r){var Q=n;return(!l&&q>=r||l&&L>=r)&&(Q=l?L-$:q-$),o&&kx(f,F,V),{placement:"top",maxHeight:Q}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return u}function Cq(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var wT=function(n){return n==="auto"?"bottom":n},_q=function(n,t){var r,a=n.placement,o=n.theme,l=o.borderRadius,d=o.spacing,f=o.colors;return $t((r={label:"menu"},qm(r,Cq(a),"100%"),qm(r,"position","absolute"),qm(r,"width","100%"),qm(r,"zIndex",1),r),t?{}:{backgroundColor:f.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:d.menuGutter,marginTop:d.menuGutter})},ST=w.createContext(null),jq=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,o=n.menuPlacement,l=n.menuPosition,d=n.menuShouldScrollIntoView,f=n.theme,u=w.useContext(ST)||{},h=u.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=Wl(b,2),S=v[0],k=v[1],T=w.useState(null),P=Wl(T,2),M=P[0],R=P[1],z=f.spacing.controlHeight;return B1(function(){var $=g.current;if($){var L=l==="fixed",B=d&&!L,q=Nq({maxHeight:a,menuEl:$,minHeight:r,placement:o,shouldScroll:B,isFixedPosition:L,controlHeight:z});k(q.maxHeight),R(q.placement),h==null||h(q.placement)}},[a,o,l,d,r,h,z]),t({ref:g,placerProps:$t($t({},n),{},{placement:M||wT(o),maxHeight:S})})},kq=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return Dt("div",Ut({},Tr(n,"menu",{menu:!0}),{ref:r},a),t)},Tq=kq,Eq=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return $t({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},Aq=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,o=n.isMulti;return Dt("div",Ut({},Tr(n,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:a},r),t)},NT=function(n,t){var r=n.theme,a=r.spacing.baseUnit,o=r.colors;return $t({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},Pq=NT,Dq=NT,Iq=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,o=Zl(n,wq);return Dt("div",Ut({},Tr($t($t({},o),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},Rq=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,o=Zl(n,Sq);return Dt("div",Ut({},Tr($t($t({},o),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},Mq=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},Oq=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,o=n.innerProps,l=n.menuPlacement,d=n.menuPosition,f=w.useRef(null),u=w.useRef(null),h=w.useState(wT(l)),g=Wl(h,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=Wl(k,2),P=T[0],M=T[1],R=w.useCallback(function(){if(a){var B=pq(a),q=d==="fixed"?0:window.pageYOffset,W=B[b]+q;(W!==(P==null?void 0:P.offset)||B.left!==(P==null?void 0:P.rect.left)||B.width!==(P==null?void 0:P.rect.width))&&M({offset:W,rect:B})}},[a,d,b,P==null?void 0:P.offset,P==null?void 0:P.rect.left,P==null?void 0:P.rect.width]);B1(function(){R()},[R]);var z=w.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),a&&f.current&&(u.current=oq(a,f.current,R,{elementResize:"ResizeObserver"in window}))},[a,R]);B1(function(){z()},[z]);var $=w.useCallback(function(B){f.current=B,z()},[z]);if(!t&&d!=="fixed"||!P)return null;var L=Dt("div",Ut({ref:$},Tr($t($t({},n),{},{offset:P.offset,position:d,rect:P.rect}),"menuPortal",{"menu-portal":!0}),o),r);return Dt(ST.Provider,{value:S},t?cI.createPortal(L,t):L)},Lq=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},Fq=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,o=n.isRtl;return Dt("div",Ut({},Tr(n,"container",{"--is-disabled":a,"--is-rtl":o}),r),t)},$q=function(n,t){var r=n.theme.spacing,a=n.isMulti,o=n.hasValue,l=n.selectProps.controlShouldRenderValue;return $t({alignItems:"center",display:a&&o&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},zq=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,o=n.hasValue;return Dt("div",Ut({},Tr(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":o}),r),t)},Bq=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},Uq=function(n){var t=n.children,r=n.innerProps;return Dt("div",Ut({},Tr(n,"indicatorsContainer",{indicators:!0}),r),t)},l_,qq=["size"],Vq=["innerProps","isRtl","size"],Hq={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},CT=function(n){var t=n.size,r=Zl(n,qq);return Dt("svg",Ut({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Hq},r))},nS=function(n){return Dt(CT,Ut({size:20},n),Dt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},_T=function(n){return Dt(CT,Ut({size:20},n),Dt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},jT=function(n,t){var r=n.isFocused,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return $t({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?l.neutral60:l.neutral20,padding:o*2,":hover":{color:r?l.neutral80:l.neutral40}})},Gq=jT,Yq=function(n){var t=n.children,r=n.innerProps;return Dt("div",Ut({},Tr(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||Dt(_T,null))},Wq=jT,Qq=function(n){var t=n.children,r=n.innerProps;return Dt("div",Ut({},Tr(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||Dt(nS,null))},Jq=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return $t({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?l.neutral10:l.neutral20,marginBottom:o*2,marginTop:o*2})},Kq=function(n){var t=n.innerProps;return Dt("span",Ut({},t,Tr(n,"indicatorSeparator",{"indicator-separator":!0})))},Xq=H9(l_||(l_=G9([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),Zq=function(n,t){var r=n.isFocused,a=n.size,o=n.theme,l=o.colors,d=o.spacing.baseUnit;return $t({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?l.neutral60:l.neutral20,padding:d*2})},T0=function(n){var t=n.delay,r=n.offset;return Dt("span",{css:Xw({animation:"".concat(Xq," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},eV=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,o=a===void 0?4:a,l=Zl(n,Vq);return Dt("div",Ut({},Tr($t($t({},l),{},{innerProps:t,isRtl:r,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Dt(T0,{delay:0,offset:r}),Dt(T0,{delay:160,offset:!0}),Dt(T0,{delay:320,offset:!r}))},tV=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.theme,l=o.colors,d=o.borderRadius,f=o.spacing;return $t({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:f.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?l.neutral5:l.neutral0,borderColor:r?l.neutral10:a?l.primary:l.neutral20,borderRadius:d,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},nV=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.innerRef,l=n.innerProps,d=n.menuIsOpen;return Dt("div",Ut({ref:o},Tr(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":d}),l,{"aria-disabled":r||void 0}),t)},rV=nV,iV=["data"],aV=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},sV=function(n){var t=n.children,r=n.cx,a=n.getStyles,o=n.getClassNames,l=n.Heading,d=n.headingProps,f=n.innerProps,u=n.label,h=n.theme,g=n.selectProps;return Dt("div",Ut({},Tr(n,"group",{group:!0}),f),Dt(l,Ut({},d,{selectProps:g,theme:h,getStyles:a,getClassNames:o,cx:r}),u),Dt("div",null,t))},oV=function(n,t){var r=n.theme,a=r.colors,o=r.spacing;return $t({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},lV=function(n){var t=xT(n);t.data;var r=Zl(t,iV);return Dt("div",Ut({},Tr(n,"groupHeading",{"group-heading":!0}),r))},cV=sV,uV=["innerRef","isDisabled","isHidden","inputClassName"],dV=function(n,t){var r=n.isDisabled,a=n.value,o=n.theme,l=o.spacing,d=o.colors;return $t($t({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},fV),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:d.neutral80})},kT={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},fV={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":$t({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},kT)},hV=function(n){return $t({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},kT)},pV=function(n){var t=n.cx,r=n.value,a=xT(n),o=a.innerRef,l=a.isDisabled,d=a.isHidden,f=a.inputClassName,u=Zl(a,uV);return Dt("div",Ut({},Tr(n,"input",{"input-container":!0}),{"data-value":r||""}),Dt("input",Ut({className:t({input:!0},f),ref:o,style:hV(d),disabled:l},u)))},mV=pV,gV=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors;return $t({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:o/2,margin:a.baseUnit/2})},yV=function(n,t){var r=n.theme,a=r.borderRadius,o=r.colors,l=n.cropWithEllipsis;return $t({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},xV=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors,d=n.isFocused;return $t({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:d?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},TT=function(n){var t=n.children,r=n.innerProps;return Dt("div",r,t)},bV=TT,vV=TT;function wV(e){var n=e.children,t=e.innerProps;return Dt("div",Ut({role:"button"},t),n||Dt(nS,{size:14}))}var SV=function(n){var t=n.children,r=n.components,a=n.data,o=n.innerProps,l=n.isDisabled,d=n.removeProps,f=n.selectProps,u=r.Container,h=r.Label,g=r.Remove;return Dt(u,{data:a,innerProps:$t($t({},Tr(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),o),selectProps:f},Dt(h,{data:a,innerProps:$t({},Tr(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:f},t),Dt(g,{data:a,innerProps:$t($t({},Tr(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},d),selectProps:f}))},NV=SV,CV=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.theme,d=l.spacing,f=l.colors;return $t({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?f.primary:a?f.primary25:"transparent",color:r?f.neutral20:o?f.neutral0:"inherit",padding:"".concat(d.baseUnit*2,"px ").concat(d.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:o?f.primary:f.primary50}})},_V=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.innerRef,d=n.innerProps;return Dt("div",Ut({},Tr(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":o}),{ref:l,"aria-disabled":r},d),t)},jV=_V,kV=function(n,t){var r=n.theme,a=r.spacing,o=r.colors;return $t({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},TV=function(n){var t=n.children,r=n.innerProps;return Dt("div",Ut({},Tr(n,"placeholder",{placeholder:!0}),r),t)},EV=TV,AV=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing,l=a.colors;return $t({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?l.neutral40:l.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},PV=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return Dt("div",Ut({},Tr(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},DV=PV,IV={ClearIndicator:Qq,Control:rV,DropdownIndicator:Yq,DownChevron:_T,CrossIcon:nS,Group:cV,GroupHeading:lV,IndicatorsContainer:Uq,IndicatorSeparator:Kq,Input:mV,LoadingIndicator:eV,Menu:Tq,MenuList:Aq,MenuPortal:Oq,LoadingMessage:Rq,NoOptionsMessage:Iq,MultiValue:NV,MultiValueContainer:bV,MultiValueLabel:vV,MultiValueRemove:wV,Option:jV,Placeholder:EV,SelectContainer:Fq,SingleValue:DV,ValueContainer:zq},RV=function(n){return $t($t({},IV),n.components)},c_=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function MV(e,n){return!!(e===n||c_(e)&&c_(n))}function OV(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!MV(e[t],n[t]))return!1;return!0}function LV(e,n){n===void 0&&(n=OV);var t=null;function r(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return r.clear=function(){t=null},r}var FV={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},$V=function(n){return Dt("span",Ut({css:FV},n))},u_=$V,zV={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,o=n.context,l=n.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,o=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,o=n.label,l=o===void 0?"":o,d=n.selectValue,f=n.isDisabled,u=n.isSelected,h=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&d)return"value ".concat(l," focused, ").concat(g(d,r),".");if(t==="menu"&&h){var b=f?" disabled":"",v="".concat(u?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},BV=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,o=n.focusableOptions,l=n.isFocused,d=n.selectValue,f=n.selectProps,u=n.id,h=n.isAppleDevice,g=f.ariaLiveMessages,b=f.getOptionLabel,v=f.inputValue,S=f.isMulti,k=f.isOptionDisabled,T=f.isSearchable,P=f.menuIsOpen,M=f.options,R=f.screenReaderStatus,z=f.tabSelectsValue,$=f.isLoading,L=f["aria-label"],B=f["aria-live"],q=w.useMemo(function(){return $t($t({},zV),g||{})},[g]),W=w.useMemo(function(){var Y="";if(t&&q.onChange){var Q=t.option,ne=t.options,le=t.removedValue,oe=t.removedValues,E=t.value,de=function(J){return Array.isArray(J)?null:J},he=le||Q||de(E),D=he?b(he):"",me=ne||oe||void 0,Ce=me?me.map(b):[],te=$t({isDisabled:he&&k(he,d),label:D,labels:Ce},t);Y=q.onChange(te)}return Y},[t,q,k,d,b]),I=w.useMemo(function(){var Y="",Q=r||a,ne=!!(r&&d&&d.includes(r));if(Q&&q.onFocus){var le={focused:Q,label:b(Q),isDisabled:k(Q,d),isSelected:ne,options:o,context:Q===r?"menu":"value",selectValue:d,isAppleDevice:h};Y=q.onFocus(le)}return Y},[r,a,b,k,q,o,d,h]),F=w.useMemo(function(){var Y="";if(P&&M.length&&!$&&q.onFilter){var Q=R({count:o.length});Y=q.onFilter({inputValue:v,resultsMessage:Q})}return Y},[o,v,P,q,M,R,$]),V=(t==null?void 0:t.action)==="initial-input-focus",ee=w.useMemo(function(){var Y="";if(q.guidance){var Q=a?"value":P?"menu":"input";Y=q.guidance({"aria-label":L,context:Q,isDisabled:r&&k(r,d),isMulti:S,isSearchable:T,tabSelectsValue:z,isInitialFocus:V})}return Y},[L,r,a,S,k,T,P,q,d,z,V]),ie=Dt(w.Fragment,null,Dt("span",{id:"aria-selection"},W),Dt("span",{id:"aria-focused"},I),Dt("span",{id:"aria-results"},F),Dt("span",{id:"aria-guidance"},ee));return Dt(w.Fragment,null,Dt(u_,{id:u},V&&ie),Dt(u_,{"aria-live":B,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!V&&ie))},UV=BV,U1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],qV=new RegExp("["+U1.map(function(e){return e.letters}).join("")+"]","g"),ET={};for(var E0=0;E0<U1.length;E0++)for(var A0=U1[E0],P0=0;P0<A0.letters.length;P0++)ET[A0.letters[P0]]=A0.base;var AT=function(n){return n.replace(qV,function(t){return ET[t]})},VV=LV(AT),d_=function(n){return n.replace(/^\s+|\s+$/g,"")},HV=function(n){return"".concat(n.label," ").concat(n.value)},GV=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=$t({ignoreCase:!0,ignoreAccents:!0,stringify:HV,trim:!0,matchFrom:"any"},n),o=a.ignoreCase,l=a.ignoreAccents,d=a.stringify,f=a.trim,u=a.matchFrom,h=f?d_(r):r,g=f?d_(d(t)):d(t);return o&&(h=h.toLowerCase(),g=g.toLowerCase()),l&&(h=VV(h),g=AT(g)),u==="start"?g.substr(0,h.length)===h:g.indexOf(h)>-1}},YV=["innerRef"];function WV(e){var n=e.innerRef,t=Zl(e,YV),r=vq(t,"onExited","in","enter","exit","appear");return Dt("input",Ut({ref:n},r,{css:Xw({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var QV=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function JV(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,o=e.onTopLeave,l=w.useRef(!1),d=w.useRef(!1),f=w.useRef(0),u=w.useRef(null),h=w.useCallback(function(T,P){if(u.current!==null){var M=u.current,R=M.scrollTop,z=M.scrollHeight,$=M.clientHeight,L=u.current,B=P>0,q=z-$-R,W=!1;q>P&&l.current&&(r&&r(T),l.current=!1),B&&d.current&&(o&&o(T),d.current=!1),B&&P>q?(t&&!l.current&&t(T),L.scrollTop=z,W=!0,l.current=!0):!B&&-P>R&&(a&&!d.current&&a(T),L.scrollTop=0,W=!0,d.current=!0),W&&QV(T)}},[t,r,a,o]),g=w.useCallback(function(T){h(T,T.deltaY)},[h]),b=w.useCallback(function(T){f.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var P=f.current-T.changedTouches[0].clientY;h(T,P)},[h]),S=w.useCallback(function(T){if(T){var P=yq?{passive:!1}:!1;T.addEventListener("wheel",g,P),T.addEventListener("touchstart",b,P),T.addEventListener("touchmove",v,P)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=u.current;return S(T),function(){k(T)}}},[n,S,k]),function(T){u.current=T}}var f_=["boxSizing","height","overflow","paddingRight","position"],h_={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function p_(e){e.cancelable&&e.preventDefault()}function m_(e){e.stopPropagation()}function g_(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function y_(){return"ontouchstart"in window||navigator.maxTouchPoints}var x_=!!(typeof window<"u"&&window.document&&window.document.createElement),Mm=0,Sh={capture:!1,passive:!1};function KV(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),o=w.useRef(null),l=w.useCallback(function(f){if(x_){var u=document.body,h=u&&u.style;if(r&&f_.forEach(function(S){var k=h&&h[S];a.current[S]=k}),r&&Mm<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(h_).forEach(function(S){var k=h_[S];h&&(h[S]=k)}),h&&(h.paddingRight="".concat(v,"px"))}u&&y_()&&(u.addEventListener("touchmove",p_,Sh),f&&(f.addEventListener("touchstart",g_,Sh),f.addEventListener("touchmove",m_,Sh))),Mm+=1}},[r]),d=w.useCallback(function(f){if(x_){var u=document.body,h=u&&u.style;Mm=Math.max(Mm-1,0),r&&Mm<1&&f_.forEach(function(g){var b=a.current[g];h&&(h[g]=b)}),u&&y_()&&(u.removeEventListener("touchmove",p_,Sh),f&&(f.removeEventListener("touchstart",g_,Sh),f.removeEventListener("touchmove",m_,Sh)))}},[r]);return w.useEffect(function(){if(n){var f=o.current;return l(f),function(){d(f)}}},[n,l,d]),function(f){o.current=f}}var XV=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},ZV={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function eH(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,o=e.onBottomArrive,l=e.onBottomLeave,d=e.onTopArrive,f=e.onTopLeave,u=JV({isEnabled:a,onBottomArrive:o,onBottomLeave:l,onTopArrive:d,onTopLeave:f}),h=KV({isEnabled:t}),g=function(v){u(v),h(v)};return Dt(w.Fragment,null,t&&Dt("div",{onClick:XV,css:ZV}),n(g))}var tH={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},nH=function(n){var t=n.name,r=n.onFocus;return Dt("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:tH,value:"",onChange:function(){}})},rH=nH;function rS(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function iH(){return rS(/^iPhone/i)}function PT(){return rS(/^Mac/i)}function aH(){return rS(/^iPad/i)||PT()&&navigator.maxTouchPoints>1}function sH(){return iH()||aH()}function oH(){return PT()||sH()}var lH=function(n){return n.label},cH=function(n){return n.label},uH=function(n){return n.value},dH=function(n){return!!n.isDisabled},fH={clearIndicator:Wq,container:Lq,control:tV,dropdownIndicator:Gq,group:aV,groupHeading:oV,indicatorsContainer:Bq,indicatorSeparator:Jq,input:dV,loadingIndicator:Zq,loadingMessage:Dq,menu:_q,menuList:Eq,menuPortal:Mq,multiValue:gV,multiValueLabel:yV,multiValueRemove:xV,noOptionsMessage:Pq,option:CV,placeholder:kV,singleValue:AV,valueContainer:$q},hH={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},pH=4,DT=4,mH=38,gH=DT*2,yH={baseUnit:DT,controlHeight:mH,menuGutter:gH},D0={borderRadius:pH,colors:hH,spacing:yH},xH={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:o_(),captureMenuScroll:!o_(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:GV(),formatGroupLabel:lH,getOptionLabel:cH,getOptionValue:uH,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:dH,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!mq(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function b_(e,n,t,r){var a=MT(e,n,t),o=OT(e,n,t),l=RT(e,n),d=gb(e,n);return{type:"option",data:n,isDisabled:a,isSelected:o,label:l,value:d,index:r}}function Jx(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(l,d){return b_(e,l,n,d)}).filter(function(l){return w_(e,l)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var o=b_(e,t,n,r);return w_(e,o)?o:void 0}).filter(xq)}function IT(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,Yw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function v_(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,Yw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function bH(e,n){return IT(Jx(e,n))}function w_(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,o=n.isSelected,l=n.label,d=n.value;return(!FT(e)||!o)&&LT(e,{label:l,value:d,data:a},r)}function vH(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var o=n.indexOf(t);if(o>-1)return t;if(a<n.length)return n[a]}return null}function wH(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var I0=function(n,t){var r,a=(r=n.find(function(o){return o.data===t}))===null||r===void 0?void 0:r.id;return a||null},RT=function(n,t){return n.getOptionLabel(t)},gb=function(n,t){return n.getOptionValue(t)};function MT(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function OT(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=gb(e,n);return t.some(function(a){return gb(e,a)===r})}function LT(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var FT=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},SH=1,$T=function(e){U7(t,e);var n=H7(t);function t(r){var a;if(z7(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(f){a.controlRef=f},a.focusedOptionRef=null,a.getFocusedOptionRef=function(f){a.focusedOptionRef=f},a.menuListRef=null,a.getMenuListRef=function(f){a.menuListRef=f},a.inputRef=null,a.getInputRef=function(f){a.inputRef=f},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(f,u){var h=a.props,g=h.onChange,b=h.name;u.name=b,a.ariaOnChange(f,u),g(f,u)},a.setValue=function(f,u,h){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(f,{action:u,option:h})},a.selectOption=function(f){var u=a.props,h=u.blurInputOnSelect,g=u.isMulti,b=u.name,v=a.state.selectValue,S=g&&a.isOptionSelected(f,v),k=a.isOptionDisabled(f,v);if(S){var T=a.getOptionValue(f);a.setValue(v.filter(function(P){return a.getOptionValue(P)!==T}),"deselect-option",f)}else if(!k)g?a.setValue([].concat(Yw(v),[f]),"select-option",f):a.setValue(f,"select-option");else{a.ariaOnChange(f,{action:"select-option",option:f,name:b});return}h&&a.blurInput()},a.removeValue=function(f){var u=a.props.isMulti,h=a.state.selectValue,g=a.getOptionValue(f),b=h.filter(function(S){return a.getOptionValue(S)!==g}),v=Ex(u,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:f}),a.focusInput()},a.clearValue=function(){var f=a.state.selectValue;a.onChange(Ex(a.props.isMulti,[],null),{action:"clear",removedValues:f})},a.popValue=function(){var f=a.props.isMulti,u=a.state.selectValue,h=u[u.length-1],g=u.slice(0,u.length-1),b=Ex(f,g,g[0]||null);h&&a.onChange(b,{action:"pop-value",removedValue:h})},a.getFocusedOptionId=function(f){return I0(a.state.focusableOptionsWithIds,f)},a.getFocusableOptionsWithIds=function(){return v_(Jx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var f=arguments.length,u=new Array(f),h=0;h<f;h++)u[h]=arguments[h];return uq.apply(void 0,[a.props.classNamePrefix].concat(u))},a.getOptionLabel=function(f){return RT(a.props,f)},a.getOptionValue=function(f){return gb(a.props,f)},a.getStyles=function(f,u){var h=a.props.unstyled,g=fH[f](u,h);g.boxSizing="border-box";var b=a.props.styles[f];return b?b(g,u):g},a.getClassNames=function(f,u){var h,g;return(h=(g=a.props.classNames)[f])===null||h===void 0?void 0:h.call(g,u)},a.getElementId=function(f){return"".concat(a.state.instancePrefix,"-").concat(f)},a.getComponents=function(){return RV(a.props)},a.buildCategorizedOptions=function(){return Jx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return IT(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(f,u){a.setState({ariaSelection:$t({value:f},u)})},a.onMenuMouseDown=function(f){f.button===0&&(f.stopPropagation(),f.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(f){a.blockOptionHover=!1},a.onControlMouseDown=function(f){if(!f.defaultPrevented){var u=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&a.onMenuClose():u&&a.openMenu("first"):(u&&(a.openAfterFocus=!0),a.focusInput()),f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&f.preventDefault()}},a.onDropdownIndicatorMouseDown=function(f){if(!(f&&f.type==="mousedown"&&f.button!==0)&&!a.props.isDisabled){var u=a.props,h=u.isMulti,g=u.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!h}),a.onMenuClose()):a.openMenu("first"),f.preventDefault()}},a.onClearIndicatorMouseDown=function(f){f&&f.type==="mousedown"&&f.button!==0||(a.clearValue(),f.preventDefault(),a.openAfterFocus=!1,f.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(f){typeof a.props.closeMenuOnScroll=="boolean"?f.target instanceof HTMLElement&&Gb(f.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(f)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(f){var u=f.touches,h=u&&u.item(0);h&&(a.initialTouchX=h.clientX,a.initialTouchY=h.clientY,a.userIsDragging=!1)},a.onTouchMove=function(f){var u=f.touches,h=u&&u.item(0);if(h){var g=Math.abs(h.clientX-a.initialTouchX),b=Math.abs(h.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(f){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(f.target)&&a.menuListRef&&!a.menuListRef.contains(f.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(f){a.userIsDragging||a.onControlMouseDown(f)},a.onClearIndicatorTouchEnd=function(f){a.userIsDragging||a.onClearIndicatorMouseDown(f)},a.onDropdownIndicatorTouchEnd=function(f){a.userIsDragging||a.onDropdownIndicatorMouseDown(f)},a.handleInputChange=function(f){var u=a.props.inputValue,h=f.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(h,{action:"input-change",prevInputValue:u}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(f){a.props.onFocus&&a.props.onFocus(f),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(f){var u=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(f),a.onInputChange("",{action:"input-blur",prevInputValue:u}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(f){if(!(a.blockOptionHover||a.state.focusedOption===f)){var u=a.getFocusableOptions(),h=u.indexOf(f);a.setState({focusedOption:f,focusedOptionId:h>-1?a.getFocusedOptionId(f):null})}},a.shouldHideSelectedOptions=function(){return FT(a.props)},a.onValueInputFocus=function(f){f.preventDefault(),f.stopPropagation(),a.focus()},a.onKeyDown=function(f){var u=a.props,h=u.isMulti,g=u.backspaceRemovesValue,b=u.escapeClearsValue,v=u.inputValue,S=u.isClearable,k=u.isDisabled,T=u.menuIsOpen,P=u.onKeyDown,M=u.tabSelectsValue,R=u.openMenuOnFocus,z=a.state,$=z.focusedOption,L=z.focusedValue,B=z.selectValue;if(!k&&!(typeof P=="function"&&(P(f),f.defaultPrevented))){switch(a.blockOptionHover=!0,f.key){case"ArrowLeft":if(!h||v)return;a.focusValue("previous");break;case"ArrowRight":if(!h||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if(L)a.removeValue(L);else{if(!g)return;h?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||f.shiftKey||!T||!M||!$||R&&a.isOptionSelected($,B))return;a.selectOption($);break;case"Enter":if(f.keyCode===229)break;if(T){if(!$||a.isComposing)return;a.selectOption($);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!$)return;a.selectOption($);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}f.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++SH),a.state.selectValue=a_(r.value),r.menuIsOpen&&a.state.selectValue.length){var o=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),d=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=o,a.state.focusedOption=l[d],a.state.focusedOptionId=I0(o,l[d])}return a}return B7(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&s_(this.menuListRef,this.focusedOptionRef),oH()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var o=this.props,l=o.isDisabled,d=o.menuIsOpen,f=this.state.isFocused;(f&&!l&&a.isDisabled||f&&d&&!a.menuIsOpen)&&this.focusInput(),f&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!f&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(s_(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,o){this.props.onInputChange(a,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var o=this,l=this.state,d=l.selectValue,f=l.isFocused,u=this.buildFocusableOptions(),h=a==="first"?0:u.length-1;if(!this.props.isMulti){var g=u.indexOf(d[0]);g>-1&&(h=g)}this.scrollToFocusedOptionOnUpdate=!(f&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[h],focusedOptionId:this.getFocusedOptionId(u[h])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(a){var o=this.state,l=o.selectValue,d=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var f=l.indexOf(d);d||(f=-1);var u=l.length-1,h=-1;if(l.length){switch(a){case"previous":f===0?h=0:f===-1?h=u:h=f-1;break;case"next":f>-1&&f<u&&(h=f+1);break}this.setState({inputIsHidden:h!==-1,focusedValue:l[h]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,d=this.getFocusableOptions();if(d.length){var f=0,u=d.indexOf(l);l||(u=-1),a==="up"?f=u>0?u-1:d.length-1:a==="down"?f=(u+1)%d.length:a==="pageup"?(f=u-o,f<0&&(f=0)):a==="pagedown"?(f=u+o,f>d.length-1&&(f=d.length-1)):a==="last"&&(f=d.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:d[f],focusedValue:null,focusedOptionId:this.getFocusedOptionId(d[f])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(D0):$t($t({},D0),this.props.theme):D0}},{key:"getCommonProps",value:function(){var a=this.clearValue,o=this.cx,l=this.getStyles,d=this.getClassNames,f=this.getValue,u=this.selectOption,h=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:o,getStyles:l,getClassNames:d,getValue:f,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:u,selectProps:g,setValue:h,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,o=a.isClearable,l=a.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(a,o){return MT(this.props,a,o)}},{key:"isOptionSelected",value:function(a,o){return OT(this.props,a,o)}},{key:"filterOption",value:function(a,o){return LT(this.props,a,o)}},{key:"formatOptionLabel",value:function(a,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,d=this.state.selectValue;return this.props.formatOptionLabel(a,{context:o,inputValue:l,selectValue:d})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,o=a.isDisabled,l=a.isSearchable,d=a.inputId,f=a.inputValue,u=a.tabIndex,h=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,T=k.inputIsHidden,P=k.ariaSelection,M=this.commonProps,R=d||this.getElementId("input"),z=$t($t($t({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(P==null?void 0:P.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,Ut({},M,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:R,innerRef:this.getInputRef,isDisabled:o,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:h,type:"text",value:f},z)):w.createElement(WV,Ut({id:R,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:pb,onFocus:this.onInputFocus,disabled:o,tabIndex:u,inputMode:"none",form:h,value:""},z))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,o=this.getComponents(),l=o.MultiValue,d=o.MultiValueContainer,f=o.MultiValueLabel,u=o.MultiValueRemove,h=o.SingleValue,g=o.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,P=v.inputValue,M=v.placeholder,R=this.state,z=R.selectValue,$=R.focusedValue,L=R.isFocused;if(!this.hasValue()||!S)return P?null:w.createElement(g,Ut({},b,{key:"placeholder",isDisabled:k,isFocused:L,innerProps:{id:this.getElementId("placeholder")}}),M);if(T)return z.map(function(q,W){var I=q===$,F="".concat(a.getOptionLabel(q),"-").concat(a.getOptionValue(q));return w.createElement(l,Ut({},b,{components:{Container:d,Label:f,Remove:u},isFocused:I,isDisabled:k,key:F,index:W,removeProps:{onClick:function(){return a.removeValue(q)},onTouchEnd:function(){return a.removeValue(q)},onMouseDown:function(ee){ee.preventDefault()}},data:q}),a.formatOptionLabel(q,"value"))});if(P)return null;var B=z[0];return w.createElement(h,Ut({},b,{data:B,isDisabled:k}),this.formatOptionLabel(B,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),o=a.ClearIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,h=this.state.isFocused;if(!this.isClearable()||!o||f||!this.hasValue()||u)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:g,isFocused:h}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),o=a.LoadingIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,h=this.state.isFocused;if(!o||!u)return null;var g={"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:g,isDisabled:f,isFocused:h}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator,l=a.IndicatorSeparator;if(!o||!l)return null;var d=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused;return w.createElement(l,Ut({},d,{isDisabled:f,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator;if(!o)return null;var l=this.commonProps,d=this.props.isDisabled,f=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:u,isDisabled:d,isFocused:f}))}},{key:"renderMenu",value:function(){var a=this,o=this.getComponents(),l=o.Group,d=o.GroupHeading,f=o.Menu,u=o.MenuList,h=o.MenuPortal,g=o.LoadingMessage,b=o.NoOptionsMessage,v=o.Option,S=this.commonProps,k=this.state.focusedOption,T=this.props,P=T.captureMenuScroll,M=T.inputValue,R=T.isLoading,z=T.loadingMessage,$=T.minMenuHeight,L=T.maxMenuHeight,B=T.menuIsOpen,q=T.menuPlacement,W=T.menuPosition,I=T.menuPortalTarget,F=T.menuShouldBlockScroll,V=T.menuShouldScrollIntoView,ee=T.noOptionsMessage,ie=T.onMenuScrollToTop,Y=T.onMenuScrollToBottom;if(!B)return null;var Q=function(D,me){var Ce=D.type,te=D.data,K=D.isDisabled,J=D.isSelected,xe=D.label,He=D.value,re=k===te,Be=K?void 0:function(){return a.onOptionHover(te)},Ae=K?void 0:function(){return a.selectOption(te)},Ie="".concat(a.getElementId("option"),"-").concat(me),Ye={id:Ie,onClick:Ae,onMouseMove:Be,onMouseOver:Be,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:J};return w.createElement(v,Ut({},S,{innerProps:Ye,data:te,isDisabled:K,isSelected:J,key:Ie,label:xe,type:Ce,value:He,isFocused:re,innerRef:re?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(D.data,"menu"))},ne;if(this.hasOptions())ne=this.getCategorizedOptions().map(function(he){if(he.type==="group"){var D=he.data,me=he.options,Ce=he.index,te="".concat(a.getElementId("group"),"-").concat(Ce),K="".concat(te,"-heading");return w.createElement(l,Ut({},S,{key:te,data:D,options:me,Heading:d,headingProps:{id:K,data:he.data},label:a.formatGroupLabel(he.data)}),he.options.map(function(J){return Q(J,"".concat(Ce,"-").concat(J.index))}))}else if(he.type==="option")return Q(he,"".concat(he.index))});else if(R){var le=z({inputValue:M});if(le===null)return null;ne=w.createElement(g,S,le)}else{var oe=ee({inputValue:M});if(oe===null)return null;ne=w.createElement(b,S,oe)}var E={minMenuHeight:$,maxMenuHeight:L,menuPlacement:q,menuPosition:W,menuShouldScrollIntoView:V},de=w.createElement(jq,Ut({},S,E),function(he){var D=he.ref,me=he.placerProps,Ce=me.placement,te=me.maxHeight;return w.createElement(f,Ut({},S,E,{innerRef:D,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:R,placement:Ce}),w.createElement(eH,{captureEnabled:P,onTopArrive:ie,onBottomArrive:Y,lockEnabled:F},function(K){return w.createElement(u,Ut({},S,{innerRef:function(xe){a.getMenuListRef(xe),K(xe)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:R,maxHeight:te,focusedOption:k}),ne)}))});return I||W==="fixed"?w.createElement(h,Ut({},S,{appendTo:I,controlElement:this.controlRef,menuPlacement:q,menuPosition:W}),de):de}},{key:"renderFormField",value:function(){var a=this,o=this.props,l=o.delimiter,d=o.isDisabled,f=o.isMulti,u=o.name,h=o.required,g=this.state.selectValue;if(h&&!this.hasValue()&&!d)return w.createElement(rH,{name:u,onFocus:this.onValueInputFocus});if(!(!u||d))if(f)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:u,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:u,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:u,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:u,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,o=this.state,l=o.ariaSelection,d=o.focusedOption,f=o.focusedValue,u=o.isFocused,h=o.selectValue,g=this.getFocusableOptions();return w.createElement(UV,Ut({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:d,focusedValue:f,isFocused:u,selectValue:h,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),o=a.Control,l=a.IndicatorsContainer,d=a.SelectContainer,f=a.ValueContainer,u=this.props,h=u.className,g=u.id,b=u.isDisabled,v=u.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(d,Ut({},k,{className:h,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(o,Ut({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(f,Ut({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,Ut({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,o){var l=o.prevProps,d=o.clearFocusValueOnUpdate,f=o.inputIsHiddenAfterUpdate,u=o.ariaSelection,h=o.isFocused,g=o.prevWasFocused,b=o.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,T=a.inputValue,P=a.isMulti,M=a_(S),R={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||T!==l.inputValue)){var z=k?bH(a,M):[],$=k?v_(Jx(a,M),"".concat(b,"-option")):[],L=d?vH(o,M):null,B=wH(o,z),q=I0($,B);R={selectValue:M,focusedOption:B,focusedOptionId:q,focusableOptionsWithIds:$,focusedValue:L,clearFocusValueOnUpdate:!1}}var W=f!=null&&a!==l?{inputIsHidden:f,inputIsHiddenAfterUpdate:void 0}:{},I=u,F=h&&g;return h&&!F&&(I={value:Ex(P,M,M[0]||null),options:M,action:"initial-input-focus"},F=!g),(u==null?void 0:u.action)==="initial-input-focus"&&(I=null),$t($t($t({},R),W),{},{prevProps:a,ariaSelection:I,prevWasFocused:F})}}]),t}(w.Component);$T.defaultProps=xH;var NH=w.forwardRef(function(e,n){var t=$7(e);return w.createElement($T,Ut({ref:n},t))}),zT=NH;const Nh=new Map,BT=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&Nh.has(n.id)){const a=Nh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Nh.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&Nh.has(n.id)){const a=Nh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Nh.set(n.id,r),r}}})();function CH(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const _H=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,UT=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,Ax=new Map,q1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var R0={exports:{}},S_;function jH(){return S_||(S_=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(f,u,h){this.fn=f,this.context=u,this.once=h||!1}function o(f,u,h,g,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,g||f,b),S=t?t+u:u;return f._events[S]?f._events[S].fn?f._events[S]=[f._events[S],v]:f._events[S].push(v):(f._events[S]=v,f._eventsCount++),f}function l(f,u){--f._eventsCount===0?f._events=new r:delete f._events[u]}function d(){this._events=new r,this._eventsCount=0}d.prototype.eventNames=function(){var u=[],h,g;if(this._eventsCount===0)return u;for(g in h=this._events)n.call(h,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},d.prototype.listeners=function(u){var h=t?t+u:u,g=this._events[h];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},d.prototype.listenerCount=function(u){var h=t?t+u:u,g=this._events[h];return g?g.fn?1:g.length:0},d.prototype.emit=function(u,h,g,b,v,S){var k=t?t+u:u;if(!this._events[k])return!1;var T=this._events[k],P=arguments.length,M,R;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),P){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,h),!0;case 3:return T.fn.call(T.context,h,g),!0;case 4:return T.fn.call(T.context,h,g,b),!0;case 5:return T.fn.call(T.context,h,g,b,v),!0;case 6:return T.fn.call(T.context,h,g,b,v,S),!0}for(R=1,M=new Array(P-1);R<P;R++)M[R-1]=arguments[R];T.fn.apply(T.context,M)}else{var z=T.length,$;for(R=0;R<z;R++)switch(T[R].once&&this.removeListener(u,T[R].fn,void 0,!0),P){case 1:T[R].fn.call(T[R].context);break;case 2:T[R].fn.call(T[R].context,h);break;case 3:T[R].fn.call(T[R].context,h,g);break;case 4:T[R].fn.call(T[R].context,h,g,b);break;default:if(!M)for($=1,M=new Array(P-1);$<P;$++)M[$-1]=arguments[$];T[R].fn.apply(T[R].context,M)}}return!0},d.prototype.on=function(u,h,g){return o(this,u,h,g,!1)},d.prototype.once=function(u,h,g){return o(this,u,h,g,!0)},d.prototype.removeListener=function(u,h,g,b){var v=t?t+u:u;if(!this._events[v])return this;if(!h)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===h&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,T=[],P=S.length;k<P;k++)(S[k].fn!==h||b&&!S[k].once||g&&S[k].context!==g)&&T.push(S[k]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},d.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&l(this,h)):(this._events=new r,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=t,d.EventEmitter=d,e.exports=d}(R0)),R0.exports}var kH=jH();const qT=Wd(kH);function TH(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class VT extends qT{constructor(t=16e3){super();Jn(this,"stream");Jn(this,"audioContext");Jn(this,"source");Jn(this,"recording",!1);Jn(this,"recordingWorklet");Jn(this,"vuWorklet");Jn(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await BT({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=q1(r,_H);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async l=>{const d=l.data.data.int16arrayBuffer;if(d){const f=TH(d);this.emit("data",f)}},this.source.connect(this.recordingWorklet);const o="vu-meter";await this.audioContext.audioWorklet.addModule(q1(o,UT)),this.vuWorklet=new AudioWorkletNode(this.audioContext,o),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(o=>o.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const EH=3,AH=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const o=()=>{r.current.forEach((l,d)=>{l&&(l.style.height=`${Math.min(24,4+n*(d===1?400:60))}px`)}),a=window.setTimeout(o,100)};return o(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:cu("audioPulse",{active:e,hover:t}),children:Array(EH).fill(null).map((a,o)=>i.jsx("div",{ref:l=>{r.current[o]=l},style:{animationDelay:`${o*133}ms`}},o))})};var Vm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var PH=Vm.exports,N_;function DH(){return N_||(N_=1,function(e,n){(function(){var t,r="4.17.21",a=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",u=500,h="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,T=1,P=2,M=4,R=8,z=16,$=32,L=64,B=128,q=256,W=512,I=30,F="...",V=800,ee=16,ie=1,Y=2,Q=3,ne=1/0,le=9007199254740991,oe=17976931348623157e292,E=NaN,de=4294967295,he=de-1,D=de>>>1,me=[["ary",B],["bind",T],["bindKey",P],["curry",R],["curryRight",z],["flip",W],["partial",$],["partialRight",L],["rearg",q]],Ce="[object Arguments]",te="[object Array]",K="[object AsyncFunction]",J="[object Boolean]",xe="[object Date]",He="[object DOMException]",re="[object Error]",Be="[object Function]",Ae="[object GeneratorFunction]",Ie="[object Map]",Ye="[object Number]",at="[object Null]",Ze="[object Object]",Ke="[object Promise]",st="[object Proxy]",yt="[object RegExp]",je="[object Set]",Ge="[object String]",_e="[object Symbol]",pe="[object Undefined]",ce="[object WeakMap]",G="[object WeakSet]",fe="[object ArrayBuffer]",Ne="[object DataView]",Le="[object Float32Array]",tt="[object Float64Array]",xt="[object Int8Array]",St="[object Int16Array]",we="[object Int32Array]",ye="[object Uint8Array]",Oe="[object Uint8ClampedArray]",De="[object Uint16Array]",Ve="[object Uint32Array]",ot=/\b__p \+= '';/g,mt=/\b(__p \+=) '' \+/g,Nt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,cn=/&(?:amp|lt|gt|quot|#39);/g,fn=/[&<>"']/g,wn=RegExp(cn.source),Tt=RegExp(fn.source),Ct=/<%-([\s\S]+?)%>/g,Yt=/<%([\s\S]+?)%>/g,It=/<%=([\s\S]+?)%>/g,Kn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yr=/^\w*$/,hr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,An=/[\\^$.*+?()[\]{}|]/g,Sr=RegExp(An.source),Xr=/^\s+/,_s=/\s/,Kd=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Xd=/\{\n\/\* \[wrapped with (.+)\] \*/,Zd=/,? & /,js=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,xu=/[()=,{}\[\]\/\s]/,va=/\\(\\)?/g,ks=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ts=/\w*$/,Es=/^[-+]0x[0-9a-f]+$/i,Nr=/^0b[01]+$/i,ef=/^\[object .+?Constructor\]$/,tf=/^0o[0-7]+$/i,As=/^(?:0|[1-9]\d*)$/,co=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ec=/($^)/,nf=/['\n\r\u2028\u2029\\]/g,cl="\\ud800-\\udfff",ip="\\u0300-\\u036f",tc="\\ufe20-\\ufe2f",uo="\\u20d0-\\u20ff",wr=ip+tc+uo,Ja="\\u2700-\\u27bf",nc="a-z\\xdf-\\xf6\\xf8-\\xff",Ps="\\xac\\xb1\\xd7\\xf7",rc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ul="\\u2000-\\u206f",bu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ic="A-Z\\xc0-\\xd6\\xd8-\\xde",Zr="\\ufe0e\\ufe0f",fo=Ps+rc+ul+bu,vu="[']",ac="["+cl+"]",sc="["+fo+"]",Ka="["+wr+"]",wu="\\d+",di="["+Ja+"]",dl="["+nc+"]",Su="[^"+cl+fo+wu+Ja+nc+ic+"]",fl="\\ud83c[\\udffb-\\udfff]",wa="(?:"+Ka+"|"+fl+")",oc="[^"+cl+"]",ho="(?:\\ud83c[\\udde6-\\uddff]){2}",Sa="[\\ud800-\\udbff][\\udc00-\\udfff]",Xa="["+ic+"]",lc="\\u200d",hl="(?:"+dl+"|"+Su+")",cc="(?:"+Xa+"|"+Su+")",uc="(?:"+vu+"(?:d|ll|m|re|s|t|ve))?",Nu="(?:"+vu+"(?:D|LL|M|RE|S|T|VE))?",Za=wa+"?",es="["+Zr+"]?",po="(?:"+lc+"(?:"+[oc,ho,Sa].join("|")+")"+es+Za+")*",Ds="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Na="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Cu=es+Za+po,pl="(?:"+[di,ho,Sa].join("|")+")"+Cu,dc="(?:"+[oc+Ka+"?",Ka,ho,Sa,ac].join("|")+")",Is=RegExp(vu,"g"),$i=RegExp(Ka,"g"),Rs=RegExp(fl+"(?="+fl+")|"+dc+Cu,"g"),Ms=RegExp([Xa+"?"+dl+"+"+uc+"(?="+[sc,Xa,"$"].join("|")+")",cc+"+"+Nu+"(?="+[sc,Xa+hl,"$"].join("|")+")",Xa+"?"+hl+"+"+uc,Xa+"+"+Nu,Na,Ds,wu,pl].join("|"),"g"),Zi=RegExp("["+lc+cl+wr+Zr+"]"),ml=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ea=-1,jn={};jn[Le]=jn[tt]=jn[xt]=jn[St]=jn[we]=jn[ye]=jn[Oe]=jn[De]=jn[Ve]=!0,jn[Ce]=jn[te]=jn[fe]=jn[J]=jn[Ne]=jn[xe]=jn[re]=jn[Be]=jn[Ie]=jn[Ye]=jn[Ze]=jn[yt]=jn[je]=jn[Ge]=jn[ce]=!1;var kn={};kn[Ce]=kn[te]=kn[fe]=kn[Ne]=kn[J]=kn[xe]=kn[Le]=kn[tt]=kn[xt]=kn[St]=kn[we]=kn[Ie]=kn[Ye]=kn[Ze]=kn[yt]=kn[je]=kn[Ge]=kn[_e]=kn[ye]=kn[Oe]=kn[De]=kn[Ve]=!0,kn[re]=kn[Be]=kn[ce]=!1;var ts={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},ei={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ca={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Os=parseFloat,gl=parseInt,hc=typeof lu=="object"&&lu&&lu.Object===Object&&lu,go=typeof self=="object"&&self&&self.Object===Object&&self,nr=hc||go||Function("return this")(),ns=n&&!n.nodeType&&n,_a=ns&&!0&&e&&!e.nodeType&&e,_u=_a&&_a.exports===ns,pc=_u&&hc.process,ti=function(){try{var Pe=_a&&_a.require&&_a.require("util").types;return Pe||pc&&pc.binding&&pc.binding("util")}catch{}}(),yl=ti&&ti.isArrayBuffer,xl=ti&&ti.isDate,bl=ti&&ti.isMap,rf=ti&&ti.isRegExp,mc=ti&&ti.isSet,gc=ti&&ti.isTypedArray;function Wr(Pe,Qe,qe){switch(qe.length){case 0:return Pe.call(Qe);case 1:return Pe.call(Qe,qe[0]);case 2:return Pe.call(Qe,qe[0],qe[1]);case 3:return Pe.call(Qe,qe[0],qe[1],qe[2])}return Pe.apply(Qe,qe)}function Dn(Pe,Qe,qe,ht){for(var Pt=-1,hn=Pe==null?0:Pe.length;++Pt<hn;){var rr=Pe[Pt];Qe(ht,rr,qe(rr),Pe)}return ht}function ni(Pe,Qe){for(var qe=-1,ht=Pe==null?0:Pe.length;++qe<ht&&Qe(Pe[qe],qe,Pe)!==!1;);return Pe}function yc(Pe,Qe){for(var qe=Pe==null?0:Pe.length;qe--&&Qe(Pe[qe],qe,Pe)!==!1;);return Pe}function xc(Pe,Qe){for(var qe=-1,ht=Pe==null?0:Pe.length;++qe<ht;)if(!Qe(Pe[qe],qe,Pe))return!1;return!0}function ri(Pe,Qe){for(var qe=-1,ht=Pe==null?0:Pe.length,Pt=0,hn=[];++qe<ht;){var rr=Pe[qe];Qe(rr,qe,Pe)&&(hn[Pt++]=rr)}return hn}function rs(Pe,Qe){var qe=Pe==null?0:Pe.length;return!!qe&&bo(Pe,Qe,0)>-1}function ju(Pe,Qe,qe){for(var ht=-1,Pt=Pe==null?0:Pe.length;++ht<Pt;)if(qe(Qe,Pe[ht]))return!0;return!1}function Vn(Pe,Qe){for(var qe=-1,ht=Pe==null?0:Pe.length,Pt=Array(ht);++qe<ht;)Pt[qe]=Qe(Pe[qe],qe,Pe);return Pt}function ii(Pe,Qe){for(var qe=-1,ht=Qe.length,Pt=Pe.length;++qe<ht;)Pe[Pt+qe]=Qe[qe];return Pe}function bc(Pe,Qe,qe,ht){var Pt=-1,hn=Pe==null?0:Pe.length;for(ht&&hn&&(qe=Pe[++Pt]);++Pt<hn;)qe=Qe(qe,Pe[Pt],Pt,Pe);return qe}function ku(Pe,Qe,qe,ht){var Pt=Pe==null?0:Pe.length;for(ht&&Pt&&(qe=Pe[--Pt]);Pt--;)qe=Qe(qe,Pe[Pt],Pt,Pe);return qe}function yo(Pe,Qe){for(var qe=-1,ht=Pe==null?0:Pe.length;++qe<ht;)if(Qe(Pe[qe],qe,Pe))return!0;return!1}var xo=ja("length");function af(Pe){return Pe.split("")}function ap(Pe){return Pe.match(js)||[]}function Tu(Pe,Qe,qe){var ht;return qe(Pe,function(Pt,hn,rr){if(Qe(Pt,hn,rr))return ht=hn,!1}),ht}function is(Pe,Qe,qe,ht){for(var Pt=Pe.length,hn=qe+(ht?1:-1);ht?hn--:++hn<Pt;)if(Qe(Pe[hn],hn,Pe))return hn;return-1}function bo(Pe,Qe,qe){return Qe===Qe?uf(Pe,Qe,qe):is(Pe,vo,qe)}function as(Pe,Qe,qe,ht){for(var Pt=qe-1,hn=Pe.length;++Pt<hn;)if(ht(Pe[Pt],Qe))return Pt;return-1}function vo(Pe){return Pe!==Pe}function Eu(Pe,Qe){var qe=Pe==null?0:Pe.length;return qe?wo(Pe,Qe)/qe:E}function ja(Pe){return function(Qe){return Qe==null?t:Qe[Pe]}}function ka(Pe){return function(Qe){return Pe==null?t:Pe[Qe]}}function Ls(Pe,Qe,qe,ht,Pt){return Pt(Pe,function(hn,rr,pn){qe=ht?(ht=!1,hn):Qe(qe,hn,rr,pn)}),qe}function Au(Pe,Qe){var qe=Pe.length;for(Pe.sort(Qe);qe--;)Pe[qe]=Pe[qe].value;return Pe}function wo(Pe,Qe){for(var qe,ht=-1,Pt=Pe.length;++ht<Pt;){var hn=Qe(Pe[ht]);hn!==t&&(qe=qe===t?hn:qe+hn)}return qe}function Ta(Pe,Qe){for(var qe=-1,ht=Array(Pe);++qe<Pe;)ht[qe]=Qe(qe);return ht}function vc(Pe,Qe){return Vn(Qe,function(qe){return[qe,Pe[qe]]})}function Pu(Pe){return Pe&&Pe.slice(0,Cc(Pe)+1).replace(Xr,"")}function fi(Pe){return function(Qe){return Pe(Qe)}}function wc(Pe,Qe){return Vn(Qe,function(qe){return Pe[qe]})}function So(Pe,Qe){return Pe.has(Qe)}function No(Pe,Qe){for(var qe=-1,ht=Pe.length;++qe<ht&&bo(Qe,Pe[qe],0)>-1;);return qe}function Co(Pe,Qe){for(var qe=Pe.length;qe--&&bo(Qe,Pe[qe],0)>-1;);return qe}function sp(Pe,Qe){for(var qe=Pe.length,ht=0;qe--;)Pe[qe]===Qe&&++ht;return ht}var Sc=ka(ts),sf=ka(ei);function of(Pe){return"\\"+fc[Pe]}function Nc(Pe,Qe){return Pe==null?t:Pe[Qe]}function ss(Pe){return Zi.test(Pe)}function vl(Pe){return ml.test(Pe)}function lf(Pe){for(var Qe,qe=[];!(Qe=Pe.next()).done;)qe.push(Qe.value);return qe}function zi(Pe){var Qe=-1,qe=Array(Pe.size);return Pe.forEach(function(ht,Pt){qe[++Qe]=[Pt,ht]}),qe}function Ea(Pe,Qe){return function(qe){return Pe(Qe(qe))}}function Lr(Pe,Qe){for(var qe=-1,ht=Pe.length,Pt=0,hn=[];++qe<ht;){var rr=Pe[qe];(rr===Qe||rr===h)&&(Pe[qe]=h,hn[Pt++]=qe)}return hn}function wl(Pe){var Qe=-1,qe=Array(Pe.size);return Pe.forEach(function(ht){qe[++Qe]=ht}),qe}function cf(Pe){var Qe=-1,qe=Array(Pe.size);return Pe.forEach(function(ht){qe[++Qe]=[ht,ht]}),qe}function uf(Pe,Qe,qe){for(var ht=qe-1,Pt=Pe.length;++ht<Pt;)if(Pe[ht]===Qe)return ht;return-1}function ai(Pe,Qe,qe){for(var ht=qe+1;ht--;)if(Pe[ht]===Qe)return ht;return ht}function si(Pe){return ss(Pe)?Du(Pe):xo(Pe)}function hi(Pe){return ss(Pe)?Iu(Pe):af(Pe)}function Cc(Pe){for(var Qe=Pe.length;Qe--&&_s.test(Pe.charAt(Qe)););return Qe}var df=ka(Ca);function Du(Pe){for(var Qe=Rs.lastIndex=0;Rs.test(Pe);)++Qe;return Qe}function Iu(Pe){return Pe.match(Rs)||[]}function op(Pe){return Pe.match(Ms)||[]}var _o=function Pe(Qe){Qe=Qe==null?nr:os.defaults(nr.Object(),Qe,os.pick(nr,mo));var qe=Qe.Array,ht=Qe.Date,Pt=Qe.Error,hn=Qe.Function,rr=Qe.Math,pn=Qe.Object,pi=Qe.RegExp,ff=Qe.String,mi=Qe.TypeError,Sl=qe.prototype,lp=hn.prototype,jo=pn.prototype,Nl=Qe["__core-js_shared__"],Cl=lp.toString,Sn=jo.hasOwnProperty,Bi=0,Ru=function(){var m=/[^.]+$/.exec(Nl&&Nl.keys&&Nl.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Qr=jo.toString,wi=Cl.call(pn),Fs=nr._,_c=pi("^"+Cl.call(Sn).replace(An,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ls=_u?Qe.Buffer:t,ae=Qe.Symbol,be=Qe.Uint8Array,ue=ls?ls.allocUnsafe:t,Te=Ea(pn.getPrototypeOf,pn),et=pn.create,ft=jo.propertyIsEnumerable,kt=Sl.splice,wt=ae?ae.isConcatSpreadable:t,pr=ae?ae.iterator:t,Xn=ae?ae.toStringTag:t,_l=function(){try{var m=Mo(pn,"defineProperty");return m({},"",{}),m}catch{}}(),hf=Qe.clearTimeout!==nr.clearTimeout&&Qe.clearTimeout,jl=ht&&ht.now!==nr.Date.now&&ht.now,cp=Qe.setTimeout!==nr.setTimeout&&Qe.setTimeout,jc=rr.ceil,$s=rr.floor,ko=pn.getOwnPropertySymbols,pf=ls?ls.isBuffer:t,Mu=Qe.isFinite,ta=Sl.join,na=Ea(pn.keys,pn),Zn=rr.max,ir=rr.min,zs=ht.now,kl=Qe.parseInt,up=rr.random,dp=Sl.reverse,Ou=Mo(Qe,"DataView"),Er=Mo(Qe,"Map"),ar=Mo(Qe,"Promise"),un=Mo(Qe,"Set"),Aa=Mo(Qe,"WeakMap"),Si=Mo(pn,"create"),kc=Aa&&new Aa,ra={},_g=Qs(Ou),jg=Qs(Er),Lu=Qs(ar),Fu=Qs(un),kg=Qs(Aa),To=ae?ae.prototype:t,Tl=To?To.valueOf:t,Eo=To?To.toString:t;function X(m){if(dr(m)&&!qt(m)&&!(m instanceof nn)){if(m instanceof Ni)return m;if(Sn.call(m,"__wrapped__"))return Pr(m)}return new Ni(m)}var Ui=function(){function m(){}return function(y){if(!or(y))return{};if(et)return et(y);m.prototype=y;var j=new m;return m.prototype=t,j}}();function ia(){}function Ni(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}X.templateSettings={escape:Ct,evaluate:Yt,interpolate:It,variable:"",imports:{_:X}},X.prototype=ia.prototype,X.prototype.constructor=X,Ni.prototype=Ui(ia.prototype),Ni.prototype.constructor=Ni;function nn(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=de,this.__views__=[]}function $u(){var m=new nn(this.__wrapped__);return m.__actions__=Ar(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=Ar(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=Ar(this.__views__),m}function mf(){if(this.__filtered__){var m=new nn(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function El(){var m=this.__wrapped__.value(),y=this.__dir__,j=qt(m),O=y<0,H=j?m.length:0,se=sy(0,H,this.__views__),ve=se.start,ke=se.end,Me=ke-ve,nt=O?ke:ve-1,it=this.__iteratees__,lt=it.length,gt=0,_t=ir(Me,this.__takeCount__);if(!j||!O&&H==Me&&_t==Me)return Gg(m,this.__actions__);var zt=[];e:for(;Me--&&gt<_t;){nt+=y;for(var an=-1,Bt=m[nt];++an<lt;){var gn=it[an],Cn=gn.iteratee,La=gn.type,Qi=Cn(Bt);if(La==Y)Bt=Qi;else if(!Qi){if(La==ie)continue e;break e}}zt[gt++]=Bt}return zt}nn.prototype=Ui(ia.prototype),nn.prototype.constructor=nn;function mr(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function gf(){this.__data__=Si?Si(null):{},this.size=0}function Tg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function iv(m){var y=this.__data__;if(Si){var j=y[m];return j===f?t:j}return Sn.call(y,m)?y[m]:t}function av(m){var y=this.__data__;return Si?y[m]!==t:Sn.call(y,m)}function sv(m,y){var j=this.__data__;return this.size+=this.has(m)?0:1,j[m]=Si&&y===t?f:y,this}mr.prototype.clear=gf,mr.prototype.delete=Tg,mr.prototype.get=iv,mr.prototype.has=av,mr.prototype.set=sv;function Hn(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function fp(){this.__data__=[],this.size=0}function zu(m){var y=this.__data__,j=Ac(y,m);if(j<0)return!1;var O=y.length-1;return j==O?y.pop():kt.call(y,j,1),--this.size,!0}function Bu(m){var y=this.__data__,j=Ac(y,m);return j<0?t:y[j][1]}function hp(m){return Ac(this.__data__,m)>-1}function Tc(m,y){var j=this.__data__,O=Ac(j,m);return O<0?(++this.size,j.push([m,y])):j[O][1]=y,this}Hn.prototype.clear=fp,Hn.prototype.delete=zu,Hn.prototype.get=Bu,Hn.prototype.has=hp,Hn.prototype.set=Tc;function Ci(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function ov(){this.size=0,this.__data__={hash:new mr,map:new(Er||Hn),string:new mr}}function Eg(m){var y=Oc(this,m).delete(m);return this.size-=y?1:0,y}function lv(m){return Oc(this,m).get(m)}function Ag(m){return Oc(this,m).has(m)}function Al(m,y){var j=Oc(this,m),O=j.size;return j.set(m,y),this.size+=j.size==O?0:1,this}Ci.prototype.clear=ov,Ci.prototype.delete=Eg,Ci.prototype.get=lv,Ci.prototype.has=Ag,Ci.prototype.set=Al;function Bs(m){var y=-1,j=m==null?0:m.length;for(this.__data__=new Ci;++y<j;)this.add(m[y])}function yf(m){return this.__data__.set(m,f),this}function Pg(m){return this.__data__.has(m)}Bs.prototype.add=Bs.prototype.push=yf,Bs.prototype.has=Pg;function gi(m){var y=this.__data__=new Hn(m);this.size=y.size}function Dg(){this.__data__=new Hn,this.size=0}function xf(m){var y=this.__data__,j=y.delete(m);return this.size=y.size,j}function pp(m){return this.__data__.get(m)}function Ig(m){return this.__data__.has(m)}function bf(m,y){var j=this.__data__;if(j instanceof Hn){var O=j.__data__;if(!Er||O.length<a-1)return O.push([m,y]),this.size=++j.size,this;j=this.__data__=new Ci(O)}return j.set(m,y),this.size=j.size,this}gi.prototype.clear=Dg,gi.prototype.delete=xf,gi.prototype.get=pp,gi.prototype.has=Ig,gi.prototype.set=bf;function mp(m,y){var j=qt(m),O=!j&&Zs(m),H=!j&&!O&&Ho(m),se=!j&&!O&&!H&&Jc(m),ve=j||O||H||se,ke=ve?Ta(m.length,ff):[],Me=ke.length;for(var nt in m)(y||Sn.call(m,nt))&&!(ve&&(nt=="length"||H&&(nt=="offset"||nt=="parent")||se&&(nt=="buffer"||nt=="byteLength"||nt=="byteOffset")||Ra(nt,Me)))&&ke.push(nt);return ke}function Ec(m){var y=m.length;return y?m[Ef(0,y-1)]:t}function Rg(m,y){return pd(Ar(m),Da(y,0,m.length))}function Mg(m){return pd(Ar(m))}function cs(m,y,j){(j!==t&&!Pi(m[y],j)||j===t&&!(y in m))&&Pa(m,y,j)}function Pl(m,y,j){var O=m[y];(!(Sn.call(m,y)&&Pi(O,j))||j===t&&!(y in m))&&Pa(m,y,j)}function Ac(m,y){for(var j=m.length;j--;)if(Pi(m[j][0],y))return j;return-1}function Ao(m,y,j,O){return qs(m,function(H,se,ve){y(O,H,j(H),ve)}),O}function Us(m,y){return m&&ki(y,Rr(y),m)}function Uu(m,y){return m&&ki(y,zr(y),m)}function Pa(m,y,j){y=="__proto__"&&_l?_l(m,y,{configurable:!0,enumerable:!0,value:j,writable:!0}):m[y]=j}function qu(m,y){for(var j=-1,O=y.length,H=qe(O),se=m==null;++j<O;)H[j]=se?t:Td(m,y[j]);return H}function Da(m,y,j){return m===m&&(j!==t&&(m=m<=j?m:j),y!==t&&(m=m>=y?m:y)),m}function oi(m,y,j,O,H,se){var ve,ke=y&g,Me=y&b,nt=y&v;if(j&&(ve=H?j(m,O,H,se):j(m)),ve!==t)return ve;if(!or(m))return m;var it=qt(m);if(it){if(ve=Bp(m),!ke)return Ar(m,ve)}else{var lt=$r(m),gt=lt==Be||lt==Ae;if(Ho(m))return Ip(m,ke);if(lt==Ze||lt==Ce||gt&&!H){if(ve=Me||gt?{}:Up(m),!ke)return Me?nd(m,Uu(ve,m)):Mf(m,Us(ve,m))}else{if(!kn[lt])return H?m:{};ve=qp(m,lt,ke)}}se||(se=new gi);var _t=se.get(m);if(_t)return _t;se.set(m,ve),Xy(m)?m.forEach(function(Bt){ve.add(oi(Bt,y,j,Bt,m,se))}):sh(m)&&m.forEach(function(Bt,gn){ve.set(gn,oi(Bt,y,j,gn,m,se))});var zt=nt?Me?$f:Ff:Me?zr:Rr,an=it?t:zt(m);return ni(an||m,function(Bt,gn){an&&(gn=Bt,Bt=m[gn]),Pl(ve,gn,oi(Bt,y,j,gn,m,se))}),ve}function Og(m){var y=Rr(m);return function(j){return gp(j,m,y)}}function gp(m,y,j){var O=j.length;if(m==null)return!O;for(m=pn(m);O--;){var H=j[O],se=y[H],ve=m[H];if(ve===t&&!(H in m)||!se(ve))return!1}return!0}function Dl(m,y,j){if(typeof m!="function")throw new mi(l);return Fc(function(){m.apply(t,j)},y)}function Po(m,y,j,O){var H=-1,se=rs,ve=!0,ke=m.length,Me=[],nt=y.length;if(!ke)return Me;j&&(y=Vn(y,fi(j))),O?(se=ju,ve=!1):y.length>=a&&(se=So,ve=!1,y=new Bs(y));e:for(;++H<ke;){var it=m[H],lt=j==null?it:j(it);if(it=O||it!==0?it:0,ve&&lt===lt){for(var gt=nt;gt--;)if(y[gt]===lt)continue e;Me.push(it)}else se(y,lt,O)||Me.push(it)}return Me}var qs=Lp(li),vf=Lp(Dc,!0);function yp(m,y){var j=!0;return qs(m,function(O,H,se){return j=!!y(O,H,se),j}),j}function Ia(m,y,j){for(var O=-1,H=m.length;++O<H;){var se=m[O],ve=y(se);if(ve!=null&&(ke===t?ve===ve&&!bi(ve):j(ve,ke)))var ke=ve,Me=se}return Me}function Xt(m,y,j,O){var H=m.length;for(j=Gt(j),j<0&&(j=-j>H?0:H+j),O=O===t||O>H?H:Gt(O),O<0&&(O+=H),O=j>O?0:xs(O);j<O;)m[j++]=y;return m}function Rn(m,y){var j=[];return qs(m,function(O,H,se){y(O,H,se)&&j.push(O)}),j}function dn(m,y,j,O,H){var se=-1,ve=m.length;for(j||(j=Ys),H||(H=[]);++se<ve;){var ke=m[se];y>0&&j(ke)?y>1?dn(ke,y-1,j,O,H):ii(H,ke):O||(H[H.length]=ke)}return H}var Pc=$l(),Il=$l(!0);function li(m,y){return m&&Pc(m,y,Rr)}function Dc(m,y){return m&&Il(m,y,Rr)}function Do(m,y){return ri(y,function(j){return Ma(m[j])})}function aa(m,y){y=Hs(y,m);for(var j=0,O=y.length;m!=null&&j<O;)m=m[In(y[j++])];return j&&j==O?m:t}function Lg(m,y,j){var O=y(m);return qt(m)?O:ii(O,j(m))}function mn(m){return m==null?m===t?pe:at:Xn&&Xn in pn(m)?ay(m):dy(m)}function Vu(m,y){return m>y}function xp(m,y){return m!=null&&Sn.call(m,y)}function Fg(m,y){return m!=null&&y in pn(m)}function $g(m,y,j){return m>=ir(y,j)&&m<Zn(y,j)}function bp(m,y,j){for(var O=j?ju:rs,H=m[0].length,se=m.length,ve=se,ke=qe(se),Me=1/0,nt=[];ve--;){var it=m[ve];ve&&y&&(it=Vn(it,fi(y))),Me=ir(it.length,Me),ke[ve]=!j&&(y||H>=120&&it.length>=120)?new Bs(ve&&it):t}it=m[0];var lt=-1,gt=ke[0];e:for(;++lt<H&&nt.length<Me;){var _t=it[lt],zt=y?y(_t):_t;if(_t=j||_t!==0?_t:0,!(gt?So(gt,zt):O(nt,zt,j))){for(ve=se;--ve;){var an=ke[ve];if(!(an?So(an,zt):O(m[ve],zt,j)))continue e}gt&&gt.push(zt),nt.push(_t)}}return nt}function vp(m,y,j,O){return li(m,function(H,se,ve){y(O,j(H),se,ve)}),O}function Rl(m,y,j){y=Hs(y,m),m=Lc(m,y);var O=m==null?m:m[In(ci(y))];return O==null?t:Wr(O,m,j)}function wf(m){return dr(m)&&mn(m)==Ce}function _i(m){return dr(m)&&mn(m)==fe}function Cr(m){return dr(m)&&mn(m)==xe}function Ml(m,y,j,O,H){return m===y?!0:m==null||y==null||!dr(m)&&!dr(y)?m!==m&&y!==y:Hu(m,y,j,O,Ml,H)}function Hu(m,y,j,O,H,se){var ve=qt(m),ke=qt(y),Me=ve?te:$r(m),nt=ke?te:$r(y);Me=Me==Ce?Ze:Me,nt=nt==Ce?Ze:nt;var it=Me==Ze,lt=nt==Ze,gt=Me==nt;if(gt&&Ho(m)){if(!Ho(y))return!1;ve=!0,it=!1}if(gt&&!it)return se||(se=new gi),ve||Jc(m)?ry(m,y,j,O,H,se):iy(m,y,Me,j,O,H,se);if(!(j&S)){var _t=it&&Sn.call(m,"__wrapped__"),zt=lt&&Sn.call(y,"__wrapped__");if(_t||zt){var an=_t?m.value():m,Bt=zt?y.value():y;return se||(se=new gi),H(an,Bt,j,O,se)}}return gt?(se||(se=new gi),Fr(m,y,j,O,H,se)):!1}function Sf(m){return dr(m)&&$r(m)==Ie}function Gu(m,y,j,O){var H=j.length,se=H,ve=!O;if(m==null)return!se;for(m=pn(m);H--;){var ke=j[H];if(ve&&ke[2]?ke[1]!==m[ke[0]]:!(ke[0]in m))return!1}for(;++H<se;){ke=j[H];var Me=ke[0],nt=m[Me],it=ke[1];if(ve&&ke[2]){if(nt===t&&!(Me in m))return!1}else{var lt=new gi;if(O)var gt=O(nt,it,Me,m,y,lt);if(!(gt===t?Ml(it,nt,S|k,O,lt):gt))return!1}}return!0}function us(m){if(!or(m)||Hf(m))return!1;var y=Ma(m)?_c:ef;return y.test(Qs(m))}function Nf(m){return dr(m)&&mn(m)==yt}function wp(m){return dr(m)&&$r(m)==je}function Sp(m){return dr(m)&&Vl(m.length)&&!!jn[mn(m)]}function Np(m){return typeof m=="function"?m:m==null?ze:typeof m=="object"?qt(m)?jf(m[0],m[1]):_p(m):Nn(m)}function Cf(m){if(!Gn(m))return na(m);var y=[];for(var j in pn(m))Sn.call(m,j)&&j!="constructor"&&y.push(j);return y}function zg(m){if(!or(m))return Oo(m);var y=Gn(m),j=[];for(var O in m)O=="constructor"&&(y||!Sn.call(m,O))||j.push(O);return j}function _f(m,y){return m<y}function Cp(m,y){var j=-1,O=Dr(m)?qe(m.length):[];return qs(m,function(H,se,ve){O[++j]=y(H,se,ve)}),O}function _p(m){var y=Bf(m);return y.length==1&&y[0][2]?cy(y[0][0],y[0][1]):function(j){return j===m||Gu(j,m,y)}}function jf(m,y){return qf(m)&&ly(y)?cy(In(m),y):function(j){var O=Td(j,m);return O===t&&O===y?eu(j,m):Ml(y,O,S|k)}}function Yu(m,y,j,O,H){m!==y&&Pc(y,function(se,ve){if(H||(H=new gi),or(se))cv(m,y,ve,j,Yu,O,H);else{var ke=O?O(Gf(m,ve),se,ve+"",m,y,H):t;ke===t&&(ke=se),cs(m,ve,ke)}},zr)}function cv(m,y,j,O,H,se,ve){var ke=Gf(m,j),Me=Gf(y,j),nt=ve.get(Me);if(nt){cs(m,j,nt);return}var it=se?se(ke,Me,j+"",m,y,ve):t,lt=it===t;if(lt){var gt=qt(Me),_t=!gt&&Ho(Me),zt=!gt&&!_t&&Jc(Me);it=Me,gt||_t||zt?qt(ke)?it=ke:xr(ke)?it=Ar(ke):_t?(lt=!1,it=Ip(Me,!0)):zt?(lt=!1,it=Mp(Me,!0)):it=[]:ca(Me)||Zs(Me)?(it=ke,Zs(ke)?it=tx(ke):(!or(ke)||Ma(ke))&&(it=Up(Me))):lt=!1}lt&&(ve.set(Me,it),H(it,Me,O,se,ve),ve.delete(Me)),cs(m,j,it)}function jp(m,y){var j=m.length;if(j)return y+=y<0?j:0,Ra(y,j)?m[y]:t}function kp(m,y,j){y.length?y=Vn(y,function(se){return qt(se)?function(ve){return aa(ve,se.length===1?se[0]:se)}:se}):y=[ze];var O=-1;y=Vn(y,fi(Et()));var H=Cp(m,function(se,ve,ke){var Me=Vn(y,function(nt){return nt(se)});return{criteria:Me,index:++O,value:se}});return Au(H,function(se,ve){return Jg(se,ve,j)})}function Bg(m,y){return kf(m,y,function(j,O){return eu(m,O)})}function kf(m,y,j){for(var O=-1,H=y.length,se={};++O<H;){var ve=y[O],ke=aa(m,ve);j(ke,ve)&&Rc(se,Hs(ve,m),ke)}return se}function Ug(m){return function(y){return aa(y,m)}}function Tf(m,y,j,O){var H=O?as:bo,se=-1,ve=y.length,ke=m;for(m===y&&(y=Ar(y)),j&&(ke=Vn(m,fi(j)));++se<ve;)for(var Me=0,nt=y[se],it=j?j(nt):nt;(Me=H(ke,it,Me,O))>-1;)ke!==m&&kt.call(ke,Me,1),kt.call(m,Me,1);return m}function Tp(m,y){for(var j=m?y.length:0,O=j-1;j--;){var H=y[j];if(j==O||H!==se){var se=H;Ra(H)?kt.call(m,H,1):Ku(m,H)}}return m}function Ef(m,y){return m+$s(up()*(y-m+1))}function qg(m,y,j,O){for(var H=-1,se=Zn(jc((y-m)/(j||1)),0),ve=qe(se);se--;)ve[O?se:++H]=m,m+=j;return ve}function Ep(m,y){var j="";if(!m||y<1||y>le)return j;do y%2&&(j+=m),y=$s(y/2),y&&(m+=m);while(y);return j}function Wt(m,y){return fd(Vp(m,y,ze),m+"")}function Ic(m){return Ec(nu(m))}function Af(m,y){var j=nu(m);return pd(j,Da(y,0,j.length))}function Rc(m,y,j,O){if(!or(m))return m;y=Hs(y,m);for(var H=-1,se=y.length,ve=se-1,ke=m;ke!=null&&++H<se;){var Me=In(y[H]),nt=j;if(Me==="__proto__"||Me==="constructor"||Me==="prototype")return m;if(H!=ve){var it=ke[Me];nt=O?O(it,Me,ke):t,nt===t&&(nt=or(it)?it:Ra(y[H+1])?[]:{})}Pl(ke,Me,nt),ke=ke[Me]}return m}var Wu=kc?function(m,y){return kc.set(m,y),m}:ze,Qu=_l?function(m,y){return _l(m,"toString",{configurable:!0,enumerable:!1,value:$e(y),writable:!0})}:ze;function Vg(m){return pd(nu(m))}function qi(m,y,j){var O=-1,H=m.length;y<0&&(y=-y>H?0:H+y),j=j>H?H:j,j<0&&(j+=H),H=y>j?0:j-y>>>0,y>>>=0;for(var se=qe(H);++O<H;)se[O]=m[O+y];return se}function Hg(m,y){var j;return qs(m,function(O,H,se){return j=y(O,H,se),!j}),!!j}function Ju(m,y,j){var O=0,H=m==null?O:m.length;if(typeof y=="number"&&y===y&&H<=D){for(;O<H;){var se=O+H>>>1,ve=m[se];ve!==null&&!bi(ve)&&(j?ve<=y:ve<y)?O=se+1:H=se}return H}return Pf(m,y,ze,j)}function Pf(m,y,j,O){var H=0,se=m==null?0:m.length;if(se===0)return 0;y=j(y);for(var ve=y!==y,ke=y===null,Me=bi(y),nt=y===t;H<se;){var it=$s((H+se)/2),lt=j(m[it]),gt=lt!==t,_t=lt===null,zt=lt===lt,an=bi(lt);if(ve)var Bt=O||zt;else nt?Bt=zt&&(O||gt):ke?Bt=zt&&gt&&(O||!_t):Me?Bt=zt&&gt&&!_t&&(O||!an):_t||an?Bt=!1:Bt=O?lt<=y:lt<y;Bt?H=it+1:se=it}return ir(se,he)}function Ap(m,y){for(var j=-1,O=m.length,H=0,se=[];++j<O;){var ve=m[j],ke=y?y(ve):ve;if(!j||!Pi(ke,Me)){var Me=ke;se[H++]=ve===0?0:ve}}return se}function Df(m){return typeof m=="number"?m:bi(m)?E:+m}function ji(m){if(typeof m=="string")return m;if(qt(m))return Vn(m,ji)+"";if(bi(m))return Eo?Eo.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Vs(m,y,j){var O=-1,H=rs,se=m.length,ve=!0,ke=[],Me=ke;if(j)ve=!1,H=ju;else if(se>=a){var nt=y?null:ty(m);if(nt)return wl(nt);ve=!1,H=So,Me=new Bs}else Me=y?[]:ke;e:for(;++O<se;){var it=m[O],lt=y?y(it):it;if(it=j||it!==0?it:0,ve&&lt===lt){for(var gt=Me.length;gt--;)if(Me[gt]===lt)continue e;y&&Me.push(lt),ke.push(it)}else H(Me,lt,j)||(Me!==ke&&Me.push(lt),ke.push(it))}return ke}function Ku(m,y){return y=Hs(y,m),m=Lc(m,y),m==null||delete m[In(ci(y))]}function Pp(m,y,j,O){return Rc(m,y,j(aa(m,y)),O)}function Xu(m,y,j,O){for(var H=m.length,se=O?H:-1;(O?se--:++se<H)&&y(m[se],se,m););return j?qi(m,O?0:se,O?se+1:H):qi(m,O?se+1:0,O?H:se)}function Gg(m,y){var j=m;return j instanceof nn&&(j=j.value()),bc(y,function(O,H){return H.func.apply(H.thisArg,ii([O],H.args))},j)}function Zu(m,y,j){var O=m.length;if(O<2)return O?Vs(m[0]):[];for(var H=-1,se=qe(O);++H<O;)for(var ve=m[H],ke=-1;++ke<O;)ke!=H&&(se[H]=Po(se[H]||ve,m[ke],y,j));return Vs(dn(se,1),y,j)}function Dp(m,y,j){for(var O=-1,H=m.length,se=y.length,ve={};++O<H;){var ke=O<se?y[O]:t;j(ve,m[O],ke)}return ve}function If(m){return xr(m)?m:[]}function ed(m){return typeof m=="function"?m:ze}function Hs(m,y){return qt(m)?m:qf(m,y)?[m]:ps(Pn(m))}var Yg=Wt;function Io(m,y,j){var O=m.length;return j=j===t?O:j,!y&&j>=O?m:qi(m,y,j)}var Wg=hf||function(m){return nr.clearTimeout(m)};function Ip(m,y){if(y)return m.slice();var j=m.length,O=ue?ue(j):new m.constructor(j);return m.copy(O),O}function Ol(m){var y=new m.constructor(m.byteLength);return new be(y).set(new be(m)),y}function Rp(m,y){var j=y?Ol(m.buffer):m.buffer;return new m.constructor(j,m.byteOffset,m.byteLength)}function Rf(m){var y=new m.constructor(m.source,Ts.exec(m));return y.lastIndex=m.lastIndex,y}function Qg(m){return Tl?pn(Tl.call(m)):{}}function Mp(m,y){var j=y?Ol(m.buffer):m.buffer;return new m.constructor(j,m.byteOffset,m.length)}function td(m,y){if(m!==y){var j=m!==t,O=m===null,H=m===m,se=bi(m),ve=y!==t,ke=y===null,Me=y===y,nt=bi(y);if(!ke&&!nt&&!se&&m>y||se&&ve&&Me&&!ke&&!nt||O&&ve&&Me||!j&&Me||!H)return 1;if(!O&&!se&&!nt&&m<y||nt&&j&&H&&!O&&!se||ke&&j&&H||!ve&&H||!Me)return-1}return 0}function Jg(m,y,j){for(var O=-1,H=m.criteria,se=y.criteria,ve=H.length,ke=j.length;++O<ve;){var Me=td(H[O],se[O]);if(Me){if(O>=ke)return Me;var nt=j[O];return Me*(nt=="desc"?-1:1)}}return m.index-y.index}function Op(m,y,j,O){for(var H=-1,se=m.length,ve=j.length,ke=-1,Me=y.length,nt=Zn(se-ve,0),it=qe(Me+nt),lt=!O;++ke<Me;)it[ke]=y[ke];for(;++H<ve;)(lt||H<se)&&(it[j[H]]=m[H]);for(;nt--;)it[ke++]=m[H++];return it}function Kg(m,y,j,O){for(var H=-1,se=m.length,ve=-1,ke=j.length,Me=-1,nt=y.length,it=Zn(se-ke,0),lt=qe(it+nt),gt=!O;++H<it;)lt[H]=m[H];for(var _t=H;++Me<nt;)lt[_t+Me]=y[Me];for(;++ve<ke;)(gt||H<se)&&(lt[_t+j[ve]]=m[H++]);return lt}function Ar(m,y){var j=-1,O=m.length;for(y||(y=qe(O));++j<O;)y[j]=m[j];return y}function ki(m,y,j,O){var H=!j;j||(j={});for(var se=-1,ve=y.length;++se<ve;){var ke=y[se],Me=O?O(j[ke],m[ke],ke,j,m):t;Me===t&&(Me=m[ke]),H?Pa(j,ke,Me):Pl(j,ke,Me)}return j}function Mf(m,y){return ki(m,ld(m),y)}function nd(m,y){return ki(m,Uf(m),y)}function Ll(m,y){return function(j,O){var H=qt(j)?Dn:Ao,se=y?y():{};return H(j,m,Et(O,2),se)}}function Fl(m){return Wt(function(y,j){var O=-1,H=j.length,se=H>1?j[H-1]:t,ve=H>2?j[2]:t;for(se=m.length>3&&typeof se=="function"?(H--,se):t,ve&&xi(j[0],j[1],ve)&&(se=H<3?t:se,H=1),y=pn(y);++O<H;){var ke=j[O];ke&&m(y,ke,O,se)}return y})}function Lp(m,y){return function(j,O){if(j==null)return j;if(!Dr(j))return m(j,O);for(var H=j.length,se=y?H:-1,ve=pn(j);(y?se--:++se<H)&&O(ve[se],se,ve)!==!1;);return j}}function $l(m){return function(y,j,O){for(var H=-1,se=pn(y),ve=O(y),ke=ve.length;ke--;){var Me=ve[m?ke:++H];if(j(se[Me],Me,se)===!1)break}return y}}function Xg(m,y,j){var O=y&T,H=sa(m);function se(){var ve=this&&this!==nr&&this instanceof se?H:m;return ve.apply(O?j:this,arguments)}return se}function Vi(m){return function(y){y=Pn(y);var j=ss(y)?hi(y):t,O=j?j[0]:y.charAt(0),H=j?Io(j,1).join(""):y.slice(1);return O[m]()+H}}function yi(m){return function(y){return bc(N(eo(y).replace(Is,"")),m,"")}}function sa(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var j=Ui(m.prototype),O=m.apply(j,y);return or(O)?O:j}}function Zg(m,y,j){var O=sa(m);function H(){for(var se=arguments.length,ve=qe(se),ke=se,Me=Bl(H);ke--;)ve[ke]=arguments[ke];var nt=se<3&&ve[0]!==Me&&ve[se-1]!==Me?[]:Lr(ve,Me);if(se-=nt.length,se<j)return Fp(m,y,gr,H.placeholder,t,ve,nt,t,t,j-se);var it=this&&this!==nr&&this instanceof H?O:m;return Wr(it,this,ve)}return H}function Gs(m){return function(y,j,O){var H=pn(y);if(!Dr(y)){var se=Et(j,3);y=Rr(y),j=function(ke){return se(H[ke],ke,H)}}var ve=m(y,j,O);return ve>-1?H[se?y[ve]:ve]:t}}function ds(m){return er(function(y){var j=y.length,O=j,H=Ni.prototype.thru;for(m&&y.reverse();O--;){var se=y[O];if(typeof se!="function")throw new mi(l);if(H&&!ve&&od(se)=="wrapper")var ve=new Ni([],!0)}for(O=ve?O:j;++O<j;){se=y[O];var ke=od(se),Me=ke=="wrapper"?zf(se):t;Me&&Vf(Me[0])&&Me[1]==(B|R|$|q)&&!Me[4].length&&Me[9]==1?ve=ve[od(Me[0])].apply(ve,Me[3]):ve=se.length==1&&Vf(se)?ve[ke]():ve.thru(se)}return function(){var nt=arguments,it=nt[0];if(ve&&nt.length==1&&qt(it))return ve.plant(it).value();for(var lt=0,gt=j?y[lt].apply(this,nt):it;++lt<j;)gt=y[lt].call(this,gt);return gt}})}function gr(m,y,j,O,H,se,ve,ke,Me,nt){var it=y&B,lt=y&T,gt=y&P,_t=y&(R|z),zt=y&W,an=gt?t:sa(m);function Bt(){for(var gn=arguments.length,Cn=qe(gn),La=gn;La--;)Cn[La]=arguments[La];if(_t)var Qi=Bl(Bt),Fa=sp(Cn,Qi);if(O&&(Cn=Op(Cn,O,H,_t)),se&&(Cn=Kg(Cn,se,ve,_t)),gn-=Fa,_t&&gn<nt){var Mr=Lr(Cn,Qi);return Fp(m,y,gr,Bt.placeholder,j,Cn,Mr,ke,Me,nt-gn)}var to=lt?j:this,Hl=gt?to[m]:m;return gn=Cn.length,ke?Cn=hs(Cn,ke):zt&&gn>1&&Cn.reverse(),it&&Me<gn&&(Cn.length=Me),this&&this!==nr&&this instanceof Bt&&(Hl=an||sa(Hl)),Hl.apply(to,Cn)}return Bt}function rd(m,y){return function(j,O){return vp(j,m,y(O),{})}}function Mc(m,y){return function(j,O){var H;if(j===t&&O===t)return y;if(j!==t&&(H=j),O!==t){if(H===t)return O;typeof j=="string"||typeof O=="string"?(j=ji(j),O=ji(O)):(j=Df(j),O=Df(O)),H=m(j,O)}return H}}function id(m){return er(function(y){return y=Vn(y,fi(Et())),Wt(function(j){var O=this;return m(y,function(H){return Wr(H,O,j)})})})}function ad(m,y){y=y===t?" ":ji(y);var j=y.length;if(j<2)return j?Ep(y,m):y;var O=Ep(y,jc(m/si(y)));return ss(y)?Io(hi(O),0,m).join(""):O.slice(0,m)}function ey(m,y,j,O){var H=y&T,se=sa(m);function ve(){for(var ke=-1,Me=arguments.length,nt=-1,it=O.length,lt=qe(it+Me),gt=this&&this!==nr&&this instanceof ve?se:m;++nt<it;)lt[nt]=O[nt];for(;Me--;)lt[nt++]=arguments[++ke];return Wr(gt,H?j:this,lt)}return ve}function Ro(m){return function(y,j,O){return O&&typeof O!="number"&&xi(y,j,O)&&(j=O=t),y=ys(y),j===t?(j=y,y=0):j=ys(j),O=O===t?y<j?1:-1:ys(O),qg(y,j,O,m)}}function zl(m){return function(y,j){return typeof y=="string"&&typeof j=="string"||(y=ua(y),j=ua(j)),m(y,j)}}function Fp(m,y,j,O,H,se,ve,ke,Me,nt){var it=y&R,lt=it?ve:t,gt=it?t:ve,_t=it?se:t,zt=it?t:se;y|=it?$:L,y&=~(it?L:$),y&M||(y&=-4);var an=[m,y,H,_t,lt,zt,gt,ke,Me,nt],Bt=j.apply(t,an);return Vf(m)&&Yf(Bt,an),Bt.placeholder=O,Wf(Bt,m,y)}function Of(m){var y=rr[m];return function(j,O){if(j=ua(j),O=O==null?0:ir(Gt(O),292),O&&Mu(j)){var H=(Pn(j)+"e").split("e"),se=y(H[0]+"e"+(+H[1]+O));return H=(Pn(se)+"e").split("e"),+(H[0]+"e"+(+H[1]-O))}return y(j)}}var ty=un&&1/wl(new un([,-0]))[1]==ne?function(m){return new un(m)}:bt;function sd(m){return function(y){var j=$r(y);return j==Ie?zi(y):j==je?cf(y):vc(y,m(y))}}function fs(m,y,j,O,H,se,ve,ke){var Me=y&P;if(!Me&&typeof m!="function")throw new mi(l);var nt=O?O.length:0;if(nt||(y&=-97,O=H=t),ve=ve===t?ve:Zn(Gt(ve),0),ke=ke===t?ke:Gt(ke),nt-=H?H.length:0,y&L){var it=O,lt=H;O=H=t}var gt=Me?t:zf(m),_t=[m,y,j,O,H,it,lt,se,ve,ke];if(gt&&dd(_t,gt),m=_t[0],y=_t[1],j=_t[2],O=_t[3],H=_t[4],ke=_t[9]=_t[9]===t?Me?0:m.length:Zn(_t[9]-nt,0),!ke&&y&(R|z)&&(y&=-25),!y||y==T)var zt=Xg(m,y,j);else y==R||y==z?zt=Zg(m,y,ke):(y==$||y==(T|$))&&!H.length?zt=ey(m,y,j,O):zt=gr.apply(t,_t);var an=gt?Wu:Yf;return Wf(an(zt,_t),m,y)}function Lf(m,y,j,O){return m===t||Pi(m,jo[j])&&!Sn.call(O,j)?y:m}function $p(m,y,j,O,H,se){return or(m)&&or(y)&&(se.set(y,m),Yu(m,y,t,$p,se),se.delete(y)),m}function ny(m){return ca(m)?t:m}function ry(m,y,j,O,H,se){var ve=j&S,ke=m.length,Me=y.length;if(ke!=Me&&!(ve&&Me>ke))return!1;var nt=se.get(m),it=se.get(y);if(nt&&it)return nt==y&&it==m;var lt=-1,gt=!0,_t=j&k?new Bs:t;for(se.set(m,y),se.set(y,m);++lt<ke;){var zt=m[lt],an=y[lt];if(O)var Bt=ve?O(an,zt,lt,y,m,se):O(zt,an,lt,m,y,se);if(Bt!==t){if(Bt)continue;gt=!1;break}if(_t){if(!yo(y,function(gn,Cn){if(!So(_t,Cn)&&(zt===gn||H(zt,gn,j,O,se)))return _t.push(Cn)})){gt=!1;break}}else if(!(zt===an||H(zt,an,j,O,se))){gt=!1;break}}return se.delete(m),se.delete(y),gt}function iy(m,y,j,O,H,se,ve){switch(j){case Ne:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case fe:return!(m.byteLength!=y.byteLength||!se(new be(m),new be(y)));case J:case xe:case Ye:return Pi(+m,+y);case re:return m.name==y.name&&m.message==y.message;case yt:case Ge:return m==y+"";case Ie:var ke=zi;case je:var Me=O&S;if(ke||(ke=wl),m.size!=y.size&&!Me)return!1;var nt=ve.get(m);if(nt)return nt==y;O|=k,ve.set(m,y);var it=ry(ke(m),ke(y),O,H,se,ve);return ve.delete(m),it;case _e:if(Tl)return Tl.call(m)==Tl.call(y)}return!1}function Fr(m,y,j,O,H,se){var ve=j&S,ke=Ff(m),Me=ke.length,nt=Ff(y),it=nt.length;if(Me!=it&&!ve)return!1;for(var lt=Me;lt--;){var gt=ke[lt];if(!(ve?gt in y:Sn.call(y,gt)))return!1}var _t=se.get(m),zt=se.get(y);if(_t&&zt)return _t==y&&zt==m;var an=!0;se.set(m,y),se.set(y,m);for(var Bt=ve;++lt<Me;){gt=ke[lt];var gn=m[gt],Cn=y[gt];if(O)var La=ve?O(Cn,gn,gt,y,m,se):O(gn,Cn,gt,m,y,se);if(!(La===t?gn===Cn||H(gn,Cn,j,O,se):La)){an=!1;break}Bt||(Bt=gt=="constructor")}if(an&&!Bt){var Qi=m.constructor,Fa=y.constructor;Qi!=Fa&&"constructor"in m&&"constructor"in y&&!(typeof Qi=="function"&&Qi instanceof Qi&&typeof Fa=="function"&&Fa instanceof Fa)&&(an=!1)}return se.delete(m),se.delete(y),an}function er(m){return fd(Vp(m,t,Ei),m+"")}function Ff(m){return Lg(m,Rr,ld)}function $f(m){return Lg(m,zr,Uf)}var zf=kc?function(m){return kc.get(m)}:bt;function od(m){for(var y=m.name+"",j=ra[y],O=Sn.call(ra,y)?j.length:0;O--;){var H=j[O],se=H.func;if(se==null||se==m)return H.name}return y}function Bl(m){var y=Sn.call(X,"placeholder")?X:m;return y.placeholder}function Et(){var m=X.iteratee||Ot;return m=m===Ot?Np:m,arguments.length?m(arguments[0],arguments[1]):m}function Oc(m,y){var j=m.__data__;return Ws(y)?j[typeof y=="string"?"string":"hash"]:j.map}function Bf(m){for(var y=Rr(m),j=y.length;j--;){var O=y[j],H=m[O];y[j]=[O,H,ly(H)]}return y}function Mo(m,y){var j=Nc(m,y);return us(j)?j:t}function ay(m){var y=Sn.call(m,Xn),j=m[Xn];try{m[Xn]=t;var O=!0}catch{}var H=Qr.call(m);return O&&(y?m[Xn]=j:delete m[Xn]),H}var ld=ko?function(m){return m==null?[]:(m=pn(m),ri(ko(m),function(y){return ft.call(m,y)}))}:Gv,Uf=ko?function(m){for(var y=[];m;)ii(y,ld(m)),m=Te(m);return y}:Gv,$r=mn;(Ou&&$r(new Ou(new ArrayBuffer(1)))!=Ne||Er&&$r(new Er)!=Ie||ar&&$r(ar.resolve())!=Ke||un&&$r(new un)!=je||Aa&&$r(new Aa)!=ce)&&($r=function(m){var y=mn(m),j=y==Ze?m.constructor:t,O=j?Qs(j):"";if(O)switch(O){case _g:return Ne;case jg:return Ie;case Lu:return Ke;case Fu:return je;case kg:return ce}return y});function sy(m,y,j){for(var O=-1,H=j.length;++O<H;){var se=j[O],ve=se.size;switch(se.type){case"drop":m+=ve;break;case"dropRight":y-=ve;break;case"take":y=ir(y,m+ve);break;case"takeRight":m=Zn(m,y-ve);break}}return{start:m,end:y}}function zp(m){var y=m.match(Xd);return y?y[1].split(Zd):[]}function cd(m,y,j){y=Hs(y,m);for(var O=-1,H=y.length,se=!1;++O<H;){var ve=In(y[O]);if(!(se=m!=null&&j(m,ve)))break;m=m[ve]}return se||++O!=H?se:(H=m==null?0:m.length,!!H&&Vl(H)&&Ra(ve,H)&&(qt(m)||Zs(m)))}function Bp(m){var y=m.length,j=new m.constructor(y);return y&&typeof m[0]=="string"&&Sn.call(m,"index")&&(j.index=m.index,j.input=m.input),j}function Up(m){return typeof m.constructor=="function"&&!Gn(m)?Ui(Te(m)):{}}function qp(m,y,j){var O=m.constructor;switch(y){case fe:return Ol(m);case J:case xe:return new O(+m);case Ne:return Rp(m,j);case Le:case tt:case xt:case St:case we:case ye:case Oe:case De:case Ve:return Mp(m,j);case Ie:return new O;case Ye:case Ge:return new O(m);case yt:return Rf(m);case je:return new O;case _e:return Qg(m)}}function oy(m,y){var j=y.length;if(!j)return m;var O=j-1;return y[O]=(j>1?"& ":"")+y[O],y=y.join(j>2?", ":" "),m.replace(Kd,`{
/* [wrapped with `+y+`] */
`)}function Ys(m){return qt(m)||Zs(m)||!!(wt&&m&&m[wt])}function Ra(m,y){var j=typeof m;return y=y??le,!!y&&(j=="number"||j!="symbol"&&As.test(m))&&m>-1&&m%1==0&&m<y}function xi(m,y,j){if(!or(j))return!1;var O=typeof y;return(O=="number"?Dr(j)&&Ra(y,j.length):O=="string"&&y in j)?Pi(j[y],m):!1}function qf(m,y){if(qt(m))return!1;var j=typeof m;return j=="number"||j=="symbol"||j=="boolean"||m==null||bi(m)?!0:Yr.test(m)||!Kn.test(m)||y!=null&&m in pn(y)}function Ws(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Vf(m){var y=od(m),j=X[y];if(typeof j!="function"||!(y in nn.prototype))return!1;if(m===j)return!0;var O=zf(j);return!!O&&m===O[0]}function Hf(m){return!!Ru&&Ru in m}var ud=Nl?Ma:Yv;function Gn(m){var y=m&&m.constructor,j=typeof y=="function"&&y.prototype||jo;return m===j}function ly(m){return m===m&&!or(m)}function cy(m,y){return function(j){return j==null?!1:j[m]===y&&(y!==t||m in pn(j))}}function uy(m){var y=Sd(m,function(O){return j.size===u&&j.clear(),O}),j=y.cache;return y}function dd(m,y){var j=m[1],O=y[1],H=j|O,se=H<(T|P|B),ve=O==B&&j==R||O==B&&j==q&&m[7].length<=y[8]||O==(B|q)&&y[7].length<=y[8]&&j==R;if(!(se||ve))return m;O&T&&(m[2]=y[2],H|=j&T?0:M);var ke=y[3];if(ke){var Me=m[3];m[3]=Me?Op(Me,ke,y[4]):ke,m[4]=Me?Lr(m[3],h):y[4]}return ke=y[5],ke&&(Me=m[5],m[5]=Me?Kg(Me,ke,y[6]):ke,m[6]=Me?Lr(m[5],h):y[6]),ke=y[7],ke&&(m[7]=ke),O&B&&(m[8]=m[8]==null?y[8]:ir(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=H,m}function Oo(m){var y=[];if(m!=null)for(var j in pn(m))y.push(j);return y}function dy(m){return Qr.call(m)}function Vp(m,y,j){return y=Zn(y===t?m.length-1:y,0),function(){for(var O=arguments,H=-1,se=Zn(O.length-y,0),ve=qe(se);++H<se;)ve[H]=O[y+H];H=-1;for(var ke=qe(y+1);++H<y;)ke[H]=O[H];return ke[y]=j(ve),Wr(m,this,ke)}}function Lc(m,y){return y.length<2?m:aa(m,qi(y,0,-1))}function hs(m,y){for(var j=m.length,O=ir(y.length,j),H=Ar(m);O--;){var se=y[O];m[O]=Ra(se,j)?H[se]:t}return m}function Gf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Yf=hd(Wu),Fc=cp||function(m,y){return nr.setTimeout(m,y)},fd=hd(Qu);function Wf(m,y,j){var O=y+"";return fd(m,oy(O,fy(zp(O),j)))}function hd(m){var y=0,j=0;return function(){var O=zs(),H=ee-(O-j);if(j=O,H>0){if(++y>=V)return arguments[0]}else y=0;return m.apply(t,arguments)}}function pd(m,y){var j=-1,O=m.length,H=O-1;for(y=y===t?O:y;++j<y;){var se=Ef(j,H),ve=m[se];m[se]=m[j],m[j]=ve}return m.length=y,m}var ps=uy(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(hr,function(j,O,H,se){y.push(H?se.replace(va,"$1"):O||j)}),y});function In(m){if(typeof m=="string"||bi(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Qs(m){if(m!=null){try{return Cl.call(m)}catch{}try{return m+""}catch{}}return""}function fy(m,y){return ni(me,function(j){var O="_."+j[0];y&j[1]&&!rs(m,O)&&m.push(O)}),m.sort()}function Pr(m){if(m instanceof nn)return m.clone();var y=new Ni(m.__wrapped__,m.__chain__);return y.__actions__=Ar(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function uv(m,y,j){(j?xi(m,y,j):y===t)?y=1:y=Zn(Gt(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var H=0,se=0,ve=qe(jc(O/y));H<O;)ve[se++]=qi(m,H,H+=y);return ve}function hy(m){for(var y=-1,j=m==null?0:m.length,O=0,H=[];++y<j;){var se=m[y];se&&(H[O++]=se)}return H}function py(){var m=arguments.length;if(!m)return[];for(var y=qe(m-1),j=arguments[0],O=m;O--;)y[O-1]=arguments[O];return ii(qt(j)?Ar(j):[j],dn(y,1))}var sr=Wt(function(m,y){return xr(m)?Po(m,dn(y,1,xr,!0)):[]}),Ti=Wt(function(m,y){var j=ci(y);return xr(j)&&(j=t),xr(m)?Po(m,dn(y,1,xr,!0),Et(j,2)):[]}),Js=Wt(function(m,y){var j=ci(y);return xr(j)&&(j=t),xr(m)?Po(m,dn(y,1,xr,!0),t,j):[]});function my(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Gt(y),qi(m,y<0?0:y,O)):[]}function gy(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Gt(y),y=O-y,qi(m,0,y<0?0:y)):[]}function dv(m,y){return m&&m.length?Xu(m,Et(y,3),!0,!0):[]}function Hp(m,y){return m&&m.length?Xu(m,Et(y,3),!0):[]}function Hi(m,y,j,O){var H=m==null?0:m.length;return H?(j&&typeof j!="number"&&xi(m,y,j)&&(j=0,O=H),Xt(m,y,j,O)):[]}function oa(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var H=j==null?0:Gt(j);return H<0&&(H=Zn(O+H,0)),is(m,Et(y,3),H)}function Gp(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var H=O-1;return j!==t&&(H=Gt(j),H=j<0?Zn(O+H,0):ir(H,O-1)),is(m,Et(y,3),H,!0)}function Ei(m){var y=m==null?0:m.length;return y?dn(m,1):[]}function yy(m){var y=m==null?0:m.length;return y?dn(m,ne):[]}function Lo(m,y){var j=m==null?0:m.length;return j?(y=y===t?1:Gt(y),dn(m,y)):[]}function Ul(m){for(var y=-1,j=m==null?0:m.length,O={};++y<j;){var H=m[y];O[H[0]]=H[1]}return O}function Ks(m){return m&&m.length?m[0]:t}function Yp(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var H=j==null?0:Gt(j);return H<0&&(H=Zn(O+H,0)),bo(m,y,H)}function Wp(m){var y=m==null?0:m.length;return y?qi(m,0,-1):[]}var ms=Wt(function(m){var y=Vn(m,If);return y.length&&y[0]===m[0]?bp(y):[]}),xy=Wt(function(m){var y=ci(m),j=Vn(m,If);return y===ci(j)?y=t:j.pop(),j.length&&j[0]===m[0]?bp(j,Et(y,2)):[]}),$c=Wt(function(m){var y=ci(m),j=Vn(m,If);return y=typeof y=="function"?y:t,y&&j.pop(),j.length&&j[0]===m[0]?bp(j,t,y):[]});function md(m,y){return m==null?"":ta.call(m,y)}function ci(m){var y=m==null?0:m.length;return y?m[y-1]:t}function zc(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var H=O;return j!==t&&(H=Gt(j),H=H<0?Zn(O+H,0):ir(H,O-1)),y===y?ai(m,y,H):is(m,vo,H,!0)}function by(m,y){return m&&m.length?jp(m,Gt(y)):t}var vy=Wt(Bc);function Bc(m,y){return m&&m.length&&y&&y.length?Tf(m,y):m}function wy(m,y,j){return m&&m.length&&y&&y.length?Tf(m,y,Et(j,2)):m}function Qf(m,y,j){return m&&m.length&&y&&y.length?Tf(m,y,t,j):m}var Sy=er(function(m,y){var j=m==null?0:m.length,O=qu(m,y);return Tp(m,Vn(y,function(H){return Ra(H,j)?+H:H}).sort(td)),O});function fv(m,y){var j=[];if(!(m&&m.length))return j;var O=-1,H=[],se=m.length;for(y=Et(y,3);++O<se;){var ve=m[O];y(ve,O,m)&&(j.push(ve),H.push(O))}return Tp(m,H),j}function Qp(m){return m==null?m:dp.call(m)}function Mn(m,y,j){var O=m==null?0:m.length;return O?(j&&typeof j!="number"&&xi(m,y,j)?(y=0,j=O):(y=y==null?0:Gt(y),j=j===t?O:Gt(j)),qi(m,y,j)):[]}function Qn(m,y){return Ju(m,y)}function on(m,y,j){return Pf(m,y,Et(j,2))}function bn(m,y){var j=m==null?0:m.length;if(j){var O=Ju(m,y);if(O<j&&Pi(m[O],y))return O}return-1}function On(m,y){return Ju(m,y,!0)}function Gi(m,y,j){return Pf(m,y,Et(j,2),!0)}function Fo(m,y){var j=m==null?0:m.length;if(j){var O=Ju(m,y,!0)-1;if(Pi(m[O],y))return O}return-1}function Uc(m){return m&&m.length?Ap(m):[]}function Jp(m,y){return m&&m.length?Ap(m,Et(y,2)):[]}function Xs(m){var y=m==null?0:m.length;return y?qi(m,1,y):[]}function yr(m,y,j){return m&&m.length?(y=j||y===t?1:Gt(y),qi(m,0,y<0?0:y)):[]}function $o(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Gt(y),y=O-y,qi(m,y<0?0:y,O)):[]}function ql(m,y){return m&&m.length?Xu(m,Et(y,3),!1,!0):[]}function Kp(m,y){return m&&m.length?Xu(m,Et(y,3)):[]}var la=Wt(function(m){return Vs(dn(m,1,xr,!0))}),qc=Wt(function(m){var y=ci(m);return xr(y)&&(y=t),Vs(dn(m,1,xr,!0),Et(y,2))}),gd=Wt(function(m){var y=ci(m);return y=typeof y=="function"?y:t,Vs(dn(m,1,xr,!0),t,y)});function Ai(m){return m&&m.length?Vs(m):[]}function Xp(m,y){return m&&m.length?Vs(m,Et(y,2)):[]}function Zp(m,y){return y=typeof y=="function"?y:t,m&&m.length?Vs(m,t,y):[]}function Vc(m){if(!(m&&m.length))return[];var y=0;return m=ri(m,function(j){if(xr(j))return y=Zn(j.length,y),!0}),Ta(y,function(j){return Vn(m,ja(j))})}function yd(m,y){if(!(m&&m.length))return[];var j=Vc(m);return y==null?j:Vn(j,function(O){return Wr(y,t,O)})}var zo=Wt(function(m,y){return xr(m)?Po(m,y):[]}),Jr=Wt(function(m){return Zu(ri(m,xr))}),Bo=Wt(function(m){var y=ci(m);return xr(y)&&(y=t),Zu(ri(m,xr),Et(y,2))}),Hc=Wt(function(m){var y=ci(m);return y=typeof y=="function"?y:t,Zu(ri(m,xr),t,y)}),Gc=Wt(Vc);function em(m,y){return Dp(m||[],y||[],Pl)}function tm(m,y){return Dp(m||[],y||[],Rc)}var Ny=Wt(function(m){var y=m.length,j=y>1?m[y-1]:t;return j=typeof j=="function"?(m.pop(),j):t,yd(m,j)});function Yc(m){var y=X(m);return y.__chain__=!0,y}function nm(m,y){return y(m),m}function ui(m,y){return y(m)}var Cy=er(function(m){var y=m.length,j=y?m[0]:0,O=this.__wrapped__,H=function(se){return qu(se,m)};return y>1||this.__actions__.length||!(O instanceof nn)||!Ra(j)?this.thru(H):(O=O.slice(j,+j+(y?1:0)),O.__actions__.push({func:ui,args:[H],thisArg:t}),new Ni(O,this.__chain__).thru(function(se){return y&&!se.length&&se.push(t),se}))});function Yi(){return Yc(this)}function _y(){return new Ni(this.value(),this.__chain__)}function jy(){this.__values__===t&&(this.__values__=Wi(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function hv(){return this}function Uo(m){for(var y,j=this;j instanceof ia;){var O=Pr(j);O.__index__=0,O.__values__=t,y?H.__wrapped__=O:y=O;var H=O;j=j.__wrapped__}return H.__wrapped__=m,y}function Jf(){var m=this.__wrapped__;if(m instanceof nn){var y=m;return this.__actions__.length&&(y=new nn(this)),y=y.reverse(),y.__actions__.push({func:ui,args:[Qp],thisArg:t}),new Ni(y,this.__chain__)}return this.thru(Qp)}function rm(){return Gg(this.__wrapped__,this.__actions__)}var Wc=Ll(function(m,y,j){Sn.call(m,j)?++m[j]:Pa(m,j,1)});function ky(m,y,j){var O=qt(m)?xc:yp;return j&&xi(m,y,j)&&(y=t),O(m,Et(y,3))}function Ty(m,y){var j=qt(m)?ri:Rn;return j(m,Et(y,3))}var Ey=Gs(oa),im=Gs(Gp);function am(m,y){return dn(xd(m,y),1)}function pv(m,y){return dn(xd(m,y),ne)}function mv(m,y,j){return j=j===t?1:Gt(j),dn(xd(m,y),j)}function Ay(m,y){var j=qt(m)?ni:qs;return j(m,Et(y,3))}function sm(m,y){var j=qt(m)?yc:vf;return j(m,Et(y,3))}var Py=Ll(function(m,y,j){Sn.call(m,j)?m[j].push(y):Pa(m,j,[y])});function Qc(m,y,j,O){m=Dr(m)?m:nu(m),j=j&&!O?Gt(j):0;var H=m.length;return j<0&&(j=Zn(H+j,0)),lh(m)?j<=H&&m.indexOf(y,j)>-1:!!H&&bo(m,y,j)>-1}var Kf=Wt(function(m,y,j){var O=-1,H=typeof y=="function",se=Dr(m)?qe(m.length):[];return qs(m,function(ve){se[++O]=H?Wr(y,ve,j):Rl(ve,y,j)}),se}),Dy=Ll(function(m,y,j){Pa(m,j,y)});function xd(m,y){var j=qt(m)?Vn:Cp;return j(m,Et(y,3))}function Iy(m,y,j,O){return m==null?[]:(qt(y)||(y=y==null?[]:[y]),j=O?t:j,qt(j)||(j=j==null?[]:[j]),kp(m,y,j))}var Ry=Ll(function(m,y,j){m[j?0:1].push(y)},function(){return[[],[]]});function My(m,y,j){var O=qt(m)?bc:Ls,H=arguments.length<3;return O(m,Et(y,4),j,H,qs)}function Oy(m,y,j){var O=qt(m)?ku:Ls,H=arguments.length<3;return O(m,Et(y,4),j,H,vf)}function Xf(m,y){var j=qt(m)?ri:Rn;return j(m,Nd(Et(y,3)))}function Ly(m){var y=qt(m)?Ec:Ic;return y(m)}function Fy(m,y,j){(j?xi(m,y,j):y===t)?y=1:y=Gt(y);var O=qt(m)?Rg:Af;return O(m,y)}function Yn(m){var y=qt(m)?Mg:Vg;return y(m)}function om(m){if(m==null)return 0;if(Dr(m))return lh(m)?si(m):m.length;var y=$r(m);return y==Ie||y==je?m.size:Cf(m).length}function gv(m,y,j){var O=qt(m)?yo:Hg;return j&&xi(m,y,j)&&(y=t),O(m,Et(y,3))}var $y=Wt(function(m,y){if(m==null)return[];var j=y.length;return j>1&&xi(m,y[0],y[1])?y=[]:j>2&&xi(y[0],y[1],y[2])&&(y=[y[0]]),kp(m,dn(y,1),[])}),Zf=jl||function(){return nr.Date.now()};function yv(m,y){if(typeof y!="function")throw new mi(l);return m=Gt(m),function(){if(--m<1)return y.apply(this,arguments)}}function zy(m,y,j){return y=j?t:y,y=m&&y==null?m.length:y,fs(m,B,t,t,t,t,y)}function bd(m,y){var j;if(typeof y!="function")throw new mi(l);return m=Gt(m),function(){return--m>0&&(j=y.apply(this,arguments)),m<=1&&(y=t),j}}var qo=Wt(function(m,y,j){var O=T;if(j.length){var H=Lr(j,Bl(qo));O|=$}return fs(m,O,y,j,H)}),eh=Wt(function(m,y,j){var O=T|P;if(j.length){var H=Lr(j,Bl(eh));O|=$}return fs(y,O,m,j,H)});function vd(m,y,j){y=j?t:y;var O=fs(m,R,t,t,t,t,t,y);return O.placeholder=vd.placeholder,O}function th(m,y,j){y=j?t:y;var O=fs(m,z,t,t,t,t,t,y);return O.placeholder=th.placeholder,O}function Vo(m,y,j){var O,H,se,ve,ke,Me,nt=0,it=!1,lt=!1,gt=!0;if(typeof m!="function")throw new mi(l);y=ua(y)||0,or(j)&&(it=!!j.leading,lt="maxWait"in j,se=lt?Zn(ua(j.maxWait)||0,y):se,gt="trailing"in j?!!j.trailing:gt);function _t(Mr){var to=O,Hl=H;return O=H=t,nt=Mr,ve=m.apply(Hl,to),ve}function zt(Mr){return nt=Mr,ke=Fc(gn,y),it?_t(Mr):ve}function an(Mr){var to=Mr-Me,Hl=Mr-nt,_S=y-to;return lt?ir(_S,se-Hl):_S}function Bt(Mr){var to=Mr-Me,Hl=Mr-nt;return Me===t||to>=y||to<0||lt&&Hl>=se}function gn(){var Mr=Zf();if(Bt(Mr))return Cn(Mr);ke=Fc(gn,an(Mr))}function Cn(Mr){return ke=t,gt&&O?_t(Mr):(O=H=t,ve)}function La(){ke!==t&&Wg(ke),nt=0,O=Me=H=ke=t}function Qi(){return ke===t?ve:Cn(Zf())}function Fa(){var Mr=Zf(),to=Bt(Mr);if(O=arguments,H=this,Me=Mr,to){if(ke===t)return zt(Me);if(lt)return Wg(ke),ke=Fc(gn,y),_t(Me)}return ke===t&&(ke=Fc(gn,y)),ve}return Fa.cancel=La,Fa.flush=Qi,Fa}var gs=Wt(function(m,y){return Dl(m,1,y)}),wd=Wt(function(m,y,j){return Dl(m,ua(y)||0,j)});function xv(m){return fs(m,W)}function Sd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new mi(l);var j=function(){var O=arguments,H=y?y.apply(this,O):O[0],se=j.cache;if(se.has(H))return se.get(H);var ve=m.apply(this,O);return j.cache=se.set(H,ve)||se,ve};return j.cache=new(Sd.Cache||Ci),j}Sd.Cache=Ci;function Nd(m){if(typeof m!="function")throw new mi(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function By(m){return bd(2,m)}var Uy=Yg(function(m,y){y=y.length==1&&qt(y[0])?Vn(y[0],fi(Et())):Vn(dn(y,1),fi(Et()));var j=y.length;return Wt(function(O){for(var H=-1,se=ir(O.length,j);++H<se;)O[H]=y[H].call(this,O[H]);return Wr(m,this,O)})}),lm=Wt(function(m,y){var j=Lr(y,Bl(lm));return fs(m,$,t,y,j)}),nh=Wt(function(m,y){var j=Lr(y,Bl(nh));return fs(m,L,t,y,j)}),qy=er(function(m,y){return fs(m,q,t,t,t,y)});function Vy(m,y){if(typeof m!="function")throw new mi(l);return y=y===t?y:Gt(y),Wt(m,y)}function bv(m,y){if(typeof m!="function")throw new mi(l);return y=y==null?0:Zn(Gt(y),0),Wt(function(j){var O=j[y],H=Io(j,0,y);return O&&ii(H,O),Wr(m,this,H)})}function cm(m,y,j){var O=!0,H=!0;if(typeof m!="function")throw new mi(l);return or(j)&&(O="leading"in j?!!j.leading:O,H="trailing"in j?!!j.trailing:H),Vo(m,y,{leading:O,maxWait:y,trailing:H})}function um(m){return zy(m,1)}function vv(m,y){return lm(ed(y),m)}function wv(){if(!arguments.length)return[];var m=arguments[0];return qt(m)?m:[m]}function Cd(m){return oi(m,v)}function Sv(m,y){return y=typeof y=="function"?y:t,oi(m,v,y)}function Hy(m){return oi(m,g|v)}function ln(m,y){return y=typeof y=="function"?y:t,oi(m,g|v,y)}function dm(m,y){return y==null||gp(m,y,Rr(y))}function Pi(m,y){return m===y||m!==m&&y!==y}var fm=zl(Vu),Gy=zl(function(m,y){return m>=y}),Zs=wf(function(){return arguments}())?wf:function(m){return dr(m)&&Sn.call(m,"callee")&&!ft.call(m,"callee")},qt=qe.isArray,rh=yl?fi(yl):_i;function Dr(m){return m!=null&&Vl(m.length)&&!Ma(m)}function xr(m){return dr(m)&&Dr(m)}function Nv(m){return m===!0||m===!1||dr(m)&&mn(m)==J}var Ho=pf||Yv,Yy=xl?fi(xl):Cr;function Wy(m){return dr(m)&&m.nodeType===1&&!ca(m)}function ih(m){if(m==null)return!0;if(Dr(m)&&(qt(m)||typeof m=="string"||typeof m.splice=="function"||Ho(m)||Jc(m)||Zs(m)))return!m.length;var y=$r(m);if(y==Ie||y==je)return!m.size;if(Gn(m))return!Cf(m).length;for(var j in m)if(Sn.call(m,j))return!1;return!0}function zn(m,y){return Ml(m,y)}function hm(m,y,j){j=typeof j=="function"?j:t;var O=j?j(m,y):t;return O===t?Ml(m,y,t,j):!!O}function Ir(m){if(!dr(m))return!1;var y=mn(m);return y==re||y==He||typeof m.message=="string"&&typeof m.name=="string"&&!ca(m)}function Cv(m){return typeof m=="number"&&Mu(m)}function Ma(m){if(!or(m))return!1;var y=mn(m);return y==Be||y==Ae||y==K||y==st}function ah(m){return typeof m=="number"&&m==Gt(m)}function Vl(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=le}function or(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function dr(m){return m!=null&&typeof m=="object"}var sh=bl?fi(bl):Sf;function pm(m,y){return m===y||Gu(m,y,Bf(y))}function _v(m,y,j){return j=typeof j=="function"?j:t,Gu(m,y,Bf(y),j)}function Qy(m){return Ky(m)&&m!=+m}function jv(m){if(ud(m))throw new Pt(o);return us(m)}function Jy(m){return m===null}function kv(m){return m==null}function Ky(m){return typeof m=="number"||dr(m)&&mn(m)==Ye}function ca(m){if(!dr(m)||mn(m)!=Ze)return!1;var y=Te(m);if(y===null)return!0;var j=Sn.call(y,"constructor")&&y.constructor;return typeof j=="function"&&j instanceof j&&Cl.call(j)==wi}var oh=rf?fi(rf):Nf;function mm(m){return ah(m)&&m>=-9007199254740991&&m<=le}var Xy=mc?fi(mc):wp;function lh(m){return typeof m=="string"||!qt(m)&&dr(m)&&mn(m)==Ge}function bi(m){return typeof m=="symbol"||dr(m)&&mn(m)==_e}var Jc=gc?fi(gc):Sp;function Oa(m){return m===t}function gm(m){return dr(m)&&$r(m)==ce}function Zy(m){return dr(m)&&mn(m)==G}var ex=zl(_f),_d=zl(function(m,y){return m<=y});function Wi(m){if(!m)return[];if(Dr(m))return lh(m)?hi(m):Ar(m);if(pr&&m[pr])return lf(m[pr]());var y=$r(m),j=y==Ie?zi:y==je?wl:nu;return j(m)}function ys(m){if(!m)return m===0?m:0;if(m=ua(m),m===ne||m===-1/0){var y=m<0?-1:1;return y*oe}return m===m?m:0}function Gt(m){var y=ys(m),j=y%1;return y===y?j?y-j:y:0}function xs(m){return m?Da(Gt(m),0,de):0}function ua(m){if(typeof m=="number")return m;if(bi(m))return E;if(or(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=or(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=Pu(m);var j=Nr.test(m);return j||tf.test(m)?gl(m.slice(2),j?2:8):Es.test(m)?E:+m}function tx(m){return ki(m,zr(m))}function Kc(m){return m?Da(Gt(m),-9007199254740991,le):m===0?m:0}function Pn(m){return m==null?"":ji(m)}var Tv=Fl(function(m,y){if(Gn(y)||Dr(y)){ki(y,Rr(y),m);return}for(var j in y)Sn.call(y,j)&&Pl(m,j,y[j])}),nx=Fl(function(m,y){ki(y,zr(y),m)}),ch=Fl(function(m,y,j,O){ki(y,zr(y),m,O)}),Ev=Fl(function(m,y,j,O){ki(y,Rr(y),m,O)}),Av=er(qu);function Pv(m,y){var j=Ui(m);return y==null?j:Us(j,y)}var Dv=Wt(function(m,y){m=pn(m);var j=-1,O=y.length,H=O>2?y[2]:t;for(H&&xi(y[0],y[1],H)&&(O=1);++j<O;)for(var se=y[j],ve=zr(se),ke=-1,Me=ve.length;++ke<Me;){var nt=ve[ke],it=m[nt];(it===t||Pi(it,jo[nt])&&!Sn.call(m,nt))&&(m[nt]=se[nt])}return m}),rx=Wt(function(m){return m.push(t,$p),Wr(Ed,t,m)});function Xc(m,y){return Tu(m,Et(y,3),li)}function jd(m,y){return Tu(m,Et(y,3),Dc)}function ix(m,y){return m==null?m:Pc(m,Et(y,3),zr)}function Iv(m,y){return m==null?m:Il(m,Et(y,3),zr)}function Zc(m,y){return m&&li(m,Et(y,3))}function kd(m,y){return m&&Dc(m,Et(y,3))}function ax(m){return m==null?[]:Do(m,Rr(m))}function uh(m){return m==null?[]:Do(m,zr(m))}function Td(m,y,j){var O=m==null?t:aa(m,y);return O===t?j:O}function ym(m,y){return m!=null&&cd(m,y,xp)}function eu(m,y){return m!=null&&cd(m,y,Fg)}var sx=rd(function(m,y,j){y!=null&&typeof y.toString!="function"&&(y=Qr.call(y)),m[y]=j},$e(ze)),ox=rd(function(m,y,j){y!=null&&typeof y.toString!="function"&&(y=Qr.call(y)),Sn.call(m,y)?m[y].push(j):m[y]=[j]},Et),Rv=Wt(Rl);function Rr(m){return Dr(m)?mp(m):Cf(m)}function zr(m){return Dr(m)?mp(m,!0):zg(m)}function Mv(m,y){var j={};return y=Et(y,3),li(m,function(O,H,se){Pa(j,y(O,H,se),O)}),j}function Ov(m,y){var j={};return y=Et(y,3),li(m,function(O,H,se){Pa(j,H,y(O,H,se))}),j}var Lv=Fl(function(m,y,j){Yu(m,y,j)}),Ed=Fl(function(m,y,j,O){Yu(m,y,j,O)}),dh=er(function(m,y){var j={};if(m==null)return j;var O=!1;y=Vn(y,function(se){return se=Hs(se,m),O||(O=se.length>1),se}),ki(m,$f(m),j),O&&(j=oi(j,g|b|v,ny));for(var H=y.length;H--;)Ku(j,y[H]);return j});function xm(m,y){return tu(m,Nd(Et(y)))}var Fv=er(function(m,y){return m==null?{}:Bg(m,y)});function tu(m,y){if(m==null)return{};var j=Vn($f(m),function(O){return[O]});return y=Et(y),kf(m,j,function(O,H){return y(O,H[0])})}function $v(m,y,j){y=Hs(y,m);var O=-1,H=y.length;for(H||(H=1,m=t);++O<H;){var se=m==null?t:m[In(y[O])];se===t&&(O=H,se=j),m=Ma(se)?se.call(m):se}return m}function lx(m,y,j){return m==null?m:Rc(m,y,j)}function cx(m,y,j,O){return O=typeof O=="function"?O:t,m==null?m:Rc(m,y,j,O)}var bm=sd(Rr),vm=sd(zr);function wm(m,y,j){var O=qt(m),H=O||Ho(m)||Jc(m);if(y=Et(y,4),j==null){var se=m&&m.constructor;H?j=O?new se:[]:or(m)?j=Ma(se)?Ui(Te(m)):{}:j={}}return(H?ni:li)(m,function(ve,ke,Me){return y(j,ve,ke,Me)}),j}function ux(m,y){return m==null?!0:Ku(m,y)}function fh(m,y,j){return m==null?m:Pp(m,y,ed(j))}function zv(m,y,j,O){return O=typeof O=="function"?O:t,m==null?m:Pp(m,y,ed(j),O)}function nu(m){return m==null?[]:wc(m,Rr(m))}function Sm(m){return m==null?[]:wc(m,zr(m))}function Nm(m,y,j){return j===t&&(j=y,y=t),j!==t&&(j=ua(j),j=j===j?j:0),y!==t&&(y=ua(y),y=y===y?y:0),Da(ua(m),y,j)}function hh(m,y,j){return y=ys(y),j===t?(j=y,y=0):j=ys(j),m=ua(m),$g(m,y,j)}function Cm(m,y,j){if(j&&typeof j!="boolean"&&xi(m,y,j)&&(y=j=t),j===t&&(typeof y=="boolean"?(j=y,y=t):typeof m=="boolean"&&(j=m,m=t)),m===t&&y===t?(m=0,y=1):(m=ys(m),y===t?(y=m,m=0):y=ys(y)),m>y){var O=m;m=y,y=O}if(j||m%1||y%1){var H=up();return ir(m+H*(y-m+Os("1e-"+((H+"").length-1))),y)}return Ef(m,y)}var dx=yi(function(m,y,j){return y=y.toLowerCase(),m+(j?ph(y):y)});function ph(m){return x(Pn(m).toLowerCase())}function eo(m){return m=Pn(m),m&&m.replace(co,Sc).replace($i,"")}function Go(m,y,j){m=Pn(m),y=ji(y);var O=m.length;j=j===t?O:Da(Gt(j),0,O);var H=j;return j-=y.length,j>=0&&m.slice(j,H)==y}function Yo(m){return m=Pn(m),m&&Tt.test(m)?m.replace(fn,sf):m}function Ad(m){return m=Pn(m),m&&Sr.test(m)?m.replace(An,"\\$&"):m}var Pd=yi(function(m,y,j){return m+(j?"-":"")+y.toLowerCase()}),Wo=yi(function(m,y,j){return m+(j?" ":"")+y.toLowerCase()}),Bv=Vi("toLowerCase");function fx(m,y,j){m=Pn(m),y=Gt(y);var O=y?si(m):0;if(!y||O>=y)return m;var H=(y-O)/2;return ad($s(H),j)+m+ad(jc(H),j)}function Dd(m,y,j){m=Pn(m),y=Gt(y);var O=y?si(m):0;return y&&O<y?m+ad(y-O,j):m}function Uv(m,y,j){m=Pn(m),y=Gt(y);var O=y?si(m):0;return y&&O<y?ad(y-O,j)+m:m}function hx(m,y,j){return j||y==null?y=0:y&&(y=+y),kl(Pn(m).replace(Xr,""),y||0)}function mh(m,y,j){return(j?xi(m,y,j):y===t)?y=1:y=Gt(y),Ep(Pn(m),y)}function px(){var m=arguments,y=Pn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var qv=yi(function(m,y,j){return m+(j?"_":"")+y.toLowerCase()});function gh(m,y,j){return j&&typeof j!="number"&&xi(m,y,j)&&(y=j=t),j=j===t?de:j>>>0,j?(m=Pn(m),m&&(typeof y=="string"||y!=null&&!oh(y))&&(y=ji(y),!y&&ss(m))?Io(hi(m),0,j):m.split(y,j)):[]}var yh=yi(function(m,y,j){return m+(j?" ":"")+x(y)});function mx(m,y,j){return m=Pn(m),j=j==null?0:Da(Gt(j),0,m.length),y=ji(y),m.slice(j,j+y.length)==y}function Id(m,y,j){var O=X.templateSettings;j&&xi(m,y,j)&&(y=t),m=Pn(m),y=ch({},y,O,Lf);var H=ch({},y.imports,O.imports,Lf),se=Rr(H),ve=wc(H,se),ke,Me,nt=0,it=y.interpolate||ec,lt="__p += '",gt=pi((y.escape||ec).source+"|"+it.source+"|"+(it===It?ks:ec).source+"|"+(y.evaluate||ec).source+"|$","g"),_t="//# sourceURL="+(Sn.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ea+"]")+`
`;m.replace(gt,function(Bt,gn,Cn,La,Qi,Fa){return Cn||(Cn=La),lt+=m.slice(nt,Fa).replace(nf,of),gn&&(ke=!0,lt+=`' +
__e(`+gn+`) +
'`),Qi&&(Me=!0,lt+=`';
`+Qi+`;
__p += '`),Cn&&(lt+=`' +
((__t = (`+Cn+`)) == null ? '' : __t) +
'`),nt=Fa+Bt.length,Bt}),lt+=`';
`;var zt=Sn.call(y,"variable")&&y.variable;if(!zt)lt=`with (obj) {
`+lt+`
}
`;else if(xu.test(zt))throw new Pt(d);lt=(Me?lt.replace(ot,""):lt).replace(mt,"$1").replace(Nt,"$1;"),lt="function("+(zt||"obj")+`) {
`+(zt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ke?", __e = _.escape":"")+(Me?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+lt+`return __p
}`;var an=A(function(){return hn(se,_t+"return "+lt).apply(t,ve)});if(an.source=lt,Ir(an))throw an;return an}function _m(m){return Pn(m).toLowerCase()}function xh(m){return Pn(m).toUpperCase()}function gx(m,y,j){if(m=Pn(m),m&&(j||y===t))return Pu(m);if(!m||!(y=ji(y)))return m;var O=hi(m),H=hi(y),se=No(O,H),ve=Co(O,H)+1;return Io(O,se,ve).join("")}function Vv(m,y,j){if(m=Pn(m),m&&(j||y===t))return m.slice(0,Cc(m)+1);if(!m||!(y=ji(y)))return m;var O=hi(m),H=Co(O,hi(y))+1;return Io(O,0,H).join("")}function bh(m,y,j){if(m=Pn(m),m&&(j||y===t))return m.replace(Xr,"");if(!m||!(y=ji(y)))return m;var O=hi(m),H=No(O,hi(y));return Io(O,H).join("")}function s(m,y){var j=I,O=F;if(or(y)){var H="separator"in y?y.separator:H;j="length"in y?Gt(y.length):j,O="omission"in y?ji(y.omission):O}m=Pn(m);var se=m.length;if(ss(m)){var ve=hi(m);se=ve.length}if(j>=se)return m;var ke=j-si(O);if(ke<1)return O;var Me=ve?Io(ve,0,ke).join(""):m.slice(0,ke);if(H===t)return Me+O;if(ve&&(ke+=Me.length-ke),oh(H)){if(m.slice(ke).search(H)){var nt,it=Me;for(H.global||(H=pi(H.source,Pn(Ts.exec(H))+"g")),H.lastIndex=0;nt=H.exec(it);)var lt=nt.index;Me=Me.slice(0,lt===t?ke:lt)}}else if(m.indexOf(ji(H),ke)!=ke){var gt=Me.lastIndexOf(H);gt>-1&&(Me=Me.slice(0,gt))}return Me+O}function c(m){return m=Pn(m),m&&wn.test(m)?m.replace(cn,df):m}var p=yi(function(m,y,j){return m+(j?" ":"")+y.toUpperCase()}),x=Vi("toUpperCase");function N(m,y,j){return m=Pn(m),y=j?t:y,y===t?vl(m)?op(m):ap(m):m.match(y)||[]}var A=Wt(function(m,y){try{return Wr(m,t,y)}catch(j){return Ir(j)?j:new Pt(j)}}),U=er(function(m,y){return ni(y,function(j){j=In(j),Pa(m,j,qo(m[j],m))}),m});function Z(m){var y=m==null?0:m.length,j=Et();return m=y?Vn(m,function(O){if(typeof O[1]!="function")throw new mi(l);return[j(O[0]),O[1]]}):[],Wt(function(O){for(var H=-1;++H<y;){var se=m[H];if(Wr(se[0],this,O))return Wr(se[1],this,O)}})}function Se(m){return Og(oi(m,g))}function $e(m){return function(){return m}}function Je(m,y){return m==null||m!==m?y:m}var rt=ds(),Ue=ds(!0);function ze(m){return m}function Ot(m){return Np(typeof m=="function"?m:oi(m,g))}function Mt(m){return _p(oi(m,g))}function Bn(m,y){return jf(m,oi(y,g))}var Re=Wt(function(m,y){return function(j){return Rl(j,m,y)}}),Ee=Wt(function(m,y){return function(j){return Rl(m,j,y)}});function Fe(m,y,j){var O=Rr(y),H=Do(y,O);j==null&&!(or(y)&&(H.length||!O.length))&&(j=y,y=m,m=this,H=Do(y,Rr(y)));var se=!(or(j)&&"chain"in j)||!!j.chain,ve=Ma(m);return ni(H,function(ke){var Me=y[ke];m[ke]=Me,ve&&(m.prototype[ke]=function(){var nt=this.__chain__;if(se||nt){var it=m(this.__wrapped__),lt=it.__actions__=Ar(this.__actions__);return lt.push({func:Me,args:arguments,thisArg:m}),it.__chain__=nt,it}return Me.apply(m,ii([this.value()],arguments))})}),m}function Xe(){return nr._===this&&(nr._=Fs),this}function bt(){}function rn(m){return m=Gt(m),Wt(function(y){return jp(y,m)})}var jt=id(Vn),Lt=id(xc),Br=id(yo);function Nn(m){return qf(m)?ja(In(m)):Ug(m)}function Qo(m){return function(y){return m==null?t:aa(m,y)}}var Hv=Ro(),JA=Ro(!0);function Gv(){return[]}function Yv(){return!1}function KA(){return{}}function XA(){return""}function ZA(){return!0}function eP(m,y){if(m=Gt(m),m<1||m>le)return[];var j=de,O=ir(m,de);y=Et(y),m-=de;for(var H=Ta(O,y);++j<m;)y(j);return H}function tP(m){return qt(m)?Vn(m,In):bi(m)?[m]:Ar(ps(Pn(m)))}function nP(m){var y=++Bi;return Pn(m)+y}var rP=Mc(function(m,y){return m+y},0),iP=Of("ceil"),aP=Mc(function(m,y){return m/y},1),sP=Of("floor");function oP(m){return m&&m.length?Ia(m,ze,Vu):t}function lP(m,y){return m&&m.length?Ia(m,Et(y,2),Vu):t}function cP(m){return Eu(m,ze)}function uP(m,y){return Eu(m,Et(y,2))}function dP(m){return m&&m.length?Ia(m,ze,_f):t}function fP(m,y){return m&&m.length?Ia(m,Et(y,2),_f):t}var hP=Mc(function(m,y){return m*y},1),pP=Of("round"),mP=Mc(function(m,y){return m-y},0);function gP(m){return m&&m.length?wo(m,ze):0}function yP(m,y){return m&&m.length?wo(m,Et(y,2)):0}return X.after=yv,X.ary=zy,X.assign=Tv,X.assignIn=nx,X.assignInWith=ch,X.assignWith=Ev,X.at=Av,X.before=bd,X.bind=qo,X.bindAll=U,X.bindKey=eh,X.castArray=wv,X.chain=Yc,X.chunk=uv,X.compact=hy,X.concat=py,X.cond=Z,X.conforms=Se,X.constant=$e,X.countBy=Wc,X.create=Pv,X.curry=vd,X.curryRight=th,X.debounce=Vo,X.defaults=Dv,X.defaultsDeep=rx,X.defer=gs,X.delay=wd,X.difference=sr,X.differenceBy=Ti,X.differenceWith=Js,X.drop=my,X.dropRight=gy,X.dropRightWhile=dv,X.dropWhile=Hp,X.fill=Hi,X.filter=Ty,X.flatMap=am,X.flatMapDeep=pv,X.flatMapDepth=mv,X.flatten=Ei,X.flattenDeep=yy,X.flattenDepth=Lo,X.flip=xv,X.flow=rt,X.flowRight=Ue,X.fromPairs=Ul,X.functions=ax,X.functionsIn=uh,X.groupBy=Py,X.initial=Wp,X.intersection=ms,X.intersectionBy=xy,X.intersectionWith=$c,X.invert=sx,X.invertBy=ox,X.invokeMap=Kf,X.iteratee=Ot,X.keyBy=Dy,X.keys=Rr,X.keysIn=zr,X.map=xd,X.mapKeys=Mv,X.mapValues=Ov,X.matches=Mt,X.matchesProperty=Bn,X.memoize=Sd,X.merge=Lv,X.mergeWith=Ed,X.method=Re,X.methodOf=Ee,X.mixin=Fe,X.negate=Nd,X.nthArg=rn,X.omit=dh,X.omitBy=xm,X.once=By,X.orderBy=Iy,X.over=jt,X.overArgs=Uy,X.overEvery=Lt,X.overSome=Br,X.partial=lm,X.partialRight=nh,X.partition=Ry,X.pick=Fv,X.pickBy=tu,X.property=Nn,X.propertyOf=Qo,X.pull=vy,X.pullAll=Bc,X.pullAllBy=wy,X.pullAllWith=Qf,X.pullAt=Sy,X.range=Hv,X.rangeRight=JA,X.rearg=qy,X.reject=Xf,X.remove=fv,X.rest=Vy,X.reverse=Qp,X.sampleSize=Fy,X.set=lx,X.setWith=cx,X.shuffle=Yn,X.slice=Mn,X.sortBy=$y,X.sortedUniq=Uc,X.sortedUniqBy=Jp,X.split=gh,X.spread=bv,X.tail=Xs,X.take=yr,X.takeRight=$o,X.takeRightWhile=ql,X.takeWhile=Kp,X.tap=nm,X.throttle=cm,X.thru=ui,X.toArray=Wi,X.toPairs=bm,X.toPairsIn=vm,X.toPath=tP,X.toPlainObject=tx,X.transform=wm,X.unary=um,X.union=la,X.unionBy=qc,X.unionWith=gd,X.uniq=Ai,X.uniqBy=Xp,X.uniqWith=Zp,X.unset=ux,X.unzip=Vc,X.unzipWith=yd,X.update=fh,X.updateWith=zv,X.values=nu,X.valuesIn=Sm,X.without=zo,X.words=N,X.wrap=vv,X.xor=Jr,X.xorBy=Bo,X.xorWith=Hc,X.zip=Gc,X.zipObject=em,X.zipObjectDeep=tm,X.zipWith=Ny,X.entries=bm,X.entriesIn=vm,X.extend=nx,X.extendWith=ch,Fe(X,X),X.add=rP,X.attempt=A,X.camelCase=dx,X.capitalize=ph,X.ceil=iP,X.clamp=Nm,X.clone=Cd,X.cloneDeep=Hy,X.cloneDeepWith=ln,X.cloneWith=Sv,X.conformsTo=dm,X.deburr=eo,X.defaultTo=Je,X.divide=aP,X.endsWith=Go,X.eq=Pi,X.escape=Yo,X.escapeRegExp=Ad,X.every=ky,X.find=Ey,X.findIndex=oa,X.findKey=Xc,X.findLast=im,X.findLastIndex=Gp,X.findLastKey=jd,X.floor=sP,X.forEach=Ay,X.forEachRight=sm,X.forIn=ix,X.forInRight=Iv,X.forOwn=Zc,X.forOwnRight=kd,X.get=Td,X.gt=fm,X.gte=Gy,X.has=ym,X.hasIn=eu,X.head=Ks,X.identity=ze,X.includes=Qc,X.indexOf=Yp,X.inRange=hh,X.invoke=Rv,X.isArguments=Zs,X.isArray=qt,X.isArrayBuffer=rh,X.isArrayLike=Dr,X.isArrayLikeObject=xr,X.isBoolean=Nv,X.isBuffer=Ho,X.isDate=Yy,X.isElement=Wy,X.isEmpty=ih,X.isEqual=zn,X.isEqualWith=hm,X.isError=Ir,X.isFinite=Cv,X.isFunction=Ma,X.isInteger=ah,X.isLength=Vl,X.isMap=sh,X.isMatch=pm,X.isMatchWith=_v,X.isNaN=Qy,X.isNative=jv,X.isNil=kv,X.isNull=Jy,X.isNumber=Ky,X.isObject=or,X.isObjectLike=dr,X.isPlainObject=ca,X.isRegExp=oh,X.isSafeInteger=mm,X.isSet=Xy,X.isString=lh,X.isSymbol=bi,X.isTypedArray=Jc,X.isUndefined=Oa,X.isWeakMap=gm,X.isWeakSet=Zy,X.join=md,X.kebabCase=Pd,X.last=ci,X.lastIndexOf=zc,X.lowerCase=Wo,X.lowerFirst=Bv,X.lt=ex,X.lte=_d,X.max=oP,X.maxBy=lP,X.mean=cP,X.meanBy=uP,X.min=dP,X.minBy=fP,X.stubArray=Gv,X.stubFalse=Yv,X.stubObject=KA,X.stubString=XA,X.stubTrue=ZA,X.multiply=hP,X.nth=by,X.noConflict=Xe,X.noop=bt,X.now=Zf,X.pad=fx,X.padEnd=Dd,X.padStart=Uv,X.parseInt=hx,X.random=Cm,X.reduce=My,X.reduceRight=Oy,X.repeat=mh,X.replace=px,X.result=$v,X.round=pP,X.runInContext=Pe,X.sample=Ly,X.size=om,X.snakeCase=qv,X.some=gv,X.sortedIndex=Qn,X.sortedIndexBy=on,X.sortedIndexOf=bn,X.sortedLastIndex=On,X.sortedLastIndexBy=Gi,X.sortedLastIndexOf=Fo,X.startCase=yh,X.startsWith=mx,X.subtract=mP,X.sum=gP,X.sumBy=yP,X.template=Id,X.times=eP,X.toFinite=ys,X.toInteger=Gt,X.toLength=xs,X.toLower=_m,X.toNumber=ua,X.toSafeInteger=Kc,X.toString=Pn,X.toUpper=xh,X.trim=gx,X.trimEnd=Vv,X.trimStart=bh,X.truncate=s,X.unescape=c,X.uniqueId=nP,X.upperCase=p,X.upperFirst=x,X.each=Ay,X.eachRight=sm,X.first=Ks,Fe(X,function(){var m={};return li(X,function(y,j){Sn.call(X.prototype,j)||(m[j]=y)}),m}(),{chain:!1}),X.VERSION=r,ni(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){X[m].placeholder=X}),ni(["drop","take"],function(m,y){nn.prototype[m]=function(j){j=j===t?1:Zn(Gt(j),0);var O=this.__filtered__&&!y?new nn(this):this.clone();return O.__filtered__?O.__takeCount__=ir(j,O.__takeCount__):O.__views__.push({size:ir(j,de),type:m+(O.__dir__<0?"Right":"")}),O},nn.prototype[m+"Right"]=function(j){return this.reverse()[m](j).reverse()}}),ni(["filter","map","takeWhile"],function(m,y){var j=y+1,O=j==ie||j==Q;nn.prototype[m]=function(H){var se=this.clone();return se.__iteratees__.push({iteratee:Et(H,3),type:j}),se.__filtered__=se.__filtered__||O,se}}),ni(["head","last"],function(m,y){var j="take"+(y?"Right":"");nn.prototype[m]=function(){return this[j](1).value()[0]}}),ni(["initial","tail"],function(m,y){var j="drop"+(y?"":"Right");nn.prototype[m]=function(){return this.__filtered__?new nn(this):this[j](1)}}),nn.prototype.compact=function(){return this.filter(ze)},nn.prototype.find=function(m){return this.filter(m).head()},nn.prototype.findLast=function(m){return this.reverse().find(m)},nn.prototype.invokeMap=Wt(function(m,y){return typeof m=="function"?new nn(this):this.map(function(j){return Rl(j,m,y)})}),nn.prototype.reject=function(m){return this.filter(Nd(Et(m)))},nn.prototype.slice=function(m,y){m=Gt(m);var j=this;return j.__filtered__&&(m>0||y<0)?new nn(j):(m<0?j=j.takeRight(-m):m&&(j=j.drop(m)),y!==t&&(y=Gt(y),j=y<0?j.dropRight(-y):j.take(y-m)),j)},nn.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},nn.prototype.toArray=function(){return this.take(de)},li(nn.prototype,function(m,y){var j=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),H=X[O?"take"+(y=="last"?"Right":""):y],se=O||/^find/.test(y);H&&(X.prototype[y]=function(){var ve=this.__wrapped__,ke=O?[1]:arguments,Me=ve instanceof nn,nt=ke[0],it=Me||qt(ve),lt=function(gn){var Cn=H.apply(X,ii([gn],ke));return O&&gt?Cn[0]:Cn};it&&j&&typeof nt=="function"&&nt.length!=1&&(Me=it=!1);var gt=this.__chain__,_t=!!this.__actions__.length,zt=se&&!gt,an=Me&&!_t;if(!se&&it){ve=an?ve:new nn(this);var Bt=m.apply(ve,ke);return Bt.__actions__.push({func:ui,args:[lt],thisArg:t}),new Ni(Bt,gt)}return zt&&an?m.apply(this,ke):(Bt=this.thru(lt),zt?O?Bt.value()[0]:Bt.value():Bt)})}),ni(["pop","push","shift","sort","splice","unshift"],function(m){var y=Sl[m],j=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);X.prototype[m]=function(){var H=arguments;if(O&&!this.__chain__){var se=this.value();return y.apply(qt(se)?se:[],H)}return this[j](function(ve){return y.apply(qt(ve)?ve:[],H)})}}),li(nn.prototype,function(m,y){var j=X[y];if(j){var O=j.name+"";Sn.call(ra,O)||(ra[O]=[]),ra[O].push({name:y,func:j})}}),ra[gr(t,P).name]=[{name:"wrapper",func:t}],nn.prototype.clone=$u,nn.prototype.reverse=mf,nn.prototype.value=El,X.prototype.at=Cy,X.prototype.chain=Yi,X.prototype.commit=_y,X.prototype.next=jy,X.prototype.plant=Uo,X.prototype.reverse=Jf,X.prototype.toJSON=X.prototype.valueOf=X.prototype.value=rm,X.prototype.first=X.prototype.head,pr&&(X.prototype[pr]=hv),X},os=_o();_a?((_a.exports=os)._=os,ns._=os):nr._=os}).call(PH)}(Vm,Vm.exports)),Vm.exports}var HT=DH();class IH{constructor(n){Jn(this,"sampleRate",24e3);Jn(this,"bufferSize",7680);Jn(this,"audioQueue",[]);Jn(this,"isPlaying",!1);Jn(this,"isStreamComplete",!1);Jn(this,"checkInterval",null);Jn(this,"scheduledTime",0);Jn(this,"initialBufferTime",.1);Jn(this,"gainNode");Jn(this,"source");Jn(this,"endOfQueueAudioSource",null);Jn(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=Ax.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(Ax.set(this.context,{}),a=Ax.get(this.context)),a[n]={handlers:[r]};const o=q1(n,t);await this.context.audioWorklet.addModule(o);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const o=r.getInt16(a*2,!0);t[a]=o/32768}catch(o){console.error(o)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const o=Ax.get(this.context);o&&Object.entries(o).forEach(([,d])=>{const{node:f,handlers:u}=d;f&&(a.connect(f),f.port.onmessage=function(h){u.forEach(g=>{g.call(f.port,h)})},f.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function GT(e,n){return function(){return e.apply(n,arguments)}}const{toString:RH}=Object.prototype,{getPrototypeOf:iS}=Object,Yb=(e=>n=>{const t=RH.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),lo=e=>(e=e.toLowerCase(),n=>Yb(n)===e),Wb=e=>n=>typeof n===e,{isArray:ep}=Array,og=Wb("undefined");function MH(e){return e!==null&&!og(e)&&e.constructor!==null&&!og(e.constructor)&&Ya(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const YT=lo("ArrayBuffer");function OH(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&YT(e.buffer),n}const LH=Wb("string"),Ya=Wb("function"),WT=Wb("number"),Qb=e=>e!==null&&typeof e=="object",FH=e=>e===!0||e===!1,Kx=e=>{if(Yb(e)!=="object")return!1;const n=iS(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},$H=lo("Date"),zH=lo("File"),BH=lo("Blob"),UH=lo("FileList"),qH=e=>Qb(e)&&Ya(e.pipe),VH=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Ya(e.append)&&((n=Yb(e))==="formdata"||n==="object"&&Ya(e.toString)&&e.toString()==="[object FormData]"))},HH=lo("URLSearchParams"),[GH,YH,WH,QH]=["ReadableStream","Request","Response","Headers"].map(lo),JH=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function bg(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),ep(e))for(r=0,a=e.length;r<a;r++)n.call(null,e[r],r,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let d;for(r=0;r<l;r++)d=o[r],n.call(null,e[d],d,e)}}function QT(e,n){n=n.toLowerCase();const t=Object.keys(e);let r=t.length,a;for(;r-- >0;)if(a=t[r],n===a.toLowerCase())return a;return null}const Fd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,JT=e=>!og(e)&&e!==Fd;function V1(){const{caseless:e}=JT(this)&&this||{},n={},t=(r,a)=>{const o=e&&QT(n,a)||a;Kx(n[o])&&Kx(r)?n[o]=V1(n[o],r):Kx(r)?n[o]=V1({},r):ep(r)?n[o]=r.slice():n[o]=r};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&bg(arguments[r],t);return n}const KH=(e,n,t,{allOwnKeys:r}={})=>(bg(n,(a,o)=>{t&&Ya(a)?e[o]=GT(a,t):e[o]=a},{allOwnKeys:r}),e),XH=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),ZH=(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},eG=(e,n,t,r)=>{let a,o,l;const d={};if(n=n||{},e==null)return n;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)l=a[o],(!r||r(l,e,n))&&!d[l]&&(n[l]=e[l],d[l]=!0);e=t!==!1&&iS(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},tG=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const r=e.indexOf(n,t);return r!==-1&&r===t},nG=e=>{if(!e)return null;if(ep(e))return e;let n=e.length;if(!WT(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},rG=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&iS(Uint8Array)),iG=(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=r.next())&&!a.done;){const o=a.value;n.call(e,o[0],o[1])}},aG=(e,n)=>{let t;const r=[];for(;(t=e.exec(n))!==null;)r.push(t);return r},sG=lo("HTMLFormElement"),oG=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,a){return r.toUpperCase()+a}),C_=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),lG=lo("RegExp"),KT=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};bg(t,(a,o)=>{let l;(l=n(a,o,e))!==!1&&(r[o]=l||a)}),Object.defineProperties(e,r)},cG=e=>{KT(e,(n,t)=>{if(Ya(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if(Ya(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},uG=(e,n)=>{const t={},r=a=>{a.forEach(o=>{t[o]=!0})};return ep(e)?r(e):r(String(e).split(n)),t},dG=()=>{},fG=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function hG(e){return!!(e&&Ya(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const pG=e=>{const n=new Array(10),t=(r,a)=>{if(Qb(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[a]=r;const o=ep(r)?[]:{};return bg(r,(l,d)=>{const f=t(l,a+1);!og(f)&&(o[d]=f)}),n[a]=void 0,o}}return r};return t(e,0)},mG=lo("AsyncFunction"),gG=e=>e&&(Qb(e)||Ya(e))&&Ya(e.then)&&Ya(e.catch),XT=((e,n)=>e?setImmediate:n?((t,r)=>(Fd.addEventListener("message",({source:a,data:o})=>{a===Fd&&o===t&&r.length&&r.shift()()},!1),a=>{r.push(a),Fd.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Ya(Fd.postMessage)),yG=typeof queueMicrotask<"u"?queueMicrotask.bind(Fd):typeof process<"u"&&process.nextTick||XT,We={isArray:ep,isArrayBuffer:YT,isBuffer:MH,isFormData:VH,isArrayBufferView:OH,isString:LH,isNumber:WT,isBoolean:FH,isObject:Qb,isPlainObject:Kx,isReadableStream:GH,isRequest:YH,isResponse:WH,isHeaders:QH,isUndefined:og,isDate:$H,isFile:zH,isBlob:BH,isRegExp:lG,isFunction:Ya,isStream:qH,isURLSearchParams:HH,isTypedArray:rG,isFileList:UH,forEach:bg,merge:V1,extend:KH,trim:JH,stripBOM:XH,inherits:ZH,toFlatObject:eG,kindOf:Yb,kindOfTest:lo,endsWith:tG,toArray:nG,forEachEntry:iG,matchAll:aG,isHTMLForm:sG,hasOwnProperty:C_,hasOwnProp:C_,reduceDescriptors:KT,freezeMethods:cG,toObjectSet:uG,toCamelCase:oG,noop:dG,toFiniteNumber:fG,findKey:QT,global:Fd,isContextDefined:JT,isSpecCompliantForm:hG,toJSONObject:pG,isAsyncFn:mG,isThenable:gG,setImmediate:XT,asap:yG};function Kt(e,n,t,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}We.inherits(Kt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:We.toJSONObject(this.config),code:this.code,status:this.status}}});const ZT=Kt.prototype,eE={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{eE[e]={value:e}});Object.defineProperties(Kt,eE);Object.defineProperty(ZT,"isAxiosError",{value:!0});Kt.from=(e,n,t,r,a,o)=>{const l=Object.create(ZT);return We.toFlatObject(e,l,function(f){return f!==Error.prototype},d=>d!=="isAxiosError"),Kt.call(l,e.message,n,t,r,a),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const xG=null;function H1(e){return We.isPlainObject(e)||We.isArray(e)}function tE(e){return We.endsWith(e,"[]")?e.slice(0,-2):e}function __(e,n,t){return e?e.concat(n).map(function(a,o){return a=tE(a),!t&&o?"["+a+"]":a}).join(t?".":""):n}function bG(e){return We.isArray(e)&&!e.some(H1)}const vG=We.toFlatObject(We,{},null,function(n){return/^is[A-Z]/.test(n)});function Jb(e,n,t){if(!We.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=We.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,T){return!We.isUndefined(T[k])});const r=t.metaTokens,a=t.visitor||h,o=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&We.isSpecCompliantForm(n);if(!We.isFunction(a))throw new TypeError("visitor must be a function");function u(S){if(S===null)return"";if(We.isDate(S))return S.toISOString();if(!f&&We.isBlob(S))throw new Kt("Blob is not supported. Use a Buffer instead.");return We.isArrayBuffer(S)||We.isTypedArray(S)?f&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function h(S,k,T){let P=S;if(S&&!T&&typeof S=="object"){if(We.endsWith(k,"{}"))k=r?k:k.slice(0,-2),S=JSON.stringify(S);else if(We.isArray(S)&&bG(S)||(We.isFileList(S)||We.endsWith(k,"[]"))&&(P=We.toArray(S)))return k=tE(k),P.forEach(function(R,z){!(We.isUndefined(R)||R===null)&&n.append(l===!0?__([k],z,o):l===null?k:k+"[]",u(R))}),!1}return H1(S)?!0:(n.append(__(T,k,o),u(S)),!1)}const g=[],b=Object.assign(vG,{defaultVisitor:h,convertValue:u,isVisitable:H1});function v(S,k){if(!We.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+k.join("."));g.push(S),We.forEach(S,function(P,M){(!(We.isUndefined(P)||P===null)&&a.call(n,P,We.isString(M)?M.trim():M,k,b))===!0&&v(P,k?k.concat(M):[M])}),g.pop()}}if(!We.isObject(e))throw new TypeError("data must be an object");return v(e),n}function j_(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function aS(e,n){this._pairs=[],e&&Jb(e,this,n)}const nE=aS.prototype;nE.append=function(n,t){this._pairs.push([n,t])};nE.toString=function(n){const t=n?function(r){return n.call(this,r,j_)}:j_;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function wG(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function rE(e,n,t){if(!n)return e;const r=t&&t.encode||wG;We.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let o;if(a?o=a(n,t):o=We.isURLSearchParams(n)?n.toString():new aS(n,t).toString(r),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class k_{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){We.forEach(this.handlers,function(r){r!==null&&n(r)})}}const iE={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},SG=typeof URLSearchParams<"u"?URLSearchParams:aS,NG=typeof FormData<"u"?FormData:null,CG=typeof Blob<"u"?Blob:null,_G={isBrowser:!0,classes:{URLSearchParams:SG,FormData:NG,Blob:CG},protocols:["http","https","file","blob","url","data"]},sS=typeof window<"u"&&typeof document<"u",G1=typeof navigator=="object"&&navigator||void 0,jG=sS&&(!G1||["ReactNative","NativeScript","NS"].indexOf(G1.product)<0),kG=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",TG=sS&&window.location.href||"http://localhost",EG=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:sS,hasStandardBrowserEnv:jG,hasStandardBrowserWebWorkerEnv:kG,navigator:G1,origin:TG},Symbol.toStringTag,{value:"Module"})),Mi={...EG,..._G};function AG(e,n){return Jb(e,new Mi.classes.URLSearchParams,Object.assign({visitor:function(t,r,a,o){return Mi.isNode&&We.isBuffer(t)?(this.append(r,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function PG(e){return We.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function DG(e){const n={},t=Object.keys(e);let r;const a=t.length;let o;for(r=0;r<a;r++)o=t[r],n[o]=e[o];return n}function aE(e){function n(t,r,a,o){let l=t[o++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),f=o>=t.length;return l=!l&&We.isArray(a)?a.length:l,f?(We.hasOwnProp(a,l)?a[l]=[a[l],r]:a[l]=r,!d):((!a[l]||!We.isObject(a[l]))&&(a[l]=[]),n(t,r,a[l],o)&&We.isArray(a[l])&&(a[l]=DG(a[l])),!d)}if(We.isFormData(e)&&We.isFunction(e.entries)){const t={};return We.forEachEntry(e,(r,a)=>{n(PG(r),a,t,0)}),t}return null}function IG(e,n,t){if(We.isString(e))try{return(n||JSON.parse)(e),We.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const vg={transitional:iE,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const r=t.getContentType()||"",a=r.indexOf("application/json")>-1,o=We.isObject(n);if(o&&We.isHTMLForm(n)&&(n=new FormData(n)),We.isFormData(n))return a?JSON.stringify(aE(n)):n;if(We.isArrayBuffer(n)||We.isBuffer(n)||We.isStream(n)||We.isFile(n)||We.isBlob(n)||We.isReadableStream(n))return n;if(We.isArrayBufferView(n))return n.buffer;if(We.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return AG(n,this.formSerializer).toString();if((d=We.isFileList(n))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Jb(d?{"files[]":n}:n,f&&new f,this.formSerializer)}}return o||a?(t.setContentType("application/json",!1),IG(n)):n}],transformResponse:[function(n){const t=this.transitional||vg.transitional,r=t&&t.forcedJSONParsing,a=this.responseType==="json";if(We.isResponse(n)||We.isReadableStream(n))return n;if(n&&We.isString(n)&&(r&&!this.responseType||a)){const l=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(n)}catch(d){if(l)throw d.name==="SyntaxError"?Kt.from(d,Kt.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Mi.classes.FormData,Blob:Mi.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};We.forEach(["delete","get","head","post","put","patch"],e=>{vg.headers[e]={}});const RG=We.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),MG=e=>{const n={};let t,r,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),t=l.substring(0,a).trim().toLowerCase(),r=l.substring(a+1).trim(),!(!t||n[t]&&RG[t])&&(t==="set-cookie"?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n},T_=Symbol("internals");function Om(e){return e&&String(e).trim().toLowerCase()}function Xx(e){return e===!1||e==null?e:We.isArray(e)?e.map(Xx):String(e)}function OG(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}const LG=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function M0(e,n,t,r,a){if(We.isFunction(r))return r.call(this,n,t);if(a&&(n=t),!!We.isString(n)){if(We.isString(r))return n.indexOf(r)!==-1;if(We.isRegExp(r))return r.test(n)}}function FG(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}function $G(e,n){const t=We.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(a,o,l){return this[r].call(this,n,a,o,l)},configurable:!0})})}let pa=class{constructor(n){n&&this.set(n)}set(n,t,r){const a=this;function o(d,f,u){const h=Om(f);if(!h)throw new Error("header name must be a non-empty string");const g=We.findKey(a,h);(!g||a[g]===void 0||u===!0||u===void 0&&a[g]!==!1)&&(a[g||f]=Xx(d))}const l=(d,f)=>We.forEach(d,(u,h)=>o(u,h,f));if(We.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(We.isString(n)&&(n=n.trim())&&!LG(n))l(MG(n),t);else if(We.isHeaders(n))for(const[d,f]of n.entries())o(f,d,r);else n!=null&&o(t,n,r);return this}get(n,t){if(n=Om(n),n){const r=We.findKey(this,n);if(r){const a=this[r];if(!t)return a;if(t===!0)return OG(a);if(We.isFunction(t))return t.call(this,a,r);if(We.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=Om(n),n){const r=We.findKey(this,n);return!!(r&&this[r]!==void 0&&(!t||M0(this,this[r],r,t)))}return!1}delete(n,t){const r=this;let a=!1;function o(l){if(l=Om(l),l){const d=We.findKey(r,l);d&&(!t||M0(r,r[d],d,t))&&(delete r[d],a=!0)}}return We.isArray(n)?n.forEach(o):o(n),a}clear(n){const t=Object.keys(this);let r=t.length,a=!1;for(;r--;){const o=t[r];(!n||M0(this,this[o],o,n,!0))&&(delete this[o],a=!0)}return a}normalize(n){const t=this,r={};return We.forEach(this,(a,o)=>{const l=We.findKey(r,o);if(l){t[l]=Xx(a),delete t[o];return}const d=n?FG(o):String(o).trim();d!==o&&delete t[o],t[d]=Xx(a),r[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return We.forEach(this,(r,a)=>{r!=null&&r!==!1&&(t[a]=n&&We.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(a=>r.set(a)),r}static accessor(n){const r=(this[T_]=this[T_]={accessors:{}}).accessors,a=this.prototype;function o(l){const d=Om(l);r[d]||($G(a,l),r[d]=!0)}return We.isArray(n)?n.forEach(o):o(n),this}};pa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);We.reduceDescriptors(pa.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[t]=r}}});We.freezeMethods(pa);function O0(e,n){const t=this||vg,r=n||t,a=pa.from(r.headers);let o=r.data;return We.forEach(e,function(d){o=d.call(t,o,a.normalize(),n?n.status:void 0)}),a.normalize(),o}function sE(e){return!!(e&&e.__CANCEL__)}function tp(e,n,t){Kt.call(this,e??"canceled",Kt.ERR_CANCELED,n,t),this.name="CanceledError"}We.inherits(tp,Kt,{__CANCEL__:!0});function oE(e,n,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):n(new Kt("Request failed with status code "+t.status,[Kt.ERR_BAD_REQUEST,Kt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function zG(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function BG(e,n){e=e||10;const t=new Array(e),r=new Array(e);let a=0,o=0,l;return n=n!==void 0?n:1e3,function(f){const u=Date.now(),h=r[o];l||(l=u),t[a]=f,r[a]=u;let g=o,b=0;for(;g!==a;)b+=t[g++],g=g%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),u-l<n)return;const v=h&&u-h;return v?Math.round(b*1e3/v):void 0}}function UG(e,n){let t=0,r=1e3/n,a,o;const l=(u,h=Date.now())=>{t=h,a=null,o&&(clearTimeout(o),o=null),e.apply(null,u)};return[(...u)=>{const h=Date.now(),g=h-t;g>=r?l(u,h):(a=u,o||(o=setTimeout(()=>{o=null,l(a)},r-g)))},()=>a&&l(a)]}const yb=(e,n,t=3)=>{let r=0;const a=BG(50,250);return UG(o=>{const l=o.loaded,d=o.lengthComputable?o.total:void 0,f=l-r,u=a(f),h=l<=d;r=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:u||void 0,estimated:u&&d&&h?(d-l)/u:void 0,event:o,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(g)},t)},E_=(e,n)=>{const t=e!=null;return[r=>n[0]({lengthComputable:t,total:e,loaded:r}),n[1]]},A_=e=>(...n)=>We.asap(()=>e(...n)),qG=Mi.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,Mi.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(Mi.origin),Mi.navigator&&/(msie|trident)/i.test(Mi.navigator.userAgent)):()=>!0,VG=Mi.hasStandardBrowserEnv?{write(e,n,t,r,a,o){const l=[e+"="+encodeURIComponent(n)];We.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),We.isString(r)&&l.push("path="+r),We.isString(a)&&l.push("domain="+a),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function HG(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function GG(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function lE(e,n,t){let r=!HG(n);return e&&(r||t==!1)?GG(e,n):n}const P_=e=>e instanceof pa?{...e}:e;function Gd(e,n){n=n||{};const t={};function r(u,h,g,b){return We.isPlainObject(u)&&We.isPlainObject(h)?We.merge.call({caseless:b},u,h):We.isPlainObject(h)?We.merge({},h):We.isArray(h)?h.slice():h}function a(u,h,g,b){if(We.isUndefined(h)){if(!We.isUndefined(u))return r(void 0,u,g,b)}else return r(u,h,g,b)}function o(u,h){if(!We.isUndefined(h))return r(void 0,h)}function l(u,h){if(We.isUndefined(h)){if(!We.isUndefined(u))return r(void 0,u)}else return r(void 0,h)}function d(u,h,g){if(g in n)return r(u,h);if(g in e)return r(void 0,u)}const f={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(u,h,g)=>a(P_(u),P_(h),g,!0)};return We.forEach(Object.keys(Object.assign({},e,n)),function(h){const g=f[h]||a,b=g(e[h],n[h],h);We.isUndefined(b)&&g!==d||(t[h]=b)}),t}const cE=e=>{const n=Gd({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:o,headers:l,auth:d}=n;n.headers=l=pa.from(l),n.url=rE(lE(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let f;if(We.isFormData(t)){if(Mi.hasStandardBrowserEnv||Mi.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((f=l.getContentType())!==!1){const[u,...h]=f?f.split(";").map(g=>g.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...h].join("; "))}}if(Mi.hasStandardBrowserEnv&&(r&&We.isFunction(r)&&(r=r(n)),r||r!==!1&&qG(n.url))){const u=a&&o&&VG.read(o);u&&l.set(a,u)}return n},YG=typeof XMLHttpRequest<"u",WG=YG&&function(e){return new Promise(function(t,r){const a=cE(e);let o=a.data;const l=pa.from(a.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:u}=a,h,g,b,v,S;function k(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let T=new XMLHttpRequest;T.open(a.method.toUpperCase(),a.url,!0),T.timeout=a.timeout;function P(){if(!T)return;const R=pa.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),$={data:!d||d==="text"||d==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:R,config:e,request:T};oE(function(B){t(B),k()},function(B){r(B),k()},$),T=null}"onloadend"in T?T.onloadend=P:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(P)},T.onabort=function(){T&&(r(new Kt("Request aborted",Kt.ECONNABORTED,e,T)),T=null)},T.onerror=function(){r(new Kt("Network Error",Kt.ERR_NETWORK,e,T)),T=null},T.ontimeout=function(){let z=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const $=a.transitional||iE;a.timeoutErrorMessage&&(z=a.timeoutErrorMessage),r(new Kt(z,$.clarifyTimeoutError?Kt.ETIMEDOUT:Kt.ECONNABORTED,e,T)),T=null},o===void 0&&l.setContentType(null),"setRequestHeader"in T&&We.forEach(l.toJSON(),function(z,$){T.setRequestHeader($,z)}),We.isUndefined(a.withCredentials)||(T.withCredentials=!!a.withCredentials),d&&d!=="json"&&(T.responseType=a.responseType),u&&([b,S]=yb(u,!0),T.addEventListener("progress",b)),f&&T.upload&&([g,v]=yb(f),T.upload.addEventListener("progress",g),T.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(h=R=>{T&&(r(!R||R.type?new tp(null,e,T):R),T.abort(),T=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const M=zG(a.url);if(M&&Mi.protocols.indexOf(M)===-1){r(new Kt("Unsupported protocol "+M+":",Kt.ERR_BAD_REQUEST,e));return}T.send(o||null)})},QG=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let r=new AbortController,a;const o=function(u){if(!a){a=!0,d();const h=u instanceof Error?u:this.reason;r.abort(h instanceof Kt?h:new tp(h instanceof Error?h.message:h))}};let l=n&&setTimeout(()=>{l=null,o(new Kt(`timeout ${n} of ms exceeded`,Kt.ETIMEDOUT))},n);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),e=null)};e.forEach(u=>u.addEventListener("abort",o));const{signal:f}=r;return f.unsubscribe=()=>We.asap(d),f}},JG=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let r=0,a;for(;r<t;)a=r+n,yield e.slice(r,a),r=a},KG=async function*(e,n){for await(const t of XG(e))yield*JG(t,n)},XG=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:r}=await n.read();if(t)break;yield r}}finally{await n.cancel()}},D_=(e,n,t,r)=>{const a=KG(e,n);let o=0,l,d=f=>{l||(l=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:u,value:h}=await a.next();if(u){d(),f.close();return}let g=h.byteLength;if(t){let b=o+=g;t(b)}f.enqueue(new Uint8Array(h))}catch(u){throw d(u),u}},cancel(f){return d(f),a.return()}},{highWaterMark:2})},Kb=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",uE=Kb&&typeof ReadableStream=="function",ZG=Kb&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),dE=(e,...n)=>{try{return!!e(...n)}catch{return!1}},eY=uE&&dE(()=>{let e=!1;const n=new Request(Mi.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),I_=64*1024,Y1=uE&&dE(()=>We.isReadableStream(new Response("").body)),xb={stream:Y1&&(e=>e.body)};Kb&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!xb[n]&&(xb[n]=We.isFunction(e[n])?t=>t[n]():(t,r)=>{throw new Kt(`Response type '${n}' is not supported`,Kt.ERR_NOT_SUPPORT,r)})})})(new Response);const tY=async e=>{if(e==null)return 0;if(We.isBlob(e))return e.size;if(We.isSpecCompliantForm(e))return(await new Request(Mi.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(We.isArrayBufferView(e)||We.isArrayBuffer(e))return e.byteLength;if(We.isURLSearchParams(e)&&(e=e+""),We.isString(e))return(await ZG(e)).byteLength},nY=async(e,n)=>{const t=We.toFiniteNumber(e.getContentLength());return t??tY(n)},rY=Kb&&(async e=>{let{url:n,method:t,data:r,signal:a,cancelToken:o,timeout:l,onDownloadProgress:d,onUploadProgress:f,responseType:u,headers:h,withCredentials:g="same-origin",fetchOptions:b}=cE(e);u=u?(u+"").toLowerCase():"text";let v=QG([a,o&&o.toAbortSignal()],l),S;const k=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let T;try{if(f&&eY&&t!=="get"&&t!=="head"&&(T=await nY(h,r))!==0){let $=new Request(n,{method:"POST",body:r,duplex:"half"}),L;if(We.isFormData(r)&&(L=$.headers.get("content-type"))&&h.setContentType(L),$.body){const[B,q]=E_(T,yb(A_(f)));r=D_($.body,I_,B,q)}}We.isString(g)||(g=g?"include":"omit");const P="credentials"in Request.prototype;S=new Request(n,{...b,signal:v,method:t.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:P?g:void 0});let M=await fetch(S);const R=Y1&&(u==="stream"||u==="response");if(Y1&&(d||R&&k)){const $={};["status","statusText","headers"].forEach(W=>{$[W]=M[W]});const L=We.toFiniteNumber(M.headers.get("content-length")),[B,q]=d&&E_(L,yb(A_(d),!0))||[];M=new Response(D_(M.body,I_,B,()=>{q&&q(),k&&k()}),$)}u=u||"text";let z=await xb[We.findKey(xb,u)||"text"](M,e);return!R&&k&&k(),await new Promise(($,L)=>{oE($,L,{data:z,headers:pa.from(M.headers),status:M.status,statusText:M.statusText,config:e,request:S})})}catch(P){throw k&&k(),P&&P.name==="TypeError"&&/fetch/i.test(P.message)?Object.assign(new Kt("Network Error",Kt.ERR_NETWORK,e,S),{cause:P.cause||P}):Kt.from(P,P&&P.code,e,S)}}),W1={http:xG,xhr:WG,fetch:rY};We.forEach(W1,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const R_=e=>`- ${e}`,iY=e=>We.isFunction(e)||e===null||e===!1,fE={getAdapter:e=>{e=We.isArray(e)?e:[e];const{length:n}=e;let t,r;const a={};for(let o=0;o<n;o++){t=e[o];let l;if(r=t,!iY(t)&&(r=W1[(l=String(t)).toLowerCase()],r===void 0))throw new Kt(`Unknown adapter '${l}'`);if(r)break;a[l||"#"+o]=r}if(!r){const o=Object.entries(a).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(R_).join(`
`):" "+R_(o[0]):"as no adapter specified";throw new Kt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:W1};function L0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new tp(null,e)}function M_(e){return L0(e),e.headers=pa.from(e.headers),e.data=O0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),fE.getAdapter(e.adapter||vg.adapter)(e).then(function(r){return L0(e),r.data=O0.call(e,e.transformResponse,r),r.headers=pa.from(r.headers),r},function(r){return sE(r)||(L0(e),r&&r.response&&(r.response.data=O0.call(e,e.transformResponse,r.response),r.response.headers=pa.from(r.response.headers))),Promise.reject(r)})}const hE="1.8.4",Xb={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Xb[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const O_={};Xb.transitional=function(n,t,r){function a(o,l){return"[Axios v"+hE+"] Transitional option '"+o+"'"+l+(r?". "+r:"")}return(o,l,d)=>{if(n===!1)throw new Kt(a(l," has been removed"+(t?" in "+t:"")),Kt.ERR_DEPRECATED);return t&&!O_[l]&&(O_[l]=!0,console.warn(a(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,d):!0}};Xb.spelling=function(n){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function aY(e,n,t){if(typeof e!="object")throw new Kt("options must be an object",Kt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const o=r[a],l=n[o];if(l){const d=e[o],f=d===void 0||l(d,o,e);if(f!==!0)throw new Kt("option "+o+" must be "+f,Kt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Kt("Unknown option "+o,Kt.ERR_BAD_OPTION)}}const Zx={assertOptions:aY,validators:Xb},Jo=Zx.validators;let $d=class{constructor(n){this.defaults=n,this.interceptors={request:new k_,response:new k_}}async request(n,t){try{return await this._request(n,t)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=Gd(this.defaults,t);const{transitional:r,paramsSerializer:a,headers:o}=t;r!==void 0&&Zx.assertOptions(r,{silentJSONParsing:Jo.transitional(Jo.boolean),forcedJSONParsing:Jo.transitional(Jo.boolean),clarifyTimeoutError:Jo.transitional(Jo.boolean)},!1),a!=null&&(We.isFunction(a)?t.paramsSerializer={serialize:a}:Zx.assertOptions(a,{encode:Jo.function,serialize:Jo.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Zx.assertOptions(t,{baseUrl:Jo.spelling("baseURL"),withXsrfToken:Jo.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&We.merge(o.common,o[t.method]);o&&We.forEach(["delete","get","head","post","put","patch","common"],S=>{delete o[S]}),t.headers=pa.concat(l,o);const d=[];let f=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(f=f&&k.synchronous,d.unshift(k.fulfilled,k.rejected))});const u=[];this.interceptors.response.forEach(function(k){u.push(k.fulfilled,k.rejected)});let h,g=0,b;if(!f){const S=[M_.bind(this),void 0];for(S.unshift.apply(S,d),S.push.apply(S,u),b=S.length,h=Promise.resolve(t);g<b;)h=h.then(S[g++],S[g++]);return h}b=d.length;let v=t;for(g=0;g<b;){const S=d[g++],k=d[g++];try{v=S(v)}catch(T){k.call(this,T);break}}try{h=M_.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,b=u.length;g<b;)h=h.then(u[g++],u[g++]);return h}getUri(n){n=Gd(this.defaults,n);const t=lE(n.baseURL,n.url,n.allowAbsoluteUrls);return rE(t,n.params,n.paramsSerializer)}};We.forEach(["delete","get","head","options"],function(n){$d.prototype[n]=function(t,r){return this.request(Gd(r||{},{method:n,url:t,data:(r||{}).data}))}});We.forEach(["post","put","patch"],function(n){function t(r){return function(o,l,d){return this.request(Gd(d||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}$d.prototype[n]=t(),$d.prototype[n+"Form"]=t(!0)});let sY=class pE{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const r=this;this.promise.then(a=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](a);r._listeners=null}),this.promise.then=a=>{let o;const l=new Promise(d=>{r.subscribe(d),o=d}).then(a);return l.cancel=function(){r.unsubscribe(o)},l},n(function(o,l,d){r.reason||(r.reason=new tp(o,l,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=r=>{n.abort(r)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new pE(function(a){n=a}),cancel:n}}};function oY(e){return function(t){return e.apply(null,t)}}function lY(e){return We.isObject(e)&&e.isAxiosError===!0}const Q1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Q1).forEach(([e,n])=>{Q1[n]=e});function mE(e){const n=new $d(e),t=GT($d.prototype.request,n);return We.extend(t,$d.prototype,n,{allOwnKeys:!0}),We.extend(t,n,null,{allOwnKeys:!0}),t.create=function(a){return mE(Gd(e,a))},t}const Or=mE(vg);Or.Axios=$d;Or.CanceledError=tp;Or.CancelToken=sY;Or.isCancel=sE;Or.VERSION=hE;Or.toFormData=Jb;Or.AxiosError=Kt;Or.Cancel=Or.CanceledError;Or.all=function(n){return Promise.all(n)};Or.spread=oY;Or.isAxiosError=lY;Or.mergeConfig=Gd;Or.AxiosHeaders=pa;Or.formToJSON=e=>aE(We.isHTMLForm(e)?new FormData(e):e);Or.getAdapter=fE.getAdapter;Or.HttpStatusCode=Q1;Or.default=Or;const{Axios:Wae,AxiosError:Qae,CanceledError:Jae,isCancel:Kae,CancelToken:Xae,VERSION:Zae,all:ese,Cancel:tse,isAxiosError:nse,spread:rse,toFormData:ise,AxiosHeaders:ase,HttpStatusCode:sse,formToJSON:ose,getAdapter:lse,mergeConfig:cse}=Or;function cY(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"screen",start:async()=>{const d=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function uY(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"webcam",start:async()=>{const d=await navigator.mediaDevices.getUserMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class dY extends qT{constructor(t){super();Jn(this,"client");Jn(this,"_status","disconnected");Jn(this,"_session",null);Jn(this,"_model",null);Jn(this,"config",null);this.client=new Cw(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(o){return console.error("Error connecting to GenAI Live:",o),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let o=((r=a.modelTurn)==null?void 0:r.parts)||[];const l=o.filter(h=>{var g;return h.inlineData&&((g=h.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),d=l.map(h=>{var g;return(g=h.inlineData)==null?void 0:g.data}),f=HT.difference(o,l);if(d.forEach(h=>{if(h){const g=CH(h);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!f.length)return;o=f;const u={modelTurn:{parts:o}};this.emit("content",u),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let r=!1,a=!1;for(const d of t)if((l=this.session)==null||l.sendRealtimeInput({media:d}),d.mimeType.includes("audio")&&(r=!0),d.mimeType.includes("image")&&(a=!0),r&&a)break;const o=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",o)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function fY(e){const n=w.useMemo(()=>new dY(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[o,l]=w.useState({}),[d,f]=w.useState(!1),[u,h]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||BT({id:"audio-out"}).then(k=>{t.current=new IH(k),t.current.addWorklet("vumeter-out",UT,T=>{h(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{f(!0)},T=()=>{f(!1)},P=$=>{console.error("error",$)},M=()=>{var $;return($=t.current)==null?void 0:$.stop()},R=$=>{var L;return(L=t.current)==null?void 0:L.addPCM16(new Uint8Array($))},z=$=>{if(console.log("Received content event:",$),$.modelTurn&&$.modelTurn.parts){const L=$.modelTurn.parts.filter(B=>"text"in B&&B.text);if(L.length>0){const B=L.map(q=>q.text).join(" ");b(B),console.log("AI Summary received:",B)}}};return n.on("error",P).on("open",k).on("close",T).on("interrupted",M).on("audio",R).on("content",z),()=>{n.off("error",P).off("open",k).off("close",T).off("interrupted",M).off("audio",R).off("content",z).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!o)throw new Error("config has not been set");n.disconnect(),await n.connect(r,o)},[n,o,r]),S=w.useCallback(async()=>{n.disconnect(),f(!1)},[f,n]);return{client:n,config:o,setConfig:l,model:r,setModel:a,connected:d,connect:v,disconnect:S,volume:u,aiSummary:g}}const gE=w.createContext(void 0),wg=({options:e,children:n})=>{const t=fY(e);return i.jsx(gE.Provider,{value:t,children:n})},gu=()=>{const e=w.useContext(gE);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function hY(){const{config:e,setConfig:n}=gu(),[t,r]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(o=>{n({...e,responseModalities:[o==="audio"?uu.AUDIO:uu.TEXT]})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),i.jsx(zT,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:o=>{r(o),o&&(o.value==="audio"||o.value==="text")&&a(o.value)}})]})}const L_=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function pY(){const{config:e,setConfig:n}=gu();w.useEffect(()=>{var d,f,u;const o=((u=(f=(d=e.speechConfig)==null?void 0:d.voiceConfig)==null?void 0:f.prebuiltVoiceConfig)==null?void 0:u.voiceName)||"Atari02";r({value:o,label:o})},[e]);const[t,r]=w.useState(L_[5]),a=w.useCallback(o=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:o}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(zT,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:L_,onChange:o=>{r(o),o&&a(o.value)}})]})}function mY(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=gu(),o=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(u=>Array.isArray(u.functionDeclarations)).map(u=>u.functionDeclarations).filter(u=>!!u).flat():[],[t]),l=w.useMemo(()=>{var u;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(h=>typeof h=="string"?h:h.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((u=t.systemInstruction.parts)==null?void 0:u.map(h=>h.text).join(`
`))||"":""},[t]),d=w.useCallback(u=>{const h={...t,systemInstruction:u.target.value};r(h)},[t,r]),f=w.useCallback((u,h)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===u?{...k,description:h}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsxs("div",{className:"mode-selectors",children:[i.jsx(hY,{}),i.jsx(pY,{})]}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:d,value:l}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:o.map((u,h)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:u.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=u.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:u.description,onBlur:b=>f(u.name,b.target.value)},`fd-${u.description}`)]},`function-${h}`)})})})]})})]})}const F_=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function gY({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const o=[uY(),cY()],[l,d]=w.useState(null),[f,u]=o,[h,g]=w.useState(0),[b]=w.useState(()=>new VT),[v,S]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:P,connected:M,connect:R,disconnect:z,volume:$}=gu();w.useEffect(()=>{!M&&T.current&&T.current.focus()},[M]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(h*200,8))}px`)},[h]),w.useEffect(()=>{const B=q=>{P.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:q}])};return M&&!v&&b?b.on("data",B).on("volume",g).start():b.stop(),()=>{b.off("data",B).off("volume",g)}},[M,P,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let B=-1;function q(){const W=e.current,I=k.current;if(!W||!I)return;const F=I.getContext("2d");if(I.width=W.videoWidth*.25,I.height=W.videoHeight*.25,I.width+I.height>0){F.drawImage(W,0,0,I.width,I.height);const V=I.toDataURL("image/jpeg",1),ee=V.slice(V.indexOf(",")+1,1/0);P.sendRealtimeInput([{mimeType:"image/jpeg",data:ee}])}M&&(B=window.setTimeout(q,1e3/.5))}return M&&l!==null&&requestAnimationFrame(q),()=>{clearTimeout(B)}},[M,l,P,e]);const L=B=>async()=>{if(B){const q=await B.start();d(q),t(q)}else d(null),t(null);o.filter(q=>q!==B).forEach(q=>q.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:cu("actions-nav",{disabled:!M}),children:[i.jsx("button",{className:cu("action-button mic-button",{recording:!v&&M}),onClick:()=>S(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(AH,{volume:$,active:M,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(F_,{isStreaming:u.isStreaming,start:L(u),stop:L(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(F_,{isStreaming:f.isStreaming,start:L(f),stop:L(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:cu("connection-container",{connected:M}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:T,className:cu("action-button connect-toggle",{connected:M}),onClick:M?z:R,children:i.jsx("span",{className:"material-symbols-outlined filled",children:M?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(mY,{}):""]})}const $_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:$h.OBJECT,properties:{summary:{type:$h.STRING,description:"The summary of the patient's case."}},required:["summary"]}},yY=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:o,setModel:l}=gu();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),o({responseModalities:[uu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[$_]}]})},[o,l]),w.useEffect(()=>{const d=f=>{if(!f.functionCalls)return;const u=f.functionCalls.find(h=>h.name===$_.name);if(u){const h=u.args.summary;r(h)}f.functionCalls.length&&setTimeout(()=>{var h;return a.sendToolResponse({functionResponses:(h=f.functionCalls)==null?void 0:h.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",d),()=>{a.off("toolcall",d)}},[a]),w.useEffect(()=>{if(t){const d=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${d}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${d}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})},z_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes";async function xY(){const e=_w();if(!e)return console.warn("No auth token found, using default Live API key."),z_;try{const t=(await Or.get("/api/clinics/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).data.geminiApiKey;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Live API key:",n)}return console.warn("Clinic-specific Live API key not found or failed to fetch, using default."),z_}function bY(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await xY();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(wg,{options:r,children:i.jsx(vY,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const vY=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[o,l]=w.useState(null),{connected:d,client:f,connect:u,config:h,model:g}=gu(),[b,v]=w.useState(""),S=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const M=window.matchMedia("(prefers-color-scheme: dark)"),R=z=>{document.documentElement.setAttribute("data-theme",z.matches?"dark":"light")};return R(M),M.addEventListener("change",R),()=>M.removeEventListener("change",R)},[]),w.useEffect(()=>{const M=new URLSearchParams(window.location.search),R={};for(const[z,$]of M.entries())z==="token_number"?l($):R[z]=$;a(R)},[]),w.useEffect(()=>{Object.keys(h).length>0&&g&&u()},[u,h,g]),w.useEffect(()=>{if(d&&r&&!k){const M=JSON.stringify(r,null,2);f.send([{text:M}]),v(""),T(!0)}},[d,r,f,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const P=()=>{f.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(yY,{patientData:r,tokenNumber:o}),i.jsx("video",{className:cu("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:cu("input-container",{disabled:!d}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:S,onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),M.stopPropagation(),P())},onChange:M=>v(M.target.value),value:b}),i.jsx("span",{className:cu("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:P,children:"send"})]})}),i.jsx(gY,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},B_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",wY=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},SY=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},o)=>{var L;const{connected:l,connect:d,disconnect:f,client:u,volume:h}=gu(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P]=w.useState(()=>new VT),M=async()=>{l?await f():(await d(),r.trim()&&a())};w.useEffect(()=>{const B=q=>{u.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:q}])};return l&&!g?P.on("data",B).start():P.stop(),()=>{P.off("data",B),P.stop()}},[l,u,g,P]);const R=w.useCallback(async()=>{if(v)$==null||$.getTracks().forEach(B=>B.stop()),t(null),S(!1);else try{const B=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),S(!0)}catch(B){console.error("Error accessing webcam:",B),S(!1)}},[v,t,e]),z=w.useCallback(async()=>{if(k)$==null||$.getTracks().forEach(B=>B.stop()),t(null),T(!1);else try{const B=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),T(!0)}catch(B){console.error("Error accessing screen share:",B),T(!1)}},[k,t,e]),$=(L=e.current)==null?void 0:L.srcObject;return w.useEffect(()=>()=>{$&&$.getTracks().forEach(B=>B.stop())},[$]),w.useImperativeHandle(o,()=>({handleConnect:M})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(DF,{className:"w-5 h-5"}):i.jsx(hg,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(wY,{volume:h,active:l})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:z,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(LF,{className:"w-5 h-5"})}),i.jsx("button",{onClick:R,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(I6,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:M,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx(qF,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(QF,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),NY=({tokenNumber:e,aiSummary:n,clinicName:t})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:t.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[t," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",t," Reception Assistant"]})]}),e&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:e})]}),n&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:n})]})]}),U_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:$h.OBJECT,properties:{summary:{type:$h.STRING,description:"The summary of the patient's case."}},required:["summary"]}},CY=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a})=>{const o=w.useRef(null),l=w.useRef(null),[d,f]=w.useState(null),[u,h]=w.useState("hi"),{client:g,connected:b,setConfig:v,setModel:S,disconnect:k,connect:T}=gu(),P=w.useMemo(()=>{let B=`Your job is to:

If patient details like name, age, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (Name, Age) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's Name and Age only. Do not ask for their phone number.

    You should guess the patient's sex based on their voice or appearance.

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu. Dont write the telugu words in english.`;return n&&(B+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[uu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:B}]},tools:[{functionDeclarations:[U_]}]}},[n]);w.useEffect(()=>{S("models/gemini-2.5-flash-native-audio-preview-12-2025"),v(P);const B=setTimeout(()=>{l.current&&!b&&l.current.handleConnect()},2e3);return()=>clearTimeout(B)},[v,S,P,b]),w.useEffect(()=>()=>{b&&k()},[b,k]);const[M,R]=w.useState(null);w.useEffect(()=>{const B=q=>{if(!q.functionCalls)return;const W=q.functionCalls.find(I=>I.name===U_.name);if(W){const I=W.args.summary;R(I),r(I)}q.functionCalls.length&&setTimeout(()=>{var I;return g.sendToolResponse({functionResponses:(I=q.functionCalls)==null?void 0:I.map(F=>({response:{output:{success:!0}},id:F.id,name:F.name}))})},200)};return g.on("toolcall",B),()=>{g.off("toolcall",B)}},[g,r]);const z=()=>{u.trim()&&(g.send([{text:u}]),h(""))},$=B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),z())},L=async()=>{R(null),r(null),h("hi"),b?(k(),setTimeout(()=>{T()},500)):T()};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:L,className:"live-api-modal-close-button",title:"Refresh Session","aria-label":"Refresh session",children:i.jsx(Uk,{className:"w-6 h-6"})}),i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(_n,{className:"w-6 h-6"})})]})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(NY,{patientData:n,tokenNumber:t,aiSummary:M,clinicName:a}),d&&i.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:u,onChange:B=>h(B.target.value),onKeyDown:$,placeholder:"Type your message here...",disabled:!b,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:z,disabled:!b||!u.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(Mb,{className:"w-5 h-5"})})]})}),i.jsx(SY,{ref:l,videoRef:o,supportsVideo:!0,onVideoStreamChange:f,textInput:u,onSubmitTextInput:z})]})})]})})},Zb=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,o]=w.useState(null),[l,d]=w.useState("Newtons Ai"),[f,u]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{let b=null,v="Newtons Ai";try{const S=await ge("/api/clinics/settings");if(S.ok){const k=await S.json();k.name&&k.name!==""&&(v=k.name),k.gemini_api_key&&k.gemini_api_key.trim()!==""&&(b=k.gemini_api_key.trim())}}catch(S){console.warn("Failed to fetch clinic settings",S)}if(d(v),b)o(b);else{try{const S=await ge("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();if(k.value&&k.value.trim()!==""){o(k.value.trim());return}}}catch(S){console.warn("Failed to fetch global key fallback",S)}o(B_)}}catch(b){console.error("Unexpected error in getSettings:",b),o(B_)}finally{u(!1)}})()},[]),f)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",style:{maxHeight:"200px",maxWidth:"400px",borderRadius:"1rem",justifyContent:"center"},children:i.jsxs("div",{className:"live-api-loading-container",children:[i.jsx("div",{className:"live-api-loading-spinner"}),i.jsx("div",{className:"live-api-loading-text",children:"Initializing AI Assistant..."})]})})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const h={apiKey:a};return i.jsx(wg,{options:h,children:i.jsx(CY,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:l})})},_Y="_overlay_th47a_5",jY="_overlayMinimized_th47a_55",kY="_modal_th47a_65",TY="_minimized_th47a_97",EY="_contentWrapper_th47a_113",AY="_exiting_th47a_161",PY="_header_th47a_183",DY="_inputWrapper_th47a_197",IY="_inputContainer_th47a_215",RY="_minimizedSearchIcon_th47a_273",MY="_input_th47a_197",OY="_controlsGroup_th47a_347",LY="_iconButton_th47a_373",FY="_sendButton_th47a_413",$Y="_dragBar_th47a_459",zY="_dragBarTitle_th47a_489",BY="_dragBarControls_th47a_519",UY="_dragBarControlsRight_th47a_537",qY="_newChatBtn_th47a_553",VY="_windowControlBtn_th47a_589",HY="_content_th47a_113",GY="_overlayContent_th47a_687",YY="_section_th47a_711",WY="_sectionTitle_th47a_723",QY="_recentList_th47a_743",JY="_recentPill_th47a_767",KY="_recentName_th47a_807",XY="_recentToken_th47a_819",ZY="_recentInfo_th47a_837",eW="_examplesGrid_th47a_849",tW="_exampleCard_th47a_861",nW="_exampleIcon_th47a_897",rW="_exampleText_th47a_905",iW="_chatSectionFill_th47a_919",aW="_chatMessagesFill_th47a_935",sW="_chatBubble_th47a_955",oW="_chatBubbleUser_th47a_975",lW="_chatBubbleModel_th47a_991",cW="_chatBubbleSystem_th47a_1009",uW="_processing_th47a_1025",dW="_spinner_th47a_1043",fW="_resultItem_th47a_1065",hW="_resultName_th47a_1093",pW="_resultToken_th47a_1103",mW="_resultDetails_th47a_1115",gW="_noResults_th47a_1125",vt={overlay:_Y,overlayMinimized:jY,modal:kY,minimized:TY,contentWrapper:EY,exiting:AY,header:PY,inputWrapper:DY,inputContainer:IY,minimizedSearchIcon:RY,input:MY,controlsGroup:OY,iconButton:LY,sendButton:FY,dragBar:$Y,dragBarTitle:zY,dragBarControls:BY,dragBarControlsRight:UY,newChatBtn:qY,windowControlBtn:VY,content:HY,overlayContent:GY,section:YY,sectionTitle:WY,recentList:QY,recentPill:JY,recentName:KY,recentToken:XY,recentInfo:ZY,examplesGrid:eW,exampleCard:tW,exampleIcon:nW,exampleText:rW,chatSectionFill:iW,chatMessagesFill:aW,chatBubble:sW,chatBubbleUser:oW,chatBubbleModel:lW,chatBubbleSystem:cW,processing:uW,spinner:dW,resultItem:fW,resultName:hW,resultToken:pW,resultDetails:mW,noResults:gW},yE="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",yW={apiKey:yE},F0=[{name:"Dashboard",path:"/dashboard",icon:i.jsx(vF,{size:16}),keywords:["home","main","analytics","stats"],roles:["all"]},{name:"Clinic Hub",path:"/dashboard/clinic-hub",icon:i.jsx(YN,{size:16}),keywords:["central","hub","overview"],roles:["admin","superadmin"]},{name:"Analysis Dashboard",path:"/dashboard/analysis",icon:i.jsx(YN,{size:16}),keywords:["reports","stats","finance","money"],roles:["admin","superadmin"]},{name:"Live AI Assistant",path:"/live-api",icon:i.jsx(eg,{size:16}),keywords:["ai","chat","voice","assistant"],roles:["all"]},{name:"Patient Search",path:"/dashboard/search-patient",icon:i.jsx(kr,{size:16}),keywords:["find","lookup","patient"],roles:["all"]},{name:"All Patients",path:"/dashboard/all-patients",icon:i.jsx(Jh,{size:16}),keywords:["list","records","database"],roles:["admin","receptionist","doctor"]},{name:"Add New Patient",path:"/dashboard/add-patient",icon:i.jsx(Ew,{size:16}),keywords:["register","new","create","onboard"],roles:["admin","receptionist","doctor"]},{name:"Admissions",path:"/manage-admission",icon:i.jsx(R3,{size:16}),keywords:["ipd","admit","discharge","rooms"],roles:["admin","doctor","receptionist"]},{name:"Pharmacy Inventory",path:"/dashboard/inventory",icon:i.jsx(Ud,{size:16}),keywords:["drugs","medicine","stock","pharmacy"],roles:["admin","pharmacy"]},{name:"Add New Drug",path:"/dashboard/inventory/add",icon:i.jsx(Ud,{size:16}),keywords:["create","medicine","stock"],roles:["admin","pharmacy"]},{name:"Add Pharmacy Order",path:"/dashboard/add-order",icon:i.jsx(C1,{size:16}),keywords:["sell","bill","dispense"],roles:["admin","pharmacy"]},{name:"Refill Reminders",path:"/refill-reminders",icon:i.jsx(zh,{size:16}),keywords:["recurring","sms","alert"],roles:["admin","pharmacy"]},{name:"Distributors",path:"/dashboard/distributors",icon:i.jsx(_6,{size:16}),keywords:["suppliers","vendors","stock"],roles:["admin","pharmacy"]},{name:"Purchase",path:"/dashboard/purchase",icon:i.jsx(C1,{size:16}),keywords:["buy","procurement","stock"],roles:["admin","pharmacy"]},{name:"Create Lab Order",path:"/create-lab-order",icon:i.jsx(io,{size:16}),keywords:["test","pathology","diagnostics"],roles:["admin","doctor","lab"]},{name:"Search Lab Reports",path:"/lab/search-report",icon:i.jsx(kr,{size:16}),keywords:["results","history","find"],roles:["admin","doctor","lab"]},{name:"Lab Inventory",path:"/lab-inventory",icon:i.jsx(io,{size:16}),keywords:["reagents","tests","stock"],roles:["admin","lab"]},{name:"Create Custom Bill",path:"/create-custom-bill",icon:i.jsx(Jl,{size:16}),keywords:["invoice","custom","charge"],roles:["admin","receptionist"]},{name:"Billing History",path:"/billing",icon:i.jsx(Ok,{size:16}),keywords:["transactions","payments","history"],roles:["admin"]},{name:"Staff Management",path:"/dashboard/staff",icon:i.jsx(c6,{size:16}),keywords:["users","employees","roles","admin"],roles:["admin","superadmin"]}],xW=[{icon:"",text:"Check Paracetamol stock"},{icon:"",text:"Show last month analysis"},{icon:"",text:"Go to Pharmacy Inventory"},{icon:"",text:"Add new staff member"},{icon:"",text:"New patient: Fever case"},{icon:"",text:"Open OPD Queue"}],bW=({user:e})=>{const{isOpen:n,closeCommandBar:t}=Lh(),r=Rt(),a=Gr(),o=w.useRef(null),[l,d]=w.useState(""),[f,u]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState([]),[S,k]=w.useState(!1),[T,P]=w.useState(!0),[M,R]=w.useState(!1),[z,$]=w.useState(null),[L,B]=w.useState(!1),[q,W]=w.useState(!1),[I,F]=w.useState(!1);w.useEffect(()=>{if(n)W(!0),F(!1);else{F(!0);const Ne=setTimeout(()=>{W(!1),F(!1)},200);return()=>clearTimeout(Ne)}},[n]);const{setPageContext:V}=Tb();w.useEffect(()=>{if(n){const Ne=a.pathname,Le=F0.find(tt=>tt.path===Ne)||F0.find(tt=>Ne.startsWith(tt.path)&&tt.path!=="/dashboard");V(Le?{name:Le.name,path:Ne,data:{role:Le.roles}}:{name:"Current Page",path:Ne})}},[n,a.pathname,V]);const ee=jw({settings:{},staffList:[]}),{selectedImage:ie,handleImageSelect:Y,clearImage:Q}=ee,ne=w.useRef(null),le=Ne=>{var tt;const Le=(tt=Ne.target.files)==null?void 0:tt[0];Le&&Y(Le)},[oe,E]=w.useState({x:0,y:0}),[de,he]=w.useState(!1),D=w.useRef({x:0,y:0}),me=w.useRef({x:0,y:0}),Ce=w.useRef(!1),te=w.useRef(null);w.useEffect(()=>{const Ne=tt=>{if(!de)return;Ce.current=!0;const xt=tt.clientX-D.current.x,St=tt.clientY-D.current.y;let we=me.current.x+xt,ye=me.current.y+St;if(te.current){const Oe=te.current.offsetWidth,De=te.current.offsetHeight,Ve=(window.innerWidth-Oe)/2,ot=(window.innerHeight-De)/2,mt=Math.max(0,Ve),Nt=Math.max(0,ot);we=Math.max(-mt,Math.min(mt,we)),ye=Math.max(-Nt,Math.min(Nt,ye))}E({x:we,y:ye})},Le=()=>{he(!1)};return de&&(window.addEventListener("mousemove",Ne),window.addEventListener("mouseup",Le)),()=>{window.removeEventListener("mousemove",Ne),window.removeEventListener("mouseup",Le)}},[de]);const K=Ne=>{Ne.target.closest("input, button, .lucide")||(he(!0),Ce.current=!1,D.current={x:Ne.clientX,y:Ne.clientY},me.current={...oe})};w.useEffect(()=>{n&&B(!0)},[a.pathname]),w.useEffect(()=>{(h.length>0||b.length>0)&&L&&B(!1)},[h,b]),w.useEffect(()=>{if(n&&window.innerWidth<=768){window.history.pushState({commandBarOpen:!0},"");const Ne=Le=>{Le.preventDefault(),B(!0)};return window.addEventListener("popstate",Ne),()=>{window.removeEventListener("popstate",Ne)}}},[n]),w.useEffect(()=>{L||E({x:0,y:0})},[L]),w.useEffect(()=>{ee.setChatQuery(l)},[l]),w.useEffect(()=>{n&&o.current&&o.current.focus()},[n]);const J=Ne=>{!Ne.trim()&&!ie||(B(!1),ee.handleSendMessage(Ne),d(""),g([]),v([]))},{preFilledQuery:xe,setPreFilledQuery:He}=Lh();w.useEffect(()=>{n&&xe&&(d(xe),setTimeout(()=>{J(xe),He("")},300))},[n,xe,He]),w.useEffect(()=>{z&&(d(z),R(!1),setTimeout(()=>J(z),50),$(null))},[z]);const re=()=>{R(!0)},Be=()=>{d(""),g([]),v([]),ee.refreshChat(),o.current&&o.current.focus()};w.useEffect(()=>{n&&(async()=>{try{const Le=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),tt=await ge(`/api/patients?${Le.toString()}`);if(tt.ok){const xt=await tt.json();u(xt.patients||[])}}catch(Le){console.error("Error fetching recent patients:",Le)}})()},[n]);const Ae=w.useMemo(()=>yg(async Ne=>{const Le=Ne.trim(),tt=/^\d+$/.test(Le),xt=Le.split(/\s+/).length;if(Le.length>1){const St=Le.toLowerCase(),we=F0.filter(ye=>{if(!(ye.name.toLowerCase().includes(St)||ye.keywords.some(Ve=>Ve.toLowerCase().includes(St))))return!1;if(!e)return!0;const De=e.role;return ye.roles.includes("all")||ye.roles.includes(De)});v(we)}else v([]);if(Le.length<2||tt&&Le.length>10||!tt&&xt>3){g([]),k(!1);return}k(!0);try{const St=new URLSearchParams({search:encodeURIComponent(Ne),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),we=await ge(`/api/patients?${St.toString()}`);if(we.ok){const ye=await we.json();g(ye.patients||[])}}catch(St){console.error("Search error:",St)}finally{k(!1)}},300),[e]),Ie=Ne=>{const Le=Ne.target.value;d(Le),Ae(Le)},Ye=Ne=>{Ne.id&&r(`/dashboard/edit-complaint/patient/${Ne.id}`)},at=Ne=>{r(Ne.path)},Ze=Ne=>{d(Ne),setTimeout(()=>J(Ne),50)},Ke=Ne=>{l.trim()&&J(l)},st=Ne=>{Ne.key==="Enter"&&!Ne.shiftKey&&(Ne.preventDefault(),Ke())},yt=Ne=>{Ne.target===Ne.currentTarget&&t()};if(!n&&!q)return null;const je=(h.length>0||b.length>0)&&!S,Ge=l.length===0&&h.length===0&&b.length===0,_e=l.length>=3&&h.length===0&&b.length===0&&!S,pe=ee.chatHistory.length>0||ee.isProcessing,ce=!pe||je,G=pe&&je,fe=pe&&!T&&!L&&!je;return i.jsxs("div",{className:`${vt.overlay} ${L?vt.overlayMinimized:""} ${I?vt.exiting:""}`,onClick:yt,children:[i.jsxs("div",{ref:te,className:`${vt.modal} ${L?vt.minimized:""} ${fe?vt.collapsed:""} ${I?vt.exiting:""}`,style:{transform:`translate(${oe.x}px, ${oe.y}px)`,height:fe?"auto":void 0},onClick:()=>{Ce.current||(L?B(!1):fe&&P(!0))},children:[i.jsxs("div",{className:vt.dragBar,onMouseDown:K,onDoubleClick:()=>!L&&B(!L),children:[i.jsxs("div",{className:vt.dragBarControls,children:[i.jsx("button",{className:vt.windowControlBtn,onClick:t,title:"Close",children:i.jsx(_n,{size:24,color:"#64748b"})}),i.jsx("button",{className:vt.windowControlBtn,onClick:()=>B(!L),title:L?"Maximize":"Minimize",children:L?i.jsx(AF,{size:24,color:"#64748b"}):i.jsx(MF,{size:24,color:"#64748b"})})]}),i.jsx("div",{className:vt.dragBarTitle,children:pe?i.jsxs(i.Fragment,{children:[i.jsx(eg,{size:14,className:"text-violet-600"}),i.jsx("span",{children:"AI Assistant"})]}):je?i.jsxs(i.Fragment,{children:[i.jsx(kr,{size:14,className:"text-blue-500"}),i.jsx("span",{children:"Search Results"})]}):i.jsx("span",{style:{opacity:.5,fontWeight:500},children:"Command Bar"})}),i.jsx("div",{className:vt.dragBarControlsRight,children:i.jsx("button",{className:vt.newChatBtn,onClick:Be,title:"New Chat",children:i.jsx(sl,{size:20})})})]}),i.jsxs("div",{className:vt.contentWrapper,children:[pe&&i.jsx("div",{className:vt.chatSectionFill,children:i.jsxs("div",{className:vt.chatMessagesFill,children:[ee.chatHistory.map((Ne,Le)=>i.jsx("div",{className:`${vt.chatBubble} ${Ne.role==="user"?vt.chatBubbleUser:Ne.role==="model"?vt.chatBubbleModel:vt.chatBubbleSystem}`,children:Ne.role==="model"?i.jsx(ws,{remarkPlugins:[Ua],children:Ne.text}):Ne.text},Le)),ee.isProcessing&&i.jsxs("div",{className:vt.processing,children:[i.jsx(ao,{size:14,className:vt.spinner}),"Thinking..."]})]})}),ce&&i.jsxs("div",{className:G?vt.overlayContent:vt.content,children:[f.length>0&&Ge&&!pe&&i.jsxs("div",{className:vt.section,children:[i.jsx("div",{className:vt.sectionTitle,children:"Newly Registered"}),i.jsx("div",{className:vt.recentList,children:f.map(Ne=>i.jsxs("div",{className:vt.recentPill,onClick:()=>Ye(Ne),children:[i.jsx("span",{className:vt.recentName,children:Ne.name||"Patient"}),i.jsxs("span",{className:vt.recentToken,children:["#",Ne.token]}),i.jsxs("span",{className:vt.recentInfo,children:[Ne.age?`${Ne.age}y`:""," ",Ne.gender||""]})]},Ne.id))})]}),Ge&&!pe&&i.jsxs("div",{className:vt.section,children:[i.jsx("div",{className:vt.sectionTitle,children:"Quick Commands"}),i.jsx("div",{className:vt.examplesGrid,children:xW.map((Ne,Le)=>i.jsxs("div",{className:vt.exampleCard,onClick:()=>Ze(Ne.text),children:[i.jsx("span",{className:vt.exampleIcon,children:Ne.icon}),i.jsx("span",{className:vt.exampleText,children:Ne.text})]},Le))})]}),S&&i.jsx("div",{className:vt.section,children:i.jsxs("div",{className:vt.processing,children:[i.jsx(ao,{size:16,className:vt.spinner}),"Searching..."]})}),b.length>0&&!S&&i.jsxs("div",{className:vt.section,children:[i.jsx("div",{className:vt.sectionTitle,children:"Pages Found"}),i.jsx("div",{className:vt.resultsList,children:b.map((Ne,Le)=>i.jsxs("div",{className:vt.resultItem,onClick:()=>at(Ne),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsx("span",{style:{color:"#7c3aed"},children:Ne.icon}),i.jsx("span",{className:vt.resultName,children:Ne.name})]}),i.jsx("span",{className:vt.resultDetails,style:{fontSize:"0.7rem"},children:"Jump to page"})]},Le))})]}),je&&h.length>0&&i.jsxs("div",{className:vt.section,children:[i.jsx("div",{className:vt.sectionTitle,children:"Patients Found"}),i.jsx("div",{className:vt.resultsList,children:h.map(Ne=>i.jsxs("div",{className:vt.resultItem,onClick:()=>Ye(Ne),children:[i.jsxs("div",{children:[i.jsxs("span",{className:vt.resultToken,children:["[#",Ne.token,"]"]}),i.jsx("span",{className:vt.resultName,children:Ne.name})]}),i.jsxs("span",{className:vt.resultDetails,children:[Ne.age?`${Ne.age} yrs`:"",Ne.age&&Ne.gender?" / ":"",Ne.gender||""]})]},Ne.id))})]}),_e&&!pe&&i.jsx("div",{className:vt.section,children:i.jsxs("div",{className:vt.noResults,children:["Press ",i.jsx("strong",{children:"Enter"}),' to send "',l,'" to AI Assistant']})})]})]}),i.jsx("div",{className:vt.header,children:i.jsxs("div",{className:vt.inputWrapper,children:[i.jsxs("div",{className:vt.inputContainer,children:[i.jsx("div",{className:vt.minimizedSearchIcon,children:i.jsx(kr,{size:24})}),i.jsx("textarea",{ref:Ne=>{o.current=Ne,Ne&&(Ne.style.height="auto",Ne.style.height=Math.min(Ne.scrollHeight,150)+"px")},className:vt.input,placeholder:L?"Type here...":"Search (Name/Token/Phone), Ask AI, or Enter New Case (Name Age Sex Complaint)...",value:l,onChange:Ne=>{Ie(Ne),Ne.target.style.height="auto",Ne.target.style.height=Math.min(Ne.target.scrollHeight,150)+"px"},onKeyDown:st,rows:1,disabled:ee.isProcessing}),ie&&i.jsxs("div",{style:{position:"relative",marginRight:"0.5rem"},children:[i.jsx("img",{src:ie,alt:"Selected",style:{width:"24px",height:"24px",objectFit:"cover",borderRadius:"4px",border:"1px solid #e2e8f0"}}),i.jsx("button",{onClick:Q,style:{position:"absolute",top:-4,right:-4,background:"rgba(0,0,0,0.6)",color:"white",border:"none",borderRadius:"50%",padding:"1px",cursor:"pointer",display:"flex"},children:i.jsx(_n,{size:8})})]}),i.jsxs("div",{className:vt.controlsGroup,children:[i.jsx("button",{className:vt.iconButton,onClick:()=>{var Ne;return(Ne=ne.current)==null?void 0:Ne.click()},title:"Attach Image",children:i.jsx(Rb,{size:16})}),(l.trim().length>0||ie)&&i.jsx("button",{className:`${vt.iconButton} ${vt.sendButton}`,onClick:()=>J(l),title:"Send to AI",children:i.jsx(Mb,{size:16})}),i.jsx("button",{className:vt.iconButton,onClick:re,title:"Voice Input",children:i.jsx(hg,{size:16})})]})]}),i.jsx("input",{type:"file",ref:ne,onChange:le,accept:"image/*",style:{display:"none"}})]})})]}),M&&yE&&i.jsx(wg,{options:yW,children:i.jsx(Zb,{onClose:()=>R(!1),patientData:{id:null,token:null,name:"New Case",age:null,gender:null},tokenNumber:null,onAiSummaryChange:$})})]})},vW=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[o,l]=w.useState(null),[d,f]=w.useState(!1),u=Rt(),h=async v=>{v.preventDefault(),f(!0),l(null);try{const S=await ge("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!S.ok){let T=`Login failed with status: ${S.status}`;try{T=(await S.json()).message||T}catch{try{const M=await S.text();M&&(T=`${T} - ${M}`)}catch{}}throw new Error(T)}const k=await S.json();console.log("Login successful:",k),localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Login failed:",S),l(S.message||"Login failed. Please check your credentials.")}finally{f(!1)}},g=async v=>{f(!0),l(null);try{const S=await ge("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v.credential})});if(!S.ok)throw new Error("Google Sign-In failed");const k=await S.json();localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Google Login Error:",S),l("Google Sign-In failed. Please try again.")}finally{f(!1)}},b=()=>{console.error("Google Login Failed"),l("Google Sign-In was unsuccessful. Please try again.")};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Newtons AI HMS"}),i.jsx("p",{className:"auth-subtitle",children:"Sign in to continue"}),i.jsxs("form",{onSubmit:h,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:v=>t(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"email",children:"Email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:v=>a(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"password",children:"Password"})]}),o&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:o})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:d,className:"auth-submit-button",children:d?"Signing in...":"Sign In"})})]}),i.jsx("div",{className:"google-login-container",children:i.jsx(OP,{onSuccess:g,onError:b,useOneTap:!0})}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(Ss,{to:"/register",className:"auth-navigation-link",children:"Create account"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},wW=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState(null),[h,g]=w.useState(!1),b=Rt(),v=async S=>{S.preventDefault(),g(!0),u(null);try{const k=await ge("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),u(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>r(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>o(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>d(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),f&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:f})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:h,className:"auth-submit-button",children:h?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(Ss,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var xE={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},q_=Tn.createContext&&Tn.createContext(xE),SW=["attr","size","title"];function NW(e,n){if(e==null)return{};var t=CW(e,n),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function CW(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function bb(){return bb=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},bb.apply(this,arguments)}function V_(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function vb(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?V_(Object(t),!0).forEach(function(r){_W(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):V_(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _W(e,n,t){return n=jW(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function jW(e){var n=kW(e,"string");return typeof n=="symbol"?n:n+""}function kW(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function bE(e){return e&&e.map((n,t)=>Tn.createElement(n.tag,vb({key:t},n.attr),bE(n.child)))}function Qa(e){return n=>Tn.createElement(TW,bb({attr:vb({},e.attr)},n),bE(e.child))}function TW(e){var n=t=>{var{attr:r,size:a,title:o}=e,l=NW(e,SW),d=a||t.size||"1em",f;return t.className&&(f=t.className),e.className&&(f=(f?f+" ":"")+e.className),Tn.createElement("svg",bb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:f,style:vb(vb({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),o&&Tn.createElement("title",null,o),e.children)};return q_!==void 0?Tn.createElement(q_.Consumer,null,t=>n(t)):n(xE)}function $0(e){return Qa({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function H_(e){return Qa({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function G_(e){return Qa({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function Eh(e){return Qa({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function Px(e){return Qa({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function Dx(e){return Qa({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function Ix(e){return Qa({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Ah(e){return Qa({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function vE(e){return Qa({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function Y_(e){return Qa({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function EW(e){return Qa({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function W_(e){return Qa({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Lm(e){return Qa({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const wE={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:Eh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:Px},{path:"/dashboard/users",name:"User Management",icon:Lm}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:Eh}]},{title:"Clinic Management",links:[{path:"/dashboard/clinic-hub",name:"Clinic Hub",icon:H_}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:Px},{path:"/dashboard/patients",name:"All Patients",icon:Lm},{path:"/dashboard/patients/search",name:"Search Patient",icon:Ah}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:$0},{path:"/dashboard/inventory",name:"Inventory Management",icon:Ix},{path:"/dashboard/inventory/add",name:"Add Drug",icon:Ix},{path:"/dashboard/distributors",name:"Distributor Management",icon:Lm}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:Y_},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:Dx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:Dx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:Ah},{path:"/dashboard/add-patient",name:"Add Patient",icon:Px},{path:"/manage-admission",name:"Manage Admission",icon:W_}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:G_},{path:"/billing",name:"Billing",icon:Dx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:Y_}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:Eh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:Lm},{path:"/dashboard/patients/add",name:"Add Patient",icon:Px},{path:"/dashboard/patients/search",name:"Search Patient",icon:Ah}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:Dx},{path:"/manage-admission",name:"Manage Admission",icon:W_}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:Eh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:G_},{path:"/lab/search-report",name:"Search Lab Report",icon:Ah}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:Eh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:Ix},{path:"/dashboard/inventory/add",name:"Add Drug",icon:Ix},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:$0},{path:"/dashboard/distributors",name:"Distributor Management",icon:Lm}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:$0},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:H_},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:Ah}]}]},AW=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const o=Gr(),[l,d]=w.useState(""),f=wE[t]||[],[u,h]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(T=>{if(g.current){const P=window.innerWidth-T.clientX;P>250&&P<window.innerWidth*.8&&h(P)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=f.map(T=>({...T,links:T.links.filter(P=>P.name.toLowerCase().includes(l.toLowerCase()))})).filter(T=>T.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${u}px`,right:r?"0":`-${u}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(Ss,{to:"/dashboard",className:"home-button",onClick:a,children:i.jsx(Eh,{})}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx(Ah,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:T=>d(T.target.value)})]}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:k.map((T,P)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:T.title}),i.jsx("ul",{className:"sub-page-list",children:T.links.map(M=>{const R=M.icon;return i.jsx("li",{children:i.jsxs(Ss,{to:M.path,className:o.pathname===M.path?"active":"",onClick:a,children:[R&&i.jsx(R,{})," ",M.name]})},M.path)})})]},P))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(vE,{})," Logout"]})]})]})},PW=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:o})=>{const l=Gr(),d=o[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"close-button",onClick:a,children:i.jsx(EW,{})})]}),i.jsx("nav",{children:d.map((f,u)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:f.title}),i.jsx("ul",{className:"sub-page-list",children:f.links.map(h=>{const g=h.icon;return i.jsx("li",{children:i.jsxs(Ss,{to:h.path,className:l.pathname===h.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",h.name]})},h.path)})})]},u))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(vE,{})," Logout"]})]})]})]})},DW=({})=>{const e=Rt(),[n]=w.useState(!1),[t,r]=w.useState(null),[a,o]=w.useState(null);return w.useEffect(()=>{if(a){const l=setTimeout(()=>o(null),5e3);return()=>clearTimeout(l)}},[a]),n?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",a&&i.jsxs("div",{className:`alert-box ${a.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:a.type==="success"?i.jsx(Wa,{size:18}):i.jsx(jr,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:a.message})}),i.jsx("button",{onClick:()=>o(null),className:"alert-box-close",children:i.jsx(_n,{size:16})})]}),t&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(jr,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:t})}),i.jsx("button",{onClick:()=>r(null),className:"alert-box-close",children:i.jsx(_n,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>e("."),className:"admin-nav-button",title:"Home",children:[i.jsx(Lk,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-hub"),className:"admin-nav-button",children:[i.jsx($k,{})," Clinic"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:"admin-nav-button",children:[i.jsx(Ud,{})," Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/analysis"),className:"admin-nav-button",children:[i.jsx(S1,{})," Analysis"]}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(Ok,{})," Subscriptions"]}),i.jsx("button",{onClick:()=>e("/refill-reminders"),className:"admin-nav-button",children:"Refills"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(S1,{})," Labs"]}),i.jsxs("button",{onClick:()=>e("patients"),className:"admin-nav-button",children:[i.jsx(Jh,{})," Patients"]}),i.jsxs("button",{onClick:()=>e("search-patient"),className:"admin-nav-button",children:[i.jsx(kr,{})," Search"]})]}),i.jsx("div",{className:"admin-content-section",children:i.jsx(TD,{})})]})},IW="_container_1hp4j_5",RW="_visualContainer_1hp4j_31",MW="_brandTitle_1hp4j_49",OW="_searchBar_1hp4j_105",LW="_searchIconWrapper_1hp4j_153",FW="_searchIcon_1hp4j_153",$W="_placeholderText_1hp4j_177",zW="_shortcutHint_1hp4j_197",BW="_key_1hp4j_213",UW="_plus_1hp4j_237",qW="_micButtonWrapper_1hp4j_247",VW="_micIcon_1hp4j_295",$a={container:IW,visualContainer:RW,brandTitle:MW,searchBar:OW,searchIconWrapper:LW,searchIcon:FW,placeholderText:$W,shortcutHint:zW,key:BW,plus:UW,micButtonWrapper:qW,micIcon:VW},SE="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",HW={apiKey:SE},GW=()=>{const{openCommandBar:e,isOpen:n,setPreFilledQuery:t}=Lh(),[r,a]=w.useState(!1),[o,l]=w.useState(null),d=f=>{f.stopPropagation(),a(!0)};return w.useEffect(()=>{o&&(a(!1),t&&t(o),e(),l(null))},[o,e,t]),i.jsxs("div",{className:$a.container,children:[i.jsxs("div",{className:$a.visualContainer,children:[i.jsx("h1",{className:$a.brandTitle,children:"Newtons Ai"}),!n&&i.jsxs("div",{className:$a.searchBar,onClick:()=>e(),children:[i.jsx("div",{className:$a.searchIconWrapper,children:i.jsx(kr,{className:$a.searchIcon})}),i.jsx("span",{className:$a.placeholderText,children:"Search or Ask AI..."}),i.jsx("div",{className:$a.micButtonWrapper,onClick:d,children:i.jsx(hg,{className:$a.micIcon})}),i.jsxs("div",{className:$a.shortcutHint,children:[i.jsx("span",{className:$a.key,children:"Ctrl"}),i.jsx("span",{className:$a.plus,children:"+"}),i.jsx("span",{className:$a.key,children:"K"})]})]})]}),r&&SE&&i.jsx(wg,{options:HW,children:i.jsx(Zb,{onClose:()=>a(!1),patientData:{id:null,token:null,name:"New Case",age:null,gender:null},tokenNumber:null,onAiSummaryChange:l})})]})},iu=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},YW=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},Ch=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:o,noDataText:l})=>{const d=w.useMemo(()=>{const f={};t.forEach(h=>{if(isNaN(h.date.getTime())){f["Unknown Date"]||(f["Unknown Date"]=[]),f["Unknown Date"].push(h);return}const g=YW(h.originalDateString);f[g]||(f[g]=[]),f[g].push(h)});const u=Object.keys(f);return u.sort((h,g)=>{if(h==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const T=k.split(" ");if(T.length===3){const M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(T[1]);if(M!==-1)return new Date(parseInt(T[2]),M,parseInt(T[0]))}return new Date(k)},v=b(h),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(h)}),u.map(h=>({date:h,items:f[h]}))},[t]);return i.jsxs("div",{className:"mb-2 bg-slate-50 rounded-lg border border-slate-200 overflow-hidden",children:[i.jsxs("h4",{className:"text-xs font-semibold text-slate-700 bg-slate-100 px-3 py-2 border-b border-slate-200 flex items-center",children:[n&&i.jsx(n,{size:14,className:"mr-2 text-indigo-600"}),e]}),i.jsxs("div",{className:"p-2",children:[a&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:o}),!a&&t.length===0&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:l}),!a&&t.length>0&&i.jsx("div",{className:"space-y-3",children:d.map(({date:f,items:u})=>i.jsxs("div",{children:[i.jsx("h5",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-1.5 px-1",children:f}),i.jsx("div",{className:"space-y-2 pl-2 border-l-2 border-slate-200 ml-1",children:u.map((h,g)=>i.jsx("div",{className:"flex items-start",children:i.jsx("div",{className:"flex-grow",children:r(h)})},`${h.type}-${h.originalDateString}-${g}`))})]},f))})]})]})},z0=()=>{var ne,le;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[T,P]=w.useState(null),{patientId:M}=Xi(),R=Rt(),z=w.useCallback(async oe=>{g(null),d(null),u(null),k(!0),P(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const E=await ge(`/api/patients/${oe}`);if(!E.ok)throw new Error(`Patient details fetch failed (${E.status})`);const de=await E.json();d(de);const he=await ge(`/api/queue/patient/${oe}/latest`);if(!he.ok&&he.status!==404)throw new Error(`Queue entry fetch failed (${he.status})`);if(he.ok){const D=await he.json();u(D)}await $(oe)}catch(E){console.error("Error fetching specific patient data:",E),g(E.message||"Failed to load patient data."),P(E.message||"Failed to load patient history.")}finally{k(!1)}},[]),$=w.useCallback(async oe=>{k(!0),P(null);try{const[E,de,he,D]=await Promise.all([ge(`/api/queue/patient/${oe}/complaints`),ge(`/api/lab/patient/${oe}`),ge(`/api/lab/orders/patient/${oe}?status=pending`),ge(`/api/pharmacy-orders/patient/${oe}`)]),me=E.ok?await E.json():[],Ce=de.ok?await de.json():[],te=he.ok?await he.json():[],K=D.ok?await D.json():[];v({pastComplaints:me||[],labReports:Ce||[],pendingLabOrders:te||[],pharmacyOrders:K||[]})}catch(E){console.error("Error fetching patient history:",E),P(E.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),L=w.useCallback(async()=>{r(!0),o(null);try{const oe=await ge("/api/queue/doctor");if(!oe.ok){const de=await oe.text();throw new Error(`API Error (${oe.status}): ${de||oe.statusText}`)}const E=await oe.json();if(E===null||typeof E!="object"||typeof E.waitingCount!="number")throw console.error("Invalid queue data format:",E),new Error("Invalid queue data format received");n({currentPatient:E.currentPatient||null,nextPatient:E.nextPatient||null,waitingCount:E.waitingCount})}catch(oe){console.error("Error fetching queue data:",oe),o(oe.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let oe=null;return M?(z(M),n({currentPatient:null,nextPatient:null,waitingCount:0})):(L(),oe=setInterval(L,1e4),d(null),u(null)),()=>{oe&&clearInterval(oe)}},[M,z,L]),w.useEffect(()=>{var oe;!M&&((oe=e.currentPatient)!=null&&oe.patientId)?$(e.currentPatient.patientId):!M&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null))},[M,(ne=e.currentPatient)==null?void 0:ne.patientId,$]);const B=((le=e.currentPatient)==null?void 0:le.patientId)||(M?parseInt(M,10):null),q=w.useMemo(()=>{if(!B||!b.pastComplaints)return[];const oe=b.pastComplaints.map(E=>({date:new Date(E.createdAt),type:"Complaint",data:E,originalDateString:E.createdAt})).filter(E=>!isNaN(E.date.getTime()));return oe.sort((E,de)=>de.date.getTime()-E.date.getTime()),oe},[B,b.pastComplaints]),W=w.useMemo(()=>{if(!B)return[];const oe=[];return(b.pendingLabOrders??[]).forEach(E=>{const de=new Date(E.createdAt);isNaN(de.getTime())||oe.push({date:de,type:"Lab Order (Pending)",data:E,originalDateString:E.createdAt})}),(b.labReports??[]).forEach(E=>{const de=E.reportCreatedAt?new Date(E.reportCreatedAt):null;de&&!isNaN(de.getTime())&&oe.push({date:de,type:"Lab Report",data:E,originalDateString:E.reportCreatedAt})}),oe.sort((E,de)=>de.date.getTime()-E.date.getTime()),oe},[B,b.pendingLabOrders,b.labReports]),I=w.useMemo(()=>{if(!B||!b.pharmacyOrders)return[];const oe=b.pharmacyOrders.map(E=>({date:new Date(E.date),type:"Pharmacy Order",data:E,originalDateString:E.date})).filter(E=>!isNaN(E.date.getTime()));return oe.sort((E,de)=>de.date.getTime()-E.date.getTime()),oe},[B,b.pharmacyOrders]),F=async()=>{r(!0),o(null);try{await ge("/api/queue/doctor/next",{method:"POST"}),await L()}catch(oe){console.error("Error calling next patient:",oe),o(oe.message||"Failed to call next patient.")}finally{r(!1)}},V=async()=>{if(!(!e.currentPatient||M)){r(!0),o(null);try{await ge(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await L(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null)}catch(oe){console.error("Error completing consultation:",oe),o(oe.message||"Failed to complete consultation.")}finally{r(!1)}}},ee=oe=>{switch(oe){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return oe}},[ie,Y]=w.useState("info");let Q=null;return e.currentPatient&&(Q=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-teal-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${ie==="info"?"active":""}`,onClick:()=>Y("info"),children:"Patient Details"}),i.jsx("button",{className:`mobile-tab-btn ${ie==="history"?"active":""}`,onClick:()=>Y("history"),children:"History & Context"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${ie==="info"?"block":"hidden md:block"}`,children:[i.jsxs("h2",{className:"text-xl text-teal-700 font-semibold mb-3 flex items-center",children:["NOW SEEING",i.jsx("span",{className:"ml-2 text-xs font-normal text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:"Live Consultation"})]}),i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-3xl font-bold text-gray-800 mb-1 leading-tight",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg text-gray-600 flex items-center mt-1",children:[i.jsxs("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm mr-2",children:[e.currentPatient.age," Yrs"]}),i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0 flex flex-col items-end",children:[i.jsxs("div",{className:"text-2xl font-bold text-gray-700 mb-1",children:["#",e.currentPatient.token]}),i.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:ee(e.currentPatient.status)})]})]}),e.currentPatient.case_summary&&i.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-100 rounded-md",children:[i.jsx("h4",{className:"text-xs font-bold text-amber-800 uppercase mb-1",children:"AI Brief"}),i.jsx("p",{className:"text-sm text-amber-900 leading-snug",children:e.currentPatient.case_summary})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex flex-col sm:flex-row justify-end gap-3 border-t pt-4",children:[i.jsxs("button",{onClick:()=>{var E;const oe=(E=e.currentPatient)==null?void 0:E._id;oe&&R(`/dashboard/edit-complaint/${oe}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary w-full sm:w-auto",children:[i.jsx(kw,{size:16})," Open Consultation"]}),i.jsxs("button",{onClick:V,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success w-full sm:w-auto",children:[i.jsx(uF,{size:16})," Complete"]})]})]})," ",i.jsxs("div",{className:`complaint-section md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${ie==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-gray-800 mb-2 flex items-center justify-between",children:[i.jsx("span",{children:"History & Context"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Updating..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(Ch,{title:"Past Complaints",icon:Jl,items:q,isLoading:S,loadingText:"Fetching...",noDataText:"No past complaints.",renderItemContent:oe=>i.jsxs("span",{className:"block text-xs",children:[oe.data.complaint,i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:iu(oe.originalDateString)})]})}),i.jsx(Ch,{title:"Lab Reports & Orders",icon:io,items:W,isLoading:S,loadingText:"Fetching...",noDataText:"No lab history.",renderItemContent:oe=>oe.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),oe.data.tests.map(E=>E.name).join(", "),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:iu(oe.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-green-700 mb-0.5",children:["Report: ",oe.data.testName]}),i.jsxs("div",{className:"text-gray-600 italic",children:['"',oe.data.reportFindings.substring(0,60),oe.data.reportFindings.length>60?"...":"",'"']}),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:iu(oe.originalDateString)})]})}),i.jsx(Ch,{title:"Medications",icon:Bd,items:I,isLoading:S,loadingText:"Fetching...",noDataText:"No medication history.",renderItemContent:oe=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-gray-800",children:oe.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:[iu(oe.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:oe.data.status})]})]})}),q.length===0&&W.length===0&&I.length===0&&!S&&i.jsx("div",{className:"text-gray-400 text-center py-4 text-xs italic bg-gray-50 rounded border border-dashed border-gray-200",children:"No history records found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>R(-1),className:"back-button mr-4",children:i.jsx(sn,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),M?i.jsxs(i.Fragment,{children:[h&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:h}),l&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-purple-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${ie==="info"?"active":""}`,onClick:()=>Y("info"),children:"Patient Record"}),i.jsx("button",{className:`mobile-tab-btn ${ie==="history"?"active":""}`,onClick:()=>Y("history"),children:"History"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${ie==="info"?"block":"hidden md:block"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold flex items-center gap-2",children:"Patient Record"}),i.jsxs("button",{onClick:()=>R("/dashboard/doctor"),className:"text-xs font-medium text-slate-500 hover:text-slate-800 flex items-center gap-1 transition-colors px-2 py-1 bg-slate-100 rounded",children:[i.jsx(sn,{size:12})," Back to Queue"]})]}),i.jsx("div",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-700 to-indigo-600 mb-1 leading-tight",children:l.name}),i.jsxs("div",{className:"text-lg text-slate-600 mb-4 flex items-center gap-2",children:[i.jsxs("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:[l.age||"N/A"," Yrs"]}),i.jsx("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:l.gender||"N/A"})]}),i.jsxs("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-sm",children:[i.jsx("label",{className:"font-semibold block mb-2 text-xs uppercase tracking-wider text-slate-500",children:"Latest Activity"}),f?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words text-slate-700",children:[i.jsx("span",{className:"font-medium text-slate-900",children:"Complaint:"})," ",f.complaint||i.jsx("span",{className:"text-slate-400 italic",children:"None"}),i.jsx("div",{className:"mt-1",children:i.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${f.status==="consulting"?"bg-teal-100 text-teal-800":f.status==="seen"?"bg-emerald-100 text-emerald-800":f.status==="waiting"?"bg-blue-100 text-blue-800":"bg-slate-100 text-slate-800"}`,children:ee(f.status)})})]}),f.status==="consulting"&&f._id&&i.jsx("button",{onClick:()=>R(`/dashboard/edit-complaint/${f._id}`),className:"ml-4 px-3 py-1.5 text-xs bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-md font-medium border border-indigo-200 transition-colors",children:"Resume"})]}),f.case_summary&&i.jsxs("div",{className:"text-xs text-slate-700 bg-amber-50 p-2.5 rounded border border-amber-100",children:[i.jsx("span",{className:"font-bold text-amber-800 uppercase text-[10px] block mb-1",children:"AI Summary"}),f.case_summary]})]}):i.jsx("p",{className:"text-slate-400 italic text-sm",children:"No queue entry found for this patient today."})]})]}),i.jsxs("div",{className:`md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${ie==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-slate-800 mb-3 flex items-center justify-between",children:[i.jsx("span",{children:"Patient History"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Loading..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(Ch,{title:"Past Complaints",icon:Jl,items:q,isLoading:S,loadingText:"Loading...",noDataText:"No past complaints.",renderItemContent:oe=>i.jsxs("div",{className:"text-xs",children:[oe.data.complaint,i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:iu(oe.originalDateString)})]})}),i.jsx(Ch,{title:"Lab Reports",icon:io,items:W,isLoading:S,loadingText:"Loading...",noDataText:"No lab history.",renderItemContent:oe=>oe.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),i.jsx("div",{children:oe.data.tests.map(E=>E.name).join(", ")}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:iu(oe.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-emerald-700 mb-0.5",children:["Report: ",oe.data.testName]}),i.jsxs("div",{className:"text-slate-600 italic",children:['"',oe.data.reportFindings.substring(0,50),oe.data.reportFindings.length>50?"...":"",'"']}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:iu(oe.originalDateString)})]})}),i.jsx(Ch,{title:"Medications",icon:Bd,items:I,isLoading:S,loadingText:"Loading...",noDataText:"No pharmacy history.",renderItemContent:oe=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-slate-800",children:oe.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:[iu(oe.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:oe.data.status})]})]})}),q.length===0&&W.length===0&&I.length===0&&!S&&i.jsx("div",{className:"text-slate-400 text-center py-4 text-xs italic bg-slate-50 rounded border border-dashed border-slate-200",children:"No history records found."})]})]})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>R("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx(Ew,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>R("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:Q||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:ee(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:F,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},WW="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",QW={apiKey:WW},Hm=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(!1),[h,g]=w.useState(null),b=w.useRef(null),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[R,z]=w.useState(null),[$,L]=w.useState([]),[B,q]=w.useState(!1),W=Rt(),I=Gr(),F=jw({settings:{},staffList:[]}),{selectedImage:V,handleImageSelect:ee,clearImage:ie}=F,Y=w.useRef(null),Q=K=>{var xe;const J=(xe=K.target.files)==null?void 0:xe[0];J&&ee(J)};w.useEffect(()=>{F.chatHistory.length>0&&B&&F.isProcessing},[F.chatHistory.length]),w.useEffect(()=>{(async()=>{try{const J=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),xe=await ge(`/api/patients?${J.toString()}`);if(xe.ok){const He=await xe.json();L(He.patients||[])}}catch(J){console.error("Error fetching recent patients:",J)}})()},[]),w.useEffect(()=>{F.setChatQuery(e)},[e]);const ne=w.useCallback(async K=>{if(!(K||e).trim()){g("Please enter complaint details.");return}u(!0),g(null),K&&K!==F.chatQuery&&F.setChatQuery(K);try{F.handleSendMessage(),n("")}catch(xe){console.error("AI Error:",xe),g("AI failed to process. Try again."),u(!1)}},[e,F]);w.useEffect(()=>{!F.isProcessing&&f&&u(!1)},[F.isProcessing,f]),w.useEffect(()=>{const K=b.current;K&&(K.style.height="auto",K.style.height=`${K.scrollHeight}px`);const xe=new URLSearchParams(I.search).get("caseDetails");if(xe){const He=decodeURIComponent(xe);He!==e&&(n(He),S(!0))}},[I.search,e]),w.useEffect(()=>{v&&e.trim()&&(W(I.pathname,{replace:!0}),ne(e),S(!1))},[v,e,ne,W,I.pathname]),w.useEffect(()=>{const K=b.current;K&&(K.style.height="auto",K.style.height=`${K.scrollHeight}px`)},[e]),w.useEffect(()=>{P&&(n(P),T(!1),F.setChatQuery(P),setTimeout(()=>F.handleSendMessage(),0),M(null))},[P,F]);const le=()=>{z({id:null,token:null,name:"New Case",age:null,gender:null}),T(!0)},oe=w.useMemo(()=>yg(async K=>{const J=K.trim(),xe=/^\d+$/.test(J),He=J.split(/\s+/).length;if(J.length<2||xe&&J.length>10||!xe&&He>2){r([]),o(!1),d(null);return}o(!0),d(null);try{const re=new URLSearchParams({search:encodeURIComponent(K),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),Be=await ge(`/api/patients?${re.toString()}`);if(!Be.ok){const Ie=await Be.text();throw new Error(`API Error (${Be.status}): ${Ie||Be.statusText}`)}const Ae=await Be.json();r(Ae.patients)}catch(re){console.error("Error searching patients:",re),d(re.message||"Failed to search patients."),r([])}finally{o(!1)}},300),[]),E=K=>{const J=K.target.value;n(J);const xe=J.trim(),He=/^\d+$/.test(xe),re=xe.split(/\s+/).length;xe.length>=2&&!(He&&xe.length>10||!He&&re>2)?o(!0):(o(!1),r([])),oe(J)},de=K=>{K.key==="Enter"&&!K.shiftKey&&(K.preventDefault(),e.trim()&&!a&&te())},he=async K=>{K&&K.id&&W(`/dashboard/edit-complaint/patient/${K.id}`)},D=[{icon:"",title:"Example: Fever & Cold",description:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Example: Stomach Ache",description:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}],me=K=>{n(K),setTimeout(()=>{F.handleSendMessage(K),n(""),r([])},50)},Ce=()=>{n(""),r([]),F.refreshChat()},te=()=>{!e.trim()&&!V||(oe.cancel(),F.handleSendMessage(e),n(""),r([]))};return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>W("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsx("button",{onClick:()=>W(-1),className:"patient-search-button patient-search-button-back",children:i.jsx(sn,{size:16})})]}),i.jsxs("div",{className:"patient-search-content-box",children:[l&&i.jsx("p",{className:"patient-search-error",children:l}),h&&i.jsx("p",{className:"patient-search-error",children:h}),$.length>0&&i.jsxs("div",{className:"newly-registered-section",children:[i.jsx("div",{className:"recent-list",children:$.map(K=>i.jsxs("div",{className:"recent-patient-pill",onClick:()=>he(K),children:[i.jsxs("div",{className:"recent-name-container",children:[i.jsx("span",{className:"recent-name",children:K.name||"New Patient"}),i.jsxs("span",{className:"recent-token",children:["#",K.token]})]}),i.jsxs("div",{className:"recent-info",children:[K.age," yrs / ",K.gender]})]},K.id))}),i.jsx("div",{className:"newly-registered-label",children:"NEWLY REGISTERED"})]}),F.chatHistory.length===0&&t.length===0&&i.jsxs("div",{className:"example-cases-section",children:[i.jsxs("div",{className:"example-cases-header",children:[i.jsx("span",{className:"sparkles-icon",children:""}),i.jsx("h3",{children:"Try AI with Example Cases"})]}),i.jsx("div",{className:"example-cards-container",children:D.map((K,J)=>i.jsxs("div",{className:"example-case-card",onClick:()=>me(K.text),children:[i.jsx("div",{className:"example-icon",children:K.icon}),i.jsxs("div",{className:"example-content",children:[i.jsx("div",{className:"example-title",children:K.title}),i.jsx("div",{className:"example-description",children:K.description})]})]},J))})]})]}),F.chatHistory.length>0&&!f&&i.jsxs("div",{className:`ai-chat-overlay ${B?"minimized":""}`,children:[i.jsxs("div",{className:"ai-chat-header",children:[i.jsx("span",{children:"AI Assistant"}),i.jsx("div",{className:"ai-chat-controls",children:i.jsx("button",{className:"icon-btn",onClick:()=>Ce(),title:"Clear Chat",children:i.jsx(_n,{size:16})})})]}),i.jsxs("div",{className:"ai-chat-messages",children:[F.chatHistory.map((K,J)=>i.jsx("div",{className:`chat-bubble ${K.role==="model"?"model":"user"}`,children:K.role==="system"?i.jsx("i",{children:K.text}):K.text},J)),F.isProcessing&&i.jsx("div",{className:"chat-bubble model",children:"Typing..."})]})]}),t.length>0&&!f&&i.jsxs("div",{className:"patient-search-results-overlay",children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingBottom:"0.5rem"},children:[i.jsx("div",{style:{fontWeight:600,color:"#64748b"},children:"Found Patients"}),i.jsx("button",{onClick:()=>r([]),style:{border:"none",background:"transparent",color:"#94a3b8",cursor:"pointer"},children:i.jsx(_n,{size:14})})]}),t.map(K=>i.jsxs("div",{onClick:()=>he(K),className:"patient-search-result-item",children:[i.jsxs("div",{className:"patient-search-result-item-name-container",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["[#",K.token,"]"]}),i.jsx("span",{className:"patient-search-result-item-name",children:K.name})]}),i.jsxs("div",{className:"patient-search-result-item-details",children:[K.age?`${K.age} yrs`:"",K.age&&K.gender?" / ":"",K.gender||"N/A"]})]},K.id))]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[i.jsxs("div",{className:"cmd-input-container",children:[V&&i.jsxs("div",{className:"cmd-image-preview",children:[i.jsx("img",{src:V,alt:"Selected"}),i.jsx("button",{className:"cmd-image-delete",onClick:ie,children:i.jsx(_n,{size:12})})]}),i.jsx("textarea",{ref:b,placeholder:"Search (Name/Token/Phone), Ask AI, or Enter New Case...",value:e,onChange:E,onKeyDown:de,className:"cmd-input",disabled:f||F.isProcessing,rows:1}),i.jsxs("div",{className:"cmd-controls-group",children:[i.jsx("input",{type:"file",ref:Y,onChange:Q,accept:"image/*",style:{display:"none"}}),i.jsx("button",{className:"cmd-icon-btn",onClick:()=>{var K;return(K=Y.current)==null?void 0:K.click()},title:"Attach Image",children:i.jsx(Rb,{})}),i.jsx("button",{className:"cmd-icon-btn",onClick:le,title:"Voice Input",children:i.jsx(hg,{})}),(e.length>0||V)&&i.jsx("button",{className:"cmd-icon-btn send-btn",onClick:te,title:"Send",children:i.jsx(Mb,{})})]})]}),k&&i.jsx(wg,{options:QW,children:i.jsx(Zb,{onClose:()=>T(!1),patientData:R,tokenNumber:null,onAiSummaryChange:M})})]})]})},NE=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=Rt(),R=w.useCallback(HT.debounce(async I=>{if(I.trim().length<2){r([]),k(!1);return}k(!0),P(null);try{const F=new URLSearchParams({search:encodeURIComponent(I),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),V=await ge(`/api/patients?${F.toString()}`);if(!V.ok){const ie=await V.text();throw new Error(`API Error (${V.status}): ${ie||V.statusText||"Failed to fetch patients"}`)}const ee=await V.json();r(ee.patients)}catch(F){P(F instanceof Error?F.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),R(e)):(r([]),R.cancel()),()=>{R.cancel()}),[e,R]);const z=I=>{o(I),n(""),r([]),P(null),d(null),u(null),g(null),v(!1)},$=async()=>{if(!a){P("No patient selected.");return}P(null),k(!0);try{const I=await ge(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok){const V=await I.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(V.message||"Failed to admit patient")}const F=await I.json();alert(F.message||"Patient admitted successfully!"),F.bill&&F.bill.id?M(`/patient/${a.id}/admission-bill/${F.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),P("Admission successful, but couldn't navigate to billing."),o(F.patient))}catch(I){P(I instanceof Error?I.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){d(null),g(null);return}v(!0),u(null),d(null),g(null);try{const F=await ge(`/api/patients/${a.id}/active-bill?type=admission`);if(!F.ok)throw F.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const V=await F.json(),ee=V==null?void 0:V.id;if(!ee)throw new Error("Active admission bill ID not found in response.");d(ee);const ie=await ge(`/api/bills/${ee}`);if(!ie.ok)throw new Error(`Failed to fetch bill details (ID: ${ee}). Status: ${ie.status}`);const Y=await ie.json();if(Y&&Y.calculated)g(Y.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",Y),new Error("Fetched bill details are incomplete (missing calculated data).")}catch(F){u(F instanceof Error?F.message:"An unknown error occurred while fetching bill details."),d(null),g(null)}finally{v(!1)}})()},[a]);const L=async()=>{if(!a){P("No patient selected.");return}if(!a.admission_date||a.discharge_date){P("Patient is not currently admitted.");return}P(null),k(!0);try{const I=await ge(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok){const V=await I.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(V.message||"Failed to discharge patient")}const F=await I.json();alert(F.message||"Patient discharged successfully!"),F.patient?o(F.patient):(console.error("Discharge successful, but updated patient info missing in response."),o(null),P("Discharge successful, but couldn't update patient details locally."))}catch(I){P(I instanceof Error?I.message:"Failed to discharge patient")}finally{k(!1)}},B=()=>{if(!a||!l){P("Cannot navigate to billing: Patient or Bill ID missing.");return}M(`/patient/${a.id}/admission-bill/${l}`)};let q="",W=null;if(a){const I=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,F=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(q=`Patient admitted on: ${I}`,W=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",f&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:f})," ",!b&&h&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(h.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(h.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(h.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:B,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!f?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:L,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(q=`Patient admitted on ${I} and discharged on ${F}.`,W=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(q="Patient is not admitted.",W=i.jsx("button",{onClick:$,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>M(-1),className:"back-button",children:[i.jsx(sn,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:I=>n(I.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(I=>i.jsxs("li",{onClick:()=>z(I),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",I.name," (Token: ",I.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[I.admission_date?`Admitted: ${new Date(I.admission_date).toLocaleDateString()}`:"Not Admitted",I.discharge_date?`, Discharged: ${new Date(I.discharge_date).toLocaleDateString()}`:""]})]},I.id))]}),t.length===0&&e&&!S&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>o(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:q})," ",T&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",W]})]})},B0=15,J1=()=>{const e=Rt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(""),[u,h]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,T]=w.useState("created_at"),[P,M]=w.useState("desc"),[R,z]=w.useState(""),[$,L]=w.useState(!1),[B,q]=w.useState(null),[W,I]=w.useState([]),[F,V]=w.useState(""),[ee,ie]=w.useState(!1),[Y,Q]=w.useState(null),[ne,le]=w.useState(!0),[oe,E]=w.useState(null),[de,he]=w.useState(d);w.useEffect(()=>{const re=setTimeout(()=>{he(d),h(1)},500);return()=>{clearTimeout(re)}},[d]);const D=w.useCallback(async()=>{le(!0),E(null);try{const re=await ge("/api/subscriptions");if(!re.ok){let Ae=`Failed to fetch subscription plans (${re.status})`;try{Ae=(await re.json()).message||Ae}catch{}throw new Error(Ae)}const Be=await re.json();I(Be)}catch(re){console.error("Error fetching subscription plans:",re),E(re.message||"An unknown error occurred while fetching plans."),I([])}finally{le(!1)}},[]),me=w.useCallback(async(re,Be,Ae,Ie,Ye)=>{a(!0),l(null);try{const at=new URLSearchParams({page:re.toString(),limit:B0.toString(),sortBy:Ae,sortOrder:Ie});Be&&at.append("search",Be),Ye&&at.append("gender",Ye);const Ze=await ge(`/api/patients?${at.toString()}`);if(!Ze.ok){const st=await Ze.json();throw new Error(st.message||"Failed to fetch patients")}const Ke=await Ze.json();t(Ke.patients),S(Ke.totalCount),h(Ke.currentPage),b(Ke.totalPages)}catch(at){console.error("Error fetching patients:",at),l(`Failed to load patients: ${at.message}`),t([]),S(0),h(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{me(u,de,k,P,R),D()},[u,de,k,P,R,me,D]);const Ce=re=>{const Be=k===re&&P==="asc"?"desc":"asc";T(re),M(Be),h(1)},te=re=>{try{return new Date(re).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},K=()=>{L(!1),q(null),V(""),Q(null),ie(!1)},J=async(re,Be)=>{t(Ae=>Ae.map(Ie=>Ie.id===re?{...Ie,insurance_type:Be}:Ie));try{const Ae=await ge(`/api/patients/${re}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Be})});if(!Ae.ok){const Ie=await Ae.json();throw new Error(Ie.message||"Failed to update insurance type")}}catch(Ae){console.error("Error updating insurance type:",Ae),me(u,de,k,P,R)}},xe=(re,Be)=>{const Ae=new Date(re),Ie=Be.interval||1;switch(Be.period){case"daily":Ae.setDate(re.getDate()+Ie);break;case"weekly":Ae.setDate(re.getDate()+Ie*7);break;case"monthly":Ae.setMonth(re.getMonth()+Ie);break;case"yearly":Ae.setFullYear(re.getFullYear()+Ie);break;default:console.warn(`Unknown subscription period: ${Be.period}. Defaulting to 1 month.`),Ae.setMonth(re.getMonth()+1)}return Ae},He=async()=>{if(!B||!F){Q("Please select a subscription plan.");return}const re=W.find(Be=>Be.id===F);if(!re){Q("Selected plan details not found.");return}ie(!0),Q(null);try{const Be=new Date,Ae=xe(Be,re),Ie={subscription_plan_id:F,subscription_status:"active",subscription_start_date:Be.toISOString(),subscription_end_date:Ae.toISOString(),subscription_payment_method:"manual"},Ye=await ge(`/api/patients/${B.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ie)});if(!Ye.ok){const at=await Ye.json();throw new Error(at.message||"Failed to update patient subscription")}K(),me(u,de,k,P,R)}catch(Be){console.error("Error starting subscription:",Be),Q(`Failed to start subscription: ${Be.message}`)}finally{ie(!1)}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(sn,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(Ns,{size:28}),"All Registered Patients"]}),o&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:ne?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):oe?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",oe]}):W.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:W.map(re=>i.jsxs("li",{children:[i.jsx("strong",{children:re.name}),": ",re.price," / ",re.interval," ",re.period,re.interval>1?"s":"",re.description&&i.jsx("span",{className:"plan-description",children:re.description})]},re.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:d,onChange:re=>f(re.target.value)}),i.jsx(kr,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(pF,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:R,onChange:re=>z(re.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:de?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>Ce("name"),children:["Name",k==="name"&&(P==="asc"?i.jsx(w1,{size:14,className:"sort-icon"}):i.jsx(WN,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>Ce("created_at"),children:["Registered On",k==="created_at"&&(P==="asc"?i.jsx(w1,{size:14,className:"sort-icon"}):i.jsx(WN,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(re=>i.jsxs("tr",{children:[i.jsx("td",{children:re.token??"-"}),i.jsx("td",{className:"patient-name",children:re.name}),i.jsx("td",{children:re.age??"-"}),i.jsx("td",{children:re.gender??"-"}),i.jsx("td",{children:re.phone??"-"}),i.jsx("td",{children:re.address??"-"}),i.jsx("td",{children:te(re.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${re.subscription_status==="active"?"active":re.subscription_status==="cancelled"||re.subscription_status==="expired"?"inactive":"none"}`,children:re.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:re.insurance_type,onChange:Be=>J(re.id,Be.target.value),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>e(`/start-subscription/${re.id}`),className:"action-button",children:"Start Sub"})})]},re.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(u-1)*B0+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(u*B0,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>h(re=>Math.max(re-1,1)),disabled:u===1||r,className:"pagination-button",children:[i.jsx(Ib,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:u})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>h(re=>Math.min(re+1,g)),disabled:u===g||r,className:"pagination-button",children:["Next",i.jsx(Qh,{size:16,className:"next-icon"})]})]})]})]}),$&&B&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",B.name]}),i.jsx("button",{onClick:K,className:"subscription-modal-close-button",children:i.jsx(_n,{size:24})})]}),Y&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:Y})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:F,onChange:re=>V(re.target.value),className:"form-select",disabled:ee||ne||oe!==null||W.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),ne?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):oe?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):W.length>0?W.map(re=>i.jsxs("option",{value:re.id,children:[re.name," - ",re.price," (",re.interval," ",re.period,re.interval>1?"s":"",")"]},re.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),oe&&i.jsx("p",{className:"error-message",children:oe}),W.length===0&&!ne&&!oe&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:K,disabled:ee,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:He,disabled:!F||ee,className:"subscription-modal-button submit",children:ee?"Starting...":"Start Subscription"})]})]})})]})},CE=()=>{const e=Rt(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,o]=w.useState([]),[l,d]=w.useState(!1),[f,u]=w.useState(null),[h,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>yg(async P=>{if(P.trim().length<2){o([]),d(!1),u(null);return}d(!0),u(null);try{const M=new URLSearchParams({search:encodeURIComponent(P),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),R=await ge(`/api/patients?${M.toString()}`);if(!R.ok){const $=await R.text();throw new Error(`API Error (${R.status}): ${$||R.statusText}`)}const z=await R.json();o(z.patients)}catch(M){console.error("Error searching patients:",M),u(M.message||"Failed to search patients."),o([])}finally{d(!1)}},300),[]),S=P=>{const M=P.target.value;r(M),g(b.test(M)),d(!0),v(M)},k=w.useCallback(P=>{e("/billing",{state:{patientId:P.id,patientName:P.name}})},[e]),T=w.useCallback(async()=>{if(!t||!h){u("Invalid phone number to create a new patient.");return}d(!0),u(null);try{const M=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!M.ok){const z=await M.json();throw new Error(z.message||`Failed to create patient: ${M.statusText}`)}const R=await M.json();alert(`New patient "direct pharmacy" created with phone ${R.phone}.`),k(R)}catch(P){console.error("Error creating new patient:",P),u(P.message||"Failed to create new patient.")}finally{d(!1)}},[t,h,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(sn,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),f&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:f}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(P=>i.jsxs("li",{onClick:()=>k({id:P.id,name:P.name,token:P.token,age:P.age,gender:P.gender,phone:P.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",P.token]}),P.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[P.age?`${P.age} yrs`:"Age N/A",P.gender?` / ${P.gender}`:" / Gender N/A",P.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",P.phone]})]})]}),P.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",P.phone]})]},P.id))})}),t.length>=2&&!l&&a.length===0&&!f&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),h&&i.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},_E=({currentUser:e})=>{const n=Rt(),[t,r]=w.useState("select_patient"),[a,o]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,d]=w.useState(null),[f,u]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[T,P]=w.useState(""),[M,R]=w.useState([]),[z,$]=w.useState(!1),[L,B]=w.useState(null),[q,W]=w.useState(null),[I,F]=w.useState(null),[V,ee]=w.useState(!1),[ie,Y]=w.useState(!1),[Q,ne]=w.useState(!1),le=/^\+?[0-9\s\-().]{7,20}$/,oe=/^[a-zA-Z\s'-]{2,}$/,E=w.useCallback(async()=>{if(!(f.length>0)){ee(!0),F(null);try{const re=await ge("/api/lab-tests");if(!re.ok)throw new Error("Failed to fetch lab tests");const Be=await re.json();u(Be)}catch(re){console.error("Failed to fetch available lab tests:",re),F("Could not load lab test list: "+re.message),u([])}finally{ee(!1)}}},[f.length]);w.useEffect(()=>{if(!b){k([]);return}const re=b.toLowerCase();k(f.filter(Be=>Be.name.toLowerCase().includes(re)||Be.description&&Be.description.toLowerCase().includes(re)).slice(0,10))},[b,f]);const de=w.useCallback(re=>{const Be={id:re.id,name:re.name,token:re.token,age:re.age,gender:re.gender,phone:re.phone};d(Be),r("create_order"),g([]),v(""),k([]),F(null),E()},[E]),he=w.useMemo(()=>yg(async re=>{if(re.trim().length<2){R([]),$(!1),B(null);return}$(!0),B(null);try{const Be=new URLSearchParams({search:encodeURIComponent(re),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Ae=await ge(`/api/patients?${Be.toString()}`);if(!Ae.ok){const Ye=await Ae.text();throw new Error(`API Error (${Ae.status}): ${Ye||Ae.statusText}`)}const Ie=await Ae.json();R(Ie.patients)}catch(Be){console.error("Error searching lab patients:",Be),B(Be.message||"Failed to search lab patients."),R([])}finally{$(!1)}},300),[le,oe]),D=re=>{const Be=re.target.value;P(Be),Y(le.test(Be)),ne(oe.test(Be)&&!le.test(Be)),$(!0),he(Be)},me=w.useCallback(async re=>{if(!T||re==="phone"&&!ie||re==="name"&&!Q){B(`Invalid ${re} to create a new patient.`);return}$(!0),B(null);try{const Ae=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:re==="name"?T:"direct lab",phone:re==="phone"?T:null,age:null,gender:null,token:null})});if(!Ae.ok){const Ye=await Ae.json();throw new Error(Ye.message||`Failed to create patient: ${Ae.statusText}`)}const Ie=await Ae.json();alert(`New patient "${Ie.name}" created with ${re==="phone"?`phone ${Ie.phone}`:`name ${Ie.name}`}.`),de({id:Ie.id,name:Ie.name,token:Ie.token??null,age:Ie.age??null,gender:Ie.gender??null,phone:Ie.phone})}catch(Be){console.error("Error creating new patient:",Be),B(Be.message||"Failed to create new patient.")}finally{$(!1)}},[T,ie,Q,de]),Ce=()=>{r("select_patient"),d(null),P(""),R([]),B(null)},te=re=>{const{name:Be,value:Ae}=re.target;o(Ie=>({...Ie,[Be]:Be==="age"?Ae?parseInt(Ae,10):void 0:Ae}))},K=async re=>{if(re.preventDefault(),W(null),!a.name){W("Patient Name is required.");return}const Be={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const Ae=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)});if(!Ae.ok){const Ye=await Ae.json();throw new Error(Ye.message||`Failed to create patient: ${Ae.statusText}`)}const Ie=await Ae.json();alert(`Patient "${Ie.name}" created successfully!`),de({id:Ie.id,name:Ie.name,token:Ie.token??null,age:Ie.age??null,gender:Ie.gender??null,phone:Ie.phone})}catch(Ae){console.error("Failed to create patient:",Ae),W(Ae.message||"Failed to create patient. Please try again.")}},J=re=>{if(h.some(Be=>Be.id===re.id)){F(`${re.name} is already in the order.`),setTimeout(()=>F(null),3e3),v(""),k([]);return}g(Be=>[...Be,{...re}]),v(""),k([])},xe=re=>{g(Be=>Be.filter(Ae=>Ae.id!==re))},He=async re=>{if(re.preventDefault(),F(null),!l){F("No patient selected.");return}if(h.length===0){F("No lab tests selected.");return}const Be={patient_id:l.id,tests:h.map(Ae=>({id:Ae.id,name:Ae.name,price:Ae.price}))};console.log("Submitting Lab Order:",Be);try{const Ae=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)});if(!Ae.ok){const at=await Ae.json();throw console.error("API Error Data:",at),new Error(at.message||`Failed to create lab order: ${Ae.statusText}`)}const Ie=await Ae.json();console.log("Lab Order Creation Result:",Ie);let Ye=l.queueId;if(!Ye){const at=await ge(`/api/queue/patient/${l.id}/latest`);if(at.ok){const Ze=await at.json();Ze!=null&&Ze._id&&(Ye=Ze._id)}}if(!Ye){const at=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!at.ok){const Ke=await at.text();throw new Error(`Failed to create queue entry for redirection: ${Ke||at.statusText}`)}const Ze=await at.json();if(Ze!=null&&Ze.id)Ye=Ze.id;else throw new Error("Failed to get ID from new queue entry for redirection.")}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${Ye}`)}catch(Ae){console.error("Failed to create lab order:",Ae),F(Ae.message||"Failed to create lab order.")}};return w.useEffect(()=>{E()},[E]),i.jsxs("div",{className:"create-lab-order-container",children:[i.jsxs("div",{className:"create-lab-order-header",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:[i.jsx(sn,{size:20,style:{marginRight:"8px"}}),"Back"]}),i.jsx("h1",{className:"create-lab-order-title",children:"Create New Lab Order"}),i.jsx("div",{style:{width:"64px"}})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"glass-card",children:[t==="select_patient"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"header-with-action",children:i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Select Patient"})}),i.jsxs("div",{className:"search-container",children:[i.jsx(kr,{className:"search-icon",size:20}),i.jsx("input",{type:"text",id:"lab-patient-search",placeholder:"Search by Name, Token No, or Phone No...",value:T,onChange:D,className:"modern-input",autoFocus:!0,autoComplete:"off"}),z&&i.jsx("span",{className:"loading-text",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)",fontSize:"0.8rem"},children:"Searching..."})]}),L&&i.jsxs("div",{className:"error-message",children:[i.jsx(jr,{size:18}),L]}),M.length>0&&i.jsx("ul",{className:"patient-list",children:M.map(re=>i.jsxs("li",{onClick:()=>de(re),className:"patient-list-item",children:[i.jsxs("div",{className:"patient-info",children:[i.jsx("strong",{children:re.name}),i.jsxs("span",{className:"token-badge",children:["#",re.token||"N/A"]})]}),i.jsxs("div",{className:"patient-details",children:[re.age?`${re.age} yrs`:"",re.gender?` / ${re.gender}`:"",re.phone?`  ${re.phone}`:""]})]},re.id))}),T.length>=2&&!z&&M.length===0&&!L&&i.jsxs("div",{style:{textAlign:"center",marginTop:"20px"},children:[i.jsxs("p",{className:"no-data-message",style:{background:"none",border:"none",padding:0},children:['No patients found matching "',T,'".']}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"15px",marginTop:"15px"},children:[ie&&i.jsxs("button",{type:"button",onClick:()=>me("phone"),className:"secondary-button",children:['Create "Direct Lab" Patient (Phone: ',T,")"]}),Q&&i.jsxs("button",{type:"button",onClick:()=>me("name"),className:"secondary-button",children:["Create Patient (Name: ",T,")"]})]})]}),T.length<2&&!z&&i.jsx("div",{className:"info-message",children:"Start typing to search for a patient..."})]}),t==="create_patient"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"New Patient Registration"}),i.jsx("button",{onClick:Ce,className:"text-button",children:" Back to Search "})]}),q&&i.jsxs("div",{className:"error-message",children:[i.jsx(jr,{size:18}),q]}),i.jsxs("form",{onSubmit:K,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-name",className:"form-label",children:"Patient Name *"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Ns,{className:"search-icon",size:18}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:te,className:"modern-input",placeholder:"Enter full name"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:te,className:"modern-input",style:{paddingLeft:"16px"},placeholder:"e.g. 30"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:te,className:"modern-input",style:{paddingLeft:"16px"},children:[i.jsx("option",{value:"",children:"Select Gender..."}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-phone",className:"form-label",children:"Phone Number"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Bk,{className:"search-icon",size:18}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:te,className:"modern-input",placeholder:"e.g. 9876543210"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-address",className:"form-label",children:"Address"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(zk,{className:"search-icon",size:18,style:{top:"20px"}}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:te,className:"modern-input",style:{resize:"none"},placeholder:"Enter address (optional)"})]})]})]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:Ce,className:"secondary-button",children:" Cancel "}),i.jsxs("button",{type:"submit",className:"primary-button",children:[i.jsx(al,{size:18}),"Create & Proceed"]})]})]})]})]}),t==="create_order"&&l&&i.jsxs("div",{className:"glass-card",children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Create Lab Order"}),i.jsx("button",{onClick:Ce,className:"text-button",children:" Change Patient "})]}),i.jsxs("div",{className:"patient-summary",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(Ns,{size:20,className:"highlight-primary"}),i.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"600"},children:l.name})]}),i.jsxs("div",{className:"patient-details",style:{marginLeft:"30px",marginTop:"4px"},children:[l.age?`${l.age} yrs`:"Age N/A",l.gender&&`  ${l.gender}`,l.phone&&`  ${l.phone}`]})]}),I&&i.jsxs("div",{className:"error-message",children:[i.jsx(jr,{size:18}),I]}),i.jsxs("form",{onSubmit:He,children:[i.jsxs("div",{className:"form-group",style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",className:"form-label",children:"Add Lab Test"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(kr,{className:"search-icon",size:18}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search tests (e.g. CBC, Lipid Profile)...",value:b,onChange:re=>v(re.target.value),className:"modern-input",disabled:V,autoComplete:"off"}),V&&i.jsx("div",{className:"loading-spinner-small",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)"}})]}),b&&S.length>0&&i.jsx("div",{className:"search-results-dropdown",children:S.map(re=>i.jsxs("div",{onClick:()=>J(re),className:"search-result-item",children:[i.jsx("span",{style:{fontWeight:500},children:re.name}),i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(re.price).toFixed(2)]})]},re.id))}),b&&S.length===0&&!V&&i.jsxs("div",{className:"no-data-message",style:{marginTop:"5px",padding:"10px",fontSize:"0.9rem"},children:['No tests found matching "',b,'".']})]}),i.jsxs("div",{style:{marginTop:"30px"},children:[i.jsxs("h4",{className:"card-title",style:{fontSize:"1.1rem"},children:["Selected Tests (",h.length,")"]}),h.length===0?i.jsx("div",{className:"info-message",children:"No tests added yet. Search above to add tests."}):i.jsx("div",{className:"selected-tests-list",children:h.map(re=>i.jsxs("div",{className:"selected-test-item",children:[i.jsx("div",{style:{flex:1},children:i.jsx("div",{style:{fontWeight:500},children:re.name})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(re.price).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>xe(re.id),className:"remove-button",title:"Remove Test",children:i.jsx(Hr,{size:18})})]})]},re.id))})]}),h.length>0&&i.jsxs("div",{className:"total-price",children:["Total: ",h.reduce((re,Be)=>re+parseFloat(Be.price),0).toFixed(2)]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:Ce,className:"secondary-button",children:" Cancel Order "}),i.jsxs("button",{type:"submit",disabled:h.length===0,className:"primary-button",children:[i.jsx(C1,{size:18}),"Create Lab Order"]})]})]})]})]})},JW=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[o,l]=w.useState([]),[d,f]=w.useState(!0),[u,h]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(null),P=Rt(),M=Gr(),R=async()=>{f(!0),T(null);let I=[];try{const F=await ge("/api/queue");if(!F.ok){const ie=await F.json();throw new Error(ie.message||"Failed to fetch queue")}I=await F.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(I,null,2));const V=I.map(async ie=>{if(!ie.patient_id)return console.warn(`Queue entry ${ie.id} has no patient_id.`),ie;try{const Y=await ge(`/api/patients/${ie.patient_id}`);if(!Y.ok)return console.error(`Failed to fetch patient details for ${ie.patient_id}: ${Y.status}`),ie;const Q=await Y.json();return{...ie,Patient:{...ie.Patient??{},...Q}}}catch(Y){return console.error(`Error fetching patient details for ${ie.patient_id}:`,Y),ie}}),ee=await Promise.all(V);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(ee,null,2)),ee.sort((ie,Y)=>{var E,de;const Q=((E=ie.Patient)==null?void 0:E.subscription_status)==="active",ne=((de=Y.Patient)==null?void 0:de.subscription_status)==="active";if(Q&&!ne)return-1;if(!Q&&ne)return 1;const le=ie.created_at?new Date(ie.created_at).getTime():0,oe=Y.created_at?new Date(Y.created_at).getTime():0;return le-oe}),console.log("Sorted Queue Data:",JSON.stringify(ee,null,2)),l(ee)}catch(F){console.error("Error in fetchQueue process:",F),T(`Failed to load queue: ${F.message}`),l(I)}finally{f(!1)}},z=async()=>{b(!0),T(null);try{const I=await ge("/api/staff?role=doctor");if(!I.ok){const V=await I.json();throw new Error(V.message||"Failed to fetch doctors")}const F=await I.json();h(F.filter(V=>V.active))}catch(I){console.error("Error fetching doctors:",I),T(`Failed to fetch doctors: ${I.message}`)}finally{b(!1)}};w.useEffect(()=>{const F=new URLSearchParams(M.search).get("tab");F&&B.find(ee=>ee.id===F)&&t(F)},[M.search]),w.useEffect(()=>{n==="queue"&&(R(),z()),S(null)},[n]);const $=w.useCallback(async(I,F)=>{if(console.log(`Attempting to assign doctor ${F} to queue ${I}`),T(null),S(null),!F){console.log("No doctor ID provided, skipping assignment.");return}const V=o.find(Y=>Y.id===I);if(!V){console.error(`Queue entry ${I} not found in local state.`),T("Queue entry not found.");return}if(V.doctor_id===F){console.log(`Queue ${I} already assigned to doctor ${F}. Skipping.`);return}const ee=async Y=>{if(!Y||!Y.id||!Y.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",Y);return}const Q=async()=>{try{const ne={status:"waiting",doctorId:F},le=await ge(`/api/queue/${I}/status`,{method:"PATCH",body:JSON.stringify(ne)}),oe=await le.json();if(!le.ok)throw new Error(oe.message||`HTTP error! status: ${le.status}`);const E=u.find(de=>de.id===F);return console.log(`Successfully assigned doctor ${E==null?void 0:E.name} to queue ${I}.`),l(de=>de.map(he=>he.id===I?{...he,doctor_id:F,status:oe.status||he.status,User:E?{name:E.name}:null,Patient:Y}:he)),!0}catch(ne){return console.error(`Error assigning doctor for queue ${I}:`,ne),T(`Failed to assign doctor: ${ne.message}`),!1}};Y.subscription_status==="active"?(console.log(`Patient ${Y.name} (ID: ${Y.id}) has active subscription. Assigning doctor directly.`),await Q()):(console.log(`Patient ${Y.name} (ID: ${Y.id}) does not have active subscription (Status: ${Y.subscription_status}). Assigning doctor and proceeding to billing.`),await Q()?(console.log(`Navigating to billing for patient ${Y.name} (ID: ${Y.id}), queue ID: ${I}, doctor ID: ${F}`),P("/billing",{state:{patientId:Y.id,queueId:I,patientName:Y.name,doctorId:F,billType:"consultation"}})):console.log(`Assignment failed for patient ${Y.name}, skipping navigation.`))},ie=V.Patient;if(ie&&ie.id&&ie.name)console.log("Patient details found in state. Proceeding with assignment."),await ee(ie);else{console.warn(`Patient details missing for queue entry ${I}. Fetching patient ${V.patient_id}...`);try{const Y=await ge(`/api/patients/${V.patient_id}`);if(!Y.ok){const ne=await Y.json().catch(()=>({}));throw new Error(ne.message||`Failed to fetch patient details (status ${Y.status})`)}const Q=await Y.json();console.log("Successfully fetched patient details:",Q),await ee(Q)}catch(Y){console.error(`Failed to fetch patient details for patient ID ${V.patient_id}:`,Y),T(`Failed to fetch required patient details: ${Y.message}`)}}},[u,o,P]),L=async(I,F)=>{T(null);const V=F==="consulting"?"start consultation":"complete visit";try{const ee=o.find(ne=>ne.id===I);if(!ee&&F==="consulting")throw new Error("Queue entry not found to start consultation.");let ie={status:F};if(F==="consulting"){if(!(ee!=null&&ee.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");ie.doctorId=ee.doctor_id}const Y=await ge(`/api/queue/${I}/status`,{method:"PATCH",body:JSON.stringify(ie)}),Q=await Y.json();if(!Y.ok)throw new Error(Q.message||`HTTP error! status: ${Y.status}`);l(ne=>ne.map(le=>le.id===I?{...le,status:F}:le))}catch(ee){console.error(`Error trying to ${V}:`,ee),T(`Failed to ${V}: ${ee.message}`)}},B=[{id:"queue",label:"Queue",icon:i.jsx(Jh,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(kr,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(T3,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(_F,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(S1,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(qa,{size:20})}],q=I=>{try{return new Date(I).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},W=o.filter(I=>{var F,V;return(V=(F=I.Patient)==null?void 0:F.name)==null?void 0:V.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",B.map(I=>i.jsxs("button",{className:`reception-tab-button ${n===I.id?"active":""}`,onClick:()=>t(I.id),children:[i.jsx("span",{children:I.icon}),I.label]},I.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:I=>a(I.target.value)}),i.jsx(kr,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(I=>I.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(I=>I.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(I=>I.status==="seen").length})," "]})]})]}),d?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):W.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:W.map(I=>{var F,V,ee,ie,Y,Q,ne,le,oe,E,de;return i.jsxs("tr",{onClick:()=>P(`/dashboard/edit-complaint/${I.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",I.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:((F=I.Patient)==null?void 0:F.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[(V=I.Patient)!=null&&V.age?`${I.Patient.age} yrs, `:"",((ee=I.Patient)==null?void 0:ee.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((ie=I.Patient)==null?void 0:ie.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:I.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((Y=I.Patient)==null?void 0:Y.subscription_status)==="active"?"status-active":((Q=I.Patient)==null?void 0:Q.subscription_status)==="cancelled"||((ne=I.Patient)==null?void 0:ne.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((le=I.Patient)==null?void 0:le.subscription_status)??"None"}),I.Patient&&I.Patient.id&&I.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:he=>{he.stopPropagation(),I.Patient&&P(`/start-subscription/${I.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:q(I.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===I.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:he=>he.stopPropagation(),children:i.jsxs("select",{value:"",onChange:he=>$(I.id,he.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(he=>i.jsx("option",{value:he.id,children:he.name},he.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:he=>he.stopPropagation(),children:[" ",I.status==="waiting"&&i.jsx(i.Fragment,{children:(oe=I.User)!=null&&oe.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:I.User.name}),i.jsx("button",{onClick:()=>L(I.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):u.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?i.jsxs("button",{onClick:()=>$(I.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):i.jsx("button",{onClick:()=>S(I.id),className:"action-button btn-assign",children:"Assign"})}),I.status==="consulting"&&i.jsxs(i.Fragment,{children:[((E=I.User)==null?void 0:E.name)&&i.jsx("span",{className:"doctor-name-display",children:I.User.name}),i.jsx("button",{onClick:()=>L(I.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),I.status==="seen"&&i.jsxs(i.Fragment,{children:[((de=I.User)==null?void 0:de.name)&&i.jsx("span",{className:"doctor-name-display",children:I.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),I.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},I.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(_E,{currentUser:e}),i.jsxs("button",{onClick:()=>P("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(kr,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(Hm,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(NE,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(J1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(CE,{})})]})})},jE=6048e5,KW=864e5,kE=6e4,TE=36e5,Q_=Symbol.for("constructDateFrom");function so(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&Q_ in e?e[Q_](n):e instanceof Date?new e.constructor(n):new Date(n)}function Li(e,n){return so(n||e,e)}function XW(e,n,t){const r=Li(e,t==null?void 0:t.in);if(isNaN(n))return so(e,NaN);const a=r.getDate(),o=so(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}let ZW={};function ev(){return ZW}function lg(e,n){var d,f,u,h;const t=ev(),r=(n==null?void 0:n.weekStartsOn)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??0,a=Li(e,n==null?void 0:n.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function wb(e,n){return lg(e,{...n,weekStartsOn:1})}function EE(e,n){const t=Li(e,n==null?void 0:n.in),r=t.getFullYear(),a=so(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=wb(a),l=so(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const d=wb(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function J_(e){const n=Li(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function eQ(e,...n){const t=so.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function K_(e,n){const t=Li(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function tQ(e,n,t){const[r,a]=eQ(t==null?void 0:t.in,e,n),o=K_(r),l=K_(a),d=+o-J_(o),f=+l-J_(l);return Math.round((d-f)/KW)}function nQ(e,n){const t=EE(e,n),r=so(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),wb(r)}function rQ(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function K1(e){return!(!rQ(e)&&typeof e!="number"||isNaN(+Li(e)))}function iQ(e,n){const t=Li(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const aQ={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},sQ=(e,n,t)=>{let r;const a=aQ[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function U0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const oQ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},lQ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},cQ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},uQ={date:U0({formats:oQ,defaultWidth:"full"}),time:U0({formats:lQ,defaultWidth:"full"}),dateTime:U0({formats:cQ,defaultWidth:"full"})},dQ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},fQ=(e,n,t,r)=>dQ[e];function Fm(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,d=t!=null&&t.width?String(t.width):l;a=e.formattingValues[d]||e.formattingValues[l]}else{const l=e.defaultWidth,d=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[d]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const hQ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},pQ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},mQ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},gQ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},yQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},xQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bQ=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},vQ={ordinalNumber:bQ,era:Fm({values:hQ,defaultWidth:"wide"}),quarter:Fm({values:pQ,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Fm({values:mQ,defaultWidth:"wide"}),day:Fm({values:gQ,defaultWidth:"wide"}),dayPeriod:Fm({values:yQ,defaultWidth:"wide",formattingValues:xQ,defaultFormattingWidth:"wide"})};function $m(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],d=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(d)?SQ(d,g=>g.test(l)):wQ(d,g=>g.test(l));let u;u=e.valueCallback?e.valueCallback(f):f,u=t.valueCallback?t.valueCallback(u):u;const h=n.slice(l.length);return{value:u,rest:h}}}function wQ(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function SQ(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function NQ(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const d=n.slice(a.length);return{value:l,rest:d}}}const CQ=/^(\d+)(th|st|nd|rd)?/i,_Q=/\d+/i,jQ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},kQ={any:[/^b/i,/^(a|c)/i]},TQ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},EQ={any:[/1/i,/2/i,/3/i,/4/i]},AQ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},PQ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},DQ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},IQ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},RQ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},MQ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},OQ={ordinalNumber:NQ({matchPattern:CQ,parsePattern:_Q,valueCallback:e=>parseInt(e,10)}),era:$m({matchPatterns:jQ,defaultMatchWidth:"wide",parsePatterns:kQ,defaultParseWidth:"any"}),quarter:$m({matchPatterns:TQ,defaultMatchWidth:"wide",parsePatterns:EQ,defaultParseWidth:"any",valueCallback:e=>e+1}),month:$m({matchPatterns:AQ,defaultMatchWidth:"wide",parsePatterns:PQ,defaultParseWidth:"any"}),day:$m({matchPatterns:DQ,defaultMatchWidth:"wide",parsePatterns:IQ,defaultParseWidth:"any"}),dayPeriod:$m({matchPatterns:RQ,defaultMatchWidth:"any",parsePatterns:MQ,defaultParseWidth:"any"})},LQ={code:"en-US",formatDistance:sQ,formatLong:uQ,formatRelative:fQ,localize:vQ,match:OQ,options:{weekStartsOn:0,firstWeekContainsDate:1}};function FQ(e,n){const t=Li(e,n==null?void 0:n.in);return tQ(t,iQ(t))+1}function $Q(e,n){const t=Li(e,n==null?void 0:n.in),r=+wb(t)-+nQ(t);return Math.round(r/jE)+1}function AE(e,n){var h,g,b,v;const t=Li(e,n==null?void 0:n.in),r=t.getFullYear(),a=ev(),o=(n==null?void 0:n.firstWeekContainsDate)??((g=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=so((n==null?void 0:n.in)||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const d=lg(l,n),f=so((n==null?void 0:n.in)||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const u=lg(f,n);return+t>=+d?r+1:+t>=+u?r:r-1}function zQ(e,n){var d,f,u,h;const t=ev(),r=(n==null?void 0:n.firstWeekContainsDate)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,a=AE(e,n),o=so((n==null?void 0:n.in)||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),lg(o,n)}function BQ(e,n){const t=Li(e,n==null?void 0:n.in),r=+lg(t,n)-+zQ(t,n);return Math.round(r/jE)+1}function Wn(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const au={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Wn(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Wn(t+1,2)},d(e,n){return Wn(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Wn(e.getHours()%12||12,n.length)},H(e,n){return Wn(e.getHours(),n.length)},m(e,n){return Wn(e.getMinutes(),n.length)},s(e,n){return Wn(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Wn(a,n.length)}},_h={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},X_={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return au.y(e,n)},Y:function(e,n,t,r){const a=AE(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Wn(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Wn(o,n.length)},R:function(e,n){const t=EE(e);return Wn(t,n.length)},u:function(e,n){const t=e.getFullYear();return Wn(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Wn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Wn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return au.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Wn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=BQ(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Wn(a,n.length)},I:function(e,n,t){const r=$Q(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Wn(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):au.d(e,n)},D:function(e,n,t){const r=FQ(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Wn(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Wn(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Wn(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Wn(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=_h.noon:r===0?a=_h.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=_h.evening:r>=12?a=_h.afternoon:r>=4?a=_h.morning:a=_h.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return au.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):au.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Wn(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Wn(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):au.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):au.s(e,n)},S:function(e,n){return au.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return ej(r);case"XXXX":case"XX":return Ld(r);case"XXXXX":case"XXX":default:return Ld(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return ej(r);case"xxxx":case"xx":return Ld(r);case"xxxxx":case"xxx":default:return Ld(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Z_(r,":");case"OOOO":default:return"GMT"+Ld(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Z_(r,":");case"zzzz":default:return"GMT"+Ld(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Wn(r,n.length)},T:function(e,n,t){return Wn(+e,n.length)}};function Z_(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+Wn(o,2)}function ej(e,n){return e%60===0?(e>0?"-":"+")+Wn(Math.abs(e)/60,2):Ld(e,n)}function Ld(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Wn(Math.trunc(r/60),2),o=Wn(r%60,2);return t+a+n+o}const tj=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},PE=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},UQ=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return tj(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",tj(r,n)).replace("{{time}}",PE(a,n))},qQ={p:PE,P:UQ},VQ=/^D+$/,HQ=/^Y+$/,GQ=["D","DD","YY","YYYY"];function YQ(e){return VQ.test(e)}function WQ(e){return HQ.test(e)}function QQ(e,n,t){const r=JQ(e,n,t);if(console.warn(r),GQ.includes(e))throw new RangeError(r)}function JQ(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const KQ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,XQ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ZQ=/^'([^]*?)'?$/,eJ=/''/g,tJ=/[a-zA-Z]/;function zd(e,n,t){var h,g,b,v;const r=ev(),a=r.locale??LQ,o=r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,l=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,d=Li(e,t==null?void 0:t.in);if(!K1(d))throw new RangeError("Invalid time value");let f=n.match(XQ).map(S=>{const k=S[0];if(k==="p"||k==="P"){const T=qQ[k];return T(S,a.formatLong)}return S}).join("").match(KQ).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:nJ(S)};if(X_[k])return{isToken:!0,value:S};if(k.match(tJ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(f=a.localize.preprocessor(d,f));const u={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(S=>{if(!S.isToken)return S.value;const k=S.value;(WQ(k)||YQ(k))&&QQ(k,n,String(e));const T=X_[k[0]];return T(d,k,a.localize,u)}).join("")}function nJ(e){const n=e.match(ZQ);return n?n[1].replace(eJ,"'"):e}function q0(e,n){return+Li(e)<+Li(n)}function nj(e,n){const t=()=>so(n==null?void 0:n.in,NaN),a=sJ(e);let o;if(a.date){const u=oJ(a.date,2);o=lJ(u.restDateString,u.year)}if(!o||isNaN(+o))return t();const l=+o;let d=0,f;if(a.time&&(d=cJ(a.time),isNaN(d)))return t();if(a.timezone){if(f=uJ(a.timezone),isNaN(f))return t()}else{const u=new Date(l+d),h=Li(0,n==null?void 0:n.in);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return Li(l+d+f,n==null?void 0:n.in)}const Rx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},rJ=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,iJ=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,aJ=/^([+-])(\d{2})(?::?(\d{2}))?$/;function sJ(e){const n={},t=e.split(Rx.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],Rx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(Rx.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=Rx.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function oJ(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function lJ(e,n){if(n===null)return new Date(NaN);const t=e.match(rJ);if(!t)return new Date(NaN);const r=!!t[4],a=zm(t[1]),o=zm(t[2])-1,l=zm(t[3]),d=zm(t[4]),f=zm(t[5])-1;if(r)return mJ(n,d,f)?dJ(n,d,f):new Date(NaN);{const u=new Date(0);return!hJ(n,o,l)||!pJ(n,a)?new Date(NaN):(u.setUTCFullYear(n,o,Math.max(a,l)),u)}}function zm(e){return e?parseInt(e):1}function cJ(e){const n=e.match(iJ);if(!n)return NaN;const t=V0(n[1]),r=V0(n[2]),a=V0(n[3]);return gJ(t,r,a)?t*TE+r*kE+a*1e3:NaN}function V0(e){return e&&parseFloat(e.replace(",","."))||0}function uJ(e){if(e==="Z")return 0;const n=e.match(aJ);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return yJ(r,a)?t*(r*TE+a*kE):NaN}function dJ(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const fJ=[31,null,31,30,31,30,31,31,30,31,30,31];function DE(e){return e%400===0||e%4===0&&e%100!==0}function hJ(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(fJ[n]||(DE(e)?29:28))}function pJ(e,n){return n>=1&&n<=(DE(e)?366:365)}function mJ(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function gJ(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function yJ(e,n){return n>=0&&n<=59}const oS=({isEmbedded:e=!1})=>{const[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(null),g=w.useRef(null),[b,v]=w.useState(!1),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,R]=w.useState(!1),[z,$]=w.useState(null),[L,B]=w.useState({name:"",description:"",price:"",default_parameters:[]}),q=w.useCallback(async()=>{a(!0),l(null),h(null),k(null);try{const D=await ge("/api/lab-tests");if(!D.ok)throw new Error(`HTTP error! status: ${D.status}`);const me=await D.json();t(me)}catch(D){console.error("Error fetching lab tests:",D),l(D.message||"Failed to fetch lab tests.")}finally{a(!1)}},[]);w.useEffect(()=>{q()},[q]);const W=D=>{const{name:me,value:Ce}=D.target;B(te=>({...te,[me]:Ce}))},I=(D,me,Ce)=>{const te=[...L.default_parameters],K=te[D];if(me==="type")switch(K.type=Ce,Ce){case"number":K.defaultValue=0,K.lower_limit=null,K.upper_limit=null,K.unit="";break;case"boolean":K.defaultValue=!1,K.lower_limit=void 0,K.upper_limit=void 0,K.unit=void 0;break;case"string":default:K.defaultValue="",K.lower_limit=void 0,K.upper_limit=void 0,K.unit=void 0;break}else me==="defaultValue"?K.type==="number"?K.defaultValue=parseFloat(Ce)||0:(K.type,K.defaultValue=Ce):me==="lower_limit"||me==="upper_limit"?K[me]=Ce===""?null:parseFloat(Ce):K[me]=Ce;B(J=>({...J,default_parameters:te}))},F=()=>{B(D=>({...D,default_parameters:[...D.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},V=D=>{B(me=>({...me,default_parameters:me.default_parameters.filter((Ce,te)=>te!==D)}))},ee=async D=>{D.preventDefault(),a(!0),l(null);const me=z!==null,Ce=me?`/api/lab-tests/${z}`:"/api/lab-tests",te=me?"PUT":"POST";try{const K=await ge(Ce,{method:te,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:L.name,description:L.description,price:parseFloat(L.price),default_parameters:L.default_parameters})});if(!K.ok){const J=await K.json();throw new Error(J.message||`HTTP error! status: ${K.status}`)}R(!1),$(null),B({name:"",description:"",price:"",default_parameters:[]}),q()}catch(K){console.error(`Error ${me?"updating":"adding"} lab test:`,K),l(K.message||`Failed to ${me?"update":"add"} lab test.`)}finally{a(!1)}},ie=()=>{$(null),B({name:"",description:"",price:"",default_parameters:[]}),R(!0)},Y=D=>{if(z===D.id)$(null);else{$(D.id);const me=(D.default_parameters||[]).map(Ce=>({...Ce,unit:Ce.unit||"",lower_limit:Ce.lower_limit===void 0?null:Ce.lower_limit,upper_limit:Ce.upper_limit===void 0?null:Ce.upper_limit}));B({name:D.name,description:D.description||"",price:D.price,default_parameters:me}),R(!1)}},Q=async D=>{if(window.confirm("Are you sure you want to delete this lab test?")){a(!0),l(null);try{const me=await ge(`/api/lab-tests/${D}`,{method:"DELETE"});if(!me.ok){const Ce=await me.json();throw new Error(Ce.message||`HTTP error! status: ${me.status}`)}q()}catch(me){console.error("Error deleting lab test:",me),l(me.message||"Failed to delete lab test.")}finally{a(!1)}}},ne=()=>{R(!1),$(null),l(null),B({name:"",description:"",price:"",default_parameters:[]})},le=async D=>{if(!D){h("No file selected.");return}f(!0),h(null),l(null);const me=new FormData;me.append("file",D);try{const Ce=await ge("/api/lab-tests/import",{method:"POST",body:me});if(!Ce.ok){const te=await Ce.json();throw new Error(te.message||`Import failed: ${Ce.statusText}`)}q()}catch(Ce){console.error("Error importing lab tests from Excel:",Ce),h(Ce.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},oe=async D=>{if(D.target.files&&D.target.files[0]){const me=D.target.files[0];await le(me),D.target&&(D.target.value="")}},E=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){v(!0),k(null),l(null);try{const D=await ge("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!D.ok){const me=await D.json();throw new Error(me.message||`Default import failed: ${D.statusText}`)}q()}catch(D){console.error("Error importing default lab tests:",D),k(D.message||"Failed to import default lab tests.")}finally{v(!1)}}},de=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){P(!0),l(null),h(null),k(null);try{const D=await ge("/api/lab-tests/all",{method:"DELETE"});if(!D.ok){const me=await D.json();throw new Error(me.message||`Delete all failed: ${D.statusText}`)}q()}catch(D){console.error("Error deleting all lab tests:",D),l(D.message||"Failed to delete all lab tests.")}finally{P(!1)}}},he=r||d||b||T;return i.jsxs("div",{className:`lab-inventory-card ${e?"embedded":""}`,style:e?{border:"none",boxShadow:"none",padding:0}:{},children:[!e&&i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:ie,className:"lab-inventory-button",disabled:he,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var D;return(D=g.current)==null?void 0:D.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:he,children:d?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:g,onChange:oe,accept:".xlsx, .xls",style:{display:"none"},disabled:d}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-secondary",disabled:he,children:b?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:de,className:"lab-inventory-button lab-inventory-button-danger",disabled:he,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:T?"Deleting All...":"Delete All Tests"})]}),o&&i.jsx("div",{className:"error-text mb-4",children:o}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),S&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",S]}),M&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:ee,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:W,className:"lab-inventory-input",required:!0,disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:W,rows:3,className:"lab-inventory-input",disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price,onChange:W,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),L.default_parameters.map((D,me)=>{var Ce,te;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:D.name,onChange:K=>I(me,"name",K.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:D.type,onChange:K=>I(me,"type",K.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),D.type==="boolean"?i.jsxs("select",{value:D.defaultValue.toString(),onChange:K=>I(me,"defaultValue",K.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:D.type==="number"?"number":"text",placeholder:"Default Value",value:D.defaultValue.toString(),onChange:K=>I(me,"defaultValue",K.target.value),className:"lab-inventory-input"}),D.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:D.lower_limit===null?"":((Ce=D.lower_limit)==null?void 0:Ce.toString())??"",onChange:K=>I(me,"lower_limit",K.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:D.upper_limit===null?"":((te=D.upper_limit)==null?void 0:te.toString())??"",onChange:K=>I(me,"upper_limit",K.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:D.unit||"",onChange:K=>I(me,"unit",K.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>V(me),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},me)}),i.jsx("button",{type:"button",onClick:F,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:ne,className:"lab-inventory-button lab-inventory-button-secondary",disabled:he,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:he,children:r?"Saving...":"Add Test"})]})]})]}),he&&!M&&i.jsxs("p",{className:"loading-text",children:[" ",d?"Importing Excel data...":b?"Importing default data...":"Loading tests..."]}),!he&&n.length===0&&!o&&!u&&!S&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!he&&n.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:n.map(D=>{const me=z===D.id,Ce=D.price&&typeof D.price=="string"?parseFloat(D.price):NaN,te=isNaN(Ce)?"0.00":Ce.toFixed(2);return i.jsxs(Tn.Fragment,{children:[i.jsxs("tr",{onClick:()=>Y(D),style:{cursor:"pointer"},children:[i.jsx("td",{children:D.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:D.description||"-"}),i.jsxs("td",{children:["",te]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:K=>{K.stopPropagation(),Y(D)},className:"lab-inventory-link",disabled:he,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:K=>{K.stopPropagation(),Q(D.id)},className:"lab-inventory-link",disabled:he,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),me&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:ee,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:W,className:"lab-inventory-input",required:!0,disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:W,rows:3,className:"lab-inventory-input",disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price,onChange:W,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:he})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),L.default_parameters.map((K,J)=>{var xe,He;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:K.name,onChange:re=>I(J,"name",re.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:K.type,onChange:re=>I(J,"type",re.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),K.type==="boolean"?i.jsxs("select",{value:K.defaultValue.toString(),onChange:re=>I(J,"defaultValue",re.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:K.type==="number"?"number":"text",placeholder:"Default Value",value:K.defaultValue.toString(),onChange:re=>I(J,"defaultValue",re.target.value),className:"lab-inventory-input"}),K.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:K.lower_limit===null?"":((xe=K.lower_limit)==null?void 0:xe.toString())??"",onChange:re=>I(J,"lower_limit",re.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:K.upper_limit===null?"":((He=K.upper_limit)==null?void 0:He.toString())??"",onChange:re=>I(J,"upper_limit",re.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:K.unit||"",onChange:re=>I(J,"unit",re.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>V(J),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},J)}),i.jsx("button",{type:"button",onClick:F,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:ne,className:"lab-inventory-button lab-inventory-button-secondary",disabled:he,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:he,children:r?"Saving...":"Update Test"})]})]})]})})})]},D.id)})})]})]})]})},xJ=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([o,l])=>{var h;const d=(h=r.default_parameters)==null?void 0:h.find(g=>g.name===o);let f=String(l),u="";if(d){const g=d.unit?` _${d.unit}_`:"";if(d.type==="boolean"){const b=l===!0||l==="true";f=b?"*Reactive*":"Non-Reactive",b||(u="`Normal: Non-Reactive`")}else if(d.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(d.lower_limit!=null||d.upper_limit!=null){let v=[];d.lower_limit!=null&&v.push(`${d.lower_limit}`),d.upper_limit!=null&&v.push(`${d.upper_limit}`),u=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(d.lower_limit!=null&&b<d.lower_limit||d.upper_limit!=null&&b>d.upper_limit)&&(f=`*${f}*`)}}d.unit&&(f+=g)}n+=`${o}: ${f}
`,u&&((d==null?void 0:d.type)==="boolean"&&(l===!0||l==="true")||(n+=`${u}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},lS=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=xJ(e),r=`Hello ${n},

Your lab report is ready.

${t}`,o=`https://wa.me/${bJ(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(o,"_blank")},bJ=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},vJ=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState("orders"),[h,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async(q=1,W="")=>{o(!0),d(null);try{const I=new URLSearchParams({page:String(q),limit:String(b)});W&&I.append("search",W);const F=await ge(`/api/lab?${I.toString()}`);if(!F.ok)throw new Error(`HTTP error! status: ${F.status}`);const V=await F.json(),ee=V.orders.map(ie=>{var Y,Q;return{id:ie.id,labTokenNumber:String(ie.lab_token_number??"N/A"),patientName:((Y=ie.Patient)==null?void 0:Y.name)||"N/A",patientId:ie.patient_id,patientTokenNumber:String(((Q=ie.Patient)==null?void 0:Q.patient_token_number)??"N/A"),tests:(ie.tests||[]).map(ne=>ne.name||"Unknown Test"),date:zd(new Date(ie.createdAt),"yyyy-MM-dd"),status:ie.status,reportId:ie.reportId,billId:ie.billId}});n(ee),S(V.totalCount),g(q)}catch(I){console.error("Failed to fetch lab orders:",I),d(I instanceof Error?I.message:"An unknown error occurred"),n([]),S(0)}finally{o(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${h}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(h,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,h,t]),w.useEffect(()=>{const q=setTimeout(()=>{t.length>=2?h!==1&&g(1):t.length<2&&h!==1&&g(1)},1e3);return()=>{clearTimeout(q)}},[t]);const P=async(q,W)=>{console.log(`Updating order ${q} to status ${W}`);try{const I=await ge(`/api/lab/${q}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:W})});if(!I.ok){const F=await I.json();throw new Error(F.message||`Failed to update status: ${I.status}`)}if(W==="completed"){const F=await ge(`/api/lab/orders/${q}/report`);if(F.ok){const V=await F.json();lS(V)}}await T(h,t),console.log(`Order ${q} status updated to ${W}, refetching page ${h}`)}catch(I){console.error("Error updating status:",I),alert(`Failed to update status: ${I instanceof Error?I.message:"Unknown error"}`)}},M=Rt(),R=q=>{if(!q){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}q.billId?(console.log(`Navigating to existing bill for Bill ID: ${q.billId}, Patient: ${q.patientName}`),M("/billing",{state:{billId:q.billId,patientId:q.patientId,patientName:q.patientName,billType:"lab"}})):(console.log(`Navigating to LabBillingPage for Order ID: ${q.id}`),M(`/dashboard/lab-billing/${q.id}`))},z=q=>{q&&q.id?M(`/lab/report/${q.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},$=q=>{switch(q){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:q,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(jr,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:l}),i.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const L=()=>{h>1&&g(q=>q-1)},B=()=>{h<k&&g(q=>q+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>M(-1),className:"back-button mr-4",children:i.jsx(sn,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>u("orders"),className:`lab-inventory-button ${f==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(Lk,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>M("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>u("inventory"),className:`lab-inventory-button ${f==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(j3,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),f==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:q=>r(q.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(kr,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map(q=>{const W=$(q.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:q.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",q.patientTokenNumber]})]}),i.jsx("td",{children:q.tests.map((I,F)=>i.jsx("div",{children:I},F))}),i.jsx("td",{className:"hidden md:table-cell",children:q.date}),i.jsx("td",{children:i.jsx("span",{className:W.className,children:W.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[q.status==="pending"&&i.jsx("button",{onClick:()=>R(q),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),q.status==="billed"&&i.jsx("button",{onClick:()=>P(q.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),q.status==="collected"&&i.jsx("button",{onClick:()=>P(q.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(q.status==="processing"||q.status==="report_ready"||q.status==="reported")&&i.jsx("button",{onClick:()=>z(q),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(q.status==="report_ready"||q.status==="reported")&&i.jsx("button",{onClick:()=>P(q.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(q.status==="completed"||q.status==="report_ready"||q.status==="reported")&&i.jsx("button",{onClick:()=>{q.id?M(`/lab/view-report/${q.id}`):(console.error("Attempted to view report for an order with no ID:",q),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},q.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map(q=>{const W=$(q.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:q.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",q.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:q.date})]}),i.jsx("span",{className:`${W.className} lab-card-status-pill`,children:W.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),q.tests.map((I,F)=>i.jsx("div",{className:"lab-card-test-item",children:I},F)),q.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[q.status==="pending"&&i.jsx("button",{onClick:()=>R(q),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),q.status==="billed"&&i.jsx("button",{onClick:()=>P(q.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),q.status==="collected"&&i.jsx("button",{onClick:()=>P(q.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(q.status==="processing"||q.status==="report_ready"||q.status==="reported")&&i.jsx("button",{onClick:()=>z(q),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(q.status==="report_ready"||q.status==="reported")&&i.jsx("button",{onClick:()=>P(q.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(q.status==="completed"||q.status==="report_ready"||q.status==="reported")&&i.jsx("button",{onClick:()=>{q.id?M(`/lab/view-report/${q.id}`):(console.error("Attempted to view report for an order with no ID:",q),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},q.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(h-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(h*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:L,disabled:h===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(Ib,{size:18})}),i.jsxs("span",{children:["Page ",h," of ",k]}),i.jsx("button",{onClick:B,disabled:h===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(Qh,{size:18})})]})]})]}),f==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(oS,{})]})]})]})},wJ=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=Rt(),u=w.useRef(null),[h,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),T=10,P=w.useCallback(async(B,q,W)=>{o(!0),d(null);try{let I=`/api/pharmacy-orders?page=${B}&limit=${q}`;W&&W.trim()!==""&&(I+=`&search=${encodeURIComponent(W.trim())}`);const F=await ge(I);if(!F.ok)throw new Error(`Failed to fetch orders: ${F.statusText} (${F.status})`);const V=await F.json();if(V&&Array.isArray(V.orders)&&typeof V.totalOrders=="number"&&typeof V.totalPages=="number")console.log("Fetched pharmacy orders data:",V.orders),n(V.orders),k(V.totalOrders),v(V.totalPages),g(V.currentPage||B);else throw console.error("Received data does not match expected paginated structure:",V),new Error("Invalid data format received from API")}catch(I){console.error("Failed to fetch pharmacy orders:",I),d(I.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{o(!1)}},[]);w.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const B=t===""?h:1;t!==""&&h!==1&&g(1),P(B,T,t)},500),()=>{u.current&&clearTimeout(u.current)}),[t,h,P,T]);const M=B=>{f(`/dashboard/edit-pharmacy-order/${B}`)},R=B=>{d(null),console.log(`Preparing billing navigation for order: ${B}`);const q=e.find(W=>W.id===B);if(q){const W=q.medications.map(I=>{const F=I.price??0;return(I.price===void 0||I.price===null)&&console.warn(`Medication "${I.name}" in order ${B} is missing a price. Defaulting to 0.`),{name:I.name,pack_quantity:I.pack_quantity,loose_quantity:I.loose_quantity,price:F,pack_price:I.pack_price,loose_price:I.loose_price,total_price:I.total_price,isLoose:I.isLoose,unit:I.unit,drug_id:I.drug_id?String(I.drug_id):null,tabletsPerDay:I.tabletsPerDay,numberOfDays:I.numberOfDays,directions_to_use:I.directions_to_use,discount_percentage:0,batch:I.batch,expiry_date:I.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:W}),f(`/dashboard/pharmacy-billing/${B}`,{state:{initialItems:W}})}else console.error(`Order with ID ${B} not found.`),d(`Order with ID ${B} not found.`),alert(`Error: Could not find order ${B} to bill.`)},z=async(B,q)=>{d(null);const W=e.find(F=>F.id===B);if(!W){d(`Order with ID ${B} not found.`);return}const I={status:q,medications:W.medications};try{const F=await ge(`/api/pharmacy-orders/${B}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!F.ok){const ee=await F.text();throw new Error(`Failed to update status: ${F.statusText} (${F.status}) - ${ee}`)}const V=await F.json();n(ee=>ee.map(ie=>ie.id===V.id?{...ie,status:V.status}:ie))}catch(F){console.error("Failed to update order status:",F),d(F.message||`Failed to update status for order ${B}.`),alert(`Error updating status for order ${B}: ${F.message||"Please try again."}`)}},$=B=>{switch(B){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},L=B=>{f(`/dashboard/orders/${B.id}`)};return a&&e.length===0&&!l?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>f("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(qa,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>f("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx(Bd,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>f("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(Mk,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>f("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx(Bd,{size:16}),"Distributors"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:B=>r(B.target.value),className:"pharmacy-search-input"}),i.jsx(kr,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"})," ",i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(B=>i.jsxs("tr",{onClick:()=>L(B),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:B.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:B.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[B.medications.map((q,W)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[q.name," (Packs: ",q.pack_quantity,", Loose: ",q.loose_quantity,", ",q.tabletsPerDay??"N/A","x",q.numberOfDays??"N/A","d)",q.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",q.box_number,")"]})]}),q.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",q.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[q.pack_price!==void 0&&`Pack Price: ${Number(q.pack_price).toFixed(2)}`,q.loose_price!==void 0&&` | Loose Price: ${Number(q.loose_price).toFixed(2)}`,q.total_price!==void 0&&` | Item Total: ${Number(q.total_price).toFixed(2)}`]})]},W)),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(B.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(B.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:$(B.status),children:B.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:q=>{q.stopPropagation(),M(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(sl,{size:14})," Edit"]}),i.jsxs("button",{onClick:q=>{q.stopPropagation(),R(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Bh,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:q=>{q.stopPropagation(),z(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Wa,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:q=>{q.stopPropagation(),z(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:q=>{q.stopPropagation(),L(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},B.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(B=>{const q=$(B.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>L(B),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:B.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:["Token: ",B.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(B.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:q,children:B.status}),B.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(B.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[B.medications.slice(0,2).map((W,I)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${W.name} (Packs: ${W.pack_quantity}, Loose: ${W.loose_quantity}, ${W.tabletsPerDay??"N/A"}x${W.numberOfDays??"N/A"}d)`,children:[W.name," (Packs: ",W.pack_quantity,", Loose: ",W.loose_quantity,", ",W.tabletsPerDay??"N/A","x",W.numberOfDays??"N/A","d)",W.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",W.box_number,")"]})]}),W.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${W.directions_to_use}`,children:["Directions: ",W.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[W.pack_price!==void 0&&`Pack Price: ${Number(W.pack_price).toFixed(2)}`,W.loose_price!==void 0&&` | Loose Price: ${Number(W.loose_price).toFixed(2)}`,W.total_price!==void 0&&` | Item Total: ${Number(W.total_price).toFixed(2)}`]})]},I)),B.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",B.medications.length-2," more"]}),B.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:W=>{W.stopPropagation(),M(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(sl,{size:14})," Edit"]}),i.jsxs("button",{onClick:W=>{W.stopPropagation(),R(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Bh,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:W=>{W.stopPropagation(),z(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Wa,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:W=>{W.stopPropagation(),z(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:W=>{W.stopPropagation(),L(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},B.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(h-1)*T+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(h*T,S)})," ","of ",i.jsx("span",{className:"font-medium",children:S})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(Ib,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",h," of ",b]}),i.jsxs("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(Qh,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},rj=10,SJ=3,IE=({isEmbedded:e=!1})=>{const n=Rt(),[t,r]=w.useState([]),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(new Set),[S,k]=w.useState("all"),T=async()=>{try{const we=await ge("/api/inventory/download-csv");if(!we.ok)throw new Error(`Failed to download CSV: ${we.statusText}`);const ye=await we.blob(),Oe=window.URL.createObjectURL(ye),De=document.createElement("a");De.href=Oe,De.download="pharmacy_inventory.csv",document.body.appendChild(De),De.click(),De.remove(),window.URL.revokeObjectURL(Oe)}catch(we){console.error("Failed to download CSV:",we),g(we.message||"Failed to download inventory CSV. Please try again.")}},[P,M]=w.useState(!1),[R,z]=w.useState(!1),[$,L]=w.useState(null),[B,q]=w.useState(!1),[W,I]=w.useState(new Set),[F,V]=w.useState(1),ee=8,[ie,Y]=w.useState(null),[Q,ne]=w.useState(0),[le,oe]=w.useState(!1),[E,de]=w.useState(null),[he,D]=w.useState(1),[me,Ce]=w.useState(!1),te=F*ee,K=te-ee,J=a.slice(K,te),xe=Math.ceil(a.length/ee);w.useEffect(()=>{V(1)},[l,S]);const He=w.useCallback(async()=>{u(!0),g(null);try{const we=await ge("/api/drugs");if(!we.ok)throw new Error(`Failed to fetch drugs: ${we.statusText} (${we.status})`);const ye=await we.json();let Oe=Array.isArray(ye)?ye:ye.drugs||[];Oe=Oe.map(De=>({...De,mrp:parseFloat(String(De.mrp))||0,rate:De.rate!==null&&De.rate!==void 0?parseFloat(String(De.rate)):null,stock:parseInt(String(De.stock),10)||0,gst:De.gst!==null&&De.gst!==void 0?parseFloat(String(De.gst)):null,margin:De.margin!==null&&De.margin!==void 0?parseFloat(String(De.margin)):null,discount:De.discount!==null&&De.discount!==void 0?parseFloat(String(De.discount)):null})),r(Oe),o(Oe)}catch(we){console.error("Failed to fetch drugs:",we),g(we.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{He()},[He]),w.useEffect(()=>{const we=l.toLowerCase();let ye=t.filter(Ve=>{var wn,Tt,Ct,Yt,It;const ot=((wn=Ve.name)==null?void 0:wn.toLowerCase())||"",mt=((Tt=Ve.description)==null?void 0:Tt.toLowerCase())||"",Nt=((Ct=Ve.supplier)==null?void 0:Ct.toLowerCase())||"",cn=((Yt=Ve.box_number)==null?void 0:Yt.toLowerCase())||"",fn=((It=Ve.brand_name)==null?void 0:It.toLowerCase())||"";return ot.includes(we)||mt.includes(we)||Nt.includes(we)||cn.includes(we)||fn.includes(we)});const Oe=new Date,De=XW(Oe,SJ);S==="low-stock"?ye=ye.filter(Ve=>Ve.stock<=rj):S==="near-expiry"?ye=ye.filter(Ve=>{if(!Ve.expiry_date)return!1;const ot=nj(Ve.expiry_date);return K1(ot)&&q0(ot,De)&&!q0(ot,Oe)}):S==="expired"&&(ye=ye.filter(Ve=>{if(!Ve.expiry_date)return!1;const ot=nj(Ve.expiry_date);return K1(ot)&&q0(ot,Oe)})),o(ye)},[l,t,S]);const re=()=>{M(!1),Y(null)},Be=we=>{ne(parseInt(we.target.value,10)||0)},Ae=async we=>{if(we.preventDefault(),g(null),!ie||!ie.id||Q===0){g("No drug selected or adjustment amount is zero.");return}try{const ye=await ge(`/api/drugs/${ie.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:Q})});if(!ye.ok){const De=await ye.json();throw new Error(De.message||`Failed to adjust stock: ${ye.statusText}`)}const Oe=await ye.json();r(De=>De.map(Ve=>Ve.id===Oe.id?Oe:Ve)),re(),alert(`Stock for "${Oe.name}" adjusted successfully. New stock: ${Oe.stock}`)}catch(ye){console.error("Failed to adjust stock:",ye),g(ye.message||"Failed to adjust stock. Please try again.")}},Ie=we=>{L(we),z(!0)},Ye=()=>{z(!1),L(null)},at=async()=>{if(!$||!$.id){g("No drug selected for deletion.");return}u(!0),g(null);try{const we=await ge(`/api/drugs/${$.id}`,{method:"DELETE"});if(!we.ok){const ye=await we.json();throw new Error(ye.message||`Failed to delete drug: ${we.statusText}`)}alert(`Drug "${$.name}" deleted successfully.`),He(),Ye()}catch(we){console.error("Failed to delete drug:",we),g(we.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},Ze=()=>{q(!0)},Ke=()=>{q(!1)},[st,yt]=w.useState(!1),je=()=>{W.size>0&&yt(!0)},Ge=()=>{yt(!1)},_e=async()=>{if(W.size===0){g("No drugs selected for deletion.");return}u(!0),g(null);try{const we=await ge("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(W)})});if(!we.ok){const ye=await we.json();throw new Error(ye.message||`Failed to delete selected drugs: ${we.statusText}`)}alert(`${W.size} drug(s) deleted successfully.`),He(),I(new Set),Ge()}catch(we){console.error("Failed to delete selected drugs:",we),g(we.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},pe=async()=>{u(!0),g(null);try{const we=await ge("/api/drugs/all",{method:"DELETE"});if(!we.ok){const ye=await we.json();throw new Error(ye.message||`Failed to delete all drugs: ${we.statusText}`)}alert("All drugs deleted successfully."),He(),Ke()}catch(we){console.error("Failed to delete all drugs:",we),g(we.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},ce=we=>{if(!we)return null;const ye=we.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return ye?parseInt(ye[1],10):null},G=we=>{de(we),D(1),oe(!0)},fe=()=>{oe(!1),de(null),D(1)},Ne=we=>{D(parseInt(we.target.value,10)||0)},Le=async we=>{if(we.preventDefault(),g(null),!E||!E.id||he<=0){g("No drug selected or invalid number of packs to convert.");return}const ye=ce(E.pack);if(!ye||ye<=0){g(`Cannot convert "${E.name}" to loose. Invalid pack unit: ${E.pack||"N/A"}.`);return}if(he>(E.stock??0)){g(`Cannot convert ${he} packs. Only ${E.stock??0} packs are in stock.`);return}try{const Oe=await ge(`/api/drugs/${E.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:he,packSize:ye})});if(!Oe.ok){const Ve=await Oe.json();throw new Error(Ve.message||`Failed to convert to loose: ${Oe.statusText}`)}const De=await Oe.json();r(Ve=>Ve.map(ot=>ot.id===De.id?De:ot)),fe(),alert(`Converted ${he} pack(s) of "${De.name}" to loose. New stock: ${De.stock} packs, ${De.loose??0} loose units.`)}catch(Oe){console.error("Failed to convert to loose:",Oe),g(Oe.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},tt=()=>{Ce(!0)},xt=()=>{Ce(!1)},St=async()=>{u(!0),g(null);try{const we=await ge("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!we.ok){const ye=await we.json();throw new Error(ye.message||`Failed to add default medications: ${we.statusText}`)}alert("Default medications added successfully."),He(),xt()}catch(we){console.error("Failed to add default medications:",we),g(we.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):h?i.jsxs("div",{className:"error-indicator",children:["Error: ",h]}):i.jsxs("div",{className:`pharmacy-inventory-page ${e?"embedded":""}`,style:e?{minHeight:"auto",padding:"0",background:"transparent"}:{},children:[i.jsx("div",{className:"inventory-header-controls",style:{padding:"20px 20px 0 20px"},children:i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",style:{display:"flex",gap:"12px"},children:[i.jsxs("button",{onClick:()=>n("/dashboard/purchase"),className:"action-button-outline add-drug-button",children:[i.jsx(qa,{size:18}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>n("/dashboard/purchase"),className:"action-button-outline",children:[i.jsx(qa,{size:18}),"Purchase Page"]}),i.jsxs("button",{onClick:()=>n("/dashboard/distributors"),className:"action-button-outline",children:[i.jsx(qa,{size:18}),"Distributors"]})]}),i.jsxs("div",{className:"action-group-right",style:{display:"flex",gap:"12px"},children:[i.jsx("button",{onClick:T,className:"action-button-outline",children:"Download CSV"}),i.jsxs("button",{onClick:tt,className:"action-button-outline",children:[i.jsx(qa,{size:18}),"Import Defaults"]}),i.jsxs("button",{onClick:je,className:"action-button-outline delete-button-outline",disabled:W.size===0,children:[i.jsx(Hr,{size:18}),"Delete (",W.size,")"]}),i.jsxs("button",{onClick:Ze,className:"action-button-outline delete-all-button-outline",children:[i.jsx(Hr,{size:18}),"Delete All"]})]})]})}),i.jsxs("div",{className:"search-bar-container",style:{padding:"0 20px 20px 20px",borderBottom:"1px solid var(--border-color)",marginBottom:"0"},children:[i.jsxs("div",{className:"search-input-wrapper",style:{maxWidth:"600px"},children:[i.jsx(kr,{size:20,className:"search-input-icon"}),i.jsx("input",{type:"text",placeholder:"Search drugs...",value:l,onChange:we=>d(we.target.value),className:"inventory-search-input"})]}),i.jsx("div",{className:"filter-dropdown-wrapper",children:i.jsxs("select",{value:S,onChange:we=>k(we.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:we=>{if(we.target.checked){const ye=new Set(a.map(Oe=>Oe.id));I(ye)}else I(new Set)},checked:W.size===a.length&&a.length>0,disabled:a.length===0})}),i.jsx("th",{className:"drug-name-header",children:"DRUG DETAILS"}),i.jsx("th",{className:"pack-header",children:"PACK"}),i.jsx("th",{className:"expiry-header",children:"EXPIRY"}),i.jsx("th",{className:"text-stock qty-header",children:"STOCK"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"RATE"}),i.jsx("th",{className:"box-number-header",children:"BOX"}),i.jsx("th",{className:"discount-header",children:"DISC %"}),i.jsx("th",{className:"margin-header",children:"MARGIN"}),i.jsx("th",{className:"actions-cell",children:"ACTIONS"})]})}),i.jsxs("tbody",{children:[a.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:11,children:"No drugs found matching your search."})}),J.map(we=>i.jsxs(Tn.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const ye=new Set(b);ye.has(we.id)&&we.id!==void 0?ye.delete(we.id):we.id!==void 0&&ye.add(we.id),v(ye)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:ye=>ye.stopPropagation(),checked:W.has(we.id),onChange:()=>{const ye=new Set(W);ye.has(we.id)?ye.delete(we.id):ye.add(we.id),I(ye)}})}),i.jsx("td",{className:"drug-name-cell",children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:we.brand_name||we.name||"-"}),we.brand_name&&we.name&&we.brand_name!==we.name&&i.jsx("span",{className:"text-xs text-muted-foreground",style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:we.name})]})}),i.jsx("td",{className:"text-muted pack-cell",children:we.pack||"-"}),i.jsx("td",{className:"text-muted",children:we.expiry_date?new Date(we.expiry_date).toLocaleDateString("en-GB"):"-"}),i.jsxs("td",{className:`text-stock ${we.stock<=rj?"low-stock":""}`,children:[i.jsx("div",{style:{fontWeight:"bold"},children:we.stock}),i.jsx("div",{className:"loose-quantity",children:we.loose!==null&&we.loose!==void 0?`${we.loose} loose`:"0 loose"})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof we.mrp=="number"?we.mrp.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:we.rate!==null&&we.rate!==void 0?`${we.rate.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:we.box_number||"-"}),i.jsx("td",{className:"text-muted",children:we.discount!==null&&we.discount!==void 0?`${we.discount.toFixed(2)}%`:"0.00%"}),i.jsx("td",{className:"text-muted",children:(()=>{const ye=we.mrp||0,Oe=we.rate||0,De=we.discount||0,Ve=we.gst||0,mt=Oe*(1-De/100)*(1+Ve/100),Nt=ye-mt;return`${(ye>0?Nt/ye*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:ye=>{ye.stopPropagation(),n(`/dashboard/inventory/edit/${we.id}`)},className:"action-icon-button",title:"Edit Drug",children:i.jsx(sl,{size:16})}),i.jsx("button",{onClick:ye=>{ye.stopPropagation(),Ie(we)},className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(Hr,{size:16})}),i.jsx("button",{onClick:ye=>{ye.stopPropagation(),Y(we),M(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(Q3,{size:16})}),i.jsx("button",{onClick:ye=>{ye.stopPropagation(),G(we)},className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!we.pack||ce(we.pack)===null,children:i.jsx($F,{size:16})})]})})]}),b.has(we.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:11,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",we.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",we.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",we.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",we.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",we.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const ye=ce(we.pack);return ye&&ye>0&&typeof we.mrp=="number"?`${(we.mrp/ye).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",we.gst!==null&&we.gst!==void 0?`${we.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(we.last_updated).toLocaleString()]})]})})})]},we.id))]})]})}),xe>1&&i.jsxs("div",{className:"pagination-controls",style:{padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"20px",backgroundColor:"var(--card-bg, #fff)",borderTop:"1px solid var(--border-color)"},children:[i.jsx("button",{onClick:()=>V(we=>Math.max(we-1,1)),disabled:F===1,className:"pagination-button",children:"Previous"}),i.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Page ",F," of ",xe]}),i.jsx("button",{onClick:()=>V(we=>Math.min(we+1,xe)),disabled:F===xe,className:"pagination-button",children:"Next"})]}),R&&$&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ye,className:"modal-close-button",children:i.jsx(_n,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:$.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ye,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:at,className:"button-delete",children:"Delete"})]})]})}),P&&ie&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:re,className:"modal-close-button",children:i.jsx(_n,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:ie.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",ie.stock]}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("form",{onSubmit:Ae,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:Q,onChange:Be,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:re,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),B&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ke,className:"modal-close-button",children:i.jsx(_n,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ke,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:pe,className:"button-delete",children:"Delete All"})]})]})}),st&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ge,className:"modal-close-button",children:i.jsx(_n,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:W.size})," selected drug(s)? This action cannot be undone."]}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ge,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:_e,className:"button-delete",children:"Delete Selected"})]})]})}),le&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:fe,className:"modal-close-button",children:i.jsx(_n,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:E.name||"Unnamed Drug"}),i.jsx("br",{}),"Pack Size: ",E.pack,i.jsx("br",{}),"Current Stock: ",E.stock," packs, ",E.loose??0," loose units."]}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("form",{onSubmit:Le,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packsToConvert",className:"form-label",children:"Packs to Convert"}),i.jsx("input",{type:"number",name:"packsToConvert",id:"packsToConvert",required:!0,step:"1",min:"1",max:E.stock,value:he,onChange:Ne,className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["Converting ",he," pack(s) will add ",he*(ce(E.pack)||0)," loose units."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:fe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert"})]})]})]})}),me&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:xt,className:"modal-close-button",children:i.jsx(_n,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),h&&i.jsx("div",{className:"modal-error-message",children:h}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:xt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:St,className:"button-submit",children:"Add Defaults"})]})]})})]})},NJ=()=>{const e=Rt();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},RE=()=>{const{id:e}=Xi(),n=Rt(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[h,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){d("Drug ID is missing."),o(!1);return}o(!0),d(null);try{const R=await ge(`/api/drugs/${e}`);if(!R.ok){const $=await R.json();throw new Error($.message||`Failed to fetch drug: ${R.statusText}`)}let z=await R.json();z={...z,name:z.name||"",brand_name:z.brand_name||"",mrp:parseFloat(String(z.mrp))||0,rate:z.rate!==null&&z.rate!==void 0?parseFloat(String(z.rate)):null,stock:parseInt(String(z.stock),10)||0,gst:z.gst!==null&&z.gst!==void 0?parseFloat(String(z.gst)):null,margin:z.margin!==null&&z.margin!==void 0?parseFloat(String(z.margin)):null,discount:z.discount!==null&&z.discount!==void 0?parseFloat(String(z.discount)):null,batch:z.batch||"",hsn_code:z.hsn_code||"",mfg:z.mfg||"",loose:z.loose!==null&&z.loose!==void 0?parseInt(String(z.loose),10):null},r(z)}catch(R){console.error("Failed to fetch drug:",R),d(R.message||"Failed to load drug data. Please try again.")}finally{o(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const R=$=>{$.key==="Tab"&&v.current===document.activeElement&&(h||(g(!0),setTimeout(()=>{var L;(L=S.current)==null||L.focus()},0),$.preventDefault()))},z=$=>{b.current&&!b.current.contains($.target)&&g(!1)};return document.addEventListener("keydown",R),document.addEventListener("mousedown",z),()=>{document.removeEventListener("keydown",R),document.removeEventListener("mousedown",z)}},[h]);const T=R=>{const{name:z,value:$,type:L}=R.target;r(B=>B?{...B,[z]:L==="number"?parseFloat($)||null:$}:null)},P=()=>{n(-1)},M=async R=>{if(R.preventDefault(),d(null),u(!0),!t||!t.id){d("Cannot edit drug: No drug data available."),u(!1);return}if(t.mrp===void 0||t.stock===void 0){d("MRP and Stock Quantity are required."),u(!1);return}const z={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,rate:t.rate===0?null:t.rate,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const $=await ge(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!$.ok){const B=await $.json();throw new Error(B.message||`Failed to update drug: ${$.statusText}`)}const L=await $.json();alert(`Drug "${L.name}" updated successfully!`),n(-1)}catch($){console.error("Failed to update drug:",$),d($.message||"Failed to update drug. Please try again.")}finally{u(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:P,className:"cancel-button",title:"Go Back",children:i.jsx(_n,{size:24})})]}),l&&i.jsx("div",{className:"error-message-submit",children:l}),i.jsxs("form",{onSubmit:M,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(rl,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(rl,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-mrp",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(rl,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"mrp",id:"edit-mrp",required:!0,step:"0.01",min:"0",value:t.mrp,onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(rl,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"stock",id:"edit-stock",required:!0,step:"1",min:"0",value:t.stock,onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-pack",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"pack",id:"edit-pack",value:t.pack||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!h),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),h&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-rate",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"rate",id:"edit-rate",step:"0.01",min:"0",value:t.rate??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:P,disabled:f,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button",tabIndex:20,children:f?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},X1=()=>{const e=Rt(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),[u,h]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,T]=w.useState(!1),[P,M]=w.useState([]),[R,z]=w.useState(!0);w.useEffect(()=>{(async()=>{z(!0);try{const F=await ge("/api/staff?role=doctor");if(!F.ok)throw new Error("Failed to fetch doctors");const V=await F.json();M(V),V.length>0&&t(ee=>({...ee,doctorId:""}))}catch(F){console.error("Error fetching doctors:",F),l(`Failed to load doctors: ${F.message}`)}finally{z(!1)}})()},[]);const $=w.useCallback(async()=>{if(u.trim()){T(!0),l(null),b([]);try{const I=encodeURIComponent(u.trim()),F=await ge(`/api/patients?search=${I}&limit=10`);if(!F.ok){const ee=await F.json().catch(()=>({message:"Failed to search patients"}));throw new Error(ee.message||"Failed to search patients")}const V=await F.json();V&&Array.isArray(V.patients)?b(V.patients):(console.error("Unexpected response format from patient search:",V),b([]))}catch(I){console.error("Error searching patients:",I),l(`Search failed: ${I.message}`)}finally{T(!1)}}},[u]);w.useEffect(()=>{if(u.trim().length<2){b([]),l(null);return}const I=setTimeout(()=>{$()},300);return()=>clearTimeout(I)},[u,$]);const L=I=>{S(I),h(""),b([]),l(null),t(F=>({...F,name:"",age:"",gender:"",phone:""}))},B=()=>{S(null),h(""),b([]),l(null),t(I=>({...I,name:"",age:"",gender:"",phone:""}))},q=I=>{const{name:F,value:V}=I.target;t(ee=>({...ee,[F]:V}))},W=async I=>{var F;I.preventDefault(),l(null),f(null),a(!0);try{let V,ee;if(v)V=v.id,ee=v.name,console.log(`Adding existing patient ${V} to queue.`);else{console.log("Registering new patient...");const ne=await ge("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!ne.ok){const oe=await ne.json();if(ne.status===403&&oe.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:oe.message}});return}throw new Error(oe.message||"Failed to register patient")}const le=await ne.json();V=le.id,ee=le.name,console.log(`New patient ${V} registered.`)}const ie=n.doctorId||null;console.log(`Adding patient ${V} to queue for doctor ${ie||"Unassigned"}`);const Y=await ge("/api/queue",{method:"POST",body:JSON.stringify({patientId:V,complaint:n.complaint||null,doctorId:ie})});if(!Y.ok){const ne=await Y.json();throw new Error(ne.message||"Failed to add patient to queue")}const Q=await Y.json();if(console.log(`Patient added to queue, entry ID: ${Q.id}`),S(null),h(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),ie){const ne=((F=P.find(oe=>oe.id===ie))==null?void 0:F.name)||"Selected Doctor",le=v?`Existing patient "${ee}" added to queue for Dr. ${ne}. Redirecting to billing...`:`Patient "${ee}" registered and added to queue for Dr. ${ne}. Redirecting to billing...`;f(le),e("/billing",{state:{patientId:V,queueId:Q.id,patientName:ee,doctorId:ie,billType:"consultation"}})}else{const ne=v?`Existing patient "${ee}" added to the general queue.`:`Patient "${ee}" registered and added to the general queue.`;f(ne)}}catch(V){console.error("Error in add/queue process:",V),V.message.includes("Patient limit")?(l(`Operation failed: ${V.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${V.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[i.jsx(sn,{size:20,className:"btn-icon"})," Back"]})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx(Ew,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:u,onChange:I=>h(I.target.value),className:"form-input",disabled:r||!!v}),i.jsx(kr,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:B,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(_n,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map(I=>i.jsxs("li",{onClick:()=>L(I),children:[I.name," (ID: ",I.id,", Phone: ",I.phone||"N/A",")"]},I.id))}),u.length>=2&&g.length===0&&!k&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',u,'". You can register them below.']}),k&&u.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),o&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),d&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:d})]}),i.jsxs("form",{onSubmit:W,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:q,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:q,className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:q,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:q,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:q,className:`form-select ${R?"opacity-50":""}`,disabled:r||R,children:[i.jsx("option",{value:"",children:R?"Loading doctors...":P.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),P.map(I=>i.jsx("option",{value:I.id,children:I.name},I.id))]}),P.length===0&&!R&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:q,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("div",{className:"flex justify-end pt-2",children:[" ",i.jsxs("button",{type:"submit",className:`btn btn-primary ${r||R?"disabled":""}`,disabled:r||R,children:[i.jsx(Tw,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})]})},CJ=({clinicId:e})=>{const n=Rt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,o]=w.useState(null),[l,d]=w.useState(!1);w.useEffect(()=>{o(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const f=g=>{const{name:b,value:v}=g.target;r(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},u=async g=>{if(g.preventDefault(),o(null),!t.name||!t.email||!t.role||!t.password){o("Name, Email, Role, and Password are required.");return}if(!e){o("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){o("Invalid OPD Fee format. Please enter a number.");return}d(!0);try{const v=await ge("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){o(`Failed to add staff: ${v.message}`)}finally{d(!1)}},h=()=>{n(-1)};return i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:h,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(sn,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{children:"Add New Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(jr,{size:18,className:"mr-2 text-red-500"}),a]}),i.jsxs("form",{onSubmit:u,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:f,required:!0,disabled:l||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:f,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:l||!e}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),i.jsxs("button",{type:"submit",disabled:l||!e,children:[l?i.jsx(ao,{size:18,className:"animate-spin mr-2"}):i.jsx(al,{size:18,className:"mr-2"}),l?"Adding...":"Add Staff Member"]})]})]})},_J=()=>{const{id:e}=Xi(),n=Rt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,o]=w.useState(""),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),d(!1);return}d(!0),g(null),v(null);try{const M=await ge(`/staff/${e}`);if(!M.ok){const z=await M.json();throw new Error(z.message||`HTTP error! status: ${M.status}`)}const R=await M.json();r({name:R.name,email:R.email,role:R.role,opd_fee:R.opd_fee??"",active:R.active})}catch(M){g(`Failed to load staff details: ${M.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=M=>{const{name:R,value:z,type:$}=M.target;if($==="checkbox"){const{checked:L}=M.target;r(B=>({...B,[R]:L}))}else r(L=>({...L,[R]:z}))},T=M=>{o(M.target.value)},P=async M=>{if(M.preventDefault(),!e){g("Staff ID is missing.");return}u(!0),g(null),v(null);const R={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const z=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(z!==null&&isNaN(z)){g("OPD Fee must be a valid number."),u(!1);return}R.opd_fee=z}else R.opd_fee=null;a.trim()!==""&&(R.password=a.trim());try{const z=await ge(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!z.ok){const $=await z.json();throw new Error($.message||`HTTP error! status: ${z.status}`)}v("Staff details updated successfully!"),o(""),setTimeout(()=>n(-1),1500)}catch(z){g(`Failed to update staff: ${z.message}`)}finally{u(!1)}};return l?i.jsxs("div",{className:"flex justify-center items-center h-screen",children:[i.jsx(ao,{className:"h-12 w-12 animate-spin text-teal-600"}),i.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(sn,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),h&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(jr,{size:18,className:"mr-2 text-red-500"}),h,i.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&i.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[i.jsx(Wa,{size:18,className:"mr-2 text-green-500"}),b,i.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),i.jsxs("form",{onSubmit:P,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"role",children:["Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),i.jsxs("div",{className:"form-group checkbox-group",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),i.jsx("button",{type:"submit",disabled:f,children:f?i.jsxs(i.Fragment,{children:[i.jsx(ao,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(qd,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})},jJ=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},kJ=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},H0=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,loadingText:o,noDataText:l,onDeleteItem:d,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:h,onLabOrderTestChange:g,onLabOrderStatusChange:b,onEditPharmacyOrder:v,onPrintUnavailablePrescription:S,onBillLabOrder:k,onUpdateLabOrderStatus:T,onEnterLabReport:P,labInventory:M=[],isSavingLabOrder:R=!1,expandedLabReports:z={},toggleLabReport:$=()=>{}})=>{const L=w.useMemo(()=>{const q={};n.forEach(I=>{if(isNaN(I.date.getTime())){q["Unknown Date"]||(q["Unknown Date"]=[]),q["Unknown Date"].push(I);return}const F=jJ(I.originalDateString);q[F]||(q[F]=[]),q[F].push(I)});const W=Object.keys(q);return W.sort((I,F)=>{if(I==="Unknown Date")return 1;if(F==="Unknown Date")return-1;try{const V=new Date(I.split(" ").reverse().join(" ")),ee=new Date(F.split(" ").reverse().join(" "));if(!isNaN(V.getTime())&&!isNaN(ee.getTime()))return ee.getTime()-V.getTime()}catch{}return F.localeCompare(I)}),W.map(I=>({date:I,items:q[I]}))},[n]),B=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),a&&i.jsx("p",{className:"ai-context-text italic",children:o}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:l}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:L.map(({date:q,items:W})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:q}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:W.map((I,F)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(I,F,z,$)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[I.type==="Lab Order"&&!I.data.isEditing&&f&&i.jsx("button",{onClick:()=>f(I.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:R,children:i.jsx(Gl,{size:14})}),I.type==="Lab Order"&&I.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>u&&u(I.data.id,I.data.editedTests,I.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:R,children:i.jsx(qd,{size:14})}),i.jsx("button",{onClick:()=>h&&h(I.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:R,children:i.jsx(Hr,{size:14})})]}),I.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[I.data.status==="pending"&&k&&(()=>{const V=I.data.tests.reduce((ee,ie)=>ee+(Number(ie.price)||0),0).toFixed(2);return i.jsxs("button",{onClick:()=>k(I.data),className:"lab-action-button btn-bill",title:`Pay total of ${V}`,children:["Pay (",V,")"]})})(),I.data.status==="billed"&&T&&i.jsx("button",{onClick:()=>T(I.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),I.data.status==="collected"&&T&&i.jsx("button",{onClick:()=>T(I.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),["pending","billed","collected","processing","report_ready","reported","completed"].includes(I.data.status)&&P&&i.jsx("button",{onClick:()=>P(I.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(I.data.status==="report_ready"||I.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T(I.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"})]}),I.type==="Pharmacy Order"&&I.data.status==="pending"&&v&&i.jsx("button",{onClick:()=>v(I.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:R,children:i.jsx(Gl,{size:14})}),I.type==="Pharmacy Order"&&I.data.prescriptionForUnavailableDrugs&&S&&i.jsx("button",{onClick:()=>S(I.data.prescriptionForUnavailableDrugs,`Prescription for Order ${I.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:R,children:i.jsx(tl,{size:14})}),I.type==="Pharmacy Order"&&I.data.status==="pending"&&d&&i.jsx("button",{onClick:()=>d({type:I.type,data:I.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:R,children:i.jsx(Hr,{size:14})}),d&&["Complaint","Lab Order","Lab Report"].includes(I.type)&&i.jsx("button",{onClick:()=>d({type:I.type,data:I.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${I.type.toLowerCase()}`,disabled:R,children:i.jsx(Hr,{size:14})})]})]}),I.type==="Lab Order"&&I.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:I.data.editedStatus||I.data.status,onChange:V=>b&&b(I.data.id,V.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:R,children:B.map(V=>i.jsx("option",{value:V,children:V.replace(/_/g," ")},V))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),I.data.editedTests.map((V,ee)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:V.id,onChange:ie=>{const Y=M.find(Q=>String(Q.id)===ie.target.value);Y&&(g&&g(I.data.id,ee,"id",Y.id),g&&g(I.data.id,ee,"name",Y.name),g&&g(I.data.id,ee,"price",Y.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:R,children:[i.jsx("option",{value:"",children:"Select Test"}),M.map(ie=>i.jsxs("option",{value:ie.id,children:[ie.name," (",ie.price,")"]},ie.id))]}),i.jsx("button",{onClick:()=>{const ie=I.data.editedTests.filter((Y,Q)=>Q!==ee);g&&g(I.data.id,-1,"remove",ie)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:R,children:i.jsx(Hr,{size:14})})]},ee)),i.jsx("button",{onClick:()=>{g&&g(I.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:R,children:"Add Test"})]})]},`${I.type}-${I.originalDateString}-${F}`))})]},q))})]})},TJ="_modalOverlay_1yna4_3",EJ="_modalContent_1yna4_29",AJ="_modalHeader_1yna4_57",PJ="_modalTitle_1yna4_75",DJ="_modalCloseButton_1yna4_87",IJ="_modalBody_1yna4_115",RJ="_errorText_1yna4_129",MJ="_formGroup_1yna4_147",OJ="_inputField_1yna4_171",LJ="_searchResultsCard_1yna4_213",FJ="_searchResultsList_1yna4_241",$J="_searchResultItem_1yna4_253",zJ="_searchResultPrice_1yna4_289",BJ="_selectedTestsCard_1yna4_299",UJ="_selectedTestsHeader_1yna4_319",qJ="_noTestsMessage_1yna4_335",VJ="_selectedTestsList_1yna4_351",HJ="_selectedTestItem_1yna4_363",GJ="_selectedTestName_1yna4_387",YJ="_selectedTestPrice_1yna4_399",WJ="_removeTestButton_1yna4_411",QJ="_totalAmount_1yna4_437",JJ="_modalFooter_1yna4_455",KJ="_button_1yna4_473",XJ="_buttonPrimary_1yna4_491",ZJ="_buttonSecondary_1yna4_513",At={modalOverlay:TJ,modalContent:EJ,modalHeader:AJ,modalTitle:PJ,modalCloseButton:DJ,modalBody:IJ,errorText:RJ,formGroup:MJ,inputField:OJ,searchResultsCard:LJ,searchResultsList:FJ,searchResultItem:$J,searchResultPrice:zJ,selectedTestsCard:BJ,selectedTestsHeader:UJ,noTestsMessage:qJ,selectedTestsList:VJ,selectedTestItem:HJ,selectedTestName:GJ,selectedTestPrice:YJ,removeTestButton:WJ,totalAmount:QJ,modalFooter:JJ,button:KJ,buttonPrimary:XJ,buttonSecondary:ZJ},eK=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){h([]);return}const M=d.toLowerCase();h(r.filter(R=>R.name.toLowerCase().includes(M)||R.description&&R.description.toLowerCase().includes(M)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const M={patient_id:t,tests:o.map(z=>({id:z.id,name:z.name,price:z.price}))},R=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!R.ok){const z=await R.json().catch(()=>({}));throw new Error(z.message||`Failed to create lab order: ${R.statusText}`)}await R.json(),a(t),n(),l([]),f("")}catch(M){b(`Lab Order Creation Error: ${M.message}`)}finally{S(!1)}},T=M=>{if(o.some(R=>R.id===M.id)){b(`${M.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),h([]);return}l(R=>[...R,{...M}]),f(""),h([])},P=M=>{l(R=>R.filter(z=>z.id!==M))};return e?i.jsx("div",{className:At.modalOverlay,children:i.jsxs("div",{className:At.modalContent,children:[i.jsxs("div",{className:At.modalHeader,children:[i.jsx("h3",{className:At.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:At.modalCloseButton,children:i.jsx(_n,{size:20})})]}),i.jsxs("div",{className:At.modalBody,children:[g&&i.jsx("div",{className:At.errorText,children:g}),i.jsxs("div",{className:At.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:d,onChange:M=>f(M.target.value),className:At.inputField}),d&&u.length>0&&i.jsx("div",{className:At.searchResultsCard,children:i.jsx("ul",{className:At.searchResultsList,children:u.map(M=>i.jsxs("li",{onClick:()=>T(M),className:At.searchResultItem,children:[i.jsx("span",{children:M.name}),i.jsxs("span",{className:At.searchResultPrice,children:["(",parseFloat(String(M.price)).toFixed(2),")"]})]},M.id))})})]}),i.jsxs("div",{className:At.selectedTestsCard,children:[i.jsx("h4",{className:At.selectedTestsHeader,children:"Selected Tests"}),o.length===0?i.jsx("p",{className:At.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:At.selectedTestsList,children:o.map(M=>i.jsxs("li",{className:At.selectedTestItem,children:[i.jsx("span",{className:At.selectedTestName,children:M.name}),i.jsxs("span",{className:At.selectedTestPrice,children:["",parseFloat(String(M.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>P(String(M.id)),className:At.removeTestButton,title:"Remove Test",children:i.jsx(Hr,{size:16})})]},M.id))})]}),o.length>0&&i.jsxs("div",{className:At.totalAmount,children:["Total: ",o.reduce((M,R)=>M+parseFloat(String(R.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:At.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${At.button} ${At.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${At.button} ${At.buttonPrimary} ${o.length===0||v?At.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},Mx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},Gm=(e,n)=>{if(!e||!n||n.length===0)return;const t=Mx(e);let r=n.find(l=>Mx(l.name)===t);if(r)return r;let a=n.find(l=>Mx(l.name).includes(t));if(a)return a;let o=n.find(l=>t.includes(Mx(l.name)));if(o)return o},tK=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
   - **Important: Preventing Loops** If you determine that no further actions are needed (e.g., you have already performed necessary actions, or the user's input does not require any specific action), you **MUST** use the \`end_task\` action. This explicitly signals that your task is complete and prevents the system from re-prompting you unnecessarily.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "create_lab_report", "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "edit_lab_report", "serialNumber": number, "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." },
  { "action": "end_task" }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Structure:**
     The AI response can be a flat array of actions OR a list of "function call" objects containing grouped actions.
     **Option 1: Flat Array (Simple)**
     \`\`\`json
     [
       { "action": "add_complaint_history", ... },
       { "action": "create_lab_order", ... }
     ]
     \`\`\`
     **Option 2: Grouped Function Calls (Complex)**
     You can group actions under logical "function calls" if needed.
     \`\`\`json
     [
       {
         "function_call": "assess_patient",
         "actions": [
           { "action": "ask_followup_question", "question": "..." }
         ]
       },
       {
         "function_call": "prescribe_treatment",
         "actions": [
            { "action": "create_pharmacy_order", "items": [...] },
            { "action": "create_lab_order", "tests": [...] }
         ]
       }
     ]
     \`\`\`

   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this action (either standalone or inside a group) only when you need clarification.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"]
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,ij="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",nK="models/gemini-3-flash-preview";async function rK(){if(!_w())return console.warn("No auth token found, using default Gemini API key."),ij;let n=null;try{const t=await ge("/api/clinics/settings");if(t.ok){const r=await t.json();r.gemini_api_key&&r.gemini_api_key.trim()!==""&&(n=r.gemini_api_key.trim())}}catch(t){console.warn("Could not fetch clinic settings (or key missing), proceeding to global fallback.",t)}if(n)return n;try{const t=await ge("/api/global-settings/app_gemini_api_key");if(t.ok){const a=(await t.json()).value;if(a&&a.trim()!=="")return a.trim()}}catch(t){console.warn("Could not fetch global API key.",t)}return console.warn("Clinic-specific and global Gemini API keys not found, using default env var."),ij}let G0=null;async function iK(){if(!G0){const e=await rK();G0=new Cw({apiKey:e})}return G0}async function aK(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:o,patientGender:l,case_summary:d,case_summary_last_updated:f,clinic_ai_memory:u,clinic_ai_memory_last_updated:h,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,pharmacyInventory:k,labInventory:T}=e;let P=`Patient Complaint: ${t}`;if(d&&(P+=`

--- Case Summary (Provided by Doctor) ---
${d}`,f))try{const I=new Date(f).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${I})`}catch{console.warn(`Could not format case_summary_last_updated: ${f}`),P+=`
(Last Updated: ${f})`}if(a&&(P+=`

Patient Name: ${a}`),o!=null&&(P+=`
Patient Age: ${o}`),l&&(P+=`
Patient Gender: ${l}`),r)try{const I=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`

Current Interaction Time: ${I}`}catch{console.warn(`Could not format currentDateTime: ${r}`),P+=`

Current Interaction Time: ${r}`}if(u&&(P+=`

--- Clinic-wide AI Memory/Context ---
${u}`,h))try{const I=new Date(h).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${I})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${h}`),P+=`
(Last Updated: ${h})`}let M="";b&&Array.isArray(b)&&b.length>0&&(M=`

--- Lab History (Orders & Reports) ---
`,b.forEach(I=>{let F="Unknown Date";try{F=new Date(I.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${I.orderDate}`)}if(M+=`
Order #${I.serialNumber} Date: ${F} (Status: ${I.status})
`,M+=`Tests: ${I.tests.map(V=>V.name).join(", ")}
`,I.report){let V="Unknown Date";try{V=new Date(I.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${I.report.reportDate}`)}M+=`  -> Report Date: ${V}
`,I.report.tests&&Array.isArray(I.report.tests)?(M+=`     Findings:
`,I.report.tests.forEach(ee=>{M+=`       - Test: ${ee.testName}
`,ee.parameters&&Array.isArray(ee.parameters)&&ee.parameters.forEach(ie=>{M+=`         - ${ie.name}: ${ie.value} (Normal: ${ie.normal_range})
`})})):(M+=`     Findings: ${I.report.reportContent||"N/A"}
`,I.report.error&&(M+=`     Note: ${I.report.error}
`))}M+=`---
`}),P+=M);let R="";v&&Array.isArray(v)&&v.length>0&&(R=`

--- Recent Pharmacy Orders ---
`,v.forEach(I=>{let F="Unknown Date/Time";try{F=new Date(I.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${I.date}`)}R+=`
Order #${I.serialNumber} Date/Time: ${F} (Status: ${I.status})
`,R+=`Prescribed By: ${I.prescribedBy||"N/A"}
`,I.dispensedBy&&(R+=`Dispensed By: ${I.dispensedBy}
`),R+=`Medications:
`,I.medications.forEach(V=>{R+=`  - ${V.name} (Qty: ${V.quantity}`,V.tabletsPerDay&&(R+=`, ${V.tabletsPerDay}/day`),V.numberOfDays&&(R+=` for ${V.numberOfDays} days`),R+=`)
`}),I.prescriptionForUnavailableDrugs&&(R+=`  Prescription for Unavailable Drugs: ${I.prescriptionForUnavailableDrugs}
`),R+=`---
`}),P+=R);let z="";S&&Array.isArray(S)&&S.length>0&&(z=`

--- Past Complaints History ---
`,S.forEach(I=>{let F="Unknown Date/Time";try{F=new Date(I.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${I.createdAt}`)}z+=`
Date/Time: ${F}
Complaint: ${I.complaint||"N/A"}
---
`}),P+=z);let $="";k&&Array.isArray(k)&&k.length>0&&($=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(I=>{let F=`${I.stock??0} packs`;I.loose!==void 0&&I.loose!==null&&I.loose>0&&(F+=`, ${I.loose} loose`);let V=`- ${I.name} (Pack: ${I.pack??"N/A"}): ${F}`;const ee=[];I.brand_name&&ee.push(`Brand: ${I.brand_name}`),I.batch&&ee.push(`Batch: ${I.batch}`),I.expiry_date&&ee.push(`Exp: ${I.expiry_date}`),ee.length>0&&(V+=` [${ee.join(", ")}]`),$+=`${V}
`}),P+=$);let L="";T&&Array.isArray(T)&&T.length>0&&(L=`

--- Available Lab Tests (with Parameters) ---
`,T.forEach(I=>{L+=`- ${I.name} (Price: ${I.price??"N/A"})
`,I.default_parameters&&Array.isArray(I.default_parameters)&&I.default_parameters.length>0&&I.default_parameters.forEach(F=>{let V=`    * ${F.name}`;F.unit&&(V+=` (${F.unit})`),F.normal_range?V+=` [Normal: ${F.normal_range}]`:F.lower_limit!==void 0&&F.upper_limit!==void 0&&F.lower_limit!==null&&F.upper_limit!==null&&(V+=` [Normal: ${F.lower_limit} - ${F.upper_limit}]`),L+=`${V}
`})}),P+=L);const B=[{text:tK}];g&&g.trim()!==""&&B.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const q=[{text:P}];if(n){const I=new FileReader,F=await new Promise((V,ee)=>{I.onloadend=()=>{typeof I.result=="string"?V(I.result.split(",")[1]):ee(new Error("Failed to read image file as base64."))},I.onerror=ee,I.readAsDataURL(n)});q.push({inlineData:{mimeType:n.type,data:F}})}const W=[];B.length>0&&W.push({role:"user",parts:B}),W.push({role:"user",parts:q});try{const I={model:nK,contents:W,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},V=await(await iK()).models.generateContentStream(I);let ee="";for await(const ie of V)if(ie&&typeof ie.text=="function"){const Y=ie.text;Y&&(ee+=Y)}else ie&&ie.candidates&&ie.candidates[0]&&ie.candidates[0].content&&ie.candidates[0].content.parts&&ie.candidates[0].content.parts[0]&&ie.candidates[0].content.parts[0].text&&(ee+=ie.candidates[0].content.parts[0].text);if(ee&&ee.trim()!=="")return ee.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(I){console.error("Error calling Gemini API:",I);let F="Failed to get suggestion from Gemini.";throw I.message&&(F=`Error processing Gemini request: ${I.message}`),new Error(F)}}const sK=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},oK=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:o,userMessages:l,selectedImageFile:d,pendingLabOrders:f,labReports:u,pastComplaints:h,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,currentComplaint:S,setCurrentComplaint:k,setAiResponse:T,setAiResponseText:P,setAiResponseJsonString:M,setShowAiJsonDetails:R,setIsLoadingAi:z,setAiError:$,setIsSubmittingAiOrder:L,setAiOrderSubmissionStatus:B,setIsSubmittingAiLabOrder:q,setAiLabOrderSubmissionStatus:W,setIsSubmittingAiComplaint:I,setAiComplaintSubmissionStatus:F,setIsUpdatingCaseSummary:V,setAiCaseSummaryUpdateStatus:ee,setCaseSummary:ie,setIsUpdatingAiMemoryByAI:Y,setAiMemoryUpdateByAIStatus:Q,setFollowUpQuestion:ne,setFollowUpOptions:le,setError:oe,setIsSavingAiResponse:E,setSaveAiResponseError:de,fetchPharmacyOrdersData:he,fetchPendingLabOrdersData:D,fetchLabReportsData:me,fetchPastComplaintsData:Ce,fetchPatientDetails:te,setClinicSettings:K,setEditedAiMemory:J,setCanUndo:xe,onAiActionSuccess:He,addMessage:re},Be)=>{const[Ae,Ie]=Tn.useState(null);Tn.useEffect(()=>{xe(!!Ae)},[Ae,xe]);let Ye;const at=async(je,Ge,_e,pe=0)=>{let ce;const fe=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(Ne=>{var Le;return(Le=Ge.message)==null?void 0:Le.includes(Ne)});_e&&fe?ce=`AI Error: ${Ge.message}

${_e}`:(ce=`I encountered a frontend error while trying to execute the '${je}' function. The error message is: "${Ge.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(je==="create_pharmacy_order"||je==="edit_pharmacy_order")&&(ce+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),_e&&(ce+=`

The original AI response that caused the error was:
\`\`\`
${_e}
\`\`\``)),re==null||re({role:"system",type:"error",content:`AI Error: ${Ge.message}. Retrying...`}),await Ye(ce,pe+1)},Ze=async je=>{console.log("Executing Rollback for actions:",je);for(const Ge of je){const{actionType:_e,undoData:pe}=Ge;if(console.log(`Attempting to rollback ${_e}`,pe),!pe){console.warn(`No undoData found for action ${_e}, skipping.`);continue}try{if(_e==="create_pharmacy_order")pe!=null&&pe.orderId?(console.log(`Deleting pharmacy order ${pe.orderId}`),await ge(`/api/pharmacy-orders/${pe.orderId}`,{method:"DELETE"}),he(n)):console.error("Missing orderId for create_pharmacy_order rollback");else if(_e==="create_lab_order")pe!=null&&pe.orderId?(console.log(`Deleting lab order ${pe.orderId}`),await ge(`/api/lab/orders/${pe.orderId}`,{method:"DELETE"}),D(n)):console.error("Missing orderId for create_lab_order rollback");else if(_e==="update_patient_details")if(pe!=null&&pe.patientId&&(pe!=null&&pe.originalDetails)){console.log(`Reverting patient details for ${pe.patientId}`);const ce=pe.originalDetails,G={name:ce.name,age:ce.age,gender:ce.gender,phone:ce.phone,ai_response:ce.ai_response};await ge(`/api/patients/${pe.patientId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)}),te(pe.patientId)}else console.error("Missing patientId or originalDetails for update_patient_details rollback");else if(_e==="add_complaint_history")pe!=null&&pe.recordId?(console.log(`Reverting complaint history for ${pe.recordId}`),await ge(`/api/queue/doctor/complaint/${pe.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:pe.originalComplaint||""})}),k(pe.originalComplaint||"")):console.error("Missing recordId for add_complaint_history rollback");else if(_e==="update_case_summary")pe!=null&&pe.recordId?(console.log(`Reverting case summary for ${pe.recordId}`),await ge(`/api/queue/doctor/complaint/${pe.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:pe.originalSummary||""})}),ie(pe.originalSummary||"")):console.error("Missing recordId for update_case_summary rollback");else if(_e==="update_clinic_ai_memory")(pe==null?void 0:pe.originalMemory)!==void 0?(console.log("Reverting AI memory"),await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify({...o,aiMemory:pe.originalMemory})}),J(pe.originalMemory)):console.error("Missing originalMemory for update_clinic_ai_memory rollback");else if(_e==="edit_pharmacy_order")if(pe!=null&&pe.orderId&&(pe!=null&&pe.originalState)){console.log(`Reverting pharmacy order ${pe.orderId}`);const ce={items:pe.originalState.medications||[],status:pe.originalState.status,prescription_for_unavailable_drugs:pe.originalState.prescription_for_unavailable_drugs,order_total:pe.originalState.order_total};await ge(`/api/pharmacy-orders/${pe.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)}),he(n)}else console.error("Missing orderId or originalState for edit_pharmacy_order rollback");else if(_e==="edit_lab_order")if(pe!=null&&pe.orderId&&(pe!=null&&pe.originalState)){console.log(`Reverting lab order ${pe.orderId}`);const ce={tests:pe.originalState.tests,status:pe.originalState.status};await ge(`/api/lab/orders/${pe.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)}),D(n)}else console.error("Missing orderId or originalState for edit_lab_order rollback");else console.warn(`Unknown action type for rollback: ${_e}`)}catch(ce){console.error(`Failed to rollback ${_e}:`,ce)}}},Ke=async()=>{!Ae||!window.confirm("Are you sure you want to undo the last AI actions?")||(z(!0),await Ze([...Ae].reverse()),Ie(null),z(!1),$("Last actions undone successfully."))},st=async(je,Ge)=>{Ie(null),B(null),W(null),F(null),ee(null),Q(null),ne(null),le([]),oe(null);let _e=null;const pe=/```json\s*([\s\S]*?)\s*```/,ce=je.match(pe);if(ce&&ce[1])_e=ce[1];else{const G=je.trim();if(G.startsWith("{")&&G.endsWith("}"))_e=G;else if(G.startsWith("[")&&G.endsWith("]"))_e=G;else throw new Error("AI response did not contain a recognized function call.")}if(_e)try{const G=JSON.parse(_e),fe=ye=>{const Oe=[],De=Array.isArray(ye)?ye:[ye];for(const Ve of De)Ve&&(Ve.actions&&Array.isArray(Ve.actions)?Oe.push(...fe(Ve.actions)):Ve.sub_actions&&Array.isArray(Ve.sub_actions)?Oe.push(...fe(Ve.sub_actions)):Ve.function_calls&&Array.isArray(Ve.function_calls)?Oe.push(...fe(Ve.function_calls)):typeof Ve.action=="string"&&Oe.push(Ve));return Oe},Ne=fe(G),Le=[];let tt=null,xt=!1;for(const ye of Ne){if(ye.action==="ask_followup_question"){tt=ye,xt=!0;continue}xt=!0;const Oe=ye.action;Oe==="update_clinic_ai_memory"&&typeof ye.memory_content=="string"?Le.push((async()=>{Y(!0),Q("Processing AI mem..."),re==null||re({role:"system",type:"loading",content:"Processing AI memory..."});const De=(o==null?void 0:o.aiMemory)||"";try{if(!o)throw new Error("Clinic settings not loaded.");const Ve={...o,aiMemory:ye.memory_content.trim(),admissionCharge:o.admissionCharge,perDayCharge:o.perDayCharge,otherCharges:o.otherCharges,clinicWideSystemPrompt:o.clinicWideSystemPrompt},ot=await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Ve)});if(!ot.ok){const Nt=await ot.json().catch(()=>({}));throw new Error(Nt.message||`AI-triggered clinic memory update failed: ${ot.statusText}`)}const mt=await ot.json();return K(Nt=>Nt?{...Nt,aiMemory:mt.settings.aiMemory}:null),J(mt.settings.aiMemory||""),Q("AI mem updated!"),re==null||re({role:"system",type:"success",content:"AI memory updated successfully."}),{success:!0,actionType:Oe,undoData:{originalMemory:De}}}catch(Ve){return Q("Failed"),{success:!1,actionType:Oe,error:Ve,originalActionPayload:ye}}finally{Y(!1)}})()):Oe==="create_pharmacy_order"?Le.push((async()=>{var De,Ve;L(!0),B("Processing order..."),re==null||re({role:"system",type:"loading",content:"Processing pharmacy order..."});try{if(!n)throw new Error("Missing patient ID.");const ot=[];let mt=null;if(Array.isArray(ye.items))for(const Tt of ye.items){let Ct;if(Tt.drug_id?Ct=b.find(Xr=>Xr.id===Tt.drug_id):Tt.name&&(Ct=Gm(Tt.name,b)),!Ct){mt=`Drug "${Tt.name||Tt.drug_id}" not found.`;break}const Yt=sK(Ct.pack),It=Number(Ct.mrp),Kn=It,Yr=Yt>0?It/Yt:0,hr=Number(Tt.pack_quantity)||0,An=Number(Tt.loose_quantity)||0,Sr=hr*Kn+An*Yr;ot.push({drug_id:String(Ct.id),name:Ct.name,pack_quantity:hr,loose_quantity:An,tabletsPerDay:Tt.tabletsPerDay,numberOfDays:Tt.numberOfDays,directions_to_use:Tt.directions_to_use,group_id:Tt.group_id,pack_price:Kn,loose_price:Yr,total_price:Sr,price:It,isLoose:Tt.isLoose,unit:Ct.pack})}if(mt)throw new Error(mt);const Nt=ot.reduce((Tt,Ct)=>Tt+Ct.total_price,0),cn={patient_id:n,items:ot,prescription_for_unavailable_drugs:ye.prescription_for_unavailable_drugs,order_total:parseFloat(Nt.toFixed(2))},fn=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(cn)});if(!fn.ok){const Tt=await fn.json().catch(()=>({}));throw new Error(Tt.message||"Order creation failed.")}const wn=await fn.json();return B("Order created!"),he(n),re==null||re({role:"system",type:"success",content:"Pharmacy order created successfully."}),{success:!0,actionType:Oe,data:wn,undoData:{orderId:((Ve=(De=wn.orders)==null?void 0:De[0])==null?void 0:Ve.id)||wn.id}}}catch(ot){return re==null||re({role:"system",type:"error",content:`Pharmacy order failed: ${ot.message}`}),{success:!1,actionType:Oe,error:ot,originalActionPayload:ye}}finally{L(!1)}})()):Oe==="update_patient_details"?Le.push((async()=>{z(!0),re==null||re({role:"system",type:"loading",content:"Updating patient details..."});const De={...t};try{if(!n)throw new Error("Missing patient ID.");const Ve={};if(ye.name&&(Ve.name=ye.name),ye.age&&(Ve.age=ye.age),ye.gender&&(Ve.gender=ye.gender),ye.phone_number!==void 0&&(Ve.phone_number=ye.phone_number),!(await ge(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ve)})).ok)throw new Error("Patient update failed.");return te(n),re==null||re({role:"system",type:"success",content:"Patient details updated."}),{success:!0,actionType:Oe,undoData:{patientId:n,originalDetails:De}}}catch(Ve){return{success:!1,actionType:Oe,error:Ve,originalActionPayload:ye}}finally{z(!1)}})()):Oe==="create_lab_order"?Le.push((async()=>{q(!0),W("Processing lab..."),re==null||re({role:"system",type:"loading",content:"Processing lab order..."});try{if(!n)throw new Error("Missing patient ID.");const De=[];for(const mt of ye.tests||[]){let Nt;if(mt.id?Nt=v.find(cn=>String(cn.id)===String(mt.id)):mt.name&&(Nt=Gm(mt.name,v)),!Nt)throw new Error(`Lab test "${mt.name}" not found.`);De.push({id:Nt.id,name:Nt.name,price:Number(Nt.price)})}const Ve=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:De})});if(!Ve.ok)throw new Error("Lab order creation failed.");const ot=await Ve.json();return W("Success!"),D(n),re==null||re({role:"system",type:"success",content:"Lab order created."}),{success:!0,actionType:Oe,data:ot.labOrder,undoData:{orderId:ot.labOrder.id}}}catch(De){return re==null||re({role:"system",type:"error",content:`Lab order failed: ${De.message}`}),{success:!1,actionType:Oe,error:De,originalActionPayload:ye}}finally{q(!1)}})()):Oe==="create_lab_report"?Le.push((async()=>{q(!0),W("Creating Report..."),re==null||re({role:"system",type:"loading",content:"Creating lab report..."});try{if(!n)throw new Error("Missing patient ID.");const De=[],Ve=ye.tests||[];for(const wn of Ve){let Tt;if(wn.id?Tt=v.find(Ct=>String(Ct.id)===String(wn.id)):wn.name&&(Tt=Gm(wn.name,v)),!Tt)throw new Error(`Lab test "${wn.name}" not found.`);wn._matchedTest=Tt,De.push({id:Tt.id,name:Tt.name,price:Number(Tt.price)})}const ot=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:De,status:"reported"})});if(!ot.ok)throw new Error("Lab order creation failed during report generation.");const mt=await ot.json(),Nt=mt.labOrder.id,cn={};if(Ve.forEach(wn=>{const Tt=wn._matchedTest,Ct=Tt.id,Yt=wn.parameters||[],It={};Tt.default_parameters&&Tt.default_parameters.forEach(Kn=>{Kn.defaultValue!==void 0&&Kn.defaultValue!==null&&(It[Kn.name]=Kn.defaultValue)}),Yt.forEach(Kn=>{Kn.name&&Kn.value!==void 0&&(It[Kn.name]=Kn.value)}),cn[Ct]=It}),!(await ge(`/api/lab/${Nt}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(cn)})})).ok)throw new Error("Report submission failed.");return W("Report Created!"),D(n),me(n),re==null||re({role:"system",type:"success",content:"Lab report created successfully."}),{success:!0,actionType:Oe,data:mt.labOrder,undoData:{orderId:Nt}}}catch(De){return re==null||re({role:"system",type:"error",content:`Lab report failed: ${De.message}`}),{success:!1,actionType:Oe,error:De,originalActionPayload:ye}}finally{q(!1)}})()):Oe==="edit_lab_report"?Le.push((async()=>{q(!0),W("Updating Report...");try{const De=ye.serialNumber;if(!De)throw new Error("Missing serial number for lab report edit.");const Ve=new Map;(f??[]).forEach(Yt=>Ve.set(Yt.id,{...Yt})),(u??[]).forEach(Yt=>{if(Ve.has(Yt.id)){const It=Ve.get(Yt.id);It.report=Yt,It.status=Yt.status}else Ve.set(Yt.id,{...Yt,createdAt:Yt.createdAt})});const ot=Array.from(Ve.values());ot.sort((Yt,It)=>new Date(It.createdAt).getTime()-new Date(Yt.createdAt).getTime());const mt=ot.length-De,Nt=ot[mt];if(!Nt)throw new Error(`Lab report #${De} not found.`);const cn=Nt.id;let fn={};if(Nt.report&&Nt.report.report_content)try{fn=typeof Nt.report.report_content=="string"?JSON.parse(Nt.report.report_content):Nt.report.report_content}catch{}const wn={...fn};if((ye.tests||[]).forEach(Yt=>{let Kn=(Nt.tests||[]).find(An=>An.name.toLowerCase()===Yt.name.toLowerCase());if(!Kn)return;const Yr=Kn.id,hr=Yt.parameters||[];wn[Yr]||(wn[Yr]={}),hr.forEach(An=>{An.name&&An.value!==void 0&&(wn[Yr][An.name]=An.value)})}),!(await ge(`/api/lab/${cn}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(wn)})})).ok)throw new Error("Report update failed.");return W("Report Updated!"),D(n),me(n),re==null||re({role:"system",type:"success",content:"Lab report updated successfully."}),{success:!0,actionType:Oe,data:{orderId:cn},undoData:{orderId:cn}}}catch(De){return re==null||re({role:"system",type:"error",content:`Update report failed: ${De.message}`}),{success:!1,actionType:Oe,error:De,originalActionPayload:ye}}finally{q(!1)}})()):Oe==="edit_pharmacy_order"?Le.push((async()=>{L(!0);try{const De=ye.serialNumber;let Ve;if(De?Ve=[...g].sort((Ct,Yt)=>new Date(Ct.date).getTime()-new Date(Yt.date).getTime())[De-1]:Ve=g.find(Tt=>Tt.status==="pending"),!Ve)throw new Error("Order to edit not found.");const ot=JSON.parse(JSON.stringify(Ve));let mt=[...Ve.medications];const Nt=ye.items_to_remove,cn=ye.items;if(Array.isArray(Nt)&&(mt=mt.filter(Tt=>!Nt.some(Ct=>Ct.drug_id&&String(Tt.drug_id)===String(Ct.drug_id)||Ct.name&&Tt.name.toLowerCase()===Ct.name.toLowerCase()))),Array.isArray(cn))for(const Tt of cn){let Ct;if(Tt.drug_id?Ct=b.find(Kn=>String(Kn.id)===String(Tt.drug_id)):Tt.name&&(Ct=Gm(Tt.name,b)),!Ct)throw new Error(`Drug ${Tt.name} not found.`);const Yt=mt.findIndex(Kn=>Kn.drug_id===String(Ct==null?void 0:Ct.id)),It={drug_id:String(Ct.id),name:Ct.name,pack_quantity:Tt.pack_quantity||0,loose_quantity:Tt.loose_quantity||0,pack_price:Number(Ct.mrp),loose_price:0,total_price:0,price:Number(Ct.mrp)};Yt>=0?mt[Yt]={...mt[Yt],...It}:mt.push(It)}const fn={items:mt,status:ye.status,prescription_for_unavailable_drugs:ye.prescription_for_unavailable_drugs,order_total:0};if(!(await ge(`/api/pharmacy-orders/${Ve.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(fn)})).ok)throw new Error("Order edit failed.");return he(n),{success:!0,actionType:Oe,undoData:{orderId:Ve.id,originalState:ot}}}catch(De){return{success:!1,actionType:Oe,error:De,originalActionPayload:ye}}finally{L(!1)}})()):Oe==="edit_lab_order"?Le.push((async()=>{q(!0);try{const De=f.sort((Nt,cn)=>new Date(cn.createdAt).getTime()-new Date(Nt.createdAt).getTime()).find(Nt=>Nt.status==="pending");if(!De)throw new Error("No pending lab order to edit.");const Ve=JSON.parse(JSON.stringify(De)),ot={tests:[],status:ye.status};if(!(await ge(`/api/lab/orders/${De.id}`,{method:"PUT",body:JSON.stringify(ot),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Lab edit failed.");return D(n),{success:!0,actionType:Oe,undoData:{orderId:De.id,originalState:Ve}}}catch(De){return{success:!1,actionType:Oe,error:De,originalActionPayload:ye}}finally{q(!1)}})()):Oe==="add_complaint_history"?Le.push((async()=>{I(!0),re==null||re({role:"system",type:"loading",content:"Updating complaint history..."});const De=S;try{if(!e)throw new Error("No record ID.");if(!(await ge(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({complaint:ye.complaint}),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Complaint update failed.");return k(ye.complaint),n&&Ce(n),re==null||re({role:"system",type:"success",content:"Complaint history updated."}),{success:!0,actionType:Oe,undoData:{recordId:e,originalComplaint:De}}}catch(Ve){return re==null||re({role:"system",type:"error",content:`Complaint history update failed: ${Ve.message}`}),{success:!1,actionType:Oe,error:Ve,originalActionPayload:ye}}finally{I(!1)}})()):Oe==="update_case_summary"?Le.push((async()=>{V(!0),re==null||re({role:"system",type:"loading",content:"Updating case summary..."});const De=r;try{if(!e)throw new Error("No record ID.");const Ve=await ge(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({case_summary:ye.summary}),headers:{"Content-Type":"application/json"}});if(!Ve.ok)throw new Error("Summary update failed.");const ot=await Ve.json();return ie(ot.case_summary),re==null||re({role:"system",type:"success",content:"Case summary updated."}),{success:!0,actionType:Oe,undoData:{recordId:e,originalSummary:De}}}catch(Ve){return re==null||re({role:"system",type:"error",content:`Case summary update failed: ${Ve.message}`}),{success:!1,actionType:Oe,error:Ve,originalActionPayload:ye}}finally{V(!1)}})()):Oe==="end_task"?Le.push((async()=>(re==null||re({role:"system",type:"success",content:"Task completed."}),{success:!0,actionType:Oe}))()):(console.warn(`Unknown action ${Oe}`),Le.push(Promise.resolve({success:!1,actionType:Oe,error:new Error(`Unknown action: ${Oe}`),originalActionPayload:ye})))}const St=await Promise.all(Le),we=St.filter(ye=>!ye.success);if(we.length>0){console.log("AI Actions Failed. Initiating Rollback...",we);const ye=St.filter(mt=>mt.success),Oe=[...ye].reverse();await Ze(Oe);const De=we.map(mt=>{var Nt;return`${mt.actionType}: ${(Nt=mt.error)==null?void 0:Nt.message}`}).join("; "),Ve=ye.length>0?` I successfully rolled back ${ye.length} other actions that succeeded.`:"",ot=`One or more actions failed: [${De}].${Ve} Please analyze the failure and try again.`;await at("multiple_actions",{message:ot},je,Ge)}else{const ye=St.filter(Oe=>Oe.success);if(ye.length>0&&(Ie(ye),He&&ye.forEach(Oe=>He(Oe.actionType))),tt&&typeof tt.question=="string")ne(tt.question),le(Array.isArray(tt.options)?tt.options:[]);else if(!xt)throw new Error("AI response did not result in a recognized or performed function call.")}}catch(G){await at("parse_json_actions",G,je,Ge)}else throw new Error("AI response did not contain a recognized function call.")};Ye=async(je,Ge=0)=>{if(Ge>1){$("AI call failed after multiple retries. Please try a different prompt."),z(!1);return}z(!0),$(null);let _e;const ce=[...l,je].join(`

`);try{const G=new Map;(f??[]).forEach(we=>{G.set(we.id,{...we})}),(u??[]).forEach(we=>{if(!G.has(we.id))G.set(we.id,{id:we.id,patient_id:we.patient_id,tests:we.tests,status:we.status,createdAt:we.createdAt,report:we});else{const ye=G.get(we.id);ye&&(ye.report=we,ye.status=we.status)}});const fe=Array.from(G.values());fe.sort((we,ye)=>new Date(ye.createdAt).getTime()-new Date(we.createdAt).getTime());const Ne=fe.map((we,ye)=>{let Oe=null;if(we.report)try{const De=typeof we.report.report_content=="string"?we.report.report_content:JSON.stringify(we.report.report_content||{}),Ve=JSON.parse(De||"{}"),ot=(we.report.tests||[]).map(mt=>{const Nt=Ve[mt.id]||{},cn=fn=>({name:fn.name,value:Nt[fn.name]!==void 0?String(Nt[fn.name]):String(fn.defaultValue),normal_range:fn.normal_range||"N/A"});return{testId:mt.id,testName:mt.name,parameters:(mt.default_parameters||[]).map(cn)}});Oe={reportId:we.report.reportId,reportDate:we.report.report_date,tests:ot}}catch{Oe={reportId:we.report.reportId,reportDate:we.report.report_date,reportContent:typeof we.report.report_content=="string"?we.report.report_content:JSON.stringify(we.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:fe.length-ye,orderId:we.id,orderDate:isNaN(new Date(we.createdAt).getTime())?we.createdAt:new Date(we.createdAt).toISOString(),tests:we.tests.map(De=>({id:De.id,name:De.name,price:De.price})),status:we.status,report:Oe}}),Le=h.map(we=>{try{return{...we,createdAt:isNaN(new Date(we.createdAt).getTime())?we.createdAt:new Date(we.createdAt).toISOString()}}catch{return we}}),xt=[...g].sort((we,ye)=>{const Oe=new Date(we.date).getTime(),De=new Date(ye.date).getTime();return Oe-De}).map((we,ye)=>{try{return{serialNumber:ye+1,...we,date:we.date&&!isNaN(new Date(we.date).getTime())?new Date(we.date).toISOString():we.date}}catch{return{serialNumber:ye+1,...we}}}),St={query:ce,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(o==null?void 0:o.aiMemory)||"",clinic_ai_memory_last_updated:o!=null&&o.aiMemoryUpdatedAt?new Date(o.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(o==null?void 0:o.clinicWideSystemPrompt)||"",labHistory:Ne,pharmacyOrders:xt,pastComplaints:Le,pharmacyInventory:b,labInventory:v};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(St,null,2)),_e=await aK(St,d),_e){T(_e),re==null||re({role:"ai",content:_e});const we=/```json\s*([\s\S]*?)\s*```/,ye=_e.match(we);if(ye&&ye[1])P(_e.replace(we,"").trim()),M(ye[1].trim());else{const Oe=_e.trim();if(Oe.startsWith("{")&&Oe.endsWith("}"))try{JSON.parse(Oe),P(""),M(Oe)}catch{P(Oe),M(null)}else if(Oe.startsWith("[")&&Oe.endsWith("]"))try{JSON.parse(Oe),P(""),M(Oe)}catch{P(Oe),M(null)}else P(Oe),M(null)}R(!1),n&&_e&&await yt(n,_e),await st(_e,Ge),k("")}else throw new Error("Invalid AI response format.")}catch(G){await at("call_generative_api",G,_e,Ge)}finally{z(!1)}};const yt=async(je,Ge)=>{E(!0),de(null);try{const _e={ai_response:Ge},pe=await ge(`/api/patients/${je}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(_e)});if(!pe.ok){const ce=await pe.json().catch(()=>({}));throw new Error(ce.message||`Failed to save AI response to patient: ${pe.statusText}`)}}catch(_e){de(`AI Response Save Error: ${_e.message}`),re==null||re({role:"system",type:"error",content:`AI Response Save Error: ${_e.message}`})}finally{E(!1)}};return w.useImperativeHandle(Be,()=>({callGenerativeApi:Ye,undoLastAction:Ke})),null}),lK={};function cS(e,n){const t=lK,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return ME(e,r,a)}function ME(e,n,t){if(cK(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return aj(e.children,n,t)}return Array.isArray(e)?aj(e,n,t):""}function aj(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=ME(e[a],n,t);return r.join("")}function cK(e){return!!(e&&typeof e=="object")}const sj=document.createElement("i");function uS(e){const n="&"+e+";";sj.innerHTML=n;const t=sj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function ol(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function vs(e,n){return e.length>0?(ol(e,e.length,0,n),e):n}const oj={}.hasOwnProperty;function uK(e){const n={};let t=-1;for(;++t<e.length;)dK(n,e[t]);return n}function dK(e,n){let t;for(t in n){const a=(oj.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){oj.call(a,l)||(a[l]=[]);const d=o[l];fK(a[l],Array.isArray(d)?d:d?[d]:[])}}}function fK(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);ol(e,0,0,r)}function OE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Rh(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const nl=yu(/[A-Za-z]/),Va=yu(/[\dA-Za-z]/),hK=yu(/[#-'*+\--9=?A-Z^-~]/);function Z1(e){return e!==null&&(e<32||e===127)}const ew=yu(/\d/),pK=yu(/[\dA-Fa-f]/),mK=yu(/[!-/:-@[-`{-~]/);function Ht(e){return e!==null&&e<-2}function ma(e){return e!==null&&(e<0||e===32)}function $n(e){return e===-2||e===-1||e===32}const gK=yu(new RegExp("\\p{P}|\\p{S}","u")),yK=yu(/\s/);function yu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function np(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Va(e.charCodeAt(t+1))&&Va(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function ur(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return $n(f)?(e.enter(t),d(f)):n(f)}function d(f){return $n(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const xK={tokenize:bK};function bK(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),ur(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Ht(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const vK={tokenize:wK},lj={tokenize:SK};function wK(e){const n=this,t=[];let r=0,a,o,l;return d;function d(R){if(r<t.length){const z=t[r];return n.containerState=z[1],e.attempt(z[0].continuation,f,u)(R)}return u(R)}function f(R){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const z=n.events.length;let $=z,L;for(;$--;)if(n.events[$][0]==="exit"&&n.events[$][1].type==="chunkFlow"){L=n.events[$][1].end;break}P(r);let B=z;for(;B<n.events.length;)n.events[B][1].end={...L},B++;return ol(n.events,$+1,0,n.events.slice(z)),n.events.length=B,u(R)}return d(R)}function u(R){if(r===t.length){if(!a)return b(R);if(a.currentConstruct&&a.currentConstruct.concrete)return S(R);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(lj,h,g)(R)}function h(R){return a&&M(),P(r),b(R)}function g(R){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(R)}function b(R){return n.containerState={},e.attempt(lj,v,S)(R)}function v(R){return r++,t.push([n.currentConstruct,n.containerState]),b(R)}function S(R){if(R===null){a&&M(),P(0),e.consume(R);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(R)}function k(R){if(R===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(R);return}return Ht(R)?(e.consume(R),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(R),k)}function T(R,z){const $=n.sliceStream(R);if(z&&$.push(null),R.previous=o,o&&(o.next=R),o=R,a.defineSkip(R.start),a.write($),n.parser.lazy[R.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const B=n.events.length;let q=B,W,I;for(;q--;)if(n.events[q][0]==="exit"&&n.events[q][1].type==="chunkFlow"){if(W){I=n.events[q][1].end;break}W=!0}for(P(r),L=B;L<n.events.length;)n.events[L][1].end={...I},L++;ol(n.events,q+1,0,n.events.slice(B)),n.events.length=L}}function P(R){let z=t.length;for(;z-- >R;){const $=t[z];n.containerState=$[1],$[0].exit.call(n,e)}t.length=R}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function SK(e,n,t){return ur(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Sb(e){if(e===null||ma(e)||yK(e))return 1;if(gK(e))return 2}function dS(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const tw={name:"attention",resolveAll:NK,tokenize:CK};function NK(e,n){let t=-1,r,a,o,l,d,f,u,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};cj(g,-f),cj(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=vs(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=vs(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=vs(u,dS(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=vs(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,u=vs(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,ol(e,r-1,t-r+3,u),t=r+u.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function CK(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Sb(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),h=Sb(f),g=!h||h===2&&a||t.includes(f),b=!a||a===2&&h||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(h||!g)),n(f)}}function cj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const _K={name:"autolink",tokenize:jK};function jK(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return nl(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Va(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||Va(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||Z1(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),h):hK(v)?(e.consume(v),u):t(v)}function h(v){return Va(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Va(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const tv={partial:!0,tokenize:kK};function kK(e,n,t){return r;function r(o){return $n(o)?ur(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Ht(o)?n(o):t(o)}}const LE={continuation:{tokenize:EK},exit:AK,name:"blockQuote",tokenize:TK};function TK(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return $n(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function EK(e,n,t){const r=this;return a;function a(l){return $n(l)?ur(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(LE,n,t)(l)}}function AK(e){e.exit("blockQuote")}const FE={name:"characterEscape",tokenize:PK};function PK(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return mK(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const $E={name:"characterReference",tokenize:DK};function DK(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Va,h(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=pK,h):(e.enter("characterReferenceValue"),o=7,l=ew,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Va&&!uS(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),h):t(g)}}const uj={partial:!0,tokenize:RK},dj={concrete:!0,name:"codeFenced",tokenize:IK};function IK(e,n,t){const r=this,a={partial:!0,tokenize:$};let o=0,l=0,d;return f;function f(L){return u(L)}function u(L){const B=r.events[r.events.length-1];return o=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,d=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(L)}function h(L){return L===d?(l++,e.consume(L),h):l<3?t(L):(e.exit("codeFencedFenceSequence"),$n(L)?ur(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Ht(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(uj,k,z)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Ht(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):$n(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ur(e,v,"whitespace")(L)):L===96&&L===d?t(L):(e.consume(L),b)}function v(L){return L===null||Ht(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Ht(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===d?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,z,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),P}function P(L){return o>0&&$n(L)?ur(e,M,"linePrefix",o+1)(L):M(L)}function M(L){return L===null||Ht(L)?e.check(uj,k,z)(L):(e.enter("codeFlowValue"),R(L))}function R(L){return L===null||Ht(L)?(e.exit("codeFlowValue"),M(L)):(e.consume(L),R)}function z(L){return e.exit("codeFenced"),n(L)}function $(L,B,q){let W=0;return I;function I(Y){return L.enter("lineEnding"),L.consume(Y),L.exit("lineEnding"),F}function F(Y){return L.enter("codeFencedFence"),$n(Y)?ur(L,V,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Y):V(Y)}function V(Y){return Y===d?(L.enter("codeFencedFenceSequence"),ee(Y)):q(Y)}function ee(Y){return Y===d?(W++,L.consume(Y),ee):W>=l?(L.exit("codeFencedFenceSequence"),$n(Y)?ur(L,ie,"whitespace")(Y):ie(Y)):q(Y)}function ie(Y){return Y===null||Ht(Y)?(L.exit("codeFencedFence"),B(Y)):q(Y)}}}function RK(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const Y0={name:"codeIndented",tokenize:OK},MK={partial:!0,tokenize:LK};function OK(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),ur(e,o,"linePrefix",5)(u)}function o(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Ht(u)?e.attempt(MK,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Ht(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function LK(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Ht(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):ur(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Ht(l)?a(l):t(l)}}const FK={name:"codeText",previous:zK,resolve:$K,tokenize:BK};function $K(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function zK(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function BK(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,h(g)):Ht(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Ht(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}class UK{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Bm(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Bm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Bm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Bm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Bm(this.left,t.reverse())}}}function Bm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function zE(e){const n={};let t=-1,r,a,o,l,d,f,u;const h=new UK(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,qK(h,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=h.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},d=h.slice(a,t),d.unshift(r),h.splice(a,t-a+1,d))}}return ol(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function qK(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let h,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const VK={resolve:GK,tokenize:YK},HK={partial:!0,tokenize:WK};function GK(e){return zE(e),e}function YK(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Ht(d)?e.check(HK,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function WK(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),ur(e,o,"linePrefix")}function o(l){if(l===null||Ht(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function BE(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let h=0;return g;function g(P){return P===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||Z1(P)?t(P):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||Ht(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!h&&(P===null||P===41||ma(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(P)):h<u&&P===40?(e.consume(P),h++,k):P===41?(e.consume(P),h--,k):P===null||P===32||P===40||Z1(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function UE(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),h}function h(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Ht(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Ht(v)||d++>999?(e.exit("chunkString"),h(v)):(e.consume(v),f||(f=!$n(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function qE(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Ht(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),ur(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||Ht(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function Jm(e,n){let t;return r;function r(a){return Ht(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):$n(a)?ur(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const QK={name:"definition",tokenize:KK},JK={partial:!0,tokenize:XK};function KK(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return UE.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=Rh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return ma(v)?Jm(e,u)(v):u(v)}function u(v){return BE(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(JK,g,g)(v)}function g(v){return $n(v)?ur(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Ht(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function XK(e,n,t){return r;function r(d){return ma(d)?Jm(e,a)(d):t(d)}function a(d){return qE(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return $n(d)?ur(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Ht(d)?n(d):t(d)}}const ZK={name:"hardBreakEscape",tokenize:eX};function eX(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Ht(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const tX={name:"headingAtx",resolve:nX,tokenize:rX};function nX(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},ol(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function rX(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),o(h)}function o(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||ma(h)?(e.exit("atxHeadingSequence"),d(h)):t(h)}function d(h){return h===35?(e.enter("atxHeadingSequence"),f(h)):h===null||Ht(h)?(e.exit("atxHeading"),n(h)):$n(h)?ur(e,d,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function f(h){return h===35?(e.consume(h),f):(e.exit("atxHeadingSequence"),d(h))}function u(h){return h===null||h===35||ma(h)?(e.exit("atxHeadingText"),d(h)):(e.consume(h),u)}}const iX=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],fj=["pre","script","style","textarea"],aX={concrete:!0,name:"htmlFlow",resolveTo:lX,tokenize:cX},sX={partial:!0,tokenize:dX},oX={partial:!0,tokenize:uX};function lX(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function cX(e,n,t){const r=this;let a,o,l,d,f;return u;function u(D){return h(D)}function h(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,r.interrupt?n:E):nl(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):nl(D)?(e.consume(D),a=4,r.interrupt?n:E):t(D)}function v(D){return D===45?(e.consume(D),r.interrupt?n:E):t(D)}function S(D){const me="CDATA[";return D===me.charCodeAt(d++)?(e.consume(D),d===me.length?r.interrupt?n:V:S):t(D)}function k(D){return nl(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||ma(D)){const me=D===47,Ce=l.toLowerCase();return!me&&!o&&fj.includes(Ce)?(a=1,r.interrupt?n(D):V(D)):iX.includes(l.toLowerCase())?(a=6,me?(e.consume(D),P):r.interrupt?n(D):V(D)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(D):o?M(D):R(D))}return D===45||Va(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),r.interrupt?n:V):t(D)}function M(D){return $n(D)?(e.consume(D),M):I(D)}function R(D){return D===47?(e.consume(D),I):D===58||D===95||nl(D)?(e.consume(D),z):$n(D)?(e.consume(D),R):I(D)}function z(D){return D===45||D===46||D===58||D===95||Va(D)?(e.consume(D),z):$(D)}function $(D){return D===61?(e.consume(D),L):$n(D)?(e.consume(D),$):R(D)}function L(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,B):$n(D)?(e.consume(D),L):q(D)}function B(D){return D===f?(e.consume(D),f=null,W):D===null||Ht(D)?t(D):(e.consume(D),B)}function q(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||ma(D)?$(D):(e.consume(D),q)}function W(D){return D===47||D===62||$n(D)?R(D):t(D)}function I(D){return D===62?(e.consume(D),F):t(D)}function F(D){return D===null||Ht(D)?V(D):$n(D)?(e.consume(D),F):t(D)}function V(D){return D===45&&a===2?(e.consume(D),Q):D===60&&a===1?(e.consume(D),ne):D===62&&a===4?(e.consume(D),de):D===63&&a===3?(e.consume(D),E):D===93&&a===5?(e.consume(D),oe):Ht(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(sX,he,ee)(D)):D===null||Ht(D)?(e.exit("htmlFlowData"),ee(D)):(e.consume(D),V)}function ee(D){return e.check(oX,ie,he)(D)}function ie(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),Y}function Y(D){return D===null||Ht(D)?ee(D):(e.enter("htmlFlowData"),V(D))}function Q(D){return D===45?(e.consume(D),E):V(D)}function ne(D){return D===47?(e.consume(D),l="",le):V(D)}function le(D){if(D===62){const me=l.toLowerCase();return fj.includes(me)?(e.consume(D),de):V(D)}return nl(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),le):V(D)}function oe(D){return D===93?(e.consume(D),E):V(D)}function E(D){return D===62?(e.consume(D),de):D===45&&a===2?(e.consume(D),E):V(D)}function de(D){return D===null||Ht(D)?(e.exit("htmlFlowData"),he(D)):(e.consume(D),de)}function he(D){return e.exit("htmlFlow"),n(D)}}function uX(e,n,t){const r=this;return a;function a(l){return Ht(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function dX(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(tv,n,t)}}const fX={name:"htmlText",tokenize:hX};function hX(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),$):E===63?(e.consume(E),R):nl(E)?(e.consume(E),q):t(E)}function u(E){return E===45?(e.consume(E),h):E===91?(e.consume(E),o=0,S):nl(E)?(e.consume(E),M):t(E)}function h(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Ht(E)?(l=g,ne(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?Q(E):E===45?b(E):g(E)}function S(E){const de="CDATA[";return E===de.charCodeAt(o++)?(e.consume(E),o===de.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Ht(E)?(l=k,ne(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),P):k(E)}function P(E){return E===62?Q(E):E===93?(e.consume(E),P):k(E)}function M(E){return E===null||E===62?Q(E):Ht(E)?(l=M,ne(E)):(e.consume(E),M)}function R(E){return E===null?t(E):E===63?(e.consume(E),z):Ht(E)?(l=R,ne(E)):(e.consume(E),R)}function z(E){return E===62?Q(E):R(E)}function $(E){return nl(E)?(e.consume(E),L):t(E)}function L(E){return E===45||Va(E)?(e.consume(E),L):B(E)}function B(E){return Ht(E)?(l=B,ne(E)):$n(E)?(e.consume(E),B):Q(E)}function q(E){return E===45||Va(E)?(e.consume(E),q):E===47||E===62||ma(E)?W(E):t(E)}function W(E){return E===47?(e.consume(E),Q):E===58||E===95||nl(E)?(e.consume(E),I):Ht(E)?(l=W,ne(E)):$n(E)?(e.consume(E),W):Q(E)}function I(E){return E===45||E===46||E===58||E===95||Va(E)?(e.consume(E),I):F(E)}function F(E){return E===61?(e.consume(E),V):Ht(E)?(l=F,ne(E)):$n(E)?(e.consume(E),F):W(E)}function V(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,ee):Ht(E)?(l=V,ne(E)):$n(E)?(e.consume(E),V):(e.consume(E),ie)}function ee(E){return E===a?(e.consume(E),a=void 0,Y):E===null?t(E):Ht(E)?(l=ee,ne(E)):(e.consume(E),ee)}function ie(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||ma(E)?W(E):(e.consume(E),ie)}function Y(E){return E===47||E===62||ma(E)?W(E):t(E)}function Q(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function ne(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),le}function le(E){return $n(E)?ur(e,oe,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):oe(E)}function oe(E){return e.enter("htmlTextData"),l(E)}}const fS={name:"labelEnd",resolveAll:yX,resolveTo:xX,tokenize:bX},pX={tokenize:vX},mX={tokenize:wX},gX={tokenize:SX};function yX(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&ol(e,0,e.length,t),e}function xX(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=vs(d,e.slice(o+1,o+r+3)),d=vs(d,[["enter",h,n]]),d=vs(d,dS(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=vs(d,[["exit",h,n],e[l-2],e[l-1],["exit",u,n]]),d=vs(d,e.slice(l+1)),d=vs(d,[["exit",f,n]]),ol(e,o,e.length,d),e}function bX(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(Rh(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(pX,h,l?h:g)(b):b===91?e.attempt(mX,h,l?u:g)(b):l?h(b):g(b)}function u(b){return e.attempt(gX,h,g)(b)}function h(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function vX(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return ma(g)?Jm(e,o)(g):o(g)}function o(g){return g===41?h(g):BE(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return ma(g)?Jm(e,f)(g):h(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?qE(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function u(g){return ma(g)?Jm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function wX(e,n,t){const r=this;return a;function a(d){return UE.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes(Rh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function SX(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const NX={name:"labelStartImage",resolveAll:fS.resolveAll,tokenize:CX};function CX(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const _X={name:"labelStartLink",resolveAll:fS.resolveAll,tokenize:jX};function jX(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const W0={name:"lineEnding",tokenize:kX};function kX(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),ur(e,n,"linePrefix")}}const eb={name:"thematicBreak",tokenize:TX};function TX(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Ht(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),$n(u)?ur(e,d,"whitespace")(u):d(u))}}const fa={continuation:{tokenize:DX},exit:RX,name:"list",tokenize:PX},EX={partial:!0,tokenize:MX},AX={partial:!0,tokenize:IX};function PX(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:ew(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(eb,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return ew(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(tv,r.interrupt?t:h,e.attempt(EX,b,g))}function h(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return $n(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function DX(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(tv,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,ur(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!$n(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(AX,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,ur(e,e.attempt(fa,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function IX(e,n,t){const r=this;return ur(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function RX(e){e.exit(this.containerState.type)}function MX(e,n,t){const r=this;return ur(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!$n(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const hj={name:"setextUnderline",resolveTo:OX,tokenize:LX};function OX(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function LX(e,n,t){const r=this;let a;return o;function o(u){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),$n(u)?ur(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Ht(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const FX={tokenize:$X};function $X(e){const n=this,t=e.attempt(tv,r,e.attempt(this.parser.constructs.flowInitial,a,ur(e,e.attempt(this.parser.constructs.flow,a,e.attempt(VK,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const zX={resolveAll:HE()},BX=VE("string"),UX=VE("text");function VE(e){return{resolveAll:HE(e==="text"?qX:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(h){return u(h)?o(h):d(h)}function d(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),f}function f(h){return u(h)?(t.exit("data"),o(h)):(t.consume(h),f)}function u(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function HE(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function qX(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const VX={42:fa,43:fa,45:fa,48:fa,49:fa,50:fa,51:fa,52:fa,53:fa,54:fa,55:fa,56:fa,57:fa,62:LE},HX={91:QK},GX={[-2]:Y0,[-1]:Y0,32:Y0},YX={35:tX,42:eb,45:[hj,eb],60:aX,61:hj,95:eb,96:dj,126:dj},WX={38:$E,92:FE},QX={[-5]:W0,[-4]:W0,[-3]:W0,33:NX,38:$E,42:tw,60:[_K,fX],91:_X,92:[ZK,FE],93:fS,95:tw,96:FK},JX={null:[tw,zX]},KX={null:[42,95]},XX={null:[]},ZX=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:KX,contentInitial:HX,disable:XX,document:VX,flow:YX,flowInitial:GX,insideSpan:JX,string:WX,text:QX},Symbol.toStringTag,{value:"Module"}));function eZ(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:B($),check:B(L),consume:M,enter:R,exit:z,interrupt:B(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(F){return l=vs(l,F),T(),l[l.length-1]!==null?[]:(q(n,0),u.events=dS(o,u.events,u),u.events)}function b(F,V){return nZ(v(F),V)}function v(F){return tZ(l,F)}function S(){const{_bufferIndex:F,_index:V,line:ee,column:ie,offset:Y}=r;return{_bufferIndex:F,_index:V,line:ee,column:ie,offset:Y}}function k(F){a[F.line]=F.column,I()}function T(){let F;for(;r._index<l.length;){const V=l[r._index];if(typeof V=="string")for(F=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===F&&r._bufferIndex<V.length;)P(V.charCodeAt(r._bufferIndex));else P(V)}}function P(F){h=h(F)}function M(F){Ht(F)?(r.line++,r.column=1,r.offset+=F===-3?2:1,I()):F!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=F}function R(F,V){const ee=V||{};return ee.type=F,ee.start=S(),u.events.push(["enter",ee,u]),d.push(ee),ee}function z(F){const V=d.pop();return V.end=S(),u.events.push(["exit",V,u]),V}function $(F,V){q(F,V.from)}function L(F,V){V.restore()}function B(F,V){return ee;function ee(ie,Y,Q){let ne,le,oe,E;return Array.isArray(ie)?he(ie):"tokenize"in ie?he([ie]):de(ie);function de(te){return K;function K(J){const xe=J!==null&&te[J],He=J!==null&&te.null,re=[...Array.isArray(xe)?xe:xe?[xe]:[],...Array.isArray(He)?He:He?[He]:[]];return he(re)(J)}}function he(te){return ne=te,le=0,te.length===0?Q:D(te[le])}function D(te){return K;function K(J){return E=W(),oe=te,te.partial||(u.currentConstruct=te),te.name&&u.parser.constructs.disable.null.includes(te.name)?Ce():te.tokenize.call(V?Object.assign(Object.create(u),V):u,f,me,Ce)(J)}}function me(te){return F(oe,E),Y}function Ce(te){return E.restore(),++le<ne.length?D(ne[le]):Q}}}function q(F,V){F.resolveAll&&!o.includes(F)&&o.push(F),F.resolve&&ol(u.events,V,u.events.length-V,F.resolve(u.events.slice(V),u)),F.resolveTo&&(u.events=F.resolveTo(u.events,u))}function W(){const F=S(),V=u.previous,ee=u.currentConstruct,ie=u.events.length,Y=Array.from(d);return{from:ie,restore:Q};function Q(){r=F,u.previous=V,u.currentConstruct=ee,u.events.length=ie,d=Y,I()}}function I(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function tZ(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function nZ(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function rZ(e){const r={constructs:uK([ZX,...(e||{}).extensions||[]]),content:a(xK),defined:[],document:a(vK),flow:a(FX),lazy:{},string:a(BX),text:a(UX)};return r;function a(o){return l;function l(d){return eZ(r,o,d)}}}function iZ(e){for(;!zE(e););return e}const pj=/[\0\t\n\r]/g;function aZ(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,h,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(pj.lastIndex=g,u=pj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,f.push(-2);e++<h;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const sZ=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function GE(e){return e.replace(sZ,oZ)}function oZ(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return OE(t.slice(o?2:1),o?16:10)}return uS(t)||e}function Km(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?mj(e.position):"start"in e||"end"in e?mj(e):"line"in e||"column"in e?nw(e):""}function nw(e){return gj(e&&e.line)+":"+gj(e&&e.column)}function mj(e){return nw(e&&e.start)+"-"+nw(e&&e.end)}function gj(e){return e&&typeof e=="number"?e:1}const YE={}.hasOwnProperty;function lZ(e,n,t){return typeof n!="string"&&(t=n,n=void 0),cZ(t)(iZ(rZ(t).document().write(aZ()(e,n,!0))))}function cZ(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(st),autolinkProtocol:W,autolinkEmail:W,atxHeading:o(Ye),blockQuote:o(He),characterEscape:W,characterReference:W,codeFenced:o(re),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(re,l),codeText:o(Be,l),codeTextData:W,data:W,codeFlowValue:W,definition:o(Ae),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Ie),hardBreakEscape:o(at),hardBreakTrailing:o(at),htmlFlow:o(Ze,l),htmlFlowData:W,htmlText:o(Ze,l),htmlTextData:W,image:o(Ke),label:l,link:o(st),listItem:o(je),listItemValue:b,listOrdered:o(yt,g),listUnordered:o(yt),paragraph:o(Ge),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(Ye),strong:o(_e),thematicBreak:o(ce)},exit:{atxHeading:f(),atxHeadingSequence:$,autolink:f(),autolinkEmail:xe,autolinkProtocol:J,blockQuote:f(),characterEscapeValue:I,characterReferenceMarkerHexadecimal:Ce,characterReferenceMarkerNumeric:Ce,characterReferenceValue:te,characterReference:K,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:I,codeIndented:f(P),codeText:f(Y),codeTextData:I,data:I,definition:f(),definitionDestinationString:z,definitionLabelString:M,definitionTitleString:R,emphasis:f(),hardBreakEscape:f(V),hardBreakTrailing:f(V),htmlFlow:f(ee),htmlFlowData:I,htmlText:f(ie),htmlTextData:I,image:f(ne),label:oe,labelText:le,lineEnding:F,link:f(Q),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:me,resourceDestinationString:E,resourceTitleString:de,resource:he,setextHeading:f(q),setextHeadingLineSequence:B,setextHeadingText:L,strong:f(),thematicBreak:f()}};WE(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(G){let fe={type:"root",children:[]};const Ne={stack:[fe],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:h,data:t},Le=[];let tt=-1;for(;++tt<G.length;)if(G[tt][1].type==="listOrdered"||G[tt][1].type==="listUnordered")if(G[tt][0]==="enter")Le.push(tt);else{const xt=Le.pop();tt=a(G,xt,tt)}for(tt=-1;++tt<G.length;){const xt=n[G[tt][0]];YE.call(xt,G[tt][1].type)&&xt[G[tt][1].type].call(Object.assign({sliceSerialize:G[tt][2].sliceSerialize},Ne),G[tt][1])}if(Ne.tokenStack.length>0){const xt=Ne.tokenStack[Ne.tokenStack.length-1];(xt[1]||yj).call(Ne,void 0,xt[0])}for(fe.position={start:su(G.length>0?G[0][1].start:{line:1,column:1,offset:0}),end:su(G.length>0?G[G.length-2][1].end:{line:1,column:1,offset:0})},tt=-1;++tt<n.transforms.length;)fe=n.transforms[tt](fe)||fe;return fe}function a(G,fe,Ne){let Le=fe-1,tt=-1,xt=!1,St,we,ye,Oe;for(;++Le<=Ne;){const De=G[Le];switch(De[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{De[0]==="enter"?tt++:tt--,Oe=void 0;break}case"lineEndingBlank":{De[0]==="enter"&&(St&&!Oe&&!tt&&!ye&&(ye=Le),Oe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Oe=void 0}if(!tt&&De[0]==="enter"&&De[1].type==="listItemPrefix"||tt===-1&&De[0]==="exit"&&(De[1].type==="listUnordered"||De[1].type==="listOrdered")){if(St){let Ve=Le;for(we=void 0;Ve--;){const ot=G[Ve];if(ot[1].type==="lineEnding"||ot[1].type==="lineEndingBlank"){if(ot[0]==="exit")continue;we&&(G[we][1].type="lineEndingBlank",xt=!0),ot[1].type="lineEnding",we=Ve}else if(!(ot[1].type==="linePrefix"||ot[1].type==="blockQuotePrefix"||ot[1].type==="blockQuotePrefixWhitespace"||ot[1].type==="blockQuoteMarker"||ot[1].type==="listItemIndent"))break}ye&&(!we||ye<we)&&(St._spread=!0),St.end=Object.assign({},we?G[we][1].start:De[1].end),G.splice(we||Le,0,["exit",St,De[2]]),Le++,Ne++}if(De[1].type==="listItemPrefix"){const Ve={type:"listItem",_spread:!1,start:Object.assign({},De[1].start),end:void 0};St=Ve,G.splice(Le,0,["enter",Ve,De[2]]),Le++,Ne++,ye=void 0,Oe=!0}}}return G[fe][1]._spread=xt,Ne}function o(G,fe){return Ne;function Ne(Le){d.call(this,G(Le),Le),fe&&fe.call(this,Le)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(G,fe,Ne){this.stack[this.stack.length-1].children.push(G),this.stack.push(G),this.tokenStack.push([fe,Ne||void 0]),G.position={start:su(fe.start),end:void 0}}function f(G){return fe;function fe(Ne){G&&G.call(this,Ne),u.call(this,Ne)}}function u(G,fe){const Ne=this.stack.pop(),Le=this.tokenStack.pop();if(Le)Le[0].type!==G.type&&(fe?fe.call(this,G,Le[0]):(Le[1]||yj).call(this,G,Le[0]));else throw new Error("Cannot close `"+G.type+"` ("+Km({start:G.start,end:G.end})+"): its not open");Ne.position.end=su(G.end)}function h(){return cS(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(G){if(this.data.expectingFirstListItemValue){const fe=this.stack[this.stack.length-2];fe.start=Number.parseInt(this.sliceSerialize(G),10),this.data.expectingFirstListItemValue=void 0}}function v(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.lang=G}function S(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.meta=G}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G.replace(/(\r?\n|\r)$/g,"")}function M(G){const fe=this.resume(),Ne=this.stack[this.stack.length-1];Ne.label=fe,Ne.identifier=Rh(this.sliceSerialize(G)).toLowerCase()}function R(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.title=G}function z(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.url=G}function $(G){const fe=this.stack[this.stack.length-1];if(!fe.depth){const Ne=this.sliceSerialize(G).length;fe.depth=Ne}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function B(G){const fe=this.stack[this.stack.length-1];fe.depth=this.sliceSerialize(G).codePointAt(0)===61?1:2}function q(){this.data.setextHeadingSlurpLineEnding=void 0}function W(G){const Ne=this.stack[this.stack.length-1].children;let Le=Ne[Ne.length-1];(!Le||Le.type!=="text")&&(Le=pe(),Le.position={start:su(G.start),end:void 0},Ne.push(Le)),this.stack.push(Le)}function I(G){const fe=this.stack.pop();fe.value+=this.sliceSerialize(G),fe.position.end=su(G.end)}function F(G){const fe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ne=fe.children[fe.children.length-1];Ne.position.end=su(G.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(fe.type)&&(W.call(this,G),I.call(this,G))}function V(){this.data.atHardBreak=!0}function ee(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G}function ie(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G}function Y(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.value=G}function Q(){const G=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";G.type+="Reference",G.referenceType=fe,delete G.url,delete G.title}else delete G.identifier,delete G.label;this.data.referenceType=void 0}function ne(){const G=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";G.type+="Reference",G.referenceType=fe,delete G.url,delete G.title}else delete G.identifier,delete G.label;this.data.referenceType=void 0}function le(G){const fe=this.sliceSerialize(G),Ne=this.stack[this.stack.length-2];Ne.label=GE(fe),Ne.identifier=Rh(fe).toLowerCase()}function oe(){const G=this.stack[this.stack.length-1],fe=this.resume(),Ne=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ne.type==="link"){const Le=G.children;Ne.children=Le}else Ne.alt=fe}function E(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.url=G}function de(){const G=this.resume(),fe=this.stack[this.stack.length-1];fe.title=G}function he(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function me(G){const fe=this.resume(),Ne=this.stack[this.stack.length-1];Ne.label=fe,Ne.identifier=Rh(this.sliceSerialize(G)).toLowerCase(),this.data.referenceType="full"}function Ce(G){this.data.characterReferenceType=G.type}function te(G){const fe=this.sliceSerialize(G),Ne=this.data.characterReferenceType;let Le;Ne?(Le=OE(fe,Ne==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Le=uS(fe);const tt=this.stack[this.stack.length-1];tt.value+=Le}function K(G){const fe=this.stack.pop();fe.position.end=su(G.end)}function J(G){I.call(this,G);const fe=this.stack[this.stack.length-1];fe.url=this.sliceSerialize(G)}function xe(G){I.call(this,G);const fe=this.stack[this.stack.length-1];fe.url="mailto:"+this.sliceSerialize(G)}function He(){return{type:"blockquote",children:[]}}function re(){return{type:"code",lang:null,meta:null,value:""}}function Be(){return{type:"inlineCode",value:""}}function Ae(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ie(){return{type:"emphasis",children:[]}}function Ye(){return{type:"heading",depth:0,children:[]}}function at(){return{type:"break"}}function Ze(){return{type:"html",value:""}}function Ke(){return{type:"image",title:null,url:"",alt:null}}function st(){return{type:"link",title:null,url:"",children:[]}}function yt(G){return{type:"list",ordered:G.type==="listOrdered",start:null,spread:G._spread,children:[]}}function je(G){return{type:"listItem",spread:G._spread,checked:null,children:[]}}function Ge(){return{type:"paragraph",children:[]}}function _e(){return{type:"strong",children:[]}}function pe(){return{type:"text",value:""}}function ce(){return{type:"thematicBreak"}}}function su(e){return{line:e.line,column:e.column,offset:e.offset}}function WE(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?WE(e,r):uZ(e,r)}}function uZ(e,n){let t;for(t in n)if(YE.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function yj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Km({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Km({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Km({start:n.start,end:n.end})+") is still open")}function dZ(e){const n=this;n.parser=t;function t(r){return lZ(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const xj={}.hasOwnProperty;function QE(e,n){const t=n||{};function r(a,...o){let l=r.invalid;const d=r.handlers;if(a&&xj.call(a,e)){const f=String(a[e]);l=xj.call(d,f)?d[f]:r.unknown}if(l)return l.call(this,a,...o)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const fZ={}.hasOwnProperty;function JE(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)JE(e,n.extensions[t]);for(r in n)if(fZ.call(n,r))switch(r){case"extensions":break;case"unsafe":{bj(e[r],n[r]);break}case"join":{bj(e[r],n[r]);break}case"handlers":{hZ(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function bj(e,n){n&&e.push(...n)}function hZ(e,n){n&&Object.assign(e,n)}function pZ(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),mZ);return a(),l}function mZ(e,n,t){return">"+(t?"":" ")+e}function KE(e,n){return vj(e,n.inConstruct,!0)&&!vj(e,n.notInConstruct,!1)}function vj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function wj(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&KE(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function gZ(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function rw(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function yZ(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function xZ(e,n,t,r){const a=yZ(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(rw(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,bZ);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(gZ(o,a)+1,3)),u=t.enter("codeFenced");let h=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=d.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=d.move(" "),h+=d.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...d.current()})),g()}return h+=d.move(`
`),o&&(h+=d.move(o+`
`)),h+=d.move(f),u(),h}function bZ(e,n,t){return(t?"":"    ")+e}function hS(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function vZ(e,n,t,r){const a=hS(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function wZ(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function du(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Nb(e,n,t){const r=Sb(e),a=Sb(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}XE.peek=SZ;function XE(e,n,t,r){const a=wZ(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=Nb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=du(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=Nb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+du(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function SZ(e,n,t){return t.options.emphasis||"*"}const pS=function(e){if(e==null)return jZ;if(typeof e=="function")return nv(e);if(typeof e=="object")return Array.isArray(e)?NZ(e):CZ(e);if(typeof e=="string")return _Z(e);throw new Error("Expected function, string, or object as test")};function NZ(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=pS(e[t]);return nv(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function CZ(e){const n=e;return nv(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function _Z(e){return nv(n);function n(t){return t&&t.type===e}}function nv(e){return n;function n(t,r,a){return!!(kZ(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function jZ(){return!0}function kZ(e){return e!==null&&typeof e=="object"&&"type"in e}const ZE=[],TZ=!0,iw=!1,EZ="skip";function AZ(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=pS(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,h){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=ZE,S,k,T;if((!n||o(f,u,h[h.length-1]||void 0))&&(v=PZ(t(f,h)),v[0]===iw))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==EZ)for(k=(r?P.children.length:-1)+l,T=h.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===iw)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function PZ(e){return Array.isArray(e)?e:typeof e=="number"?[TZ,e]:e==null?ZE:[e]}function eA(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),AZ(e,o,d,a);function d(f,u){const h=u[u.length-1],g=h?h.children.indexOf(f):void 0;return l(f,g,h)}}function tA(e,n){let t=!1;return eA(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,iw}),!!((!e.depth||e.depth<3)&&cS(e)&&(n.options.setext||t))}function DZ(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(tA(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=du(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}nA.peek=IZ;function nA(e){return e.value||""}function IZ(){return"<"}rA.peek=RZ;function rA(e,n,t,r){const a=hS(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function RZ(){return"!"}iA.peek=MZ;function iA(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function MZ(){return"!"}aA.peek=OZ;function aA(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function OZ(){return"`"}function sA(e,n){const t=cS(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}oA.peek=LZ;function oA(e,n,t,r){const a=hS(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(sA(e,t)){const h=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=h,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function LZ(e,n,t){return sA(e,t)?"<":"["}lA.peek=FZ;function lA(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function FZ(){return"["}function mS(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function $Z(e){const n=mS(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function zZ(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function cA(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function BZ(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?zZ(t):mS(t);const d=e.ordered?l==="."?")":".":$Z(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),cA(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function UZ(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function qZ(e,n,t,r){const a=UZ(t);let o=t.bulletCurrent||mS(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),h);return f(),u;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function VZ(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const HZ=pS(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function GZ(e,n,t,r){return(e.children.some(function(l){return HZ(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function YZ(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}uA.peek=WZ;function uA(e,n,t,r){const a=YZ(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=Nb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=du(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=Nb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+du(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function WZ(e,n,t){return t.options.strong||"*"}function QZ(e,n,t,r){return t.safe(e.value,r)}function JZ(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function KZ(e,n,t){const r=(cA(t)+(t.options.ruleSpaces?" ":"")).repeat(JZ(t));return t.options.ruleSpaces?r.slice(0,-1):r}const XZ={blockquote:pZ,break:wj,code:xZ,definition:vZ,emphasis:XE,hardBreak:wj,heading:DZ,html:nA,image:rA,imageReference:iA,inlineCode:aA,link:oA,linkReference:lA,list:BZ,listItem:qZ,paragraph:VZ,root:GZ,strong:uA,text:QZ,thematicBreak:KZ},ZZ=[eee];function eee(e,n,t,r){if(n.type==="code"&&rw(n,r)&&(e.type==="list"||e.type===n.type&&rw(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&tA(n,r))?void 0:t.spread?1:0}const Md=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],tee=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Md},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Md},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Md},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Md},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Md},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Md},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Md},{atBreak:!0,character:"~"}];function nee(e){return e.label||!e.identifier?e.label||"":GE(e.identifier)}function ree(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function iee(e,n,t){const r=n.indexStack,a=e.children||[],o=[];let l=-1,d=t.before,f;r.push(-1);let u=n.createTracker(t);for(;++l<a.length;){const h=a[l];let g;if(r[r.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else g=t.after;o.length>0&&(d==="\r"||d===`
`)&&h.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),d=" ",u=n.createTracker(t),u.move(o.join("")));let b=n.handle(h,e,n,{...u.current(),after:g,before:d});f&&f===b.slice(0,1)&&(b=du(f.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,f=void 0,v&&(o.length>0&&v.before&&d===o[o.length-1].slice(-1)&&(o[o.length-1]=o[o.length-1].slice(0,-1)+du(d.charCodeAt(0))),v.after&&(f=g)),u.move(b),o.push(b),d=b.slice(-1)}return r.pop(),o.join("")}function aee(e,n,t){const r=n.indexStack,a=e.children||[],o=n.createTracker(t),l=[];let d=-1;for(r.push(-1);++d<a.length;){const f=a[d];r[r.length-1]=d,l.push(o.move(n.handle(f,e,n,{before:`
`,after:`
`,...o.current()}))),f.type!=="list"&&(n.bulletLastUsed=void 0),d<a.length-1&&l.push(o.move(see(f,a[d+1],e,n)))}return r.pop(),l.join("")}function see(e,n,t,r){let a=r.join.length;for(;a--;){const o=r.join[a](e,n,t,r);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}const oee=/\r?\n|\r/g;function lee(e,n){const t=[];let r=0,a=0,o;for(;o=oee.exec(e);)l(e.slice(r,o.index)),t.push(o[0]),r=o.index+o[0].length,a++;return l(e.slice(r)),t.join("");function l(d){t.push(n(d,a,!d))}}function cee(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],o=[],l={};let d=-1;for(;++d<e.unsafe.length;){const h=e.unsafe[d];if(!KE(e.stack,h))continue;const g=e.compilePattern(h);let b;for(;b=g.exec(r);){const v="before"in h||!!h.atBreak,S="after"in h,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(uee);let f=t.before?t.before.length:0;const u=r.length-(t.after?t.after.length:0);for(d=-1;++d<a.length;){const h=a[d];h<f||h>=u||h+1<u&&a[d+1]===h+1&&l[h].after&&!l[h+1].before&&!l[h+1].after||a[d-1]===h-1&&l[h].before&&!l[h-1].before&&!l[h-1].after||(f!==h&&o.push(Sj(r.slice(f,h),"\\")),f=h,/[!-/:-@[-`{-~]/.test(r.charAt(h))&&(!t.encode||!t.encode.includes(r.charAt(h)))?o.push("\\"):(o.push(du(r.charCodeAt(h))),f++))}return o.push(Sj(r.slice(f,u),t.after)),o.join("")}function uee(e,n){return e-n}function Sj(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],o=e+n;let l=-1,d=0,f;for(;f=t.exec(o);)r.push(f.index);for(;++l<r.length;)d!==r[l]&&a.push(e.slice(d,r[l])),a.push("\\"),d=r[l];return a.push(e.slice(d)),a.join("")}function dee(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,o=t.column||1;return{move:f,current:l,shift:d};function l(){return{now:{line:a,column:o},lineShift:r}}function d(u){r+=u}function f(u){const h=u||"",g=h.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,o=g.length===1?o+b.length:1+b.length+r,h}}function fee(e,n){const t=n||{},r={associationId:nee,containerPhrasing:gee,containerFlow:yee,createTracker:dee,compilePattern:ree,enter:o,handlers:{...XZ},handle:void 0,indentLines:lee,indexStack:[],join:[...ZZ],options:{},safe:xee,stack:[],unsafe:[...tee]};JE(r,t),r.options.tightDefinitions&&r.join.push(mee),r.handle=QE("type",{invalid:hee,unknown:pee,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function o(l){return r.stack.push(l),d;function d(){r.stack.pop()}}}function hee(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function pee(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function mee(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function gee(e,n){return iee(e,this,n)}function yee(e,n){return aee(e,this,n)}function xee(e,n){return cee(this,e,n)}function bee(e){const n=this;n.compiler=t;function t(r){return fee(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function Nj(e){if(e)throw e}var Q0,Cj;function vee(){if(Cj)return Q0;Cj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var h=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!h&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,h){t&&h.name==="__proto__"?t(u,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):u[h.name]=h.newValue},d=function(u,h){if(h==="__proto__")if(e.call(u,h)){if(r)return r(u,h).value}else return;return u[h]};return Q0=function f(){var u,h,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(h in u)g=d(k,h),b=d(u,h),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:h,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},Q0}var wee=vee();const J0=Wd(wee);function aw(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function See(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const h=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,h?Nee(h,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function Nee(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const h=u;if(d&&t)throw h;return a(h)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}class xa extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=d?d.line:void 0,this.name=Km(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}xa.prototype.file="";xa.prototype.name="";xa.prototype.reason="";xa.prototype.message="";xa.prototype.stack="";xa.prototype.column=void 0;xa.prototype.line=void 0;xa.prototype.ancestors=void 0;xa.prototype.cause=void 0;xa.prototype.fatal=void 0;xa.prototype.place=void 0;xa.prototype.ruleId=void 0;xa.prototype.source=void 0;const Xo={basename:Cee,dirname:_ee,extname:jee,join:kee,sep:"/"};function Cee(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');Sg(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function _ee(e){if(Sg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function jee(e){Sg(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function kee(...e){let n=-1,t;for(;++n<e.length;)Sg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":Tee(t)}function Tee(e){Sg(e);const n=e.codePointAt(0)===47;let t=Eee(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function Eee(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function Sg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const Aee={cwd:Pee};function Pee(){return"/"}function sw(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function Dee(e){if(typeof e=="string")e=new URL(e);else if(!sw(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return Iee(e)}function Iee(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const K0=["history","path","basename","stem","extname","dirname"];class Ree{constructor(n){let t;n?sw(n)?t={path:n}:typeof n=="string"||Mee(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":Aee.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<K0.length;){const o=K0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)K0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Xo.basename(this.path):void 0}set basename(n){Z0(n,"basename"),X0(n,"basename"),this.path=Xo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Xo.dirname(this.path):void 0}set dirname(n){_j(this.basename,"dirname"),this.path=Xo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Xo.extname(this.path):void 0}set extname(n){if(X0(n,"extname"),_j(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Xo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){sw(n)&&(n=Dee(n)),Z0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Xo.basename(this.path,this.extname):void 0}set stem(n){Z0(n,"stem"),X0(n,"stem"),this.path=Xo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new xa(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function X0(e,n){if(e&&e.includes(Xo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Xo.sep+"`")}function Z0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function _j(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function Mee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const Oee=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},Lee={}.hasOwnProperty;class gS extends Oee{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=See()}copy(){const n=new gS;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(J0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(n1("data",this.frozen),this.namespace[n]=t,this):Lee.call(this.namespace,n)&&this.namespace[n]||void 0:n?(n1("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Ox(n),r=this.parser||this.Parser;return e1("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),e1("process",this.parser||this.Parser),t1("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=Ox(n),f=r.parse(d);r.run(f,d,function(h,g,b){if(h||!g||!b)return u(h);const v=g,S=r.stringify(v,b);zee(S)?b.value=S:b.result=S,u(h,b)});function u(h,g){h||!g?l(h):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),e1("processSync",this.parser||this.Parser),t1("processSync",this.compiler||this.Compiler),this.process(n,a),kj("processSync","process",t),r;function a(o,l){t=!0,Nj(o),r=l}}run(n,t,r){jj(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=Ox(t);a.run(n,f,u);function u(h,g,b){const v=g||n;h?d(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),kj("runSync","run",r),a;function o(l,d){Nj(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=Ox(t),a=this.compiler||this.Compiler;return t1("stringify",a),jj(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(n1("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...g]=u;f(h,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=J0(!0,a.settings,u.settings))}function d(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const g=u[h];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];aw(k)&&aw(v)&&(v=J0(!0,k,v)),r[b]=[u,v,...S]}}}}const Fee=new gS().freeze();function e1(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function t1(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function n1(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function jj(e){if(!aw(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function kj(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Ox(e){return $ee(e)?e:new Ree(e)}function $ee(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function zee(e){return typeof e=="string"||Bee(e)}function Bee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const Uee=Fee().use(dZ).use(bee).freeze(),dA=-1,rv=0,Xm=1,Cb=2,yS=3,xS=4,bS=5,vS=6,fA=7,hA=8,Tj=typeof self=="object"?self:globalThis,qee=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case rv:case dA:return t(l,a);case Xm:{const d=t([],a);for(const f of l)d.push(r(f));return d}case Cb:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case yS:return t(new Date(l),a);case xS:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case bS:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case vS:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case fA:{const{name:d,message:f}=l;return t(new Tj[d](f),a)}case hA:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new Tj[o](l),a)};return r},Ej=e=>qee(new Map,e)(0),jh="",{toString:Vee}={},{keys:Hee}=Object,Um=e=>{const n=typeof e;if(n!=="object"||!e)return[rv,n];const t=Vee.call(e).slice(8,-1);switch(t){case"Array":return[Xm,jh];case"Object":return[Cb,jh];case"Date":return[yS,jh];case"RegExp":return[xS,jh];case"Map":return[bS,jh];case"Set":return[vS,jh];case"DataView":return[Xm,t]}return t.includes("Array")?[Xm,t]:t.includes("Error")?[fA,t]:[Cb,t]},Lx=([e,n])=>e===rv&&(n==="function"||n==="symbol"),Gee=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Um(l);switch(d){case rv:{let h=l;switch(f){case"bigint":d=hA,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);h=null;break;case"undefined":return a([dA],l)}return a([d,h],l)}case Xm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const h=[],g=a([d,h],l);for(const b of l)h.push(o(b));return g}case Cb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const h=[],g=a([d,h],l);for(const b of Hee(l))(e||!Lx(Um(l[b])))&&h.push([o(b),o(l[b])]);return g}case yS:return a([d,l.toISOString()],l);case xS:{const{source:h,flags:g}=l;return a([d,{source:h,flags:g}],l)}case bS:{const h=[],g=a([d,h],l);for(const[b,v]of l)(e||!(Lx(Um(b))||Lx(Um(v))))&&h.push([o(b),o(v)]);return g}case vS:{const h=[],g=a([d,h],l);for(const b of l)(e||!Lx(Um(b)))&&h.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},Aj=(e,{json:n,lossy:t}={})=>{const r=[];return Gee(!(n||t),!!n,new Map,r)(e),r},cg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?Ej(Aj(e,n)):structuredClone(e):(e,n)=>Ej(Aj(e,n)),pA=gA("end"),mA=gA("start");function gA(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function yA(e){const n=mA(e),t=pA(e);if(n&&t)return{start:n,end:t}}const Od=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],Pj={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Od,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Od],h2:[["className","sr-only"]],img:[...Od,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Od,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Od],table:[...Od],ul:[...Od,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},ou={}.hasOwnProperty;function Yee(e,n){let t={type:"root",children:[]};const r={schema:n?{...Pj,...n}:Pj,stack:[]},a=xA(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function xA(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return Wee(e,t);case"doctype":return Qee(e,t);case"element":return Jee(e,t);case"root":return Kee(e,t);case"text":return Xee(e,t)}}}function Wee(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),o={type:"comment",value:r<0?t:t.slice(0,r)};return Ng(o,n),o}}function Qee(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return Ng(t,n),t}}function Jee(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=bA(e,n.children),a=Zee(e,n.properties);e.stack.pop();let o=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(o=!0,e.schema.ancestors&&ou.call(e.schema.ancestors,t))){const d=e.schema.ancestors[t];let f=-1;for(o=!1;++f<d.length;)e.stack.includes(d[f])&&(o=!0)}if(!o)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const l={type:"element",tagName:t,properties:a,children:r};return Ng(l,n),l}function Kee(e,n){const r={type:"root",children:bA(e,n.children)};return Ng(r,n),r}function Xee(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return Ng(r,n),r}function bA(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const o=xA(e,r[a]);o&&(Array.isArray(o)?t.push(...o):t.push(o))}}return t}function Zee(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,o=r&&ou.call(r,t)?r[t]:void 0,l=r&&ou.call(r,"*")?r["*"]:void 0,d=n&&typeof n=="object"?n:{},f={};let u;for(u in d)if(ou.call(d,u)){const h=d[u];let g=Dj(e,Ij(o,u),u,h);g==null&&(g=Dj(e,Ij(l,u),u,h)),g!=null&&(f[u]=g)}if(a&&ou.call(a,t)){const h=a[t];for(u in h)ou.call(h,u)&&!ou.call(f,u)&&(f[u]=h[u])}return f}function Dj(e,n,t,r){return n?Array.isArray(r)?ete(e,n,t,r):vA(e,n,t,r):void 0}function ete(e,n,t,r){let a=-1;const o=[];for(;++a<r.length;){const l=vA(e,n,t,r[a]);(typeof l=="number"||typeof l=="string")&&o.push(l)}return o}function vA(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&tte(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,o=0;for(;++o<n.length;){const l=n[o];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(r))){a=!0;break}}else if(l===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function tte(e,n,t){const r=e.schema.protocols&&ou.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),o=a.indexOf(":"),l=a.indexOf("?"),d=a.indexOf("#"),f=a.indexOf("/");if(o<0||f>-1&&o>f||l>-1&&o>l||d>-1&&o>d)return!0;let u=-1;for(;++u<r.length;){const h=r[u];if(o===h.length&&a.slice(0,h.length)===h)return!0}return!1}function Ng(e,n){const t=yA(n);n.data&&(e.data=cg(n.data)),t&&(e.position=t)}function Ij(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],o=typeof a=="string"?a:a[0];if(o===n)return a;o==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function nte(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function rte(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function ite(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function ate(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function ste(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function ote(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=np(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function lte(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function cte(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function wA(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function ute(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return wA(e,n);const a={src:np(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function dte(e,n){const t={src:np(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function fte(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function hte(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return wA(e,n);const a={href:np(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function pte(e,n){const t={href:np(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function mte(e,n,t){const r=e.all(n),a=t?gte(t):SA(n),o={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const h=r[d];(a||d!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function gte(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=SA(t[r])}return n}function SA(e){const n=e.spread;return n??e.children.length>1}function yte(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function xte(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function bte(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function vte(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function wte(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=mA(n.children[1]),f=pA(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function Ste(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,h),e.applyData(n,h)}function Nte(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Rj=9,Mj=32;function Cte(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(Oj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(Oj(n.slice(a),a>0,!1)),o.join("")}function Oj(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===Rj||o===Mj;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===Rj||o===Mj;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function _te(e,n){const t={type:"text",value:Cte(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function jte(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const kte={blockquote:nte,break:rte,code:ite,delete:ate,emphasis:ste,footnoteReference:ote,heading:lte,html:cte,imageReference:ute,image:dte,inlineCode:fte,linkReference:hte,link:pte,listItem:mte,list:yte,paragraph:xte,root:bte,strong:vte,table:wte,tableCell:Nte,tableRow:Ste,text:_te,thematicBreak:jte,toml:Fx,yaml:Fx,definition:Fx,footnoteDefinition:Fx};function Fx(){}function Tte(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function Ete(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function Ate(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||Tte,r=e.options.footnoteBackLabel||Ete,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const h=e.all(u),g=String(u.identifier).toUpperCase(),b=np(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else h.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...cg(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const ow={}.hasOwnProperty,Pte={};function Dte(e,n){const t=n||Pte,r=new Map,a=new Map,o=new Map,l={...kte,...t.handlers},d={all:u,applyData:Rte,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:Ite,wrap:Ote};return eA(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),d;function f(h,g){const b=h.type,v=d.handlers[b];if(ow.call(d.handlers,b)&&v)return v(d,h,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,P=cg(T);return P.children=d.all(h),P}return cg(h)}return(d.options.unknownHandler||Mte)(d,h,g)}function u(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Lj(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=Lj(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function Ite(e,n){e.position&&(n.position=yA(e))}function Rte(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,cg(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function Mte(e,n){const t=n.data||{},r="value"in n&&!(ow.call(t,"hProperties")||ow.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function Ote(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Lj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function Lte(e,n){const t=Dte(e,n),r=t.one(e,void 0),a=Ate(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}const Fte=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class Cg{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}Cg.prototype.normal={};Cg.prototype.property={};Cg.prototype.space=void 0;function NA(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new Cg(t,r,n)}function lw(e){return e.toLowerCase()}class ba{constructor(n,t){this.attribute=t,this.property=n}}ba.prototype.attribute="";ba.prototype.booleanish=!1;ba.prototype.boolean=!1;ba.prototype.commaOrSpaceSeparated=!1;ba.prototype.commaSeparated=!1;ba.prototype.defined=!1;ba.prototype.mustUseProperty=!1;ba.prototype.number=!1;ba.prototype.overloadedBoolean=!1;ba.prototype.property="";ba.prototype.spaceSeparated=!1;ba.prototype.space=void 0;let $te=0;const tn=Jd(),qr=Jd(),cw=Jd(),ut=Jd(),cr=Jd(),Mh=Jd(),Ba=Jd();function Jd(){return 2**++$te}const uw=Object.freeze(Object.defineProperty({__proto__:null,boolean:tn,booleanish:qr,commaOrSpaceSeparated:Ba,commaSeparated:Mh,number:ut,overloadedBoolean:cw,spaceSeparated:cr},Symbol.toStringTag,{value:"Module"})),r1=Object.keys(uw);class wS extends ba{constructor(n,t,r,a){let o=-1;if(super(n,t),Fj(this,"space",a),typeof r=="number")for(;++o<r1.length;){const l=r1[o];Fj(this,r1[o],(r&uw[l])===uw[l])}}}wS.prototype.defined=!0;function Fj(e,n,t){t&&(e[n]=t)}function rp(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new wS(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[lw(r)]=r,t[lw(o.attribute)]=r}return new Cg(n,t,e.space)}const CA=rp({properties:{ariaActiveDescendant:null,ariaAtomic:qr,ariaAutoComplete:null,ariaBusy:qr,ariaChecked:qr,ariaColCount:ut,ariaColIndex:ut,ariaColSpan:ut,ariaControls:cr,ariaCurrent:null,ariaDescribedBy:cr,ariaDetails:null,ariaDisabled:qr,ariaDropEffect:cr,ariaErrorMessage:null,ariaExpanded:qr,ariaFlowTo:cr,ariaGrabbed:qr,ariaHasPopup:null,ariaHidden:qr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:cr,ariaLevel:ut,ariaLive:null,ariaModal:qr,ariaMultiLine:qr,ariaMultiSelectable:qr,ariaOrientation:null,ariaOwns:cr,ariaPlaceholder:null,ariaPosInSet:ut,ariaPressed:qr,ariaReadOnly:qr,ariaRelevant:null,ariaRequired:qr,ariaRoleDescription:cr,ariaRowCount:ut,ariaRowIndex:ut,ariaRowSpan:ut,ariaSelected:qr,ariaSetSize:ut,ariaSort:null,ariaValueMax:ut,ariaValueMin:ut,ariaValueNow:ut,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function _A(e,n){return n in e?e[n]:n}function jA(e,n){return _A(e,n.toLowerCase())}const zte=rp({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Mh,acceptCharset:cr,accessKey:cr,action:null,allow:null,allowFullScreen:tn,allowPaymentRequest:tn,allowUserMedia:tn,alt:null,as:null,async:tn,autoCapitalize:null,autoComplete:cr,autoFocus:tn,autoPlay:tn,blocking:cr,capture:null,charSet:null,checked:tn,cite:null,className:cr,cols:ut,colSpan:null,content:null,contentEditable:qr,controls:tn,controlsList:cr,coords:ut|Mh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:tn,defer:tn,dir:null,dirName:null,disabled:tn,download:cw,draggable:qr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:tn,formTarget:null,headers:cr,height:ut,hidden:cw,high:ut,href:null,hrefLang:null,htmlFor:cr,httpEquiv:cr,id:null,imageSizes:null,imageSrcSet:null,inert:tn,inputMode:null,integrity:null,is:null,isMap:tn,itemId:null,itemProp:cr,itemRef:cr,itemScope:tn,itemType:cr,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:tn,low:ut,manifest:null,max:null,maxLength:ut,media:null,method:null,min:null,minLength:ut,multiple:tn,muted:tn,name:null,nonce:null,noModule:tn,noValidate:tn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:tn,optimum:ut,pattern:null,ping:cr,placeholder:null,playsInline:tn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:tn,referrerPolicy:null,rel:cr,required:tn,reversed:tn,rows:ut,rowSpan:ut,sandbox:cr,scope:null,scoped:tn,seamless:tn,selected:tn,shadowRootClonable:tn,shadowRootDelegatesFocus:tn,shadowRootMode:null,shape:null,size:ut,sizes:null,slot:null,span:ut,spellCheck:qr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ut,step:null,style:null,tabIndex:ut,target:null,title:null,translate:null,type:null,typeMustMatch:tn,useMap:null,value:qr,width:ut,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:cr,axis:null,background:null,bgColor:null,border:ut,borderColor:null,bottomMargin:ut,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:tn,declare:tn,event:null,face:null,frame:null,frameBorder:null,hSpace:ut,leftMargin:ut,link:null,longDesc:null,lowSrc:null,marginHeight:ut,marginWidth:ut,noResize:tn,noHref:tn,noShade:tn,noWrap:tn,object:null,profile:null,prompt:null,rev:null,rightMargin:ut,rules:null,scheme:null,scrolling:qr,standby:null,summary:null,text:null,topMargin:ut,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ut,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:tn,disableRemotePlayback:tn,prefix:null,property:null,results:ut,security:null,unselectable:null},space:"html",transform:jA}),Bte=rp({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ba,accentHeight:ut,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ut,amplitude:ut,arabicForm:null,ascent:ut,attributeName:null,attributeType:null,azimuth:ut,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ut,by:null,calcMode:null,capHeight:ut,className:cr,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ut,diffuseConstant:ut,direction:null,display:null,dur:null,divisor:ut,dominantBaseline:null,download:tn,dx:null,dy:null,edgeMode:null,editable:null,elevation:ut,enableBackground:null,end:null,event:null,exponent:ut,externalResourcesRequired:null,fill:null,fillOpacity:ut,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Mh,g2:Mh,glyphName:Mh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ut,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ut,horizOriginX:ut,horizOriginY:ut,id:null,ideographic:ut,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ut,k:ut,k1:ut,k2:ut,k3:ut,k4:ut,kernelMatrix:Ba,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ut,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ut,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ut,overlineThickness:ut,paintOrder:null,panose1:null,path:null,pathLength:ut,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:cr,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ut,pointsAtY:ut,pointsAtZ:ut,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ba,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ba,rev:Ba,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ba,requiredFeatures:Ba,requiredFonts:Ba,requiredFormats:Ba,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ut,specularExponent:ut,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ut,strikethroughThickness:ut,string:null,stroke:null,strokeDashArray:Ba,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ut,strokeOpacity:ut,strokeWidth:null,style:null,surfaceScale:ut,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ba,tabIndex:ut,tableValues:null,target:null,targetX:ut,targetY:ut,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ba,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ut,underlineThickness:ut,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ut,values:null,vAlphabetic:ut,vMathematical:ut,vectorEffect:null,vHanging:ut,vIdeographic:ut,version:null,vertAdvY:ut,vertOriginX:ut,vertOriginY:ut,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ut,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:_A}),kA=rp({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),TA=rp({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:jA}),EA=rp({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),Ute=/[A-Z]/g,$j=/-[a-z]/g,qte=/^data[-\w.:]+$/i;function Vte(e,n){const t=lw(n);let r=n,a=ba;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&qte.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace($j,Gte);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!$j.test(o)){let l=o.replace(Ute,Hte);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=wS}return new a(r,n)}function Hte(e){return"-"+e.toLowerCase()}function Gte(e){return e.charAt(1).toUpperCase()}const Yte=NA([CA,zte,kA,TA,EA],"html"),AA=NA([CA,Bte,kA,TA,EA],"svg"),Wte=/["&'<>`]/g,Qte=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Jte=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,Kte=/[|\\{}()[\]^$+*?.]/g,zj=new WeakMap;function Xte(e,n){if(e=e.replace(n.subset?Zte(n.subset):Wte,r),n.subset||n.escapeOnly)return e;return e.replace(Qte,t).replace(Jte,r);function t(a,o,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(o+2),n)}function r(a,o,l){return n.format(a.charCodeAt(0),l.charCodeAt(o+1),n)}}function Zte(e){let n=zj.get(e);return n||(n=ene(e),zj.set(e,n)),n}function ene(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(Kte,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const tne=/[\dA-Fa-f]/;function nne(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!tne.test(String.fromCharCode(n))?r:r+";"}const rne=/\d/;function ine(e,n,t){const r="&#"+String(e);return t&&n&&!rne.test(String.fromCharCode(n))?r:r+";"}const ane=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],i1={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},sne=["cent","copy","divide","gt","lt","not","para","times"],PA={}.hasOwnProperty,dw={};let $x;for($x in i1)PA.call(i1,$x)&&(dw[i1[$x]]=$x);const one=/[^\dA-Za-z]/;function lne(e,n,t,r){const a=String.fromCharCode(e);if(PA.call(dw,a)){const o=dw[a],l="&"+o;return t&&ane.includes(o)&&!sne.includes(o)&&(!r||n&&n!==61&&one.test(String.fromCharCode(n)))?l:l+";"}return""}function cne(e,n,t){let r=nne(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=lne(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const o=ine(e,n,t.omitOptionalSemicolons);o.length<r.length&&(r=o)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function Oh(e,n){return Xte(e,Object.assign({format:cne},n))}const une=/^>|^->|<!--|-->|--!>|<!-$/g,dne=[">"],fne=["<",">"];function hne(e,n,t,r){return r.settings.bogusComments?"<?"+Oh(e.value,Object.assign({},r.settings.characterReferences,{subset:dne}))+">":"<!--"+e.value.replace(une,a)+"-->";function a(o){return Oh(o,Object.assign({},r.settings.characterReferences,{subset:fne}))}}function pne(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function Bj(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function mne(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function gne(e){return e.join(" ").trim()}const yne=/[ \t\n\f\r]/g;function SS(e){return typeof e=="object"?e.type==="text"?Uj(e.value):!1:Uj(e)}function Uj(e){return e.replace(yne,"")===""}const Kr=IA(1),DA=IA(-1),xne=[];function IA(e){return n;function n(t,r,a){const o=t?t.children:xne;let l=(r||0)+e,d=o[l];if(!a)for(;d&&SS(d);)l+=e,d=o[l];return d}}const bne={}.hasOwnProperty;function RA(e){return n;function n(t,r,a){return bne.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const NS=RA({body:wne,caption:a1,colgroup:a1,dd:_ne,dt:Cne,head:a1,html:vne,li:Nne,optgroup:jne,option:kne,p:Sne,rp:qj,rt:qj,tbody:Ene,td:Vj,tfoot:Ane,th:Vj,thead:Tne,tr:Pne});function a1(e,n,t){const r=Kr(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&SS(r.value.charAt(0)))}function vne(e,n,t){const r=Kr(t,n);return!r||r.type!=="comment"}function wne(e,n,t){const r=Kr(t,n);return!r||r.type!=="comment"}function Sne(e,n,t){const r=Kr(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function Nne(e,n,t){const r=Kr(t,n);return!r||r.type==="element"&&r.tagName==="li"}function Cne(e,n,t){const r=Kr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function _ne(e,n,t){const r=Kr(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function qj(e,n,t){const r=Kr(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function jne(e,n,t){const r=Kr(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function kne(e,n,t){const r=Kr(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function Tne(e,n,t){const r=Kr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function Ene(e,n,t){const r=Kr(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function Ane(e,n,t){return!Kr(t,n)}function Pne(e,n,t){const r=Kr(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function Vj(e,n,t){const r=Kr(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const Dne=RA({body:Mne,colgroup:One,head:Rne,html:Ine,tbody:Lne});function Ine(e){const n=Kr(e,-1);return!n||n.type!=="comment"}function Rne(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function Mne(e){const n=Kr(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&SS(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function One(e,n,t){const r=DA(t,n),a=Kr(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&NS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function Lne(e,n,t){const r=DA(t,n),a=Kr(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&NS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const zx={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function Fne(e,n,t,r){const a=r.schema,o=a.space==="svg"?!1:r.settings.omitOptionalTags;let l=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const d=[];let f;a.space==="html"&&e.tagName==="svg"&&(r.schema=AA);const u=$ne(r,e.properties),h=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,h&&(l=!1),(u||!o||!Dne(e,n,t))&&(d.push("<",e.tagName,u?" "+u:""),l&&(a.space==="svg"||r.settings.closeSelfClosing)&&(f=u.charAt(u.length-1),(!r.settings.tightSelfClosing||f==="/"||f&&f!=='"'&&f!=="'")&&d.push(" "),d.push("/")),d.push(">")),d.push(h),!l&&(!o||!NS(e,n,t))&&d.push("</"+e.tagName+">"),d.join("")}function $ne(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const o=zne(e,a,n[a]);o&&t.push(o)}}for(;++r<t.length;){const o=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&o!=='"'&&o!=="'"&&(t[r]+=" ")}return t.join("")}function zne(e,n,t){const r=Vte(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,o=e.settings.allowDangerousCharacters?0:1;let l=e.quote,d;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const f=Oh(r.attribute,Object.assign({},e.settings.characterReferences,{subset:zx.name[a][o]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?mne:gne)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?f:(e.settings.preferUnquoted&&(d=Oh(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:zx.unquoted[a][o]}))),d!==t&&(e.settings.quoteSmart&&Bj(t,l)>Bj(t,e.alternative)&&(l=e.alternative),d=l+Oh(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?zx.single:zx.double)[a][o],attribute:!0}))+l),f+(d&&"="+d))}const Bne=["<","&"];function MA(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Oh(e.value,Object.assign({},r.settings.characterReferences,{subset:Bne}))}function Une(e,n,t,r){return r.settings.allowDangerousHtml?e.value:MA(e,n,t,r)}function qne(e,n,t,r){return r.all(e)}const Vne=QE("type",{invalid:Hne,unknown:Gne,handlers:{comment:hne,doctype:pne,element:Fne,raw:Une,root:qne,text:MA}});function Hne(e){throw new Error("Expected node, not `"+e+"`")}function Gne(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const Yne={},Wne={},Qne=[];function Jne(e,n){const t=n||Yne,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:Kne,all:Xne,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||Fte,characterReferences:t.characterReferences||Wne,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?AA:Yte,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function Kne(e,n,t){return Vne(e,n,t,this)}function Xne(e){const n=[],t=e&&e.children||Qne;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const Zne={};function ere(e){const n=this,{handlers:t,sanitize:r,...a}=e||Zne;let o=!1,l;typeof r=="boolean"?o=!r:r&&(l=r),n.compiler=d;function d(f,u){const h=Lte(f,{handlers:t,allowDangerousHtml:o}),g=o?h:Yee(h,l),b=Jne(g,{...a,allowDangerousHtml:o});return u.extname&&(u.extname=".html"),f&&f.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const tre=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){h([]);return}const R=d.toLowerCase();h(r.filter(z=>z.name.toLowerCase().includes(R)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one drug.");return}for(const R of o)if(R.selected_pack_quantity===0&&R.selected_loose_quantity===0){b(`Please specify a quantity for ${R.name}.`);return}S(!0),b(null);try{const R={patient_id:t,items:o.map($=>({drug_id:$.id,name:$.name,pack_quantity:$.selected_pack_quantity,loose_quantity:$.selected_loose_quantity,pack_price:0,loose_price:0,total_price:0,tabletsPerDay:1,numberOfDays:1,directions_to_use:"As directed"})),order_total:0,prescription_for_unavailable_drugs:""},z=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!z.ok){const $=await z.json().catch(()=>({}));throw new Error($.message||`Failed to create pharmacy order: ${z.statusText} `)}await z.json(),a(t),n(),l([]),f("")}catch(R){b(`Order Creation Error: ${R.message} `)}finally{S(!1)}},T=R=>{if(o.some(z=>z.id===R.id)){b(`${R.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),h([]);return}l(z=>[...z,{...R,selected_pack_quantity:0,selected_loose_quantity:0}]),f(""),h([])},P=R=>{l(z=>z.filter($=>$.id!==R))},M=(R,z,$)=>{const L=parseInt($)||0;l(B=>B.map(q=>q.id===R?{...q,[z==="pack"?"selected_pack_quantity":"selected_loose_quantity"]:L}:q))};return e?i.jsx("div",{className:At.modalOverlay,children:i.jsxs("div",{className:At.modalContent,children:[i.jsxs("div",{className:At.modalHeader,children:[i.jsx("h3",{className:At.modalTitle,children:"Create Pharmacy Order"}),i.jsx("button",{onClick:n,className:At.modalCloseButton,children:i.jsx(_n,{size:20})})]}),i.jsxs("div",{className:At.modalBody,children:[g&&i.jsx("div",{className:At.errorText,children:g}),i.jsxs("div",{className:At.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Drug"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:d,onChange:R=>f(R.target.value),className:At.inputField,autoComplete:"off"}),d&&u.length>0&&i.jsx("div",{className:At.searchResultsCard,children:i.jsx("ul",{className:At.searchResultsList,children:u.map(R=>i.jsx("li",{onClick:()=>T(R),className:At.searchResultItem,children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[i.jsx("span",{children:R.name}),i.jsxs("span",{className:At.searchResultPrice,children:["Stock: ",R.stock," (Box) / ",R.loose||0," (Loose)"]})]})},R.id))})})]}),i.jsxs("div",{className:At.selectedTestsCard,children:[" ",i.jsx("h4",{className:At.selectedTestsHeader,children:"Selected Drugs"}),o.length===0?i.jsx("p",{className:At.noTestsMessage,children:"No drugs added yet."}):i.jsx("ul",{className:At.selectedTestsList,children:o.map(R=>i.jsxs("li",{className:At.selectedTestItem,style:{flexDirection:"column",alignItems:"flex-start",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},children:[i.jsx("span",{className:At.selectedTestName,style:{fontWeight:"bold"},children:R.name}),i.jsx("button",{type:"button",onClick:()=>P(String(R.id)),className:At.removeTestButton,title:"Remove Drug",children:i.jsx(Hr,{size:16})})]}),i.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",width:"100%"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Packs"}),i.jsx("input",{type:"number",min:"0",className:At.inputField,style:{padding:"4px 8px"},value:R.selected_pack_quantity||"",onChange:z=>M(R.id,"pack",z.target.value),placeholder:"0"})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Loose"}),i.jsx("input",{type:"number",min:"0",className:At.inputField,style:{padding:"4px 8px"},value:R.selected_loose_quantity||"",onChange:z=>M(R.id,"loose",z.target.value),placeholder:"0"})]})]})]},R.id))})]})]}),i.jsxs("div",{className:At.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${At.button} ${At.buttonSecondary} `,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${At.button} ${At.buttonPrimary} ${o.length===0||v?At.buttonDisabled:""} `,children:[" ",v?"Creating...":"Create Order"," "]})]})]})}):null},OA=({isOpen:e,onClose:n,onSuccess:t,medication:r,initialPatient:a,initialItems:o})=>{const[l,d]=w.useState(""),[f,u]=w.useState([]),[h,g]=w.useState(null),[b,v]=w.useState(!1);w.useEffect(()=>{if(e&&r){k([{id:Date.now(),medication_name:r.medicationName,drug_id:null,quantity:r.quantity,tablets_per_day:r.tabletsPerDay||1,number_of_days:r.numberOfDays||30,directions:r.directions||"",notes:r.notes||""}]),P(r.frequencyDays);try{const K=new Date(r.nextDeliveryDate);isNaN(K.getTime())||R(K.toISOString().split("T")[0])}catch(K){console.error("Error parsing date",K)}g({id:r.patientId,name:r.patientName,phone:r.patientPhone,patient_token_number:r.patientToken})}else e&&(a||o)?(o&&o.length>0&&k(o),a&&g(a)):e&&!r&&!o&&(k([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),P(30),R(""),g(null),d(""))},[e,r,a,o]);const[S,k]=w.useState([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),[T,P]=w.useState(30),[M,R]=w.useState(""),[z,$]=w.useState(null),[L,B]=w.useState(""),[q,W]=w.useState([]),[I,F]=w.useState(!1),[V,ee]=w.useState(!1),[ie,Y]=w.useState(null),Q=w.useRef(null),ne=w.useRef(null);w.useEffect(()=>{if(e){const K=new Date;K.setDate(K.getDate()+30),R(K.toISOString().split("T")[0])}},[e]);const le=w.useCallback(async K=>{if(!K.trim()){u([]);return}v(!0);try{const J=await ge(`/api/patients?search=${encodeURIComponent(K)}&limit=10`);if(J.ok){const xe=await J.json();u(xe.patients||[])}}catch(J){console.error("Error searching patients:",J)}finally{v(!1)}},[]);w.useEffect(()=>{Q.current&&clearTimeout(Q.current),l&&!h?Q.current=setTimeout(()=>le(l),300):u([])},[l,h,le]);const oe=w.useCallback(async K=>{if(!K.trim()){W([]);return}F(!0);try{const J=await ge(`/api/drugs?search=${encodeURIComponent(K)}&limit=10`);if(J.ok){const xe=await J.json();W(xe.drugs||[])}}catch(J){console.error("Error searching drugs:",J)}finally{F(!1)}},[]);w.useEffect(()=>{ne.current&&clearTimeout(ne.current),L&&z!==null?ne.current=setTimeout(()=>oe(L),300):W([])},[L,z,oe]);const E=K=>{if(!K)return 1;const J=K.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return J?parseInt(J[1],10):1},de=K=>{g(K),d(`${K.name} (${K.patient_token_number})`),u([])},he=(K,J)=>{const xe=[...S];xe[J]={...xe[J],medication_name:K.name,drug_id:K.id,pack_size:E(K.pack),packs:0,loose:0,quantity:0},k(xe),$(null),B(""),W([])},D=(K,J,xe)=>{const He=[...S],re={...He[K]},Be=re.pack_size||1;if(J==="packs"||J==="loose"){const Ae=parseInt(xe)||0;J==="packs"&&(re.packs=Ae),J==="loose"&&(re.loose=Ae);const Ie=re.packs||0,Ye=re.loose||0;re.quantity=Ie*Be+Ye}else if(J==="tablets_per_day"||J==="number_of_days"){J==="tablets_per_day"&&(re.tablets_per_day=xe),J==="number_of_days"&&(re.number_of_days=xe);const Ae=parseFloat(re.tablets_per_day.toString())||0,Ie=parseInt(re.number_of_days.toString())||0,Ye=Math.ceil(Ae*Ie);re.quantity=Ye,re.packs=Math.floor(Ye/Be),re.loose=Ye%Be}else re[J]=xe;He[K]=re,k(He)},me=()=>{k([...S,{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:T,directions:"",notes:"",packs:0,loose:0,pack_size:1}])},Ce=K=>{S.length>1&&k(S.filter((J,xe)=>xe!==K))},te=async K=>{if(K.preventDefault(),Y(null),!h){Y("Please select a patient.");return}if(S.some(xe=>!xe.medication_name||xe.quantity<=0)){Y("Please ensure all items have a medication name and valid quantity.");return}ee(!0);try{const xe={patient_id:h.id,items:S.map(re=>({medication_name:re.medication_name,drug_id:re.drug_id,quantity:re.quantity,tablets_per_day:re.tablets_per_day,number_of_days:re.number_of_days,directions:re.directions,notes:re.notes,frequency_days:T,next_delivery_date:M}))},He=await ge("/api/recurring-medications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)});if(!He.ok){const re=await He.json();throw new Error(re.message+(re.error?": "+re.error:"")||"Failed to create recurring medication.")}t(),n(),g(null),d(""),k([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),P(30)}catch(xe){Y(xe.message)}finally{ee(!1)}};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"add-recurring-modal",style:{maxWidth:"800px",width:"95%"},children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Add Recurring Medication Order"}),i.jsx("button",{className:"close-btn",onClick:n,children:i.jsx(_n,{size:20})})]}),i.jsxs("div",{className:"modal-body",children:[ie&&i.jsx("div",{className:"error-message",children:ie}),i.jsxs("form",{onSubmit:te,className:"recurring-form",children:[i.jsxs("div",{className:"order-settings-row",children:[i.jsxs("div",{className:"form-group",style:{flex:2},children:[i.jsxs("label",{children:[i.jsx(Ns,{size:16})," Patient"]}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search patient...",value:l,onChange:K=>{d(K.target.value),g(null)},className:h?"selected":"unselected"}),b&&i.jsx("span",{className:"spinner",children:"..."}),l&&!h&&f.length>0&&i.jsx("ul",{className:"suggestions-list",children:f.map(K=>i.jsxs("li",{onClick:()=>de(K),children:[i.jsx("div",{className:"suggestion-name",children:K.name}),i.jsxs("div",{className:"suggestion-details",children:[K.phone,"  ",K.patient_token_number]})]},K.id))})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(nF,{size:16})," Frequency"]}),i.jsxs("select",{value:T,onChange:K=>{const J=parseInt(K.target.value);P(J);const xe=new Date;xe.setDate(xe.getDate()+J),R(xe.toISOString().split("T")[0]);const He=S.map(re=>({...re,number_of_days:J}));k(He)},children:[i.jsx("option",{value:15,children:"Every 15 Days"}),i.jsx("option",{value:30,children:"Every 30 Days"}),i.jsx("option",{value:60,children:"Every 60 Days"}),i.jsx("option",{value:90,children:"Every 90 Days"})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(zh,{size:16})," Next Delivery"]}),i.jsx("input",{type:"date",value:M,onChange:K=>R(K.target.value)})]})]}),i.jsx("hr",{className:"divider"}),i.jsxs("div",{className:"items-header",children:[i.jsx("h4",{children:"Medications"}),i.jsxs("button",{type:"button",className:"add-item-btn",onClick:me,children:[i.jsx(al,{size:14})," Add Drug"]})]}),i.jsx("div",{className:"items-list",children:S.map((K,J)=>i.jsxs("div",{className:"medication-item-row",children:[i.jsxs("div",{className:"row-top",children:[i.jsxs("div",{className:"form-group med-search-group",children:[i.jsx("label",{children:"Drug Name"}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drug...",value:z===J?L:K.medication_name,onFocus:()=>{$(J),B(K.medication_name)},onChange:xe=>{B(xe.target.value),D(J,"medication_name",xe.target.value)}}),z===J&&I&&i.jsx("span",{className:"spinner",children:"..."}),z===J&&L&&q.length>0&&i.jsx("ul",{className:"suggestions-list",children:q.map(xe=>i.jsxs("li",{onClick:()=>he(xe,J),children:[i.jsx("div",{className:"suggestion-name",children:xe.name}),i.jsxs("div",{className:"suggestion-details",children:["Stock: ",xe.stock]})]},xe.id))})]})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Tabs/Day"}),i.jsx("input",{type:"number",min:"0.5",step:"0.5",value:K.tablets_per_day,onChange:xe=>D(J,"tablets_per_day",xe.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Days"}),i.jsx("input",{type:"number",min:"1",value:K.number_of_days,onChange:xe=>D(J,"number_of_days",xe.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:K.packs||"",onChange:xe=>D(J,"packs",xe.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:K.loose||"",onChange:xe=>D(J,"loose",xe.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Total"}),i.jsx("input",{type:"number",value:K.quantity,disabled:!0,style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]}),i.jsx("button",{type:"button",className:"remove-btn",onClick:()=>Ce(J),disabled:S.length===1,children:i.jsx(Hr,{size:16})})]}),i.jsxs("div",{className:"row-bottom",children:[i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Directions (e.g. 1-0-1 after food)",value:K.directions,onChange:xe=>D(J,"directions",xe.target.value)})}),i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Notes",value:K.notes,onChange:xe=>D(J,"notes",xe.target.value)})})]})]},K.id))}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",className:"btn-cancel",onClick:n,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-submit",disabled:V,children:V?"Creating...":"Create Recurring Order"})]})]})]})]})}):null},nre=({messages:e})=>{const n=w.useRef(null);return w.useEffect(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e]),i.jsxs("div",{className:"conversation-panel",children:[i.jsxs("div",{className:"conversation-header",children:[i.jsx("div",{className:"conversation-title",children:i.jsx("h3",{children:"Conversation"})}),i.jsxs("span",{className:"conversation-count",children:[e.length," messages"]})]}),i.jsxs("div",{ref:n,className:"message-list custom-scrollbar",children:[e.length===0&&i.jsx("div",{className:"empty-state",children:"Start talking to the AI..."}),e.map(t=>i.jsxs("div",{className:`message-wrapper ${t.role}`,children:[i.jsx("div",{className:`message-bubble ${t.role} ${t.role==="system"?t.type||"info":""}`,children:t.role==="ai"||t.role==="system"&&t.type==="loading"?i.jsx("div",{className:"prose prose-sm max-w-none",children:t.role==="system"&&t.type==="loading"?i.jsxs("span",{className:"flex items-center justify-center gap-2",children:[i.jsx("span",{className:"loading-spinner"}),t.content]}):i.jsx(ws,{remarkPlugins:[Ua],children:t.content})}):i.jsx("div",{className:"whitespace-pre-wrap",children:t.content})}),t.role!=="system"&&i.jsx("span",{className:"message-timestamp",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id))]})]})},s1=e=>{if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return"";const t=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,16)},Hj=()=>{var _c,ls;const{openCommandBar:e}=Lh(),{recordId:n,patientId:t}=Xi(),[r,a]=w.useState(n||void 0),o=Rt(),l=Gr(),[d,f]=w.useState(""),[u]=w.useState([]),[h,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(void 0),[T,P]=w.useState(void 0),[M,R]=w.useState(null),[z,$]=w.useState(!1),[L,B]=w.useState(""),[q,W]=w.useState(!1),[I,F]=w.useState(null),[V,ee]=w.useState(null),[ie,Y]=w.useState(!1),[Q,ne]=w.useState(!1),[le,oe]=w.useState(null),[E,de]=w.useState(""),[he,D]=w.useState(""),[me,Ce]=w.useState(null),[te,K]=w.useState(!1),[J,xe]=w.useState(!1),[He,re]=w.useState(!1),[Be,Ae]=w.useState(window.innerHeight),[Ie,Ye]=w.useState([]),[at,Ze]=w.useState(!1),[Ke,st]=w.useState(null),[yt,je]=w.useState([]),[Ge,_e]=w.useState([]),[pe,ce]=w.useState([]),[G,fe]=w.useState(!1),[Ne,Le]=w.useState(null),tt=w.useRef(null),xt=w.useRef(null),St=w.useRef(!1),we=w.useRef(null),ye=w.useRef(null),Oe=w.useRef(null),De=w.useRef(null),Ve=w.useRef(null),ot=w.useRef(null),mt=w.useRef(null),[Nt,cn]=w.useState([]),[fn,wn]=w.useState(!1);w.useEffect(()=>{(async()=>{if(Nt.length>0&&!fn){wn(!0);const be=Nt[0];be.current&&(be.current.scrollIntoView({behavior:"smooth",block:"center"}),be.current.classList.add("ai-glow"),await new Promise(ue=>setTimeout(ue,2e3)),be.current&&be.current.classList.remove("ai-glow")),cn(ue=>ue.slice(1)),wn(!1)}})()},[Nt,fn]);const Tt=ae=>{let be=null;switch(ae){case"update_patient_details":be=Oe;break;case"create_pharmacy_order":case"edit_pharmacy_order":be=De;break;case"create_lab_order":case"edit_lab_order":be=Ve;break;case"add_complaint_history":be=ot;break;case"update_case_summary":be=mt;break}be&&cn(ue=>[...ue,be])},[Ct,Yt]=w.useState(33.33),[It,Kn]=w.useState(!1),Yr=w.useRef(null),hr=w.useRef(null),[An,Sr]=w.useState("response"),Xr=w.useRef(null),_s=w.useRef(null),Kd=150,[Xd,Zd]=w.useState([]),[js,xu]=w.useState([]),[va,ks]=w.useState(!0),[Ts,Es]=w.useState(null),[Nr,ef]=w.useState(!1),[tf,As]=w.useState(!1),[co,ec]=w.useState(!1),[nf,cl]=w.useState(!1),[ip,tc]=w.useState(!1),[uo,wr]=w.useState([]),[Ja,nc]=w.useState(!1),[Ps,rc]=w.useState(null),[ul,bu]=w.useState(!1),[ic,Zr]=w.useState(null),[fo,vu]=w.useState({}),[ac,sc]=w.useState(!1),[Ka,wu]=w.useState(!1),[di,dl]=w.useState(!1),[Su,fl]=w.useState([]),[wa,oc]=w.useState(!1),[ho,Sa]=w.useState(!1),[Xa,lc]=w.useState(!1),[hl,cc]=w.useState(!1),[uc,Nu]=w.useState(!1),[Za,es]=w.useState(!1),po=w.useMemo(()=>(b==null?void 0:b.admission_date)&&!(b!=null&&b.discharge_date),[b]),[Ds,Na]=w.useState(!1),[Cu,pl]=w.useState(null),[dc,Is]=w.useState(""),[$i,Rs]=w.useState(void 0),[Ms,Zi]=w.useState(void 0),[ml,mo]=w.useState(void 0),[ea,jn]=w.useState(!1),[kn,ts]=w.useState(null),[ei,Ca]=w.useState(null),[fc,Os]=w.useState(null),[gl,hc]=w.useState(!1),go=w.useRef(null),[nr,ns]=w.useState(null),[_a,_u]=w.useState([]),pc=w.useCallback(ae=>{_u(be=>[...be,{id:Math.random().toString(36).substr(2,9),timestamp:new Date,role:"system",content:"",...ae}])},[]),[ti,yl]=w.useState(null),xl=w.useRef(null),bl=w.useRef(null),[rf,mc]=w.useState(!1),[gc,Wr]=w.useState(!1),[Dn,ni]=w.useState(null),[yc,xc]=w.useState(""),[ri,rs]=w.useState(""),[ju,Vn]=w.useState(!0),[ii,bc]=w.useState(!1),[ku,yo]=w.useState(!1),[xo,af]=w.useState(!1),[ap,Tu]=w.useState(!1),is=w.useRef(null),bo=async()=>{is.current&&(await is.current.undoLastAction(),Tu(!1))},as=async ae=>{try{const be=await ge(`/api/patients/${ae}`);if(!be.ok){const Te=await be.json().catch(()=>({}));throw new Error(Te.message||`Failed to fetch patient details: ${be.status}`)}const ue=await be.json();if(v(ue),k(ue.age),P(ue.gender),de(ue.ai_response||""),v(Te=>Te?{...Te,current_status:ue.current_status,admission_date:ue.admission_date,discharge_date:ue.discharge_date}:{...ue,current_status:ue.current_status,admission_date:ue.admission_date,discharge_date:ue.discharge_date}),ue.insurance_type&&v(Te=>Te?{...Te,insurance_type:ue.insurance_type}:{...ue}),wo(ae),ue.ai_response){const Te=/```json\s*([\s\S]*?)\s*```/,et=ue.ai_response.match(Te);if(et&&et[1])D(ue.ai_response.replace(Te,"").trim()),Ce(et[1].trim());else{const ft=ue.ai_response.trim();if(ft.startsWith("{")&&ft.endsWith("}"))try{JSON.parse(ft),D(""),Ce(ft)}catch{D(ft),Ce(null)}else if(ft.startsWith("[")&&ft.endsWith("]"))try{JSON.parse(ft),D(""),Ce(ft)}catch{D(ft),Ce(null)}else D(ft),Ce(null)}}else D(""),Ce(null)}catch{v(null),de(""),D(""),Ce(null)}},vo=async(ae,be)=>{v(ue=>ue?{...ue,insurance_type:be}:null);try{const ue=await ge(`/api/patients/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:be})});if(!ue.ok){const Te=await ue.json();throw new Error(Te.message||"Failed to update insurance type")}}catch(ue){console.error("Error updating insurance type:",ue),ae&&as(ae)}},Eu=async ae=>{fe(!0),Le(null),ce([]);try{const be=await ge(`/api/queue/patient/${ae}/complaints`);if(!be.ok){const Te=await be.json().catch(()=>({}));throw new Error(Te.message||`HTTP error! status: ${be.status}`)}const ue=await be.json();ce(ue||[])}catch(be){Le(`Past complaints error: ${be.message}`)}finally{fe(!1)}},ja=async ae=>{je([]);try{const be=await ge(`/api/pharmacy-orders/patient/${ae}`);if(!be.ok){const Te=await be.json().catch(()=>({}));throw new Error(Te.message||`HTTP error! status: ${be.status}`)}const ue=await be.json();je(ue||[])}catch{}},ka=async ae=>{nc(!0),rc(null),wr([]);try{const be=await ge(`/api/lab/orders/patient/${ae}`);if(!be.ok){const Te=await be.json().catch(()=>({}));throw new Error(Te.message||`HTTP error! status: ${be.status}`)}const ue=await be.json();wr(ue||[])}catch(be){rc(`Pending labs error: ${be.message}`)}finally{nc(!1)}},Ls=async ae=>{Ze(!0),st(null),Ye([]);try{const be=await ge(`/api/lab/patient/${ae}`);if(!be.ok){const Te=await be.json().catch(()=>({}));throw new Error(Te.message||`HTTP error! status: ${be.status}`)}const ue=await be.json();Ye(ue||[])}catch(be){st(`Lab reports error: ${be.message}`)}finally{Ze(!1)}},Au=async ae=>{try{const be=await ge(`/api/patients/${ae}/context`);if(!be.ok){console.error("Failed to fetch patient context");return}const ue=await be.json();if(v(ue.patient),k(ue.patient.age),P(ue.patient.gender),de(ue.patient.ai_response||""),ue.patient.ai_response){const Te=/```json\s*([\s\S]*?)\s*```/,et=ue.patient.ai_response.match(Te);if(et&&et[1])D(ue.patient.ai_response.replace(Te,"").trim()),Ce(et[1].trim());else{const ft=ue.patient.ai_response.trim();if(ft.startsWith("{")&&ft.endsWith("}"))try{JSON.parse(ft),D(""),Ce(ft)}catch{D(ft),Ce(null)}else if(ft.startsWith("[")&&ft.endsWith("]"))try{JSON.parse(ft),D(""),Ce(ft)}catch{D(ft),Ce(null)}else D(ft),Ce(null)}}else D(""),Ce(null);if(es(ue.patient.current_status==="In Doctor Queue"||ue.patient.current_status==="In Consultation"),ce(Array.isArray(ue.history)?ue.history:[]),je(Array.isArray(ue.pharmacyOrders)?ue.pharmacyOrders:[]),Array.isArray(ue.labOrders)){const Te=ue.labOrders,et=Te.filter(kt=>!kt.report);wr(et);const ft=Te.filter(kt=>kt.report).map(kt=>({...kt.report,id:kt.id,patient_id:kt.patient_id,createdAt:kt.createdAt}));Ye(ft),Ye(ft)}else wr([]),Ye([]);Array.isArray(ue.recurringMedications)?_e(ue.recurringMedications):_e([])}catch(be){console.error("Error fetching patient context:",be)}},wo=async ae=>{try{const be=await ge(`/api/queue/patient/${ae}/latest`);if(!be.ok){const Te=await be.json().catch(()=>({}));throw new Error(Te.message||`Failed to fetch queue status: ${be.status}`)}const ue=await be.json();if(ue){const Te=new Date(ue.createdAt),et=new Date,ft=Te.getDate()===et.getDate()&&Te.getMonth()===et.getMonth()&&Te.getFullYear()===et.getFullYear(),kt=["waiting","consulting"].includes(ue.status);es(ft&&kt)}else es(!1)}catch(be){console.error("Error checking patient queue status:",be),es(!1)}},Ta=async(ae,be)=>{try{if(!(await ge(`/api/pharmacy-orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:be})})).ok)throw new Error("Failed to update pharmacy order date");h&&ja(h)}catch(ue){console.error("Error updating pharmacy order date:",ue),oe("Failed to update pharmacy order date")}},vc=async(ae,be,ue)=>{try{const Te={};if(be==="order"?Te.date=ue:be==="report"&&(Te.reportDate=ue),!(await ge(`/api/lab/orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Te)})).ok)throw new Error("Failed to update lab date");h&&(ka(h),Ls(h))}catch(Te){console.error("Error updating lab order date:",Te),oe("Failed to update lab order date")}},Pu=ae=>{o(`/dashboard/edit-pharmacy-order/${ae}`)},fi=ae=>{const be=ae.medications.map((ue,Te)=>({id:Date.now()+Te,medication_name:ue.name,drug_id:ue.drug_id?String(ue.drug_id):null,quantity:(ue.pack_quantity||0)*(ue.pack_price||1)+(ue.loose_quantity||0),tablets_per_day:ue.tabletsPerDay||1,number_of_days:ue.numberOfDays||30,directions:ue.directions_to_use||"",notes:"",packs:ue.pack_quantity,loose:ue.loose_quantity,pack_size:1}));fl(be),dl(!0)},wc=ae=>{oe(null),console.log(`Preparing billing navigation for order: ${ae}`);const be=yt.find(ue=>ue.id===ae);if(be){const ue=be.medications.map(Te=>{const et=Te.price??0;return(Te.price===void 0||Te.price===null)&&console.warn(`Medication "${Te.name}" in order ${ae} is missing a price. Defaulting to 0.`),{name:Te.name,pack_quantity:Te.pack_quantity,loose_quantity:Te.loose_quantity,price:et,pack_price:Te.pack_price,loose_price:Te.loose_price,total_price:Number(Te.total_price)||0,isLoose:Te.isLoose,unit:Te.unit,drug_id:Te.drug_id?String(Te.drug_id):null,tabletsPerDay:Te.tabletsPerDay,numberOfDays:Te.numberOfDays,directions_to_use:Te.directions_to_use,discount_percentage:Te.discount_percentage??0,batch:Te.batch,expiry_date:Te.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:ue}),o(`/dashboard/pharmacy-billing/${ae}`,{state:{initialItems:ue}})}else console.error(`Order with ID ${ae} not found.`),oe(`Order with ID ${ae} not found.`),alert(`Error: Could not find order ${ae} to bill.`)},So=async(ae,be)=>{oe(null);const ue=yt.find(et=>et.id===ae);if(!ue){oe(`Order with ID ${ae} not found.`);return}const Te={status:be,medications:ue.medications};try{const et=await ge(`/api/pharmacy-orders/${ae}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Te)});if(!et.ok){const kt=await et.text();throw new Error(`Failed to update status: ${et.statusText} (${et.status}) - ${kt}`)}const ft=await et.json();je(kt=>kt.map(wt=>wt.id===ft.id?{...wt,status:ft.status}:wt)),h&&ja(h)}catch(et){console.error("Failed to update order status:",et),oe(et.message||`Failed to update status for order ${ae}.`),alert(`Error updating status for order ${ae}: ${et.message||"Please try again."}`)}},No=ae=>{wr(be=>be.map(ue=>ue.id===ae?{...ue,isEditing:!0,editedTests:[...ue.tests],editedStatus:ue.status}:{...ue,isEditing:!1}))},Co=ae=>{wr(be=>be.map(ue=>ue.id===ae?{...ue,isEditing:!1,editedTests:void 0,editedStatus:void 0}:ue))},sp=(ae,be,ue,Te)=>{wr(et=>et.map(ft=>{if(ft.id===ae){const kt=ft.editedTests?[...ft.editedTests]:[...ft.tests];if(ue==="add")return{...ft,editedTests:[...kt,{id:"",name:"",price:0}]};if(ue==="remove")return{...ft,editedTests:Te};if(be!==-1){const wt={...kt[be],[ue]:Te};return kt[be]=wt,{...ft,editedTests:kt}}}return ft}))},Sc=(ae,be)=>{wr(ue=>ue.map(Te=>Te.id===ae?{...Te,editedStatus:be}:Te))},sf=async ae=>{if(!ae){console.error("Cannot navigate to billing: Lab Order data is missing."),alert("Could not open billing page: Lab Order information is missing.");return}o(`/dashboard/lab-billing/${ae.id}`)},of=async(ae,be)=>{console.log(`Updating lab order ${ae} to status ${be}`);try{const ue=await ge(`/api/lab/${ae}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:be})});if(!ue.ok){const Te=await ue.json();throw new Error(Te.message||`Failed to update lab order status: ${ue.status}`)}h&&(ka(h),Ls(h)),console.log(`Lab Order ${ae} status updated to ${be}, refetching data.`)}catch(ue){console.error("Error updating lab order status:",ue),alert(`Failed to update lab order status: ${ue instanceof Error?ue.message:"Unknown error"}`)}},Nc=ae=>{ae&&ae.id?o(`/lab/report/${ae.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the report entry page: Lab Order information is missing."))},ss=async(ae,be,ue)=>{oc(!0),oe(null);try{if(!be||be.length===0)throw new Error("Lab order must have at least one test.");for(const ft of be)if(!ft.id||!ft.name||isNaN(ft.price)||ft.price<0)throw new Error(`Invalid test data: ${JSON.stringify(ft)}. Each test must have id, name, and a valid price.`);const Te={tests:be,status:ue},et=await ge(`/api/lab/orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Te)});if(!et.ok){const ft=await et.json().catch(()=>({}));throw new Error(ft.message||`Failed to update lab order: ${et.statusText}`)}h&&ka(h),wr(ft=>ft.map(kt=>kt.id===ae?{...kt,isEditing:!1,editedTests:void 0,editedStatus:void 0}:kt))}catch(Te){oe(`Lab Order Save Error: ${Te.message}`)}finally{oc(!1)}},vl=async ae=>{if(!window.confirm(`Are you sure you want to delete this ${ae.type.toLowerCase()} record? This action cannot be undone.`))return;bu(!0),Zr(null);let ue=null,Te;const et=ae.type;try{switch(et){case"Complaint":if(Te=ae.data.id,!Te)throw new Error("Complaint ID is missing.");ue=`/api/patients/complaints/${Te}`;break;case"Lab Order":if(Te=ae.data.id,!Te)throw new Error("Lab Order ID is missing.");ue=`/api/lab/orders/${Te}`;break;case"Lab Report":if(Te=ae.data.reportId,!Te)throw new Error("Lab Report ID is missing.");ue=`/api/lab/reports/${Te}`;break;case"Pharmacy Order":if(Te=ae.data.id,!Te)throw new Error("Pharmacy Order ID is missing.");ue=`/api/pharmacy-orders/${Te}`;break;default:throw new Error(`Deletion not supported for item type: ${et}`)}if(!ue)throw new Error(`Could not determine delete URL for type: ${et}`);const ft=await ge(ue,{method:"DELETE"});if(!ft.ok){const kt=await ft.json().catch(()=>({}));throw new Error(kt.message||`Failed to delete ${et}: ${ft.statusText}`)}h&&(et==="Complaint"?Eu(h):et==="Lab Order"?(ka(h),Ls(h)):et==="Lab Report"?Ls(h):et==="Pharmacy Order"&&ja(h))}catch(ft){Zr(`Delete Error (${et}): ${ft.message}`),ul&&bu(!1)}finally{bu(!1)}},lf=async()=>{if(!h)return;if(yt.filter(be=>be.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Wr(!0);try{const be=await ge(`/api/pharmacy-orders/patient/${h}/merge-pending`,{method:"POST"});if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||"Failed to merge orders")}ja(h)}catch(be){oe(`Merge Error: ${be.message}`)}finally{Wr(!1)}},zi=w.useMemo(()=>{if(!h||!pe)return[];const ae=pe.map(be=>({date:new Date(be.createdAt),type:"Complaint",data:be,originalDateString:be.createdAt})).filter(be=>!isNaN(be.date.getTime()));return ae.sort((be,ue)=>ue.date.getTime()-be.date.getTime()),ae},[h,pe]),Ea=w.useMemo(()=>{if(!h)return[];const ae=new Map;(uo??[]).forEach(ue=>{ae.set(ue.id,{...ue})}),(Ie??[]).forEach(ue=>{if(!ae.has(ue.id))ae.set(ue.id,{id:ue.id,patient_id:ue.patient_id,tests:ue.tests,status:ue.status,createdAt:ue.createdAt,report:ue});else{const Te=ae.get(ue.id);Te&&(Te.report=ue,Te.status=ue.status)}});let be=Array.from(ae.values());return be.sort((ue,Te)=>new Date(ue.createdAt).getTime()-new Date(Te.createdAt).getTime()),be=be.map((ue,Te)=>({...ue,serialNumber:Te+1})),be.map(ue=>({date:new Date(ue.createdAt),type:"Lab Order",data:ue,originalDateString:ue.createdAt}))},[h,uo,Ie]),Lr=w.useMemo(()=>{if(!h||!yt)return[];const ae=yt.map(be=>({date:new Date(be.date),type:"Pharmacy Order",data:be,originalDateString:be.date})).filter(be=>!isNaN(be.date.getTime()));return ae.sort((be,ue)=>ue.date.getTime()-be.date.getTime()),ae},[h,yt]),[wl,cf]=w.useState(null),[uf,ai]=w.useState([]),[si,hi]=w.useState(""),Cc=(ae,be)=>{if(!ae||!ae.report_content||!be)return"";try{const ue=JSON.parse(ae.report_content||"{}");if(typeof ue!="object"||ue===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${ae.report_content}</pre>`;let Te="";return be.forEach(et=>{ue[et.id]?(Te+=`<h5 class="font-semibold text-sm mt-2 mb-1">${et.name}</h5>`,Te+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(ue[et.id]).map(([ft,kt])=>{var Xn;const wt=(Xn=et.default_parameters)==null?void 0:Xn.find(_l=>_l.name===ft);let pr="N/A";wt&&wt.type==="number"&&(wt.lower_limit!=null||wt.upper_limit!=null)?(pr="",wt.lower_limit!=null&&(pr+=` > ${wt.lower_limit}`),wt.lower_limit!=null&&wt.upper_limit!=null&&(pr+=" - "),wt.upper_limit!=null&&(pr+=` < ${wt.upper_limit}`),pr=pr.trim()||"N/A"):(wt==null?void 0:wt.type)==="boolean"?pr="N/A":wt!=null&&wt.normal_range&&(pr=wt.normal_range),Te+=`<tr><td>${ft}</td><td>${String(kt)} ${(wt==null?void 0:wt.unit)||""}</td><td>${pr}</td></tr>`}),Te+="</tbody></table>"):Te+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${et.name}.</p>`}),Te}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${ae.report_content}</pre>`}};w.useEffect(()=>{const ae=()=>{Ae(window.innerHeight)};return window.addEventListener("resize",ae),ae(),()=>window.removeEventListener("resize",ae)},[]),w.useEffect(()=>{const ae=ue=>{if(!It||!_s.current||!Xr.current)return;const Te=Xr.current.getBoundingClientRect(),ft=ue.clientX-_s.current.x;let kt=_s.current.initialWidth+ft;const wt=Te.width-Kd-10;kt=Math.max(Kd,kt),kt=Math.min(kt,wt);const pr=kt/Te.width*100;Yt(pr)},be=()=>{Kn(!1),_s.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return It&&(window.addEventListener("mousemove",ae),window.addEventListener("mouseup",be),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",ae),window.removeEventListener("mouseup",be),document.body.style.cursor="",document.body.style.userSelect=""}},[It]);const df=ae=>{if(!Xr.current)return;ae.preventDefault();const be=Xr.current.querySelector(".edit-complaint-context-column");be&&(_s.current={x:ae.clientX,initialWidth:be.offsetWidth},Kn(!0))},Du=w.useCallback(async()=>{ne(!0),oe(null);try{const ae=await ge("/api/queue/doctor/new",{method:"POST"});if(!ae.ok){const ue=await ae.json().catch(()=>({}));throw new Error(ue.message||`Failed to create record: ${ae.statusText}`)}const be=await ae.json();if(!be.recordId)throw new Error("New record ID not received from server.");o(`/edit-complaint/${be.recordId}`,{replace:!0})}catch(ae){oe(`Failed to create new complaint record: ${ae.message}`)}finally{ne(!1)}},[o]);w.useEffect(()=>{(async()=>{Vn(!0);try{const be=await ge("/api/clinics/settings");if(!be.ok){const Te=await be.json().catch(()=>({}));throw new Error(Te.message||"Failed to fetch clinic settings.")}const ue=await be.json();ni({admissionCharge:parseFloat(ue.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(ue.perDayCharge||0).toFixed(2),otherCharges:parseFloat(ue.otherCharges||0).toFixed(2),aiMemory:ue.aiMemory||"",aiMemoryUpdatedAt:ue.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:ue.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:ue.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:ue.gemini_api_key||""}),xc(ue.aiMemory||""),rs(ue.clinicWideSystemPrompt||"")}catch{}finally{Vn(!1)}})()},[]),w.useEffect(()=>{var be;(be=l.state)!=null&&be.initialComplaint&&f(l.state.initialComplaint);const ae=async ue=>{Y(!0),oe(null);try{const Te=await ge(`/api/queue/doctor/complaint/${ue}`);if(!Te.ok){const ft=await Te.json().catch(()=>({}));throw new Error(ft.message||`HTTP error! status: ${Te.status}`)}const et=await Te.json();g(et.patientId),k(et.age),P(et.gender),R(et.case_summary||null),ee(et.updatedAt||null)}catch{oe("Failed to load current complaint details."),g(null),k(void 0),P(void 0),R(null),ee(null)}finally{Y(!1)}};if(r)ae(r);else if(t){const ue=t;ue&&(g(ue),(async()=>{try{const et=await ge(`/api/queue/patient/${ue}/latest`);if(et.ok){const kt=await et.json();if(kt!=null&&kt._id){a(kt._id),ae(kt._id);return}}const ft=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:ue,complaint:"Visit Initiated"})});if(ft.ok){const kt=await ft.json();if(kt!=null&&kt.id){a(kt.id),ae(kt.id);return}}}catch(et){console.error("Background queue resolution failed",et),oe("Failed to initialize visit record.")}})())}else Du()},[r,Du,(_c=l.state)==null?void 0:_c.initialComplaint,t]),w.useEffect(()=>{h?Au(h):(v(null),ce([]),je([]),wr([]),Ye([]),ee(null),es(!1))},[h]),w.useEffect(()=>{var ue;const ae=(ue=l.state)==null?void 0:ue.initialComplaint;ae&&r&&(!ie&&!G&&!Ja&&!at&&!va)&&!St.current&&d===ae&&(St.current=!0,qe(),o(l.pathname,{replace:!0,state:{}}))},[(ls=l.state)==null?void 0:ls.initialComplaint,r,d,ie,G,Ja,at,va,o]);const Iu=()=>{B(M||""),$(!0),F(null)},op=()=>{$(!1),B(""),F(null)},_o=async()=>{if(!r){F("Missing Record ID.");return}W(!0),F(null);try{const ae=await ge(`/api/queue/doctor/complaint/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:L.trim()})});if(!ae.ok){const ue=await ae.json().catch(()=>({}));throw new Error(ue.message||`Failed to save case summary: ${ae.statusText}`)}const be=await ae.json();R(be.case_summary||L.trim()),ee(be.updatedAt||null),$(!1)}catch(ae){F(`Save Error: ${ae.message}`)}finally{W(!1)}};w.useEffect(()=>{(async()=>{ks(!0),Es(null);try{const[be,ue]=await Promise.all([ge("/api/drugs"),ge("/api/lab-tests")]);if(!be.ok)throw new Error(`Pharmacy inventory error! status: ${be.status}`);const Te=await be.json(),et=Te.drugs||Te||[];if(Zd(et),!ue.ok)throw new Error(`Lab inventory error! status: ${ue.status}`);const ft=await ue.json();xu(ft||[])}catch(be){Es(be.message)}finally{ks(!1)}})()},[]);const os=async()=>{if(!Dn)return;if(yc===Dn.aiMemory&&ri===Dn.clinicWideSystemPrompt){yo(!1);return}const ae=yc!==Dn.aiMemory,be=ri!==Dn.clinicWideSystemPrompt;ae&&bc(!0),be&&af(!0);try{const ue={...Dn};ae&&(ue.aiMemory=yc),be&&(ue.clinicWideSystemPrompt=ri);const Te=await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify(ue)});if(!Te.ok){const ft=await Te.json().catch(()=>({}));throw new Error(ft.message||"Failed to update clinic settings.")}const et=await Te.json();ni({admissionCharge:parseFloat(et.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(et.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(et.settings.otherCharges).toFixed(2),aiMemory:et.settings.aiMemory||"",aiMemoryUpdatedAt:et.settings.aiMemoryUpdatedAt||(Dn==null?void 0:Dn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:et.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:et.settings.clinicWideSystemPromptUpdatedAt||(Dn==null?void 0:Dn.clinicWideSystemPromptUpdatedAt)||null}),ae&&xc(et.settings.aiMemory||""),be&&(rs(et.settings.clinicWideSystemPrompt||""),yo(!1))}catch{}finally{ae&&bc(!1),be&&af(!1)}},Pe=()=>{Dn&&(rs(Dn.clinicWideSystemPrompt||""),yo(!0))},Qe=()=>{yo(!1),Dn&&rs(Dn.clinicWideSystemPrompt||"")},qe=async ae=>{const be=ae??d;be.trim()&&(bl.current&&(clearTimeout(bl.current),bl.current=null),pc({role:"user",content:be}),is.current&&(await is.current.callGenerativeApi(be),bl.current=setTimeout(()=>{_u([])},1e4)))},ht=ae=>{navigator.clipboard.writeText(ae).then(()=>{}).catch(be=>{console.error("Failed to copy text: ",be)})},Pt=(ae,be)=>{const ue=window.open("","_blank");ue&&(ue.document.write(`
        <html>
          <head>
            <title>${be}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${be}</h2>
            <div id="print-content">${ae}</div>
          </body>
        </html>
      `),ue.document.close(),ue.print())},hn=()=>{if(E){const ae=Uee().use(Ua).use(ere).processSync(he).toString();Pt(`<div class="prose">${ae}</div>`,"AI Response")}};w.useEffect(()=>{if(b){let ae=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${b.name||"N/A"}</p>
          <p><strong>Token:</strong> ${b.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${b.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${b.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${b.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${b.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${b.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${b.admission_date?new Date(b.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${b.discharge_date?new Date(b.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${M||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${zi.length>0?`
            <ul>
              ${zi.map(be=>`<li>${new Date(be.originalDateString).toLocaleDateString()}: ${be.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${Lr.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${Lr.map(be=>be.data.medications.map((ue,Te)=>`
                    <tr>
                      ${Te===0?`<td rowspan="${be.data.medications.length}">${new Date(be.originalDateString).toLocaleDateString()}</td>`:""}
                      ${Te===0?`<td rowspan="${be.data.medications.length}">${be.data.status}</td>`:""}
                      <td><strong>${ue.name}</strong></td>
                      <td>
                        ${ue.pack_quantity!==void 0&&ue.pack_quantity>0?`Packs: ${ue.pack_quantity}`:""}
                        ${ue.pack_quantity!==void 0&&ue.pack_quantity>0&&ue.loose_quantity!==void 0&&ue.loose_quantity>0?", ":""}
                        ${ue.loose_quantity!==void 0&&ue.loose_quantity>0?`Loose: ${ue.loose_quantity}`:""}
                      </td>
                      <td>${ue.tabletsPerDay&&ue.numberOfDays?`${ue.tabletsPerDay} tab/day for ${ue.numberOfDays} days`:"N/A"}</td>
                      <td>${ue.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${Ea.length>0?`
            ${Ea.map(be=>{const ue=be.data.tests.map(et=>et.name).join(", ");let Te="";return be.data.report&&(Te=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(be.data.report.report_date).toLocaleDateString()})</h4>
                    ${Cc(be.data.report,be.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(be.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${be.data.status}</p>
                  <p><strong>Tests:</strong> ${ue}</p>
                  ${Te}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;hi(ae)}else hi("")},[b,M,zi,Lr,Ea,Cc]);const rr=()=>{si&&Pt(si,`Patient Details - ${b==null?void 0:b.name}`)},pn=ae=>{f(ae),cf(null),ai([]),setTimeout(()=>{qe(ae)},0)},pi=ie||J||He||at||G||va||Ja||Q||Nr||tf||co||nf||ip||wa||ea||ii||xo||gc||ul||ho||Xa||hl||uc||q,ff=pi,mi=()=>{f("reports came,please anaylse"),setTimeout(()=>{qe()},0)},Sl=ae=>{vu(be=>({...be,[ae]:!be[ae]}))},lp=ae=>{ae.key==="Enter"&&!ae.shiftKey&&(ae.preventDefault(),!pi&&d.trim()&&r&&qe())};w.useEffect(()=>{const ae=window.SpeechRecognition||window.webkitSpeechRecognition;if(!ae){ns("Speech recognition not supported in this browser.");return}const be=new ae;return be.continuous=!0,be.interimResults=!0,be.lang="en-US",be.onresult=ue=>{let Te="";for(let et=ue.resultIndex;et<ue.results.length;++et)ue.results[et].isFinal&&(Te+=ue.results[et][0].transcript);Te&&f(et=>et+(et.endsWith(" ")||et===""?"":" ")+Te)},be.onerror=ue=>{ns(`Speech error: ${ue.error}`),hc(!1)},be.onend=()=>{},go.current=be,()=>{go.current&&go.current.stop()}},[]);const jo=async()=>{if(h)if(po){lc(!0);try{const ae=await ge(`/api/patients/${h}/discharge`,{method:"POST"});if(!ae.ok){const be=await ae.json().catch(()=>({}));throw new Error(be.message||`Failed to discharge patient: ${ae.status}`)}as(h)}catch(ae){oe(`Discharge Error: ${ae.message}`)}finally{lc(!1)}}else{Sa(!0);try{const ae=await ge(`/api/patients/${h}/admit`,{method:"POST"});if(!ae.ok){const be=await ae.json().catch(()=>({}));throw new Error(be.message||`Failed to admit patient: ${ae.status}`)}as(h)}catch(ae){oe(`Admit Error: ${ae.message}`)}finally{Sa(!1)}}},Nl=async ae=>{if(h){cc(!0);try{const ue=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:h})});if(!ue.ok){const Te=await ue.json().catch(()=>({}));throw new Error(Te.message||`Failed to add patient to ${ae} queue: ${ue.status}`)}alert(`Patient added to ${ae} queue successfully!`),h&&(as(h),wo(h))}catch(be){oe(`Add to Queue Error: ${be.message}`)}finally{cc(!1)}}},Cl=async()=>{if(r){Nu(!0),oe(null);try{const ae=await ge(`/api/queue/${r}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!ae.ok){const be=await ae.json().catch(()=>({}));throw new Error(be.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),h&&(as(h),wo(h))}catch(ae){oe(`Error completing consultation: ${ae.message}`)}finally{Nu(!1)}}},Sn=async()=>{if(!h){ts("Missing Patient ID.");return}if(!b){ts("Patient details not loaded.");return}jn(!0),ts(null);try{const ae={};let be=!1;if(dc!==b.name&&(ae.name=dc,be=!0),$i!==b.age&&(ae.age=$i,be=!0),Ms!==b.gender&&(ae.gender=Ms,be=!0),ml!==b.phone&&(ae.phone=ml,be=!0),!be){ts("No changes detected."),jn(!1),Na(!1);return}const ue=await ge(`/api/patients/${h}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!ue.ok){const et=await ue.json().catch(()=>({}));throw new Error(et.message||`Failed to update patient details: ${ue.statusText}`)}const Te=await ue.json();v(Te),k(Te.age),P(Te.gender),Is(Te.name),Rs(Te.age),Zi(Te.gender),mo(Te.phone),Na(!1)}catch(ae){ts(`Save Error: ${ae.message}`)}finally{jn(!1)}},Bi=w.useCallback(()=>{if(!b)return null;const ae={token_number:b.patient_token_number||"N/A",name:b.name||"N/A",age:b.age||"N/A",gender:b.gender||"N/A",phone:b.phone||"N/A"};return zi.length>0?ae.complaints_history=zi.map(be=>`${be.data.complaint} (${new Date(be.originalDateString).toLocaleDateString()})`).join("; "):ae.complaints_history="No past complaints.",Lr.length>0?ae.pharmacy_orders_history=Lr.map(be=>`Order: ${be.data.medications.map(Te=>{let et=`${Te.name}`;return Te.pack_quantity!==void 0&&Te.pack_quantity>0&&(et+=` Packs: ${Te.pack_quantity}`),Te.loose_quantity!==void 0&&Te.loose_quantity>0&&(et+=` Loose: ${Te.loose_quantity}`),et}).join(", ")} (${be.data.status}, ${new Date(be.originalDateString).toLocaleDateString()})`).join("; "):ae.pharmacy_orders_history="No pharmacy orders.",Ea.length>0?ae.lab_orders_history=Ea.map(be=>{let Te=`Lab Order: ${be.data.tests.map(et=>et.name).join(", ")} (${be.data.status}, ${new Date(be.originalDateString).toLocaleDateString()})`;return be.data.report&&(Te+=` - Report: ${be.data.report.report_content} (${new Date(be.data.report.report_date).toLocaleDateString()})`),Te}).join("; "):ae.lab_orders_history="No lab history.",ae},[b,zi,Lr,Ea]),Ru=()=>{if(!b){ns("Patient details are required to use the Live API.");return}mc(!0)},Qr=()=>{var ae;(ae=xl.current)==null||ae.click()},wi=ae=>{var ue;const be=(ue=ae.target.files)==null?void 0:ue[0];be&&yl(be)},Fs=ae=>{Sr(ae),ae==="context"&&Yr.current?Yr.current.scrollIntoView({behavior:"smooth",block:"start"}):ae==="response"&&hr.current&&hr.current.scrollIntoView({behavior:"smooth",block:"start"})};return w.useEffect(()=>{const ae=new IntersectionObserver(be=>{be.forEach(ue=>{ue.isIntersecting&&(ue.target===hr.current?Sr("response"):ue.target===Yr.current&&Sr("context"))})},{root:null,threshold:.5});return hr.current&&ae.observe(hr.current),Yr.current&&ae.observe(Yr.current),()=>{hr.current&&ae.unobserve(hr.current),Yr.current&&ae.unobserve(Yr.current)}},[]),i.jsxs("div",{className:"edit-complaint-page",style:{height:`${Be}px`},children:[i.jsx(oK,{ref:is,recordId:r,patientId:h,patientDetails:b,caseSummary:M,caseSummaryUpdatedAt:V,clinicSettings:Dn,userMessages:u,selectedImageFile:ti,pendingLabOrders:uo,labReports:Ie,pastComplaints:pe,pharmacyOrders:yt,pharmacyInventory:Xd,labInventory:js,currentComplaint:d,setCurrentComplaint:f,setAiResponse:de,setAiResponseText:D,setAiResponseJsonString:Ce,setShowAiJsonDetails:K,setIsLoadingAi:xe,setAiError:()=>{},setIsSubmittingAiOrder:ef,setAiOrderSubmissionStatus:()=>{},setIsSubmittingAiLabOrder:As,setAiLabOrderSubmissionStatus:()=>{},setIsSubmittingAiComplaint:ec,setAiComplaintSubmissionStatus:()=>{},setIsUpdatingCaseSummary:cl,setAiCaseSummaryUpdateStatus:()=>{},setCaseSummary:R,setCaseSummaryUpdatedAt:ee,setIsUpdatingAiMemoryByAI:tc,setAiMemoryUpdateByAIStatus:()=>{},setFollowUpQuestion:cf,setFollowUpOptions:ai,setError:oe,setIsSavingAiResponse:re,setSaveAiResponseError:()=>{},fetchPharmacyOrdersData:ja,fetchPendingLabOrdersData:ka,fetchLabReportsData:Ls,fetchPastComplaintsData:Eu,fetchPatientDetails:as,setClinicSettings:ni,setEditedAiMemory:xc,handleDeleteItem:vl,setCanUndo:Tu,onAiActionSuccess:Tt,addMessage:pc}),rf&&b&&i.jsx(Zb,{onClose:()=>mc(!1),patientData:Bi(),tokenNumber:b.patient_token_number?String(b.patient_token_number):null,onAiSummaryChange:ae=>{ae&&(f(ae),qe(ae),mc(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>o(-1),disabled:pi,className:"back-button",title:"Go Back",children:"< Back"}),i.jsx("span",{ref:ye,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),b&&i.jsx("div",{className:"edit-complaint-patient-details",children:b&&!Ds?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{Na(!0),Is(b.name||""),Rs(b.age),Zi(b.gender),mo(b.phone),ts(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:ea,children:i.jsx(Gl,{size:14})}),b.name??"N/A",b.patient_token_number!==null&&b.patient_token_number!==void 0&&` (${b.patient_token_number})`," - ",b.age??"N/A"," / ",b.gender??"N/A",b.phone&&` / ${b.phone}`,i.jsx("button",{onClick:ae=>{ae.stopPropagation(),rr()},disabled:!si,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(tl,{size:14})})]}):b&&Ds?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:dc,onChange:ae=>Is(ae.target.value),placeholder:"Name",className:"edit-input",disabled:ea}),i.jsx("input",{type:"number",value:$i??"",onChange:ae=>Rs(ae.target.value?parseInt(ae.target.value):null),placeholder:"Age",className:"edit-input",disabled:ea}),i.jsxs("select",{value:Ms??"",onChange:ae=>Zi(ae.target.value||null),className:"edit-input",disabled:ea,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:ml??"",onChange:ae=>mo(ae.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:ea}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{Na(!1),ts(null)},className:"button-secondary",disabled:ea,children:"Cancel"}),i.jsx("button",{onClick:Sn,className:"button-primary blue",disabled:ea,children:ea?"Saving...":"Save"})]}),kn&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:kn})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[S??"N/A"," / ",T??"N/A",i.jsx("button",{onClick:ae=>{ae.stopPropagation(),rr()},disabled:!si,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(tl,{size:14})})]})}),!b&&S!==void 0&&T!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[S??"N/A"," / ",T??"N/A",i.jsx("button",{onClick:ae=>{ae.stopPropagation(),rr()},disabled:!si,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(tl,{size:14})})]}),i.jsx("div",{style:{minWidth:"64px",display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{onClick:e,className:"icon-button small text-gray-600 hover:text-gray-900 bg-gray-100 hover:bg-gray-200",title:"Open Command Bar (Ctrl+K)",style:{padding:"0.2rem",borderRadius:"8px"},children:i.jsx(kr,{size:24})})})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:Xr,children:[_a.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"edit-complaint-chat-column",style:{width:"30%",minWidth:"320px",maxWidth:"40%",flexShrink:0},children:i.jsx(nre,{messages:_a})}),i.jsx("div",{className:"draggable-divider",onMouseDown:()=>{}})]}),i.jsxs("div",{ref:hr,className:"edit-complaint-main-column",style:{flex:1,minWidth:0},children:[le&&i.jsxs("div",{className:"general-error-message",children:["Error: ",le]}),(he||me)&&i.jsxs("div",{ref:tt,className:`${me?"ai-function-call-block":"ai-response-container"} group`,children:[he&&i.jsx(ws,{remarkPlugins:[Ua],children:he}),me&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>K(!te),className:"ai-json-toggle-button",children:[te?i.jsx(KN,{size:14,className:"mr-1"}):i.jsx(JN,{size:14,className:"mr-1"}),te?"Hide":"Show"," AI Function Call Details"]}),te&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(me),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>ht(E),disabled:!E,title:"Copy Full AI Response",children:i.jsx(iF,{size:12})}),i.jsx("button",{onClick:hn,disabled:!E,title:"Print AI Response",children:i.jsx(tl,{size:12})})]})]})]}),i.jsx("div",{className:"draggable-divider",onMouseDown:df}),i.jsx("div",{ref:Yr,className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-Ct}% - 5px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsxs("h3",{className:"ai-context-header",children:[i.jsx("span",{children:"AI Context:"}),(b==null?void 0:b.insurance_type)&&i.jsx("div",{className:"insurance-type-container mt-2",children:i.jsxs("select",{ref:we,value:b.insurance_type,onChange:ae=>vo(b.id,ae.target.value),className:"insurance-type-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),i.jsxs("div",{ref:Oe,className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),(b==null?void 0:b.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(b.admission_date).toLocaleDateString()]}),(b==null?void 0:b.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(b.discharge_date).toLocaleDateString()]}),(b==null?void 0:b.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:b.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsx("button",{onClick:jo,className:`admit-discharge-button ${po?"discharge":"admit"}`,title:po?"Discharge Patient":"Admit Patient",disabled:!h||ho||Xa,children:ho?"Admitting...":Xa?"Discharging...":po?"Discharge":"Admit"}),i.jsx("button",{onClick:()=>Nl("doctor"),className:`queue-status-button ${Za?"in-queue":"add-to-queue"}`,title:Za?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!h||hl||Za,children:hl?"Adding...":Za?"In Queue":"Add to Queue"}),i.jsx("button",{onClick:Cl,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:uc,children:uc?"Completing...":"Complete Consultation"})]})]}),i.jsx("div",{ref:De,children:i.jsx(H0,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:lf,className:"button-primary blue text-xs px-2 py-1",disabled:gc||yt.filter(ae=>ae.status==="pending").length<2,title:"Merge all pending orders into one",children:gc?"Merging...":"Merge Orders"}),i.jsxs("button",{onClick:()=>wu(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!h,children:[i.jsx(al,{size:12,className:"mr-1"})," Create Order"]})]}),items:Lr,isLoading:!1,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(ae,be)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",Lr.length-be,". Order Status: (",ae.data.status,")",i.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:Cu===ae.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",children:i.jsx("input",{type:"datetime-local",defaultValue:s1(ae.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:ue=>{ue.target.value&&Ta(ae.data.id,ue.target.value),pl(null)},onKeyDown:ue=>{if(ue.key==="Enter"){const Te=ue.target;Te.value&&Ta(ae.data.id,Te.value),pl(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:()=>pl(ae.data.id),title:"Click to edit date",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")",i.jsx(Gl,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>Pu(ae.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(Gl,{size:12})}),ae.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>Pt(ae.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(tl,{size:12})}),i.jsx("button",{onClick:()=>vl({type:"Pharmacy Order",data:ae.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(Hr,{size:12})}),ae.data.status==="pending"&&i.jsx("button",{onClick:()=>wc(ae.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:wa,children:i.jsx(Bh,{size:12})}),ae.data.status==="billed"&&i.jsx("button",{onClick:()=>So(ae.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:wa,children:i.jsx(Wa,{size:12})}),i.jsx("button",{onClick:()=>fi(ae.data),className:"icon-button small group-hover:block",title:"Add to Recurring Medications",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[i.jsx("path",{d:"m17 2 4 4-4 4"}),i.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),i.jsx("path",{d:"m7 22-4-4 4-4"}),i.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2 cursor-pointer hover:bg-gray-50 transition-colors rounded p-1",onClick:()=>Pu(ae.data.id),title:"Click to edit order",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:ae.data.medications.map((ue,Te)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:ue.name})}),i.jsxs("td",{className:"py-1 px-2",children:[ue.pack_quantity!==void 0&&ue.pack_quantity>0&&`Packs: ${ue.pack_quantity}`,ue.pack_quantity!==void 0&&ue.pack_quantity>0&&ue.loose_quantity!==void 0&&ue.loose_quantity>0&&", ",ue.loose_quantity!==void 0&&ue.loose_quantity>0&&`Loose: ${ue.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:ue.tabletsPerDay&&ue.numberOfDays?`${ue.tabletsPerDay} tab/day for ${ue.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:ue.directions_to_use||"N/A"})]},ue.drug_id||ue.name||Te))})]})}),ae.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",ae.data.prescriptionForUnavailableDrugs]})]})})}),i.jsxs("div",{className:"ai-context-section mt-4",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Recurring Medications"}),Ge.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full text-xs text-left",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",children:[i.jsx("th",{className:"py-1 px-2",children:"Medication"}),i.jsx("th",{className:"py-1 px-2",children:"Qty"}),i.jsx("th",{className:"py-1 px-2",children:"Frequency"}),i.jsx("th",{className:"py-1 px-2",children:"Next Delivery"}),i.jsx("th",{className:"py-1 px-2",children:"Status"})]})}),i.jsx("tbody",{children:Ge.map(ae=>i.jsxs("tr",{className:"border-b last:border-0 hover:bg-gray-50",children:[i.jsx("td",{className:"py-1 px-2 font-medium",children:ae.medicationName}),i.jsx("td",{className:"py-1 px-2",children:ae.quantity}),i.jsxs("td",{className:"py-1 px-2",children:[ae.frequencyDays," days"]}),i.jsx("td",{className:"py-1 px-2",children:new Date(ae.nextDeliveryDate).toLocaleDateString()}),i.jsx("td",{className:"py-1 px-2",children:i.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] ${ae.status==="active"?"bg-green-100 text-green-800":ae.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ae.status})})]},ae.id))})]})}):i.jsx("p",{className:"text-gray-500 text-sm italic",children:"No recurring medications."})]}),Ka&&i.jsx(tre,{isOpen:Ka,onClose:()=>wu(!1),patientId:h,pharmacyInventory:Xd,fetchPharmacyOrdersData:ja}),i.jsxs("div",{ref:Ve,children:[i.jsx(H0,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:mi,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:ff,children:"Analyse Reports"}),i.jsxs("button",{onClick:()=>sc(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!h,children:[i.jsx(al,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:Ea,onDeleteItem:vl,onEditLabOrder:No,onSaveLabOrder:ss,onCancelEditLabOrder:Co,onLabOrderTestChange:sp,onLabOrderStatusChange:Sc,onBillLabOrder:sf,onUpdateLabOrderStatus:of,onEnterLabReport:Nc,labInventory:js,isSavingLabOrder:wa,isLoading:Ja||at,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:fo,toggleLabReport:Sl,renderItemContent:(ae,be)=>{const ue=kJ(ae.data.report?ae.data.report.status:ae.data.status);return i.jsxs("div",{className:"ai-context-text",children:[i.jsxs("div",{onClick:()=>Nc(ae.data),className:"cursor-pointer hover:bg-gray-100 rounded p-1 inline-block -ml-1",title:"Click to enter report",children:[ae.data.serialNumber,". ",i.jsx("span",{className:"font-medium",children:"[Order]"})," ",ae.data.tests&&ae.data.tests.length>0?ae.data.tests.map(Te=>i.jsxs("strong",{children:[Te.name," (",Te.price,")"]},Te.id||Te.name)).reduce((Te,et)=>[Te,", ",et]):i.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",ae.data.tests&&ae.data.tests.length>0&&i.jsxs("span",{className:"font-bold ml-2",children:["Total: ",ae.data.tests.reduce((Te,et)=>Te+(Number(et.price)||0),0).toFixed(2)]}),"(",i.jsx("span",{className:ue.className,children:ue.text}),")"]}),i.jsx("span",{className:"text-gray-400 ml-1 inline-flex items-center",children:ei===ae.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Te=>Te.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:s1(ae.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Te=>{Te.target.value&&vc(ae.data.id,"order",Te.target.value),Ca(null)},onKeyDown:Te=>{if(Te.key==="Enter"){const et=Te.target;et.value&&vc(ae.data.id,"order",et.value),Ca(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:Te=>{Te.stopPropagation(),Ca(ae.data.id)},title:"Click to edit order date",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")",i.jsx(Gl,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),ae.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),i.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:fc===ae.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Te=>Te.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:s1(ae.data.report.report_date),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Te=>{Te.target.value&&vc(ae.data.id,"report",Te.target.value),Os(null)},onKeyDown:Te=>{if(Te.key==="Enter"){const et=Te.target;et.value&&vc(ae.data.id,"report",et.value),Os(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/reportDate ml-1",onClick:Te=>{Te.stopPropagation(),Os(ae.data.id)},title:"Click to edit report date",children:["(",new Date(ae.data.report.report_date).toLocaleDateString(),")",i.jsx(Gl,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsx("button",{onClick:()=>Sl(ae.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:fo[ae.data.report.reportId]?"Collapse Report":"Expand Report",children:fo[ae.data.report.reportId]?i.jsx(KN,{size:14}):i.jsx(JN,{size:14})})]}),fo[ae.data.report.reportId]&&(()=>{try{const Te=JSON.parse(ae.data.report.report_content||"{}");return typeof Te=="object"&&Te!==null&&ae.data.report.tests?ae.data.report.tests.map(et=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:et.name}),Te[et.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(Te[et.id]).map(([ft,kt])=>{var pr;const wt=(pr=et.default_parameters)==null?void 0:pr.find(Xn=>Xn.name===ft);return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:ft}),i.jsxs("td",{className:"py-1 px-2",children:[String(kt)," ",(wt==null?void 0:wt.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(wt&&wt.type==="number"&&(wt.lower_limit!=null||wt.upper_limit!=null)){let Xn="";return wt.lower_limit!=null&&(Xn+=` > ${wt.lower_limit}`),wt.lower_limit!=null&&wt.upper_limit!=null&&(Xn+=" - "),wt.upper_limit!=null&&(Xn+=` < ${wt.upper_limit}`),Xn.trim()||"N/A"}else if((wt==null?void 0:wt.type)==="boolean")return"N/A";return(wt==null?void 0:wt.normal_range)||"N/A"})()})]},ft)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},et.id)):i.jsx(ws,{remarkPlugins:[Ua],children:ae.data.report.report_content})}catch{return i.jsx(ws,{remarkPlugins:[Ua],children:ae.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(eK,{isOpen:ac,onClose:()=>sc(!1),patientId:h,labInventory:js,fetchPendingLabOrdersData:ka}),i.jsx("div",{ref:ot,children:i.jsx(H0,{title:"Complaints History",items:zi,isLoading:G,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(ae,be)=>i.jsxs("span",{className:"ai-context-text",children:[ae.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:vl})}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(Ob,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!ku&&i.jsx("button",{onClick:Pe,className:"edit-button",title:"Edit System Prompt",disabled:ju||ii||xo,children:i.jsx(Gl,{size:14})})]}),ku&&Dn?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:ri,onChange:ae=>rs(ae.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:ii||xo}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:Qe,disabled:ii||xo,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:os,disabled:ii||xo||yc===Dn.aiMemory&&ri===Dn.clinicWideSystemPrompt,className:"button-primary purple",children:[i.jsx(qd,{size:14,className:"mr-1"}),xo||ii?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:Dn!=null&&Dn.clinicWideSystemPrompt?i.jsx(ws,{remarkPlugins:[Ua],children:Dn.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!ku&&(Dn==null?void 0:Dn.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(Dn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{ref:mt,className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!z&&i.jsx("button",{onClick:Iu,className:"edit-button",title:"Edit Case Summary",disabled:ie||q,children:i.jsx(Gl,{size:14})})]}),z?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:L,onChange:ae=>B(ae.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:q}),I&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:I}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:op,disabled:q,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:_o,disabled:q||L===M,className:"button-primary blue",children:q?"Saving...":"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:M?i.jsx(ws,{remarkPlugins:[Ua],components:{},children:M}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),V&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(V).toLocaleDateString()]})]})]}),zi.length===0&&Ea.length===0&&Lr.length===0&&!(G||Ja||at)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),ul&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),ic&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:ic})]})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsx("div",{className:"mobile-section-selector",children:i.jsxs("div",{className:"selector-container",children:[i.jsx("button",{onClick:()=>Fs("response"),className:`selector-button ${An==="response"?"active":""}`,children:"AI Response"}),i.jsx("button",{onClick:()=>Fs("context"),className:`selector-button ${An==="context"?"active":""}`,children:"AI Context"})]})}),i.jsxs("div",{className:"status-messages-container",children:[Ke&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ke}),Ne&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ne}),Ps&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ps}),Ts&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ts})]}),r&&!Q&&i.jsxs(w.Fragment,{children:[wl&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:wl}),uf.length>0&&i.jsx("div",{className:"options-grid",children:uf.map((ae,be)=>i.jsx("button",{onClick:()=>pn(ae),className:"option-button",children:ae},be))})]}),nr&&i.jsx("div",{className:"speech-error-display",children:nr}),ti&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",ti.name]}),i.jsx("button",{onClick:()=>{yl(null),xl.current&&(xl.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:xl,onChange:wi,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:xt,className:"complaint-textarea",value:d,onChange:ae=>f(ae.target.value),onKeyDown:lp,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:pi||!r||gl}),i.jsxs("div",{className:"chat-input-actions-container",children:[h&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>o(`/patient/${h}/lab-reports`),disabled:at||!h,className:"icon-button",title:"View Lab Reports",children:i.jsx(Jl,{size:14})}),i.jsx("button",{onClick:()=>o("/inventory"),disabled:va,className:"icon-button",title:"View Inventory",children:i.jsx(Bd,{size:14})})]}),i.jsx("button",{type:"button",onClick:Qr,disabled:pi||!r||gl,className:"icon-button",title:"Attach Image",children:i.jsx(Rb,{size:14})}),i.jsx("button",{type:"button",onClick:Ru,disabled:pi||!r||!go.current,className:`mic-button ${gl?"listening":""}`,title:gl?"Stop":"Mic",children:i.jsx(hg,{size:14})}),i.jsx("button",{onClick:()=>qe(),disabled:pi||!d.trim()||!r||gl,className:"send-button",title:pi?"Processing...":"Save & Ask AI",children:pi?i.jsx("div",{className:"custom-loader-circle",role:"status","aria-label":"loading"}):i.jsx(w1,{size:14})}),ap&&i.jsx("button",{type:"button",onClick:bo,disabled:pi,className:"icon-button text-red-500",title:"Undo Last AI Actions",children:i.jsx(Hr,{size:14})})]})]})})]})]}),di&&i.jsx(OA,{isOpen:di,onClose:()=>dl(!1),onSuccess:()=>{h&&Au(h)},initialItems:Su,initialPatient:b?{id:b.id,name:b.name,phone:b.phone||"",patient_token_number:String(b.patient_token_number||"")}:void 0})]})},rre=()=>{const{patientId:e}=Xi(),n=Rt(),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(!1),[f,u]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){u("Patient ID not provided.");return}d(!0),u(null);try{const b=await ge(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();o({name:v.name,age:v.age,gender:v.gender});const S=await ge(`/api/patients/${e}/complaints`);if(S.ok){const T=(await S.json()).sort((P,M)=>new Date(M.createdAt).getTime()-new Date(P.createdAt).getTime());r(T)}else if(S.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),u(`Failed to load data. ${b.message}`),r([]),o(null)}finally{d(!1)}})()},[e]);const h=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),f&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",f]}),l&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!f&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>h(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Bx=500,Gj="defaultConsultationFee",ire=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:o=[],billType:l="other",relatedId:d,initialStatus:f="pending",initialDiscountPercentage:u=0,readOnlyMode:h=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[T,P]=w.useState([]),M=w.useRef([]),[R,z]=w.useState(""),[$,L]=w.useState(""),[B,q]=w.useState(1),[W,I]=w.useState(u),[F,V]=w.useState("cash"),[ee,ie]=w.useState(!1),[Y,Q]=w.useState(null),[ne,le]=w.useState(!1),[oe,E]=w.useState(!1),[de,he]=w.useState(!1),[D,me]=w.useState(null),[,Ce]=w.useState([]),[te,K]=w.useState(null),[J,xe]=w.useState(""),[He,re]=w.useState("cash"),[Be,Ae]=w.useState(!1),[Ie,Ye]=w.useState(Bx),[at,Ze]=w.useState(Bx.toString()),Ke=n?"view_pay":"create";w.useEffect(()=>{const ye=localStorage.getItem(Gj),Oe=ye?parseFloat(ye):Bx;isNaN(Oe)||(Ye(Oe),Ze(Oe.toString()))},[]);const st=o.length===0;w.useEffect(()=>{e?(async()=>{ie(!0),Q(null);try{const Oe=await ge(`/api/patients/${e}`);if(!Oe.ok){const Ve=await Oe.json().catch(()=>({}));throw new Error(Ve.message||"Failed to fetch patient details")}const De=await Oe.json();k(De)}catch(Oe){Q(`Failed to load patient details: ${Oe.message}`),k(null)}finally{ie(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{he(!0),Q(null),me(null),Ce([]),K(null);try{const Oe=await ge(`/api/bills/${n}`);if(!Oe.ok){const Ve=await Oe.json().catch(()=>({}));throw new Error(Ve.message||"Failed to fetch bill details")}const De=await Oe.json();if(!De.bill||!De.payments||!De.calculated)throw new Error("Invalid bill details structure.");me(De.bill),Ce(De.payments),K(De.calculated),I(De.bill.discount_percentage!==void 0&&De.bill.discount_percentage!==null?parseFloat(De.bill.discount_percentage.toString()):0),!S&&De.bill.patient_id&&yt(De.bill.patient_id.toString())}catch(Oe){Q(`Failed to load bill details: ${Oe.message}`),me(null),Ce([]),K(null)}finally{he(!1)}})():(me(null),Ce([]),K(null))},[n]);const yt=async ye=>{ie(!0);try{const Oe=await ge(`/api/patients/${ye}`);if(!Oe.ok)throw new Error("Failed to fetch patient");const De=await Oe.json();k(De)}catch(Oe){console.error("Error fetching patient details:",Oe),k(null)}finally{ie(!1)}},je=w.useCallback(async ye=>{E(!0),Q(null);const Oe=ye.filter(De=>De.drug_id!=null).map(async De=>{try{const Ve=await ge(`/api/drugs/${De.drug_id}`);if(!Ve.ok)throw new Error(`Drug ${De.drug_id} not found.`);const ot=await Ve.json();return{...De,price:ot.price,total:ot.price*De.quantity}}catch{return Q(ot=>`${ot?ot+"; ":""}Failed to fetch price for ${De.name}`),De}});try{const De=await Promise.all(Oe);P(Ve=>{const ot=new Map(De.map(mt=>[mt.id,mt]));return Ve.map(mt=>ot.get(mt.id)||mt)})}catch{}finally{E(!1)}},[ge]);w.useEffect(()=>{if(n){P([]),M.current=[];return}JSON.stringify(o)===JSON.stringify(M.current)||(async()=>{let De=[];if(o&&o.length>0)De=o.map((Ve,ot)=>({...Ve,id:`initial-${ot}-${Date.now()}`})),V(f==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),I(u),l==="pharmacy"&&!h&&await je(De);else if(e&&st&&l==="consultation"){let Ve=Ie;if(g)try{const ot=await ge(`/api/staff/${g}`);if(!ot.ok){const Nt=await ot.json().catch(()=>({}));throw new Error(Nt.message||"Doctor not found or error fetching fee")}const mt=await ot.json();mt.opd_fee!=null&&!isNaN(parseFloat(String(mt.opd_fee)))&&parseFloat(String(mt.opd_fee))>=0&&(Ve=parseFloat(String(mt.opd_fee)))}catch(ot){Q(mt=>`${mt?mt+"; ":""}Could not fetch doctor's fee, using default. (${ot.message})`)}De=[{id:Date.now(),name:"Consultation Fee",price:Ve,quantity:1,total:Ve*1,drug_id:null}],V(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else De=[],V(v==="no_cash_insurance"?"no_cash_insurance":"cash");P(De),M.current=o})()},[n,e,g,o,l,Ie,st,f,h,je,u,v]);const Ge=()=>{const ye=parseFloat($);if(!h)if(R&&!isNaN(ye)&&ye>=0&&B>0){if(R.trim().toLowerCase()==="consultation fee"&&T.some(De=>De.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Oe={id:Date.now(),name:R.trim(),price:ye,quantity:B,total:ye*B,drug_id:null};P([...T,Oe]),z(""),L(""),q(1)}else alert("Invalid item details.")},_e=ye=>{h||P(T.filter(Oe=>Oe.id!==ye))},pe=w.useMemo(()=>{let ye=T.reduce((Oe,De)=>Oe+De.total,0);return Ke==="create"&&W>0&&(ye=ye*(1-W/100)),(te==null?void 0:te.totalDue)!==void 0&&(te==null?void 0:te.totalDue)!==null?te.totalDue:ye},[T,te,W,Ke]),ce=w.useMemo(()=>(te==null?void 0:te.totalPaid)??0,[te]),G=w.useMemo(()=>(te==null?void 0:te.balance)!==void 0&&(te==null?void 0:te.balance)!==null?te.balance:pe-ce,[te,pe,ce]),fe=()=>{const ye=parseFloat(at);!isNaN(ye)&&ye>=0?(Ye(ye),localStorage.setItem(Gj,ye.toString()),alert(`Default Fee set to ${ye.toFixed(2)}`)):alert("Invalid fee amount.")},Ne=async(ye,Oe)=>{le(!0),Q(null);try{const De=await ge("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Oe,billId:ye})}),Ve=await De.json();if(!De.ok||!Ve.order)throw new Error(Ve.message||"Failed to create Razorpay order.");const{key_id:ot,order:mt}=Ve,Nt={key:ot,amount:mt.amount,currency:mt.currency,name:"Newtons Ai HMS Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:mt.id,handler:async function(cn){try{const fn=await ge("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:cn.razorpay_payment_id,razorpay_order_id:cn.razorpay_order_id,razorpay_signature:cn.razorpay_signature,billId:ye})}),wn=await fn.json();if(fn.ok&&wn.success)alert("Payment Successful!"),r&&r(ye),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(wn.message||"Payment verification failed.")}catch(fn){Q(`Payment verification failed: ${fn.message}. Contact support.`)}finally{le(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:ye,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){Q("Payment cancelled."),le(!1)}}};if(window.Razorpay)new window.Razorpay(Nt).open();else throw new Error("Razorpay SDK not loaded.")}catch(De){Q(`Failed to initiate online payment: ${De.message}`),le(!1)}},Le=async()=>{if(!n){Q("Bill ID is missing.");return}if(!J||isNaN(parseFloat(J))||parseFloat(J)<=0){Q("Please enter a valid positive payment amount.");return}Ae(!0),Q(null);const ye={amount_paid:parseFloat(J),payment_mode:He};try{const Oe=await ge(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ye)}),De=await Oe.json();if(!Oe.ok)throw new Error(De.message||`Failed to record payment (Status: ${Oe.status})`);alert(`Payment of ${ye.amount_paid.toFixed(2)} recorded.`),xe(""),a?a():console.log("Payment recorded.")}catch(Oe){Q(`Failed to record payment: ${Oe.message}`)}finally{Ae(!1)}},tt=async()=>{if(Ke==="view_pay")return;if(!e){Q("Patient ID is missing for creating a bill.");return}if(T.length===0){Q("Cannot finalize an empty bill.");return}le(!0),Q(null);const ye=pe,Oe=T.map(({id:De,...Ve})=>Ve);if(F==="online"){const De={patientId:e,queueId:t||null,items:Oe,amount:ye,paymentMode:"online",type:l,related_id:d||b||null,status:"pending",discountPercentage:W,labOrderId:b||null};try{const Ve=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(De)}),ot=await Ve.json();if(!Ve.ok)throw new Error(ot.message||"Failed to create pending bill.");Ne(ot.id,Math.round(ye*100))}catch(Ve){Q(`Failed to create pending bill: ${Ve.message}`),le(!1)}}else{const De="paid";if(!F){Q("Payment mode required."),le(!1);return}const Ve={patientId:e,queueId:t||null,items:Oe,amount:ye,paymentMode:F,type:l,related_id:d||b||null,status:De,discountPercentage:W,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const ot=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ve)}),mt=await ot.json();if(!ot.ok)throw new Error(mt.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(mt.id),le(!1)}catch(ot){Q(`Failed to process bill: ${ot.message}`),le(!1)}}},xt=(D==null?void 0:D.type)??l,St=(D==null?void 0:D.status)??f,we=Ke==="view_pay"&&D&&St==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):ee||Ke==="view_pay"&&de?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):Ke==="view_pay"&&!D&&!de&&Y?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",Y]}):Ke==="create"&&!S&&!ee&&Y?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",Y]}):i.jsxs("div",{className:"billing-component-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:Ke==="create"?"Create Bill":"Bill Details"}),Ke==="create"&&l==="consultation"&&!h&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),i.jsx("input",{id:"defaultFee",type:"number",value:at,onChange:ye=>Ze(ye.target.value),className:"",placeholder:Bx.toString(),disabled:h}),i.jsx("button",{onClick:fe,title:"Set Default Fee",className:"",disabled:h,children:i.jsx(qd,{size:16})})]})]}),Y&&!de&&!Be&&i.jsxs("div",{className:"error-message",role:"alert",children:[i.jsx("strong",{children:"Error: "}),Y]}),S&&i.jsxs("div",{className:"patient-details-section",children:[i.jsx("h3",{children:"Patient Details"}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",S.id]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",S.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",i.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),i.jsxs("div",{className:"bill-items-summary-section",children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:Ke==="create"?"Bill Items":"Billing Summary"}),Ke==="create"&&l==="pharmacy"&&!h&&T.some(ye=>ye.drug_id!=null)&&i.jsxs("button",{onClick:()=>je(T),disabled:oe,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[i.jsx(N1,{size:14,className:`lucide ${oe?"animate-spin":""}`}),oe?"Refreshing...":"Refresh"]})]}),Ke==="view_pay"&&D&&i.jsxs("div",{className:"bill-info-bar",children:[i.jsxs("span",{children:["Bill ID: ",i.jsx("strong",{children:D.id})]}),i.jsxs("span",{children:["Type: ",i.jsx("strong",{className:"capitalize",children:xt})]}),i.jsxs("span",{children:["Status: ",i.jsx("strong",{className:`capitalize ${St==="paid"?"status-paid":"status-pending"}`,children:St})]})]}),(Ke==="create"||Ke==="view_pay"&&D)&&i.jsxs("div",{className:"bill-items-list",children:[Ke==="create"&&oe&&T.length>0&&i.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),Ke==="create"&&!oe&&T.map((ye,Oe)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Oe+1,". ",ye.name]}),ye.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ye.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",ye.total.toFixed(2)]}),Ke==="create"&&typeof ye.id=="number"&&!h&&i.jsxs("button",{onClick:()=>_e(ye.id),className:"remove-item-button",title:"Remove",children:[" ",i.jsx(_n,{size:16})," "]}),(typeof ye.id!="number"||h||ye.name==="Consultation Fee")&&i.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",i.jsx(XN,{size:14})," "]})]})]},ye.id)),Ke==="view_pay"&&D&&D.items.map((ye,Oe)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Oe+1,". ",ye.name]}),ye.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ye.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",(ye.total??ye.price*ye.quantity).toFixed(2)]}),i.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",i.jsx(XN,{size:14})," "]})]})]},Oe)),Ke==="create"&&T.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items added."}),Ke==="view_pay"&&D&&D.items.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),Ke==="create"&&!h&&i.jsxs("div",{className:"add-item-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Item"}),i.jsx("input",{type:"text",value:R,onChange:ye=>z(ye.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:B,onChange:ye=>q(parseInt(ye.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[i.jsx("label",{children:"Price ()"}),i.jsx("input",{type:"number",value:$,onChange:ye=>L(ye.target.value),placeholder:"0.00",className:"custom-text-input"})]}),i.jsx("button",{onClick:Ge,className:"add-item-button",children:"Add"})]})]})," ",i.jsxs("div",{className:"billing-footer",children:[i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),i.jsxs("span",{className:"total-amount-value",children:["",typeof pe=="number"?pe.toFixed(2):"0.00"]}),Ke==="create"&&!h&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),i.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:W,onChange:ye=>I(parseFloat(ye.target.value)||0),className:"",disabled:h||ne})]}),Ke==="view_pay"&&D&&(D.status==="pending"||D.status==="paid")&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),i.jsxs("span",{className:"discount-value",children:[W.toFixed(2),"%"]})]})]}),Ke==="view_pay"&&te&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),i.jsxs("span",{className:"total-amount-value",children:["",ce.toFixed(2)]})]}),Ke==="view_pay"&&te&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),i.jsxs("span",{className:"total-amount-value",children:["",G.toFixed(2)]})]}),i.jsxs("div",{className:"footer-actions",children:[Ke==="create"&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:F,onChange:ye=>V(ye.target.value),className:"custom-select-input",disabled:h||ne,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("button",{onClick:tt,disabled:ne||T.length===0||h,className:"finalize-button",children:ne?"Processing...":"Finalize Bill"})]}),Ke==="view_pay"&&we&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Record Payment Amount ()"}),i.jsx("input",{type:"number",value:J,onChange:ye=>xe(ye.target.value),placeholder:`Max: ${G.toFixed(2)}`,className:"custom-text-input",disabled:Be})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:He,onChange:ye=>re(ye.target.value),className:"custom-select-input",disabled:Be,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{onClick:Le,disabled:Be||!J||parseFloat(J)<=0||parseFloat(J)>G,className:"record-payment-button",children:Be?"Recording...":"Record Payment"})]}),Ke==="create"&&h&&T.length>0&&i.jsx("div",{className:"status-message read-only",children:"Read-only."}),Ke==="view_pay"&&St==="paid"&&i.jsx("div",{className:"status-message paid",children:"PAID."}),Ke==="view_pay"&&St==="cancelled"&&i.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},are=()=>{const e=Rt(),n=Gr(),{patientId:t,queueId:r,patientName:a,initialItems:o,billType:l,relatedId:d,initialStatus:f,initialDiscountPercentage:u,doctorId:h,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,T]=w.useState(null),[P,M]=w.useState(null),[R,z]=w.useState(null),[$,L]=w.useState(null),[B,q]=w.useState(null),[W,I]=w.useState(null),[F,V]=w.useState(null),[ee,ie]=w.useState(!0),[Y,Q]=w.useState(null),[ne,le]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{ie(!0),Q(null);try{let me=t,Ce=o||null,te=f||null,K=l||null,J=d||null,xe=u!==void 0?parseFloat(u):null,He=a||null,re=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Be=await ge(`/api/bills/${g}`);if(!Be.ok){const Ie=await Be.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(Ie.message||`Failed to fetch bill details (Status: ${Be.status})`)}const Ae=await Be.json();if(console.log("Fetched Bill Data:",Ae),Ce=Ae.bill.items||[],te=Ae.bill.status||"pending",K=Ae.bill.type||null,J=Ae.bill.related_id||null,xe=Ae.bill.discount_percentage!==void 0&&Ae.bill.discount_percentage!==null?parseFloat(Ae.bill.discount_percentage):0,me=Ae.bill.patient_id,z(Ce),L(te),q(K),I(J),V(xe),me){const Ie=await ge(`/api/patients/${me}`);if(Ie.ok){const Ye=await Ie.json();He=Ye.name,re=Ye.phone??null,M(Ye.insurance_type??null),le(He),T(re)}else console.warn(`Could not fetch patient details for ID ${me} from bill.`),le("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),le("Patient (Unknown)")}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Be=await ge(`/api/lab/${b}`);if(!Be.ok){let Ie=`Failed to fetch lab order details (Status: ${Be.status} ${Be.statusText})`;try{Ie=(await Be.json()).message||Ie}catch{console.error("Response was not valid JSON:",await Be.text())}throw new Error(Ie)}const Ae=await Be.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(Ae,null,2)),Ce=(Ae.tests||[]).filter(Ie=>Ie&&typeof Ie.name=="string"&&Ie.price!==void 0&&Ie.id!==void 0).map(Ie=>{const Ye=parseFloat(Ie.price||"0"),at=!isNaN(Ye)&&isFinite(Ye)?Ye:0;return{item_id:Ie.id,name:Ie.name,price:at,quantity:1,total:at*1,type:"lab_test"}}),Ce&&Ce.length===0&&(Ae.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",Ae.tests),Q(Ie=>`${Ie?Ie+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),te="pending",K="lab",J=b,me=Ae.patient_id,z(Ce),L(te),q(K),I(J),me){const Ie=await ge(`/api/patients/${me}`);if(Ie.ok){const Ye=await Ie.json();He=Ye.name,re=Ye.phone??null,M(Ye.insurance_type??null),le(He),T(re)}else console.warn(`Could not fetch patient details for ID ${me} from lab order.`),le("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),le("Patient (Unknown)")}else if(z(o||null),L(f||null),q(l||null),I(d||null),V(u!==void 0?parseFloat(u):null),le(a||`ID ${t}`),me){const Be=await ge(`/api/patients/${me}`);if(Be.ok){const Ae=await Be.json();T(Ae.phone??null),M(Ae.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${me}.`)}if(r){const Be=await ge(`/api/queue/${r}`);if(Be.ok){const Ae=await Be.json();S(Ae.token_number)}else console.warn(`Could not fetch queue details for ID ${r}.`)}}catch(me){console.error("Error fetching billing page details:",me),Q(`Failed to load details: ${me.message}`),z(null),L(null),q(null),I(null),le(a||""),T(null),S(null)}finally{ie(!1)}})()},[t,g,b,r,e]);const oe=D=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${D}`),e(-1)},E=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(ZN,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(ee)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(Y)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(ZN,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:Y}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const he=($??f)==="paid";return i.jsxs("div",{className:"billing-page-container",children:[i.jsx("div",{className:"back-button-container",children:i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(sn,{size:20,className:"lucide"})," Back"]})}),i.jsxs("div",{className:"billing-content-wrapper",children:[i.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",ne||`ID ${t}`]}),i.jsxs("div",{className:"patient-info-bar",children:[v!==null&&i.jsxs("span",{children:[i.jsx(tg,{size:14,className:"lucide"})," Token: ",v]}),k&&i.jsxs("span",{children:[i.jsx(Bk,{size:14,className:"lucide"})," Phone: ",k]}),b&&i.jsxs("span",{className:"lab-order-info",children:[i.jsx(io,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),P&&i.jsxs("span",{className:"insurance-info",children:[i.jsx(o6,{size:14,className:"lucide"})," Insurance: ",P.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase())]}),!k&&v===null&&!b&&!P&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),i.jsx(ire,{patientId:t,labOrderId:b,queueId:r,onBillCreated:oe,onBillUpdated:E,initialItems:R??o,billType:B??l,relatedId:W??d,initialStatus:$??f,initialDiscountPercentage:F??u,readOnlyMode:he,doctorId:h,patientInsuranceType:P??void 0})]})]})},sre=()=>{const{patientId:e}=Xi(),n=Rt(),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided in URL.");return}o(!0),d(null),r([]);try{try{const v=await ge(`/api/patients/${e}`);if(v.ok){const S=await v.json();u(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await ge(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),d(`Failed to load pharmacy orders: ${g.message}`)}finally{o(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(sn,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(Bd,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",f&&`for ${f}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(h=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(h.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",h.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",h.prescribedBy||"N/A"]}),h.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",h.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:h.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},h.id))})]})},ore=()=>{const e=Rt(),n=Gr(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState([]),[f,u]=w.useState(""),[h,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState(null),[M,R]=w.useState(!0),[z,$]=w.useState(""),[L,B]=w.useState([]),[q,W]=w.useState(!1),[I,F]=w.useState(null),[V,ee]=w.useState(!1),[ie,Y]=w.useState(!1),[Q,ne]=w.useState([]),[le,oe]=w.useState(!1),[E,de]=w.useState(null),he=/^\+?[0-9\s\-().]{7,20}$/,D=/^[a-zA-Z\s'-]{2,}$/,me=w.useCallback(async()=>{try{const je=await ge("/api/drugs");if(!je.ok)throw new Error("Failed to fetch drugs");const Ge=await je.json(),_e=Ge.drugs||Ge||[];o(_e)}catch(je){console.error("Failed to fetch available drugs:",je),v("Could not load drug list. "+je.message)}},[]),Ce=w.useCallback(async je=>{oe(!0),de(null);try{const Ge=await ge(`/api/pharmacy-orders/patient/${je}`);if(!Ge.ok){const pe=await Ge.json().catch(()=>({}));throw new Error(pe.message||`HTTP error! status: ${Ge.status}`)}const _e=await Ge.json();ne(_e||[])}catch(Ge){console.error("Failed to fetch previous pharmacy orders:",Ge),de(`Could not load previous orders: ${Ge.message}`)}finally{oe(!1)}},[]);w.useEffect(()=>{var je;me(),(je=n.state)!=null&&je.patient?J(n.state.patient):R(!0)},[me,n.state]),w.useEffect(()=>{t!=null&&t.id?Ce(t.id):ne([])},[t,Ce]),w.useEffect(()=>{if(!f){g([]);return}const je=f.toLowerCase();g(a.filter(Ge=>{const _e=Ge.name&&Ge.name.toLowerCase().includes(je),pe=Ge.brand_name&&Ge.brand_name.toLowerCase().includes(je);return _e||pe}).slice(0,10))},[f,a]);const te=w.useMemo(()=>yg(async je=>{if(je.trim().length<2){B([]),W(!1),F(null);return}W(!0),F(null);try{const Ge=new URLSearchParams({search:encodeURIComponent(je),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),_e=await ge(`/api/patients?${Ge.toString()}`);if(!_e.ok){const ce=await _e.text();throw new Error(`API Error (${_e.status}): ${ce||_e.statusText}`)}const pe=await _e.json();B(pe.patients)}catch(Ge){console.error("Error searching patients:",Ge),F(Ge.message||"Failed to search patients."),B([])}finally{W(!1)}},300),[he]),K=je=>{const Ge=je.target.value;$(Ge),ee(he.test(Ge)),Y(D.test(Ge)&&!he.test(Ge)),W(!0),te(Ge)},J=w.useCallback(je=>{r(je),R(!1),$(""),B([]),F(null)},[]),xe=w.useCallback(async je=>{if(!z||je==="phone"&&!V||je==="name"&&!ie){F(`Invalid ${je} to create a new patient.`);return}W(!0),F(null);try{const _e=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:je==="name"?z:"direct pharmacy",phone:je==="phone"?z:null,age:null,gender:null,token:null})});if(!_e.ok){const ce=await _e.json();throw new Error(ce.message||`Failed to create patient: ${_e.statusText}`)}const pe=await _e.json();alert(`New patient "${pe.name}" created with ${je==="phone"?`phone ${pe.phone}`:`name ${pe.name}`}.`),J(pe)}catch(Ge){console.error("Error creating new patient:",Ge),F(Ge.message||"Failed to create new patient.")}finally{W(!1)}},[z,V,ie,J]),He=()=>{r(null),R(!0),d([]),v(null),ne([])},re=je=>{if(l.some(Ge=>Ge.drug_id===je.id)){const Ge=je.name||je.brand_name||"This drug";v(`${Ge} is already in the order.`),setTimeout(()=>v(null),3e3),u(""),g([]);return}d(Ge=>[...Ge,{drug_id:je.id,name:je.name||je.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,mrp:Number(je.mrp)||0,originalMrp:Number(je.mrp)||0,stock:je.stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(je.mrp)||0)/(Ae(je.pack)||1),pack:je.pack}]),u(""),g([])},Be=()=>{const je=f.trim();if(!je){v("Please enter a drug name to navigate to the add drug page."),setTimeout(()=>v(null),3e3);return}e("/dashboard/inventory/add",{state:{initialDrugName:je}}),u(""),g([])},Ae=je=>{if(!je)return null;const Ge=je.match(/(?:\d+x)?(\d+)/);return Ge?parseInt(Ge[1],10):null},Ie=je=>{d(Ge=>Ge.filter(_e=>(_e.drug_id??_e.name)!==je))},Ye=(je,Ge)=>{d(_e=>_e.map(pe=>{if((pe.drug_id??pe.name)===je&&pe.isLoose){const G=Ae(pe.pack),fe=Math.max(0,Ge),Ne=fe*(G??1)+(pe.looseUnits??0);return{...pe,loosePacks:fe,looseQuantity:Ne,pack_quantity:fe}}return pe}))},at=(je,Ge)=>{d(_e=>_e.map(pe=>{if((pe.drug_id??pe.name)===je&&pe.isLoose){const G=Ae(pe.pack),fe=Math.max(0,Ge),Ne=(pe.loosePacks??0)*(G??1)+fe;return{...pe,looseUnits:fe,looseQuantity:Ne}}return pe}))},Ze=je=>{const Ge=[];je.medications.forEach(_e=>{if(l.find(ce=>ce.drug_id&&_e.drug_id&&ce.drug_id===_e.drug_id||ce.name.toLowerCase()===_e.name.toLowerCase()))d(ce=>ce.map(G=>{if(G.drug_id&&_e.drug_id&&G.drug_id===_e.drug_id||G.name.toLowerCase()===_e.name.toLowerCase()){const fe=(G.pack_quantity??0)+(_e.pack_quantity??0),Ne=(G.loose_quantity??0)+(_e.loose_quantity??0),Le=_e.tabletsPerDay??G.tabletsPerDay,tt=_e.numberOfDays??G.numberOfDays,xt=Ae(G.pack),St=fe*(xt??1)+Ne;return{...G,pack_quantity:fe,loose_quantity:Ne,directions_to_use:_e.directions_to_use??G.directions_to_use,tabletsPerDay:Le,numberOfDays:tt,looseQuantity:St,loosePacks:Math.floor(St/(xt??1)),looseUnits:St%(xt??1)}}return G}));else{let ce=_e.drug_id,G=_e.drug_id?a.find(fe=>fe.id===_e.drug_id):void 0;if(!ce&&_e.name){const fe=a.find(Ne=>Ne.name&&Ne.name.toLowerCase()===_e.name.toLowerCase());fe&&(ce=fe.id,G=fe)}Ge.push({drug_id:ce,name:_e.name,pack_quantity:_e.pack_quantity??0,loose_quantity:_e.loose_quantity??0,directions_to_use:_e.directions_to_use,tabletsPerDay:_e.tabletsPerDay??1,numberOfDays:_e.numberOfDays??1,mrp:G?G.mrp:_e.pack_price,originalMrp:G?G.mrp:_e.pack_price,stock:G?G.stock:_e.stock,isLoose:!0,loosePacks:0,looseUnits:(_e.pack_quantity??0)*(Ae((G==null?void 0:G.pack)||_e.pack)??1)+(_e.loose_quantity??0),looseQuantity:(_e.pack_quantity??0)*(Ae((G==null?void 0:G.pack)||_e.pack)??1)+(_e.loose_quantity??0),pricePerLooseUnit:(G?Number(G.mrp):Number(_e.pack_price)||0)/(Ae((G==null?void 0:G.pack)||_e.pack)||1),pack:(G==null?void 0:G.pack)||_e.pack})}}),d(_e=>[..._e,...Ge]),je.prescriptionForUnavailableDrugs&&(!T||!T.includes(je.prescriptionForUnavailableDrugs))&&P(_e=>_e?`${_e}

-- From Order ${je.id.substring(0,8)} --
${je.prescriptionForUnavailableDrugs}`:je.prescriptionForUnavailableDrugs),v("Medications from previous order added to current order."),setTimeout(()=>v(null),3e3)},Ke=async je=>{if(je.preventDefault(),v(null),k(!0),!t){v("No patient selected for the order."),k(!1);return}if(l.length===0&&!(T!=null&&T.trim())){v("Please add at least one medication or provide a prescription for unavailable drugs."),k(!1);return}const Ge=l.filter(pe=>{const ce=pe.looseQuantity??0;return ce<=0||pe.stock!==void 0&&ce>pe.stock});if(Ge.length>0){v(`Invalid quantity or insufficient stock for: ${Ge.map(pe=>pe.name).join(", ")}`),k(!1);return}const _e={patient_id:t.id,items:l.map(pe=>{const ce=pe.mrp??0,G=pe.pricePerLooseUnit??0,fe=G*(pe.looseQuantity??0);return{drug_id:pe.drug_id===void 0?null:pe.drug_id,name:pe.name,pack_quantity:pe.loosePacks??0,loose_quantity:pe.looseUnits??0,pack_price:ce,loose_price:G,total_price:fe,price:pe.originalMrp??0,directions_to_use:pe.directions_to_use===void 0?null:pe.directions_to_use,tabletsPerDay:pe.tabletsPerDay??1,numberOfDays:pe.numberOfDays??1}}),order_total:st,prescription_for_unavailable_drugs:T};try{const pe=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_e)});if(!pe.ok){const ce=await pe.json();throw new Error(ce.message||`Failed to create order: ${pe.statusText}`)}alert(`Pharmacy order created successfully for ${t.name}!`),e(-1)}catch(pe){console.error("Failed to create pharmacy order:",pe),v(pe.message||"Failed to create order. Please try again.")}finally{k(!1)}},st=w.useMemo(()=>l.reduce((je,Ge)=>{const _e=Ge.isLoose?Ge.pricePerLooseUnit??0:Ge.mrp??0,pe=Ge.isLoose?Ge.looseQuantity??0:Ge.quantity??0;return je+_e*pe},0),[l]),yt=(Number(st)||0).toFixed(2);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-6 max-w-5xl mx-auto",children:[" ",i.jsxs("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:[" ",i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:[i.jsx(sn,{size:20})," "]}),i.jsx("h2",{className:"text-2xl",children:"Create New Pharmacy Order"})," "]})]}),M&&i.jsxs("div",{className:"content-section",children:[" ",i.jsx("h3",{className:"section-title",children:"Select Patient"})," ",i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"})," ",i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:z,onChange:K,className:"custom-text-input mt-1",autoFocus:!0}),q&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),I&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:I})," ",L.length>0&&i.jsxs("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:[" ",i.jsxs("ul",{children:[" ",L.map(je=>i.jsxs("li",{onClick:()=>J({id:je.id,name:je.name,token:je.token,age:je.age,gender:je.gender,phone:je.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",je.token]}),je.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[je.age?`${je.age} yrs`:"Age N/A",je.gender?` / ${je.gender}`:" / Gender N/A",je.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",je.phone]})]})]}),je.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",je.phone]})]},je.id))]})]}),z.length>=2&&!q&&L.length===0&&!I&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',z,'".']}),V&&i.jsx("button",{type:"button",onClick:()=>xe("phone"),className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:q,children:'Create "direct pharmacy" Patient with this Phone'}),ie&&i.jsx("button",{type:"button",onClick:()=>xe("name"),className:"create-patient-button mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ml-2",disabled:q,children:"Create Patient with this Name"})]}),z.length<2&&!q&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]}),t&&!M&&i.jsxs("form",{onSubmit:Ke,children:[i.jsxs("div",{className:"selected-patient-info content-section flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:"section-title",children:[" ","Patient: ",i.jsx("span",{className:"font-normal",children:t.name})]}),i.jsxs("p",{className:"text-sm mt-1",children:["Token: ",i.jsx("span",{className:"font-medium",children:t.token??"N/A"}),t.age&&`    Age: ${t.age}`,t.gender&&`    Gender: ${t.gender}`,t.phone&&`    Phone: ${t.phone}`]}),i.jsxs("p",{className:"text-xs mt-1",title:`Patient UUID: ${t.id}`,children:["ID: ",t.id.substring(0,12),"..."]})]}),i.jsx("button",{type:"button",onClick:He,className:"change-patient-button mt-2 sm:mt-0 px-3 py-1.5 border rounded-md text-sm font-medium focus:outline-none focus:ring-2",children:"Change Patient"})]}),b&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:b})," ",le&&i.jsx("div",{className:"content-section text-center py-4",children:i.jsx("p",{className:"text-gray-500",children:"Loading previous orders..."})}),E&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:E}),!le&&Q.length>0&&i.jsxs("div",{className:"content-section mt-4",children:[i.jsx("h3",{className:"section-title",children:"Previous Orders"}),i.jsx("div",{className:"space-y-4",children:Q.map(je=>i.jsxs("div",{className:"previous-order-card p-4 border rounded-lg shadow-sm bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"font-semibold text-gray-800",children:["Order Date: ",new Date(je.date).toLocaleDateString()]}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${je.status==="dispensed"?"bg-green-100 text-green-800":je.status==="pending"?"bg-yellow-100 text-yellow-800":je.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:je.status.charAt(0).toUpperCase()+je.status.slice(1)})]}),i.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mb-3",children:je.medications.map((Ge,_e)=>i.jsxs("li",{children:[i.jsx("strong",{children:Ge.name}),": ",Ge.quantity," Qty",Ge.directions_to_use&&` - Directions: ${Ge.directions_to_use}`]},_e))}),je.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[i.jsx("span",{className:"font-semibold",children:"Prescription for Unavailable:"}),i.jsxs("div",{className:"prose prose-sm max-w-none",children:[" ",i.jsx(ws,{remarkPlugins:[Ua],children:je.prescriptionForUnavailableDrugs})]})]}),i.jsxs("button",{type:"button",onClick:()=>Ze(je),className:"add-previous-meds-button mt-3 px-3 py-1.5 text-sm font-medium rounded-md flex items-center justify-center",children:[i.jsx(al,{size:16,className:"mr-1"})," Add Medications to Current Order"]})]},je.id))})]}),!le&&Q.length===0&&t&&i.jsx("div",{className:"content-section text-center py-4 mt-4",children:i.jsx("p",{className:"text-gray-500",children:"No previous orders found for this patient."})}),i.jsxs("div",{className:"mb-4 content-section",children:[i.jsx("label",{htmlFor:"prescription-unavailable",className:"form-label",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-unavailable",rows:3,value:T??"",onChange:je=>P(je.target.value||null),placeholder:"Enter prescription details for any drugs that are currently unavailable...",className:"custom-text-input mt-1 w-full"})]}),i.jsxs("div",{className:"mb-4 relative content-section",children:[" ",i.jsx("label",{htmlFor:"drug-search",className:"form-label",children:"Add Medication"})," ",i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search for drug name or type to add custom...",value:f,onChange:je=>u(je.target.value),className:"custom-text-input mt-1"}),f&&i.jsxs("div",{className:"drug-search-dropdown mt-1 w-full max-h-60 rounded-md border shadow-lg overflow-auto focus:outline-none sm:text-sm z-20",children:[" ",h.length>0&&i.jsxs("ul",{children:[" ",h.map(je=>i.jsxs("li",{onClick:()=>re(je),className:"cursor-pointer select-none relative",children:[i.jsx("span",{className:"font-medium block truncate",children:je.name||je.brand_name}),i.jsxs("span",{className:"drug-stock-price text-xs",children:[" ","(Stock: ",je.stock??"N/A",", MRP: ",Number(je.mrp||0).toFixed(2),")"]})]},je.id))]}),f.trim()&&!a.some(je=>je.name&&je.name.toLowerCase()===f.trim().toLowerCase()||je.brand_name&&je.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsxs("div",{onClick:Be,className:"add-custom-drug-button cursor-pointer text-sm font-medium",role:"button",children:['Add "',f.trim(),'" as new item']}),f.trim()&&h.length===0&&a.some(je=>je.name&&je.name.toLowerCase()===f.trim().toLowerCase()||je.brand_name&&je.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsx("p",{className:"text-gray-400 py-2.5 px-4 text-sm",children:"Drug already selected or no new matches."})]})]}),i.jsxs("div",{className:"order-items-section content-section max-h-96 overflow-y-auto",children:[" ",i.jsx("h4",{className:"section-title",children:"Order Items"})," ",l.length===0&&i.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No medications added yet."}),l.length>0&&i.jsx("ul",{className:"space-y-4",children:l.map(je=>{const Ge=je.drug_id??je.name,_e=!je.drug_id;return i.jsxs("li",{className:"order-item-card text-sm",children:[" ",i.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3",children:[i.jsxs("div",{className:"flex-grow mb-2 md:mb-0",children:[i.jsxs("span",{className:`item-name block text-base ${_e?"custom":""}`,children:[" ",je.name,_e?" (custom)":""]}),!_e&&je.pricePerLooseUnit!==void 0&&i.jsxs("span",{className:"item-details text-xs",children:[" ","@ ",(Number(je.pricePerLooseUnit)||0).toFixed(2)," per loose unit"]}),je.stock!==void 0&&i.jsxs("span",{className:`item-details text-xs ml-2 ${je.stock<=10?"item-stock low":""}`,children:[" ","(Stock: ",je.stock,")"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2",children:[i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-packs-${Ge}`,className:"dosage-label",children:"Packs:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>Ye(Ge,(je.loosePacks??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-packs-${Ge}`,min:"0",value:je.loosePacks??0,onChange:pe=>{const ce=parseInt(pe.target.value,10);Ye(Ge,isNaN(ce)?0:ce)},onFocus:pe=>pe.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>Ye(Ge,(je.loosePacks??0)+1),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-units-${Ge}`,className:"dosage-label",children:"Loose:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>at(Ge,(je.looseUnits??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-units-${Ge}`,min:"0",value:je.looseUnits??0,onChange:pe=>{const ce=parseInt(pe.target.value,10);at(Ge,isNaN(ce)?0:ce)},onFocus:pe=>pe.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>at(Ge,(je.looseUnits??0)+1),className:"quantity-btn",children:"+"})]}),je.pack&&i.jsxs("span",{className:"ml-2 text-sm text-gray-400",children:["(",je.pack.split("x")[1]||je.pack," per pack)"]})]})]}),i.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-3 mt-2 md:mt-0 md:flex-col md:items-end",children:[i.jsxs("div",{className:"w-28 text-right font-semibold",children:[" ","",(Number((je.pricePerLooseUnit??0)*(je.looseQuantity??0))||0).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>Ie(Ge),className:"remove-item-button p-1.5 -m-1.5 rounded-full",title:"Remove Item",children:i.jsx(Hr,{size:18})})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2 mt-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:`tablets-per-day-${Ge}`,className:"dosage-label",children:"Per Day:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(pe=>pe.map(ce=>ce.drug_id===Ge?{...ce,tabletsPerDay:Math.max(1,(ce.tabletsPerDay??1)-1)}:ce)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`tablets-per-day-${Ge}`,min:"1",value:je.tabletsPerDay??1,onChange:pe=>{const ce=parseInt(pe.target.value,10);d(G=>G.map(fe=>fe.drug_id===Ge?{...fe,tabletsPerDay:isNaN(ce)?1:Math.max(1,ce)}:fe))},onFocus:pe=>pe.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(pe=>pe.map(ce=>ce.drug_id===Ge?{...ce,tabletsPerDay:(ce.tabletsPerDay??1)+1}:ce)),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`number-of-days-${Ge}`,className:"dosage-label",children:"No. Days:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(pe=>pe.map(ce=>ce.drug_id===Ge?{...ce,numberOfDays:Math.max(1,(ce.numberOfDays??1)-1)}:ce)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`number-of-days-${Ge}`,min:"1",value:je.numberOfDays??1,onChange:pe=>{const ce=parseInt(pe.target.value,10);d(G=>G.map(fe=>fe.drug_id===Ge?{...fe,numberOfDays:isNaN(ce)?1:Math.max(1,ce)}:fe))},onFocus:pe=>pe.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(pe=>pe.map(ce=>ce.drug_id===Ge?{...ce,numberOfDays:(ce.numberOfDays??1)+1}:ce)),className:"quantity-btn",children:"+"})]})]})]}),i.jsx("div",{className:"flex items-center mt-2",children:je.pack&&Ae(je.pack)&&i.jsx("span",{className:"ml-4 text-sm text-gray-400",children:(()=>{const pe=Ae(je.pack),ce=je.looseQuantity??0;if(pe&&pe>0){const G=Math.floor(ce/pe),fe=ce%pe;return`(Subtract: ${G} packs, ${fe} loose)`}return""})()})}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{htmlFor:`directions-${Ge}`,className:"dosage-label",children:"Directions:"}),i.jsx("input",{type:"text",id:`directions-${Ge}`,placeholder:"e.g., 'After food', 'Twice a day'",value:je.directions_to_use??"",onChange:pe=>{const ce=pe.target.value;d(G=>G.map(fe=>(fe.drug_id??fe.name)===Ge?{...fe,directions_to_use:ce}:fe))},className:"dosage-input text-sm w-full mt-1"})]})]},Ge)})})]}),l.length>0&&i.jsx("div",{className:"mt-6 text-right pr-4",children:i.jsxs("span",{className:"grand-total font-bold",children:[" ","Grand Total: ",yt]})}),i.jsx("div",{className:"mt-8 flex justify-end",children:i.jsx("button",{type:"submit",disabled:S||l.length===0&&!(T!=null&&T.trim()),className:`submit-order-button inline-flex items-center justify-center text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${S||l.length===0&&!(T!=null&&T.trim())?"":"hover:opacity-90"}`,children:S?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner animate-spin rounded-full h-5 w-5 border-2 mr-3"})," ","Creating Order..."]}):"Create Order"})})]})]})},LA=()=>{const{orderId:e}=Xi(),n=Rt(),[t,r]=w.useState(null),[a,o]=w.useState(null),[l,d]=w.useState([]),[f,u]=w.useState([]),[h,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,R]=w.useState(null),[z,$]=w.useState(!0),L=w.useCallback(async()=>{$(!0);try{const Y=await ge(`/api/pharmacy-orders/${e}`);if(!Y.ok)throw new Error("Failed to fetch order details");const Q=await Y.json();r(Q),o({id:Q.patientId,name:Q.patientName||"N/A",token:Q.patientTokenNumber}),R(Q.prescriptionForUnavailableDrugs);const ne=Q.medications.map(le=>{const oe=q(le.pack),E=le.pack_quantity*(oe??1)+le.loose_quantity;return{...le,isLoose:!0,loosePacks:le.pack_quantity,looseUnits:le.loose_quantity,looseQuantity:E,pack_price:le.pack_price,loose_price:le.loose_price,total_price:le.total_price,pricePerLooseUnit:le.loose_price,originalPrice:le.pack_price,box_number:le.box_number,pack:le.pack,batch:le.batch,expiry_date:le.expiry_date,discount_percentage:le.discount_percentage}});u(ne)}catch(Y){k("Could not load order details. "+Y.message)}finally{$(!1)}},[e]),B=w.useCallback(async()=>{try{const Y=await ge("/api/drugs");if(!Y.ok)throw new Error("Failed to fetch drugs");const Q=await Y.json(),ne=Q.drugs||Q||[];d(ne)}catch(Y){k("Could not load drug list. "+Y.message)}},[]);w.useEffect(()=>{L(),B()},[L,B]),w.useEffect(()=>{if(!h){v([]);return}const Y=h.toLowerCase();v(l.filter(Q=>{const ne=Q.name&&Q.name.toLowerCase().includes(Y),le=Q.brand_name&&Q.brand_name.toLowerCase().includes(Y);return ne||le}).slice(0,10))},[h,l]);const q=Y=>{if(!Y)return null;const Q=Y.match(/(?:\d+x)?(\d+)/);return Q?parseInt(Q[1],10):null},W=Y=>{if(f.some(Q=>Q.drug_id===Y.id)){k(`${Y.name||Y.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}u(Q=>[...Q,{drug_id:Y.id,name:Y.name||Y.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(Y.mrp)||0,loose_price:(Number(Y.mrp)||0)/(q(Y.pack)||1),total_price:(Number(Y.mrp)||0)/(q(Y.pack)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:Y.stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(Y.mrp)||0)/(q(Y.pack)||1),originalPrice:Number(Y.mrp)||0,pack:Y.pack}]),g(""),v([])},I=Y=>{u(Q=>Q.filter(ne=>(ne.drug_id??ne.name)!==Y))},F=(Y,Q)=>{u(ne=>ne.map(le=>{if((le.drug_id??le.name)===Y&&le.isLoose){const oe=q(le.pack),E=Math.max(0,Q),de=E*(oe??1)+(le.looseUnits??0);return{...le,loosePacks:E,looseQuantity:de,pack_quantity:E}}return le}))},V=(Y,Q)=>{u(ne=>ne.map(le=>{if((le.drug_id??le.name)===Y&&le.isLoose){const oe=q(le.pack),E=Math.max(0,Q),de=(le.loosePacks??0)*(oe??1)+E;return{...le,looseUnits:E,looseQuantity:de,loose_quantity:E}}return le}))},ee=async Y=>{if(Y.preventDefault(),k(null),P(!0),f.length===0&&!(M!=null&&M.trim())){k("Please add at least one medication or provide a prescription."),P(!1);return}const Q=f.filter(le=>{const oe=le.looseQuantity??0;return oe<=0||le.stock!==void 0&&oe>le.stock});if(Q.length>0){k(`Invalid quantity or insufficient stock for: ${Q.map(le=>le.name).join(", ")}`),P(!1);return}const ne={items:f.map(le=>({drug_id:le.drug_id??null,name:le.name,pack_quantity:le.loosePacks??0,loose_quantity:le.looseUnits??0,pack_price:le.pack_price??0,loose_price:le.loose_price??0,total_price:(le.loose_price??0)*(le.looseQuantity??0),discount_percentage:le.discount_percentage??0,directions_to_use:le.directions_to_use??null,tabletsPerDay:le.tabletsPerDay??1,numberOfDays:le.numberOfDays??1})),prescription_for_unavailable_drugs:M,order_total:ie};try{const le=await ge(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ne)});if(!le.ok){const oe=await le.json();throw new Error(oe.message||"Failed to update order")}alert("Pharmacy order updated successfully!"),n(-1)}catch(le){k(le.message||"Failed to update order. Please try again.")}finally{P(!1)}},ie=w.useMemo(()=>f.reduce((Y,Q)=>{const ne=Q.loose_price??0,le=Q.looseQuantity??0;return Y+ne*le},0),[f]);return z?i.jsx("div",{className:"p-6 flex justify-center items-center h-screen text-gray-500",children:"Loading order details..."}):t?i.jsxs("div",{className:"edit-pharmacy-order-container",children:[i.jsxs("div",{className:"page-header",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(sn,{size:20})}),i.jsxs("h2",{className:"page-title",children:["EDIT ORDER ",i.jsxs("span",{className:"text-gray-500 text-lg font-normal ml-2",children:[a==null?void 0:a.name," #",t.id.substring(0,4)]})]})]}),i.jsx("div",{className:"header-right",children:i.jsx("span",{className:"status-badge",children:t.status.toUpperCase()})})]}),i.jsx("div",{className:"order-meta",children:i.jsxs("span",{className:"order-date",children:[" Order Date: ",new Date(t.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})]})}),i.jsxs("form",{onSubmit:ee,className:"main-layout",children:[i.jsxs("div",{className:"left-column",children:[i.jsxs("div",{className:"card search-section",children:[i.jsx("div",{className:"card-header",children:i.jsx("h3",{children:" Find & Add Medication"})}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or brand...",value:h,onChange:Y=>g(Y.target.value),className:"search-input"}),h&&i.jsx("div",{className:"dropdown-results",children:b.length>0?i.jsx("ul",{children:b.map(Y=>i.jsxs("li",{onClick:()=>W(Y),className:"dropdown-item",children:[i.jsx("span",{className:"drug-name",children:Y.name||Y.brand_name}),i.jsxs("span",{className:"drug-meta",children:["(Stock: ",Y.stock??"N/A",", MRP: ",Number(Y.mrp||0).toFixed(2),")"]})]},Y.id))}):i.jsxs("div",{className:"p-3 text-gray-500 text-sm",children:['No drugs found matching "',h,'"']})})]})]}),i.jsxs("div",{className:"card medications-list-section",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[" Medications in Order ",i.jsxs("span",{className:"item-count",children:[f.length," items"]})]})}),f.length>0?i.jsxs("div",{className:"table-container",children:[i.jsxs("div",{className:"table-header-row",children:[i.jsx("div",{className:"col-medication",children:"MEDICATION"}),i.jsx("div",{className:"col-directions",children:"DIRECTIONS"}),i.jsx("div",{className:"col-quantity",children:"QUANTITY"}),i.jsx("div",{className:"col-subtotal",children:"SUBTOTAL"}),i.jsx("div",{className:"col-action"})]}),i.jsx("div",{className:"table-body",children:f.map(Y=>{const Q=Y.drug_id??Y.name;return i.jsxs("div",{className:"table-row",children:[i.jsxs("div",{className:"col-medication",children:[i.jsx("span",{className:"med-name",children:Y.name}),Y.pack&&i.jsx("span",{className:"med-unit text-xs text-gray-500 block",children:Y.pack}),i.jsxs("div",{className:"stock-info",children:[" Stock: ",i.jsxs("span",{className:"stock-value",children:[" ",Y.stock!==void 0?Y.pack?`BOX OF ${q(Y.pack)}`:Y.stock:"N/A"]})]})]}),i.jsx("div",{className:"col-directions",children:i.jsx("input",{type:"text",placeholder:"1 tablet twice daily...",value:Y.directions_to_use??"",onChange:ne=>{const le=ne.target.value;u(oe=>oe.map(E=>(E.drug_id??E.name)===Q?{...E,directions_to_use:le}:E))},className:"directions-input"})}),i.jsx("div",{className:"col-quantity",children:i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"PACKS"}),i.jsx("input",{type:"number",min:"0",value:Y.loosePacks??0,onChange:ne=>F(Q,parseInt(ne.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"LOOSE"}),i.jsx("input",{type:"number",min:"0",value:Y.looseUnits??0,onChange:ne=>V(Q,parseInt(ne.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]})]})}),i.jsxs("div",{className:"col-subtotal",children:["",(Number((Y.pricePerLooseUnit??0)*(Y.looseQuantity??0))||0).toFixed(2)]}),i.jsx("div",{className:"col-action",children:i.jsx("button",{type:"button",onClick:()=>I(Q),className:"delete-btn",children:i.jsx(Hr,{size:16})})})]},Q)})})]}):i.jsx("div",{className:"empty-state",children:"No medications added. Search above to add."})]})]}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"card notes-card",children:[i.jsx("div",{className:"card-header border-b-0 pb-2",children:i.jsx("h3",{children:" Prescription Notes"})}),i.jsx("textarea",{rows:3,value:M??"",onChange:Y=>R(Y.target.value||null),placeholder:"Add notes about unavailable drugs...",className:"notes-input"})]}),i.jsxs("button",{type:"submit",disabled:T,className:"confirm-btn",style:{width:"100%",margin:"20px 0 0 0"},children:[i.jsx("span",{className:"check-icon",children:""})," ",T?"Updating...":"Confirm Changes"]}),S&&i.jsx("div",{className:"error-alert mt-4",children:S})]})]})]}):i.jsx("div",{className:"p-6 text-red-500 flex justify-center items-center h-screen",children:"Order not found or failed to load."})},lre=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},cre=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},ure=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},dre=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},fre=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},hre=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},Yj=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),Wj=()=>{var me,Ce;const{orderId:e}=Xi(),n=Rt(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[T,P]=w.useState({}),[M,R]=w.useState(null),[z,$]=w.useState(!1),[L,B]=w.useState(""),[q,W]=w.useState(!1),[I,F]=w.useState(""),V=w.useCallback(async te=>{var K;try{const J=await ge(`/api/patients/${te}`);if(!J.ok)throw new Error(`Failed to fetch patient details: ${J.status}`);const xe=await J.json();v(xe.age),k(((K=xe.sex)==null?void 0:K.toLowerCase())==="female"?"female":"male"),xe.phone&&r(He=>He?{...He,Patient:{...He.Patient,phone:xe.phone}}:null)}catch(J){console.error("Error fetching patient details:",J),v(null),k(null)}},[]),ee=w.useCallback(async()=>{if(e){d(!0),g(null);try{const te=await ge(`/api/lab/${e}`);if(!te.ok){const xe=await te.json().catch(()=>({message:`HTTP error! status: ${te.status}`}));throw new Error(xe.message||`HTTP error! status: ${te.status}`)}const K=await te.json();if(r(K),K.createdAt)try{const xe=new Date(K.createdAt),He=new Date(xe.getTime()-xe.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(He)}catch(xe){console.error("Error formatting date for edit:",xe)}if(K.report_date)try{const xe=new Date(K.report_date),He=new Date(xe.getTime()-xe.getTimezoneOffset()*6e4).toISOString().slice(0,16);F(He)}catch(xe){console.error("Error formatting report date for edit:",xe)}else{const xe=new Date,He=new Date(xe.getTime()-xe.getTimezoneOffset()*6e4).toISOString().slice(0,16);F(He)}K.patient_id&&V(K.patient_id);const J={};if(K.tests&&K.tests.forEach(xe=>{J[xe.id]={},xe.default_parameters&&xe.default_parameters.length>0?xe.default_parameters.forEach(He=>{J[xe.id][He.name]=He.defaultValue}):J[xe.id].report_content=""}),K.report_content)try{const xe=JSON.parse(K.report_content);typeof xe=="object"&&xe!==null&&!Array.isArray(xe)?o(xe):(console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),o(J))}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),o(J)}else o({})}catch(te){console.error("Failed to fetch lab order details:",te),g(te instanceof Error?te.message:"An unknown error occurred while fetching order details.")}finally{d(!1)}}},[e,V]);w.useEffect(()=>{e?ee():(g("No Order ID provided in the URL."),d(!1))},[e,ee]);const ie=(te,K,J)=>{o(xe=>{var G,fe,Ne,Le,tt,xt,St,we,ye,Oe,De,Ve,ot,mt,Nt,cn,fn,wn,Tt;const He={...xe,[te]:{...xe[te],[K]:J}},re=parseFloat((G=He[te])==null?void 0:G.Creatinine),Be=b,Ae=S;if(K==="Creatinine"&&!isNaN(re)&&Be!==null&&Ae!==null){const Ct=lre(re,Be,Ae);Ct!==null&&((fe=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&fe.default_parameters.find(It=>It.name==="eGFR"))&&(He[te].eGFR=Ct)}const Ie=parseFloat((Ne=He[te])==null?void 0:Ne["Total Cholesterol"]),Ye=parseFloat((Le=He[te])==null?void 0:Le["HDL Cholesterol"]),at=parseFloat((tt=He[te])==null?void 0:tt.Triglycerides);if((K==="Total Cholesterol"||K==="HDL Cholesterol"||K==="Triglycerides")&&!isNaN(Ie)&&!isNaN(Ye)&&!isNaN(at)){const Ct=cre(Ie,Ye,at);Ct!==null&&((xt=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&xt.default_parameters.find(It=>It.name==="LDL Cholesterol"))&&(He[te]["LDL Cholesterol"]=Ct)}const Ze=parseFloat((St=He[te])==null?void 0:St["Total Bilirubin"]),Ke=parseFloat((we=He[te])==null?void 0:we["Direct Bilirubin"]);if((K==="Total Bilirubin"||K==="Direct Bilirubin")&&!isNaN(Ze)&&!isNaN(Ke)){const Ct=ure(Ze,Ke);Ct!==null&&((ye=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&ye.default_parameters.find(It=>It.name==="Indirect Bilirubin"))&&(He[te]["Indirect Bilirubin"]=Ct)}const st=parseFloat((Oe=He[te])==null?void 0:Oe["Total Protein"]),yt=parseFloat((De=He[te])==null?void 0:De.Albumin);if((K==="Total Protein"||K==="Albumin")&&!isNaN(st)&&!isNaN(yt)){const Ct=dre(st,yt);Ct!==null&&((Ve=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&Ve.default_parameters.find(It=>It.name==="Globulin"))&&(He[te].Globulin=Ct)}const je=parseFloat((ot=He[te])==null?void 0:ot.Sodium),Ge=parseFloat((mt=He[te])==null?void 0:mt.Chloride),_e=parseFloat((Nt=He[te])==null?void 0:Nt.Bicarbonate);if((K==="Sodium"||K==="Chloride"||K==="Bicarbonate")&&!isNaN(je)&&!isNaN(Ge)&&!isNaN(_e)){const Ct=fre(je,Ge,_e);Ct!==null&&((cn=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&cn.default_parameters.find(It=>It.name==="Anion Gap"))&&(He[te]["Anion Gap"]=Ct)}const pe=parseFloat((fn=He[te])==null?void 0:fn.Glucose),ce=parseFloat((wn=He[te])==null?void 0:wn.BUN);if((K==="Sodium"||K==="Glucose"||K==="BUN")&&!isNaN(je)&&!isNaN(pe)&&!isNaN(ce)){const Ct=hre(je,pe,ce);Ct!==null&&((Tt=t==null?void 0:t.tests.find(It=>It.id===te))!=null&&Tt.default_parameters.find(It=>It.name==="Osmolality"))&&(He[te].Osmolality=Ct)}return He})},Y=async te=>{const K=a[te]||{},J=t==null?void 0:t.tests.find(Be=>Be.id===te);if(!J)return;const xe={};J.default_parameters&&J.default_parameters.forEach(Be=>{xe[Be.name]=Be.defaultValue});const He={...xe,...K},re={...a,[te]:He};o(re),u(!0),g(null);try{const Be=await ge(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(re),isPartial:!0})});if(!Be.ok)throw new Error(`Save failed: ${Be.status}`);alert(`Report for ${J.name} saved successfully!`)}catch(Be){console.error("Error saving test report:",Be),alert("Failed to save test report.")}finally{u(!1)}},Q=(te=null)=>{R(te),setTimeout(()=>{window.print()},100)},ne=()=>{t&&lS(t)},le=async()=>{if(!t||!t.tests){alert("Order details not loaded.");return}if(!e){alert("Cannot submit report without an Order ID.");return}const te={};if(t.tests.forEach(K=>{const J=a[K.id]||{},xe={};K.default_parameters&&K.default_parameters.forEach(He=>{He.defaultValue!==void 0&&He.defaultValue!==null&&(xe[He.name]=He.defaultValue)}),te[K.id]={...xe,...J},(!K.default_parameters||K.default_parameters.length===0)&&!te[K.id].report_content&&(te[K.id].report_content="")}),Object.keys(te).length===0){alert("Report content cannot be empty.");return}o(te),u(!0),g(null);try{const K=await ge(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(te)})});if(!K.ok){const J=await K.json().catch(()=>({message:`Submission failed: ${K.status}`}));throw new Error(J.message||`Submission failed: ${K.status}`)}alert("Report submitted successfully!"),n(-1)}catch(K){console.error("Error submitting report:",K),g(K instanceof Error?K.message:"An unknown error occurred during submission.")}finally{u(!1)}},oe=async()=>{if(!(!e||!L))try{const te=await ge(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:new Date(L).toISOString()})});if(!te.ok)throw new Error("Failed to update date");const K=await te.json();K.order&&r(J=>J?{...J,createdAt:K.order.createdAt}:null),$(!1)}catch(te){console.error("Failed to update date:",te),alert("Failed to update date")}},E=async()=>{if(!(!e||!I))try{const te=await ge(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportDate:new Date(I).toISOString()})});if(!te.ok)throw new Error("Failed to update report date");const K=await te.json();K.order&&r(J=>J?{...J,report_date:K.order.report_date}:null),W(!1)}catch(te){console.error("Failed to update report date:",te),alert("Failed to update report date")}};if(l)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(ao,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(h&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(jr,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:h}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(sn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(rl,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(sn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const de=(me=t==null?void 0:t.Patient)==null?void 0:me.name,he=(Ce=t==null?void 0:t.Patient)==null?void 0:Ce.patient_token_number;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Enter Lab Report"})," ",i.jsxs("button",{onClick:()=>n(e?"/lab":-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:f,children:[i.jsx(sn,{size:16,style:{marginRight:"5px"}}),e?"Back to Lab Panel":"Back"]}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginLeft:"10px"},children:[i.jsxs("button",{onClick:()=>Q(null),className:"lab-inventory-button",title:"Print Full Report",children:[i.jsx(tl,{size:16,style:{marginRight:"5px"}})," Print All"]}),i.jsxs("button",{onClick:ne,className:"lab-inventory-button",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},title:"Share via WhatsApp",children:[i.jsx(qk,{size:16,style:{marginRight:"5px"}})," WhatsApp"]})]})]}),t&&i.jsxs("div",{className:"lab-inventory-card no-print",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(rl,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(Ns,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",de??"N/A"," (Token: ",he??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(QN,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",z?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:L,onChange:te=>B(te.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:oe,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Date",children:i.jsx(ib,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if($(!1),t.createdAt){const te=new Date(t.createdAt),K=new Date(te.getTime()-te.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(K)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(_n,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[zd(new Date(t.createdAt),"PPpp"),i.jsx("button",{onClick:()=>$(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Date",children:i.jsx(a0,{size:14})})]})]}),i.jsxs("div",{children:[i.jsx(QN,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Report Date:"})," ",q?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:I,onChange:te=>F(te.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Report Date",children:i.jsx(ib,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if(W(!1),t.report_date){const te=new Date(t.report_date),K=new Date(te.getTime()-te.getTimezoneOffset()*6e4).toISOString().slice(0,16);F(K)}else{const te=new Date,K=new Date(te.getTime()-te.getTimezoneOffset()*6e4).toISOString().slice(0,16);F(K)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(_n,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[t.report_date?zd(new Date(t.report_date),"PPpp"):"Not Reported",i.jsx("button",{onClick:()=>W(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Report Date",children:i.jsx(a0,{size:14})})]})]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(NF,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(te=>te.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:mre(t.status),children:pre(t.status)})]})]})]}),i.jsxs("div",{className:"lab-inventory-form-group no-print",style:{marginTop:"20px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:"Report Parameters"}),t==null?void 0:t.tests.map(te=>{var K;return i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",margin:0},children:te.name}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsxs("button",{type:"button",onClick:J=>{J.stopPropagation(),Y(te.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em"},disabled:f,children:[i.jsx(qd,{size:14,style:{marginRight:"4px"}})," Save"]}),i.jsx("button",{type:"button",onClick:J=>{J.stopPropagation(),Q(te.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em",marginLeft:"5px"},title:"Print This Test Only",children:i.jsx(tl,{size:14})})]})]}),i.jsx("div",{className:"test-parameters-body",style:{display:"block"},children:te.default_parameters&&te.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{className:"lab-inventory-table",style:{marginTop:"10px",width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9fafb"},children:[i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Parameter"}),i.jsx("th",{style:{width:"35%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Result"}),i.jsx("th",{style:{width:"15%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Units"}),i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Normal Range"})]})}),i.jsx("tbody",{children:te.default_parameters.map(J=>{var xe,He,re,Be,Ae,Ie,Ye,at,Ze;return i.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#374151",fontWeight:"500"},children:i.jsx("label",{htmlFor:`${te.id}-${J.name}`,style:{cursor:"pointer"},children:J.name})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle"},children:J.type==="boolean"?i.jsxs("select",{id:`${te.id}-${J.name}`,value:((He=(xe=a[te.id])==null?void 0:xe[J.name])==null?void 0:He.toString())??"false",onChange:Ke=>ie(te.id,J.name,Ke.target.value==="true"),className:"lab-inventory-input",disabled:f,style:{margin:0,width:"100%"},children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-Reactive"})]}):i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{id:`${te.id}-${J.name}`,type:J.type==="number"?"number":"text",value:((re=a[te.id])==null?void 0:re[J.name])!==void 0?(Be=a[te.id])==null?void 0:Be[J.name]:J.defaultValue??"",onChange:Ke=>{const st=J.type==="number"&&Ke.target.value===""?"":Ke.target.value;ie(te.id,J.name,st)},className:`lab-inventory-input ${J.type==="number"&&((Ae=a[te.id])==null?void 0:Ae[J.name])!==""&&(J.lower_limit!=null&&parseFloat((Ie=a[te.id])==null?void 0:Ie[J.name])<J.lower_limit||J.upper_limit!=null&&parseFloat((Ye=a[te.id])==null?void 0:Ye[J.name])>J.upper_limit)?"abnormal-result":""}`,disabled:f||Yj(J.name)&&!((at=T[te.id])!=null&&at[J.name]),style:{margin:0,width:"100%"}}),Yj(J.name)&&i.jsx("button",{type:"button",onClick:()=>P(Ke=>{var st;return{...Ke,[te.id]:{...Ke[te.id]||{},[J.name]:!((st=Ke[te.id])!=null&&st[J.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.7em",padding:"4px 6px",height:"fit-content",whiteSpace:"nowrap"},disabled:f,title:(Ze=T[te.id])!=null&&Ze[J.name]?"Disable Manual Edit":"Edit Calculated Field",children:i.jsx(a0,{size:12})})]})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280"},children:J.unit||"-"}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280",fontSize:"0.9em"},children:J.type==="number"&&(J.lower_limit!==null||J.upper_limit!==null)?i.jsxs(i.Fragment,{children:[J.lower_limit!==null&&J.lower_limit!==void 0&&`> ${J.lower_limit}`,J.lower_limit!==null&&J.lower_limit!==void 0&&J.upper_limit!==null&&J.upper_limit!==void 0&&" - ",J.upper_limit!==null&&J.upper_limit!==void 0&&`< ${J.upper_limit}`]}):"-"})]},J.name)})})]})})}):i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:`${te.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${te.id}-report_content`,value:((K=a[te.id])==null?void 0:K.report_content)??"",onChange:J=>ie(te.id,"report_content",J.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${te.name}...`,disabled:f})]})})]},te.id)}),h&&i.jsxs("p",{className:"error-text",style:{marginTop:"10px"},children:[i.jsx(jr,{size:15,className:"inline mr-1"}),h]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:f,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:le,disabled:f,className:"lab-inventory-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(ao,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(qd,{size:16,style:{marginRight:"5px"}})," Submit Full Report"]})})]}),i.jsxs("div",{className:"printable-only",children:[t&&t.Patient&&i.jsxs("div",{style:{marginBottom:"20px",borderBottom:"1px solid #ccc",paddingBottom:"10px"},children:[i.jsx("h2",{style:{textAlign:"center",marginBottom:"15px"},children:"Lab Report"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"12px"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Patient Name:"})," ",t.Patient.name]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age/Sex:"})," ",b??"N/A"," / ",S??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Ref. Doctor:"})," ",t.uploaded_by||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Date:"})," ",zd(new Date,"PPpp")]})]})]}),t==null?void 0:t.tests.filter(te=>M===null||te.id===M).map(te=>{var K;return i.jsxs("div",{style:{marginBottom:"20px",pageBreakInside:"avoid"},children:[i.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"5px"},children:te.name}),te.default_parameters&&te.default_parameters.length>0?i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9f9f9"},children:[i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Parameter"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Result"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Units"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Normal Range"})]})}),i.jsx("tbody",{children:te.default_parameters.map(J=>{var Ie;const xe=(Ie=a[te.id])==null?void 0:Ie[J.name],He=typeof xe=="string"?parseFloat(xe):typeof xe=="number"?xe:NaN,re=J.type==="number"&&!isNaN(He)&&xe!==""&&(J.lower_limit!=null&&He<J.lower_limit||J.upper_limit!=null&&He>J.upper_limit),Be=J.type==="boolean"&&(xe===!0||xe==="true"),Ae=J.type==="boolean"?xe===!0||xe==="true"?"Reactive":"Non-Reactive":xe??"";return i.jsxs("tr",{children:[i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:J.name}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee",fontWeight:re||Be?"bold":"normal",color:re?"red":Be?"green":"inherit"},children:Ae}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:J.unit??""}),i.jsxs("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:[J.lower_limit!==null&&J.lower_limit!==void 0&&`> ${J.lower_limit}`,J.lower_limit!==null&&J.lower_limit!==void 0&&J.upper_limit!==null&&J.upper_limit!==void 0&&" - ",J.upper_limit!==null&&J.upper_limit!==void 0&&`< ${J.upper_limit}`]})]},J.name)})})]}):i.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:"12px",padding:"10px"},children:((K=a[te.id])==null?void 0:K.report_content)||"No report content entered."})]},te.id)})]})]})})},pre=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",mre=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},gre=()=>{const{orderId:e}=Xi(),n=Rt(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=w.useCallback(async h=>{if(!h){d("No Order ID specified in the URL."),o(!1),r(null);return}o(!0),d(null),r(null);try{console.log(`Fetching order details for ID: ${h}`);const g=await ge(`/api/lab/orders/${h}/report`);if(!g.ok){let v;try{v=await g.json()}catch{v={message:`Server returned status ${g.status}`}}throw console.error("Fetch order details error response:",v),new Error(v.message||`Failed to fetch order details: ${g.status}`)}const b=await g.json();if(console.log("Received order data:",b),!b)throw console.error("Invalid order data structure:",b),new Error("Invalid order data received from server.");r(b)}catch(g){console.error("Error fetching order details:",g),d(g instanceof Error?g.message:"An unknown error occurred while fetching the order details")}finally{o(!1)}},[ge]);w.useEffect(()=>{f(e)},[e,f]);const u=()=>{t&&lS(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(Ss,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(kr,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(sn,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(tl,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:u,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(qk,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(jr,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:l}),e&&i.jsx("button",{onClick:()=>f(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Ns,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Jl,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const h=JSON.parse(t.report_content||"{}");return typeof h=="object"&&h!==null&&t.tests?t.tests.map(g=>i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em"},children:g.name}),h[g.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(h[g.id]).map(([b,v])=>{var R;const S=(R=g.default_parameters)==null?void 0:R.find(z=>z.name===b),k=typeof v=="string"?parseFloat(v):typeof v=="number"?v:NaN,T=(S==null?void 0:S.type)==="number"&&!isNaN(k)&&(S.lower_limit!=null&&k<S.lower_limit||S.upper_limit!=null&&k>S.upper_limit),P=(S==null?void 0:S.type)==="boolean"?v===!0||v==="true"?"Reactive":"Non-Reactive":String(v),M=(S==null?void 0:S.type)==="boolean"&&(v===!0||v==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:b}),i.jsxs("td",{className:`${T?"abnormal-result":""} ${M?"reactive-result":""}`,children:[P," ",S==null?void 0:S.unit]}),i.jsx("td",{children:S&&S.type==="number"&&(S.lower_limit!==null||S.upper_limit!==null)?i.jsxs(i.Fragment,{children:[S.lower_limit!=null&&` > ${S.lower_limit}`,S.lower_limit!=null&&S.upper_limit!=null&&" - ",S.upper_limit!=null&&` < ${S.upper_limit}`,S.unit&&` ${S.unit}`]}):((S==null?void 0:S.type)==="boolean","N/A")})]},b)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},g.id)):i.jsx(ws,{remarkPlugins:[Ua],children:t.report_content})}catch{return i.jsx(ws,{remarkPlugins:[Ua],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(Ss,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},yre=()=>{const e=Rt(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[o,l]=w.useState([]),[d,f]=w.useState(null),[u,h]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{h(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[u]);const g=async()=>{const k=n.trim();if(!k){l([]),f(null);return}a(!0),f(null),l([]),console.log(`Searching for: ${k}`);try{const T=await ge("/api/lab");if(!T.ok){let L;try{L=await T.json()}catch{L={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",L),new Error(L.message||`HTTP error! status: ${T.status}`)}const{orders:P}=await T.json();console.log("Received lab orders for search:",P);const R=P.filter(L=>!!L.report_content).map(L=>{var B,q;return{id:L.id,labTokenNumber:String(L.lab_token_number??"N/A"),patientName:((B=L.Patient)==null?void 0:B.name)||"N/A",patientId:L.patient_id,patientTokenNumber:String(((q=L.Patient)==null?void 0:q.patient_token_number)??"N/A"),tests:(L.tests||[]).map(W=>W.name||"Unknown Test"),date:zd(new Date(L.createdAt),"yyyy-MM-dd"),status:L.status}}),z=n.toLowerCase(),$=R.filter(L=>{var W,I,F,V,ee;const B=String(L.labTokenNumber).toLowerCase(),q=String(L.patientTokenNumber).toLowerCase();return(((W=L.patientName)==null?void 0:W.toLowerCase())||"").includes(z)||B.includes(z)||q.includes(z)||(((F=(I=L.tests)==null?void 0:I.join(" "))==null?void 0:F.toLowerCase())||"").includes(z)||(((V=L.id)==null?void 0:V.toLowerCase())||"").includes(z)||(((ee=L.patientId)==null?void 0:ee.toLowerCase())||"").includes(z)});console.log("Filtered search results:",$),l($),$.length===0&&k?f(`No matching reports found for "${k}".`):f(null)}catch(T){console.error("Failed to search lab reports:",T),f(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(sn,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(kr,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),d&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(jr,{size:20,className:"inline mr-2"})," ",d]}),o.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:o.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(X3,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:S(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(Jl,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(v6,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx($3,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&o.length===0&&!d&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&o.length===0&&!d&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},xre=()=>{const{patientId:e}=Xi(),n=Rt(),[t,r]=w.useState([]),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID is missing from the URL."),o(!1);return}o(!0),d(null),r([]),g(null);try{const S=await ge(`/api/patients/${e}`);if(S.ok){const P=await S.json();g(P.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await ge(`/api/lab/patient/${e}`);if(!k.ok){const P=await k.json().catch(()=>({}));throw new Error(P.message||`HTTP error! status: ${k.status}`)}const T=await k.json();r(T||[])}catch(S){console.error("Error fetching data:",S),d(`Failed to load data: ${S.message}`)}finally{o(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",h?`for ${h}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await ge("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(qa,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(sn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(ao,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(N6,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:l})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Jl,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(Ss,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):f?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",f.report_date?zd(new Date(f.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>u(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(sn,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(f.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(ws,{remarkPlugins:[Ua],children:f.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(Jl,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",zd(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:vre(v.status),children:bre(v.status)}),i.jsx(Qh,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},bre=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},vre=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},FA=()=>{const e=Rt(),[n,t]=w.useState("pharmacy");return i.jsxs("div",{className:"inventory-management-container",style:{padding:"20px",backgroundColor:"var(--background-color)",minHeight:"100vh"},children:[i.jsxs("div",{className:"inventory-header",style:{marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)"},children:i.jsx(sn,{size:24})}),i.jsx("h1",{style:{margin:0,fontSize:"1.8rem",fontWeight:"700",color:"var(--text-primary)"},children:"Inventory Management"})]}),i.jsxs("div",{className:"inventory-tabs",style:{display:"flex",gap:"5px",backgroundColor:"var(--card-bg, #f3f4f6)",padding:"5px",borderRadius:"12px",border:"1px solid var(--border-color, #e5e7eb)"},children:[i.jsxs("button",{onClick:()=>t("pharmacy"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="pharmacy"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="pharmacy"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="pharmacy"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="pharmacy"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="pharmacy"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(Ud,{size:18}),"Pharmacy Stock"]}),i.jsxs("button",{onClick:()=>t("lab"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="lab"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="lab"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="lab"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="lab"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="lab"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(io,{size:18}),"Lab Stock"]})]})]}),i.jsx("div",{className:"inventory-content",style:{backgroundColor:"var(--card-bg, #fff)",borderRadius:"16px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden"},children:n==="pharmacy"?i.jsx(IE,{isEmbedded:!0}):i.jsx(oS,{isEmbedded:!0})})]})},wre=({fetchWithAuth:e})=>{const n=Rt(),[t,r]=w.useState(!0),[a,o]=w.useState([]),[l,d]=w.useState(null),[f,u]=w.useState(null),h=w.useCallback(async()=>{r(!0),d(null);try{const S=await(await e("/staff")).json();o(S.map(k=>({...k,id:k._id||k.id})))}catch(v){d(`Failed to load staff data: ${v.message}`),o([])}finally{r(!1)}},[e]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{if(f){const v=setTimeout(()=>u(null),5e3);return()=>clearTimeout(v)}},[f]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return i.jsx(Vk,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return i.jsx(Tw,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return i.jsx(Ud,{size:16,className:"mr-2 text-purple-600"});case"lab":return i.jsx(io,{size:16,className:"mr-2 text-yellow-600"});case"admin":return i.jsx(Ob,{size:16,className:"mr-2 text-teal-600"});default:return i.jsx(Jh,{size:16,className:"mr-2 text-gray-500"})}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",i.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[f&&i.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${f.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[f.type==="success"?i.jsx(Wa,{size:18,className:"mr-2"}):i.jsx(jr,{size:18,className:"mr-2"}),i.jsx("span",{children:f.message}),i.jsx("button",{onClick:()=>u(null),className:"ml-auto text-xl font-bold",children:""})]}),l&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[i.jsx(jr,{size:18,className:"mr-2 text-red-500"}),l,i.jsx("button",{onClick:()=>d(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(sn,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[i.jsx(al,{size:16,className:"mr-2"})," Add New Staff"]})]}),i.jsx("div",{className:"staff-table-container",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),i.jsx("th",{className:"hidden md:table-cell",children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:a.length===0&&!t?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>i.jsxs("tr",{children:[i.jsx("td",{children:v.name}),i.jsx("td",{className:"hidden md:table-cell",children:v.email}),i.jsx("td",{children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),i.jsx("td",{className:"hidden md:table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"actions",children:i.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[i.jsx(sl,{size:16})," Edit"]})})]},v.id))})]})})]})},Sre=()=>{var k,T,P,M,R,z,$,L,B,q,W,I,F,V;const{patientId:e,billId:n}=Xi(),t=Rt(),[r,a]=w.useState(null),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,h]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),f(null);try{const ie=await ge(`/api/bills/${n}`);if(!ie.ok)throw new Error(`HTTP error! status: ${ie.status}`);const Y=await ie.json();if(!Y||!Y.bill||!Y.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(Y.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",Y.bill.type),new Error(`Unexpected bill type received: ${Y.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(Y,null,2));const Q=Array.isArray(Y.admissionPayments)?Y.admissionPayments:[];console.log("Processed admissionPaymentsData:",Q);const ne={...Y.bill,amount:Y.bill.amount,AdmissionPayments:Q,calculated:Y.calculated,patient:Y.bill.Patient?{id:Y.bill.Patient.id,name:Y.bill.Patient.name,admission_date:Y.bill.Patient.admission_date,discharge_date:Y.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(ne,null,2)),a(ne)}catch(ie){console.error("Failed to fetch admission bill details:",ie),f(ie instanceof Error?ie.message:"An unknown error occurred")}finally{l(!1)}})():(f("Bill ID is missing."),l(!1))},[n,e]);const S=async ee=>{var ie;if(ee.preventDefault(),!e||!u||isNaN(parseFloat(u))||parseFloat(u)<=0||parseFloat(u)>(((ie=r==null?void 0:r.calculated)==null?void 0:ie.balance)??0)){f("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}f(null);try{const Y=await ge(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(u),payment_mode:g})});if(!Y.ok){const le=await Y.json();throw new Error(le.message||`HTTP error! status: ${Y.status}`)}const ne=await(await ge(`/api/bills/${n}`)).json();if(ne&&ne.bill&&ne.calculated&&ne.admissionPayments)a({...ne.bill,amount:parseFloat(ne.bill.amount),AdmissionPayments:ne.admissionPayments,calculated:ne.calculated,patient:ne.bill.Patient?{id:ne.bill.Patient.id,name:ne.bill.Patient.name,admission_date:ne.bill.Patient.admission_date,discharge_date:ne.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");h("")}catch(Y){console.error("Failed to submit payment:",Y),f(Y instanceof Error?Y.message:"Failed to record payment")}};return o?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):d?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",d]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=r.patient)==null?void 0:T.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(P=r.patient)!=null&&P.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((M=r.patient)==null?void 0:M.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((R=r.status)==null?void 0:R.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((z=r==null?void 0:r.calculated)==null?void 0:z.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number(($=r==null?void 0:r.calculated)==null?void 0:$.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number((L=r==null?void 0:r.calculated)==null?void 0:L.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((B=r==null?void 0:r.calculated)==null?void 0:B.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((q=r==null?void 0:r.calculated)==null?void 0:q.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:u,onChange:ee=>h(ee.target.value),placeholder:`Max ${(Number((W=r==null?void 0:r.calculated)==null?void 0:W.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((I=r==null?void 0:r.calculated)==null?void 0:I.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:ee=>b(ee.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:o||!u||parseFloat(u)<=0||parseFloat(u)>(Number((F=r==null?void 0:r.calculated)==null?void 0:F.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(V=r==null?void 0:r.AdmissionPayments)==null?void 0:V.map(ee=>{if(!ee||typeof ee!="object")return null;let ie="Invalid Date";try{ee.payment_date&&!isNaN(new Date(ee.payment_date).getTime())&&(ie=new Date(ee.payment_date).toLocaleString())}catch(Y){console.error("Error formatting payment date:",ee.payment_date,Y)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ee.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ie}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(ee.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:ee.payment_mode??"N/A"})]},ee.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var Nre=Object.defineProperty,_b=Object.getOwnPropertySymbols,$A=Object.prototype.hasOwnProperty,zA=Object.prototype.propertyIsEnumerable,Qj=(e,n,t)=>n in e?Nre(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,fw=(e,n)=>{for(var t in n||(n={}))$A.call(n,t)&&Qj(e,t,n[t]);if(_b)for(var t of _b(n))zA.call(n,t)&&Qj(e,t,n[t]);return e},hw=(e,n)=>{var t={};for(var r in e)$A.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&_b)for(var r of _b(e))n.indexOf(r)<0&&zA.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Yd;(e=>{const n=class yn{constructor(f,u,h,g){if(this.version=f,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],f<yn.MIN_VERSION||f>yn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(h);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<S&&(g=k,S=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,u){const h=e.QrSegment.makeSegments(f);return yn.encodeSegments(h,u)}static encodeBinary(f,u){const h=e.QrSegment.makeBytes(f);return yn.encodeSegments([h],u)}static encodeSegments(f,u,h=1,g=40,b=-1,v=!0){if(!(yn.MIN_VERSION<=h&&h<=g&&g<=yn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=h;;S++){const R=yn.getNumDataCodewords(S,u)*8,z=l.getTotalBits(f,S);if(z<=R){k=z;break}if(S>=g)throw new RangeError("Data too long")}for(const R of[yn.Ecc.MEDIUM,yn.Ecc.QUARTILE,yn.Ecc.HIGH])v&&k<=yn.getNumDataCodewords(S,R)*8&&(u=R);let T=[];for(const R of f){t(R.mode.modeBits,4,T),t(R.numChars,R.mode.numCharCountBits(S),T);for(const z of R.getData())T.push(z)}a(T.length==k);const P=yn.getNumDataCodewords(S,u)*8;a(T.length<=P),t(0,Math.min(4,P-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let R=236;T.length<P;R^=253)t(R,8,T);let M=[];for(;M.length*8<T.length;)M.push(0);return T.forEach((R,z)=>M[z>>>3]|=R<<7-(z&7)),new yn(S,u,M,b)}getModule(f,u){return 0<=f&&f<this.size&&0<=u&&u<this.size&&this.modules[u][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),u=f.length;for(let h=0;h<u;h++)for(let g=0;g<u;g++)h==0&&g==0||h==0&&g==u-1||h==u-1&&g==0||this.drawAlignmentPattern(f[h],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const u=this.errorCorrectionLevel.formatBits<<3|f;let h=u;for(let b=0;b<10;b++)h=h<<1^(h>>>9)*1335;const g=(u<<10|h)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let h=0;h<12;h++)f=f<<1^(f>>>11)*7973;const u=this.version<<12|f;a(u>>>18==0);for(let h=0;h<18;h++){const g=r(u,h),b=this.size-11+h%3,v=Math.floor(h/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(f,u){for(let h=-4;h<=4;h++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(h)),v=f+g,S=u+h;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(f,u){for(let h=-2;h<=2;h++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,u+h,Math.max(Math.abs(g),Math.abs(h))!=1)}setFunctionModule(f,u,h){this.modules[u][f]=h,this.isFunction[u][f]=!0}addEccAndInterleave(f){const u=this.version,h=this.errorCorrectionLevel;if(f.length!=yn.getNumDataCodewords(u,h))throw new RangeError("Invalid argument");const g=yn.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][u],b=yn.ECC_CODEWORDS_PER_BLOCK[h.ordinal][u],v=Math.floor(yn.getNumRawDataModules(u)/8),S=g-v%g,k=Math.floor(v/g);let T=[];const P=yn.reedSolomonComputeDivisor(b);for(let R=0,z=0;R<g;R++){let $=f.slice(z,z+k-b+(R<S?0:1));z+=$.length;const L=yn.reedSolomonComputeRemainder($,P);R<S&&$.push(0),T.push($.concat(L))}let M=[];for(let R=0;R<T[0].length;R++)T.forEach((z,$)=>{(R!=k-b||$>=S)&&M.push(z[R])});return a(M.length==v),M}drawCodewords(f){if(f.length!=Math.floor(yn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=h-b,k=(h+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&u<f.length*8&&(this.modules[k][v]=r(f[u>>>3],7-(u&7)),u++)}}a(u==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let h=0;h<this.size;h++){let g;switch(f){case 0:g=(h+u)%2==0;break;case 1:g=u%2==0;break;case 2:g=h%3==0;break;case 3:g=(h+u)%3==0;break;case 4:g=(Math.floor(h/3)+Math.floor(u/2))%2==0;break;case 5:g=h*u%2+h*u%3==0;break;case 6:g=(h*u%2+h*u%3)%2==0;break;case 7:g=((h+u)%2+h*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][h]&&g&&(this.modules[u][h]=!this.modules[u][h])}}getPenaltyScore(){let f=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(S++,S==5?f+=yn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*yn.PENALTY_N3),v=this.modules[b][T],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*yn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(S++,S==5?f+=yn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*yn.PENALTY_N3),v=this.modules[T][b],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*yn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(f+=yn.PENALTY_N2)}let u=0;for(const b of this.modules)u=b.reduce((v,S)=>v+(S?1:0),u);const h=this.size*this.size,g=Math.ceil(Math.abs(u*20-h*10)/h)-1;return a(0<=g&&g<=9),f+=g*yn.PENALTY_N4,a(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let h=[6];for(let g=this.size-7;h.length<f;g-=u)h.splice(1,0,g);return h}}static getNumRawDataModules(f){if(f<yn.MIN_VERSION||f>yn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*f+128)*f+64;if(f>=2){const h=Math.floor(f/7)+2;u-=(25*h-10)*h-55,f>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(f,u){return Math.floor(yn.getNumRawDataModules(f)/8)-yn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][f]*yn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let u=[];for(let g=0;g<f-1;g++)u.push(0);u.push(1);let h=1;for(let g=0;g<f;g++){for(let b=0;b<u.length;b++)u[b]=yn.reedSolomonMultiply(u[b],h),b+1<u.length&&(u[b]^=u[b+1]);h=yn.reedSolomonMultiply(h,2)}return u}static reedSolomonComputeRemainder(f,u){let h=u.map(g=>0);for(const g of f){const b=g^h.shift();h.push(0),u.forEach((v,S)=>h[S]^=yn.reedSolomonMultiply(v,b))}return h}static reedSolomonMultiply(f,u){if(f>>>8||u>>>8)throw new RangeError("Byte out of range");let h=0;for(let g=7;g>=0;g--)h=h<<1^(h>>>7)*285,h^=(u>>>g&1)*f;return a(h>>>8==0),h}finderPenaltyCountPatterns(f){const u=f[1];a(u<=this.size*3);const h=u>0&&f[2]==u&&f[3]==u*3&&f[4]==u&&f[5]==u;return(h&&f[0]>=u*4&&f[6]>=u?1:0)+(h&&f[6]>=u*4&&f[0]>=u?1:0)}finderPenaltyTerminateAndCount(f,u,h){return f&&(this.finderPenaltyAddHistory(u,h),u=0),u+=this.size,this.finderPenaltyAddHistory(u,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(f,u){u[0]==0&&(f+=this.size),u.pop(),u.unshift(f)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(d,f,u){if(f<0||f>31||d>>>f)throw new RangeError("Value out of range");for(let h=f-1;h>=0;h--)u.push(d>>>h&1)}function r(d,f){return(d>>>f&1)!=0}function a(d){if(!d)throw new Error("Assertion error")}const o=class _r{constructor(f,u,h){if(this.mode=f,this.numChars=u,this.bitData=h,u<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(f){let u=[];for(const h of f)t(h,8,u);return new _r(_r.Mode.BYTE,f.length,u)}static makeNumeric(f){if(!_r.isNumeric(f))throw new RangeError("String contains non-numeric characters");let u=[];for(let h=0;h<f.length;){const g=Math.min(f.length-h,3);t(parseInt(f.substring(h,h+g),10),g*3+1,u),h+=g}return new _r(_r.Mode.NUMERIC,f.length,u)}static makeAlphanumeric(f){if(!_r.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],h;for(h=0;h+2<=f.length;h+=2){let g=_r.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h))*45;g+=_r.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h+1)),t(g,11,u)}return h<f.length&&t(_r.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h)),6,u),new _r(_r.Mode.ALPHANUMERIC,f.length,u)}static makeSegments(f){return f==""?[]:_r.isNumeric(f)?[_r.makeNumeric(f)]:_r.isAlphanumeric(f)?[_r.makeAlphanumeric(f)]:[_r.makeBytes(_r.toUtf8ByteArray(f))]}static makeEci(f){let u=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)t(f,8,u);else if(f<16384)t(2,2,u),t(f,14,u);else if(f<1e6)t(6,3,u),t(f,21,u);else throw new RangeError("ECI assignment value out of range");return new _r(_r.Mode.ECI,0,u)}static isNumeric(f){return _r.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return _r.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,u){let h=0;for(const g of f){const b=g.mode.numCharCountBits(u);if(g.numChars>=1<<b)return 1/0;h+=4+b+g.bitData.length}return h}static toUtf8ByteArray(f){f=encodeURI(f);let u=[];for(let h=0;h<f.length;h++)f.charAt(h)!="%"?u.push(f.charCodeAt(h)):(u.push(parseInt(f.substring(h+1,h+3),16)),h+=2);return u}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=o;e.QrSegment=o})(Yd||(Yd={}));(e=>{(n=>{const t=class{constructor(a,o){this.ordinal=a,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(Yd||(Yd={}));(e=>{(n=>{const t=class{constructor(a,o){this.modeBits=a,this.numBitsCharCount=o}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Yd||(Yd={}));var Ph=Yd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Cre={L:Ph.QrCode.Ecc.LOW,M:Ph.QrCode.Ecc.MEDIUM,Q:Ph.QrCode.Ecc.QUARTILE,H:Ph.QrCode.Ecc.HIGH},BA=128,UA="L",qA="#FFFFFF",VA="#000000",HA=!1,GA=1,_re=4,jre=0,kre=.1;function YA(e,n=0){const t=[];return e.forEach(function(r,a){let o=null;r.forEach(function(l,d){if(!l&&o!==null){t.push(`M${o+n} ${a+n}h${d-o}v1H${o+n}z`),o=null;return}if(d===r.length-1){if(!l)return;o===null?t.push(`M${d+n},${a+n} h1v1H${d+n}z`):t.push(`M${o+n},${a+n} h${d+1-o}v1H${o+n}z`);return}l&&o===null&&(o=d)})}),t.join("")}function WA(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,o)=>o<n.x||o>=n.x+n.w?a:!1))}function Tre(e,n,t,r){if(r==null)return null;const a=e.length+t*2,o=Math.floor(n*kre),l=a/n,d=(r.width||o)*l,f=(r.height||o)*l,u=r.x==null?e.length/2-d/2:r.x*l,h=r.y==null?e.length/2-f/2:r.y*l,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let S=Math.floor(u),k=Math.floor(h),T=Math.ceil(d+u-S),P=Math.ceil(f+h-k);b={x:S,y:k,w:T,h:P}}const v=r.crossOrigin;return{x:u,y:h,h:f,w:d,excavation:b,opacity:g,crossOrigin:v}}function Ere(e,n){return n!=null?Math.max(Math.floor(n),0):e?_re:jre}function QA({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:o,size:l,boostLevel:d}){let f=Tn.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(...Ph.QrSegment.makeSegments(T)),k),[]);return Ph.QrCode.encodeSegments(S,Cre[n],t,void 0,void 0,d)},[e,n,t,d]);const{cells:u,margin:h,numCells:g,calculatedImageSettings:b}=Tn.useMemo(()=>{let v=f.getModules();const S=Ere(r,a),k=v.length+S*2,T=Tre(v,l,S,o);return{cells:v,margin:S,numCells:k,calculatedImageSettings:T}},[f,l,o,r,a]);return{qrcode:f,margin:h,cells:u,numCells:g,calculatedImageSettings:b}}var Are=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Vh=Tn.forwardRef(function(n,t){const r=n,{value:a,size:o=BA,level:l=UA,bgColor:d=qA,fgColor:f=VA,includeMargin:u=HA,minVersion:h=GA,boostLevel:g,marginSize:b,imageSettings:v}=r,k=hw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,P=hw(k,["style"]),M=v==null?void 0:v.src,R=Tn.useRef(null),z=Tn.useRef(null),$=Tn.useCallback(ie=>{R.current=ie,typeof t=="function"?t(ie):t&&(t.current=ie)},[t]),[L,B]=Tn.useState(!1),{margin:q,cells:W,numCells:I,calculatedImageSettings:F}=QA({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:u,marginSize:b,imageSettings:v,size:o});Tn.useEffect(()=>{if(R.current!=null){const ie=R.current,Y=ie.getContext("2d");if(!Y)return;let Q=W;const ne=z.current,le=F!=null&&ne!==null&&ne.complete&&ne.naturalHeight!==0&&ne.naturalWidth!==0;le&&F.excavation!=null&&(Q=WA(W,F.excavation));const oe=window.devicePixelRatio||1;ie.height=ie.width=o*oe;const E=o/I*oe;Y.scale(E,E),Y.fillStyle=d,Y.fillRect(0,0,I,I),Y.fillStyle=f,Are?Y.fill(new Path2D(YA(Q,q))):W.forEach(function(de,he){de.forEach(function(D,me){D&&Y.fillRect(me+q,he+q,1,1)})}),F&&(Y.globalAlpha=F.opacity),le&&Y.drawImage(ne,F.x+q,F.y+q,F.w,F.h)}}),Tn.useEffect(()=>{B(!1)},[M]);const V=fw({height:o,width:o},T);let ee=null;return M!=null&&(ee=Tn.createElement("img",{src:M,key:M,style:{display:"none"},onLoad:()=>{B(!0)},ref:z,crossOrigin:F==null?void 0:F.crossOrigin})),Tn.createElement(Tn.Fragment,null,Tn.createElement("canvas",fw({style:V,height:o,width:o,ref:$,role:"img"},P)),ee)});Vh.displayName="QRCodeCanvas";var Pre=Tn.forwardRef(function(n,t){const r=n,{value:a,size:o=BA,level:l=UA,bgColor:d=qA,fgColor:f=VA,includeMargin:u=HA,minVersion:h=GA,boostLevel:g,title:b,marginSize:v,imageSettings:S}=r,k=hw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:P,numCells:M,calculatedImageSettings:R}=QA({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:u,marginSize:v,imageSettings:S,size:o});let z=P,$=null;S!=null&&R!=null&&(R.excavation!=null&&(z=WA(P,R.excavation)),$=Tn.createElement("image",{href:S.src,height:R.h,width:R.w,x:R.x+T,y:R.y+T,preserveAspectRatio:"none",opacity:R.opacity,crossOrigin:R.crossOrigin}));const L=YA(z,T);return Tn.createElement("svg",fw({height:o,width:o,viewBox:`0 0 ${M} ${M}`,ref:t,role:"img"},k),!!b&&Tn.createElement("title",null,b),Tn.createElement("path",{fill:d,d:`M0,0 h${M}v${M}H0z`,shapeRendering:"crispEdges"}),Tn.createElement("path",{fill:f,d:L,shapeRendering:"crispEdges"}),$)});Pre.displayName="QRCodeSVG";const Dre=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},Ire=()=>{const{orderId:e}=Xi(),n=Rt(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[h,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,P]=w.useState("cash"),M=w.useMemo(()=>(t==null?void 0:t.medications.reduce((F,V)=>{const ee=V.total_price??0,ie=ee*(V.discount_percentage??0)/100;return F+ee-ie},0))??0,[t==null?void 0:t.medications]),R=5,z=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce((F,V,ee)=>{var oe,E;const ie=V.drug_id??`index-${ee}`,Y=((oe=h[ie])==null?void 0:oe.pack)||0,Q=((E=h[ie])==null?void 0:E.loose)||0,ne=V.pack_price??0,le=V.loose_price??0;return F+Y*ne+Q*le},0),[t,h]),$=w.useCallback(async()=>{if(!e){d("Order ID is missing."),o(!1);return}o(!0),d(null);try{const F=await ge(`/api/pharmacy-orders/${e}`);if(!F.ok)throw F.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${F.statusText} (${F.status})`);const V=await F.json();console.log("Fetched order data after return:",V);const ie=V.medications.map(Q=>Q.pack_price&&Q.loose_price&&Q.loose_price>0?{...Q,unitsPerPack:Math.round(Q.pack_price/Q.loose_price)}:{...Q,unitsPerPack:0}).map(Q=>({...Q,discount_percentage:Q.discount_percentage??0}));r({...V,medications:ie});const Y={};ie.forEach((Q,ne)=>{const le=Q.drug_id??`index-${ne}`;Y[le]={pack:0,loose:0}}),g(Y)}catch(F){console.error("Failed to fetch order details:",F),d(F.message||"Failed to load order details.")}finally{o(!1)}},[e]);w.useEffect(()=>{$()},[$]),w.useEffect(()=>{(async()=>{try{const V=await ge("/api/clinics/settings");if(!V.ok)throw new Error("Failed to fetch clinic settings");const ee=await V.json();console.log("Fetched clinic settings:",ee),v(ee.upi_id||"")}catch(V){console.error("Error fetching clinic settings:",V)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const F=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k(F)}else k("")},[t==null?void 0:t.order_total,b]);const L=(F,V)=>{r(ee=>{if(!ee)return null;const ie=ee.medications.map((Q,ne)=>(Q.drug_id??`index-${ne}`)===F?{...Q,discount_percentage:isNaN(V)?0:V}:Q),Y=ie.reduce((Q,ne)=>{const le=ne.total_price??0,oe=le*(ne.discount_percentage??0)/100;return Q+le-oe},0);return{...ee,medications:ie,order_total:Y}})},B=(F,V,ee)=>{g(ie=>{const Y=ee.unitsPerPack||0,ne=ee.pack_quantity*Y+ee.loose_quantity,le=Math.max(0,Math.min(V,ne));let oe=0,E=le;return Y>0&&(oe=Math.floor(le/Y),E=le%Y),{...ie,[F]:{pack:oe,loose:E}}})},q=async()=>{const F=t==null?void 0:t.medications.map((V,ee)=>{var ne,le;const ie=V.drug_id??`index-${ee}`,Y=((ne=h[ie])==null?void 0:ne.pack)||0,Q=((le=h[ie])==null?void 0:le.loose)||0;return Y>0||Q>0?{drug_id:V.drug_id,name:V.name,pack_quantity:V.pack_quantity,loose_quantity:V.loose_quantity,returnPackQuantity:Y,returnLooseQuantity:Q}:null}).filter(V=>V!==null);if(!F||F.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!F){alert("Could not prepare items for return.");return}u(!0),d(null);try{const V=await ge(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:F})}),ee=await V.json();if(!V.ok)throw new Error(ee.message||`Failed to process return: ${V.statusText}`);alert("Return processed successfully! Stock has been updated.");const ie={};t==null||t.medications.forEach((Y,Q)=>{const ne=Y.drug_id??`index-${Q}`;ie[ne]={pack:0,loose:0}}),g(ie),$()}catch(V){console.error("Failed to process return:",V),d(V.message||"An error occurred while processing the return."),alert(`Error processing return: ${V.message||"Unknown error"}`)}finally{u(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(sn,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(sn,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const W=()=>{window.print()},I=Dre(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(sn,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:W,className:"print-button",children:[i.jsx(tl,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${I.text} ${I.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map((F,V)=>{var oe,E,de,he,D,me;const ee=F.drug_id??`index-${V}`,ie=F.total_price??0,Y=ie*(F.discount_percentage??0)/100,Q=ie-Y,ne=((oe=h[ee])==null?void 0:oe.pack)||0,le=((E=h[ee])==null?void 0:E.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:F.name}),i.jsx("td",{children:F.pack_quantity??0}),i.jsx("td",{children:((de=F.pack_price)==null?void 0:de.toFixed(2))??"N/A"}),i.jsx("td",{children:F.loose_quantity??0}),i.jsx("td",{children:((he=F.loose_price)==null?void 0:he.toFixed(2))??"N/A"}),i.jsx("td",{children:((D=F.price)==null?void 0:D.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((me=F.price)==null?void 0:me.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:F.discount_percentage??0,onChange:Ce=>L(ee,parseFloat(Ce.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[F.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[R.toFixed(1),"%"]}),i.jsx("td",{children:Q.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:F.pack_quantity,value:ne,onChange:Ce=>{const K=(parseInt(Ce.target.value,10)||0)*(F.unitsPerPack||0)+le;B(ee,K,F)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:F.loose_quantity+F.pack_quantity*(F.unitsPerPack||0)-ne*(F.unitsPerPack||0),value:le,onChange:Ce=>{const te=parseInt(Ce.target.value,10)||0,K=ne*(F.unitsPerPack||0)+te;B(ee,K,F)},className:"return-quantity-input"})})]})]},ee)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",M.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",M.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:T,onChange:F=>P(F.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Vh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[z>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",z.toFixed(2)]}),i.jsx("button",{onClick:q,disabled:Object.values(h).every(F=>F.pack===0&&F.loose===0)||f,className:"process-return-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(N1,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(N1,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},Rre=async()=>{const e=await ge("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},Mre=async e=>{const n=await ge(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},Ore=async e=>{const n=await ge("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},Lre=async(e,n)=>{const t=await ge(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},Fre=async e=>{const n=await ge(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},$re=async(e,n)=>{const t=await ge("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},zre=()=>{const e=Rt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await Rre();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const h=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await Fre(g),f({type:"success",message:"Plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(Wa,{size:18,className:"mr-2 text-green-500"}):i.jsx(jr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(_n,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(sn,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(al,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(sl,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Hr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},Bre=()=>{const e=Rt(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await Ore(n),f({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(Wa,{size:18,className:"mr-2 text-green-500"}):i.jsx(jr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(_n,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Ure=()=>{const{id:e}=Xi(),n=Rt(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await Mre(e);r(M),o({name:M.name,description:M.description||"",price:M.price,period:M.period,interval:M.interval,razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:R,value:z}=M.target;o($=>({...$,[R]:z}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await Lre(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(R){const z=R.message||"Failed to update plan.";g(z),v({type:"error",message:z})}finally{d(!1)}},P=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Wa,{size:18,className:"mr-2"}):i.jsx(jr,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(_n,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},qre=()=>{const{patientId:e}=Xi(),n=Rt(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=w.useCallback(async()=>{u(!0),g(null);try{const $=await ge(`/api/patients/${e}`);if(!$.ok){const W=await $.json();throw new Error(W.message||"Failed to fetch patient details")}const L=await $.json();r(L);const B=await ge("/api/subscriptions");if(!B.ok){const W=await B.json();throw new Error(W.message||"Failed to fetch subscription plans")}const q=await B.json();o(q.filter(W=>W.status==="active"))}catch($){console.error("Error fetching data:",$),g(`Failed to load data: ${$.message}`)}finally{u(!1)}},[e]);w.useEffect(()=>{e?M():(g("Patient ID is missing."),u(!1))},[e,M]);const R=($,L)=>{const B=new Date($),q=L.interval||1;switch(L.period){case"daily":B.setDate($.getDate()+q);break;case"weekly":B.setDate($.getDate()+q*7);break;case"monthly":B.setMonth($.getMonth()+q);break;case"yearly":B.setFullYear($.getFullYear()+q);break;default:console.warn(`Unknown subscription period: ${L.period}. Defaulting to 1 month.`),B.setMonth($.getMonth()+1)}return B},z=async()=>{if(!e||!l){P("Please select a subscription plan.");return}const $=a.find(L=>L.id===l);if(!$){P("Selected plan details not found.");return}k(!0),P(null);try{const L=new Date,B=R(L,$);if(b==="manual"){const q={subscription_plan_id:l,subscription_status:"active",subscription_start_date:L.toISOString(),subscription_end_date:B.toISOString(),subscription_payment_method:"manual"},W=await ge(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});if(!W.ok){const I=await W.json();throw new Error(I.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",$);const q=await $re(e,l);if(q&&q.short_url)window.location.href=q.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch(L){console.error("Error starting subscription:",L),P(`Failed to start subscription: ${L.message}`),k(!1)}};return f?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):h?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:h})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(sn,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(sn,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(Ns,{size:28})," ","Start Subscription for ",t.name]}),T&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:T})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map($=>i.jsxs("div",{className:`subscription-plan-card ${l===$.id?"selected-plan":""}`,onClick:()=>d($.id),children:[i.jsx("h3",{children:$.name}),i.jsxs("p",{className:"price",children:["",$.price]}),i.jsxs("p",{className:"duration",children:["Every ",$.interval," ",$.period,$.interval>1?"s":""]}),$.description&&i.jsx("p",{children:$.description})]},$.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:z,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(sn,{size:16}),"Back"]})]})},CS=async()=>{const e=await ge("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},Vre=async e=>{const n=await ge(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},Hre=async e=>{const n=await ge(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},Gre=async e=>{const n=await ge(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},Yre=async e=>{const n=await ge("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},Wre=async(e,n)=>{const t=await ge(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},Qre=async e=>{const n=await ge(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},Jre=async e=>{const n=await ge("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},Kre=async()=>{try{const e=await ge("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},Xre=async()=>{const e=await ge("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()},Zre=()=>{const e=Rt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await CS();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const h=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await Qre(g),f({type:"success",message:"Clinic plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate clinic plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(Wa,{size:18,className:"mr-2 text-green-500"}):i.jsx(jr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(_n,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(sn,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(al,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(sl,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Hr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},eie=()=>{const e=Rt(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(S):S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await Yre(n),f({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(Wa,{size:18,className:"mr-2 text-green-500"}):i.jsx(jr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(_n,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},tie=()=>{const{id:e}=Xi(),n=Rt(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await Gre(e);r(M),o({name:M.name,description:M.description||"",price:Number(M.price),period:M.period,interval:Number(M.interval),razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch clinic plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:R,value:z,type:$}=M.target;o(L=>({...L,[R]:$==="number"?parseFloat(z):z}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await Wre(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(R){const z=R.message||"Failed to update clinic plan.";g(z),v({type:"error",message:z})}finally{d(!1)}},P=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Wa,{size:18,className:"mr-2"}):i.jsx(jr,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(_n,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},nie=()=>{const e=Rt(),[n,t]=w.useState([]),[r,a]=w.useState(""),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,h]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{f(null);try{const T=(await CS()).filter(P=>P.status==="active");t(T),T.length>0&&!r&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),f(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const T=await Kre();if(T&&T.short_url){window.location.href=T.short_url,f("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),f(`An unexpected error occurred: ${T.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===r);if(!k){b("Selected plan details not found.");return}h(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await Jre(r);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),h(!1)}};return o?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):d?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:d})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(sn,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(sn,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(O3,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:S,disabled:!r||u||n.length===0,className:"subscription-btn",children:[u&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),u?"Initiating Payment...":"Buy Pro Plan"]})})]})},rie=()=>{const e=Rt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[P,M]=w.useState(""),[R,z]=w.useState(""),[$,L]=w.useState({}),[B,q]=w.useState(!1),[W,I]=w.useState(null),[F,V]=w.useState([]),[ee,ie]=w.useState(""),[Y,Q]=w.useState(!1),[ne,le]=w.useState(null);w.useEffect(()=>{const J=setTimeout(()=>{z(P)},500);return()=>{clearTimeout(J)}},[P]),w.useEffect(()=>{oe(R)},[R]);const oe=async(J="")=>{a(!0);try{const xe=J?`/api/users?search=${encodeURIComponent(J)}`:"/api/users",re=await(await ge(xe)).json();if(t(re),re.length>0){const Be=[...new Set(re.map(Ie=>Ie.clinic_id).filter(Ie=>!!Ie))],Ae={};await Promise.all(Be.map(async Ie=>{try{const Ye=await Hre(Ie);Ae[Ie]=Ye}catch(Ye){console.error(`Failed to fetch subscription status for clinic ${Ie}`,Ye),Ae[Ie]={hasProPlan:!1}}})),L(Ae)}l(null)}catch(xe){l("Failed to fetch users."),console.error(xe)}finally{a(!1)}},E=async J=>{J.preventDefault();try{await ge("/users",{method:"POST",body:JSON.stringify(v)}),f(!1),S({name:"",email:"",password:"",role:"user"}),oe()}catch(xe){l("Failed to add user."),console.error(xe)}},de=async J=>{if(J.preventDefault(),!g)return;const{password:xe,confirmPassword:He,...re}=k,Be={...re};if(xe){if(xe.length<6){l("Password must be at least 6 characters long.");return}if(xe!==He){l("Passwords do not match.");return}Be.password=xe}try{await ge(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Be)}),h(!1),b(null),T({...k,password:"",confirmPassword:""}),oe()}catch(Ae){l("Failed to update user."),console.error(Ae)}},he=async J=>{if(window.confirm("Are you sure you want to delete this user?"))try{await ge(`/users/${J}`,{method:"DELETE"}),oe()}catch(xe){l("Failed to delete user."),console.error(xe)}},D=J=>{b(J),T({name:J.name,email:J.email,role:J.role,password:"",confirmPassword:""}),h(!0)},me=async()=>{Q(!0);try{const J=await CS();V(J),J.length>0&&ie(J[0].id),le(null)}catch(J){le("Failed to fetch subscription plans."),console.error(J)}finally{Q(!1)}},Ce=J=>{I(J),q(!0),me()},te=async J=>{if(J.preventDefault(),!W||!ee){l("Please select a clinic and a plan.");return}try{await ge("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:W,planId:ee})}),q(!1),I(null),ie(""),oe(),l(null)}catch(xe){l("Failed to manually activate clinic subscription."),console.error(xe)}},K=async J=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await Vre(J),oe(),l(null)}catch(xe){l("Failed to cancel subscription."),console.error(xe)}};return r?i.jsx("div",{children:"Loading users..."}):o?i.jsx("div",{className:"error-message",children:o}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(sn,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:P,onChange:J=>M(J.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>f(!0),className:"add-user-button",children:"Add New User"})]}),d&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>f(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:J=>S({...v,name:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:J=>S({...v,email:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:J=>S({...v,password:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:J=>S({...v,role:J.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),u&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>h(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:de,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:J=>T({...k,name:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:J=>T({...k,email:J.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:J=>T({...k,role:J.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:J=>T({...k,password:J.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:J=>T({...k,confirmPassword:J.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),B&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>q(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),Y&&i.jsx("div",{children:"Loading plans..."}),ne&&i.jsx("div",{className:"error-message",children:ne}),!Y&&!ne&&F.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!Y&&!ne&&F.length>0&&i.jsxs("form",{onSubmit:te,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:ee,onChange:J=>ie(J.target.value),required:!0,children:F.map(J=>i.jsxs("option",{value:J.id,children:[J.name," - $",J.price,"/",J.interval," ",J.period]},J.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(J=>{const xe=J.clinic_id||"N/A",He=xe!=="N/A"?$[xe]:null,re=(He==null?void 0:He.hasProPlan)??!1,Be=re?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:J.name}),i.jsx("td",{children:J.email}),i.jsx("td",{children:J.role}),i.jsx("td",{children:xe}),i.jsx("td",{children:xe!=="N/A"?i.jsx("span",{className:re?"pro-badge":"standard-badge",children:Be}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>D(J),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>he(J.id),className:"delete-button",children:"Delete"}),J.clinic_id&&!re&&i.jsx("button",{onClick:()=>Ce(J.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),J.clinic_id&&re&&i.jsx("button",{onClick:()=>K(J.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},J.id)})})]})]})},iie="_modalOverlay_1spz3_3",aie="_modalContent_1spz3_29",sie="_modalHeader_1spz3_53",oie="_modalTitle_1spz3_71",lie="_modalCloseButton_1spz3_83",cie="_modalBody_1spz3_111",uie="_formGroup_1spz3_119",die="_inputField_1spz3_141",fie="_errorText_1spz3_175",hie="_successText_1spz3_193",pie="_modalFooter_1spz3_211",mie="_button_1spz3_227",gie="_buttonPrimary_1spz3_247",yie="_buttonSecondary_1spz3_265",Ji={modalOverlay:iie,modalContent:aie,modalHeader:sie,modalTitle:oie,modalCloseButton:lie,modalBody:cie,formGroup:uie,inputField:die,errorText:fie,successText:hie,modalFooter:pie,button:mie,buttonPrimary:gie,buttonSecondary:yie},xie=({isOpen:e,onClose:n})=>{const[t,r]=w.useState(""),[a,o]=w.useState(!1),[l,d]=w.useState(!1),[f,u]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{e&&b()},[e]);const b=async()=>{o(!0),u(null);try{const S=await ge("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();r(k.value||"")}else S.status}catch(S){console.warn("Could not fetch existing key:",S)}finally{o(!1)}},v=async()=>{d(!0),u(null),g(null);try{if(!(await ge("/api/global-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"app_gemini_api_key",value:t})})).ok)throw new Error("Failed to save API Key");g("API Key updated successfully!"),setTimeout(()=>{n(),g(null)},1500)}catch(S){u(S.message||"Error saving key")}finally{d(!1)}};return e?i.jsx("div",{className:Ji.modalOverlay,children:i.jsxs("div",{className:Ji.modalContent,children:[i.jsxs("div",{className:Ji.modalHeader,children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(Fk,{size:24}),i.jsx("h3",{className:Ji.modalTitle,children:"App Gemini API Key"})]}),i.jsx("button",{onClick:n,className:Ji.modalCloseButton,children:i.jsx(_n,{size:20})})]}),i.jsxs("div",{className:Ji.modalBody,children:[f&&i.jsx("div",{className:Ji.errorText,children:f}),h&&i.jsx("div",{className:Ji.successText,children:h}),i.jsxs("div",{className:Ji.formGroup,children:[i.jsx("label",{htmlFor:"gemini-key",children:"Gemini API Key"}),i.jsx("input",{type:"text",id:"gemini-key",value:t,onChange:S=>r(S.target.value),className:Ji.inputField,placeholder:"Enter Gemini API Key (AIza...)",disabled:a||l})]}),i.jsx("p",{style:{fontSize:"0.9em",color:"var(--secondary-text-color, #666)"},children:"This key will be used as a fallback for all clinics if their specific Gemini API key is not configured."})]}),i.jsxs("div",{className:Ji.modalFooter,children:[i.jsx("button",{onClick:n,className:`${Ji.button} ${Ji.buttonSecondary}`,disabled:l,children:"Cancel"}),i.jsx("button",{onClick:v,className:`${Ji.button} ${Ji.buttonPrimary}`,disabled:l,children:l?"Saving...":"Save Key"})]})]})}):null},bie=()=>{const[e,n]=w.useState(!1);return i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(Ob,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(Ss,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(Bh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(Ss,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(Jh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),i.jsxs("div",{className:"admin-panel-card",onClick:()=>n(!0),style:{cursor:"pointer"},children:[i.jsx(Fk,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage App Gemini API Key"}),i.jsx("p",{children:"Update the fallback Gemini API key used by the application."})]})]}),i.jsx(xie,{isOpen:e,onClose:()=>n(!1)})]})},o1="tutorialCurrentStep",vie=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),[o,l]=w.useState(null),d=async()=>{var f,u;t(!0);try{const h=await ge("/api/drugs/import-defaults",{method:"POST"}),g=await h.json();if(h.ok){a(!0);const b=((f=g.details)==null?void 0:f.added)||0,v=((u=g.details)==null?void 0:u.updated)||0,S=`Added: ${b}, Updated: ${v}`;l(S),e(!0,"Default medications imported successfully!","pharmacyImport")}else e(!1,"Failed to import medications.")}catch{e(!1,"Error importing medications.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"One click to populate your inventory."}),r?i.jsxs("div",{className:"success-badge flex-col",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ib,{size:16})," Imported"]}),o&&i.jsx("span",{className:"text-xs opacity-80 mt-1",children:o})]}):i.jsx("button",{onClick:d,className:"tutorial-button primary",disabled:n,children:n?i.jsxs(i.Fragment,{children:[i.jsx(ao,{size:18,className:"animate-spin"})," Importing ~80 items..."]}):i.jsxs(i.Fragment,{children:[i.jsx(kw,{size:18})," Import Drugs"]})})]})},wie=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),[o,l]=w.useState(null),d=async()=>{var f,u;t(!0);try{const h=await ge("/api/lab-tests/import-defaults",{method:"POST"}),g=await h.json();if(h.ok){a(!0);const b=((f=g.details)==null?void 0:f.added)||0,v=((u=g.details)==null?void 0:u.updated)||0,S=`Added: ${b}, Updated: ${v}`;l(S),e(!0,"Default lab tests imported successfully!","labImport")}else e(!1,"Failed to import lab tests.")}catch{e(!1,"Error importing lab tests.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"Setup your lab with common tests."}),r?i.jsxs("div",{className:"success-badge flex-col",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ib,{size:16})," Imported"]}),o&&i.jsx("span",{className:"text-xs opacity-80 mt-1",children:o})]}):i.jsx("button",{onClick:d,className:"tutorial-button primary",disabled:n,children:n?i.jsxs(i.Fragment,{children:[i.jsx(ao,{size:18,className:"animate-spin"})," Importing ~25 items..."]}):i.jsxs(i.Fragment,{children:[i.jsx(io,{size:18})," Import Tests"]})})]})},Sie=({onOpenCommandBar:e})=>i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"Ready to experience the power? Open the command bar to start."}),i.jsx("button",{onClick:e,className:"tutorial-button primary large-button",children:i.jsxs("div",{className:"flex items-center gap-2",children:["Open Command Bar ",i.jsx("span",{className:"shortcut-hint-badge",children:"Ctrl+K"})]})})]}),l1=[{title:"Welcome to Newtons Ai HMS",description:"Your all-in-one clinic management solution. Let's get your clinic ready in less than 2 minutes.",icon:i.jsx(f6,{size:48,className:"step-icon welcome"}),component:null,actionText:"Get Started"},{title:"Pharmacy Setup",description:"Start by populating your pharmacy. We can import a standard list of medicines for you.",icon:i.jsx(kw,{size:48,className:"step-icon pharmacy"}),component:vie,actionText:"Next",showSkip:!0},{title:"Lab Configuration",description:"Next, let's set up your lab. Import common lab tests to start generating reports immediately.",icon:i.jsx(io,{size:48,className:"step-icon lab"}),component:wie,actionText:"Next",showSkip:!0},{title:"Power at Your Fingertips",description:"The Command Bar is your central hub for everything. Search patients, add orders, or use AI tools instantly.",icon:i.jsx(P3,{size:48,className:"step-icon ai"}),component:Sie,actionText:null,isLast:!0}],Nie=({onClose:e,onMarkAsSeen:n})=>{const{openCommandBar:t}=Lh(),[r,a]=w.useState(()=>{const T=localStorage.getItem(o1);return T?parseInt(T,10):0}),[o,l]=w.useState(!1),[d,f]=w.useState(null),[u,h]=w.useState(null);w.useEffect(()=>{localStorage.setItem(o1,r.toString()),f(null)},[r]);const g=()=>{l(!0),setTimeout(()=>{a(T=>Math.min(T+1,l1.length-1)),l(!1)},300)},b=(T,P,M)=>{h(T),f(P),T&&(M==="pharmacyImport"||M==="labImport")&&setTimeout(g,1e3)},v=()=>{n(),e(),localStorage.removeItem(o1)},S=()=>{v(),setTimeout(()=>{t()},100)},k=l1[r];return i.jsx("div",{className:"tutorial-overlay",children:i.jsxs("div",{className:`tutorial-card ${o?"fade-out":"fade-in"}`,children:[i.jsxs("div",{className:"tutorial-visual",children:[i.jsx("div",{className:"icon-circle",children:k.icon}),i.jsx("div",{className:"step-indicators",children:l1.map((T,P)=>i.jsx("div",{className:`step-dot ${P===r?"active":""} ${P<r?"completed":""}`},P))})]}),i.jsxs("div",{className:"tutorial-content",children:[i.jsx("button",{className:"close-button",onClick:v,title:"Close Tutorial",children:i.jsx(_n,{size:20})}),i.jsxs("div",{className:"text-content",children:[i.jsx("h2",{children:k.title}),i.jsx("p",{className:"description",children:k.description})]}),i.jsxs("div",{className:"interactive-area",children:[k.component?i.jsx(k.component,{onActionComplete:b,onOpenCommandBar:S}):null,d&&i.jsx("div",{className:`status-message ${u?"success":"error"}`,children:d})]}),i.jsxs("div",{className:"action-footer",children:[k.showSkip&&i.jsx("button",{onClick:g,className:"tutorial-button text-only",children:"Skip for now"}),k.actionText&&i.jsxs("button",{onClick:g,className:"tutorial-button primary",children:[k.actionText," ",i.jsx(Qh,{size:16})]})]})]})]})})},Cie=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(""),[f,u]=w.useState(1),[h,g]=w.useState(1),[b,v]=w.useState(0),[S,k]=w.useState(!1),[T,P]=w.useState(void 0),M=10,R=w.useRef(null),z=w.useCallback(async(F,V)=>{r(!0),o(null);try{let ee=`/api/recurring-medications?page=${F}&limit=${M}`;V&&(ee+=`&search=${encodeURIComponent(V)}`);const ie=await ge(ee);if(!ie.ok)throw new Error("Failed to fetch recurring medications.");const Y=await ie.json();n(Y.medications),g(Y.totalPages),v(Y.total),u(Y.page)}catch(ee){console.error(ee),o(ee.message||"An error occurred while fetching data.")}finally{r(!1)}},[]);w.useEffect(()=>(R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{z(f,l)},500),()=>{R.current&&clearTimeout(R.current)}),[l,f,z]);const $=F=>{d(F.target.value),u(1)},L=F=>{F>=1&&F<=h&&u(F)},B=F=>{P(F),k(!0)},q=()=>{z(f,l),k(!1),P(void 0)},W=F=>F===30?"Every 30 Days (Monthly)":F===15?"Every 15 Days":`Every ${F} Days`,I=F=>{switch(F){case"active":return"status-pill status-pill-active";case"paused":return"status-pill status-pill-paused";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill"}};return i.jsxs("div",{className:"refill-reminders-container",children:[i.jsxs("div",{className:"refill-header",children:[i.jsx("h3",{className:"refill-title",children:"Recurring Medications"}),i.jsxs("div",{className:"refill-actions",children:[i.jsxs("button",{className:"refill-action-button btn-add",onClick:()=>{P(void 0),k(!0)},children:[i.jsx(qa,{size:16})," Add New"]}),i.jsxs("div",{className:"search-box",children:[i.jsx("input",{type:"text",placeholder:"Search patient, phone, medication...",value:l,onChange:$}),i.jsx(kr,{size:18,className:"search-icon"})]})]})]}),a&&i.jsx("div",{className:"error-message-box",children:a}),i.jsx("div",{className:"refill-table-container",children:t?i.jsx("div",{className:"loading-pulse",children:"Loading..."}):e.length===0?i.jsx("div",{className:"empty-state",children:"No recurring medications found."}):i.jsxs("table",{className:"refill-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Details"}),i.jsx("th",{children:"Medication Info"}),i.jsx("th",{children:"Frequency"}),i.jsx("th",{children:"Next Delivery"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(F=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:F.patientName}),i.jsxs("div",{className:"patient-subtext",children:["Phone: ",F.patientPhone]}),i.jsxs("div",{className:"patient-subtext",children:["Token: ",F.patientToken]})]}),i.jsxs("td",{children:[i.jsx("div",{className:"med-name",children:F.medicationName}),i.jsxs("div",{className:"med-qty",children:["Qty: ",F.quantity]}),(F.tabletsPerDay||F.numberOfDays||F.directions)&&i.jsxs("div",{className:"med-usage-details",style:{fontSize:"0.8em",color:"#666",marginTop:"4px"},children:[F.tabletsPerDay&&i.jsxs("span",{children:[F.tabletsPerDay," tabs/day  "]}),F.numberOfDays&&i.jsxs("span",{children:[F.numberOfDays," days  "]}),F.directions&&i.jsx("span",{children:F.directions})]}),F.notes&&i.jsxs("div",{className:"med-notes",children:["Note: ",F.notes]})]}),i.jsx("td",{children:i.jsx("span",{className:"frequency-badge",children:W(F.frequencyDays)})}),i.jsx("td",{children:i.jsx("div",{className:"date-display",children:new Date(F.nextDeliveryDate).toLocaleDateString()})}),i.jsx("td",{children:i.jsx("span",{className:I(F.status),children:F.status})}),i.jsx("td",{children:i.jsxs("div",{className:"action-buttons",children:[i.jsx("button",{className:"action-btn edit",title:"Edit",onClick:()=>B(F),children:i.jsx(sl,{size:16})}),i.jsx("button",{className:"action-btn delete",title:"Cancel/Delete",children:i.jsx(Hr,{size:16})})]})})]},F.id))})]})}),!t&&h>1&&i.jsxs("div",{className:"pagination-container",children:[i.jsxs("span",{className:"pagination-info",children:["Page ",f," of ",h," (Total ",b,")"]}),i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("button",{onClick:()=>L(f-1),disabled:f===1,className:"page-btn",children:[i.jsx(Ib,{size:16})," Prev"]}),i.jsxs("button",{onClick:()=>L(f+1),disabled:f===h,className:"page-btn",children:["Next ",i.jsx(Qh,{size:16})]})]})]}),i.jsx(OA,{isOpen:S,onClose:()=>{k(!1),P(void 0)},onSuccess:q,medication:T})]})},_ie=()=>{const e=Rt(),n=Gr();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const l=await ge(`/api/patients?search=${r}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const f=(await l.json()).patients[0];if(!f)throw new Error("Patient with the given token not found");const u=await ge(`/api/queue/patient/${f.id}/latest`);if(u.ok){const b=await u.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a}});return}}const h=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:f.id,complaint:a})});if(!h.ok)throw new Error("Failed to create queue entry");const g=await h.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},Jj=()=>{const e=Rt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[R,z]=w.useState([]),[$,L]=w.useState(null),[B,q]=w.useState(""),[W,I]=w.useState(""),[F,V]=w.useState(""),[ee,ie]=w.useState(""),[Y,Q]=w.useState(""),[ne,le]=w.useState(""),[oe,E]=w.useState(""),[de,he]=w.useState(""),[D,me]=w.useState(""),[Ce,te]=w.useState(""),[K,J]=w.useState(""),xe=w.useCallback(async()=>{a(!0),l(null);try{const ce=await ge("/api/distributors");if(!ce.ok)throw new Error(`Failed to fetch distributors: ${ce.statusText}`);const G=await ce.json();t(G)}catch(ce){console.error("Failed to fetch distributors:",ce),l(ce.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{xe()},[xe]);const He=async ce=>{ce.preventDefault(),l(null);try{const G=await ge("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:W,phone:F,email:ee,address:Y,gst_number:ne,drug_license_number:oe})});if(!G.ok){const fe=await G.json();throw new Error(fe.message||"Failed to add distributor.")}alert("Distributor added successfully!"),at(),xe()}catch(G){console.error("Error adding distributor:",G),l(G.message||"Failed to add distributor.")}},re=async ce=>{if(ce.preventDefault(),l(null),!!P)try{const G=await ge(`/api/distributors/${P.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:W,phone:F,email:ee,address:Y,gst_number:ne,drug_license_number:oe})});if(!G.ok){const fe=await G.json();throw new Error(fe.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),Ke(),xe()}catch(G){console.error("Error updating distributor:",G),l(G.message||"Failed to update distributor.")}},Be=async()=>{if(l(null),!!P)try{const ce=await ge(`/api/distributors/${P.id}`,{method:"DELETE"});if(!ce.ok){const G=await ce.json();throw new Error(G.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),yt(),xe()}catch(ce){console.error("Error deleting distributor:",ce),l(ce.message||"Failed to delete distributor.")}},Ae=w.useCallback(async ce=>{l(null);try{const G=await ge(`/api/distributors/${ce}/payments`);if(!G.ok)throw new Error(`Failed to fetch payments: ${G.statusText}`);const Ne=(await G.json()).map(xt=>({...xt,order_value:parseFloat(xt.order_value),amount_paid:parseFloat(xt.amount_paid),balance_remaining:parseFloat(xt.balance_remaining)}));z(Ne);const Le=await ge(`/api/distributors/${ce}/balance`);if(!Le.ok)throw new Error(`Failed to fetch balance: ${Le.statusText}`);const tt=await Le.json();L({totalOrderValue:parseFloat(tt.totalOrderValue),totalAmountPaid:parseFloat(tt.totalAmountPaid),remainingBalance:parseFloat(tt.remainingBalance)})}catch(G){console.error("Error fetching payments/balance:",G),l(G.message||"Failed to load payments or balance.")}},[]),Ie=async ce=>{if(ce.preventDefault(),l(null),!!P)try{const G=await ge(`/api/distributors/${P.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:de,order_value:parseFloat(D||"0"),amount_paid:parseFloat(Ce||"0"),notes:K})});if(!G.ok){const fe=await G.json();throw new Error(fe.message||"Failed to add payment.")}alert("Payment added successfully!"),pe(),Ae(P.id)}catch(G){console.error("Error adding payment:",G),l(G.message||"Failed to add payment.")}},Ye=()=>{q(""),I(""),V(""),ie(""),Q(""),le(""),E(""),l(null),f(!0)},at=()=>{f(!1)},Ze=ce=>{M(ce),q(ce.name),I(ce.contact_person||""),V(ce.phone||""),ie(ce.email||""),Q(ce.address||""),le(ce.gst_number||""),E(ce.drug_license_number||""),l(null),h(!0)},Ke=()=>{h(!1),M(null)},st=ce=>{M(ce),l(null),b(!0)},yt=()=>{b(!1),M(null)},je=ce=>{M(ce),Ae(ce.id),l(null),S(!0)},Ge=()=>{S(!1),M(null),z([]),L(null)},_e=ce=>{M(ce),he(new Date().toISOString().split("T")[0]),me("0"),te("0"),J(""),l(null),T(!0)},pe=()=>{T(!1),M(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):o?i.jsxs("div",{className:"error-indicator",children:["Error: ",o]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(sn,{size:24})," Back"]}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const ce=n.reduce((fe,Ne)=>fe+parseFloat(Ne.remainingBalance||"0"),0),G=ce>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${G}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",ce.toFixed(2)]})})(),i.jsxs("button",{onClick:Ye,className:"add-distributor-button",children:[i.jsx(qa,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(ce=>i.jsxs("tr",{children:[i.jsx("td",{children:ce.name}),i.jsx("td",{children:ce.contact_person||"-"}),i.jsx("td",{children:ce.phone||"-"}),i.jsx("td",{children:ce.email||"-"}),i.jsx("td",{children:ce.address||"-"}),i.jsx("td",{children:ce.gst_number||"-"})," ",i.jsx("td",{children:ce.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(ce.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",ce.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>je(ce),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(lF,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>_e(ce),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(qa,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>Ze(ce),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(sl,{size:16})}),i.jsx("button",{onClick:()=>st(ce),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(Hr,{size:16})})]})})]},ce.id))})]})}),d&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:at,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:He,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:B,onChange:ce=>q(ce.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:W,onChange:ce=>I(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:F,onChange:ce=>V(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:ee,onChange:ce=>ie(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:Y,onChange:ce=>Q(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:ne,onChange:ce=>le(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:oe,onChange:ce=>E(ce.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:at,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),u&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ke,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:re,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:B,onChange:ce=>q(ce.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:W,onChange:ce=>I(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:F,onChange:ce=>V(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:ee,onChange:ce=>ie(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:Y,onChange:ce=>Q(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:ne,onChange:ce=>le(ce.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:oe,onChange:ce=>E(ce.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ke,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:yt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',P.name,'"?']}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:yt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Be,className:"button-delete",children:"Delete"})]})]})}),v&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:Ge,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",P.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),$&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",$.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",$.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",$.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),R.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:R.map(ce=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(ce.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",ce.order_value.toFixed(2)]}),i.jsxs("td",{children:["",ce.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",ce.balance_remaining.toFixed(2)]}),i.jsx("td",{children:ce.notes||"-"})]},ce.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:Ge,className:"button-cancel",children:"Close"})})]})}),k&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:pe,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",P.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Ie,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:de,onChange:ce=>he(ce.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:D,onChange:ce=>me(ce.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:Ce,onChange:ce=>te(ce.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:K,onChange:ce=>J(ce.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:pe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},jie=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[o,l]=w.useState({});if(w.useEffect(()=>{e&&f()},[e,t,a]),!e)return null;const d=(h,g)=>{l(b=>({...b,[h]:g}))},f=()=>{const h={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=Gm(g,b);v&&(h[g]=v.name)}),l(h)},u=()=>{const h={};for(const g in o)o[g]&&o[g]!=="none"&&(h[g]=o[g]);r(h),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(_n,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:f,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((h,g)=>i.jsxs(Tn.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:h}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:o[h]||"",onChange:b=>d(h,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:u,className:"button-submit",children:"Confirm Mapping"})]})]})})},kie=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",mrp:0,stock:0,pack:"",expiry_date:"",rate:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",mrp:0,stock:0,pack:"",expiry_date:"",rate:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),f(!1),h(!1))},[e]),w.useEffect(()=>{const T=M=>{M.key==="Tab"&&b.current===document.activeElement&&(u||(h(!0),setTimeout(()=>{var R;(R=v.current)==null||R.focus()},0),M.preventDefault()))},P=M=>{g.current&&!g.current.contains(M.target)&&h(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",P),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",P)}},[u]);const S=T=>{const{name:P,value:M,type:R}=T.target;a(z=>({...z,[P]:R==="number"?parseFloat(M)||null:M}))},k=T=>{if(T.preventDefault(),l(null),f(!0),r.mrp===void 0||r.stock===void 0){l("MRP and Stock Quantity are required."),f(!1);return}const P={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,rate:r.rate===0?null:r.rate,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(P),f(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(_n,{size:24})})]}),o&&i.jsx("div",{className:"error-message",children:o}),i.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(rl,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(rl,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"mrp",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(rl,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"mrp",id:"mrp",required:!0,step:"0.01",min:"0",value:r.mrp,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(rl,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"stock",id:"stock",required:!0,step:"1",min:"0",value:r.stock,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"pack",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"pack",id:"pack",value:r.pack||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>h(!u),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),u&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"rate",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"rate",id:"rate",step:"0.01",min:"0",value:r.rate??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:d,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:d,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:d?"Adding...":"Add Drug"})]})]})]})}):null},Tie=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r})=>{const a=w.useRef(new Map),o=["name","mrp","stock","pack","expiry_date","rate","brand_name","box_number","gst","discount","batch","hsn_code","mfg","loose"],l=(d,f,u)=>{if(d.key==="Tab"){d.preventDefault();const h=o.indexOf(u);if(h!==-1){const g=(h+1)%o.length,b=o[g],v=a.current.get(`${f}-${b}`);v==null||v.focus()}}};return e.length===0?i.jsxs("div",{className:"no-drugs-message",children:[i.jsx("p",{children:"No drugs added to the purchase list yet."}),i.jsxs("button",{onClick:r,className:"action-button add-drug-to-table-button",children:[i.jsx(qa,{size:18,className:"button-icon"}),"Add the first drug"]})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"purchase-drugs-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Composition Name"}),i.jsx("th",{children:"MRP ()"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Pack"}),i.jsx("th",{children:"Supplier"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Rate ()"}),i.jsx("th",{children:"Brand Name"}),i.jsx("th",{children:"Box Number"}),i.jsx("th",{children:"GST (%)"}),i.jsx("th",{children:"Discount (%)"}),i.jsx("th",{children:"Margin (%)"}),i.jsx("th",{children:"Batch"}),i.jsx("th",{children:"HSN Code"}),i.jsx("th",{children:"MFG"}),i.jsx("th",{children:"Loose"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map((d,f)=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("input",{type:"text",value:d.name||"",onChange:u=>n(u,d.id,"name"),onKeyDown:u=>l(u,d.id,"name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.mrp,onChange:u=>n(u,d.id,"mrp"),onKeyDown:u=>l(u,d.id,"mrp"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mrp`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.stock,onChange:u=>n(u,d.id,"stock"),onKeyDown:u=>l(u,d.id,"stock"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-stock`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.pack||"",onChange:u=>n(u,d.id,"pack"),onKeyDown:u=>l(u,d.id,"pack"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-pack`,u)}})}),i.jsx("td",{children:d.supplier||"N/A"}),i.jsx("td",{children:i.jsx("input",{type:"date",value:d.expiry_date||"",onChange:u=>n(u,d.id,"expiry_date"),onKeyDown:u=>l(u,d.id,"expiry_date"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-expiry_date`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.rate||"",onChange:u=>n(u,d.id,"rate"),onKeyDown:u=>l(u,d.id,"rate"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-rate`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.brand_name||"",onChange:u=>n(u,d.id,"brand_name"),onKeyDown:u=>l(u,d.id,"brand_name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-brand_name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.box_number||"",onChange:u=>n(u,d.id,"box_number"),onKeyDown:u=>l(u,d.id,"box_number"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-box_number`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.gst||"",onChange:u=>n(u,d.id,"gst"),onKeyDown:u=>l(u,d.id,"gst"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-gst`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.discount||"",onChange:u=>n(u,d.id,"discount"),onKeyDown:u=>l(u,d.id,"discount"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-discount`,u)}})}),i.jsx("td",{children:(()=>{const u=d.mrp||0,h=d.rate||0,g=d.gst!==null&&d.gst!==void 0?d.gst/100*h:0,b=d.discount!==null&&d.discount!==void 0?d.discount/100*u:0,v=u-(h+g)-b;return`${(u>0?v/u*100:0).toFixed(2)}%`})()}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.batch||"",onChange:u=>n(u,d.id,"batch"),onKeyDown:u=>l(u,d.id,"batch"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-batch`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.hsn_code||"",onChange:u=>n(u,d.id,"hsn_code"),onKeyDown:u=>l(u,d.id,"hsn_code"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-hsn_code`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.mfg||"",onChange:u=>n(u,d.id,"mfg"),onKeyDown:u=>l(u,d.id,"mfg"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mfg`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.loose||"",onChange:u=>n(u,d.id,"loose"),onKeyDown:u=>l(u,d.id,"loose"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-loose`,u)}})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>t(d.id),className:"delete-button",title:"Remove Item",children:i.jsx(Hr,{size:16})})})]},d.id||f))})]})})},Eie="_container_1yrvv_7",Aie="_header_1yrvv_159",Pie="_backButton_1yrvv_173",Die="_title_1yrvv_217",Iie="_stickyActionBar_1yrvv_239",Rie="_actionRow_1yrvv_269",Mie="_inputWrapper_1yrvv_287",Oie="_inputIcon_1yrvv_297",Lie="_input_1yrvv_287",Fie="_quickDistributors_1yrvv_353",$ie="_distributorChip_1yrvv_369",zie="_distributorChipIcon_1yrvv_415",Bie="_selectedInfo_1yrvv_425",Uie="_resultsDropdown_1yrvv_455",qie="_resultItem_1yrvv_489",Vie="_buttonGroup_1yrvv_517",Hie="_button_1yrvv_517",Gie="_buttonPrimary_1yrvv_561",Yie="_buttonSecondary_1yrvv_583",Wie="_buttonAccent_1yrvv_605",Qie="_buttonDisabled_1yrvv_627",Jie="_tableSection_1yrvv_643",Kie="_cardTitle_1yrvv_659",Xie="_cardIcon_1yrvv_679",Zie="_footer_1yrvv_899",eae="_totalValue_1yrvv_941",tae="_footerControls_1yrvv_965",nae="_paidInputGroup_1yrvv_977",rae="_paidLabel_1yrvv_989",iae="_paidInput_1yrvv_977",aae="_errorMsg_1yrvv_1035",Qt={container:Eie,header:Aie,backButton:Pie,title:Die,stickyActionBar:Iie,actionRow:Rie,inputWrapper:Mie,inputIcon:Oie,input:Lie,quickDistributors:Fie,distributorChip:$ie,distributorChipIcon:zie,selectedInfo:Bie,resultsDropdown:Uie,resultItem:qie,buttonGroup:Vie,button:Hie,buttonPrimary:Gie,buttonSecondary:Yie,buttonAccent:Wie,buttonDisabled:Qie,tableSection:Jie,cardTitle:Kie,cardIcon:Xie,footer:Zie,totalValue:eae,footerControls:tae,paidInputGroup:nae,paidLabel:rae,paidInput:iae,errorMsg:aae},Kj=()=>{const e=Rt(),{purchaseRows:n,setPurchaseRows:t,selectedDistributor:r,setSelectedDistributor:a,searchTerm:o,setSearchTerm:l,amountPaidToDistributor:d,setAmountPaidToDistributor:f,distributors:u,setDistributors:h}=gk(),[g,b]=w.useState(!1),v=w.useRef(null),S=w.useRef(null),[k,T]=w.useState(!1),P=w.useRef(null),[M,R]=w.useState(!1),[z,$]=w.useState([]),[L,B]=w.useState(null),[q,W]=w.useState(null),[I,F]=w.useState(!1),[V,ee]=w.useState([]),ie=["name","description","mrp","stock","pack","supplier","expiry_date","rate","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"];w.useEffect(()=>{(async()=>{try{const Ie=await ge("/api/distributors?limit=4");if(Ie.ok){const Ye=await Ie.json();ee(Array.isArray(Ye)?Ye.slice(0,4):[])}}catch(Ie){console.error("Failed to fetch initial distributors",Ie)}})()},[]);const Y=()=>{const Ie={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",mrp:0,stock:0,pack:"",supplier:r?r.name:"",expiry_date:"",rate:0,box_number:"",gst:0,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""};t(Ye=>[...Ye,Ie])},Q=async(Ae,Ie)=>{if(!Ae){W("No file provided for import.");return}if(!r){W("Please select a distributor before importing.");return}b(!0),W(null);const Ye=new FormData;Ye.append("inventoryFile",Ae),Ye.append("columnMapping",JSON.stringify(Ie));try{const at=await ge("/api/drugs/parse-excel",{method:"POST",body:Ye});if(!at.ok){const Ke=await at.json();throw new Error(Ke.message||`Failed to parse Excel file: ${at.statusText}`)}const Ze=await at.json();t(Ke=>[...Ke,...Ze.map(st=>({...st,id:Date.now().toString()+Math.random().toString(36).substring(2,9),supplier:r?r.name:st.supplier}))]),alert(`Successfully parsed ${Ze.length} drugs from Excel. They have been added to the purchase list.`)}catch(at){console.error("Failed to parse Excel file:",at),W(at.message||"Failed to parse Excel file. Please check the file format and try again.")}finally{v.current&&(v.current.value=""),b(!1),B(null)}},ne=async Ae=>{if(Ae.target.files&&Ae.target.files[0]){const Ie=Ae.target.files[0];B(Ie),W(null),b(!0);const Ye=new FormData;Ye.append("inventoryFile",Ie);try{const at=await ge("/api/drugs/get-file-headers",{method:"POST",body:Ye});if(!at.ok){const Ke=await at.json();throw new Error(Ke.message||`Failed to get file headers: ${at.statusText}`)}const{headers:Ze}=await at.json();$(Ze),R(!0)}catch(at){console.error("Failed to get file headers:",at),W(at.message||"Failed to read file headers. Please check the file format and try again."),B(null)}finally{b(!1)}}else B(null)},le=Ae=>{L?Q(L,Ae):W("No file selected for import after mapping."),R(!1)},oe=()=>{R(!1),$([]),B(null),v.current&&(v.current.value="")},E=()=>{var Ae;(Ae=v.current)==null||Ae.click()},de=async Ae=>{if(Ae.target.files&&Ae.target.files[0]){const Ie=Ae.target.files[0];W(null),b(!0);const Ye=new FormData;Ye.append("file",Ie),Ye.append("output_type","csv");const Ze={Authorization:"Bearer 00841ac4-b279-11f0-ab55-0a3a41e3fad1"};try{const Ke=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:Ze,body:Ye});if(!Ke.ok){const G=await Ke.json();throw new Error(G.message||`Failed to extract data from image/PDF: ${Ke.statusText}`)}const st=await Ke.json();if(!st.success||!st.content)throw new Error(st.detail||"Nanonets API did not return expected content.");let yt=st.content;yt=yt.split(`
`).filter(G=>!G.startsWith("#")&&G.trim()!=="").join(`
`);const Ge=new File([yt],"extracted_data.csv",{type:"text/csv"}),_e=new FormData;_e.append("inventoryFile",Ge);const pe=await ge("/api/drugs/get-file-headers",{method:"POST",body:_e});if(!pe.ok){const G=await pe.json();throw new Error(G.message||`Failed to get headers from extracted CSV: ${pe.statusText}`)}const{headers:ce}=await pe.json();$(ce),B(Ge),R(!0)}catch(Ke){console.error("Failed to extract data from image/PDF:",Ke),W(Ke.message||"Failed to extract data from image/PDF. Please check the file and try again.")}finally{S.current&&(S.current.value=""),b(!1)}}},he=()=>{var Ae;(Ae=S.current)==null||Ae.click()},D=()=>{if(!r){W("Please select a distributor before adding a drug manually.");return}F(!0)},me=()=>{F(!1),W(null)},Ce=Ae=>{t(Ie=>[...Ie,{...Ae,id:Date.now().toString(),supplier:r?r.name:Ae.supplier}]),me()},te=Ae=>{t(Ie=>Ie.filter(Ye=>Ye.id!==Ae))},K=(Ae,Ie,Ye)=>{const{value:at}=Ae.target;t(Ze=>Ze.map(Ke=>{if(Ke.id===Ie){let st=at;Ye==="expiry_date"?st=at.trim()===""?null:at:["mrp","stock","rate","gst","margin","discount","loose"].includes(Ye)&&(st=parseFloat(at),isNaN(st)&&(st=null));const yt={...Ke,[Ye]:st};return Ye==="name"&&r&&!yt.supplier&&(yt.supplier=r.name),yt}return Ke}))},J=w.useCallback(()=>n.reduce((Ae,Ie)=>{const Ye=Ie.stock||0,at=Ie.rate||0,Ze=Ie.gst||0,Ke=Ie.discount||0;let st=at*(1-Ke/100),yt=Ye*st;return yt+=yt*(Ze/100),Ae+yt},0),[n]),xe=async()=>{if(!r){W("Please select a distributor before submitting the purchase.");return}const Ae=n.filter(Ie=>Object.values(Ie).some(Ye=>typeof Ye=="string"&&Ye.trim()!==""||typeof Ye=="number"&&Ye!==0||Ye!=null&&typeof Ye!="string"&&typeof Ye!="number"));if(Ae.length===0){W("No valid drugs to submit. Please fill in at least one field for a row, or remove empty rows."),b(!1);return}b(!0),W(null);try{for(const Ze of Ae){const Ke={...Ze,expiry_date:Ze.expiry_date===""?null:Ze.expiry_date,distributorId:r.id},st=await ge("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ke)});if(!st.ok){const yt=await st.json();throw new Error(yt.message||`Failed to add drug ${Ze.name}: ${st.statusText}`)}}const Ie=J(),Ye=new Date().toISOString().split("T")[0],at=await ge(`/api/distributors/${r.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:Ye,order_value:Ie,amount_paid:d,notes:"Payment from purchase page."})});if(!at.ok){const Ze=await at.json();throw new Error(Ze.message||`Failed to record distributor payment: ${at.statusText}`)}alert("All valid drugs added to inventory and distributor payment recorded successfully!"),t([]),a(null),l(""),f(0),e("/dashboard/inventory")}catch(Ie){console.error("Failed to submit purchase:",Ie),W(Ie.message||"Failed to submit purchase. Please try again.")}finally{b(!1)}},He=w.useCallback(async Ae=>{if(Ae.trim()===""){h([]);return}try{const Ie=await ge(`/api/distributors?search=${encodeURIComponent(Ae)}`);if(!Ie.ok)throw new Error(`Failed to fetch distributors: ${Ie.statusText}`);const Ye=await Ie.json();h(Ye)}catch(Ie){console.error("Failed to fetch distributors:",Ie),W(Ie.message||"Failed to load distributors.")}},[]),re=Ae=>{const Ie=Ae.target.value;l(Ie),a(null),P.current&&clearTimeout(P.current),Ie.trim()!==""?P.current=setTimeout(()=>{He(Ie),T(!0)},300):(h([]),T(!1))},Be=Ae=>{a(Ae),l(Ae.name),T(!1),h([])};return w.useEffect(()=>{const Ae=Ie=>{Ie.target instanceof HTMLElement&&!Ie.target.closest(`.${Qt.inputWrapper}`)&&T(!1)};return document.addEventListener("mousedown",Ae),()=>{document.removeEventListener("mousedown",Ae),P.current&&clearTimeout(P.current)}},[]),i.jsxs("div",{className:Qt.container,children:[i.jsxs("div",{className:Qt.header,children:[i.jsx("button",{onClick:()=>e(-1),className:Qt.backButton,title:"Go Back",children:i.jsx(sn,{size:24})}),i.jsx("h2",{className:Qt.title,children:"Purchase Inventory"})]}),q&&i.jsxs("div",{className:Qt.errorMsg,children:[i.jsx(jr,{size:20}),q]}),i.jsx("div",{className:Qt.stickyActionBar,children:i.jsxs("div",{className:Qt.actionRow,children:[i.jsxs("div",{style:{flex:1,minWidth:"300px",position:"relative"},children:[i.jsxs("div",{className:Qt.inputWrapper,children:[i.jsx(kr,{className:Qt.inputIcon,size:20}),i.jsx("input",{type:"text",placeholder:"Search distributor...",value:o,onChange:re,onFocus:()=>o.trim()!==""&&T(!0),className:Qt.input}),k&&u.length>0&&i.jsx("ul",{className:Qt.resultsDropdown,children:u.map(Ae=>i.jsx("li",{onClick:()=>Be(Ae),className:Qt.resultItem,children:Ae.name},Ae.id))})]}),V.length>0&&!r&&i.jsx("div",{className:Qt.quickDistributors,children:V.map(Ae=>i.jsxs("button",{className:Qt.distributorChip,onClick:()=>Be(Ae),children:[i.jsx(Ns,{className:Qt.distributorChipIcon}),Ae.name]},Ae.id))}),r&&i.jsxs("div",{className:Qt.selectedInfo,style:{marginTop:"0.5rem",marginBottom:0},children:[i.jsx(Wa,{size:18}),i.jsxs("span",{children:["Selected: ",i.jsx("strong",{children:r.name})]})]})]}),i.jsxs("div",{className:Qt.buttonGroup,children:[i.jsx("input",{ref:v,type:"file",className:"sr-only",style:{display:"none"},accept:".xlsx, .xls, .csv",onChange:ne}),i.jsx("input",{ref:S,type:"file",className:"sr-only",style:{display:"none"},accept:".pdf, .png, .jpg, .jpeg",onChange:de}),i.jsxs("button",{onClick:E,disabled:g||!r,className:`${Qt.button} ${Qt.buttonPrimary} ${g||!r?Qt.buttonDisabled:""}`,title:r?"":"Select a distributor to import",children:[i.jsx(k6,{size:18}),g?"Processing...":"Import Excel/CSV"]}),i.jsxs("button",{onClick:he,disabled:g||!r,className:`${Qt.button} ${Qt.buttonSecondary} ${g||!r?Qt.buttonDisabled:""}`,title:r?"":"Select a distributor",children:[i.jsx(Jl,{size:18}),"Scan Image/PDF"]}),i.jsxs("button",{onClick:D,disabled:!r,className:`${Qt.button} ${Qt.buttonAccent} ${r?"":Qt.buttonDisabled}`,title:r?"":"Select a distributor",children:[i.jsx(qa,{size:18}),"Add Manually"]})]})]})}),i.jsx(jie,{isOpen:M,onClose:oe,excelHeaders:z,onConfirm:le,availableFields:ie}),I&&i.jsx(kie,{isOpen:I,onClose:me,onDrugAddedToPurchase:Ce}),i.jsxs("div",{className:Qt.tableSection,children:[i.jsxs("div",{className:Qt.cardTitle,children:[i.jsx(x6,{className:Qt.cardIcon,size:24}),"Purchase Items (",n.length,")"]}),i.jsx(Tie,{purchaseRows:n,onCellChange:K,onRemoveDrug:te,onAddEmptyRow:Y}),i.jsxs("div",{className:Qt.footer,children:[i.jsxs("button",{onClick:Y,className:`${Qt.button} ${Qt.buttonSecondary}`,children:[i.jsx(qa,{size:18}),"Add New Row"]}),i.jsxs("div",{className:Qt.footerControls,children:[i.jsxs("div",{className:Qt.paidInputGroup,children:[i.jsx("label",{htmlFor:"amount-paid",className:Qt.paidLabel,children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount-paid",value:d,onChange:Ae=>f(parseFloat(Ae.target.value)||0),placeholder:"0.00",className:Qt.paidInput,step:"0.01",disabled:!r})]}),i.jsxs("div",{className:Qt.totalValue,children:["Total: ",i.jsxs("span",{children:["",J().toFixed(2)]})]}),i.jsx("button",{onClick:xe,disabled:g||n.length===0||!r,className:`${Qt.button} ${Qt.buttonPrimary} ${Qt.submitButton} ${g||!r||n.length===0?Qt.buttonDisabled:""}`,style:{padding:"0.8rem 1.5rem",fontSize:"1rem"},children:g?"Submitting...":"Complete Purchase"})]})]})]})]})},sae=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},oae=()=>{const e=Rt(),n=Gr(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(!0),[f,u]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[T,P]=w.useState(""),[M,R]=w.useState(""),[z,$]=w.useState(""),[L,B]=w.useState(""),[q,W]=w.useState(0),I=w.useRef(!1),F=oe=>{const E=Math.max(0,Math.min(100,isNaN(oe)?0:oe));I.current=!0,W(E);const de=a.map(he=>({...he,discount_percentage:E}));o(de)},V=(oe,E)=>{const de=[...a];de[oe].discount_percentage=isNaN(E)?0:E,o(de)};w.useEffect(()=>{if(I.current){I.current=!1;return}const oe=a.reduce((he,D)=>he+(D.total_price??0),0);if(oe===0){W(0);return}const de=a.reduce((he,D)=>{const Ce=(D.total_price??0)*((D.discount_percentage??0)/100);return he+Ce},0)/oe*100;W(he=>Math.abs(he-de)>.01?de:he)},[a]);const ee=async()=>{if(!t)return u("No order data available to bill."),null;if(a.length===0)return u("Cannot bill an empty order."),null;g(!0),u(null);try{const oe=a.map(me=>{const Ce=(me.pricePerLooseUnit??0)*(me.looseQuantity??0),te=Ce*((me.discount_percentage??0)/100),K=Ce-te;return{name:me.name,pack_quantity:me.loosePacks??0,loose_quantity:me.looseUnits??0,price:me.originalPrice??0,pack_price:me.originalPrice??0,loose_price:me.pricePerLooseUnit??0,total:K,drug_id:me.drug_id,discount_percentage:me.discount_percentage??0,batch:me.batch,expiry_date:me.expiry_date}}),E={patientId:t.patientId,queueId:t.id,items:oe,amount:le,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:q},de=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),he=await de.json();if(!de.ok||!he.id)throw new Error(he.message||"Failed to create bill.");const D=await ge(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:he.id,medications:a})});if(!D.ok){const me=await D.text();throw new Error(`Failed to update pharmacy order status: ${D.statusText} - ${me}`)}return r(me=>me?{...me,status:"billed",bill_id:he.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${he.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:he.id},initialItems:a}}),he.id}catch(oe){return console.error("Billing process failed:",oe),u(oe.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},ie=()=>{window.print()},Y=async()=>{await ee()&&(window.print(),e(-1))};w.useEffect(()=>{const oe=n.pathname.split("/"),E=oe[oe.length-1];E?(async()=>{try{const he=await ge(`/api/pharmacy-orders/${E}`);if(!he.ok)throw new Error("Failed to fetch pharmacy order details");const D=await he.json();r(D);const me=D.medications.map(Ce=>{const te=sae(Ce.unit),K=(Ce.pack_quantity??0)*te+(Ce.loose_quantity??0);return{...Ce,isLoose:!0,loosePacks:Ce.pack_quantity??0,looseUnits:Ce.loose_quantity??0,looseQuantity:K,pack_price:Number(Ce.pack_price)||0,loose_price:Number(Ce.loose_price)||0,total_price:Number(Ce.total_price)||0,pricePerLooseUnit:Number(Ce.loose_price)||0,originalPrice:Number(Ce.pack_price)||0,discount_percentage:Number(Ce.discount_percentage)??0,directions_to_use:Ce.directions_to_use,tabletsPerDay:Ce.tabletsPerDay,numberOfDays:Ce.numberOfDays,batch:Ce.batch,expiry_date:Ce.expiry_date}});o(me)}catch(he){console.error("Failed to fetch order:",he),u(he.message||"Failed to load order details.")}finally{d(!1)}})():(u("No pharmacy order ID provided."),d(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const E=await ge("/api/clinics/settings");if(!E.ok)throw new Error("Failed to fetch clinic settings");const de=await E.json();P(de.upi_id||""),R(de.name||""),$(de.address||""),B(de.notes||"")}catch(E){console.error("Error fetching clinic settings:",E)}})()},[]);const Q=w.useMemo(()=>a.reduce((oe,E)=>oe+(E.total_price??0),0),[a]),ne=w.useMemo(()=>a.reduce((oe,E)=>{const he=(E.total_price??0)*(E.discount_percentage??0)/100;return oe+he},0),[a]),le=w.useMemo(()=>Q-ne,[Q,ne]);return w.useEffect(()=>{if(le>0&&T){const oe=`upi://pay?pa=${T}&pn=ClinicName&am=${le.toFixed(2)}&cu=INR`;k(oe)}else k("")},[le,T]),l?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):f?i.jsxs("div",{className:"error-message-box",children:["Error: ",f]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:M?`${M} Pharmacy`:"Pharmacy Bill"}),(z||L)&&i.jsxs("div",{className:"clinic-details-print",children:[z&&i.jsx("span",{className:"small-text clinic-address",children:z}),L&&i.jsx("span",{className:"small-text clinic-notes",children:L})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ns,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(tg,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(zh,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(sn,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ns,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(tg,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(Ud,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(zh,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((oe,E)=>{var Ce,te;const de=oe.total_price??0,he=de*(oe.discount_percentage??0)/100,D=de-he;return i.jsxs("tr",{children:[i.jsx("td",{children:E+1}),i.jsx("td",{children:oe.name}),i.jsx("td",{children:oe.batch||"N/A"}),i.jsx("td",{children:oe.expiry_date?new Date(oe.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",oe.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",oe.looseUnits??0]})]}),i.jsx("td",{children:((Ce=oe.originalPrice)==null?void 0:Ce.toFixed(2))??"N/A"}),i.jsx("td",{children:((te=oe.pricePerLooseUnit)==null?void 0:te.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:oe.discount_percentage??0,onChange:K=>V(E,parseFloat(K.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:D.toFixed(2)})]},E)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Vh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",Q.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",q.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",ne.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(le*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",le.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",Q.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",ne.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:q,onChange:oe=>F(parseFloat(oe.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:h||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",le.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Vh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:oe=>v(oe.target.value),className:"payment-mode-select",disabled:h||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:ie,className:"secondary-button print-preview-button no-print",disabled:h||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:Y,className:"primary-button",disabled:h||a.length===0,children:h?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},lae=()=>{const e=Rt(),n=Gr(),[t,r]=w.useState(null),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState([]),[h,g]=w.useState(!0),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState("cash"),[M,R]=w.useState(""),[z,$]=w.useState(""),[L,B]=w.useState(""),[q,W]=w.useState(""),[I,F]=w.useState(""),[V,ee]=w.useState(0),ie=w.useRef(!1),Y=D=>{const me=Math.max(0,Math.min(100,isNaN(D)?0:D));ie.current=!0,ee(me);const Ce=f.map(te=>({...te,discount_percentage:me}));u(Ce)},Q=(D,me)=>{const Ce=[...f];Ce[D].discount_percentage=isNaN(me)?0:me,u(Ce)};w.useEffect(()=>{if(ie.current){ie.current=!1;return}const D=f.reduce((te,K)=>te+(K.price??0),0);if(D===0){ee(0);return}const Ce=f.reduce((te,K)=>{const xe=(K.price??0)*((K.discount_percentage??0)/100);return te+xe},0)/D*100;ee(te=>Math.abs(te-Ce)>.01?Ce:te)},[f]);const ne=async()=>{if(!t)return v("No order data available to bill."),null;if(f.length===0)return v("Cannot bill an empty order."),null;k(!0),v(null);try{const D=f.map(J=>{const xe=J.price,He=xe*((J.discount_percentage??0)/100),re=xe-He;return{name:J.name,price:J.price,quantity:1,total:re,item_id:J.id,type:"lab_test",discount_percentage:J.discount_percentage??0}}),me={patientId:t.patient_id,items:D,amount:he,paymentMode:T,type:"lab",related_id:t.id,status:"paid",discountPercentage:V},Ce=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)}),te=await Ce.json();if(!Ce.ok||!te.id)throw new Error(te.message||"Failed to create bill.");const K=await ge(`/api/lab/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:te.id})});if(!K.ok){const J=await K.text();throw new Error(`Failed to update lab order status: ${K.statusText} - ${J}`)}return r(J=>J?{...J,status:"billed",bill_id:te.id}:null),alert(`Lab Order bill created (ID: ${te.id}) and marked as billed.`),e(`/dashboard/lab-billing/${t.id}`,{replace:!0,state:{...n.state,order:{...t,status:"billed",bill_id:te.id}}}),te.id}catch(D){return console.error("Billing process failed:",D),v(D.message||"Failed to mark order as billed. Please try again."),null}finally{k(!1)}},le=()=>{window.print()},oe=async()=>{await ne()&&(window.print(),e(-1))};w.useEffect(()=>{const D=n.pathname.split("/"),me=D[D.length-1];me?(async()=>{try{const te=await ge(`/api/lab/${me}`);if(!te.ok)throw new Error("Failed to fetch lab order details");const K=await te.json();if(r(K),K.patient_id){const xe=await ge(`/api/patients/${K.patient_id}`);if(xe.ok){const He=await xe.json();o(He.name),d(He.patient_token_number)}}const J=K.tests.map(xe=>({...xe,price:typeof xe.price=="string"?parseFloat(xe.price):Number(xe.price)||0,discount_percentage:0,total_price:typeof xe.price=="string"?parseFloat(xe.price):Number(xe.price)||0}));u(J)}catch(te){console.error("Failed to fetch order:",te),v(te.message||"Failed to load order details.")}finally{g(!1)}})():(v("No lab order ID provided."),g(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const me=await ge("/api/clinics/settings");if(!me.ok)throw new Error("Failed to fetch clinic settings");const Ce=await me.json();$(Ce.upi_id||""),B(Ce.name||""),W(Ce.address||""),F(Ce.notes||"")}catch(me){console.error("Error fetching clinic settings:",me)}})()},[]);const E=w.useMemo(()=>f.reduce((D,me)=>D+(me.price??0),0),[f]),de=w.useMemo(()=>f.reduce((D,me)=>{const te=(me.price??0)*(me.discount_percentage??0)/100;return D+te},0),[f]),he=w.useMemo(()=>E-de,[E,de]);return w.useEffect(()=>{if(he>0&&z){const D=`upi://pay?pa=${z}&pn=ClinicName&am=${he.toFixed(2)}&cu=INR`;R(D)}else R("")},[he,z]),h?i.jsx("div",{className:"loading-pulse",children:"Loading Lab Bill..."}):b?i.jsxs("div",{className:"error-message-box",children:["Error: ",b]}):t?i.jsxs("div",{className:"pharmacy-billing-page",children:[" ",i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"LAB INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:L?`${L} Lab`:"Lab Bill"}),(q||I)&&i.jsxs("div",{className:"clinic-details-print",children:[q&&i.jsx("span",{className:"small-text clinic-address",children:q}),I&&i.jsx("span",{className:"small-text clinic-notes",children:I})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ns,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(tg,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(zh,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(sn,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ns,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(tg,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(io,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(zh,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),f.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"TEST DESCRIPTION"}),i.jsx("th",{children:"PRICE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:f.map((D,me)=>{const Ce=D.price??0,te=Ce*(D.discount_percentage??0)/100,K=Ce-te;return i.jsxs("tr",{children:[i.jsx("td",{children:me+1}),i.jsx("td",{children:D.name}),i.jsx("td",{children:typeof D.price=="number"?D.price.toFixed(2):Number(D.price||0).toFixed(2)}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:D.discount_percentage??0,onChange:J=>Q(me,parseFloat(J.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsx("td",{children:K.toFixed(2)})]},me)})})]}):i.jsx("p",{children:"No tests in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[M&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${T!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Vh,{value:M,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",V.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",de.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",he.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",de.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:V,onChange:D=>Y(parseFloat(D.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:S||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",he.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:M?i.jsxs(i.Fragment,{children:[i.jsx(Vh,{value:M,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:T,onChange:D=>P(D.target.value),className:"payment-mode-select",disabled:S||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status!=="billed"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:le,className:"secondary-button print-preview-button no-print",disabled:S||f.length===0,children:"Print Preview"}),i.jsx("button",{onClick:oe,className:"primary-button",disabled:S||f.length===0,children:S?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e("/billing",{state:{billId:t.bill_id}}),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})]}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},cae=()=>{const e=Rt(),[n,t]=w.useState(!0),[r,a]=w.useState([]),[o,l]=w.useState(""),[d,f]=w.useState(!0),[u,h]=w.useState(!1),[g,b]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[v,S]=w.useState(null),[k,T]=w.useState(!1),P=(I,F)=>{S({type:I,message:F}),setTimeout(()=>S(null),3e3)},M=I=>{switch(I){case"doctor":return i.jsx(Vk,{size:14,className:"text-blue-600"});case"receptionist":return i.jsx(Tw,{size:14,className:"text-green-600"});case"pharmacy":return i.jsx(Ud,{size:14,className:"text-purple-600"});case"lab":return i.jsx(io,{size:14,className:"text-yellow-600"});default:return i.jsx(Ob,{size:14,className:"text-gray-500"})}},R=I=>{switch(I){case"doctor":return"avatar-blue";case"receptionist":return"avatar-green";case"pharmacy":return"avatar-purple";case"lab":return"avatar-yellow";default:return"avatar-gray"}},z=w.useCallback(async()=>{t(!0);try{const I=await ge("/staff");if(I.ok){const F=await I.json();a(F.map(V=>({...V,id:V._id||V.id})))}}catch(I){console.error("Error fetching staff:",I),P("error","Failed to load staff list")}finally{t(!1)}},[]),$=w.useCallback(async()=>{f(!0);try{const I=await ge("/api/clinics/settings");if(I.ok){const F=await I.json();b({admissionCharge:parseFloat(F.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(F.perDayCharge||0).toFixed(2),otherCharges:parseFloat(F.otherCharges||0).toFixed(2),aiMemory:F.aiMemory||"",clinicWideSystemPrompt:F.clinicWideSystemPrompt||"",gemini_api_key:F.gemini_api_key||"",low_stock_threshold:F.low_stock_threshold!==void 0&&F.low_stock_threshold!==null?String(F.low_stock_threshold):"10",name:F.name||"",logoUrl:F.logoUrl||"",upi_id:F.upi_id||"",address:F.address||"",notes:F.notes||"",clinic_id:F.clinic_id})}}catch(I){console.error("Error fetching settings:",I),P("error","Failed to load settings")}finally{f(!1)}},[]);w.useEffect(()=>{z(),$()},[z,$]);const L=I=>{const{name:F,value:V}=I.target;b(ee=>({...ee,[F]:V}))},B=async()=>{h(!0);try{const I=parseFloat(g.admissionCharge),F=parseFloat(g.perDayCharge),V=parseFloat(g.otherCharges),ee=parseInt(g.low_stock_threshold);if((await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:g.name,admissionCharge:I,perDayCharge:F,otherCharges:V,aiMemory:g.aiMemory,clinicWideSystemPrompt:g.clinicWideSystemPrompt,gemini_api_key:g.gemini_api_key,low_stock_threshold:ee,logoUrl:g.logoUrl,upi_id:g.upi_id,address:g.address,notes:g.notes})})).ok)P("success","Changes saved successfully");else throw new Error("Failed to save")}catch(I){console.error("Error saving settings:",I),P("error","Failed to save settings")}finally{h(!1)}},q=r.filter(I=>I.name.toLowerCase().includes(o.toLowerCase())||I.role.toLowerCase().includes(o.toLowerCase())),W=async I=>{for(const F of I){const V=document.getElementById(F);V&&(V.scrollIntoView({behavior:"smooth",block:"center"}),V.classList.add("ai-feedback-glow"),await new Promise(ee=>setTimeout(ee,1500)),V.classList.remove("ai-feedback-glow"))}};return i.jsxs("div",{className:"clinic-hub-container",children:[i.jsxs("header",{className:"clinic-hub-header",children:[i.jsxs("div",{className:"clinic-hub-title",children:[i.jsx("h1",{children:"Clinic Hub"}),i.jsx("p",{className:"clinic-hub-subtitle",children:"Manage your ecosystem"})]}),i.jsxs("div",{className:"clinic-hub-actions",children:[v&&i.jsx("div",{className:`px-4 py-2 rounded-md text-sm font-medium ${v.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.message}),i.jsxs("button",{className:"btn-assistant",onClick:()=>T(!0),style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",backgroundColor:"#7c3aed",color:"white",borderRadius:"6px",marginRight:"8px"},children:[i.jsx(eg,{size:16})," AI Assistant"]}),i.jsxs("button",{className:"btn-add-staff",onClick:()=>e("/dashboard/staff/add"),children:[i.jsx(al,{size:16})," Add Staff"]}),i.jsxs("button",{className:"btn-save-changes",onClick:B,disabled:u,children:[i.jsx(qd,{size:16})," ",u?"Saving...":"Save Changes"]})]})]}),i.jsxs("main",{className:"clinic-hub-content",children:[i.jsxs("div",{className:"team-directory-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx(Jh,{size:18,className:"text-gray-500"}),i.jsxs("span",{className:"panel-title",children:["Team Directory (",r.length,")"]})]}),i.jsx("div",{className:"search-container",children:i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(kr,{size:16,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Find member...",className:"search-input",value:o,onChange:I=>l(I.target.value)})]})}),i.jsx("div",{className:"team-list",children:n?i.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading staff..."}):q.length===0?i.jsx("div",{className:"empty-state",children:"No staff found."}):q.map(I=>i.jsxs("div",{id:`staff-member-${I.id}`,className:"team-member-item",children:[i.jsx("div",{className:`member-avatar ${R(I.role)}`,children:I.name.charAt(0).toUpperCase()}),i.jsxs("div",{className:"member-info",children:[i.jsx("div",{className:"member-name",children:I.name}),i.jsxs("div",{className:"member-role",children:[M(I.role),I.role]})]}),i.jsx("span",{className:`member-status ${I.active?"status-active":"status-inactive"}`,children:I.active?"Active":"Inactive"}),i.jsx("button",{className:"btn-edit-member",onClick:()=>e(`/dashboard/staff/edit/${I.id}`),children:i.jsx(sl,{size:16})})]},I.id))})]}),i.jsxs("div",{className:"config-console-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx($k,{size:18,className:"text-gray-500"}),i.jsx("span",{className:"panel-title",children:"Configuration Console"})]}),d?i.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading settings..."}):i.jsxs("div",{className:"config-content",children:[i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(zk,{size:16})," CLINIC IDENTITY & LOCATION"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Clinic Name"}),i.jsx("input",{type:"text",className:"form-input",name:"name",id:"setting-name",value:g.name,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Logo URL"}),i.jsx("input",{type:"url",className:"form-input",placeholder:"https://",name:"logoUrl",id:"setting-logoUrl",value:g.logoUrl,onChange:L})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Address"}),i.jsx("textarea",{className:"form-textarea",placeholder:"Full physical address",name:"address",id:"setting-address",value:g.address,onChange:L})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Bh,{size:16})," FINANCIAL OPERATIONS"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Admission Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"admissionCharge",id:"setting-admissionCharge",value:g.admissionCharge,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Per Day Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"perDayCharge",id:"setting-perDayCharge",value:g.perDayCharge,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Other Charges ()"}),i.jsx("input",{type:"number",className:"form-input",name:"otherCharges",id:"setting-otherCharges",value:g.otherCharges,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"UPI ID"}),i.jsx("input",{type:"text",className:"form-input",name:"upi_id",id:"setting-upi_id",value:g.upi_id,onChange:L})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Mk,{size:16})," INVENTORY & AI"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Low Stock Threshold"}),i.jsx("input",{type:"number",className:"form-input",name:"low_stock_threshold",id:"setting-low_stock_threshold",value:g.low_stock_threshold,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Gemini API Key"}),i.jsx("input",{type:"password",className:"form-input",name:"gemini_api_key",id:"setting-gemini_api_key",value:g.gemini_api_key,onChange:L,placeholder:"******************"})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Clinic-Wide System Prompt"}),i.jsx("textarea",{className:"form-textarea",name:"clinicWideSystemPrompt",id:"setting-clinicWideSystemPrompt",value:g.clinicWideSystemPrompt,onChange:L,placeholder:"Instructions for the AI..."})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"AI Memory (Context)"}),i.jsx("textarea",{className:"form-textarea",name:"aiMemory",id:"setting-aiMemory",value:g.aiMemory,onChange:L,placeholder:"Shared context for the AI..."})]})]})]})]})]})]}),k&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex justify-end",children:i.jsx("div",{className:"w-96 bg-white h-full shadow-2xl animate-slide-in-right",children:i.jsx(K2,{onClose:()=>T(!1),settings:g,staffList:r,onSettingsUpdate:$,onStaffUpdate:z,onHighlight:W})})})]})},uae="_container_1sjqk_1",dae="_header_1sjqk_15",fae="_title_1sjqk_37",hae="_controls_1sjqk_51",pae="_dateInputGroup_1sjqk_63",mae="_dateInputLabel_1sjqk_75",gae="_dateInput_1sjqk_63",yae="_section_1sjqk_121",xae="_sectionTitle_1sjqk_137",bae="_statsGrid_1sjqk_157",vae="_statCard_1sjqk_171",wae="_statTitle_1sjqk_197",Sae="_statValue_1sjqk_213",Nae="_statSubtitle_1sjqk_225",Cae="_revenueGrid_1sjqk_239",_ae="_revenueCard_1sjqk_253",jae="_revenueCardTitle_1sjqk_267",kae="_revenueCardList_1sjqk_281",Tae="_revenueCardListItem_1sjqk_293",Eae="_tableContainer_1sjqk_321",Aae="_table_1sjqk_321",Pae="_textGreen_1sjqk_395",Dae="_textRed_1sjqk_403",Iae="_loadingContainer_1sjqk_421",Rae="_errorAlert_1sjqk_439",en={container:uae,header:dae,title:fae,controls:hae,dateInputGroup:pae,dateInputLabel:mae,dateInput:gae,section:yae,sectionTitle:xae,statsGrid:bae,statCard:vae,statTitle:wae,statValue:Sae,statSubtitle:Nae,revenueGrid:Cae,revenueCard:_ae,revenueCardTitle:jae,revenueCardList:kae,revenueCardListItem:Tae,tableContainer:Eae,table:Aae,textGreen:Pae,textRed:Dae,loadingContainer:Iae,errorAlert:Rae},Mae=()=>{const e=Rt(),n=Gr(),t=new URLSearchParams(n.search),r=t.get("startDate"),a=t.get("endDate"),o=new Date().toISOString().split("T")[0],[l,d]=w.useState(r||o),[f,u]=w.useState(a||o),[h,g]=w.useState(!1),[b,v]=w.useState(null),{setAnalysisDateRange:S,analysisDateRange:k,setAnalysisData:T,registerAnalysisNavigator:P,registerAnalysisRefresher:M}=Tb(),[R,z]=w.useState(0),[$,L]=w.useState(0),[B,q]=w.useState(null),[W,I]=w.useState(null),[F,V]=w.useState({reception:{},pharmacy:{},lab:{}}),[ee,ie]=w.useState(null),Y=w.useCallback(async(ne,le)=>{g(!0),v(null);const oe=ne||l,E=le||f;if(z(0),L(0),q(null),I(null),V({reception:{},pharmacy:{},lab:{}}),ie(null),!oe||!E){v("Please select both start and end dates."),g(!1);return}try{const de=l3(),[he,D,me,Ce]=await Promise.all([ge(`/api/bills?startDate=${l}&endDate=${f}`),ge(`/api/payment/admission?startDate=${l}&endDate=${f}`),ge(`/api/subscriptions/transactions/manual?startDate=${l}&endDate=${f}`),de?ge(`/api/inventory/comprehensive-analysis?startDate=${l}&endDate=${f}&clinicId=${de}`):Promise.resolve(null)]);if(he.ok&&D.ok&&me.ok){const te=await he.json(),K=await D.json(),J=await me.json(),xe=te.bills||[],He=K.admissionPayments||[],re=J||[];let Be=0,Ae=0;const Ie={},Ye={consultation:0,pharmacy:0,lab:0,other:0},at={reception:{},pharmacy:{},lab:{}};xe.forEach(Ze=>{if(Ze.status==="paid"||Ze.type==="pharmacy_return"){const Ke=parseFloat(Ze.amount.toString()),st=Ze.payment_mode||"Unknown";let yt=Ze.type||"other";yt==="pharmacy_return"&&(Ae+=Ke,yt="pharmacy"),Be+=Ke,Ie[st]=(Ie[st]||0)+Ke,Ye.hasOwnProperty(yt)?Ye[yt]=(Ye[yt]||0)+Ke:Ye.other=(Ye.other||0)+Ke,yt==="pharmacy"?at.pharmacy[st]=(at.pharmacy[st]||0)+Ke:yt==="lab"?at.lab[st]=(at.lab[st]||0)+Ke:at.reception[st]=(at.reception[st]||0)+Ke}}),He.forEach(Ze=>{const Ke=parseFloat(Ze.amount_paid.toString()),st=Ze.payment_mode||"Unknown";Be+=Ke,Ie[st]=(Ie[st]||0)+Ke,at.reception[st]=(at.reception[st]||0)+Ke}),re.forEach(Ze=>{var yt,je;const Ke=parseFloat(((je=(yt=Ze.subscriptionPlan)==null?void 0:yt.price)==null?void 0:je.toString())??"0"),st=Ze.subscription_payment_method||"manual";Be+=Ke,Ie[st]=(Ie[st]||0)+Ke,at.reception[st]=(at.reception[st]||0)+Ke}),z(Be),L(Ae),q(Ie),I(Ye),V(at)}if(Ce&&Ce.ok){const te=await Ce.json();ie(te)}}catch(de){console.error("Analysis Fetch Error:",de),v("Failed to fetch analysis data. Please try again.")}finally{g(!1)}},[l,f]);w.useEffect(()=>{P(ne=>{const le=`analysis-${ne}`,oe=document.getElementById(le);oe&&(oe.scrollIntoView({behavior:"smooth",block:"center"}),oe.classList.add("ai-highlight-glow"),setTimeout(()=>oe.classList.remove("ai-highlight-glow"),2e3))})},[P]),w.useEffect(()=>{M(async()=>(await Y(),null))},[M,Y]),w.useEffect(()=>{if(k.startDate&&k.endDate){const ne=k.startDate.toISOString().split("T")[0],le=k.endDate.toISOString().split("T")[0];(ne!==l||le!==f)&&(d(ne),u(le))}},[k]),w.useEffect(()=>{const ne=new URLSearchParams(n.search),le=ne.get("section"),oe=ne.get("startDate"),E=ne.get("endDate");if(oe&&E){d(oe),u(E);const de=k.startDate?k.startDate.toISOString().split("T")[0]:null,he=k.endDate?k.endDate.toISOString().split("T")[0]:null;(de!==oe||he!==E)&&S({startDate:new Date(oe),endDate:new Date(E)})}if(le){const de=`analysis-${le}`;setTimeout(()=>{const he=document.getElementById(de);he&&(he.scrollIntoView({behavior:"smooth",block:"center"}),he.classList.add("ai-highlight-glow"),setTimeout(()=>he.classList.remove("ai-highlight-glow"),2e3))},500)}},[n.search]),w.useEffect(()=>{Y()},[l,f,Y]),w.useEffect(()=>{!h&&(R>0||ee)&&T({totalRevenue:R,inventoryValue:0,pharmacyRevenue:(W==null?void 0:W.pharmacy)||0,labRevenue:(W==null?void 0:W.lab)||0,receptionRevenue:((W==null?void 0:W.consultation)||0)+((W==null?void 0:W.other)||0),inventorySummary:ee?{totalItemsAnalyzed:ee.pharmacyAnalysis.length,netPositiveItems:ee.pharmacyAnalysis.filter(ne=>ne.net_change>0).length}:null})},[R,ee,W,h,T]);const Q=ne=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(ne);return i.jsxs("div",{className:en.container,children:[i.jsxs("div",{className:en.header,children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-gray-100 rounded-full",children:i.jsx(sn,{size:20,className:"text-gray-600"})}),i.jsx("h1",{className:en.title,children:"Analysis Dashboard"})]}),i.jsxs("div",{className:en.controls,children:[i.jsxs("div",{className:en.dateInputGroup,children:[i.jsx("label",{className:en.dateInputLabel,children:"From:"}),i.jsx("input",{type:"date",className:en.dateInput,value:l,onChange:ne=>{d(ne.target.value),f&&S({startDate:new Date(ne.target.value),endDate:new Date(f)})}})]}),i.jsxs("div",{className:en.dateInputGroup,children:[i.jsx("label",{className:en.dateInputLabel,children:"To:"}),i.jsx("input",{type:"date",className:en.dateInput,value:f,onChange:ne=>{u(ne.target.value),l&&S({startDate:new Date(l),endDate:new Date(ne.target.value)})}})]})]})]}),b&&i.jsxs("div",{className:en.errorAlert,children:[i.jsx(jr,{size:20}),i.jsx("span",{children:b})]}),!h&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{className:en.section,id:"analysis-financial",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Bh,{className:"text-blue-600"}),i.jsx("h2",{className:en.sectionTitle,children:"Financial Performance"})]}),i.jsxs("div",{className:en.statsGrid,children:[i.jsxs("div",{className:en.statCard,children:[i.jsx("div",{className:en.statTitle,children:"Total Revenue Collected"}),i.jsx("div",{className:`${en.statValue} text-blue-600`,children:Q(R)}),i.jsx("div",{className:en.statSubtitle,children:"All payment modes"})]}),B&&Object.entries(B).map(([ne,le])=>i.jsxs("div",{className:en.statCard,children:[i.jsxs("div",{className:en.statTitle,children:[ne," Collections"]}),i.jsx("div",{className:en.statValue,children:Q(le)})]},ne))]}),F&&i.jsxs("div",{className:en.revenueGrid,children:[i.jsxs("div",{className:en.revenueCard,children:[i.jsx("h3",{className:en.revenueCardTitle,children:"Reception / Clinic"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:Q(((W==null?void 0:W.consultation)||0)+((W==null?void 0:W.other)||0))}),i.jsx("ul",{className:en.revenueCardList,children:Object.entries(F.reception).map(([ne,le])=>i.jsxs("li",{className:en.revenueCardListItem,children:[i.jsx("span",{children:ne}),i.jsx("span",{className:"font-medium text-gray-900",children:Q(le)})]},ne))})]}),i.jsxs("div",{className:en.revenueCard,children:[i.jsx("h3",{className:en.revenueCardTitle,children:"Pharmacy"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:Q((W==null?void 0:W.pharmacy)||0)}),$<0&&i.jsxs("div",{className:"text-sm text-red-500 mb-2",children:["Returns: ",Q($)]}),i.jsx("ul",{className:en.revenueCardList,children:Object.entries(F.pharmacy).map(([ne,le])=>i.jsxs("li",{className:en.revenueCardListItem,children:[i.jsx("span",{children:ne}),i.jsx("span",{className:"font-medium text-gray-900",children:Q(le)})]},ne))})]}),i.jsxs("div",{className:en.revenueCard,children:[i.jsx("h3",{className:en.revenueCardTitle,children:"Laboratory"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:Q((W==null?void 0:W.lab)||0)}),i.jsx("ul",{className:en.revenueCardList,children:Object.entries(F.lab).map(([ne,le])=>i.jsxs("li",{className:en.revenueCardListItem,children:[i.jsx("span",{children:ne}),i.jsx("span",{className:"font-medium text-gray-900",children:Q(le)})]},ne))})]})]})]}),i.jsxs("section",{className:en.section,id:"analysis-inventory",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Bd,{className:"text-emerald-600"}),i.jsx("h2",{className:en.sectionTitle,children:"Inventory Movement"})]}),ee&&ee.pharmacyAnalysis.length>0?i.jsx("div",{className:en.tableContainer,children:i.jsxs("table",{className:en.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Item Name"}),i.jsx("th",{children:"Stock In"}),i.jsx("th",{children:"Stock Out"}),i.jsx("th",{children:"Net Change"}),i.jsx("th",{className:"text-right",children:"Est. Revenue"}),i.jsx("th",{className:"text-right",children:"Est. Profit"})]})}),i.jsx("tbody",{children:ee.pharmacyAnalysis.map(ne=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:ne.name}),i.jsx("div",{className:"text-xs text-gray-500",children:ne.supplier})]}),i.jsxs("td",{className:en.textGreen,children:["+",ne.quantity_in,Object.entries(ne.quantity_in_by_reason).map(([le,oe])=>i.jsxs("div",{className:"text-xs opacity-75",children:[le,": ",oe]},le))]}),i.jsxs("td",{className:en.textRed,children:["-",ne.quantity_out,Object.entries(ne.quantity_out_by_reason).map(([le,oe])=>i.jsxs("div",{className:"text-xs opacity-75",children:[le,": ",oe]},le))]}),i.jsx("td",{children:i.jsxs("span",{className:`font-semibold ${ne.net_change>=0?"text-green-600":"text-red-600"}`,children:[ne.net_change>0?"+":"",ne.net_change]})}),i.jsx("td",{className:"text-right font-medium",children:Q(ne.revenue)}),i.jsx("td",{className:`text-right font-medium ${ne.profit>=0?"text-green-600":"text-red-600"}`,children:Q(ne.profit)})]},ne.drug_id))})]})}):i.jsx("div",{className:"text-center py-8 text-gray-500 mb-4 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No inventory movement recorded for this period."})]})]}),h&&i.jsxs("div",{className:en.loadingContainer,children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),i.jsx("div",{children:"Analyzing Financial & Inventory Data..."})]})]})};function Oae(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),h=R=>{r(R),n(!0),R.role==="admin"&&!R.has_seen_tutorial&&u(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const R=localStorage.getItem("authToken"),z=localStorage.getItem("currentUser");if(R&&z)try{const $=JSON.parse(z);r($),n(!0),$.role==="admin"&&!$.has_seen_tutorial&&u(!0)}catch($){console.error("Error parsing stored user data:",$),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}o(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const z=await Xre();d(z)}catch(z){console.error("Error fetching clinic pro plan status:",z),d({hasProPlan:!1})}else d(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const R=z=>{z.preventDefault(),v(z),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",R),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",R)}},[]),w.useEffect(()=>{const R=window.matchMedia("(prefers-color-scheme: dark)"),z=()=>{R.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return z(),R.addEventListener("change",z),()=>{R.removeEventListener("change",z),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const R=b;R.prompt();const{outcome:z}=await R.userChoice;console.log(`User response to the install prompt: ${z}`),v(null),k(!1)},[b]),P=async()=>{if(t)try{(await ge(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(z=>z?{...z,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),u(!1)):console.error("Failed to update tutorial status on backend.")}catch(R){console.error("Error marking tutorial as seen:",R)}};return a?i.jsx(AP,{}):i.jsx(DP,{clientId:"277898779560-33obduhn8r758rini4qagetdrupvisri.apps.googleusercontent.com",children:i.jsx(hI,{children:i.jsx(dI,{children:i.jsx(fI,{children:i.jsxs(ZD,{children:[i.jsx(uI,{children:i.jsxs(kh,{children:[i.jsx(pt,{path:"/login",element:e?i.jsx(vn,{to:"/dashboard"}):i.jsx(vW,{onLoginSuccess:h})}),i.jsx(pt,{path:"/register",element:e?i.jsx(vn,{to:"/dashboard"}):i.jsx(wW,{})}),i.jsx(pt,{path:"/handle-complaint-url",element:e?i.jsx(_ie,{}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/live-api",element:e?i.jsx(bY,{}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/create-lab-order",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(_E,{currentUser:t})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/manage-admission",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(NE,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/lab/report/:orderId",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Wj,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Wj,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/add-patient",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(X1,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/billing",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(are,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(Hj,{}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/edit-complaint/patient/:patientId",element:e&&t?i.jsx(Hj,{}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(LA,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/*",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:Lae(t.role,t,ge)}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(gre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/lab/search-report",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(yre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(xre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(sre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/inventory",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(FA,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/inventory/add",element:e&&t?i.jsx(vn,{to:"/dashboard/purchase",replace:!0}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/inventory/edit/:id",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(RE,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/lab-inventory",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(oS,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(rre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Sre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(qre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/start-clinic-subscription",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(nie,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/refill-reminders",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Cie,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/create-custom-bill",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(CE,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(oae,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/lab-billing/:orderId",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(lae,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/analysis",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Mae,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"/dashboard/clinic-hub",element:e&&t?i.jsx(fr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(cae,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(pt,{path:"*",element:i.jsx(vn,{to:e?"/dashboard":"/login"})})]})}),f&&(t==null?void 0:t.role)==="admin"&&i.jsx(Nie,{onClose:()=>u(!1),onMarkAsSeen:P}),e&&t&&i.jsx(Fae,{user:t}),e&&t&&i.jsx(bW,{})]})})})})})}const Lae=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(kh,{children:[i.jsx(pt,{index:!0,element:i.jsx(bie,{})}),i.jsx(pt,{path:"clinic-subscriptions",element:i.jsx(Zre,{})}),i.jsx(pt,{path:"clinic-subscriptions/add",element:i.jsx(eie,{})}),i.jsx(pt,{path:"clinic-subscriptions/edit/:id",element:i.jsx(tie,{})}),i.jsx(pt,{path:"users",element:i.jsx(rie,{})})," ",i.jsx(pt,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(kh,{children:[i.jsxs(pt,{path:"/",element:i.jsx(DW,{fetchWithAuth:t}),children:[i.jsx(pt,{index:!0,element:i.jsx(GW,{})}),i.jsx(pt,{path:"search-patient",element:i.jsx(Hm,{})}),i.jsx(pt,{path:"patients",element:i.jsx(J1,{})})]}),i.jsx(pt,{path:"staff",element:i.jsx(wre,{fetchWithAuth:t})}),i.jsx(pt,{path:"staff/add",element:i.jsx(CJ,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(pt,{path:"staff/edit/:id",element:i.jsx(_J,{})}),i.jsx(pt,{path:"patients/add",element:i.jsx(X1,{})}),i.jsx(pt,{path:"inventory",element:i.jsx(IE,{})}),i.jsx(pt,{path:"inventory/edit/:id",element:i.jsx(RE,{})}),i.jsx(pt,{path:"distributors",element:i.jsx(Jj,{})}),i.jsx(pt,{path:"purchase",element:i.jsx(Kj,{})})," ",i.jsx(pt,{path:"queue",element:i.jsx(z0,{})}),i.jsx(pt,{path:"subscriptions",element:i.jsx(zre,{})}),i.jsx(pt,{path:"subscriptions/add",element:i.jsx(Bre,{})}),i.jsx(pt,{path:"subscriptions/edit/:id",element:i.jsx(Ure,{})}),i.jsx(pt,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(kh,{children:[i.jsx(pt,{index:!0,element:i.jsx(vn,{to:"search-patient",replace:!0})}),i.jsx(pt,{path:"search-patient",element:i.jsx(Hm,{})}),i.jsx(pt,{path:"queue",element:i.jsx(z0,{})}),i.jsx(pt,{path:":patientId",element:i.jsx(z0,{})}),i.jsx(pt,{path:"add-patient",element:i.jsx(X1,{})}),i.jsx(pt,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(kh,{children:[i.jsx(pt,{index:!0,element:i.jsx(JW,{currentUser:n})}),i.jsx(pt,{path:"all-patients",element:i.jsx(J1,{})}),i.jsx(pt,{path:"search-patient",element:i.jsx(Hm,{})}),i.jsx(pt,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(vJ,{});case"pharmacy":return i.jsxs(kh,{children:[i.jsx(pt,{index:!0,element:i.jsx(wJ,{})}),i.jsx(pt,{path:"inventory",element:i.jsx(FA,{})}),i.jsx(pt,{path:"settings",element:i.jsx(NJ,{})}),i.jsx(pt,{path:"add-order",element:i.jsx(ore,{})}),i.jsx(pt,{path:"edit-pharmacy-order/:orderId",element:i.jsx(LA,{})}),i.jsx(pt,{path:"orders/:orderId",element:i.jsx(Ire,{})}),i.jsx(pt,{path:"search-patient-records",element:i.jsx(Hm,{})}),i.jsx(pt,{path:"distributors",element:i.jsx(Jj,{})}),i.jsx(pt,{path:"purchase",element:i.jsx(Kj,{})})," ",i.jsx(pt,{path:"*",element:i.jsx(vn,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},fr=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:o})=>{const l=Rt(),[d,f]=w.useState(!1),[u,h]=w.useState(window.innerWidth<=768),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>v1.subscribe(P=>{S(P)}),[]),w.useEffect(()=>{const P=()=>{h(window.innerWidth<=768)};return window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[]),w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const M=await ge("/api/clinics/settings");if(M.ok){const R=await M.json();b(R.logoUrl)}else console.error("Failed to fetch clinic details for display:",M.statusText),b(null)}catch(M){console.error("Error fetching clinic details for display:",M),b(null)}else b(null)})()},[e==null?void 0:e.clinic_id]);const k=()=>{f(!d)},{toggleCommandBar:T}=Lh();return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("a",{href:"#",onClick:P=>{P.preventDefault(),l("/dashboard")},className:"logo-container",children:i.jsx("img",{src:g||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:"Newtons Ai"}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),o&&(o.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),i.jsx("button",{onClick:T,className:"p-2 mr-2 text-slate-500 rounded-full hover:bg-slate-100 hover:text-slate-900 transition-colors",title:"Search & Commands (Ctrl+K)",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"11",cy:"11",r:"8"}),i.jsx("path",{d:"m21 21-4.3-4.3"})]})}),i.jsx("button",{className:"hamburger-icon",onClick:k,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]}),v&&i.jsx("div",{className:"global-loading-bar"})]}),i.jsx("main",{className:"main-content",children:t}),u?i.jsx(PW,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k,roleNavigation:wE}):i.jsx(AW,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k}),!u&&d&&i.jsx("div",{className:"side-panel-overlay",onClick:k}),!u&&d&&i.jsx("div",{className:"side-panel-overlay",onClick:k})]})},Fae=({user:e})=>{const{isOpen:n,closeAssistant:t}=Tb(),r=Rt(),[a,o]=w.useState(null),[l,d]=w.useState([]);return w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const[u,h]=await Promise.all([ge("/api/clinics/settings"),ge("/api/staff")]);u.ok&&o(await u.json()),h.ok&&d(await h.json())}catch(u){console.error("Failed to fetch initial AI context",u)}})()},[e.clinic_id]),n?i.jsx("div",{className:"ai-assistant-wrapper",children:i.jsx(K2,{onClose:t,settings:a,staffList:l,onSettingsUpdate:()=>{},onStaffUpdate:()=>{},onHighlight:f=>{f.forEach(u=>{if(u.startsWith("navigate_")){const h=u.replace("navigate_","");r(`/dashboard/analysis?section=${h}`)}else{const h=document.getElementById(u);h&&(h.scrollIntoView({behavior:"smooth",block:"center"}),h.classList.add("ai-highlight-glow"),setTimeout(()=>h.classList.remove("ai-highlight-glow"),2e3))}})}})}):null};EP.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(Oae,{})}));
