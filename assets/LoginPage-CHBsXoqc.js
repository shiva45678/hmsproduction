import{j as e,G as y,f as p}from"./index-B0SGsixC.js";import{r as l,u as v,L as b}from"./react-vendor-Cc0P4_ZX.js";/* empty css                 */import{u as I}from"./useAutoFocusSingleInput-6a_v4dYJ.js";import"./utils-vendor-azd6ta8e.js";import"./ai-vendor-CB5T-uN5.js";import"./ui-vendor-CZgqa0n4.js";import"./chart-vendor-BcjzKorn.js";const q=({onLoginSuccess:u})=>{const[d,f]=l.useState(""),[g,x]=l.useState(""),[h,r]=l.useState(null),[m,n]=l.useState(!1),i=v();I();const j=async s=>{s.preventDefault(),n(!0),r(null);try{const t=await p("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,password:g})});if(!t.ok){let o=`Login failed with status: ${t.status}`;try{o=(await t.json()).message||o}catch{try{const c=await t.text();c&&(o=`${o} - ${c}`)}catch{}}throw new Error(o)}const a=await t.json();console.log("Login successful:",a),localStorage.setItem("authToken",a.token),localStorage.setItem("currentUser",JSON.stringify(a.user)),a.user.clinic_id&&localStorage.setItem("currentClinicId",a.user.clinic_id),u(a.user),a.user.role==="doctor"?i("/dashboard/queue"):i("/dashboard")}catch(t){console.error("Login failed:",t),r(t.message||"Login failed. Please check your credentials.")}finally{n(!1)}},S=async s=>{n(!0),r(null);try{const t=await p("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:s.credential})});if(!t.ok)throw new Error("Google Sign-In failed");const a=await t.json();localStorage.setItem("authToken",a.token),localStorage.setItem("currentUser",JSON.stringify(a.user)),a.user.clinic_id&&localStorage.setItem("currentClinicId",a.user.clinic_id),u(a.user),a.user.role==="doctor"?i("/dashboard/queue"):i("/dashboard")}catch(t){console.error("Google Login Error:",t),r("Google Sign-In failed. Please try again.")}finally{n(!1)}},N=()=>{console.error("Google Login Failed"),r("Google Sign-In was unsuccessful. Please try again.")};return e.jsx("div",{className:"auth-page-container",children:e.jsxs("div",{className:"auth-form-card",children:[e.jsx("h2",{className:"auth-title",children:"Newtons AI HMS"}),e.jsx("p",{className:"auth-subtitle",children:"Sign in to continue"}),e.jsxs("form",{onSubmit:j,className:"auth-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:s=>f(s.target.value),className:"auth-text-input",placeholder:" "}),e.jsx("label",{htmlFor:"email",children:"Email address"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:g,onChange:s=>x(s.target.value),className:"auth-text-input",placeholder:" "}),e.jsx("label",{htmlFor:"password",children:"Password"})]}),h&&e.jsx("div",{className:"auth-error-message",children:e.jsx("p",{children:h})}),e.jsx("div",{className:"form-group",children:e.jsx("button",{type:"submit",disabled:m,className:"auth-submit-button",children:m?"Signing in...":"Sign In"})})]}),e.jsx("div",{className:"google-login-container",children:e.jsx(y,{onSuccess:S,onError:N,useOneTap:!0})}),e.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",e.jsx(b,{to:"/register",className:"auth-navigation-link",children:"Create account"})]}),e.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};export{q as default};
