import{f as h,j as e,S as v}from"./index-D_kqlrGT.js";import{r as t,L as x}from"./react-vendor-Cc0P4_ZX.js";import{u as S}from"./useAutoFocusSingleInput-6a_v4dYJ.js";import{aI as _,X as N,ai as z,a4 as A,U as k}from"./ui-vendor-SmiJk_kJ.js";import"./utils-vendor-azd6ta8e.js";import"./ai-vendor-CB5T-uN5.js";import"./chart-vendor-BcjzKorn.js";const C="_modalOverlay_1spz3_3",T="_modalContent_1spz3_29",P="_modalHeader_1spz3_53",K="_modalTitle_1spz3_71",I="_modalCloseButton_1spz3_83",F="_modalBody_1spz3_111",G="_formGroup_1spz3_119",w="_inputField_1spz3_141",B="_errorText_1spz3_175",E="_successText_1spz3_193",M="_modalFooter_1spz3_211",O="_button_1spz3_227",H="_buttonPrimary_1spz3_247",U="_buttonSecondary_1spz3_265",s={modalOverlay:C,modalContent:T,modalHeader:P,modalTitle:K,modalCloseButton:I,modalBody:F,formGroup:G,inputField:w,errorText:B,successText:E,modalFooter:M,button:O,buttonPrimary:H,buttonSecondary:U},$=({isOpen:n,onClose:o})=>{const[c,d]=t.useState(""),[j,m]=t.useState(!1),[i,p]=t.useState(!1),[u,l]=t.useState(null),[y,r]=t.useState(null);S(void 0,n?200:99999),t.useEffect(()=>{n&&f()},[n]);const f=async()=>{m(!0),l(null);try{const a=await h("/api/global-settings/app_gemini_api_key");if(a.ok){const g=await a.json();d(g.value||"")}else a.status}catch(a){console.warn("Could not fetch existing key:",a)}finally{m(!1)}},b=async()=>{p(!0),l(null),r(null);try{if(!(await h("/api/global-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"app_gemini_api_key",value:c})})).ok)throw new Error("Failed to save API Key");r("API Key updated successfully!"),setTimeout(()=>{o(),r(null)},1500)}catch(a){l(a.message||"Error saving key")}finally{p(!1)}};return n?e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.modalContent,children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(_,{size:24}),e.jsx("h3",{className:s.modalTitle,children:"App Gemini API Key"})]}),e.jsx("button",{onClick:o,className:s.modalCloseButton,children:e.jsx(N,{size:20})})]}),e.jsxs("div",{className:s.modalBody,children:[u&&e.jsx("div",{className:s.errorText,children:u}),y&&e.jsx("div",{className:s.successText,children:y}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"gemini-key",children:"Gemini API Key"}),j?e.jsx(v,{width:"100%",height:40,style:{borderRadius:"8px"}}):e.jsx("input",{type:"text",id:"gemini-key",value:c,onChange:a=>d(a.target.value),className:s.inputField,placeholder:"Enter Gemini API Key (AIza...)",disabled:i})]}),e.jsx("p",{style:{fontSize:"0.9em",color:"var(--secondary-text-color, #666)"},children:"This key will be used as a fallback for all clinics if their specific Gemini API key is not configured."})]}),e.jsxs("div",{className:s.modalFooter,children:[e.jsx("button",{onClick:o,className:`${s.button} ${s.buttonSecondary}`,disabled:i,children:"Cancel"}),e.jsx("button",{onClick:b,className:`${s.button} ${s.buttonPrimary}`,disabled:i,children:i?"Saving...":"Save Key"})]})]})}):null},Q=()=>{const[n,o]=t.useState(!1);return e.jsxs("div",{className:"admin-panel-container",children:[e.jsxs("h1",{className:"admin-panel-title",children:[e.jsx(z,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),e.jsxs("div",{className:"admin-panel-grid",children:[e.jsxs(x,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[e.jsx(A,{size:48,className:"card-icon"}),e.jsx("h2",{children:"Manage Clinic Subscription Plans"}),e.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),e.jsxs(x,{to:"/dashboard/users",className:"admin-panel-card",children:[e.jsx(k,{size:48,className:"card-icon"}),e.jsx("h2",{children:"User Management"}),e.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),e.jsxs("div",{className:"admin-panel-card",onClick:()=>o(!0),style:{cursor:"pointer"},children:[e.jsx(_,{size:48,className:"card-icon"}),e.jsx("h2",{children:"Manage App Gemini API Key"}),e.jsx("p",{children:"Update the fallback Gemini API key used by the application."})]})]}),e.jsx($,{isOpen:n,onClose:()=>o(!1)})]})};export{Q as default};
