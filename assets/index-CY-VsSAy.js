var NP=Object.defineProperty;var CP=(e,n,t)=>n in e?NP(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var nr=(e,n,t)=>CP(e,typeof n!="symbol"?n+"":n,t);function _P(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wv={exports:{}},km={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AS;function jP(){if(AS)return km;AS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var d in a)d!=="key"&&(o[d]=a[d])}else o=a;return a=o.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:o}}return km.Fragment=n,km.jsx=t,km.jsxs=t,km}var PS;function kP(){return PS||(PS=1,Wv.exports=jP()),Wv.exports}var i=kP(),Qv={exports:{}},tn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DS;function TP(){if(DS)return tn;DS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function b(E){return E===null||typeof E!="object"?null:(E=g&&E[g]||E["@@iterator"],typeof E=="function"?E:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function T(E,ce,ge){this.props=E,this.context=ce,this.refs=k,this.updater=ge||v}T.prototype.isReactComponent={},T.prototype.setState=function(E,ce){if(typeof E!="object"&&typeof E!="function"&&E!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,E,ce,"setState")},T.prototype.forceUpdate=function(E){this.updater.enqueueForceUpdate(this,E,"forceUpdate")};function P(){}P.prototype=T.prototype;function R(E,ce,ge){this.props=E,this.context=ce,this.refs=k,this.updater=ge||v}var I=R.prototype=new P;I.constructor=R,S(I,T.prototype),I.isPureReactComponent=!0;var B=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},L=Object.prototype.hasOwnProperty;function U(E,ce,ge,D,pe,Ce){return ge=Ce.ref,{$$typeof:e,type:E,key:ce,ref:ge!==void 0?ge:null,props:Ce}}function H(E,ce){return U(E.type,ce,void 0,void 0,void 0,E.props)}function K(E){return typeof E=="object"&&E!==null&&E.$$typeof===e}function M(E){var ce={"=":"=0",":":"=2"};return"$"+E.replace(/[=:]/g,function(ge){return ce[ge]})}var $=/\/+/g;function z(E,ce){return typeof E=="object"&&E!==null&&E.key!=null?M(""+E.key):ce.toString(36)}function W(){}function te(E){switch(E.status){case"fulfilled":return E.value;case"rejected":throw E.reason;default:switch(typeof E.status=="string"?E.then(W,W):(E.status="pending",E.then(function(ce){E.status==="pending"&&(E.status="fulfilled",E.value=ce)},function(ce){E.status==="pending"&&(E.status="rejected",E.reason=ce)})),E.status){case"fulfilled":return E.value;case"rejected":throw E.reason}}throw E}function V(E,ce,ge,D,pe){var Ce=typeof E;(Ce==="undefined"||Ce==="boolean")&&(E=null);var Z=!1;if(E===null)Z=!0;else switch(Ce){case"bigint":case"string":case"number":Z=!0;break;case"object":switch(E.$$typeof){case e:case n:Z=!0;break;case h:return Z=E._init,V(Z(E._payload),ce,ge,D,pe)}}if(Z)return pe=pe(E),Z=D===""?"."+z(E,0):D,B(pe)?(ge="",Z!=null&&(ge=Z.replace($,"$&/")+"/"),V(pe,ce,ge,"",function(ye){return ye})):pe!=null&&(K(pe)&&(pe=H(pe,ge+(pe.key==null||E&&E.key===pe.key?"":(""+pe.key).replace($,"$&/")+"/")+Z)),ce.push(pe)),1;Z=0;var ee=D===""?".":D+":";if(B(E))for(var X=0;X<E.length;X++)D=E[X],Ce=ee+z(D,X),Z+=V(D,ce,ge,Ce,pe);else if(X=b(E),typeof X=="function")for(E=X.call(E),X=0;!(D=E.next()).done;)D=D.value,Ce=ee+z(D,X++),Z+=V(D,ce,ge,Ce,pe);else if(Ce==="object"){if(typeof E.then=="function")return V(te(E),ce,ge,D,pe);throw ce=String(E),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return Z}function G(E,ce,ge){if(E==null)return E;var D=[],pe=0;return V(E,D,"","",function(Ce){return ce.call(ge,Ce,pe++)}),D}function J(E){if(E._status===-1){var ce=E._result;ce=ce(),ce.then(function(ge){(E._status===0||E._status===-1)&&(E._status=1,E._result=ge)},function(ge){(E._status===0||E._status===-1)&&(E._status=2,E._result=ge)}),E._status===-1&&(E._status=0,E._result=ce)}if(E._status===1)return E._result.default;throw E._result}var oe=typeof reportError=="function"?reportError:function(E){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof E=="object"&&E!==null&&typeof E.message=="string"?String(E.message):String(E),error:E});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",E);return}console.error(E)};function ie(){}return tn.Children={map:G,forEach:function(E,ce,ge){G(E,function(){ce.apply(this,arguments)},ge)},count:function(E){var ce=0;return G(E,function(){ce++}),ce},toArray:function(E){return G(E,function(ce){return ce})||[]},only:function(E){if(!K(E))throw Error("React.Children.only expected to receive a single React element child.");return E}},tn.Component=T,tn.Fragment=t,tn.Profiler=a,tn.PureComponent=R,tn.StrictMode=r,tn.Suspense=f,tn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,tn.__COMPILER_RUNTIME={__proto__:null,c:function(E){return F.H.useMemoCache(E)}},tn.cache=function(E){return function(){return E.apply(null,arguments)}},tn.cloneElement=function(E,ce,ge){if(E==null)throw Error("The argument must be a React element, but you passed "+E+".");var D=S({},E.props),pe=E.key,Ce=void 0;if(ce!=null)for(Z in ce.ref!==void 0&&(Ce=void 0),ce.key!==void 0&&(pe=""+ce.key),ce)!L.call(ce,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&ce.ref===void 0||(D[Z]=ce[Z]);var Z=arguments.length-2;if(Z===1)D.children=ge;else if(1<Z){for(var ee=Array(Z),X=0;X<Z;X++)ee[X]=arguments[X+2];D.children=ee}return U(E.type,pe,void 0,void 0,Ce,D)},tn.createContext=function(E){return E={$$typeof:l,_currentValue:E,_currentValue2:E,_threadCount:0,Provider:null,Consumer:null},E.Provider=E,E.Consumer={$$typeof:o,_context:E},E},tn.createElement=function(E,ce,ge){var D,pe={},Ce=null;if(ce!=null)for(D in ce.key!==void 0&&(Ce=""+ce.key),ce)L.call(ce,D)&&D!=="key"&&D!=="__self"&&D!=="__source"&&(pe[D]=ce[D]);var Z=arguments.length-2;if(Z===1)pe.children=ge;else if(1<Z){for(var ee=Array(Z),X=0;X<Z;X++)ee[X]=arguments[X+2];pe.children=ee}if(E&&E.defaultProps)for(D in Z=E.defaultProps,Z)pe[D]===void 0&&(pe[D]=Z[D]);return U(E,Ce,void 0,void 0,null,pe)},tn.createRef=function(){return{current:null}},tn.forwardRef=function(E){return{$$typeof:d,render:E}},tn.isValidElement=K,tn.lazy=function(E){return{$$typeof:h,_payload:{_status:-1,_result:E},_init:J}},tn.memo=function(E,ce){return{$$typeof:u,type:E,compare:ce===void 0?null:ce}},tn.startTransition=function(E){var ce=F.T,ge={};F.T=ge;try{var D=E(),pe=F.S;pe!==null&&pe(ge,D),typeof D=="object"&&D!==null&&typeof D.then=="function"&&D.then(ie,oe)}catch(Ce){oe(Ce)}finally{F.T=ce}},tn.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},tn.use=function(E){return F.H.use(E)},tn.useActionState=function(E,ce,ge){return F.H.useActionState(E,ce,ge)},tn.useCallback=function(E,ce){return F.H.useCallback(E,ce)},tn.useContext=function(E){return F.H.useContext(E)},tn.useDebugValue=function(){},tn.useDeferredValue=function(E,ce){return F.H.useDeferredValue(E,ce)},tn.useEffect=function(E,ce,ge){var D=F.H;if(typeof ge=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return D.useEffect(E,ce)},tn.useId=function(){return F.H.useId()},tn.useImperativeHandle=function(E,ce,ge){return F.H.useImperativeHandle(E,ce,ge)},tn.useInsertionEffect=function(E,ce){return F.H.useInsertionEffect(E,ce)},tn.useLayoutEffect=function(E,ce){return F.H.useLayoutEffect(E,ce)},tn.useMemo=function(E,ce){return F.H.useMemo(E,ce)},tn.useOptimistic=function(E,ce){return F.H.useOptimistic(E,ce)},tn.useReducer=function(E,ce,ge){return F.H.useReducer(E,ce,ge)},tn.useRef=function(E){return F.H.useRef(E)},tn.useState=function(E){return F.H.useState(E)},tn.useSyncExternalStore=function(E,ce,ge){return F.H.useSyncExternalStore(E,ce,ge)},tn.useTransition=function(){return F.H.useTransition()},tn.version="19.1.0",tn}var IS;function yw(){return IS||(IS=1,Qv.exports=TP()),Qv.exports}var w=yw();const Pn=tf(w),RS=_P({__proto__:null,default:Pn},[w]);var Jv={exports:{}},Tm={},Kv={exports:{}},Xv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MS;function EP(){return MS||(MS=1,function(e){function n(G,J){var oe=G.length;G.push(J);e:for(;0<oe;){var ie=oe-1>>>1,E=G[ie];if(0<a(E,J))G[ie]=J,G[oe]=E,oe=ie;else break e}}function t(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var J=G[0],oe=G.pop();if(oe!==J){G[0]=oe;e:for(var ie=0,E=G.length,ce=E>>>1;ie<ce;){var ge=2*(ie+1)-1,D=G[ge],pe=ge+1,Ce=G[pe];if(0>a(D,oe))pe<E&&0>a(Ce,D)?(G[ie]=Ce,G[pe]=oe,ie=pe):(G[ie]=D,G[ge]=oe,ie=ge);else if(pe<E&&0>a(Ce,oe))G[ie]=Ce,G[pe]=oe,ie=pe;else break e}}return J}function a(G,J){var oe=G.sortIndex-J.sortIndex;return oe!==0?oe:G.id-J.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var f=[],u=[],h=1,g=null,b=3,v=!1,S=!1,k=!1,T=!1,P=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function B(G){for(var J=t(u);J!==null;){if(J.callback===null)r(u);else if(J.startTime<=G)r(u),J.sortIndex=J.expirationTime,n(f,J);else break;J=t(u)}}function F(G){if(k=!1,B(G),!S)if(t(f)!==null)S=!0,L||(L=!0,z());else{var J=t(u);J!==null&&V(F,J.startTime-G)}}var L=!1,U=-1,H=5,K=-1;function M(){return T?!0:!(e.unstable_now()-K<H)}function $(){if(T=!1,L){var G=e.unstable_now();K=G;var J=!0;try{e:{S=!1,k&&(k=!1,R(U),U=-1),v=!0;var oe=b;try{t:{for(B(G),g=t(f);g!==null&&!(g.expirationTime>G&&M());){var ie=g.callback;if(typeof ie=="function"){g.callback=null,b=g.priorityLevel;var E=ie(g.expirationTime<=G);if(G=e.unstable_now(),typeof E=="function"){g.callback=E,B(G),J=!0;break t}g===t(f)&&r(f),B(G)}else r(f);g=t(f)}if(g!==null)J=!0;else{var ce=t(u);ce!==null&&V(F,ce.startTime-G),J=!1}}break e}finally{g=null,b=oe,v=!1}J=void 0}}finally{J?z():L=!1}}}var z;if(typeof I=="function")z=function(){I($)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,te=W.port2;W.port1.onmessage=$,z=function(){te.postMessage(null)}}else z=function(){P($,0)};function V(G,J){U=P(function(){G(e.unstable_now())},J)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(G){switch(b){case 1:case 2:case 3:var J=3;break;default:J=b}var oe=b;b=J;try{return G()}finally{b=oe}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(G,J){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var oe=b;b=G;try{return J()}finally{b=oe}},e.unstable_scheduleCallback=function(G,J,oe){var ie=e.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?ie+oe:ie):oe=ie,G){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=oe+E,G={id:h++,callback:J,priorityLevel:G,startTime:oe,expirationTime:E,sortIndex:-1},oe>ie?(G.sortIndex=oe,n(u,G),t(f)===null&&G===t(u)&&(k?(R(U),U=-1):k=!0,V(F,oe-ie))):(G.sortIndex=E,n(f,G),S||v||(S=!0,L||(L=!0,z()))),G},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(G){var J=b;return function(){var oe=b;b=J;try{return G.apply(this,arguments)}finally{b=oe}}}}(Xv)),Xv}var OS;function AP(){return OS||(OS=1,Kv.exports=EP()),Kv.exports}var Zv={exports:{}},Mi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LS;function PP(){if(LS)return Mi;LS=1;var e=yw();function n(f){var u="https://react.dev/errors/"+f;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+f+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,u,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:f,containerInfo:u,implementation:h}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,u){if(f==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Mi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Mi.createPortal=function(f,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(n(299));return o(f,u,null,h)},Mi.flushSync=function(f){var u=l.T,h=r.p;try{if(l.T=null,r.p=2,f)return f()}finally{l.T=u,r.p=h,r.d.f()}},Mi.preconnect=function(f,u){typeof f=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(f,u))},Mi.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Mi.preinit=function(f,u){if(typeof f=="string"&&u&&typeof u.as=="string"){var h=u.as,g=d(h,u.crossOrigin),b=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?r.d.S(f,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):h==="script"&&r.d.X(f,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Mi.preinitModule=function(f,u){if(typeof f=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=d(u.as,u.crossOrigin);r.d.M(f,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(f)},Mi.preload=function(f,u){if(typeof f=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,g=d(h,u.crossOrigin);r.d.L(f,h,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Mi.preloadModule=function(f,u){if(typeof f=="string")if(u){var h=d(u.as,u.crossOrigin);r.d.m(f,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(f)},Mi.requestFormReset=function(f){r.d.r(f)},Mi.unstable_batchedUpdates=function(f,u){return f(u)},Mi.useFormState=function(f,u,h){return l.H.useFormState(f,u,h)},Mi.useFormStatus=function(){return l.H.useHostTransitionStatus()},Mi.version="19.1.0",Mi}var FS;function nk(){if(FS)return Zv.exports;FS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Zv.exports=PP(),Zv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $S;function DP(){if($S)return Tm;$S=1;var e=AP(),n=yw(),t=nk();function r(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var c=s,p=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(p=c.return),s=c.return;while(s)}return c.tag===3?p:null}function l(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function d(s){if(o(s)!==s)throw Error(r(188))}function f(s){var c=s.alternate;if(!c){if(c=o(s),c===null)throw Error(r(188));return c!==s?null:s}for(var p=s,x=c;;){var N=p.return;if(N===null)break;var A=N.alternate;if(A===null){if(x=N.return,x!==null){p=x;continue}break}if(N.child===A.child){for(A=N.child;A;){if(A===p)return d(N),s;if(A===x)return d(N),c;A=A.sibling}throw Error(r(188))}if(p.return!==x.return)p=N,x=A;else{for(var Y=!1,ae=N.child;ae;){if(ae===p){Y=!0,p=N,x=A;break}if(ae===x){Y=!0,x=N,p=A;break}ae=ae.sibling}if(!Y){for(ae=A.child;ae;){if(ae===p){Y=!0,p=A,x=N;break}if(ae===x){Y=!0,x=A,p=N;break}ae=ae.sibling}if(!Y)throw Error(r(189))}}if(p.alternate!==x)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:c}function u(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=u(s),c!==null)return c;s=s.sibling}return null}var h=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),R=Symbol.for("react.consumer"),I=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function z(s){return s===null||typeof s!="object"?null:(s=$&&s[$]||s["@@iterator"],typeof s=="function"?s:null)}var W=Symbol.for("react.client.reference");function te(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===W?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case F:return"Suspense";case L:return"SuspenseList";case K:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case I:return(s.displayName||"Context")+".Provider";case R:return(s._context.displayName||"Context")+".Consumer";case B:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case U:return c=s.displayName||null,c!==null?c:te(s.type)||"Memo";case H:c=s._payload,s=s._init;try{return te(s(c))}catch{}}return null}var V=Array.isArray,G=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},ie=[],E=-1;function ce(s){return{current:s}}function ge(s){0>E||(s.current=ie[E],ie[E]=null,E--)}function D(s,c){E++,ie[E]=s.current,s.current=c}var pe=ce(null),Ce=ce(null),Z=ce(null),ee=ce(null);function X(s,c){switch(D(Z,c),D(Ce,s),D(pe,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?cr(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=cr(c),s=mr(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ge(pe),D(pe,s)}function ye(){ge(pe),ge(Ce),ge(Z)}function He(s){s.memoizedState!==null&&D(ee,s);var c=pe.current,p=mr(c,s.type);c!==p&&(D(Ce,s),D(pe,p))}function he(s){Ce.current===s&&(ge(pe),ge(Ce)),ee.current===s&&(ge(ee),uu._currentValue=oe)}var Le=Object.prototype.hasOwnProperty,ue=e.unstable_scheduleCallback,De=e.unstable_cancelCallback,Ye=e.unstable_shouldYield,et=e.unstable_requestPaint,Ke=e.unstable_now,it=e.unstable_getCurrentPriorityLevel,ot=e.unstable_ImmediatePriority,vt=e.unstable_UserBlockingPriority,Ee=e.unstable_NormalPriority,Je=e.unstable_LowPriority,Ae=e.unstable_IdlePriority,_e=e.log,le=e.unstable_setDisableYieldValue,q=null,de=null;function be(s){if(typeof _e=="function"&&le(s),de&&typeof de.setStrictMode=="function")try{de.setStrictMode(q,s)}catch{}}var $e=Math.clz32?Math.clz32:wt,nt=Math.log,ht=Math.LN2;function wt(s){return s>>>=0,s===0?32:31-(nt(s)/ht|0)|0}var Et=256,ve=4194304;function ke(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ne(s,c,p){var x=s.pendingLanes;if(x===0)return 0;var N=0,A=s.suspendedLanes,Y=s.pingedLanes;s=s.warmLanes;var ae=x&134217727;return ae!==0?(x=ae&~A,x!==0?N=ke(x):(Y&=ae,Y!==0?N=ke(Y):p||(p=ae&~s,p!==0&&(N=ke(p))))):(ae=x&~A,ae!==0?N=ke(ae):Y!==0?N=ke(Y):p||(p=x&~s,p!==0&&(N=ke(p)))),N===0?0:c!==0&&c!==N&&(c&A)===0&&(A=N&-N,p=c&-c,A>=p||A===32&&(p&4194048)!==0)?c:N}function Oe(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function Ve(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ze(){var s=Et;return Et<<=1,(Et&4194048)===0&&(Et=256),s}function jt(){var s=ve;return ve<<=1,(ve&62914560)===0&&(ve=4194304),s}function Nt(s){for(var c=[],p=0;31>p;p++)c.push(s);return c}function mt(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function an(s,c,p,x,N,A){var Y=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var ae=s.entanglements,Se=s.expirationTimes,ze=s.hiddenUpdates;for(p=Y&~p;0<p;){var Xe=31-$e(p),at=1<<Xe;ae[Xe]=0,Se[Xe]=-1;var qe=ze[Xe];if(qe!==null)for(ze[Xe]=null,Xe=0;Xe<qe.length;Xe++){var Be=qe[Xe];Be!==null&&(Be.lane&=-536870913)}p&=~at}x!==0&&Ln(s,x,0),A!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=A&~(Y&~c))}function Ln(s,c,p){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-$e(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|p&4194090}function Vt(s,c){var p=s.entangledLanes|=c;for(s=s.entanglements;p;){var x=31-$e(p),N=1<<x;N&c|s[x]&c&&(s[x]|=c),p&=~N}}function Ct(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function xt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function hn(){var s=J.p;return s!==0?s:(s=window.event,s===void 0?32:ux(s.type))}function Jn(s,c){var p=J.p;try{return J.p=s,c()}finally{J.p=p}}var un=Math.random().toString(36).slice(2),Hn="__reactFiber$"+un,hr="__reactProps$"+un,sr="__reactContainer$"+un,Ea="__reactEvents$"+un,hc="__reactListeners$"+un,af="__reactHandles$"+un,sf="__reactResources$"+un,As="__reactMarker$"+un;function Tu(s){delete s[Hn],delete s[hr],delete s[Ea],delete s[hc],delete s[af]}function Aa(s){var c=s[Hn];if(c)return c;for(var p=s.parentNode;p;){if(c=p[sr]||p[Hn]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(s=Xy(s);s!==null;){if(p=s[Hn])return p;s=Xy(s)}return c}s=p,p=s.parentNode}return null}function Ps(s){if(s=s[Hn]||s[sr]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function Ds(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(r(33))}function Is(s){var c=s[sf];return c||(c=s[sf]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function kr(s){s[As]=!0}var of=new Set,lf={};function Rs(s,c){bo(s,c),bo(s+"Capture",c)}function bo(s,c){for(lf[s]=c,s=0;s<c.length;s++)of.add(c[s])}var pc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),cf={},vl={};function lp(s){return Le.call(vl,s)?!0:Le.call(cf,s)?!1:pc.test(s)?vl[s]=!0:(cf[s]=!0,!1)}function mc(s,c,p){if(lp(c))if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+p)}}function vo(s,c,p){if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+p)}}function Cr(s,c,p,x){if(x===null)s.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(p);return}s.setAttributeNS(c,p,""+x)}}var ts,gc;function Ms(s){if(ts===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);ts=c&&c[1]||"",gc=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ts+s+gc}var yc=!1;function wl(s,c){if(!s||yc)return"";yc=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var at=function(){throw Error()};if(Object.defineProperty(at.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(at,[])}catch(Be){var qe=Be}Reflect.construct(s,[],at)}else{try{at.call()}catch(Be){qe=Be}s.call(at.prototype)}}else{try{throw Error()}catch(Be){qe=Be}(at=s())&&typeof at.catch=="function"&&at.catch(function(){})}}catch(Be){if(Be&&qe&&typeof Be.stack=="string")return[Be.stack,qe.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=x.DetermineComponentFrameRoot(),Y=A[0],ae=A[1];if(Y&&ae){var Se=Y.split(`
`),ze=ae.split(`
`);for(N=x=0;x<Se.length&&!Se[x].includes("DetermineComponentFrameRoot");)x++;for(;N<ze.length&&!ze[N].includes("DetermineComponentFrameRoot");)N++;if(x===Se.length||N===ze.length)for(x=Se.length-1,N=ze.length-1;1<=x&&0<=N&&Se[x]!==ze[N];)N--;for(;1<=x&&0<=N;x--,N--)if(Se[x]!==ze[N]){if(x!==1||N!==1)do if(x--,N--,0>N||Se[x]!==ze[N]){var Xe=`
`+Se[x].replace(" at new "," at ");return s.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",s.displayName)),Xe}while(1<=x&&0<=N);break}}}finally{yc=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?Ms(p):""}function Eu(s){switch(s.tag){case 26:case 27:case 5:return Ms(s.type);case 16:return Ms("Lazy");case 13:return Ms("Suspense");case 19:return Ms("SuspenseList");case 0:case 15:return wl(s.type,!1);case 11:return wl(s.type.render,!1);case 1:return wl(s.type,!0);case 31:return Ms("Activity");default:return""}}function xc(s){try{var c="";do c+=Eu(s),s=s.return;while(s);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function ni(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function wo(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Au(s){var c=wo(s)?"checked":"value",p=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,A=p.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return N.call(this)},set:function(Y){x=""+Y,A.call(this,Y)}}),Object.defineProperty(s,c,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(Y){x=""+Y},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function bc(s){s._valueTracker||(s._valueTracker=Au(s))}function vc(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var p=c.getValue(),x="";return s&&(x=wo(s)?s.checked?"true":"false":s.value),s=x,s!==p?(c.setValue(s),!0):!1}function ns(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Pu=/[\n"\\]/g;function ui(s){return s.replace(Pu,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Sl(s,c,p,x,N,A,Y,ae){s.name="",Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?s.type=Y:s.removeAttribute("type"),c!=null?Y==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+ni(c)):s.value!==""+ni(c)&&(s.value=""+ni(c)):Y!=="submit"&&Y!=="reset"||s.removeAttribute("value"),c!=null?rs(s,Y,ni(c)):p!=null?rs(s,Y,ni(p)):x!=null&&s.removeAttribute("value"),N==null&&A!=null&&(s.defaultChecked=!!A),N!=null&&(s.checked=N&&typeof N!="function"&&typeof N!="symbol"),ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?s.name=""+ni(ae):s.removeAttribute("name")}function wc(s,c,p,x,N,A,Y,ae){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.type=A),c!=null||p!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;p=p!=null?""+ni(p):"",c=c!=null?""+ni(c):p,ae||c===s.value||(s.value=c),s.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=ae?s.checked:!!x,s.defaultChecked=!!x,Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"&&(s.name=Y)}function rs(s,c,p){c==="number"&&ns(s.ownerDocument)===s||s.defaultValue===""+p||(s.defaultValue=""+p)}function Os(s,c,p,x){if(s=s.options,c){c={};for(var N=0;N<p.length;N++)c["$"+p[N]]=!0;for(p=0;p<s.length;p++)N=c.hasOwnProperty("$"+s[p].value),s[p].selected!==N&&(s[p].selected=N),N&&x&&(s[p].defaultSelected=!0)}else{for(p=""+ni(p),c=null,N=0;N<s.length;N++){if(s[N].value===p){s[N].selected=!0,x&&(s[N].defaultSelected=!0);return}c!==null||s[N].disabled||(c=s[N])}c!==null&&(c.selected=!0)}}function Nl(s,c,p){if(c!=null&&(c=""+ni(c),c!==s.value&&(s.value=c),p==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=p!=null?""+ni(p):""}function Cl(s,c,p,x){if(c==null){if(x!=null){if(p!=null)throw Error(r(92));if(V(x)){if(1<x.length)throw Error(r(93));x=x[0]}p=x}p==null&&(p=""),c=p}p=ni(c),s.defaultValue=p,x=s.textContent,x===p&&x!==""&&x!==null&&(s.value=x)}function wi(s,c){if(c){var p=s.firstChild;if(p&&p===s.lastChild&&p.nodeType===3){p.nodeValue=c;return}}s.textContent=c}var is=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function So(s,c,p){var x=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,p):typeof p!="number"||p===0||is.has(c)?c==="float"?s.cssFloat=p:s[c]=(""+p).trim():s[c]=p+"px"}function di(s,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(s=s.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&p[N]!==x&&So(s,N,x)}else for(var A in c)c.hasOwnProperty(A)&&So(s,A,c[A])}function Sc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nc=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Du=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ls(s){return Du.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var _l=null;function jl(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Fs=null,as=null;function Cc(s){var c=Ps(s);if(c&&(s=c.stateNode)){var p=s[hr]||null;e:switch(s=c.stateNode,c.type){case"input":if(Sl(s,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+ui(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var x=p[c];if(x!==s&&x.form===s.form){var N=x[hr]||null;if(!N)throw Error(r(90));Sl(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<p.length;c++)x=p[c],x.form===s.form&&vc(x)}break e;case"textarea":Nl(s,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&Os(s,!!p.multiple,c,!1)}}}var No=!1;function Co(s,c,p){if(No)return s(c,p);No=!0;try{var x=s(c);return x}finally{if(No=!1,(Fs!==null||as!==null)&&(th(),Fs&&(c=Fs,s=as,as=Fs=null,Cc(c),s)))for(c=0;c<s.length;c++)Cc(s[c])}}function ss(s,c){var p=s.stateNode;if(p===null)return null;var x=p[hr]||null;if(x===null)return null;p=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),os=!1;if(ia)try{var kl={};Object.defineProperty(kl,"passive",{get:function(){os=!0}}),window.addEventListener("test",kl,kl),window.removeEventListener("test",kl,kl)}catch{os=!1}var aa=null,Tl=null,_o=null;function _c(){if(_o)return _o;var s,c=Tl,p=c.length,x,N="value"in aa?aa.value:aa.textContent,A=N.length;for(s=0;s<p&&c[s]===N[s];s++);var Y=p-s;for(x=1;x<=Y&&c[p-x]===N[A-x];x++);return _o=N.slice(s,1<x?1-x:void 0)}function An(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function jn(){return!0}function jc(){return!1}function qr(s){function c(p,x,N,A,Y){this._reactName=p,this._targetInst=N,this.type=x,this.nativeEvent=A,this.target=Y,this.currentTarget=null;for(var ae in s)s.hasOwnProperty(ae)&&(p=s[ae],this[ae]=p?p(A):A[ae]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?jn:jc,this.isPropagationStopped=jc,this}return h(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=jn)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=jn)},persist:function(){},isPersistent:jn}),c}var Pa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Si=qr(Pa),$s=h({},Pa,{view:0,detail:0}),uf=qr($s),sa,Iu,rr,jo=h({},$s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ni,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==rr&&(rr&&s.type==="mousemove"?(sa=s.screenX-rr.screenX,Iu=s.screenY-rr.screenY):Iu=sa=0,rr=s),sa)},movementY:function(s){return"movementY"in s?s.movementY:Iu}}),oa=qr(jo),df=h({},jo,{dataTransfer:0}),zs=qr(df),_r=h({},$s,{relatedTarget:0}),Da=qr(_r),El=h({},Pa,{animationName:0,elapsedTime:0,pseudoElement:0}),Al=qr(El),ko=h({},Pa,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ff=qr(ko),Pl=h({},Pa,{data:0}),Xr=qr(Pl),Ru={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mu(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=hf[s])?!!c[s]:!1}function Ni(){return Mu}var Dl=h({},$s,{key:function(s){if(s.key){var c=Ru[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=An(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?fi[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ni,charCode:function(s){return s.type==="keypress"?An(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?An(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),To=qr(Dl),Fn=h({},jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ia=qr(Fn),Il=h({},$s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ni}),Ou=qr(Il),kc=h({},Pa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mn=qr(kc),Lu=h({},jo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Tc=qr(Lu),Ec=h({},Pa,{newState:0,oldState:0}),ls=qr(Ec),la=[9,13,27,32],Fu=ia&&"CompositionEvent"in window,Bs=null;ia&&"documentMode"in document&&(Bs=document.documentMode);var Us=ia&&"TextEvent"in window&&!Bs,Rl=ia&&(!Fu||Bs&&8<Bs&&11>=Bs),Eo=" ",Ao=!1;function qs(s,c){switch(s){case"keyup":return la.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ml(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var cs=!1;function pf(s,c){switch(s){case"compositionend":return Ml(c);case"keypress":return c.which!==32?null:(Ao=!0,Eo);case"textInput":return s=c.data,s===Eo&&Ao?null:s;default:return null}}function Po(s,c){if(cs)return s==="compositionend"||!Fu&&qs(s,c)?(s=_c(),_o=Tl=aa=null,cs=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Rl&&c.locale!=="ko"?null:c.data;default:return null}}var hi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ra(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!hi[s.type]:c==="textarea"}function Do(s,c,p,x){Fs?as?as.push(x):as=[x]:Fs=x,c=lh(c,"onChange"),0<c.length&&(p=new Si("onChange","change",null,p,x),s.push({event:p,listeners:c}))}var Vs=null,qi=null;function Io(s){Vy(s,0)}function us(s){var c=Ds(s);if(vc(c))return s}function Ro(s,c){if(s==="change")return c}var Ac=!1;if(ia){var Pc;if(ia){var Vi="oninput"in document;if(!Vi){var $u=document.createElement("div");$u.setAttribute("oninput","return;"),Vi=typeof $u.oninput=="function"}Pc=Vi}else Pc=!1;Ac=Pc&&(!document.documentMode||9<document.documentMode)}function mf(){Vs&&(Vs.detachEvent("onpropertychange",Dc),qi=Vs=null)}function Dc(s){if(s.propertyName==="value"&&us(qi)){var c=[];Do(c,qi,s,jl(s)),Co(Io,c)}}function gf(s,c,p){s==="focusin"?(mf(),Vs=c,qi=p,Vs.attachEvent("onpropertychange",Dc)):s==="focusout"&&mf()}function Ma(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return us(qi)}function Ic(s,c){if(s==="click")return us(c)}function cp(s,c){if(s==="input"||s==="change")return us(c)}function up(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var pi=typeof Object.is=="function"?Object.is:up;function Ci(s,c){if(pi(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var p=Object.keys(s),x=Object.keys(c);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var N=p[x];if(!Le.call(c,N)||!pi(s[N],c[N]))return!1}return!0}function ri(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function zu(s,c){var p=ri(s);s=0;for(var x;p;){if(p.nodeType===3){if(x=s+p.textContent.length,s<=c&&x>=c)return{node:p,offset:c-s};s=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=ri(p)}}function Mo(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?Mo(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function yf(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=ns(s.document);c instanceof s.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)s=c.contentWindow;else break;c=ns(s.document)}return c}function ca(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var ds=ia&&"documentMode"in document&&11>=document.documentMode,ii=null,Oa=null,Pe=null,Qe=!1;function Ge(s,c,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Qe||ii==null||ii!==ns(x)||(x=ii,"selectionStart"in x&&ca(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Pe&&Ci(Pe,x)||(Pe=x,x=lh(Oa,"onSelect"),0<x.length&&(c=new Si("onSelect","select",null,c,p),s.push({event:c,listeners:x}),c.target=ii)))}function pt(s,c){var p={};return p[s.toLowerCase()]=c.toLowerCase(),p["Webkit"+s]="webkit"+c,p["Moz"+s]="moz"+c,p}var Rt={animationend:pt("Animation","AnimationEnd"),animationiteration:pt("Animation","AnimationIteration"),animationstart:pt("Animation","AnimationStart"),transitionrun:pt("Transition","TransitionRun"),transitionstart:pt("Transition","TransitionStart"),transitioncancel:pt("Transition","TransitionCancel"),transitionend:pt("Transition","TransitionEnd")},pn={},yr={};ia&&(yr=document.createElement("div").style,"AnimationEvent"in window||(delete Rt.animationend.animation,delete Rt.animationiteration.animation,delete Rt.animationstart.animation),"TransitionEvent"in window||delete Rt.transitionend.transition);function mn(s){if(pn[s])return pn[s];if(!Rt[s])return s;var c=Rt[s],p;for(p in c)if(c.hasOwnProperty(p)&&p in yr)return pn[s]=c[p];return s}var Ol=mn("animationend"),xf=mn("animationiteration"),mi=mn("animationstart"),Rc=mn("transitionrun"),bf=mn("transitionstart"),Oo=mn("transitioncancel"),ua=mn("transitionend"),Ll=new Map,xn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xn.push("scrollEnd");function Hi(s,c){Ll.set(s,c),Rs(c,[s])}var Fl=new WeakMap;function Zr(s,c){if(typeof s=="object"&&s!==null){var p=Fl.get(s);return p!==void 0?p:(c={value:s,source:c,stack:xc(c)},Fl.set(s,c),c)}return{value:s,source:c,stack:xc(c)}}var pr=[],Lo=0,Bu=0;function fs(){for(var s=Lo,c=Bu=Lo=0;c<s;){var p=pr[c];pr[c++]=null;var x=pr[c];pr[c++]=null;var N=pr[c];pr[c++]=null;var A=pr[c];if(pr[c++]=null,x!==null&&N!==null){var Y=x.pending;Y===null?N.next=N:(N.next=Y.next,Y.next=N),x.pending=N}A!==0&&$l(p,N,A)}}function Gi(s,c,p,x){pr[Lo++]=s,pr[Lo++]=c,pr[Lo++]=p,pr[Lo++]=x,Bu|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function Fo(s,c,p,x){return Gi(s,c,p,x),zl(s)}function Hs(s,c){return Gi(s,null,null,c),zl(s)}function $l(s,c,p){s.lanes|=p;var x=s.alternate;x!==null&&(x.lanes|=p);for(var N=!1,A=s.return;A!==null;)A.childLanes|=p,x=A.alternate,x!==null&&(x.childLanes|=p),A.tag===22&&(s=A.stateNode,s===null||s._visibility&1||(N=!0)),s=A,A=A.return;return s.tag===3?(A=s.stateNode,N&&c!==null&&(N=31-$e(p),s=A.hiddenUpdates,x=s[N],x===null?s[N]=[c]:x.push(c),c.lane=p|536870912),A):null}function zl(s){if(50<nu)throw nu=0,rm=null,Error(r(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var Gs={};function Mc(s,c,p,x){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ai(s,c,p,x){return new Mc(s,c,p,x)}function Ys(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Vr(s,c){var p=s.alternate;return p===null?(p=ai(s.tag,c,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=c,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,c=s.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function $o(s,c){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,c=p.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function Bl(s,c,p,x,N,A){var Y=0;if(x=s,typeof s=="function")Ys(s)&&(Y=1);else if(typeof s=="string")Y=Rv(s,p,pe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case K:return s=ai(31,p,c,N),s.elementType=K,s.lanes=A,s;case S:return ne(p.children,N,A,c);case k:Y=8,N|=24;break;case T:return s=ai(12,p,c,N|2),s.elementType=T,s.lanes=A,s;case F:return s=ai(13,p,c,N),s.elementType=F,s.lanes=A,s;case L:return s=ai(19,p,c,N),s.elementType=L,s.lanes=A,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case P:case I:Y=10;break e;case R:Y=9;break e;case B:Y=11;break e;case U:Y=14;break e;case H:Y=16,x=null;break e}Y=29,p=Error(r(130,s===null?"null":typeof s,"")),x=null}return c=ai(Y,p,c,N),c.elementType=s,c.type=x,c.lanes=A,c}function ne(s,c,p,x){return s=ai(7,s,x,c),s.lanes=p,s}function xe(s,c,p){return s=ai(6,s,null,c),s.lanes=p,s}function fe(s,c,p){return c=ai(4,s.children!==null?s.children:[],s.key,c),c.lanes=p,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var Ie=[],Ue=0,ct=null,_t=0,Qt=[],Yt=0,In=null,kn=1,Ws="";function Ul(s,c){Ie[Ue++]=_t,Ie[Ue++]=ct,ct=s,_t=c}function dp(s,c,p){Qt[Yt++]=kn,Qt[Yt++]=Ws,Qt[Yt++]=In,In=s;var x=kn;s=Ws;var N=32-$e(x)-1;x&=~(1<<N),p+=1;var A=32-$e(c)+N;if(30<A){var Y=N-N%5;A=(x&(1<<Y)-1).toString(32),x>>=Y,N-=Y,kn=1<<32-$e(c)+N|p<<N|x,Ws=A+s}else kn=1<<A|p<<N|x,Ws=s}function fp(s){s.return!==null&&(Ul(s,1),dp(s,1,0))}function Uu(s){for(;s===ct;)ct=Ie[--Ue],Ie[Ue]=null,_t=Ie[--Ue],Ie[Ue]=null;for(;s===In;)In=Qt[--Yt],Qt[Yt]=null,Ws=Qt[--Yt],Qt[Yt]=null,kn=Qt[--Yt],Qt[Yt]=null}var Ir=null,or=null,gn=!1,La=null,_i=!1,Oc=Error(r(519));function da(s){var c=Error(r(418,""));throw zo(Zr(c,s)),Oc}function Cg(s){var c=s.stateNode,p=s.type,x=s.memoizedProps;switch(c[Hn]=s,c[hr]=x,p){case"dialog":fn("cancel",c),fn("close",c);break;case"iframe":case"object":case"embed":fn("load",c);break;case"video":case"audio":for(p=0;p<Ad.length;p++)fn(Ad[p],c);break;case"source":fn("error",c);break;case"img":case"image":case"link":fn("error",c),fn("load",c);break;case"details":fn("toggle",c);break;case"input":fn("invalid",c),wc(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),bc(c);break;case"select":fn("invalid",c);break;case"textarea":fn("invalid",c),Cl(c,x.value,x.defaultValue,x.children),bc(c)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||x.suppressHydrationWarning===!0||Yy(c.textContent,p)?(x.popover!=null&&(fn("beforetoggle",c),fn("toggle",c)),x.onScroll!=null&&fn("scroll",c),x.onScrollEnd!=null&&fn("scrollend",c),x.onClick!=null&&(c.onclick=ch),c=!0):c=!1,c||da(s)}function _g(s){for(Ir=s.return;Ir;)switch(Ir.tag){case 5:case 13:_i=!1;return;case 27:case 3:_i=!0;return;default:Ir=Ir.return}}function qu(s){if(s!==Ir)return!1;if(!gn)return _g(s),gn=!0,!1;var c=s.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=s.type,p=!(p!=="form"&&p!=="button")||dh(s.type,s.memoizedProps)),p=!p),p&&or&&da(s),_g(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(p=s.data,p==="/$"){if(c===0){or=qa(s.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++;s=s.nextSibling}or=null}}else c===27?(c=or,ya(s.type)?(s=ym,ym=null,or=s):or=c):or=Ir?qa(s.stateNode.nextSibling):null;return!0}function Vu(){or=Ir=null,gn=!1}function jg(){var s=La;return s!==null&&(Ii===null?Ii=s:Ii.push.apply(Ii,s),La=null),s}function zo(s){La===null?La=[s]:La.push(s)}var ql=ce(null),Bo=null,re=null;function Yi(s,c,p){D(ql,c._currentValue),c._currentValue=p}function fa(s){s._currentValue=ql.current,ge(ql)}function ji(s,c,p){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===p)break;s=s.return}}function sn(s,c,p,x){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var A=N.dependencies;if(A!==null){var Y=N.child;A=A.firstContext;e:for(;A!==null;){var ae=A;A=N;for(var Se=0;Se<c.length;Se++)if(ae.context===c[Se]){A.lanes|=p,ae=A.alternate,ae!==null&&(ae.lanes|=p),ji(A.return,p,s),x||(Y=null);break e}A=ae.next}}else if(N.tag===18){if(Y=N.return,Y===null)throw Error(r(341));Y.lanes|=p,A=Y.alternate,A!==null&&(A.lanes|=p),ji(Y,p,s),Y=null}else Y=N.child;if(Y!==null)Y.return=N;else for(Y=N;Y!==null;){if(Y===s){Y=null;break}if(N=Y.sibling,N!==null){N.return=Y.return,Y=N;break}Y=Y.return}N=Y}}function Hu(s,c,p,x){s=null;for(var N=c,A=!1;N!==null;){if(!A){if((N.flags&524288)!==0)A=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var Y=N.alternate;if(Y===null)throw Error(r(387));if(Y=Y.memoizedProps,Y!==null){var ae=N.type;pi(N.pendingProps.value,Y.value)||(s!==null?s.push(ae):s=[ae])}}else if(N===ee.current){if(Y=N.alternate,Y===null)throw Error(r(387));Y.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(uu):s=[uu])}N=N.return}s!==null&&sn(c,s,p,x),c.flags|=262144}function vf(s){for(s=s.firstContext;s!==null;){if(!pi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Vl(s){Bo=s,re=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function xr(s){return kg(Bo,s)}function wf(s,c){return Bo===null&&Vl(s),kg(s,c)}function kg(s,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},re===null){if(s===null)throw Error(r(308));re=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else re=re.next=c;return p}var iv=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(p,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(p){return p()})}},av=e.unstable_scheduleCallback,sv=e.unstable_NormalPriority,Kn={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hp(){return{controller:new iv,data:new Map,refCount:0}}function Gu(s){s.refCount--,s.refCount===0&&av(sv,function(){s.controller.abort()})}var Yu=null,pp=0,Lc=0,ki=null;function ov(s,c){if(Yu===null){var p=Yu=[];pp=0,Lc=oh(),ki={status:"pending",value:void 0,then:function(x){p.push(x)}}}return pp++,c.then(Tg,Tg),c}function Tg(){if(--pp===0&&Yu!==null){ki!==null&&(ki.status="fulfilled");var s=Yu;Yu=null,Lc=0,ki=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function lv(s,c){var p=[],x={status:"pending",value:null,reason:null,then:function(N){p.push(N)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<p.length;N++)(0,p[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<p.length;N++)(0,p[N])(void 0)}),x}var Eg=G.S;G.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&ov(s,c),Eg!==null&&Eg(s,c)};var Hl=ce(null);function Qs(){var s=Hl.current;return s!==null?s:tr.pooledCache}function Sf(s,c){c===null?D(Hl,Hl.current):D(Hl,c.pool)}function Ag(){var s=Qs();return s===null?null:{parent:Kn._currentValue,pool:s}}var gi=Error(r(460)),Pg=Error(r(474)),Nf=Error(r(542)),mp={then:function(){}};function Dg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Cf(){}function gp(s,c,p){switch(p=s[p],p===void 0?s.push(c):p!==c&&(c.then(Cf,Cf),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Rg(s),s;default:if(typeof c.status=="string")c.then(Cf,Cf);else{if(s=tr,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Rg(s),s}throw Fc=c,gi}}var Fc=null;function Ig(){if(Fc===null)throw Error(r(459));var s=Fc;return Fc=null,s}function Rg(s){if(s===gi||s===Nf)throw Error(r(483))}var hs=!1;function Gl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $c(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Uo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Js(s,c,p){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(zn&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=zl(s),$l(s,null,p),c}return Gi(s,x,c,p),zl(s)}function Wu(s,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Vt(s,p)}}function Fa(s,c){var p=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var N=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var Y={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};A===null?N=A=Y:A=A.next=Y,p=p.next}while(p!==null);A===null?N=A=c:A=A.next=c}else N=A=c;p={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:A,shared:x.shared,callbacks:x.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=c:s.next=c,p.lastBaseUpdate=c}var Qu=!1;function $a(){if(Qu){var s=ki;if(s!==null)throw s}}function si(s,c,p,x){Qu=!1;var N=s.updateQueue;hs=!1;var A=N.firstBaseUpdate,Y=N.lastBaseUpdate,ae=N.shared.pending;if(ae!==null){N.shared.pending=null;var Se=ae,ze=Se.next;Se.next=null,Y===null?A=ze:Y.next=ze,Y=Se;var Xe=s.alternate;Xe!==null&&(Xe=Xe.updateQueue,ae=Xe.lastBaseUpdate,ae!==Y&&(ae===null?Xe.firstBaseUpdate=ze:ae.next=ze,Xe.lastBaseUpdate=Se))}if(A!==null){var at=N.baseState;Y=0,Xe=ze=Se=null,ae=A;do{var qe=ae.lane&-536870913,Be=qe!==ae.lane;if(Be?(Cn&qe)===qe:(x&qe)===qe){qe!==0&&qe===Lc&&(Qu=!0),Xe!==null&&(Xe=Xe.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var Ot=s,Mt=ae;qe=c;var Yn=p;switch(Mt.tag){case 1:if(Ot=Mt.payload,typeof Ot=="function"){at=Ot.call(Yn,at,qe);break e}at=Ot;break e;case 3:Ot.flags=Ot.flags&-65537|128;case 0:if(Ot=Mt.payload,qe=typeof Ot=="function"?Ot.call(Yn,at,qe):Ot,qe==null)break e;at=h({},at,qe);break e;case 2:hs=!0}}qe=ae.callback,qe!==null&&(s.flags|=64,Be&&(s.flags|=8192),Be=N.callbacks,Be===null?N.callbacks=[qe]:Be.push(qe))}else Be={lane:qe,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},Xe===null?(ze=Xe=Be,Se=at):Xe=Xe.next=Be,Y|=qe;if(ae=ae.next,ae===null){if(ae=N.shared.pending,ae===null)break;Be=ae,ae=Be.next,Be.next=null,N.lastBaseUpdate=Be,N.shared.pending=null}}while(!0);Xe===null&&(Se=at),N.baseState=Se,N.firstBaseUpdate=ze,N.lastBaseUpdate=Xe,A===null&&(N.shared.lanes=0),Ko|=Y,s.lanes=Y,s.memoizedState=at}}function Mg(s,c){if(typeof s!="function")throw Error(r(191,s));s.call(c)}function yp(s,c){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Mg(p[s],c)}var Yl=ce(null),qo=ce(0);function Ks(s,c){s=so,D(qo,s),D(Yl,c),so=s|c.baseLanes}function _f(){D(qo,so),D(Yl,Yl.current)}function xp(){so=qo.current,ge(Yl),ge(qo)}var za=0,en=null,$n=null,yn=null,zc=!1,Wl=!1,oi=!1,Bc=0,Vo=0,ha=null,Og=0;function bn(){throw Error(r(321))}function Ju(s,c){if(c===null)return!1;for(var p=0;p<c.length&&p<s.length;p++)if(!pi(s[p],c[p]))return!1;return!0}function bp(s,c,p,x,N,A){return za=A,en=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,G.H=s===null||s.memoizedState===null?Qg:Lp,oi=!1,A=p(x,N),oi=!1,Wl&&(A=Fg(c,p,x,N)),Lg(s),A}function Lg(s){G.H=od;var c=$n!==null&&$n.next!==null;if(za=0,yn=$n=en=null,zc=!1,Vo=0,ha=null,c)throw Error(r(300));s===null||Hr||(s=s.dependencies,s!==null&&vf(s)&&(Hr=!0))}function Fg(s,c,p,x){en=s;var N=0;do{if(Wl&&(ha=null),Vo=0,Wl=!1,25<=N)throw Error(r(301));if(N+=1,yn=$n=null,s.updateQueue!=null){var A=s.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}G.H=Jg,A=c(p,x)}while(Wl);return A}function vp(){var s=G.H,c=s.useState()[0];return c=typeof c.then=="function"?Ku(c):c,s=s.useState()[0],($n!==null?$n.memoizedState:null)!==s&&(en.flags|=1024),c}function wp(){var s=Bc!==0;return Bc=0,s}function Ql(s,c,p){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~p}function jf(s){if(zc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}zc=!1}za=0,yn=$n=en=null,Wl=!1,Vo=Bc=0,ha=null}function Ti(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yn===null?en.memoizedState=yn=s:yn=yn.next=s,yn}function Tr(){if($n===null){var s=en.alternate;s=s!==null?s.memoizedState:null}else s=$n.next;var c=yn===null?en.memoizedState:yn.next;if(c!==null)yn=c,$n=s;else{if(s===null)throw en.alternate===null?Error(r(467)):Error(r(310));$n=s,s={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},yn===null?en.memoizedState=yn=s:yn=yn.next=s}return yn}function Jl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ku(s){var c=Vo;return Vo+=1,ha===null&&(ha=[]),s=gp(ha,s,c),c=en,(yn===null?c.memoizedState:yn.next)===null&&(c=c.alternate,G.H=c===null||c.memoizedState===null?Qg:Lp),s}function kf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ku(s);if(s.$$typeof===I)return xr(s)}throw Error(r(438,String(s)))}function Xu(s){var c=null,p=en.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var x=en.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=Jl(),en.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(s),x=0;x<s;x++)p[x]=M;return c.index++,p}function ps(s,c){return typeof c=="function"?c(s):c}function Tf(s){var c=Tr();return Sp(c,$n,s)}function Sp(s,c,p){var x=s.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=p;var N=s.baseQueue,A=x.pending;if(A!==null){if(N!==null){var Y=N.next;N.next=A.next,A.next=Y}c.baseQueue=N=A,x.pending=null}if(A=s.baseState,N===null)s.memoizedState=A;else{c=N.next;var ae=Y=null,Se=null,ze=c,Xe=!1;do{var at=ze.lane&-536870913;if(at!==ze.lane?(Cn&at)===at:(za&at)===at){var qe=ze.revertLane;if(qe===0)Se!==null&&(Se=Se.next={lane:0,revertLane:0,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null}),at===Lc&&(Xe=!0);else if((za&qe)===qe){ze=ze.next,qe===Lc&&(Xe=!0);continue}else at={lane:0,revertLane:ze.revertLane,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},Se===null?(ae=Se=at,Y=A):Se=Se.next=at,en.lanes|=qe,Ko|=qe;at=ze.action,oi&&p(A,at),A=ze.hasEagerState?ze.eagerState:p(A,at)}else qe={lane:at,revertLane:ze.revertLane,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},Se===null?(ae=Se=qe,Y=A):Se=Se.next=qe,en.lanes|=at,Ko|=at;ze=ze.next}while(ze!==null&&ze!==c);if(Se===null?Y=A:Se.next=ae,!pi(A,s.memoizedState)&&(Hr=!0,Xe&&(p=ki,p!==null)))throw p;s.memoizedState=A,s.baseState=Y,s.baseQueue=Se,x.lastRenderedState=A}return N===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function Np(s){var c=Tr(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var x=p.dispatch,N=p.pending,A=c.memoizedState;if(N!==null){p.pending=null;var Y=N=N.next;do A=s(A,Y.action),Y=Y.next;while(Y!==N);pi(A,c.memoizedState)||(Hr=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),p.lastRenderedState=A}return[A,x]}function Cp(s,c,p){var x=en,N=Tr(),A=gn;if(A){if(p===void 0)throw Error(r(407));p=p()}else p=c();var Y=!pi(($n||N).memoizedState,p);Y&&(N.memoizedState=p,Hr=!0),N=N.queue;var ae=Af.bind(null,x,N,s);if(td(2048,8,ae,[s]),N.getSnapshot!==c||Y||yn!==null&&yn.memoizedState.tag&1){if(x.flags|=2048,Uc(9,Mf(),$g.bind(null,x,N,p,c),null),tr===null)throw Error(r(349));A||(za&124)!==0||Ef(x,c,p)}return p}function Ef(s,c,p){s.flags|=16384,s={getSnapshot:c,value:p},c=en.updateQueue,c===null?(c=Jl(),en.updateQueue=c,c.stores=[s]):(p=c.stores,p===null?c.stores=[s]:p.push(s))}function $g(s,c,p,x){c.value=p,c.getSnapshot=x,_p(c)&&jp(s)}function Af(s,c,p){return p(function(){_p(c)&&jp(s)})}function _p(s){var c=s.getSnapshot;s=s.value;try{var p=c();return!pi(s,p)}catch{return!0}}function jp(s){var c=Hs(s,2);c!==null&&Xi(c,s,2)}function Pf(s){var c=Ti();if(typeof s=="function"){var p=s;if(s=p(),oi){be(!0);try{p()}finally{be(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:s},c}function Zu(s,c,p,x){return s.baseState=p,Sp(s,$n,typeof x=="function"?x:ps)}function cv(s,c,p,x,N){if($f(s))throw Error(r(485));if(s=c.action,s!==null){var A={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Y){A.listeners.push(Y)}};G.T!==null?p(!0):A.isTransition=!1,x(A),p=c.pending,p===null?(A.next=c.pending=A,kp(c,A)):(A.next=p.next,c.pending=p.next=A)}}function kp(s,c){var p=c.action,x=c.payload,N=s.state;if(c.isTransition){var A=G.T,Y={};G.T=Y;try{var ae=p(N,x),Se=G.S;Se!==null&&Se(Y,ae),Tp(s,c,ae)}catch(ze){Df(s,c,ze)}finally{G.T=A}}else try{A=p(N,x),Tp(s,c,A)}catch(ze){Df(s,c,ze)}}function Tp(s,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){zg(s,c,x)},function(x){return Df(s,c,x)}):zg(s,c,p)}function zg(s,c,p){c.status="fulfilled",c.value=p,Bg(c),s.state=p,c=s.pending,c!==null&&(p=c.next,p===c?s.pending=null:(p=p.next,c.next=p,kp(s,p)))}function Df(s,c,p){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=p,Bg(c),c=c.next;while(c!==x)}s.action=null}function Bg(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function If(s,c){return c}function Ep(s,c){if(gn){var p=tr.formState;if(p!==null){e:{var x=en;if(gn){if(or){t:{for(var N=or,A=_i;N.nodeType!==8;){if(!A){N=null;break t}if(N=qa(N.nextSibling),N===null){N=null;break t}}A=N.data,N=A==="F!"||A==="F"?N:null}if(N){or=qa(N.nextSibling),x=N.data==="F!";break e}}da(x)}x=!1}x&&(c=p[0])}}return p=Ti(),p.memoizedState=p.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:If,lastRenderedState:c},p.queue=x,p=Rp.bind(null,en,x),x.dispatch=p,x=Pf(!1),A=Mp.bind(null,en,!1,x.queue),x=Ti(),N={state:c,dispatch:null,action:s,pending:null},x.queue=N,p=cv.bind(null,en,N,A,p),N.dispatch=p,x.memoizedState=s,[c,p,!1]}function Rf(s){var c=Tr();return Ug(c,$n,s)}function Ug(s,c,p){if(c=Sp(s,c,If)[0],s=Tf(ps)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Ku(c)}catch(Y){throw Y===gi?Nf:Y}else x=c;c=Tr();var N=c.queue,A=N.dispatch;return p!==c.memoizedState&&(en.flags|=2048,Uc(9,Mf(),Ap.bind(null,N,p),null)),[x,A,s]}function Ap(s,c){s.action=c}function Jt(s){var c=Tr(),p=$n;if(p!==null)return Ug(c,p,s);Tr(),c=c.memoizedState,p=Tr();var x=p.queue.dispatch;return p.memoizedState=s,[c,x,!1]}function Uc(s,c,p,x){return s={tag:s,create:p,deps:x,inst:c,next:null},c=en.updateQueue,c===null&&(c=Jl(),en.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=s.next=s:(x=p.next,p.next=s,s.next=x,c.lastEffect=s),s}function Mf(){return{destroy:void 0,resource:void 0}}function qc(){return Tr().memoizedState}function ed(s,c,p,x){var N=Ti();x=x===void 0?null:x,en.flags|=s,N.memoizedState=Uc(1|c,Mf(),p,x)}function td(s,c,p,x){var N=Tr();x=x===void 0?null:x;var A=N.memoizedState.inst;$n!==null&&x!==null&&Ju(x,$n.memoizedState.deps)?N.memoizedState=Uc(c,A,p,x):(en.flags|=s,N.memoizedState=Uc(1|c,A,p,x))}function qg(s,c){ed(8390656,8,s,c)}function Wi(s,c){td(2048,8,s,c)}function Vg(s,c){return td(4,2,s,c)}function nd(s,c){return td(4,4,s,c)}function Of(s,c){if(typeof c=="function"){s=s();var p=c(s);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Pp(s,c,p){p=p!=null?p.concat([s]):null,td(4,4,Of.bind(null,c,s),p)}function Lf(){}function Ei(s,c){var p=Tr();c=c===void 0?null:c;var x=p.memoizedState;return c!==null&&Ju(c,x[1])?x[0]:(p.memoizedState=[s,c],s)}function Xs(s,c){var p=Tr();c=c===void 0?null:c;var x=p.memoizedState;if(c!==null&&Ju(c,x[1]))return x[0];if(x=s(),oi){be(!0);try{s()}finally{be(!1)}}return p.memoizedState=[x,c],x}function rd(s,c,p){return p===void 0||(za&1073741824)!==0?s.memoizedState=c:(s.memoizedState=p,s=Ny(),en.lanes|=s,Ko|=s,p)}function Dp(s,c,p,x){return pi(p,c)?p:Yl.current!==null?(s=rd(s,p,x),pi(s,c)||(Hr=!0),s):(za&42)===0?(Hr=!0,s.memoizedState=p):(s=Ny(),en.lanes|=s,Ko|=s,c)}function id(s,c,p,x,N){var A=J.p;J.p=A!==0&&8>A?A:8;var Y=G.T,ae={};G.T=ae,Mp(s,!1,c,p);try{var Se=N(),ze=G.S;if(ze!==null&&ze(ae,Se),Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var Xe=lv(Se,x);Kl(s,c,Xe,ci(s))}else Kl(s,c,x,ci(s))}catch(at){Kl(s,c,{then:function(){},status:"rejected",reason:at},ci())}finally{J.p=A,G.T=Y}}function Hg(){}function ad(s,c,p,x){if(s.tag!==5)throw Error(r(476));var N=Ip(s).queue;id(s,N,c,oe,p===null?Hg:function(){return Ff(s),p(x)})}function Ip(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:oe},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:p},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function Ff(s){var c=Ip(s).next.queue;Kl(s,c,{},ci())}function sd(){return xr(uu)}function Zs(){return Tr().memoizedState}function Gg(){return Tr().memoizedState}function Ho(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var p=ci();s=Uo(p);var x=Js(c,s,p);x!==null&&(Xi(x,c,p),Wu(x,c,p)),c={cache:hp()},s.payload=c;return}c=c.return}}function Yg(s,c,p){var x=ci();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},$f(s)?Wg(c,p):(p=Fo(s,c,p,x),p!==null&&(Xi(p,s,x),Op(p,c,x)))}function Rp(s,c,p){var x=ci();Kl(s,c,p,x)}function Kl(s,c,p,x){var N={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if($f(s))Wg(c,N);else{var A=s.alternate;if(s.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var Y=c.lastRenderedState,ae=A(Y,p);if(N.hasEagerState=!0,N.eagerState=ae,pi(ae,Y))return Gi(s,c,N,0),tr===null&&fs(),!1}catch{}finally{}if(p=Fo(s,c,N,x),p!==null)return Xi(p,s,x),Op(p,c,x),!0}return!1}function Mp(s,c,p,x){if(x={lane:2,revertLane:oh(),action:x,hasEagerState:!1,eagerState:null,next:null},$f(s)){if(c)throw Error(r(479))}else c=Fo(s,p,x,2),c!==null&&Xi(c,s,2)}function $f(s){var c=s.alternate;return s===en||c!==null&&c===en}function Wg(s,c){Wl=zc=!0;var p=s.pending;p===null?c.next=c:(c.next=p.next,p.next=c),s.pending=c}function Op(s,c,p){if((p&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Vt(s,p)}}var od={readContext:xr,use:kf,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useLayoutEffect:bn,useInsertionEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useSyncExternalStore:bn,useId:bn,useHostTransitionStatus:bn,useFormState:bn,useActionState:bn,useOptimistic:bn,useMemoCache:bn,useCacheRefresh:bn},Qg={readContext:xr,use:kf,useCallback:function(s,c){return Ti().memoizedState=[s,c===void 0?null:c],s},useContext:xr,useEffect:qg,useImperativeHandle:function(s,c,p){p=p!=null?p.concat([s]):null,ed(4194308,4,Of.bind(null,c,s),p)},useLayoutEffect:function(s,c){return ed(4194308,4,s,c)},useInsertionEffect:function(s,c){ed(4,2,s,c)},useMemo:function(s,c){var p=Ti();c=c===void 0?null:c;var x=s();if(oi){be(!0);try{s()}finally{be(!1)}}return p.memoizedState=[x,c],x},useReducer:function(s,c,p){var x=Ti();if(p!==void 0){var N=p(c);if(oi){be(!0);try{p(c)}finally{be(!1)}}}else N=c;return x.memoizedState=x.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},x.queue=s,s=s.dispatch=Yg.bind(null,en,s),[x.memoizedState,s]},useRef:function(s){var c=Ti();return s={current:s},c.memoizedState=s},useState:function(s){s=Pf(s);var c=s.queue,p=Rp.bind(null,en,c);return c.dispatch=p,[s.memoizedState,p]},useDebugValue:Lf,useDeferredValue:function(s,c){var p=Ti();return rd(p,s,c)},useTransition:function(){var s=Pf(!1);return s=id.bind(null,en,s.queue,!0,!1),Ti().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,p){var x=en,N=Ti();if(gn){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),tr===null)throw Error(r(349));(Cn&124)!==0||Ef(x,c,p)}N.memoizedState=p;var A={value:p,getSnapshot:c};return N.queue=A,qg(Af.bind(null,x,A,s),[s]),x.flags|=2048,Uc(9,Mf(),$g.bind(null,x,A,p,c),null),p},useId:function(){var s=Ti(),c=tr.identifierPrefix;if(gn){var p=Ws,x=kn;p=(x&~(1<<32-$e(x)-1)).toString(32)+p,c=""+c+"R"+p,p=Bc++,0<p&&(c+="H"+p.toString(32)),c+=""}else p=Og++,c=""+c+"r"+p.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:sd,useFormState:Ep,useActionState:Ep,useOptimistic:function(s){var c=Ti();c.memoizedState=c.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=Mp.bind(null,en,!0,p),p.dispatch=c,[s,c]},useMemoCache:Xu,useCacheRefresh:function(){return Ti().memoizedState=Ho.bind(null,en)}},Lp={readContext:xr,use:kf,useCallback:Ei,useContext:xr,useEffect:Wi,useImperativeHandle:Pp,useInsertionEffect:Vg,useLayoutEffect:nd,useMemo:Xs,useReducer:Tf,useRef:qc,useState:function(){return Tf(ps)},useDebugValue:Lf,useDeferredValue:function(s,c){var p=Tr();return Dp(p,$n.memoizedState,s,c)},useTransition:function(){var s=Tf(ps)[0],c=Tr().memoizedState;return[typeof s=="boolean"?s:Ku(s),c]},useSyncExternalStore:Cp,useId:Zs,useHostTransitionStatus:sd,useFormState:Rf,useActionState:Rf,useOptimistic:function(s,c){var p=Tr();return Zu(p,$n,s,c)},useMemoCache:Xu,useCacheRefresh:Gg},Jg={readContext:xr,use:kf,useCallback:Ei,useContext:xr,useEffect:Wi,useImperativeHandle:Pp,useInsertionEffect:Vg,useLayoutEffect:nd,useMemo:Xs,useReducer:Np,useRef:qc,useState:function(){return Np(ps)},useDebugValue:Lf,useDeferredValue:function(s,c){var p=Tr();return $n===null?rd(p,s,c):Dp(p,$n.memoizedState,s,c)},useTransition:function(){var s=Np(ps)[0],c=Tr().memoizedState;return[typeof s=="boolean"?s:Ku(s),c]},useSyncExternalStore:Cp,useId:Zs,useHostTransitionStatus:sd,useFormState:Jt,useActionState:Jt,useOptimistic:function(s,c){var p=Tr();return $n!==null?Zu(p,$n,s,c):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:Xu,useCacheRefresh:Gg},Rr=null,Ai=0;function zf(s){var c=Ai;return Ai+=1,Rr===null&&(Rr=[]),gp(Rr,s,c)}function ld(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function Xl(s,c){throw c.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function Zl(s){var c=s._init;return c(s._payload)}function Fp(s){function c(Re,Te){if(s){var Fe=Re.deletions;Fe===null?(Re.deletions=[Te],Re.flags|=16):Fe.push(Te)}}function p(Re,Te){if(!s)return null;for(;Te!==null;)c(Re,Te),Te=Te.sibling;return null}function x(Re){for(var Te=new Map;Re!==null;)Re.key!==null?Te.set(Re.key,Re):Te.set(Re.index,Re),Re=Re.sibling;return Te}function N(Re,Te){return Re=Vr(Re,Te),Re.index=0,Re.sibling=null,Re}function A(Re,Te,Fe){return Re.index=Fe,s?(Fe=Re.alternate,Fe!==null?(Fe=Fe.index,Fe<Te?(Re.flags|=67108866,Te):Fe):(Re.flags|=67108866,Te)):(Re.flags|=1048576,Te)}function Y(Re){return s&&Re.alternate===null&&(Re.flags|=67108866),Re}function ae(Re,Te,Fe,tt){return Te===null||Te.tag!==6?(Te=xe(Fe,Re.mode,tt),Te.return=Re,Te):(Te=N(Te,Fe),Te.return=Re,Te)}function Se(Re,Te,Fe,tt){var bt=Fe.type;return bt===S?Xe(Re,Te,Fe.props.children,tt,Fe.key):Te!==null&&(Te.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===H&&Zl(bt)===Te.type)?(Te=N(Te,Fe.props),ld(Te,Fe),Te.return=Re,Te):(Te=Bl(Fe.type,Fe.key,Fe.props,null,Re.mode,tt),ld(Te,Fe),Te.return=Re,Te)}function ze(Re,Te,Fe,tt){return Te===null||Te.tag!==4||Te.stateNode.containerInfo!==Fe.containerInfo||Te.stateNode.implementation!==Fe.implementation?(Te=fe(Fe,Re.mode,tt),Te.return=Re,Te):(Te=N(Te,Fe.children||[]),Te.return=Re,Te)}function Xe(Re,Te,Fe,tt,bt){return Te===null||Te.tag!==7?(Te=ne(Fe,Re.mode,tt,bt),Te.return=Re,Te):(Te=N(Te,Fe),Te.return=Re,Te)}function at(Re,Te,Fe){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return Te=xe(""+Te,Re.mode,Fe),Te.return=Re,Te;if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case b:return Fe=Bl(Te.type,Te.key,Te.props,null,Re.mode,Fe),ld(Fe,Te),Fe.return=Re,Fe;case v:return Te=fe(Te,Re.mode,Fe),Te.return=Re,Te;case H:var tt=Te._init;return Te=tt(Te._payload),at(Re,Te,Fe)}if(V(Te)||z(Te))return Te=ne(Te,Re.mode,Fe,null),Te.return=Re,Te;if(typeof Te.then=="function")return at(Re,zf(Te),Fe);if(Te.$$typeof===I)return at(Re,wf(Re,Te),Fe);Xl(Re,Te)}return null}function qe(Re,Te,Fe,tt){var bt=Te!==null?Te.key:null;if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return bt!==null?null:ae(Re,Te,""+Fe,tt);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case b:return Fe.key===bt?Se(Re,Te,Fe,tt):null;case v:return Fe.key===bt?ze(Re,Te,Fe,tt):null;case H:return bt=Fe._init,Fe=bt(Fe._payload),qe(Re,Te,Fe,tt)}if(V(Fe)||z(Fe))return bt!==null?null:Xe(Re,Te,Fe,tt,null);if(typeof Fe.then=="function")return qe(Re,Te,zf(Fe),tt);if(Fe.$$typeof===I)return qe(Re,Te,wf(Re,Fe),tt);Xl(Re,Fe)}return null}function Be(Re,Te,Fe,tt,bt){if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return Re=Re.get(Fe)||null,ae(Te,Re,""+tt,bt);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case b:return Re=Re.get(tt.key===null?Fe:tt.key)||null,Se(Te,Re,tt,bt);case v:return Re=Re.get(tt.key===null?Fe:tt.key)||null,ze(Te,Re,tt,bt);case H:var on=tt._init;return tt=on(tt._payload),Be(Re,Te,Fe,tt,bt)}if(V(tt)||z(tt))return Re=Re.get(Fe)||null,Xe(Te,Re,tt,bt,null);if(typeof tt.then=="function")return Be(Re,Te,Fe,zf(tt),bt);if(tt.$$typeof===I)return Be(Re,Te,Fe,wf(Te,tt),bt);Xl(Te,tt)}return null}function Ot(Re,Te,Fe,tt){for(var bt=null,on=null,Tt=Te,Lt=Te=0,Wr=null;Tt!==null&&Lt<Fe.length;Lt++){Tt.index>Lt?(Wr=Tt,Tt=null):Wr=Tt.sibling;var Tn=qe(Re,Tt,Fe[Lt],tt);if(Tn===null){Tt===null&&(Tt=Wr);break}s&&Tt&&Tn.alternate===null&&c(Re,Tt),Te=A(Tn,Te,Lt),on===null?bt=Tn:on.sibling=Tn,on=Tn,Tt=Wr}if(Lt===Fe.length)return p(Re,Tt),gn&&Ul(Re,Lt),bt;if(Tt===null){for(;Lt<Fe.length;Lt++)Tt=at(Re,Fe[Lt],tt),Tt!==null&&(Te=A(Tt,Te,Lt),on===null?bt=Tt:on.sibling=Tt,on=Tt);return gn&&Ul(Re,Lt),bt}for(Tt=x(Tt);Lt<Fe.length;Lt++)Wr=Be(Tt,Re,Lt,Fe[Lt],tt),Wr!==null&&(s&&Wr.alternate!==null&&Tt.delete(Wr.key===null?Lt:Wr.key),Te=A(Wr,Te,Lt),on===null?bt=Wr:on.sibling=Wr,on=Wr);return s&&Tt.forEach(function(ol){return c(Re,ol)}),gn&&Ul(Re,Lt),bt}function Mt(Re,Te,Fe,tt){if(Fe==null)throw Error(r(151));for(var bt=null,on=null,Tt=Te,Lt=Te=0,Wr=null,Tn=Fe.next();Tt!==null&&!Tn.done;Lt++,Tn=Fe.next()){Tt.index>Lt?(Wr=Tt,Tt=null):Wr=Tt.sibling;var ol=qe(Re,Tt,Tn.value,tt);if(ol===null){Tt===null&&(Tt=Wr);break}s&&Tt&&ol.alternate===null&&c(Re,Tt),Te=A(ol,Te,Lt),on===null?bt=ol:on.sibling=ol,on=ol,Tt=Wr}if(Tn.done)return p(Re,Tt),gn&&Ul(Re,Lt),bt;if(Tt===null){for(;!Tn.done;Lt++,Tn=Fe.next())Tn=at(Re,Tn.value,tt),Tn!==null&&(Te=A(Tn,Te,Lt),on===null?bt=Tn:on.sibling=Tn,on=Tn);return gn&&Ul(Re,Lt),bt}for(Tt=x(Tt);!Tn.done;Lt++,Tn=Fe.next())Tn=Be(Tt,Re,Lt,Tn.value,tt),Tn!==null&&(s&&Tn.alternate!==null&&Tt.delete(Tn.key===null?Lt:Tn.key),Te=A(Tn,Te,Lt),on===null?bt=Tn:on.sibling=Tn,on=Tn);return s&&Tt.forEach(function(Hv){return c(Re,Hv)}),gn&&Ul(Re,Lt),bt}function Yn(Re,Te,Fe,tt){if(typeof Fe=="object"&&Fe!==null&&Fe.type===S&&Fe.key===null&&(Fe=Fe.props.children),typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case b:e:{for(var bt=Fe.key;Te!==null;){if(Te.key===bt){if(bt=Fe.type,bt===S){if(Te.tag===7){p(Re,Te.sibling),tt=N(Te,Fe.props.children),tt.return=Re,Re=tt;break e}}else if(Te.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===H&&Zl(bt)===Te.type){p(Re,Te.sibling),tt=N(Te,Fe.props),ld(tt,Fe),tt.return=Re,Re=tt;break e}p(Re,Te);break}else c(Re,Te);Te=Te.sibling}Fe.type===S?(tt=ne(Fe.props.children,Re.mode,tt,Fe.key),tt.return=Re,Re=tt):(tt=Bl(Fe.type,Fe.key,Fe.props,null,Re.mode,tt),ld(tt,Fe),tt.return=Re,Re=tt)}return Y(Re);case v:e:{for(bt=Fe.key;Te!==null;){if(Te.key===bt)if(Te.tag===4&&Te.stateNode.containerInfo===Fe.containerInfo&&Te.stateNode.implementation===Fe.implementation){p(Re,Te.sibling),tt=N(Te,Fe.children||[]),tt.return=Re,Re=tt;break e}else{p(Re,Te);break}else c(Re,Te);Te=Te.sibling}tt=fe(Fe,Re.mode,tt),tt.return=Re,Re=tt}return Y(Re);case H:return bt=Fe._init,Fe=bt(Fe._payload),Yn(Re,Te,Fe,tt)}if(V(Fe))return Ot(Re,Te,Fe,tt);if(z(Fe)){if(bt=z(Fe),typeof bt!="function")throw Error(r(150));return Fe=bt.call(Fe),Mt(Re,Te,Fe,tt)}if(typeof Fe.then=="function")return Yn(Re,Te,zf(Fe),tt);if(Fe.$$typeof===I)return Yn(Re,Te,wf(Re,Fe),tt);Xl(Re,Fe)}return typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint"?(Fe=""+Fe,Te!==null&&Te.tag===6?(p(Re,Te.sibling),tt=N(Te,Fe),tt.return=Re,Re=tt):(p(Re,Te),tt=xe(Fe,Re.mode,tt),tt.return=Re,Re=tt),Y(Re)):p(Re,Te)}return function(Re,Te,Fe,tt){try{Ai=0;var bt=Yn(Re,Te,Fe,tt);return Rr=null,bt}catch(Tt){if(Tt===gi||Tt===Nf)throw Tt;var on=ai(29,Tt,null,Re.mode);return on.lanes=tt,on.return=Re,on}finally{}}}var ec=Fp(!0),Kg=Fp(!1),Qi=ce(null),yi=null;function pa(s){var c=s.alternate;D(br,br.current&1),D(Qi,s),yi===null&&(c===null||Yl.current!==null||c.memoizedState!==null)&&(yi=s)}function Xg(s){if(s.tag===22){if(D(br,br.current),D(Qi,s),yi===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(yi=s)}}else eo()}function eo(){D(br,br.current),D(Qi,Qi.current)}function ms(s){ge(Qi),yi===s&&(yi=null),ge(br)}var br=ce(0);function cd(s){for(var c=s;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||bi(p)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Vc(s,c,p,x){c=s.memoizedState,p=p(x,c),p=p==null?c:h({},c,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}var ud={enqueueSetState:function(s,c,p){s=s._reactInternals;var x=ci(),N=Uo(x);N.payload=c,p!=null&&(N.callback=p),c=Js(s,N,x),c!==null&&(Xi(c,s,x),Wu(c,s,x))},enqueueReplaceState:function(s,c,p){s=s._reactInternals;var x=ci(),N=Uo(x);N.tag=1,N.payload=c,p!=null&&(N.callback=p),c=Js(s,N,x),c!==null&&(Xi(c,s,x),Wu(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var p=ci(),x=Uo(p);x.tag=2,c!=null&&(x.callback=c),c=Js(s,x,p),c!==null&&(Xi(c,s,p),Wu(c,s,p))}};function dd(s,c,p,x,N,A,Y){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,A,Y):c.prototype&&c.prototype.isPureReactComponent?!Ci(p,x)||!Ci(N,A):!0}function Zg(s,c,p,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,x),c.state!==s&&ud.enqueueReplaceState(c,c.state,null)}function Go(s,c){var p=c;if("ref"in c){p={};for(var x in c)x!=="ref"&&(p[x]=c[x])}if(s=s.defaultProps){p===c&&(p=h({},p));for(var N in s)p[N]===void 0&&(p[N]=s[N])}return p}var tc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function $p(s){tc(s)}function Bf(s){console.error(s)}function ey(s){tc(s)}function fd(s,c){try{var p=s.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function gs(s,c,p){try{var x=s.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Uf(s,c,p){return p=Uo(p),p.tag=3,p.payload={element:null},p.callback=function(){fd(s,c)},p}function zp(s){return s=Uo(s),s.tag=3,s}function ty(s,c,p,x){var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var A=x.value;s.payload=function(){return N(A)},s.callback=function(){gs(c,p,x)}}var Y=p.stateNode;Y!==null&&typeof Y.componentDidCatch=="function"&&(s.callback=function(){gs(c,p,x),typeof N!="function"&&(Xo===null?Xo=new Set([this]):Xo.add(this));var ae=x.stack;this.componentDidCatch(x.value,{componentStack:ae!==null?ae:""})})}function ny(s,c,p,x,N){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=p.alternate,c!==null&&Hu(c,p,N,!0),p=Qi.current,p!==null){switch(p.tag){case 13:return yi===null?am():p.alternate===null&&vr===0&&(vr=3),p.flags&=-257,p.flags|=65536,p.lanes=N,x===mp?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([x]):c.add(x),lm(s,x,N)),!1;case 22:return p.flags|=65536,x===mp?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([x]):p.add(x)),lm(s,x,N)),!1}throw Error(r(435,p.tag))}return lm(s,x,N),am(),!1}if(gn)return c=Qi.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==Oc&&(s=Error(r(422),{cause:x}),zo(Zr(s,p)))):(x!==Oc&&(c=Error(r(423),{cause:x}),zo(Zr(c,p))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,x=Zr(x,p),N=Uf(s.stateNode,x,N),Fa(s,N),vr!==4&&(vr=2)),!1;var A=Error(r(520),{cause:x});if(A=Zr(A,p),Sd===null?Sd=[A]:Sd.push(A),vr!==4&&(vr=2),c===null)return!0;x=Zr(x,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,s=N&-N,p.lanes|=s,s=Uf(p.stateNode,x,s),Fa(p,s),!1;case 1:if(c=p.type,A=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Xo===null||!Xo.has(A))))return p.flags|=65536,N&=-N,p.lanes|=N,N=zp(N),ty(N,s,p,x),Fa(p,N),!1}p=p.return}while(p!==null);return!1}var ry=Error(r(461)),Hr=!1;function ir(s,c,p,x){c.child=s===null?Kg(c,null,p,x):ec(c,s.child,p,x)}function qf(s,c,p,x,N){p=p.render;var A=c.ref;if("ref"in x){var Y={};for(var ae in x)ae!=="ref"&&(Y[ae]=x[ae])}else Y=x;return Vl(c),x=bp(s,c,p,Y,A,N),ae=wp(),s!==null&&!Hr?(Ql(s,c,N),to(s,c,N)):(gn&&ae&&fp(c),c.flags|=1,ir(s,c,x,N),c.child)}function Vf(s,c,p,x,N){if(s===null){var A=p.type;return typeof A=="function"&&!Ys(A)&&A.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=A,Hf(s,c,A,x,N)):(s=Bl(p.type,null,x,c,c.mode,N),s.ref=c.ref,s.return=c,c.child=s)}if(A=s.child,!Ba(s,N)){var Y=A.memoizedProps;if(p=p.compare,p=p!==null?p:Ci,p(Y,x)&&s.ref===c.ref)return to(s,c,N)}return c.flags|=1,s=Vr(A,x),s.ref=c.ref,s.return=c,c.child=s}function Hf(s,c,p,x,N){if(s!==null){var A=s.memoizedProps;if(Ci(A,x)&&s.ref===c.ref)if(Hr=!1,c.pendingProps=x=A,Ba(s,N))(s.flags&131072)!==0&&(Hr=!0);else return c.lanes=s.lanes,to(s,c,N)}return Hc(s,c,p,x,N)}function hd(s,c,p){var x=c.pendingProps,N=x.children,A=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=A!==null?A.baseLanes|p:p,s!==null){for(N=c.child=s.child,A=0;N!==null;)A=A|N.lanes|N.childLanes,N=N.sibling;c.childLanes=A&~x}else c.childLanes=0,c.child=null;return nc(s,c,x,p)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&Sf(c,A!==null?A.cachePool:null),A!==null?Ks(c,A):_f(),Xg(c);else return c.lanes=c.childLanes=536870912,nc(s,c,A!==null?A.baseLanes|p:p,p)}else A!==null?(Sf(c,A.cachePool),Ks(c,A),eo(),c.memoizedState=null):(s!==null&&Sf(c,null),_f(),eo());return ir(s,c,N,p),c.child}function nc(s,c,p,x){var N=Qs();return N=N===null?null:{parent:Kn._currentValue,pool:N},c.memoizedState={baseLanes:p,cachePool:N},s!==null&&Sf(c,null),_f(),Xg(c),s!==null&&Hu(s,c,x,!0),null}function At(s,c){var p=c.ref;if(p===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(c.flags|=4194816)}}function Hc(s,c,p,x,N){return Vl(c),p=bp(s,c,p,x,void 0,N),x=wp(),s!==null&&!Hr?(Ql(s,c,N),to(s,c,N)):(gn&&x&&fp(c),c.flags|=1,ir(s,c,p,N),c.child)}function Gf(s,c,p,x,N,A){return Vl(c),c.updateQueue=null,p=Fg(c,x,p,N),Lg(s),x=wp(),s!==null&&!Hr?(Ql(s,c,A),to(s,c,A)):(gn&&x&&fp(c),c.flags|=1,ir(s,c,p,A),c.child)}function Yo(s,c,p,x,N){if(Vl(c),c.stateNode===null){var A=Gs,Y=p.contextType;typeof Y=="object"&&Y!==null&&(A=xr(Y)),A=new p(x,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=ud,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=x,A.state=c.memoizedState,A.refs={},Gl(c),Y=p.contextType,A.context=typeof Y=="object"&&Y!==null?xr(Y):Gs,A.state=c.memoizedState,Y=p.getDerivedStateFromProps,typeof Y=="function"&&(Vc(c,p,Y,x),A.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(Y=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),Y!==A.state&&ud.enqueueReplaceState(A,A.state,null),si(c,x,A,N),$a(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){A=c.stateNode;var ae=c.memoizedProps,Se=Go(p,ae);A.props=Se;var ze=A.context,Xe=p.contextType;Y=Gs,typeof Xe=="object"&&Xe!==null&&(Y=xr(Xe));var at=p.getDerivedStateFromProps;Xe=typeof at=="function"||typeof A.getSnapshotBeforeUpdate=="function",ae=c.pendingProps!==ae,Xe||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(ae||ze!==Y)&&Zg(c,A,x,Y),hs=!1;var qe=c.memoizedState;A.state=qe,si(c,x,A,N),$a(),ze=c.memoizedState,ae||qe!==ze||hs?(typeof at=="function"&&(Vc(c,p,at,x),ze=c.memoizedState),(Se=hs||dd(c,p,Se,x,qe,ze,Y))?(Xe||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=ze),A.props=x,A.state=ze,A.context=Y,x=Se):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{A=c.stateNode,$c(s,c),Y=c.memoizedProps,Xe=Go(p,Y),A.props=Xe,at=c.pendingProps,qe=A.context,ze=p.contextType,Se=Gs,typeof ze=="object"&&ze!==null&&(Se=xr(ze)),ae=p.getDerivedStateFromProps,(ze=typeof ae=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(Y!==at||qe!==Se)&&Zg(c,A,x,Se),hs=!1,qe=c.memoizedState,A.state=qe,si(c,x,A,N),$a();var Be=c.memoizedState;Y!==at||qe!==Be||hs||s!==null&&s.dependencies!==null&&vf(s.dependencies)?(typeof ae=="function"&&(Vc(c,p,ae,x),Be=c.memoizedState),(Xe=hs||dd(c,p,Xe,x,qe,Be,Se)||s!==null&&s.dependencies!==null&&vf(s.dependencies))?(ze||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(x,Be,Se),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(x,Be,Se)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||Y===s.memoizedProps&&qe===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||Y===s.memoizedProps&&qe===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Be),A.props=x,A.state=Be,A.context=Se,x=Xe):(typeof A.componentDidUpdate!="function"||Y===s.memoizedProps&&qe===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||Y===s.memoizedProps&&qe===s.memoizedState||(c.flags|=1024),x=!1)}return A=x,At(s,c),x=(c.flags&128)!==0,A||x?(A=c.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,s!==null&&x?(c.child=ec(c,s.child,null,N),c.child=ec(c,null,p,N)):ir(s,c,p,N),c.memoizedState=A.state,s=c.child):s=to(s,c,N),s}function iy(s,c,p,x){return Vu(),c.flags|=256,ir(s,c,p,x),c.child}var pd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yf(s){return{baseLanes:s,cachePool:Ag()}}function Gr(s,c,p){return s=s!==null?s.childLanes&~p:0,c&&(s|=ga),s}function ay(s,c,p){var x=c.pendingProps,N=!1,A=(c.flags&128)!==0,Y;if((Y=A)||(Y=s!==null&&s.memoizedState===null?!1:(br.current&2)!==0),Y&&(N=!0,c.flags&=-129),Y=(c.flags&32)!==0,c.flags&=-33,s===null){if(gn){if(N?pa(c):eo(),gn){var ae=or,Se;if(Se=ae){e:{for(Se=ae,ae=_i;Se.nodeType!==8;){if(!ae){ae=null;break e}if(Se=qa(Se.nextSibling),Se===null){ae=null;break e}}ae=Se}ae!==null?(c.memoizedState={dehydrated:ae,treeContext:In!==null?{id:kn,overflow:Ws}:null,retryLane:536870912,hydrationErrors:null},Se=ai(18,null,null,0),Se.stateNode=ae,Se.return=c,c.child=Se,Ir=c,or=null,Se=!0):Se=!1}Se||da(c)}if(ae=c.memoizedState,ae!==null&&(ae=ae.dehydrated,ae!==null))return bi(ae)?c.lanes=32:c.lanes=536870912,null;ms(c)}return ae=x.children,x=x.fallback,N?(eo(),N=c.mode,ae=md({mode:"hidden",children:ae},N),x=ne(x,N,p,null),ae.return=c,x.return=c,ae.sibling=x,c.child=ae,N=c.child,N.memoizedState=Yf(p),N.childLanes=Gr(s,Y,p),c.memoizedState=pd,x):(pa(c),Bp(c,ae))}if(Se=s.memoizedState,Se!==null&&(ae=Se.dehydrated,ae!==null)){if(A)c.flags&256?(pa(c),c.flags&=-257,c=Up(s,c,p)):c.memoizedState!==null?(eo(),c.child=s.child,c.flags|=128,c=null):(eo(),N=x.fallback,ae=c.mode,x=md({mode:"visible",children:x.children},ae),N=ne(N,ae,p,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,ec(c,s.child,null,p),x=c.child,x.memoizedState=Yf(p),x.childLanes=Gr(s,Y,p),c.memoizedState=pd,c=N);else if(pa(c),bi(ae)){if(Y=ae.nextSibling&&ae.nextSibling.dataset,Y)var ze=Y.dgst;Y=ze,x=Error(r(419)),x.stack="",x.digest=Y,zo({value:x,source:null,stack:null}),c=Up(s,c,p)}else if(Hr||Hu(s,c,p,!1),Y=(p&s.childLanes)!==0,Hr||Y){if(Y=tr,Y!==null&&(x=p&-p,x=(x&42)!==0?1:Ct(x),x=(x&(Y.suspendedLanes|p))!==0?0:x,x!==0&&x!==Se.retryLane))throw Se.retryLane=x,Hs(s,x),Xi(Y,s,x),ry;ae.data==="$?"||am(),c=Up(s,c,p)}else ae.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=Se.treeContext,or=qa(ae.nextSibling),Ir=c,gn=!0,La=null,_i=!1,s!==null&&(Qt[Yt++]=kn,Qt[Yt++]=Ws,Qt[Yt++]=In,kn=s.id,Ws=s.overflow,In=c),c=Bp(c,x.children),c.flags|=4096);return c}return N?(eo(),N=x.fallback,ae=c.mode,Se=s.child,ze=Se.sibling,x=Vr(Se,{mode:"hidden",children:x.children}),x.subtreeFlags=Se.subtreeFlags&65011712,ze!==null?N=Vr(ze,N):(N=ne(N,ae,p,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,ae=s.child.memoizedState,ae===null?ae=Yf(p):(Se=ae.cachePool,Se!==null?(ze=Kn._currentValue,Se=Se.parent!==ze?{parent:ze,pool:ze}:Se):Se=Ag(),ae={baseLanes:ae.baseLanes|p,cachePool:Se}),N.memoizedState=ae,N.childLanes=Gr(s,Y,p),c.memoizedState=pd,x):(pa(c),p=s.child,s=p.sibling,p=Vr(p,{mode:"visible",children:x.children}),p.return=c,p.sibling=null,s!==null&&(Y=c.deletions,Y===null?(c.deletions=[s],c.flags|=16):Y.push(s)),c.child=p,c.memoizedState=null,p)}function Bp(s,c){return c=md({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function md(s,c){return s=ai(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Up(s,c,p){return ec(c,s.child,null,p),s=Bp(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function qp(s,c,p){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),ji(s.return,c,p)}function Vp(s,c,p,x,N){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:N}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=x,A.tail=p,A.tailMode=N)}function sy(s,c,p){var x=c.pendingProps,N=x.revealOrder,A=x.tail;if(ir(s,c,x.children,p),x=br.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&qp(s,p,c);else if(s.tag===19)qp(s,p,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(D(br,x),N){case"forwards":for(p=c.child,N=null;p!==null;)s=p.alternate,s!==null&&cd(s)===null&&(N=p),p=p.sibling;p=N,p===null?(N=c.child,c.child=null):(N=p.sibling,p.sibling=null),Vp(c,!1,N,p,A);break;case"backwards":for(p=null,N=c.child,c.child=null;N!==null;){if(s=N.alternate,s!==null&&cd(s)===null){c.child=N;break}s=N.sibling,N.sibling=p,p=N,N=s}Vp(c,!0,p,null,A);break;case"together":Vp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function to(s,c,p){if(s!==null&&(c.dependencies=s.dependencies),Ko|=c.lanes,(p&c.childLanes)===0)if(s!==null){if(Hu(s,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,p=Vr(s,s.pendingProps),c.child=p,p.return=c;s.sibling!==null;)s=s.sibling,p=p.sibling=Vr(s,s.pendingProps),p.return=c;p.sibling=null}return c.child}function Ba(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&vf(s)))}function xi(s,c,p){switch(c.tag){case 3:X(c,c.stateNode.containerInfo),Yi(c,Kn,s.memoizedState.cache),Vu();break;case 27:case 5:He(c);break;case 4:X(c,c.stateNode.containerInfo);break;case 10:Yi(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(pa(c),c.flags|=128,null):(p&c.child.childLanes)!==0?ay(s,c,p):(pa(c),s=to(s,c,p),s!==null?s.sibling:null);pa(c);break;case 19:var N=(s.flags&128)!==0;if(x=(p&c.childLanes)!==0,x||(Hu(s,c,p,!1),x=(p&c.childLanes)!==0),N){if(x)return sy(s,c,p);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),D(br,br.current),x)break;return null;case 22:case 23:return c.lanes=0,hd(s,c,p);case 24:Yi(c,Kn,s.memoizedState.cache)}return to(s,c,p)}function Wf(s,c,p){if(s!==null)if(s.memoizedProps!==c.pendingProps)Hr=!0;else{if(!Ba(s,p)&&(c.flags&128)===0)return Hr=!1,xi(s,c,p);Hr=(s.flags&131072)!==0}else Hr=!1,gn&&(c.flags&1048576)!==0&&dp(c,_t,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")Ys(x)?(s=Go(x,s),c.tag=1,c=Yo(null,c,x,s,p)):(c.tag=0,c=Hc(null,c,x,s,p));else{if(x!=null){if(N=x.$$typeof,N===B){c.tag=11,c=qf(null,c,x,s,p);break e}else if(N===U){c.tag=14,c=Vf(null,c,x,s,p);break e}}throw c=te(x)||x,Error(r(306,c,""))}}return c;case 0:return Hc(s,c,c.type,c.pendingProps,p);case 1:return x=c.type,N=Go(x,c.pendingProps),Yo(s,c,x,N,p);case 3:e:{if(X(c,c.stateNode.containerInfo),s===null)throw Error(r(387));x=c.pendingProps;var A=c.memoizedState;N=A.element,$c(s,c),si(c,x,null,p);var Y=c.memoizedState;if(x=Y.cache,Yi(c,Kn,x),x!==A.cache&&sn(c,[Kn],p,!0),$a(),x=Y.element,A.isDehydrated)if(A={element:x,isDehydrated:!1,cache:Y.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=iy(s,c,x,p);break e}else if(x!==N){N=Zr(Error(r(424)),c),zo(N),c=iy(s,c,x,p);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(or=qa(s.firstChild),Ir=c,gn=!0,La=null,_i=!0,p=Kg(c,null,x,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Vu(),x===N){c=to(s,c,p);break e}ir(s,c,x,p)}c=c.child}return c;case 26:return At(s,c),s===null?(p=nx(c.type,null,c.pendingProps,null))?c.memoizedState=p:gn||(p=c.type,s=c.pendingProps,x=ac(Z.current).createElement(p),x[Hn]=c,x[hr]=s,Lr(x,p,s),kr(x),c.stateNode=x):c.memoizedState=nx(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return He(c),s===null&&gn&&(x=c.stateNode=Zy(c.type,c.pendingProps,Z.current),Ir=c,_i=!0,N=or,ya(c.type)?(ym=N,or=qa(x.firstChild)):or=N),ir(s,c,c.pendingProps.children,p),At(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&gn&&((N=x=or)&&(x=Ky(x,c.type,c.pendingProps,_i),x!==null?(c.stateNode=x,Ir=c,or=qa(x.firstChild),_i=!1,N=!0):N=!1),N||da(c)),He(c),N=c.type,A=c.pendingProps,Y=s!==null?s.memoizedProps:null,x=A.children,dh(N,A)?x=null:Y!==null&&dh(N,Y)&&(c.flags|=32),c.memoizedState!==null&&(N=bp(s,c,vp,null,null,p),uu._currentValue=N),At(s,c),ir(s,c,x,p),c.child;case 6:return s===null&&gn&&((s=p=or)&&(p=hh(p,c.pendingProps,_i),p!==null?(c.stateNode=p,Ir=c,or=null,s=!0):s=!1),s||da(c)),null;case 13:return ay(s,c,p);case 4:return X(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=ec(c,null,x,p):ir(s,c,x,p),c.child;case 11:return qf(s,c,c.type,c.pendingProps,p);case 7:return ir(s,c,c.pendingProps,p),c.child;case 8:return ir(s,c,c.pendingProps.children,p),c.child;case 12:return ir(s,c,c.pendingProps.children,p),c.child;case 10:return x=c.pendingProps,Yi(c,c.type,x.value),ir(s,c,x.children,p),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,Vl(c),N=xr(N),x=x(N),c.flags|=1,ir(s,c,x,p),c.child;case 14:return Vf(s,c,c.type,c.pendingProps,p);case 15:return Hf(s,c,c.type,c.pendingProps,p);case 19:return sy(s,c,p);case 31:return x=c.pendingProps,p=c.mode,x={mode:x.mode,children:x.children},s===null?(p=md(x,p),p.ref=c.ref,c.child=p,p.return=c,c=p):(p=Vr(s.child,x),p.ref=c.ref,c.child=p,p.return=c,c=p),c;case 22:return hd(s,c,p);case 24:return Vl(c),x=xr(Kn),s===null?(N=Qs(),N===null&&(N=tr,A=hp(),N.pooledCache=A,A.refCount++,A!==null&&(N.pooledCacheLanes|=p),N=A),c.memoizedState={parent:x,cache:N},Gl(c),Yi(c,Kn,N)):((s.lanes&p)!==0&&($c(s,c),si(c,null,null,p),$a()),N=s.memoizedState,A=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),Yi(c,Kn,x)):(x=A.cache,Yi(c,Kn,x),x!==N.cache&&sn(c,[Kn],p,!0))),ir(s,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function no(s){s.flags|=4}function Qf(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Fr(c)){if(c=Qi.current,c!==null&&((Cn&4194048)===Cn?yi!==null:(Cn&62914560)!==Cn&&(Cn&536870912)===0||c!==yi))throw Fc=mp,Pg;s.flags|=8192}}function Jf(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?jt():536870912,s.lanes|=c,Xc|=c)}function gd(s,c){if(!gn)switch(s.tailMode){case"hidden":c=s.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Xn(s){var c=s.alternate!==null&&s.alternate.child===s.child,p=0,x=0;if(c)for(var N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=x,s.childLanes=p,c}function oy(s,c,p){var x=c.pendingProps;switch(Uu(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xn(c),null;case 1:return Xn(c),null;case 3:return p=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),fa(Kn),ye(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(qu(c)?no(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,jg())),Xn(c),null;case 26:return p=c.memoizedState,s===null?(no(c),p!==null?(Xn(c),Qf(c,p)):(Xn(c),c.flags&=-16777217)):p?p!==s.memoizedState?(no(c),Xn(c),Qf(c,p)):(Xn(c),c.flags&=-16777217):(s.memoizedProps!==x&&no(c),Xn(c),c.flags&=-16777217),null;case 27:he(c),p=Z.current;var N=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&no(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Xn(c),null}s=pe.current,qu(c)?Cg(c):(s=Zy(N,x,p),c.stateNode=s,no(c))}return Xn(c),null;case 5:if(he(c),p=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&no(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Xn(c),null}if(s=pe.current,qu(c))Cg(c);else{switch(N=ac(Z.current),s){case 1:s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?N.createElement(p,{is:x.is}):N.createElement(p)}}s[Hn]=c,s[hr]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)s.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=s;e:switch(Lr(s,p,x),p){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&no(c)}}return Xn(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&no(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(s=Z.current,qu(c)){if(s=c.stateNode,p=c.memoizedProps,x=null,N=Ir,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}s[Hn]=c,s=!!(s.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||Yy(s.nodeValue,p)),s||da(c)}else s=ac(s).createTextNode(x),s[Hn]=c,c.stateNode=s}return Xn(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=qu(c),x!==null&&x.dehydrated!==null){if(s===null){if(!N)throw Error(r(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[Hn]=c}else Vu(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Xn(c),N=!1}else N=jg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(ms(c),c):(ms(c),null)}if(ms(c),(c.flags&128)!==0)return c.lanes=p,c;if(p=x!==null,s=s!==null&&s.memoizedState!==null,p){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var A=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(A=x.memoizedState.cachePool.pool),A!==N&&(x.flags|=2048)}return p!==s&&p&&(c.child.flags|=8192),Jf(c,c.updateQueue),Xn(c),null;case 4:return ye(),s===null&&hm(c.stateNode.containerInfo),Xn(c),null;case 10:return fa(c.type),Xn(c),null;case 19:if(ge(br),N=c.memoizedState,N===null)return Xn(c),null;if(x=(c.flags&128)!==0,A=N.rendering,A===null)if(x)gd(N,!1);else{if(vr!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(A=cd(s),A!==null){for(c.flags|=128,gd(N,!1),s=A.updateQueue,c.updateQueue=s,Jf(c,s),c.subtreeFlags=0,s=p,p=c.child;p!==null;)$o(p,s),p=p.sibling;return D(br,br.current&1|2),c.child}s=s.sibling}N.tail!==null&&Ke()>Zc&&(c.flags|=128,x=!0,gd(N,!1),c.lanes=4194304)}else{if(!x)if(s=cd(A),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,Jf(c,s),gd(N,!0),N.tail===null&&N.tailMode==="hidden"&&!A.alternate&&!gn)return Xn(c),null}else 2*Ke()-N.renderingStartTime>Zc&&p!==536870912&&(c.flags|=128,x=!0,gd(N,!1),c.lanes=4194304);N.isBackwards?(A.sibling=c.child,c.child=A):(s=N.last,s!==null?s.sibling=A:c.child=A,N.last=A)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=Ke(),c.sibling=null,s=br.current,D(br,x?s&1|2:s&1),c):(Xn(c),null);case 22:case 23:return ms(c),xp(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(p&536870912)!==0&&(c.flags&128)===0&&(Xn(c),c.subtreeFlags&6&&(c.flags|=8192)):Xn(c),p=c.updateQueue,p!==null&&Jf(c,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==p&&(c.flags|=2048),s!==null&&ge(Hl),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),fa(Kn),Xn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function ly(s,c){switch(Uu(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return fa(Kn),ye(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return he(c),null;case 13:if(ms(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Vu()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return ge(br),null;case 4:return ye(),null;case 10:return fa(c.type),null;case 22:case 23:return ms(c),xp(),s!==null&&ge(Hl),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return fa(Kn),null;case 25:return null;default:return null}}function cy(s,c){switch(Uu(c),c.tag){case 3:fa(Kn),ye();break;case 26:case 27:case 5:he(c);break;case 4:ye();break;case 13:ms(c);break;case 19:ge(br);break;case 10:fa(c.type);break;case 22:case 23:ms(c),xp(),s!==null&&ge(Hl);break;case 24:fa(Kn)}}function yd(s,c){try{var p=c.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var N=x.next;p=N;do{if((p.tag&s)===s){x=void 0;var A=p.create,Y=p.inst;x=A(),Y.destroy=x}p=p.next}while(p!==N)}}catch(ae){Zn(c,c.return,ae)}}function Wo(s,c,p){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var A=N.next;x=A;do{if((x.tag&s)===s){var Y=x.inst,ae=Y.destroy;if(ae!==void 0){Y.destroy=void 0,N=c;var Se=p,ze=ae;try{ze()}catch(Xe){Zn(N,Se,Xe)}}}x=x.next}while(x!==A)}}catch(Xe){Zn(c,c.return,Xe)}}function uy(s){var c=s.updateQueue;if(c!==null){var p=s.stateNode;try{yp(c,p)}catch(x){Zn(s,s.return,x)}}}function Hp(s,c,p){p.props=Go(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(x){Zn(s,c,x)}}function Gc(s,c){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof p=="function"?s.refCleanup=p(x):p.current=x}}catch(N){Zn(s,c,N)}}function ys(s,c){var p=s.ref,x=s.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(N){Zn(s,c,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(N){Zn(s,c,N)}else p.current=null}function Kf(s){var c=s.type,p=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(N){Zn(s,s.return,N)}}function Xf(s,c,p){try{var x=s.stateNode;Cv(x,s.type,p,c),x[hr]=c}catch(N){Zn(s,s.return,N)}}function Yc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ya(s.type)||s.tag===4}function xd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Yc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ya(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Zf(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(s,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(s),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=ch));else if(x!==4&&(x===27&&ya(s.type)&&(p=s.stateNode,c=null),s=s.child,s!==null))for(Zf(s,c,p),s=s.sibling;s!==null;)Zf(s,c,p),s=s.sibling}function bd(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?p.insertBefore(s,c):p.appendChild(s);else if(x!==4&&(x===27&&ya(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(bd(s,c,p),s=s.sibling;s!==null;)bd(s,c,p),s=s.sibling}function vd(s){var c=s.stateNode,p=s.memoizedProps;try{for(var x=s.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);Lr(c,x,p),c[Hn]=s,c[hr]=p}catch(A){Zn(s,s.return,A)}}var xs=!1,On=!1,ro=!1,dy=typeof WeakSet=="function"?WeakSet:Set,Mr=null;function uv(s,c){if(s=s.containerInfo,Ua=yh,s=yf(s),ca(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var N=x.anchorOffset,A=x.focusNode;x=x.focusOffset;try{p.nodeType,A.nodeType}catch{p=null;break e}var Y=0,ae=-1,Se=-1,ze=0,Xe=0,at=s,qe=null;t:for(;;){for(var Be;at!==p||N!==0&&at.nodeType!==3||(ae=Y+N),at!==A||x!==0&&at.nodeType!==3||(Se=Y+x),at.nodeType===3&&(Y+=at.nodeValue.length),(Be=at.firstChild)!==null;)qe=at,at=Be;for(;;){if(at===s)break t;if(qe===p&&++ze===N&&(ae=Y),qe===A&&++Xe===x&&(Se=Y),(Be=at.nextSibling)!==null)break;at=qe,qe=at.parentNode}at=Be}p=ae===-1||Se===-1?null:{start:ae,end:Se}}else p=null}p=p||{start:0,end:0}}else p=null;for(uh={focusedElem:s,selectionRange:p},yh=!1,Mr=c;Mr!==null;)if(c=Mr,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,Mr=s;else for(;Mr!==null;){switch(c=Mr,A=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&A!==null){s=void 0,p=c,N=A.memoizedProps,A=A.memoizedState,x=p.stateNode;try{var Ot=Go(p.type,N,p.elementType===p.type);s=x.getSnapshotBeforeUpdate(Ot,A),x.__reactInternalSnapshotBeforeUpdate=s}catch(Mt){Zn(p,p.return,Mt)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,p=s.nodeType,p===9)gm(s);else if(p===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":gm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=c.sibling,s!==null){s.return=c.return,Mr=s;break}Mr=c.return}}function fy(s,c,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:Qo(s,p),x&4&&yd(5,p);break;case 1:if(Qo(s,p),x&4)if(s=p.stateNode,c===null)try{s.componentDidMount()}catch(Y){Zn(p,p.return,Y)}else{var N=Go(p.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(N,c,s.__reactInternalSnapshotBeforeUpdate)}catch(Y){Zn(p,p.return,Y)}}x&64&&uy(p),x&512&&Gc(p,p.return);break;case 3:if(Qo(s,p),x&64&&(s=p.updateQueue,s!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{yp(s,c)}catch(Y){Zn(p,p.return,Y)}}break;case 27:c===null&&x&4&&vd(p);case 26:case 5:Qo(s,p),c===null&&x&4&&Kf(p),x&512&&Gc(p,p.return);break;case 12:Qo(s,p);break;case 13:Qo(s,p),x&4&&my(s,p),x&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=ih.bind(null,p),au(s,p))));break;case 22:if(x=p.memoizedState!==null||xs,!x){c=c!==null&&c.memoizedState!==null||On,N=xs;var A=On;xs=x,(On=c)&&!A?ao(s,p,(p.subtreeFlags&8772)!==0):Qo(s,p),xs=N,On=A}break;case 30:break;default:Qo(s,p)}}function hy(s){var c=s.alternate;c!==null&&(s.alternate=null,hy(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&Tu(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var lr=null,Pi=!1;function io(s,c,p){for(p=p.child;p!==null;)py(s,c,p),p=p.sibling}function py(s,c,p){if(de&&typeof de.onCommitFiberUnmount=="function")try{de.onCommitFiberUnmount(q,p)}catch{}switch(p.tag){case 26:On||ys(p,c),io(s,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:On||ys(p,c);var x=lr,N=Pi;ya(p.type)&&(lr=p.stateNode,Pi=!1),io(s,c,p),Pd(p.stateNode),lr=x,Pi=N;break;case 5:On||ys(p,c);case 6:if(x=lr,N=Pi,lr=null,io(s,c,p),lr=x,Pi=N,lr!==null)if(Pi)try{(lr.nodeType===9?lr.body:lr.nodeName==="HTML"?lr.ownerDocument.body:lr).removeChild(p.stateNode)}catch(A){Zn(p,c,A)}else try{lr.removeChild(p.stateNode)}catch(A){Zn(p,c,A)}break;case 18:lr!==null&&(Pi?(s=lr,fh(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,p.stateNode),$d(s)):fh(lr,p.stateNode));break;case 4:x=lr,N=Pi,lr=p.stateNode.containerInfo,Pi=!0,io(s,c,p),lr=x,Pi=N;break;case 0:case 11:case 14:case 15:On||Wo(2,p,c),On||Wo(4,p,c),io(s,c,p);break;case 1:On||(ys(p,c),x=p.stateNode,typeof x.componentWillUnmount=="function"&&Hp(p,c,x)),io(s,c,p);break;case 21:io(s,c,p);break;case 22:On=(x=On)||p.memoizedState!==null,io(s,c,p),On=x;break;default:io(s,c,p)}}function my(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{$d(s)}catch(p){Zn(c,c.return,p)}}function dv(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new dy),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new dy),c;default:throw Error(r(435,s.tag))}}function Gp(s,c){var p=dv(s);c.forEach(function(x){var N=yv.bind(null,s,x);p.has(x)||(p.add(x),x.then(N,N))})}function Ji(s,c){var p=c.deletions;if(p!==null)for(var x=0;x<p.length;x++){var N=p[x],A=s,Y=c,ae=Y;e:for(;ae!==null;){switch(ae.tag){case 27:if(ya(ae.type)){lr=ae.stateNode,Pi=!1;break e}break;case 5:lr=ae.stateNode,Pi=!1;break e;case 3:case 4:lr=ae.stateNode.containerInfo,Pi=!0;break e}ae=ae.return}if(lr===null)throw Error(r(160));py(A,Y,N),lr=null,Pi=!1,A=N.alternate,A!==null&&(A.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Yp(c,s),c=c.sibling}var ma=null;function Yp(s,c){var p=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ji(c,s),Di(s),x&4&&(Wo(3,s,s.return),yd(3,s),Wo(5,s,s.return));break;case 1:Ji(c,s),Di(s),x&512&&(On||p===null||ys(p,p.return)),x&64&&xs&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var N=ma;if(Ji(c,s),Di(s),x&512&&(On||p===null||ys(p,p.return)),x&4){var A=p!==null?p.memoizedState:null;if(x=s.memoizedState,p===null)if(x===null)if(s.stateNode===null){e:{x=s.type,p=s.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":A=N.getElementsByTagName("title")[0],(!A||A[As]||A[Hn]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=N.createElement(x),N.head.insertBefore(A,N.querySelector("head > title"))),Lr(A,x,p),A[Hn]=s,kr(A),x=A;break e;case"link":var Y=ax("link","href",N).get(x+(p.href||""));if(Y){for(var ae=0;ae<Y.length;ae++)if(A=Y[ae],A.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&A.getAttribute("rel")===(p.rel==null?null:p.rel)&&A.getAttribute("title")===(p.title==null?null:p.title)&&A.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){Y.splice(ae,1);break t}}A=N.createElement(x),Lr(A,x,p),N.head.appendChild(A);break;case"meta":if(Y=ax("meta","content",N).get(x+(p.content||""))){for(ae=0;ae<Y.length;ae++)if(A=Y[ae],A.getAttribute("content")===(p.content==null?null:""+p.content)&&A.getAttribute("name")===(p.name==null?null:p.name)&&A.getAttribute("property")===(p.property==null?null:p.property)&&A.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&A.getAttribute("charset")===(p.charSet==null?null:p.charSet)){Y.splice(ae,1);break t}}A=N.createElement(x),Lr(A,x,p),N.head.appendChild(A);break;default:throw Error(r(468,x))}A[Hn]=s,kr(A),x=A}s.stateNode=x}else sx(N,s.type,s.stateNode);else s.stateNode=ix(N,x,s.memoizedProps);else A!==x?(A===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):A.count--,x===null?sx(N,s.type,s.stateNode):ix(N,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Xf(s,s.memoizedProps,p.memoizedProps)}break;case 27:Ji(c,s),Di(s),x&512&&(On||p===null||ys(p,p.return)),p!==null&&x&4&&Xf(s,s.memoizedProps,p.memoizedProps);break;case 5:if(Ji(c,s),Di(s),x&512&&(On||p===null||ys(p,p.return)),s.flags&32){N=s.stateNode;try{wi(N,"")}catch(Be){Zn(s,s.return,Be)}}x&4&&s.stateNode!=null&&(N=s.memoizedProps,Xf(s,N,p!==null?p.memoizedProps:N)),x&1024&&(ro=!0);break;case 6:if(Ji(c,s),Di(s),x&4){if(s.stateNode===null)throw Error(r(162));x=s.memoizedProps,p=s.stateNode;try{p.nodeValue=x}catch(Be){Zn(s,s.return,Be)}}break;case 3:if(cu=null,N=ma,ma=Wt(c.containerInfo),Ji(c,s),ma=N,Di(s),x&4&&p!==null&&p.memoizedState.isDehydrated)try{$d(c.containerInfo)}catch(Be){Zn(s,s.return,Be)}ro&&(ro=!1,gy(s));break;case 4:x=ma,ma=Wt(s.stateNode.containerInfo),Ji(c,s),Di(s),ma=x;break;case 12:Ji(c,s),Di(s);break;case 13:Ji(c,s),Di(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(em=Ke()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Gp(s,x)));break;case 22:N=s.memoizedState!==null;var Se=p!==null&&p.memoizedState!==null,ze=xs,Xe=On;if(xs=ze||N,On=Xe||Se,Ji(c,s),On=Xe,xs=ze,Di(s),x&8192)e:for(c=s.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(p===null||Se||xs||On||rc(s)),p=null,c=s;;){if(c.tag===5||c.tag===26){if(p===null){Se=p=c;try{if(A=Se.stateNode,N)Y=A.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none";else{ae=Se.stateNode;var at=Se.memoizedProps.style,qe=at!=null&&at.hasOwnProperty("display")?at.display:null;ae.style.display=qe==null||typeof qe=="boolean"?"":(""+qe).trim()}}catch(Be){Zn(Se,Se.return,Be)}}}else if(c.tag===6){if(p===null){Se=c;try{Se.stateNode.nodeValue=N?"":Se.memoizedProps}catch(Be){Zn(Se,Se.return,Be)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Gp(s,p))));break;case 19:Ji(c,s),Di(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Gp(s,x)));break;case 30:break;case 21:break;default:Ji(c,s),Di(s)}}function Di(s){var c=s.flags;if(c&2){try{for(var p,x=s.return;x!==null;){if(Yc(x)){p=x;break}x=x.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var N=p.stateNode,A=xd(s);bd(s,A,N);break;case 5:var Y=p.stateNode;p.flags&32&&(wi(Y,""),p.flags&=-33);var ae=xd(s);bd(s,ae,Y);break;case 3:case 4:var Se=p.stateNode.containerInfo,ze=xd(s);Zf(s,ze,Se);break;default:throw Error(r(161))}}catch(Xe){Zn(s,s.return,Xe)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function gy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;gy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function Qo(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)fy(s,c.alternate,c),c=c.sibling}function rc(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:Wo(4,c,c.return),rc(c);break;case 1:ys(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&Hp(c,c.return,p),rc(c);break;case 27:Pd(c.stateNode);case 26:case 5:ys(c,c.return),rc(c);break;case 22:c.memoizedState===null&&rc(c);break;case 30:rc(c);break;default:rc(c)}s=s.sibling}}function ao(s,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=s,A=c,Y=A.flags;switch(A.tag){case 0:case 11:case 15:ao(N,A,p),yd(4,A);break;case 1:if(ao(N,A,p),x=A,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(ze){Zn(x,x.return,ze)}if(x=A,N=x.updateQueue,N!==null){var ae=x.stateNode;try{var Se=N.shared.hiddenCallbacks;if(Se!==null)for(N.shared.hiddenCallbacks=null,N=0;N<Se.length;N++)Mg(Se[N],ae)}catch(ze){Zn(x,x.return,ze)}}p&&Y&64&&uy(A),Gc(A,A.return);break;case 27:vd(A);case 26:case 5:ao(N,A,p),p&&x===null&&Y&4&&Kf(A),Gc(A,A.return);break;case 12:ao(N,A,p);break;case 13:ao(N,A,p),p&&Y&4&&my(N,A);break;case 22:A.memoizedState===null&&ao(N,A,p),Gc(A,A.return);break;case 30:break;default:ao(N,A,p)}c=c.sibling}}function Wp(s,c){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&Gu(p))}function Qp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Gu(s))}function bs(s,c,p,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)yy(s,c,p,x),c=c.sibling}function yy(s,c,p,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:bs(s,c,p,x),N&2048&&yd(9,c);break;case 1:bs(s,c,p,x);break;case 3:bs(s,c,p,x),N&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Gu(s)));break;case 12:if(N&2048){bs(s,c,p,x),s=c.stateNode;try{var A=c.memoizedProps,Y=A.id,ae=A.onPostCommit;typeof ae=="function"&&ae(Y,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Se){Zn(c,c.return,Se)}}else bs(s,c,p,x);break;case 13:bs(s,c,p,x);break;case 23:break;case 22:A=c.stateNode,Y=c.alternate,c.memoizedState!==null?A._visibility&2?bs(s,c,p,x):wd(s,c):A._visibility&2?bs(s,c,p,x):(A._visibility|=2,Wc(s,c,p,x,(c.subtreeFlags&10256)!==0)),N&2048&&Wp(Y,c);break;case 24:bs(s,c,p,x),N&2048&&Qp(c.alternate,c);break;default:bs(s,c,p,x)}}function Wc(s,c,p,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=s,Y=c,ae=p,Se=x,ze=Y.flags;switch(Y.tag){case 0:case 11:case 15:Wc(A,Y,ae,Se,N),yd(8,Y);break;case 23:break;case 22:var Xe=Y.stateNode;Y.memoizedState!==null?Xe._visibility&2?Wc(A,Y,ae,Se,N):wd(A,Y):(Xe._visibility|=2,Wc(A,Y,ae,Se,N)),N&&ze&2048&&Wp(Y.alternate,Y);break;case 24:Wc(A,Y,ae,Se,N),N&&ze&2048&&Qp(Y.alternate,Y);break;default:Wc(A,Y,ae,Se,N)}c=c.sibling}}function wd(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=s,x=c,N=x.flags;switch(x.tag){case 22:wd(p,x),N&2048&&Wp(x.alternate,x);break;case 24:wd(p,x),N&2048&&Qp(x.alternate,x);break;default:wd(p,x)}c=c.sibling}}var li=8192;function Qc(s){if(s.subtreeFlags&li)for(s=s.child;s!==null;)xy(s),s=s.sibling}function xy(s){switch(s.tag){case 26:Qc(s),s.flags&li&&s.memoizedState!==null&&Ov(ma,s.memoizedState,s.memoizedProps);break;case 5:Qc(s);break;case 3:case 4:var c=ma;ma=Wt(s.stateNode.containerInfo),Qc(s),ma=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=li,li=16777216,Qc(s),li=c):Qc(s));break;default:Qc(s)}}function by(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Jc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Mr=x,wy(x,s)}by(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)vy(s),s=s.sibling}function vy(s){switch(s.tag){case 0:case 11:case 15:Jc(s),s.flags&2048&&Wo(9,s,s.return);break;case 3:Jc(s);break;case 12:Jc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,eh(s)):Jc(s);break;default:Jc(s)}}function eh(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Mr=x,wy(x,s)}by(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:Wo(8,c,c.return),eh(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,eh(c));break;default:eh(c)}s=s.sibling}}function wy(s,c){for(;Mr!==null;){var p=Mr;switch(p.tag){case 0:case 11:case 15:Wo(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Gu(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,Mr=x;else e:for(p=s;Mr!==null;){x=Mr;var N=x.sibling,A=x.return;if(hy(x),x===p){Mr=null;break e}if(N!==null){N.return=A,Mr=N;break e}Mr=A}}}var fv={getCacheForType:function(s){var c=xr(Kn),p=c.data.get(s);return p===void 0&&(p=s(),c.data.set(s,p)),p}},Jp=typeof WeakMap=="function"?WeakMap:Map,zn=0,tr=null,dn=null,Cn=0,Bn=0,Ki=null,Jo=!1,Kc=!1,Kp=!1,so=0,vr=0,Ko=0,ic=0,Xp=0,ga=0,Xc=0,Sd=null,Ii=null,Zp=!1,em=0,Zc=1/0,Nd=null,Xo=null,ei=0,Zo=null,eu=null,tu=0,tm=0,nm=null,Sy=null,nu=0,rm=null;function ci(){if((zn&2)!==0&&Cn!==0)return Cn&-Cn;if(G.T!==null){var s=Lc;return s!==0?s:oh()}return hn()}function Ny(){ga===0&&(ga=(Cn&536870912)===0||gn?Ze():536870912);var s=Qi.current;return s!==null&&(s.flags|=32),ga}function Xi(s,c,p){(s===tr&&(Bn===2||Bn===9)||s.cancelPendingCommit!==null)&&(ru(s,0),el(s,Cn,ga,!1)),mt(s,p),((zn&2)===0||s!==tr)&&(s===tr&&((zn&2)===0&&(ic|=p),vr===4&&el(s,Cn,ga,!1)),vs(s))}function Cy(s,c,p){if((zn&6)!==0)throw Error(r(327));var x=!p&&(c&124)===0&&(c&s.expiredLanes)===0||Oe(s,c),N=x?mv(s,c):sm(s,c,!0),A=x;do{if(N===0){Kc&&!x&&el(s,c,0,!1);break}else{if(p=s.current.alternate,A&&!hv(p)){N=sm(s,c,!1),A=!1;continue}if(N===2){if(A=c,s.errorRecoveryDisabledLanes&A)var Y=0;else Y=s.pendingLanes&-536870913,Y=Y!==0?Y:Y&536870912?536870912:0;if(Y!==0){c=Y;e:{var ae=s;N=Sd;var Se=ae.current.memoizedState.isDehydrated;if(Se&&(ru(ae,Y).flags|=256),Y=sm(ae,Y,!1),Y!==2){if(Kp&&!Se){ae.errorRecoveryDisabledLanes|=A,ic|=A,N=4;break e}A=Ii,Ii=N,A!==null&&(Ii===null?Ii=A:Ii.push.apply(Ii,A))}N=Y}if(A=!1,N!==2)continue}}if(N===1){ru(s,0),el(s,c,0,!0);break}e:{switch(x=s,A=N,A){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:el(x,c,ga,!Jo);break e;case 2:Ii=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(N=em+300-Ke(),10<N)){if(el(x,c,ga,!Jo),Ne(x,0,!0)!==0)break e;x.timeoutHandle=Wy(_y.bind(null,x,p,Ii,Nd,Zp,c,ga,ic,Xc,Jo,A,2,-0,0),N);break e}_y(x,p,Ii,Nd,Zp,c,ga,ic,Xc,Jo,A,0,-0,0)}}break}while(!0);vs(s)}function _y(s,c,p,x,N,A,Y,ae,Se,ze,Xe,at,qe,Be){if(s.timeoutHandle=-1,at=c.subtreeFlags,(at&8192||(at&16785408)===16785408)&&(Yr={stylesheets:null,count:0,unsuspend:Mv},xy(c),at=Lv(),at!==null)){s.cancelPendingCommit=at(Cd.bind(null,s,c,A,p,x,N,Y,ae,Se,Xe,1,qe,Be)),el(s,A,Y,!ze);return}Cd(s,c,A,p,x,N,Y,ae,Se)}function hv(s){for(var c=s;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var N=p[x],A=N.getSnapshot;N=N.value;try{if(!pi(A(),N))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function el(s,c,p,x){c&=~Xp,c&=~ic,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var N=c;0<N;){var A=31-$e(N),Y=1<<A;x[A]=-1,N&=~Y}p!==0&&Ln(s,p,c)}function th(){return(zn&6)===0?(kd(0),!1):!0}function im(){if(dn!==null){if(Bn===0)var s=dn.return;else s=dn,re=Bo=null,jf(s),Rr=null,Ai=0,s=dn;for(;s!==null;)cy(s.alternate,s),s=s.return;dn=null}}function ru(s,c){var p=s.timeoutHandle;p!==-1&&(s.timeoutHandle=-1,jv(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),im(),tr=s,dn=p=Vr(s.current,null),Cn=c,Bn=0,Ki=null,Jo=!1,Kc=Oe(s,c),Kp=!1,Xc=ga=Xp=ic=Ko=vr=0,Ii=Sd=null,Zp=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var N=31-$e(x),A=1<<N;c|=s[N],x&=~A}return so=c,fs(),p}function jy(s,c){en=null,G.H=od,c===gi||c===Nf?(c=Ig(),Bn=3):c===Pg?(c=Ig(),Bn=4):Bn=c===ry?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Ki=c,dn===null&&(vr=1,fd(s,Zr(c,s.current)))}function ky(){var s=G.H;return G.H=od,s===null?od:s}function Ty(){var s=G.A;return G.A=fv,s}function am(){vr=4,Jo||(Cn&4194048)!==Cn&&Qi.current!==null||(Kc=!0),(Ko&134217727)===0&&(ic&134217727)===0||tr===null||el(tr,Cn,ga,!1)}function sm(s,c,p){var x=zn;zn|=2;var N=ky(),A=Ty();(tr!==s||Cn!==c)&&(Nd=null,ru(s,c)),c=!1;var Y=vr;e:do try{if(Bn!==0&&dn!==null){var ae=dn,Se=Ki;switch(Bn){case 8:im(),Y=6;break e;case 3:case 2:case 9:case 6:Qi.current===null&&(c=!0);var ze=Bn;if(Bn=0,Ki=null,iu(s,ae,Se,ze),p&&Kc){Y=0;break e}break;default:ze=Bn,Bn=0,Ki=null,iu(s,ae,Se,ze)}}pv(),Y=vr;break}catch(Xe){jy(s,Xe)}while(!0);return c&&s.shellSuspendCounter++,re=Bo=null,zn=x,G.H=N,G.A=A,dn===null&&(tr=null,Cn=0,fs()),Y}function pv(){for(;dn!==null;)om(dn)}function mv(s,c){var p=zn;zn|=2;var x=ky(),N=Ty();tr!==s||Cn!==c?(Nd=null,Zc=Ke()+500,ru(s,c)):Kc=Oe(s,c);e:do try{if(Bn!==0&&dn!==null){c=dn;var A=Ki;t:switch(Bn){case 1:Bn=0,Ki=null,iu(s,c,A,1);break;case 2:case 9:if(Dg(A)){Bn=0,Ki=null,Ay(c);break}c=function(){Bn!==2&&Bn!==9||tr!==s||(Bn=7),vs(s)},A.then(c,c);break e;case 3:Bn=7;break e;case 4:Bn=5;break e;case 7:Dg(A)?(Bn=0,Ki=null,Ay(c)):(Bn=0,Ki=null,iu(s,c,A,7));break;case 5:var Y=null;switch(dn.tag){case 26:Y=dn.memoizedState;case 5:case 27:var ae=dn;if(!Y||Fr(Y)){Bn=0,Ki=null;var Se=ae.sibling;if(Se!==null)dn=Se;else{var ze=ae.return;ze!==null?(dn=ze,nh(ze)):dn=null}break t}}Bn=0,Ki=null,iu(s,c,A,5);break;case 6:Bn=0,Ki=null,iu(s,c,A,6);break;case 8:im(),vr=6;break e;default:throw Error(r(462))}}Ey();break}catch(Xe){jy(s,Xe)}while(!0);return re=Bo=null,G.H=x,G.A=N,zn=p,dn!==null?0:(tr=null,Cn=0,fs(),vr)}function Ey(){for(;dn!==null&&!Ye();)om(dn)}function om(s){var c=Wf(s.alternate,s,so);s.memoizedProps=s.pendingProps,c===null?nh(s):dn=c}function Ay(s){var c=s,p=c.alternate;switch(c.tag){case 15:case 0:c=Gf(p,c,c.pendingProps,c.type,void 0,Cn);break;case 11:c=Gf(p,c,c.pendingProps,c.type.render,c.ref,Cn);break;case 5:jf(c);default:cy(p,c),c=dn=$o(c,so),c=Wf(p,c,so)}s.memoizedProps=s.pendingProps,c===null?nh(s):dn=c}function iu(s,c,p,x){re=Bo=null,jf(c),Rr=null,Ai=0;var N=c.return;try{if(ny(s,N,c,p,Cn)){vr=1,fd(s,Zr(p,s.current)),dn=null;return}}catch(A){if(N!==null)throw dn=N,A;vr=1,fd(s,Zr(p,s.current)),dn=null;return}c.flags&32768?(gn||x===1?s=!0:Kc||(Cn&536870912)!==0?s=!1:(Jo=s=!0,(x===2||x===9||x===3||x===6)&&(x=Qi.current,x!==null&&x.tag===13&&(x.flags|=16384))),Py(c,s)):nh(c)}function nh(s){var c=s;do{if((c.flags&32768)!==0){Py(c,Jo);return}s=c.return;var p=oy(c.alternate,c,so);if(p!==null){dn=p;return}if(c=c.sibling,c!==null){dn=c;return}dn=c=s}while(c!==null);vr===0&&(vr=5)}function Py(s,c){do{var p=ly(s.alternate,s);if(p!==null){p.flags&=32767,dn=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(s=s.sibling,s!==null)){dn=s;return}dn=s=p}while(s!==null);vr=6,dn=null}function Cd(s,c,p,x,N,A,Y,ae,Se){s.cancelPendingCommit=null;do rh();while(ei!==0);if((zn&6)!==0)throw Error(r(327));if(c!==null){if(c===s.current)throw Error(r(177));if(A=c.lanes|c.childLanes,A|=Bu,an(s,p,A,Y,ae,Se),s===tr&&(dn=tr=null,Cn=0),eu=c,Zo=s,tu=p,tm=A,nm=N,Sy=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,$y(Ee,function(){return Oy(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=G.T,G.T=null,N=J.p,J.p=2,Y=zn,zn|=4;try{uv(s,c,p)}finally{zn=Y,J.p=N,G.T=x}}ei=1,Dy(),Iy(),Ry()}}function Dy(){if(ei===1){ei=0;var s=Zo,c=eu,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=G.T,G.T=null;var x=J.p;J.p=2;var N=zn;zn|=4;try{Yp(c,s);var A=uh,Y=yf(s.containerInfo),ae=A.focusedElem,Se=A.selectionRange;if(Y!==ae&&ae&&ae.ownerDocument&&Mo(ae.ownerDocument.documentElement,ae)){if(Se!==null&&ca(ae)){var ze=Se.start,Xe=Se.end;if(Xe===void 0&&(Xe=ze),"selectionStart"in ae)ae.selectionStart=ze,ae.selectionEnd=Math.min(Xe,ae.value.length);else{var at=ae.ownerDocument||document,qe=at&&at.defaultView||window;if(qe.getSelection){var Be=qe.getSelection(),Ot=ae.textContent.length,Mt=Math.min(Se.start,Ot),Yn=Se.end===void 0?Mt:Math.min(Se.end,Ot);!Be.extend&&Mt>Yn&&(Y=Yn,Yn=Mt,Mt=Y);var Re=zu(ae,Mt),Te=zu(ae,Yn);if(Re&&Te&&(Be.rangeCount!==1||Be.anchorNode!==Re.node||Be.anchorOffset!==Re.offset||Be.focusNode!==Te.node||Be.focusOffset!==Te.offset)){var Fe=at.createRange();Fe.setStart(Re.node,Re.offset),Be.removeAllRanges(),Mt>Yn?(Be.addRange(Fe),Be.extend(Te.node,Te.offset)):(Fe.setEnd(Te.node,Te.offset),Be.addRange(Fe))}}}}for(at=[],Be=ae;Be=Be.parentNode;)Be.nodeType===1&&at.push({element:Be,left:Be.scrollLeft,top:Be.scrollTop});for(typeof ae.focus=="function"&&ae.focus(),ae=0;ae<at.length;ae++){var tt=at[ae];tt.element.scrollLeft=tt.left,tt.element.scrollTop=tt.top}}yh=!!Ua,uh=Ua=null}finally{zn=N,J.p=x,G.T=p}}s.current=c,ei=2}}function Iy(){if(ei===2){ei=0;var s=Zo,c=eu,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=G.T,G.T=null;var x=J.p;J.p=2;var N=zn;zn|=4;try{fy(s,c.alternate,c)}finally{zn=N,J.p=x,G.T=p}}ei=3}}function Ry(){if(ei===4||ei===3){ei=0,et();var s=Zo,c=eu,p=tu,x=Sy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?ei=5:(ei=0,eu=Zo=null,My(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(Xo=null),xt(p),c=c.stateNode,de&&typeof de.onCommitFiberRoot=="function")try{de.onCommitFiberRoot(q,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=G.T,N=J.p,J.p=2,G.T=null;try{for(var A=s.onRecoverableError,Y=0;Y<x.length;Y++){var ae=x[Y];A(ae.value,{componentStack:ae.stack})}}finally{G.T=c,J.p=N}}(tu&3)!==0&&rh(),vs(s),N=s.pendingLanes,(p&4194090)!==0&&(N&42)!==0?s===rm?nu++:(nu=0,rm=s):nu=0,kd(0)}}function My(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,Gu(c)))}function rh(s){return Dy(),Iy(),Ry(),Oy()}function Oy(){if(ei!==5)return!1;var s=Zo,c=tm;tm=0;var p=xt(tu),x=G.T,N=J.p;try{J.p=32>p?32:p,G.T=null,p=nm,nm=null;var A=Zo,Y=tu;if(ei=0,eu=Zo=null,tu=0,(zn&6)!==0)throw Error(r(331));var ae=zn;if(zn|=4,vy(A.current),yy(A,A.current,Y,p),zn=ae,kd(0,!1),de&&typeof de.onPostCommitFiberRoot=="function")try{de.onPostCommitFiberRoot(q,A)}catch{}return!0}finally{J.p=N,G.T=x,My(s,c)}}function Ly(s,c,p){c=Zr(p,c),c=Uf(s.stateNode,c,2),s=Js(s,c,2),s!==null&&(mt(s,2),vs(s))}function Zn(s,c,p){if(s.tag===3)Ly(s,s,p);else for(;c!==null;){if(c.tag===3){Ly(c,s,p);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Xo===null||!Xo.has(x))){s=Zr(p,s),p=zp(2),x=Js(c,p,2),x!==null&&(ty(p,x,c,s),mt(x,2),vs(x));break}}c=c.return}}function lm(s,c,p){var x=s.pingCache;if(x===null){x=s.pingCache=new Jp;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(p)||(Kp=!0,N.add(p),s=gv.bind(null,s,c,p),c.then(s,s))}function gv(s,c,p){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,tr===s&&(Cn&p)===p&&(vr===4||vr===3&&(Cn&62914560)===Cn&&300>Ke()-em?(zn&2)===0&&ru(s,0):Xp|=p,Xc===Cn&&(Xc=0)),vs(s)}function Fy(s,c){c===0&&(c=jt()),s=Hs(s,c),s!==null&&(mt(s,c),vs(s))}function ih(s){var c=s.memoizedState,p=0;c!==null&&(p=c.retryLane),Fy(s,p)}function yv(s,c){var p=0;switch(s.tag){case 13:var x=s.stateNode,N=s.memoizedState;N!==null&&(p=N.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),Fy(s,p)}function $y(s,c){return ue(s,c)}var _d=null,tl=null,ah=!1,jd=!1,sh=!1,nl=0;function vs(s){s!==tl&&s.next===null&&(tl===null?_d=tl=s:tl=tl.next=s),jd=!0,ah||(ah=!0,cm())}function kd(s,c){if(!sh&&jd){sh=!0;do for(var p=!1,x=_d;x!==null;){if(s!==0){var N=x.pendingLanes;if(N===0)var A=0;else{var Y=x.suspendedLanes,ae=x.pingedLanes;A=(1<<31-$e(42|s)+1)-1,A&=N&~(Y&~ae),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(p=!0,By(x,A))}else A=Cn,A=Ne(x,x===tr?A:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(A&3)===0||Oe(x,A)||(p=!0,By(x,A));x=x.next}while(p);sh=!1}}function xv(){Td()}function Td(){jd=ah=!1;var s=0;nl!==0&&(_v()&&(s=nl),nl=0);for(var c=Ke(),p=null,x=_d;x!==null;){var N=x.next,A=Ed(x,c);A===0?(x.next=null,p===null?_d=N:p.next=N,N===null&&(tl=p)):(p=x,(s!==0||(A&3)!==0)&&(jd=!0)),x=N}kd(s)}function Ed(s,c){for(var p=s.suspendedLanes,x=s.pingedLanes,N=s.expirationTimes,A=s.pendingLanes&-62914561;0<A;){var Y=31-$e(A),ae=1<<Y,Se=N[Y];Se===-1?((ae&p)===0||(ae&x)!==0)&&(N[Y]=Ve(ae,c)):Se<=c&&(s.expiredLanes|=ae),A&=~ae}if(c=tr,p=Cn,p=Ne(s,s===c?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,p===0||s===c&&(Bn===2||Bn===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&De(x),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||Oe(s,p)){if(c=p&-p,c===s.callbackPriority)return c;switch(x!==null&&De(x),xt(p)){case 2:case 8:p=vt;break;case 32:p=Ee;break;case 268435456:p=Ae;break;default:p=Ee}return x=zy.bind(null,s),p=ue(p,x),s.callbackPriority=c,s.callbackNode=p,c}return x!==null&&x!==null&&De(x),s.callbackPriority=2,s.callbackNode=null,2}function zy(s,c){if(ei!==0&&ei!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(rh()&&s.callbackNode!==p)return null;var x=Cn;return x=Ne(s,s===tr?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(Cy(s,x,c),Ed(s,Ke()),s.callbackNode!=null&&s.callbackNode===p?zy.bind(null,s):null)}function By(s,c){if(rh())return null;Cy(s,c,!0)}function cm(){kv(function(){(zn&6)!==0?ue(ot,xv):Td()})}function oh(){return nl===0&&(nl=Ze()),nl}function Uy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ls(""+s)}function qy(s,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,s.id&&p.setAttribute("form",s.id),c.parentNode.insertBefore(p,c),s=new FormData(s),p.parentNode.removeChild(p),s}function bv(s,c,p,x,N){if(c==="submit"&&p&&p.stateNode===N){var A=Uy((N[hr]||null).action),Y=x.submitter;Y&&(c=(c=Y[hr]||null)?Uy(c.formAction):Y.getAttribute("formAction"),c!==null&&(A=c,Y=null));var ae=new Si("action","action",null,x,N);s.push({event:ae,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(nl!==0){var Se=Y?qy(N,Y):new FormData(N);ad(p,{pending:!0,data:Se,method:N.method,action:A},null,Se)}}else typeof A=="function"&&(ae.preventDefault(),Se=Y?qy(N,Y):new FormData(N),ad(p,{pending:!0,data:Se,method:N.method,action:A},A,Se))},currentTarget:N}]})}}for(var um=0;um<xn.length;um++){var dm=xn[um],vv=dm.toLowerCase(),wv=dm[0].toUpperCase()+dm.slice(1);Hi(vv,"on"+wv)}Hi(Ol,"onAnimationEnd"),Hi(xf,"onAnimationIteration"),Hi(mi,"onAnimationStart"),Hi("dblclick","onDoubleClick"),Hi("focusin","onFocus"),Hi("focusout","onBlur"),Hi(Rc,"onTransitionRun"),Hi(bf,"onTransitionStart"),Hi(Oo,"onTransitionCancel"),Hi(ua,"onTransitionEnd"),bo("onMouseEnter",["mouseout","mouseover"]),bo("onMouseLeave",["mouseout","mouseover"]),bo("onPointerEnter",["pointerout","pointerover"]),bo("onPointerLeave",["pointerout","pointerover"]),Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ad="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ad));function Vy(s,c){c=(c&4)!==0;for(var p=0;p<s.length;p++){var x=s[p],N=x.event;x=x.listeners;e:{var A=void 0;if(c)for(var Y=x.length-1;0<=Y;Y--){var ae=x[Y],Se=ae.instance,ze=ae.currentTarget;if(ae=ae.listener,Se!==A&&N.isPropagationStopped())break e;A=ae,N.currentTarget=ze;try{A(N)}catch(Xe){tc(Xe)}N.currentTarget=null,A=Se}else for(Y=0;Y<x.length;Y++){if(ae=x[Y],Se=ae.instance,ze=ae.currentTarget,ae=ae.listener,Se!==A&&N.isPropagationStopped())break e;A=ae,N.currentTarget=ze;try{A(N)}catch(Xe){tc(Xe)}N.currentTarget=null,A=Se}}}}function fn(s,c){var p=c[Ea];p===void 0&&(p=c[Ea]=new Set);var x=s+"__bubble";p.has(x)||(Hy(c,s,2,!1),p.add(x))}function fm(s,c,p){var x=0;c&&(x|=4),Hy(p,s,x,c)}var Ri="_reactListening"+Math.random().toString(36).slice(2);function hm(s){if(!s[Ri]){s[Ri]=!0,of.forEach(function(p){p!=="selectionchange"&&(Sv.has(p)||fm(p,!1,s),fm(p,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[Ri]||(c[Ri]=!0,fm("selectionchange",!1,c))}}function Hy(s,c,p,x){switch(ux(c)){case 2:var N=zv;break;case 8:N=du;break;default:N=Nm}p=N.bind(null,c,p,s),N=void 0,!os||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?s.addEventListener(c,p,{capture:!0,passive:N}):s.addEventListener(c,p,!0):N!==void 0?s.addEventListener(c,p,{passive:N}):s.addEventListener(c,p,!1)}function oo(s,c,p,x,N){var A=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var Y=x.tag;if(Y===3||Y===4){var ae=x.stateNode.containerInfo;if(ae===N)break;if(Y===4)for(Y=x.return;Y!==null;){var Se=Y.tag;if((Se===3||Se===4)&&Y.stateNode.containerInfo===N)return;Y=Y.return}for(;ae!==null;){if(Y=Aa(ae),Y===null)return;if(Se=Y.tag,Se===5||Se===6||Se===26||Se===27){x=A=Y;continue e}ae=ae.parentNode}}x=x.return}Co(function(){var ze=A,Xe=jl(p),at=[];e:{var qe=Ll.get(s);if(qe!==void 0){var Be=Si,Ot=s;switch(s){case"keypress":if(An(p)===0)break e;case"keydown":case"keyup":Be=To;break;case"focusin":Ot="focus",Be=Da;break;case"focusout":Ot="blur",Be=Da;break;case"beforeblur":case"afterblur":Be=Da;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Be=oa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Be=zs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Be=Ou;break;case Ol:case xf:case mi:Be=Al;break;case ua:Be=Mn;break;case"scroll":case"scrollend":Be=uf;break;case"wheel":Be=Tc;break;case"copy":case"cut":case"paste":Be=ff;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Be=Ia;break;case"toggle":case"beforetoggle":Be=ls}var Mt=(c&4)!==0,Yn=!Mt&&(s==="scroll"||s==="scrollend"),Re=Mt?qe!==null?qe+"Capture":null:qe;Mt=[];for(var Te=ze,Fe;Te!==null;){var tt=Te;if(Fe=tt.stateNode,tt=tt.tag,tt!==5&&tt!==26&&tt!==27||Fe===null||Re===null||(tt=ss(Te,Re),tt!=null&&Mt.push(qt(Te,tt,Fe))),Yn)break;Te=Te.return}0<Mt.length&&(qe=new Be(qe,Ot,null,p,Xe),at.push({event:qe,listeners:Mt}))}}if((c&7)===0){e:{if(qe=s==="mouseover"||s==="pointerover",Be=s==="mouseout"||s==="pointerout",qe&&p!==_l&&(Ot=p.relatedTarget||p.fromElement)&&(Aa(Ot)||Ot[sr]))break e;if((Be||qe)&&(qe=Xe.window===Xe?Xe:(qe=Xe.ownerDocument)?qe.defaultView||qe.parentWindow:window,Be?(Ot=p.relatedTarget||p.toElement,Be=ze,Ot=Ot?Aa(Ot):null,Ot!==null&&(Yn=o(Ot),Mt=Ot.tag,Ot!==Yn||Mt!==5&&Mt!==27&&Mt!==6)&&(Ot=null)):(Be=null,Ot=ze),Be!==Ot)){if(Mt=oa,tt="onMouseLeave",Re="onMouseEnter",Te="mouse",(s==="pointerout"||s==="pointerover")&&(Mt=Ia,tt="onPointerLeave",Re="onPointerEnter",Te="pointer"),Yn=Be==null?qe:Ds(Be),Fe=Ot==null?qe:Ds(Ot),qe=new Mt(tt,Te+"leave",Be,p,Xe),qe.target=Yn,qe.relatedTarget=Fe,tt=null,Aa(Xe)===ze&&(Mt=new Mt(Re,Te+"enter",Ot,p,Xe),Mt.target=Fe,Mt.relatedTarget=Yn,tt=Mt),Yn=tt,Be&&Ot)t:{for(Mt=Be,Re=Ot,Te=0,Fe=Mt;Fe;Fe=Or(Fe))Te++;for(Fe=0,tt=Re;tt;tt=Or(tt))Fe++;for(;0<Te-Fe;)Mt=Or(Mt),Te--;for(;0<Fe-Te;)Re=Or(Re),Fe--;for(;Te--;){if(Mt===Re||Re!==null&&Mt===Re.alternate)break t;Mt=Or(Mt),Re=Or(Re)}Mt=null}else Mt=null;Be!==null&&wr(at,qe,Be,Mt,!1),Ot!==null&&Yn!==null&&wr(at,Yn,Ot,Mt,!0)}}e:{if(qe=ze?Ds(ze):window,Be=qe.nodeName&&qe.nodeName.toLowerCase(),Be==="select"||Be==="input"&&qe.type==="file")var bt=Ro;else if(Ra(qe))if(Ac)bt=cp;else{bt=Ma;var on=gf}else Be=qe.nodeName,!Be||Be.toLowerCase()!=="input"||qe.type!=="checkbox"&&qe.type!=="radio"?ze&&Sc(ze.elementType)&&(bt=Ro):bt=Ic;if(bt&&(bt=bt(s,ze))){Do(at,bt,p,Xe);break e}on&&on(s,qe,ze),s==="focusout"&&ze&&qe.type==="number"&&ze.memoizedProps.value!=null&&rs(qe,"number",qe.value)}switch(on=ze?Ds(ze):window,s){case"focusin":(Ra(on)||on.contentEditable==="true")&&(ii=on,Oa=ze,Pe=null);break;case"focusout":Pe=Oa=ii=null;break;case"mousedown":Qe=!0;break;case"contextmenu":case"mouseup":case"dragend":Qe=!1,Ge(at,p,Xe);break;case"selectionchange":if(ds)break;case"keydown":case"keyup":Ge(at,p,Xe)}var Tt;if(Fu)e:{switch(s){case"compositionstart":var Lt="onCompositionStart";break e;case"compositionend":Lt="onCompositionEnd";break e;case"compositionupdate":Lt="onCompositionUpdate";break e}Lt=void 0}else cs?qs(s,p)&&(Lt="onCompositionEnd"):s==="keydown"&&p.keyCode===229&&(Lt="onCompositionStart");Lt&&(Rl&&p.locale!=="ko"&&(cs||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&cs&&(Tt=_c()):(aa=Xe,Tl="value"in aa?aa.value:aa.textContent,cs=!0)),on=lh(ze,Lt),0<on.length&&(Lt=new Xr(Lt,s,null,p,Xe),at.push({event:Lt,listeners:on}),Tt?Lt.data=Tt:(Tt=Ml(p),Tt!==null&&(Lt.data=Tt)))),(Tt=Us?pf(s,p):Po(s,p))&&(Lt=lh(ze,"onBeforeInput"),0<Lt.length&&(on=new Xr("onBeforeInput","beforeinput",null,p,Xe),at.push({event:on,listeners:Lt}),on.data=Tt)),bv(at,s,ze,p,Xe)}Vy(at,c)})}function qt(s,c,p){return{instance:s,listener:c,currentTarget:p}}function lh(s,c){for(var p=c+"Capture",x=[];s!==null;){var N=s,A=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||A===null||(N=ss(s,p),N!=null&&x.unshift(qt(s,N,A)),N=ss(s,c),N!=null&&x.push(qt(s,N,A))),s.tag===3)return x;s=s.return}return[]}function Or(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function wr(s,c,p,x,N){for(var A=c._reactName,Y=[];p!==null&&p!==x;){var ae=p,Se=ae.alternate,ze=ae.stateNode;if(ae=ae.tag,Se!==null&&Se===x)break;ae!==5&&ae!==26&&ae!==27||ze===null||(Se=ze,N?(ze=ss(p,A),ze!=null&&Y.unshift(qt(p,ze,Se))):N||(ze=ss(p,A),ze!=null&&Y.push(qt(p,ze,Se)))),p=p.return}Y.length!==0&&s.push({event:c,listeners:Y})}var Nv=/\r\n?/g,rl=/\u0000|\uFFFD/g;function Gy(s){return(typeof s=="string"?s:""+s).replace(Nv,`
`).replace(rl,"")}function Yy(s,c){return c=Gy(c),Gy(s)===c}function ch(){}function Gn(s,c,p,x,N,A){switch(p){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||wi(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&wi(s,""+x);break;case"className":vo(s,"class",x);break;case"tabIndex":vo(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":vo(s,p,x);break;case"style":di(s,x,A);break;case"data":if(c!=="object"){vo(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||p!=="href")){s.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=Ls(""+x),s.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(p==="formAction"?(c!=="input"&&Gn(s,c,"name",N.name,N,null),Gn(s,c,"formEncType",N.formEncType,N,null),Gn(s,c,"formMethod",N.formMethod,N,null),Gn(s,c,"formTarget",N.formTarget,N,null)):(Gn(s,c,"encType",N.encType,N,null),Gn(s,c,"method",N.method,N,null),Gn(s,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=Ls(""+x),s.setAttribute(p,x);break;case"onClick":x!=null&&(s.onclick=ch);break;case"onScroll":x!=null&&fn("scroll",s);break;case"onScrollEnd":x!=null&&fn("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}p=Ls(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""+x):s.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""):s.removeAttribute(p);break;case"capture":case"download":x===!0?s.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,x):s.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(p,x):s.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(p):s.setAttribute(p,x);break;case"popover":fn("beforetoggle",s),fn("toggle",s),mc(s,"popover",x);break;case"xlinkActuate":Cr(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Cr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Cr(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Cr(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Cr(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Cr(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Cr(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Cr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Cr(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":mc(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Nc.get(p)||p,mc(s,p,x))}}function pm(s,c,p,x,N,A){switch(p){case"style":di(s,x,A);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"children":typeof x=="string"?wi(s,x):(typeof x=="number"||typeof x=="bigint")&&wi(s,""+x);break;case"onScroll":x!=null&&fn("scroll",s);break;case"onScrollEnd":x!=null&&fn("scrollend",s);break;case"onClick":x!=null&&(s.onclick=ch);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!lf.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(N=p.endsWith("Capture"),c=p.slice(2,N?p.length-7:void 0),A=s[hr]||null,A=A!=null?A[p]:null,typeof A=="function"&&s.removeEventListener(c,A,N),typeof x=="function")){typeof A!="function"&&A!==null&&(p in s?s[p]=null:s.hasAttribute(p)&&s.removeAttribute(p)),s.addEventListener(c,x,N);break e}p in s?s[p]=x:x===!0?s.setAttribute(p,""):mc(s,p,x)}}}function Lr(s,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":fn("error",s),fn("load",s);var x=!1,N=!1,A;for(A in p)if(p.hasOwnProperty(A)){var Y=p[A];if(Y!=null)switch(A){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Gn(s,c,A,Y,p,null)}}N&&Gn(s,c,"srcSet",p.srcSet,p,null),x&&Gn(s,c,"src",p.src,p,null);return;case"input":fn("invalid",s);var ae=A=Y=N=null,Se=null,ze=null;for(x in p)if(p.hasOwnProperty(x)){var Xe=p[x];if(Xe!=null)switch(x){case"name":N=Xe;break;case"type":Y=Xe;break;case"checked":Se=Xe;break;case"defaultChecked":ze=Xe;break;case"value":A=Xe;break;case"defaultValue":ae=Xe;break;case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(r(137,c));break;default:Gn(s,c,x,Xe,p,null)}}wc(s,A,ae,Se,ze,Y,N,!1),bc(s);return;case"select":fn("invalid",s),x=Y=A=null;for(N in p)if(p.hasOwnProperty(N)&&(ae=p[N],ae!=null))switch(N){case"value":A=ae;break;case"defaultValue":Y=ae;break;case"multiple":x=ae;default:Gn(s,c,N,ae,p,null)}c=A,p=Y,s.multiple=!!x,c!=null?Os(s,!!x,c,!1):p!=null&&Os(s,!!x,p,!0);return;case"textarea":fn("invalid",s),A=N=x=null;for(Y in p)if(p.hasOwnProperty(Y)&&(ae=p[Y],ae!=null))switch(Y){case"value":x=ae;break;case"defaultValue":N=ae;break;case"children":A=ae;break;case"dangerouslySetInnerHTML":if(ae!=null)throw Error(r(91));break;default:Gn(s,c,Y,ae,p,null)}Cl(s,x,N,A),bc(s);return;case"option":for(Se in p)if(p.hasOwnProperty(Se)&&(x=p[Se],x!=null))switch(Se){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Gn(s,c,Se,x,p,null)}return;case"dialog":fn("beforetoggle",s),fn("toggle",s),fn("cancel",s),fn("close",s);break;case"iframe":case"object":fn("load",s);break;case"video":case"audio":for(x=0;x<Ad.length;x++)fn(Ad[x],s);break;case"image":fn("error",s),fn("load",s);break;case"details":fn("toggle",s);break;case"embed":case"source":case"link":fn("error",s),fn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ze in p)if(p.hasOwnProperty(ze)&&(x=p[ze],x!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Gn(s,c,ze,x,p,null)}return;default:if(Sc(c)){for(Xe in p)p.hasOwnProperty(Xe)&&(x=p[Xe],x!==void 0&&pm(s,c,Xe,x,p,void 0));return}}for(ae in p)p.hasOwnProperty(ae)&&(x=p[ae],x!=null&&Gn(s,c,ae,x,p,null))}function Cv(s,c,p,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,A=null,Y=null,ae=null,Se=null,ze=null,Xe=null;for(Be in p){var at=p[Be];if(p.hasOwnProperty(Be)&&at!=null)switch(Be){case"checked":break;case"value":break;case"defaultValue":Se=at;default:x.hasOwnProperty(Be)||Gn(s,c,Be,null,x,at)}}for(var qe in x){var Be=x[qe];if(at=p[qe],x.hasOwnProperty(qe)&&(Be!=null||at!=null))switch(qe){case"type":A=Be;break;case"name":N=Be;break;case"checked":ze=Be;break;case"defaultChecked":Xe=Be;break;case"value":Y=Be;break;case"defaultValue":ae=Be;break;case"children":case"dangerouslySetInnerHTML":if(Be!=null)throw Error(r(137,c));break;default:Be!==at&&Gn(s,c,qe,Be,x,at)}}Sl(s,Y,ae,Se,ze,Xe,A,N);return;case"select":Be=Y=ae=qe=null;for(A in p)if(Se=p[A],p.hasOwnProperty(A)&&Se!=null)switch(A){case"value":break;case"multiple":Be=Se;default:x.hasOwnProperty(A)||Gn(s,c,A,null,x,Se)}for(N in x)if(A=x[N],Se=p[N],x.hasOwnProperty(N)&&(A!=null||Se!=null))switch(N){case"value":qe=A;break;case"defaultValue":ae=A;break;case"multiple":Y=A;default:A!==Se&&Gn(s,c,N,A,x,Se)}c=ae,p=Y,x=Be,qe!=null?Os(s,!!p,qe,!1):!!x!=!!p&&(c!=null?Os(s,!!p,c,!0):Os(s,!!p,p?[]:"",!1));return;case"textarea":Be=qe=null;for(ae in p)if(N=p[ae],p.hasOwnProperty(ae)&&N!=null&&!x.hasOwnProperty(ae))switch(ae){case"value":break;case"children":break;default:Gn(s,c,ae,null,x,N)}for(Y in x)if(N=x[Y],A=p[Y],x.hasOwnProperty(Y)&&(N!=null||A!=null))switch(Y){case"value":qe=N;break;case"defaultValue":Be=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==A&&Gn(s,c,Y,N,x,A)}Nl(s,qe,Be);return;case"option":for(var Ot in p)if(qe=p[Ot],p.hasOwnProperty(Ot)&&qe!=null&&!x.hasOwnProperty(Ot))switch(Ot){case"selected":s.selected=!1;break;default:Gn(s,c,Ot,null,x,qe)}for(Se in x)if(qe=x[Se],Be=p[Se],x.hasOwnProperty(Se)&&qe!==Be&&(qe!=null||Be!=null))switch(Se){case"selected":s.selected=qe&&typeof qe!="function"&&typeof qe!="symbol";break;default:Gn(s,c,Se,qe,x,Be)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mt in p)qe=p[Mt],p.hasOwnProperty(Mt)&&qe!=null&&!x.hasOwnProperty(Mt)&&Gn(s,c,Mt,null,x,qe);for(ze in x)if(qe=x[ze],Be=p[ze],x.hasOwnProperty(ze)&&qe!==Be&&(qe!=null||Be!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":if(qe!=null)throw Error(r(137,c));break;default:Gn(s,c,ze,qe,x,Be)}return;default:if(Sc(c)){for(var Yn in p)qe=p[Yn],p.hasOwnProperty(Yn)&&qe!==void 0&&!x.hasOwnProperty(Yn)&&pm(s,c,Yn,void 0,x,qe);for(Xe in x)qe=x[Xe],Be=p[Xe],!x.hasOwnProperty(Xe)||qe===Be||qe===void 0&&Be===void 0||pm(s,c,Xe,qe,x,Be);return}}for(var Re in p)qe=p[Re],p.hasOwnProperty(Re)&&qe!=null&&!x.hasOwnProperty(Re)&&Gn(s,c,Re,null,x,qe);for(at in x)qe=x[at],Be=p[at],!x.hasOwnProperty(at)||qe===Be||qe==null&&Be==null||Gn(s,c,at,qe,x,Be)}var Ua=null,uh=null;function ac(s){return s.nodeType===9?s:s.ownerDocument}function cr(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function mr(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function dh(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var mm=null;function _v(){var s=window.event;return s&&s.type==="popstate"?s===mm?!1:(mm=s,!0):(mm=null,!1)}var Wy=typeof setTimeout=="function"?setTimeout:void 0,jv=typeof clearTimeout=="function"?clearTimeout:void 0,Qy=typeof Promise=="function"?Promise:void 0,kv=typeof queueMicrotask=="function"?queueMicrotask:typeof Qy<"u"?function(s){return Qy.resolve(null).then(s).catch(Jy)}:Wy;function Jy(s){setTimeout(function(){throw s})}function ya(s){return s==="head"}function fh(s,c){var p=c,x=0,N=0;do{var A=p.nextSibling;if(s.removeChild(p),A&&A.nodeType===8)if(p=A.data,p==="/$"){if(0<x&&8>x){p=x;var Y=s.ownerDocument;if(p&1&&Pd(Y.documentElement),p&2&&Pd(Y.body),p&4)for(p=Y.head,Pd(p),Y=p.firstChild;Y;){var ae=Y.nextSibling,Se=Y.nodeName;Y[As]||Se==="SCRIPT"||Se==="STYLE"||Se==="LINK"&&Y.rel.toLowerCase()==="stylesheet"||p.removeChild(Y),Y=ae}}if(N===0){s.removeChild(A),$d(c);return}N--}else p==="$"||p==="$?"||p==="$!"?N++:x=p.charCodeAt(0)-48;else x=0;p=A}while(p);$d(c)}function gm(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":gm(p),Tu(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}s.removeChild(p)}}function Ky(s,c,p,x){for(;s.nodeType===1;){var N=p;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[As])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(A=s.getAttribute("rel"),A==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(A!==N.rel||s.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||s.getAttribute("title")!==(N.title==null?null:N.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(A=s.getAttribute("src"),(A!==(N.src==null?null:N.src)||s.getAttribute("type")!==(N.type==null?null:N.type)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&A&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var A=N.name==null?null:""+N.name;if(N.type==="hidden"&&s.getAttribute("name")===A)return s}else return s;if(s=qa(s.nextSibling),s===null)break}return null}function hh(s,c,p){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!p||(s=qa(s.nextSibling),s===null))return null;return s}function bi(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function au(s,c){var p=s.ownerDocument;if(s.data!=="$?"||p.readyState==="complete")c();else{var x=function(){c(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function qa(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var ym=null;function Xy(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var p=s.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return s;c--}else p==="/$"&&c++}s=s.previousSibling}return null}function Zy(s,c,p){switch(c=ac(p),s){case"html":if(s=c.documentElement,!s)throw Error(r(452));return s;case"head":if(s=c.head,!s)throw Error(r(453));return s;case"body":if(s=c.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Pd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);Tu(s)}var Zi=new Map,ws=new Set;function Wt(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ss=J.d;J.d={f:xa,r:ex,D:Tv,C:tx,L:ph,m:Ev,X:Pv,S:Av,M:Dv};function xa(){var s=Ss.f(),c=th();return s||c}function ex(s){var c=Ps(s);c!==null&&c.tag===5&&c.type==="form"?Ff(c):Ss.r(s)}var su=typeof document>"u"?null:document;function Rn(s,c,p){var x=su;if(x&&typeof c=="string"&&c){var N=ui(c);N='link[rel="'+s+'"][href="'+N+'"]',typeof p=="string"&&(N+='[crossorigin="'+p+'"]'),ws.has(N)||(ws.add(N),s={rel:s,crossOrigin:p,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),Lr(c,"link",s),kr(c),x.head.appendChild(c)))}}function Tv(s){Ss.D(s),Rn("dns-prefetch",s,null)}function tx(s,c){Ss.C(s,c),Rn("preconnect",s,c)}function ph(s,c,p){Ss.L(s,c,p);var x=su;if(x&&s&&c){var N='link[rel="preload"][as="'+ui(c)+'"]';c==="image"&&p&&p.imageSrcSet?(N+='[imagesrcset="'+ui(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(N+='[imagesizes="'+ui(p.imageSizes)+'"]')):N+='[href="'+ui(s)+'"]';var A=N;switch(c){case"style":A=ou(s);break;case"script":A=lu(s)}Zi.has(A)||(s=h({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:s,as:c},p),Zi.set(A,s),x.querySelector(N)!==null||c==="style"&&x.querySelector(Dd(A))||c==="script"&&x.querySelector(Id(A))||(c=x.createElement("link"),Lr(c,"link",s),kr(c),x.head.appendChild(c)))}}function Ev(s,c){Ss.m(s,c);var p=su;if(p&&s){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+ui(x)+'"][href="'+ui(s)+'"]',A=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=lu(s)}if(!Zi.has(A)&&(s=h({rel:"modulepreload",href:s},c),Zi.set(A,s),p.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Id(A)))return}x=p.createElement("link"),Lr(x,"link",s),kr(x),p.head.appendChild(x)}}}function Av(s,c,p){Ss.S(s,c,p);var x=su;if(x&&s){var N=Is(x).hoistableStyles,A=ou(s);c=c||"default";var Y=N.get(A);if(!Y){var ae={loading:0,preload:null};if(Y=x.querySelector(Dd(A)))ae.loading=5;else{s=h({rel:"stylesheet",href:s,"data-precedence":c},p),(p=Zi.get(A))&&Rd(s,p);var Se=Y=x.createElement("link");kr(Se),Lr(Se,"link",s),Se._p=new Promise(function(ze,Xe){Se.onload=ze,Se.onerror=Xe}),Se.addEventListener("load",function(){ae.loading|=1}),Se.addEventListener("error",function(){ae.loading|=2}),ae.loading|=4,mh(Y,c,x)}Y={type:"stylesheet",instance:Y,count:1,state:ae},N.set(A,Y)}}}function Pv(s,c){Ss.X(s,c);var p=su;if(p&&s){var x=Is(p).hoistableScripts,N=lu(s),A=x.get(N);A||(A=p.querySelector(Id(N)),A||(s=h({src:s,async:!0},c),(c=Zi.get(N))&&xm(s,c),A=p.createElement("script"),kr(A),Lr(A,"link",s),p.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function Dv(s,c){Ss.M(s,c);var p=su;if(p&&s){var x=Is(p).hoistableScripts,N=lu(s),A=x.get(N);A||(A=p.querySelector(Id(N)),A||(s=h({src:s,async:!0,type:"module"},c),(c=Zi.get(N))&&xm(s,c),A=p.createElement("script"),kr(A),Lr(A,"link",s),p.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function nx(s,c,p,x){var N=(N=Z.current)?Wt(N):null;if(!N)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=ou(p.href),p=Is(N).hoistableStyles,x=p.get(c),x||(x={type:"style",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){s=ou(p.href);var A=Is(N).hoistableStyles,Y=A.get(s);if(Y||(N=N.ownerDocument||N,Y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(s,Y),(A=N.querySelector(Dd(s)))&&!A._p&&(Y.instance=A,Y.state.loading=5),Zi.has(s)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Zi.set(s,p),A||Iv(N,s,p,Y.state))),c&&x===null)throw Error(r(528,""));return Y}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=lu(p),p=Is(N).hoistableScripts,x=p.get(c),x||(x={type:"script",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function ou(s){return'href="'+ui(s)+'"'}function Dd(s){return'link[rel="stylesheet"]['+s+"]"}function rx(s){return h({},s,{"data-precedence":s.precedence,precedence:null})}function Iv(s,c,p,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),Lr(c,"link",p),kr(c),s.head.appendChild(c))}function lu(s){return'[src="'+ui(s)+'"]'}function Id(s){return"script[async]"+s}function ix(s,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+ui(p.href)+'"]');if(x)return c.instance=x,kr(x),x;var N=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),kr(x),Lr(x,"style",N),mh(x,p.precedence,s),c.instance=x;case"stylesheet":N=ou(p.href);var A=s.querySelector(Dd(N));if(A)return c.state.loading|=4,c.instance=A,kr(A),A;x=rx(p),(N=Zi.get(N))&&Rd(x,N),A=(s.ownerDocument||s).createElement("link"),kr(A);var Y=A;return Y._p=new Promise(function(ae,Se){Y.onload=ae,Y.onerror=Se}),Lr(A,"link",x),c.state.loading|=4,mh(A,p.precedence,s),c.instance=A;case"script":return A=lu(p.src),(N=s.querySelector(Id(A)))?(c.instance=N,kr(N),N):(x=p,(N=Zi.get(A))&&(x=h({},p),xm(x,N)),s=s.ownerDocument||s,N=s.createElement("script"),kr(N),Lr(N,"link",x),s.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,mh(x,p.precedence,s));return c.instance}function mh(s,c,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,A=N,Y=0;Y<x.length;Y++){var ae=x[Y];if(ae.dataset.precedence===c)A=ae;else if(A!==N)break}A?A.parentNode.insertBefore(s,A.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(s,c.firstChild))}function Rd(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function xm(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var cu=null;function ax(s,c,p){if(cu===null){var x=new Map,N=cu=new Map;N.set(p,x)}else N=cu,x=N.get(p),x||(x=new Map,N.set(p,x));if(x.has(s))return x;for(x.set(s,null),p=p.getElementsByTagName(s),N=0;N<p.length;N++){var A=p[N];if(!(A[As]||A[Hn]||s==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var Y=A.getAttribute(c)||"";Y=s+Y;var ae=x.get(Y);ae?ae.push(A):x.set(Y,[A])}}return x}function sx(s,c,p){s=s.ownerDocument||s,s.head.insertBefore(p,c==="title"?s.querySelector("head > title"):null)}function Rv(s,c,p){if(p===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Fr(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Yr=null;function Mv(){}function Ov(s,c,p){if(Yr===null)throw Error(r(475));var x=Yr;if(c.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=ou(p.href),A=s.querySelector(Dd(N));if(A){s=A._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Md.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=A,kr(A);return}A=s.ownerDocument||s,p=rx(p),(N=Zi.get(N))&&Rd(p,N),A=A.createElement("link"),kr(A);var Y=A;Y._p=new Promise(function(ae,Se){Y.onload=ae,Y.onerror=Se}),Lr(A,"link",p),c.instance=A}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=Md.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function Lv(){if(Yr===null)throw Error(r(475));var s=Yr;return s.stylesheets&&s.count===0&&bm(s,s.stylesheets),0<s.count?function(c){var p=setTimeout(function(){if(s.stylesheets&&bm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(p)}}:null}function Md(){if(this.count--,this.count===0){if(this.stylesheets)bm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var gh=null;function bm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,gh=new Map,c.forEach(Fv,s),gh=null,Md.call(s))}function Fv(s,c){if(!(c.state.loading&4)){var p=gh.get(s);if(p)var x=p.get(null);else{p=new Map,gh.set(s,p);for(var N=s.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<N.length;A++){var Y=N[A];(Y.nodeName==="LINK"||Y.getAttribute("media")!=="not all")&&(p.set(Y.dataset.precedence,Y),x=Y)}x&&p.set(null,x)}N=c.instance,Y=N.getAttribute("data-precedence"),A=p.get(Y)||x,A===x&&p.set(null,N),p.set(Y,N),this.count++,x=Md.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),A?A.parentNode.insertBefore(N,A.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(N,s.firstChild)),c.state.loading|=4}}var uu={$$typeof:I,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function $v(s,c,p,x,N,A,Y,ae){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nt(0),this.hiddenUpdates=Nt(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=A,this.onRecoverableError=Y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function ox(s,c,p,x,N,A,Y,ae,Se,ze,Xe,at){return s=new $v(s,c,p,Y,ae,Se,ze,at),c=1,A===!0&&(c|=24),A=ai(3,null,null,c),s.current=A,A.stateNode=s,c=hp(),c.refCount++,s.pooledCache=c,c.refCount++,A.memoizedState={element:x,isDehydrated:p,cache:c},Gl(A),s}function lx(s){return s?(s=Gs,s):Gs}function vm(s,c,p,x,N,A){N=lx(N),x.context===null?x.context=N:x.pendingContext=N,x=Uo(c),x.payload={element:p},A=A===void 0?null:A,A!==null&&(x.callback=A),p=Js(s,x,c),p!==null&&(Xi(p,s,c),Wu(p,s,c))}function wm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<c?p:c}}function Sm(s,c){wm(s,c),(s=s.alternate)&&wm(s,c)}function cx(s){if(s.tag===13){var c=Hs(s,67108864);c!==null&&Xi(c,s,67108864),Sm(s,67108864)}}var yh=!0;function zv(s,c,p,x){var N=G.T;G.T=null;var A=J.p;try{J.p=2,Nm(s,c,p,x)}finally{J.p=A,G.T=N}}function du(s,c,p,x){var N=G.T;G.T=null;var A=J.p;try{J.p=8,Nm(s,c,p,x)}finally{J.p=A,G.T=N}}function Nm(s,c,p,x){if(yh){var N=Cm(x);if(N===null)oo(s,c,x,xh,p),dx(s,x);else if(Uv(N,s,c,p,x))x.stopPropagation();else if(dx(s,x),c&4&&-1<Bv.indexOf(s)){for(;N!==null;){var A=Ps(N);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var Y=ke(A.pendingLanes);if(Y!==0){var ae=A;for(ae.pendingLanes|=2,ae.entangledLanes|=2;Y;){var Se=1<<31-$e(Y);ae.entanglements[1]|=Se,Y&=~Se}vs(A),(zn&6)===0&&(Zc=Ke()+500,kd(0))}}break;case 13:ae=Hs(A,2),ae!==null&&Xi(ae,A,2),th(),Sm(A,2)}if(A=Cm(x),A===null&&oo(s,c,x,xh,p),A===N)break;N=A}N!==null&&x.stopPropagation()}else oo(s,c,x,null,p)}}function Cm(s){return s=jl(s),_m(s)}var xh=null;function _m(s){if(xh=null,s=Aa(s),s!==null){var c=o(s);if(c===null)s=null;else{var p=c.tag;if(p===13){if(s=l(c),s!==null)return s;s=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return xh=s,null}function ux(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(it()){case ot:return 2;case vt:return 8;case Ee:case Je:return 32;case Ae:return 268435456;default:return 32}default:return 32}}var bh=!1,lo=null,il=null,al=null,Od=new Map,Ld=new Map,sl=[],Bv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dx(s,c){switch(s){case"focusin":case"focusout":lo=null;break;case"dragenter":case"dragleave":il=null;break;case"mouseover":case"mouseout":al=null;break;case"pointerover":case"pointerout":Od.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ld.delete(c.pointerId)}}function Fd(s,c,p,x,N,A){return s===null||s.nativeEvent!==A?(s={blockedOn:c,domEventName:p,eventSystemFlags:x,nativeEvent:A,targetContainers:[N]},c!==null&&(c=Ps(c),c!==null&&cx(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),s)}function Uv(s,c,p,x,N){switch(c){case"focusin":return lo=Fd(lo,s,c,p,x,N),!0;case"dragenter":return il=Fd(il,s,c,p,x,N),!0;case"mouseover":return al=Fd(al,s,c,p,x,N),!0;case"pointerover":var A=N.pointerId;return Od.set(A,Fd(Od.get(A)||null,s,c,p,x,N)),!0;case"gotpointercapture":return A=N.pointerId,Ld.set(A,Fd(Ld.get(A)||null,s,c,p,x,N)),!0}return!1}function fx(s){var c=Aa(s.target);if(c!==null){var p=o(c);if(p!==null){if(c=p.tag,c===13){if(c=l(p),c!==null){s.blockedOn=c,Jn(s.priority,function(){if(p.tag===13){var x=ci();x=Ct(x);var N=Hs(p,x);N!==null&&Xi(N,p,x),Sm(p,x)}});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){s.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}s.blockedOn=null}function vh(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var p=Cm(s.nativeEvent);if(p===null){p=s.nativeEvent;var x=new p.constructor(p.type,p);_l=x,p.target.dispatchEvent(x),_l=null}else return c=Ps(p),c!==null&&cx(c),s.blockedOn=p,!1;c.shift()}return!0}function hx(s,c,p){vh(s)&&p.delete(c)}function qv(){bh=!1,lo!==null&&vh(lo)&&(lo=null),il!==null&&vh(il)&&(il=null),al!==null&&vh(al)&&(al=null),Od.forEach(hx),Ld.forEach(hx)}function wh(s,c){s.blockedOn===c&&(s.blockedOn=null,bh||(bh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,qv)))}var Sh=null;function px(s){Sh!==s&&(Sh=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Sh===s&&(Sh=null);for(var c=0;c<s.length;c+=3){var p=s[c],x=s[c+1],N=s[c+2];if(typeof x!="function"){if(_m(x||p)===null)continue;break}var A=Ps(p);A!==null&&(s.splice(c,3),c-=3,ad(A,{pending:!0,data:N,method:p.method,action:x},x,N))}}))}function $d(s){function c(Se){return wh(Se,s)}lo!==null&&wh(lo,s),il!==null&&wh(il,s),al!==null&&wh(al,s),Od.forEach(c),Ld.forEach(c);for(var p=0;p<sl.length;p++){var x=sl[p];x.blockedOn===s&&(x.blockedOn=null)}for(;0<sl.length&&(p=sl[0],p.blockedOn===null);)fx(p),p.blockedOn===null&&sl.shift();if(p=(s.ownerDocument||s).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var N=p[x],A=p[x+1],Y=N[hr]||null;if(typeof A=="function")Y||px(p);else if(Y){var ae=null;if(A&&A.hasAttribute("formAction")){if(N=A,Y=A[hr]||null)ae=Y.formAction;else if(_m(N)!==null)continue}else ae=Y.action;typeof ae=="function"?p[x+1]=ae:(p.splice(x,3),x-=3),px(p)}}}function jm(s){this._internalRoot=s}Nh.prototype.render=jm.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,x=ci();vm(p,x,s,c,null,null)},Nh.prototype.unmount=jm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;vm(s.current,2,null,s,null,null),th(),c[sr]=null}};function Nh(s){this._internalRoot=s}Nh.prototype.unstable_scheduleHydration=function(s){if(s){var c=hn();s={blockedOn:null,target:s,priority:c};for(var p=0;p<sl.length&&c!==0&&c<sl[p].priority;p++);sl.splice(p,0,s),p===0&&fx(s)}};var mx=n.version;if(mx!=="19.1.0")throw Error(r(527,mx,"19.1.0"));J.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=f(c),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var Vv={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ch=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ch.isDisabled&&Ch.supportsFiber)try{q=Ch.inject(Vv),de=Ch}catch{}}return Tm.createRoot=function(s,c){if(!a(s))throw Error(r(299));var p=!1,x="",N=$p,A=Bf,Y=ey,ae=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(Y=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(ae=c.unstable_transitionCallbacks)),c=ox(s,1,!1,null,null,p,x,N,A,Y,ae,null),s[sr]=c.current,hm(s),new jm(c)},Tm.hydrateRoot=function(s,c,p){if(!a(s))throw Error(r(299));var x=!1,N="",A=$p,Y=Bf,ae=ey,Se=null,ze=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onUncaughtError!==void 0&&(A=p.onUncaughtError),p.onCaughtError!==void 0&&(Y=p.onCaughtError),p.onRecoverableError!==void 0&&(ae=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(Se=p.unstable_transitionCallbacks),p.formState!==void 0&&(ze=p.formState)),c=ox(s,1,!0,c,p??null,x,N,A,Y,ae,Se,ze),c.context=lx(null),p=c.current,x=ci(),x=Ct(x),N=Uo(x),N.callback=null,Js(p,N,x),p=x,c.current.lanes=p,mt(c,p),vs(c),s[sr]=c.current,hm(s),new Nh(c)},Tm.version="19.1.0",Tm}var zS;function IP(){if(zS)return Jv.exports;zS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Jv.exports=DP(),Jv.exports}var RP=IP();const MP=({message:e="Newtons Ai HMS"})=>i.jsx("div",{className:"loading-container",children:i.jsxs("div",{className:"loading-content",children:[i.jsxs("div",{className:"spinner-ring",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}),i.jsx("div",{className:"loading-title",children:e}),i.jsx("div",{className:"loading-subtitle",children:"Loading your workspace..."})]})});function OP(e={}){const{nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a}=e,[o,l]=w.useState(!1),d=w.useRef(r);d.current=r;const f=w.useRef(a);return f.current=a,w.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",t&&(u.src+=`?hl=${t}`),u.async=!0,u.defer=!0,u.nonce=n,u.onload=()=>{var h;l(!0),(h=d.current)===null||h===void 0||h.call(d)},u.onerror=()=>{var h;l(!1),(h=f.current)===null||h===void 0||h.call(f)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[n]),o}const rk=w.createContext(null);function LP({clientId:e,nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a,children:o}){const l=OP({nonce:n,onScriptLoadSuccess:r,onScriptLoadError:a,locale:t}),d=w.useMemo(()=>({locale:t,clientId:e,scriptLoadedSuccessfully:l}),[e,l]);return Pn.createElement(rk.Provider,{value:d},o)}function FP(){const e=w.useContext(rk);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function $P(e){var n;return(n=e==null?void 0:e.clientId)!==null&&n!==void 0?n:e==null?void 0:e.client_id}const zP={large:40,medium:32,small:20};function BP({onSuccess:e,onError:n,useOneTap:t,promptMomentNotification:r,type:a="standard",theme:o="outline",size:l="large",text:d,shape:f,logo_alignment:u,width:h,click_listener:g,state:b,containerProps:v,...S}){const k=w.useRef(null),{clientId:T,locale:P,scriptLoadedSuccessfully:R}=FP(),I=w.useRef(e);I.current=e;const B=w.useRef(n);B.current=n;const F=w.useRef(r);return F.current=r,w.useEffect(()=>{var L,U,H,K,M,$,z,W,te;if(R)return(H=(U=(L=window==null?void 0:window.google)===null||L===void 0?void 0:L.accounts)===null||U===void 0?void 0:U.id)===null||H===void 0||H.initialize({client_id:T,callback:V=>{var G;if(!(V!=null&&V.credential))return(G=B.current)===null||G===void 0?void 0:G.call(B);const{credential:J,select_by:oe}=V;I.current({credential:J,clientId:$P(V),select_by:oe})},...S}),($=(M=(K=window==null?void 0:window.google)===null||K===void 0?void 0:K.accounts)===null||M===void 0?void 0:M.id)===null||$===void 0||$.renderButton(k.current,{type:a,theme:o,size:l,text:d,shape:f,logo_alignment:u,width:h,locale:P,click_listener:g,state:b}),t&&((te=(W=(z=window==null?void 0:window.google)===null||z===void 0?void 0:z.accounts)===null||W===void 0?void 0:W.id)===null||te===void 0||te.prompt(F.current)),()=>{var V,G,J;t&&((J=(G=(V=window==null?void 0:window.google)===null||V===void 0?void 0:V.accounts)===null||G===void 0?void 0:G.id)===null||J===void 0||J.cancel())}},[T,R,t,a,o,l,d,f,u,h,P]),Pn.createElement("div",{...v,ref:k,style:{height:zP[l],...v==null?void 0:v.style}})}var Em={},BS;function UP(){if(BS)return Em;BS=1,Object.defineProperty(Em,"__esModule",{value:!0}),Em.parse=l,Em.serialize=u;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new o,k=b.length;if(k<2)return S;const T=(v==null?void 0:v.decode)||h;let P=0;do{const R=b.indexOf("=",P);if(R===-1)break;const I=b.indexOf(";",P),B=I===-1?k:I;if(R>B){P=b.lastIndexOf(";",R-1)+1;continue}const F=d(b,P,R),L=f(b,R,F),U=b.slice(F,L);if(S[U]===void 0){let H=d(b,R+1,B),K=f(b,B,H);const M=T(b.slice(H,K));S[U]=M}P=B+1}while(P<k);return S}function d(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function f(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function u(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let P=b+"="+T;if(!S)return P;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);P+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);P+="; Domain="+S.domain}if(S.path){if(!r.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);P+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);P+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(P+="; HttpOnly"),S.secure&&(P+="; Secure"),S.partitioned&&(P+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":P+="; Priority=Low";break;case"medium":P+="; Priority=Medium";break;case"high":P+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":P+="; SameSite=Strict";break;case"lax":P+="; SameSite=Lax";break;case"none":P+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return P}function h(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Em}UP();var US="popstate";function qP(e={}){function n(r,a){let{pathname:o,search:l,hash:d}=r.location;return d1("",{pathname:o,search:l,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Zm(a)}return HP(n,t,null,e)}function Sr(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function js(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function VP(){return Math.random().toString(36).substring(2,10)}function qS(e,n){return{usr:e.state,key:e.key,idx:n}}function d1(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Qh(n):n,state:t,key:n&&n.key||r||VP()}}function Zm({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Qh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function HP(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,l=a.history,d="POP",f=null,u=h();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function h(){return(l.state||{idx:null}).idx}function g(){d="POP";let T=h(),P=T==null?null:T-u;u=T,f&&f({action:d,location:k.location,delta:P})}function b(T,P){d="PUSH";let R=d1(k.location,T,P);u=h()+1;let I=qS(R,u),B=k.createHref(R);try{l.pushState(I,"",B)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(B)}o&&f&&f({action:d,location:k.location,delta:1})}function v(T,P){d="REPLACE";let R=d1(k.location,T,P);u=h();let I=qS(R,u),B=k.createHref(R);l.replaceState(I,"",B),o&&f&&f({action:d,location:k.location,delta:0})}function S(T){return GP(T)}let k={get action(){return d},get location(){return e(a,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(US,g),f=T,()=>{a.removeEventListener(US,g),f=null}},createHref(T){return n(a,T)},createURL:S,encodeLocation(T){let P=S(T);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:b,replace:v,go(T){return l.go(T)}};return k}function GP(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Sr(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Zm(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function ik(e,n,t="/"){return YP(e,n,t,!1)}function YP(e,n,t,r){let a=typeof n=="string"?Qh(n):n,o=cc(a.pathname||"/",t);if(o==null)return null;let l=ak(e);WP(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let u=aD(o);d=rD(l[f],u,r)}return d}function ak(e,n=[],t=[],r=""){let a=(o,l,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(Sr(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length));let u=oc([r,f.relativePath]),h=t.concat(f);o.children&&o.children.length>0&&(Sr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),ak(o.children,n,h,u)),!(o.path==null&&!o.index)&&n.push({path:u,score:tD(u,o.index),routesMeta:h})};return e.forEach((o,l)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))a(o,l);else for(let f of sk(o.path))a(o,l,f)}),n}function sk(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let l=sk(r.join("/")),d=[];return d.push(...l.map(f=>f===""?o:[o,f].join("/"))),a&&d.push(...l),d.map(f=>e.startsWith("/")&&f===""?"/":f)}function WP(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:nD(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var QP=/^:[\w-]+$/,JP=3,KP=2,XP=1,ZP=10,eD=-2,VS=e=>e==="*";function tD(e,n){let t=e.split("/"),r=t.length;return t.some(VS)&&(r+=eD),n&&(r+=KP),t.filter(a=>!VS(a)).reduce((a,o)=>a+(QP.test(o)?JP:o===""?XP:ZP),r)}function nD(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function rD(e,n,t=!1){let{routesMeta:r}=e,a={},o="/",l=[];for(let d=0;d<r.length;++d){let f=r[d],u=d===r.length-1,h=o==="/"?n:n.slice(o.length)||"/",g=eb({path:f.relativePath,caseSensitive:f.caseSensitive,end:u},h),b=f.route;if(!g&&u&&t&&!r[r.length-1].route.index&&(g=eb({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},h)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:oc([o,g.pathname]),pathnameBase:cD(oc([o,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(o=oc([o,g.pathnameBase]))}return l}function eb(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=iD(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:r.reduce((u,{paramName:h,isOptional:g},b)=>{if(h==="*"){let S=d[b]||"";l=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const v=d[b];return g&&!v?u[h]=void 0:u[h]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:l,pattern:e}}function iD(e,n=!1,t=!0){js(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function aD(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return js(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function cc(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function sD(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Qh(e):e;return{pathname:t?t.startsWith("/")?t:oD(t,n):n,search:uD(r),hash:dD(a)}}function oD(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function e0(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function lD(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function xw(e){let n=lD(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function bw(e,n,t,r=!1){let a;typeof e=="string"?a=Qh(e):(a={...e},Sr(!a.pathname||!a.pathname.includes("?"),e0("?","pathname","search",a)),Sr(!a.pathname||!a.pathname.includes("#"),e0("#","pathname","hash",a)),Sr(!a.search||!a.search.includes("#"),e0("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,d;if(l==null)d=t;else{let g=n.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}d=g>=0?n[g]:"/"}let f=sD(a,d),u=l&&l!=="/"&&l.endsWith("/"),h=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(u||h)&&(f.pathname+="/"),f}var oc=e=>e.join("/").replace(/\/\/+/g,"/"),cD=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),uD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,dD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function fD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var ok=["POST","PUT","PATCH","DELETE"];new Set(ok);var hD=["GET",...ok];new Set(hD);var Jh=w.createContext(null);Jh.displayName="DataRouter";var jb=w.createContext(null);jb.displayName="DataRouterState";var lk=w.createContext({isTransitioning:!1});lk.displayName="ViewTransition";var pD=w.createContext(new Map);pD.displayName="Fetchers";var mD=w.createContext(null);mD.displayName="Await";var yo=w.createContext(null);yo.displayName="Navigation";var cg=w.createContext(null);cg.displayName="Location";var Es=w.createContext({outlet:null,matches:[],isDataRoute:!1});Es.displayName="Route";var vw=w.createContext(null);vw.displayName="RouteError";function gD(e,{relative:n}={}){Sr(Kh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(yo),{hash:a,pathname:o,search:l}=ug(e,{relative:n}),d=o;return t!=="/"&&(d=o==="/"?t:oc([t,o])),r.createHref({pathname:d,search:l,hash:a})}function Kh(){return w.useContext(cg)!=null}function Ur(){return Sr(Kh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(cg).location}var ck="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function uk(e){w.useContext(yo).static||w.useLayoutEffect(e)}function Dt(){let{isDataRoute:e}=w.useContext(Es);return e?PD():yD()}function yD(){Sr(Kh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(Jh),{basename:n,navigator:t}=w.useContext(yo),{matches:r}=w.useContext(Es),{pathname:a}=Ur(),o=JSON.stringify(xw(r)),l=w.useRef(!1);return uk(()=>{l.current=!0}),w.useCallback((f,u={})=>{if(js(l.current,ck),!l.current)return;if(typeof f=="number"){t.go(f);return}let h=bw(f,JSON.parse(o),a,u.relative==="path");e==null&&n!=="/"&&(h.pathname=h.pathname==="/"?n:oc([n,h.pathname])),(u.replace?t.replace:t.push)(h,u.state,u)},[n,t,o,a,e])}var xD=w.createContext(null);function bD(e){let n=w.useContext(Es).outlet;return n&&w.createElement(xD.Provider,{value:e},n)}function ra(){let{matches:e}=w.useContext(Es),n=e[e.length-1];return n?n.params:{}}function ug(e,{relative:n}={}){let{matches:t}=w.useContext(Es),{pathname:r}=Ur(),a=JSON.stringify(xw(t));return w.useMemo(()=>bw(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function vD(e,n){return dk(e,n)}function dk(e,n,t,r){var R;Sr(Kh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=w.useContext(yo),{matches:l}=w.useContext(Es),d=l[l.length-1],f=d?d.params:{},u=d?d.pathname:"/",h=d?d.pathnameBase:"/",g=d&&d.route;{let I=g&&g.path||"";fk(u,!g||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let b=Ur(),v;if(n){let I=typeof n=="string"?Qh(n):n;Sr(h==="/"||((R=I.pathname)==null?void 0:R.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${I.pathname}" was given in the \`location\` prop.`),v=I}else v=b;let S=v.pathname||"/",k=S;if(h!=="/"){let I=h.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(I.length).join("/")}let T=!o&&t&&t.matches&&t.matches.length>0?t.matches:ik(e,{pathname:k});js(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),js(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let P=_D(T&&T.map(I=>Object.assign({},I,{params:Object.assign({},f,I.params),pathname:oc([h,a.encodeLocation?a.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?h:oc([h,a.encodeLocation?a.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),l,t,r);return n&&P?w.createElement(cg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},P):P}function wD(){let e=AD(),n=fD(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:o},"ErrorBoundary")," or"," ",w.createElement("code",{style:o},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var SD=w.createElement(wD,null),ND=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(Es.Provider,{value:this.props.routeContext},w.createElement(vw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function CD({routeContext:e,match:n,children:t}){let r=w.useContext(Jh);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Es.Provider,{value:e},t)}function _D(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,o=t==null?void 0:t.errors;if(o!=null){let f=a.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);Sr(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,d=-1;if(t)for(let f=0;f<a.length;f++){let u=a[f];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=f),u.route.id){let{loaderData:h,errors:g}=t,b=u.route.loader&&!h.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||b){l=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,u,h)=>{let g,b=!1,v=null,S=null;t&&(g=o&&u.route.id?o[u.route.id]:void 0,v=u.route.errorElement||SD,l&&(d<0&&h===0?(fk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):d===h&&(b=!0,S=u.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,h+1)),T=()=>{let P;return g?P=v:b?P=S:u.route.Component?P=w.createElement(u.route.Component,null):u.route.element?P=u.route.element:P=f,w.createElement(CD,{match:u,routeContext:{outlet:f,matches:k,isDataRoute:t!=null},children:P})};return t&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?w.createElement(ND,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function ww(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jD(e){let n=w.useContext(Jh);return Sr(n,ww(e)),n}function kD(e){let n=w.useContext(jb);return Sr(n,ww(e)),n}function TD(e){let n=w.useContext(Es);return Sr(n,ww(e)),n}function Sw(e){let n=TD(e),t=n.matches[n.matches.length-1];return Sr(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function ED(){return Sw("useRouteId")}function AD(){var r;let e=w.useContext(vw),n=kD("useRouteError"),t=Sw("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function PD(){let{router:e}=jD("useNavigate"),n=Sw("useNavigate"),t=w.useRef(!1);return uk(()=>{t.current=!0}),w.useCallback(async(a,o={})=>{js(t.current,ck),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...o}))},[e,n])}var HS={};function fk(e,n,t){!n&&!HS[e]&&(HS[e]=!0,js(!1,t))}w.memo(DD);function DD({routes:e,future:n,state:t}){return dk(e,void 0,t,n)}function _n({to:e,replace:n,state:t,relative:r}){Sr(Kh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(yo);js(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=w.useContext(Es),{pathname:l}=Ur(),d=Dt(),f=bw(e,xw(o),l,r==="path"),u=JSON.stringify(f);return w.useEffect(()=>{d(JSON.parse(u),{replace:n,state:t,relative:r})},[d,u,r,n,t]),null}function ID(e){return bD(e.context)}function gt(e){Sr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function RD({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:o=!1}){Sr(!Kh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=Qh(t));let{pathname:f="/",search:u="",hash:h="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=cc(f,l);return S==null?null:{location:{pathname:S,search:u,hash:h,state:g,key:b},navigationType:r}},[l,f,u,h,g,b,r]);return js(v!=null,`<Router basename="${l}"> is not able to match the URL "${f}${u}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(yo.Provider,{value:d},w.createElement(cg.Provider,{children:n,value:v}))}function Dh({children:e,location:n}){return vD(f1(e),n)}function f1(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let o=[...n,a];if(r.type===w.Fragment){t.push.apply(t,f1(r.props.children,o));return}Sr(r.type===gt,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Sr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=f1(r.props.children,o)),t.push(l)}),t}var Bx="get",Ux="application/x-www-form-urlencoded";function kb(e){return e!=null&&typeof e.tagName=="string"}function MD(e){return kb(e)&&e.tagName.toLowerCase()==="button"}function OD(e){return kb(e)&&e.tagName.toLowerCase()==="form"}function LD(e){return kb(e)&&e.tagName.toLowerCase()==="input"}function FD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function $D(e,n){return e.button===0&&(!n||n==="_self")&&!FD(e)}function h1(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((n,t)=>{let r=e[t];return n.concat(Array.isArray(r)?r.map(a=>[t,a]):[[t,r]])},[]))}function zD(e,n){let t=h1(e);return n&&n.forEach((r,a)=>{t.has(a)||n.getAll(a).forEach(o=>{t.append(a,o)})}),t}var gx=null;function BD(){if(gx===null)try{new FormData(document.createElement("form"),0),gx=!1}catch{gx=!0}return gx}var UD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function t0(e){return e!=null&&!UD.has(e)?(js(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ux}"`),null):e}function qD(e,n){let t,r,a,o,l;if(OD(e)){let d=e.getAttribute("action");r=d?cc(d,n):null,t=e.getAttribute("method")||Bx,a=t0(e.getAttribute("enctype"))||Ux,o=new FormData(e)}else if(MD(e)||LD(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||d.getAttribute("action");if(r=f?cc(f,n):null,t=e.getAttribute("formmethod")||d.getAttribute("method")||Bx,a=t0(e.getAttribute("formenctype"))||t0(d.getAttribute("enctype"))||Ux,o=new FormData(d,e),!BD()){let{name:u,type:h,value:g}=e;if(h==="image"){let b=u?`${u}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else u&&o.append(u,g)}}else{if(kb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Bx,r=null,a=Ux,l=e}return o&&a==="text/plain"&&(l=o,o=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:o,body:l}}function Nw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function VD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function HD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function GD(e,n,t){let r=await Promise.all(e.map(async a=>{let o=n.routes[a.route.id];if(o){let l=await VD(o,t);return l.links?l.links():[]}return[]}));return JD(r.flat(1).filter(HD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function GS(e,n,t,r,a,o){let l=(f,u)=>t[u]?f.route.id!==t[u].route.id:!0,d=(f,u)=>{var h;return t[u].pathname!==f.pathname||((h=t[u].route.path)==null?void 0:h.endsWith("*"))&&t[u].params["*"]!==f.params["*"]};return o==="assets"?n.filter((f,u)=>l(f,u)||d(f,u)):o==="data"?n.filter((f,u)=>{var g;let h=r.routes[f.route.id];if(!h||!h.hasLoader)return!1;if(l(f,u)||d(f,u))return!0;if(f.route.shouldRevalidate){let b=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function YD(e,n,{includeHydrateFallback:t}={}){return WD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function WD(e){return[...new Set(e)]}function QD(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function JD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let o=JSON.stringify(QD(a));return t.has(o)||(t.add(o),r.push({key:o,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var KD=new Set([100,101,204,205]);function XD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&cc(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function hk(){let e=w.useContext(Jh);return Nw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function ZD(){let e=w.useContext(jb);return Nw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Cw=w.createContext(void 0);Cw.displayName="FrameworkContext";function pk(){let e=w.useContext(Cw);return Nw(e,"You must render this element inside a <HydratedRouter> element"),e}function eI(e,n){let t=w.useContext(Cw),[r,a]=w.useState(!1),[o,l]=w.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:u,onMouseLeave:h,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=P=>{P.forEach(R=>{l(R.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[o,b,{}]:[o,b,{onFocus:Am(d,v),onBlur:Am(f,S),onMouseEnter:Am(u,v),onMouseLeave:Am(h,S),onTouchStart:Am(g,v)}]:[!1,b,{}]}function Am(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function tI({page:e,...n}){let{router:t}=hk(),r=w.useMemo(()=>ik(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(rI,{page:e,matches:r,...n}):null}function nI(e){let{manifest:n,routeModules:t}=pk(),[r,a]=w.useState([]);return w.useEffect(()=>{let o=!1;return GD(e,n,t).then(l=>{o||a(l)}),()=>{o=!0}},[e,n,t]),r}function rI({page:e,matches:n,...t}){let r=Ur(),{manifest:a,routeModules:o}=pk(),{basename:l}=hk(),{loaderData:d,matches:f}=ZD(),u=w.useMemo(()=>GS(e,n,f,a,r,"data"),[e,n,f,a,r]),h=w.useMemo(()=>GS(e,n,f,a,r,"assets"),[e,n,f,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let S=new Set,k=!1;if(n.forEach(P=>{var I;let R=a.routes[P.route.id];!R||!R.hasLoader||(!u.some(B=>B.route.id===P.route.id)&&P.route.id in d&&((I=o[P.route.id])!=null&&I.shouldRevalidate)||R.hasClientLoader?k=!0:S.add(P.route.id))}),S.size===0)return[];let T=XD(e,l);return k&&S.size>0&&T.searchParams.set("_routes",n.filter(P=>S.has(P.route.id)).map(P=>P.route.id).join(",")),[T.pathname+T.search]},[l,d,r,a,u,n,e,o]),b=w.useMemo(()=>YD(h,a),[h,a]),v=nI(h);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function iI(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var mk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{mk&&(window.__reactRouterVersion="7.6.0")}catch{}function aI({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=qP({window:t,v5Compat:!0}));let a=r.current,[o,l]=w.useState({action:a.action,location:a.location}),d=w.useCallback(f=>{w.startTransition(()=>l(f))},[l]);return w.useLayoutEffect(()=>a.listen(d),[a,d]),w.createElement(RD,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}var gk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ks=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:o,replace:l,state:d,target:f,to:u,preventScrollReset:h,viewTransition:g,...b},v){let{basename:S}=w.useContext(yo),k=typeof u=="string"&&gk.test(u),T,P=!1;if(typeof u=="string"&&k&&(T=u,mk))try{let K=new URL(window.location.href),M=u.startsWith("//")?new URL(K.protocol+u):new URL(u),$=cc(M.pathname,S);M.origin===K.origin&&$!=null?u=$+M.search+M.hash:P=!0}catch{js(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let R=gD(u,{relative:a}),[I,B,F]=eI(r,b),L=cI(u,{replace:l,state:d,target:f,preventScrollReset:h,relative:a,viewTransition:g});function U(K){n&&n(K),K.defaultPrevented||L(K)}let H=w.createElement("a",{...b,...F,href:T||R,onClick:P||o?n:U,ref:iI(v,B),target:f,"data-discover":!k&&t==="render"?"true":void 0});return I&&!k?w.createElement(w.Fragment,null,H,w.createElement(tI,{page:R})):H});ks.displayName="Link";var sI=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:o,to:l,viewTransition:d,children:f,...u},h){let g=ug(l,{relative:u.relative}),b=Ur(),v=w.useContext(jb),{navigator:S,basename:k}=w.useContext(yo),T=v!=null&&mI(g)&&d===!0,P=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,R=b.pathname,I=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(R=R.toLowerCase(),I=I?I.toLowerCase():null,P=P.toLowerCase()),I&&k&&(I=cc(I,k)||I);const B=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let F=R===P||!a&&R.startsWith(P)&&R.charAt(B)==="/",L=I!=null&&(I===P||!a&&I.startsWith(P)&&I.charAt(P.length)==="/"),U={isActive:F,isPending:L,isTransitioning:T},H=F?n:void 0,K;typeof r=="function"?K=r(U):K=[r,F?"active":null,L?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let M=typeof o=="function"?o(U):o;return w.createElement(ks,{...u,"aria-current":H,className:K,ref:h,style:M,to:l,viewTransition:d},typeof f=="function"?f(U):f)});sI.displayName="NavLink";var oI=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:o,method:l=Bx,action:d,onSubmit:f,relative:u,preventScrollReset:h,viewTransition:g,...b},v)=>{let S=hI(),k=pI(d,{relative:u}),T=l.toLowerCase()==="get"?"get":"post",P=typeof d=="string"&&gk.test(d),R=I=>{if(f&&f(I),I.defaultPrevented)return;I.preventDefault();let B=I.nativeEvent.submitter,F=(B==null?void 0:B.getAttribute("formmethod"))||l;S(B||I.currentTarget,{fetcherKey:n,method:F,navigate:t,replace:a,state:o,relative:u,preventScrollReset:h,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:r?f:R,...b,"data-discover":!P&&e==="render"?"true":void 0})});oI.displayName="Form";function lI(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yk(e){let n=w.useContext(Jh);return Sr(n,lI(e)),n}function cI(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:o,viewTransition:l}={}){let d=Dt(),f=Ur(),u=ug(e,{relative:o});return w.useCallback(h=>{if($D(h,n)){h.preventDefault();let g=t!==void 0?t:Zm(f)===Zm(u);d(e,{replace:g,state:r,preventScrollReset:a,relative:o,viewTransition:l})}},[f,d,u,t,r,n,e,a,o,l])}function uI(e){js(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let n=w.useRef(h1(e)),t=w.useRef(!1),r=Ur(),a=w.useMemo(()=>zD(r.search,t.current?null:n.current),[r.search]),o=Dt(),l=w.useCallback((d,f)=>{const u=h1(typeof d=="function"?d(a):d);t.current=!0,o("?"+u,f)},[o,a]);return[a,l]}var dI=0,fI=()=>`__${String(++dI)}__`;function hI(){let{router:e}=yk("useSubmit"),{basename:n}=w.useContext(yo),t=ED();return w.useCallback(async(r,a={})=>{let{action:o,method:l,encType:d,formData:f,body:u}=qD(r,n);if(a.navigate===!1){let h=a.fetcherKey||fI();await e.fetch(h,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function pI(e,{relative:n}={}){let{basename:t}=w.useContext(yo),r=w.useContext(Es);Sr(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...ug(e||".",{relative:n})},l=Ur();if(e==null){o.search=l.search;let d=new URLSearchParams(o.search),f=d.getAll("index");if(f.some(h=>h==="")){d.delete("index"),f.filter(g=>g).forEach(g=>d.append("index",g));let h=d.toString();o.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:oc([t,o.pathname])),Zm(o)}function mI(e,n={}){let t=w.useContext(lk);Sr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=yk("useViewTransitionState"),a=ug(e,{relative:n.relative});if(!t.isTransitioning)return!1;let o=cc(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=cc(t.nextLocation.pathname,r)||t.nextLocation.pathname;return eb(a.pathname,l)!=null||eb(a.pathname,o)!=null}[...KD];var gI=nk();class yI extends w.Component{constructor(){super(...arguments);nr(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}const xk=w.createContext(void 0),xI=({children:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState({startDate:null,endDate:null}),[o,l]=w.useState(null),[d,f]=w.useState(null),[u,h]=w.useState(null),g=w.useCallback(()=>t(!0),[]),b=w.useCallback(()=>t(!1),[]),v=w.useCallback(()=>t(B=>!B),[]),S=w.useCallback(B=>{h(()=>B)},[]),k=w.useCallback(B=>{u?u(B):console.warn("Analysis navigator not registered")},[u]),[T,P]=w.useState(null),R=w.useCallback(B=>{P(()=>B)},[]),I=w.useCallback(async()=>T?await T():(console.warn("Analysis refresher not registered"),null),[T]);return i.jsx(xk.Provider,{value:{isOpen:n,openAssistant:g,closeAssistant:b,toggleAssistant:v,analysisDateRange:r,setAnalysisDateRange:a,analysisData:o,setAnalysisData:l,analysisNavigate:k,registerAnalysisNavigator:S,refreshAnalysis:I,registerAnalysisRefresher:R,pageContext:d,setPageContext:f},children:e})},Tb=()=>{const e=w.useContext(xk);if(e===void 0)throw new Error("useClinicAssistantContext must be used within a ClinicAssistantProvider");return e},bk=w.createContext(void 0),bI=({children:e})=>{const[n,t]=w.useState([]),[r,a]=w.useState(null),[o,l]=w.useState(""),[d,f]=w.useState(0),[u,h]=w.useState([]),g=w.useCallback(k=>{t(T=>[...T,k])},[]),b=w.useCallback((k,T)=>{t(P=>P.map(R=>R.id===k?{...R,...T}:R))},[]),v=w.useCallback(k=>{t(T=>T.filter(P=>P.id!==k))},[]),S=w.useCallback(()=>{t([]),a(null),l(""),f(0),h([])},[]);return i.jsx(bk.Provider,{value:{purchaseRows:n,setPurchaseRows:t,selectedDistributor:r,setSelectedDistributor:a,searchTerm:o,setSearchTerm:l,amountPaidToDistributor:d,setAmountPaidToDistributor:f,distributors:u,setDistributors:h,addPurchaseRow:g,updatePurchaseRow:b,removePurchaseRow:v,resetPurchase:S},children:e})},vk=()=>{const e=w.useContext(bk);if(!e)throw new Error("usePurchaseContext must be used within a PurchaseProvider");return e},wk=w.createContext(void 0),vI=({children:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(""),o=w.useCallback(()=>t(!0),[]),l=w.useCallback(()=>t(!1),[]),d=w.useCallback(()=>t(f=>!f),[]);return w.useEffect(()=>{const f=u=>{(u.ctrlKey||u.metaKey)&&u.key==="k"&&(u.preventDefault(),d()),u.key==="Escape"&&n&&l()};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[n,d,l]),i.jsx(wk.Provider,{value:{isOpen:n,openCommandBar:o,closeCommandBar:l,toggleCommandBar:d,preFilledQuery:r,setPreFilledQuery:a},children:e})},Uh=()=>{const e=w.useContext(wk);if(e===void 0)throw new Error("useCommandBar must be used within a CommandBarProvider");return e};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let wI,SI;function NI(){return{geminiUrl:wI,vertexUrl:SI}}function CI(e,n,t){var r,a,o;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=NI();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(o=l.geminiUrl)!==null&&o!==void 0?o:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dg{}function Ht(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const o=n[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function _(e,n,t){for(let o=0;o<n.length-1;o++){const l=n[o];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in e))if(Array.isArray(t))e[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[d])){const f=e[d];if(Array.isArray(t))for(let u=0;u<f.length;u++){const h=f[u];_(h,n.slice(o+1),t[u])}else for(const u of f)_(u,n.slice(o+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in e||(e[d]=[{}]);const f=e[d];_(f[0],n.slice(o+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const o=e[a];return Array.isArray(o)?o.map(l=>C(l,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nr(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function Sk(e,n){const t=Nr(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function Nk(e,n){return Array.isArray(n)?n.map(t=>tb(e,t)):[tb(e,n)]}function tb(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function _I(e,n){const t=tb(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function jI(e,n){const t=tb(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function YS(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function Ck(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>YS(e,t)):[YS(e,n)]}function p1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function WS(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function QS(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function wa(e,n){if(n==null)throw new Error("ContentUnion is required");return p1(n)?n:{role:"user",parts:Ck(e,n)}}function _k(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=wa(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=wa(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>wa(e,t)):[wa(e,n)]}function Su(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(WS(n)||QS(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[wa(e,n)]}const t=[],r=[],a=p1(n[0]);for(const o of n){const l=p1(o);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(o);else{if(WS(o)||QS(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(o)}}return a||t.push({role:"user",parts:Ck(e,r)}),t}function jk(e,n){return n}function kk(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Eb(e,n){return n}function Ab(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function kI(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function Nu(e,n){if(typeof n!="string")throw new Error("name must be a string");return kI(e,n,"cachedContents")}function Tk(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Cu(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function TI(e){return e!=null&&typeof e=="object"&&"name"in e}function EI(e){return e!=null&&typeof e=="object"&&"video"in e}function AI(e){return e!=null&&typeof e=="object"&&"uri"in e}function Ek(e,n){var t;let r;if(TI(n)&&(r=n.name),!(AI(n)&&(r=n.uri,r===void 0))&&!(EI(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const o=r.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${r}`);r=o[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function Ak(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function Pk(e,n){for(const t of["models","tunedModels","publisherModels"])if(PI(n,t))return n[t];return[]}function PI(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DI(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function II(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],DI(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function JS(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>II(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function RI(){return{}}function MI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function OI(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],MI(e,r)),t}function LI(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],RI());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],OI(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function FI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function $I(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],FI(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function zI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=Su(e,d);Array.isArray(g)&&(g=g.map(b=>JS(e,b))),_(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&_(t,["systemInstruction"],JS(e,wa(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>LI(e,b))),_(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&_(t,["toolConfig"],$I(e,h)),r}function BI(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],Sk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],zI(e,a,t)),t}function UI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],Nu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function qI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],Nu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function VI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function HI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],Nu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],VI(e,a,t)),t}function GI(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function YI(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],GI(e,r,t)),t}function WI(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function QI(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],WI(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function KS(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>QI(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function JI(){return{}}function KI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function XI(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],KI(e,r)),t}function ZI(){return{}}function eR(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function tR(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],eR(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function nR(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],tR(e,r)),t}function rR(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],JI());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],XI(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],ZI());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],nR(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function iR(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function aR(e,n){const t={},r=C(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function sR(e,n){const t={},r=C(n,["latLng"]);return r!=null&&_(t,["latLng"],aR(e,r)),t}function oR(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],iR(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],sR(e,a)),t}function lR(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=Su(e,d);Array.isArray(g)&&(g=g.map(b=>KS(e,b))),_(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&_(t,["systemInstruction"],KS(e,wa(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>rR(e,b))),_(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&_(t,["toolConfig"],oR(e,h)),r}function cR(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],Sk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],lR(e,a,t)),t}function uR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],Nu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function dR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],Nu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function fR(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function hR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],Nu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],fR(e,a,t)),t}function pR(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function mR(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],pR(e,r,t)),t}function qx(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["model"]);o!=null&&_(t,["model"],o);const l=C(n,["createTime"]);l!=null&&_(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&_(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function gR(){return{}}function yR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>qx(e,l))),_(t,["cachedContents"],o)}return t}function Vx(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["model"]);o!=null&&_(t,["model"],o);const l=C(n,["createTime"]);l!=null&&_(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&_(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function xR(){return{}}function bR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Vx(e,l))),_(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var qh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(qh||(qh={}));class Pb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,o;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var XS;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(XS||(XS={}));var ZS;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(ZS||(ZS={}));var eN;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(eN||(eN={}));var tN;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(tN||(tN={}));var nN;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(nN||(nN={}));var rN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(rN||(rN={}));var iN;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(iN||(iN={}));var Vh;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Vh||(Vh={}));var aN;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(aN||(aN={}));var sN;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(sN||(sN={}));var oN;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(oN||(oN={}));var lN;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(lN||(lN={}));var cN;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(cN||(cN={}));var bu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(bu||(bu={}));var uN;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(uN||(uN={}));var m1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(m1||(m1={}));var dN;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(dN||(dN={}));var fN;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(fN||(fN={}));var hN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(hN||(hN={}));var pN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(pN||(pN={}));var mN;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(mN||(mN={}));var gN;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(gN||(gN={}));var yN;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(yN||(yN={}));var xN;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(xN||(xN={}));var bN;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(bN||(bN={}));var vN;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(vN||(vN={}));var wN;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(wN||(wN={}));var SN;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(SN||(SN={}));var NN;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(NN||(NN={}));var CN;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(CN||(CN={}));var _N;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(_N||(_N={}));var jN;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(jN||(jN={}));var kN;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(kN||(kN={}));var TN;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(TN||(TN={}));class yx{get text(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",h=!1;const g=[];for(const b of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;h=!0,u+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?u:void 0}get data(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const h=[];for(const g of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&h.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(u+=atob(g.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.output}}class EN{}class AN{}class vR{}class wR{}class PN{}class DN{}class IN{}class SR{}class RN{}class MN{}class ON{}class NR{}class g1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class CR{}class _R{}class jR{get text(){var n,t,r;let a="",o=!1;const l=[];for(const d of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,u]of Object.entries(d))f!=="text"&&f!=="thought"&&u!==null&&l.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;o=!0,a+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var n,t,r;let a="";const o=[];for(const l of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(l))d!=="inlineData"&&f!==null&&o.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kR extends dg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Pb(qh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=cR(this.apiClient,n);return d=Ht("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>Vx(this.apiClient,h))}else{const u=BI(this.apiClient,n);return d=Ht("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>qx(this.apiClient,h))}}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=uR(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>Vx(this.apiClient,h))}else{const u=UI(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>qx(this.apiClient,h))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=dR(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=xR(),g=new MN;return Object.assign(g,h),g})}else{const u=qI(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(()=>{const h=gR(),g=new MN;return Object.assign(g,h),g})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=hR(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>Vx(this.apiClient,h))}else{const u=HI(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>qx(this.apiClient,h))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=mR(this.apiClient,n);return d=Ht("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=bR(this.apiClient,h),b=new ON;return Object.assign(b,g),b})}else{const u=YI(this.apiClient,n);return d=Ht("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=yR(this.apiClient,h),b=new ON;return Object.assign(b,g),b})}}}function LN(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fi(e){return this instanceof Fi?(this.v=e,this):new Fi(e)}function nb(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function d(v,S){r[v]&&(a[v]=function(k){return new Promise(function(T,P){o.push([v,k,T,P])>1||f(v,k)})},S&&(a[v]=S(a[v])))}function f(v,S){try{u(r[v](S))}catch(k){b(o[0][3],k)}}function u(v){v.value instanceof Fi?Promise.resolve(v.value.v).then(h,g):b(o[0][2],v)}function h(v){f("next",v)}function g(v){f("throw",v)}function b(v,S){v(S),o.shift(),o.length&&f(o[0][0],o[0][1])}}function y1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof LN=="function"?LN(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=e[o]&&function(l){return new Promise(function(d,f){l=e[o](l),a(d,f,l.done,l.value)})}}function a(o,l,d,f){Promise.resolve(f).then(function(u){o({value:u,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TR(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:Dk(t)}function Dk(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function ER(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function AR(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const o=[];let l=!0;for(;r<t&&e[r].role==="model";)o.push(e[r]),l&&!Dk(e[r])&&(l=!1),r++;l&&(n.push(a),n.push(...o))}return n}class PR{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new DR(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class DR{constructor(n,t,r,a={},o=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),ER(o)}async sendMessage(n){var t;await this.sendPromise;const r=wa(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l;const f=(l=(o=(await a).candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,u=f?[f]:[];this.recordHistory(r,u)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=wa(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,r)}getHistory(n=!1){return n?AR(this.history):this.history}processStreamResponse(n,t){var r,a;return nb(this,arguments,function*(){var l,d,f,u;const h=[];try{for(var g=!0,b=y1(n),v;v=yield Fi(b.next()),l=v.done,!l;g=!0){u=v.value,g=!1;const S=u;if(TR(S)){const k=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&h.push(k)}yield yield Fi(S)}}catch(S){d={error:S}}finally{try{!g&&!l&&(f=b.return)&&(yield Fi(f.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,h)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IR(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function RR(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],IR(e,r,t)),t}function MR(e,n){const t={},r=C(n,["details"]);r!=null&&_(t,["details"],r);const a=C(n,["message"]);a!=null&&_(t,["message"],a);const o=C(n,["code"]);return o!=null&&_(t,["code"],o),t}function OR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&_(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&_(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const h=C(n,["sha256Hash"]);h!=null&&_(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&_(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&_(t,["state"],v);const S=C(n,["source"]);S!=null&&_(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&_(t,["error"],MR(e,T)),t}function LR(e,n){const t={},r=C(n,["file"]);r!=null&&_(t,["file"],OR(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function FR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","file"],Ek(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function $R(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","file"],Ek(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function zR(e,n){const t={},r=C(n,["details"]);r!=null&&_(t,["details"],r);const a=C(n,["message"]);a!=null&&_(t,["message"],a);const o=C(n,["code"]);return o!=null&&_(t,["code"],o),t}function x1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&_(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&_(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const h=C(n,["sha256Hash"]);h!=null&&_(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&_(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&_(t,["state"],v);const S=C(n,["source"]);S!=null&&_(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&_(t,["error"],zR(e,T)),t}function BR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["files"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>x1(e,l))),_(t,["files"],o)}return t}function UR(){return{}}function qR(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VR extends dg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Pb(qh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>x1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=RR(this.apiClient,n);return o=Ht("files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=BR(this.apiClient,f),h=new NR;return Object.assign(h,u),h})}}async createInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=LR(this.apiClient,n);return o=Ht("upload/v1beta/files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=UR(),u=new CR;return Object.assign(u,f),u})}}async get(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=FR(this.apiClient,n);return o=Ht("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>x1(this.apiClient,f))}}async delete(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=$R(this.apiClient,n);return o=Ht("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=qR(),u=new _R;return Object.assign(u,f),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HR(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function GR(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function YR(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],HR(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function WR(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],GR(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function QR(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>YR(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function JR(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>WR(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function KR(){return{}}function XR(){return{}}function ZR(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function eM(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function tM(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],ZR(e,r)),t}function nM(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],eM(e,r)),t}function rM(){return{}}function iM(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function aM(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],iM(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function sM(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],aM(e,r)),t}function oM(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],KR());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],tM(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function lM(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],XR());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],nM(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],rM());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],sM(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function cM(e,n){const t={},r=C(n,["handle"]);if(r!=null&&_(t,["handle"],r),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function uM(e,n){const t={},r=C(n,["handle"]);r!=null&&_(t,["handle"],r);const a=C(n,["transparent"]);return a!=null&&_(t,["transparent"],a),t}function FN(){return{}}function $N(){return{}}function dM(e,n){const t={},r=C(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&_(t,["silenceDurationMs"],d),t}function fM(e,n){const t={},r=C(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&_(t,["silenceDurationMs"],d),t}function hM(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],dM(e,r));const a=C(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function pM(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],fM(e,r));const a=C(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function mM(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function gM(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function yM(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],mM(e,a)),t}function xM(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],gM(e,a)),t}function bM(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],QR(e,wa(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let B=Ab(e,S);Array.isArray(B)&&(B=B.map(F=>oM(e,Eb(e,F)))),_(t,["setup","tools"],B)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],cM(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],FN());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&_(t,["setup","outputAudioTranscription"],FN());const R=C(n,["realtimeInputConfig"]);t!==void 0&&R!=null&&_(t,["setup","realtimeInputConfig"],hM(e,R));const I=C(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&_(t,["setup","contextWindowCompression"],yM(e,I)),r}function vM(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],JR(e,wa(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let B=Ab(e,S);Array.isArray(B)&&(B=B.map(F=>lM(e,Eb(e,F)))),_(t,["setup","tools"],B)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],uM(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],$N());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&_(t,["setup","outputAudioTranscription"],$N());const R=C(n,["realtimeInputConfig"]);t!==void 0&&R!=null&&_(t,["setup","realtimeInputConfig"],pM(e,R));const I=C(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&_(t,["setup","contextWindowCompression"],xM(e,I)),r}function wM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["setup","model"],Nr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],bM(e,a,t)),t}function SM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["setup","model"],Nr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],vM(e,a,t)),t}function NM(){return{}}function CM(){return{}}function _M(){return{}}function jM(){return{}}function kM(e,n){const t={},r=C(n,["media"]);r!=null&&_(t,["mediaChunks"],Nk(e,r));const a=C(n,["audio"]);a!=null&&_(t,["audio"],jI(e,a));const o=C(n,["audioStreamEnd"]);o!=null&&_(t,["audioStreamEnd"],o);const l=C(n,["video"]);l!=null&&_(t,["video"],_I(e,l));const d=C(n,["text"]);return d!=null&&_(t,["text"],d),C(n,["activityStart"])!=null&&_(t,["activityStart"],NM()),C(n,["activityEnd"])!=null&&_(t,["activityEnd"],_M()),t}function TM(e,n){const t={},r=C(n,["media"]);if(r!=null&&_(t,["mediaChunks"],Nk(e,r)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&_(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&_(t,["activityStart"],CM()),C(n,["activityEnd"])!=null&&_(t,["activityEnd"],jM()),t}function EM(){return{}}function AM(){return{}}function PM(e,n){const t={},r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function DM(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function IM(e,n){const t={},r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],PM(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function RM(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],DM(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function MM(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>IM(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function OM(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>RM(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function zN(e,n){const t={},r=C(n,["text"]);r!=null&&_(t,["text"],r);const a=C(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function BN(e,n){const t={},r=C(n,["text"]);r!=null&&_(t,["text"],r);const a=C(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function LM(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],MM(e,r));const a=C(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&_(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&_(t,["inputTranscription"],zN(e,f));const u=C(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],zN(e,u)),t}function FM(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],OM(e,r));const a=C(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&_(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&_(t,["inputTranscription"],BN(e,f));const u=C(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],BN(e,u)),t}function $M(e,n){const t={},r=C(n,["id"]);r!=null&&_(t,["id"],r);const a=C(n,["args"]);a!=null&&_(t,["args"],a);const o=C(n,["name"]);return o!=null&&_(t,["name"],o),t}function zM(e,n){const t={},r=C(n,["args"]);r!=null&&_(t,["args"],r);const a=C(n,["name"]);return a!=null&&_(t,["name"],a),t}function BM(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>$M(e,o))),_(t,["functionCalls"],a)}return t}function UM(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>zM(e,o))),_(t,["functionCalls"],a)}return t}function qM(e,n){const t={},r=C(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function VM(e,n){const t={},r=C(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function xx(e,n){const t={},r=C(n,["modality"]);r!=null&&_(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function bx(e,n){const t={},r=C(n,["modality"]);r!=null&&_(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function HM(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=C(n,["responseTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&_(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&_(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(S=>xx(e,S))),_(t,["promptTokensDetails"],v)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(S=>xx(e,S))),_(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>xx(e,S))),_(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>xx(e,S))),_(t,["toolUsePromptTokensDetails"],v)}return t}function GM(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=C(n,["candidatesTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&_(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&_(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(k=>bx(e,k))),_(t,["promptTokensDetails"],S)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(k=>bx(e,k))),_(t,["cacheTokensDetails"],S)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>bx(e,k))),_(t,["responseTokensDetails"],S)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>bx(e,k))),_(t,["toolUsePromptTokensDetails"],S)}const v=C(n,["trafficType"]);return v!=null&&_(t,["trafficType"],v),t}function YM(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function WM(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function QM(e,n){const t={},r=C(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function JM(e,n){const t={},r=C(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function KM(e,n){const t={};C(n,["setupComplete"])!=null&&_(t,["setupComplete"],EM());const a=C(n,["serverContent"]);a!=null&&_(t,["serverContent"],LM(e,a));const o=C(n,["toolCall"]);o!=null&&_(t,["toolCall"],BM(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],qM(e,l));const d=C(n,["usageMetadata"]);d!=null&&_(t,["usageMetadata"],HM(e,d));const f=C(n,["goAway"]);f!=null&&_(t,["goAway"],YM(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],QM(e,u)),t}function XM(e,n){const t={};C(n,["setupComplete"])!=null&&_(t,["setupComplete"],AM());const a=C(n,["serverContent"]);a!=null&&_(t,["serverContent"],FM(e,a));const o=C(n,["toolCall"]);o!=null&&_(t,["toolCall"],UM(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],VM(e,l));const d=C(n,["usageMetadata"]);d!=null&&_(t,["usageMetadata"],GM(e,d));const f=C(n,["goAway"]);f!=null&&_(t,["goAway"],WM(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],JM(e,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZM(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function e4(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],ZM(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function Db(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>e4(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function t4(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=C(n,["category"]);r!=null&&_(t,["category"],r);const a=C(n,["threshold"]);return a!=null&&_(t,["threshold"],a),t}function n4(){return{}}function r4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function i4(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],r4(e,r)),t}function a4(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],n4());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],i4(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function s4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function o4(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],s4(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function l4(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function c4(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],l4(e,r)),t}function u4(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],c4(e,r));const a=C(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function d4(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function f4(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Db(e,wa(e,a)));const o=C(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&_(r,["topP"],l);const d=C(n,["topK"]);d!=null&&_(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&_(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const h=C(n,["stopSequences"]);h!=null&&_(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&_(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const P=C(n,["responseSchema"]);if(P!=null&&_(r,["responseSchema"],jk(e,P)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=C(n,["safetySettings"]);if(t!==void 0&&R!=null){let M=R;Array.isArray(M)&&(M=M.map($=>t4(e,$))),_(t,["safetySettings"],M)}const I=C(n,["tools"]);if(t!==void 0&&I!=null){let M=Ab(e,I);Array.isArray(M)&&(M=M.map($=>a4(e,Eb(e,$)))),_(t,["tools"],M)}const B=C(n,["toolConfig"]);if(t!==void 0&&B!=null&&_(t,["toolConfig"],o4(e,B)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=C(n,["cachedContent"]);t!==void 0&&F!=null&&_(t,["cachedContent"],Nu(e,F));const L=C(n,["responseModalities"]);L!=null&&_(r,["responseModalities"],L);const U=C(n,["mediaResolution"]);U!=null&&_(r,["mediaResolution"],U);const H=C(n,["speechConfig"]);if(H!=null&&_(r,["speechConfig"],u4(e,kk(e,H))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const K=C(n,["thinkingConfig"]);return K!=null&&_(r,["thinkingConfig"],d4(e,K)),r}function UN(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Su(e,a);Array.isArray(l)&&(l=l.map(d=>Db(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["generationConfig"],f4(e,o,t)),t}function h4(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&_(t,["requests[]","taskType"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&_(t,["requests[]","title"],o);const l=C(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&_(t,["requests[]","outputDimensionality"],l),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function p4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["contents"]);a!=null&&_(t,["requests[]","content"],_k(e,a));const o=C(n,["config"]);o!=null&&_(t,["config"],h4(e,o,t));const l=C(n,["model"]);return l!==void 0&&_(t,["requests[]","model"],Nr(e,l)),t}function m4(e,n,t){const r={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=C(n,["aspectRatio"]);t!==void 0&&o!=null&&_(t,["parameters","aspectRatio"],o);const l=C(n,["guidanceScale"]);if(t!==void 0&&l!=null&&_(t,["parameters","guidanceScale"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=C(n,["safetyFilterLevel"]);t!==void 0&&d!=null&&_(t,["parameters","safetySetting"],d);const f=C(n,["personGeneration"]);t!==void 0&&f!=null&&_(t,["parameters","personGeneration"],f);const u=C(n,["includeSafetyAttributes"]);t!==void 0&&u!=null&&_(t,["parameters","includeSafetyAttributes"],u);const h=C(n,["includeRaiReason"]);t!==void 0&&h!=null&&_(t,["parameters","includeRaiReason"],h);const g=C(n,["language"]);t!==void 0&&g!=null&&_(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&_(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&_(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function g4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],m4(e,o,t)),t}function y4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],Nr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function x4(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&_(t,["_url","models_url"],Ak(e,d)),r}function b4(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],x4(e,r,t)),t}function v4(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function w4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],Nr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],v4(e,a,t)),t}function S4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],Nr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function N4(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function C4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Su(e,a);Array.isArray(l)&&(l=l.map(d=>Db(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],N4(e,o)),t}function _4(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["imageBytes"]);r!=null&&_(t,["bytesBase64Encoded"],Cu(e,r));const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function j4(e,n,t){const r={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=C(n,["durationSeconds"]);if(t!==void 0&&o!=null&&_(t,["parameters","durationSeconds"],o),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=C(n,["aspectRatio"]);if(t!==void 0&&l!=null&&_(t,["parameters","aspectRatio"],l),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const d=C(n,["personGeneration"]);if(t!==void 0&&d!=null&&_(t,["parameters","personGeneration"],d),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=C(n,["negativePrompt"]);if(t!==void 0&&f!=null&&_(t,["parameters","negativePrompt"],f),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function k4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&_(t,["instances[0]","image"],_4(e,o));const l=C(n,["config"]);return l!=null&&_(t,["config"],j4(e,l,t)),t}function T4(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function E4(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],T4(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function Xh(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>E4(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function A4(e,n){const t={},r=C(n,["featureSelectionPreference"]);return r!=null&&_(t,["featureSelectionPreference"],r),t}function P4(e,n){const t={},r=C(n,["method"]);r!=null&&_(t,["method"],r);const a=C(n,["category"]);a!=null&&_(t,["category"],a);const o=C(n,["threshold"]);return o!=null&&_(t,["threshold"],o),t}function D4(){return{}}function I4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function R4(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],I4(e,r)),t}function M4(){return{}}function O4(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function L4(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],O4(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function F4(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],L4(e,r)),t}function Ik(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],D4());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],R4(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],M4());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],F4(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function $4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function z4(e,n){const t={},r=C(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function B4(e,n){const t={},r=C(n,["latLng"]);return r!=null&&_(t,["latLng"],z4(e,r)),t}function U4(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],$4(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],B4(e,a)),t}function q4(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function V4(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],q4(e,r)),t}function H4(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],V4(e,r));const a=C(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function G4(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function Y4(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Xh(e,wa(e,a)));const o=C(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&_(r,["topP"],l);const d=C(n,["topK"]);d!=null&&_(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&_(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const h=C(n,["stopSequences"]);h!=null&&_(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&_(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const P=C(n,["responseSchema"]);P!=null&&_(r,["responseSchema"],jk(e,P));const R=C(n,["routingConfig"]);R!=null&&_(r,["routingConfig"],R);const I=C(n,["modelSelectionConfig"]);I!=null&&_(r,["modelConfig"],A4(e,I));const B=C(n,["safetySettings"]);if(t!==void 0&&B!=null){let te=B;Array.isArray(te)&&(te=te.map(V=>P4(e,V))),_(t,["safetySettings"],te)}const F=C(n,["tools"]);if(t!==void 0&&F!=null){let te=Ab(e,F);Array.isArray(te)&&(te=te.map(V=>Ik(e,Eb(e,V)))),_(t,["tools"],te)}const L=C(n,["toolConfig"]);t!==void 0&&L!=null&&_(t,["toolConfig"],U4(e,L));const U=C(n,["labels"]);t!==void 0&&U!=null&&_(t,["labels"],U);const H=C(n,["cachedContent"]);t!==void 0&&H!=null&&_(t,["cachedContent"],Nu(e,H));const K=C(n,["responseModalities"]);K!=null&&_(r,["responseModalities"],K);const M=C(n,["mediaResolution"]);M!=null&&_(r,["mediaResolution"],M);const $=C(n,["speechConfig"]);$!=null&&_(r,["speechConfig"],H4(e,kk(e,$)));const z=C(n,["audioTimestamp"]);z!=null&&_(r,["audioTimestamp"],z);const W=C(n,["thinkingConfig"]);return W!=null&&_(r,["thinkingConfig"],G4(e,W)),r}function qN(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Su(e,a);Array.isArray(l)&&(l=l.map(d=>Xh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["generationConfig"],Y4(e,o,t)),t}function W4(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&_(t,["instances[]","task_type"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&_(t,["instances[]","title"],o);const l=C(n,["outputDimensionality"]);t!==void 0&&l!=null&&_(t,["parameters","outputDimensionality"],l);const d=C(n,["mimeType"]);t!==void 0&&d!=null&&_(t,["instances[]","mimeType"],d);const f=C(n,["autoTruncate"]);return t!==void 0&&f!=null&&_(t,["parameters","autoTruncate"],f),r}function Q4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["contents"]);a!=null&&_(t,["instances[]","content"],_k(e,a));const o=C(n,["config"]);return o!=null&&_(t,["config"],W4(e,o,t)),t}function J4(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&_(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&_(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&_(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["addWatermark"]);t!==void 0&&P!=null&&_(t,["parameters","addWatermark"],P);const R=C(n,["enhancePrompt"]);return t!==void 0&&R!=null&&_(t,["parameters","enhancePrompt"],R),r}function K4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],J4(e,o,t)),t}function _w(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=C(n,["imageBytes"]);a!=null&&_(t,["bytesBase64Encoded"],Cu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function X4(e,n){const t={},r=C(n,["maskMode"]);r!=null&&_(t,["maskMode"],r);const a=C(n,["segmentationClasses"]);a!=null&&_(t,["maskClasses"],a);const o=C(n,["maskDilation"]);return o!=null&&_(t,["dilation"],o),t}function Z4(e,n){const t={},r=C(n,["controlType"]);r!=null&&_(t,["controlType"],r);const a=C(n,["enableControlImageComputation"]);return a!=null&&_(t,["computeControl"],a),t}function eO(e,n){const t={},r=C(n,["styleDescription"]);return r!=null&&_(t,["styleDescription"],r),t}function tO(e,n){const t={},r=C(n,["subjectType"]);r!=null&&_(t,["subjectType"],r);const a=C(n,["subjectDescription"]);return a!=null&&_(t,["subjectDescription"],a),t}function nO(e,n){const t={},r=C(n,["referenceImage"]);r!=null&&_(t,["referenceImage"],_w(e,r));const a=C(n,["referenceId"]);a!=null&&_(t,["referenceId"],a);const o=C(n,["referenceType"]);o!=null&&_(t,["referenceType"],o);const l=C(n,["maskImageConfig"]);l!=null&&_(t,["maskImageConfig"],X4(e,l));const d=C(n,["controlImageConfig"]);d!=null&&_(t,["controlImageConfig"],Z4(e,d));const f=C(n,["styleImageConfig"]);f!=null&&_(t,["styleImageConfig"],eO(e,f));const u=C(n,["subjectImageConfig"]);return u!=null&&_(t,["subjectImageConfig"],tO(e,u)),t}function rO(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&_(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&_(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&_(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["editMode"]);t!==void 0&&P!=null&&_(t,["parameters","editMode"],P);const R=C(n,["baseSteps"]);return t!==void 0&&R!=null&&_(t,["parameters","editConfig","baseSteps"],R),r}function iO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["referenceImages"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>nO(e,f))),_(t,["instances[0]","referenceImages"],d)}const l=C(n,["config"]);return l!=null&&_(t,["config"],rO(e,l,t)),t}function aO(e,n,t){const r={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&_(t,["parameters","includeRaiReason"],a);const o=C(n,["outputMimeType"]);t!==void 0&&o!=null&&_(t,["parameters","outputOptions","mimeType"],o);const l=C(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&_(t,["parameters","outputOptions","compressionQuality"],l);const d=C(n,["numberOfImages"]);t!==void 0&&d!=null&&_(t,["parameters","sampleCount"],d);const f=C(n,["mode"]);return t!==void 0&&f!=null&&_(t,["parameters","mode"],f),r}function sO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["image"]);a!=null&&_(t,["instances[0]","image"],_w(e,a));const o=C(n,["upscaleFactor"]);o!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=C(n,["config"]);return l!=null&&_(t,["config"],aO(e,l,t)),t}function oO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],Nr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function lO(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&_(t,["_url","models_url"],Ak(e,d)),r}function cO(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],lO(e,r,t)),t}function uO(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function dO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],uO(e,a,t)),t}function fO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],Nr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function hO(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Xh(e,wa(e,a)));const o=C(n,["tools"]);if(t!==void 0&&o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>Ik(e,f))),_(t,["tools"],d)}const l=C(n,["generationConfig"]);return t!==void 0&&l!=null&&_(t,["generationConfig"],l),r}function pO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Su(e,a);Array.isArray(l)&&(l=l.map(d=>Xh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],hO(e,o,t)),t}function mO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Su(e,a);Array.isArray(l)&&(l=l.map(d=>Xh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],o),t}function gO(e,n,t){const r={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=C(n,["outputGcsUri"]);t!==void 0&&o!=null&&_(t,["parameters","storageUri"],o);const l=C(n,["fps"]);t!==void 0&&l!=null&&_(t,["parameters","fps"],l);const d=C(n,["durationSeconds"]);t!==void 0&&d!=null&&_(t,["parameters","durationSeconds"],d);const f=C(n,["seed"]);t!==void 0&&f!=null&&_(t,["parameters","seed"],f);const u=C(n,["aspectRatio"]);t!==void 0&&u!=null&&_(t,["parameters","aspectRatio"],u);const h=C(n,["resolution"]);t!==void 0&&h!=null&&_(t,["parameters","resolution"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&_(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&_(t,["parameters","negativePrompt"],v);const S=C(n,["enhancePrompt"]);return t!==void 0&&S!=null&&_(t,["parameters","enhancePrompt"],S),r}function yO(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],Nr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&_(t,["instances[0]","image"],_w(e,o));const l=C(n,["config"]);return l!=null&&_(t,["config"],gO(e,l,t)),t}function xO(e,n){const t={},r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function bO(e,n){const t={},r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],xO(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&_(t,["text"],h),t}function vO(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>bO(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function wO(e,n){const t={},r=C(n,["citationSources"]);return r!=null&&_(t,["citations"],r),t}function SO(e,n){const t={},r=C(n,["content"]);r!=null&&_(t,["content"],vO(e,r));const a=C(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],wO(e,a));const o=C(n,["tokenCount"]);o!=null&&_(t,["tokenCount"],o);const l=C(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&_(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&_(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&_(t,["index"],u);const h=C(n,["logprobsResult"]);h!=null&&_(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function VN(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(f=>SO(e,f))),_(t,["candidates"],d)}const a=C(n,["modelVersion"]);a!=null&&_(t,["modelVersion"],a);const o=C(n,["promptFeedback"]);o!=null&&_(t,["promptFeedback"],o);const l=C(n,["usageMetadata"]);return l!=null&&_(t,["usageMetadata"],l),t}function NO(e,n){const t={},r=C(n,["values"]);return r!=null&&_(t,["values"],r),t}function CO(){return{}}function _O(e,n){const t={},r=C(n,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>NO(e,l))),_(t,["embeddings"],o)}return C(n,["metadata"])!=null&&_(t,["metadata"],CO()),t}function jO(e,n){const t={},r=C(n,["bytesBase64Encoded"]);r!=null&&_(t,["imageBytes"],Cu(e,r));const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function Rk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function kO(e,n){const t={},r=C(n,["_self"]);r!=null&&_(t,["image"],jO(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=C(n,["_self"]);return o!=null&&_(t,["safetyAttributes"],Rk(e,o)),t}function TO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>kO(e,l))),_(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],Rk(e,a)),t}function EO(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function b1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);o!=null&&_(t,["description"],o);const l=C(n,["version"]);l!=null&&_(t,["version"],l);const d=C(n,["_self"]);d!=null&&_(t,["tunedModelInfo"],EO(e,d));const f=C(n,["inputTokenLimit"]);f!=null&&_(t,["inputTokenLimit"],f);const u=C(n,["outputTokenLimit"]);u!=null&&_(t,["outputTokenLimit"],u);const h=C(n,["supportedGenerationMethods"]);return h!=null&&_(t,["supportedActions"],h),t}function AO(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=Pk(e,a);Array.isArray(o)&&(o=o.map(l=>b1(e,l))),_(t,["models"],o)}return t}function PO(){return{}}function DO(e,n){const t={},r=C(n,["totalTokens"]);r!=null&&_(t,["totalTokens"],r);const a=C(n,["cachedContentTokenCount"]);return a!=null&&_(t,["cachedContentTokenCount"],a),t}function IO(e,n){const t={},r=C(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],Cu(e,a));const o=C(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function RO(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],IO(e,r)),t}function MO(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>RO(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function OO(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&_(t,["response"],MO(e,d)),t}function LO(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function FO(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],LO(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&_(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function $O(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>FO(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function zO(e,n){const t={},r=C(n,["citations"]);return r!=null&&_(t,["citations"],r),t}function BO(e,n){const t={},r=C(n,["content"]);r!=null&&_(t,["content"],$O(e,r));const a=C(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],zO(e,a));const o=C(n,["finishMessage"]);o!=null&&_(t,["finishMessage"],o);const l=C(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&_(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&_(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&_(t,["index"],u);const h=C(n,["logprobsResult"]);h!=null&&_(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function HN(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>BO(e,h))),_(t,["candidates"],u)}const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["responseId"]);o!=null&&_(t,["responseId"],o);const l=C(n,["modelVersion"]);l!=null&&_(t,["modelVersion"],l);const d=C(n,["promptFeedback"]);d!=null&&_(t,["promptFeedback"],d);const f=C(n,["usageMetadata"]);return f!=null&&_(t,["usageMetadata"],f),t}function UO(e,n){const t={},r=C(n,["truncated"]);r!=null&&_(t,["truncated"],r);const a=C(n,["token_count"]);return a!=null&&_(t,["tokenCount"],a),t}function qO(e,n){const t={},r=C(n,["values"]);r!=null&&_(t,["values"],r);const a=C(n,["statistics"]);return a!=null&&_(t,["statistics"],UO(e,a)),t}function VO(e,n){const t={},r=C(n,["billableCharacterCount"]);return r!=null&&_(t,["billableCharacterCount"],r),t}function HO(e,n){const t={},r=C(n,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>qO(e,l))),_(t,["embeddings"],o)}const a=C(n,["metadata"]);return a!=null&&_(t,["metadata"],VO(e,a)),t}function GO(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["imageBytes"],Cu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function Mk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function jw(e,n){const t={},r=C(n,["_self"]);r!=null&&_(t,["image"],GO(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=C(n,["_self"]);o!=null&&_(t,["safetyAttributes"],Mk(e,o));const l=C(n,["prompt"]);return l!=null&&_(t,["enhancedPrompt"],l),t}function YO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>jw(e,l))),_(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],Mk(e,a)),t}function WO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>jw(e,o))),_(t,["generatedImages"],a)}return t}function QO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>jw(e,o))),_(t,["generatedImages"],a)}return t}function JO(e,n){const t={},r=C(n,["endpoint"]);r!=null&&_(t,["name"],r);const a=C(n,["deployedModelId"]);return a!=null&&_(t,["deployedModelId"],a),t}function KO(e,n){const t={},r=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function XO(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=C(n,["step"]);return o!=null&&_(t,["step"],o),t}function v1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);o!=null&&_(t,["description"],o);const l=C(n,["versionId"]);l!=null&&_(t,["version"],l);const d=C(n,["deployedModels"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(v=>JO(e,v))),_(t,["endpoints"],b)}const f=C(n,["labels"]);f!=null&&_(t,["labels"],f);const u=C(n,["_self"]);u!=null&&_(t,["tunedModelInfo"],KO(e,u));const h=C(n,["defaultCheckpointId"]);h!=null&&_(t,["defaultCheckpointId"],h);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>XO(e,v))),_(t,["checkpoints"],b)}return t}function ZO(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=Pk(e,a);Array.isArray(o)&&(o=o.map(l=>v1(e,l))),_(t,["models"],o)}return t}function eL(){return{}}function tL(e,n){const t={},r=C(n,["totalTokens"]);return r!=null&&_(t,["totalTokens"],r),t}function nL(e,n){const t={},r=C(n,["tokensInfo"]);return r!=null&&_(t,["tokensInfo"],r),t}function rL(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],Cu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function iL(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],rL(e,r)),t}function aL(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>iL(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function sL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response"]);return d!=null&&_(t,["response"],aL(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oL="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function lL(e,n,t){const r=new jR;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const o=XM(e,a);Object.assign(r,o)}else{const o=KM(e,a);Object.assign(r,o)}n(r)}class cL{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,o;const l=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const u=hL(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const B=this.apiClient.getApiKey();f=`${l}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${B}`}let h=()=>{};const g=new Promise(B=>{h=B}),b=n.callbacks,v=function(){var B;(B=b==null?void 0:b.onopen)===null||B===void 0||B.call(b),h({})},S=this.apiClient,k={onopen:v,onmessage:B=>{lL(S,b.onmessage,B)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(B){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(B){}},T=this.webSocketFactory.create(f,fL(u),k);T.connect(),await g;let P=Nr(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const B=this.apiClient.getProject(),F=this.apiClient.getLocation();P=`projects/${B}/locations/${F}/`+P}let R={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[bu.AUDIO]}:n.config.responseModalities=[bu.AUDIO]),!((o=n.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I={model:P,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?R=SM(this.apiClient,I):R=wM(this.apiClient,I),delete R.config,T.send(JSON.stringify(R)),new dL(T,this.apiClient)}}const uL={turnComplete:!0};class dL{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=Su(n,t.turns),n.isVertexAI()?r=r.map(a=>Xh(n,a)):r=r.map(a=>Db(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!n.isVertexAI()&&!("id"in o))throw new Error(oL)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},uL),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:TM(this.apiClient,n)}:t={realtimeInput:kM(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function fL(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function hL(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pL extends dg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let o;const l=[];if(r!=null&&r.generatedImages)for(const f of r.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((a=f==null?void 0:f.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=f==null?void 0:f.safetyAttributes:l.push(f);let d;return o?d={generatedImages:l,positivePromptSafetyAttributes:o}:d={generatedImages:l},d}),this.list=async t=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Pb(qh.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=qN(this.apiClient,n);return d=Ht("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=HN(this.apiClient,h),b=new yx;return Object.assign(b,g),b})}else{const u=UN(this.apiClient,n);return d=Ht("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=VN(this.apiClient,h),b=new yx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=qN(this.apiClient,n);d=Ht("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const h=this.apiClient;return l=h.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(g){return nb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=y1(g),R;R=yield Fi(P.next()),b=R.done,!b;T=!0){k=R.value,T=!1;const B=HN(h,yield Fi(k.json())),F=new yx;Object.assign(F,B),yield yield Fi(F)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=P.return)&&(yield Fi(S.call(P)))}finally{if(v)throw v.error}}})})}else{const u=UN(this.apiClient,n);d=Ht("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const h=this.apiClient;return l=h.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(g){return nb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=y1(g),R;R=yield Fi(P.next()),b=R.done,!b;T=!0){k=R.value,T=!1;const B=VN(h,yield Fi(k.json())),F=new yx;Object.assign(F,B),yield yield Fi(F)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=P.return)&&(yield Fi(S.call(P)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=Q4(this.apiClient,n);return d=Ht("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=HO(this.apiClient,h),b=new EN;return Object.assign(b,g),b})}else{const u=p4(this.apiClient,n);return d=Ht("{model}:batchEmbedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=_O(this.apiClient,h),b=new EN;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=K4(this.apiClient,n);return d=Ht("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=YO(this.apiClient,h),b=new AN;return Object.assign(b,g),b})}else{const u=g4(this.apiClient,n);return d=Ht("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=TO(this.apiClient,h),b=new AN;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=iO(this.apiClient,n);return o=Ht("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=WO(this.apiClient,f),h=new vR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=sO(this.apiClient,n);return o=Ht("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=QO(this.apiClient,f),h=new wR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=oO(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>v1(this.apiClient,h))}else{const u=y4(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>b1(this.apiClient,h))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=cO(this.apiClient,n);return d=Ht("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=ZO(this.apiClient,h),b=new PN;return Object.assign(b,g),b})}else{const u=b4(this.apiClient,n);return d=Ht("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=AO(this.apiClient,h),b=new PN;return Object.assign(b,g),b})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=dO(this.apiClient,n);return d=Ht("{model}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>v1(this.apiClient,h))}else{const u=w4(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>b1(this.apiClient,h))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=fO(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=eL(),g=new DN;return Object.assign(g,h),g})}else{const u=S4(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(()=>{const h=PO(),g=new DN;return Object.assign(g,h),g})}}async countTokens(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=pO(this.apiClient,n);return d=Ht("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=tL(this.apiClient,h),b=new IN;return Object.assign(b,g),b})}else{const u=C4(this.apiClient,n);return d=Ht("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=DO(this.apiClient,h),b=new IN;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=mO(this.apiClient,n);return o=Ht("{model}:computeTokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=nL(this.apiClient,f),h=new SR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=yO(this.apiClient,n);return d=Ht("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>sL(this.apiClient,h))}else{const u=k4(this.apiClient,n);return d=Ht("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>OO(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mL(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function gL(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function yL(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["operationName"],r);const a=C(n,["resourceName"]);a!=null&&_(t,["_url","resourceName"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],o),t}function xL(e,n){const t={},r=C(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],Cu(e,a));const o=C(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function bL(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],xL(e,r)),t}function vL(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>bL(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function wL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&_(t,["response"],vL(e,d)),t}function SL(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],Cu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function NL(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],SL(e,r)),t}function CL(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>NL(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function GN(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response"]);return d!=null&&_(t,["response"],CL(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _L extends dg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let o;return r&&"httpOptions"in r&&(o=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=gL(this.apiClient,n);return d=Ht("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>GN(this.apiClient,h))}else{const u=mL(this.apiClient,n);return d=Ht("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>wL(this.apiClient,h))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=yL(this.apiClient,n);return o=Ht("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>GN(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jL="Content-Type",kL="X-Server-Timeout",TL="User-Agent",EL="x-goog-api-client",AL="0.14.1",PL=`google-genai-sdk/${AL}`,DL="v1beta1",IL="v1beta",YN=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Ok extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class w1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class RL{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:DL,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:IL,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[l,d]of Object.entries(n.queryParams))a.searchParams.append(l,String(d));let o={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=n.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.unaryApiCall(a,o,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,o]of Object.entries(t))typeof o=="object"?r[a]=Object.assign(Object.assign({},r[a]),o):o!==void 0&&(r[a]=o);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=n.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.streamApiCall(a,o,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,o=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=o}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await WN(a),new g1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await WN(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return nb(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:d,value:f}=yield Fi(a.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(f);try{const g=JSON.parse(u);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new Ok(k);if(S>=500&&S<600)throw new w1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=u;let h=l.match(YN);for(;h;){const g=h[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Fi(new g1(b)),l=l.slice(h[0].length),h=l.match(YN)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=PL+" "+this.clientOptions.userAgentExtra;return n[TL]=t,n[EL]=t,n[jL]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(kL,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,l=await o.stat(n);a.sizeBytes=String(l.size);const d=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=d;const f=await this.fetchUploadUrl(a,t);return o.upload(n,f,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const o={file:n},l=await this.request({path:Ht("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function WN(e){var n;if(e===void 0)throw new w1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new Ok(o):t>=500&&t<600?new w1(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ML(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function OL(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function LL(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],OL(e,r,t)),t}function FL(e,n){const t={},r=C(n,["textInput"]);r!=null&&_(t,["textInput"],r);const a=C(n,["output"]);return a!=null&&_(t,["output"],a),t}function $L(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>FL(e,o))),_(t,["examples","examples"],a)}return t}function zL(e,n,t){const r={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&_(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=C(n,["epochCount"]);t!==void 0&&o!=null&&_(t,["tuningTask","hyperparameters","epochCount"],o);const l=C(n,["learningRateMultiplier"]);if(l!=null&&_(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=C(n,["batchSize"]);t!==void 0&&d!=null&&_(t,["tuningTask","hyperparameters","batchSize"],d);const f=C(n,["learningRate"]);return t!==void 0&&f!=null&&_(t,["tuningTask","hyperparameters","learningRate"],f),r}function BL(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&_(t,["tuningTask","trainingData"],$L(e,a));const o=C(n,["config"]);return o!=null&&_(t,["config"],zL(e,o,t)),t}function UL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function qL(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function VL(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],qL(e,r,t)),t}function HL(e,n,t){const r={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function GL(e,n){const t={},r=C(n,["gcsUri"]);return r!=null&&_(t,["validationDatasetUri"],r),t}function YL(e,n,t){const r={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&_(t,["supervisedTuningSpec"],GL(e,a));const o=C(n,["tunedModelDisplayName"]);t!==void 0&&o!=null&&_(t,["tunedModelDisplayName"],o);const l=C(n,["description"]);t!==void 0&&l!=null&&_(t,["description"],l);const d=C(n,["epochCount"]);t!==void 0&&d!=null&&_(t,["supervisedTuningSpec","hyperParameters","epochCount"],d);const f=C(n,["learningRateMultiplier"]);t!==void 0&&f!=null&&_(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const u=C(n,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&_(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const h=C(n,["adapterSize"]);if(t!==void 0&&h!=null&&_(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function WL(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],HL(e,a,t));const o=C(n,["config"]);return o!=null&&_(t,["config"],YL(e,o,t)),t}function QL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["model"],r);const a=C(n,["name"]);return a!=null&&_(t,["endpoint"],a),t}function Lk(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["state"]);a!=null&&_(t,["state"],Tk(e,a));const o=C(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=C(n,["tuningTask","startTime"]);l!=null&&_(t,["startTime"],l);const d=C(n,["tuningTask","completeTime"]);d!=null&&_(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=C(n,["description"]);u!=null&&_(t,["description"],u);const h=C(n,["baseModel"]);h!=null&&_(t,["baseModel"],h);const g=C(n,["_self"]);g!=null&&_(t,["tunedModel"],QL(e,g));const b=C(n,["distillationSpec"]);b!=null&&_(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&_(t,["experiment"],v);const S=C(n,["labels"]);S!=null&&_(t,["labels"],S);const k=C(n,["pipelineJob"]);k!=null&&_(t,["pipelineJob"],k);const T=C(n,["tunedModelDisplayName"]);return T!=null&&_(t,["tunedModelDisplayName"],T),t}function JL(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["tunedModels"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Lk(e,l))),_(t,["tuningJobs"],o)}return t}function KL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);return l!=null&&_(t,["error"],l),t}function XL(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=C(n,["step"]);o!=null&&_(t,["step"],o);const l=C(n,["endpoint"]);return l!=null&&_(t,["endpoint"],l),t}function ZL(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],r);const a=C(n,["endpoint"]);a!=null&&_(t,["endpoint"],a);const o=C(n,["checkpoints"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>XL(e,d))),_(t,["checkpoints"],l)}return t}function S1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["state"]);a!=null&&_(t,["state"],Tk(e,a));const o=C(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=C(n,["startTime"]);l!=null&&_(t,["startTime"],l);const d=C(n,["endTime"]);d!=null&&_(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=C(n,["error"]);u!=null&&_(t,["error"],u);const h=C(n,["description"]);h!=null&&_(t,["description"],h);const g=C(n,["baseModel"]);g!=null&&_(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&_(t,["tunedModel"],ZL(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&_(t,["supervisedTuningSpec"],v);const S=C(n,["tuningDataStats"]);S!=null&&_(t,["tuningDataStats"],S);const k=C(n,["encryptionSpec"]);k!=null&&_(t,["encryptionSpec"],k);const T=C(n,["partnerModelTuningSpec"]);T!=null&&_(t,["partnerModelTuningSpec"],T);const P=C(n,["distillationSpec"]);P!=null&&_(t,["distillationSpec"],P);const R=C(n,["experiment"]);R!=null&&_(t,["experiment"],R);const I=C(n,["labels"]);I!=null&&_(t,["labels"],I);const B=C(n,["pipelineJob"]);B!=null&&_(t,["pipelineJob"],B);const F=C(n,["tunedModelDisplayName"]);return F!=null&&_(t,["tunedModelDisplayName"],F),t}function e3(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["tuningJobs"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>S1(e,l))),_(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t3 extends dg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Pb(qh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:m1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=UL(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>S1(this.apiClient,h))}else{const u=ML(this.apiClient,n);return d=Ht("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>Lk(this.apiClient,h))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=VL(this.apiClient,n);return d=Ht("tuningJobs",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=e3(this.apiClient,h),b=new RN;return Object.assign(b,g),b})}else{const u=LL(this.apiClient,n);return d=Ht("tunedModels",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),l.then(h=>{const g=JL(this.apiClient,h),b=new RN;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=WL(this.apiClient,n);return o=Ht("tuningJobs",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>S1(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=BL(this.apiClient,n);return o=Ht("tunedModels",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>KL(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class n3{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const r3=1024*1024*8,i3=3,a3=1e3,s3=2,n0="x-goog-upload-status";async function o3(e,n,t){var r,a,o;let l=0,d=0,f=new g1(new Response),u="upload";for(l=e.size;d<l;){const g=Math.min(r3,l-d),b=e.slice(d,d+g);d+g>=l&&(u+=", finalize");let v=0,S=a3;for(;v<i3&&(f=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(d),"Content-Length":String(g)}}}),!(!((r=f==null?void 0:f.headers)===null||r===void 0)&&r[n0]));)v++,await c3(S),S=S*s3;if(d+=g,((a=f==null?void 0:f.headers)===null||a===void 0?void 0:a[n0])!=="active")break;if(l<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(f==null?void 0:f.json());if(((o=f==null?void 0:f.headers)===null||o===void 0?void 0:o[n0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function l3(e){return{size:e.size,type:e.type}}function c3(e){return new Promise(n=>setTimeout(n,e))}class u3{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await o3(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await l3(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class d3{create(n,t,r){return new f3(n,t,r)}}class f3{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const QN="x-goog-api-key";class h3{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(QN)===null&&n.append(QN,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p3="gl-node/";class kw{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=CI(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new h3(this.apiKey);this.apiClient=new RL({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:p3+"web",uploader:new u3,downloader:new n3}),this.models=new pL(this.apiClient),this.live=new cL(this.apiClient,a,new d3),this.chats=new PR(this.models,this.apiClient),this.caches=new kR(this.apiClient),this.files=new VR(this.apiClient),this.operations=new _L(this.apiClient),this.tunings=new t3(this.apiClient)}}const m3=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},Tw=()=>localStorage.getItem("authToken");class g3{constructor(){nr(this,"listeners",[]);nr(this,"activeRequests",0)}subscribe(n){return this.listeners.push(n),n(this.activeRequests>0),()=>this.unsubscribe(n)}unsubscribe(n){this.listeners=this.listeners.filter(t=>t!==n)}notify(n){n?this.activeRequests++:this.activeRequests=Math.max(0,this.activeRequests-1);const t=this.activeRequests>0;this.listeners.forEach(r=>r(t))}}const N1=new g3,y3="https://backend.newtons.in",x3=()=>localStorage.getItem("authToken"),me=async(e,n={})=>{const t=x3(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let o=e.startsWith("/")?e:`/${e}`;o.startsWith("/api/")||(o=`/api${o}`);const l=`${y3}${o}`;N1.notify(!0);try{console.log(`Making API call to: ${l}`);const d=await fetch(l,{...n,headers:a});if(d.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!d.ok){let f=`HTTP error! status: ${d.status}`;try{const u=await d.json();f=(u==null?void 0:u.message)||(u==null?void 0:u.error)||f}catch{}throw console.error(`API Error: ${d.status} ${d.statusText} - ${f}`),new Error(f)}return d}catch(d){throw d instanceof TypeError&&d.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",d):console.error("API Fetch Error:",d),d}finally{N1.notify(!1)}},r0="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",b3="models/gemini-3-flash-preview",v3=`You are an intelligent Clinic Hub Assistant for a Clinic Management System. Your role is to help the Clinic Administrator or Doctor manage their clinic ecosystem efficiently.

You have access to the current state of the clinic settings and the staff list. You can perform actions to update these settings or manage staff members.

**Capabilities:**
1.  **View Settings & Staff:** User can ask about current charges, clinic details, or staff members. Answer based on the provided context.
2.  **Update Settings:** Change fees, clinic name, address, etc.
3.  **Manage Staff:** Add new staff members or update existing ones.
4.  **Voice AI Settings:** Update the \`voice_ai_language\` for the Live API Assistant. Available codes:
    -   India: \`en-US\` (English), \`hi-IN\` (Hindi), \`te-IN\` (Telugu), \`bn-IN\` (Bengali), \`mr-IN\` (Marathi), \`ta-IN\` (Tamil), \`gu-IN\` (Gujarati), \`kn-IN\` (Kannada), \`ml-IN\` (Malayalam), \`pa-IN\` (Punjabi)
    -   Global: \`es-ES\` (Spanish), \`fr-FR\` (French), \`de-DE\` (German), \`it-IT\` (Italian), \`pt-PT\` (Portuguese), \`ru-RU\` (Russian), \`ja-JP\` (Japanese), \`ko-KR\` (Korean), \`zh-CN\` (Chinese), \`ar-SA\` (Arabic).
5.  **Analyze Financials & Inventory:** Access the Analysis Dashboard to view revenue, expenses, and inventory movement. Set date ranges to filter data.
6.  **Manage Inventory:** Update pharmacy tokens (drugs) and lab tests. You will reference items by their **Serial Number** as provided in the context.
7.  **Purchase Management:** Search for distributors, select one, and build a purchase order by adding items. You can add multiple items at once. Editing items uses Serial Numbers.
8.  **Looping & Reasoning:** You should think step-by-step. If a user request involves multiple steps or if you need to check something after an action, you can continue the loop.
9.  **Follow-up:** If critical information is missing, ask the user.

**Interpretation Rules:**
- **Analysis Dates:** When the user asks for analysis (financial or inventory) for a specific time range (e.g., "last month", "yesterday"), you **MUST** include \`startDate\` and \`endDate\` in the \`navigate_to\` action for \`/dashboard/analysis\`.
- If the user says "add drug", "buy medicine", or "new stock", they **usually mean "Add Item to Purchase Order"** (use \`add_purchase_items\` or navigate to \`/dashboard/purchase\`).
- **Prerequisite:** If you are using ANY purchase tools (\`add_purchase_items\`, \`search_distributor_purchase\`, \`set_distributor_purchase\`, \`edit_purchase_items\`), you **MUST** include a \`navigate_to\` action with \`page: "/dashboard/purchase"\` as the **FIRST** action in your list, unless you are already on that page.
- **ONLY** use \`update_drug\` (create) if the user explicitly says "create new drug definition" or "add to master inventory".
- The correct route for purchasing is \`/dashboard/purchase\`.

- **Inventory Navigation:** If you execute "update_drug" or "search_pharmacy_inventory", you **MUST** include a "navigate_to" action for "/dashboard/inventory". If you searched for or updated a specific term, append it as "?search=Term" (e.g. "/dashboard/inventory?search=Paracetamol").
- **Lab Navigation:** If you execute "update_lab_test", you **MUST** include a "navigate_to" action for "/lab-inventory", unless you are already on that page.

**Action Tools:**
You can perform the following actions. Return a JSON array of actions.

\`\`\`json
[
  {
    "action": "update_clinic_settings",
    "updates": {
       "admissionCharge": "number string",
       "perDayCharge": "number string",
       "otherCharges": "number string",
       "name": "string",
       "address": "string",
       "notes": "string",
       "logoUrl": "string",
       "upi_id": "string",
       "low_stock_threshold": number,
        "clinicWideSystemPrompt": "string",
        "aiMemory": "string",
        "clinicWideSystemPrompt": "string",
        "aiMemory": "string",
        "gemini_api_key": "string",
        "voice_ai_language": "string (e.g. 'en-US', 'te-IN')"
    }
  },
  {
    "action": "create_staff_member",
    "staff": {
       "name": "string",
       "email": "string",
       "role": "doctor" | "receptionist" | "pharmacy" | "lab",
       "password": "string",
       "opd_fee": number | null
    }
  },
  {
    "action": "update_staff_member",
    "id": "string | number", 
    "updates": {
       "name": "string",
       "email": "string",
       "role": "doctor" | "receptionist" | "pharmacy" | "lab",
       "password": "string",
       "opd_fee": number | null,
       "active": boolean
    }
  },
  {
    "action": "set_analysis_dates",
    "startDate": "YYYY-MM-DD",
    "endDate": "YYYY-MM-DD"
  },
  {
    "action": "navigate_to",
    "page": "/dashboard/inventory" | "/lab-inventory" | "/dashboard/queue" | "/dashboard/staff" | "/dashboard/purchase" | "/dashboard/analysis" | "/dashboard/clinic-hub" | "/billing" | "/dashboard/patients",
    "section": "financial" | "inventory" | "string (optional)",
    "startDate": "YYYY-MM-DD (optional, for analysis page)",
    "endDate": "YYYY-MM-DD (optional, for analysis page)"
  },
  {
    "action": "highlight_section",
    "elementId": "string"
  },
  {
    "action": "refresh_analysis"
  },
  {
    "action": "ask_followup_question",
    "question": "string"
  },
  {
    "action": "search_pharmacy_inventory",
    "query": "string (name, brand, or composition)"
  },
  {
    "action": "update_drug",
    "id": "number",
    "updates": {
       "name": "string",
       "brand_name": "string",
       "description": "string",
       "mrp": "number (MRP)",
       "stock": "number",
       "pack": "string (e.g. strip, bottle)",
       "supplier": "string",
       "expiry_date": "YYYY-MM-DD",
       "rate": "number",
       "box_number": "string",
       "gst": "number",
       "margin": "number",
       "discount": "number",
       "batch": "string",
       "hsn_code": "string",
       "mfg": "string",
       "loose": "number"
    }
  },
  {
    "action": "update_lab_test",
    "serial_number": 1,
    "updates": {
       "name": "string",
       "price": "number",
       "description": "string",
       "default_parameters": "array of objects { name, type, defaultValue, unit, lower_limit, upper_limit }"
    }
  },
  {
    "action": "search_distributor_purchase",
    "query": "string"
  },
  {
    "action": "set_distributor_purchase",
    "distributorId": "string"
  },
  {
    "action": "add_purchase_items",
    "items": [
        {
            "name": "string",
            "stock": "number (quantity)",
            "rate": "number (buying price)",
            "mrp": "number",
             "pack": "string", 
             "expiry_date": "YYYY-MM-DD",
             "batch": "string",
             "discount": "number",
             "gst": "number"
        }
    ]
  },
  {
    "action": "edit_purchase_items",
     "updates": [
         {
             "serial_number": "number (The Row # from context)",
             "field": "string (name, stock, rate, etc.)",
             "value": "string | number"
         }
     ]
  },
  {
    "action": "end_task",
    "summary": "string"
  },
  {
    "action": "open_new_case",
    "name": "string (Patient Name)",
    "age": "number (optional)",
    "gender": "M | F | O (optional)",
    "phone": "string (optional)",
    "complaint": "string (The medical complaint/reason)"
  }
]
\`\`\`

**Navigation Reference:**
- **Pharmacy Inventory:** \`/dashboard/inventory\`
- **Lab Inventory:** \`/lab-inventory\`
- **Doctor Queue:** \`/dashboard/queue\`
- **Staff Management:** \`/dashboard/staff\`
- **All Patients:** \`/dashboard/patients\`
- **Billing:** \`/billing\`
- **Purchase Page:** \`/dashboard/purchase\`
- **Analysis:** \`/dashboard/analysis\`
- **Clinic Hub:** \`/dashboard/clinic-hub\`
\`\`\`

**Rules:**
-   **Always** return a JSON array as the last part of your response.
-   If the user's request is satisfied, use the \`end_task\` action with a summary of what was done.
-   If you need more info, use \`ask_followup_question\`.
-   If you perform an action (like updating settings), and there's nothing else to do *immediately* but you want to confirm it's done, you can return the action. The system will execute it and call you back with the result. Then you can \`end_task\`.
-   For \`create_staff_member\`, if password is not provided by user, generate a secure random password and mention it in the summary.
-   Update numeric strings as strings (e.g., "500.00").
-   **CRITICAL DO's and DON'Ts:**
    -   **DO NOT** fill in empty fields (like \`gemini_api_key\`, \`logoUrl\`, \`upi_id\`, etc.) with fake, placeholder, or example data.
    -   **ONLY** update fields that the user *intentionally* asked to change.
    -   **PRESERVE** existing values for any fields not explicitly mentioned in the user's request.
    -   If a field is empty and the user didn't ask to set it, **leave it empty**.
    -   Do not invent values.
`;async function w3(){var t;if(!Tw()&&r0)return r0;let n=null;try{const r=await me("/api/clinics/settings");if(r.ok){const a=await r.json();(t=a.gemini_api_key)!=null&&t.trim()&&(n=a.gemini_api_key.trim())}}catch(r){console.warn("Error fetching updated key",r)}if(n)return n;try{const r=await me("/api/global-settings/app_gemini_api_key");if(r.ok){const o=(await r.json()).value;if(o&&o.trim()!=="")return o.trim()}}catch(r){console.warn("Could not fetch global API key.",r)}return r0}let i0=null;async function S3(){if(!i0){const e=await w3();i0=new kw({apiKey:e})}return i0}async function N3(e,n,t=[],r){var u,h,g,b,v;const a=await S3(),o=[];o.push({role:"user",parts:[{text:v3}]}),o.push({role:"model",parts:[{text:"Understood. I am ready to assist with Clinic Hub management."}]}),t.forEach(S=>{o.push({role:S.role,parts:[{text:S.text}]})});const f=[{text:`
    Context:
    ${`
    --- Current Clinic Context ---
    Settings: ${JSON.stringify(n.settings,null,2)}
    
    Staff List: ${JSON.stringify(n.staffList.map(S=>({id:S.id||S._id,name:S.name,role:S.role,email:S.email,active:S.active,opd_fee:S.opd_fee})),null,2)}
    
    Previous Action Results (if any): ${JSON.stringify(n.actionResults||[],null,2)}

    Analysis Data (if active): ${JSON.stringify(n.analysisData||{},null,2)}

    Pharmacy Inventory: ${n.pharmacyInventory?JSON.stringify(n.pharmacyInventory,null,2):"Not loaded. Use 'search_pharmacy_inventory' to find items."}

    Distributors List: ${JSON.stringify((n.distributors||[]).map(S=>({serial_number:S.serial_number,name:S.name,contact_person:S.contact_person,phone:S.phone,remainingBalance:S.remainingBalance})),null,2)}

    Lab Tests Inventory: ${JSON.stringify((n.labInventory||[]).map(S=>({serial:S.serial_number,name:S.name,price:S.price,description:S.description,default_parameters:S.default_parameters})),null,2)}

    Current Purchase Page Rows: ${JSON.stringify((n.purchaseRows||[]).map((S,k)=>({serial_number:k+1,name:S.name,stock:S.stock,rate:S.rate,mrp:S.mrp,net_value:(S.stock*S.rate).toFixed(2)})),null,2)}

    Current Application Page Context: ${n.pageContext?JSON.stringify(n.pageContext,null,2):"Unknown/General Dashboard"}
    `}

    User Query/Input:
    ${e}
    `}];if(r){const S=r.replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"");f.push({inlineData:{data:S,mimeType:"image/jpeg"}})}o.push({role:"user",parts:f});try{const S={model:b3,contents:o,generationConfig:{temperature:.7,maxOutputTokens:2048,responseMimeType:"text/plain"}},k=await a.models.generateContentStream(S);let T="";for await(const P of k){const R=P;R.text&&typeof R.text=="function"?T+=R.text():(v=(b=(g=(h=(u=R.candidates)==null?void 0:u[0])==null?void 0:h.content)==null?void 0:g.parts)==null?void 0:b[0])!=null&&v.text&&(T+=R.candidates[0].content.parts[0].text)}if(!T)throw new Error("Empty response from AI");return T}catch(S){throw console.error("Gemini Interaction Error:",S),new Error("Failed to communicate with AI Assistant.")}}const Ew=({settings:e,staffList:n,onSettingsUpdate:t,onStaffUpdate:r,onHighlight:a})=>{const o=Dt(),{setAnalysisDateRange:l,analysisData:d,analysisNavigate:f,refreshAnalysis:u,pageContext:h}=Tb(),{setDistributors:g,setSelectedDistributor:b,setSearchTerm:v,addPurchaseRow:S,updatePurchaseRow:k,distributors:T,purchaseRows:P}=vk(),[R,I]=w.useState(""),B=w.useRef(d),F=w.useRef(P);w.useEffect(()=>{B.current=d},[d]),w.useEffect(()=>{F.current=P},[P]);const[L,U]=w.useState([]),[H,K]=w.useState(!1),[M,$]=w.useState(null),z=w.useRef(!1),W=w.useRef(0),te=5,V=()=>{z.current=!1,K(!1),U(ce=>[...ce,{role:"system",text:" Task stopped by user."}])},G=ce=>{const ge=new FileReader;ge.onloadend=()=>{$(ge.result)},ge.readAsDataURL(ce)},J=()=>{$(null)},oe=async(ce,ge,D=[],pe)=>{var Ce,Z,ee;if(z.current){if(W.current+=1,W.current>te){U(X=>[...X,{role:"system",text:" Task limit reached. Stopping automatically."}]),K(!1),z.current=!1;return}try{let X=e,ye=n,He=[],he=[],Le=[];try{const[Ae,_e]=await Promise.all([me("/api/clinics/settings"),me("/staff")]);if(Ae.ok&&_e.ok){const le=await Ae.json(),q=await _e.json(),[de,be,$e]=await Promise.all([me("/api/drugs"),me("/api/lab-tests"),me("/api/distributors")]);if(de.ok){const nt=await de.json();He=nt.drugs||nt||[]}be.ok&&(he=(await be.json()).map((ht,wt)=>({...ht,serial_number:wt+1}))),$e.ok&&(Le=(await $e.json()||[]).map((ht,wt)=>({...ht,serial_number:wt+1}))),X={...le,admissionCharge:parseFloat(le.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(le.perDayCharge||0).toFixed(2),otherCharges:parseFloat(le.otherCharges||0).toFixed(2),aiMemory:le.aiMemory||"",clinicWideSystemPrompt:le.clinicWideSystemPrompt||"",gemini_api_key:le.gemini_api_key||"",low_stock_threshold:le.low_stock_threshold!==void 0&&le.low_stock_threshold!==null?String(le.low_stock_threshold):"10",name:le.name||"",logoUrl:le.logoUrl||"",upi_id:le.upi_id||"",address:le.address||"",notes:le.notes||"",clinic_id:le.clinic_id},ye=q.map(nt=>({...nt,id:nt._id||nt.id}))}}catch(Ae){console.warn("Failed to fetch fresh context for AI loop, falling back to props",Ae)}const ue={settings:X,staffList:ye,analysisData:B.current,pharmacyInventory:He.length>50?void 0:He,labInventory:he,distributors:Le,purchaseRows:F.current,actionResults:D,pageContext:h||void 0},De=ge.filter(Ae=>Ae.role!=="system"),Ye=await N3(ce,ue,De,pe);if(!z.current)return;let et=[];try{const Ae=Ye.match(/\[[\s\S]*\]/);if(Ae)et=JSON.parse(Ae[0]);else{U(_e=>[..._e,{role:"model",text:Ye}]),K(!1),z.current=!1;return}}catch(Ae){console.error("Failed to parse AI response",Ae),U(_e=>[..._e,{role:"model",text:"I'm having trouble processing that. Please try again."}]),K(!1),z.current=!1;return}const Ke=[];let it=[],ot=[];for(const Ae of et){if(!z.current)break;if(Ae.action==="end_task"){U(_e=>[..._e,{role:"model",text:Ae.summary}]),K(!1),z.current=!1;return}if(Ae.action==="ask_followup_question"){U(_e=>[..._e,{role:"model",text:Ae.question}]),K(!1),z.current=!1;return}try{if(Ae.action==="update_clinic_settings"){const _e=Ae.updates;Object.keys(_e).forEach(de=>it.push(`setting-${de}`));const le={...X,..._e},q={...le,admissionCharge:parseFloat(le.admissionCharge),perDayCharge:parseFloat(le.perDayCharge),otherCharges:parseFloat(le.otherCharges),low_stock_threshold:parseInt(le.low_stock_threshold)};await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify(q)}),t&&t(),Ke.push({action:"update_clinic_settings",status:"success"}),ot.push({role:"system",text:" Updated clinic settings"})}if(Ae.action==="create_staff_member"&&(await me("/api/staff",{method:"POST",body:JSON.stringify({...Ae.staff,clinic_id:X.clinic_id})}),r&&r(),Ke.push({action:"create_staff_member",status:"success",name:Ae.staff.name}),ot.push({role:"system",text:` Created staff member: ${Ae.staff.name}`})),Ae.action==="update_staff_member"){const _e=Ae.id;await me(`/api/staff/${_e}`,{method:"PUT",body:JSON.stringify(Ae.updates)}),r&&r(),it.push(`staff-member-${_e}`),Ke.push({action:"update_staff_member",status:"success",id:_e}),ot.push({role:"system",text:" Updated staff member details"})}if(Ae.action==="set_analysis_dates"){const{startDate:_e,endDate:le}=Ae;l({startDate:new Date(_e),endDate:new Date(le)}),Ke.push({action:"set_analysis_dates",status:"success",startDate:_e,endDate:le}),ot.push({role:"system",text:` Set analysis dates: ${_e} to ${le}`})}if(Ae.action==="navigate_to"){let _e=Ae.page;if(Ae.page&&Ae.page.includes("analysis")&&Ae.startDate&&Ae.endDate){const le=_e.includes("?")?"&":"?";_e=`${_e}${le}startDate=${Ae.startDate}&endDate=${Ae.endDate}`}else Ae.page&&Ae.page.includes("analysis")&&((Ce=B.current)!=null&&Ce.startDate)&&((Z=B.current)!=null&&Z.endDate);o(_e),Ae.section&&setTimeout(()=>f(Ae.section),500),Ke.push({action:"navigate_to",status:"success",page:_e}),ot.push({role:"system",text:` Navigated to ${_e}`})}if(Ae.action==="highlight_section"&&(it.push(Ae.elementId),Ke.push({action:"highlight_section",status:"success",id:Ae.elementId})),Ae.action==="refresh_analysis"){ot.push({role:"system",text:" Refreshing analysis data..."});const _e=await u();_e?(B.current=_e,Ke.push({action:"refresh_analysis",status:"success",summary:"Data refreshed successfully"}),ot.push({role:"system",text:" Analysis data refreshed"})):(Ke.push({action:"refresh_analysis",status:"error",error:"No data returned"}),ot.push({role:"system",text:" Failed to refresh analysis data"}))}if(Ae.action==="search_pharmacy_inventory"){const _e=Ae.query.toLowerCase(),le=He.filter(de=>de.name&&de.name.toLowerCase().includes(_e)||de.brand_name&&de.brand_name.toLowerCase().includes(_e)||de.description&&de.description.toLowerCase().includes(_e)),q=le.slice(0,10);Ke.push({action:"search_pharmacy_inventory",status:"success",count:le.length,results:q}),le.length>0?ot.push({role:"system",text:` Found ${le.length} matches for "${Ae.query}". Showing top ${q.length}.`}):ot.push({role:"system",text:` No matches found for "${Ae.query}"`})}if(Ae.action==="update_drug"){const _e=Ae.id;try{const le=He.find(de=>de.id===_e);if(!le)throw new Error(`Drug with ID ${_e} not found.`);const q={...le,...Ae.updates};await me(`/api/drugs/${_e}`,{method:"PUT",body:JSON.stringify(q)}),Ke.push({action:"update_drug",status:"success",id:_e,updates:Ae.updates}),ot.push({role:"system",text:` Updated drug: ${le.name}`})}catch(le){Ke.push({action:"update_drug",status:"error",error:le.message}),ot.push({role:"system",text:` Failed to update drug: ${le.message}`})}}if(Ae.action==="update_lab_test"){const _e=he.find(le=>le.serial_number===Ae.serial_number);if(_e){const le={..._e,...Ae.updates};await me(`/api/lab-tests/${_e.id}`,{method:"PUT",body:JSON.stringify(le)}),Ke.push({action:"update_lab_test",status:"success",item:_e.name}),ot.push({role:"system",text:` Updated lab test: ${_e.name}`})}else Ke.push({action:"update_lab_test",status:"error",error:`Test with serial ${Ae.serial_number} not found`}),ot.push({role:"system",text:` Lab test with serial ${Ae.serial_number} not found`})}if(Ae.action==="search_distributor_purchase"){const _e=Ae.query,le=await me(`/api/distributors?search=${encodeURIComponent(_e)}`);if(le.ok){const q=await le.json();g(q),v(_e),Ke.push({action:"search_distributor_purchase",status:"success",count:q.length,results:q}),ot.push({role:"system",text:` Found ${q.length} distributors for "${_e}"`})}else Ke.push({action:"search_distributor_purchase",status:"error",error:le.statusText}),ot.push({role:"system",text:" Failed to search distributors"})}if(Ae.action==="set_distributor_purchase"){const _e=Ae.distributorId;let le=T.find(q=>q.id===_e);le?(b(le),v(le.name),Ke.push({action:"set_distributor_purchase",status:"success",distributor:le.name}),ot.push({role:"system",text:` Selected distributor: ${le.name}`})):(Ke.push({action:"set_distributor_purchase",status:"error",error:"Distributor not found in current search results. Please search first."}),ot.push({role:"system",text:" Distributor not found. Please search first."}))}if(Ae.action==="add_purchase_items"){const _e=Ae.items;let le=0;_e.forEach(q=>{const be={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:q.name||"",composition:q.composition||"",description:q.description||"",mrp:q.mrp||0,stock:q.stock||0,pack:q.pack||"",supplier:"",expiry_date:q.expiry_date||"",rate:q.rate||0,box_number:q.box_number||"",gst:q.gst||0,margin:q.margin||0,discount:q.discount||0,brand_name:q.brand_name||"",batch:q.batch||"",hsn_code:q.hsn_code||"",mfg:q.mfg||"",loose:q.loose||0,last_updated:"",created_at:""};S(be),le++}),Ke.push({action:"add_purchase_items",status:"success",count:le}),ot.push({role:"system",text:` Added ${le} items to purchase list`})}if(Ae.action==="edit_purchase_items"){const _e=Ae.updates;let le=0;const q=F.current||[];_e.forEach(de=>{if(de.serial_number){const be=de.serial_number-1,$e=q[be];$e&&$e.id?(k($e.id,{[de.field]:de.value}),le++):(console.warn(`Row with serial number ${de.serial_number} not found.`),ot.push({role:"system",text:` Row #${de.serial_number} not found.`}))}}),Ke.push({action:"edit_purchase_items",status:"success",count:le}),ot.push({role:"system",text:` Updated ${le} items`})}if(Ae.action==="open_new_case"){const{name:_e,age:le,gender:q,complaint:de,phone:be}=Ae;try{const $e=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:_e||"New Patient",age:le||null,gender:q||null,phone:be||null,address:null})});if(!$e.ok){const Et=await $e.json().catch(()=>({}));throw $e.status===403&&((ee=Et.message)!=null&&ee.includes("Patient limit"))?new Error(`Patient limit reached: ${Et.message}`):new Error(Et.message||"Failed to create patient")}const nt=await $e.json();if(!nt||!nt.id)throw new Error("Created patient has no ID");const ht=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:nt.id,complaint:de||"New Case"})});if(!ht.ok)throw new Error("Failed to create queue entry");const wt=await ht.json();o(`/dashboard/edit-complaint/${wt.id}`,{state:{initialComplaint:de}}),Ke.push({action:"open_new_case",status:"success",patientId:nt.id,queueId:wt.id}),ot.push({role:"system",text:` Opened new case for ${_e}`}),K(!1),z.current=!1;return}catch($e){$e.message.includes("Patient limit")&&(o("/start-clinic-subscription"),ot.push({role:"system",text:" Patient limit reached. Redirecting to subscription."})),Ke.push({action:"open_new_case",status:"error",error:$e.message}),ot.push({role:"system",text:` Failed to open new case: ${$e.message}`})}}}catch(_e){console.error("Action execution failed",Ae,_e),Ke.push({action:Ae.action,status:"error",error:_e.message}),ot.push({role:"system",text:` Failed to execute action: ${Ae.action}`})}}it.length>0&&a&&setTimeout(()=>a(it),500),ot.length>0&&U(Ae=>[...Ae,...ot]);const vt=[...D,...Ke],Ee=`Reflecting on previous actions: ${JSON.stringify(Ke)}. What is the next step? If done, call end_task.`,Je=[...ge,...ot,{role:"model",text:Ye},{role:"user",text:Ee}];await oe(Ee,Je,vt,void 0)}catch(X){console.error(X),U(ye=>[...ye,{role:"model",text:"Something went wrong."}]),K(!1),z.current=!1}}};return{chatQuery:R,setChatQuery:I,chatHistory:L,isProcessing:H,handleSendMessage:ce=>{const ge=ce!==void 0?ce:R;if(!ge.trim()&&!M)return;z.current=!0,K(!0),W.current=0;const D={role:"user",text:ge};M&&(D.text+=" [Image Attached]"),U(Ce=>[...Ce,D]);const pe=M||void 0;I(""),$(null),oe(ge,L,[],pe)},refreshChat:()=>{U([]),I(""),K(!1),z.current=!1,W.current=0,$(null)},stopGeneration:V,selectedImage:M,handleImageSelect:G,clearImage:J}};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_3=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),JN=e=>{const n=_3(e);return n.charAt(0).toUpperCase()+n.slice(1)},Fk=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var j3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...d},f)=>w.createElement("svg",{ref:f,...j3,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:Fk("lucide",a),...d},[...l.map(([u,h])=>w.createElement(u,h)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=(e,n)=>{const t=w.forwardRef(({className:r,...a},o)=>w.createElement(k3,{ref:o,iconNode:n,className:Fk(`lucide-${C3(JN(e))}`,`lucide-${e}`,r),...a}));return t.displayName=JN(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],KN=ft("activity",T3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],XN=ft("arrow-down",E3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],cn=ft("arrow-left",A3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],C1=ft("arrow-up",P3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"M8 8h8",key:"1bis0t"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m13 17-5-1h1a4 4 0 0 0 0-8",key:"nu2bwa"}]],$k=ft("badge-indian-rupee",D3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],R3=ft("beaker",I3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],O3=ft("bed-double",M3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],rb=ft("bot",L3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],$3=ft("brain-circuit",F3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],zk=ft("brain",z3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M12 11v4",key:"a6ujw6"}],["path",{d:"M14 13h-4",key:"1pl8zg"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M18 6v14",key:"1mu4gy"}],["path",{d:"M6 6v14",key:"1s15cj"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],U3=ft("briefcase-medical",B3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],V3=ft("building",q3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],ZN=ft("calendar-check-2",H3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Y3=ft("calendar-days",G3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],vu=ft("calendar",W3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ib=ft("check",Q3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],eC=ft("chevron-down",J3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ib=ft("chevron-left",K3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Zh=ft("chevron-right",X3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],tC=ft("chevron-up",Z3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ar=ft("circle-alert",e6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ca=ft("circle-check-big",t6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],r6=ft("circle-minus",n6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Qa=ft("circle-plus",i6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],s6=ft("circle-user",a6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o6=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Aw=ft("clipboard-list",o6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l6=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],_1=ft("clipboard",l6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Pw=ft("clock",c6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],d6=ft("copy",u6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f6=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Bk=ft("credit-card",f6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Hh=ft("dollar-sign",h6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p6=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],m6=ft("eye",p6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g6=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],y6=ft("file-check",g6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x6=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],fo=ft("file-text",x6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],po=ft("flask-conical",b6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v6=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],w6=ft("funnel",v6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],eg=ft("hash",S6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N6=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Uk=ft("house",N6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ml=ft("info",C6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _6=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],qk=ft("key",_6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],k6=ft("layout-dashboard",j6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T6=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Vk=ft("layout-grid",T6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E6=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],A6=ft("list-ordered",E6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],D6=ft("list",P6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I6=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],mo=ft("loader-circle",I6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],nC=ft("lock",R6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Hk=ft("map-pin",M6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O6=[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],L6=ft("maximize-2",O6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F6=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],$6=ft("mic-off",F6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z6=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],fg=ft("mic",z6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B6=[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],U6=ft("minimize-2",B6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],V6=ft("monitor",q6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H6=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],G6=ft("package-open",H6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Wd=ft("package",Y6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W6=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],Rb=ft("paperclip",W6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],J6=ft("pause",Q6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],a0=ft("pen",K6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],uo=ft("pencil",X6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],Gk=ft("phone",Z6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Qd=ft("pill",eF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],nF=ft("play",tF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],_s=ft("plus",rF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],hl=ft("printer",iF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],j1=ft("refresh-cw",aF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Yk=ft("rotate-cw",sF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Jd=ft("save",oF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Pr=ft("search",lF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Mb=ft("send",cF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],rC=ft("server-crash",uF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ob=ft("settings",dF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Wk=ft("share-2",fF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],pF=ft("shield-check",hF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],gF=ft("shield",mF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],k1=ft("shopping-cart",yF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],bF=ft("sparkles",xF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],yl=ft("square-pen",vF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],SF=ft("square",wF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],Qk=ft("stethoscope",NF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],_F=ft("table",CF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],kF=ft("tag",jF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],jr=ft("trash-2",TF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],AF=ft("triangle-alert",EF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],DF=ft("truck",PF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],RF=ft("upload",IF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],Dw=ft("user-check",MF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Iw=ft("user-plus",OF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ts=ft("user",LF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],ep=ft("users",FF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],zF=ft("video",$F);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Sn=ft("x",BF);function UF(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const qF=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,VF=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,HF={};function iC(e,n){return(HF.jsx?VF:qF).test(e)}const GF=/[ \t\n\f\r]/g;function YF(e){return typeof e=="object"?e.type==="text"?aC(e.value):!1:aC(e)}function aC(e){return e.replace(GF,"")===""}let hg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};hg.prototype.normal={};hg.prototype.property={};hg.prototype.space=void 0;function Jk(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new hg(t,r,n)}function T1(e){return e.toLowerCase()}let ja=class{constructor(n,t){this.attribute=t,this.property=n}};ja.prototype.attribute="";ja.prototype.booleanish=!1;ja.prototype.boolean=!1;ja.prototype.commaOrSpaceSeparated=!1;ja.prototype.commaSeparated=!1;ja.prototype.defined=!1;ja.prototype.mustUseProperty=!1;ja.prototype.number=!1;ja.prototype.overloadedBoolean=!1;ja.prototype.property="";ja.prototype.spaceSeparated=!1;ja.prototype.space=void 0;let WF=0;const Xt=nf(),Qr=nf(),Kk=nf(),ut=nf(),ur=nf(),Lh=nf(),Ga=nf();function nf(){return 2**++WF}const E1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Xt,booleanish:Qr,commaOrSpaceSeparated:Ga,commaSeparated:Lh,number:ut,overloadedBoolean:Kk,spaceSeparated:ur},Symbol.toStringTag,{value:"Module"})),s0=Object.keys(E1);let Rw=class extends ja{constructor(n,t,r,a){let o=-1;if(super(n,t),sC(this,"space",a),typeof r=="number")for(;++o<s0.length;){const l=s0[o];sC(this,s0[o],(r&E1[l])===E1[l])}}};Rw.prototype.defined=!0;function sC(e,n,t){t&&(e[n]=t)}function tp(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new Rw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[T1(r)]=r,t[T1(o.attribute)]=r}return new hg(n,t,e.space)}const Xk=tp({properties:{ariaActiveDescendant:null,ariaAtomic:Qr,ariaAutoComplete:null,ariaBusy:Qr,ariaChecked:Qr,ariaColCount:ut,ariaColIndex:ut,ariaColSpan:ut,ariaControls:ur,ariaCurrent:null,ariaDescribedBy:ur,ariaDetails:null,ariaDisabled:Qr,ariaDropEffect:ur,ariaErrorMessage:null,ariaExpanded:Qr,ariaFlowTo:ur,ariaGrabbed:Qr,ariaHasPopup:null,ariaHidden:Qr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ur,ariaLevel:ut,ariaLive:null,ariaModal:Qr,ariaMultiLine:Qr,ariaMultiSelectable:Qr,ariaOrientation:null,ariaOwns:ur,ariaPlaceholder:null,ariaPosInSet:ut,ariaPressed:Qr,ariaReadOnly:Qr,ariaRelevant:null,ariaRequired:Qr,ariaRoleDescription:ur,ariaRowCount:ut,ariaRowIndex:ut,ariaRowSpan:ut,ariaSelected:Qr,ariaSetSize:ut,ariaSort:null,ariaValueMax:ut,ariaValueMin:ut,ariaValueNow:ut,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function Zk(e,n){return n in e?e[n]:n}function e2(e,n){return Zk(e,n.toLowerCase())}const QF=tp({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Lh,acceptCharset:ur,accessKey:ur,action:null,allow:null,allowFullScreen:Xt,allowPaymentRequest:Xt,allowUserMedia:Xt,alt:null,as:null,async:Xt,autoCapitalize:null,autoComplete:ur,autoFocus:Xt,autoPlay:Xt,blocking:ur,capture:null,charSet:null,checked:Xt,cite:null,className:ur,cols:ut,colSpan:null,content:null,contentEditable:Qr,controls:Xt,controlsList:ur,coords:ut|Lh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Xt,defer:Xt,dir:null,dirName:null,disabled:Xt,download:Kk,draggable:Qr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Xt,formTarget:null,headers:ur,height:ut,hidden:Xt,high:ut,href:null,hrefLang:null,htmlFor:ur,httpEquiv:ur,id:null,imageSizes:null,imageSrcSet:null,inert:Xt,inputMode:null,integrity:null,is:null,isMap:Xt,itemId:null,itemProp:ur,itemRef:ur,itemScope:Xt,itemType:ur,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Xt,low:ut,manifest:null,max:null,maxLength:ut,media:null,method:null,min:null,minLength:ut,multiple:Xt,muted:Xt,name:null,nonce:null,noModule:Xt,noValidate:Xt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Xt,optimum:ut,pattern:null,ping:ur,placeholder:null,playsInline:Xt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Xt,referrerPolicy:null,rel:ur,required:Xt,reversed:Xt,rows:ut,rowSpan:ut,sandbox:ur,scope:null,scoped:Xt,seamless:Xt,selected:Xt,shadowRootClonable:Xt,shadowRootDelegatesFocus:Xt,shadowRootMode:null,shape:null,size:ut,sizes:null,slot:null,span:ut,spellCheck:Qr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ut,step:null,style:null,tabIndex:ut,target:null,title:null,translate:null,type:null,typeMustMatch:Xt,useMap:null,value:Qr,width:ut,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ur,axis:null,background:null,bgColor:null,border:ut,borderColor:null,bottomMargin:ut,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Xt,declare:Xt,event:null,face:null,frame:null,frameBorder:null,hSpace:ut,leftMargin:ut,link:null,longDesc:null,lowSrc:null,marginHeight:ut,marginWidth:ut,noResize:Xt,noHref:Xt,noShade:Xt,noWrap:Xt,object:null,profile:null,prompt:null,rev:null,rightMargin:ut,rules:null,scheme:null,scrolling:Qr,standby:null,summary:null,text:null,topMargin:ut,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ut,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Xt,disableRemotePlayback:Xt,prefix:null,property:null,results:ut,security:null,unselectable:null},space:"html",transform:e2}),JF=tp({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ga,accentHeight:ut,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ut,amplitude:ut,arabicForm:null,ascent:ut,attributeName:null,attributeType:null,azimuth:ut,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ut,by:null,calcMode:null,capHeight:ut,className:ur,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ut,diffuseConstant:ut,direction:null,display:null,dur:null,divisor:ut,dominantBaseline:null,download:Xt,dx:null,dy:null,edgeMode:null,editable:null,elevation:ut,enableBackground:null,end:null,event:null,exponent:ut,externalResourcesRequired:null,fill:null,fillOpacity:ut,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Lh,g2:Lh,glyphName:Lh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ut,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ut,horizOriginX:ut,horizOriginY:ut,id:null,ideographic:ut,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ut,k:ut,k1:ut,k2:ut,k3:ut,k4:ut,kernelMatrix:Ga,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ut,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ut,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ut,overlineThickness:ut,paintOrder:null,panose1:null,path:null,pathLength:ut,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ur,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ut,pointsAtY:ut,pointsAtZ:ut,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ga,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ga,rev:Ga,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ga,requiredFeatures:Ga,requiredFonts:Ga,requiredFormats:Ga,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ut,specularExponent:ut,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ut,strikethroughThickness:ut,string:null,stroke:null,strokeDashArray:Ga,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ut,strokeOpacity:ut,strokeWidth:null,style:null,surfaceScale:ut,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ga,tabIndex:ut,tableValues:null,target:null,targetX:ut,targetY:ut,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ga,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ut,underlineThickness:ut,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ut,values:null,vAlphabetic:ut,vMathematical:ut,vectorEffect:null,vHanging:ut,vIdeographic:ut,version:null,vertAdvY:ut,vertOriginX:ut,vertOriginY:ut,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ut,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Zk}),t2=tp({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),n2=tp({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:e2}),r2=tp({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),KF={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},XF=/[A-Z]/g,oC=/-[a-z]/g,ZF=/^data[-\w.:]+$/i;function e$(e,n){const t=T1(n);let r=n,a=ja;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&ZF.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(oC,n$);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!oC.test(o)){let l=o.replace(XF,t$);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=Rw}return new a(r,n)}function t$(e){return"-"+e.toLowerCase()}function n$(e){return e.charAt(1).toUpperCase()}const r$=Jk([Xk,QF,t2,n2,r2],"html"),Mw=Jk([Xk,JF,t2,n2,r2],"svg");function i$(e){return e.join(" ").trim()}var _h={},o0,lC;function a$(){if(lC)return o0;lC=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,d=/^\s+|\s+$/g,f=`
`,u="/",h="*",g="",b="comment",v="declaration";o0=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var P=1,R=1;function I(W){var te=W.match(n);te&&(P+=te.length);var V=W.lastIndexOf(f);R=~V?W.length-V:R+W.length}function B(){var W={line:P,column:R};return function(te){return te.position=new F(W),H(),te}}function F(W){this.start=W,this.end={line:P,column:R},this.source=T.source}F.prototype.content=k;function L(W){var te=new Error(T.source+":"+P+":"+R+": "+W);if(te.reason=W,te.filename=T.source,te.line=P,te.column=R,te.source=k,!T.silent)throw te}function U(W){var te=W.exec(k);if(te){var V=te[0];return I(V),k=k.slice(V.length),te}}function H(){U(t)}function K(W){var te;for(W=W||[];te=M();)te!==!1&&W.push(te);return W}function M(){var W=B();if(!(u!=k.charAt(0)||h!=k.charAt(1))){for(var te=2;g!=k.charAt(te)&&(h!=k.charAt(te)||u!=k.charAt(te+1));)++te;if(te+=2,g===k.charAt(te-1))return L("End of comment missing");var V=k.slice(2,te-2);return R+=2,I(V),k=k.slice(te),R+=2,W({type:b,comment:V})}}function $(){var W=B(),te=U(r);if(te){if(M(),!U(a))return L("property missing ':'");var V=U(o),G=W({type:v,property:S(te[0].replace(e,g)),value:V?S(V[0].replace(e,g)):g});return U(l),G}}function z(){var W=[];K(W);for(var te;te=$();)te!==!1&&(W.push(te),K(W));return W}return H(),z()};function S(k){return k?k.replace(d,g):g}return o0}var cC;function s$(){if(cC)return _h;cC=1;var e=_h&&_h.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(_h,"__esModule",{value:!0}),_h.default=t;var n=e(a$());function t(r,a){var o=null;if(!r||typeof r!="string")return o;var l=(0,n.default)(r),d=typeof a=="function";return l.forEach(function(f){if(f.type==="declaration"){var u=f.property,h=f.value;d?a(u,h,f):h&&(o=o||{},o[u]=h)}}),o}return _h}var Pm={},uC;function o$(){if(uC)return Pm;uC=1,Object.defineProperty(Pm,"__esModule",{value:!0}),Pm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,o=function(u){return!u||t.test(u)||e.test(u)},l=function(u,h){return h.toUpperCase()},d=function(u,h){return"".concat(h,"-")},f=function(u,h){return h===void 0&&(h={}),o(u)?u:(u=u.toLowerCase(),h.reactCompat?u=u.replace(a,d):u=u.replace(r,d),u.replace(n,l))};return Pm.camelCase=f,Pm}var Dm,dC;function l$(){if(dC)return Dm;dC=1;var e=Dm&&Dm.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(s$()),t=o$();function r(a,o){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(d,f){d&&f&&(l[(0,t.camelCase)(d,o)]=f)}),l}return r.default=r,Dm=r,Dm}var c$=l$();const u$=tf(c$),i2=a2("end"),Ow=a2("start");function a2(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function d$(e){const n=Ow(e),t=i2(e);if(n&&t)return{start:n,end:t}}function Ym(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?fC(e.position):"start"in e||"end"in e?fC(e):"line"in e||"column"in e?A1(e):""}function A1(e){return hC(e&&e.line)+":"+hC(e&&e.column)}function fC(e){return A1(e&&e.start)+"-"+A1(e&&e.end)}function hC(e){return e&&typeof e=="number"?e:1}let Ui=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=d?d.line:void 0,this.name=Ym(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}};Ui.prototype.file="";Ui.prototype.name="";Ui.prototype.reason="";Ui.prototype.message="";Ui.prototype.stack="";Ui.prototype.column=void 0;Ui.prototype.line=void 0;Ui.prototype.ancestors=void 0;Ui.prototype.cause=void 0;Ui.prototype.fatal=void 0;Ui.prototype.place=void 0;Ui.prototype.ruleId=void 0;Ui.prototype.source=void 0;const Lw={}.hasOwnProperty,f$=new Map,h$=/[A-Z]/g,p$=new Set(["table","tbody","thead","tfoot","tr"]),m$=new Set(["td","th"]),s2="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function g$(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=C$(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=N$(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?Mw:r$,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=o2(a,e,void 0);return o&&typeof o!="string"?o:a.create(e,a.Fragment,{children:o||void 0},void 0)}function o2(e,n,t){if(n.type==="element")return y$(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return x$(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return v$(e,n,t);if(n.type==="mdxjsEsm")return b$(e,n);if(n.type==="root")return w$(e,n,t);if(n.type==="text")return S$(e,n)}function y$(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=Mw,e.schema=a),e.ancestors.push(n);const o=c2(e,n.tagName,!1),l=_$(e,n);let d=$w(e,n);return p$.has(n.tagName)&&(d=d.filter(function(f){return typeof f=="string"?!YF(f):!0})),l2(e,l,o,n),Fw(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function x$(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}tg(e,n.position)}function b$(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);tg(e,n.position)}function v$(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=Mw,e.schema=a),e.ancestors.push(n);const o=n.name===null?e.Fragment:c2(e,n.name,!0),l=j$(e,n),d=$w(e,n);return l2(e,l,o,n),Fw(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function w$(e,n,t){const r={};return Fw(r,$w(e,n)),e.create(n,e.Fragment,r,t)}function S$(e,n){return n.value}function l2(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function Fw(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function N$(e,n,t){return r;function r(a,o,l,d){const u=Array.isArray(l.children)?t:n;return d?u(o,l,d):u(o,l)}}function C$(e,n){return t;function t(r,a,o,l){const d=Array.isArray(o.children),f=Ow(r);return n(a,o,l,d,{columnNumber:f?f.column-1:void 0,fileName:e,lineNumber:f?f.line:void 0},void 0)}}function _$(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&Lw.call(n.properties,a)){const o=k$(e,a,n.properties[a]);if(o){const[l,d]=o;e.tableCellAlignToStyle&&l==="align"&&typeof d=="string"&&m$.has(n.tagName)?r=d:t[l]=d}}if(r){const o=t.style||(t.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function j$(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const o=r.data.estree.body[0];o.type;const l=o.expression;l.type;const d=l.properties[0];d.type,Object.assign(t,e.evaluater.evaluateExpression(d.argument))}else tg(e,n.position);else{const a=r.name;let o;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const d=r.value.data.estree.body[0];d.type,o=e.evaluater.evaluateExpression(d.expression)}else tg(e,n.position);else o=r.value===null?!0:r.value;t[a]=o}return t}function $w(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:f$;for(;++r<n.children.length;){const o=n.children[r];let l;if(e.passKeys){const f=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(f){const u=a.get(f)||0;l=f+"-"+u,a.set(f,u+1)}}const d=o2(e,o,l);d!==void 0&&t.push(d)}return t}function k$(e,n,t){const r=e$(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?UF(t):i$(t)),r.property==="style"){let a=typeof t=="object"?t:T$(e,String(t));return e.stylePropertyNameCase==="css"&&(a=E$(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?KF[r.property]||r.property:r.attribute,t]}}function T$(e,n){try{return u$(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new Ui("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=s2+"#cannot-parse-style-attribute",a}}function c2(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let o=-1,l;for(;++o<a.length;){const d=iC(a[o])?{type:"Identifier",name:a[o]}:{type:"Literal",value:a[o]};l=l?{type:"MemberExpression",object:l,property:d,computed:!!(o&&d.type==="Literal"),optional:!1}:d}r=l}else r=iC(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return Lw.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);tg(e)}function tg(e,n){const t=new Ui("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=s2+"#cannot-handle-mdx-estrees-without-createevaluater",t}function E$(e){const n={};let t;for(t in e)Lw.call(e,t)&&(n[A$(t)]=e[t]);return n}function A$(e){let n=e.replace(h$,P$);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function P$(e){return"-"+e.toLowerCase()}const l0={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},D$={};function zw(e,n){const t=D$,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return u2(e,r,a)}function u2(e,n,t){if(I$(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return pC(e.children,n,t)}return Array.isArray(e)?pC(e,n,t):""}function pC(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=u2(e[a],n,t);return r.join("")}function I$(e){return!!(e&&typeof e=="object")}const mC=document.createElement("i");function Bw(e){const n="&"+e+";";mC.innerHTML=n;const t=mC.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Ka(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function Ns(e,n){return e.length>0?(Ka(e,e.length,0,n),e):n}const gC={}.hasOwnProperty;function d2(e){const n={};let t=-1;for(;++t<e.length;)R$(n,e[t]);return n}function R$(e,n){let t;for(t in n){const a=(gC.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){gC.call(a,l)||(a[l]=[]);const d=o[l];M$(a[l],Array.isArray(d)?d:d?[d]:[])}}}function M$(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Ka(e,0,0,r)}function f2(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function ho(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const na=_u(/[A-Za-z]/),zi=_u(/[\dA-Za-z]/),O$=_u(/[#-'*+\--9=?A-Z^-~]/);function ab(e){return e!==null&&(e<32||e===127)}const P1=_u(/\d/),L$=_u(/[\dA-Fa-f]/),F$=_u(/[!-/:-@[-`{-~]/);function Ft(e){return e!==null&&e<-2}function ar(e){return e!==null&&(e<0||e===32)}function Nn(e){return e===-2||e===-1||e===32}const Lb=_u(new RegExp("\\p{P}|\\p{S}","u")),Kd=_u(/\s/);function _u(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function np(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&zi(e.charCodeAt(t+1))&&zi(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function Dn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return Nn(f)?(e.enter(t),d(f)):n(f)}function d(f){return Nn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const $$={tokenize:z$};function z$(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),Dn(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Ft(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const B$={tokenize:U$},yC={tokenize:q$};function U$(e){const n=this,t=[];let r=0,a,o,l;return d;function d(I){if(r<t.length){const B=t[r];return n.containerState=B[1],e.attempt(B[0].continuation,f,u)(I)}return u(I)}function f(I){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&R();const B=n.events.length;let F=B,L;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){L=n.events[F][1].end;break}P(r);let U=B;for(;U<n.events.length;)n.events[U][1].end={...L},U++;return Ka(n.events,F+1,0,n.events.slice(B)),n.events.length=U,u(I)}return d(I)}function u(I){if(r===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(yC,h,g)(I)}function h(I){return a&&R(),P(r),b(I)}function g(I){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(yC,v,S)(I)}function v(I){return r++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&R(),P(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(I);return}return Ft(I)?(e.consume(I),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(I),k)}function T(I,B){const F=n.sliceStream(I);if(B&&F.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write(F),n.parser.lazy[I.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const U=n.events.length;let H=U,K,M;for(;H--;)if(n.events[H][0]==="exit"&&n.events[H][1].type==="chunkFlow"){if(K){M=n.events[H][1].end;break}K=!0}for(P(r),L=U;L<n.events.length;)n.events[L][1].end={...M},L++;Ka(n.events,H+1,0,n.events.slice(U)),n.events.length=L}}function P(I){let B=t.length;for(;B-- >I;){const F=t[B];n.containerState=F[1],F[0].exit.call(n,e)}t.length=I}function R(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function q$(e,n,t){return Dn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Gh(e){if(e===null||ar(e)||Kd(e))return 1;if(Lb(e))return 2}function Fb(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const D1={name:"attention",resolveAll:V$,tokenize:H$};function V$(e,n){let t=-1,r,a,o,l,d,f,u,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};xC(g,-f),xC(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Ns(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=Ns(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=Ns(u,Fb(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=Ns(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,u=Ns(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,Ka(e,r-1,t-r+3,u),t=r+u.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function H$(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Gh(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),h=Gh(f),g=!h||h===2&&a||t.includes(f),b=!a||a===2&&h||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(h||!g)),n(f)}}function xC(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const G$={name:"autolink",tokenize:Y$};function Y$(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return na(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||zi(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||zi(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||ab(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),h):O$(v)?(e.consume(v),u):t(v)}function h(v){return zi(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||zi(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const pg={partial:!0,tokenize:W$};function W$(e,n,t){return r;function r(o){return Nn(o)?Dn(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Ft(o)?n(o):t(o)}}const h2={continuation:{tokenize:J$},exit:K$,name:"blockQuote",tokenize:Q$};function Q$(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return Nn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function J$(e,n,t){const r=this;return a;function a(l){return Nn(l)?Dn(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(h2,n,t)(l)}}function K$(e){e.exit("blockQuote")}const p2={name:"characterEscape",tokenize:X$};function X$(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return F$(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const m2={name:"characterReference",tokenize:Z$};function Z$(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=zi,h(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=L$,h):(e.enter("characterReferenceValue"),o=7,l=P1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===zi&&!Bw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),h):t(g)}}const bC={partial:!0,tokenize:t5},vC={concrete:!0,name:"codeFenced",tokenize:e5};function e5(e,n,t){const r=this,a={partial:!0,tokenize:F};let o=0,l=0,d;return f;function f(L){return u(L)}function u(L){const U=r.events[r.events.length-1];return o=U&&U[1].type==="linePrefix"?U[2].sliceSerialize(U[1],!0).length:0,d=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(L)}function h(L){return L===d?(l++,e.consume(L),h):l<3?t(L):(e.exit("codeFencedFenceSequence"),Nn(L)?Dn(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Ft(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(bC,k,B)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Ft(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):Nn(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Dn(e,v,"whitespace")(L)):L===96&&L===d?t(L):(e.consume(L),b)}function v(L){return L===null||Ft(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Ft(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===d?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,B,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),P}function P(L){return o>0&&Nn(L)?Dn(e,R,"linePrefix",o+1)(L):R(L)}function R(L){return L===null||Ft(L)?e.check(bC,k,B)(L):(e.enter("codeFlowValue"),I(L))}function I(L){return L===null||Ft(L)?(e.exit("codeFlowValue"),R(L)):(e.consume(L),I)}function B(L){return e.exit("codeFenced"),n(L)}function F(L,U,H){let K=0;return M;function M(V){return L.enter("lineEnding"),L.consume(V),L.exit("lineEnding"),$}function $(V){return L.enter("codeFencedFence"),Nn(V)?Dn(L,z,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(V):z(V)}function z(V){return V===d?(L.enter("codeFencedFenceSequence"),W(V)):H(V)}function W(V){return V===d?(K++,L.consume(V),W):K>=l?(L.exit("codeFencedFenceSequence"),Nn(V)?Dn(L,te,"whitespace")(V):te(V)):H(V)}function te(V){return V===null||Ft(V)?(L.exit("codeFencedFence"),U(V)):H(V)}}}function t5(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const c0={name:"codeIndented",tokenize:r5},n5={partial:!0,tokenize:i5};function r5(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),Dn(e,o,"linePrefix",5)(u)}function o(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Ft(u)?e.attempt(n5,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Ft(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function i5(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Ft(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):Dn(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Ft(l)?a(l):t(l)}}const a5={name:"codeText",previous:o5,resolve:s5,tokenize:l5};function s5(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function o5(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function l5(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,h(g)):Ft(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Ft(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}let c5=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Im(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Im(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Im(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Im(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Im(this.left,t.reverse())}}};function Im(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function g2(e){const n={};let t=-1,r,a,o,l,d,f,u;const h=new c5(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,u5(h,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=h.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},d=h.slice(a,t),d.unshift(r),h.splice(a,t-a+1,d))}}return Ka(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function u5(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let h,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),R=o.pop();f.push([R,R+P.length-1]),e.splice(R,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const d5={resolve:h5,tokenize:p5},f5={partial:!0,tokenize:m5};function h5(e){return g2(e),e}function p5(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Ft(d)?e.check(f5,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function m5(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Dn(e,o,"linePrefix")}function o(l){if(l===null||Ft(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function y2(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let h=0;return g;function g(P){return P===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||ab(P)?t(P):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||Ft(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!h&&(P===null||P===41||ar(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(P)):h<u&&P===40?(e.consume(P),h++,k):P===41?(e.consume(P),h--,k):P===null||P===32||P===40||ab(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function x2(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),h}function h(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Ft(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Ft(v)||d++>999?(e.exit("chunkString"),h(v)):(e.consume(v),f||(f=!Nn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function b2(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Ft(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),Dn(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||Ft(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function Wm(e,n){let t;return r;function r(a){return Ft(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):Nn(a)?Dn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const g5={name:"definition",tokenize:x5},y5={partial:!0,tokenize:b5};function x5(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return x2.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=ho(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return ar(v)?Wm(e,u)(v):u(v)}function u(v){return y2(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(y5,g,g)(v)}function g(v){return Nn(v)?Dn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Ft(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function b5(e,n,t){return r;function r(d){return ar(d)?Wm(e,a)(d):t(d)}function a(d){return b2(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return Nn(d)?Dn(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Ft(d)?n(d):t(d)}}const v5={name:"hardBreakEscape",tokenize:w5};function w5(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Ft(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const S5={name:"headingAtx",resolve:N5,tokenize:C5};function N5(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Ka(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function C5(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),o(h)}function o(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||ar(h)?(e.exit("atxHeadingSequence"),d(h)):t(h)}function d(h){return h===35?(e.enter("atxHeadingSequence"),f(h)):h===null||Ft(h)?(e.exit("atxHeading"),n(h)):Nn(h)?Dn(e,d,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function f(h){return h===35?(e.consume(h),f):(e.exit("atxHeadingSequence"),d(h))}function u(h){return h===null||h===35||ar(h)?(e.exit("atxHeadingText"),d(h)):(e.consume(h),u)}}const _5=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],wC=["pre","script","style","textarea"],j5={concrete:!0,name:"htmlFlow",resolveTo:E5,tokenize:A5},k5={partial:!0,tokenize:D5},T5={partial:!0,tokenize:P5};function E5(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function A5(e,n,t){const r=this;let a,o,l,d,f;return u;function u(D){return h(D)}function h(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,r.interrupt?n:E):na(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):na(D)?(e.consume(D),a=4,r.interrupt?n:E):t(D)}function v(D){return D===45?(e.consume(D),r.interrupt?n:E):t(D)}function S(D){const pe="CDATA[";return D===pe.charCodeAt(d++)?(e.consume(D),d===pe.length?r.interrupt?n:z:S):t(D)}function k(D){return na(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||ar(D)){const pe=D===47,Ce=l.toLowerCase();return!pe&&!o&&wC.includes(Ce)?(a=1,r.interrupt?n(D):z(D)):_5.includes(l.toLowerCase())?(a=6,pe?(e.consume(D),P):r.interrupt?n(D):z(D)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(D):o?R(D):I(D))}return D===45||zi(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),r.interrupt?n:z):t(D)}function R(D){return Nn(D)?(e.consume(D),R):M(D)}function I(D){return D===47?(e.consume(D),M):D===58||D===95||na(D)?(e.consume(D),B):Nn(D)?(e.consume(D),I):M(D)}function B(D){return D===45||D===46||D===58||D===95||zi(D)?(e.consume(D),B):F(D)}function F(D){return D===61?(e.consume(D),L):Nn(D)?(e.consume(D),F):I(D)}function L(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,U):Nn(D)?(e.consume(D),L):H(D)}function U(D){return D===f?(e.consume(D),f=null,K):D===null||Ft(D)?t(D):(e.consume(D),U)}function H(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||ar(D)?F(D):(e.consume(D),H)}function K(D){return D===47||D===62||Nn(D)?I(D):t(D)}function M(D){return D===62?(e.consume(D),$):t(D)}function $(D){return D===null||Ft(D)?z(D):Nn(D)?(e.consume(D),$):t(D)}function z(D){return D===45&&a===2?(e.consume(D),G):D===60&&a===1?(e.consume(D),J):D===62&&a===4?(e.consume(D),ce):D===63&&a===3?(e.consume(D),E):D===93&&a===5?(e.consume(D),ie):Ft(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(k5,ge,W)(D)):D===null||Ft(D)?(e.exit("htmlFlowData"),W(D)):(e.consume(D),z)}function W(D){return e.check(T5,te,ge)(D)}function te(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),V}function V(D){return D===null||Ft(D)?W(D):(e.enter("htmlFlowData"),z(D))}function G(D){return D===45?(e.consume(D),E):z(D)}function J(D){return D===47?(e.consume(D),l="",oe):z(D)}function oe(D){if(D===62){const pe=l.toLowerCase();return wC.includes(pe)?(e.consume(D),ce):z(D)}return na(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),oe):z(D)}function ie(D){return D===93?(e.consume(D),E):z(D)}function E(D){return D===62?(e.consume(D),ce):D===45&&a===2?(e.consume(D),E):z(D)}function ce(D){return D===null||Ft(D)?(e.exit("htmlFlowData"),ge(D)):(e.consume(D),ce)}function ge(D){return e.exit("htmlFlow"),n(D)}}function P5(e,n,t){const r=this;return a;function a(l){return Ft(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function D5(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(pg,n,t)}}const I5={name:"htmlText",tokenize:R5};function R5(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),F):E===63?(e.consume(E),I):na(E)?(e.consume(E),H):t(E)}function u(E){return E===45?(e.consume(E),h):E===91?(e.consume(E),o=0,S):na(E)?(e.consume(E),R):t(E)}function h(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Ft(E)?(l=g,J(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?G(E):E===45?b(E):g(E)}function S(E){const ce="CDATA[";return E===ce.charCodeAt(o++)?(e.consume(E),o===ce.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Ft(E)?(l=k,J(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),P):k(E)}function P(E){return E===62?G(E):E===93?(e.consume(E),P):k(E)}function R(E){return E===null||E===62?G(E):Ft(E)?(l=R,J(E)):(e.consume(E),R)}function I(E){return E===null?t(E):E===63?(e.consume(E),B):Ft(E)?(l=I,J(E)):(e.consume(E),I)}function B(E){return E===62?G(E):I(E)}function F(E){return na(E)?(e.consume(E),L):t(E)}function L(E){return E===45||zi(E)?(e.consume(E),L):U(E)}function U(E){return Ft(E)?(l=U,J(E)):Nn(E)?(e.consume(E),U):G(E)}function H(E){return E===45||zi(E)?(e.consume(E),H):E===47||E===62||ar(E)?K(E):t(E)}function K(E){return E===47?(e.consume(E),G):E===58||E===95||na(E)?(e.consume(E),M):Ft(E)?(l=K,J(E)):Nn(E)?(e.consume(E),K):G(E)}function M(E){return E===45||E===46||E===58||E===95||zi(E)?(e.consume(E),M):$(E)}function $(E){return E===61?(e.consume(E),z):Ft(E)?(l=$,J(E)):Nn(E)?(e.consume(E),$):K(E)}function z(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,W):Ft(E)?(l=z,J(E)):Nn(E)?(e.consume(E),z):(e.consume(E),te)}function W(E){return E===a?(e.consume(E),a=void 0,V):E===null?t(E):Ft(E)?(l=W,J(E)):(e.consume(E),W)}function te(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||ar(E)?K(E):(e.consume(E),te)}function V(E){return E===47||E===62||ar(E)?K(E):t(E)}function G(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function J(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),oe}function oe(E){return Nn(E)?Dn(e,ie,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):ie(E)}function ie(E){return e.enter("htmlTextData"),l(E)}}const Uw={name:"labelEnd",resolveAll:F5,resolveTo:$5,tokenize:z5},M5={tokenize:B5},O5={tokenize:U5},L5={tokenize:q5};function F5(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Ka(e,0,e.length,t),e}function $5(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=Ns(d,e.slice(o+1,o+r+3)),d=Ns(d,[["enter",h,n]]),d=Ns(d,Fb(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=Ns(d,[["exit",h,n],e[l-2],e[l-1],["exit",u,n]]),d=Ns(d,e.slice(l+1)),d=Ns(d,[["exit",f,n]]),Ka(e,o,e.length,d),e}function z5(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(ho(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(M5,h,l?h:g)(b):b===91?e.attempt(O5,h,l?u:g)(b):l?h(b):g(b)}function u(b){return e.attempt(L5,h,g)(b)}function h(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function B5(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return ar(g)?Wm(e,o)(g):o(g)}function o(g){return g===41?h(g):y2(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return ar(g)?Wm(e,f)(g):h(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?b2(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function u(g){return ar(g)?Wm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function U5(e,n,t){const r=this;return a;function a(d){return x2.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes(ho(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function q5(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const V5={name:"labelStartImage",resolveAll:Uw.resolveAll,tokenize:H5};function H5(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const G5={name:"labelStartLink",resolveAll:Uw.resolveAll,tokenize:Y5};function Y5(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const u0={name:"lineEnding",tokenize:W5};function W5(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Dn(e,n,"linePrefix")}}const Hx={name:"thematicBreak",tokenize:Q5};function Q5(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Ft(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),Nn(u)?Dn(e,d,"whitespace")(u):d(u))}}const ba={continuation:{tokenize:Z5},exit:tz,name:"list",tokenize:X5},J5={partial:!0,tokenize:nz},K5={partial:!0,tokenize:ez};function X5(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:P1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Hx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return P1(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(pg,r.interrupt?t:h,e.attempt(J5,b,g))}function h(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return Nn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function Z5(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(pg,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Dn(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!Nn(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(K5,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,Dn(e,e.attempt(ba,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function ez(e,n,t){const r=this;return Dn(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function tz(e){e.exit(this.containerState.type)}function nz(e,n,t){const r=this;return Dn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!Nn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const SC={name:"setextUnderline",resolveTo:rz,tokenize:iz};function rz(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function iz(e,n,t){const r=this;let a;return o;function o(u){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),Nn(u)?Dn(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Ft(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const az={tokenize:sz};function sz(e){const n=this,t=e.attempt(pg,r,e.attempt(this.parser.constructs.flowInitial,a,Dn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(d5,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const oz={resolveAll:w2()},lz=v2("string"),cz=v2("text");function v2(e){return{resolveAll:w2(e==="text"?uz:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(h){return u(h)?o(h):d(h)}function d(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),f}function f(h){return u(h)?(t.exit("data"),o(h)):(t.consume(h),f)}function u(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function w2(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function uz(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const dz={42:ba,43:ba,45:ba,48:ba,49:ba,50:ba,51:ba,52:ba,53:ba,54:ba,55:ba,56:ba,57:ba,62:h2},fz={91:g5},hz={[-2]:c0,[-1]:c0,32:c0},pz={35:S5,42:Hx,45:[SC,Hx],60:j5,61:SC,95:Hx,96:vC,126:vC},mz={38:m2,92:p2},gz={[-5]:u0,[-4]:u0,[-3]:u0,33:V5,38:m2,42:D1,60:[G$,I5],91:G5,92:[v5,p2],93:Uw,95:D1,96:a5},yz={null:[D1,oz]},xz={null:[42,95]},bz={null:[]},vz=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:xz,contentInitial:fz,disable:bz,document:dz,flow:pz,flowInitial:hz,insideSpan:yz,string:mz,text:gz},Symbol.toStringTag,{value:"Module"}));function wz(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:U(F),check:U(L),consume:R,enter:I,exit:B,interrupt:U(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g($){return l=Ns(l,$),T(),l[l.length-1]!==null?[]:(H(n,0),u.events=Fb(o,u.events,u),u.events)}function b($,z){return Nz(v($),z)}function v($){return Sz(l,$)}function S(){const{_bufferIndex:$,_index:z,line:W,column:te,offset:V}=r;return{_bufferIndex:$,_index:z,line:W,column:te,offset:V}}function k($){a[$.line]=$.column,M()}function T(){let $;for(;r._index<l.length;){const z=l[r._index];if(typeof z=="string")for($=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===$&&r._bufferIndex<z.length;)P(z.charCodeAt(r._bufferIndex));else P(z)}}function P($){h=h($)}function R($){Ft($)?(r.line++,r.column=1,r.offset+=$===-3?2:1,M()):$!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=$}function I($,z){const W=z||{};return W.type=$,W.start=S(),u.events.push(["enter",W,u]),d.push(W),W}function B($){const z=d.pop();return z.end=S(),u.events.push(["exit",z,u]),z}function F($,z){H($,z.from)}function L($,z){z.restore()}function U($,z){return W;function W(te,V,G){let J,oe,ie,E;return Array.isArray(te)?ge(te):"tokenize"in te?ge([te]):ce(te);function ce(Z){return ee;function ee(X){const ye=X!==null&&Z[X],He=X!==null&&Z.null,he=[...Array.isArray(ye)?ye:ye?[ye]:[],...Array.isArray(He)?He:He?[He]:[]];return ge(he)(X)}}function ge(Z){return J=Z,oe=0,Z.length===0?G:D(Z[oe])}function D(Z){return ee;function ee(X){return E=K(),ie=Z,Z.partial||(u.currentConstruct=Z),Z.name&&u.parser.constructs.disable.null.includes(Z.name)?Ce():Z.tokenize.call(z?Object.assign(Object.create(u),z):u,f,pe,Ce)(X)}}function pe(Z){return $(ie,E),V}function Ce(Z){return E.restore(),++oe<J.length?D(J[oe]):G}}}function H($,z){$.resolveAll&&!o.includes($)&&o.push($),$.resolve&&Ka(u.events,z,u.events.length-z,$.resolve(u.events.slice(z),u)),$.resolveTo&&(u.events=$.resolveTo(u.events,u))}function K(){const $=S(),z=u.previous,W=u.currentConstruct,te=u.events.length,V=Array.from(d);return{from:te,restore:G};function G(){r=$,u.previous=z,u.currentConstruct=W,u.events.length=te,d=V,M()}}function M(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function Sz(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function Nz(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function Cz(e){const r={constructs:d2([vz,...(e||{}).extensions||[]]),content:a($$),defined:[],document:a(B$),flow:a(az),lazy:{},string:a(lz),text:a(cz)};return r;function a(o){return l;function l(d){return wz(r,o,d)}}}function _z(e){for(;!g2(e););return e}const NC=/[\0\t\n\r]/g;function jz(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,h,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(NC.lastIndex=g,u=NC.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,f.push(-2);e++<h;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const kz=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Tz(e){return e.replace(kz,Ez)}function Ez(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return f2(t.slice(o?2:1),o?16:10)}return Bw(t)||e}const S2={}.hasOwnProperty;function Az(e,n,t){return typeof n!="string"&&(t=n,n=void 0),Pz(t)(_z(Cz(t).document().write(jz()(e,n,!0))))}function Pz(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(ot),autolinkProtocol:K,autolinkEmail:K,atxHeading:o(Ye),blockQuote:o(He),characterEscape:K,characterReference:K,codeFenced:o(he),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(he,l),codeText:o(Le,l),codeTextData:K,data:K,codeFlowValue:K,definition:o(ue),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(De),hardBreakEscape:o(et),hardBreakTrailing:o(et),htmlFlow:o(Ke,l),htmlFlowData:K,htmlText:o(Ke,l),htmlTextData:K,image:o(it),label:l,link:o(ot),listItem:o(Ee),listItemValue:b,listOrdered:o(vt,g),listUnordered:o(vt),paragraph:o(Je),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(Ye),strong:o(Ae),thematicBreak:o(le)},exit:{atxHeading:f(),atxHeadingSequence:F,autolink:f(),autolinkEmail:ye,autolinkProtocol:X,blockQuote:f(),characterEscapeValue:M,characterReferenceMarkerHexadecimal:Ce,characterReferenceMarkerNumeric:Ce,characterReferenceValue:Z,characterReference:ee,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:M,codeIndented:f(P),codeText:f(V),codeTextData:M,data:M,definition:f(),definitionDestinationString:B,definitionLabelString:R,definitionTitleString:I,emphasis:f(),hardBreakEscape:f(z),hardBreakTrailing:f(z),htmlFlow:f(W),htmlFlowData:M,htmlText:f(te),htmlTextData:M,image:f(J),label:ie,labelText:oe,lineEnding:$,link:f(G),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:pe,resourceDestinationString:E,resourceTitleString:ce,resource:ge,setextHeading:f(H),setextHeadingLineSequence:U,setextHeadingText:L,strong:f(),thematicBreak:f()}};N2(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(q){let de={type:"root",children:[]};const be={stack:[de],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:h,data:t},$e=[];let nt=-1;for(;++nt<q.length;)if(q[nt][1].type==="listOrdered"||q[nt][1].type==="listUnordered")if(q[nt][0]==="enter")$e.push(nt);else{const ht=$e.pop();nt=a(q,ht,nt)}for(nt=-1;++nt<q.length;){const ht=n[q[nt][0]];S2.call(ht,q[nt][1].type)&&ht[q[nt][1].type].call(Object.assign({sliceSerialize:q[nt][2].sliceSerialize},be),q[nt][1])}if(be.tokenStack.length>0){const ht=be.tokenStack[be.tokenStack.length-1];(ht[1]||CC).call(be,void 0,ht[0])}for(de.position={start:fu(q.length>0?q[0][1].start:{line:1,column:1,offset:0}),end:fu(q.length>0?q[q.length-2][1].end:{line:1,column:1,offset:0})},nt=-1;++nt<n.transforms.length;)de=n.transforms[nt](de)||de;return de}function a(q,de,be){let $e=de-1,nt=-1,ht=!1,wt,Et,ve,ke;for(;++$e<=be;){const Ne=q[$e];switch(Ne[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ne[0]==="enter"?nt++:nt--,ke=void 0;break}case"lineEndingBlank":{Ne[0]==="enter"&&(wt&&!ke&&!nt&&!ve&&(ve=$e),ke=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:ke=void 0}if(!nt&&Ne[0]==="enter"&&Ne[1].type==="listItemPrefix"||nt===-1&&Ne[0]==="exit"&&(Ne[1].type==="listUnordered"||Ne[1].type==="listOrdered")){if(wt){let Oe=$e;for(Et=void 0;Oe--;){const Ve=q[Oe];if(Ve[1].type==="lineEnding"||Ve[1].type==="lineEndingBlank"){if(Ve[0]==="exit")continue;Et&&(q[Et][1].type="lineEndingBlank",ht=!0),Ve[1].type="lineEnding",Et=Oe}else if(!(Ve[1].type==="linePrefix"||Ve[1].type==="blockQuotePrefix"||Ve[1].type==="blockQuotePrefixWhitespace"||Ve[1].type==="blockQuoteMarker"||Ve[1].type==="listItemIndent"))break}ve&&(!Et||ve<Et)&&(wt._spread=!0),wt.end=Object.assign({},Et?q[Et][1].start:Ne[1].end),q.splice(Et||$e,0,["exit",wt,Ne[2]]),$e++,be++}if(Ne[1].type==="listItemPrefix"){const Oe={type:"listItem",_spread:!1,start:Object.assign({},Ne[1].start),end:void 0};wt=Oe,q.splice($e,0,["enter",Oe,Ne[2]]),$e++,be++,ve=void 0,ke=!0}}}return q[de][1]._spread=ht,be}function o(q,de){return be;function be($e){d.call(this,q($e),$e),de&&de.call(this,$e)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(q,de,be){this.stack[this.stack.length-1].children.push(q),this.stack.push(q),this.tokenStack.push([de,be||void 0]),q.position={start:fu(de.start),end:void 0}}function f(q){return de;function de(be){q&&q.call(this,be),u.call(this,be)}}function u(q,de){const be=this.stack.pop(),$e=this.tokenStack.pop();if($e)$e[0].type!==q.type&&(de?de.call(this,q,$e[0]):($e[1]||CC).call(this,q,$e[0]));else throw new Error("Cannot close `"+q.type+"` ("+Ym({start:q.start,end:q.end})+"): its not open");be.position.end=fu(q.end)}function h(){return zw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(q){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];de.start=Number.parseInt(this.sliceSerialize(q),10),this.data.expectingFirstListItemValue=void 0}}function v(){const q=this.resume(),de=this.stack[this.stack.length-1];de.lang=q}function S(){const q=this.resume(),de=this.stack[this.stack.length-1];de.meta=q}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q.replace(/(\r?\n|\r)$/g,"")}function R(q){const de=this.resume(),be=this.stack[this.stack.length-1];be.label=de,be.identifier=ho(this.sliceSerialize(q)).toLowerCase()}function I(){const q=this.resume(),de=this.stack[this.stack.length-1];de.title=q}function B(){const q=this.resume(),de=this.stack[this.stack.length-1];de.url=q}function F(q){const de=this.stack[this.stack.length-1];if(!de.depth){const be=this.sliceSerialize(q).length;de.depth=be}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function U(q){const de=this.stack[this.stack.length-1];de.depth=this.sliceSerialize(q).codePointAt(0)===61?1:2}function H(){this.data.setextHeadingSlurpLineEnding=void 0}function K(q){const be=this.stack[this.stack.length-1].children;let $e=be[be.length-1];(!$e||$e.type!=="text")&&($e=_e(),$e.position={start:fu(q.start),end:void 0},be.push($e)),this.stack.push($e)}function M(q){const de=this.stack.pop();de.value+=this.sliceSerialize(q),de.position.end=fu(q.end)}function $(q){const de=this.stack[this.stack.length-1];if(this.data.atHardBreak){const be=de.children[de.children.length-1];be.position.end=fu(q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(de.type)&&(K.call(this,q),M.call(this,q))}function z(){this.data.atHardBreak=!0}function W(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q}function te(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q}function V(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q}function G(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=de,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function J(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=de,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function oe(q){const de=this.sliceSerialize(q),be=this.stack[this.stack.length-2];be.label=Tz(de),be.identifier=ho(de).toLowerCase()}function ie(){const q=this.stack[this.stack.length-1],de=this.resume(),be=this.stack[this.stack.length-1];if(this.data.inReference=!0,be.type==="link"){const $e=q.children;be.children=$e}else be.alt=de}function E(){const q=this.resume(),de=this.stack[this.stack.length-1];de.url=q}function ce(){const q=this.resume(),de=this.stack[this.stack.length-1];de.title=q}function ge(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function pe(q){const de=this.resume(),be=this.stack[this.stack.length-1];be.label=de,be.identifier=ho(this.sliceSerialize(q)).toLowerCase(),this.data.referenceType="full"}function Ce(q){this.data.characterReferenceType=q.type}function Z(q){const de=this.sliceSerialize(q),be=this.data.characterReferenceType;let $e;be?($e=f2(de,be==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):$e=Bw(de);const nt=this.stack[this.stack.length-1];nt.value+=$e}function ee(q){const de=this.stack.pop();de.position.end=fu(q.end)}function X(q){M.call(this,q);const de=this.stack[this.stack.length-1];de.url=this.sliceSerialize(q)}function ye(q){M.call(this,q);const de=this.stack[this.stack.length-1];de.url="mailto:"+this.sliceSerialize(q)}function He(){return{type:"blockquote",children:[]}}function he(){return{type:"code",lang:null,meta:null,value:""}}function Le(){return{type:"inlineCode",value:""}}function ue(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function De(){return{type:"emphasis",children:[]}}function Ye(){return{type:"heading",depth:0,children:[]}}function et(){return{type:"break"}}function Ke(){return{type:"html",value:""}}function it(){return{type:"image",title:null,url:"",alt:null}}function ot(){return{type:"link",title:null,url:"",children:[]}}function vt(q){return{type:"list",ordered:q.type==="listOrdered",start:null,spread:q._spread,children:[]}}function Ee(q){return{type:"listItem",spread:q._spread,checked:null,children:[]}}function Je(){return{type:"paragraph",children:[]}}function Ae(){return{type:"strong",children:[]}}function _e(){return{type:"text",value:""}}function le(){return{type:"thematicBreak"}}}function fu(e){return{line:e.line,column:e.column,offset:e.offset}}function N2(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?N2(e,r):Dz(e,r)}}function Dz(e,n){let t;for(t in n)if(S2.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function CC(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Ym({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Ym({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Ym({start:n.start,end:n.end})+") is still open")}function Iz(e){const n=this;n.parser=t;function t(r){return Az(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function Rz(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function Mz(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function Oz(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function Lz(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Fz(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function $z(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=np(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function zz(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Bz(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function C2(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function Uz(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return C2(e,n);const a={src:np(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function qz(e,n){const t={src:np(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function Vz(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function Hz(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return C2(e,n);const a={href:np(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function Gz(e,n){const t={href:np(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function Yz(e,n,t){const r=e.all(n),a=t?Wz(t):_2(n),o={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const h=r[d];(a||d!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function Wz(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=_2(t[r])}return n}function _2(e){const n=e.spread;return n??e.children.length>1}function Qz(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function Jz(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Kz(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function Xz(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Zz(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=Ow(n.children[1]),f=i2(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function e8(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,h),e.applyData(n,h)}function t8(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const _C=9,jC=32;function n8(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(kC(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(kC(n.slice(a),a>0,!1)),o.join("")}function kC(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===_C||o===jC;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===_C||o===jC;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function r8(e,n){const t={type:"text",value:n8(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function i8(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const a8={blockquote:Rz,break:Mz,code:Oz,delete:Lz,emphasis:Fz,footnoteReference:$z,heading:zz,html:Bz,imageReference:Uz,image:qz,inlineCode:Vz,linkReference:Hz,link:Gz,listItem:Yz,list:Qz,paragraph:Jz,root:Kz,strong:Xz,table:Zz,tableCell:t8,tableRow:e8,text:r8,thematicBreak:i8,toml:vx,yaml:vx,definition:vx,footnoteDefinition:vx};function vx(){}const j2=-1,$b=0,Qm=1,sb=2,qw=3,Vw=4,Hw=5,Gw=6,k2=7,T2=8,TC=typeof self=="object"?self:globalThis,s8=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case $b:case j2:return t(l,a);case Qm:{const d=t([],a);for(const f of l)d.push(r(f));return d}case sb:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case qw:return t(new Date(l),a);case Vw:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case Hw:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case Gw:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case k2:{const{name:d,message:f}=l;return t(new TC[d](f),a)}case T2:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new TC[o](l),a)};return r},EC=e=>s8(new Map,e)(0),jh="",{toString:o8}={},{keys:l8}=Object,Rm=e=>{const n=typeof e;if(n!=="object"||!e)return[$b,n];const t=o8.call(e).slice(8,-1);switch(t){case"Array":return[Qm,jh];case"Object":return[sb,jh];case"Date":return[qw,jh];case"RegExp":return[Vw,jh];case"Map":return[Hw,jh];case"Set":return[Gw,jh];case"DataView":return[Qm,t]}return t.includes("Array")?[Qm,t]:t.includes("Error")?[k2,t]:[sb,t]},wx=([e,n])=>e===$b&&(n==="function"||n==="symbol"),c8=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Rm(l);switch(d){case $b:{let h=l;switch(f){case"bigint":d=T2,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);h=null;break;case"undefined":return a([j2],l)}return a([d,h],l)}case Qm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const h=[],g=a([d,h],l);for(const b of l)h.push(o(b));return g}case sb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const h=[],g=a([d,h],l);for(const b of l8(l))(e||!wx(Rm(l[b])))&&h.push([o(b),o(l[b])]);return g}case qw:return a([d,l.toISOString()],l);case Vw:{const{source:h,flags:g}=l;return a([d,{source:h,flags:g}],l)}case Hw:{const h=[],g=a([d,h],l);for(const[b,v]of l)(e||!(wx(Rm(b))||wx(Rm(v))))&&h.push([o(b),o(v)]);return g}case Gw:{const h=[],g=a([d,h],l);for(const b of l)(e||!wx(Rm(b)))&&h.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},AC=(e,{json:n,lossy:t}={})=>{const r=[];return c8(!(n||t),!!n,new Map,r)(e),r},ob=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?EC(AC(e,n)):structuredClone(e):(e,n)=>EC(AC(e,n));function u8(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function d8(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function f8(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||u8,r=e.options.footnoteBackLabel||d8,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const h=e.all(u),g=String(u.identifier).toUpperCase(),b=np(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let R=typeof t=="string"?t:t(f,v);typeof R=="string"&&(R={type:"text",value:R}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(R)?R:[R]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const R=T.children[T.children.length-1];R&&R.type==="text"?R.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else h.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...ob(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const zb=function(e){if(e==null)return g8;if(typeof e=="function")return Bb(e);if(typeof e=="object")return Array.isArray(e)?h8(e):p8(e);if(typeof e=="string")return m8(e);throw new Error("Expected function, string, or object as test")};function h8(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=zb(e[t]);return Bb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function p8(e){const n=e;return Bb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function m8(e){return Bb(n);function n(t){return t&&t.type===e}}function Bb(e){return n;function n(t,r,a){return!!(y8(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function g8(){return!0}function y8(e){return e!==null&&typeof e=="object"&&"type"in e}const E2=[],x8=!0,I1=!1,b8="skip";function A2(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=zb(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,h){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=E2,S,k,T;if((!n||o(f,u,h[h.length-1]||void 0))&&(v=v8(t(f,h)),v[0]===I1))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==b8)for(k=(r?P.children.length:-1)+l,T=h.concat(P);k>-1&&k<P.children.length;){const R=P.children[k];if(S=d(R,k,T)(),S[0]===I1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function v8(e){return Array.isArray(e)?e:typeof e=="number"?[x8,e]:e==null?E2:[e]}function Yw(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),A2(e,o,d,a);function d(f,u){const h=u[u.length-1],g=h?h.children.indexOf(f):void 0;return l(f,g,h)}}const R1={}.hasOwnProperty,w8={};function S8(e,n){const t=n||w8,r=new Map,a=new Map,o=new Map,l={...a8,...t.handlers},d={all:u,applyData:C8,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:N8,wrap:j8};return Yw(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),d;function f(h,g){const b=h.type,v=d.handlers[b];if(R1.call(d.handlers,b)&&v)return v(d,h,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,P=ob(T);return P.children=d.all(h),P}return ob(h)}return(d.options.unknownHandler||_8)(d,h,g)}function u(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=PC(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=PC(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function N8(e,n){e.position&&(n.position=d$(e))}function C8(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,ob(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function _8(e,n){const t=n.data||{},r="value"in n&&!(R1.call(t,"hProperties")||R1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function j8(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function PC(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function DC(e,n){const t=S8(e,n),r=t.one(e,void 0),a=f8(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}function k8(e,n){return e&&"run"in e?async function(t,r){const a=DC(t,{file:r,...n});await e.run(a,r)}:function(t,r){return DC(t,{file:r,...e||n})}}function IC(e){if(e)throw e}var d0,RC;function T8(){if(RC)return d0;RC=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var h=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!h&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,h){t&&h.name==="__proto__"?t(u,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):u[h.name]=h.newValue},d=function(u,h){if(h==="__proto__")if(e.call(u,h)){if(r)return r(u,h).value}else return;return u[h]};return d0=function f(){var u,h,g,b,v,S,k=arguments[0],T=1,P=arguments.length,R=!1;for(typeof k=="boolean"&&(R=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(h in u)g=d(k,h),b=d(u,h),k!==b&&(R&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:h,newValue:f(R,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},d0}var E8=T8();const f0=tf(E8);function M1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function A8(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const h=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,h?P8(h,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function P8(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const h=u;if(d&&t)throw h;return a(h)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}const cl={basename:D8,dirname:I8,extname:R8,join:M8,sep:"/"};function D8(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');mg(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function I8(e){if(mg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function R8(e){mg(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function M8(...e){let n=-1,t;for(;++n<e.length;)mg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":O8(t)}function O8(e){mg(e);const n=e.codePointAt(0)===47;let t=L8(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function L8(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function mg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const F8={cwd:$8};function $8(){return"/"}function O1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function z8(e){if(typeof e=="string")e=new URL(e);else if(!O1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return B8(e)}function B8(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const h0=["history","path","basename","stem","extname","dirname"];let P2=class{constructor(n){let t;n?O1(n)?t={path:n}:typeof n=="string"||U8(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":F8.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<h0.length;){const o=h0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)h0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?cl.basename(this.path):void 0}set basename(n){m0(n,"basename"),p0(n,"basename"),this.path=cl.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?cl.dirname(this.path):void 0}set dirname(n){MC(this.basename,"dirname"),this.path=cl.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?cl.extname(this.path):void 0}set extname(n){if(p0(n,"extname"),MC(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=cl.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){O1(n)&&(n=z8(n)),m0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?cl.basename(this.path,this.extname):void 0}set stem(n){m0(n,"stem"),p0(n,"stem"),this.path=cl.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Ui(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function p0(e,n){if(e&&e.includes(cl.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+cl.sep+"`")}function m0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function MC(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function U8(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const q8=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},V8={}.hasOwnProperty;let H8=class D2 extends q8{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=A8()}copy(){const n=new D2;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(f0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(x0("data",this.frozen),this.namespace[n]=t,this):V8.call(this.namespace,n)&&this.namespace[n]||void 0:n?(x0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Sx(n),r=this.parser||this.Parser;return g0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),g0("process",this.parser||this.Parser),y0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=Sx(n),f=r.parse(d);r.run(f,d,function(h,g,b){if(h||!g||!b)return u(h);const v=g,S=r.stringify(v,b);W8(S)?b.value=S:b.result=S,u(h,b)});function u(h,g){h||!g?l(h):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),g0("processSync",this.parser||this.Parser),y0("processSync",this.compiler||this.Compiler),this.process(n,a),LC("processSync","process",t),r;function a(o,l){t=!0,IC(o),r=l}}run(n,t,r){OC(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=Sx(t);a.run(n,f,u);function u(h,g,b){const v=g||n;h?d(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),LC("runSync","run",r),a;function o(l,d){IC(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=Sx(t),a=this.compiler||this.Compiler;return y0("stringify",a),OC(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(x0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...g]=u;f(h,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=f0(!0,a.settings,u.settings))}function d(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const g=u[h];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];M1(k)&&M1(v)&&(v=f0(!0,k,v)),r[b]=[u,v,...S]}}}};const G8=new H8().freeze();function g0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function y0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function x0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function OC(e){if(!M1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function LC(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Sx(e){return Y8(e)?e:new P2(e)}function Y8(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function W8(e){return typeof e=="string"||Q8(e)}function Q8(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const J8="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",FC=[],$C={allowDangerousHtml:!0},K8=/^(https?|ircs?|mailto|xmpp)$/i,X8=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Wa(e){const n=Z8(e),t=eB(e);return tB(n.runSync(n.parse(t),t),e)}function Z8(e){const n=e.rehypePlugins||FC,t=e.remarkPlugins||FC,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...$C}:$C;return G8().use(Iz).use(t).use(k8,r).use(n)}function eB(e){const n=e.children||"",t=new P2;return typeof n=="string"&&(t.value=n),t}function tB(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,o=n.disallowedElements,l=n.skipHtml,d=n.unwrapDisallowed,f=n.urlTransform||nB;for(const h of X8)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+J8+h.id,void 0);return Yw(e,u),g$(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function u(h,g,b){if(h.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let v;for(v in l0)if(Object.hasOwn(l0,v)&&Object.hasOwn(h.properties,v)){const S=h.properties[v],k=l0[v];(k===null||k.includes(h.tagName))&&(h.properties[v]=f(String(S||""),v,h))}}if(h.type==="element"){let v=t?!t.includes(h.tagName):o?o.includes(h.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(h,g,b)),v&&b&&typeof g=="number")return d&&h.children?b.children.splice(g,1,...h.children):b.children.splice(g,1),g}}}function nB(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||K8.test(e.slice(0,n))?e:""}function zC(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function rB(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function iB(e,n,t){const a=zb((t||{}).ignore||[]),o=aB(n);let l=-1;for(;++l<o.length;)A2(e,"text",d);function d(u,h){let g=-1,b;for(;++g<h.length;){const v=h[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return f(u,h)}function f(u,h){const g=h[h.length-1],b=o[l][0],v=o[l][1];let S=0;const T=g.children.indexOf(u);let P=!1,R=[];b.lastIndex=0;let I=b.exec(u.value);for(;I;){const B=I.index,F={index:I.index,input:I.input,stack:[...h,u]};let L=v(...I,F);if(typeof L=="string"&&(L=L.length>0?{type:"text",value:L}:void 0),L===!1?b.lastIndex=B+1:(S!==B&&R.push({type:"text",value:u.value.slice(S,B)}),Array.isArray(L)?R.push(...L):L&&R.push(L),S=B+I[0].length,P=!0),!b.global)break;I=b.exec(u.value)}return P?(S<u.value.length&&R.push({type:"text",value:u.value.slice(S)}),g.children.splice(T,1,...R)):R=[u],T+R.length}}function aB(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([sB(a[0]),oB(a[1])])}return n}function sB(e){return typeof e=="string"?new RegExp(rB(e),"g"):e}function oB(e){return typeof e=="function"?e:function(){return e}}const b0="phrasing",v0=["autolink","link","image","label"];function lB(){return{transforms:[mB],enter:{literalAutolink:uB,literalAutolinkEmail:w0,literalAutolinkHttp:w0,literalAutolinkWww:w0},exit:{literalAutolink:pB,literalAutolinkEmail:hB,literalAutolinkHttp:dB,literalAutolinkWww:fB}}}function cB(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:b0,notInConstruct:v0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:b0,notInConstruct:v0},{character:":",before:"[ps]",after:"\\/",inConstruct:b0,notInConstruct:v0}]}}function uB(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function w0(e){this.config.enter.autolinkProtocol.call(this,e)}function dB(e){this.config.exit.autolinkProtocol.call(this,e)}function fB(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function hB(e){this.config.exit.autolinkEmail.call(this,e)}function pB(e){this.exit(e)}function mB(e){iB(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,gB],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),yB]],{ignore:["link","linkReference"]})}function gB(e,n,t,r,a){let o="";if(!I2(a)||(/^w/i.test(n)&&(t=n+t,n="",o="http://"),!xB(t)))return!1;const l=bB(t+r);if(!l[0])return!1;const d={type:"link",title:null,url:o+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[d,{type:"text",value:l[1]}]:d}function yB(e,n,t,r){return!I2(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function xB(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function bB(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=zC(e,"(");let o=zC(e,")");for(;r!==-1&&a>o;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),o++;return[e,t]}function I2(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||Kd(t)||Lb(t))&&(!n||t!==47)}R2.peek=TB;function vB(){this.buffer()}function wB(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function SB(){this.buffer()}function NB(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function CB(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=ho(this.sliceSerialize(e)).toLowerCase(),t.label=n}function _B(e){this.exit(e)}function jB(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=ho(this.sliceSerialize(e)).toLowerCase(),t.label=n}function kB(e){this.exit(e)}function TB(){return"["}function R2(e,n,t,r){const a=t.createTracker(r);let o=a.move("[^");const l=t.enter("footnoteReference"),d=t.enter("reference");return o+=a.move(t.safe(t.associationId(e),{after:"]",before:o})),d(),l(),o+=a.move("]"),o}function EB(){return{enter:{gfmFootnoteCallString:vB,gfmFootnoteCall:wB,gfmFootnoteDefinitionLabelString:SB,gfmFootnoteDefinition:NB},exit:{gfmFootnoteCallString:CB,gfmFootnoteCall:_B,gfmFootnoteDefinitionLabelString:jB,gfmFootnoteDefinition:kB}}}function AB(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:R2},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,o,l){const d=o.createTracker(l);let f=d.move("[^");const u=o.enter("footnoteDefinition"),h=o.enter("label");return f+=d.move(o.safe(o.associationId(r),{before:f,after:"]"})),h(),f+=d.move("]:"),r.children&&r.children.length>0&&(d.shift(4),f+=d.move((n?`
`:" ")+o.indentLines(o.containerFlow(r,d.current()),n?M2:PB))),u(),f}}function PB(e,n,t){return n===0?e:M2(e,n,t)}function M2(e,n,t){return(t?"":"    ")+e}const DB=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];O2.peek=LB;function IB(){return{canContainEols:["delete"],enter:{strikethrough:MB},exit:{strikethrough:OB}}}function RB(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:DB}],handlers:{delete:O2}}}function MB(e){this.enter({type:"delete",children:[]},e)}function OB(e){this.exit(e)}function O2(e,n,t,r){const a=t.createTracker(r),o=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),o(),l}function LB(){return"~"}function FB(e){return e.length}function $B(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||FB,o=[],l=[],d=[],f=[];let u=0,h=-1;for(;++h<e.length;){const k=[],T=[];let P=-1;for(e[h].length>u&&(u=e[h].length);++P<e[h].length;){const R=zB(e[h][P]);if(t.alignDelimiters!==!1){const I=a(R);T[P]=I,(f[P]===void 0||I>f[P])&&(f[P]=I)}k.push(R)}l[h]=k,d[h]=T}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<u;)o[g]=BC(r[g]);else{const k=BC(r);for(;++g<u;)o[g]=k}g=-1;const b=[],v=[];for(;++g<u;){const k=o[g];let T="",P="";k===99?(T=":",P=":"):k===108?T=":":k===114&&(P=":");let R=t.alignDelimiters===!1?1:Math.max(1,f[g]-T.length-P.length);const I=T+"-".repeat(R)+P;t.alignDelimiters!==!1&&(R=T.length+R+P.length,R>f[g]&&(f[g]=R),v[g]=R),b[g]=I}l.splice(1,0,b),d.splice(1,0,v),h=-1;const S=[];for(;++h<l.length;){const k=l[h],T=d[h];g=-1;const P=[];for(;++g<u;){const R=k[g]||"";let I="",B="";if(t.alignDelimiters!==!1){const F=f[g]-(T[g]||0),L=o[g];L===114?I=" ".repeat(F):L===99?F%2?(I=" ".repeat(F/2+.5),B=" ".repeat(F/2-.5)):(I=" ".repeat(F/2),B=I):B=" ".repeat(F)}t.delimiterStart!==!1&&!g&&P.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&R==="")&&(t.delimiterStart!==!1||g)&&P.push(" "),t.alignDelimiters!==!1&&P.push(I),P.push(R),t.alignDelimiters!==!1&&P.push(B),t.padding!==!1&&P.push(" "),(t.delimiterEnd!==!1||g!==u-1)&&P.push("|")}S.push(t.delimiterEnd===!1?P.join("").replace(/ +$/,""):P.join(""))}return S.join(`
`)}function zB(e){return e==null?"":String(e)}function BC(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function BB(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),UB);return a(),l}function UB(e,n,t){return">"+(t?"":" ")+e}function qB(e,n){return UC(e,n.inConstruct,!0)&&!UC(e,n.notInConstruct,!1)}function UC(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function qC(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&qB(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function VB(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function HB(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function GB(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function YB(e,n,t,r){const a=GB(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(HB(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,WB);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(VB(o,a)+1,3)),u=t.enter("codeFenced");let h=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=d.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=d.move(" "),h+=d.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...d.current()})),g()}return h+=d.move(`
`),o&&(h+=d.move(o+`
`)),h+=d.move(f),u(),h}function WB(e,n,t){return(t?"":"    ")+e}function Ww(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function QB(e,n,t,r){const a=Ww(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function JB(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function ng(e){return"&#x"+e.toString(16).toUpperCase()+";"}function lb(e,n,t){const r=Gh(e),a=Gh(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}L2.peek=KB;function L2(e,n,t,r){const a=JB(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=lb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=ng(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=lb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+ng(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function KB(e,n,t){return t.options.emphasis||"*"}function XB(e,n){let t=!1;return Yw(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,I1}),!!((!e.depth||e.depth<3)&&zw(e)&&(n.options.setext||t))}function ZB(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(XB(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=ng(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}F2.peek=eU;function F2(e){return e.value||""}function eU(){return"<"}$2.peek=tU;function $2(e,n,t,r){const a=Ww(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function tU(){return"!"}z2.peek=nU;function z2(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function nU(){return"!"}B2.peek=rU;function B2(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function rU(){return"`"}function U2(e,n){const t=zw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}q2.peek=iU;function q2(e,n,t,r){const a=Ww(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(U2(e,t)){const h=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=h,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function iU(e,n,t){return U2(e,t)?"<":"["}V2.peek=aU;function V2(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function aU(){return"["}function Qw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function sU(e){const n=Qw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function oU(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function H2(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function lU(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?oU(t):Qw(t);const d=e.ordered?l==="."?")":".":sU(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),H2(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function cU(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function uU(e,n,t,r){const a=cU(t);let o=t.bulletCurrent||Qw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),h);return f(),u;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function dU(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const fU=zb(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function hU(e,n,t,r){return(e.children.some(function(l){return fU(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function pU(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}G2.peek=mU;function G2(e,n,t,r){const a=pU(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=lb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=ng(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=lb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+ng(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function mU(e,n,t){return t.options.strong||"*"}function gU(e,n,t,r){return t.safe(e.value,r)}function yU(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function xU(e,n,t){const r=(H2(t)+(t.options.ruleSpaces?" ":"")).repeat(yU(t));return t.options.ruleSpaces?r.slice(0,-1):r}const Y2={blockquote:BB,break:qC,code:YB,definition:QB,emphasis:L2,hardBreak:qC,heading:ZB,html:F2,image:$2,imageReference:z2,inlineCode:B2,link:q2,linkReference:V2,list:lU,listItem:uU,paragraph:dU,root:hU,strong:G2,text:gU,thematicBreak:xU};function bU(){return{enter:{table:vU,tableData:VC,tableHeader:VC,tableRow:SU},exit:{codeText:NU,table:wU,tableData:S0,tableHeader:S0,tableRow:S0}}}function vU(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function wU(e){this.exit(e),this.data.inTable=void 0}function SU(e){this.enter({type:"tableRow",children:[]},e)}function S0(e){this.exit(e)}function VC(e){this.enter({type:"tableCell",children:[]},e)}function NU(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,CU));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function CU(e,n){return n==="|"?n:e}function _U(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,o=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:f,tableRow:d}};function l(v,S,k,T){return u(h(v,k,T),v.align)}function d(v,S,k,T){const P=g(v,k,T),R=u([P]);return R.slice(0,R.indexOf(`
`))}function f(v,S,k,T){const P=k.enter("tableCell"),R=k.enter("phrasing"),I=k.containerPhrasing(v,{...T,before:o,after:o});return R(),P(),I}function u(v,S){return $B(v,{align:S,alignDelimiters:r,padding:t,stringLength:a})}function h(v,S,k){const T=v.children;let P=-1;const R=[],I=S.enter("table");for(;++P<T.length;)R[P]=g(T[P],S,k);return I(),R}function g(v,S,k){const T=v.children;let P=-1;const R=[],I=S.enter("tableRow");for(;++P<T.length;)R[P]=f(T[P],v,S,k);return I(),R}function b(v,S,k){let T=Y2.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function jU(){return{exit:{taskListCheckValueChecked:HC,taskListCheckValueUnchecked:HC,paragraph:TU}}}function kU(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:EU}}}function HC(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function TU(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let o=-1,l;for(;++o<a.length;){const d=a[o];if(d.type==="paragraph"){l=d;break}}l===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function EU(e,n,t,r){const a=e.children[0],o=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",d=t.createTracker(r);o&&d.move(l);let f=Y2.listItem(e,n,t,{...r,...d.current()});return o&&(f=f.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),f;function u(h){return h+l}}function AU(){return[lB(),EB(),IB(),bU(),jU()]}function PU(e){return{extensions:[cB(),AB(e),RB(),_U(e),kU()]}}const DU={tokenize:FU,partial:!0},W2={tokenize:$U,partial:!0},Q2={tokenize:zU,partial:!0},J2={tokenize:BU,partial:!0},IU={tokenize:UU,partial:!0},K2={name:"wwwAutolink",tokenize:OU,previous:Z2},X2={name:"protocolAutolink",tokenize:LU,previous:eT},dc={name:"emailAutolink",tokenize:MU,previous:tT},bl={};function RU(){return{text:bl}}let zd=48;for(;zd<123;)bl[zd]=dc,zd++,zd===58?zd=65:zd===91&&(zd=97);bl[43]=dc;bl[45]=dc;bl[46]=dc;bl[95]=dc;bl[72]=[dc,X2];bl[104]=[dc,X2];bl[87]=[dc,K2];bl[119]=[dc,K2];function MU(e,n,t){const r=this;let a,o;return l;function l(g){return!L1(g)||!tT.call(r,r.previous)||Jw(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),d(g))}function d(g){return L1(g)?(e.consume(g),d):g===64?(e.consume(g),f):t(g)}function f(g){return g===46?e.check(IU,h,u)(g):g===45||g===95||zi(g)?(o=!0,e.consume(g),f):h(g)}function u(g){return e.consume(g),a=!0,f}function h(g){return o&&a&&na(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function OU(e,n,t){const r=this;return a;function a(l){return l!==87&&l!==119||!Z2.call(r,r.previous)||Jw(r.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(DU,e.attempt(W2,e.attempt(Q2,o),t),t)(l))}function o(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function LU(e,n,t){const r=this;let a="",o=!1;return l;function l(g){return(g===72||g===104)&&eT.call(r,r.previous)&&!Jw(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),d):t(g)}function d(g){if(na(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),d;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),f}return t(g)}function f(g){return g===47?(e.consume(g),o?u:(o=!0,f)):t(g)}function u(g){return g===null||ab(g)||ar(g)||Kd(g)||Lb(g)?t(g):e.attempt(W2,e.attempt(Q2,h),t)(g)}function h(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function FU(e,n,t){let r=0;return a;function a(l){return(l===87||l===119)&&r<3?(r++,e.consume(l),a):l===46&&r===3?(e.consume(l),o):t(l)}function o(l){return l===null?t(l):n(l)}}function $U(e,n,t){let r,a,o;return l;function l(u){return u===46||u===95?e.check(J2,f,d)(u):u===null||ar(u)||Kd(u)||u!==45&&Lb(u)?f(u):(o=!0,e.consume(u),l)}function d(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),l}function f(u){return a||r||!o?t(u):n(u)}}function zU(e,n){let t=0,r=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&r<t?o(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(J2,n,o)(l):l===null||ar(l)||Kd(l)?n(l):(e.consume(l),a)}function o(l){return l===41&&r++,e.consume(l),a}}function BU(e,n,t){return r;function r(d){return d===33||d===34||d===39||d===41||d===42||d===44||d===46||d===58||d===59||d===63||d===95||d===126?(e.consume(d),r):d===38?(e.consume(d),o):d===93?(e.consume(d),a):d===60||d===null||ar(d)||Kd(d)?n(d):t(d)}function a(d){return d===null||d===40||d===91||ar(d)||Kd(d)?n(d):r(d)}function o(d){return na(d)?l(d):t(d)}function l(d){return d===59?(e.consume(d),r):na(d)?(e.consume(d),l):t(d)}}function UU(e,n,t){return r;function r(o){return e.consume(o),a}function a(o){return zi(o)?t(o):n(o)}}function Z2(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||ar(e)}function eT(e){return!na(e)}function tT(e){return!(e===47||L1(e))}function L1(e){return e===43||e===45||e===46||e===95||zi(e)}function Jw(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const qU={tokenize:KU,partial:!0};function VU(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:WU,continuation:{tokenize:QU},exit:JU}},text:{91:{name:"gfmFootnoteCall",tokenize:YU},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:HU,resolveTo:GU}}}}function HU(e,n,t){const r=this;let a=r.events.length;const o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l;for(;a--;){const f=r.events[a][1];if(f.type==="labelImage"){l=f;break}if(f.type==="gfmFootnoteCall"||f.type==="labelLink"||f.type==="label"||f.type==="image"||f.type==="link")break}return d;function d(f){if(!l||!l._balanced)return t(f);const u=ho(r.sliceSerialize({start:l.end,end:r.now()}));return u.codePointAt(0)!==94||!o.includes(u.slice(1))?t(f):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(f),e.exit("gfmFootnoteCallLabelMarker"),n(f))}}function GU(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},d=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",o,n],["enter",l,n],["exit",l,n],["exit",o,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...d),e}function YU(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o=0,l;return d;function d(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),f}function f(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(g){if(o>999||g===93&&!l||g===null||g===91||ar(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(ho(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return ar(g)||(l=!0),o++,e.consume(g),g===92?h:u}function h(g){return g===91||g===92||g===93?(e.consume(g),o++,u):u(g)}}function WU(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o,l=0,d;return f;function f(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):t(S)}function h(S){if(l>999||S===93&&!d||S===null||S===91||ar(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return o=ho(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return ar(S)||(d=!0),l++,e.consume(S),S===92?g:h}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,h):h(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(o)||a.push(o),Dn(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function QU(e,n,t){return e.check(pg,n,e.attempt(qU,n,t))}function JU(e){e.exit("gfmFootnoteDefinition")}function KU(e,n,t){const r=this;return Dn(e,a,"gfmFootnoteDefinitionIndent",5);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(o):t(o)}}function XU(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:o,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(l,d){let f=-1;for(;++f<l.length;)if(l[f][0]==="enter"&&l[f][1].type==="strikethroughSequenceTemporary"&&l[f][1]._close){let u=f;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[f][1].end.offset-l[f][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[f][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[f][1].end)},g={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[f][1].start)},b=[["enter",h,d],["enter",l[u][1],d],["exit",l[u][1],d],["enter",g,d]],v=d.parser.constructs.insideSpan.null;v&&Ka(b,b.length,0,Fb(v,l.slice(u+1,f),d)),Ka(b,b.length,0,[["exit",g,d],["enter",l[f][1],d],["exit",l[f][1],d],["exit",h,d]]),Ka(l,u-1,f-u+3,b),f=u+b.length-2;break}}for(f=-1;++f<l.length;)l[f][1].type==="strikethroughSequenceTemporary"&&(l[f][1].type="data");return l}function o(l,d,f){const u=this.previous,h=this.events;let g=0;return b;function b(S){return u===126&&h[h.length-1][1].type!=="characterEscape"?f(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=Gh(u);if(S===126)return g>1?f(S):(l.consume(S),g++,v);if(g<2&&!t)return f(S);const T=l.exit("strikethroughSequenceTemporary"),P=Gh(S);return T._open=!P||P===2&&!!k,T._close=!k||k===2&&!!P,d(S)}}}class ZU{constructor(){this.map=[]}add(n,t,r){e9(this,n,t,r)}consume(n){if(this.map.sort(function(o,l){return o[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const o of a)n.push(o);a=r.pop()}this.map.length=0}}function e9(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function t9(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const o=r.length-1;r[o]=r[o]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function n9(){return{flow:{null:{name:"table",tokenize:r9,resolveAll:i9}}}}function r9(e,n,t){const r=this;let a=0,o=0,l;return d;function d(M){let $=r.events.length-1;for(;$>-1;){const te=r.events[$][1].type;if(te==="lineEnding"||te==="linePrefix")$--;else break}const z=$>-1?r.events[$][1].type:null,W=z==="tableHead"||z==="tableRow"?L:f;return W===L&&r.parser.lazy[r.now().line]?t(M):W(M)}function f(M){return e.enter("tableHead"),e.enter("tableRow"),u(M)}function u(M){return M===124||(l=!0,o+=1),h(M)}function h(M){return M===null?t(M):Ft(M)?o>1?(o=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),v):t(M):Nn(M)?Dn(e,h,"whitespace")(M):(o+=1,l&&(l=!1,a+=1),M===124?(e.enter("tableCellDivider"),e.consume(M),e.exit("tableCellDivider"),l=!0,h):(e.enter("data"),g(M)))}function g(M){return M===null||M===124||ar(M)?(e.exit("data"),h(M)):(e.consume(M),M===92?b:g)}function b(M){return M===92||M===124?(e.consume(M),g):g(M)}function v(M){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(M):(e.enter("tableDelimiterRow"),l=!1,Nn(M)?Dn(e,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(M):S(M))}function S(M){return M===45||M===58?T(M):M===124?(l=!0,e.enter("tableCellDivider"),e.consume(M),e.exit("tableCellDivider"),k):F(M)}function k(M){return Nn(M)?Dn(e,T,"whitespace")(M):T(M)}function T(M){return M===58?(o+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(M),e.exit("tableDelimiterMarker"),P):M===45?(o+=1,P(M)):M===null||Ft(M)?B(M):F(M)}function P(M){return M===45?(e.enter("tableDelimiterFiller"),R(M)):F(M)}function R(M){return M===45?(e.consume(M),R):M===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(M),e.exit("tableDelimiterMarker"),I):(e.exit("tableDelimiterFiller"),I(M))}function I(M){return Nn(M)?Dn(e,B,"whitespace")(M):B(M)}function B(M){return M===124?S(M):M===null||Ft(M)?!l||a!==o?F(M):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(M)):F(M)}function F(M){return t(M)}function L(M){return e.enter("tableRow"),U(M)}function U(M){return M===124?(e.enter("tableCellDivider"),e.consume(M),e.exit("tableCellDivider"),U):M===null||Ft(M)?(e.exit("tableRow"),n(M)):Nn(M)?Dn(e,U,"whitespace")(M):(e.enter("data"),H(M))}function H(M){return M===null||M===124||ar(M)?(e.exit("data"),U(M)):(e.consume(M),M===92?K:H)}function K(M){return M===92||M===124?(e.consume(M),H):H(M)}}function i9(e,n){let t=-1,r=!0,a=0,o=[0,0,0,0],l=[0,0,0,0],d=!1,f=0,u,h,g;const b=new ZU;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(d=!1,f!==0&&(GC(b,n,f,u,h),h=void 0,f=0),u={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",u,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(r=!0,g=void 0,o=[0,0,0,0],l=[0,t+1,0,0],d&&(d=!1,h={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",h,n]])),a=S.type==="tableDelimiterRow"?2:h?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(r=!1,l[2]===0&&(o[1]!==0&&(l[0]=l[1],g=Nx(b,n,o,a,void 0,g),o=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(r?r=!1:(o[1]!==0&&(l[0]=l[1],g=Nx(b,n,o,a,void 0,g)),o=l,l=[o[1],t,0,0])):S.type==="tableHead"?(d=!0,f=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(f=t,o[1]!==0?(l[0]=l[1],g=Nx(b,n,o,a,t,g)):l[1]!==0&&(g=Nx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(f!==0&&GC(b,n,f,u,h),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=t9(n.events,t))}return e}function Nx(e,n,t,r,a,o){const l=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",d="tableContent";t[0]!==0&&(o.end=Object.assign({},Ih(n.events,t[0])),e.add(t[0],0,[["exit",o,n]]));const f=Ih(n.events,t[1]);if(o={type:l,start:Object.assign({},f),end:Object.assign({},f)},e.add(t[1],0,[["enter",o,n]]),t[2]!==0){const u=Ih(n.events,t[2]),h=Ih(n.events,t[3]),g={type:d,start:Object.assign({},u),end:Object.assign({},h)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(o.end=Object.assign({},Ih(n.events,a)),e.add(a,0,[["exit",o,n]]),o=void 0),o}function GC(e,n,t,r,a){const o=[],l=Ih(n.events,t);a&&(a.end=Object.assign({},l),o.push(["exit",a,n])),r.end=Object.assign({},l),o.push(["exit",r,n]),e.add(t+1,0,o)}function Ih(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const a9={name:"tasklistCheck",tokenize:o9};function s9(){return{text:{91:a9}}}function o9(e,n,t){const r=this;return a;function a(f){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(f):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),o)}function o(f){return ar(f)?(e.enter("taskListCheckValueUnchecked"),e.consume(f),e.exit("taskListCheckValueUnchecked"),l):f===88||f===120?(e.enter("taskListCheckValueChecked"),e.consume(f),e.exit("taskListCheckValueChecked"),l):t(f)}function l(f){return f===93?(e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),d):t(f)}function d(f){return Ft(f)?n(f):Nn(f)?e.check({tokenize:l9},n,t)(f):t(f)}}function l9(e,n,t){return Dn(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function c9(e){return d2([RU(),VU(),XU(e),n9(),s9()])}const u9={};function Li(e){const n=this,t=e||u9,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),o=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),l=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(c9(t)),o.push(AU()),l.push(PU(t))}const d9="_container_plki7_3",f9="_header_plki7_21",h9="_titleGroup_plki7_41",p9="_title_plki7_41",m9="_closeButton_plki7_59",g9="_messageList_plki7_79",y9="_emptyState_plki7_108",x9="_emptyStateIcon_plki7_119",b9="_exampleContainer_plki7_145",v9="_exampleChip_plki7_153",w9="_messageRow_plki7_176",S9="_messageRowUser_plki7_194",N9="_messageRowModel_plki7_198",C9="_messageRowSystem_plki7_202",_9="_bubble_plki7_208",j9="_bubbleUser_plki7_224",k9="_bubbleModel_plki7_234",T9="_bubbleSystem_plki7_247",E9="_processingIndicator_plki7_330",A9="_spin_plki7_343",P9="_inputArea_plki7_358",D9="_imagePreviewContainer_plki7_365",I9="_inputContainer_plki7_376",R9="_inputField_plki7_393",M9="_sendButton_plki7_407",Wn={container:d9,header:f9,titleGroup:h9,title:p9,closeButton:m9,messageList:g9,emptyState:y9,emptyStateIcon:x9,exampleContainer:b9,exampleChip:v9,messageRow:w9,messageRowUser:S9,messageRowModel:N9,messageRowSystem:C9,bubble:_9,bubbleUser:j9,bubbleModel:k9,bubbleSystem:T9,processingIndicator:E9,spin:A9,inputArea:P9,imagePreviewContainer:D9,inputContainer:I9,inputField:R9,sendButton:M9},nT=({onClose:e,settings:n,staffList:t,onSettingsUpdate:r,onStaffUpdate:a,onHighlight:o})=>{const{chatQuery:l,setChatQuery:d,chatHistory:f,isProcessing:u,handleSendMessage:h,refreshChat:g,stopGeneration:b,selectedImage:v,handleImageSelect:S,clearImage:k}=Ew({settings:n,staffList:t,onSettingsUpdate:r,onStaffUpdate:a,onHighlight:o}),T=w.useRef(null),P=w.useRef(null),R=()=>{var L;(L=T.current)==null||L.scrollIntoView({behavior:"smooth"})};w.useEffect(()=>{R()},[f,u]);const I=L=>{var H;const U=(H=L.target.files)==null?void 0:H[0];U&&S(U)},B=["Check Paracetamol stock","Go to Pharmacy","Analysis for last month","Add nurse Sarah"],F=L=>{d(L)};return i.jsxs("div",{className:Wn.container,children:[i.jsxs("header",{className:Wn.header,children:[i.jsxs("div",{className:Wn.titleGroup,children:[i.jsx(rb,{size:20,className:"text-violet-600"}),i.jsx("h3",{className:Wn.title,children:"Clinic Assistant"})]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[i.jsx("button",{onClick:g,className:Wn.closeButton,title:"Refresh Chat",children:i.jsx(Yk,{size:18})}),i.jsx("button",{onClick:e,className:Wn.closeButton,title:"Close",children:i.jsx(Sn,{size:20})})]})]}),i.jsxs("div",{className:Wn.messageList,children:[f.length===0&&i.jsxs("div",{className:Wn.emptyState,children:[i.jsx(rb,{size:48,className:Wn.emptyStateIcon}),i.jsx("p",{children:"How can I help you manage the clinic today?"}),i.jsx("div",{className:Wn.exampleContainer,children:B.map((L,U)=>i.jsx("button",{className:Wn.exampleChip,onClick:()=>F(L),children:L},U))})]}),f.map((L,U)=>i.jsx("div",{className:`${Wn.messageRow} ${L.role==="user"?Wn.messageRowUser:L.role==="model"?Wn.messageRowModel:Wn.messageRowSystem}`,children:i.jsx("div",{className:`${Wn.bubble} ${L.role==="user"?Wn.bubbleUser:L.role==="model"?Wn.bubbleModel:Wn.bubbleSystem}`,children:L.role==="user"||L.role==="system"?L.text:i.jsx(Wa,{remarkPlugins:[Li],children:L.text})})},U)),u&&i.jsx("div",{className:`${Wn.messageRow} ${Wn.messageRowModel}`,children:i.jsxs("div",{className:Wn.processingIndicator,children:[i.jsx(mo,{size:14,className:Wn.spin}),"Thinking..."]})}),i.jsx("div",{ref:T})]}),i.jsxs("div",{className:Wn.inputArea,children:[v&&i.jsxs("div",{className:Wn.imagePreviewContainer,style:{marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("div",{style:{position:"relative",width:"60px",height:"60px",border:"1px solid #e5e7eb",borderRadius:"4px",overflow:"hidden"},children:[i.jsx("img",{src:v,alt:"Selected",style:{width:"100%",height:"100%",objectFit:"cover"}}),i.jsx("button",{onClick:k,style:{position:"absolute",top:0,right:0,background:"rgba(0,0,0,0.5)",color:"white",border:"none",cursor:"pointer",padding:"1px"},children:i.jsx(Sn,{size:12})})]}),i.jsx("span",{style:{fontSize:"0.8rem",color:"#6b7280"},children:"Image attached"})]}),i.jsxs("div",{className:Wn.inputContainer,children:[i.jsx("input",{type:"file",ref:P,onChange:I,accept:"image/*",style:{display:"none"}}),i.jsx("button",{className:Wn.sendButton,onClick:()=>{var L;return(L=P.current)==null?void 0:L.click()},disabled:u,title:"Attach Image",style:{marginRight:"0.5rem",color:"#6b7280"},children:i.jsx(Rb,{size:18})}),i.jsx("input",{type:"text",className:Wn.inputField,placeholder:"Type your request...",value:l,onChange:L=>d(L.target.value),onKeyDown:L=>L.key==="Enter"&&!u&&h(),disabled:u,autoFocus:!0}),u?i.jsx("button",{className:Wn.sendButton,onClick:b,title:"Stop Generating",style:{color:"#ef4444"},children:i.jsx(SF,{size:18,fill:"currentColor"})}):i.jsx("button",{className:Wn.sendButton,onClick:()=>h(),disabled:!l.trim()&&!v,children:i.jsx(Mb,{size:18})})]})]})]})};var N0,YC;function O9(){if(YC)return N0;YC=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,f=typeof yu=="object"&&yu&&yu.Object===Object&&yu,u=typeof self=="object"&&self&&self.Object===Object&&self,h=f||u||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return h.Date.now()};function T(F,L,U){var H,K,M,$,z,W,te=0,V=!1,G=!1,J=!0;if(typeof F!="function")throw new TypeError(e);L=B(L)||0,P(U)&&(V=!!U.leading,G="maxWait"in U,M=G?v(B(U.maxWait)||0,L):M,J="trailing"in U?!!U.trailing:J);function oe(ee){var X=H,ye=K;return H=K=void 0,te=ee,$=F.apply(ye,X),$}function ie(ee){return te=ee,z=setTimeout(ge,L),V?oe(ee):$}function E(ee){var X=ee-W,ye=ee-te,He=L-X;return G?S(He,M-ye):He}function ce(ee){var X=ee-W,ye=ee-te;return W===void 0||X>=L||X<0||G&&ye>=M}function ge(){var ee=k();if(ce(ee))return D(ee);z=setTimeout(ge,E(ee))}function D(ee){return z=void 0,J&&H?oe(ee):(H=K=void 0,$)}function pe(){z!==void 0&&clearTimeout(z),te=0,H=W=K=z=void 0}function Ce(){return z===void 0?$:D(k())}function Z(){var ee=k(),X=ce(ee);if(H=arguments,K=this,W=ee,X){if(z===void 0)return ie(W);if(G)return z=setTimeout(ge,L),oe(W)}return z===void 0&&(z=setTimeout(ge,L)),$}return Z.cancel=pe,Z.flush=Ce,Z}function P(F){var L=typeof F;return!!F&&(L=="object"||L=="function")}function R(F){return!!F&&typeof F=="object"}function I(F){return typeof F=="symbol"||R(F)&&b.call(F)==t}function B(F){if(typeof F=="number")return F;if(I(F))return n;if(P(F)){var L=typeof F.valueOf=="function"?F.valueOf():F;F=P(L)?L+"":L}if(typeof F!="string")return F===0?F:+F;F=F.replace(r,"");var U=o.test(F);return U||l.test(F)?d(F.slice(2),U?2:8):a.test(F)?n:+F}return N0=T,N0}var L9=O9();const gg=tf(L9);var C0={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var WC;function F9(){return WC||(WC=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var d=arguments[l];d&&(o=a(o,r(d)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var d in o)n.call(o,d)&&o[d]&&(l=a(l,d));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(C0)),C0.exports}var $9=F9();const xu=tf($9);function Xd(e){"@babel/helpers - typeof";return Xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Xd(e)}function z9(e,n){if(Xd(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(Xd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function rT(e){var n=z9(e,"string");return Xd(n)=="symbol"?n:n+""}function Vm(e,n,t){return(n=rT(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function QC(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function $t(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?QC(Object(t),!0).forEach(function(r){Vm(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):QC(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function B9(e){if(Array.isArray(e))return e}function U9(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,o,l,d=[],f=!0,u=!1;try{if(o=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;f=!1}else for(;!(f=(r=o.call(t)).done)&&(d.push(r.value),d.length!==n);f=!0);}catch(h){u=!0,a=h}finally{try{if(!f&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return d}}function F1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function iT(e,n){if(e){if(typeof e=="string")return F1(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?F1(e,n):void 0}}function q9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lc(e,n){return B9(e)||U9(e,n)||iT(e,n)||q9()}function V9(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function fc(e,n){if(e==null)return{};var t,r,a=V9(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var H9=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function G9(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,o=e.defaultValue,l=o===void 0?null:o,d=e.inputValue,f=e.menuIsOpen,u=e.onChange,h=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=fc(e,H9),k=w.useState(d!==void 0?d:t),T=lc(k,2),P=T[0],R=T[1],I=w.useState(f!==void 0?f:a),B=lc(I,2),F=B[0],L=B[1],U=w.useState(v!==void 0?v:l),H=lc(U,2),K=H[0],M=H[1],$=w.useCallback(function(oe,ie){typeof u=="function"&&u(oe,ie),M(oe)},[u]),z=w.useCallback(function(oe,ie){var E;typeof h=="function"&&(E=h(oe,ie)),R(E!==void 0?E:oe)},[h]),W=w.useCallback(function(){typeof b=="function"&&b(),L(!0)},[b]),te=w.useCallback(function(){typeof g=="function"&&g(),L(!1)},[g]),V=d!==void 0?d:P,G=f!==void 0?f:F,J=v!==void 0?v:K;return $t($t({},S),{},{inputValue:V,menuIsOpen:G,onChange:$,onInputChange:z,onMenuClose:te,onMenuOpen:W,value:J})}function Ut(){return Ut=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Ut.apply(null,arguments)}function Y9(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function JC(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rT(r.key),r)}}function W9(e,n,t){return n&&JC(e.prototype,n),t&&JC(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $1(e,n){return $1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},$1(e,n)}function Q9(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&$1(e,n)}function cb(e){return cb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},cb(e)}function aT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aT=function(){return!!e})()}function J9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K9(e,n){if(n&&(Xd(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J9(e)}function X9(e){var n=aT();return function(){var t,r=cb(e);if(n){var a=cb(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return K9(this,t)}}function Z9(e){if(Array.isArray(e))return F1(e)}function e7(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function t7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kw(e){return Z9(e)||e7(e)||iT(e)||t7()}function n7(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function r7(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var i7=function(){function e(t){var r=this;this._insertTag=function(a){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,o),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(r7(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var o=n7(a);try{o.insertRule(r,o.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Oi="-ms-",ub="-moz-",Un="-webkit-",sT="comm",Xw="rule",Zw="decl",a7="@import",oT="@keyframes",s7="@layer",o7=Math.abs,Ub=String.fromCharCode,l7=Object.assign;function c7(e,n){return vi(e,0)^45?(((n<<2^vi(e,0))<<2^vi(e,1))<<2^vi(e,2))<<2^vi(e,3):0}function lT(e){return e.trim()}function u7(e,n){return(e=n.exec(e))?e[0]:e}function qn(e,n,t){return e.replace(n,t)}function z1(e,n){return e.indexOf(n)}function vi(e,n){return e.charCodeAt(n)|0}function rg(e,n,t){return e.slice(n,t)}function dl(e){return e.length}function eS(e){return e.length}function Cx(e,n){return n.push(e),e}function d7(e,n){return e.map(n).join("")}var qb=1,Yh=1,cT=0,_a=0,Kr=0,rp="";function Vb(e,n,t,r,a,o,l){return{value:e,root:n,parent:t,type:r,props:a,children:o,line:qb,column:Yh,length:l,return:""}}function Mm(e,n){return l7(Vb("",null,null,"",null,null,0),e,{length:-e.length},n)}function f7(){return Kr}function h7(){return Kr=_a>0?vi(rp,--_a):0,Yh--,Kr===10&&(Yh=1,qb--),Kr}function Xa(){return Kr=_a<cT?vi(rp,_a++):0,Yh++,Kr===10&&(Yh=1,qb++),Kr}function gl(){return vi(rp,_a)}function Gx(){return _a}function yg(e,n){return rg(rp,e,n)}function ig(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function uT(e){return qb=Yh=1,cT=dl(rp=e),_a=0,[]}function dT(e){return rp="",e}function Yx(e){return lT(yg(_a-1,B1(e===91?e+2:e===40?e+1:e)))}function p7(e){for(;(Kr=gl())&&Kr<33;)Xa();return ig(e)>2||ig(Kr)>3?"":" "}function m7(e,n){for(;--n&&Xa()&&!(Kr<48||Kr>102||Kr>57&&Kr<65||Kr>70&&Kr<97););return yg(e,Gx()+(n<6&&gl()==32&&Xa()==32))}function B1(e){for(;Xa();)switch(Kr){case e:return _a;case 34:case 39:e!==34&&e!==39&&B1(Kr);break;case 40:e===41&&B1(e);break;case 92:Xa();break}return _a}function g7(e,n){for(;Xa()&&e+Kr!==57;)if(e+Kr===84&&gl()===47)break;return"/*"+yg(n,_a-1)+"*"+Ub(e===47?e:Xa())}function y7(e){for(;!ig(gl());)Xa();return yg(e,_a)}function x7(e){return dT(Wx("",null,null,null,[""],e=uT(e),0,[0],e))}function Wx(e,n,t,r,a,o,l,d,f){for(var u=0,h=0,g=l,b=0,v=0,S=0,k=1,T=1,P=1,R=0,I="",B=a,F=o,L=r,U=I;T;)switch(S=R,R=Xa()){case 40:if(S!=108&&vi(U,g-1)==58){z1(U+=qn(Yx(R),"&","&\f"),"&\f")!=-1&&(P=-1);break}case 34:case 39:case 91:U+=Yx(R);break;case 9:case 10:case 13:case 32:U+=p7(S);break;case 92:U+=m7(Gx()-1,7);continue;case 47:switch(gl()){case 42:case 47:Cx(b7(g7(Xa(),Gx()),n,t),f);break;default:U+="/"}break;case 123*k:d[u++]=dl(U)*P;case 125*k:case 59:case 0:switch(R){case 0:case 125:T=0;case 59+h:P==-1&&(U=qn(U,/\f/g,"")),v>0&&dl(U)-g&&Cx(v>32?XC(U+";",r,t,g-1):XC(qn(U," ","")+";",r,t,g-2),f);break;case 59:U+=";";default:if(Cx(L=KC(U,n,t,u,h,a,d,I,B=[],F=[],g),o),R===123)if(h===0)Wx(U,n,L,L,B,o,g,d,F);else switch(b===99&&vi(U,3)===110?100:b){case 100:case 108:case 109:case 115:Wx(e,L,L,r&&Cx(KC(e,L,L,0,0,a,d,I,a,B=[],g),F),a,F,g,d,r?B:F);break;default:Wx(U,L,L,L,[""],F,0,d,F)}}u=h=v=0,k=P=1,I=U="",g=l;break;case 58:g=1+dl(U),v=S;default:if(k<1){if(R==123)--k;else if(R==125&&k++==0&&h7()==125)continue}switch(U+=Ub(R),R*k){case 38:P=h>0?1:(U+="\f",-1);break;case 44:d[u++]=(dl(U)-1)*P,P=1;break;case 64:gl()===45&&(U+=Yx(Xa())),b=gl(),h=g=dl(I=U+=y7(Gx())),R++;break;case 45:S===45&&dl(U)==2&&(k=0)}}return o}function KC(e,n,t,r,a,o,l,d,f,u,h){for(var g=a-1,b=a===0?o:[""],v=eS(b),S=0,k=0,T=0;S<r;++S)for(var P=0,R=rg(e,g+1,g=o7(k=l[S])),I=e;P<v;++P)(I=lT(k>0?b[P]+" "+R:qn(R,/&\f/g,b[P])))&&(f[T++]=I);return Vb(e,n,t,a===0?Xw:d,f,u,h)}function b7(e,n,t){return Vb(e,n,t,sT,Ub(f7()),rg(e,2,-2),0)}function XC(e,n,t,r){return Vb(e,n,t,Zw,rg(e,0,r),rg(e,r+1,-1),r)}function Fh(e,n){for(var t="",r=eS(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function v7(e,n,t,r){switch(e.type){case s7:if(e.children.length)break;case a7:case Zw:return e.return=e.return||e.value;case sT:return"";case oT:return e.return=e.value+"{"+Fh(e.children,r)+"}";case Xw:e.value=e.props.join(",")}return dl(t=Fh(e.children,r))?e.return=e.value+"{"+t+"}":""}function w7(e){var n=eS(e);return function(t,r,a,o){for(var l="",d=0;d<n;d++)l+=e[d](t,r,a,o)||"";return l}}function S7(e){return function(n){n.root||(n=n.return)&&e(n)}}function N7(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var C7=function(n,t,r){for(var a=0,o=0;a=o,o=gl(),a===38&&o===12&&(t[r]=1),!ig(o);)Xa();return yg(n,_a)},_7=function(n,t){var r=-1,a=44;do switch(ig(a)){case 0:a===38&&gl()===12&&(t[r]=1),n[r]+=C7(_a-1,t,r);break;case 2:n[r]+=Yx(a);break;case 4:if(a===44){n[++r]=gl()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Ub(a)}while(a=Xa());return n},j7=function(n,t){return dT(_7(uT(n),t))},ZC=new WeakMap,k7=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!ZC.get(r))&&!a){ZC.set(n,!0);for(var o=[],l=j7(t,o),d=r.props,f=0,u=0;f<l.length;f++)for(var h=0;h<d.length;h++,u++)n.props[u]=o[f]?l[f].replace(/&\f/g,d[h]):d[h]+" "+l[f]}}},T7=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function fT(e,n){switch(c7(e,n)){case 5103:return Un+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Un+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Un+e+ub+e+Oi+e+e;case 6828:case 4268:return Un+e+Oi+e+e;case 6165:return Un+e+Oi+"flex-"+e+e;case 5187:return Un+e+qn(e,/(\w+).+(:[^]+)/,Un+"box-$1$2"+Oi+"flex-$1$2")+e;case 5443:return Un+e+Oi+"flex-item-"+qn(e,/flex-|-self/,"")+e;case 4675:return Un+e+Oi+"flex-line-pack"+qn(e,/align-content|flex-|-self/,"")+e;case 5548:return Un+e+Oi+qn(e,"shrink","negative")+e;case 5292:return Un+e+Oi+qn(e,"basis","preferred-size")+e;case 6060:return Un+"box-"+qn(e,"-grow","")+Un+e+Oi+qn(e,"grow","positive")+e;case 4554:return Un+qn(e,/([^-])(transform)/g,"$1"+Un+"$2")+e;case 6187:return qn(qn(qn(e,/(zoom-|grab)/,Un+"$1"),/(image-set)/,Un+"$1"),e,"")+e;case 5495:case 3959:return qn(e,/(image-set\([^]*)/,Un+"$1$`$1");case 4968:return qn(qn(e,/(.+:)(flex-)?(.*)/,Un+"box-pack:$3"+Oi+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Un+e+e;case 4095:case 3583:case 4068:case 2532:return qn(e,/(.+)-inline(.+)/,Un+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(dl(e)-1-n>6)switch(vi(e,n+1)){case 109:if(vi(e,n+4)!==45)break;case 102:return qn(e,/(.+:)(.+)-([^]+)/,"$1"+Un+"$2-$3$1"+ub+(vi(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~z1(e,"stretch")?fT(qn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(vi(e,n+1)!==115)break;case 6444:switch(vi(e,dl(e)-3-(~z1(e,"!important")&&10))){case 107:return qn(e,":",":"+Un)+e;case 101:return qn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Un+(vi(e,14)===45?"inline-":"")+"box$3$1"+Un+"$2$3$1"+Oi+"$2box$3")+e}break;case 5936:switch(vi(e,n+11)){case 114:return Un+e+Oi+qn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Un+e+Oi+qn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Un+e+Oi+qn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Un+e+Oi+e+e}return e}var E7=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case Zw:n.return=fT(n.value,n.length);break;case oT:return Fh([Mm(n,{value:qn(n.value,"@","@"+Un)})],a);case Xw:if(n.length)return d7(n.props,function(o){switch(u7(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Fh([Mm(n,{props:[qn(o,/:(read-\w+)/,":"+ub+"$1")]})],a);case"::placeholder":return Fh([Mm(n,{props:[qn(o,/:(plac\w+)/,":"+Un+"input-$1")]}),Mm(n,{props:[qn(o,/:(plac\w+)/,":"+ub+"$1")]}),Mm(n,{props:[qn(o,/:(plac\w+)/,Oi+"input-$1")]})],a)}return""})}},A7=[E7],P7=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||A7,o={},l,d=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),P=1;P<T.length;P++)o[T[P]]=!0;d.push(k)});var f,u=[k7,T7];{var h,g=[v7,S7(function(k){h.insert(k)})],b=w7(u.concat(a,g)),v=function(T){return Fh(x7(T),b)};f=function(T,P,R,I){h=R,v(T?T+"{"+P.styles+"}":P.styles),I&&(S.inserted[P.name]=!0)}}var S={key:t,sheet:new i7({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:o,registered:{},insert:f};return S.sheet.hydrate(d),S},_0={exports:{}},Qn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e_;function D7(){if(e_)return Qn;e_=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,P=e?Symbol.for("react.responder"):60118,R=e?Symbol.for("react.scope"):60119;function I(F){if(typeof F=="object"&&F!==null){var L=F.$$typeof;switch(L){case n:switch(F=F.type,F){case f:case u:case r:case o:case a:case g:return F;default:switch(F=F&&F.$$typeof,F){case d:case h:case S:case v:case l:return F;default:return L}}case t:return L}}}function B(F){return I(F)===u}return Qn.AsyncMode=f,Qn.ConcurrentMode=u,Qn.ContextConsumer=d,Qn.ContextProvider=l,Qn.Element=n,Qn.ForwardRef=h,Qn.Fragment=r,Qn.Lazy=S,Qn.Memo=v,Qn.Portal=t,Qn.Profiler=o,Qn.StrictMode=a,Qn.Suspense=g,Qn.isAsyncMode=function(F){return B(F)||I(F)===f},Qn.isConcurrentMode=B,Qn.isContextConsumer=function(F){return I(F)===d},Qn.isContextProvider=function(F){return I(F)===l},Qn.isElement=function(F){return typeof F=="object"&&F!==null&&F.$$typeof===n},Qn.isForwardRef=function(F){return I(F)===h},Qn.isFragment=function(F){return I(F)===r},Qn.isLazy=function(F){return I(F)===S},Qn.isMemo=function(F){return I(F)===v},Qn.isPortal=function(F){return I(F)===t},Qn.isProfiler=function(F){return I(F)===o},Qn.isStrictMode=function(F){return I(F)===a},Qn.isSuspense=function(F){return I(F)===g},Qn.isValidElementType=function(F){return typeof F=="string"||typeof F=="function"||F===r||F===u||F===o||F===a||F===g||F===b||typeof F=="object"&&F!==null&&(F.$$typeof===S||F.$$typeof===v||F.$$typeof===l||F.$$typeof===d||F.$$typeof===h||F.$$typeof===T||F.$$typeof===P||F.$$typeof===R||F.$$typeof===k)},Qn.typeOf=I,Qn}var t_;function I7(){return t_||(t_=1,_0.exports=D7()),_0.exports}var j0,n_;function R7(){if(n_)return j0;n_=1;var e=I7(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[e.ForwardRef]=r,o[e.Memo]=a;function l(S){return e.isMemo(S)?a:o[S.$$typeof]||n}var d=Object.defineProperty,f=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,T){if(typeof k!="string"){if(b){var P=g(k);P&&P!==b&&v(S,P,T)}var R=f(k);u&&(R=R.concat(u(k)));for(var I=l(S),B=l(k),F=0;F<R.length;++F){var L=R[F];if(!t[L]&&!(T&&T[L])&&!(B&&B[L])&&!(I&&I[L])){var U=h(k,L);try{d(S,L,U)}catch{}}}}return S}return j0=v,j0}R7();var M7=!0;function O7(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var hT=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||M7===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},L7=function(n,t,r){hT(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var o=t;do n.insert(t===o?"."+a:"",o,n.sheet,!0),o=o.next;while(o!==void 0)}};function F7(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var $7={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},z7=/[A-Z]|^ms/g,B7=/_EMO_([^_]+?)_([^]*?)_EMO_/g,pT=function(n){return n.charCodeAt(1)===45},r_=function(n){return n!=null&&typeof n!="boolean"},k0=N7(function(e){return pT(e)?e:e.replace(z7,"-$&").toLowerCase()}),i_=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(B7,function(r,a,o){return fl={name:a,styles:o,next:fl},a})}return $7[n]!==1&&!pT(n)&&typeof t=="number"&&t!==0?t+"px":t};function ag(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return fl={name:a.name,styles:a.styles,next:fl},a.name;var o=t;if(o.styles!==void 0){var l=o.next;if(l!==void 0)for(;l!==void 0;)fl={name:l.name,styles:l.styles,next:fl},l=l.next;var d=o.styles+";";return d}return U7(e,n,t)}case"function":{if(e!==void 0){var f=fl,u=t(e);return fl=f,ag(e,n,u)}break}}var h=t;return h}function U7(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=ag(e,n,t[a])+";";else for(var o in t){var l=t[o];if(typeof l!="object"){var d=l;r_(d)&&(r+=k0(o)+":"+i_(o,d)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var f=0;f<l.length;f++)r_(l[f])&&(r+=k0(o)+":"+i_(o,l[f])+";");else{var u=ag(e,n,l);switch(o){case"animation":case"animationName":{r+=k0(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var a_=/label:\s*([^\s;{]+)\s*(;|$)/g,fl;function mT(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";fl=void 0;var o=e[0];if(o==null||o.raw===void 0)r=!1,a+=ag(t,n,o);else{var l=o;a+=l[0]}for(var d=1;d<e.length;d++)if(a+=ag(t,n,e[d]),r){var f=o;a+=f[d]}a_.lastIndex=0;for(var u="",h;(h=a_.exec(a))!==null;)u+="-"+h[1];var g=F7(a)+u;return{name:g,styles:a,next:fl}}var q7=function(n){return n()},V7=RS.useInsertionEffect?RS.useInsertionEffect:!1,H7=V7||q7,gT=w.createContext(typeof HTMLElement<"u"?P7({key:"css"}):null);gT.Provider;var G7=function(n){return w.forwardRef(function(t,r){var a=w.useContext(gT);return n(t,a,r)})},Y7=w.createContext({}),tS={}.hasOwnProperty,U1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",W7=function(n,t){var r={};for(var a in t)tS.call(t,a)&&(r[a]=t[a]);return r[U1]=n,r},Q7=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return hT(t,r,a),H7(function(){return L7(t,r,a)}),null},J7=G7(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[U1],o=[r],l="";typeof e.className=="string"?l=O7(n.registered,o,e.className):e.className!=null&&(l=e.className+" ");var d=mT(o,void 0,w.useContext(Y7));l+=n.key+"-"+d.name;var f={};for(var u in e)tS.call(e,u)&&u!=="css"&&u!==U1&&(f[u]=e[u]);return f.className=l,t&&(f.ref=t),w.createElement(w.Fragment,null,w.createElement(Q7,{cache:n,serialized:d,isStringTag:typeof a=="string"}),w.createElement(a,f))}),K7=J7,It=function(n,t){var r=arguments;if(t==null||!tS.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,o=new Array(a);o[0]=K7,o[1]=W7(n,t);for(var l=2;l<a;l++)o[l]=r[l];return w.createElement.apply(null,o)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(It||(It={}));function nS(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return mT(n)}function X7(){var e=nS.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function Z7(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const eq=Math.min,tq=Math.max,db=Math.round,_x=Math.floor,fb=e=>({x:e,y:e});function nq(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function Hb(){return typeof window<"u"}function yT(e){return bT(e)?(e.nodeName||"").toLowerCase():"#document"}function uc(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function xT(e){var n;return(n=(bT(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function bT(e){return Hb()?e instanceof Node||e instanceof uc(e).Node:!1}function rq(e){return Hb()?e instanceof Element||e instanceof uc(e).Element:!1}function rS(e){return Hb()?e instanceof HTMLElement||e instanceof uc(e).HTMLElement:!1}function s_(e){return!Hb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof uc(e).ShadowRoot}const iq=new Set(["inline","contents"]);function vT(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=iS(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!iq.has(a)}function aq(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const sq=new Set(["html","body","#document"]);function oq(e){return sq.has(yT(e))}function iS(e){return uc(e).getComputedStyle(e)}function lq(e){if(yT(e)==="html")return e;const n=e.assignedSlot||e.parentNode||s_(e)&&e.host||xT(e);return s_(n)?n.host:n}function wT(e){const n=lq(e);return oq(n)?e.ownerDocument?e.ownerDocument.body:e.body:rS(n)&&vT(n)?n:wT(n)}function hb(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=wT(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=uc(a);if(o){const d=q1(l);return n.concat(l,l.visualViewport||[],vT(a)?a:[],d&&t?hb(d):[])}return n.concat(a,hb(a,[],t))}function q1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function cq(e){const n=iS(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=rS(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,d=db(t)!==o||db(r)!==l;return d&&(t=o,r=l),{width:t,height:r,$:d}}function aS(e){return rq(e)?e:e.contextElement}function o_(e){const n=aS(e);if(!rS(n))return fb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=cq(n);let l=(o?db(t.width):t.width)/r,d=(o?db(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!d||!Number.isFinite(d))&&(d=1),{x:l,y:d}}const uq=fb(0);function dq(e){const n=uc(e);return!aq()||!n.visualViewport?uq:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function fq(e,n,t){return!1}function l_(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=aS(e);let l=fb(1);n&&(l=o_(e));const d=fq()?dq(o):fb(0);let f=(a.left+d.x)/l.x,u=(a.top+d.y)/l.y,h=a.width/l.x,g=a.height/l.y;if(o){const b=uc(o),v=r;let S=b,k=q1(S);for(;k&&r&&v!==S;){const T=o_(k),P=k.getBoundingClientRect(),R=iS(k),I=P.left+(k.clientLeft+parseFloat(R.paddingLeft))*T.x,B=P.top+(k.clientTop+parseFloat(R.paddingTop))*T.y;f*=T.x,u*=T.y,h*=T.x,g*=T.y,f+=I,u+=B,S=uc(k),k=q1(S)}}return nq({width:h,height:g,x:f,y:u})}function ST(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function hq(e,n){let t=null,r;const a=xT(e);function o(){var d;clearTimeout(r),(d=t)==null||d.disconnect(),t=null}function l(d,f){d===void 0&&(d=!1),f===void 0&&(f=1),o();const u=e.getBoundingClientRect(),{left:h,top:g,width:b,height:v}=u;if(d||n(),!b||!v)return;const S=_x(g),k=_x(a.clientWidth-(h+b)),T=_x(a.clientHeight-(g+v)),P=_x(h),I={rootMargin:-S+"px "+-k+"px "+-T+"px "+-P+"px",threshold:tq(0,eq(1,f))||1};let B=!0;function F(L){const U=L[0].intersectionRatio;if(U!==f){if(!B)return l();U?l(!1,U):r=setTimeout(()=>{l(!1,1e-7)},1e3)}U===1&&!ST(u,e.getBoundingClientRect())&&l(),B=!1}try{t=new IntersectionObserver(F,{...I,root:a.ownerDocument})}catch{t=new IntersectionObserver(F,I)}t.observe(e)}return l(!0),o}function pq(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,u=aS(e),h=a||o?[...u?hb(u):[],...hb(n)]:[];h.forEach(P=>{a&&P.addEventListener("scroll",t,{passive:!0}),o&&P.addEventListener("resize",t)});const g=u&&d?hq(u,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(P=>{let[R]=P;R&&R.target===u&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var I;(I=v)==null||I.observe(n)})),t()}),u&&!f&&v.observe(u),v.observe(n));let S,k=f?l_(e):null;f&&T();function T(){const P=l_(e);k&&!ST(k,P)&&t(),k=P,S=requestAnimationFrame(T)}return t(),()=>{var P;h.forEach(R=>{a&&R.removeEventListener("scroll",t),o&&R.removeEventListener("resize",t)}),g==null||g(),(P=v)==null||P.disconnect(),v=null,f&&cancelAnimationFrame(S)}}var V1=w.useLayoutEffect,mq=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],pb=function(){};function gq(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function yq(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var o=[].concat(r);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&o.push("".concat(gq(e,l)));return o.filter(function(d){return d}).map(function(d){return String(d).trim()}).join(" ")}var c_=function(n){return jq(n)?n.filter(Boolean):Xd(n)==="object"&&n!==null?[n]:[]},NT=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=fc(n,mq);return $t({},t)},Dr=function(n,t,r){var a=n.cx,o=n.getStyles,l=n.getClassNames,d=n.className;return{css:o(t,n),className:a(r??{},l(t,n),d)}};function Gb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function xq(e){return Gb(e)?window.innerHeight:e.clientHeight}function CT(e){return Gb(e)?window.pageYOffset:e.scrollTop}function mb(e,n){if(Gb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function bq(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function vq(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function jx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:pb,a=CT(e),o=n-a,l=10,d=0;function f(){d+=l;var u=vq(d,a,o,t);mb(e,u),d<t?window.requestAnimationFrame(f):r(e)}f()}function u_(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?mb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&mb(e,Math.max(n.offsetTop-a,0))}function wq(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function d_(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function Sq(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var _T=!1,Nq={get passive(){return _T=!0}},kx=typeof window<"u"?window:{};kx.addEventListener&&kx.removeEventListener&&(kx.addEventListener("p",pb,Nq),kx.removeEventListener("p",pb,!1));var Cq=_T;function _q(e){return e!=null}function jq(e){return Array.isArray(e)}function Tx(e,n,t){return e?n:t}var kq=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var o=Object.entries(n).filter(function(l){var d=lc(l,1),f=d[0];return!r.includes(f)});return o.reduce(function(l,d){var f=lc(d,2),u=f[0],h=f[1];return l[u]=h,l},{})},Tq=["children","innerProps"],Eq=["children","innerProps"];function Aq(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,o=e.shouldScroll,l=e.isFixedPosition,d=e.controlHeight,f=bq(t),u={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return u;var h=f.getBoundingClientRect(),g=h.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),P=T.top,R=l?window.innerHeight:xq(f),I=CT(f),B=parseInt(getComputedStyle(t).marginBottom,10),F=parseInt(getComputedStyle(t).marginTop,10),L=P-F,U=R-k,H=L+I,K=g-I-k,M=v-R+I+B,$=I+k-F,z=160;switch(a){case"auto":case"bottom":if(U>=S)return{placement:"bottom",maxHeight:n};if(K>=S&&!l)return o&&jx(f,M,z),{placement:"bottom",maxHeight:n};if(!l&&K>=r||l&&U>=r){o&&jx(f,M,z);var W=l?U-B:K-B;return{placement:"bottom",maxHeight:W}}if(a==="auto"||l){var te=n,V=l?L:H;return V>=r&&(te=Math.min(V-B-d,n)),{placement:"top",maxHeight:te}}if(a==="bottom")return o&&mb(f,M),{placement:"bottom",maxHeight:n};break;case"top":if(L>=S)return{placement:"top",maxHeight:n};if(H>=S&&!l)return o&&jx(f,$,z),{placement:"top",maxHeight:n};if(!l&&H>=r||l&&L>=r){var G=n;return(!l&&H>=r||l&&L>=r)&&(G=l?L-F:H-F),o&&jx(f,$,z),{placement:"top",maxHeight:G}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return u}function Pq(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var jT=function(n){return n==="auto"?"bottom":n},Dq=function(n,t){var r,a=n.placement,o=n.theme,l=o.borderRadius,d=o.spacing,f=o.colors;return $t((r={label:"menu"},Vm(r,Pq(a),"100%"),Vm(r,"position","absolute"),Vm(r,"width","100%"),Vm(r,"zIndex",1),r),t?{}:{backgroundColor:f.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:d.menuGutter,marginTop:d.menuGutter})},kT=w.createContext(null),Iq=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,o=n.menuPlacement,l=n.menuPosition,d=n.menuShouldScrollIntoView,f=n.theme,u=w.useContext(kT)||{},h=u.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=lc(b,2),S=v[0],k=v[1],T=w.useState(null),P=lc(T,2),R=P[0],I=P[1],B=f.spacing.controlHeight;return V1(function(){var F=g.current;if(F){var L=l==="fixed",U=d&&!L,H=Aq({maxHeight:a,menuEl:F,minHeight:r,placement:o,shouldScroll:U,isFixedPosition:L,controlHeight:B});k(H.maxHeight),I(H.placement),h==null||h(H.placement)}},[a,o,l,d,r,h,B]),t({ref:g,placerProps:$t($t({},n),{},{placement:R||jT(o),maxHeight:S})})},Rq=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return It("div",Ut({},Dr(n,"menu",{menu:!0}),{ref:r},a),t)},Mq=Rq,Oq=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return $t({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},Lq=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,o=n.isMulti;return It("div",Ut({},Dr(n,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:a},r),t)},TT=function(n,t){var r=n.theme,a=r.spacing.baseUnit,o=r.colors;return $t({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},Fq=TT,$q=TT,zq=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,o=fc(n,Tq);return It("div",Ut({},Dr($t($t({},o),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},Bq=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,o=fc(n,Eq);return It("div",Ut({},Dr($t($t({},o),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},Uq=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},qq=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,o=n.innerProps,l=n.menuPlacement,d=n.menuPosition,f=w.useRef(null),u=w.useRef(null),h=w.useState(jT(l)),g=lc(h,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=lc(k,2),P=T[0],R=T[1],I=w.useCallback(function(){if(a){var U=wq(a),H=d==="fixed"?0:window.pageYOffset,K=U[b]+H;(K!==(P==null?void 0:P.offset)||U.left!==(P==null?void 0:P.rect.left)||U.width!==(P==null?void 0:P.rect.width))&&R({offset:K,rect:U})}},[a,d,b,P==null?void 0:P.offset,P==null?void 0:P.rect.left,P==null?void 0:P.rect.width]);V1(function(){I()},[I]);var B=w.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),a&&f.current&&(u.current=pq(a,f.current,I,{elementResize:"ResizeObserver"in window}))},[a,I]);V1(function(){B()},[B]);var F=w.useCallback(function(U){f.current=U,B()},[B]);if(!t&&d!=="fixed"||!P)return null;var L=It("div",Ut({ref:F},Dr($t($t({},n),{},{offset:P.offset,position:d,rect:P.rect}),"menuPortal",{"menu-portal":!0}),o),r);return It(kT.Provider,{value:S},t?gI.createPortal(L,t):L)},Vq=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},Hq=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,o=n.isRtl;return It("div",Ut({},Dr(n,"container",{"--is-disabled":a,"--is-rtl":o}),r),t)},Gq=function(n,t){var r=n.theme.spacing,a=n.isMulti,o=n.hasValue,l=n.selectProps.controlShouldRenderValue;return $t({alignItems:"center",display:a&&o&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},Yq=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,o=n.hasValue;return It("div",Ut({},Dr(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":o}),r),t)},Wq=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},Qq=function(n){var t=n.children,r=n.innerProps;return It("div",Ut({},Dr(n,"indicatorsContainer",{indicators:!0}),r),t)},f_,Jq=["size"],Kq=["innerProps","isRtl","size"],Xq={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},ET=function(n){var t=n.size,r=fc(n,Jq);return It("svg",Ut({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Xq},r))},sS=function(n){return It(ET,Ut({size:20},n),It("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},AT=function(n){return It(ET,Ut({size:20},n),It("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},PT=function(n,t){var r=n.isFocused,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return $t({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?l.neutral60:l.neutral20,padding:o*2,":hover":{color:r?l.neutral80:l.neutral40}})},Zq=PT,eV=function(n){var t=n.children,r=n.innerProps;return It("div",Ut({},Dr(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||It(AT,null))},tV=PT,nV=function(n){var t=n.children,r=n.innerProps;return It("div",Ut({},Dr(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||It(sS,null))},rV=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return $t({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?l.neutral10:l.neutral20,marginBottom:o*2,marginTop:o*2})},iV=function(n){var t=n.innerProps;return It("span",Ut({},t,Dr(n,"indicatorSeparator",{"indicator-separator":!0})))},aV=X7(f_||(f_=Z7([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),sV=function(n,t){var r=n.isFocused,a=n.size,o=n.theme,l=o.colors,d=o.spacing.baseUnit;return $t({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?l.neutral60:l.neutral20,padding:d*2})},T0=function(n){var t=n.delay,r=n.offset;return It("span",{css:nS({animation:"".concat(aV," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},oV=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,o=a===void 0?4:a,l=fc(n,Kq);return It("div",Ut({},Dr($t($t({},l),{},{innerProps:t,isRtl:r,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),It(T0,{delay:0,offset:r}),It(T0,{delay:160,offset:!0}),It(T0,{delay:320,offset:!r}))},lV=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.theme,l=o.colors,d=o.borderRadius,f=o.spacing;return $t({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:f.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?l.neutral5:l.neutral0,borderColor:r?l.neutral10:a?l.primary:l.neutral20,borderRadius:d,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},cV=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.innerRef,l=n.innerProps,d=n.menuIsOpen;return It("div",Ut({ref:o},Dr(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":d}),l,{"aria-disabled":r||void 0}),t)},uV=cV,dV=["data"],fV=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},hV=function(n){var t=n.children,r=n.cx,a=n.getStyles,o=n.getClassNames,l=n.Heading,d=n.headingProps,f=n.innerProps,u=n.label,h=n.theme,g=n.selectProps;return It("div",Ut({},Dr(n,"group",{group:!0}),f),It(l,Ut({},d,{selectProps:g,theme:h,getStyles:a,getClassNames:o,cx:r}),u),It("div",null,t))},pV=function(n,t){var r=n.theme,a=r.colors,o=r.spacing;return $t({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},mV=function(n){var t=NT(n);t.data;var r=fc(t,dV);return It("div",Ut({},Dr(n,"groupHeading",{"group-heading":!0}),r))},gV=hV,yV=["innerRef","isDisabled","isHidden","inputClassName"],xV=function(n,t){var r=n.isDisabled,a=n.value,o=n.theme,l=o.spacing,d=o.colors;return $t($t({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},bV),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:d.neutral80})},DT={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},bV={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":$t({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},DT)},vV=function(n){return $t({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},DT)},wV=function(n){var t=n.cx,r=n.value,a=NT(n),o=a.innerRef,l=a.isDisabled,d=a.isHidden,f=a.inputClassName,u=fc(a,yV);return It("div",Ut({},Dr(n,"input",{"input-container":!0}),{"data-value":r||""}),It("input",Ut({className:t({input:!0},f),ref:o,style:vV(d),disabled:l},u)))},SV=wV,NV=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors;return $t({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:o/2,margin:a.baseUnit/2})},CV=function(n,t){var r=n.theme,a=r.borderRadius,o=r.colors,l=n.cropWithEllipsis;return $t({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},_V=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors,d=n.isFocused;return $t({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:d?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},IT=function(n){var t=n.children,r=n.innerProps;return It("div",r,t)},jV=IT,kV=IT;function TV(e){var n=e.children,t=e.innerProps;return It("div",Ut({role:"button"},t),n||It(sS,{size:14}))}var EV=function(n){var t=n.children,r=n.components,a=n.data,o=n.innerProps,l=n.isDisabled,d=n.removeProps,f=n.selectProps,u=r.Container,h=r.Label,g=r.Remove;return It(u,{data:a,innerProps:$t($t({},Dr(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),o),selectProps:f},It(h,{data:a,innerProps:$t({},Dr(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:f},t),It(g,{data:a,innerProps:$t($t({},Dr(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},d),selectProps:f}))},AV=EV,PV=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.theme,d=l.spacing,f=l.colors;return $t({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?f.primary:a?f.primary25:"transparent",color:r?f.neutral20:o?f.neutral0:"inherit",padding:"".concat(d.baseUnit*2,"px ").concat(d.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:o?f.primary:f.primary50}})},DV=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.innerRef,d=n.innerProps;return It("div",Ut({},Dr(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":o}),{ref:l,"aria-disabled":r},d),t)},IV=DV,RV=function(n,t){var r=n.theme,a=r.spacing,o=r.colors;return $t({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},MV=function(n){var t=n.children,r=n.innerProps;return It("div",Ut({},Dr(n,"placeholder",{placeholder:!0}),r),t)},OV=MV,LV=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing,l=a.colors;return $t({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?l.neutral40:l.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},FV=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return It("div",Ut({},Dr(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},$V=FV,zV={ClearIndicator:nV,Control:uV,DropdownIndicator:eV,DownChevron:AT,CrossIcon:sS,Group:gV,GroupHeading:mV,IndicatorsContainer:Qq,IndicatorSeparator:iV,Input:SV,LoadingIndicator:oV,Menu:Mq,MenuList:Lq,MenuPortal:qq,LoadingMessage:Bq,NoOptionsMessage:zq,MultiValue:AV,MultiValueContainer:jV,MultiValueLabel:kV,MultiValueRemove:TV,Option:IV,Placeholder:OV,SelectContainer:Hq,SingleValue:$V,ValueContainer:Yq},BV=function(n){return $t($t({},zV),n.components)},h_=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function UV(e,n){return!!(e===n||h_(e)&&h_(n))}function qV(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!UV(e[t],n[t]))return!1;return!0}function VV(e,n){n===void 0&&(n=qV);var t=null;function r(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return r.clear=function(){t=null},r}var HV={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},GV=function(n){return It("span",Ut({css:HV},n))},p_=GV,YV={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,o=n.context,l=n.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,o=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,o=n.label,l=o===void 0?"":o,d=n.selectValue,f=n.isDisabled,u=n.isSelected,h=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&d)return"value ".concat(l," focused, ").concat(g(d,r),".");if(t==="menu"&&h){var b=f?" disabled":"",v="".concat(u?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},WV=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,o=n.focusableOptions,l=n.isFocused,d=n.selectValue,f=n.selectProps,u=n.id,h=n.isAppleDevice,g=f.ariaLiveMessages,b=f.getOptionLabel,v=f.inputValue,S=f.isMulti,k=f.isOptionDisabled,T=f.isSearchable,P=f.menuIsOpen,R=f.options,I=f.screenReaderStatus,B=f.tabSelectsValue,F=f.isLoading,L=f["aria-label"],U=f["aria-live"],H=w.useMemo(function(){return $t($t({},YV),g||{})},[g]),K=w.useMemo(function(){var V="";if(t&&H.onChange){var G=t.option,J=t.options,oe=t.removedValue,ie=t.removedValues,E=t.value,ce=function(X){return Array.isArray(X)?null:X},ge=oe||G||ce(E),D=ge?b(ge):"",pe=J||ie||void 0,Ce=pe?pe.map(b):[],Z=$t({isDisabled:ge&&k(ge,d),label:D,labels:Ce},t);V=H.onChange(Z)}return V},[t,H,k,d,b]),M=w.useMemo(function(){var V="",G=r||a,J=!!(r&&d&&d.includes(r));if(G&&H.onFocus){var oe={focused:G,label:b(G),isDisabled:k(G,d),isSelected:J,options:o,context:G===r?"menu":"value",selectValue:d,isAppleDevice:h};V=H.onFocus(oe)}return V},[r,a,b,k,H,o,d,h]),$=w.useMemo(function(){var V="";if(P&&R.length&&!F&&H.onFilter){var G=I({count:o.length});V=H.onFilter({inputValue:v,resultsMessage:G})}return V},[o,v,P,H,R,I,F]),z=(t==null?void 0:t.action)==="initial-input-focus",W=w.useMemo(function(){var V="";if(H.guidance){var G=a?"value":P?"menu":"input";V=H.guidance({"aria-label":L,context:G,isDisabled:r&&k(r,d),isMulti:S,isSearchable:T,tabSelectsValue:B,isInitialFocus:z})}return V},[L,r,a,S,k,T,P,H,d,B,z]),te=It(w.Fragment,null,It("span",{id:"aria-selection"},K),It("span",{id:"aria-focused"},M),It("span",{id:"aria-results"},$),It("span",{id:"aria-guidance"},W));return It(w.Fragment,null,It(p_,{id:u},z&&te),It(p_,{"aria-live":U,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!z&&te))},QV=WV,H1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],JV=new RegExp("["+H1.map(function(e){return e.letters}).join("")+"]","g"),RT={};for(var E0=0;E0<H1.length;E0++)for(var A0=H1[E0],P0=0;P0<A0.letters.length;P0++)RT[A0.letters[P0]]=A0.base;var MT=function(n){return n.replace(JV,function(t){return RT[t]})},KV=VV(MT),m_=function(n){return n.replace(/^\s+|\s+$/g,"")},XV=function(n){return"".concat(n.label," ").concat(n.value)},ZV=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=$t({ignoreCase:!0,ignoreAccents:!0,stringify:XV,trim:!0,matchFrom:"any"},n),o=a.ignoreCase,l=a.ignoreAccents,d=a.stringify,f=a.trim,u=a.matchFrom,h=f?m_(r):r,g=f?m_(d(t)):d(t);return o&&(h=h.toLowerCase(),g=g.toLowerCase()),l&&(h=KV(h),g=MT(g)),u==="start"?g.substr(0,h.length)===h:g.indexOf(h)>-1}},eH=["innerRef"];function tH(e){var n=e.innerRef,t=fc(e,eH),r=kq(t,"onExited","in","enter","exit","appear");return It("input",Ut({ref:n},r,{css:nS({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var nH=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function rH(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,o=e.onTopLeave,l=w.useRef(!1),d=w.useRef(!1),f=w.useRef(0),u=w.useRef(null),h=w.useCallback(function(T,P){if(u.current!==null){var R=u.current,I=R.scrollTop,B=R.scrollHeight,F=R.clientHeight,L=u.current,U=P>0,H=B-F-I,K=!1;H>P&&l.current&&(r&&r(T),l.current=!1),U&&d.current&&(o&&o(T),d.current=!1),U&&P>H?(t&&!l.current&&t(T),L.scrollTop=B,K=!0,l.current=!0):!U&&-P>I&&(a&&!d.current&&a(T),L.scrollTop=0,K=!0,d.current=!0),K&&nH(T)}},[t,r,a,o]),g=w.useCallback(function(T){h(T,T.deltaY)},[h]),b=w.useCallback(function(T){f.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var P=f.current-T.changedTouches[0].clientY;h(T,P)},[h]),S=w.useCallback(function(T){if(T){var P=Cq?{passive:!1}:!1;T.addEventListener("wheel",g,P),T.addEventListener("touchstart",b,P),T.addEventListener("touchmove",v,P)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=u.current;return S(T),function(){k(T)}}},[n,S,k]),function(T){u.current=T}}var g_=["boxSizing","height","overflow","paddingRight","position"],y_={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function x_(e){e.cancelable&&e.preventDefault()}function b_(e){e.stopPropagation()}function v_(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function w_(){return"ontouchstart"in window||navigator.maxTouchPoints}var S_=!!(typeof window<"u"&&window.document&&window.document.createElement),Om=0,kh={capture:!1,passive:!1};function iH(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),o=w.useRef(null),l=w.useCallback(function(f){if(S_){var u=document.body,h=u&&u.style;if(r&&g_.forEach(function(S){var k=h&&h[S];a.current[S]=k}),r&&Om<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(y_).forEach(function(S){var k=y_[S];h&&(h[S]=k)}),h&&(h.paddingRight="".concat(v,"px"))}u&&w_()&&(u.addEventListener("touchmove",x_,kh),f&&(f.addEventListener("touchstart",v_,kh),f.addEventListener("touchmove",b_,kh))),Om+=1}},[r]),d=w.useCallback(function(f){if(S_){var u=document.body,h=u&&u.style;Om=Math.max(Om-1,0),r&&Om<1&&g_.forEach(function(g){var b=a.current[g];h&&(h[g]=b)}),u&&w_()&&(u.removeEventListener("touchmove",x_,kh),f&&(f.removeEventListener("touchstart",v_,kh),f.removeEventListener("touchmove",b_,kh)))}},[r]);return w.useEffect(function(){if(n){var f=o.current;return l(f),function(){d(f)}}},[n,l,d]),function(f){o.current=f}}var aH=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},sH={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function oH(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,o=e.onBottomArrive,l=e.onBottomLeave,d=e.onTopArrive,f=e.onTopLeave,u=rH({isEnabled:a,onBottomArrive:o,onBottomLeave:l,onTopArrive:d,onTopLeave:f}),h=iH({isEnabled:t}),g=function(v){u(v),h(v)};return It(w.Fragment,null,t&&It("div",{onClick:aH,css:sH}),n(g))}var lH={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},cH=function(n){var t=n.name,r=n.onFocus;return It("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:lH,value:"",onChange:function(){}})},uH=cH;function oS(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function dH(){return oS(/^iPhone/i)}function OT(){return oS(/^Mac/i)}function fH(){return oS(/^iPad/i)||OT()&&navigator.maxTouchPoints>1}function hH(){return dH()||fH()}function pH(){return OT()||hH()}var mH=function(n){return n.label},gH=function(n){return n.label},yH=function(n){return n.value},xH=function(n){return!!n.isDisabled},bH={clearIndicator:tV,container:Vq,control:lV,dropdownIndicator:Zq,group:fV,groupHeading:pV,indicatorsContainer:Wq,indicatorSeparator:rV,input:xV,loadingIndicator:sV,loadingMessage:$q,menu:Dq,menuList:Oq,menuPortal:Uq,multiValue:NV,multiValueLabel:CV,multiValueRemove:_V,noOptionsMessage:Fq,option:PV,placeholder:RV,singleValue:LV,valueContainer:Gq},vH={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},wH=4,LT=4,SH=38,NH=LT*2,CH={baseUnit:LT,controlHeight:SH,menuGutter:NH},D0={borderRadius:wH,colors:vH,spacing:CH},_H={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:d_(),captureMenuScroll:!d_(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:ZV(),formatGroupLabel:mH,getOptionLabel:gH,getOptionValue:yH,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:xH,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!Sq(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function N_(e,n,t,r){var a=zT(e,n,t),o=BT(e,n,t),l=$T(e,n),d=gb(e,n);return{type:"option",data:n,isDisabled:a,isSelected:o,label:l,value:d,index:r}}function Qx(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(l,d){return N_(e,l,n,d)}).filter(function(l){return __(e,l)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var o=N_(e,t,n,r);return __(e,o)?o:void 0}).filter(_q)}function FT(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,Kw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function C_(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,Kw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function jH(e,n){return FT(Qx(e,n))}function __(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,o=n.isSelected,l=n.label,d=n.value;return(!qT(e)||!o)&&UT(e,{label:l,value:d,data:a},r)}function kH(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var o=n.indexOf(t);if(o>-1)return t;if(a<n.length)return n[a]}return null}function TH(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var I0=function(n,t){var r,a=(r=n.find(function(o){return o.data===t}))===null||r===void 0?void 0:r.id;return a||null},$T=function(n,t){return n.getOptionLabel(t)},gb=function(n,t){return n.getOptionValue(t)};function zT(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function BT(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=gb(e,n);return t.some(function(a){return gb(e,a)===r})}function UT(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var qT=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},EH=1,VT=function(e){Q9(t,e);var n=X9(t);function t(r){var a;if(Y9(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(f){a.controlRef=f},a.focusedOptionRef=null,a.getFocusedOptionRef=function(f){a.focusedOptionRef=f},a.menuListRef=null,a.getMenuListRef=function(f){a.menuListRef=f},a.inputRef=null,a.getInputRef=function(f){a.inputRef=f},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(f,u){var h=a.props,g=h.onChange,b=h.name;u.name=b,a.ariaOnChange(f,u),g(f,u)},a.setValue=function(f,u,h){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(f,{action:u,option:h})},a.selectOption=function(f){var u=a.props,h=u.blurInputOnSelect,g=u.isMulti,b=u.name,v=a.state.selectValue,S=g&&a.isOptionSelected(f,v),k=a.isOptionDisabled(f,v);if(S){var T=a.getOptionValue(f);a.setValue(v.filter(function(P){return a.getOptionValue(P)!==T}),"deselect-option",f)}else if(!k)g?a.setValue([].concat(Kw(v),[f]),"select-option",f):a.setValue(f,"select-option");else{a.ariaOnChange(f,{action:"select-option",option:f,name:b});return}h&&a.blurInput()},a.removeValue=function(f){var u=a.props.isMulti,h=a.state.selectValue,g=a.getOptionValue(f),b=h.filter(function(S){return a.getOptionValue(S)!==g}),v=Tx(u,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:f}),a.focusInput()},a.clearValue=function(){var f=a.state.selectValue;a.onChange(Tx(a.props.isMulti,[],null),{action:"clear",removedValues:f})},a.popValue=function(){var f=a.props.isMulti,u=a.state.selectValue,h=u[u.length-1],g=u.slice(0,u.length-1),b=Tx(f,g,g[0]||null);h&&a.onChange(b,{action:"pop-value",removedValue:h})},a.getFocusedOptionId=function(f){return I0(a.state.focusableOptionsWithIds,f)},a.getFocusableOptionsWithIds=function(){return C_(Qx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var f=arguments.length,u=new Array(f),h=0;h<f;h++)u[h]=arguments[h];return yq.apply(void 0,[a.props.classNamePrefix].concat(u))},a.getOptionLabel=function(f){return $T(a.props,f)},a.getOptionValue=function(f){return gb(a.props,f)},a.getStyles=function(f,u){var h=a.props.unstyled,g=bH[f](u,h);g.boxSizing="border-box";var b=a.props.styles[f];return b?b(g,u):g},a.getClassNames=function(f,u){var h,g;return(h=(g=a.props.classNames)[f])===null||h===void 0?void 0:h.call(g,u)},a.getElementId=function(f){return"".concat(a.state.instancePrefix,"-").concat(f)},a.getComponents=function(){return BV(a.props)},a.buildCategorizedOptions=function(){return Qx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return FT(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(f,u){a.setState({ariaSelection:$t({value:f},u)})},a.onMenuMouseDown=function(f){f.button===0&&(f.stopPropagation(),f.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(f){a.blockOptionHover=!1},a.onControlMouseDown=function(f){if(!f.defaultPrevented){var u=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&a.onMenuClose():u&&a.openMenu("first"):(u&&(a.openAfterFocus=!0),a.focusInput()),f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&f.preventDefault()}},a.onDropdownIndicatorMouseDown=function(f){if(!(f&&f.type==="mousedown"&&f.button!==0)&&!a.props.isDisabled){var u=a.props,h=u.isMulti,g=u.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!h}),a.onMenuClose()):a.openMenu("first"),f.preventDefault()}},a.onClearIndicatorMouseDown=function(f){f&&f.type==="mousedown"&&f.button!==0||(a.clearValue(),f.preventDefault(),a.openAfterFocus=!1,f.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(f){typeof a.props.closeMenuOnScroll=="boolean"?f.target instanceof HTMLElement&&Gb(f.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(f)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(f){var u=f.touches,h=u&&u.item(0);h&&(a.initialTouchX=h.clientX,a.initialTouchY=h.clientY,a.userIsDragging=!1)},a.onTouchMove=function(f){var u=f.touches,h=u&&u.item(0);if(h){var g=Math.abs(h.clientX-a.initialTouchX),b=Math.abs(h.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(f){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(f.target)&&a.menuListRef&&!a.menuListRef.contains(f.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(f){a.userIsDragging||a.onControlMouseDown(f)},a.onClearIndicatorTouchEnd=function(f){a.userIsDragging||a.onClearIndicatorMouseDown(f)},a.onDropdownIndicatorTouchEnd=function(f){a.userIsDragging||a.onDropdownIndicatorMouseDown(f)},a.handleInputChange=function(f){var u=a.props.inputValue,h=f.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(h,{action:"input-change",prevInputValue:u}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(f){a.props.onFocus&&a.props.onFocus(f),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(f){var u=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(f),a.onInputChange("",{action:"input-blur",prevInputValue:u}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(f){if(!(a.blockOptionHover||a.state.focusedOption===f)){var u=a.getFocusableOptions(),h=u.indexOf(f);a.setState({focusedOption:f,focusedOptionId:h>-1?a.getFocusedOptionId(f):null})}},a.shouldHideSelectedOptions=function(){return qT(a.props)},a.onValueInputFocus=function(f){f.preventDefault(),f.stopPropagation(),a.focus()},a.onKeyDown=function(f){var u=a.props,h=u.isMulti,g=u.backspaceRemovesValue,b=u.escapeClearsValue,v=u.inputValue,S=u.isClearable,k=u.isDisabled,T=u.menuIsOpen,P=u.onKeyDown,R=u.tabSelectsValue,I=u.openMenuOnFocus,B=a.state,F=B.focusedOption,L=B.focusedValue,U=B.selectValue;if(!k&&!(typeof P=="function"&&(P(f),f.defaultPrevented))){switch(a.blockOptionHover=!0,f.key){case"ArrowLeft":if(!h||v)return;a.focusValue("previous");break;case"ArrowRight":if(!h||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if(L)a.removeValue(L);else{if(!g)return;h?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||f.shiftKey||!T||!R||!F||I&&a.isOptionSelected(F,U))return;a.selectOption(F);break;case"Enter":if(f.keyCode===229)break;if(T){if(!F||a.isComposing)return;a.selectOption(F);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!F)return;a.selectOption(F);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}f.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++EH),a.state.selectValue=c_(r.value),r.menuIsOpen&&a.state.selectValue.length){var o=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),d=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=o,a.state.focusedOption=l[d],a.state.focusedOptionId=I0(o,l[d])}return a}return W9(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&u_(this.menuListRef,this.focusedOptionRef),pH()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var o=this.props,l=o.isDisabled,d=o.menuIsOpen,f=this.state.isFocused;(f&&!l&&a.isDisabled||f&&d&&!a.menuIsOpen)&&this.focusInput(),f&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!f&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(u_(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,o){this.props.onInputChange(a,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var o=this,l=this.state,d=l.selectValue,f=l.isFocused,u=this.buildFocusableOptions(),h=a==="first"?0:u.length-1;if(!this.props.isMulti){var g=u.indexOf(d[0]);g>-1&&(h=g)}this.scrollToFocusedOptionOnUpdate=!(f&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[h],focusedOptionId:this.getFocusedOptionId(u[h])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(a){var o=this.state,l=o.selectValue,d=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var f=l.indexOf(d);d||(f=-1);var u=l.length-1,h=-1;if(l.length){switch(a){case"previous":f===0?h=0:f===-1?h=u:h=f-1;break;case"next":f>-1&&f<u&&(h=f+1);break}this.setState({inputIsHidden:h!==-1,focusedValue:l[h]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,d=this.getFocusableOptions();if(d.length){var f=0,u=d.indexOf(l);l||(u=-1),a==="up"?f=u>0?u-1:d.length-1:a==="down"?f=(u+1)%d.length:a==="pageup"?(f=u-o,f<0&&(f=0)):a==="pagedown"?(f=u+o,f>d.length-1&&(f=d.length-1)):a==="last"&&(f=d.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:d[f],focusedValue:null,focusedOptionId:this.getFocusedOptionId(d[f])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(D0):$t($t({},D0),this.props.theme):D0}},{key:"getCommonProps",value:function(){var a=this.clearValue,o=this.cx,l=this.getStyles,d=this.getClassNames,f=this.getValue,u=this.selectOption,h=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:o,getStyles:l,getClassNames:d,getValue:f,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:u,selectProps:g,setValue:h,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,o=a.isClearable,l=a.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(a,o){return zT(this.props,a,o)}},{key:"isOptionSelected",value:function(a,o){return BT(this.props,a,o)}},{key:"filterOption",value:function(a,o){return UT(this.props,a,o)}},{key:"formatOptionLabel",value:function(a,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,d=this.state.selectValue;return this.props.formatOptionLabel(a,{context:o,inputValue:l,selectValue:d})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,o=a.isDisabled,l=a.isSearchable,d=a.inputId,f=a.inputValue,u=a.tabIndex,h=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,T=k.inputIsHidden,P=k.ariaSelection,R=this.commonProps,I=d||this.getElementId("input"),B=$t($t($t({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(P==null?void 0:P.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,Ut({},R,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:I,innerRef:this.getInputRef,isDisabled:o,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:h,type:"text",value:f},B)):w.createElement(tH,Ut({id:I,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:pb,onFocus:this.onInputFocus,disabled:o,tabIndex:u,inputMode:"none",form:h,value:""},B))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,o=this.getComponents(),l=o.MultiValue,d=o.MultiValueContainer,f=o.MultiValueLabel,u=o.MultiValueRemove,h=o.SingleValue,g=o.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,P=v.inputValue,R=v.placeholder,I=this.state,B=I.selectValue,F=I.focusedValue,L=I.isFocused;if(!this.hasValue()||!S)return P?null:w.createElement(g,Ut({},b,{key:"placeholder",isDisabled:k,isFocused:L,innerProps:{id:this.getElementId("placeholder")}}),R);if(T)return B.map(function(H,K){var M=H===F,$="".concat(a.getOptionLabel(H),"-").concat(a.getOptionValue(H));return w.createElement(l,Ut({},b,{components:{Container:d,Label:f,Remove:u},isFocused:M,isDisabled:k,key:$,index:K,removeProps:{onClick:function(){return a.removeValue(H)},onTouchEnd:function(){return a.removeValue(H)},onMouseDown:function(W){W.preventDefault()}},data:H}),a.formatOptionLabel(H,"value"))});if(P)return null;var U=B[0];return w.createElement(h,Ut({},b,{data:U,isDisabled:k}),this.formatOptionLabel(U,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),o=a.ClearIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,h=this.state.isFocused;if(!this.isClearable()||!o||f||!this.hasValue()||u)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:g,isFocused:h}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),o=a.LoadingIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,h=this.state.isFocused;if(!o||!u)return null;var g={"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:g,isDisabled:f,isFocused:h}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator,l=a.IndicatorSeparator;if(!o||!l)return null;var d=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused;return w.createElement(l,Ut({},d,{isDisabled:f,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator;if(!o)return null;var l=this.commonProps,d=this.props.isDisabled,f=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:u,isDisabled:d,isFocused:f}))}},{key:"renderMenu",value:function(){var a=this,o=this.getComponents(),l=o.Group,d=o.GroupHeading,f=o.Menu,u=o.MenuList,h=o.MenuPortal,g=o.LoadingMessage,b=o.NoOptionsMessage,v=o.Option,S=this.commonProps,k=this.state.focusedOption,T=this.props,P=T.captureMenuScroll,R=T.inputValue,I=T.isLoading,B=T.loadingMessage,F=T.minMenuHeight,L=T.maxMenuHeight,U=T.menuIsOpen,H=T.menuPlacement,K=T.menuPosition,M=T.menuPortalTarget,$=T.menuShouldBlockScroll,z=T.menuShouldScrollIntoView,W=T.noOptionsMessage,te=T.onMenuScrollToTop,V=T.onMenuScrollToBottom;if(!U)return null;var G=function(D,pe){var Ce=D.type,Z=D.data,ee=D.isDisabled,X=D.isSelected,ye=D.label,He=D.value,he=k===Z,Le=ee?void 0:function(){return a.onOptionHover(Z)},ue=ee?void 0:function(){return a.selectOption(Z)},De="".concat(a.getElementId("option"),"-").concat(pe),Ye={id:De,onClick:ue,onMouseMove:Le,onMouseOver:Le,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:X};return w.createElement(v,Ut({},S,{innerProps:Ye,data:Z,isDisabled:ee,isSelected:X,key:De,label:ye,type:Ce,value:He,isFocused:he,innerRef:he?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(D.data,"menu"))},J;if(this.hasOptions())J=this.getCategorizedOptions().map(function(ge){if(ge.type==="group"){var D=ge.data,pe=ge.options,Ce=ge.index,Z="".concat(a.getElementId("group"),"-").concat(Ce),ee="".concat(Z,"-heading");return w.createElement(l,Ut({},S,{key:Z,data:D,options:pe,Heading:d,headingProps:{id:ee,data:ge.data},label:a.formatGroupLabel(ge.data)}),ge.options.map(function(X){return G(X,"".concat(Ce,"-").concat(X.index))}))}else if(ge.type==="option")return G(ge,"".concat(ge.index))});else if(I){var oe=B({inputValue:R});if(oe===null)return null;J=w.createElement(g,S,oe)}else{var ie=W({inputValue:R});if(ie===null)return null;J=w.createElement(b,S,ie)}var E={minMenuHeight:F,maxMenuHeight:L,menuPlacement:H,menuPosition:K,menuShouldScrollIntoView:z},ce=w.createElement(Iq,Ut({},S,E),function(ge){var D=ge.ref,pe=ge.placerProps,Ce=pe.placement,Z=pe.maxHeight;return w.createElement(f,Ut({},S,E,{innerRef:D,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:I,placement:Ce}),w.createElement(oH,{captureEnabled:P,onTopArrive:te,onBottomArrive:V,lockEnabled:$},function(ee){return w.createElement(u,Ut({},S,{innerRef:function(ye){a.getMenuListRef(ye),ee(ye)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:I,maxHeight:Z,focusedOption:k}),J)}))});return M||K==="fixed"?w.createElement(h,Ut({},S,{appendTo:M,controlElement:this.controlRef,menuPlacement:H,menuPosition:K}),ce):ce}},{key:"renderFormField",value:function(){var a=this,o=this.props,l=o.delimiter,d=o.isDisabled,f=o.isMulti,u=o.name,h=o.required,g=this.state.selectValue;if(h&&!this.hasValue()&&!d)return w.createElement(uH,{name:u,onFocus:this.onValueInputFocus});if(!(!u||d))if(f)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:u,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:u,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:u,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:u,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,o=this.state,l=o.ariaSelection,d=o.focusedOption,f=o.focusedValue,u=o.isFocused,h=o.selectValue,g=this.getFocusableOptions();return w.createElement(QV,Ut({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:d,focusedValue:f,isFocused:u,selectValue:h,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),o=a.Control,l=a.IndicatorsContainer,d=a.SelectContainer,f=a.ValueContainer,u=this.props,h=u.className,g=u.id,b=u.isDisabled,v=u.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(d,Ut({},k,{className:h,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(o,Ut({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(f,Ut({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,Ut({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,o){var l=o.prevProps,d=o.clearFocusValueOnUpdate,f=o.inputIsHiddenAfterUpdate,u=o.ariaSelection,h=o.isFocused,g=o.prevWasFocused,b=o.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,T=a.inputValue,P=a.isMulti,R=c_(S),I={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||T!==l.inputValue)){var B=k?jH(a,R):[],F=k?C_(Qx(a,R),"".concat(b,"-option")):[],L=d?kH(o,R):null,U=TH(o,B),H=I0(F,U);I={selectValue:R,focusedOption:U,focusedOptionId:H,focusableOptionsWithIds:F,focusedValue:L,clearFocusValueOnUpdate:!1}}var K=f!=null&&a!==l?{inputIsHidden:f,inputIsHiddenAfterUpdate:void 0}:{},M=u,$=h&&g;return h&&!$&&(M={value:Tx(P,R,R[0]||null),options:R,action:"initial-input-focus"},$=!g),(u==null?void 0:u.action)==="initial-input-focus"&&(M=null),$t($t($t({},I),K),{},{prevProps:a,ariaSelection:M,prevWasFocused:$})}}]),t}(w.Component);VT.defaultProps=_H;var AH=w.forwardRef(function(e,n){var t=G9(e);return w.createElement(VT,Ut({ref:n},t))}),HT=AH;const Th=new Map,GT=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&Th.has(n.id)){const a=Th.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Th.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&Th.has(n.id)){const a=Th.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Th.set(n.id,r),r}}})();function PH(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const DH=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,YT=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,Ex=new Map,G1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var R0={exports:{}},j_;function IH(){return j_||(j_=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(f,u,h){this.fn=f,this.context=u,this.once=h||!1}function o(f,u,h,g,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,g||f,b),S=t?t+u:u;return f._events[S]?f._events[S].fn?f._events[S]=[f._events[S],v]:f._events[S].push(v):(f._events[S]=v,f._eventsCount++),f}function l(f,u){--f._eventsCount===0?f._events=new r:delete f._events[u]}function d(){this._events=new r,this._eventsCount=0}d.prototype.eventNames=function(){var u=[],h,g;if(this._eventsCount===0)return u;for(g in h=this._events)n.call(h,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},d.prototype.listeners=function(u){var h=t?t+u:u,g=this._events[h];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},d.prototype.listenerCount=function(u){var h=t?t+u:u,g=this._events[h];return g?g.fn?1:g.length:0},d.prototype.emit=function(u,h,g,b,v,S){var k=t?t+u:u;if(!this._events[k])return!1;var T=this._events[k],P=arguments.length,R,I;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),P){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,h),!0;case 3:return T.fn.call(T.context,h,g),!0;case 4:return T.fn.call(T.context,h,g,b),!0;case 5:return T.fn.call(T.context,h,g,b,v),!0;case 6:return T.fn.call(T.context,h,g,b,v,S),!0}for(I=1,R=new Array(P-1);I<P;I++)R[I-1]=arguments[I];T.fn.apply(T.context,R)}else{var B=T.length,F;for(I=0;I<B;I++)switch(T[I].once&&this.removeListener(u,T[I].fn,void 0,!0),P){case 1:T[I].fn.call(T[I].context);break;case 2:T[I].fn.call(T[I].context,h);break;case 3:T[I].fn.call(T[I].context,h,g);break;case 4:T[I].fn.call(T[I].context,h,g,b);break;default:if(!R)for(F=1,R=new Array(P-1);F<P;F++)R[F-1]=arguments[F];T[I].fn.apply(T[I].context,R)}}return!0},d.prototype.on=function(u,h,g){return o(this,u,h,g,!1)},d.prototype.once=function(u,h,g){return o(this,u,h,g,!0)},d.prototype.removeListener=function(u,h,g,b){var v=t?t+u:u;if(!this._events[v])return this;if(!h)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===h&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,T=[],P=S.length;k<P;k++)(S[k].fn!==h||b&&!S[k].once||g&&S[k].context!==g)&&T.push(S[k]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},d.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&l(this,h)):(this._events=new r,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=t,d.EventEmitter=d,e.exports=d}(R0)),R0.exports}var RH=IH();const WT=tf(RH);function MH(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class QT extends WT{constructor(t=16e3){super();nr(this,"stream");nr(this,"audioContext");nr(this,"source");nr(this,"recording",!1);nr(this,"recordingWorklet");nr(this,"vuWorklet");nr(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await GT({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=G1(r,DH);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async l=>{const d=l.data.data.int16arrayBuffer;if(d){const f=MH(d);this.emit("data",f)}},this.source.connect(this.recordingWorklet);const o="vu-meter";await this.audioContext.audioWorklet.addModule(G1(o,YT)),this.vuWorklet=new AudioWorkletNode(this.audioContext,o),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(o=>o.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const OH=3,LH=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const o=()=>{r.current.forEach((l,d)=>{l&&(l.style.height=`${Math.min(24,4+n*(d===1?400:60))}px`)}),a=window.setTimeout(o,100)};return o(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:xu("audioPulse",{active:e,hover:t}),children:Array(OH).fill(null).map((a,o)=>i.jsx("div",{ref:l=>{r.current[o]=l},style:{animationDelay:`${o*133}ms`}},o))})};var Hm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var FH=Hm.exports,k_;function $H(){return k_||(k_=1,function(e,n){(function(){var t,r="4.17.21",a=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",u=500,h="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,T=1,P=2,R=4,I=8,B=16,F=32,L=64,U=128,H=256,K=512,M=30,$="...",z=800,W=16,te=1,V=2,G=3,J=1/0,oe=9007199254740991,ie=17976931348623157e292,E=NaN,ce=4294967295,ge=ce-1,D=ce>>>1,pe=[["ary",U],["bind",T],["bindKey",P],["curry",I],["curryRight",B],["flip",K],["partial",F],["partialRight",L],["rearg",H]],Ce="[object Arguments]",Z="[object Array]",ee="[object AsyncFunction]",X="[object Boolean]",ye="[object Date]",He="[object DOMException]",he="[object Error]",Le="[object Function]",ue="[object GeneratorFunction]",De="[object Map]",Ye="[object Number]",et="[object Null]",Ke="[object Object]",it="[object Promise]",ot="[object Proxy]",vt="[object RegExp]",Ee="[object Set]",Je="[object String]",Ae="[object Symbol]",_e="[object Undefined]",le="[object WeakMap]",q="[object WeakSet]",de="[object ArrayBuffer]",be="[object DataView]",$e="[object Float32Array]",nt="[object Float64Array]",ht="[object Int8Array]",wt="[object Int16Array]",Et="[object Int32Array]",ve="[object Uint8Array]",ke="[object Uint8ClampedArray]",Ne="[object Uint16Array]",Oe="[object Uint32Array]",Ve=/\b__p \+= '';/g,Ze=/\b(__p \+=) '' \+/g,jt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Nt=/&(?:amp|lt|gt|quot|#39);/g,mt=/[&<>"']/g,an=RegExp(Nt.source),Ln=RegExp(mt.source),Vt=/<%-([\s\S]+?)%>/g,Ct=/<%([\s\S]+?)%>/g,xt=/<%=([\s\S]+?)%>/g,hn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Jn=/^\w*$/,un=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Hn=/[\\^$.*+?()[\]{}|]/g,hr=RegExp(Hn.source),sr=/^\s+/,Ea=/\s/,hc=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,af=/\{\n\/\* \[wrapped with (.+)\] \*/,sf=/,? & /,As=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Tu=/[()=,{}\[\]\/\s]/,Aa=/\\(\\)?/g,Ps=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ds=/\w*$/,Is=/^[-+]0x[0-9a-f]+$/i,kr=/^0b[01]+$/i,of=/^\[object .+?Constructor\]$/,lf=/^0o[0-7]+$/i,Rs=/^(?:0|[1-9]\d*)$/,bo=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,pc=/($^)/,cf=/['\n\r\u2028\u2029\\]/g,vl="\\ud800-\\udfff",lp="\\u0300-\\u036f",mc="\\ufe20-\\ufe2f",vo="\\u20d0-\\u20ff",Cr=lp+mc+vo,ts="\\u2700-\\u27bf",gc="a-z\\xdf-\\xf6\\xf8-\\xff",Ms="\\xac\\xb1\\xd7\\xf7",yc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",wl="\\u2000-\\u206f",Eu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",xc="A-Z\\xc0-\\xd6\\xd8-\\xde",ni="\\ufe0e\\ufe0f",wo=Ms+yc+wl+Eu,Au="[']",bc="["+vl+"]",vc="["+wo+"]",ns="["+Cr+"]",Pu="\\d+",ui="["+ts+"]",Sl="["+gc+"]",wc="[^"+vl+wo+Pu+ts+gc+xc+"]",rs="\\ud83c[\\udffb-\\udfff]",Os="(?:"+ns+"|"+rs+")",Nl="[^"+vl+"]",Cl="(?:\\ud83c[\\udde6-\\uddff]){2}",wi="[\\ud800-\\udbff][\\udc00-\\udfff]",is="["+xc+"]",So="\\u200d",di="(?:"+Sl+"|"+wc+")",Sc="(?:"+is+"|"+wc+")",Nc="(?:"+Au+"(?:d|ll|m|re|s|t|ve))?",Du="(?:"+Au+"(?:D|LL|M|RE|S|T|VE))?",Ls=Os+"?",_l="["+ni+"]?",jl="(?:"+So+"(?:"+[Nl,Cl,wi].join("|")+")"+_l+Ls+")*",Fs="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",as="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Cc=_l+Ls+jl,No="(?:"+[ui,Cl,wi].join("|")+")"+Cc,Co="(?:"+[Nl+ns+"?",ns,Cl,wi,bc].join("|")+")",ss=RegExp(Au,"g"),ia=RegExp(ns,"g"),os=RegExp(rs+"(?="+rs+")|"+Co+Cc,"g"),kl=RegExp([is+"?"+Sl+"+"+Nc+"(?="+[vc,is,"$"].join("|")+")",Sc+"+"+Du+"(?="+[vc,is+di,"$"].join("|")+")",is+"?"+di+"+"+Nc,is+"+"+Du,as,Fs,Pu,No].join("|"),"g"),aa=RegExp("["+So+vl+Cr+ni+"]"),Tl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_o=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],_c=-1,An={};An[$e]=An[nt]=An[ht]=An[wt]=An[Et]=An[ve]=An[ke]=An[Ne]=An[Oe]=!0,An[Ce]=An[Z]=An[de]=An[X]=An[be]=An[ye]=An[he]=An[Le]=An[De]=An[Ye]=An[Ke]=An[vt]=An[Ee]=An[Je]=An[le]=!1;var jn={};jn[Ce]=jn[Z]=jn[de]=jn[be]=jn[X]=jn[ye]=jn[$e]=jn[nt]=jn[ht]=jn[wt]=jn[Et]=jn[De]=jn[Ye]=jn[Ke]=jn[vt]=jn[Ee]=jn[Je]=jn[Ae]=jn[ve]=jn[ke]=jn[Ne]=jn[Oe]=!0,jn[he]=jn[Le]=jn[le]=!1;var jc={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},qr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Pa={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Si={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},$s=parseFloat,uf=parseInt,sa=typeof yu=="object"&&yu&&yu.Object===Object&&yu,Iu=typeof self=="object"&&self&&self.Object===Object&&self,rr=sa||Iu||Function("return this")(),jo=n&&!n.nodeType&&n,oa=jo&&!0&&e&&!e.nodeType&&e,df=oa&&oa.exports===jo,zs=df&&sa.process,_r=function(){try{var Pe=oa&&oa.require&&oa.require("util").types;return Pe||zs&&zs.binding&&zs.binding("util")}catch{}}(),Da=_r&&_r.isArrayBuffer,El=_r&&_r.isDate,Al=_r&&_r.isMap,ko=_r&&_r.isRegExp,ff=_r&&_r.isSet,Pl=_r&&_r.isTypedArray;function Xr(Pe,Qe,Ge){switch(Ge.length){case 0:return Pe.call(Qe);case 1:return Pe.call(Qe,Ge[0]);case 2:return Pe.call(Qe,Ge[0],Ge[1]);case 3:return Pe.call(Qe,Ge[0],Ge[1],Ge[2])}return Pe.apply(Qe,Ge)}function Ru(Pe,Qe,Ge,pt){for(var Rt=-1,pn=Pe==null?0:Pe.length;++Rt<pn;){var yr=Pe[Rt];Qe(pt,yr,Ge(yr),Pe)}return pt}function fi(Pe,Qe){for(var Ge=-1,pt=Pe==null?0:Pe.length;++Ge<pt&&Qe(Pe[Ge],Ge,Pe)!==!1;);return Pe}function hf(Pe,Qe){for(var Ge=Pe==null?0:Pe.length;Ge--&&Qe(Pe[Ge],Ge,Pe)!==!1;);return Pe}function Mu(Pe,Qe){for(var Ge=-1,pt=Pe==null?0:Pe.length;++Ge<pt;)if(!Qe(Pe[Ge],Ge,Pe))return!1;return!0}function Ni(Pe,Qe){for(var Ge=-1,pt=Pe==null?0:Pe.length,Rt=0,pn=[];++Ge<pt;){var yr=Pe[Ge];Qe(yr,Ge,Pe)&&(pn[Rt++]=yr)}return pn}function Dl(Pe,Qe){var Ge=Pe==null?0:Pe.length;return!!Ge&&la(Pe,Qe,0)>-1}function To(Pe,Qe,Ge){for(var pt=-1,Rt=Pe==null?0:Pe.length;++pt<Rt;)if(Ge(Qe,Pe[pt]))return!0;return!1}function Fn(Pe,Qe){for(var Ge=-1,pt=Pe==null?0:Pe.length,Rt=Array(pt);++Ge<pt;)Rt[Ge]=Qe(Pe[Ge],Ge,Pe);return Rt}function Ia(Pe,Qe){for(var Ge=-1,pt=Qe.length,Rt=Pe.length;++Ge<pt;)Pe[Rt+Ge]=Qe[Ge];return Pe}function Il(Pe,Qe,Ge,pt){var Rt=-1,pn=Pe==null?0:Pe.length;for(pt&&pn&&(Ge=Pe[++Rt]);++Rt<pn;)Ge=Qe(Ge,Pe[Rt],Rt,Pe);return Ge}function Ou(Pe,Qe,Ge,pt){var Rt=Pe==null?0:Pe.length;for(pt&&Rt&&(Ge=Pe[--Rt]);Rt--;)Ge=Qe(Ge,Pe[Rt],Rt,Pe);return Ge}function kc(Pe,Qe){for(var Ge=-1,pt=Pe==null?0:Pe.length;++Ge<pt;)if(Qe(Pe[Ge],Ge,Pe))return!0;return!1}var Mn=Rl("length");function Lu(Pe){return Pe.split("")}function Tc(Pe){return Pe.match(As)||[]}function Ec(Pe,Qe,Ge){var pt;return Ge(Pe,function(Rt,pn,yr){if(Qe(Rt,pn,yr))return pt=pn,!1}),pt}function ls(Pe,Qe,Ge,pt){for(var Rt=Pe.length,pn=Ge+(pt?1:-1);pt?pn--:++pn<Rt;)if(Qe(Pe[pn],pn,Pe))return pn;return-1}function la(Pe,Qe,Ge){return Qe===Qe?up(Pe,Qe,Ge):ls(Pe,Bs,Ge)}function Fu(Pe,Qe,Ge,pt){for(var Rt=Ge-1,pn=Pe.length;++Rt<pn;)if(pt(Pe[Rt],Qe))return Rt;return-1}function Bs(Pe){return Pe!==Pe}function Us(Pe,Qe){var Ge=Pe==null?0:Pe.length;return Ge?Ml(Pe,Qe)/Ge:E}function Rl(Pe){return function(Qe){return Qe==null?t:Qe[Pe]}}function Eo(Pe){return function(Qe){return Pe==null?t:Pe[Qe]}}function Ao(Pe,Qe,Ge,pt,Rt){return Rt(Pe,function(pn,yr,mn){Ge=pt?(pt=!1,pn):Qe(Ge,pn,yr,mn)}),Ge}function qs(Pe,Qe){var Ge=Pe.length;for(Pe.sort(Qe);Ge--;)Pe[Ge]=Pe[Ge].value;return Pe}function Ml(Pe,Qe){for(var Ge,pt=-1,Rt=Pe.length;++pt<Rt;){var pn=Qe(Pe[pt]);pn!==t&&(Ge=Ge===t?pn:Ge+pn)}return Ge}function cs(Pe,Qe){for(var Ge=-1,pt=Array(Pe);++Ge<Pe;)pt[Ge]=Qe(Ge);return pt}function pf(Pe,Qe){return Fn(Qe,function(Ge){return[Ge,Pe[Ge]]})}function Po(Pe){return Pe&&Pe.slice(0,zu(Pe)+1).replace(sr,"")}function hi(Pe){return function(Qe){return Pe(Qe)}}function Ra(Pe,Qe){return Fn(Qe,function(Ge){return Pe[Ge]})}function Do(Pe,Qe){return Pe.has(Qe)}function Vs(Pe,Qe){for(var Ge=-1,pt=Pe.length;++Ge<pt&&la(Qe,Pe[Ge],0)>-1;);return Ge}function qi(Pe,Qe){for(var Ge=Pe.length;Ge--&&la(Qe,Pe[Ge],0)>-1;);return Ge}function Io(Pe,Qe){for(var Ge=Pe.length,pt=0;Ge--;)Pe[Ge]===Qe&&++pt;return pt}var us=Eo(jc),Ro=Eo(qr);function Ac(Pe){return"\\"+Si[Pe]}function Pc(Pe,Qe){return Pe==null?t:Pe[Qe]}function Vi(Pe){return aa.test(Pe)}function $u(Pe){return Tl.test(Pe)}function mf(Pe){for(var Qe,Ge=[];!(Qe=Pe.next()).done;)Ge.push(Qe.value);return Ge}function Dc(Pe){var Qe=-1,Ge=Array(Pe.size);return Pe.forEach(function(pt,Rt){Ge[++Qe]=[Rt,pt]}),Ge}function gf(Pe,Qe){return function(Ge){return Pe(Qe(Ge))}}function Ma(Pe,Qe){for(var Ge=-1,pt=Pe.length,Rt=0,pn=[];++Ge<pt;){var yr=Pe[Ge];(yr===Qe||yr===h)&&(Pe[Ge]=h,pn[Rt++]=Ge)}return pn}function Ic(Pe){var Qe=-1,Ge=Array(Pe.size);return Pe.forEach(function(pt){Ge[++Qe]=pt}),Ge}function cp(Pe){var Qe=-1,Ge=Array(Pe.size);return Pe.forEach(function(pt){Ge[++Qe]=[pt,pt]}),Ge}function up(Pe,Qe,Ge){for(var pt=Ge-1,Rt=Pe.length;++pt<Rt;)if(Pe[pt]===Qe)return pt;return-1}function pi(Pe,Qe,Ge){for(var pt=Ge+1;pt--;)if(Pe[pt]===Qe)return pt;return pt}function Ci(Pe){return Vi(Pe)?yf(Pe):Mn(Pe)}function ri(Pe){return Vi(Pe)?ca(Pe):Lu(Pe)}function zu(Pe){for(var Qe=Pe.length;Qe--&&Ea.test(Pe.charAt(Qe)););return Qe}var Mo=Eo(Pa);function yf(Pe){for(var Qe=os.lastIndex=0;os.test(Pe);)++Qe;return Qe}function ca(Pe){return Pe.match(os)||[]}function ds(Pe){return Pe.match(kl)||[]}var ii=function Pe(Qe){Qe=Qe==null?rr:Oa.defaults(rr.Object(),Qe,Oa.pick(rr,_o));var Ge=Qe.Array,pt=Qe.Date,Rt=Qe.Error,pn=Qe.Function,yr=Qe.Math,mn=Qe.Object,Ol=Qe.RegExp,xf=Qe.String,mi=Qe.TypeError,Rc=Ge.prototype,bf=pn.prototype,Oo=mn.prototype,ua=Qe["__core-js_shared__"],Ll=bf.toString,xn=Oo.hasOwnProperty,Hi=0,Fl=function(){var m=/[^.]+$/.exec(ua&&ua.keys&&ua.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Zr=Oo.toString,pr=Ll.call(mn),Lo=rr._,Bu=Ol("^"+Ll.call(xn).replace(Hn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fs=df?Qe.Buffer:t,Gi=Qe.Symbol,Fo=Qe.Uint8Array,Hs=fs?fs.allocUnsafe:t,$l=gf(mn.getPrototypeOf,mn),zl=mn.create,Gs=Oo.propertyIsEnumerable,Mc=Rc.splice,ai=Gi?Gi.isConcatSpreadable:t,Ys=Gi?Gi.iterator:t,Vr=Gi?Gi.toStringTag:t,$o=function(){try{var m=Yo(mn,"defineProperty");return m({},"",{}),m}catch{}}(),Bl=Qe.clearTimeout!==rr.clearTimeout&&Qe.clearTimeout,ne=pt&&pt.now!==rr.Date.now&&pt.now,xe=Qe.setTimeout!==rr.setTimeout&&Qe.setTimeout,fe=yr.ceil,Ie=yr.floor,Ue=mn.getOwnPropertySymbols,ct=fs?fs.isBuffer:t,_t=Qe.isFinite,Qt=Rc.join,Yt=gf(mn.keys,mn),In=yr.max,kn=yr.min,Ws=pt.now,Ul=Qe.parseInt,dp=yr.random,fp=Rc.reverse,Uu=Yo(Qe,"DataView"),Ir=Yo(Qe,"Map"),or=Yo(Qe,"Promise"),gn=Yo(Qe,"Set"),La=Yo(Qe,"WeakMap"),_i=Yo(mn,"create"),Oc=La&&new La,da={},Cg=ro(Uu),_g=ro(Ir),qu=ro(or),Vu=ro(gn),jg=ro(La),zo=Gi?Gi.prototype:t,ql=zo?zo.valueOf:t,Bo=zo?zo.toString:t;function re(m){if(mr(m)&&!qt(m)&&!(m instanceof sn)){if(m instanceof ji)return m;if(xn.call(m,"__wrapped__"))return Mr(m)}return new ji(m)}var Yi=function(){function m(){}return function(y){if(!cr(y))return{};if(zl)return zl(y);m.prototype=y;var j=new m;return m.prototype=t,j}}();function fa(){}function ji(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}re.templateSettings={escape:Vt,evaluate:Ct,interpolate:xt,variable:"",imports:{_:re}},re.prototype=fa.prototype,re.prototype.constructor=re,ji.prototype=Yi(fa.prototype),ji.prototype.constructor=ji;function sn(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ce,this.__views__=[]}function Hu(){var m=new sn(this.__wrapped__);return m.__actions__=Rr(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=Rr(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=Rr(this.__views__),m}function vf(){if(this.__filtered__){var m=new sn(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function Vl(){var m=this.__wrapped__.value(),y=this.__dir__,j=qt(m),O=y<0,Q=j?m.length:0,se=ay(0,Q,this.__views__),we=se.start,je=se.end,Me=je-we,rt=O?je:we-1,st=this.__iteratees__,lt=st.length,yt=0,kt=kn(Me,this.__takeCount__);if(!j||!O&&Q==Me&&kt==Me)return Hg(m,this.__actions__);var zt=[];e:for(;Me--&&yt<kt;){rt+=y;for(var ln=-1,Bt=m[rt];++ln<lt;){var vn=st[ln],En=vn.iteratee,Va=vn.type,ea=En(Bt);if(Va==V)Bt=ea;else if(!ea){if(Va==te)continue e;break e}}zt[yt++]=Bt}return zt}sn.prototype=Yi(fa.prototype),sn.prototype.constructor=sn;function xr(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function wf(){this.__data__=_i?_i(null):{},this.size=0}function kg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function iv(m){var y=this.__data__;if(_i){var j=y[m];return j===f?t:j}return xn.call(y,m)?y[m]:t}function av(m){var y=this.__data__;return _i?y[m]!==t:xn.call(y,m)}function sv(m,y){var j=this.__data__;return this.size+=this.has(m)?0:1,j[m]=_i&&y===t?f:y,this}xr.prototype.clear=wf,xr.prototype.delete=kg,xr.prototype.get=iv,xr.prototype.has=av,xr.prototype.set=sv;function Kn(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function hp(){this.__data__=[],this.size=0}function Gu(m){var y=this.__data__,j=$c(y,m);if(j<0)return!1;var O=y.length-1;return j==O?y.pop():Mc.call(y,j,1),--this.size,!0}function Yu(m){var y=this.__data__,j=$c(y,m);return j<0?t:y[j][1]}function pp(m){return $c(this.__data__,m)>-1}function Lc(m,y){var j=this.__data__,O=$c(j,m);return O<0?(++this.size,j.push([m,y])):j[O][1]=y,this}Kn.prototype.clear=hp,Kn.prototype.delete=Gu,Kn.prototype.get=Yu,Kn.prototype.has=pp,Kn.prototype.set=Lc;function ki(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function ov(){this.size=0,this.__data__={hash:new xr,map:new(Ir||Kn),string:new xr}}function Tg(m){var y=Hc(this,m).delete(m);return this.size-=y?1:0,y}function lv(m){return Hc(this,m).get(m)}function Eg(m){return Hc(this,m).has(m)}function Hl(m,y){var j=Hc(this,m),O=j.size;return j.set(m,y),this.size+=j.size==O?0:1,this}ki.prototype.clear=ov,ki.prototype.delete=Tg,ki.prototype.get=lv,ki.prototype.has=Eg,ki.prototype.set=Hl;function Qs(m){var y=-1,j=m==null?0:m.length;for(this.__data__=new ki;++y<j;)this.add(m[y])}function Sf(m){return this.__data__.set(m,f),this}function Ag(m){return this.__data__.has(m)}Qs.prototype.add=Qs.prototype.push=Sf,Qs.prototype.has=Ag;function gi(m){var y=this.__data__=new Kn(m);this.size=y.size}function Pg(){this.__data__=new Kn,this.size=0}function Nf(m){var y=this.__data__,j=y.delete(m);return this.size=y.size,j}function mp(m){return this.__data__.get(m)}function Dg(m){return this.__data__.has(m)}function Cf(m,y){var j=this.__data__;if(j instanceof Kn){var O=j.__data__;if(!Ir||O.length<a-1)return O.push([m,y]),this.size=++j.size,this;j=this.__data__=new ki(O)}return j.set(m,y),this.size=j.size,this}gi.prototype.clear=Pg,gi.prototype.delete=Nf,gi.prototype.get=mp,gi.prototype.has=Dg,gi.prototype.set=Cf;function gp(m,y){var j=qt(m),O=!j&&oo(m),Q=!j&&!O&&rl(m),se=!j&&!O&&!Q&&au(m),we=j||O||Q||se,je=we?cs(m.length,xf):[],Me=je.length;for(var rt in m)(y||xn.call(m,rt))&&!(we&&(rt=="length"||Q&&(rt=="offset"||rt=="parent")||se&&(rt=="buffer"||rt=="byteLength"||rt=="byteOffset")||Ba(rt,Me)))&&je.push(rt);return je}function Fc(m){var y=m.length;return y?m[Rf(0,y-1)]:t}function Ig(m,y){return vd(Rr(m),$a(y,0,m.length))}function Rg(m){return vd(Rr(m))}function hs(m,y,j){(j!==t&&!Ri(m[y],j)||j===t&&!(y in m))&&Fa(m,y,j)}function Gl(m,y,j){var O=m[y];(!(xn.call(m,y)&&Ri(O,j))||j===t&&!(y in m))&&Fa(m,y,j)}function $c(m,y){for(var j=m.length;j--;)if(Ri(m[j][0],y))return j;return-1}function Uo(m,y,j,O){return Ks(m,function(Q,se,we){y(O,Q,j(Q),we)}),O}function Js(m,y){return m&&Ai(y,Fr(y),m)}function Wu(m,y){return m&&Ai(y,Yr(y),m)}function Fa(m,y,j){y=="__proto__"&&$o?$o(m,y,{configurable:!0,enumerable:!0,value:j,writable:!0}):m[y]=j}function Qu(m,y){for(var j=-1,O=y.length,Q=Ge(O),se=m==null;++j<O;)Q[j]=se?t:Rd(m,y[j]);return Q}function $a(m,y,j){return m===m&&(j!==t&&(m=m<=j?m:j),y!==t&&(m=m>=y?m:y)),m}function si(m,y,j,O,Q,se){var we,je=y&g,Me=y&b,rt=y&v;if(j&&(we=Q?j(m,O,Q,se):j(m)),we!==t)return we;if(!cr(m))return m;var st=qt(m);if(st){if(we=Up(m),!je)return Rr(m,we)}else{var lt=Gr(m),yt=lt==Le||lt==ue;if(rl(m))return Rp(m,je);if(lt==Ke||lt==Ce||yt&&!Q){if(we=Me||yt?{}:qp(m),!je)return Me?ld(m,Wu(we,m)):zf(m,Js(we,m))}else{if(!jn[lt])return Q?m:{};we=Vp(m,lt,je)}}se||(se=new gi);var kt=se.get(m);if(kt)return kt;se.set(m,we),Ky(m)?m.forEach(function(Bt){we.add(si(Bt,y,j,Bt,m,se))}):dh(m)&&m.forEach(function(Bt,vn){we.set(vn,si(Bt,y,j,vn,m,se))});var zt=rt?Me?Vf:qf:Me?Yr:Fr,ln=st?t:zt(m);return fi(ln||m,function(Bt,vn){ln&&(vn=Bt,Bt=m[vn]),Gl(we,vn,si(Bt,y,j,vn,m,se))}),we}function Mg(m){var y=Fr(m);return function(j){return yp(j,m,y)}}function yp(m,y,j){var O=j.length;if(m==null)return!O;for(m=mn(m);O--;){var Q=j[O],se=y[Q],we=m[Q];if(we===t&&!(Q in m)||!se(we))return!1}return!0}function Yl(m,y,j){if(typeof m!="function")throw new mi(l);return Yc(function(){m.apply(t,j)},y)}function qo(m,y,j,O){var Q=-1,se=Dl,we=!0,je=m.length,Me=[],rt=y.length;if(!je)return Me;j&&(y=Fn(y,hi(j))),O?(se=To,we=!1):y.length>=a&&(se=Do,we=!1,y=new Qs(y));e:for(;++Q<je;){var st=m[Q],lt=j==null?st:j(st);if(st=O||st!==0?st:0,we&&lt===lt){for(var yt=rt;yt--;)if(y[yt]===lt)continue e;Me.push(st)}else se(y,lt,O)||Me.push(st)}return Me}var Ks=Fp(oi),_f=Fp(Bc,!0);function xp(m,y){var j=!0;return Ks(m,function(O,Q,se){return j=!!y(O,Q,se),j}),j}function za(m,y,j){for(var O=-1,Q=m.length;++O<Q;){var se=m[O],we=y(se);if(we!=null&&(je===t?we===we&&!bi(we):j(we,je)))var je=we,Me=se}return Me}function en(m,y,j,O){var Q=m.length;for(j=Wt(j),j<0&&(j=-j>Q?0:Q+j),O=O===t||O>Q?Q:Wt(O),O<0&&(O+=Q),O=j>O?0:Ss(O);j<O;)m[j++]=y;return m}function $n(m,y){var j=[];return Ks(m,function(O,Q,se){y(O,Q,se)&&j.push(O)}),j}function yn(m,y,j,O,Q){var se=-1,we=m.length;for(j||(j=to),Q||(Q=[]);++se<we;){var je=m[se];y>0&&j(je)?y>1?yn(je,y-1,j,O,Q):Ia(Q,je):O||(Q[Q.length]=je)}return Q}var zc=ec(),Wl=ec(!0);function oi(m,y){return m&&zc(m,y,Fr)}function Bc(m,y){return m&&Wl(m,y,Fr)}function Vo(m,y){return Ni(y,function(j){return Ua(m[j])})}function ha(m,y){y=Zs(y,m);for(var j=0,O=y.length;m!=null&&j<O;)m=m[On(y[j++])];return j&&j==O?m:t}function Og(m,y,j){var O=y(m);return qt(m)?O:Ia(O,j(m))}function bn(m){return m==null?m===t?_e:et:Vr&&Vr in mn(m)?iy(m):uy(m)}function Ju(m,y){return m>y}function bp(m,y){return m!=null&&xn.call(m,y)}function Lg(m,y){return m!=null&&y in mn(m)}function Fg(m,y,j){return m>=kn(y,j)&&m<In(y,j)}function vp(m,y,j){for(var O=j?To:Dl,Q=m[0].length,se=m.length,we=se,je=Ge(se),Me=1/0,rt=[];we--;){var st=m[we];we&&y&&(st=Fn(st,hi(y))),Me=kn(st.length,Me),je[we]=!j&&(y||Q>=120&&st.length>=120)?new Qs(we&&st):t}st=m[0];var lt=-1,yt=je[0];e:for(;++lt<Q&&rt.length<Me;){var kt=st[lt],zt=y?y(kt):kt;if(kt=j||kt!==0?kt:0,!(yt?Do(yt,zt):O(rt,zt,j))){for(we=se;--we;){var ln=je[we];if(!(ln?Do(ln,zt):O(m[we],zt,j)))continue e}yt&&yt.push(zt),rt.push(kt)}}return rt}function wp(m,y,j,O){return oi(m,function(Q,se,we){y(O,j(Q),se,we)}),O}function Ql(m,y,j){y=Zs(y,m),m=Gc(m,y);var O=m==null?m:m[On(li(y))];return O==null?t:Xr(O,m,j)}function jf(m){return mr(m)&&bn(m)==Ce}function Ti(m){return mr(m)&&bn(m)==de}function Tr(m){return mr(m)&&bn(m)==ye}function Jl(m,y,j,O,Q){return m===y?!0:m==null||y==null||!mr(m)&&!mr(y)?m!==m&&y!==y:Ku(m,y,j,O,Jl,Q)}function Ku(m,y,j,O,Q,se){var we=qt(m),je=qt(y),Me=we?Z:Gr(m),rt=je?Z:Gr(y);Me=Me==Ce?Ke:Me,rt=rt==Ce?Ke:rt;var st=Me==Ke,lt=rt==Ke,yt=Me==rt;if(yt&&rl(m)){if(!rl(y))return!1;we=!0,st=!1}if(yt&&!st)return se||(se=new gi),we||au(m)?ny(m,y,j,O,Q,se):ry(m,y,Me,j,O,Q,se);if(!(j&S)){var kt=st&&xn.call(m,"__wrapped__"),zt=lt&&xn.call(y,"__wrapped__");if(kt||zt){var ln=kt?m.value():m,Bt=zt?y.value():y;return se||(se=new gi),Q(ln,Bt,j,O,se)}}return yt?(se||(se=new gi),Hr(m,y,j,O,Q,se)):!1}function kf(m){return mr(m)&&Gr(m)==De}function Xu(m,y,j,O){var Q=j.length,se=Q,we=!O;if(m==null)return!se;for(m=mn(m);Q--;){var je=j[Q];if(we&&je[2]?je[1]!==m[je[0]]:!(je[0]in m))return!1}for(;++Q<se;){je=j[Q];var Me=je[0],rt=m[Me],st=je[1];if(we&&je[2]){if(rt===t&&!(Me in m))return!1}else{var lt=new gi;if(O)var yt=O(rt,st,Me,m,y,lt);if(!(yt===t?Jl(st,rt,S|k,O,lt):yt))return!1}}return!0}function ps(m){if(!cr(m)||Jf(m))return!1;var y=Ua(m)?Bu:of;return y.test(ro(m))}function Tf(m){return mr(m)&&bn(m)==vt}function Sp(m){return mr(m)&&Gr(m)==Ee}function Np(m){return mr(m)&&ac(m.length)&&!!An[bn(m)]}function Cp(m){return typeof m=="function"?m:m==null?Be:typeof m=="object"?qt(m)?Pf(m[0],m[1]):jp(m):Tn(m)}function Ef(m){if(!Xn(m))return Yt(m);var y=[];for(var j in mn(m))xn.call(m,j)&&j!="constructor"&&y.push(j);return y}function $g(m){if(!cr(m))return Wo(m);var y=Xn(m),j=[];for(var O in m)O=="constructor"&&(y||!xn.call(m,O))||j.push(O);return j}function Af(m,y){return m<y}function _p(m,y){var j=-1,O=Or(m)?Ge(m.length):[];return Ks(m,function(Q,se,we){O[++j]=y(Q,se,we)}),O}function jp(m){var y=Gf(m);return y.length==1&&y[0][2]?ly(y[0][0],y[0][1]):function(j){return j===m||Xu(j,m,y)}}function Pf(m,y){return Wf(m)&&oy(y)?ly(On(m),y):function(j){var O=Rd(j,m);return O===t&&O===y?cu(j,m):Jl(y,O,S|k)}}function Zu(m,y,j,O,Q){m!==y&&zc(y,function(se,we){if(Q||(Q=new gi),cr(se))cv(m,y,we,j,Zu,O,Q);else{var je=O?O(Kf(m,we),se,we+"",m,y,Q):t;je===t&&(je=se),hs(m,we,je)}},Yr)}function cv(m,y,j,O,Q,se,we){var je=Kf(m,j),Me=Kf(y,j),rt=we.get(Me);if(rt){hs(m,j,rt);return}var st=se?se(je,Me,j+"",m,y,we):t,lt=st===t;if(lt){var yt=qt(Me),kt=!yt&&rl(Me),zt=!yt&&!kt&&au(Me);st=Me,yt||kt||zt?qt(je)?st=je:wr(je)?st=Rr(je):kt?(lt=!1,st=Rp(Me,!0)):zt?(lt=!1,st=Op(Me,!0)):st=[]:ya(Me)||oo(Me)?(st=je,oo(je)?st=ex(je):(!cr(je)||Ua(je))&&(st=qp(Me))):lt=!1}lt&&(we.set(Me,st),Q(st,Me,O,se,we),we.delete(Me)),hs(m,j,st)}function kp(m,y){var j=m.length;if(j)return y+=y<0?j:0,Ba(y,j)?m[y]:t}function Tp(m,y,j){y.length?y=Fn(y,function(se){return qt(se)?function(we){return ha(we,se.length===1?se[0]:se)}:se}):y=[Be];var O=-1;y=Fn(y,hi(At()));var Q=_p(m,function(se,we,je){var Me=Fn(y,function(rt){return rt(se)});return{criteria:Me,index:++O,value:se}});return qs(Q,function(se,we){return Qg(se,we,j)})}function zg(m,y){return Df(m,y,function(j,O){return cu(m,O)})}function Df(m,y,j){for(var O=-1,Q=y.length,se={};++O<Q;){var we=y[O],je=ha(m,we);j(je,we)&&qc(se,Zs(we,m),je)}return se}function Bg(m){return function(y){return ha(y,m)}}function If(m,y,j,O){var Q=O?Fu:la,se=-1,we=y.length,je=m;for(m===y&&(y=Rr(y)),j&&(je=Fn(m,hi(j)));++se<we;)for(var Me=0,rt=y[se],st=j?j(rt):rt;(Me=Q(je,st,Me,O))>-1;)je!==m&&Mc.call(je,Me,1),Mc.call(m,Me,1);return m}function Ep(m,y){for(var j=m?y.length:0,O=j-1;j--;){var Q=y[j];if(j==O||Q!==se){var se=Q;Ba(Q)?Mc.call(m,Q,1):rd(m,Q)}}return m}function Rf(m,y){return m+Ie(dp()*(y-m+1))}function Ug(m,y,j,O){for(var Q=-1,se=In(fe((y-m)/(j||1)),0),we=Ge(se);se--;)we[O?se:++Q]=m,m+=j;return we}function Ap(m,y){var j="";if(!m||y<1||y>oe)return j;do y%2&&(j+=m),y=Ie(y/2),y&&(m+=m);while(y);return j}function Jt(m,y){return xd(Hp(m,y,Be),m+"")}function Uc(m){return Fc(du(m))}function Mf(m,y){var j=du(m);return vd(j,$a(y,0,j.length))}function qc(m,y,j,O){if(!cr(m))return m;y=Zs(y,m);for(var Q=-1,se=y.length,we=se-1,je=m;je!=null&&++Q<se;){var Me=On(y[Q]),rt=j;if(Me==="__proto__"||Me==="constructor"||Me==="prototype")return m;if(Q!=we){var st=je[Me];rt=O?O(st,Me,je):t,rt===t&&(rt=cr(st)?st:Ba(y[Q+1])?[]:{})}Gl(je,Me,rt),je=je[Me]}return m}var ed=Oc?function(m,y){return Oc.set(m,y),m}:Be,td=$o?function(m,y){return $o(m,"toString",{configurable:!0,enumerable:!1,value:ze(y),writable:!0})}:Be;function qg(m){return vd(du(m))}function Wi(m,y,j){var O=-1,Q=m.length;y<0&&(y=-y>Q?0:Q+y),j=j>Q?Q:j,j<0&&(j+=Q),Q=y>j?0:j-y>>>0,y>>>=0;for(var se=Ge(Q);++O<Q;)se[O]=m[O+y];return se}function Vg(m,y){var j;return Ks(m,function(O,Q,se){return j=y(O,Q,se),!j}),!!j}function nd(m,y,j){var O=0,Q=m==null?O:m.length;if(typeof y=="number"&&y===y&&Q<=D){for(;O<Q;){var se=O+Q>>>1,we=m[se];we!==null&&!bi(we)&&(j?we<=y:we<y)?O=se+1:Q=se}return Q}return Of(m,y,Be,j)}function Of(m,y,j,O){var Q=0,se=m==null?0:m.length;if(se===0)return 0;y=j(y);for(var we=y!==y,je=y===null,Me=bi(y),rt=y===t;Q<se;){var st=Ie((Q+se)/2),lt=j(m[st]),yt=lt!==t,kt=lt===null,zt=lt===lt,ln=bi(lt);if(we)var Bt=O||zt;else rt?Bt=zt&&(O||yt):je?Bt=zt&&yt&&(O||!kt):Me?Bt=zt&&yt&&!kt&&(O||!ln):kt||ln?Bt=!1:Bt=O?lt<=y:lt<y;Bt?Q=st+1:se=st}return kn(se,ge)}function Pp(m,y){for(var j=-1,O=m.length,Q=0,se=[];++j<O;){var we=m[j],je=y?y(we):we;if(!j||!Ri(je,Me)){var Me=je;se[Q++]=we===0?0:we}}return se}function Lf(m){return typeof m=="number"?m:bi(m)?E:+m}function Ei(m){if(typeof m=="string")return m;if(qt(m))return Fn(m,Ei)+"";if(bi(m))return Bo?Bo.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Xs(m,y,j){var O=-1,Q=Dl,se=m.length,we=!0,je=[],Me=je;if(j)we=!1,Q=To;else if(se>=a){var rt=y?null:ey(m);if(rt)return Ic(rt);we=!1,Q=Do,Me=new Qs}else Me=y?[]:je;e:for(;++O<se;){var st=m[O],lt=y?y(st):st;if(st=j||st!==0?st:0,we&&lt===lt){for(var yt=Me.length;yt--;)if(Me[yt]===lt)continue e;y&&Me.push(lt),je.push(st)}else Q(Me,lt,j)||(Me!==je&&Me.push(lt),je.push(st))}return je}function rd(m,y){return y=Zs(y,m),m=Gc(m,y),m==null||delete m[On(li(y))]}function Dp(m,y,j,O){return qc(m,y,j(ha(m,y)),O)}function id(m,y,j,O){for(var Q=m.length,se=O?Q:-1;(O?se--:++se<Q)&&y(m[se],se,m););return j?Wi(m,O?0:se,O?se+1:Q):Wi(m,O?se+1:0,O?Q:se)}function Hg(m,y){var j=m;return j instanceof sn&&(j=j.value()),Il(y,function(O,Q){return Q.func.apply(Q.thisArg,Ia([O],Q.args))},j)}function ad(m,y,j){var O=m.length;if(O<2)return O?Xs(m[0]):[];for(var Q=-1,se=Ge(O);++Q<O;)for(var we=m[Q],je=-1;++je<O;)je!=Q&&(se[Q]=qo(se[Q]||we,m[je],y,j));return Xs(yn(se,1),y,j)}function Ip(m,y,j){for(var O=-1,Q=m.length,se=y.length,we={};++O<Q;){var je=O<se?y[O]:t;j(we,m[O],je)}return we}function Ff(m){return wr(m)?m:[]}function sd(m){return typeof m=="function"?m:Be}function Zs(m,y){return qt(m)?m:Wf(m,y)?[m]:xs(Rn(m))}var Gg=Jt;function Ho(m,y,j){var O=m.length;return j=j===t?O:j,!y&&j>=O?m:Wi(m,y,j)}var Yg=Bl||function(m){return rr.clearTimeout(m)};function Rp(m,y){if(y)return m.slice();var j=m.length,O=Hs?Hs(j):new m.constructor(j);return m.copy(O),O}function Kl(m){var y=new m.constructor(m.byteLength);return new Fo(y).set(new Fo(m)),y}function Mp(m,y){var j=y?Kl(m.buffer):m.buffer;return new m.constructor(j,m.byteOffset,m.byteLength)}function $f(m){var y=new m.constructor(m.source,Ds.exec(m));return y.lastIndex=m.lastIndex,y}function Wg(m){return ql?mn(ql.call(m)):{}}function Op(m,y){var j=y?Kl(m.buffer):m.buffer;return new m.constructor(j,m.byteOffset,m.length)}function od(m,y){if(m!==y){var j=m!==t,O=m===null,Q=m===m,se=bi(m),we=y!==t,je=y===null,Me=y===y,rt=bi(y);if(!je&&!rt&&!se&&m>y||se&&we&&Me&&!je&&!rt||O&&we&&Me||!j&&Me||!Q)return 1;if(!O&&!se&&!rt&&m<y||rt&&j&&Q&&!O&&!se||je&&j&&Q||!we&&Q||!Me)return-1}return 0}function Qg(m,y,j){for(var O=-1,Q=m.criteria,se=y.criteria,we=Q.length,je=j.length;++O<we;){var Me=od(Q[O],se[O]);if(Me){if(O>=je)return Me;var rt=j[O];return Me*(rt=="desc"?-1:1)}}return m.index-y.index}function Lp(m,y,j,O){for(var Q=-1,se=m.length,we=j.length,je=-1,Me=y.length,rt=In(se-we,0),st=Ge(Me+rt),lt=!O;++je<Me;)st[je]=y[je];for(;++Q<we;)(lt||Q<se)&&(st[j[Q]]=m[Q]);for(;rt--;)st[je++]=m[Q++];return st}function Jg(m,y,j,O){for(var Q=-1,se=m.length,we=-1,je=j.length,Me=-1,rt=y.length,st=In(se-je,0),lt=Ge(st+rt),yt=!O;++Q<st;)lt[Q]=m[Q];for(var kt=Q;++Me<rt;)lt[kt+Me]=y[Me];for(;++we<je;)(yt||Q<se)&&(lt[kt+j[we]]=m[Q++]);return lt}function Rr(m,y){var j=-1,O=m.length;for(y||(y=Ge(O));++j<O;)y[j]=m[j];return y}function Ai(m,y,j,O){var Q=!j;j||(j={});for(var se=-1,we=y.length;++se<we;){var je=y[se],Me=O?O(j[je],m[je],je,j,m):t;Me===t&&(Me=m[je]),Q?Fa(j,je,Me):Gl(j,je,Me)}return j}function zf(m,y){return Ai(m,pd(m),y)}function ld(m,y){return Ai(m,Yf(m),y)}function Xl(m,y){return function(j,O){var Q=qt(j)?Ru:Uo,se=y?y():{};return Q(j,m,At(O,2),se)}}function Zl(m){return Jt(function(y,j){var O=-1,Q=j.length,se=Q>1?j[Q-1]:t,we=Q>2?j[2]:t;for(se=m.length>3&&typeof se=="function"?(Q--,se):t,we&&xi(j[0],j[1],we)&&(se=Q<3?t:se,Q=1),y=mn(y);++O<Q;){var je=j[O];je&&m(y,je,O,se)}return y})}function Fp(m,y){return function(j,O){if(j==null)return j;if(!Or(j))return m(j,O);for(var Q=j.length,se=y?Q:-1,we=mn(j);(y?se--:++se<Q)&&O(we[se],se,we)!==!1;);return j}}function ec(m){return function(y,j,O){for(var Q=-1,se=mn(y),we=O(y),je=we.length;je--;){var Me=we[m?je:++Q];if(j(se[Me],Me,se)===!1)break}return y}}function Kg(m,y,j){var O=y&T,Q=pa(m);function se(){var we=this&&this!==rr&&this instanceof se?Q:m;return we.apply(O?j:this,arguments)}return se}function Qi(m){return function(y){y=Rn(y);var j=Vi(y)?ri(y):t,O=j?j[0]:y.charAt(0),Q=j?Ho(j,1).join(""):y.slice(1);return O[m]()+Q}}function yi(m){return function(y){return Il(N(lo(y).replace(ss,"")),m,"")}}function pa(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var j=Yi(m.prototype),O=m.apply(j,y);return cr(O)?O:j}}function Xg(m,y,j){var O=pa(m);function Q(){for(var se=arguments.length,we=Ge(se),je=se,Me=nc(Q);je--;)we[je]=arguments[je];var rt=se<3&&we[0]!==Me&&we[se-1]!==Me?[]:Ma(we,Me);if(se-=rt.length,se<j)return $p(m,y,br,Q.placeholder,t,we,rt,t,t,j-se);var st=this&&this!==rr&&this instanceof Q?O:m;return Xr(st,this,we)}return Q}function eo(m){return function(y,j,O){var Q=mn(y);if(!Or(y)){var se=At(j,3);y=Fr(y),j=function(je){return se(Q[je],je,Q)}}var we=m(y,j,O);return we>-1?Q[se?y[we]:we]:t}}function ms(m){return ir(function(y){var j=y.length,O=j,Q=ji.prototype.thru;for(m&&y.reverse();O--;){var se=y[O];if(typeof se!="function")throw new mi(l);if(Q&&!we&&hd(se)=="wrapper")var we=new ji([],!0)}for(O=we?O:j;++O<j;){se=y[O];var je=hd(se),Me=je=="wrapper"?Hf(se):t;Me&&Qf(Me[0])&&Me[1]==(U|I|F|H)&&!Me[4].length&&Me[9]==1?we=we[hd(Me[0])].apply(we,Me[3]):we=se.length==1&&Qf(se)?we[je]():we.thru(se)}return function(){var rt=arguments,st=rt[0];if(we&&rt.length==1&&qt(st))return we.plant(st).value();for(var lt=0,yt=j?y[lt].apply(this,rt):st;++lt<j;)yt=y[lt].call(this,yt);return yt}})}function br(m,y,j,O,Q,se,we,je,Me,rt){var st=y&U,lt=y&T,yt=y&P,kt=y&(I|B),zt=y&K,ln=yt?t:pa(m);function Bt(){for(var vn=arguments.length,En=Ge(vn),Va=vn;Va--;)En[Va]=arguments[Va];if(kt)var ea=nc(Bt),Ha=Io(En,ea);if(O&&(En=Lp(En,O,Q,kt)),se&&(En=Jg(En,se,we,kt)),vn-=Ha,kt&&vn<rt){var $r=Ma(En,ea);return $p(m,y,br,Bt.placeholder,j,En,$r,je,Me,rt-vn)}var co=lt?j:this,sc=yt?co[m]:m;return vn=En.length,je?En=ys(En,je):zt&&vn>1&&En.reverse(),st&&Me<vn&&(En.length=Me),this&&this!==rr&&this instanceof Bt&&(sc=ln||pa(sc)),sc.apply(co,En)}return Bt}function cd(m,y){return function(j,O){return wp(j,m,y(O),{})}}function Vc(m,y){return function(j,O){var Q;if(j===t&&O===t)return y;if(j!==t&&(Q=j),O!==t){if(Q===t)return O;typeof j=="string"||typeof O=="string"?(j=Ei(j),O=Ei(O)):(j=Lf(j),O=Lf(O)),Q=m(j,O)}return Q}}function ud(m){return ir(function(y){return y=Fn(y,hi(At())),Jt(function(j){var O=this;return m(y,function(Q){return Xr(Q,O,j)})})})}function dd(m,y){y=y===t?" ":Ei(y);var j=y.length;if(j<2)return j?Ap(y,m):y;var O=Ap(y,fe(m/Ci(y)));return Vi(y)?Ho(ri(O),0,m).join(""):O.slice(0,m)}function Zg(m,y,j,O){var Q=y&T,se=pa(m);function we(){for(var je=-1,Me=arguments.length,rt=-1,st=O.length,lt=Ge(st+Me),yt=this&&this!==rr&&this instanceof we?se:m;++rt<st;)lt[rt]=O[rt];for(;Me--;)lt[rt++]=arguments[++je];return Xr(yt,Q?j:this,lt)}return we}function Go(m){return function(y,j,O){return O&&typeof O!="number"&&xi(y,j,O)&&(j=O=t),y=ws(y),j===t?(j=y,y=0):j=ws(j),O=O===t?y<j?1:-1:ws(O),Ug(y,j,O,m)}}function tc(m){return function(y,j){return typeof y=="string"&&typeof j=="string"||(y=xa(y),j=xa(j)),m(y,j)}}function $p(m,y,j,O,Q,se,we,je,Me,rt){var st=y&I,lt=st?we:t,yt=st?t:we,kt=st?se:t,zt=st?t:se;y|=st?F:L,y&=~(st?L:F),y&R||(y&=-4);var ln=[m,y,Q,kt,lt,zt,yt,je,Me,rt],Bt=j.apply(t,ln);return Qf(m)&&Xf(Bt,ln),Bt.placeholder=O,Zf(Bt,m,y)}function Bf(m){var y=yr[m];return function(j,O){if(j=xa(j),O=O==null?0:kn(Wt(O),292),O&&_t(j)){var Q=(Rn(j)+"e").split("e"),se=y(Q[0]+"e"+(+Q[1]+O));return Q=(Rn(se)+"e").split("e"),+(Q[0]+"e"+(+Q[1]-O))}return y(j)}}var ey=gn&&1/Ic(new gn([,-0]))[1]==J?function(m){return new gn(m)}:bt;function fd(m){return function(y){var j=Gr(y);return j==De?Dc(y):j==Ee?cp(y):pf(y,m(y))}}function gs(m,y,j,O,Q,se,we,je){var Me=y&P;if(!Me&&typeof m!="function")throw new mi(l);var rt=O?O.length:0;if(rt||(y&=-97,O=Q=t),we=we===t?we:In(Wt(we),0),je=je===t?je:Wt(je),rt-=Q?Q.length:0,y&L){var st=O,lt=Q;O=Q=t}var yt=Me?t:Hf(m),kt=[m,y,j,O,Q,st,lt,se,we,je];if(yt&&yd(kt,yt),m=kt[0],y=kt[1],j=kt[2],O=kt[3],Q=kt[4],je=kt[9]=kt[9]===t?Me?0:m.length:In(kt[9]-rt,0),!je&&y&(I|B)&&(y&=-25),!y||y==T)var zt=Kg(m,y,j);else y==I||y==B?zt=Xg(m,y,je):(y==F||y==(T|F))&&!Q.length?zt=Zg(m,y,j,O):zt=br.apply(t,kt);var ln=yt?ed:Xf;return Zf(ln(zt,kt),m,y)}function Uf(m,y,j,O){return m===t||Ri(m,Oo[j])&&!xn.call(O,j)?y:m}function zp(m,y,j,O,Q,se){return cr(m)&&cr(y)&&(se.set(y,m),Zu(m,y,t,zp,se),se.delete(y)),m}function ty(m){return ya(m)?t:m}function ny(m,y,j,O,Q,se){var we=j&S,je=m.length,Me=y.length;if(je!=Me&&!(we&&Me>je))return!1;var rt=se.get(m),st=se.get(y);if(rt&&st)return rt==y&&st==m;var lt=-1,yt=!0,kt=j&k?new Qs:t;for(se.set(m,y),se.set(y,m);++lt<je;){var zt=m[lt],ln=y[lt];if(O)var Bt=we?O(ln,zt,lt,y,m,se):O(zt,ln,lt,m,y,se);if(Bt!==t){if(Bt)continue;yt=!1;break}if(kt){if(!kc(y,function(vn,En){if(!Do(kt,En)&&(zt===vn||Q(zt,vn,j,O,se)))return kt.push(En)})){yt=!1;break}}else if(!(zt===ln||Q(zt,ln,j,O,se))){yt=!1;break}}return se.delete(m),se.delete(y),yt}function ry(m,y,j,O,Q,se,we){switch(j){case be:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case de:return!(m.byteLength!=y.byteLength||!se(new Fo(m),new Fo(y)));case X:case ye:case Ye:return Ri(+m,+y);case he:return m.name==y.name&&m.message==y.message;case vt:case Je:return m==y+"";case De:var je=Dc;case Ee:var Me=O&S;if(je||(je=Ic),m.size!=y.size&&!Me)return!1;var rt=we.get(m);if(rt)return rt==y;O|=k,we.set(m,y);var st=ny(je(m),je(y),O,Q,se,we);return we.delete(m),st;case Ae:if(ql)return ql.call(m)==ql.call(y)}return!1}function Hr(m,y,j,O,Q,se){var we=j&S,je=qf(m),Me=je.length,rt=qf(y),st=rt.length;if(Me!=st&&!we)return!1;for(var lt=Me;lt--;){var yt=je[lt];if(!(we?yt in y:xn.call(y,yt)))return!1}var kt=se.get(m),zt=se.get(y);if(kt&&zt)return kt==y&&zt==m;var ln=!0;se.set(m,y),se.set(y,m);for(var Bt=we;++lt<Me;){yt=je[lt];var vn=m[yt],En=y[yt];if(O)var Va=we?O(En,vn,yt,y,m,se):O(vn,En,yt,m,y,se);if(!(Va===t?vn===En||Q(vn,En,j,O,se):Va)){ln=!1;break}Bt||(Bt=yt=="constructor")}if(ln&&!Bt){var ea=m.constructor,Ha=y.constructor;ea!=Ha&&"constructor"in m&&"constructor"in y&&!(typeof ea=="function"&&ea instanceof ea&&typeof Ha=="function"&&Ha instanceof Ha)&&(ln=!1)}return se.delete(m),se.delete(y),ln}function ir(m){return xd(Hp(m,t,Di),m+"")}function qf(m){return Og(m,Fr,pd)}function Vf(m){return Og(m,Yr,Yf)}var Hf=Oc?function(m){return Oc.get(m)}:bt;function hd(m){for(var y=m.name+"",j=da[y],O=xn.call(da,y)?j.length:0;O--;){var Q=j[O],se=Q.func;if(se==null||se==m)return Q.name}return y}function nc(m){var y=xn.call(re,"placeholder")?re:m;return y.placeholder}function At(){var m=re.iteratee||Ot;return m=m===Ot?Cp:m,arguments.length?m(arguments[0],arguments[1]):m}function Hc(m,y){var j=m.__data__;return no(y)?j[typeof y=="string"?"string":"hash"]:j.map}function Gf(m){for(var y=Fr(m),j=y.length;j--;){var O=y[j],Q=m[O];y[j]=[O,Q,oy(Q)]}return y}function Yo(m,y){var j=Pc(m,y);return ps(j)?j:t}function iy(m){var y=xn.call(m,Vr),j=m[Vr];try{m[Vr]=t;var O=!0}catch{}var Q=Zr.call(m);return O&&(y?m[Vr]=j:delete m[Vr]),Q}var pd=Ue?function(m){return m==null?[]:(m=mn(m),Ni(Ue(m),function(y){return Gs.call(m,y)}))}:Gv,Yf=Ue?function(m){for(var y=[];m;)Ia(y,pd(m)),m=$l(m);return y}:Gv,Gr=bn;(Uu&&Gr(new Uu(new ArrayBuffer(1)))!=be||Ir&&Gr(new Ir)!=De||or&&Gr(or.resolve())!=it||gn&&Gr(new gn)!=Ee||La&&Gr(new La)!=le)&&(Gr=function(m){var y=bn(m),j=y==Ke?m.constructor:t,O=j?ro(j):"";if(O)switch(O){case Cg:return be;case _g:return De;case qu:return it;case Vu:return Ee;case jg:return le}return y});function ay(m,y,j){for(var O=-1,Q=j.length;++O<Q;){var se=j[O],we=se.size;switch(se.type){case"drop":m+=we;break;case"dropRight":y-=we;break;case"take":y=kn(y,m+we);break;case"takeRight":m=In(m,y-we);break}}return{start:m,end:y}}function Bp(m){var y=m.match(af);return y?y[1].split(sf):[]}function md(m,y,j){y=Zs(y,m);for(var O=-1,Q=y.length,se=!1;++O<Q;){var we=On(y[O]);if(!(se=m!=null&&j(m,we)))break;m=m[we]}return se||++O!=Q?se:(Q=m==null?0:m.length,!!Q&&ac(Q)&&Ba(we,Q)&&(qt(m)||oo(m)))}function Up(m){var y=m.length,j=new m.constructor(y);return y&&typeof m[0]=="string"&&xn.call(m,"index")&&(j.index=m.index,j.input=m.input),j}function qp(m){return typeof m.constructor=="function"&&!Xn(m)?Yi($l(m)):{}}function Vp(m,y,j){var O=m.constructor;switch(y){case de:return Kl(m);case X:case ye:return new O(+m);case be:return Mp(m,j);case $e:case nt:case ht:case wt:case Et:case ve:case ke:case Ne:case Oe:return Op(m,j);case De:return new O;case Ye:case Je:return new O(m);case vt:return $f(m);case Ee:return new O;case Ae:return Wg(m)}}function sy(m,y){var j=y.length;if(!j)return m;var O=j-1;return y[O]=(j>1?"& ":"")+y[O],y=y.join(j>2?", ":" "),m.replace(hc,`{
/* [wrapped with `+y+`] */
`)}function to(m){return qt(m)||oo(m)||!!(ai&&m&&m[ai])}function Ba(m,y){var j=typeof m;return y=y??oe,!!y&&(j=="number"||j!="symbol"&&Rs.test(m))&&m>-1&&m%1==0&&m<y}function xi(m,y,j){if(!cr(j))return!1;var O=typeof y;return(O=="number"?Or(j)&&Ba(y,j.length):O=="string"&&y in j)?Ri(j[y],m):!1}function Wf(m,y){if(qt(m))return!1;var j=typeof m;return j=="number"||j=="symbol"||j=="boolean"||m==null||bi(m)?!0:Jn.test(m)||!hn.test(m)||y!=null&&m in mn(y)}function no(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Qf(m){var y=hd(m),j=re[y];if(typeof j!="function"||!(y in sn.prototype))return!1;if(m===j)return!0;var O=Hf(j);return!!O&&m===O[0]}function Jf(m){return!!Fl&&Fl in m}var gd=ua?Ua:Yv;function Xn(m){var y=m&&m.constructor,j=typeof y=="function"&&y.prototype||Oo;return m===j}function oy(m){return m===m&&!cr(m)}function ly(m,y){return function(j){return j==null?!1:j[m]===y&&(y!==t||m in mn(j))}}function cy(m){var y=Td(m,function(O){return j.size===u&&j.clear(),O}),j=y.cache;return y}function yd(m,y){var j=m[1],O=y[1],Q=j|O,se=Q<(T|P|U),we=O==U&&j==I||O==U&&j==H&&m[7].length<=y[8]||O==(U|H)&&y[7].length<=y[8]&&j==I;if(!(se||we))return m;O&T&&(m[2]=y[2],Q|=j&T?0:R);var je=y[3];if(je){var Me=m[3];m[3]=Me?Lp(Me,je,y[4]):je,m[4]=Me?Ma(m[3],h):y[4]}return je=y[5],je&&(Me=m[5],m[5]=Me?Jg(Me,je,y[6]):je,m[6]=Me?Ma(m[5],h):y[6]),je=y[7],je&&(m[7]=je),O&U&&(m[8]=m[8]==null?y[8]:kn(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=Q,m}function Wo(m){var y=[];if(m!=null)for(var j in mn(m))y.push(j);return y}function uy(m){return Zr.call(m)}function Hp(m,y,j){return y=In(y===t?m.length-1:y,0),function(){for(var O=arguments,Q=-1,se=In(O.length-y,0),we=Ge(se);++Q<se;)we[Q]=O[y+Q];Q=-1;for(var je=Ge(y+1);++Q<y;)je[Q]=O[Q];return je[y]=j(we),Xr(m,this,je)}}function Gc(m,y){return y.length<2?m:ha(m,Wi(y,0,-1))}function ys(m,y){for(var j=m.length,O=kn(y.length,j),Q=Rr(m);O--;){var se=y[O];m[O]=Ba(se,j)?Q[se]:t}return m}function Kf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Xf=bd(ed),Yc=xe||function(m,y){return rr.setTimeout(m,y)},xd=bd(td);function Zf(m,y,j){var O=y+"";return xd(m,sy(O,dy(Bp(O),j)))}function bd(m){var y=0,j=0;return function(){var O=Ws(),Q=W-(O-j);if(j=O,Q>0){if(++y>=z)return arguments[0]}else y=0;return m.apply(t,arguments)}}function vd(m,y){var j=-1,O=m.length,Q=O-1;for(y=y===t?O:y;++j<y;){var se=Rf(j,Q),we=m[se];m[se]=m[j],m[j]=we}return m.length=y,m}var xs=cy(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(un,function(j,O,Q,se){y.push(Q?se.replace(Aa,"$1"):O||j)}),y});function On(m){if(typeof m=="string"||bi(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function ro(m){if(m!=null){try{return Ll.call(m)}catch{}try{return m+""}catch{}}return""}function dy(m,y){return fi(pe,function(j){var O="_."+j[0];y&j[1]&&!Dl(m,O)&&m.push(O)}),m.sort()}function Mr(m){if(m instanceof sn)return m.clone();var y=new ji(m.__wrapped__,m.__chain__);return y.__actions__=Rr(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function uv(m,y,j){(j?xi(m,y,j):y===t)?y=1:y=In(Wt(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var Q=0,se=0,we=Ge(fe(O/y));Q<O;)we[se++]=Wi(m,Q,Q+=y);return we}function fy(m){for(var y=-1,j=m==null?0:m.length,O=0,Q=[];++y<j;){var se=m[y];se&&(Q[O++]=se)}return Q}function hy(){var m=arguments.length;if(!m)return[];for(var y=Ge(m-1),j=arguments[0],O=m;O--;)y[O-1]=arguments[O];return Ia(qt(j)?Rr(j):[j],yn(y,1))}var lr=Jt(function(m,y){return wr(m)?qo(m,yn(y,1,wr,!0)):[]}),Pi=Jt(function(m,y){var j=li(y);return wr(j)&&(j=t),wr(m)?qo(m,yn(y,1,wr,!0),At(j,2)):[]}),io=Jt(function(m,y){var j=li(y);return wr(j)&&(j=t),wr(m)?qo(m,yn(y,1,wr,!0),t,j):[]});function py(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Wt(y),Wi(m,y<0?0:y,O)):[]}function my(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Wt(y),y=O-y,Wi(m,0,y<0?0:y)):[]}function dv(m,y){return m&&m.length?id(m,At(y,3),!0,!0):[]}function Gp(m,y){return m&&m.length?id(m,At(y,3),!0):[]}function Ji(m,y,j,O){var Q=m==null?0:m.length;return Q?(j&&typeof j!="number"&&xi(m,y,j)&&(j=0,O=Q),en(m,y,j,O)):[]}function ma(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var Q=j==null?0:Wt(j);return Q<0&&(Q=In(O+Q,0)),ls(m,At(y,3),Q)}function Yp(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var Q=O-1;return j!==t&&(Q=Wt(j),Q=j<0?In(O+Q,0):kn(Q,O-1)),ls(m,At(y,3),Q,!0)}function Di(m){var y=m==null?0:m.length;return y?yn(m,1):[]}function gy(m){var y=m==null?0:m.length;return y?yn(m,J):[]}function Qo(m,y){var j=m==null?0:m.length;return j?(y=y===t?1:Wt(y),yn(m,y)):[]}function rc(m){for(var y=-1,j=m==null?0:m.length,O={};++y<j;){var Q=m[y];O[Q[0]]=Q[1]}return O}function ao(m){return m&&m.length?m[0]:t}function Wp(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var Q=j==null?0:Wt(j);return Q<0&&(Q=In(O+Q,0)),la(m,y,Q)}function Qp(m){var y=m==null?0:m.length;return y?Wi(m,0,-1):[]}var bs=Jt(function(m){var y=Fn(m,Ff);return y.length&&y[0]===m[0]?vp(y):[]}),yy=Jt(function(m){var y=li(m),j=Fn(m,Ff);return y===li(j)?y=t:j.pop(),j.length&&j[0]===m[0]?vp(j,At(y,2)):[]}),Wc=Jt(function(m){var y=li(m),j=Fn(m,Ff);return y=typeof y=="function"?y:t,y&&j.pop(),j.length&&j[0]===m[0]?vp(j,t,y):[]});function wd(m,y){return m==null?"":Qt.call(m,y)}function li(m){var y=m==null?0:m.length;return y?m[y-1]:t}function Qc(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var Q=O;return j!==t&&(Q=Wt(j),Q=Q<0?In(O+Q,0):kn(Q,O-1)),y===y?pi(m,y,Q):ls(m,Bs,Q,!0)}function xy(m,y){return m&&m.length?kp(m,Wt(y)):t}var by=Jt(Jc);function Jc(m,y){return m&&m.length&&y&&y.length?If(m,y):m}function vy(m,y,j){return m&&m.length&&y&&y.length?If(m,y,At(j,2)):m}function eh(m,y,j){return m&&m.length&&y&&y.length?If(m,y,t,j):m}var wy=ir(function(m,y){var j=m==null?0:m.length,O=Qu(m,y);return Ep(m,Fn(y,function(Q){return Ba(Q,j)?+Q:Q}).sort(od)),O});function fv(m,y){var j=[];if(!(m&&m.length))return j;var O=-1,Q=[],se=m.length;for(y=At(y,3);++O<se;){var we=m[O];y(we,O,m)&&(j.push(we),Q.push(O))}return Ep(m,Q),j}function Jp(m){return m==null?m:fp.call(m)}function zn(m,y,j){var O=m==null?0:m.length;return O?(j&&typeof j!="number"&&xi(m,y,j)?(y=0,j=O):(y=y==null?0:Wt(y),j=j===t?O:Wt(j)),Wi(m,y,j)):[]}function tr(m,y){return nd(m,y)}function dn(m,y,j){return Of(m,y,At(j,2))}function Cn(m,y){var j=m==null?0:m.length;if(j){var O=nd(m,y);if(O<j&&Ri(m[O],y))return O}return-1}function Bn(m,y){return nd(m,y,!0)}function Ki(m,y,j){return Of(m,y,At(j,2),!0)}function Jo(m,y){var j=m==null?0:m.length;if(j){var O=nd(m,y,!0)-1;if(Ri(m[O],y))return O}return-1}function Kc(m){return m&&m.length?Pp(m):[]}function Kp(m,y){return m&&m.length?Pp(m,At(y,2)):[]}function so(m){var y=m==null?0:m.length;return y?Wi(m,1,y):[]}function vr(m,y,j){return m&&m.length?(y=j||y===t?1:Wt(y),Wi(m,0,y<0?0:y)):[]}function Ko(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Wt(y),y=O-y,Wi(m,y<0?0:y,O)):[]}function ic(m,y){return m&&m.length?id(m,At(y,3),!1,!0):[]}function Xp(m,y){return m&&m.length?id(m,At(y,3)):[]}var ga=Jt(function(m){return Xs(yn(m,1,wr,!0))}),Xc=Jt(function(m){var y=li(m);return wr(y)&&(y=t),Xs(yn(m,1,wr,!0),At(y,2))}),Sd=Jt(function(m){var y=li(m);return y=typeof y=="function"?y:t,Xs(yn(m,1,wr,!0),t,y)});function Ii(m){return m&&m.length?Xs(m):[]}function Zp(m,y){return m&&m.length?Xs(m,At(y,2)):[]}function em(m,y){return y=typeof y=="function"?y:t,m&&m.length?Xs(m,t,y):[]}function Zc(m){if(!(m&&m.length))return[];var y=0;return m=Ni(m,function(j){if(wr(j))return y=In(j.length,y),!0}),cs(y,function(j){return Fn(m,Rl(j))})}function Nd(m,y){if(!(m&&m.length))return[];var j=Zc(m);return y==null?j:Fn(j,function(O){return Xr(y,t,O)})}var Xo=Jt(function(m,y){return wr(m)?qo(m,y):[]}),ei=Jt(function(m){return ad(Ni(m,wr))}),Zo=Jt(function(m){var y=li(m);return wr(y)&&(y=t),ad(Ni(m,wr),At(y,2))}),eu=Jt(function(m){var y=li(m);return y=typeof y=="function"?y:t,ad(Ni(m,wr),t,y)}),tu=Jt(Zc);function tm(m,y){return Ip(m||[],y||[],Gl)}function nm(m,y){return Ip(m||[],y||[],qc)}var Sy=Jt(function(m){var y=m.length,j=y>1?m[y-1]:t;return j=typeof j=="function"?(m.pop(),j):t,Nd(m,j)});function nu(m){var y=re(m);return y.__chain__=!0,y}function rm(m,y){return y(m),m}function ci(m,y){return y(m)}var Ny=ir(function(m){var y=m.length,j=y?m[0]:0,O=this.__wrapped__,Q=function(se){return Qu(se,m)};return y>1||this.__actions__.length||!(O instanceof sn)||!Ba(j)?this.thru(Q):(O=O.slice(j,+j+(y?1:0)),O.__actions__.push({func:ci,args:[Q],thisArg:t}),new ji(O,this.__chain__).thru(function(se){return y&&!se.length&&se.push(t),se}))});function Xi(){return nu(this)}function Cy(){return new ji(this.value(),this.__chain__)}function _y(){this.__values__===t&&(this.__values__=Zi(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function hv(){return this}function el(m){for(var y,j=this;j instanceof fa;){var O=Mr(j);O.__index__=0,O.__values__=t,y?Q.__wrapped__=O:y=O;var Q=O;j=j.__wrapped__}return Q.__wrapped__=m,y}function th(){var m=this.__wrapped__;if(m instanceof sn){var y=m;return this.__actions__.length&&(y=new sn(this)),y=y.reverse(),y.__actions__.push({func:ci,args:[Jp],thisArg:t}),new ji(y,this.__chain__)}return this.thru(Jp)}function im(){return Hg(this.__wrapped__,this.__actions__)}var ru=Xl(function(m,y,j){xn.call(m,j)?++m[j]:Fa(m,j,1)});function jy(m,y,j){var O=qt(m)?Mu:xp;return j&&xi(m,y,j)&&(y=t),O(m,At(y,3))}function ky(m,y){var j=qt(m)?Ni:$n;return j(m,At(y,3))}var Ty=eo(ma),am=eo(Yp);function sm(m,y){return yn(Cd(m,y),1)}function pv(m,y){return yn(Cd(m,y),J)}function mv(m,y,j){return j=j===t?1:Wt(j),yn(Cd(m,y),j)}function Ey(m,y){var j=qt(m)?fi:Ks;return j(m,At(y,3))}function om(m,y){var j=qt(m)?hf:_f;return j(m,At(y,3))}var Ay=Xl(function(m,y,j){xn.call(m,j)?m[j].push(y):Fa(m,j,[y])});function iu(m,y,j,O){m=Or(m)?m:du(m),j=j&&!O?Wt(j):0;var Q=m.length;return j<0&&(j=In(Q+j,0)),hh(m)?j<=Q&&m.indexOf(y,j)>-1:!!Q&&la(m,y,j)>-1}var nh=Jt(function(m,y,j){var O=-1,Q=typeof y=="function",se=Or(m)?Ge(m.length):[];return Ks(m,function(we){se[++O]=Q?Xr(y,we,j):Ql(we,y,j)}),se}),Py=Xl(function(m,y,j){Fa(m,j,y)});function Cd(m,y){var j=qt(m)?Fn:_p;return j(m,At(y,3))}function Dy(m,y,j,O){return m==null?[]:(qt(y)||(y=y==null?[]:[y]),j=O?t:j,qt(j)||(j=j==null?[]:[j]),Tp(m,y,j))}var Iy=Xl(function(m,y,j){m[j?0:1].push(y)},function(){return[[],[]]});function Ry(m,y,j){var O=qt(m)?Il:Ao,Q=arguments.length<3;return O(m,At(y,4),j,Q,Ks)}function My(m,y,j){var O=qt(m)?Ou:Ao,Q=arguments.length<3;return O(m,At(y,4),j,Q,_f)}function rh(m,y){var j=qt(m)?Ni:$n;return j(m,Ed(At(y,3)))}function Oy(m){var y=qt(m)?Fc:Uc;return y(m)}function Ly(m,y,j){(j?xi(m,y,j):y===t)?y=1:y=Wt(y);var O=qt(m)?Ig:Mf;return O(m,y)}function Zn(m){var y=qt(m)?Rg:qg;return y(m)}function lm(m){if(m==null)return 0;if(Or(m))return hh(m)?Ci(m):m.length;var y=Gr(m);return y==De||y==Ee?m.size:Ef(m).length}function gv(m,y,j){var O=qt(m)?kc:Vg;return j&&xi(m,y,j)&&(y=t),O(m,At(y,3))}var Fy=Jt(function(m,y){if(m==null)return[];var j=y.length;return j>1&&xi(m,y[0],y[1])?y=[]:j>2&&xi(y[0],y[1],y[2])&&(y=[y[0]]),Tp(m,yn(y,1),[])}),ih=ne||function(){return rr.Date.now()};function yv(m,y){if(typeof y!="function")throw new mi(l);return m=Wt(m),function(){if(--m<1)return y.apply(this,arguments)}}function $y(m,y,j){return y=j?t:y,y=m&&y==null?m.length:y,gs(m,U,t,t,t,t,y)}function _d(m,y){var j;if(typeof y!="function")throw new mi(l);return m=Wt(m),function(){return--m>0&&(j=y.apply(this,arguments)),m<=1&&(y=t),j}}var tl=Jt(function(m,y,j){var O=T;if(j.length){var Q=Ma(j,nc(tl));O|=F}return gs(m,O,y,j,Q)}),ah=Jt(function(m,y,j){var O=T|P;if(j.length){var Q=Ma(j,nc(ah));O|=F}return gs(y,O,m,j,Q)});function jd(m,y,j){y=j?t:y;var O=gs(m,I,t,t,t,t,t,y);return O.placeholder=jd.placeholder,O}function sh(m,y,j){y=j?t:y;var O=gs(m,B,t,t,t,t,t,y);return O.placeholder=sh.placeholder,O}function nl(m,y,j){var O,Q,se,we,je,Me,rt=0,st=!1,lt=!1,yt=!0;if(typeof m!="function")throw new mi(l);y=xa(y)||0,cr(j)&&(st=!!j.leading,lt="maxWait"in j,se=lt?In(xa(j.maxWait)||0,y):se,yt="trailing"in j?!!j.trailing:yt);function kt($r){var co=O,sc=Q;return O=Q=t,rt=$r,we=m.apply(sc,co),we}function zt($r){return rt=$r,je=Yc(vn,y),st?kt($r):we}function ln($r){var co=$r-Me,sc=$r-rt,ES=y-co;return lt?kn(ES,se-sc):ES}function Bt($r){var co=$r-Me,sc=$r-rt;return Me===t||co>=y||co<0||lt&&sc>=se}function vn(){var $r=ih();if(Bt($r))return En($r);je=Yc(vn,ln($r))}function En($r){return je=t,yt&&O?kt($r):(O=Q=t,we)}function Va(){je!==t&&Yg(je),rt=0,O=Me=Q=je=t}function ea(){return je===t?we:En(ih())}function Ha(){var $r=ih(),co=Bt($r);if(O=arguments,Q=this,Me=$r,co){if(je===t)return zt(Me);if(lt)return Yg(je),je=Yc(vn,y),kt(Me)}return je===t&&(je=Yc(vn,y)),we}return Ha.cancel=Va,Ha.flush=ea,Ha}var vs=Jt(function(m,y){return Yl(m,1,y)}),kd=Jt(function(m,y,j){return Yl(m,xa(y)||0,j)});function xv(m){return gs(m,K)}function Td(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new mi(l);var j=function(){var O=arguments,Q=y?y.apply(this,O):O[0],se=j.cache;if(se.has(Q))return se.get(Q);var we=m.apply(this,O);return j.cache=se.set(Q,we)||se,we};return j.cache=new(Td.Cache||ki),j}Td.Cache=ki;function Ed(m){if(typeof m!="function")throw new mi(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function zy(m){return _d(2,m)}var By=Gg(function(m,y){y=y.length==1&&qt(y[0])?Fn(y[0],hi(At())):Fn(yn(y,1),hi(At()));var j=y.length;return Jt(function(O){for(var Q=-1,se=kn(O.length,j);++Q<se;)O[Q]=y[Q].call(this,O[Q]);return Xr(m,this,O)})}),cm=Jt(function(m,y){var j=Ma(y,nc(cm));return gs(m,F,t,y,j)}),oh=Jt(function(m,y){var j=Ma(y,nc(oh));return gs(m,L,t,y,j)}),Uy=ir(function(m,y){return gs(m,H,t,t,t,y)});function qy(m,y){if(typeof m!="function")throw new mi(l);return y=y===t?y:Wt(y),Jt(m,y)}function bv(m,y){if(typeof m!="function")throw new mi(l);return y=y==null?0:In(Wt(y),0),Jt(function(j){var O=j[y],Q=Ho(j,0,y);return O&&Ia(Q,O),Xr(m,this,Q)})}function um(m,y,j){var O=!0,Q=!0;if(typeof m!="function")throw new mi(l);return cr(j)&&(O="leading"in j?!!j.leading:O,Q="trailing"in j?!!j.trailing:Q),nl(m,y,{leading:O,maxWait:y,trailing:Q})}function dm(m){return $y(m,1)}function vv(m,y){return cm(sd(y),m)}function wv(){if(!arguments.length)return[];var m=arguments[0];return qt(m)?m:[m]}function Ad(m){return si(m,v)}function Sv(m,y){return y=typeof y=="function"?y:t,si(m,v,y)}function Vy(m){return si(m,g|v)}function fn(m,y){return y=typeof y=="function"?y:t,si(m,g|v,y)}function fm(m,y){return y==null||yp(m,y,Fr(y))}function Ri(m,y){return m===y||m!==m&&y!==y}var hm=tc(Ju),Hy=tc(function(m,y){return m>=y}),oo=jf(function(){return arguments}())?jf:function(m){return mr(m)&&xn.call(m,"callee")&&!Gs.call(m,"callee")},qt=Ge.isArray,lh=Da?hi(Da):Ti;function Or(m){return m!=null&&ac(m.length)&&!Ua(m)}function wr(m){return mr(m)&&Or(m)}function Nv(m){return m===!0||m===!1||mr(m)&&bn(m)==X}var rl=ct||Yv,Gy=El?hi(El):Tr;function Yy(m){return mr(m)&&m.nodeType===1&&!ya(m)}function ch(m){if(m==null)return!0;if(Or(m)&&(qt(m)||typeof m=="string"||typeof m.splice=="function"||rl(m)||au(m)||oo(m)))return!m.length;var y=Gr(m);if(y==De||y==Ee)return!m.size;if(Xn(m))return!Ef(m).length;for(var j in m)if(xn.call(m,j))return!1;return!0}function Gn(m,y){return Jl(m,y)}function pm(m,y,j){j=typeof j=="function"?j:t;var O=j?j(m,y):t;return O===t?Jl(m,y,t,j):!!O}function Lr(m){if(!mr(m))return!1;var y=bn(m);return y==he||y==He||typeof m.message=="string"&&typeof m.name=="string"&&!ya(m)}function Cv(m){return typeof m=="number"&&_t(m)}function Ua(m){if(!cr(m))return!1;var y=bn(m);return y==Le||y==ue||y==ee||y==ot}function uh(m){return typeof m=="number"&&m==Wt(m)}function ac(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=oe}function cr(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function mr(m){return m!=null&&typeof m=="object"}var dh=Al?hi(Al):kf;function mm(m,y){return m===y||Xu(m,y,Gf(y))}function _v(m,y,j){return j=typeof j=="function"?j:t,Xu(m,y,Gf(y),j)}function Wy(m){return Jy(m)&&m!=+m}function jv(m){if(gd(m))throw new Rt(o);return ps(m)}function Qy(m){return m===null}function kv(m){return m==null}function Jy(m){return typeof m=="number"||mr(m)&&bn(m)==Ye}function ya(m){if(!mr(m)||bn(m)!=Ke)return!1;var y=$l(m);if(y===null)return!0;var j=xn.call(y,"constructor")&&y.constructor;return typeof j=="function"&&j instanceof j&&Ll.call(j)==pr}var fh=ko?hi(ko):Tf;function gm(m){return uh(m)&&m>=-9007199254740991&&m<=oe}var Ky=ff?hi(ff):Sp;function hh(m){return typeof m=="string"||!qt(m)&&mr(m)&&bn(m)==Je}function bi(m){return typeof m=="symbol"||mr(m)&&bn(m)==Ae}var au=Pl?hi(Pl):Np;function qa(m){return m===t}function ym(m){return mr(m)&&Gr(m)==le}function Xy(m){return mr(m)&&bn(m)==q}var Zy=tc(Af),Pd=tc(function(m,y){return m<=y});function Zi(m){if(!m)return[];if(Or(m))return hh(m)?ri(m):Rr(m);if(Ys&&m[Ys])return mf(m[Ys]());var y=Gr(m),j=y==De?Dc:y==Ee?Ic:du;return j(m)}function ws(m){if(!m)return m===0?m:0;if(m=xa(m),m===J||m===-1/0){var y=m<0?-1:1;return y*ie}return m===m?m:0}function Wt(m){var y=ws(m),j=y%1;return y===y?j?y-j:y:0}function Ss(m){return m?$a(Wt(m),0,ce):0}function xa(m){if(typeof m=="number")return m;if(bi(m))return E;if(cr(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=cr(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=Po(m);var j=kr.test(m);return j||lf.test(m)?uf(m.slice(2),j?2:8):Is.test(m)?E:+m}function ex(m){return Ai(m,Yr(m))}function su(m){return m?$a(Wt(m),-9007199254740991,oe):m===0?m:0}function Rn(m){return m==null?"":Ei(m)}var Tv=Zl(function(m,y){if(Xn(y)||Or(y)){Ai(y,Fr(y),m);return}for(var j in y)xn.call(y,j)&&Gl(m,j,y[j])}),tx=Zl(function(m,y){Ai(y,Yr(y),m)}),ph=Zl(function(m,y,j,O){Ai(y,Yr(y),m,O)}),Ev=Zl(function(m,y,j,O){Ai(y,Fr(y),m,O)}),Av=ir(Qu);function Pv(m,y){var j=Yi(m);return y==null?j:Js(j,y)}var Dv=Jt(function(m,y){m=mn(m);var j=-1,O=y.length,Q=O>2?y[2]:t;for(Q&&xi(y[0],y[1],Q)&&(O=1);++j<O;)for(var se=y[j],we=Yr(se),je=-1,Me=we.length;++je<Me;){var rt=we[je],st=m[rt];(st===t||Ri(st,Oo[rt])&&!xn.call(m,rt))&&(m[rt]=se[rt])}return m}),nx=Jt(function(m){return m.push(t,zp),Xr(Md,t,m)});function ou(m,y){return Ec(m,At(y,3),oi)}function Dd(m,y){return Ec(m,At(y,3),Bc)}function rx(m,y){return m==null?m:zc(m,At(y,3),Yr)}function Iv(m,y){return m==null?m:Wl(m,At(y,3),Yr)}function lu(m,y){return m&&oi(m,At(y,3))}function Id(m,y){return m&&Bc(m,At(y,3))}function ix(m){return m==null?[]:Vo(m,Fr(m))}function mh(m){return m==null?[]:Vo(m,Yr(m))}function Rd(m,y,j){var O=m==null?t:ha(m,y);return O===t?j:O}function xm(m,y){return m!=null&&md(m,y,bp)}function cu(m,y){return m!=null&&md(m,y,Lg)}var ax=cd(function(m,y,j){y!=null&&typeof y.toString!="function"&&(y=Zr.call(y)),m[y]=j},ze(Be)),sx=cd(function(m,y,j){y!=null&&typeof y.toString!="function"&&(y=Zr.call(y)),xn.call(m,y)?m[y].push(j):m[y]=[j]},At),Rv=Jt(Ql);function Fr(m){return Or(m)?gp(m):Ef(m)}function Yr(m){return Or(m)?gp(m,!0):$g(m)}function Mv(m,y){var j={};return y=At(y,3),oi(m,function(O,Q,se){Fa(j,y(O,Q,se),O)}),j}function Ov(m,y){var j={};return y=At(y,3),oi(m,function(O,Q,se){Fa(j,Q,y(O,Q,se))}),j}var Lv=Zl(function(m,y,j){Zu(m,y,j)}),Md=Zl(function(m,y,j,O){Zu(m,y,j,O)}),gh=ir(function(m,y){var j={};if(m==null)return j;var O=!1;y=Fn(y,function(se){return se=Zs(se,m),O||(O=se.length>1),se}),Ai(m,Vf(m),j),O&&(j=si(j,g|b|v,ty));for(var Q=y.length;Q--;)rd(j,y[Q]);return j});function bm(m,y){return uu(m,Ed(At(y)))}var Fv=ir(function(m,y){return m==null?{}:zg(m,y)});function uu(m,y){if(m==null)return{};var j=Fn(Vf(m),function(O){return[O]});return y=At(y),Df(m,j,function(O,Q){return y(O,Q[0])})}function $v(m,y,j){y=Zs(y,m);var O=-1,Q=y.length;for(Q||(Q=1,m=t);++O<Q;){var se=m==null?t:m[On(y[O])];se===t&&(O=Q,se=j),m=Ua(se)?se.call(m):se}return m}function ox(m,y,j){return m==null?m:qc(m,y,j)}function lx(m,y,j,O){return O=typeof O=="function"?O:t,m==null?m:qc(m,y,j,O)}var vm=fd(Fr),wm=fd(Yr);function Sm(m,y,j){var O=qt(m),Q=O||rl(m)||au(m);if(y=At(y,4),j==null){var se=m&&m.constructor;Q?j=O?new se:[]:cr(m)?j=Ua(se)?Yi($l(m)):{}:j={}}return(Q?fi:oi)(m,function(we,je,Me){return y(j,we,je,Me)}),j}function cx(m,y){return m==null?!0:rd(m,y)}function yh(m,y,j){return m==null?m:Dp(m,y,sd(j))}function zv(m,y,j,O){return O=typeof O=="function"?O:t,m==null?m:Dp(m,y,sd(j),O)}function du(m){return m==null?[]:Ra(m,Fr(m))}function Nm(m){return m==null?[]:Ra(m,Yr(m))}function Cm(m,y,j){return j===t&&(j=y,y=t),j!==t&&(j=xa(j),j=j===j?j:0),y!==t&&(y=xa(y),y=y===y?y:0),$a(xa(m),y,j)}function xh(m,y,j){return y=ws(y),j===t?(j=y,y=0):j=ws(j),m=xa(m),Fg(m,y,j)}function _m(m,y,j){if(j&&typeof j!="boolean"&&xi(m,y,j)&&(y=j=t),j===t&&(typeof y=="boolean"?(j=y,y=t):typeof m=="boolean"&&(j=m,m=t)),m===t&&y===t?(m=0,y=1):(m=ws(m),y===t?(y=m,m=0):y=ws(y)),m>y){var O=m;m=y,y=O}if(j||m%1||y%1){var Q=dp();return kn(m+Q*(y-m+$s("1e-"+((Q+"").length-1))),y)}return Rf(m,y)}var ux=yi(function(m,y,j){return y=y.toLowerCase(),m+(j?bh(y):y)});function bh(m){return x(Rn(m).toLowerCase())}function lo(m){return m=Rn(m),m&&m.replace(bo,us).replace(ia,"")}function il(m,y,j){m=Rn(m),y=Ei(y);var O=m.length;j=j===t?O:$a(Wt(j),0,O);var Q=j;return j-=y.length,j>=0&&m.slice(j,Q)==y}function al(m){return m=Rn(m),m&&Ln.test(m)?m.replace(mt,Ro):m}function Od(m){return m=Rn(m),m&&hr.test(m)?m.replace(Hn,"\\$&"):m}var Ld=yi(function(m,y,j){return m+(j?"-":"")+y.toLowerCase()}),sl=yi(function(m,y,j){return m+(j?" ":"")+y.toLowerCase()}),Bv=Qi("toLowerCase");function dx(m,y,j){m=Rn(m),y=Wt(y);var O=y?Ci(m):0;if(!y||O>=y)return m;var Q=(y-O)/2;return dd(Ie(Q),j)+m+dd(fe(Q),j)}function Fd(m,y,j){m=Rn(m),y=Wt(y);var O=y?Ci(m):0;return y&&O<y?m+dd(y-O,j):m}function Uv(m,y,j){m=Rn(m),y=Wt(y);var O=y?Ci(m):0;return y&&O<y?dd(y-O,j)+m:m}function fx(m,y,j){return j||y==null?y=0:y&&(y=+y),Ul(Rn(m).replace(sr,""),y||0)}function vh(m,y,j){return(j?xi(m,y,j):y===t)?y=1:y=Wt(y),Ap(Rn(m),y)}function hx(){var m=arguments,y=Rn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var qv=yi(function(m,y,j){return m+(j?"_":"")+y.toLowerCase()});function wh(m,y,j){return j&&typeof j!="number"&&xi(m,y,j)&&(y=j=t),j=j===t?ce:j>>>0,j?(m=Rn(m),m&&(typeof y=="string"||y!=null&&!fh(y))&&(y=Ei(y),!y&&Vi(m))?Ho(ri(m),0,j):m.split(y,j)):[]}var Sh=yi(function(m,y,j){return m+(j?" ":"")+x(y)});function px(m,y,j){return m=Rn(m),j=j==null?0:$a(Wt(j),0,m.length),y=Ei(y),m.slice(j,j+y.length)==y}function $d(m,y,j){var O=re.templateSettings;j&&xi(m,y,j)&&(y=t),m=Rn(m),y=ph({},y,O,Uf);var Q=ph({},y.imports,O.imports,Uf),se=Fr(Q),we=Ra(Q,se),je,Me,rt=0,st=y.interpolate||pc,lt="__p += '",yt=Ol((y.escape||pc).source+"|"+st.source+"|"+(st===xt?Ps:pc).source+"|"+(y.evaluate||pc).source+"|$","g"),kt="//# sourceURL="+(xn.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++_c+"]")+`
`;m.replace(yt,function(Bt,vn,En,Va,ea,Ha){return En||(En=Va),lt+=m.slice(rt,Ha).replace(cf,Ac),vn&&(je=!0,lt+=`' +
__e(`+vn+`) +
'`),ea&&(Me=!0,lt+=`';
`+ea+`;
__p += '`),En&&(lt+=`' +
((__t = (`+En+`)) == null ? '' : __t) +
'`),rt=Ha+Bt.length,Bt}),lt+=`';
`;var zt=xn.call(y,"variable")&&y.variable;if(!zt)lt=`with (obj) {
`+lt+`
}
`;else if(Tu.test(zt))throw new Rt(d);lt=(Me?lt.replace(Ve,""):lt).replace(Ze,"$1").replace(jt,"$1;"),lt="function("+(zt||"obj")+`) {
`+(zt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(je?", __e = _.escape":"")+(Me?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+lt+`return __p
}`;var ln=A(function(){return pn(se,kt+"return "+lt).apply(t,we)});if(ln.source=lt,Lr(ln))throw ln;return ln}function jm(m){return Rn(m).toLowerCase()}function Nh(m){return Rn(m).toUpperCase()}function mx(m,y,j){if(m=Rn(m),m&&(j||y===t))return Po(m);if(!m||!(y=Ei(y)))return m;var O=ri(m),Q=ri(y),se=Vs(O,Q),we=qi(O,Q)+1;return Ho(O,se,we).join("")}function Vv(m,y,j){if(m=Rn(m),m&&(j||y===t))return m.slice(0,zu(m)+1);if(!m||!(y=Ei(y)))return m;var O=ri(m),Q=qi(O,ri(y))+1;return Ho(O,0,Q).join("")}function Ch(m,y,j){if(m=Rn(m),m&&(j||y===t))return m.replace(sr,"");if(!m||!(y=Ei(y)))return m;var O=ri(m),Q=Vs(O,ri(y));return Ho(O,Q).join("")}function s(m,y){var j=M,O=$;if(cr(y)){var Q="separator"in y?y.separator:Q;j="length"in y?Wt(y.length):j,O="omission"in y?Ei(y.omission):O}m=Rn(m);var se=m.length;if(Vi(m)){var we=ri(m);se=we.length}if(j>=se)return m;var je=j-Ci(O);if(je<1)return O;var Me=we?Ho(we,0,je).join(""):m.slice(0,je);if(Q===t)return Me+O;if(we&&(je+=Me.length-je),fh(Q)){if(m.slice(je).search(Q)){var rt,st=Me;for(Q.global||(Q=Ol(Q.source,Rn(Ds.exec(Q))+"g")),Q.lastIndex=0;rt=Q.exec(st);)var lt=rt.index;Me=Me.slice(0,lt===t?je:lt)}}else if(m.indexOf(Ei(Q),je)!=je){var yt=Me.lastIndexOf(Q);yt>-1&&(Me=Me.slice(0,yt))}return Me+O}function c(m){return m=Rn(m),m&&an.test(m)?m.replace(Nt,Mo):m}var p=yi(function(m,y,j){return m+(j?" ":"")+y.toUpperCase()}),x=Qi("toUpperCase");function N(m,y,j){return m=Rn(m),y=j?t:y,y===t?$u(m)?ds(m):Tc(m):m.match(y)||[]}var A=Jt(function(m,y){try{return Xr(m,t,y)}catch(j){return Lr(j)?j:new Rt(j)}}),Y=ir(function(m,y){return fi(y,function(j){j=On(j),Fa(m,j,tl(m[j],m))}),m});function ae(m){var y=m==null?0:m.length,j=At();return m=y?Fn(m,function(O){if(typeof O[1]!="function")throw new mi(l);return[j(O[0]),O[1]]}):[],Jt(function(O){for(var Q=-1;++Q<y;){var se=m[Q];if(Xr(se[0],this,O))return Xr(se[1],this,O)}})}function Se(m){return Mg(si(m,g))}function ze(m){return function(){return m}}function Xe(m,y){return m==null||m!==m?y:m}var at=ms(),qe=ms(!0);function Be(m){return m}function Ot(m){return Cp(typeof m=="function"?m:si(m,g))}function Mt(m){return jp(si(m,g))}function Yn(m,y){return Pf(m,si(y,g))}var Re=Jt(function(m,y){return function(j){return Ql(j,m,y)}}),Te=Jt(function(m,y){return function(j){return Ql(m,j,y)}});function Fe(m,y,j){var O=Fr(y),Q=Vo(y,O);j==null&&!(cr(y)&&(Q.length||!O.length))&&(j=y,y=m,m=this,Q=Vo(y,Fr(y)));var se=!(cr(j)&&"chain"in j)||!!j.chain,we=Ua(m);return fi(Q,function(je){var Me=y[je];m[je]=Me,we&&(m.prototype[je]=function(){var rt=this.__chain__;if(se||rt){var st=m(this.__wrapped__),lt=st.__actions__=Rr(this.__actions__);return lt.push({func:Me,args:arguments,thisArg:m}),st.__chain__=rt,st}return Me.apply(m,Ia([this.value()],arguments))})}),m}function tt(){return rr._===this&&(rr._=Lo),this}function bt(){}function on(m){return m=Wt(m),Jt(function(y){return kp(y,m)})}var Tt=ud(Fn),Lt=ud(Mu),Wr=ud(kc);function Tn(m){return Wf(m)?Rl(On(m)):Bg(m)}function ol(m){return function(y){return m==null?t:ha(m,y)}}var Hv=Go(),tP=Go(!0);function Gv(){return[]}function Yv(){return!1}function nP(){return{}}function rP(){return""}function iP(){return!0}function aP(m,y){if(m=Wt(m),m<1||m>oe)return[];var j=ce,O=kn(m,ce);y=At(y),m-=ce;for(var Q=cs(O,y);++j<m;)y(j);return Q}function sP(m){return qt(m)?Fn(m,On):bi(m)?[m]:Rr(xs(Rn(m)))}function oP(m){var y=++Hi;return Rn(m)+y}var lP=Vc(function(m,y){return m+y},0),cP=Bf("ceil"),uP=Vc(function(m,y){return m/y},1),dP=Bf("floor");function fP(m){return m&&m.length?za(m,Be,Ju):t}function hP(m,y){return m&&m.length?za(m,At(y,2),Ju):t}function pP(m){return Us(m,Be)}function mP(m,y){return Us(m,At(y,2))}function gP(m){return m&&m.length?za(m,Be,Af):t}function yP(m,y){return m&&m.length?za(m,At(y,2),Af):t}var xP=Vc(function(m,y){return m*y},1),bP=Bf("round"),vP=Vc(function(m,y){return m-y},0);function wP(m){return m&&m.length?Ml(m,Be):0}function SP(m,y){return m&&m.length?Ml(m,At(y,2)):0}return re.after=yv,re.ary=$y,re.assign=Tv,re.assignIn=tx,re.assignInWith=ph,re.assignWith=Ev,re.at=Av,re.before=_d,re.bind=tl,re.bindAll=Y,re.bindKey=ah,re.castArray=wv,re.chain=nu,re.chunk=uv,re.compact=fy,re.concat=hy,re.cond=ae,re.conforms=Se,re.constant=ze,re.countBy=ru,re.create=Pv,re.curry=jd,re.curryRight=sh,re.debounce=nl,re.defaults=Dv,re.defaultsDeep=nx,re.defer=vs,re.delay=kd,re.difference=lr,re.differenceBy=Pi,re.differenceWith=io,re.drop=py,re.dropRight=my,re.dropRightWhile=dv,re.dropWhile=Gp,re.fill=Ji,re.filter=ky,re.flatMap=sm,re.flatMapDeep=pv,re.flatMapDepth=mv,re.flatten=Di,re.flattenDeep=gy,re.flattenDepth=Qo,re.flip=xv,re.flow=at,re.flowRight=qe,re.fromPairs=rc,re.functions=ix,re.functionsIn=mh,re.groupBy=Ay,re.initial=Qp,re.intersection=bs,re.intersectionBy=yy,re.intersectionWith=Wc,re.invert=ax,re.invertBy=sx,re.invokeMap=nh,re.iteratee=Ot,re.keyBy=Py,re.keys=Fr,re.keysIn=Yr,re.map=Cd,re.mapKeys=Mv,re.mapValues=Ov,re.matches=Mt,re.matchesProperty=Yn,re.memoize=Td,re.merge=Lv,re.mergeWith=Md,re.method=Re,re.methodOf=Te,re.mixin=Fe,re.negate=Ed,re.nthArg=on,re.omit=gh,re.omitBy=bm,re.once=zy,re.orderBy=Dy,re.over=Tt,re.overArgs=By,re.overEvery=Lt,re.overSome=Wr,re.partial=cm,re.partialRight=oh,re.partition=Iy,re.pick=Fv,re.pickBy=uu,re.property=Tn,re.propertyOf=ol,re.pull=by,re.pullAll=Jc,re.pullAllBy=vy,re.pullAllWith=eh,re.pullAt=wy,re.range=Hv,re.rangeRight=tP,re.rearg=Uy,re.reject=rh,re.remove=fv,re.rest=qy,re.reverse=Jp,re.sampleSize=Ly,re.set=ox,re.setWith=lx,re.shuffle=Zn,re.slice=zn,re.sortBy=Fy,re.sortedUniq=Kc,re.sortedUniqBy=Kp,re.split=wh,re.spread=bv,re.tail=so,re.take=vr,re.takeRight=Ko,re.takeRightWhile=ic,re.takeWhile=Xp,re.tap=rm,re.throttle=um,re.thru=ci,re.toArray=Zi,re.toPairs=vm,re.toPairsIn=wm,re.toPath=sP,re.toPlainObject=ex,re.transform=Sm,re.unary=dm,re.union=ga,re.unionBy=Xc,re.unionWith=Sd,re.uniq=Ii,re.uniqBy=Zp,re.uniqWith=em,re.unset=cx,re.unzip=Zc,re.unzipWith=Nd,re.update=yh,re.updateWith=zv,re.values=du,re.valuesIn=Nm,re.without=Xo,re.words=N,re.wrap=vv,re.xor=ei,re.xorBy=Zo,re.xorWith=eu,re.zip=tu,re.zipObject=tm,re.zipObjectDeep=nm,re.zipWith=Sy,re.entries=vm,re.entriesIn=wm,re.extend=tx,re.extendWith=ph,Fe(re,re),re.add=lP,re.attempt=A,re.camelCase=ux,re.capitalize=bh,re.ceil=cP,re.clamp=Cm,re.clone=Ad,re.cloneDeep=Vy,re.cloneDeepWith=fn,re.cloneWith=Sv,re.conformsTo=fm,re.deburr=lo,re.defaultTo=Xe,re.divide=uP,re.endsWith=il,re.eq=Ri,re.escape=al,re.escapeRegExp=Od,re.every=jy,re.find=Ty,re.findIndex=ma,re.findKey=ou,re.findLast=am,re.findLastIndex=Yp,re.findLastKey=Dd,re.floor=dP,re.forEach=Ey,re.forEachRight=om,re.forIn=rx,re.forInRight=Iv,re.forOwn=lu,re.forOwnRight=Id,re.get=Rd,re.gt=hm,re.gte=Hy,re.has=xm,re.hasIn=cu,re.head=ao,re.identity=Be,re.includes=iu,re.indexOf=Wp,re.inRange=xh,re.invoke=Rv,re.isArguments=oo,re.isArray=qt,re.isArrayBuffer=lh,re.isArrayLike=Or,re.isArrayLikeObject=wr,re.isBoolean=Nv,re.isBuffer=rl,re.isDate=Gy,re.isElement=Yy,re.isEmpty=ch,re.isEqual=Gn,re.isEqualWith=pm,re.isError=Lr,re.isFinite=Cv,re.isFunction=Ua,re.isInteger=uh,re.isLength=ac,re.isMap=dh,re.isMatch=mm,re.isMatchWith=_v,re.isNaN=Wy,re.isNative=jv,re.isNil=kv,re.isNull=Qy,re.isNumber=Jy,re.isObject=cr,re.isObjectLike=mr,re.isPlainObject=ya,re.isRegExp=fh,re.isSafeInteger=gm,re.isSet=Ky,re.isString=hh,re.isSymbol=bi,re.isTypedArray=au,re.isUndefined=qa,re.isWeakMap=ym,re.isWeakSet=Xy,re.join=wd,re.kebabCase=Ld,re.last=li,re.lastIndexOf=Qc,re.lowerCase=sl,re.lowerFirst=Bv,re.lt=Zy,re.lte=Pd,re.max=fP,re.maxBy=hP,re.mean=pP,re.meanBy=mP,re.min=gP,re.minBy=yP,re.stubArray=Gv,re.stubFalse=Yv,re.stubObject=nP,re.stubString=rP,re.stubTrue=iP,re.multiply=xP,re.nth=xy,re.noConflict=tt,re.noop=bt,re.now=ih,re.pad=dx,re.padEnd=Fd,re.padStart=Uv,re.parseInt=fx,re.random=_m,re.reduce=Ry,re.reduceRight=My,re.repeat=vh,re.replace=hx,re.result=$v,re.round=bP,re.runInContext=Pe,re.sample=Oy,re.size=lm,re.snakeCase=qv,re.some=gv,re.sortedIndex=tr,re.sortedIndexBy=dn,re.sortedIndexOf=Cn,re.sortedLastIndex=Bn,re.sortedLastIndexBy=Ki,re.sortedLastIndexOf=Jo,re.startCase=Sh,re.startsWith=px,re.subtract=vP,re.sum=wP,re.sumBy=SP,re.template=$d,re.times=aP,re.toFinite=ws,re.toInteger=Wt,re.toLength=Ss,re.toLower=jm,re.toNumber=xa,re.toSafeInteger=su,re.toString=Rn,re.toUpper=Nh,re.trim=mx,re.trimEnd=Vv,re.trimStart=Ch,re.truncate=s,re.unescape=c,re.uniqueId=oP,re.upperCase=p,re.upperFirst=x,re.each=Ey,re.eachRight=om,re.first=ao,Fe(re,function(){var m={};return oi(re,function(y,j){xn.call(re.prototype,j)||(m[j]=y)}),m}(),{chain:!1}),re.VERSION=r,fi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){re[m].placeholder=re}),fi(["drop","take"],function(m,y){sn.prototype[m]=function(j){j=j===t?1:In(Wt(j),0);var O=this.__filtered__&&!y?new sn(this):this.clone();return O.__filtered__?O.__takeCount__=kn(j,O.__takeCount__):O.__views__.push({size:kn(j,ce),type:m+(O.__dir__<0?"Right":"")}),O},sn.prototype[m+"Right"]=function(j){return this.reverse()[m](j).reverse()}}),fi(["filter","map","takeWhile"],function(m,y){var j=y+1,O=j==te||j==G;sn.prototype[m]=function(Q){var se=this.clone();return se.__iteratees__.push({iteratee:At(Q,3),type:j}),se.__filtered__=se.__filtered__||O,se}}),fi(["head","last"],function(m,y){var j="take"+(y?"Right":"");sn.prototype[m]=function(){return this[j](1).value()[0]}}),fi(["initial","tail"],function(m,y){var j="drop"+(y?"":"Right");sn.prototype[m]=function(){return this.__filtered__?new sn(this):this[j](1)}}),sn.prototype.compact=function(){return this.filter(Be)},sn.prototype.find=function(m){return this.filter(m).head()},sn.prototype.findLast=function(m){return this.reverse().find(m)},sn.prototype.invokeMap=Jt(function(m,y){return typeof m=="function"?new sn(this):this.map(function(j){return Ql(j,m,y)})}),sn.prototype.reject=function(m){return this.filter(Ed(At(m)))},sn.prototype.slice=function(m,y){m=Wt(m);var j=this;return j.__filtered__&&(m>0||y<0)?new sn(j):(m<0?j=j.takeRight(-m):m&&(j=j.drop(m)),y!==t&&(y=Wt(y),j=y<0?j.dropRight(-y):j.take(y-m)),j)},sn.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},sn.prototype.toArray=function(){return this.take(ce)},oi(sn.prototype,function(m,y){var j=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),Q=re[O?"take"+(y=="last"?"Right":""):y],se=O||/^find/.test(y);Q&&(re.prototype[y]=function(){var we=this.__wrapped__,je=O?[1]:arguments,Me=we instanceof sn,rt=je[0],st=Me||qt(we),lt=function(vn){var En=Q.apply(re,Ia([vn],je));return O&&yt?En[0]:En};st&&j&&typeof rt=="function"&&rt.length!=1&&(Me=st=!1);var yt=this.__chain__,kt=!!this.__actions__.length,zt=se&&!yt,ln=Me&&!kt;if(!se&&st){we=ln?we:new sn(this);var Bt=m.apply(we,je);return Bt.__actions__.push({func:ci,args:[lt],thisArg:t}),new ji(Bt,yt)}return zt&&ln?m.apply(this,je):(Bt=this.thru(lt),zt?O?Bt.value()[0]:Bt.value():Bt)})}),fi(["pop","push","shift","sort","splice","unshift"],function(m){var y=Rc[m],j=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);re.prototype[m]=function(){var Q=arguments;if(O&&!this.__chain__){var se=this.value();return y.apply(qt(se)?se:[],Q)}return this[j](function(we){return y.apply(qt(we)?we:[],Q)})}}),oi(sn.prototype,function(m,y){var j=re[y];if(j){var O=j.name+"";xn.call(da,O)||(da[O]=[]),da[O].push({name:y,func:j})}}),da[br(t,P).name]=[{name:"wrapper",func:t}],sn.prototype.clone=Hu,sn.prototype.reverse=vf,sn.prototype.value=Vl,re.prototype.at=Ny,re.prototype.chain=Xi,re.prototype.commit=Cy,re.prototype.next=_y,re.prototype.plant=el,re.prototype.reverse=th,re.prototype.toJSON=re.prototype.valueOf=re.prototype.value=im,re.prototype.first=re.prototype.head,Ys&&(re.prototype[Ys]=hv),re},Oa=ii();oa?((oa.exports=Oa)._=Oa,jo._=Oa):rr._=Oa}).call(FH)}(Hm,Hm.exports)),Hm.exports}var JT=$H();class zH{constructor(n){nr(this,"sampleRate",24e3);nr(this,"bufferSize",7680);nr(this,"audioQueue",[]);nr(this,"isPlaying",!1);nr(this,"isStreamComplete",!1);nr(this,"checkInterval",null);nr(this,"scheduledTime",0);nr(this,"initialBufferTime",.1);nr(this,"gainNode");nr(this,"source");nr(this,"endOfQueueAudioSource",null);nr(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=Ex.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(Ex.set(this.context,{}),a=Ex.get(this.context)),a[n]={handlers:[r]};const o=G1(n,t);await this.context.audioWorklet.addModule(o);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const o=r.getInt16(a*2,!0);t[a]=o/32768}catch(o){console.error(o)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const o=Ex.get(this.context);o&&Object.entries(o).forEach(([,d])=>{const{node:f,handlers:u}=d;f&&(a.connect(f),f.port.onmessage=function(h){u.forEach(g=>{g.call(f.port,h)})},f.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function KT(e,n){return function(){return e.apply(n,arguments)}}const{toString:BH}=Object.prototype,{getPrototypeOf:lS}=Object,Yb=(e=>n=>{const t=BH.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),xo=e=>(e=e.toLowerCase(),n=>Yb(n)===e),Wb=e=>n=>typeof n===e,{isArray:ip}=Array,sg=Wb("undefined");function UH(e){return e!==null&&!sg(e)&&e.constructor!==null&&!sg(e.constructor)&&Za(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const XT=xo("ArrayBuffer");function qH(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&XT(e.buffer),n}const VH=Wb("string"),Za=Wb("function"),ZT=Wb("number"),Qb=e=>e!==null&&typeof e=="object",HH=e=>e===!0||e===!1,Jx=e=>{if(Yb(e)!=="object")return!1;const n=lS(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},GH=xo("Date"),YH=xo("File"),WH=xo("Blob"),QH=xo("FileList"),JH=e=>Qb(e)&&Za(e.pipe),KH=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Za(e.append)&&((n=Yb(e))==="formdata"||n==="object"&&Za(e.toString)&&e.toString()==="[object FormData]"))},XH=xo("URLSearchParams"),[ZH,eG,tG,nG]=["ReadableStream","Request","Response","Headers"].map(xo),rG=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xg(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),ip(e))for(r=0,a=e.length;r<a;r++)n.call(null,e[r],r,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let d;for(r=0;r<l;r++)d=o[r],n.call(null,e[d],d,e)}}function eE(e,n){n=n.toLowerCase();const t=Object.keys(e);let r=t.length,a;for(;r-- >0;)if(a=t[r],n===a.toLowerCase())return a;return null}const Hd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,tE=e=>!sg(e)&&e!==Hd;function Y1(){const{caseless:e}=tE(this)&&this||{},n={},t=(r,a)=>{const o=e&&eE(n,a)||a;Jx(n[o])&&Jx(r)?n[o]=Y1(n[o],r):Jx(r)?n[o]=Y1({},r):ip(r)?n[o]=r.slice():n[o]=r};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&xg(arguments[r],t);return n}const iG=(e,n,t,{allOwnKeys:r}={})=>(xg(n,(a,o)=>{t&&Za(a)?e[o]=KT(a,t):e[o]=a},{allOwnKeys:r}),e),aG=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),sG=(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},oG=(e,n,t,r)=>{let a,o,l;const d={};if(n=n||{},e==null)return n;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)l=a[o],(!r||r(l,e,n))&&!d[l]&&(n[l]=e[l],d[l]=!0);e=t!==!1&&lS(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},lG=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const r=e.indexOf(n,t);return r!==-1&&r===t},cG=e=>{if(!e)return null;if(ip(e))return e;let n=e.length;if(!ZT(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},uG=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&lS(Uint8Array)),dG=(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=r.next())&&!a.done;){const o=a.value;n.call(e,o[0],o[1])}},fG=(e,n)=>{let t;const r=[];for(;(t=e.exec(n))!==null;)r.push(t);return r},hG=xo("HTMLFormElement"),pG=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,a){return r.toUpperCase()+a}),T_=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),mG=xo("RegExp"),nE=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};xg(t,(a,o)=>{let l;(l=n(a,o,e))!==!1&&(r[o]=l||a)}),Object.defineProperties(e,r)},gG=e=>{nE(e,(n,t)=>{if(Za(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if(Za(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},yG=(e,n)=>{const t={},r=a=>{a.forEach(o=>{t[o]=!0})};return ip(e)?r(e):r(String(e).split(n)),t},xG=()=>{},bG=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function vG(e){return!!(e&&Za(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const wG=e=>{const n=new Array(10),t=(r,a)=>{if(Qb(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[a]=r;const o=ip(r)?[]:{};return xg(r,(l,d)=>{const f=t(l,a+1);!sg(f)&&(o[d]=f)}),n[a]=void 0,o}}return r};return t(e,0)},SG=xo("AsyncFunction"),NG=e=>e&&(Qb(e)||Za(e))&&Za(e.then)&&Za(e.catch),rE=((e,n)=>e?setImmediate:n?((t,r)=>(Hd.addEventListener("message",({source:a,data:o})=>{a===Hd&&o===t&&r.length&&r.shift()()},!1),a=>{r.push(a),Hd.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Za(Hd.postMessage)),CG=typeof queueMicrotask<"u"?queueMicrotask.bind(Hd):typeof process<"u"&&process.nextTick||rE,We={isArray:ip,isArrayBuffer:XT,isBuffer:UH,isFormData:KH,isArrayBufferView:qH,isString:VH,isNumber:ZT,isBoolean:HH,isObject:Qb,isPlainObject:Jx,isReadableStream:ZH,isRequest:eG,isResponse:tG,isHeaders:nG,isUndefined:sg,isDate:GH,isFile:YH,isBlob:WH,isRegExp:mG,isFunction:Za,isStream:JH,isURLSearchParams:XH,isTypedArray:uG,isFileList:QH,forEach:xg,merge:Y1,extend:iG,trim:rG,stripBOM:aG,inherits:sG,toFlatObject:oG,kindOf:Yb,kindOfTest:xo,endsWith:lG,toArray:cG,forEachEntry:dG,matchAll:fG,isHTMLForm:hG,hasOwnProperty:T_,hasOwnProp:T_,reduceDescriptors:nE,freezeMethods:gG,toObjectSet:yG,toCamelCase:pG,noop:xG,toFiniteNumber:bG,findKey:eE,global:Hd,isContextDefined:tE,isSpecCompliantForm:vG,toJSONObject:wG,isAsyncFn:SG,isThenable:NG,setImmediate:rE,asap:CG};function Zt(e,n,t,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}We.inherits(Zt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:We.toJSONObject(this.config),code:this.code,status:this.status}}});const iE=Zt.prototype,aE={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{aE[e]={value:e}});Object.defineProperties(Zt,aE);Object.defineProperty(iE,"isAxiosError",{value:!0});Zt.from=(e,n,t,r,a,o)=>{const l=Object.create(iE);return We.toFlatObject(e,l,function(f){return f!==Error.prototype},d=>d!=="isAxiosError"),Zt.call(l,e.message,n,t,r,a),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const _G=null;function W1(e){return We.isPlainObject(e)||We.isArray(e)}function sE(e){return We.endsWith(e,"[]")?e.slice(0,-2):e}function E_(e,n,t){return e?e.concat(n).map(function(a,o){return a=sE(a),!t&&o?"["+a+"]":a}).join(t?".":""):n}function jG(e){return We.isArray(e)&&!e.some(W1)}const kG=We.toFlatObject(We,{},null,function(n){return/^is[A-Z]/.test(n)});function Jb(e,n,t){if(!We.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=We.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,T){return!We.isUndefined(T[k])});const r=t.metaTokens,a=t.visitor||h,o=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&We.isSpecCompliantForm(n);if(!We.isFunction(a))throw new TypeError("visitor must be a function");function u(S){if(S===null)return"";if(We.isDate(S))return S.toISOString();if(!f&&We.isBlob(S))throw new Zt("Blob is not supported. Use a Buffer instead.");return We.isArrayBuffer(S)||We.isTypedArray(S)?f&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function h(S,k,T){let P=S;if(S&&!T&&typeof S=="object"){if(We.endsWith(k,"{}"))k=r?k:k.slice(0,-2),S=JSON.stringify(S);else if(We.isArray(S)&&jG(S)||(We.isFileList(S)||We.endsWith(k,"[]"))&&(P=We.toArray(S)))return k=sE(k),P.forEach(function(I,B){!(We.isUndefined(I)||I===null)&&n.append(l===!0?E_([k],B,o):l===null?k:k+"[]",u(I))}),!1}return W1(S)?!0:(n.append(E_(T,k,o),u(S)),!1)}const g=[],b=Object.assign(kG,{defaultVisitor:h,convertValue:u,isVisitable:W1});function v(S,k){if(!We.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+k.join("."));g.push(S),We.forEach(S,function(P,R){(!(We.isUndefined(P)||P===null)&&a.call(n,P,We.isString(R)?R.trim():R,k,b))===!0&&v(P,k?k.concat(R):[R])}),g.pop()}}if(!We.isObject(e))throw new TypeError("data must be an object");return v(e),n}function A_(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function cS(e,n){this._pairs=[],e&&Jb(e,this,n)}const oE=cS.prototype;oE.append=function(n,t){this._pairs.push([n,t])};oE.toString=function(n){const t=n?function(r){return n.call(this,r,A_)}:A_;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function TG(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function lE(e,n,t){if(!n)return e;const r=t&&t.encode||TG;We.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let o;if(a?o=a(n,t):o=We.isURLSearchParams(n)?n.toString():new cS(n,t).toString(r),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class P_{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){We.forEach(this.handlers,function(r){r!==null&&n(r)})}}const cE={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},EG=typeof URLSearchParams<"u"?URLSearchParams:cS,AG=typeof FormData<"u"?FormData:null,PG=typeof Blob<"u"?Blob:null,DG={isBrowser:!0,classes:{URLSearchParams:EG,FormData:AG,Blob:PG},protocols:["http","https","file","blob","url","data"]},uS=typeof window<"u"&&typeof document<"u",Q1=typeof navigator=="object"&&navigator||void 0,IG=uS&&(!Q1||["ReactNative","NativeScript","NS"].indexOf(Q1.product)<0),RG=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",MG=uS&&window.location.href||"http://localhost",OG=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:uS,hasStandardBrowserEnv:IG,hasStandardBrowserWebWorkerEnv:RG,navigator:Q1,origin:MG},Symbol.toStringTag,{value:"Module"})),$i={...OG,...DG};function LG(e,n){return Jb(e,new $i.classes.URLSearchParams,Object.assign({visitor:function(t,r,a,o){return $i.isNode&&We.isBuffer(t)?(this.append(r,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function FG(e){return We.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function $G(e){const n={},t=Object.keys(e);let r;const a=t.length;let o;for(r=0;r<a;r++)o=t[r],n[o]=e[o];return n}function uE(e){function n(t,r,a,o){let l=t[o++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),f=o>=t.length;return l=!l&&We.isArray(a)?a.length:l,f?(We.hasOwnProp(a,l)?a[l]=[a[l],r]:a[l]=r,!d):((!a[l]||!We.isObject(a[l]))&&(a[l]=[]),n(t,r,a[l],o)&&We.isArray(a[l])&&(a[l]=$G(a[l])),!d)}if(We.isFormData(e)&&We.isFunction(e.entries)){const t={};return We.forEachEntry(e,(r,a)=>{n(FG(r),a,t,0)}),t}return null}function zG(e,n,t){if(We.isString(e))try{return(n||JSON.parse)(e),We.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const bg={transitional:cE,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const r=t.getContentType()||"",a=r.indexOf("application/json")>-1,o=We.isObject(n);if(o&&We.isHTMLForm(n)&&(n=new FormData(n)),We.isFormData(n))return a?JSON.stringify(uE(n)):n;if(We.isArrayBuffer(n)||We.isBuffer(n)||We.isStream(n)||We.isFile(n)||We.isBlob(n)||We.isReadableStream(n))return n;if(We.isArrayBufferView(n))return n.buffer;if(We.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return LG(n,this.formSerializer).toString();if((d=We.isFileList(n))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Jb(d?{"files[]":n}:n,f&&new f,this.formSerializer)}}return o||a?(t.setContentType("application/json",!1),zG(n)):n}],transformResponse:[function(n){const t=this.transitional||bg.transitional,r=t&&t.forcedJSONParsing,a=this.responseType==="json";if(We.isResponse(n)||We.isReadableStream(n))return n;if(n&&We.isString(n)&&(r&&!this.responseType||a)){const l=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(n)}catch(d){if(l)throw d.name==="SyntaxError"?Zt.from(d,Zt.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:$i.classes.FormData,Blob:$i.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};We.forEach(["delete","get","head","post","put","patch"],e=>{bg.headers[e]={}});const BG=We.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),UG=e=>{const n={};let t,r,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),t=l.substring(0,a).trim().toLowerCase(),r=l.substring(a+1).trim(),!(!t||n[t]&&BG[t])&&(t==="set-cookie"?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n},D_=Symbol("internals");function Lm(e){return e&&String(e).trim().toLowerCase()}function Kx(e){return e===!1||e==null?e:We.isArray(e)?e.map(Kx):String(e)}function qG(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}const VG=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function M0(e,n,t,r,a){if(We.isFunction(r))return r.call(this,n,t);if(a&&(n=t),!!We.isString(n)){if(We.isString(r))return n.indexOf(r)!==-1;if(We.isRegExp(r))return r.test(n)}}function HG(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}function GG(e,n){const t=We.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(a,o,l){return this[r].call(this,n,a,o,l)},configurable:!0})})}let Sa=class{constructor(n){n&&this.set(n)}set(n,t,r){const a=this;function o(d,f,u){const h=Lm(f);if(!h)throw new Error("header name must be a non-empty string");const g=We.findKey(a,h);(!g||a[g]===void 0||u===!0||u===void 0&&a[g]!==!1)&&(a[g||f]=Kx(d))}const l=(d,f)=>We.forEach(d,(u,h)=>o(u,h,f));if(We.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(We.isString(n)&&(n=n.trim())&&!VG(n))l(UG(n),t);else if(We.isHeaders(n))for(const[d,f]of n.entries())o(f,d,r);else n!=null&&o(t,n,r);return this}get(n,t){if(n=Lm(n),n){const r=We.findKey(this,n);if(r){const a=this[r];if(!t)return a;if(t===!0)return qG(a);if(We.isFunction(t))return t.call(this,a,r);if(We.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=Lm(n),n){const r=We.findKey(this,n);return!!(r&&this[r]!==void 0&&(!t||M0(this,this[r],r,t)))}return!1}delete(n,t){const r=this;let a=!1;function o(l){if(l=Lm(l),l){const d=We.findKey(r,l);d&&(!t||M0(r,r[d],d,t))&&(delete r[d],a=!0)}}return We.isArray(n)?n.forEach(o):o(n),a}clear(n){const t=Object.keys(this);let r=t.length,a=!1;for(;r--;){const o=t[r];(!n||M0(this,this[o],o,n,!0))&&(delete this[o],a=!0)}return a}normalize(n){const t=this,r={};return We.forEach(this,(a,o)=>{const l=We.findKey(r,o);if(l){t[l]=Kx(a),delete t[o];return}const d=n?HG(o):String(o).trim();d!==o&&delete t[o],t[d]=Kx(a),r[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return We.forEach(this,(r,a)=>{r!=null&&r!==!1&&(t[a]=n&&We.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(a=>r.set(a)),r}static accessor(n){const r=(this[D_]=this[D_]={accessors:{}}).accessors,a=this.prototype;function o(l){const d=Lm(l);r[d]||(GG(a,l),r[d]=!0)}return We.isArray(n)?n.forEach(o):o(n),this}};Sa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);We.reduceDescriptors(Sa.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[t]=r}}});We.freezeMethods(Sa);function O0(e,n){const t=this||bg,r=n||t,a=Sa.from(r.headers);let o=r.data;return We.forEach(e,function(d){o=d.call(t,o,a.normalize(),n?n.status:void 0)}),a.normalize(),o}function dE(e){return!!(e&&e.__CANCEL__)}function ap(e,n,t){Zt.call(this,e??"canceled",Zt.ERR_CANCELED,n,t),this.name="CanceledError"}We.inherits(ap,Zt,{__CANCEL__:!0});function fE(e,n,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):n(new Zt("Request failed with status code "+t.status,[Zt.ERR_BAD_REQUEST,Zt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function YG(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function WG(e,n){e=e||10;const t=new Array(e),r=new Array(e);let a=0,o=0,l;return n=n!==void 0?n:1e3,function(f){const u=Date.now(),h=r[o];l||(l=u),t[a]=f,r[a]=u;let g=o,b=0;for(;g!==a;)b+=t[g++],g=g%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),u-l<n)return;const v=h&&u-h;return v?Math.round(b*1e3/v):void 0}}function QG(e,n){let t=0,r=1e3/n,a,o;const l=(u,h=Date.now())=>{t=h,a=null,o&&(clearTimeout(o),o=null),e.apply(null,u)};return[(...u)=>{const h=Date.now(),g=h-t;g>=r?l(u,h):(a=u,o||(o=setTimeout(()=>{o=null,l(a)},r-g)))},()=>a&&l(a)]}const yb=(e,n,t=3)=>{let r=0;const a=WG(50,250);return QG(o=>{const l=o.loaded,d=o.lengthComputable?o.total:void 0,f=l-r,u=a(f),h=l<=d;r=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:u||void 0,estimated:u&&d&&h?(d-l)/u:void 0,event:o,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(g)},t)},I_=(e,n)=>{const t=e!=null;return[r=>n[0]({lengthComputable:t,total:e,loaded:r}),n[1]]},R_=e=>(...n)=>We.asap(()=>e(...n)),JG=$i.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,$i.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL($i.origin),$i.navigator&&/(msie|trident)/i.test($i.navigator.userAgent)):()=>!0,KG=$i.hasStandardBrowserEnv?{write(e,n,t,r,a,o){const l=[e+"="+encodeURIComponent(n)];We.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),We.isString(r)&&l.push("path="+r),We.isString(a)&&l.push("domain="+a),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function XG(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function ZG(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function hE(e,n,t){let r=!XG(n);return e&&(r||t==!1)?ZG(e,n):n}const M_=e=>e instanceof Sa?{...e}:e;function Zd(e,n){n=n||{};const t={};function r(u,h,g,b){return We.isPlainObject(u)&&We.isPlainObject(h)?We.merge.call({caseless:b},u,h):We.isPlainObject(h)?We.merge({},h):We.isArray(h)?h.slice():h}function a(u,h,g,b){if(We.isUndefined(h)){if(!We.isUndefined(u))return r(void 0,u,g,b)}else return r(u,h,g,b)}function o(u,h){if(!We.isUndefined(h))return r(void 0,h)}function l(u,h){if(We.isUndefined(h)){if(!We.isUndefined(u))return r(void 0,u)}else return r(void 0,h)}function d(u,h,g){if(g in n)return r(u,h);if(g in e)return r(void 0,u)}const f={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(u,h,g)=>a(M_(u),M_(h),g,!0)};return We.forEach(Object.keys(Object.assign({},e,n)),function(h){const g=f[h]||a,b=g(e[h],n[h],h);We.isUndefined(b)&&g!==d||(t[h]=b)}),t}const pE=e=>{const n=Zd({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:o,headers:l,auth:d}=n;n.headers=l=Sa.from(l),n.url=lE(hE(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let f;if(We.isFormData(t)){if($i.hasStandardBrowserEnv||$i.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((f=l.getContentType())!==!1){const[u,...h]=f?f.split(";").map(g=>g.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...h].join("; "))}}if($i.hasStandardBrowserEnv&&(r&&We.isFunction(r)&&(r=r(n)),r||r!==!1&&JG(n.url))){const u=a&&o&&KG.read(o);u&&l.set(a,u)}return n},eY=typeof XMLHttpRequest<"u",tY=eY&&function(e){return new Promise(function(t,r){const a=pE(e);let o=a.data;const l=Sa.from(a.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:u}=a,h,g,b,v,S;function k(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let T=new XMLHttpRequest;T.open(a.method.toUpperCase(),a.url,!0),T.timeout=a.timeout;function P(){if(!T)return;const I=Sa.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),F={data:!d||d==="text"||d==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:I,config:e,request:T};fE(function(U){t(U),k()},function(U){r(U),k()},F),T=null}"onloadend"in T?T.onloadend=P:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(P)},T.onabort=function(){T&&(r(new Zt("Request aborted",Zt.ECONNABORTED,e,T)),T=null)},T.onerror=function(){r(new Zt("Network Error",Zt.ERR_NETWORK,e,T)),T=null},T.ontimeout=function(){let B=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const F=a.transitional||cE;a.timeoutErrorMessage&&(B=a.timeoutErrorMessage),r(new Zt(B,F.clarifyTimeoutError?Zt.ETIMEDOUT:Zt.ECONNABORTED,e,T)),T=null},o===void 0&&l.setContentType(null),"setRequestHeader"in T&&We.forEach(l.toJSON(),function(B,F){T.setRequestHeader(F,B)}),We.isUndefined(a.withCredentials)||(T.withCredentials=!!a.withCredentials),d&&d!=="json"&&(T.responseType=a.responseType),u&&([b,S]=yb(u,!0),T.addEventListener("progress",b)),f&&T.upload&&([g,v]=yb(f),T.upload.addEventListener("progress",g),T.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(h=I=>{T&&(r(!I||I.type?new ap(null,e,T):I),T.abort(),T=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const R=YG(a.url);if(R&&$i.protocols.indexOf(R)===-1){r(new Zt("Unsupported protocol "+R+":",Zt.ERR_BAD_REQUEST,e));return}T.send(o||null)})},nY=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let r=new AbortController,a;const o=function(u){if(!a){a=!0,d();const h=u instanceof Error?u:this.reason;r.abort(h instanceof Zt?h:new ap(h instanceof Error?h.message:h))}};let l=n&&setTimeout(()=>{l=null,o(new Zt(`timeout ${n} of ms exceeded`,Zt.ETIMEDOUT))},n);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),e=null)};e.forEach(u=>u.addEventListener("abort",o));const{signal:f}=r;return f.unsubscribe=()=>We.asap(d),f}},rY=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let r=0,a;for(;r<t;)a=r+n,yield e.slice(r,a),r=a},iY=async function*(e,n){for await(const t of aY(e))yield*rY(t,n)},aY=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:r}=await n.read();if(t)break;yield r}}finally{await n.cancel()}},O_=(e,n,t,r)=>{const a=iY(e,n);let o=0,l,d=f=>{l||(l=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:u,value:h}=await a.next();if(u){d(),f.close();return}let g=h.byteLength;if(t){let b=o+=g;t(b)}f.enqueue(new Uint8Array(h))}catch(u){throw d(u),u}},cancel(f){return d(f),a.return()}},{highWaterMark:2})},Kb=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",mE=Kb&&typeof ReadableStream=="function",sY=Kb&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),gE=(e,...n)=>{try{return!!e(...n)}catch{return!1}},oY=mE&&gE(()=>{let e=!1;const n=new Request($i.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),L_=64*1024,J1=mE&&gE(()=>We.isReadableStream(new Response("").body)),xb={stream:J1&&(e=>e.body)};Kb&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!xb[n]&&(xb[n]=We.isFunction(e[n])?t=>t[n]():(t,r)=>{throw new Zt(`Response type '${n}' is not supported`,Zt.ERR_NOT_SUPPORT,r)})})})(new Response);const lY=async e=>{if(e==null)return 0;if(We.isBlob(e))return e.size;if(We.isSpecCompliantForm(e))return(await new Request($i.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(We.isArrayBufferView(e)||We.isArrayBuffer(e))return e.byteLength;if(We.isURLSearchParams(e)&&(e=e+""),We.isString(e))return(await sY(e)).byteLength},cY=async(e,n)=>{const t=We.toFiniteNumber(e.getContentLength());return t??lY(n)},uY=Kb&&(async e=>{let{url:n,method:t,data:r,signal:a,cancelToken:o,timeout:l,onDownloadProgress:d,onUploadProgress:f,responseType:u,headers:h,withCredentials:g="same-origin",fetchOptions:b}=pE(e);u=u?(u+"").toLowerCase():"text";let v=nY([a,o&&o.toAbortSignal()],l),S;const k=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let T;try{if(f&&oY&&t!=="get"&&t!=="head"&&(T=await cY(h,r))!==0){let F=new Request(n,{method:"POST",body:r,duplex:"half"}),L;if(We.isFormData(r)&&(L=F.headers.get("content-type"))&&h.setContentType(L),F.body){const[U,H]=I_(T,yb(R_(f)));r=O_(F.body,L_,U,H)}}We.isString(g)||(g=g?"include":"omit");const P="credentials"in Request.prototype;S=new Request(n,{...b,signal:v,method:t.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:P?g:void 0});let R=await fetch(S);const I=J1&&(u==="stream"||u==="response");if(J1&&(d||I&&k)){const F={};["status","statusText","headers"].forEach(K=>{F[K]=R[K]});const L=We.toFiniteNumber(R.headers.get("content-length")),[U,H]=d&&I_(L,yb(R_(d),!0))||[];R=new Response(O_(R.body,L_,U,()=>{H&&H(),k&&k()}),F)}u=u||"text";let B=await xb[We.findKey(xb,u)||"text"](R,e);return!I&&k&&k(),await new Promise((F,L)=>{fE(F,L,{data:B,headers:Sa.from(R.headers),status:R.status,statusText:R.statusText,config:e,request:S})})}catch(P){throw k&&k(),P&&P.name==="TypeError"&&/fetch/i.test(P.message)?Object.assign(new Zt("Network Error",Zt.ERR_NETWORK,e,S),{cause:P.cause||P}):Zt.from(P,P&&P.code,e,S)}}),K1={http:_G,xhr:tY,fetch:uY};We.forEach(K1,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const F_=e=>`- ${e}`,dY=e=>We.isFunction(e)||e===null||e===!1,yE={getAdapter:e=>{e=We.isArray(e)?e:[e];const{length:n}=e;let t,r;const a={};for(let o=0;o<n;o++){t=e[o];let l;if(r=t,!dY(t)&&(r=K1[(l=String(t)).toLowerCase()],r===void 0))throw new Zt(`Unknown adapter '${l}'`);if(r)break;a[l||"#"+o]=r}if(!r){const o=Object.entries(a).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(F_).join(`
`):" "+F_(o[0]):"as no adapter specified";throw new Zt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:K1};function L0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ap(null,e)}function $_(e){return L0(e),e.headers=Sa.from(e.headers),e.data=O0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),yE.getAdapter(e.adapter||bg.adapter)(e).then(function(r){return L0(e),r.data=O0.call(e,e.transformResponse,r),r.headers=Sa.from(r.headers),r},function(r){return dE(r)||(L0(e),r&&r.response&&(r.response.data=O0.call(e,e.transformResponse,r.response),r.response.headers=Sa.from(r.response.headers))),Promise.reject(r)})}const xE="1.8.4",Xb={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Xb[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const z_={};Xb.transitional=function(n,t,r){function a(o,l){return"[Axios v"+xE+"] Transitional option '"+o+"'"+l+(r?". "+r:"")}return(o,l,d)=>{if(n===!1)throw new Zt(a(l," has been removed"+(t?" in "+t:"")),Zt.ERR_DEPRECATED);return t&&!z_[l]&&(z_[l]=!0,console.warn(a(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,d):!0}};Xb.spelling=function(n){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function fY(e,n,t){if(typeof e!="object")throw new Zt("options must be an object",Zt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const o=r[a],l=n[o];if(l){const d=e[o],f=d===void 0||l(d,o,e);if(f!==!0)throw new Zt("option "+o+" must be "+f,Zt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Zt("Unknown option "+o,Zt.ERR_BAD_OPTION)}}const Xx={assertOptions:fY,validators:Xb},ll=Xx.validators;let Gd=class{constructor(n){this.defaults=n,this.interceptors={request:new P_,response:new P_}}async request(n,t){try{return await this._request(n,t)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=Zd(this.defaults,t);const{transitional:r,paramsSerializer:a,headers:o}=t;r!==void 0&&Xx.assertOptions(r,{silentJSONParsing:ll.transitional(ll.boolean),forcedJSONParsing:ll.transitional(ll.boolean),clarifyTimeoutError:ll.transitional(ll.boolean)},!1),a!=null&&(We.isFunction(a)?t.paramsSerializer={serialize:a}:Xx.assertOptions(a,{encode:ll.function,serialize:ll.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Xx.assertOptions(t,{baseUrl:ll.spelling("baseURL"),withXsrfToken:ll.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&We.merge(o.common,o[t.method]);o&&We.forEach(["delete","get","head","post","put","patch","common"],S=>{delete o[S]}),t.headers=Sa.concat(l,o);const d=[];let f=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(f=f&&k.synchronous,d.unshift(k.fulfilled,k.rejected))});const u=[];this.interceptors.response.forEach(function(k){u.push(k.fulfilled,k.rejected)});let h,g=0,b;if(!f){const S=[$_.bind(this),void 0];for(S.unshift.apply(S,d),S.push.apply(S,u),b=S.length,h=Promise.resolve(t);g<b;)h=h.then(S[g++],S[g++]);return h}b=d.length;let v=t;for(g=0;g<b;){const S=d[g++],k=d[g++];try{v=S(v)}catch(T){k.call(this,T);break}}try{h=$_.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,b=u.length;g<b;)h=h.then(u[g++],u[g++]);return h}getUri(n){n=Zd(this.defaults,n);const t=hE(n.baseURL,n.url,n.allowAbsoluteUrls);return lE(t,n.params,n.paramsSerializer)}};We.forEach(["delete","get","head","options"],function(n){Gd.prototype[n]=function(t,r){return this.request(Zd(r||{},{method:n,url:t,data:(r||{}).data}))}});We.forEach(["post","put","patch"],function(n){function t(r){return function(o,l,d){return this.request(Zd(d||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}Gd.prototype[n]=t(),Gd.prototype[n+"Form"]=t(!0)});let hY=class bE{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const r=this;this.promise.then(a=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](a);r._listeners=null}),this.promise.then=a=>{let o;const l=new Promise(d=>{r.subscribe(d),o=d}).then(a);return l.cancel=function(){r.unsubscribe(o)},l},n(function(o,l,d){r.reason||(r.reason=new ap(o,l,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=r=>{n.abort(r)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new bE(function(a){n=a}),cancel:n}}};function pY(e){return function(t){return e.apply(null,t)}}function mY(e){return We.isObject(e)&&e.isAxiosError===!0}const X1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(X1).forEach(([e,n])=>{X1[n]=e});function vE(e){const n=new Gd(e),t=KT(Gd.prototype.request,n);return We.extend(t,Gd.prototype,n,{allOwnKeys:!0}),We.extend(t,n,null,{allOwnKeys:!0}),t.create=function(a){return vE(Zd(e,a))},t}const Br=vE(bg);Br.Axios=Gd;Br.CanceledError=ap;Br.CancelToken=hY;Br.isCancel=dE;Br.VERSION=xE;Br.toFormData=Jb;Br.AxiosError=Zt;Br.Cancel=Br.CanceledError;Br.all=function(n){return Promise.all(n)};Br.spread=pY;Br.isAxiosError=mY;Br.mergeConfig=Zd;Br.AxiosHeaders=Sa;Br.formToJSON=e=>uE(We.isHTMLForm(e)?new FormData(e):e);Br.getAdapter=yE.getAdapter;Br.HttpStatusCode=X1;Br.default=Br;const{Axios:cse,AxiosError:use,CanceledError:dse,isCancel:fse,CancelToken:hse,VERSION:pse,all:mse,Cancel:gse,isAxiosError:yse,spread:xse,toFormData:bse,AxiosHeaders:vse,HttpStatusCode:wse,formToJSON:Sse,getAdapter:Nse,mergeConfig:Cse}=Br;function gY(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"screen",start:async()=>{const d=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function yY(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"webcam",start:async()=>{const d=await navigator.mediaDevices.getUserMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class xY extends WT{constructor(t){super();nr(this,"client");nr(this,"_status","disconnected");nr(this,"_session",null);nr(this,"_model",null);nr(this,"config",null);this.client=new kw(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(o){return console.error("Error connecting to GenAI Live:",o),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let o=((r=a.modelTurn)==null?void 0:r.parts)||[];const l=o.filter(h=>{var g;return h.inlineData&&((g=h.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),d=l.map(h=>{var g;return(g=h.inlineData)==null?void 0:g.data}),f=JT.difference(o,l);if(d.forEach(h=>{if(h){const g=PH(h);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!f.length)return;o=f;const u={modelTurn:{parts:o}};this.emit("content",u),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let r=!1,a=!1;for(const d of t)if((l=this.session)==null||l.sendRealtimeInput({media:d}),d.mimeType.includes("audio")&&(r=!0),d.mimeType.includes("image")&&(a=!0),r&&a)break;const o=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",o)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function bY(e){const n=w.useMemo(()=>new xY(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[o,l]=w.useState({}),[d,f]=w.useState(!1),[u,h]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||GT({id:"audio-out"}).then(k=>{t.current=new zH(k),t.current.addWorklet("vumeter-out",YT,T=>{h(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{f(!0)},T=()=>{f(!1)},P=F=>{console.error("error",F)},R=()=>{var F;return(F=t.current)==null?void 0:F.stop()},I=F=>{var L;return(L=t.current)==null?void 0:L.addPCM16(new Uint8Array(F))},B=F=>{if(console.log("Received content event:",F),F.modelTurn&&F.modelTurn.parts){const L=F.modelTurn.parts.filter(U=>"text"in U&&U.text);if(L.length>0){const U=L.map(H=>H.text).join(" ");b(U),console.log("AI Summary received:",U)}}};return n.on("error",P).on("open",k).on("close",T).on("interrupted",R).on("audio",I).on("content",B),()=>{n.off("error",P).off("open",k).off("close",T).off("interrupted",R).off("audio",I).off("content",B).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!o)throw new Error("config has not been set");n.disconnect(),await n.connect(r,o)},[n,o,r]),S=w.useCallback(async()=>{n.disconnect(),f(!1)},[f,n]);return{client:n,config:o,setConfig:l,model:r,setModel:a,connected:d,connect:v,disconnect:S,volume:u,aiSummary:g}}const wE=w.createContext(void 0),vg=({options:e,children:n})=>{const t=bY(e);return i.jsx(wE.Provider,{value:t,children:n})},ju=()=>{const e=w.useContext(wE);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function vY(){const{config:e,setConfig:n}=ju(),[t,r]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(o=>{n({...e,responseModalities:[o==="audio"?bu.AUDIO:bu.TEXT]})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),i.jsx(HT,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:o=>{r(o),o&&(o.value==="audio"||o.value==="text")&&a(o.value)}})]})}const B_=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function wY(){const{config:e,setConfig:n}=ju();w.useEffect(()=>{var d,f,u;const o=((u=(f=(d=e.speechConfig)==null?void 0:d.voiceConfig)==null?void 0:f.prebuiltVoiceConfig)==null?void 0:u.voiceName)||"Atari02";r({value:o,label:o})},[e]);const[t,r]=w.useState(B_[5]),a=w.useCallback(o=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:o}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(HT,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:B_,onChange:o=>{r(o),o&&a(o.value)}})]})}function SY(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=ju(),o=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(u=>Array.isArray(u.functionDeclarations)).map(u=>u.functionDeclarations).filter(u=>!!u).flat():[],[t]),l=w.useMemo(()=>{var u;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(h=>typeof h=="string"?h:h.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((u=t.systemInstruction.parts)==null?void 0:u.map(h=>h.text).join(`
`))||"":""},[t]),d=w.useCallback(u=>{const h={...t,systemInstruction:u.target.value};r(h)},[t,r]),f=w.useCallback((u,h)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===u?{...k,description:h}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsxs("div",{className:"mode-selectors",children:[i.jsx(vY,{}),i.jsx(wY,{})]}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:d,value:l}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:o.map((u,h)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:u.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=u.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:u.description,onBlur:b=>f(u.name,b.target.value)},`fd-${u.description}`)]},`function-${h}`)})})})]})})]})}const U_=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function NY({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const o=[yY(),gY()],[l,d]=w.useState(null),[f,u]=o,[h,g]=w.useState(0),[b]=w.useState(()=>new QT),[v,S]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:P,connected:R,connect:I,disconnect:B,volume:F}=ju();w.useEffect(()=>{!R&&T.current&&T.current.focus()},[R]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(h*200,8))}px`)},[h]),w.useEffect(()=>{const U=H=>{P.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:H}])};return R&&!v&&b?b.on("data",U).on("volume",g).start():b.stop(),()=>{b.off("data",U).off("volume",g)}},[R,P,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let U=-1;function H(){const K=e.current,M=k.current;if(!K||!M)return;const $=M.getContext("2d");if(M.width=K.videoWidth*.25,M.height=K.videoHeight*.25,M.width+M.height>0){$.drawImage(K,0,0,M.width,M.height);const z=M.toDataURL("image/jpeg",1),W=z.slice(z.indexOf(",")+1,1/0);P.sendRealtimeInput([{mimeType:"image/jpeg",data:W}])}R&&(U=window.setTimeout(H,1e3/.5))}return R&&l!==null&&requestAnimationFrame(H),()=>{clearTimeout(U)}},[R,l,P,e]);const L=U=>async()=>{if(U){const H=await U.start();d(H),t(H)}else d(null),t(null);o.filter(H=>H!==U).forEach(H=>H.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:xu("actions-nav",{disabled:!R}),children:[i.jsx("button",{className:xu("action-button mic-button",{recording:!v&&R}),onClick:()=>S(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(LH,{volume:F,active:R,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(U_,{isStreaming:u.isStreaming,start:L(u),stop:L(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(U_,{isStreaming:f.isStreaming,start:L(f),stop:L(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:xu("connection-container",{connected:R}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:T,className:xu("action-button connect-toggle",{connected:R}),onClick:R?B:I,children:i.jsx("span",{className:"material-symbols-outlined filled",children:R?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(SY,{}):""]})}const q_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Vh.OBJECT,properties:{summary:{type:Vh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},CY=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:o,setModel:l}=ju();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),o({responseModalities:[bu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[q_]}]})},[o,l]),w.useEffect(()=>{const d=f=>{if(!f.functionCalls)return;const u=f.functionCalls.find(h=>h.name===q_.name);if(u){const h=u.args.summary;r(h)}f.functionCalls.length&&setTimeout(()=>{var h;return a.sendToolResponse({functionResponses:(h=f.functionCalls)==null?void 0:h.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",d),()=>{a.off("toolcall",d)}},[a]),w.useEffect(()=>{if(t){const d=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${d}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${d}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})},V_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes";async function _Y(){const e=Tw();if(!e)return console.warn("No auth token found, using default Live API key."),V_;try{const t=(await Br.get("/api/clinics/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).data.geminiApiKey;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Live API key:",n)}return console.warn("Clinic-specific Live API key not found or failed to fetch, using default."),V_}function jY(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await _Y();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(vg,{options:r,children:i.jsx(kY,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const kY=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[o,l]=w.useState(null),{connected:d,client:f,connect:u,config:h,model:g}=ju(),[b,v]=w.useState(""),S=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const R=window.matchMedia("(prefers-color-scheme: dark)"),I=B=>{document.documentElement.setAttribute("data-theme",B.matches?"dark":"light")};return I(R),R.addEventListener("change",I),()=>R.removeEventListener("change",I)},[]),w.useEffect(()=>{const R=new URLSearchParams(window.location.search),I={};for(const[B,F]of R.entries())B==="token_number"?l(F):I[B]=F;a(I)},[]),w.useEffect(()=>{Object.keys(h).length>0&&g&&u()},[u,h,g]),w.useEffect(()=>{if(d&&r&&!k){const R=JSON.stringify(r,null,2);f.send([{text:R}]),v(""),T(!0)}},[d,r,f,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const P=()=>{f.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(CY,{patientData:r,tokenNumber:o}),i.jsx("video",{className:xu("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:xu("input-container",{disabled:!d}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:S,onKeyDown:R=>{R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),R.stopPropagation(),P())},onChange:R=>v(R.target.value),value:b}),i.jsx("span",{className:xu("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:P,children:"send"})]})}),i.jsx(NY,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},H_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",TY=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},EY=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},o)=>{var L;const{connected:l,connect:d,disconnect:f,client:u,volume:h}=ju(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P]=w.useState(()=>new QT),R=async()=>{l?await f():(await d(),r.trim()&&a())};w.useEffect(()=>{const U=H=>{u.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:H}])};return l&&!g?P.on("data",U).start():P.stop(),()=>{P.off("data",U),P.stop()}},[l,u,g,P]);const I=w.useCallback(async()=>{if(v)F==null||F.getTracks().forEach(U=>U.stop()),t(null),S(!1);else try{const U=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=U),t(U),S(!0)}catch(U){console.error("Error accessing webcam:",U),S(!1)}},[v,t,e]),B=w.useCallback(async()=>{if(k)F==null||F.getTracks().forEach(U=>U.stop()),t(null),T(!1);else try{const U=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=U),t(U),T(!0)}catch(U){console.error("Error accessing screen share:",U),T(!1)}},[k,t,e]),F=(L=e.current)==null?void 0:L.srcObject;return w.useEffect(()=>()=>{F&&F.getTracks().forEach(U=>U.stop())},[F]),w.useImperativeHandle(o,()=>({handleConnect:R})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx($6,{className:"w-5 h-5"}):i.jsx(fg,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(TY,{volume:h,active:l})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:B,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(V6,{className:"w-5 h-5"})}),i.jsx("button",{onClick:I,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(zF,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:R,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx(J6,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(nF,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),AY=({tokenNumber:e,aiSummary:n,clinicName:t})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:t.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[t," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",t," Reception Assistant"]})]}),e&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:e})]}),n&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:n})]})]}),G_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Vh.OBJECT,properties:{summary:{type:Vh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},PY=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a,voiceAiLanguage:o})=>{const l=w.useRef(null),d=w.useRef(null),[f,u]=w.useState(null),[h,g]=w.useState("hi"),{client:b,connected:v,setConfig:S,setModel:k,disconnect:T,connect:P}=ju(),R=w.useMemo(()=>{let H=`Your job is to:

If patient details like name, age, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (Name, Age) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's Name and Age only. Do not ask for their phone number.

    You should guess the patient's sex based on their voice or appearance.

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception.`;n&&(H+=`

Patient Data: ${JSON.stringify(n,null,2)}`);const M={"en-US":"English","hi-IN":"Hindi","te-IN":"Telugu","bn-IN":"Bengali","mr-IN":"Marathi","ta-IN":"Tamil","gu-IN":"Gujarati","kn-IN":"Kannada","ml-IN":"Malayalam","pa-IN":"Punjabi","es-ES":"Spanish","fr-FR":"French","de-DE":"German","it-IT":"Italian","pt-PT":"Portuguese","ru-RU":"Russian","ja-JP":"Japanese","ko-KR":"Korean","zh-CN":"Chinese","ar-SA":"Arabic"}[o]||"English";return H+=` You should always speak in ${M}.`,o==="te-IN"&&(H+=" Dont write the telugu words in english."),{responseModalities:[bu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:H}]},tools:[{functionDeclarations:[G_]}]}},[n,o]);w.useEffect(()=>{k("models/gemini-2.5-flash-native-audio-preview-12-2025"),S(R);const H=setTimeout(()=>{d.current&&!v&&d.current.handleConnect()},2e3);return()=>clearTimeout(H)},[S,k,R,v]),w.useEffect(()=>()=>{v&&T()},[v,T]);const[I,B]=w.useState(null);w.useEffect(()=>{const H=K=>{if(!K.functionCalls)return;const M=K.functionCalls.find($=>$.name===G_.name);if(M){const $=M.args.summary;B($),r($)}K.functionCalls.length&&setTimeout(()=>{var $;return b.sendToolResponse({functionResponses:($=K.functionCalls)==null?void 0:$.map(z=>({response:{output:{success:!0}},id:z.id,name:z.name}))})},200)};return b.on("toolcall",H),()=>{b.off("toolcall",H)}},[b,r]);const F=()=>{h.trim()&&(b.send([{text:h}]),g(""))},L=H=>{H.key==="Enter"&&!H.shiftKey&&(H.preventDefault(),F())},U=async()=>{B(null),r(null),g("hi"),v?(T(),setTimeout(()=>{P()},500)):P()};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:U,className:"live-api-modal-close-button",title:"Refresh Session","aria-label":"Refresh session",children:i.jsx(Yk,{className:"w-6 h-6"})}),i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(Sn,{className:"w-6 h-6"})})]})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(AY,{patientData:n,tokenNumber:t,aiSummary:I,clinicName:a}),f&&i.jsx("video",{ref:l,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:h,onChange:H=>g(H.target.value),onKeyDown:L,placeholder:"Type your message here...",disabled:!v,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:F,disabled:!v||!h.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(Mb,{className:"w-5 h-5"})})]})}),i.jsx(EY,{ref:d,videoRef:l,supportsVideo:!0,onVideoStreamChange:u,textInput:h,onSubmitTextInput:F})]})})]})})},Zb=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,o]=w.useState(null),[l,d]=w.useState("Newtons Ai"),[f,u]=w.useState("en-US"),[h,g]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{let S=null,k="Newtons Ai",T="en-US";try{const P=await me("/api/clinics/settings");if(P.ok){const R=await P.json();R.name&&R.name!==""&&(k=R.name),R.gemini_api_key&&R.gemini_api_key.trim()!==""&&(S=R.gemini_api_key.trim()),R.voice_ai_language&&(T=R.voice_ai_language)}}catch(P){console.warn("Failed to fetch clinic settings",P)}if(d(k),u(T),S)o(S);else{try{const P=await me("/api/global-settings/app_gemini_api_key");if(P.ok){const R=await P.json();if(R.value&&R.value.trim()!==""){o(R.value.trim());return}}}catch(P){console.warn("Failed to fetch global key fallback",P)}o(H_)}}catch(S){console.error("Unexpected error in getSettings:",S),o(H_)}finally{g(!1)}})()},[]),h)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",style:{maxHeight:"200px",maxWidth:"400px",borderRadius:"1rem",justifyContent:"center"},children:i.jsxs("div",{className:"live-api-loading-container",children:[i.jsx("div",{className:"live-api-loading-spinner"}),i.jsx("div",{className:"live-api-loading-text",children:"Initializing AI Assistant..."})]})})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const b={apiKey:a};return i.jsx(vg,{options:b,children:i.jsx(PY,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:l,voiceAiLanguage:f})})},DY="_overlay_79cew_5",IY="_overlayMinimized_79cew_55",RY="_modal_79cew_65",MY="_minimized_79cew_97",OY="_contentWrapper_79cew_113",LY="_exiting_79cew_161",FY="_header_79cew_183",$Y="_inputWrapper_79cew_197",zY="_inputContainer_79cew_215",BY="_minimizedSearchIcon_79cew_273",UY="_input_79cew_197",qY="_controlsGroup_79cew_347",VY="_iconButton_79cew_373",HY="_sendButton_79cew_413",GY="_dragBar_79cew_459",YY="_dragBarTitle_79cew_489",WY="_dragBarControls_79cew_519",QY="_dragBarControlsRight_79cew_537",JY="_newChatBtn_79cew_553",KY="_windowControlBtn_79cew_589",XY="_content_79cew_113",ZY="_overlayContent_79cew_687",eW="_section_79cew_711",tW="_sectionTitle_79cew_723",nW="_recentList_79cew_743",rW="_recentPill_79cew_767",iW="_recentName_79cew_807",aW="_recentToken_79cew_819",sW="_recentInfo_79cew_837",oW="_examplesGrid_79cew_849",lW="_exampleCard_79cew_861",cW="_exampleIcon_79cew_897",uW="_exampleText_79cew_905",dW="_chatSectionFill_79cew_919",fW="_chatMessagesFill_79cew_935",hW="_chatBubble_79cew_955",pW="_chatBubbleUser_79cew_975",mW="_chatBubbleModel_79cew_991",gW="_chatBubbleSystem_79cew_1009",yW="_processing_79cew_1025",xW="_spinner_79cew_1043",bW="_resultItem_79cew_1065",vW="_resultName_79cew_1093",wW="_resultToken_79cew_1103",SW="_resultDetails_79cew_1115",NW="_noResults_79cew_1125",St={overlay:DY,overlayMinimized:IY,modal:RY,minimized:MY,contentWrapper:OY,exiting:LY,header:FY,inputWrapper:$Y,inputContainer:zY,minimizedSearchIcon:BY,input:UY,controlsGroup:qY,iconButton:VY,sendButton:HY,dragBar:GY,dragBarTitle:YY,dragBarControls:WY,dragBarControlsRight:QY,newChatBtn:JY,windowControlBtn:KY,content:XY,overlayContent:ZY,section:eW,sectionTitle:tW,recentList:nW,recentPill:rW,recentName:iW,recentToken:aW,recentInfo:sW,examplesGrid:oW,exampleCard:lW,exampleIcon:cW,exampleText:uW,chatSectionFill:dW,chatMessagesFill:fW,chatBubble:hW,chatBubbleUser:pW,chatBubbleModel:mW,chatBubbleSystem:gW,processing:yW,spinner:xW,resultItem:bW,resultName:vW,resultToken:wW,resultDetails:SW,noResults:NW},SE="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",CW={apiKey:SE},F0=[{name:"Dashboard",path:"/dashboard",icon:i.jsx(k6,{size:16}),keywords:["home","main","analytics","stats"],roles:["all"]},{name:"Clinic Hub",path:"/dashboard/clinic-hub",icon:i.jsx(KN,{size:16}),keywords:["central","hub","overview"],roles:["admin","superadmin"]},{name:"Analysis Dashboard",path:"/dashboard/analysis",icon:i.jsx(KN,{size:16}),keywords:["reports","stats","finance","money"],roles:["admin","superadmin"]},{name:"Live AI Assistant",path:"/live-api",icon:i.jsx(rb,{size:16}),keywords:["ai","chat","voice","assistant"],roles:["all"]},{name:"Patient Search",path:"/dashboard/search-patient",icon:i.jsx(Pr,{size:16}),keywords:["find","lookup","patient"],roles:["all"]},{name:"All Patients",path:"/dashboard/all-patients",icon:i.jsx(ep,{size:16}),keywords:["list","records","database"],roles:["admin","receptionist","doctor"]},{name:"Add New Patient",path:"/dashboard/add-patient",icon:i.jsx(Iw,{size:16}),keywords:["register","new","create","onboard"],roles:["admin","receptionist","doctor"]},{name:"Admissions",path:"/manage-admission",icon:i.jsx(U3,{size:16}),keywords:["ipd","admit","discharge","rooms"],roles:["admin","doctor","receptionist"]},{name:"Pharmacy Inventory",path:"/dashboard/inventory",icon:i.jsx(Qd,{size:16}),keywords:["drugs","medicine","stock","pharmacy"],roles:["admin","pharmacy"]},{name:"Add New Drug",path:"/dashboard/inventory/add",icon:i.jsx(Qd,{size:16}),keywords:["create","medicine","stock"],roles:["admin","pharmacy"]},{name:"Add Pharmacy Order",path:"/dashboard/add-order",icon:i.jsx(k1,{size:16}),keywords:["sell","bill","dispense"],roles:["admin","pharmacy"]},{name:"Refill Reminders",path:"/refill-reminders",icon:i.jsx(vu,{size:16}),keywords:["recurring","sms","alert"],roles:["admin","pharmacy"]},{name:"Distributors",path:"/dashboard/distributors",icon:i.jsx(DF,{size:16}),keywords:["suppliers","vendors","stock"],roles:["admin","pharmacy"]},{name:"Purchase",path:"/dashboard/purchase",icon:i.jsx(k1,{size:16}),keywords:["buy","procurement","stock"],roles:["admin","pharmacy"]},{name:"Create Lab Order",path:"/create-lab-order",icon:i.jsx(po,{size:16}),keywords:["test","pathology","diagnostics"],roles:["admin","doctor","lab"]},{name:"Search Lab Reports",path:"/lab/search-report",icon:i.jsx(Pr,{size:16}),keywords:["results","history","find"],roles:["admin","doctor","lab"]},{name:"Lab Inventory",path:"/lab-inventory",icon:i.jsx(po,{size:16}),keywords:["reagents","tests","stock"],roles:["admin","lab"]},{name:"Create Custom Bill",path:"/create-custom-bill",icon:i.jsx(fo,{size:16}),keywords:["invoice","custom","charge"],roles:["admin","receptionist"]},{name:"Billing History",path:"/billing",icon:i.jsx(Bk,{size:16}),keywords:["transactions","payments","history"],roles:["admin"]},{name:"Staff Management",path:"/dashboard/staff",icon:i.jsx(gF,{size:16}),keywords:["users","employees","roles","admin"],roles:["admin","superadmin"]}],_W=[{icon:"",text:"Update Paracetamol stock to 100"},{icon:"",text:"Change CBC Test price to 350"},{icon:"",text:"Set Voice AI language to Hindi"},{icon:"",text:"Show revenue for last month"},{icon:"",text:"Purchase 50 strips of Aspirin"},{icon:"",text:"Update consultation fee to 500"},{icon:"",text:"Add new staff member"},{icon:"",text:"Register: John Doe, 25M, Fever"},{icon:"",text:"Check Metformin availability"}],jW=({user:e})=>{const{isOpen:n,closeCommandBar:t}=Uh(),r=Dt(),a=Ur(),o=w.useRef(null),[l,d]=w.useState(""),[f,u]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState([]),[S,k]=w.useState(!1),[T,P]=w.useState(!0),[R,I]=w.useState(!1),[B,F]=w.useState(null),[L,U]=w.useState(!1),[H,K]=w.useState(!1),[M,$]=w.useState(!1);w.useEffect(()=>{if(n)K(!0),$(!1);else{$(!0);const be=setTimeout(()=>{K(!1),$(!1)},200);return()=>clearTimeout(be)}},[n]);const{setPageContext:z}=Tb();w.useEffect(()=>{if(n){const be=a.pathname,$e=F0.find(nt=>nt.path===be)||F0.find(nt=>be.startsWith(nt.path)&&nt.path!=="/dashboard");z($e?{name:$e.name,path:be,data:{role:$e.roles}}:{name:"Current Page",path:be})}},[n,a.pathname,z]);const W=Ew({settings:{},staffList:[]}),{selectedImage:te,handleImageSelect:V,clearImage:G}=W,J=w.useRef(null),oe=be=>{var nt;const $e=(nt=be.target.files)==null?void 0:nt[0];$e&&V($e)},[ie,E]=w.useState({x:0,y:0}),[ce,ge]=w.useState(!1),D=w.useRef({x:0,y:0}),pe=w.useRef({x:0,y:0}),Ce=w.useRef(!1),Z=w.useRef(null);w.useEffect(()=>{const be=nt=>{if(!ce)return;Ce.current=!0;const ht=nt.clientX-D.current.x,wt=nt.clientY-D.current.y;let Et=pe.current.x+ht,ve=pe.current.y+wt;if(Z.current){const ke=Z.current.offsetWidth,Ne=Z.current.offsetHeight,Oe=(window.innerWidth-ke)/2,Ve=(window.innerHeight-Ne)/2,Ze=Math.max(0,Oe),jt=Math.max(0,Ve);Et=Math.max(-Ze,Math.min(Ze,Et)),ve=Math.max(-jt,Math.min(jt,ve))}E({x:Et,y:ve})},$e=()=>{ge(!1)};return ce&&(window.addEventListener("mousemove",be),window.addEventListener("mouseup",$e)),()=>{window.removeEventListener("mousemove",be),window.removeEventListener("mouseup",$e)}},[ce]);const ee=be=>{be.target.closest("input, button, .lucide")||(ge(!0),Ce.current=!1,D.current={x:be.clientX,y:be.clientY},pe.current={...ie})};w.useEffect(()=>{n&&U(!0)},[a.pathname]),w.useEffect(()=>{(h.length>0||b.length>0)&&L&&U(!1)},[h,b]),w.useEffect(()=>{if(n&&window.innerWidth<=768){window.history.pushState({commandBarOpen:!0},"");const be=$e=>{$e.preventDefault(),U(!0)};return window.addEventListener("popstate",be),()=>{window.removeEventListener("popstate",be)}}},[n]),w.useEffect(()=>{L||E({x:0,y:0})},[L]),w.useEffect(()=>{W.setChatQuery(l)},[l]),w.useEffect(()=>{n&&o.current&&o.current.focus()},[n]),w.useEffect(()=>{if(!n||L||!(window.innerWidth<=768))return;const $e=window.scrollY,nt=document.body.style.overflow,ht=document.documentElement.style.overflow,wt=document.body.style.position,Et=document.body.style.top,ve=document.body.style.width;return document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${$e}px`,document.body.style.width="100%",()=>{document.documentElement.style.overflow=ht,document.body.style.overflow=nt,document.body.style.position=wt,document.body.style.top=Et,document.body.style.width=ve,window.scrollTo(0,$e)}},[n,L]);const X=be=>{!be.trim()&&!te||(U(!1),W.handleSendMessage(be),d(""),g([]),v([]))},{preFilledQuery:ye,setPreFilledQuery:He}=Uh();w.useEffect(()=>{n&&ye&&(d(ye),setTimeout(()=>{X(ye),He("")},300))},[n,ye,He]),w.useEffect(()=>{B&&(d(B),I(!1),setTimeout(()=>X(B),50),F(null))},[B]);const he=()=>{I(!0)},Le=()=>{d(""),g([]),v([]),W.refreshChat(),o.current&&o.current.focus()};w.useEffect(()=>{n&&(async()=>{try{const $e=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),nt=await me(`/api/patients?${$e.toString()}`);if(nt.ok){const ht=await nt.json();u(ht.patients||[])}}catch($e){console.error("Error fetching recent patients:",$e)}})()},[n]);const ue=w.useMemo(()=>gg(async be=>{const $e=be.trim(),nt=/^\d+$/.test($e),ht=$e.split(/\s+/).length;if($e.length>1){const wt=$e.toLowerCase(),Et=F0.filter(ve=>{if(!(ve.name.toLowerCase().includes(wt)||ve.keywords.some(Oe=>Oe.toLowerCase().includes(wt))))return!1;if(!e)return!0;const Ne=e.role;return ve.roles.includes("all")||ve.roles.includes(Ne)});v(Et)}else v([]);if($e.length<2||nt&&$e.length>10||!nt&&ht>3){g([]),k(!1);return}k(!0);try{const wt=new URLSearchParams({search:encodeURIComponent(be),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Et=await me(`/api/patients?${wt.toString()}`);if(Et.ok){const ve=await Et.json();g(ve.patients||[])}}catch(wt){console.error("Search error:",wt)}finally{k(!1)}},300),[e]),De=be=>{const $e=be.target.value;d($e),ue($e)},Ye=be=>{be.id&&r(`/dashboard/edit-complaint/patient/${be.id}`)},et=be=>{r(be.path)},Ke=be=>{d(be),setTimeout(()=>X(be),50)},it=be=>{l.trim()&&X(l)},ot=be=>{be.key==="Enter"&&!be.shiftKey&&(be.preventDefault(),it())},vt=be=>{be.target===be.currentTarget&&t()};if(!n&&!H)return null;const Ee=(h.length>0||b.length>0)&&!S,Je=l.length===0&&h.length===0&&b.length===0,Ae=l.length>=3&&h.length===0&&b.length===0&&!S,_e=W.chatHistory.length>0||W.isProcessing,le=!_e||Ee,q=_e&&Ee,de=_e&&!T&&!L&&!Ee;return i.jsxs("div",{className:`${St.overlay} ${L?St.overlayMinimized:""} ${M?St.exiting:""}`,onClick:vt,children:[i.jsxs("div",{ref:Z,className:`${St.modal} ${L?St.minimized:""} ${de?St.collapsed:""} ${M?St.exiting:""}`,style:{transform:`translate(${ie.x}px, ${ie.y}px)`,height:de?"auto":void 0},onClick:()=>{Ce.current||(L?U(!1):de&&P(!0))},children:[i.jsxs("div",{className:St.dragBar,onMouseDown:ee,onDoubleClick:()=>!L&&U(!L),children:[i.jsxs("div",{className:St.dragBarControls,children:[i.jsx("button",{className:St.windowControlBtn,onClick:t,title:"Close",children:i.jsx(Sn,{size:24,color:"#64748b"})}),i.jsx("button",{className:St.windowControlBtn,onClick:()=>U(!L),title:L?"Maximize":"Minimize",children:L?i.jsx(L6,{size:24,color:"#64748b"}):i.jsx(U6,{size:24,color:"#64748b"})})]}),i.jsx("div",{className:St.dragBarTitle,children:_e?i.jsxs(i.Fragment,{children:[i.jsx(rb,{size:14,className:"text-violet-600"}),i.jsx("span",{children:"AI Assistant"})]}):Ee?i.jsxs(i.Fragment,{children:[i.jsx(Pr,{size:14,className:"text-blue-500"}),i.jsx("span",{children:"Search Results"})]}):i.jsx("span",{style:{opacity:.5,fontWeight:500},children:"Command Bar"})}),i.jsx("div",{className:St.dragBarControlsRight,children:i.jsx("button",{className:St.newChatBtn,onClick:Le,title:"New Chat",children:i.jsx(yl,{size:20})})})]}),i.jsxs("div",{className:St.contentWrapper,children:[_e&&i.jsx("div",{className:St.chatSectionFill,children:i.jsxs("div",{className:St.chatMessagesFill,children:[W.chatHistory.map((be,$e)=>i.jsx("div",{className:`${St.chatBubble} ${be.role==="user"?St.chatBubbleUser:be.role==="model"?St.chatBubbleModel:St.chatBubbleSystem}`,children:be.role==="model"?i.jsx(Wa,{remarkPlugins:[Li],children:be.text}):be.text},$e)),W.isProcessing&&i.jsxs("div",{className:St.processing,children:[i.jsx(mo,{size:14,className:St.spinner}),"Thinking..."]})]})}),le&&i.jsxs("div",{className:q?St.overlayContent:St.content,children:[f.length>0&&Je&&!_e&&i.jsxs("div",{className:St.section,children:[i.jsx("div",{className:St.sectionTitle,children:"Newly Registered"}),i.jsx("div",{className:St.recentList,children:f.map(be=>i.jsxs("div",{className:St.recentPill,onClick:()=>Ye(be),children:[i.jsx("span",{className:St.recentName,children:be.name||"Patient"}),i.jsxs("span",{className:St.recentToken,children:["#",be.token]}),i.jsxs("span",{className:St.recentInfo,children:[be.age?`${be.age}y`:""," ",be.gender||""]})]},be.id))})]}),Je&&!_e&&i.jsxs("div",{className:St.section,children:[i.jsx("div",{className:St.sectionTitle,children:"Quick Commands"}),i.jsx("div",{className:St.examplesGrid,children:_W.map((be,$e)=>i.jsxs("div",{className:St.exampleCard,onClick:()=>Ke(be.text),children:[i.jsx("span",{className:St.exampleIcon,children:be.icon}),i.jsx("span",{className:St.exampleText,children:be.text})]},$e))})]}),S&&i.jsx("div",{className:St.section,children:i.jsxs("div",{className:St.processing,children:[i.jsx(mo,{size:16,className:St.spinner}),"Searching..."]})}),b.length>0&&!S&&i.jsxs("div",{className:St.section,children:[i.jsx("div",{className:St.sectionTitle,children:"Pages Found"}),i.jsx("div",{className:St.resultsList,children:b.map((be,$e)=>i.jsxs("div",{className:St.resultItem,onClick:()=>et(be),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsx("span",{style:{color:"#7c3aed"},children:be.icon}),i.jsx("span",{className:St.resultName,children:be.name})]}),i.jsx("span",{className:St.resultDetails,style:{fontSize:"0.7rem"},children:"Jump to page"})]},$e))})]}),Ee&&h.length>0&&i.jsxs("div",{className:St.section,children:[i.jsx("div",{className:St.sectionTitle,children:"Patients Found"}),i.jsx("div",{className:St.resultsList,children:h.map(be=>i.jsxs("div",{className:St.resultItem,onClick:()=>Ye(be),children:[i.jsxs("div",{children:[i.jsxs("span",{className:St.resultToken,children:["[#",be.token,"]"]}),i.jsx("span",{className:St.resultName,children:be.name})]}),i.jsxs("span",{className:St.resultDetails,children:[be.age?`${be.age} yrs`:"",be.age&&be.gender?" / ":"",be.gender||""]})]},be.id))})]}),Ae&&!_e&&i.jsx("div",{className:St.section,children:i.jsxs("div",{className:St.noResults,children:["Press ",i.jsx("strong",{children:"Enter"}),' to send "',l,'" to AI Assistant']})})]})]}),i.jsx("div",{className:St.header,children:i.jsxs("div",{className:St.inputWrapper,children:[i.jsxs("div",{className:St.inputContainer,children:[i.jsx("div",{className:St.minimizedSearchIcon,children:i.jsx(Pr,{size:24})}),i.jsx("textarea",{ref:be=>{o.current=be,be&&(be.style.height="auto",be.style.height=Math.min(be.scrollHeight,150)+"px")},className:St.input,placeholder:L?"Type here...":"Search (Name/Token/Phone), Ask AI, or Enter New Case (Name Age Sex Complaint)...",value:l,onChange:be=>{De(be),be.target.style.height="auto",be.target.style.height=Math.min(be.target.scrollHeight,150)+"px"},onKeyDown:ot,onFocus:be=>{be.target.scrollIntoView=()=>{},setTimeout(()=>{Z.current&&(Z.current.scrollTop=Z.current.scrollHeight)},100)},rows:1,disabled:W.isProcessing}),te&&i.jsxs("div",{style:{position:"relative",marginRight:"0.5rem"},children:[i.jsx("img",{src:te,alt:"Selected",style:{width:"24px",height:"24px",objectFit:"cover",borderRadius:"4px",border:"1px solid #e2e8f0"}}),i.jsx("button",{onClick:G,style:{position:"absolute",top:-4,right:-4,background:"rgba(0,0,0,0.6)",color:"white",border:"none",borderRadius:"50%",padding:"1px",cursor:"pointer",display:"flex"},children:i.jsx(Sn,{size:8})})]}),i.jsxs("div",{className:St.controlsGroup,children:[i.jsx("button",{className:St.iconButton,onClick:()=>{var be;return(be=J.current)==null?void 0:be.click()},title:"Attach Image",children:i.jsx(Rb,{size:16})}),(l.trim().length>0||te)&&i.jsx("button",{className:`${St.iconButton} ${St.sendButton}`,onClick:()=>X(l),title:"Send to AI",children:i.jsx(Mb,{size:16})}),i.jsx("button",{className:St.iconButton,onClick:he,title:"Voice Input",children:i.jsx(fg,{size:16})})]})]}),i.jsx("input",{type:"file",ref:J,onChange:oe,accept:"image/*",style:{display:"none"}})]})})]}),R&&SE&&i.jsx(vg,{options:CW,children:i.jsx(Zb,{onClose:()=>I(!1),patientData:{id:null,token:null,name:"New Case",age:null,gender:null},tokenNumber:null,onAiSummaryChange:F})})]})},kW=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[o,l]=w.useState(null),[d,f]=w.useState(!1),u=Dt(),h=async v=>{v.preventDefault(),f(!0),l(null);try{const S=await me("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!S.ok){let T=`Login failed with status: ${S.status}`;try{T=(await S.json()).message||T}catch{try{const R=await S.text();R&&(T=`${T} - ${R}`)}catch{}}throw new Error(T)}const k=await S.json();console.log("Login successful:",k),localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Login failed:",S),l(S.message||"Login failed. Please check your credentials.")}finally{f(!1)}},g=async v=>{f(!0),l(null);try{const S=await me("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v.credential})});if(!S.ok)throw new Error("Google Sign-In failed");const k=await S.json();localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Google Login Error:",S),l("Google Sign-In failed. Please try again.")}finally{f(!1)}},b=()=>{console.error("Google Login Failed"),l("Google Sign-In was unsuccessful. Please try again.")};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Newtons AI HMS"}),i.jsx("p",{className:"auth-subtitle",children:"Sign in to continue"}),i.jsxs("form",{onSubmit:h,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:v=>t(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"email",children:"Email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:v=>a(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"password",children:"Password"})]}),o&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:o})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:d,className:"auth-submit-button",children:d?"Signing in...":"Sign In"})})]}),i.jsx("div",{className:"google-login-container",children:i.jsx(BP,{onSuccess:g,onError:b,useOneTap:!0})}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(ks,{to:"/register",className:"auth-navigation-link",children:"Create account"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},TW=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState(null),[h,g]=w.useState(!1),b=Dt(),v=async S=>{S.preventDefault(),g(!0),u(null);try{const k=await me("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),u(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>r(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>o(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>d(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),f&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:f})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:h,className:"auth-submit-button",children:h?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(ks,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var NE={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Y_=Pn.createContext&&Pn.createContext(NE),EW=["attr","size","title"];function AW(e,n){if(e==null)return{};var t=PW(e,n),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function PW(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function bb(){return bb=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},bb.apply(this,arguments)}function W_(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function vb(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?W_(Object(t),!0).forEach(function(r){DW(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):W_(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function DW(e,n,t){return n=IW(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function IW(e){var n=RW(e,"string");return typeof n=="symbol"?n:n+""}function RW(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function CE(e){return e&&e.map((n,t)=>Pn.createElement(n.tag,vb({key:t},n.attr),CE(n.child)))}function es(e){return n=>Pn.createElement(MW,bb({attr:vb({},e.attr)},n),CE(e.child))}function MW(e){var n=t=>{var{attr:r,size:a,title:o}=e,l=AW(e,EW),d=a||t.size||"1em",f;return t.className&&(f=t.className),e.className&&(f=(f?f+" ":"")+e.className),Pn.createElement("svg",bb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:f,style:vb(vb({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),o&&Pn.createElement("title",null,o),e.children)};return Y_!==void 0?Pn.createElement(Y_.Consumer,null,t=>n(t)):n(NE)}function $0(e){return es({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function Q_(e){return es({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function J_(e){return es({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function Rh(e){return es({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function Ax(e){return es({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function Px(e){return es({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function Dx(e){return es({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Mh(e){return es({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function _E(e){return es({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function K_(e){return es({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function OW(e){return es({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function X_(e){return es({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Fm(e){return es({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const jE={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:Rh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:Ax},{path:"/dashboard/users",name:"User Management",icon:Fm}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:Rh}]},{title:"Clinic Management",links:[{path:"/dashboard/clinic-hub",name:"Clinic Hub",icon:Q_}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:Ax},{path:"/dashboard/patients",name:"All Patients",icon:Fm},{path:"/dashboard/patients/search",name:"Search Patient",icon:Mh}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:$0},{path:"/dashboard/inventory",name:"Inventory Management",icon:Dx},{path:"/dashboard/inventory/add",name:"Add Drug",icon:Dx},{path:"/dashboard/distributors",name:"Distributor Management",icon:Fm}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:K_},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:Px},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:Px}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:Mh},{path:"/dashboard/add-patient",name:"Add Patient",icon:Ax},{path:"/manage-admission",name:"Manage Admission",icon:X_}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:J_},{path:"/billing",name:"Billing",icon:Px}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:K_}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:Rh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:Fm},{path:"/dashboard/patients/add",name:"Add Patient",icon:Ax},{path:"/dashboard/patients/search",name:"Search Patient",icon:Mh}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:Px},{path:"/manage-admission",name:"Manage Admission",icon:X_}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:Rh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:J_},{path:"/lab/search-report",name:"Search Lab Report",icon:Mh}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:Rh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:Dx},{path:"/dashboard/inventory/add",name:"Add Drug",icon:Dx},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:$0},{path:"/dashboard/distributors",name:"Distributor Management",icon:Fm}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:$0},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:Q_},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:Mh}]}]},LW=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const o=Ur(),[l,d]=w.useState(""),f=jE[t]||[],[u,h]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(T=>{if(g.current){const P=window.innerWidth-T.clientX;P>250&&P<window.innerWidth*.8&&h(P)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=f.map(T=>({...T,links:T.links.filter(P=>P.name.toLowerCase().includes(l.toLowerCase()))})).filter(T=>T.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${u}px`,right:r?"0":`-${u}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(ks,{to:"/dashboard",className:"home-button",onClick:a,children:i.jsx(Rh,{})}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx(Mh,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:T=>d(T.target.value)})]}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:k.map((T,P)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:T.title}),i.jsx("ul",{className:"sub-page-list",children:T.links.map(R=>{const I=R.icon;return i.jsx("li",{children:i.jsxs(ks,{to:R.path,className:o.pathname===R.path?"active":"",onClick:a,children:[I&&i.jsx(I,{})," ",R.name]})},R.path)})})]},P))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(_E,{})," Logout"]})]})]})},FW=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:o})=>{const l=Ur(),d=o[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"close-button",onClick:a,children:i.jsx(OW,{})})]}),i.jsx("nav",{children:d.map((f,u)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:f.title}),i.jsx("ul",{className:"sub-page-list",children:f.links.map(h=>{const g=h.icon;return i.jsx("li",{children:i.jsxs(ks,{to:h.path,className:l.pathname===h.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",h.name]})},h.path)})})]},u))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(_E,{})," Logout"]})]})]})]})},$W=({})=>{const e=Dt(),[n]=w.useState(!1),[t,r]=w.useState(null),[a,o]=w.useState(null);return w.useEffect(()=>{if(a){const l=setTimeout(()=>o(null),5e3);return()=>clearTimeout(l)}},[a]),n?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",a&&i.jsxs("div",{className:`alert-box ${a.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:a.type==="success"?i.jsx(Ca,{size:18}):i.jsx(Ar,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:a.message})}),i.jsx("button",{onClick:()=>o(null),className:"alert-box-close",children:i.jsx(Sn,{size:16})})]}),t&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(Ar,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:t})}),i.jsx("button",{onClick:()=>r(null),className:"alert-box-close",children:i.jsx(Sn,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>e("."),className:"admin-nav-button",title:"Home",children:[i.jsx(Uk,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-hub"),className:"admin-nav-button",children:[i.jsx(Vk,{})," Clinic"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:"admin-nav-button",children:[i.jsx(Qd,{})," Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/analysis"),className:"admin-nav-button",children:[i.jsx(_1,{})," Analysis"]}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(Bk,{})," Subscriptions"]}),i.jsx("button",{onClick:()=>e("/refill-reminders"),className:"admin-nav-button",children:"Refills"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(_1,{})," Labs"]}),i.jsxs("button",{onClick:()=>e("patients"),className:"admin-nav-button",children:[i.jsx(ep,{})," Patients"]}),i.jsxs("button",{onClick:()=>e("search-patient"),className:"admin-nav-button",children:[i.jsx(Pr,{})," Search"]})]}),i.jsx("div",{className:"admin-content-section",children:i.jsx(ID,{})})]})},zW="_container_15l0t_5",BW="_visualContainer_15l0t_31",UW="_brandTitle_15l0t_49",qW="_searchBar_15l0t_105",VW="_searchIconWrapper_15l0t_153",HW="_searchIcon_15l0t_153",GW="_placeholderText_15l0t_177",YW="_shortcutHint_15l0t_197",WW="_key_15l0t_213",QW="_plus_15l0t_237",JW="_micButtonWrapper_15l0t_247",KW="_micIcon_15l0t_295",XW="_newlyRegisteredSection_15l0t_491",ZW="_recentList_15l0t_509",eQ="_recentPatientPill_15l0t_523",tQ="_recentNameContainer_15l0t_549",nQ="_recentInfo_15l0t_561",rQ="_newlyRegisteredLabel_15l0t_599",iQ="_recentName_15l0t_549",aQ="_recentToken_15l0t_763",zr={container:zW,visualContainer:BW,brandTitle:UW,searchBar:qW,searchIconWrapper:VW,searchIcon:HW,placeholderText:GW,shortcutHint:YW,key:WW,plus:QW,micButtonWrapper:JW,micIcon:KW,newlyRegisteredSection:XW,recentList:ZW,recentPatientPill:eQ,recentNameContainer:tQ,recentInfo:nQ,newlyRegisteredLabel:rQ,recentName:iQ,recentToken:aQ},kE="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",sQ={apiKey:kE},oQ=()=>{const{openCommandBar:e,isOpen:n,setPreFilledQuery:t}=Uh(),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState([]),u=Dt(),h=g=>{g.stopPropagation(),a(!0)};return w.useEffect(()=>{o&&(a(!1),t&&t(o),e(),l(null))},[o,e,t]),w.useEffect(()=>{(async()=>{try{const b=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),v=await me(`/api/patients?${b.toString()}`);if(v.ok){const S=await v.json();f(S.patients||[])}}catch(b){console.error("Error fetching recent patients:",b)}})()},[]),i.jsxs("div",{className:zr.container,children:[i.jsxs("div",{className:zr.visualContainer,children:[i.jsx("h1",{className:zr.brandTitle,children:"Newtons Ai"}),!n&&i.jsxs("div",{className:zr.searchBar,onClick:()=>e(),children:[i.jsx("div",{className:zr.searchIconWrapper,children:i.jsx(Pr,{className:zr.searchIcon})}),i.jsx("span",{className:zr.placeholderText,children:"Search or Ask AI..."}),i.jsx("div",{className:zr.micButtonWrapper,onClick:h,children:i.jsx(fg,{className:zr.micIcon})}),i.jsxs("div",{className:zr.shortcutHint,children:[i.jsx("span",{className:zr.key,children:"Ctrl"}),i.jsx("span",{className:zr.plus,children:"+"}),i.jsx("span",{className:zr.key,children:"K"})]})]}),!n&&d.length>0&&i.jsxs("div",{className:zr.newlyRegisteredSection,children:[i.jsx("div",{className:zr.newlyRegisteredLabel,children:"Newly Registered"}),i.jsx("div",{className:zr.recentList,children:d.map(g=>i.jsxs("div",{className:zr.recentPatientPill,onClick:()=>u(`/dashboard/edit-complaint/patient/${g.id}`),children:[i.jsxs("div",{className:zr.recentNameContainer,children:[i.jsx("span",{className:zr.recentName,children:g.name||"New Patient"}),i.jsxs("span",{className:zr.recentToken,children:["#",g.token]})]}),i.jsxs("div",{className:zr.recentInfo,children:[g.age?`${g.age} yrs`:"",g.age&&g.gender?" / ":"",g.gender||""]})]},g.id))})]})]}),r&&kE&&i.jsx(vg,{options:sQ,children:i.jsx(Zb,{onClose:()=>a(!1),patientData:{id:null,token:null,name:"New Case",age:null,gender:null},tokenNumber:null,onAiSummaryChange:l})})]})},hu=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},lQ=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},Eh=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:o,noDataText:l})=>{const d=w.useMemo(()=>{const f={};t.forEach(h=>{if(isNaN(h.date.getTime())){f["Unknown Date"]||(f["Unknown Date"]=[]),f["Unknown Date"].push(h);return}const g=lQ(h.originalDateString);f[g]||(f[g]=[]),f[g].push(h)});const u=Object.keys(f);return u.sort((h,g)=>{if(h==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const T=k.split(" ");if(T.length===3){const R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(T[1]);if(R!==-1)return new Date(parseInt(T[2]),R,parseInt(T[0]))}return new Date(k)},v=b(h),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(h)}),u.map(h=>({date:h,items:f[h]}))},[t]);return i.jsxs("div",{className:"mb-2 bg-slate-50 rounded-lg border border-slate-200 overflow-hidden",children:[i.jsxs("h4",{className:"text-xs font-semibold text-slate-700 bg-slate-100 px-3 py-2 border-b border-slate-200 flex items-center",children:[n&&i.jsx(n,{size:14,className:"mr-2 text-indigo-600"}),e]}),i.jsxs("div",{className:"p-2",children:[a&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:o}),!a&&t.length===0&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:l}),!a&&t.length>0&&i.jsx("div",{className:"space-y-3",children:d.map(({date:f,items:u})=>i.jsxs("div",{children:[i.jsx("h5",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-1.5 px-1",children:f}),i.jsx("div",{className:"space-y-2 pl-2 border-l-2 border-slate-200 ml-1",children:u.map((h,g)=>i.jsx("div",{className:"flex items-start",children:i.jsx("div",{className:"flex-grow",children:r(h)})},`${h.type}-${h.originalDateString}-${g}`))})]},f))})]})]})},z0=()=>{var J,oe;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[T,P]=w.useState(null),{patientId:R}=ra(),I=Dt(),B=w.useCallback(async ie=>{g(null),d(null),u(null),k(!0),P(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const E=await me(`/api/patients/${ie}`);if(!E.ok)throw new Error(`Patient details fetch failed (${E.status})`);const ce=await E.json();d(ce);const ge=await me(`/api/queue/patient/${ie}/latest`);if(!ge.ok&&ge.status!==404)throw new Error(`Queue entry fetch failed (${ge.status})`);if(ge.ok){const D=await ge.json();u(D)}await F(ie)}catch(E){console.error("Error fetching specific patient data:",E),g(E.message||"Failed to load patient data."),P(E.message||"Failed to load patient history.")}finally{k(!1)}},[]),F=w.useCallback(async ie=>{k(!0),P(null);try{const[E,ce,ge,D]=await Promise.all([me(`/api/queue/patient/${ie}/complaints`),me(`/api/lab/patient/${ie}`),me(`/api/lab/orders/patient/${ie}?status=pending`),me(`/api/pharmacy-orders/patient/${ie}`)]),pe=E.ok?await E.json():[],Ce=ce.ok?await ce.json():[],Z=ge.ok?await ge.json():[],ee=D.ok?await D.json():[];v({pastComplaints:pe||[],labReports:Ce||[],pendingLabOrders:Z||[],pharmacyOrders:ee||[]})}catch(E){console.error("Error fetching patient history:",E),P(E.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),L=w.useCallback(async()=>{r(!0),o(null);try{const ie=await me("/api/queue/doctor");if(!ie.ok){const ce=await ie.text();throw new Error(`API Error (${ie.status}): ${ce||ie.statusText}`)}const E=await ie.json();if(E===null||typeof E!="object"||typeof E.waitingCount!="number")throw console.error("Invalid queue data format:",E),new Error("Invalid queue data format received");n({currentPatient:E.currentPatient||null,nextPatient:E.nextPatient||null,waitingCount:E.waitingCount})}catch(ie){console.error("Error fetching queue data:",ie),o(ie.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let ie=null;return R?(B(R),n({currentPatient:null,nextPatient:null,waitingCount:0})):(L(),ie=setInterval(L,1e4),d(null),u(null)),()=>{ie&&clearInterval(ie)}},[R,B,L]),w.useEffect(()=>{var ie;!R&&((ie=e.currentPatient)!=null&&ie.patientId)?F(e.currentPatient.patientId):!R&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null))},[R,(J=e.currentPatient)==null?void 0:J.patientId,F]);const U=((oe=e.currentPatient)==null?void 0:oe.patientId)||(R?parseInt(R,10):null),H=w.useMemo(()=>{if(!U||!b.pastComplaints)return[];const ie=b.pastComplaints.map(E=>({date:new Date(E.createdAt),type:"Complaint",data:E,originalDateString:E.createdAt})).filter(E=>!isNaN(E.date.getTime()));return ie.sort((E,ce)=>ce.date.getTime()-E.date.getTime()),ie},[U,b.pastComplaints]),K=w.useMemo(()=>{if(!U)return[];const ie=[];return(b.pendingLabOrders??[]).forEach(E=>{const ce=new Date(E.createdAt);isNaN(ce.getTime())||ie.push({date:ce,type:"Lab Order (Pending)",data:E,originalDateString:E.createdAt})}),(b.labReports??[]).forEach(E=>{const ce=E.reportCreatedAt?new Date(E.reportCreatedAt):null;ce&&!isNaN(ce.getTime())&&ie.push({date:ce,type:"Lab Report",data:E,originalDateString:E.reportCreatedAt})}),ie.sort((E,ce)=>ce.date.getTime()-E.date.getTime()),ie},[U,b.pendingLabOrders,b.labReports]),M=w.useMemo(()=>{if(!U||!b.pharmacyOrders)return[];const ie=b.pharmacyOrders.map(E=>({date:new Date(E.date),type:"Pharmacy Order",data:E,originalDateString:E.date})).filter(E=>!isNaN(E.date.getTime()));return ie.sort((E,ce)=>ce.date.getTime()-E.date.getTime()),ie},[U,b.pharmacyOrders]),$=async()=>{r(!0),o(null);try{await me("/api/queue/doctor/next",{method:"POST"}),await L()}catch(ie){console.error("Error calling next patient:",ie),o(ie.message||"Failed to call next patient.")}finally{r(!1)}},z=async()=>{if(!(!e.currentPatient||R)){r(!0),o(null);try{await me(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await L(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null)}catch(ie){console.error("Error completing consultation:",ie),o(ie.message||"Failed to complete consultation.")}finally{r(!1)}}},W=ie=>{switch(ie){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return ie}},[te,V]=w.useState("info");let G=null;return e.currentPatient&&(G=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-teal-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${te==="info"?"active":""}`,onClick:()=>V("info"),children:"Patient Details"}),i.jsx("button",{className:`mobile-tab-btn ${te==="history"?"active":""}`,onClick:()=>V("history"),children:"History & Context"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${te==="info"?"block":"hidden md:block"}`,children:[i.jsxs("h2",{className:"text-xl text-teal-700 font-semibold mb-3 flex items-center",children:["NOW SEEING",i.jsx("span",{className:"ml-2 text-xs font-normal text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:"Live Consultation"})]}),i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-3xl font-bold text-gray-800 mb-1 leading-tight",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg text-gray-600 flex items-center mt-1",children:[i.jsxs("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm mr-2",children:[e.currentPatient.age," Yrs"]}),i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0 flex flex-col items-end",children:[i.jsxs("div",{className:"text-2xl font-bold text-gray-700 mb-1",children:["#",e.currentPatient.token]}),i.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:W(e.currentPatient.status)})]})]}),e.currentPatient.case_summary&&i.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-100 rounded-md",children:[i.jsx("h4",{className:"text-xs font-bold text-amber-800 uppercase mb-1",children:"AI Brief"}),i.jsx("p",{className:"text-sm text-amber-900 leading-snug",children:e.currentPatient.case_summary})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex flex-col sm:flex-row justify-end gap-3 border-t pt-4",children:[i.jsxs("button",{onClick:()=>{var E;const ie=(E=e.currentPatient)==null?void 0:E._id;ie&&I(`/dashboard/edit-complaint/${ie}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary w-full sm:w-auto",children:[i.jsx(Aw,{size:16})," Open Consultation"]}),i.jsxs("button",{onClick:z,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success w-full sm:w-auto",children:[i.jsx(y6,{size:16})," Complete"]})]})]})," ",i.jsxs("div",{className:`complaint-section md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${te==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-gray-800 mb-2 flex items-center justify-between",children:[i.jsx("span",{children:"History & Context"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Updating..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(Eh,{title:"Past Complaints",icon:fo,items:H,isLoading:S,loadingText:"Fetching...",noDataText:"No past complaints.",renderItemContent:ie=>i.jsxs("span",{className:"block text-xs",children:[ie.data.complaint,i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:hu(ie.originalDateString)})]})}),i.jsx(Eh,{title:"Lab Reports & Orders",icon:po,items:K,isLoading:S,loadingText:"Fetching...",noDataText:"No lab history.",renderItemContent:ie=>ie.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),ie.data.tests.map(E=>E.name).join(", "),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:hu(ie.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-green-700 mb-0.5",children:["Report: ",ie.data.testName]}),i.jsxs("div",{className:"text-gray-600 italic",children:['"',ie.data.reportFindings.substring(0,60),ie.data.reportFindings.length>60?"...":"",'"']}),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:hu(ie.originalDateString)})]})}),i.jsx(Eh,{title:"Medications",icon:Wd,items:M,isLoading:S,loadingText:"Fetching...",noDataText:"No medication history.",renderItemContent:ie=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-gray-800",children:ie.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:[hu(ie.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:ie.data.status})]})]})}),H.length===0&&K.length===0&&M.length===0&&!S&&i.jsx("div",{className:"text-gray-400 text-center py-4 text-xs italic bg-gray-50 rounded border border-dashed border-gray-200",children:"No history records found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>I(-1),className:"back-button mr-4",children:i.jsx(cn,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),R?i.jsxs(i.Fragment,{children:[h&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:h}),l&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-purple-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${te==="info"?"active":""}`,onClick:()=>V("info"),children:"Patient Record"}),i.jsx("button",{className:`mobile-tab-btn ${te==="history"?"active":""}`,onClick:()=>V("history"),children:"History"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${te==="info"?"block":"hidden md:block"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold flex items-center gap-2",children:"Patient Record"}),i.jsxs("button",{onClick:()=>I("/dashboard/doctor"),className:"text-xs font-medium text-slate-500 hover:text-slate-800 flex items-center gap-1 transition-colors px-2 py-1 bg-slate-100 rounded",children:[i.jsx(cn,{size:12})," Back to Queue"]})]}),i.jsx("div",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-700 to-indigo-600 mb-1 leading-tight",children:l.name}),i.jsxs("div",{className:"text-lg text-slate-600 mb-4 flex items-center gap-2",children:[i.jsxs("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:[l.age||"N/A"," Yrs"]}),i.jsx("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:l.gender||"N/A"})]}),i.jsxs("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-sm",children:[i.jsx("label",{className:"font-semibold block mb-2 text-xs uppercase tracking-wider text-slate-500",children:"Latest Activity"}),f?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words text-slate-700",children:[i.jsx("span",{className:"font-medium text-slate-900",children:"Complaint:"})," ",f.complaint||i.jsx("span",{className:"text-slate-400 italic",children:"None"}),i.jsx("div",{className:"mt-1",children:i.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${f.status==="consulting"?"bg-teal-100 text-teal-800":f.status==="seen"?"bg-emerald-100 text-emerald-800":f.status==="waiting"?"bg-blue-100 text-blue-800":"bg-slate-100 text-slate-800"}`,children:W(f.status)})})]}),f.status==="consulting"&&f._id&&i.jsx("button",{onClick:()=>I(`/dashboard/edit-complaint/${f._id}`),className:"ml-4 px-3 py-1.5 text-xs bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-md font-medium border border-indigo-200 transition-colors",children:"Resume"})]}),f.case_summary&&i.jsxs("div",{className:"text-xs text-slate-700 bg-amber-50 p-2.5 rounded border border-amber-100",children:[i.jsx("span",{className:"font-bold text-amber-800 uppercase text-[10px] block mb-1",children:"AI Summary"}),f.case_summary]})]}):i.jsx("p",{className:"text-slate-400 italic text-sm",children:"No queue entry found for this patient today."})]})]}),i.jsxs("div",{className:`md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${te==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-slate-800 mb-3 flex items-center justify-between",children:[i.jsx("span",{children:"Patient History"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Loading..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(Eh,{title:"Past Complaints",icon:fo,items:H,isLoading:S,loadingText:"Loading...",noDataText:"No past complaints.",renderItemContent:ie=>i.jsxs("div",{className:"text-xs",children:[ie.data.complaint,i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:hu(ie.originalDateString)})]})}),i.jsx(Eh,{title:"Lab Reports",icon:po,items:K,isLoading:S,loadingText:"Loading...",noDataText:"No lab history.",renderItemContent:ie=>ie.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),i.jsx("div",{children:ie.data.tests.map(E=>E.name).join(", ")}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:hu(ie.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-emerald-700 mb-0.5",children:["Report: ",ie.data.testName]}),i.jsxs("div",{className:"text-slate-600 italic",children:['"',ie.data.reportFindings.substring(0,50),ie.data.reportFindings.length>50?"...":"",'"']}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:hu(ie.originalDateString)})]})}),i.jsx(Eh,{title:"Medications",icon:Wd,items:M,isLoading:S,loadingText:"Loading...",noDataText:"No pharmacy history.",renderItemContent:ie=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-slate-800",children:ie.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:[hu(ie.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:ie.data.status})]})]})}),H.length===0&&K.length===0&&M.length===0&&!S&&i.jsx("div",{className:"text-slate-400 text-center py-4 text-xs italic bg-slate-50 rounded border border-dashed border-slate-200",children:"No history records found."})]})]})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>I("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx(Iw,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>I("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:G||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:W(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:$,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},cQ="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",uQ={apiKey:cQ},Gm=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(!1),[h,g]=w.useState(null),b=w.useRef(null),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,R]=w.useState(null),[I,B]=w.useState(null),[F,L]=w.useState([]),[U,H]=w.useState(!1),K=Dt(),M=Ur(),$=Ew({settings:{},staffList:[]}),{selectedImage:z,handleImageSelect:W,clearImage:te}=$,V=w.useRef(null),G=ee=>{var ye;const X=(ye=ee.target.files)==null?void 0:ye[0];X&&W(X)};w.useEffect(()=>{$.chatHistory.length>0&&U&&$.isProcessing},[$.chatHistory.length]),w.useEffect(()=>{(async()=>{try{const X=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),ye=await me(`/api/patients?${X.toString()}`);if(ye.ok){const He=await ye.json();L(He.patients||[])}}catch(X){console.error("Error fetching recent patients:",X)}})()},[]),w.useEffect(()=>{$.setChatQuery(e)},[e]);const J=w.useCallback(async ee=>{if(!(ee||e).trim()){g("Please enter complaint details.");return}u(!0),g(null),ee&&ee!==$.chatQuery&&$.setChatQuery(ee);try{$.handleSendMessage(),n("")}catch(ye){console.error("AI Error:",ye),g("AI failed to process. Try again."),u(!1)}},[e,$]);w.useEffect(()=>{!$.isProcessing&&f&&u(!1)},[$.isProcessing,f]),w.useEffect(()=>{const ee=b.current;ee&&(ee.style.height="auto",ee.style.height=`${ee.scrollHeight}px`);const ye=new URLSearchParams(M.search).get("caseDetails");if(ye){const He=decodeURIComponent(ye);He!==e&&(n(He),S(!0))}},[M.search,e]),w.useEffect(()=>{v&&e.trim()&&(K(M.pathname,{replace:!0}),J(e),S(!1))},[v,e,J,K,M.pathname]),w.useEffect(()=>{const ee=b.current;ee&&(ee.style.height="auto",ee.style.height=`${ee.scrollHeight}px`)},[e]),w.useEffect(()=>{P&&(n(P),T(!1),$.setChatQuery(P),setTimeout(()=>$.handleSendMessage(),0),R(null))},[P,$]);const oe=()=>{B({id:null,token:null,name:"New Case",age:null,gender:null}),T(!0)},ie=w.useMemo(()=>gg(async ee=>{const X=ee.trim(),ye=/^\d+$/.test(X),He=X.split(/\s+/).length;if(X.length<2||ye&&X.length>10||!ye&&He>2){r([]),o(!1),d(null);return}o(!0),d(null);try{const he=new URLSearchParams({search:encodeURIComponent(ee),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),Le=await me(`/api/patients?${he.toString()}`);if(!Le.ok){const De=await Le.text();throw new Error(`API Error (${Le.status}): ${De||Le.statusText}`)}const ue=await Le.json();r(ue.patients)}catch(he){console.error("Error searching patients:",he),d(he.message||"Failed to search patients."),r([])}finally{o(!1)}},300),[]),E=ee=>{const X=ee.target.value;n(X);const ye=X.trim(),He=/^\d+$/.test(ye),he=ye.split(/\s+/).length;ye.length>=2&&!(He&&ye.length>10||!He&&he>2)?o(!0):(o(!1),r([])),ie(X)},ce=ee=>{ee.key==="Enter"&&!ee.shiftKey&&(ee.preventDefault(),e.trim()&&!a&&Z())},ge=async ee=>{ee&&ee.id&&K(`/dashboard/edit-complaint/patient/${ee.id}`)},D=[{icon:"",title:"Example: Fever & Cold",description:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Example: Stomach Ache",description:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}],pe=ee=>{n(ee),setTimeout(()=>{$.handleSendMessage(ee),n(""),r([])},50)},Ce=()=>{n(""),r([]),$.refreshChat()},Z=()=>{!e.trim()&&!z||(ie.cancel(),$.handleSendMessage(e),n(""),r([]))};return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>K("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsx("button",{onClick:()=>K(-1),className:"patient-search-button patient-search-button-back",children:i.jsx(cn,{size:16})})]}),i.jsxs("div",{className:"patient-search-content-box",children:[l&&i.jsx("p",{className:"patient-search-error",children:l}),h&&i.jsx("p",{className:"patient-search-error",children:h}),F.length>0&&i.jsxs("div",{className:"newly-registered-section",children:[i.jsx("div",{className:"recent-list",children:F.map(ee=>i.jsxs("div",{className:"recent-patient-pill",onClick:()=>ge(ee),children:[i.jsxs("div",{className:"recent-name-container",children:[i.jsx("span",{className:"recent-name",children:ee.name||"New Patient"}),i.jsxs("span",{className:"recent-token",children:["#",ee.token]})]}),i.jsxs("div",{className:"recent-info",children:[ee.age," yrs / ",ee.gender]})]},ee.id))}),i.jsx("div",{className:"newly-registered-label",children:"NEWLY REGISTERED"})]}),$.chatHistory.length===0&&t.length===0&&i.jsxs("div",{className:"example-cases-section",children:[i.jsxs("div",{className:"example-cases-header",children:[i.jsx("span",{className:"sparkles-icon",children:""}),i.jsx("h3",{children:"Try AI with Example Cases"})]}),i.jsx("div",{className:"example-cards-container",children:D.map((ee,X)=>i.jsxs("div",{className:"example-case-card",onClick:()=>pe(ee.text),children:[i.jsx("div",{className:"example-icon",children:ee.icon}),i.jsxs("div",{className:"example-content",children:[i.jsx("div",{className:"example-title",children:ee.title}),i.jsx("div",{className:"example-description",children:ee.description})]})]},X))})]})]}),$.chatHistory.length>0&&!f&&i.jsxs("div",{className:`ai-chat-overlay ${U?"minimized":""}`,children:[i.jsxs("div",{className:"ai-chat-header",children:[i.jsx("span",{children:"AI Assistant"}),i.jsx("div",{className:"ai-chat-controls",children:i.jsx("button",{className:"icon-btn",onClick:()=>Ce(),title:"Clear Chat",children:i.jsx(Sn,{size:16})})})]}),i.jsxs("div",{className:"ai-chat-messages",children:[$.chatHistory.map((ee,X)=>i.jsx("div",{className:`chat-bubble ${ee.role==="model"?"model":"user"}`,children:ee.role==="system"?i.jsx("i",{children:ee.text}):ee.text},X)),$.isProcessing&&i.jsx("div",{className:"chat-bubble model",children:"Typing..."})]})]}),t.length>0&&!f&&i.jsxs("div",{className:"patient-search-results-overlay",children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingBottom:"0.5rem"},children:[i.jsx("div",{style:{fontWeight:600,color:"#64748b"},children:"Found Patients"}),i.jsx("button",{onClick:()=>r([]),style:{border:"none",background:"transparent",color:"#94a3b8",cursor:"pointer"},children:i.jsx(Sn,{size:14})})]}),t.map(ee=>i.jsxs("div",{onClick:()=>ge(ee),className:"patient-search-result-item",children:[i.jsxs("div",{className:"patient-search-result-item-name-container",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["[#",ee.token,"]"]}),i.jsx("span",{className:"patient-search-result-item-name",children:ee.name})]}),i.jsxs("div",{className:"patient-search-result-item-details",children:[ee.age?`${ee.age} yrs`:"",ee.age&&ee.gender?" / ":"",ee.gender||"N/A"]})]},ee.id))]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[i.jsxs("div",{className:"cmd-input-container",children:[z&&i.jsxs("div",{className:"cmd-image-preview",children:[i.jsx("img",{src:z,alt:"Selected"}),i.jsx("button",{className:"cmd-image-delete",onClick:te,children:i.jsx(Sn,{size:12})})]}),i.jsx("textarea",{ref:b,placeholder:"Search (Name/Token/Phone), Ask AI, or Enter New Case...",value:e,onChange:E,onKeyDown:ce,className:"cmd-input",disabled:f||$.isProcessing,rows:1}),i.jsxs("div",{className:"cmd-controls-group",children:[i.jsx("input",{type:"file",ref:V,onChange:G,accept:"image/*",style:{display:"none"}}),i.jsx("button",{className:"cmd-icon-btn",onClick:()=>{var ee;return(ee=V.current)==null?void 0:ee.click()},title:"Attach Image",children:i.jsx(Rb,{})}),i.jsx("button",{className:"cmd-icon-btn",onClick:oe,title:"Voice Input",children:i.jsx(fg,{})}),(e.length>0||z)&&i.jsx("button",{className:"cmd-icon-btn send-btn",onClick:Z,title:"Send",children:i.jsx(Mb,{})})]})]}),k&&i.jsx(vg,{options:uQ,children:i.jsx(Zb,{onClose:()=>T(!1),patientData:I,tokenNumber:null,onAiSummaryChange:R})})]})]})},TE=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,P]=w.useState(null),R=Dt(),I=w.useCallback(JT.debounce(async M=>{if(M.trim().length<2){r([]),k(!1);return}k(!0),P(null);try{const $=new URLSearchParams({search:encodeURIComponent(M),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),z=await me(`/api/patients?${$.toString()}`);if(!z.ok){const te=await z.text();throw new Error(`API Error (${z.status}): ${te||z.statusText||"Failed to fetch patients"}`)}const W=await z.json();r(W.patients)}catch($){P($ instanceof Error?$.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),I(e)):(r([]),I.cancel()),()=>{I.cancel()}),[e,I]);const B=M=>{o(M),n(""),r([]),P(null),d(null),u(null),g(null),v(!1)},F=async()=>{if(!a){P("No patient selected.");return}P(null),k(!0);try{const M=await me(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!M.ok){const z=await M.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(z.message||"Failed to admit patient")}const $=await M.json();alert($.message||"Patient admitted successfully!"),$.bill&&$.bill.id?R(`/patient/${a.id}/admission-bill/${$.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),P("Admission successful, but couldn't navigate to billing."),o($.patient))}catch(M){P(M instanceof Error?M.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){d(null),g(null);return}v(!0),u(null),d(null),g(null);try{const $=await me(`/api/patients/${a.id}/active-bill?type=admission`);if(!$.ok)throw $.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const z=await $.json(),W=z==null?void 0:z.id;if(!W)throw new Error("Active admission bill ID not found in response.");d(W);const te=await me(`/api/bills/${W}`);if(!te.ok)throw new Error(`Failed to fetch bill details (ID: ${W}). Status: ${te.status}`);const V=await te.json();if(V&&V.calculated)g(V.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",V),new Error("Fetched bill details are incomplete (missing calculated data).")}catch($){u($ instanceof Error?$.message:"An unknown error occurred while fetching bill details."),d(null),g(null)}finally{v(!1)}})()},[a]);const L=async()=>{if(!a){P("No patient selected.");return}if(!a.admission_date||a.discharge_date){P("Patient is not currently admitted.");return}P(null),k(!0);try{const M=await me(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!M.ok){const z=await M.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(z.message||"Failed to discharge patient")}const $=await M.json();alert($.message||"Patient discharged successfully!"),$.patient?o($.patient):(console.error("Discharge successful, but updated patient info missing in response."),o(null),P("Discharge successful, but couldn't update patient details locally."))}catch(M){P(M instanceof Error?M.message:"Failed to discharge patient")}finally{k(!1)}},U=()=>{if(!a||!l){P("Cannot navigate to billing: Patient or Bill ID missing.");return}R(`/patient/${a.id}/admission-bill/${l}`)};let H="",K=null;if(a){const M=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,$=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(H=`Patient admitted on: ${M}`,K=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",f&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:f})," ",!b&&h&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(h.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(h.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(h.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:U,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!f?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:L,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(H=`Patient admitted on ${M} and discharged on ${$}.`,K=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(H="Patient is not admitted.",K=i.jsx("button",{onClick:F,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>R(-1),className:"back-button",children:[i.jsx(cn,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:M=>n(M.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(M=>i.jsxs("li",{onClick:()=>B(M),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",M.name," (Token: ",M.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[M.admission_date?`Admitted: ${new Date(M.admission_date).toLocaleDateString()}`:"Not Admitted",M.discharge_date?`, Discharged: ${new Date(M.discharge_date).toLocaleDateString()}`:""]})]},M.id))]}),t.length===0&&e&&!S&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>o(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:H})," ",T&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",K]})]})},B0=15,Z1=()=>{const e=Dt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(""),[u,h]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,T]=w.useState("created_at"),[P,R]=w.useState("desc"),[I,B]=w.useState(""),[F,L]=w.useState(!1),[U,H]=w.useState(null),[K,M]=w.useState([]),[$,z]=w.useState(""),[W,te]=w.useState(!1),[V,G]=w.useState(null),[J,oe]=w.useState(!0),[ie,E]=w.useState(null),[ce,ge]=w.useState(d);w.useEffect(()=>{const he=setTimeout(()=>{ge(d),h(1)},500);return()=>{clearTimeout(he)}},[d]);const D=w.useCallback(async()=>{oe(!0),E(null);try{const he=await me("/api/subscriptions");if(!he.ok){let ue=`Failed to fetch subscription plans (${he.status})`;try{ue=(await he.json()).message||ue}catch{}throw new Error(ue)}const Le=await he.json();M(Le)}catch(he){console.error("Error fetching subscription plans:",he),E(he.message||"An unknown error occurred while fetching plans."),M([])}finally{oe(!1)}},[]),pe=w.useCallback(async(he,Le,ue,De,Ye)=>{a(!0),l(null);try{const et=new URLSearchParams({page:he.toString(),limit:B0.toString(),sortBy:ue,sortOrder:De});Le&&et.append("search",Le),Ye&&et.append("gender",Ye);const Ke=await me(`/api/patients?${et.toString()}`);if(!Ke.ok){const ot=await Ke.json();throw new Error(ot.message||"Failed to fetch patients")}const it=await Ke.json();t(it.patients),S(it.totalCount),h(it.currentPage),b(it.totalPages)}catch(et){console.error("Error fetching patients:",et),l(`Failed to load patients: ${et.message}`),t([]),S(0),h(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{pe(u,ce,k,P,I),D()},[u,ce,k,P,I,pe,D]);const Ce=he=>{const Le=k===he&&P==="asc"?"desc":"asc";T(he),R(Le),h(1)},Z=he=>{try{return new Date(he).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},ee=()=>{L(!1),H(null),z(""),G(null),te(!1)},X=async(he,Le)=>{t(ue=>ue.map(De=>De.id===he?{...De,insurance_type:Le}:De));try{const ue=await me(`/api/patients/${he}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Le})});if(!ue.ok){const De=await ue.json();throw new Error(De.message||"Failed to update insurance type")}}catch(ue){console.error("Error updating insurance type:",ue),pe(u,ce,k,P,I)}},ye=(he,Le)=>{const ue=new Date(he),De=Le.interval||1;switch(Le.period){case"daily":ue.setDate(he.getDate()+De);break;case"weekly":ue.setDate(he.getDate()+De*7);break;case"monthly":ue.setMonth(he.getMonth()+De);break;case"yearly":ue.setFullYear(he.getFullYear()+De);break;default:console.warn(`Unknown subscription period: ${Le.period}. Defaulting to 1 month.`),ue.setMonth(he.getMonth()+1)}return ue},He=async()=>{if(!U||!$){G("Please select a subscription plan.");return}const he=K.find(Le=>Le.id===$);if(!he){G("Selected plan details not found.");return}te(!0),G(null);try{const Le=new Date,ue=ye(Le,he),De={subscription_plan_id:$,subscription_status:"active",subscription_start_date:Le.toISOString(),subscription_end_date:ue.toISOString(),subscription_payment_method:"manual"},Ye=await me(`/api/patients/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(De)});if(!Ye.ok){const et=await Ye.json();throw new Error(et.message||"Failed to update patient subscription")}ee(),pe(u,ce,k,P,I)}catch(Le){console.error("Error starting subscription:",Le),G(`Failed to start subscription: ${Le.message}`)}finally{te(!1)}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(cn,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(Ts,{size:28}),"All Registered Patients"]}),o&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:J?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):ie?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",ie]}):K.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:K.map(he=>i.jsxs("li",{children:[i.jsx("strong",{children:he.name}),": ",he.price," / ",he.interval," ",he.period,he.interval>1?"s":"",he.description&&i.jsx("span",{className:"plan-description",children:he.description})]},he.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:d,onChange:he=>f(he.target.value)}),i.jsx(Pr,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(w6,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:I,onChange:he=>B(he.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:ce?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>Ce("name"),children:["Name",k==="name"&&(P==="asc"?i.jsx(C1,{size:14,className:"sort-icon"}):i.jsx(XN,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>Ce("created_at"),children:["Registered On",k==="created_at"&&(P==="asc"?i.jsx(C1,{size:14,className:"sort-icon"}):i.jsx(XN,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(he=>i.jsxs("tr",{children:[i.jsx("td",{children:he.token??"-"}),i.jsx("td",{className:"patient-name",children:he.name}),i.jsx("td",{children:he.age??"-"}),i.jsx("td",{children:he.gender??"-"}),i.jsx("td",{children:he.phone??"-"}),i.jsx("td",{children:he.address??"-"}),i.jsx("td",{children:Z(he.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${he.subscription_status==="active"?"active":he.subscription_status==="cancelled"||he.subscription_status==="expired"?"inactive":"none"}`,children:he.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:he.insurance_type,onChange:Le=>X(he.id,Le.target.value),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>e(`/start-subscription/${he.id}`),className:"action-button",children:"Start Sub"})})]},he.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(u-1)*B0+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(u*B0,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>h(he=>Math.max(he-1,1)),disabled:u===1||r,className:"pagination-button",children:[i.jsx(Ib,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:u})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>h(he=>Math.min(he+1,g)),disabled:u===g||r,className:"pagination-button",children:["Next",i.jsx(Zh,{size:16,className:"next-icon"})]})]})]})]}),F&&U&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",U.name]}),i.jsx("button",{onClick:ee,className:"subscription-modal-close-button",children:i.jsx(Sn,{size:24})})]}),V&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:V})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:$,onChange:he=>z(he.target.value),className:"form-select",disabled:W||J||ie!==null||K.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),J?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):ie?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):K.length>0?K.map(he=>i.jsxs("option",{value:he.id,children:[he.name," - ",he.price," (",he.interval," ",he.period,he.interval>1?"s":"",")"]},he.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),ie&&i.jsx("p",{className:"error-message",children:ie}),K.length===0&&!J&&!ie&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:ee,disabled:W,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:He,disabled:!$||W,className:"subscription-modal-button submit",children:W?"Starting...":"Start Subscription"})]})]})})]})},EE=()=>{const e=Dt(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,o]=w.useState([]),[l,d]=w.useState(!1),[f,u]=w.useState(null),[h,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>gg(async P=>{if(P.trim().length<2){o([]),d(!1),u(null);return}d(!0),u(null);try{const R=new URLSearchParams({search:encodeURIComponent(P),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),I=await me(`/api/patients?${R.toString()}`);if(!I.ok){const F=await I.text();throw new Error(`API Error (${I.status}): ${F||I.statusText}`)}const B=await I.json();o(B.patients)}catch(R){console.error("Error searching patients:",R),u(R.message||"Failed to search patients."),o([])}finally{d(!1)}},300),[]),S=P=>{const R=P.target.value;r(R),g(b.test(R)),d(!0),v(R)},k=w.useCallback(P=>{e("/billing",{state:{patientId:P.id,patientName:P.name}})},[e]),T=w.useCallback(async()=>{if(!t||!h){u("Invalid phone number to create a new patient.");return}d(!0),u(null);try{const R=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!R.ok){const B=await R.json();throw new Error(B.message||`Failed to create patient: ${R.statusText}`)}const I=await R.json();alert(`New patient "direct pharmacy" created with phone ${I.phone}.`),k(I)}catch(P){console.error("Error creating new patient:",P),u(P.message||"Failed to create new patient.")}finally{d(!1)}},[t,h,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(cn,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),f&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:f}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(P=>i.jsxs("li",{onClick:()=>k({id:P.id,name:P.name,token:P.token,age:P.age,gender:P.gender,phone:P.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",P.token]}),P.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[P.age?`${P.age} yrs`:"Age N/A",P.gender?` / ${P.gender}`:" / Gender N/A",P.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",P.phone]})]})]}),P.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",P.phone]})]},P.id))})}),t.length>=2&&!l&&a.length===0&&!f&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),h&&i.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},AE=({currentUser:e})=>{const n=Dt(),[t,r]=w.useState("select_patient"),[a,o]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,d]=w.useState(null),[f,u]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[T,P]=w.useState(""),[R,I]=w.useState([]),[B,F]=w.useState(!1),[L,U]=w.useState(null),[H,K]=w.useState(null),[M,$]=w.useState(null),[z,W]=w.useState(!1),[te,V]=w.useState(!1),[G,J]=w.useState(!1),oe=/^\+?[0-9\s\-().]{7,20}$/,ie=/^[a-zA-Z\s'-]{2,}$/,E=w.useCallback(async()=>{if(!(f.length>0)){W(!0),$(null);try{const he=await me("/api/lab-tests");if(!he.ok)throw new Error("Failed to fetch lab tests");const Le=await he.json();u(Le)}catch(he){console.error("Failed to fetch available lab tests:",he),$("Could not load lab test list: "+he.message),u([])}finally{W(!1)}}},[f.length]);w.useEffect(()=>{if(!b){k([]);return}const he=b.toLowerCase();k(f.filter(Le=>Le.name.toLowerCase().includes(he)||Le.description&&Le.description.toLowerCase().includes(he)).slice(0,10))},[b,f]);const ce=w.useCallback(he=>{const Le={id:he.id,name:he.name,token:he.token,age:he.age,gender:he.gender,phone:he.phone};d(Le),r("create_order"),g([]),v(""),k([]),$(null),E()},[E]),ge=w.useMemo(()=>gg(async he=>{if(he.trim().length<2){I([]),F(!1),U(null);return}F(!0),U(null);try{const Le=new URLSearchParams({search:encodeURIComponent(he),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),ue=await me(`/api/patients?${Le.toString()}`);if(!ue.ok){const Ye=await ue.text();throw new Error(`API Error (${ue.status}): ${Ye||ue.statusText}`)}const De=await ue.json();I(De.patients)}catch(Le){console.error("Error searching lab patients:",Le),U(Le.message||"Failed to search lab patients."),I([])}finally{F(!1)}},300),[oe,ie]),D=he=>{const Le=he.target.value;P(Le),V(oe.test(Le)),J(ie.test(Le)&&!oe.test(Le)),F(!0),ge(Le)},pe=w.useCallback(async he=>{if(!T||he==="phone"&&!te||he==="name"&&!G){U(`Invalid ${he} to create a new patient.`);return}F(!0),U(null);try{const ue=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:he==="name"?T:"direct lab",phone:he==="phone"?T:null,age:null,gender:null,token:null})});if(!ue.ok){const Ye=await ue.json();throw new Error(Ye.message||`Failed to create patient: ${ue.statusText}`)}const De=await ue.json();alert(`New patient "${De.name}" created with ${he==="phone"?`phone ${De.phone}`:`name ${De.name}`}.`),ce({id:De.id,name:De.name,token:De.token??null,age:De.age??null,gender:De.gender??null,phone:De.phone})}catch(Le){console.error("Error creating new patient:",Le),U(Le.message||"Failed to create new patient.")}finally{F(!1)}},[T,te,G,ce]),Ce=()=>{r("select_patient"),d(null),P(""),I([]),U(null)},Z=he=>{const{name:Le,value:ue}=he.target;o(De=>({...De,[Le]:Le==="age"?ue?parseInt(ue,10):void 0:ue}))},ee=async he=>{if(he.preventDefault(),K(null),!a.name){K("Patient Name is required.");return}const Le={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const ue=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Le)});if(!ue.ok){const Ye=await ue.json();throw new Error(Ye.message||`Failed to create patient: ${ue.statusText}`)}const De=await ue.json();alert(`Patient "${De.name}" created successfully!`),ce({id:De.id,name:De.name,token:De.token??null,age:De.age??null,gender:De.gender??null,phone:De.phone})}catch(ue){console.error("Failed to create patient:",ue),K(ue.message||"Failed to create patient. Please try again.")}},X=he=>{if(h.some(Le=>Le.id===he.id)){$(`${he.name} is already in the order.`),setTimeout(()=>$(null),3e3),v(""),k([]);return}g(Le=>[...Le,{...he}]),v(""),k([])},ye=he=>{g(Le=>Le.filter(ue=>ue.id!==he))},He=async he=>{if(he.preventDefault(),$(null),!l){$("No patient selected.");return}if(h.length===0){$("No lab tests selected.");return}const Le={patient_id:l.id,tests:h.map(ue=>({id:ue.id,name:ue.name,price:ue.price}))};console.log("Submitting Lab Order:",Le);try{const ue=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Le)});if(!ue.ok){const et=await ue.json();throw console.error("API Error Data:",et),new Error(et.message||`Failed to create lab order: ${ue.statusText}`)}const De=await ue.json();console.log("Lab Order Creation Result:",De);let Ye=l.queueId;if(!Ye){const et=await me(`/api/queue/patient/${l.id}/latest`);if(et.ok){const Ke=await et.json();Ke!=null&&Ke._id&&(Ye=Ke._id)}}if(!Ye){const et=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!et.ok){const it=await et.text();throw new Error(`Failed to create queue entry for redirection: ${it||et.statusText}`)}const Ke=await et.json();if(Ke!=null&&Ke.id)Ye=Ke.id;else throw new Error("Failed to get ID from new queue entry for redirection.")}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${Ye}`)}catch(ue){console.error("Failed to create lab order:",ue),$(ue.message||"Failed to create lab order.")}};return w.useEffect(()=>{E()},[E]),i.jsxs("div",{className:"create-lab-order-container",children:[i.jsxs("div",{className:"create-lab-order-header",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:[i.jsx(cn,{size:20,style:{marginRight:"8px"}}),"Back"]}),i.jsx("h1",{className:"create-lab-order-title",children:"Create New Lab Order"}),i.jsx("div",{style:{width:"64px"}})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"glass-card",children:[t==="select_patient"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"header-with-action",children:i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Select Patient"})}),i.jsxs("div",{className:"search-container",children:[i.jsx(Pr,{className:"search-icon",size:20}),i.jsx("input",{type:"text",id:"lab-patient-search",placeholder:"Search by Name, Token No, or Phone No...",value:T,onChange:D,className:"modern-input",autoFocus:!0,autoComplete:"off"}),B&&i.jsx("span",{className:"loading-text",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)",fontSize:"0.8rem"},children:"Searching..."})]}),L&&i.jsxs("div",{className:"error-message",children:[i.jsx(Ar,{size:18}),L]}),R.length>0&&i.jsx("ul",{className:"patient-list",children:R.map(he=>i.jsxs("li",{onClick:()=>ce(he),className:"patient-list-item",children:[i.jsxs("div",{className:"patient-info",children:[i.jsx("strong",{children:he.name}),i.jsxs("span",{className:"token-badge",children:["#",he.token||"N/A"]})]}),i.jsxs("div",{className:"patient-details",children:[he.age?`${he.age} yrs`:"",he.gender?` / ${he.gender}`:"",he.phone?`  ${he.phone}`:""]})]},he.id))}),T.length>=2&&!B&&R.length===0&&!L&&i.jsxs("div",{style:{textAlign:"center",marginTop:"20px"},children:[i.jsxs("p",{className:"no-data-message",style:{background:"none",border:"none",padding:0},children:['No patients found matching "',T,'".']}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"15px",marginTop:"15px"},children:[te&&i.jsxs("button",{type:"button",onClick:()=>pe("phone"),className:"secondary-button",children:['Create "Direct Lab" Patient (Phone: ',T,")"]}),G&&i.jsxs("button",{type:"button",onClick:()=>pe("name"),className:"secondary-button",children:["Create Patient (Name: ",T,")"]})]})]}),T.length<2&&!B&&i.jsx("div",{className:"info-message",children:"Start typing to search for a patient..."})]}),t==="create_patient"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"New Patient Registration"}),i.jsx("button",{onClick:Ce,className:"text-button",children:" Back to Search "})]}),H&&i.jsxs("div",{className:"error-message",children:[i.jsx(Ar,{size:18}),H]}),i.jsxs("form",{onSubmit:ee,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-name",className:"form-label",children:"Patient Name *"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Ts,{className:"search-icon",size:18}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:Z,className:"modern-input",placeholder:"Enter full name"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:Z,className:"modern-input",style:{paddingLeft:"16px"},placeholder:"e.g. 30"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:Z,className:"modern-input",style:{paddingLeft:"16px"},children:[i.jsx("option",{value:"",children:"Select Gender..."}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-phone",className:"form-label",children:"Phone Number"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Gk,{className:"search-icon",size:18}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:Z,className:"modern-input",placeholder:"e.g. 9876543210"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-address",className:"form-label",children:"Address"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Hk,{className:"search-icon",size:18,style:{top:"20px"}}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:Z,className:"modern-input",style:{resize:"none"},placeholder:"Enter address (optional)"})]})]})]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:Ce,className:"secondary-button",children:" Cancel "}),i.jsxs("button",{type:"submit",className:"primary-button",children:[i.jsx(_s,{size:18}),"Create & Proceed"]})]})]})]})]}),t==="create_order"&&l&&i.jsxs("div",{className:"glass-card",children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Create Lab Order"}),i.jsx("button",{onClick:Ce,className:"text-button",children:" Change Patient "})]}),i.jsxs("div",{className:"patient-summary",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(Ts,{size:20,className:"highlight-primary"}),i.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"600"},children:l.name})]}),i.jsxs("div",{className:"patient-details",style:{marginLeft:"30px",marginTop:"4px"},children:[l.age?`${l.age} yrs`:"Age N/A",l.gender&&`  ${l.gender}`,l.phone&&`  ${l.phone}`]})]}),M&&i.jsxs("div",{className:"error-message",children:[i.jsx(Ar,{size:18}),M]}),i.jsxs("form",{onSubmit:He,children:[i.jsxs("div",{className:"form-group",style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",className:"form-label",children:"Add Lab Test"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Pr,{className:"search-icon",size:18}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search tests (e.g. CBC, Lipid Profile)...",value:b,onChange:he=>v(he.target.value),className:"modern-input",disabled:z,autoComplete:"off"}),z&&i.jsx("div",{className:"loading-spinner-small",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)"}})]}),b&&S.length>0&&i.jsx("div",{className:"search-results-dropdown",children:S.map(he=>i.jsxs("div",{onClick:()=>X(he),className:"search-result-item",children:[i.jsx("span",{style:{fontWeight:500},children:he.name}),i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(he.price).toFixed(2)]})]},he.id))}),b&&S.length===0&&!z&&i.jsxs("div",{className:"no-data-message",style:{marginTop:"5px",padding:"10px",fontSize:"0.9rem"},children:['No tests found matching "',b,'".']})]}),i.jsxs("div",{style:{marginTop:"30px"},children:[i.jsxs("h4",{className:"card-title",style:{fontSize:"1.1rem"},children:["Selected Tests (",h.length,")"]}),h.length===0?i.jsx("div",{className:"info-message",children:"No tests added yet. Search above to add tests."}):i.jsx("div",{className:"selected-tests-list",children:h.map(he=>i.jsxs("div",{className:"selected-test-item",children:[i.jsx("div",{style:{flex:1},children:i.jsx("div",{style:{fontWeight:500},children:he.name})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(he.price).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>ye(he.id),className:"remove-button",title:"Remove Test",children:i.jsx(jr,{size:18})})]})]},he.id))})]}),h.length>0&&i.jsxs("div",{className:"total-price",children:["Total: ",h.reduce((he,Le)=>he+parseFloat(Le.price),0).toFixed(2)]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:Ce,className:"secondary-button",children:" Cancel Order "}),i.jsxs("button",{type:"submit",disabled:h.length===0,className:"primary-button",children:[i.jsx(k1,{size:18}),"Create Lab Order"]})]})]})]})]})},dQ=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[o,l]=w.useState([]),[d,f]=w.useState(!0),[u,h]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(null),P=Dt(),R=Ur(),I=async()=>{f(!0),T(null);let M=[];try{const $=await me("/api/queue");if(!$.ok){const te=await $.json();throw new Error(te.message||"Failed to fetch queue")}M=await $.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(M,null,2));const z=M.map(async te=>{if(!te.patient_id)return console.warn(`Queue entry ${te.id} has no patient_id.`),te;try{const V=await me(`/api/patients/${te.patient_id}`);if(!V.ok)return console.error(`Failed to fetch patient details for ${te.patient_id}: ${V.status}`),te;const G=await V.json();return{...te,Patient:{...te.Patient??{},...G}}}catch(V){return console.error(`Error fetching patient details for ${te.patient_id}:`,V),te}}),W=await Promise.all(z);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(W,null,2)),W.sort((te,V)=>{var E,ce;const G=((E=te.Patient)==null?void 0:E.subscription_status)==="active",J=((ce=V.Patient)==null?void 0:ce.subscription_status)==="active";if(G&&!J)return-1;if(!G&&J)return 1;const oe=te.created_at?new Date(te.created_at).getTime():0,ie=V.created_at?new Date(V.created_at).getTime():0;return oe-ie}),console.log("Sorted Queue Data:",JSON.stringify(W,null,2)),l(W)}catch($){console.error("Error in fetchQueue process:",$),T(`Failed to load queue: ${$.message}`),l(M)}finally{f(!1)}},B=async()=>{b(!0),T(null);try{const M=await me("/api/staff?role=doctor");if(!M.ok){const z=await M.json();throw new Error(z.message||"Failed to fetch doctors")}const $=await M.json();h($.filter(z=>z.active))}catch(M){console.error("Error fetching doctors:",M),T(`Failed to fetch doctors: ${M.message}`)}finally{b(!1)}};w.useEffect(()=>{const $=new URLSearchParams(R.search).get("tab");$&&U.find(W=>W.id===$)&&t($)},[R.search]),w.useEffect(()=>{n==="queue"&&(I(),B()),S(null)},[n]);const F=w.useCallback(async(M,$)=>{if(console.log(`Attempting to assign doctor ${$} to queue ${M}`),T(null),S(null),!$){console.log("No doctor ID provided, skipping assignment.");return}const z=o.find(V=>V.id===M);if(!z){console.error(`Queue entry ${M} not found in local state.`),T("Queue entry not found.");return}if(z.doctor_id===$){console.log(`Queue ${M} already assigned to doctor ${$}. Skipping.`);return}const W=async V=>{if(!V||!V.id||!V.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",V);return}const G=async()=>{try{const J={status:"waiting",doctorId:$},oe=await me(`/api/queue/${M}/status`,{method:"PATCH",body:JSON.stringify(J)}),ie=await oe.json();if(!oe.ok)throw new Error(ie.message||`HTTP error! status: ${oe.status}`);const E=u.find(ce=>ce.id===$);return console.log(`Successfully assigned doctor ${E==null?void 0:E.name} to queue ${M}.`),l(ce=>ce.map(ge=>ge.id===M?{...ge,doctor_id:$,status:ie.status||ge.status,User:E?{name:E.name}:null,Patient:V}:ge)),!0}catch(J){return console.error(`Error assigning doctor for queue ${M}:`,J),T(`Failed to assign doctor: ${J.message}`),!1}};V.subscription_status==="active"?(console.log(`Patient ${V.name} (ID: ${V.id}) has active subscription. Assigning doctor directly.`),await G()):(console.log(`Patient ${V.name} (ID: ${V.id}) does not have active subscription (Status: ${V.subscription_status}). Assigning doctor and proceeding to billing.`),await G()?(console.log(`Navigating to billing for patient ${V.name} (ID: ${V.id}), queue ID: ${M}, doctor ID: ${$}`),P("/billing",{state:{patientId:V.id,queueId:M,patientName:V.name,doctorId:$,billType:"consultation"}})):console.log(`Assignment failed for patient ${V.name}, skipping navigation.`))},te=z.Patient;if(te&&te.id&&te.name)console.log("Patient details found in state. Proceeding with assignment."),await W(te);else{console.warn(`Patient details missing for queue entry ${M}. Fetching patient ${z.patient_id}...`);try{const V=await me(`/api/patients/${z.patient_id}`);if(!V.ok){const J=await V.json().catch(()=>({}));throw new Error(J.message||`Failed to fetch patient details (status ${V.status})`)}const G=await V.json();console.log("Successfully fetched patient details:",G),await W(G)}catch(V){console.error(`Failed to fetch patient details for patient ID ${z.patient_id}:`,V),T(`Failed to fetch required patient details: ${V.message}`)}}},[u,o,P]),L=async(M,$)=>{T(null);const z=$==="consulting"?"start consultation":"complete visit";try{const W=o.find(J=>J.id===M);if(!W&&$==="consulting")throw new Error("Queue entry not found to start consultation.");let te={status:$};if($==="consulting"){if(!(W!=null&&W.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");te.doctorId=W.doctor_id}const V=await me(`/api/queue/${M}/status`,{method:"PATCH",body:JSON.stringify(te)}),G=await V.json();if(!V.ok)throw new Error(G.message||`HTTP error! status: ${V.status}`);l(J=>J.map(oe=>oe.id===M?{...oe,status:$}:oe))}catch(W){console.error(`Error trying to ${z}:`,W),T(`Failed to ${z}: ${W.message}`)}},U=[{id:"queue",label:"Queue",icon:i.jsx(ep,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(Pr,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(O3,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(D6,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(_1,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(Qa,{size:20})}],H=M=>{try{return new Date(M).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},K=o.filter(M=>{var $,z;return(z=($=M.Patient)==null?void 0:$.name)==null?void 0:z.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",U.map(M=>i.jsxs("button",{className:`reception-tab-button ${n===M.id?"active":""}`,onClick:()=>t(M.id),children:[i.jsx("span",{children:M.icon}),M.label]},M.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:M=>a(M.target.value)}),i.jsx(Pr,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(M=>M.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(M=>M.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(M=>M.status==="seen").length})," "]})]})]}),d?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):K.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:K.map(M=>{var $,z,W,te,V,G,J,oe,ie,E,ce;return i.jsxs("tr",{onClick:()=>P(`/dashboard/edit-complaint/${M.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",M.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:(($=M.Patient)==null?void 0:$.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[(z=M.Patient)!=null&&z.age?`${M.Patient.age} yrs, `:"",((W=M.Patient)==null?void 0:W.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((te=M.Patient)==null?void 0:te.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:M.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((V=M.Patient)==null?void 0:V.subscription_status)==="active"?"status-active":((G=M.Patient)==null?void 0:G.subscription_status)==="cancelled"||((J=M.Patient)==null?void 0:J.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((oe=M.Patient)==null?void 0:oe.subscription_status)??"None"}),M.Patient&&M.Patient.id&&M.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:ge=>{ge.stopPropagation(),M.Patient&&P(`/start-subscription/${M.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:H(M.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===M.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:ge=>ge.stopPropagation(),children:i.jsxs("select",{value:"",onChange:ge=>F(M.id,ge.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(ge=>i.jsx("option",{value:ge.id,children:ge.name},ge.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:ge=>ge.stopPropagation(),children:[" ",M.status==="waiting"&&i.jsx(i.Fragment,{children:(ie=M.User)!=null&&ie.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:M.User.name}),i.jsx("button",{onClick:()=>L(M.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):u.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?i.jsxs("button",{onClick:()=>F(M.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):i.jsx("button",{onClick:()=>S(M.id),className:"action-button btn-assign",children:"Assign"})}),M.status==="consulting"&&i.jsxs(i.Fragment,{children:[((E=M.User)==null?void 0:E.name)&&i.jsx("span",{className:"doctor-name-display",children:M.User.name}),i.jsx("button",{onClick:()=>L(M.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),M.status==="seen"&&i.jsxs(i.Fragment,{children:[((ce=M.User)==null?void 0:ce.name)&&i.jsx("span",{className:"doctor-name-display",children:M.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),M.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},M.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(AE,{currentUser:e}),i.jsxs("button",{onClick:()=>P("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(Pr,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(Gm,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(TE,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(Z1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(EE,{})})]})})},PE=6048e5,fQ=864e5,DE=6e4,IE=36e5,Z_=Symbol.for("constructDateFrom");function go(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&Z_ in e?e[Z_](n):e instanceof Date?new e.constructor(n):new Date(n)}function Bi(e,n){return go(n||e,e)}function hQ(e,n,t){const r=Bi(e,t==null?void 0:t.in);if(isNaN(n))return go(e,NaN);const a=r.getDate(),o=go(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}let pQ={};function ev(){return pQ}function og(e,n){var d,f,u,h;const t=ev(),r=(n==null?void 0:n.weekStartsOn)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??0,a=Bi(e,n==null?void 0:n.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function wb(e,n){return og(e,{...n,weekStartsOn:1})}function RE(e,n){const t=Bi(e,n==null?void 0:n.in),r=t.getFullYear(),a=go(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=wb(a),l=go(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const d=wb(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function ej(e){const n=Bi(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function mQ(e,...n){const t=go.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function tj(e,n){const t=Bi(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function gQ(e,n,t){const[r,a]=mQ(t==null?void 0:t.in,e,n),o=tj(r),l=tj(a),d=+o-ej(o),f=+l-ej(l);return Math.round((d-f)/fQ)}function yQ(e,n){const t=RE(e,n),r=go(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),wb(r)}function xQ(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ew(e){return!(!xQ(e)&&typeof e!="number"||isNaN(+Bi(e)))}function bQ(e,n){const t=Bi(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const vQ={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},wQ=(e,n,t)=>{let r;const a=vQ[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function U0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const SQ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},NQ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},CQ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_Q={date:U0({formats:SQ,defaultWidth:"full"}),time:U0({formats:NQ,defaultWidth:"full"}),dateTime:U0({formats:CQ,defaultWidth:"full"})},jQ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},kQ=(e,n,t,r)=>jQ[e];function $m(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,d=t!=null&&t.width?String(t.width):l;a=e.formattingValues[d]||e.formattingValues[l]}else{const l=e.defaultWidth,d=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[d]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const TQ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},EQ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},AQ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},PQ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},DQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},IQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},RQ=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},MQ={ordinalNumber:RQ,era:$m({values:TQ,defaultWidth:"wide"}),quarter:$m({values:EQ,defaultWidth:"wide",argumentCallback:e=>e-1}),month:$m({values:AQ,defaultWidth:"wide"}),day:$m({values:PQ,defaultWidth:"wide"}),dayPeriod:$m({values:DQ,defaultWidth:"wide",formattingValues:IQ,defaultFormattingWidth:"wide"})};function zm(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],d=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(d)?LQ(d,g=>g.test(l)):OQ(d,g=>g.test(l));let u;u=e.valueCallback?e.valueCallback(f):f,u=t.valueCallback?t.valueCallback(u):u;const h=n.slice(l.length);return{value:u,rest:h}}}function OQ(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function LQ(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function FQ(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const d=n.slice(a.length);return{value:l,rest:d}}}const $Q=/^(\d+)(th|st|nd|rd)?/i,zQ=/\d+/i,BQ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},UQ={any:[/^b/i,/^(a|c)/i]},qQ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},VQ={any:[/1/i,/2/i,/3/i,/4/i]},HQ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},GQ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},YQ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},WQ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},QQ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},JQ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},KQ={ordinalNumber:FQ({matchPattern:$Q,parsePattern:zQ,valueCallback:e=>parseInt(e,10)}),era:zm({matchPatterns:BQ,defaultMatchWidth:"wide",parsePatterns:UQ,defaultParseWidth:"any"}),quarter:zm({matchPatterns:qQ,defaultMatchWidth:"wide",parsePatterns:VQ,defaultParseWidth:"any",valueCallback:e=>e+1}),month:zm({matchPatterns:HQ,defaultMatchWidth:"wide",parsePatterns:GQ,defaultParseWidth:"any"}),day:zm({matchPatterns:YQ,defaultMatchWidth:"wide",parsePatterns:WQ,defaultParseWidth:"any"}),dayPeriod:zm({matchPatterns:QQ,defaultMatchWidth:"any",parsePatterns:JQ,defaultParseWidth:"any"})},XQ={code:"en-US",formatDistance:wQ,formatLong:_Q,formatRelative:kQ,localize:MQ,match:KQ,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ZQ(e,n){const t=Bi(e,n==null?void 0:n.in);return gQ(t,bQ(t))+1}function eJ(e,n){const t=Bi(e,n==null?void 0:n.in),r=+wb(t)-+yQ(t);return Math.round(r/PE)+1}function ME(e,n){var h,g,b,v;const t=Bi(e,n==null?void 0:n.in),r=t.getFullYear(),a=ev(),o=(n==null?void 0:n.firstWeekContainsDate)??((g=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=go((n==null?void 0:n.in)||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const d=og(l,n),f=go((n==null?void 0:n.in)||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const u=og(f,n);return+t>=+d?r+1:+t>=+u?r:r-1}function tJ(e,n){var d,f,u,h;const t=ev(),r=(n==null?void 0:n.firstWeekContainsDate)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,a=ME(e,n),o=go((n==null?void 0:n.in)||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),og(o,n)}function nJ(e,n){const t=Bi(e,n==null?void 0:n.in),r=+og(t,n)-+tJ(t,n);return Math.round(r/PE)+1}function er(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const pu={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return er(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):er(t+1,2)},d(e,n){return er(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return er(e.getHours()%12||12,n.length)},H(e,n){return er(e.getHours(),n.length)},m(e,n){return er(e.getMinutes(),n.length)},s(e,n){return er(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return er(a,n.length)}},Ah={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},nj={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return pu.y(e,n)},Y:function(e,n,t,r){const a=ME(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return er(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):er(o,n.length)},R:function(e,n){const t=RE(e);return er(t,n.length)},u:function(e,n){const t=e.getFullYear();return er(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return er(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return er(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return pu.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return er(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=nJ(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):er(a,n.length)},I:function(e,n,t){const r=eJ(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):er(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):pu.d(e,n)},D:function(e,n,t){const r=ZQ(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):er(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return er(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return er(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return er(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Ah.noon:r===0?a=Ah.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Ah.evening:r>=12?a=Ah.afternoon:r>=4?a=Ah.morning:a=Ah.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return pu.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):pu.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):er(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):er(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):pu.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):pu.s(e,n)},S:function(e,n){return pu.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return ij(r);case"XXXX":case"XX":return qd(r);case"XXXXX":case"XXX":default:return qd(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return ij(r);case"xxxx":case"xx":return qd(r);case"xxxxx":case"xxx":default:return qd(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+rj(r,":");case"OOOO":default:return"GMT"+qd(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+rj(r,":");case"zzzz":default:return"GMT"+qd(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return er(r,n.length)},T:function(e,n,t){return er(+e,n.length)}};function rj(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+er(o,2)}function ij(e,n){return e%60===0?(e>0?"-":"+")+er(Math.abs(e)/60,2):qd(e,n)}function qd(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=er(Math.trunc(r/60),2),o=er(r%60,2);return t+a+n+o}const aj=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},OE=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},rJ=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return aj(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",aj(r,n)).replace("{{time}}",OE(a,n))},iJ={p:OE,P:rJ},aJ=/^D+$/,sJ=/^Y+$/,oJ=["D","DD","YY","YYYY"];function lJ(e){return aJ.test(e)}function cJ(e){return sJ.test(e)}function uJ(e,n,t){const r=dJ(e,n,t);if(console.warn(r),oJ.includes(e))throw new RangeError(r)}function dJ(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const fJ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,hJ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,pJ=/^'([^]*?)'?$/,mJ=/''/g,gJ=/[a-zA-Z]/;function Yd(e,n,t){var h,g,b,v;const r=ev(),a=r.locale??XQ,o=r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,l=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,d=Bi(e,t==null?void 0:t.in);if(!ew(d))throw new RangeError("Invalid time value");let f=n.match(hJ).map(S=>{const k=S[0];if(k==="p"||k==="P"){const T=iJ[k];return T(S,a.formatLong)}return S}).join("").match(fJ).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:yJ(S)};if(nj[k])return{isToken:!0,value:S};if(k.match(gJ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(f=a.localize.preprocessor(d,f));const u={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(S=>{if(!S.isToken)return S.value;const k=S.value;(cJ(k)||lJ(k))&&uJ(k,n,String(e));const T=nj[k[0]];return T(d,k,a.localize,u)}).join("")}function yJ(e){const n=e.match(pJ);return n?n[1].replace(mJ,"'"):e}function q0(e,n){return+Bi(e)<+Bi(n)}function sj(e,n){const t=()=>go(n==null?void 0:n.in,NaN),a=wJ(e);let o;if(a.date){const u=SJ(a.date,2);o=NJ(u.restDateString,u.year)}if(!o||isNaN(+o))return t();const l=+o;let d=0,f;if(a.time&&(d=CJ(a.time),isNaN(d)))return t();if(a.timezone){if(f=_J(a.timezone),isNaN(f))return t()}else{const u=new Date(l+d),h=Bi(0,n==null?void 0:n.in);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return Bi(l+d+f,n==null?void 0:n.in)}const Ix={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},xJ=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,bJ=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,vJ=/^([+-])(\d{2})(?::?(\d{2}))?$/;function wJ(e){const n={},t=e.split(Ix.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],Ix.timeZoneDelimiter.test(n.date)&&(n.date=e.split(Ix.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=Ix.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function SJ(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function NJ(e,n){if(n===null)return new Date(NaN);const t=e.match(xJ);if(!t)return new Date(NaN);const r=!!t[4],a=Bm(t[1]),o=Bm(t[2])-1,l=Bm(t[3]),d=Bm(t[4]),f=Bm(t[5])-1;if(r)return AJ(n,d,f)?jJ(n,d,f):new Date(NaN);{const u=new Date(0);return!TJ(n,o,l)||!EJ(n,a)?new Date(NaN):(u.setUTCFullYear(n,o,Math.max(a,l)),u)}}function Bm(e){return e?parseInt(e):1}function CJ(e){const n=e.match(bJ);if(!n)return NaN;const t=V0(n[1]),r=V0(n[2]),a=V0(n[3]);return PJ(t,r,a)?t*IE+r*DE+a*1e3:NaN}function V0(e){return e&&parseFloat(e.replace(",","."))||0}function _J(e){if(e==="Z")return 0;const n=e.match(vJ);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return DJ(r,a)?t*(r*IE+a*DE):NaN}function jJ(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const kJ=[31,null,31,30,31,30,31,31,30,31,30,31];function LE(e){return e%400===0||e%4===0&&e%100!==0}function TJ(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(kJ[n]||(LE(e)?29:28))}function EJ(e,n){return n>=1&&n<=(LE(e)?366:365)}function AJ(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function PJ(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function DJ(e,n){return n>=0&&n<=59}const dS=({isEmbedded:e=!1})=>{const[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(null),g=w.useRef(null),[b,v]=w.useState(!1),[S,k]=w.useState(null),[T,P]=w.useState(!1),[R,I]=w.useState(!1),[B,F]=w.useState(null),[L,U]=w.useState({name:"",description:"",price:"",default_parameters:[]}),H=w.useCallback(async()=>{a(!0),l(null),h(null),k(null);try{const D=await me("/api/lab-tests");if(!D.ok)throw new Error(`HTTP error! status: ${D.status}`);const pe=await D.json();t(pe)}catch(D){console.error("Error fetching lab tests:",D),l(D.message||"Failed to fetch lab tests.")}finally{a(!1)}},[]);w.useEffect(()=>{H()},[H]);const K=D=>{const{name:pe,value:Ce}=D.target;U(Z=>({...Z,[pe]:Ce}))},M=(D,pe,Ce)=>{const Z=[...L.default_parameters],ee=Z[D];if(pe==="type")switch(ee.type=Ce,Ce){case"number":ee.defaultValue=0,ee.lower_limit=null,ee.upper_limit=null,ee.unit="";break;case"boolean":ee.defaultValue=!1,ee.lower_limit=void 0,ee.upper_limit=void 0,ee.unit=void 0;break;case"string":default:ee.defaultValue="",ee.lower_limit=void 0,ee.upper_limit=void 0,ee.unit=void 0;break}else pe==="defaultValue"?ee.type==="number"?ee.defaultValue=parseFloat(Ce)||0:(ee.type,ee.defaultValue=Ce):pe==="lower_limit"||pe==="upper_limit"?ee[pe]=Ce===""?null:parseFloat(Ce):ee[pe]=Ce;U(X=>({...X,default_parameters:Z}))},$=()=>{U(D=>({...D,default_parameters:[...D.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},z=D=>{U(pe=>({...pe,default_parameters:pe.default_parameters.filter((Ce,Z)=>Z!==D)}))},W=async D=>{D.preventDefault(),a(!0),l(null);const pe=B!==null,Ce=pe?`/api/lab-tests/${B}`:"/api/lab-tests",Z=pe?"PUT":"POST";try{const ee=await me(Ce,{method:Z,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:L.name,description:L.description,price:parseFloat(L.price),default_parameters:L.default_parameters})});if(!ee.ok){const X=await ee.json();throw new Error(X.message||`HTTP error! status: ${ee.status}`)}I(!1),F(null),U({name:"",description:"",price:"",default_parameters:[]}),H()}catch(ee){console.error(`Error ${pe?"updating":"adding"} lab test:`,ee),l(ee.message||`Failed to ${pe?"update":"add"} lab test.`)}finally{a(!1)}},te=()=>{F(null),U({name:"",description:"",price:"",default_parameters:[]}),I(!0)},V=D=>{if(B===D.id)F(null);else{F(D.id);const pe=(D.default_parameters||[]).map(Ce=>({...Ce,unit:Ce.unit||"",lower_limit:Ce.lower_limit===void 0?null:Ce.lower_limit,upper_limit:Ce.upper_limit===void 0?null:Ce.upper_limit}));U({name:D.name,description:D.description||"",price:D.price,default_parameters:pe}),I(!1)}},G=async D=>{if(window.confirm("Are you sure you want to delete this lab test?")){a(!0),l(null);try{const pe=await me(`/api/lab-tests/${D}`,{method:"DELETE"});if(!pe.ok){const Ce=await pe.json();throw new Error(Ce.message||`HTTP error! status: ${pe.status}`)}H()}catch(pe){console.error("Error deleting lab test:",pe),l(pe.message||"Failed to delete lab test.")}finally{a(!1)}}},J=()=>{I(!1),F(null),l(null),U({name:"",description:"",price:"",default_parameters:[]})},oe=async D=>{if(!D){h("No file selected.");return}f(!0),h(null),l(null);const pe=new FormData;pe.append("file",D);try{const Ce=await me("/api/lab-tests/import",{method:"POST",body:pe});if(!Ce.ok){const Z=await Ce.json();throw new Error(Z.message||`Import failed: ${Ce.statusText}`)}H()}catch(Ce){console.error("Error importing lab tests from Excel:",Ce),h(Ce.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},ie=async D=>{if(D.target.files&&D.target.files[0]){const pe=D.target.files[0];await oe(pe),D.target&&(D.target.value="")}},E=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){v(!0),k(null),l(null);try{const D=await me("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!D.ok){const pe=await D.json();throw new Error(pe.message||`Default import failed: ${D.statusText}`)}H()}catch(D){console.error("Error importing default lab tests:",D),k(D.message||"Failed to import default lab tests.")}finally{v(!1)}}},ce=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){P(!0),l(null),h(null),k(null);try{const D=await me("/api/lab-tests/all",{method:"DELETE"});if(!D.ok){const pe=await D.json();throw new Error(pe.message||`Delete all failed: ${D.statusText}`)}H()}catch(D){console.error("Error deleting all lab tests:",D),l(D.message||"Failed to delete all lab tests.")}finally{P(!1)}}},ge=r||d||b||T;return i.jsxs("div",{className:`lab-inventory-card ${e?"embedded":""}`,style:e?{border:"none",boxShadow:"none",padding:0}:{},children:[!e&&i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:te,className:"lab-inventory-button",disabled:ge,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var D;return(D=g.current)==null?void 0:D.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:ge,children:d?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:g,onChange:ie,accept:".xlsx, .xls",style:{display:"none"},disabled:d}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ge,children:b?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:ce,className:"lab-inventory-button lab-inventory-button-danger",disabled:ge,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:T?"Deleting All...":"Delete All Tests"})]}),o&&i.jsx("div",{className:"error-text mb-4",children:o}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),S&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",S]}),R&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:W,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:K,className:"lab-inventory-input",required:!0,disabled:ge})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:K,rows:3,className:"lab-inventory-input",disabled:ge})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price==="0"?"":L.price,onChange:K,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ge})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),L.default_parameters.map((D,pe)=>{var Ce,Z;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:D.name,onChange:ee=>M(pe,"name",ee.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:D.type,onChange:ee=>M(pe,"type",ee.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),D.type==="boolean"?i.jsxs("select",{value:D.defaultValue.toString(),onChange:ee=>M(pe,"defaultValue",ee.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:D.type==="number"?"number":"text",placeholder:"Default Value",value:D.defaultValue===0?"":D.defaultValue.toString(),onChange:ee=>M(pe,"defaultValue",ee.target.value),className:"lab-inventory-input"}),D.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:D.lower_limit===null?"":((Ce=D.lower_limit)==null?void 0:Ce.toString())??"",onChange:ee=>M(pe,"lower_limit",ee.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:D.upper_limit===null?"":((Z=D.upper_limit)==null?void 0:Z.toString())??"",onChange:ee=>M(pe,"upper_limit",ee.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:D.unit||"",onChange:ee=>M(pe,"unit",ee.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>z(pe),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},pe)}),i.jsx("button",{type:"button",onClick:$,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:J,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ge,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ge,children:r?"Saving...":"Add Test"})]})]})]}),ge&&!R&&i.jsxs("p",{className:"loading-text",children:[" ",d?"Importing Excel data...":b?"Importing default data...":"Loading tests..."]}),!ge&&n.length===0&&!o&&!u&&!S&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!ge&&n.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:n.map(D=>{const pe=B===D.id,Ce=D.price&&typeof D.price=="string"?parseFloat(D.price):NaN,Z=isNaN(Ce)?"0.00":Ce.toFixed(2);return i.jsxs(Pn.Fragment,{children:[i.jsxs("tr",{onClick:()=>V(D),style:{cursor:"pointer"},children:[i.jsx("td",{children:D.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:D.description||"-"}),i.jsxs("td",{children:["",Z]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:ee=>{ee.stopPropagation(),V(D)},className:"lab-inventory-link",disabled:ge,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:ee=>{ee.stopPropagation(),G(D.id)},className:"lab-inventory-link",disabled:ge,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),pe&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:W,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:K,className:"lab-inventory-input",required:!0,disabled:ge})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:K,rows:3,className:"lab-inventory-input",disabled:ge})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price==="0"?"":L.price,onChange:K,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ge})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),L.default_parameters.map((ee,X)=>{var ye,He;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:ee.name,onChange:he=>M(X,"name",he.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:ee.type,onChange:he=>M(X,"type",he.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),ee.type==="boolean"?i.jsxs("select",{value:ee.defaultValue.toString(),onChange:he=>M(X,"defaultValue",he.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:ee.type==="number"?"number":"text",placeholder:"Default Value",value:ee.defaultValue===0?"":ee.defaultValue.toString(),onChange:he=>M(X,"defaultValue",he.target.value),className:"lab-inventory-input"}),ee.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:ee.lower_limit===null?"":((ye=ee.lower_limit)==null?void 0:ye.toString())??"",onChange:he=>M(X,"lower_limit",he.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:ee.upper_limit===null?"":((He=ee.upper_limit)==null?void 0:He.toString())??"",onChange:he=>M(X,"upper_limit",he.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:ee.unit||"",onChange:he=>M(X,"unit",he.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>z(X),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},X)}),i.jsx("button",{type:"button",onClick:$,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:J,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ge,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ge,children:r?"Saving...":"Update Test"})]})]})]})})})]},D.id)})})]})]})]})},IJ=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([o,l])=>{var h;const d=(h=r.default_parameters)==null?void 0:h.find(g=>g.name===o);let f=String(l),u="";if(d){const g=d.unit?` _${d.unit}_`:"";if(d.type==="boolean"){const b=l===!0||l==="true";f=b?"*Reactive*":"Non-Reactive",b||(u="`Normal: Non-Reactive`")}else if(d.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(d.lower_limit!=null||d.upper_limit!=null){let v=[];d.lower_limit!=null&&v.push(`${d.lower_limit}`),d.upper_limit!=null&&v.push(`${d.upper_limit}`),u=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(d.lower_limit!=null&&b<d.lower_limit||d.upper_limit!=null&&b>d.upper_limit)&&(f=`*${f}*`)}}d.unit&&(f+=g)}n+=`${o}: ${f}
`,u&&((d==null?void 0:d.type)==="boolean"&&(l===!0||l==="true")||(n+=`${u}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},fS=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=IJ(e),r=`Hello ${n},

Your lab report is ready.

${t}`,o=`https://wa.me/${RJ(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(o,"_blank")},RJ=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},MJ=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState("orders"),[h,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async(H=1,K="")=>{o(!0),d(null);try{const M=new URLSearchParams({page:String(H),limit:String(b)});K&&M.append("search",K);const $=await me(`/api/lab?${M.toString()}`);if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const z=await $.json(),W=z.orders.map(te=>{var V,G;return{id:te.id,labTokenNumber:String(te.lab_token_number??"N/A"),patientName:((V=te.Patient)==null?void 0:V.name)||"N/A",patientId:te.patient_id,patientTokenNumber:String(((G=te.Patient)==null?void 0:G.patient_token_number)??"N/A"),tests:(te.tests||[]).map(J=>J.name||"Unknown Test"),date:Yd(new Date(te.createdAt),"yyyy-MM-dd"),status:te.status,reportId:te.reportId,billId:te.billId}});n(W),S(z.totalCount),g(H)}catch(M){console.error("Failed to fetch lab orders:",M),d(M instanceof Error?M.message:"An unknown error occurred"),n([]),S(0)}finally{o(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${h}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(h,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,h,t]),w.useEffect(()=>{const H=setTimeout(()=>{t.length>=2?h!==1&&g(1):t.length<2&&h!==1&&g(1)},1e3);return()=>{clearTimeout(H)}},[t]);const P=async(H,K)=>{console.log(`Updating order ${H} to status ${K}`);try{const M=await me(`/api/lab/${H}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:K})});if(!M.ok){const $=await M.json();throw new Error($.message||`Failed to update status: ${M.status}`)}if(K==="completed"){const $=await me(`/api/lab/orders/${H}/report`);if($.ok){const z=await $.json();fS(z)}}await T(h,t),console.log(`Order ${H} status updated to ${K}, refetching page ${h}`)}catch(M){console.error("Error updating status:",M),alert(`Failed to update status: ${M instanceof Error?M.message:"Unknown error"}`)}},R=Dt(),I=H=>{if(!H){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}H.billId?(console.log(`Navigating to existing bill for Bill ID: ${H.billId}, Patient: ${H.patientName}`),R("/billing",{state:{billId:H.billId,patientId:H.patientId,patientName:H.patientName,billType:"lab"}})):(console.log(`Navigating to LabBillingPage for Order ID: ${H.id}`),R(`/dashboard/lab-billing/${H.id}`))},B=H=>{H&&H.id?R(`/lab/report/${H.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},F=H=>{switch(H){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:H,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(Ar,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:l}),i.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const L=()=>{h>1&&g(H=>H-1)},U=()=>{h<k&&g(H=>H+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>R(-1),className:"back-button mr-4",children:i.jsx(cn,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>u("orders"),className:`lab-inventory-button ${f==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(Uk,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>R("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>u("inventory"),className:`lab-inventory-button ${f==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(R3,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),f==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:H=>r(H.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(Pr,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map(H=>{const K=F(H.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:H.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",H.patientTokenNumber]})]}),i.jsx("td",{children:H.tests.map((M,$)=>i.jsx("div",{children:M},$))}),i.jsx("td",{className:"hidden md:table-cell",children:H.date}),i.jsx("td",{children:i.jsx("span",{className:K.className,children:K.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[H.status==="pending"&&i.jsx("button",{onClick:()=>I(H),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),H.status==="billed"&&i.jsx("button",{onClick:()=>P(H.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),H.status==="collected"&&i.jsx("button",{onClick:()=>P(H.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(H.status==="processing"||H.status==="report_ready"||H.status==="reported")&&i.jsx("button",{onClick:()=>B(H),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(H.status==="report_ready"||H.status==="reported")&&i.jsx("button",{onClick:()=>P(H.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(H.status==="completed"||H.status==="report_ready"||H.status==="reported")&&i.jsx("button",{onClick:()=>{H.id?R(`/lab/view-report/${H.id}`):(console.error("Attempted to view report for an order with no ID:",H),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},H.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map(H=>{const K=F(H.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:H.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",H.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:H.date})]}),i.jsx("span",{className:`${K.className} lab-card-status-pill`,children:K.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),H.tests.map((M,$)=>i.jsx("div",{className:"lab-card-test-item",children:M},$)),H.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[H.status==="pending"&&i.jsx("button",{onClick:()=>I(H),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),H.status==="billed"&&i.jsx("button",{onClick:()=>P(H.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),H.status==="collected"&&i.jsx("button",{onClick:()=>P(H.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(H.status==="processing"||H.status==="report_ready"||H.status==="reported")&&i.jsx("button",{onClick:()=>B(H),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(H.status==="report_ready"||H.status==="reported")&&i.jsx("button",{onClick:()=>P(H.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(H.status==="completed"||H.status==="report_ready"||H.status==="reported")&&i.jsx("button",{onClick:()=>{H.id?R(`/lab/view-report/${H.id}`):(console.error("Attempted to view report for an order with no ID:",H),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},H.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(h-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(h*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:L,disabled:h===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(Ib,{size:18})}),i.jsxs("span",{children:["Page ",h," of ",k]}),i.jsx("button",{onClick:U,disabled:h===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(Zh,{size:18})})]})]})]}),f==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(dS,{})]})]})]})},OJ=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=Dt(),u=w.useRef(null),[h,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),T=10,P=w.useCallback(async(U,H,K)=>{o(!0),d(null);try{let M=`/api/pharmacy-orders?page=${U}&limit=${H}`;K&&K.trim()!==""&&(M+=`&search=${encodeURIComponent(K.trim())}`);const $=await me(M);if(!$.ok)throw new Error(`Failed to fetch orders: ${$.statusText} (${$.status})`);const z=await $.json();if(z&&Array.isArray(z.orders)&&typeof z.totalOrders=="number"&&typeof z.totalPages=="number")console.log("Fetched pharmacy orders data:",z.orders),n(z.orders),k(z.totalOrders),v(z.totalPages),g(z.currentPage||U);else throw console.error("Received data does not match expected paginated structure:",z),new Error("Invalid data format received from API")}catch(M){console.error("Failed to fetch pharmacy orders:",M),d(M.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{o(!1)}},[]);w.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const U=t===""?h:1;t!==""&&h!==1&&g(1),P(U,T,t)},500),()=>{u.current&&clearTimeout(u.current)}),[t,h,P,T]);const R=U=>{f(`/dashboard/edit-pharmacy-order/${U}`)},I=U=>{d(null),console.log(`Preparing billing navigation for order: ${U}`);const H=e.find(K=>K.id===U);if(H){const K=H.medications.map(M=>{const $=M.price??0;return(M.price===void 0||M.price===null)&&console.warn(`Medication "${M.name}" in order ${U} is missing a price. Defaulting to 0.`),{name:M.name,pack_quantity:M.pack_quantity,loose_quantity:M.loose_quantity,price:$,pack_price:M.pack_price,loose_price:M.loose_price,total_price:M.total_price,isLoose:M.isLoose,unit:M.unit,drug_id:M.drug_id?String(M.drug_id):null,tabletsPerDay:M.tabletsPerDay,numberOfDays:M.numberOfDays,directions_to_use:M.directions_to_use,discount_percentage:0,batch:M.batch,expiry_date:M.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:K}),f(`/dashboard/pharmacy-billing/${U}`,{state:{initialItems:K}})}else console.error(`Order with ID ${U} not found.`),d(`Order with ID ${U} not found.`),alert(`Error: Could not find order ${U} to bill.`)},B=async(U,H)=>{d(null);const K=e.find($=>$.id===U);if(!K){d(`Order with ID ${U} not found.`);return}const M={status:H,medications:K.medications};try{const $=await me(`/api/pharmacy-orders/${U}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!$.ok){const W=await $.text();throw new Error(`Failed to update status: ${$.statusText} (${$.status}) - ${W}`)}const z=await $.json();n(W=>W.map(te=>te.id===z.id?{...te,status:z.status}:te))}catch($){console.error("Failed to update order status:",$),d($.message||`Failed to update status for order ${U}.`),alert(`Error updating status for order ${U}: ${$.message||"Please try again."}`)}},F=U=>{switch(U){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},L=U=>{f(`/dashboard/orders/${U.id}`)};return a&&e.length===0&&!l?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>f("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(Qa,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>f("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx(Wd,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>f("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(zk,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>f("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx(Wd,{size:16}),"Distributors"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:U=>r(U.target.value),className:"pharmacy-search-input"}),i.jsx(Pr,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"})," ",i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(U=>i.jsxs("tr",{onClick:()=>L(U),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:U.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${U.patientTokenNumber}`,children:U.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[U.medications.map((H,K)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[H.name," (Packs: ",H.pack_quantity,", Loose: ",H.loose_quantity,", ",H.tabletsPerDay??"N/A","x",H.numberOfDays??"N/A","d)",H.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",H.box_number,")"]})]}),H.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",H.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[H.pack_price!==void 0&&`Pack Price: ${Number(H.pack_price).toFixed(2)}`,H.loose_price!==void 0&&` | Loose Price: ${Number(H.loose_price).toFixed(2)}`,H.total_price!==void 0&&` | Item Total: ${Number(H.total_price).toFixed(2)}`]})]},K)),U.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",U.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(U.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(U.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:F(U.status),children:U.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[U.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:H=>{H.stopPropagation(),R(U.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(yl,{size:14})," Edit"]}),i.jsxs("button",{onClick:H=>{H.stopPropagation(),I(U.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Hh,{size:14})," Bill"]})]}),U.status==="billed"&&i.jsxs("button",{onClick:H=>{H.stopPropagation(),B(U.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ca,{size:14})," Dispense"]}),(U.status==="pending"||U.status==="billed")&&i.jsx("button",{onClick:H=>{H.stopPropagation(),B(U.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:H=>{H.stopPropagation(),L(U)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},U.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(U=>{const H=F(U.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>L(U),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:U.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${U.patientTokenNumber}`,children:["Token: ",U.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(U.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:H,children:U.status}),U.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(U.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[U.medications.slice(0,2).map((K,M)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${K.name} (Packs: ${K.pack_quantity}, Loose: ${K.loose_quantity}, ${K.tabletsPerDay??"N/A"}x${K.numberOfDays??"N/A"}d)`,children:[K.name," (Packs: ",K.pack_quantity,", Loose: ",K.loose_quantity,", ",K.tabletsPerDay??"N/A","x",K.numberOfDays??"N/A","d)",K.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",K.box_number,")"]})]}),K.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${K.directions_to_use}`,children:["Directions: ",K.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[K.pack_price!==void 0&&`Pack Price: ${Number(K.pack_price).toFixed(2)}`,K.loose_price!==void 0&&` | Loose Price: ${Number(K.loose_price).toFixed(2)}`,K.total_price!==void 0&&` | Item Total: ${Number(K.total_price).toFixed(2)}`]})]},M)),U.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",U.medications.length-2," more"]}),U.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),U.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",U.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[U.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:K=>{K.stopPropagation(),R(U.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(yl,{size:14})," Edit"]}),i.jsxs("button",{onClick:K=>{K.stopPropagation(),I(U.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Hh,{size:14})," Bill"]})]}),U.status==="billed"&&i.jsxs("button",{onClick:K=>{K.stopPropagation(),B(U.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ca,{size:14})," Dispense"]}),(U.status==="pending"||U.status==="billed")&&i.jsx("button",{onClick:K=>{K.stopPropagation(),B(U.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:K=>{K.stopPropagation(),L(U)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},U.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(U=>Math.max(U-1,1)),disabled:h===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(U=>Math.min(U+1,b)),disabled:h===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(h-1)*T+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(h*T,S)})," ","of ",i.jsx("span",{className:"font-medium",children:S})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(U=>Math.max(U-1,1)),disabled:h===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(Ib,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",h," of ",b]}),i.jsxs("button",{onClick:()=>g(U=>Math.min(U+1,b)),disabled:h===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(Zh,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},oj=10,LJ=3,FE=({isEmbedded:e=!1,initialSearch:n=""})=>{const t=Dt(),[r,a]=w.useState([]),[o,l]=w.useState([]),[d,f]=w.useState(n),[u,h]=w.useState(!0),[g,b]=w.useState(null),[v,S]=w.useState(new Set),[k,T]=w.useState("all"),P=async()=>{try{const ve=await me("/api/inventory/download-csv");if(!ve.ok)throw new Error(`Failed to download CSV: ${ve.statusText}`);const ke=await ve.blob(),Ne=window.URL.createObjectURL(ke),Oe=document.createElement("a");Oe.href=Ne,Oe.download="pharmacy_inventory.csv",document.body.appendChild(Oe),Oe.click(),Oe.remove(),window.URL.revokeObjectURL(Ne)}catch(ve){console.error("Failed to download CSV:",ve),b(ve.message||"Failed to download inventory CSV. Please try again.")}},[R,I]=w.useState(!1),[B,F]=w.useState(!1),[L,U]=w.useState(null),[H,K]=w.useState(!1),[M,$]=w.useState(new Set),[z,W]=w.useState(1),te=8,[V,G]=w.useState(null),[J,oe]=w.useState(0),[ie,E]=w.useState(!1),[ce,ge]=w.useState(null),[D,pe]=w.useState(1),[Ce,Z]=w.useState(!1),ee=z*te,X=ee-te,ye=o.slice(X,ee),He=Math.ceil(o.length/te);w.useEffect(()=>{W(1)},[d,k]);const he=w.useCallback(async()=>{h(!0),b(null);try{const ve=await me("/api/drugs");if(!ve.ok)throw new Error(`Failed to fetch drugs: ${ve.statusText} (${ve.status})`);const ke=await ve.json();let Ne=Array.isArray(ke)?ke:ke.drugs||[];Ne=Ne.map(Oe=>({...Oe,mrp:parseFloat(String(Oe.mrp))||0,rate:Oe.rate!==null&&Oe.rate!==void 0?parseFloat(String(Oe.rate)):null,stock:parseInt(String(Oe.stock),10)||0,gst:Oe.gst!==null&&Oe.gst!==void 0?parseFloat(String(Oe.gst)):null,margin:Oe.margin!==null&&Oe.margin!==void 0?parseFloat(String(Oe.margin)):null,discount:Oe.discount!==null&&Oe.discount!==void 0?parseFloat(String(Oe.discount)):null})),a(Ne),l(Ne)}catch(ve){console.error("Failed to fetch drugs:",ve),b(ve.message||"Failed to load inventory. Please try again.")}finally{h(!1)}},[]);w.useEffect(()=>{he()},[he]),w.useEffect(()=>{n&&f(n)},[n]),w.useEffect(()=>{const ve=d.toLowerCase();let ke=r.filter(Ve=>{var Ln,Vt,Ct,xt,hn;const Ze=((Ln=Ve.name)==null?void 0:Ln.toLowerCase())||"",jt=((Vt=Ve.description)==null?void 0:Vt.toLowerCase())||"",Nt=((Ct=Ve.supplier)==null?void 0:Ct.toLowerCase())||"",mt=((xt=Ve.box_number)==null?void 0:xt.toLowerCase())||"",an=((hn=Ve.brand_name)==null?void 0:hn.toLowerCase())||"";return Ze.includes(ve)||jt.includes(ve)||Nt.includes(ve)||mt.includes(ve)||an.includes(ve)});const Ne=new Date,Oe=hQ(Ne,LJ);k==="low-stock"?ke=ke.filter(Ve=>Ve.stock<=oj):k==="near-expiry"?ke=ke.filter(Ve=>{if(!Ve.expiry_date)return!1;const Ze=sj(Ve.expiry_date);return ew(Ze)&&q0(Ze,Oe)&&!q0(Ze,Ne)}):k==="expired"&&(ke=ke.filter(Ve=>{if(!Ve.expiry_date)return!1;const Ze=sj(Ve.expiry_date);return ew(Ze)&&q0(Ze,Ne)})),l(ke)},[d,r,k]);const Le=()=>{I(!1),G(null)},ue=ve=>{oe(parseInt(ve.target.value,10)||0)},De=async ve=>{if(ve.preventDefault(),b(null),!V||!V.id||J===0){b("No drug selected or adjustment amount is zero.");return}try{const ke=await me(`/api/drugs/${V.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:J})});if(!ke.ok){const Oe=await ke.json();throw new Error(Oe.message||`Failed to adjust stock: ${ke.statusText}`)}const Ne=await ke.json();a(Oe=>Oe.map(Ve=>Ve.id===Ne.id?Ne:Ve)),Le(),alert(`Stock for "${Ne.name}" adjusted successfully. New stock: ${Ne.stock}`)}catch(ke){console.error("Failed to adjust stock:",ke),b(ke.message||"Failed to adjust stock. Please try again.")}},Ye=ve=>{U(ve),F(!0)},et=()=>{F(!1),U(null)},Ke=async()=>{if(!L||!L.id){b("No drug selected for deletion.");return}h(!0),b(null);try{const ve=await me(`/api/drugs/${L.id}`,{method:"DELETE"});if(!ve.ok){const ke=await ve.json();throw new Error(ke.message||`Failed to delete drug: ${ve.statusText}`)}alert(`Drug "${L.name}" deleted successfully.`),he(),et()}catch(ve){console.error("Failed to delete drug:",ve),b(ve.message||"Failed to delete drug. Please try again.")}finally{h(!1)}},it=()=>{K(!0)},ot=()=>{K(!1)},[vt,Ee]=w.useState(!1),Je=()=>{M.size>0&&Ee(!0)},Ae=()=>{Ee(!1)},_e=async()=>{if(M.size===0){b("No drugs selected for deletion.");return}h(!0),b(null);try{const ve=await me("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(M)})});if(!ve.ok){const ke=await ve.json();throw new Error(ke.message||`Failed to delete selected drugs: ${ve.statusText}`)}alert(`${M.size} drug(s) deleted successfully.`),he(),$(new Set),Ae()}catch(ve){console.error("Failed to delete selected drugs:",ve),b(ve.message||"Failed to delete selected drugs. Please try again.")}finally{h(!1)}},le=async()=>{h(!0),b(null);try{const ve=await me("/api/drugs/all",{method:"DELETE"});if(!ve.ok){const ke=await ve.json();throw new Error(ke.message||`Failed to delete all drugs: ${ve.statusText}`)}alert("All drugs deleted successfully."),he(),ot()}catch(ve){console.error("Failed to delete all drugs:",ve),b(ve.message||"Failed to delete all drugs. Please try again.")}finally{h(!1)}},q=ve=>{if(!ve)return null;const ke=ve.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return ke?parseInt(ke[1],10):null},de=ve=>{ge(ve),pe(1),E(!0)},be=()=>{E(!1),ge(null),pe(1)},$e=ve=>{pe(parseInt(ve.target.value,10)||0)},nt=async ve=>{if(ve.preventDefault(),b(null),!ce||!ce.id||D<=0){b("No drug selected or invalid number of packs to convert.");return}const ke=q(ce.pack);if(!ke||ke<=0){b(`Cannot convert "${ce.name}" to loose. Invalid pack unit: ${ce.pack||"N/A"}.`);return}if(D>(ce.stock??0)){b(`Cannot convert ${D} packs. Only ${ce.stock??0} packs are in stock.`);return}try{const Ne=await me(`/api/drugs/${ce.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:D,packSize:ke})});if(!Ne.ok){const Ve=await Ne.json();throw new Error(Ve.message||`Failed to convert to loose: ${Ne.statusText}`)}const Oe=await Ne.json();a(Ve=>Ve.map(Ze=>Ze.id===Oe.id?Oe:Ze)),be(),alert(`Converted ${D} pack(s) of "${Oe.name}" to loose. New stock: ${Oe.stock} packs, ${Oe.loose??0} loose units.`)}catch(Ne){console.error("Failed to convert to loose:",Ne),b(Ne.message||"Failed to convert to loose. Please try again.")}finally{h(!1)}},ht=()=>{Z(!0)},wt=()=>{Z(!1)},Et=async()=>{h(!0),b(null);try{const ve=await me("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!ve.ok){const ke=await ve.json();throw new Error(ke.message||`Failed to add default medications: ${ve.statusText}`)}alert("Default medications added successfully."),he(),wt()}catch(ve){console.error("Failed to add default medications:",ve),b(ve.message||"Failed to add default medications. Please try again.")}finally{h(!1)}};return u?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):g?i.jsxs("div",{className:"error-indicator",children:["Error: ",g]}):i.jsxs("div",{className:`pharmacy-inventory-page ${e?"embedded":""}`,style:e?{minHeight:"auto",padding:"0",background:"transparent"}:{},children:[i.jsx("div",{className:"inventory-header-controls",style:{padding:"20px 20px 0 20px"},children:i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",style:{display:"flex",gap:"12px"},children:[i.jsxs("button",{onClick:()=>t("/dashboard/purchase"),className:"action-button-outline add-drug-button",children:[i.jsx(Qa,{size:18}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>t("/dashboard/purchase"),className:"action-button-outline",children:[i.jsx(Qa,{size:18}),"Purchase Page"]}),i.jsxs("button",{onClick:()=>t("/dashboard/distributors"),className:"action-button-outline",children:[i.jsx(Qa,{size:18}),"Distributors"]})]}),i.jsxs("div",{className:"action-group-right",style:{display:"flex",gap:"12px"},children:[i.jsx("button",{onClick:P,className:"action-button-outline",children:"Download CSV"}),i.jsxs("button",{onClick:ht,className:"action-button-outline",children:[i.jsx(Qa,{size:18}),"Import Defaults"]}),i.jsxs("button",{onClick:Je,className:"action-button-outline delete-button-outline",disabled:M.size===0,children:[i.jsx(jr,{size:18}),"Delete (",M.size,")"]}),i.jsxs("button",{onClick:it,className:"action-button-outline delete-all-button-outline",children:[i.jsx(jr,{size:18}),"Delete All"]})]})]})}),i.jsxs("div",{className:"search-bar-container",style:{padding:"0 20px 20px 20px",borderBottom:"1px solid var(--border-color)",marginBottom:"0"},children:[i.jsxs("div",{className:"search-input-wrapper",style:{maxWidth:"600px"},children:[i.jsx(Pr,{size:20,className:"search-input-icon"}),i.jsx("input",{type:"text",placeholder:"Search drugs...",value:d,onChange:ve=>f(ve.target.value),className:"inventory-search-input"})]}),i.jsx("div",{className:"filter-dropdown-wrapper",children:i.jsxs("select",{value:k,onChange:ve=>T(ve.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:ve=>{if(ve.target.checked){const ke=new Set(o.map(Ne=>Ne.id));$(ke)}else $(new Set)},checked:M.size===o.length&&o.length>0,disabled:o.length===0})}),i.jsx("th",{className:"drug-name-header",children:"DRUG DETAILS"}),i.jsx("th",{className:"pack-header",children:"PACK"}),i.jsx("th",{className:"expiry-header",children:"EXPIRY"}),i.jsx("th",{className:"text-stock qty-header",children:"STOCK"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"RATE"}),i.jsx("th",{className:"box-number-header",children:"BOX"}),i.jsx("th",{className:"discount-header",children:"DISC %"}),i.jsx("th",{className:"margin-header",children:"MARGIN"}),i.jsx("th",{className:"actions-cell",children:"ACTIONS"})]})}),i.jsxs("tbody",{children:[o.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:11,children:"No drugs found matching your search."})}),ye.map(ve=>i.jsxs(Pn.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const ke=new Set(v);ke.has(ve.id)&&ve.id!==void 0?ke.delete(ve.id):ve.id!==void 0&&ke.add(ve.id),S(ke)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:ke=>ke.stopPropagation(),checked:M.has(ve.id),onChange:()=>{const ke=new Set(M);ke.has(ve.id)?ke.delete(ve.id):ke.add(ve.id),$(ke)}})}),i.jsx("td",{className:"drug-name-cell",children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:ve.brand_name||ve.name||"-"}),ve.brand_name&&ve.name&&ve.brand_name!==ve.name&&i.jsx("span",{className:"text-xs text-muted-foreground",style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:ve.name})]})}),i.jsx("td",{className:"text-muted pack-cell",children:ve.pack||"-"}),i.jsx("td",{className:"text-muted",children:ve.expiry_date?new Date(ve.expiry_date).toLocaleDateString("en-GB"):"-"}),i.jsxs("td",{className:`text-stock ${ve.stock<=oj?"low-stock":""}`,children:[i.jsx("div",{style:{fontWeight:"bold"},children:ve.stock}),i.jsx("div",{className:"loose-quantity",children:ve.loose!==null&&ve.loose!==void 0?`${ve.loose} loose`:"0 loose"})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof ve.mrp=="number"?ve.mrp.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:ve.rate!==null&&ve.rate!==void 0?`${ve.rate.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:ve.box_number||"-"}),i.jsx("td",{className:"text-muted",children:ve.discount!==null&&ve.discount!==void 0?`${ve.discount.toFixed(2)}%`:"0.00%"}),i.jsx("td",{className:"text-muted",children:(()=>{const ke=ve.mrp||0,Ne=ve.rate||0,Oe=ve.discount||0,Ve=ve.gst||0,jt=Ne*(1-Oe/100)*(1+Ve/100),Nt=ke-jt;return`${(ke>0?Nt/ke*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:ke=>{ke.stopPropagation(),t(`/dashboard/inventory/edit/${ve.id}`)},className:"action-icon-button",title:"Edit Drug",children:i.jsx(yl,{size:16})}),i.jsx("button",{onClick:ke=>{ke.stopPropagation(),Ye(ve)},className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(jr,{size:16})}),i.jsx("button",{onClick:ke=>{ke.stopPropagation(),G(ve),I(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(r6,{size:16})}),i.jsx("button",{onClick:ke=>{ke.stopPropagation(),de(ve)},className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!ve.pack||q(ve.pack)===null,children:i.jsx(G6,{size:16})})]})})]}),v.has(ve.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:11,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",ve.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",ve.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",ve.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",ve.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",ve.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const ke=q(ve.pack);return ke&&ke>0&&typeof ve.mrp=="number"?`${(ve.mrp/ke).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",ve.gst!==null&&ve.gst!==void 0?`${ve.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(ve.last_updated).toLocaleString()]})]})})})]},ve.id))]})]})}),He>1&&i.jsxs("div",{className:"pagination-controls",style:{padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"20px",backgroundColor:"var(--card-bg, #fff)",borderTop:"1px solid var(--border-color)"},children:[i.jsx("button",{onClick:()=>W(ve=>Math.max(ve-1,1)),disabled:z===1,className:"pagination-button",children:"Previous"}),i.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Page ",z," of ",He]}),i.jsx("button",{onClick:()=>W(ve=>Math.min(ve+1,He)),disabled:z===He,className:"pagination-button",children:"Next"})]}),B&&L&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:et,className:"modal-close-button",children:i.jsx(Sn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:L.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),g&&i.jsx("div",{className:"modal-error-message",children:g}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:et,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ke,className:"button-delete",children:"Delete"})]})]})}),R&&V&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Le,className:"modal-close-button",children:i.jsx(Sn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:V.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",V.stock]}),g&&i.jsx("div",{className:"modal-error-message",children:g}),i.jsxs("form",{onSubmit:De,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:J===0?"":J,onChange:ue,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Le,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),H&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ot,className:"modal-close-button",children:i.jsx(Sn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),g&&i.jsx("div",{className:"modal-error-message",children:g}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ot,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:le,className:"button-delete",children:"Delete All"})]})]})}),vt&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ae,className:"modal-close-button",children:i.jsx(Sn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:M.size})," selected drug(s)? This action cannot be undone."]}),g&&i.jsx("div",{className:"modal-error-message",children:g}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ae,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:_e,className:"button-delete",children:"Delete Selected"})]})]})}),ie&&ce&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:be,className:"modal-close-button",children:i.jsx(Sn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:ce.name||"Unnamed Drug"}),i.jsx("br",{}),"Pack Size: ",ce.pack,i.jsx("br",{}),"Current Stock: ",ce.stock," packs, ",ce.loose??0," loose units."]}),g&&i.jsx("div",{className:"modal-error-message",children:g}),i.jsxs("form",{onSubmit:nt,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packsToConvert",className:"form-label",children:"Packs to Convert"}),i.jsx("input",{type:"number",name:"packsToConvert",id:"packsToConvert",required:!0,step:"1",min:"1",max:ce.stock,value:D===0?"":D,onChange:$e,className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["Converting ",D," pack(s) will add ",D*(q(ce.pack)||0)," loose units."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:be,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert"})]})]})]})}),Ce&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:wt,className:"modal-close-button",children:i.jsx(Sn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),g&&i.jsx("div",{className:"modal-error-message",children:g}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:wt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Et,className:"button-submit",children:"Add Defaults"})]})]})})]})},FJ=()=>{const e=Dt();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},$E=()=>{const{id:e}=ra(),n=Dt(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[h,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){d("Drug ID is missing."),o(!1);return}o(!0),d(null);try{const I=await me(`/api/drugs/${e}`);if(!I.ok){const F=await I.json();throw new Error(F.message||`Failed to fetch drug: ${I.statusText}`)}let B=await I.json();B={...B,name:B.name||"",brand_name:B.brand_name||"",mrp:parseFloat(String(B.mrp))||0,rate:B.rate!==null&&B.rate!==void 0?parseFloat(String(B.rate)):null,stock:parseInt(String(B.stock),10)||0,gst:B.gst!==null&&B.gst!==void 0?parseFloat(String(B.gst)):null,margin:B.margin!==null&&B.margin!==void 0?parseFloat(String(B.margin)):null,discount:B.discount!==null&&B.discount!==void 0?parseFloat(String(B.discount)):null,batch:B.batch||"",hsn_code:B.hsn_code||"",mfg:B.mfg||"",loose:B.loose!==null&&B.loose!==void 0?parseInt(String(B.loose),10):null},r(B)}catch(I){console.error("Failed to fetch drug:",I),d(I.message||"Failed to load drug data. Please try again.")}finally{o(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const I=F=>{F.key==="Tab"&&v.current===document.activeElement&&(h||(g(!0),setTimeout(()=>{var L;(L=S.current)==null||L.focus()},0),F.preventDefault()))},B=F=>{b.current&&!b.current.contains(F.target)&&g(!1)};return document.addEventListener("keydown",I),document.addEventListener("mousedown",B),()=>{document.removeEventListener("keydown",I),document.removeEventListener("mousedown",B)}},[h]);const T=I=>{const{name:B,value:F,type:L}=I.target;r(U=>U?{...U,[B]:L==="number"?parseFloat(F)||null:F}:null)},P=()=>{n(-1)},R=async I=>{if(I.preventDefault(),d(null),u(!0),!t||!t.id){d("Cannot edit drug: No drug data available."),u(!1);return}if(t.mrp===void 0||t.stock===void 0){d("MRP and Stock Quantity are required."),u(!1);return}const B={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,rate:t.rate===0?null:t.rate,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const F=await me(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(!F.ok){const U=await F.json();throw new Error(U.message||`Failed to update drug: ${F.statusText}`)}const L=await F.json();alert(`Drug "${L.name}" updated successfully!`),n(-1)}catch(F){console.error("Failed to update drug:",F),d(F.message||"Failed to update drug. Please try again.")}finally{u(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:P,className:"cancel-button",title:"Go Back",children:i.jsx(Sn,{size:24})})]}),l&&i.jsx("div",{className:"error-message-submit",children:l}),i.jsxs("form",{onSubmit:R,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ml,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ml,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-mrp",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ml,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"mrp",id:"edit-mrp",required:!0,step:"0.01",min:"0",value:t.mrp||"",onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ml,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"stock",id:"edit-stock",required:!0,step:"1",min:"0",value:t.stock||"",onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-pack",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"pack",id:"edit-pack",value:t.pack||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!h),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),h&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-rate",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"rate",id:"edit-rate",step:"0.01",min:"0",value:t.rate??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:P,disabled:f,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button",tabIndex:20,children:f?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},tw=()=>{const e=Dt(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),[u,h]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,T]=w.useState(!1),[P,R]=w.useState([]),[I,B]=w.useState(!0);w.useEffect(()=>{(async()=>{B(!0);try{const $=await me("/api/staff?role=doctor");if(!$.ok)throw new Error("Failed to fetch doctors");const z=await $.json();R(z),z.length>0&&t(W=>({...W,doctorId:""}))}catch($){console.error("Error fetching doctors:",$),l(`Failed to load doctors: ${$.message}`)}finally{B(!1)}})()},[]);const F=w.useCallback(async()=>{if(u.trim()){T(!0),l(null),b([]);try{const M=encodeURIComponent(u.trim()),$=await me(`/api/patients?search=${M}&limit=10`);if(!$.ok){const W=await $.json().catch(()=>({message:"Failed to search patients"}));throw new Error(W.message||"Failed to search patients")}const z=await $.json();z&&Array.isArray(z.patients)?b(z.patients):(console.error("Unexpected response format from patient search:",z),b([]))}catch(M){console.error("Error searching patients:",M),l(`Search failed: ${M.message}`)}finally{T(!1)}}},[u]);w.useEffect(()=>{if(u.trim().length<2){b([]),l(null);return}const M=setTimeout(()=>{F()},300);return()=>clearTimeout(M)},[u,F]);const L=M=>{S(M),h(""),b([]),l(null),t($=>({...$,name:"",age:"",gender:"",phone:""}))},U=()=>{S(null),h(""),b([]),l(null),t(M=>({...M,name:"",age:"",gender:"",phone:""}))},H=M=>{const{name:$,value:z}=M.target;t(W=>({...W,[$]:z}))},K=async M=>{var $;M.preventDefault(),l(null),f(null),a(!0);try{let z,W;if(v)z=v.id,W=v.name,console.log(`Adding existing patient ${z} to queue.`);else{console.log("Registering new patient...");const J=await me("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!J.ok){const ie=await J.json();if(J.status===403&&ie.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:ie.message}});return}throw new Error(ie.message||"Failed to register patient")}const oe=await J.json();z=oe.id,W=oe.name,console.log(`New patient ${z} registered.`)}const te=n.doctorId||null;console.log(`Adding patient ${z} to queue for doctor ${te||"Unassigned"}`);const V=await me("/api/queue",{method:"POST",body:JSON.stringify({patientId:z,complaint:n.complaint||null,doctorId:te})});if(!V.ok){const J=await V.json();throw new Error(J.message||"Failed to add patient to queue")}const G=await V.json();if(console.log(`Patient added to queue, entry ID: ${G.id}`),S(null),h(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),te){const J=(($=P.find(ie=>ie.id===te))==null?void 0:$.name)||"Selected Doctor",oe=v?`Existing patient "${W}" added to queue for Dr. ${J}. Redirecting to billing...`:`Patient "${W}" registered and added to queue for Dr. ${J}. Redirecting to billing...`;f(oe),e("/billing",{state:{patientId:z,queueId:G.id,patientName:W,doctorId:te,billType:"consultation"}})}else{const J=v?`Existing patient "${W}" added to the general queue.`:`Patient "${W}" registered and added to the general queue.`;f(J)}}catch(z){console.error("Error in add/queue process:",z),z.message.includes("Patient limit")?(l(`Operation failed: ${z.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${z.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[i.jsx(cn,{size:20,className:"btn-icon"})," Back"]})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx(Iw,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:u,onChange:M=>h(M.target.value),className:"form-input",disabled:r||!!v}),i.jsx(Pr,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:U,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(Sn,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map(M=>i.jsxs("li",{onClick:()=>L(M),children:[M.name," (ID: ",M.id,", Phone: ",M.phone||"N/A",")"]},M.id))}),u.length>=2&&g.length===0&&!k&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',u,'". You can register them below.']}),k&&u.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),o&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),d&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:d})]}),i.jsxs("form",{onSubmit:K,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:H,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:H,className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:H,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:H,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:H,className:`form-select ${I?"opacity-50":""}`,disabled:r||I,children:[i.jsx("option",{value:"",children:I?"Loading doctors...":P.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),P.map(M=>i.jsx("option",{value:M.id,children:M.name},M.id))]}),P.length===0&&!I&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:H,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("div",{className:"flex justify-end pt-2",children:[" ",i.jsxs("button",{type:"submit",className:`btn btn-primary ${r||I?"disabled":""}`,disabled:r||I,children:[i.jsx(Dw,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})]})},$J=({clinicId:e})=>{const n=Dt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,o]=w.useState(null),[l,d]=w.useState(!1);w.useEffect(()=>{o(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const f=g=>{const{name:b,value:v}=g.target;r(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},u=async g=>{if(g.preventDefault(),o(null),!t.name||!t.email||!t.role||!t.password){o("Name, Email, Role, and Password are required.");return}if(!e){o("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){o("Invalid OPD Fee format. Please enter a number.");return}d(!0);try{const v=await me("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){o(`Failed to add staff: ${v.message}`)}finally{d(!1)}},h=()=>{n(-1)};return i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:h,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(cn,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{children:"Add New Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),a]}),i.jsxs("form",{onSubmit:u,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:f,required:!0,disabled:l||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:f,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:l||!e}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),i.jsxs("button",{type:"submit",disabled:l||!e,children:[l?i.jsx(mo,{size:18,className:"animate-spin mr-2"}):i.jsx(_s,{size:18,className:"mr-2"}),l?"Adding...":"Add Staff Member"]})]})]})},zJ=()=>{const{id:e}=ra(),n=Dt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,o]=w.useState(""),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),d(!1);return}d(!0),g(null),v(null);try{const R=await me(`/staff/${e}`);if(!R.ok){const B=await R.json();throw new Error(B.message||`HTTP error! status: ${R.status}`)}const I=await R.json();r({name:I.name,email:I.email,role:I.role,opd_fee:I.opd_fee??"",active:I.active})}catch(R){g(`Failed to load staff details: ${R.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=R=>{const{name:I,value:B,type:F}=R.target;if(F==="checkbox"){const{checked:L}=R.target;r(U=>({...U,[I]:L}))}else r(L=>({...L,[I]:B}))},T=R=>{o(R.target.value)},P=async R=>{if(R.preventDefault(),!e){g("Staff ID is missing.");return}u(!0),g(null),v(null);const I={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const B=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(B!==null&&isNaN(B)){g("OPD Fee must be a valid number."),u(!1);return}I.opd_fee=B}else I.opd_fee=null;a.trim()!==""&&(I.password=a.trim());try{const B=await me(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!B.ok){const F=await B.json();throw new Error(F.message||`HTTP error! status: ${B.status}`)}v("Staff details updated successfully!"),o(""),setTimeout(()=>n(-1),1500)}catch(B){g(`Failed to update staff: ${B.message}`)}finally{u(!1)}};return l?i.jsxs("div",{className:"flex justify-center items-center h-screen",children:[i.jsx(mo,{className:"h-12 w-12 animate-spin text-teal-600"}),i.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(cn,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),h&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),h,i.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&i.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[i.jsx(Ca,{size:18,className:"mr-2 text-green-500"}),b,i.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),i.jsxs("form",{onSubmit:P,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"role",children:["Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),i.jsxs("div",{className:"form-group checkbox-group",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),i.jsx("button",{type:"submit",disabled:f,children:f?i.jsxs(i.Fragment,{children:[i.jsx(mo,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Jd,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})},BJ={};function hS(e,n){const t=BJ,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return zE(e,r,a)}function zE(e,n,t){if(UJ(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return lj(e.children,n,t)}return Array.isArray(e)?lj(e,n,t):""}function lj(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=zE(e[a],n,t);return r.join("")}function UJ(e){return!!(e&&typeof e=="object")}const cj=document.createElement("i");function pS(e){const n="&"+e+";";cj.innerHTML=n;const t=cj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function xl(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function Cs(e,n){return e.length>0?(xl(e,e.length,0,n),e):n}const uj={}.hasOwnProperty;function qJ(e){const n={};let t=-1;for(;++t<e.length;)VJ(n,e[t]);return n}function VJ(e,n){let t;for(t in n){const a=(uj.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){uj.call(a,l)||(a[l]=[]);const d=o[l];HJ(a[l],Array.isArray(d)?d:d?[d]:[])}}}function HJ(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);xl(e,0,0,r)}function BE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function $h(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const pl=ku(/[A-Za-z]/),Ja=ku(/[\dA-Za-z]/),GJ=ku(/[#-'*+\--9=?A-Z^-~]/);function nw(e){return e!==null&&(e<32||e===127)}const rw=ku(/\d/),YJ=ku(/[\dA-Fa-f]/),WJ=ku(/[!-/:-@[-`{-~]/);function Gt(e){return e!==null&&e<-2}function Na(e){return e!==null&&(e<0||e===32)}function Vn(e){return e===-2||e===-1||e===32}const QJ=ku(new RegExp("\\p{P}|\\p{S}","u")),JJ=ku(/\s/);function ku(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function sp(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Ja(e.charCodeAt(t+1))&&Ja(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function fr(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return Vn(f)?(e.enter(t),d(f)):n(f)}function d(f){return Vn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const KJ={tokenize:XJ};function XJ(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),fr(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Gt(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const ZJ={tokenize:eK},dj={tokenize:tK};function eK(e){const n=this,t=[];let r=0,a,o,l;return d;function d(I){if(r<t.length){const B=t[r];return n.containerState=B[1],e.attempt(B[0].continuation,f,u)(I)}return u(I)}function f(I){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&R();const B=n.events.length;let F=B,L;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){L=n.events[F][1].end;break}P(r);let U=B;for(;U<n.events.length;)n.events[U][1].end={...L},U++;return xl(n.events,F+1,0,n.events.slice(B)),n.events.length=U,u(I)}return d(I)}function u(I){if(r===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(dj,h,g)(I)}function h(I){return a&&R(),P(r),b(I)}function g(I){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(dj,v,S)(I)}function v(I){return r++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&R(),P(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(I);return}return Gt(I)?(e.consume(I),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(I),k)}function T(I,B){const F=n.sliceStream(I);if(B&&F.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write(F),n.parser.lazy[I.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const U=n.events.length;let H=U,K,M;for(;H--;)if(n.events[H][0]==="exit"&&n.events[H][1].type==="chunkFlow"){if(K){M=n.events[H][1].end;break}K=!0}for(P(r),L=U;L<n.events.length;)n.events[L][1].end={...M},L++;xl(n.events,H+1,0,n.events.slice(U)),n.events.length=L}}function P(I){let B=t.length;for(;B-- >I;){const F=t[B];n.containerState=F[1],F[0].exit.call(n,e)}t.length=I}function R(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function tK(e,n,t){return fr(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Sb(e){if(e===null||Na(e)||JJ(e))return 1;if(QJ(e))return 2}function mS(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const iw={name:"attention",resolveAll:nK,tokenize:rK};function nK(e,n){let t=-1,r,a,o,l,d,f,u,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};fj(g,-f),fj(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Cs(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=Cs(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=Cs(u,mS(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=Cs(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,u=Cs(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,xl(e,r-1,t-r+3,u),t=r+u.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function rK(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Sb(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),h=Sb(f),g=!h||h===2&&a||t.includes(f),b=!a||a===2&&h||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(h||!g)),n(f)}}function fj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const iK={name:"autolink",tokenize:aK};function aK(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return pl(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Ja(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||Ja(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||nw(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),h):GJ(v)?(e.consume(v),u):t(v)}function h(v){return Ja(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Ja(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const tv={partial:!0,tokenize:sK};function sK(e,n,t){return r;function r(o){return Vn(o)?fr(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Gt(o)?n(o):t(o)}}const UE={continuation:{tokenize:lK},exit:cK,name:"blockQuote",tokenize:oK};function oK(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return Vn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function lK(e,n,t){const r=this;return a;function a(l){return Vn(l)?fr(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(UE,n,t)(l)}}function cK(e){e.exit("blockQuote")}const qE={name:"characterEscape",tokenize:uK};function uK(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return WJ(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const VE={name:"characterReference",tokenize:dK};function dK(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Ja,h(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=YJ,h):(e.enter("characterReferenceValue"),o=7,l=rw,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Ja&&!pS(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),h):t(g)}}const hj={partial:!0,tokenize:hK},pj={concrete:!0,name:"codeFenced",tokenize:fK};function fK(e,n,t){const r=this,a={partial:!0,tokenize:F};let o=0,l=0,d;return f;function f(L){return u(L)}function u(L){const U=r.events[r.events.length-1];return o=U&&U[1].type==="linePrefix"?U[2].sliceSerialize(U[1],!0).length:0,d=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(L)}function h(L){return L===d?(l++,e.consume(L),h):l<3?t(L):(e.exit("codeFencedFenceSequence"),Vn(L)?fr(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Gt(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(hj,k,B)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Gt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):Vn(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),fr(e,v,"whitespace")(L)):L===96&&L===d?t(L):(e.consume(L),b)}function v(L){return L===null||Gt(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Gt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===d?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,B,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),P}function P(L){return o>0&&Vn(L)?fr(e,R,"linePrefix",o+1)(L):R(L)}function R(L){return L===null||Gt(L)?e.check(hj,k,B)(L):(e.enter("codeFlowValue"),I(L))}function I(L){return L===null||Gt(L)?(e.exit("codeFlowValue"),R(L)):(e.consume(L),I)}function B(L){return e.exit("codeFenced"),n(L)}function F(L,U,H){let K=0;return M;function M(V){return L.enter("lineEnding"),L.consume(V),L.exit("lineEnding"),$}function $(V){return L.enter("codeFencedFence"),Vn(V)?fr(L,z,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(V):z(V)}function z(V){return V===d?(L.enter("codeFencedFenceSequence"),W(V)):H(V)}function W(V){return V===d?(K++,L.consume(V),W):K>=l?(L.exit("codeFencedFenceSequence"),Vn(V)?fr(L,te,"whitespace")(V):te(V)):H(V)}function te(V){return V===null||Gt(V)?(L.exit("codeFencedFence"),U(V)):H(V)}}}function hK(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const H0={name:"codeIndented",tokenize:mK},pK={partial:!0,tokenize:gK};function mK(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),fr(e,o,"linePrefix",5)(u)}function o(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Gt(u)?e.attempt(pK,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Gt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function gK(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Gt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):fr(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Gt(l)?a(l):t(l)}}const yK={name:"codeText",previous:bK,resolve:xK,tokenize:vK};function xK(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function bK(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function vK(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,h(g)):Gt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Gt(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}class wK{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Um(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Um(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Um(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Um(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Um(this.left,t.reverse())}}}function Um(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function HE(e){const n={};let t=-1,r,a,o,l,d,f,u;const h=new wK(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,SK(h,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=h.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},d=h.slice(a,t),d.unshift(r),h.splice(a,t-a+1,d))}}return xl(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function SK(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let h,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),R=o.pop();f.push([R,R+P.length-1]),e.splice(R,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const NK={resolve:_K,tokenize:jK},CK={partial:!0,tokenize:kK};function _K(e){return HE(e),e}function jK(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Gt(d)?e.check(CK,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function kK(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),fr(e,o,"linePrefix")}function o(l){if(l===null||Gt(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function GE(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let h=0;return g;function g(P){return P===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||nw(P)?t(P):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||Gt(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!h&&(P===null||P===41||Na(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(P)):h<u&&P===40?(e.consume(P),h++,k):P===41?(e.consume(P),h--,k):P===null||P===32||P===40||nw(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function YE(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),h}function h(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Gt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Gt(v)||d++>999?(e.exit("chunkString"),h(v)):(e.consume(v),f||(f=!Vn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function WE(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Gt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),fr(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||Gt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function Jm(e,n){let t;return r;function r(a){return Gt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):Vn(a)?fr(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const TK={name:"definition",tokenize:AK},EK={partial:!0,tokenize:PK};function AK(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return YE.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=$h(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return Na(v)?Jm(e,u)(v):u(v)}function u(v){return GE(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(EK,g,g)(v)}function g(v){return Vn(v)?fr(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Gt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function PK(e,n,t){return r;function r(d){return Na(d)?Jm(e,a)(d):t(d)}function a(d){return WE(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return Vn(d)?fr(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Gt(d)?n(d):t(d)}}const DK={name:"hardBreakEscape",tokenize:IK};function IK(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Gt(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const RK={name:"headingAtx",resolve:MK,tokenize:OK};function MK(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},xl(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function OK(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),o(h)}function o(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||Na(h)?(e.exit("atxHeadingSequence"),d(h)):t(h)}function d(h){return h===35?(e.enter("atxHeadingSequence"),f(h)):h===null||Gt(h)?(e.exit("atxHeading"),n(h)):Vn(h)?fr(e,d,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function f(h){return h===35?(e.consume(h),f):(e.exit("atxHeadingSequence"),d(h))}function u(h){return h===null||h===35||Na(h)?(e.exit("atxHeadingText"),d(h)):(e.consume(h),u)}}const LK=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],mj=["pre","script","style","textarea"],FK={concrete:!0,name:"htmlFlow",resolveTo:BK,tokenize:UK},$K={partial:!0,tokenize:VK},zK={partial:!0,tokenize:qK};function BK(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function UK(e,n,t){const r=this;let a,o,l,d,f;return u;function u(D){return h(D)}function h(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,r.interrupt?n:E):pl(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):pl(D)?(e.consume(D),a=4,r.interrupt?n:E):t(D)}function v(D){return D===45?(e.consume(D),r.interrupt?n:E):t(D)}function S(D){const pe="CDATA[";return D===pe.charCodeAt(d++)?(e.consume(D),d===pe.length?r.interrupt?n:z:S):t(D)}function k(D){return pl(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||Na(D)){const pe=D===47,Ce=l.toLowerCase();return!pe&&!o&&mj.includes(Ce)?(a=1,r.interrupt?n(D):z(D)):LK.includes(l.toLowerCase())?(a=6,pe?(e.consume(D),P):r.interrupt?n(D):z(D)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(D):o?R(D):I(D))}return D===45||Ja(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),r.interrupt?n:z):t(D)}function R(D){return Vn(D)?(e.consume(D),R):M(D)}function I(D){return D===47?(e.consume(D),M):D===58||D===95||pl(D)?(e.consume(D),B):Vn(D)?(e.consume(D),I):M(D)}function B(D){return D===45||D===46||D===58||D===95||Ja(D)?(e.consume(D),B):F(D)}function F(D){return D===61?(e.consume(D),L):Vn(D)?(e.consume(D),F):I(D)}function L(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,U):Vn(D)?(e.consume(D),L):H(D)}function U(D){return D===f?(e.consume(D),f=null,K):D===null||Gt(D)?t(D):(e.consume(D),U)}function H(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||Na(D)?F(D):(e.consume(D),H)}function K(D){return D===47||D===62||Vn(D)?I(D):t(D)}function M(D){return D===62?(e.consume(D),$):t(D)}function $(D){return D===null||Gt(D)?z(D):Vn(D)?(e.consume(D),$):t(D)}function z(D){return D===45&&a===2?(e.consume(D),G):D===60&&a===1?(e.consume(D),J):D===62&&a===4?(e.consume(D),ce):D===63&&a===3?(e.consume(D),E):D===93&&a===5?(e.consume(D),ie):Gt(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check($K,ge,W)(D)):D===null||Gt(D)?(e.exit("htmlFlowData"),W(D)):(e.consume(D),z)}function W(D){return e.check(zK,te,ge)(D)}function te(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),V}function V(D){return D===null||Gt(D)?W(D):(e.enter("htmlFlowData"),z(D))}function G(D){return D===45?(e.consume(D),E):z(D)}function J(D){return D===47?(e.consume(D),l="",oe):z(D)}function oe(D){if(D===62){const pe=l.toLowerCase();return mj.includes(pe)?(e.consume(D),ce):z(D)}return pl(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),oe):z(D)}function ie(D){return D===93?(e.consume(D),E):z(D)}function E(D){return D===62?(e.consume(D),ce):D===45&&a===2?(e.consume(D),E):z(D)}function ce(D){return D===null||Gt(D)?(e.exit("htmlFlowData"),ge(D)):(e.consume(D),ce)}function ge(D){return e.exit("htmlFlow"),n(D)}}function qK(e,n,t){const r=this;return a;function a(l){return Gt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function VK(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(tv,n,t)}}const HK={name:"htmlText",tokenize:GK};function GK(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),F):E===63?(e.consume(E),I):pl(E)?(e.consume(E),H):t(E)}function u(E){return E===45?(e.consume(E),h):E===91?(e.consume(E),o=0,S):pl(E)?(e.consume(E),R):t(E)}function h(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Gt(E)?(l=g,J(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?G(E):E===45?b(E):g(E)}function S(E){const ce="CDATA[";return E===ce.charCodeAt(o++)?(e.consume(E),o===ce.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Gt(E)?(l=k,J(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),P):k(E)}function P(E){return E===62?G(E):E===93?(e.consume(E),P):k(E)}function R(E){return E===null||E===62?G(E):Gt(E)?(l=R,J(E)):(e.consume(E),R)}function I(E){return E===null?t(E):E===63?(e.consume(E),B):Gt(E)?(l=I,J(E)):(e.consume(E),I)}function B(E){return E===62?G(E):I(E)}function F(E){return pl(E)?(e.consume(E),L):t(E)}function L(E){return E===45||Ja(E)?(e.consume(E),L):U(E)}function U(E){return Gt(E)?(l=U,J(E)):Vn(E)?(e.consume(E),U):G(E)}function H(E){return E===45||Ja(E)?(e.consume(E),H):E===47||E===62||Na(E)?K(E):t(E)}function K(E){return E===47?(e.consume(E),G):E===58||E===95||pl(E)?(e.consume(E),M):Gt(E)?(l=K,J(E)):Vn(E)?(e.consume(E),K):G(E)}function M(E){return E===45||E===46||E===58||E===95||Ja(E)?(e.consume(E),M):$(E)}function $(E){return E===61?(e.consume(E),z):Gt(E)?(l=$,J(E)):Vn(E)?(e.consume(E),$):K(E)}function z(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,W):Gt(E)?(l=z,J(E)):Vn(E)?(e.consume(E),z):(e.consume(E),te)}function W(E){return E===a?(e.consume(E),a=void 0,V):E===null?t(E):Gt(E)?(l=W,J(E)):(e.consume(E),W)}function te(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||Na(E)?K(E):(e.consume(E),te)}function V(E){return E===47||E===62||Na(E)?K(E):t(E)}function G(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function J(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),oe}function oe(E){return Vn(E)?fr(e,ie,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):ie(E)}function ie(E){return e.enter("htmlTextData"),l(E)}}const gS={name:"labelEnd",resolveAll:JK,resolveTo:KK,tokenize:XK},YK={tokenize:ZK},WK={tokenize:eX},QK={tokenize:tX};function JK(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&xl(e,0,e.length,t),e}function KK(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=Cs(d,e.slice(o+1,o+r+3)),d=Cs(d,[["enter",h,n]]),d=Cs(d,mS(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=Cs(d,[["exit",h,n],e[l-2],e[l-1],["exit",u,n]]),d=Cs(d,e.slice(l+1)),d=Cs(d,[["exit",f,n]]),xl(e,o,e.length,d),e}function XK(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes($h(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(YK,h,l?h:g)(b):b===91?e.attempt(WK,h,l?u:g)(b):l?h(b):g(b)}function u(b){return e.attempt(QK,h,g)(b)}function h(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function ZK(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return Na(g)?Jm(e,o)(g):o(g)}function o(g){return g===41?h(g):GE(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return Na(g)?Jm(e,f)(g):h(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?WE(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function u(g){return Na(g)?Jm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function eX(e,n,t){const r=this;return a;function a(d){return YE.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes($h(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function tX(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const nX={name:"labelStartImage",resolveAll:gS.resolveAll,tokenize:rX};function rX(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const iX={name:"labelStartLink",resolveAll:gS.resolveAll,tokenize:aX};function aX(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const G0={name:"lineEnding",tokenize:sX};function sX(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),fr(e,n,"linePrefix")}}const Zx={name:"thematicBreak",tokenize:oX};function oX(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Gt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),Vn(u)?fr(e,d,"whitespace")(u):d(u))}}const va={continuation:{tokenize:dX},exit:hX,name:"list",tokenize:uX},lX={partial:!0,tokenize:pX},cX={partial:!0,tokenize:fX};function uX(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:rw(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Zx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return rw(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(tv,r.interrupt?t:h,e.attempt(lX,b,g))}function h(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return Vn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function dX(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(tv,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,fr(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!Vn(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(cX,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,fr(e,e.attempt(va,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function fX(e,n,t){const r=this;return fr(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function hX(e){e.exit(this.containerState.type)}function pX(e,n,t){const r=this;return fr(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!Vn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const gj={name:"setextUnderline",resolveTo:mX,tokenize:gX};function mX(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function gX(e,n,t){const r=this;let a;return o;function o(u){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),Vn(u)?fr(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Gt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const yX={tokenize:xX};function xX(e){const n=this,t=e.attempt(tv,r,e.attempt(this.parser.constructs.flowInitial,a,fr(e,e.attempt(this.parser.constructs.flow,a,e.attempt(NK,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const bX={resolveAll:JE()},vX=QE("string"),wX=QE("text");function QE(e){return{resolveAll:JE(e==="text"?SX:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(h){return u(h)?o(h):d(h)}function d(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),f}function f(h){return u(h)?(t.exit("data"),o(h)):(t.consume(h),f)}function u(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function JE(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function SX(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const NX={42:va,43:va,45:va,48:va,49:va,50:va,51:va,52:va,53:va,54:va,55:va,56:va,57:va,62:UE},CX={91:TK},_X={[-2]:H0,[-1]:H0,32:H0},jX={35:RK,42:Zx,45:[gj,Zx],60:FK,61:gj,95:Zx,96:pj,126:pj},kX={38:VE,92:qE},TX={[-5]:G0,[-4]:G0,[-3]:G0,33:nX,38:VE,42:iw,60:[iK,HK],91:iX,92:[DK,qE],93:gS,95:iw,96:yK},EX={null:[iw,bX]},AX={null:[42,95]},PX={null:[]},DX=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:AX,contentInitial:CX,disable:PX,document:NX,flow:jX,flowInitial:_X,insideSpan:EX,string:kX,text:TX},Symbol.toStringTag,{value:"Module"}));function IX(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:U(F),check:U(L),consume:R,enter:I,exit:B,interrupt:U(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g($){return l=Cs(l,$),T(),l[l.length-1]!==null?[]:(H(n,0),u.events=mS(o,u.events,u),u.events)}function b($,z){return MX(v($),z)}function v($){return RX(l,$)}function S(){const{_bufferIndex:$,_index:z,line:W,column:te,offset:V}=r;return{_bufferIndex:$,_index:z,line:W,column:te,offset:V}}function k($){a[$.line]=$.column,M()}function T(){let $;for(;r._index<l.length;){const z=l[r._index];if(typeof z=="string")for($=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===$&&r._bufferIndex<z.length;)P(z.charCodeAt(r._bufferIndex));else P(z)}}function P($){h=h($)}function R($){Gt($)?(r.line++,r.column=1,r.offset+=$===-3?2:1,M()):$!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=$}function I($,z){const W=z||{};return W.type=$,W.start=S(),u.events.push(["enter",W,u]),d.push(W),W}function B($){const z=d.pop();return z.end=S(),u.events.push(["exit",z,u]),z}function F($,z){H($,z.from)}function L($,z){z.restore()}function U($,z){return W;function W(te,V,G){let J,oe,ie,E;return Array.isArray(te)?ge(te):"tokenize"in te?ge([te]):ce(te);function ce(Z){return ee;function ee(X){const ye=X!==null&&Z[X],He=X!==null&&Z.null,he=[...Array.isArray(ye)?ye:ye?[ye]:[],...Array.isArray(He)?He:He?[He]:[]];return ge(he)(X)}}function ge(Z){return J=Z,oe=0,Z.length===0?G:D(Z[oe])}function D(Z){return ee;function ee(X){return E=K(),ie=Z,Z.partial||(u.currentConstruct=Z),Z.name&&u.parser.constructs.disable.null.includes(Z.name)?Ce():Z.tokenize.call(z?Object.assign(Object.create(u),z):u,f,pe,Ce)(X)}}function pe(Z){return $(ie,E),V}function Ce(Z){return E.restore(),++oe<J.length?D(J[oe]):G}}}function H($,z){$.resolveAll&&!o.includes($)&&o.push($),$.resolve&&xl(u.events,z,u.events.length-z,$.resolve(u.events.slice(z),u)),$.resolveTo&&(u.events=$.resolveTo(u.events,u))}function K(){const $=S(),z=u.previous,W=u.currentConstruct,te=u.events.length,V=Array.from(d);return{from:te,restore:G};function G(){r=$,u.previous=z,u.currentConstruct=W,u.events.length=te,d=V,M()}}function M(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function RX(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function MX(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function OX(e){const r={constructs:qJ([DX,...(e||{}).extensions||[]]),content:a(KJ),defined:[],document:a(ZJ),flow:a(yX),lazy:{},string:a(vX),text:a(wX)};return r;function a(o){return l;function l(d){return IX(r,o,d)}}}function LX(e){for(;!HE(e););return e}const yj=/[\0\t\n\r]/g;function FX(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,h,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(yj.lastIndex=g,u=yj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,f.push(-2);e++<h;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const $X=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function KE(e){return e.replace($X,zX)}function zX(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return BE(t.slice(o?2:1),o?16:10)}return pS(t)||e}function Km(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?xj(e.position):"start"in e||"end"in e?xj(e):"line"in e||"column"in e?aw(e):""}function aw(e){return bj(e&&e.line)+":"+bj(e&&e.column)}function xj(e){return aw(e&&e.start)+"-"+aw(e&&e.end)}function bj(e){return e&&typeof e=="number"?e:1}const XE={}.hasOwnProperty;function BX(e,n,t){return typeof n!="string"&&(t=n,n=void 0),UX(t)(LX(OX(t).document().write(FX()(e,n,!0))))}function UX(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(ot),autolinkProtocol:K,autolinkEmail:K,atxHeading:o(Ye),blockQuote:o(He),characterEscape:K,characterReference:K,codeFenced:o(he),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(he,l),codeText:o(Le,l),codeTextData:K,data:K,codeFlowValue:K,definition:o(ue),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(De),hardBreakEscape:o(et),hardBreakTrailing:o(et),htmlFlow:o(Ke,l),htmlFlowData:K,htmlText:o(Ke,l),htmlTextData:K,image:o(it),label:l,link:o(ot),listItem:o(Ee),listItemValue:b,listOrdered:o(vt,g),listUnordered:o(vt),paragraph:o(Je),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(Ye),strong:o(Ae),thematicBreak:o(le)},exit:{atxHeading:f(),atxHeadingSequence:F,autolink:f(),autolinkEmail:ye,autolinkProtocol:X,blockQuote:f(),characterEscapeValue:M,characterReferenceMarkerHexadecimal:Ce,characterReferenceMarkerNumeric:Ce,characterReferenceValue:Z,characterReference:ee,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:M,codeIndented:f(P),codeText:f(V),codeTextData:M,data:M,definition:f(),definitionDestinationString:B,definitionLabelString:R,definitionTitleString:I,emphasis:f(),hardBreakEscape:f(z),hardBreakTrailing:f(z),htmlFlow:f(W),htmlFlowData:M,htmlText:f(te),htmlTextData:M,image:f(J),label:ie,labelText:oe,lineEnding:$,link:f(G),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:pe,resourceDestinationString:E,resourceTitleString:ce,resource:ge,setextHeading:f(H),setextHeadingLineSequence:U,setextHeadingText:L,strong:f(),thematicBreak:f()}};ZE(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(q){let de={type:"root",children:[]};const be={stack:[de],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:h,data:t},$e=[];let nt=-1;for(;++nt<q.length;)if(q[nt][1].type==="listOrdered"||q[nt][1].type==="listUnordered")if(q[nt][0]==="enter")$e.push(nt);else{const ht=$e.pop();nt=a(q,ht,nt)}for(nt=-1;++nt<q.length;){const ht=n[q[nt][0]];XE.call(ht,q[nt][1].type)&&ht[q[nt][1].type].call(Object.assign({sliceSerialize:q[nt][2].sliceSerialize},be),q[nt][1])}if(be.tokenStack.length>0){const ht=be.tokenStack[be.tokenStack.length-1];(ht[1]||vj).call(be,void 0,ht[0])}for(de.position={start:mu(q.length>0?q[0][1].start:{line:1,column:1,offset:0}),end:mu(q.length>0?q[q.length-2][1].end:{line:1,column:1,offset:0})},nt=-1;++nt<n.transforms.length;)de=n.transforms[nt](de)||de;return de}function a(q,de,be){let $e=de-1,nt=-1,ht=!1,wt,Et,ve,ke;for(;++$e<=be;){const Ne=q[$e];switch(Ne[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ne[0]==="enter"?nt++:nt--,ke=void 0;break}case"lineEndingBlank":{Ne[0]==="enter"&&(wt&&!ke&&!nt&&!ve&&(ve=$e),ke=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:ke=void 0}if(!nt&&Ne[0]==="enter"&&Ne[1].type==="listItemPrefix"||nt===-1&&Ne[0]==="exit"&&(Ne[1].type==="listUnordered"||Ne[1].type==="listOrdered")){if(wt){let Oe=$e;for(Et=void 0;Oe--;){const Ve=q[Oe];if(Ve[1].type==="lineEnding"||Ve[1].type==="lineEndingBlank"){if(Ve[0]==="exit")continue;Et&&(q[Et][1].type="lineEndingBlank",ht=!0),Ve[1].type="lineEnding",Et=Oe}else if(!(Ve[1].type==="linePrefix"||Ve[1].type==="blockQuotePrefix"||Ve[1].type==="blockQuotePrefixWhitespace"||Ve[1].type==="blockQuoteMarker"||Ve[1].type==="listItemIndent"))break}ve&&(!Et||ve<Et)&&(wt._spread=!0),wt.end=Object.assign({},Et?q[Et][1].start:Ne[1].end),q.splice(Et||$e,0,["exit",wt,Ne[2]]),$e++,be++}if(Ne[1].type==="listItemPrefix"){const Oe={type:"listItem",_spread:!1,start:Object.assign({},Ne[1].start),end:void 0};wt=Oe,q.splice($e,0,["enter",Oe,Ne[2]]),$e++,be++,ve=void 0,ke=!0}}}return q[de][1]._spread=ht,be}function o(q,de){return be;function be($e){d.call(this,q($e),$e),de&&de.call(this,$e)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(q,de,be){this.stack[this.stack.length-1].children.push(q),this.stack.push(q),this.tokenStack.push([de,be||void 0]),q.position={start:mu(de.start),end:void 0}}function f(q){return de;function de(be){q&&q.call(this,be),u.call(this,be)}}function u(q,de){const be=this.stack.pop(),$e=this.tokenStack.pop();if($e)$e[0].type!==q.type&&(de?de.call(this,q,$e[0]):($e[1]||vj).call(this,q,$e[0]));else throw new Error("Cannot close `"+q.type+"` ("+Km({start:q.start,end:q.end})+"): its not open");be.position.end=mu(q.end)}function h(){return hS(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(q){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];de.start=Number.parseInt(this.sliceSerialize(q),10),this.data.expectingFirstListItemValue=void 0}}function v(){const q=this.resume(),de=this.stack[this.stack.length-1];de.lang=q}function S(){const q=this.resume(),de=this.stack[this.stack.length-1];de.meta=q}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q.replace(/(\r?\n|\r)$/g,"")}function R(q){const de=this.resume(),be=this.stack[this.stack.length-1];be.label=de,be.identifier=$h(this.sliceSerialize(q)).toLowerCase()}function I(){const q=this.resume(),de=this.stack[this.stack.length-1];de.title=q}function B(){const q=this.resume(),de=this.stack[this.stack.length-1];de.url=q}function F(q){const de=this.stack[this.stack.length-1];if(!de.depth){const be=this.sliceSerialize(q).length;de.depth=be}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function U(q){const de=this.stack[this.stack.length-1];de.depth=this.sliceSerialize(q).codePointAt(0)===61?1:2}function H(){this.data.setextHeadingSlurpLineEnding=void 0}function K(q){const be=this.stack[this.stack.length-1].children;let $e=be[be.length-1];(!$e||$e.type!=="text")&&($e=_e(),$e.position={start:mu(q.start),end:void 0},be.push($e)),this.stack.push($e)}function M(q){const de=this.stack.pop();de.value+=this.sliceSerialize(q),de.position.end=mu(q.end)}function $(q){const de=this.stack[this.stack.length-1];if(this.data.atHardBreak){const be=de.children[de.children.length-1];be.position.end=mu(q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(de.type)&&(K.call(this,q),M.call(this,q))}function z(){this.data.atHardBreak=!0}function W(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q}function te(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q}function V(){const q=this.resume(),de=this.stack[this.stack.length-1];de.value=q}function G(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=de,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function J(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=de,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function oe(q){const de=this.sliceSerialize(q),be=this.stack[this.stack.length-2];be.label=KE(de),be.identifier=$h(de).toLowerCase()}function ie(){const q=this.stack[this.stack.length-1],de=this.resume(),be=this.stack[this.stack.length-1];if(this.data.inReference=!0,be.type==="link"){const $e=q.children;be.children=$e}else be.alt=de}function E(){const q=this.resume(),de=this.stack[this.stack.length-1];de.url=q}function ce(){const q=this.resume(),de=this.stack[this.stack.length-1];de.title=q}function ge(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function pe(q){const de=this.resume(),be=this.stack[this.stack.length-1];be.label=de,be.identifier=$h(this.sliceSerialize(q)).toLowerCase(),this.data.referenceType="full"}function Ce(q){this.data.characterReferenceType=q.type}function Z(q){const de=this.sliceSerialize(q),be=this.data.characterReferenceType;let $e;be?($e=BE(de,be==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):$e=pS(de);const nt=this.stack[this.stack.length-1];nt.value+=$e}function ee(q){const de=this.stack.pop();de.position.end=mu(q.end)}function X(q){M.call(this,q);const de=this.stack[this.stack.length-1];de.url=this.sliceSerialize(q)}function ye(q){M.call(this,q);const de=this.stack[this.stack.length-1];de.url="mailto:"+this.sliceSerialize(q)}function He(){return{type:"blockquote",children:[]}}function he(){return{type:"code",lang:null,meta:null,value:""}}function Le(){return{type:"inlineCode",value:""}}function ue(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function De(){return{type:"emphasis",children:[]}}function Ye(){return{type:"heading",depth:0,children:[]}}function et(){return{type:"break"}}function Ke(){return{type:"html",value:""}}function it(){return{type:"image",title:null,url:"",alt:null}}function ot(){return{type:"link",title:null,url:"",children:[]}}function vt(q){return{type:"list",ordered:q.type==="listOrdered",start:null,spread:q._spread,children:[]}}function Ee(q){return{type:"listItem",spread:q._spread,checked:null,children:[]}}function Je(){return{type:"paragraph",children:[]}}function Ae(){return{type:"strong",children:[]}}function _e(){return{type:"text",value:""}}function le(){return{type:"thematicBreak"}}}function mu(e){return{line:e.line,column:e.column,offset:e.offset}}function ZE(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?ZE(e,r):qX(e,r)}}function qX(e,n){let t;for(t in n)if(XE.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function vj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Km({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Km({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Km({start:n.start,end:n.end})+") is still open")}function VX(e){const n=this;n.parser=t;function t(r){return BX(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const wj={}.hasOwnProperty;function eA(e,n){const t=n||{};function r(a,...o){let l=r.invalid;const d=r.handlers;if(a&&wj.call(a,e)){const f=String(a[e]);l=wj.call(d,f)?d[f]:r.unknown}if(l)return l.call(this,a,...o)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const HX={}.hasOwnProperty;function tA(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)tA(e,n.extensions[t]);for(r in n)if(HX.call(n,r))switch(r){case"extensions":break;case"unsafe":{Sj(e[r],n[r]);break}case"join":{Sj(e[r],n[r]);break}case"handlers":{GX(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function Sj(e,n){n&&e.push(...n)}function GX(e,n){n&&Object.assign(e,n)}function YX(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),WX);return a(),l}function WX(e,n,t){return">"+(t?"":" ")+e}function nA(e,n){return Nj(e,n.inConstruct,!0)&&!Nj(e,n.notInConstruct,!1)}function Nj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function Cj(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&nA(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function QX(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function sw(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function JX(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function KX(e,n,t,r){const a=JX(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(sw(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,XX);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(QX(o,a)+1,3)),u=t.enter("codeFenced");let h=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=d.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=d.move(" "),h+=d.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...d.current()})),g()}return h+=d.move(`
`),o&&(h+=d.move(o+`
`)),h+=d.move(f),u(),h}function XX(e,n,t){return(t?"":"    ")+e}function yS(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function ZX(e,n,t,r){const a=yS(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function eZ(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function wu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Nb(e,n,t){const r=Sb(e),a=Sb(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}rA.peek=tZ;function rA(e,n,t,r){const a=eZ(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=Nb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=wu(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=Nb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+wu(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function tZ(e,n,t){return t.options.emphasis||"*"}const xS=function(e){if(e==null)return aZ;if(typeof e=="function")return nv(e);if(typeof e=="object")return Array.isArray(e)?nZ(e):rZ(e);if(typeof e=="string")return iZ(e);throw new Error("Expected function, string, or object as test")};function nZ(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=xS(e[t]);return nv(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function rZ(e){const n=e;return nv(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function iZ(e){return nv(n);function n(t){return t&&t.type===e}}function nv(e){return n;function n(t,r,a){return!!(sZ(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function aZ(){return!0}function sZ(e){return e!==null&&typeof e=="object"&&"type"in e}const iA=[],oZ=!0,ow=!1,lZ="skip";function cZ(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=xS(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,h){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=iA,S,k,T;if((!n||o(f,u,h[h.length-1]||void 0))&&(v=uZ(t(f,h)),v[0]===ow))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==lZ)for(k=(r?P.children.length:-1)+l,T=h.concat(P);k>-1&&k<P.children.length;){const R=P.children[k];if(S=d(R,k,T)(),S[0]===ow)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function uZ(e){return Array.isArray(e)?e:typeof e=="number"?[oZ,e]:e==null?iA:[e]}function aA(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),cZ(e,o,d,a);function d(f,u){const h=u[u.length-1],g=h?h.children.indexOf(f):void 0;return l(f,g,h)}}function sA(e,n){let t=!1;return aA(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,ow}),!!((!e.depth||e.depth<3)&&hS(e)&&(n.options.setext||t))}function dZ(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(sA(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=wu(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}oA.peek=fZ;function oA(e){return e.value||""}function fZ(){return"<"}lA.peek=hZ;function lA(e,n,t,r){const a=yS(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function hZ(){return"!"}cA.peek=pZ;function cA(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function pZ(){return"!"}uA.peek=mZ;function uA(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function mZ(){return"`"}function dA(e,n){const t=hS(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}fA.peek=gZ;function fA(e,n,t,r){const a=yS(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(dA(e,t)){const h=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=h,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function gZ(e,n,t){return dA(e,t)?"<":"["}hA.peek=yZ;function hA(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=h,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function yZ(){return"["}function bS(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function xZ(e){const n=bS(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function bZ(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function pA(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function vZ(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?bZ(t):bS(t);const d=e.ordered?l==="."?")":".":xZ(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),pA(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function wZ(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function SZ(e,n,t,r){const a=wZ(t);let o=t.bulletCurrent||bS(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),h);return f(),u;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function NZ(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const CZ=xS(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function _Z(e,n,t,r){return(e.children.some(function(l){return CZ(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function jZ(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}mA.peek=kZ;function mA(e,n,t,r){const a=jZ(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),h=Nb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(f=wu(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=Nb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+wu(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},d+f+v}function kZ(e,n,t){return t.options.strong||"*"}function TZ(e,n,t,r){return t.safe(e.value,r)}function EZ(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function AZ(e,n,t){const r=(pA(t)+(t.options.ruleSpaces?" ":"")).repeat(EZ(t));return t.options.ruleSpaces?r.slice(0,-1):r}const PZ={blockquote:YX,break:Cj,code:KX,definition:ZX,emphasis:rA,hardBreak:Cj,heading:dZ,html:oA,image:lA,imageReference:cA,inlineCode:uA,link:fA,linkReference:hA,list:vZ,listItem:SZ,paragraph:NZ,root:_Z,strong:mA,text:TZ,thematicBreak:AZ},DZ=[IZ];function IZ(e,n,t,r){if(n.type==="code"&&sw(n,r)&&(e.type==="list"||e.type===n.type&&sw(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&sA(n,r))?void 0:t.spread?1:0}const Bd=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],RZ=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Bd},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Bd},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Bd},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Bd},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Bd},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Bd},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Bd},{atBreak:!0,character:"~"}];function MZ(e){return e.label||!e.identifier?e.label||"":KE(e.identifier)}function OZ(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function LZ(e,n,t){const r=n.indexStack,a=e.children||[],o=[];let l=-1,d=t.before,f;r.push(-1);let u=n.createTracker(t);for(;++l<a.length;){const h=a[l];let g;if(r[r.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else g=t.after;o.length>0&&(d==="\r"||d===`
`)&&h.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),d=" ",u=n.createTracker(t),u.move(o.join("")));let b=n.handle(h,e,n,{...u.current(),after:g,before:d});f&&f===b.slice(0,1)&&(b=wu(f.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,f=void 0,v&&(o.length>0&&v.before&&d===o[o.length-1].slice(-1)&&(o[o.length-1]=o[o.length-1].slice(0,-1)+wu(d.charCodeAt(0))),v.after&&(f=g)),u.move(b),o.push(b),d=b.slice(-1)}return r.pop(),o.join("")}function FZ(e,n,t){const r=n.indexStack,a=e.children||[],o=n.createTracker(t),l=[];let d=-1;for(r.push(-1);++d<a.length;){const f=a[d];r[r.length-1]=d,l.push(o.move(n.handle(f,e,n,{before:`
`,after:`
`,...o.current()}))),f.type!=="list"&&(n.bulletLastUsed=void 0),d<a.length-1&&l.push(o.move($Z(f,a[d+1],e,n)))}return r.pop(),l.join("")}function $Z(e,n,t,r){let a=r.join.length;for(;a--;){const o=r.join[a](e,n,t,r);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}const zZ=/\r?\n|\r/g;function BZ(e,n){const t=[];let r=0,a=0,o;for(;o=zZ.exec(e);)l(e.slice(r,o.index)),t.push(o[0]),r=o.index+o[0].length,a++;return l(e.slice(r)),t.join("");function l(d){t.push(n(d,a,!d))}}function UZ(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],o=[],l={};let d=-1;for(;++d<e.unsafe.length;){const h=e.unsafe[d];if(!nA(e.stack,h))continue;const g=e.compilePattern(h);let b;for(;b=g.exec(r);){const v="before"in h||!!h.atBreak,S="after"in h,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(qZ);let f=t.before?t.before.length:0;const u=r.length-(t.after?t.after.length:0);for(d=-1;++d<a.length;){const h=a[d];h<f||h>=u||h+1<u&&a[d+1]===h+1&&l[h].after&&!l[h+1].before&&!l[h+1].after||a[d-1]===h-1&&l[h].before&&!l[h-1].before&&!l[h-1].after||(f!==h&&o.push(_j(r.slice(f,h),"\\")),f=h,/[!-/:-@[-`{-~]/.test(r.charAt(h))&&(!t.encode||!t.encode.includes(r.charAt(h)))?o.push("\\"):(o.push(wu(r.charCodeAt(h))),f++))}return o.push(_j(r.slice(f,u),t.after)),o.join("")}function qZ(e,n){return e-n}function _j(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],o=e+n;let l=-1,d=0,f;for(;f=t.exec(o);)r.push(f.index);for(;++l<r.length;)d!==r[l]&&a.push(e.slice(d,r[l])),a.push("\\"),d=r[l];return a.push(e.slice(d)),a.join("")}function VZ(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,o=t.column||1;return{move:f,current:l,shift:d};function l(){return{now:{line:a,column:o},lineShift:r}}function d(u){r+=u}function f(u){const h=u||"",g=h.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,o=g.length===1?o+b.length:1+b.length+r,h}}function HZ(e,n){const t=n||{},r={associationId:MZ,containerPhrasing:QZ,containerFlow:JZ,createTracker:VZ,compilePattern:OZ,enter:o,handlers:{...PZ},handle:void 0,indentLines:BZ,indexStack:[],join:[...DZ],options:{},safe:KZ,stack:[],unsafe:[...RZ]};tA(r,t),r.options.tightDefinitions&&r.join.push(WZ),r.handle=eA("type",{invalid:GZ,unknown:YZ,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function o(l){return r.stack.push(l),d;function d(){r.stack.pop()}}}function GZ(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function YZ(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function WZ(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function QZ(e,n){return LZ(e,this,n)}function JZ(e,n){return FZ(e,this,n)}function KZ(e,n){return UZ(this,e,n)}function XZ(e){const n=this;n.compiler=t;function t(r){return HZ(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function jj(e){if(e)throw e}var Y0,kj;function ZZ(){if(kj)return Y0;kj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var h=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!h&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,h){t&&h.name==="__proto__"?t(u,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):u[h.name]=h.newValue},d=function(u,h){if(h==="__proto__")if(e.call(u,h)){if(r)return r(u,h).value}else return;return u[h]};return Y0=function f(){var u,h,g,b,v,S,k=arguments[0],T=1,P=arguments.length,R=!1;for(typeof k=="boolean"&&(R=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(h in u)g=d(k,h),b=d(u,h),k!==b&&(R&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:h,newValue:f(R,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},Y0}var eee=ZZ();const W0=tf(eee);function lw(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function tee(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const h=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,h?nee(h,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function nee(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const h=u;if(d&&t)throw h;return a(h)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}class ka extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=d?d.line:void 0,this.name=Km(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}ka.prototype.file="";ka.prototype.name="";ka.prototype.reason="";ka.prototype.message="";ka.prototype.stack="";ka.prototype.column=void 0;ka.prototype.line=void 0;ka.prototype.ancestors=void 0;ka.prototype.cause=void 0;ka.prototype.fatal=void 0;ka.prototype.place=void 0;ka.prototype.ruleId=void 0;ka.prototype.source=void 0;const ul={basename:ree,dirname:iee,extname:aee,join:see,sep:"/"};function ree(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');wg(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function iee(e){if(wg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function aee(e){wg(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function see(...e){let n=-1,t;for(;++n<e.length;)wg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":oee(t)}function oee(e){wg(e);const n=e.codePointAt(0)===47;let t=lee(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function lee(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function wg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const cee={cwd:uee};function uee(){return"/"}function cw(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function dee(e){if(typeof e=="string")e=new URL(e);else if(!cw(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return fee(e)}function fee(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const Q0=["history","path","basename","stem","extname","dirname"];class hee{constructor(n){let t;n?cw(n)?t={path:n}:typeof n=="string"||pee(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":cee.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Q0.length;){const o=Q0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)Q0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?ul.basename(this.path):void 0}set basename(n){K0(n,"basename"),J0(n,"basename"),this.path=ul.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?ul.dirname(this.path):void 0}set dirname(n){Tj(this.basename,"dirname"),this.path=ul.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?ul.extname(this.path):void 0}set extname(n){if(J0(n,"extname"),Tj(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=ul.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){cw(n)&&(n=dee(n)),K0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?ul.basename(this.path,this.extname):void 0}set stem(n){K0(n,"stem"),J0(n,"stem"),this.path=ul.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new ka(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function J0(e,n){if(e&&e.includes(ul.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+ul.sep+"`")}function K0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function Tj(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function pee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const mee=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},gee={}.hasOwnProperty;class vS extends mee{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=tee()}copy(){const n=new vS;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(W0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(e1("data",this.frozen),this.namespace[n]=t,this):gee.call(this.namespace,n)&&this.namespace[n]||void 0:n?(e1("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Rx(n),r=this.parser||this.Parser;return X0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),X0("process",this.parser||this.Parser),Z0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=Rx(n),f=r.parse(d);r.run(f,d,function(h,g,b){if(h||!g||!b)return u(h);const v=g,S=r.stringify(v,b);bee(S)?b.value=S:b.result=S,u(h,b)});function u(h,g){h||!g?l(h):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),X0("processSync",this.parser||this.Parser),Z0("processSync",this.compiler||this.Compiler),this.process(n,a),Aj("processSync","process",t),r;function a(o,l){t=!0,jj(o),r=l}}run(n,t,r){Ej(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=Rx(t);a.run(n,f,u);function u(h,g,b){const v=g||n;h?d(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),Aj("runSync","run",r),a;function o(l,d){jj(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=Rx(t),a=this.compiler||this.Compiler;return Z0("stringify",a),Ej(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(e1("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...g]=u;f(h,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=W0(!0,a.settings,u.settings))}function d(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const g=u[h];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];lw(k)&&lw(v)&&(v=W0(!0,k,v)),r[b]=[u,v,...S]}}}}const yee=new vS().freeze();function X0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Z0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function e1(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Ej(e){if(!lw(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Aj(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Rx(e){return xee(e)?e:new hee(e)}function xee(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function bee(e){return typeof e=="string"||vee(e)}function vee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const t1=yee().use(VX).use(XZ).freeze(),wee=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},See=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},n1=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,loadingText:o,noDataText:l,onDeleteItem:d,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:h,onLabOrderTestChange:g,onLabOrderStatusChange:b,onEditPharmacyOrder:v,onPrintUnavailablePrescription:S,onBillLabOrder:k,onUpdateLabOrderStatus:T,onEnterLabReport:P,labInventory:R=[],isSavingLabOrder:I=!1,expandedLabReports:B={},toggleLabReport:F=()=>{},selectionEnabled:L=!1,selectedIds:U=new Set,onSelectionChange:H})=>{const K=w.useMemo(()=>{const $={};n.forEach(W=>{if(isNaN(W.date.getTime())){$["Unknown Date"]||($["Unknown Date"]=[]),$["Unknown Date"].push(W);return}const te=wee(W.originalDateString);$[te]||($[te]=[]),$[te].push(W)});const z=Object.keys($);return z.sort((W,te)=>{if(W==="Unknown Date")return 1;if(te==="Unknown Date")return-1;try{const V=new Date(W.split(" ").reverse().join(" ")),G=new Date(te.split(" ").reverse().join(" "));if(!isNaN(V.getTime())&&!isNaN(G.getTime()))return G.getTime()-V.getTime()}catch{}return te.localeCompare(W)}),z.map(W=>({date:W,items:$[W]}))},[n]),M=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),a&&i.jsx("p",{className:"ai-context-text italic",children:o}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:l}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:K.map(({date:$,items:z})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:$}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:z.map((W,te)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[!(W.type==="Lab Order"&&W.data.isEditing)&&i.jsxs("div",{className:"flex justify-between items-center w-full",children:[L&&H&&W.type==="Pharmacy Order"&&i.jsx("div",{className:"mr-2",children:i.jsx("input",{type:"checkbox",checked:U.has(W.data.id),onChange:V=>H(W.data.id,V.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(W,te,B,F)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[W.type==="Lab Order"&&!W.data.isEditing&&f&&i.jsx("button",{onClick:()=>f(W.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:I,children:i.jsx(uo,{size:14})}),W.type==="Lab Order"&&W.data.isEditing&&i.jsx(i.Fragment,{}),W.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[W.data.status==="pending"&&k&&(()=>{const V=W.data.tests.reduce((G,J)=>G+(Number(J.price)||0),0).toFixed(2);return i.jsx("button",{onClick:()=>k(W.data),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:`Pay total of ${V}`,disabled:I,children:i.jsx($k,{size:14})})})(),W.data.status==="billed"&&T&&i.jsx("button",{onClick:()=>T(W.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),W.data.status==="collected"&&T&&i.jsx("button",{onClick:()=>T(W.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),["pending","billed","collected","processing","report_ready","reported","completed"].includes(W.data.status)&&P&&i.jsx("button",{onClick:()=>P(W.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(W.data.status==="report_ready"||W.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T(W.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"})]}),W.type==="Pharmacy Order"&&W.data.status==="pending"&&v&&i.jsx("button",{onClick:()=>v(W.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:I,children:i.jsx(uo,{size:14})}),W.type==="Pharmacy Order"&&W.data.prescriptionForUnavailableDrugs&&S&&i.jsx("button",{onClick:()=>S(W.data.prescriptionForUnavailableDrugs,`Prescription for Order ${W.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:I,children:i.jsx(hl,{size:14})}),W.type==="Pharmacy Order"&&W.data.status==="pending"&&d&&i.jsx("button",{onClick:()=>d({type:W.type,data:W.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:I,children:i.jsx(jr,{size:14})}),d&&["Complaint","Lab Order","Lab Report"].includes(W.type)&&i.jsx("button",{onClick:()=>d({type:W.type,data:W.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${W.type.toLowerCase()}`,disabled:I,children:i.jsx(jr,{size:14})})]})]}),W.type==="Lab Order"&&W.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form w-full bg-gray-50 border rounded-md p-3",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h6",{className:"text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Edit Order"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Status:"}),i.jsx("select",{value:W.data.editedStatus||W.data.status,onChange:V=>b&&b(W.data.id,V.target.value),className:"form-select text-xs py-1 pl-2 pr-6 rounded border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:I,children:M.map(V=>i.jsx("option",{value:V,children:V.replace(/_/g," ")},V))})]})]}),i.jsx("div",{className:"overflow-hidden border rounded-md bg-white mb-3",children:i.jsxs("table",{className:"w-full text-xs text-left",children:[i.jsx("thead",{className:"bg-gray-100 border-b",children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-2 px-3 font-medium text-gray-600",children:"Test Name"}),i.jsx("th",{className:"py-2 px-3 text-right font-medium text-gray-600 w-20",children:"Price"}),i.jsx("th",{className:"py-2 px-3 w-10"})]})}),i.jsxs("tbody",{className:"divide-y divide-gray-100",children:[W.data.editedTests.map((V,G)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"py-1 px-3",children:i.jsxs("select",{value:V.id,onChange:J=>{const oe=R.find(ie=>String(ie.id)===J.target.value);oe&&(g&&g(W.data.id,G,"id",oe.id),g&&g(W.data.id,G,"name",oe.name),g&&g(W.data.id,G,"price",oe.price))},className:"form-select w-full text-xs border-0 bg-transparent focus:ring-0 p-0",disabled:I,children:[i.jsx("option",{value:"",children:"Select Test"}),R.map(J=>i.jsx("option",{value:J.id,children:J.name},J.id))]})}),i.jsxs("td",{className:"py-1 px-3 text-right text-gray-700",children:["",V.price]}),i.jsx("td",{className:"py-1 px-3 text-center",children:i.jsx("button",{onClick:()=>{const J=W.data.editedTests.filter((oe,ie)=>ie!==G);g&&g(W.data.id,-1,"remove",J)},className:"text-red-400 hover:text-red-600 focus:outline-none",title:"Remove test",disabled:I,children:i.jsx(jr,{size:12})})})]},G)),W.data.editedTests.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"py-2 px-3 text-center italic text-gray-400",children:"No tests selected"})})]}),i.jsx("tfoot",{className:"bg-gray-50 border-t",children:i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"py-1 px-3",children:i.jsx("button",{onClick:()=>{g&&g(W.data.id,-1,"add",{id:"",name:"",price:0})},className:"text-blue-600 hover:text-blue-800 text-xs font-medium flex items-center py-1",disabled:I,children:"+ Add Test"})})})})]})}),i.jsxs("div",{className:"flex justify-end space-x-2 border-t border-gray-200 pt-3 mt-1",children:[i.jsx("button",{onClick:()=>h&&h(W.data.id),className:"px-3 py-1.5 rounded text-xs text-gray-600 hover:bg-white hover:text-gray-800 border border-transparent hover:border-gray-200 transition-colors",disabled:I,children:"Cancel"}),i.jsx("button",{onClick:()=>u&&u(W.data.id,W.data.editedTests,W.data.editedStatus),className:"px-3 py-1.5 rounded text-xs bg-blue-600 text-white hover:bg-blue-700 shadow-sm flex items-center space-x-1 transition-colors",disabled:I,children:I?i.jsx("span",{children:"Saving..."}):i.jsxs(i.Fragment,{children:[i.jsx(Jd,{size:12}),i.jsx("span",{children:"Save Changes"})]})})]})]})]},`${W.type}-${W.originalDateString}-${te}`))})]},$))})]})},Nee="_modalOverlay_spc0l_3",Cee="_modalContent_spc0l_29",_ee="_modalHeader_spc0l_61",jee="_modalTitle_spc0l_79",kee="_modalCloseButton_spc0l_91",Tee="_modalBody_spc0l_119",Eee="_errorText_spc0l_137",Aee="_formGroup_spc0l_155",Pee="_inputField_spc0l_179",Dee="_searchResultsCard_spc0l_221",Iee="_searchResultsList_spc0l_249",Ree="_searchResultItem_spc0l_261",Mee="_searchResultPrice_spc0l_297",Oee="_selectedTestsCard_spc0l_307",Lee="_selectedTestsHeader_spc0l_327",Fee="_noTestsMessage_spc0l_343",$ee="_selectedTestsList_spc0l_359",zee="_selectedTestItem_spc0l_371",Bee="_selectedTestName_spc0l_395",Uee="_selectedTestPrice_spc0l_407",qee="_removeTestButton_spc0l_419",Vee="_totalAmount_spc0l_445",Hee="_modalFooter_spc0l_463",Gee="_button_spc0l_489",Yee="_buttonPrimary_spc0l_507",Wee="_buttonSecondary_spc0l_529",Pt={modalOverlay:Nee,modalContent:Cee,modalHeader:_ee,modalTitle:jee,modalCloseButton:kee,modalBody:Tee,errorText:Eee,formGroup:Aee,inputField:Pee,searchResultsCard:Dee,searchResultsList:Iee,searchResultItem:Ree,searchResultPrice:Mee,selectedTestsCard:Oee,selectedTestsHeader:Lee,noTestsMessage:Fee,selectedTestsList:$ee,selectedTestItem:zee,selectedTestName:Bee,selectedTestPrice:Uee,removeTestButton:qee,totalAmount:Vee,modalFooter:Hee,button:Gee,buttonPrimary:Yee,buttonSecondary:Wee},Qee=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){h([]);return}const R=d.toLowerCase();h(r.filter(I=>I.name.toLowerCase().includes(R)||I.description&&I.description.toLowerCase().includes(R)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const R={patient_id:t,tests:o.map(B=>({id:B.id,name:B.name,price:B.price}))},I=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!I.ok){const B=await I.json().catch(()=>({}));throw new Error(B.message||`Failed to create lab order: ${I.statusText}`)}await I.json(),a(t),n(),l([]),f("")}catch(R){b(`Lab Order Creation Error: ${R.message}`)}finally{S(!1)}},T=R=>{if(o.some(I=>I.id===R.id)){b(`${R.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),h([]);return}l(I=>[...I,{...R}]),f(""),h([])},P=R=>{l(I=>I.filter(B=>B.id!==R))};return e?i.jsx("div",{className:Pt.modalOverlay,children:i.jsxs("div",{className:Pt.modalContent,children:[i.jsxs("div",{className:Pt.modalHeader,children:[i.jsx("h3",{className:Pt.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:Pt.modalCloseButton,children:i.jsx(Sn,{size:20})})]}),i.jsxs("div",{className:Pt.modalBody,children:[g&&i.jsx("div",{className:Pt.errorText,children:g}),i.jsxs("div",{className:Pt.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:d,onChange:R=>f(R.target.value),className:Pt.inputField}),d&&u.length>0&&i.jsx("div",{className:Pt.searchResultsCard,children:i.jsx("ul",{className:Pt.searchResultsList,children:u.map(R=>i.jsxs("li",{onClick:()=>T(R),className:Pt.searchResultItem,children:[i.jsx("span",{children:R.name}),i.jsxs("span",{className:Pt.searchResultPrice,children:["(",parseFloat(String(R.price)).toFixed(2),")"]})]},R.id))})})]}),i.jsxs("div",{className:Pt.selectedTestsCard,children:[i.jsx("h4",{className:Pt.selectedTestsHeader,children:"Selected Tests"}),o.length===0?i.jsx("p",{className:Pt.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:Pt.selectedTestsList,children:o.map(R=>i.jsxs("li",{className:Pt.selectedTestItem,children:[i.jsx("span",{className:Pt.selectedTestName,children:R.name}),i.jsxs("span",{className:Pt.selectedTestPrice,children:["",parseFloat(String(R.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>P(String(R.id)),className:Pt.removeTestButton,title:"Remove Test",children:i.jsx(jr,{size:16})})]},R.id))})]}),o.length>0&&i.jsxs("div",{className:Pt.totalAmount,children:["Total: ",o.reduce((R,I)=>R+parseFloat(String(I.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:Pt.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Pt.button} ${Pt.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${Pt.button} ${Pt.buttonPrimary} ${o.length===0||v?Pt.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},Mx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},Vd=(e,n)=>{if(!e||!n||n.length===0)return;const t=Mx(e);let r=n.find(l=>Mx(l.name)===t);if(r)return r;let a=n.find(l=>Mx(l.name).includes(t));if(a)return a;let o=n.find(l=>t.includes(Mx(l.name)));if(o)return o},Jee=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details. **IMPORTANT:** This string MUST be a **Markdown table** with columns: 'Drug Name', 'Quantity', 'Dosage', 'Directions'. Do not use plain text.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
    -   **Recurring Medications:**
        -   Use \`create_recurring_medication_order\` to add a new recurring medication.
        -   Use \`edit_recurring_medication_order\` to edit an existing recurring medication (using its serial number).
        -   Recurring medications are long-term prescriptions (e.g., for chronic conditions) that automatically re-order or remind.
    -   **Important: Preventing Loops** If you determine that no further actions are needed (e.g., you have already performed necessary actions, or the user's input does not require any specific action), you **MUST** use the \`end_task\` action. This explicitly signals that your task is complete and prevents the system from re-prompting you unnecessarily.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "create_lab_report", "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "edit_lab_report", "serialNumber": number, "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." },
  { "action": "create_recurring_medication_order", "items": [ { "medication_name": "Drug Name", "drug_id": "string | null", "quantity": number, "frequency_days": number, "next_delivery_date": "YYYY-MM-DD", "tablets_per_day": number | null, "number_of_days": number | null, "directions": "string | null", "notes": "string | null" } ] },
  { "action": "edit_recurring_medication_order", "serialNumber": number, "updates": { "medication_name": "string (opt)", "quantity": number, "frequency_days": number, "status": "active" | "paused" | "stopped", "next_delivery_date": "YYYY-MM-DD", "number_of_days": number, "tablets_per_day": number, "directions": "string" } },
  { "action": "end_task" }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Structure:**
     The AI response can be a flat array of actions OR a list of "function call" objects containing grouped actions.
     **Option 1: Flat Array (Simple)**
     \`\`\`json
     [
       { "action": "add_complaint_history", ... },
       { "action": "create_lab_order", ... }
     ]
     \`\`\`
     **Option 2: Grouped Function Calls (Complex)**
     You can group actions under logical "function calls" if needed.
     \`\`\`json
     [
       {
         "function_call": "assess_patient",
         "actions": [
           { "action": "ask_followup_question", "question": "..." }
         ]
       },
       {
         "function_call": "prescribe_treatment",
         "actions": [
            { "action": "create_pharmacy_order", "items": [...] },
            { "action": "create_lab_order", "tests": [...] }
         ]
       }
     ]
     \`\`\`

   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this action (either standalone or inside a group) only when you need clarification.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"]
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,Pj="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",Kee="models/gemini-3-flash-preview";async function Xee(){if(!Tw())return console.warn("No auth token found, using default Gemini API key."),Pj;let n=null;try{const t=await me("/api/clinics/settings");if(t.ok){const r=await t.json();r.gemini_api_key&&r.gemini_api_key.trim()!==""&&(n=r.gemini_api_key.trim())}}catch(t){console.warn("Could not fetch clinic settings (or key missing), proceeding to global fallback.",t)}if(n)return n;try{const t=await me("/api/global-settings/app_gemini_api_key");if(t.ok){const a=(await t.json()).value;if(a&&a.trim()!=="")return a.trim()}}catch(t){console.warn("Could not fetch global API key.",t)}return console.warn("Clinic-specific and global Gemini API keys not found, using default env var."),Pj}let r1=null;async function Zee(){if(!r1){const e=await Xee();r1=new kw({apiKey:e})}return r1}async function ete(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:o,patientGender:l,case_summary:d,case_summary_last_updated:f,clinic_ai_memory:u,clinic_ai_memory_last_updated:h,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,pharmacyInventory:k,labInventory:T,recurringMedications:P}=e;let R=`Patient Complaint: ${t}`;if(d&&(R+=`

--- Case Summary (Provided by Doctor) ---
${d}`,f))try{const z=new Date(f).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});R+=`
(Last Updated: ${z})`}catch{console.warn(`Could not format case_summary_last_updated: ${f}`),R+=`
(Last Updated: ${f})`}if(a&&(R+=`

Patient Name: ${a}`),o!=null&&(R+=`
Patient Age: ${o}`),l&&(R+=`
Patient Gender: ${l}`),r)try{const z=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});R+=`

Current Interaction Time: ${z}`}catch{console.warn(`Could not format currentDateTime: ${r}`),R+=`

Current Interaction Time: ${r}`}if(u&&(R+=`

--- Clinic-wide AI Memory/Context ---
${u}`,h))try{const z=new Date(h).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});R+=`
(Last Updated: ${z})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${h}`),R+=`
(Last Updated: ${h})`}let I="";b&&Array.isArray(b)&&b.length>0&&(I=`

--- Lab History (Orders & Reports) ---
`,b.forEach(z=>{let W="Unknown Date";try{W=new Date(z.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${z.orderDate}`)}if(I+=`
Order #${z.serialNumber} Date: ${W} (Status: ${z.status})
`,I+=`Tests: ${z.tests.map(te=>te.name).join(", ")}
`,z.report){let te="Unknown Date";try{te=new Date(z.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${z.report.reportDate}`)}I+=`  -> Report Date: ${te}
`,z.report.tests&&Array.isArray(z.report.tests)?(I+=`     Findings:
`,z.report.tests.forEach(V=>{I+=`       - Test: ${V.testName}
`,V.parameters&&Array.isArray(V.parameters)&&V.parameters.forEach(G=>{I+=`         - ${G.name}: ${G.value} (Normal: ${G.normal_range})
`})})):(I+=`     Findings: ${z.report.reportContent||"N/A"}
`,z.report.error&&(I+=`     Note: ${z.report.error}
`))}I+=`---
`}),R+=I);let B="";v&&Array.isArray(v)&&v.length>0&&(B=`

--- Recent Pharmacy Orders ---
`,v.forEach(z=>{let W="Unknown Date/Time";try{W=new Date(z.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${z.date}`)}B+=`
Order #${z.serialNumber} Date/Time: ${W} (Status: ${z.status})
`,B+=`Prescribed By: ${z.prescribedBy||"N/A"}
`,z.dispensedBy&&(B+=`Dispensed By: ${z.dispensedBy}
`),B+=`Medications:
`,z.medications.forEach(te=>{B+=`  - ${te.name} (Qty: ${te.quantity}`,te.tabletsPerDay&&(B+=`, ${te.tabletsPerDay}/day`),te.numberOfDays&&(B+=` for ${te.numberOfDays} days`),B+=`)
`}),z.prescriptionForUnavailableDrugs&&(B+=`  Prescription for Unavailable Drugs: ${z.prescriptionForUnavailableDrugs}
`),B+=`---
`}),R+=B);let F="";P&&Array.isArray(P)&&P.length>0&&(F=`

--- Recurring Medications (Active) ---
`,P.forEach((z,W)=>{let te=`${W+1}. ${z.medicationName} (${z.frequencyDays} days)`;if(z.tabletsPerDay&&(te+=` - ${z.tabletsPerDay} tabs/day`),z.numberOfDays&&(te+=` for ${z.numberOfDays} days`),te+=` [Status: ${z.status}]`,z.nextDeliveryDate)try{const V=new Date(z.nextDeliveryDate).toLocaleDateString();te+=` (Next: ${V})`}catch{}F+=`${te}
`}),R+=F);let L="";S&&Array.isArray(S)&&S.length>0&&(L=`

--- Past Complaints History ---
`,S.forEach(z=>{let W="Unknown Date/Time";try{W=new Date(z.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${z.createdAt}`)}L+=`
Date/Time: ${W}
Complaint: ${z.complaint||"N/A"}
---
`}),R+=L);let U="";k&&Array.isArray(k)&&k.length>0&&(U=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(z=>{let W=`${z.stock??0} packs`;z.loose!==void 0&&z.loose!==null&&z.loose>0&&(W+=`, ${z.loose} loose`);let te=`- ${z.name} (Pack: ${z.pack??"N/A"}): ${W}`;const V=[];z.brand_name&&V.push(`Brand: ${z.brand_name}`),z.batch&&V.push(`Batch: ${z.batch}`),z.expiry_date&&V.push(`Exp: ${z.expiry_date}`),V.length>0&&(te+=` [${V.join(", ")}]`),U+=`${te}
`}),R+=U);let H="";T&&Array.isArray(T)&&T.length>0&&(H=`

--- Available Lab Tests (with Parameters) ---
`,T.forEach(z=>{H+=`- ${z.name} (Price: ${z.price??"N/A"})
`,z.default_parameters&&Array.isArray(z.default_parameters)&&z.default_parameters.length>0&&z.default_parameters.forEach(W=>{let te=`    * ${W.name}`;W.unit&&(te+=` (${W.unit})`),W.normal_range?te+=` [Normal: ${W.normal_range}]`:W.lower_limit!==void 0&&W.upper_limit!==void 0&&W.lower_limit!==null&&W.upper_limit!==null&&(te+=` [Normal: ${W.lower_limit} - ${W.upper_limit}]`),H+=`${te}
`})}),R+=H);const K=[{text:Jee}];g&&g.trim()!==""&&K.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const M=[{text:R}];if(n){const z=new FileReader,W=await new Promise((te,V)=>{z.onloadend=()=>{typeof z.result=="string"?te(z.result.split(",")[1]):V(new Error("Failed to read image file as base64."))},z.onerror=V,z.readAsDataURL(n)});M.push({inlineData:{mimeType:n.type,data:W}})}const $=[];K.length>0&&$.push({role:"user",parts:K}),$.push({role:"user",parts:M});try{const z={model:Kee,contents:$,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},te=await(await Zee()).models.generateContentStream(z);let V="";for await(const G of te)if(G&&typeof G.text=="function"){const J=G.text;J&&(V+=J)}else G&&G.candidates&&G.candidates[0]&&G.candidates[0].content&&G.candidates[0].content.parts&&G.candidates[0].content.parts[0]&&G.candidates[0].content.parts[0].text&&(V+=G.candidates[0].content.parts[0].text);if(V&&V.trim()!=="")return V.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(z){console.error("Error calling Gemini API:",z);let W="Failed to get suggestion from Gemini.";throw z.message&&(W=`Error processing Gemini request: ${z.message}`),new Error(W)}}const tte=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},nte=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:o,userMessages:l,selectedImageFile:d,pendingLabOrders:f,labReports:u,pastComplaints:h,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,recurringMedications:S,currentComplaint:k,setCurrentComplaint:T,setAiResponse:P,setAiResponseText:R,setAiResponseJsonString:I,setShowAiJsonDetails:B,setIsLoadingAi:F,setAiError:L,setIsSubmittingAiOrder:U,setAiOrderSubmissionStatus:H,setIsSubmittingAiLabOrder:K,setAiLabOrderSubmissionStatus:M,setIsSubmittingAiComplaint:$,setAiComplaintSubmissionStatus:z,setIsUpdatingCaseSummary:W,setAiCaseSummaryUpdateStatus:te,setCaseSummary:V,setIsUpdatingAiMemoryByAI:G,setAiMemoryUpdateByAIStatus:J,setFollowUpQuestion:oe,setFollowUpOptions:ie,setError:E,setIsSavingAiResponse:ce,setSaveAiResponseError:ge,fetchPharmacyOrdersData:D,fetchPendingLabOrdersData:pe,fetchLabReportsData:Ce,fetchRecurringMedicationsData:Z,fetchPastComplaintsData:ee,fetchPatientDetails:X,setClinicSettings:ye,setEditedAiMemory:He,setCanUndo:he,onAiActionSuccess:Le,addMessage:ue},De)=>{const[Ye,et]=Pn.useState(null);Pn.useEffect(()=>{he(!!Ye)},[Ye,he]);let Ke;const it=async(Ae,_e,le,q=0)=>{let de;const $e=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(nt=>{var ht;return(ht=_e.message)==null?void 0:ht.includes(nt)});le&&$e?de=`AI Error: ${_e.message}

${le}`:(de=`I encountered a frontend error while trying to execute the '${Ae}' function. The error message is: "${_e.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(Ae==="create_pharmacy_order"||Ae==="edit_pharmacy_order")&&(de+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can use 'prescription_for_unavailable_drugs' to write a prescription. **NOTE:** This field MUST be formatted as a Markdown table (columns: Drug Name, Quantity, Dosage, Directions).`),le&&(de+=`

The original AI response that caused the error was:
\`\`\`
${le}
\`\`\``)),ue==null||ue({role:"system",type:"error",content:`AI Error: ${_e.message}. Retrying...`}),await Ke(de,q+1)},ot=async Ae=>{console.log("Executing Rollback for actions:",Ae);for(const _e of Ae){const{actionType:le,undoData:q}=_e;if(console.log(`Attempting to rollback ${le}`,q),!q){console.warn(`No undoData found for action ${le}, skipping.`);continue}try{if(le==="create_pharmacy_order")q!=null&&q.orderId?(console.log(`Deleting pharmacy order ${q.orderId}`),await me(`/api/pharmacy-orders/${q.orderId}`,{method:"DELETE"}),D(n)):console.error("Missing orderId for create_pharmacy_order rollback");else if(le==="create_lab_order")q!=null&&q.orderId?(console.log(`Deleting lab order ${q.orderId}`),await me(`/api/lab/orders/${q.orderId}`,{method:"DELETE"}),pe(n)):console.error("Missing orderId for create_lab_order rollback");else if(le==="update_patient_details")if(q!=null&&q.patientId&&(q!=null&&q.originalDetails)){console.log(`Reverting patient details for ${q.patientId}`);const de=q.originalDetails,be={name:de.name,age:de.age,gender:de.gender,phone:de.phone,ai_response:de.ai_response};await me(`/api/patients/${q.patientId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(be)}),X(q.patientId)}else console.error("Missing patientId or originalDetails for update_patient_details rollback");else if(le==="add_complaint_history")q!=null&&q.recordId?(console.log(`Reverting complaint history for ${q.recordId}`),await me(`/api/queue/doctor/complaint/${q.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:q.originalComplaint||""})}),T(q.originalComplaint||"")):console.error("Missing recordId for add_complaint_history rollback");else if(le==="update_case_summary")q!=null&&q.recordId?(console.log(`Reverting case summary for ${q.recordId}`),await me(`/api/queue/doctor/complaint/${q.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:q.originalSummary||""})}),V(q.originalSummary||"")):console.error("Missing recordId for update_case_summary rollback");else if(le==="update_clinic_ai_memory")(q==null?void 0:q.originalMemory)!==void 0?(console.log("Reverting AI memory"),await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify({...o,aiMemory:q.originalMemory})}),He(q.originalMemory)):console.error("Missing originalMemory for update_clinic_ai_memory rollback");else if(le==="edit_pharmacy_order")if(q!=null&&q.orderId&&(q!=null&&q.originalState)){console.log(`Reverting pharmacy order ${q.orderId}`);const de={items:q.originalState.medications||[],status:q.originalState.status,prescription_for_unavailable_drugs:q.originalState.prescription_for_unavailable_drugs,order_total:q.originalState.order_total};await me(`/api/pharmacy-orders/${q.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(de)}),D(n)}else console.error("Missing orderId or originalState for edit_pharmacy_order rollback");else if(le==="edit_lab_order")if(q!=null&&q.orderId&&(q!=null&&q.originalState)){console.log(`Reverting lab order ${q.orderId}`);const de={tests:q.originalState.tests,status:q.originalState.status};await me(`/api/lab/orders/${q.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(de)}),pe(n)}else console.error("Missing orderId or originalState for edit_lab_order rollback");else if(le==="create_recurring_medication_order")if(q!=null&&q.createdIds&&q.createdIds.length>0){console.log(`Deleting recurring medications: ${q.createdIds.join(", ")}`);for(const de of q.createdIds)await me(`/api/recurring-medications/${de}`,{method:"DELETE"});n&&Z&&Z(n)}else console.error("Missing createdIds for create_recurring_medication_order rollback");else le==="edit_recurring_medication_order"?q!=null&&q.medicationId&&(q!=null&&q.originalState)?(console.log(`Reverting recurring medication ${q.medicationId}`),await me(`/api/recurring-medications/${q.medicationId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(q.originalState)}),n&&Z&&Z(n)):console.error("Missing medicationId or originalState for edit_recurring_medication_order rollback"):console.warn(`Unknown action type for rollback: ${le}`)}catch(de){console.error(`Failed to rollback ${le}:`,de)}}},vt=async()=>{!Ye||!window.confirm("Are you sure you want to undo the last AI actions?")||(F(!0),await ot([...Ye].reverse()),et(null),F(!1),L("Last actions undone successfully."))},Ee=async(Ae,_e)=>{et(null),H(null),M(null),z(null),te(null),J(null),oe(null),ie([]),E(null);let le=null;const q=/```json\s*([\s\S]*?)\s*```/,de=Ae.match(q);if(de&&de[1])le=de[1];else{const be=Ae.trim();if(be.startsWith("{")&&be.endsWith("}"))le=be;else if(be.startsWith("[")&&be.endsWith("]"))le=be;else throw new Error("AI response did not contain a recognized function call.")}if(le)try{const be=JSON.parse(le),$e=Ne=>{const Oe=[],Ve=Array.isArray(Ne)?Ne:[Ne];for(const Ze of Ve)Ze&&(Ze.actions&&Array.isArray(Ze.actions)?Oe.push(...$e(Ze.actions)):Ze.sub_actions&&Array.isArray(Ze.sub_actions)?Oe.push(...$e(Ze.sub_actions)):Ze.function_calls&&Array.isArray(Ze.function_calls)?Oe.push(...$e(Ze.function_calls)):typeof Ze.action=="string"&&Oe.push(Ze));return Oe},nt=$e(be),ht=[];let wt=null,Et=!1;for(const Ne of nt){if(Ne.action==="ask_followup_question"){wt=Ne,Et=!0;continue}Et=!0;const Oe=Ne.action;Oe==="update_clinic_ai_memory"&&typeof Ne.memory_content=="string"?ht.push((async()=>{G(!0),J("Processing AI mem..."),ue==null||ue({role:"system",type:"loading",content:"Processing AI memory..."});const Ve=(o==null?void 0:o.aiMemory)||"";try{if(!o)throw new Error("Clinic settings not loaded.");const Ze={...o,aiMemory:Ne.memory_content.trim(),admissionCharge:o.admissionCharge,perDayCharge:o.perDayCharge,otherCharges:o.otherCharges,clinicWideSystemPrompt:o.clinicWideSystemPrompt},jt=await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Ze)});if(!jt.ok){const mt=await jt.json().catch(()=>({}));throw new Error(mt.message||`AI-triggered clinic memory update failed: ${jt.statusText}`)}const Nt=await jt.json();return ye(mt=>mt?{...mt,aiMemory:Nt.settings.aiMemory}:null),He(Nt.settings.aiMemory||""),J("AI mem updated!"),ue==null||ue({role:"system",type:"success",content:"AI memory updated successfully."}),{success:!0,actionType:Oe,undoData:{originalMemory:Ve}}}catch(Ze){return J("Failed"),{success:!1,actionType:Oe,error:Ze,originalActionPayload:Ne}}finally{G(!1)}})()):Oe==="create_pharmacy_order"?ht.push((async()=>{var Ve,Ze;U(!0),H("Processing order..."),ue==null||ue({role:"system",type:"loading",content:"Processing pharmacy order..."});try{if(!n)throw new Error("Missing patient ID.");const jt=[];let Nt=null;if(Array.isArray(Ne.items))for(const Ct of Ne.items){let xt;if(Ct.drug_id?xt=b.find(hc=>hc.id===Ct.drug_id):Ct.name&&(xt=Vd(Ct.name,b)),!xt){Nt=`Drug "${Ct.name||Ct.drug_id}" not found.`;break}const hn=tte(xt.pack),Jn=Number(xt.mrp),un=Jn,Hn=hn>0?Jn/hn:0,hr=Number(Ct.pack_quantity)||0,sr=Number(Ct.loose_quantity)||0,Ea=hr*un+sr*Hn;jt.push({drug_id:String(xt.id),name:xt.name,pack_quantity:hr,loose_quantity:sr,tabletsPerDay:Ct.tabletsPerDay,numberOfDays:Ct.numberOfDays,directions_to_use:Ct.directions_to_use,group_id:Ct.group_id,pack_price:un,loose_price:Hn,total_price:Ea,price:Jn,isLoose:Ct.isLoose,unit:xt.pack})}if(Nt)throw new Error(Nt);const mt=jt.reduce((Ct,xt)=>Ct+xt.total_price,0),an={patient_id:n,items:jt,prescription_for_unavailable_drugs:Ne.prescription_for_unavailable_drugs,order_total:parseFloat(mt.toFixed(2))},Ln=await me("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(an)});if(!Ln.ok){const Ct=await Ln.json().catch(()=>({}));throw new Error(Ct.message||"Order creation failed.")}const Vt=await Ln.json();return H("Order created!"),D(n),ue==null||ue({role:"system",type:"success",content:"Pharmacy order created successfully."}),{success:!0,actionType:Oe,data:Vt,undoData:{orderId:((Ze=(Ve=Vt.orders)==null?void 0:Ve[0])==null?void 0:Ze.id)||Vt.id}}}catch(jt){return ue==null||ue({role:"system",type:"error",content:`Pharmacy order failed: ${jt.message}`}),{success:!1,actionType:Oe,error:jt,originalActionPayload:Ne}}finally{U(!1)}})()):Oe==="update_patient_details"?ht.push((async()=>{F(!0),ue==null||ue({role:"system",type:"loading",content:"Updating patient details..."});const Ve={...t};try{if(!n)throw new Error("Missing patient ID.");const Ze={};if(Ne.name&&(Ze.name=Ne.name),Ne.age&&(Ze.age=Ne.age),Ne.gender&&(Ze.gender=Ne.gender),Ne.phone_number!==void 0&&(Ze.phone_number=Ne.phone_number),!(await me(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ze)})).ok)throw new Error("Patient update failed.");return X(n),ue==null||ue({role:"system",type:"success",content:"Patient details updated."}),{success:!0,actionType:Oe,undoData:{patientId:n,originalDetails:Ve}}}catch(Ze){return{success:!1,actionType:Oe,error:Ze,originalActionPayload:Ne}}finally{F(!1)}})()):Oe==="create_lab_order"?ht.push((async()=>{K(!0),M("Processing lab..."),ue==null||ue({role:"system",type:"loading",content:"Processing lab order..."});try{if(!n)throw new Error("Missing patient ID.");const Ve=[];for(const Nt of Ne.tests||[]){let mt;if(Nt.id?mt=v.find(an=>String(an.id)===String(Nt.id)):Nt.name&&(mt=Vd(Nt.name,v)),!mt)throw new Error(`Lab test "${Nt.name}" not found.`);Ve.push({id:mt.id,name:mt.name,price:Number(mt.price)})}const Ze=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:Ve})});if(!Ze.ok)throw new Error("Lab order creation failed.");const jt=await Ze.json();return M("Success!"),pe(n),ue==null||ue({role:"system",type:"success",content:"Lab order created."}),{success:!0,actionType:Oe,data:jt.labOrder,undoData:{orderId:jt.labOrder.id}}}catch(Ve){return ue==null||ue({role:"system",type:"error",content:`Lab order failed: ${Ve.message}`}),{success:!1,actionType:Oe,error:Ve,originalActionPayload:Ne}}finally{K(!1)}})()):Oe==="create_lab_report"?ht.push((async()=>{K(!0),M("Creating Report..."),ue==null||ue({role:"system",type:"loading",content:"Creating lab report..."});try{if(!n)throw new Error("Missing patient ID.");const Ve=[],Ze=Ne.tests||[];for(const Vt of Ze){let Ct;if(Vt.id?Ct=v.find(xt=>String(xt.id)===String(Vt.id)):Vt.name&&(Ct=Vd(Vt.name,v)),!Ct)throw new Error(`Lab test "${Vt.name}" not found.`);Vt._matchedTest=Ct,Ve.push({id:Ct.id,name:Ct.name,price:Number(Ct.price)})}const jt=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:Ve,status:"reported"})});if(!jt.ok)throw new Error("Lab order creation failed during report generation.");const Nt=await jt.json(),mt=Nt.labOrder.id,an={};if(Ze.forEach(Vt=>{const Ct=Vt._matchedTest,xt=Ct.id,hn=Vt.parameters||[],Jn={};Ct.default_parameters&&Ct.default_parameters.forEach(un=>{un.defaultValue!==void 0&&un.defaultValue!==null&&(Jn[un.name]=un.defaultValue)}),hn.forEach(un=>{un.name&&un.value!==void 0&&(Jn[un.name]=un.value)}),an[xt]=Jn}),!(await me(`/api/lab/${mt}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(an)})})).ok)throw new Error("Report submission failed.");return M("Report Created!"),pe(n),Ce(n),ue==null||ue({role:"system",type:"success",content:"Lab report created successfully."}),{success:!0,actionType:Oe,data:Nt.labOrder,undoData:{orderId:mt}}}catch(Ve){return ue==null||ue({role:"system",type:"error",content:`Lab report failed: ${Ve.message}`}),{success:!1,actionType:Oe,error:Ve,originalActionPayload:Ne}}finally{K(!1)}})()):Oe==="edit_lab_report"?ht.push((async()=>{K(!0),M("Updating Report...");try{const Ve=Ne.serialNumber;if(!Ve)throw new Error("Missing serial number for lab report edit.");const Ze=new Map;(f??[]).forEach(hn=>Ze.set(hn.id,{...hn})),(u??[]).forEach(hn=>{if(Ze.has(hn.id)){const Jn=Ze.get(hn.id);Jn.report=hn,Jn.status=hn.status}else Ze.set(hn.id,{...hn,createdAt:hn.createdAt})});const jt=Array.from(Ze.values());jt.sort((hn,Jn)=>new Date(Jn.createdAt).getTime()-new Date(hn.createdAt).getTime());const Nt=jt.length-Ve,mt=jt[Nt];if(!mt)throw new Error(`Lab report #${Ve} not found.`);const an=mt.id;let Ln={};if(mt.report&&mt.report.report_content)try{Ln=typeof mt.report.report_content=="string"?JSON.parse(mt.report.report_content):mt.report.report_content}catch{}const Vt={...Ln};if((Ne.tests||[]).forEach(hn=>{let un=(mt.tests||[]).find(sr=>sr.name.toLowerCase()===hn.name.toLowerCase());if(!un)return;const Hn=un.id,hr=hn.parameters||[];Vt[Hn]||(Vt[Hn]={}),hr.forEach(sr=>{sr.name&&sr.value!==void 0&&(Vt[Hn][sr.name]=sr.value)})}),!(await me(`/api/lab/${an}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Vt)})})).ok)throw new Error("Report update failed.");return M("Report Updated!"),pe(n),Ce(n),ue==null||ue({role:"system",type:"success",content:"Lab report updated successfully."}),{success:!0,actionType:Oe,data:{orderId:an},undoData:{orderId:an}}}catch(Ve){return ue==null||ue({role:"system",type:"error",content:`Update report failed: ${Ve.message}`}),{success:!1,actionType:Oe,error:Ve,originalActionPayload:Ne}}finally{K(!1)}})()):Oe==="edit_pharmacy_order"?ht.push((async()=>{U(!0);try{const Ve=Ne.serialNumber;let Ze;if(Ve?Ze=[...g].sort((xt,hn)=>new Date(xt.date).getTime()-new Date(hn.date).getTime())[Ve-1]:Ze=g.find(Ct=>Ct.status==="pending"),!Ze)throw new Error("Order to edit not found.");const jt=JSON.parse(JSON.stringify(Ze));let Nt=[...Ze.medications];const mt=Ne.items_to_remove,an=Ne.items;if(Array.isArray(mt)&&(Nt=Nt.filter(Ct=>!mt.some(xt=>xt.drug_id&&String(Ct.drug_id)===String(xt.drug_id)||xt.name&&Ct.name.toLowerCase()===xt.name.toLowerCase()))),Array.isArray(an))for(const Ct of an){let xt;if(Ct.drug_id?xt=b.find(un=>String(un.id)===String(Ct.drug_id)):Ct.name&&(xt=Vd(Ct.name,b)),!xt)throw new Error(`Drug ${Ct.name} not found.`);const hn=Nt.findIndex(un=>un.drug_id===String(xt==null?void 0:xt.id)),Jn={drug_id:String(xt.id),name:xt.name,pack_quantity:Ct.pack_quantity||0,loose_quantity:Ct.loose_quantity||0,pack_price:Number(xt.mrp),loose_price:0,total_price:0,price:Number(xt.mrp)};hn>=0?Nt[hn]={...Nt[hn],...Jn}:Nt.push(Jn)}const Ln={items:Nt,status:Ne.status,prescription_for_unavailable_drugs:Ne.prescription_for_unavailable_drugs,order_total:0};if(!(await me(`/api/pharmacy-orders/${Ze.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ln)})).ok)throw new Error("Order edit failed.");return D(n),{success:!0,actionType:Oe,undoData:{orderId:Ze.id,originalState:jt}}}catch(Ve){return{success:!1,actionType:Oe,error:Ve,originalActionPayload:Ne}}finally{U(!1)}})()):Oe==="edit_lab_order"?ht.push((async()=>{K(!0);try{const Ve=f.sort((mt,an)=>new Date(an.createdAt).getTime()-new Date(mt.createdAt).getTime()).find(mt=>mt.status==="pending");if(!Ve)throw new Error("No pending lab order to edit.");const Ze=JSON.parse(JSON.stringify(Ve)),jt={tests:[],status:Ne.status};if(!(await me(`/api/lab/orders/${Ve.id}`,{method:"PUT",body:JSON.stringify(jt),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Lab edit failed.");return pe(n),{success:!0,actionType:Oe,undoData:{orderId:Ve.id,originalState:Ze}}}catch(Ve){return{success:!1,actionType:Oe,error:Ve,originalActionPayload:Ne}}finally{K(!1)}})()):Oe==="add_complaint_history"?ht.push((async()=>{$(!0),ue==null||ue({role:"system",type:"loading",content:"Updating complaint history..."});const Ve=k;try{if(!e)throw new Error("No record ID.");if(!(await me(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({complaint:Ne.complaint}),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Complaint update failed.");return T(Ne.complaint),n&&ee(n),ue==null||ue({role:"system",type:"success",content:"Complaint history updated."}),{success:!0,actionType:Oe,undoData:{recordId:e,originalComplaint:Ve}}}catch(Ze){return ue==null||ue({role:"system",type:"error",content:`Complaint history update failed: ${Ze.message}`}),{success:!1,actionType:Oe,error:Ze,originalActionPayload:Ne}}finally{$(!1)}})()):Oe==="update_case_summary"?ht.push((async()=>{W(!0),ue==null||ue({role:"system",type:"loading",content:"Updating case summary..."});const Ve=r;try{if(!e)throw new Error("No record ID.");const Ze=await me(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({case_summary:Ne.summary}),headers:{"Content-Type":"application/json"}});if(!Ze.ok)throw new Error("Summary update failed.");const jt=await Ze.json();return V(jt.case_summary),ue==null||ue({role:"system",type:"success",content:"Case summary updated."}),{success:!0,actionType:Oe,undoData:{recordId:e,originalSummary:Ve}}}catch(Ze){return ue==null||ue({role:"system",type:"error",content:`Case summary update failed: ${Ze.message}`}),{success:!1,actionType:Oe,error:Ze,originalActionPayload:Ne}}finally{W(!1)}})()):Oe==="create_recurring_medication_order"?ht.push((async()=>{U(!0),H("Creating recurring medication(s)..."),ue==null||ue({role:"system",type:"loading",content:"Creating recurring medication(s)..."});try{if(!n)throw new Error("Missing patient ID.");if(!Ne.items||!Array.isArray(Ne.items))throw new Error("No items provided for recurring medication order.");const Ve=await Promise.all(Ne.items.map(async mt=>{let an=mt.drug_id;if(!an){const Ln=Vd(mt.medication_name,b);an=Ln?Ln.id:null}if(!an)throw new Error(`Drug "${mt.medication_name}" not found in inventory for recurring medication.`);return{...mt,drug_id:an}})),Ze=await me("/api/recurring-medications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,items:Ve})});if(!Ze.ok){const mt=await Ze.json().catch(()=>({}));throw new Error(mt.message||"Failed to create recurring medication order")}const jt=await Ze.json(),Nt=jt.map(mt=>mt.id);return n&&Z&&Z(n),H("Recurring medication(s) created."),ue==null||ue({role:"system",type:"success",content:`Successfully created ${Nt.length} recurring medication(s).`}),{success:!0,actionType:Oe,data:jt,undoData:{createdIds:Nt}}}catch(Ve){return ue==null||ue({role:"system",type:"error",content:`Error creating recurring medication: ${Ve.message}`}),{success:!1,actionType:Oe,error:Ve,originalActionPayload:Ne}}finally{U(!1)}})()):Oe==="edit_recurring_medication_order"?ht.push((async()=>{U(!0),H("Updating recurring medication..."),ue==null||ue({role:"system",type:"loading",content:"Updating recurring medication..."});try{if(!n)throw new Error("Missing patient ID.");if(!Ne.serialNumber||!Ne.updates)throw new Error("Missing serialNumber or updates for recurring medication edit.");if(!S||S.length===0)throw new Error("No recurring medications found to edit.");const Ve=Ne.serialNumber-1;if(Ve<0||Ve>=S.length)throw new Error(`Recurring medication with serial number ${Ne.serialNumber} not found.`);const Ze=S[Ve],jt=JSON.parse(JSON.stringify(Ze));if(Ne.updates.drug_id===null||Ne.updates.medication_name){let mt=Ne.updates.drug_id;if(!mt&&Ne.updates.medication_name){const an=Vd(Ne.updates.medication_name,b);mt=an?an.id:null}if(!mt&&Ne.updates.medication_name)throw new Error(`Drug "${Ne.updates.medication_name}" not found in inventory for update.`);Ne.updates.drug_id=mt}const Nt=await me(`/api/recurring-medications/${Ze.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne.updates)});if(!Nt.ok){const mt=await Nt.json().catch(()=>({}));throw new Error(mt.message||"Failed to update recurring medication")}return n&&Z&&Z(n),H("Recurring medication updated."),ue==null||ue({role:"system",type:"success",content:`Successfully updated recurring medication #${Ne.serialNumber}.`}),{success:!0,actionType:Oe,data:{id:Ze.id,...Ne.updates},undoData:{medicationId:Ze.id,originalState:jt}}}catch(Ve){return ue==null||ue({role:"system",type:"error",content:`Error updating recurring medication: ${Ve.message}`}),{success:!1,actionType:Oe,error:Ve,originalActionPayload:Ne}}finally{U(!1)}})()):Oe==="end_task"?ht.push((async()=>(ue==null||ue({role:"system",type:"success",content:"Task completed."}),{success:!0,actionType:Oe}))()):(console.warn(`Unknown action ${Oe}`),ht.push(Promise.resolve({success:!1,actionType:Oe,error:new Error(`Unknown action: ${Oe}`),originalActionPayload:Ne})))}const ve=await Promise.all(ht),ke=ve.filter(Ne=>!Ne.success);if(ke.length>0){console.log("AI Actions Failed. Initiating Rollback...",ke);const Ne=ve.filter(Nt=>Nt.success),Oe=[...Ne].reverse();await ot(Oe);const Ve=ke.map(Nt=>{var mt;return`${Nt.actionType}: ${(mt=Nt.error)==null?void 0:mt.message}`}).join("; "),Ze=Ne.length>0?` I successfully rolled back ${Ne.length} other actions that succeeded.`:"",jt=`One or more actions failed: [${Ve}].${Ze} Please analyze the failure and try again.`;await it("multiple_actions",{message:jt},Ae,_e)}else{const Ne=ve.filter(Oe=>Oe.success);if(Ne.length>0&&(et(Ne),Le&&Ne.forEach(Oe=>Le(Oe.actionType))),wt&&typeof wt.question=="string")oe(wt.question),ie(Array.isArray(wt.options)?wt.options:[]);else if(!Et)throw new Error("AI response did not result in a recognized or performed function call.")}}catch(be){await it("parse_json_actions",be,Ae,_e)}else throw new Error("AI response did not contain a recognized function call.")};Ke=async(Ae,_e=0)=>{if(_e>1){L("AI call failed after multiple retries. Please try a different prompt."),F(!1);return}F(!0),L(null);let le;const de=[...l,Ae].join(`

`);try{const be=new Map;(f??[]).forEach(ke=>{be.set(ke.id,{...ke})}),(u??[]).forEach(ke=>{if(!be.has(ke.id))be.set(ke.id,{id:ke.id,patient_id:ke.patient_id,tests:ke.tests,status:ke.status,createdAt:ke.createdAt,report:ke});else{const Ne=be.get(ke.id);Ne&&(Ne.report=ke,Ne.status=ke.status)}});const $e=Array.from(be.values());$e.sort((ke,Ne)=>new Date(Ne.createdAt).getTime()-new Date(ke.createdAt).getTime());const nt=$e.map((ke,Ne)=>{let Oe=null;if(ke.report)try{const Ve=typeof ke.report.report_content=="string"?ke.report.report_content:JSON.stringify(ke.report.report_content||{}),Ze=JSON.parse(Ve||"{}"),jt=Nt=>{const mt=Ze[Nt.id]||{},an=Ln=>({name:Ln.name,value:mt[Ln.name]!==void 0?String(mt[Ln.name]):String(Ln.defaultValue),normal_range:Ln.normal_range||"N/A"});return{testId:Nt.id,testName:Nt.name,parameters:(Nt.default_parameters||[]).map(an)}};Oe={reportId:ke.report.reportId,reportDate:ke.report.report_date,tests:(ke.tests||[]).map(jt)}}catch{Oe={reportId:ke.report.reportId,reportDate:ke.report.report_date,reportContent:typeof ke.report.report_content=="string"?ke.report.report_content:JSON.stringify(ke.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:$e.length-Ne,orderId:ke.id,orderDate:isNaN(new Date(ke.createdAt).getTime())?ke.createdAt:new Date(ke.createdAt).toISOString(),tests:ke.tests.map(Ve=>({id:Ve.id,name:Ve.name,price:Ve.price})),status:ke.status,report:Oe}}),ht=h.map(ke=>{try{return{...ke,createdAt:isNaN(new Date(ke.createdAt).getTime())?ke.createdAt:new Date(ke.createdAt).toISOString()}}catch{return ke}}),Et=[...g].sort((ke,Ne)=>{const Oe=new Date(ke.date).getTime(),Ve=new Date(Ne.date).getTime();return Oe-Ve}).map((ke,Ne)=>{try{return{serialNumber:Ne+1,...ke,date:ke.date&&!isNaN(new Date(ke.date).getTime())?new Date(ke.date).toISOString():ke.date}}catch{return{serialNumber:Ne+1,...ke}}}),ve={query:de,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(o==null?void 0:o.aiMemory)||"",clinic_ai_memory_last_updated:o!=null&&o.aiMemoryUpdatedAt?new Date(o.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(o==null?void 0:o.clinicWideSystemPrompt)||"",labHistory:nt,pharmacyOrders:Et,pastComplaints:ht,pharmacyInventory:b,labInventory:v,recurringMedications:S};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(ve,null,2)),le=await ete(ve,d),le){P(le),ue==null||ue({role:"ai",content:le});const ke=/```json\s*([\s\S]*?)\s*```/,Ne=le.match(ke);if(Ne&&Ne[1])R(le.replace(ke,"").trim()),I(Ne[1].trim());else{const Oe=le.trim();if(Oe.startsWith("{")&&Oe.endsWith("}"))try{JSON.parse(Oe),R(""),I(Oe)}catch{R(Oe),I(null)}else if(Oe.startsWith("[")&&Oe.endsWith("]"))try{JSON.parse(Oe),R(""),I(Oe)}catch{R(Oe),I(null)}else R(Oe),I(null)}B(!1),n&&le&&await Je(n,le),await Ee(le,_e),T("")}else throw new Error("Invalid AI response format.")}catch(be){await it("call_generative_api",be,le,_e)}finally{F(!1)}};const Je=async(Ae,_e)=>{ce(!0),ge(null);try{const le={ai_response:_e},q=await me(`/api/patients/${Ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)});if(!q.ok){const de=await q.json().catch(()=>({}));throw new Error(de.message||`Failed to save AI response to patient: ${q.statusText}`)}}catch(le){ge(`AI Response Save Error: ${le.message}`),ue==null||ue({role:"system",type:"error",content:`AI Response Save Error: ${le.message}`})}finally{ce(!1)}};return w.useImperativeHandle(De,()=>({callGenerativeApi:Ke,undoLastAction:vt})),null}),gA=-1,rv=0,Xm=1,Cb=2,wS=3,SS=4,NS=5,CS=6,yA=7,xA=8,Dj=typeof self=="object"?self:globalThis,rte=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case rv:case gA:return t(l,a);case Xm:{const d=t([],a);for(const f of l)d.push(r(f));return d}case Cb:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case wS:return t(new Date(l),a);case SS:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case NS:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case CS:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case yA:{const{name:d,message:f}=l;return t(new Dj[d](f),a)}case xA:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new Dj[o](l),a)};return r},Ij=e=>rte(new Map,e)(0),Ph="",{toString:ite}={},{keys:ate}=Object,qm=e=>{const n=typeof e;if(n!=="object"||!e)return[rv,n];const t=ite.call(e).slice(8,-1);switch(t){case"Array":return[Xm,Ph];case"Object":return[Cb,Ph];case"Date":return[wS,Ph];case"RegExp":return[SS,Ph];case"Map":return[NS,Ph];case"Set":return[CS,Ph];case"DataView":return[Xm,t]}return t.includes("Array")?[Xm,t]:t.includes("Error")?[yA,t]:[Cb,t]},Ox=([e,n])=>e===rv&&(n==="function"||n==="symbol"),ste=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=qm(l);switch(d){case rv:{let h=l;switch(f){case"bigint":d=xA,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);h=null;break;case"undefined":return a([gA],l)}return a([d,h],l)}case Xm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const h=[],g=a([d,h],l);for(const b of l)h.push(o(b));return g}case Cb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const h=[],g=a([d,h],l);for(const b of ate(l))(e||!Ox(qm(l[b])))&&h.push([o(b),o(l[b])]);return g}case wS:return a([d,l.toISOString()],l);case SS:{const{source:h,flags:g}=l;return a([d,{source:h,flags:g}],l)}case NS:{const h=[],g=a([d,h],l);for(const[b,v]of l)(e||!(Ox(qm(b))||Ox(qm(v))))&&h.push([o(b),o(v)]);return g}case CS:{const h=[],g=a([d,h],l);for(const b of l)(e||!Ox(qm(b)))&&h.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},Rj=(e,{json:n,lossy:t}={})=>{const r=[];return ste(!(n||t),!!n,new Map,r)(e),r},lg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?Ij(Rj(e,n)):structuredClone(e):(e,n)=>Ij(Rj(e,n)),bA=wA("end"),vA=wA("start");function wA(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function SA(e){const n=vA(e),t=bA(e);if(n&&t)return{start:n,end:t}}const Ud=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],Mj={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Ud,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Ud],h2:[["className","sr-only"]],img:[...Ud,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Ud,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Ud],table:[...Ud],ul:[...Ud,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},gu={}.hasOwnProperty;function ote(e,n){let t={type:"root",children:[]};const r={schema:n?{...Mj,...n}:Mj,stack:[]},a=NA(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function NA(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return lte(e,t);case"doctype":return cte(e,t);case"element":return ute(e,t);case"root":return dte(e,t);case"text":return fte(e,t)}}}function lte(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),o={type:"comment",value:r<0?t:t.slice(0,r)};return Sg(o,n),o}}function cte(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return Sg(t,n),t}}function ute(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=CA(e,n.children),a=hte(e,n.properties);e.stack.pop();let o=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(o=!0,e.schema.ancestors&&gu.call(e.schema.ancestors,t))){const d=e.schema.ancestors[t];let f=-1;for(o=!1;++f<d.length;)e.stack.includes(d[f])&&(o=!0)}if(!o)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const l={type:"element",tagName:t,properties:a,children:r};return Sg(l,n),l}function dte(e,n){const r={type:"root",children:CA(e,n.children)};return Sg(r,n),r}function fte(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return Sg(r,n),r}function CA(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const o=NA(e,r[a]);o&&(Array.isArray(o)?t.push(...o):t.push(o))}}return t}function hte(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,o=r&&gu.call(r,t)?r[t]:void 0,l=r&&gu.call(r,"*")?r["*"]:void 0,d=n&&typeof n=="object"?n:{},f={};let u;for(u in d)if(gu.call(d,u)){const h=d[u];let g=Oj(e,Lj(o,u),u,h);g==null&&(g=Oj(e,Lj(l,u),u,h)),g!=null&&(f[u]=g)}if(a&&gu.call(a,t)){const h=a[t];for(u in h)gu.call(h,u)&&!gu.call(f,u)&&(f[u]=h[u])}return f}function Oj(e,n,t,r){return n?Array.isArray(r)?pte(e,n,t,r):_A(e,n,t,r):void 0}function pte(e,n,t,r){let a=-1;const o=[];for(;++a<r.length;){const l=_A(e,n,t,r[a]);(typeof l=="number"||typeof l=="string")&&o.push(l)}return o}function _A(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&mte(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,o=0;for(;++o<n.length;){const l=n[o];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(r))){a=!0;break}}else if(l===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function mte(e,n,t){const r=e.schema.protocols&&gu.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),o=a.indexOf(":"),l=a.indexOf("?"),d=a.indexOf("#"),f=a.indexOf("/");if(o<0||f>-1&&o>f||l>-1&&o>l||d>-1&&o>d)return!0;let u=-1;for(;++u<r.length;){const h=r[u];if(o===h.length&&a.slice(0,h.length)===h)return!0}return!1}function Sg(e,n){const t=SA(n);n.data&&(e.data=lg(n.data)),t&&(e.position=t)}function Lj(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],o=typeof a=="string"?a:a[0];if(o===n)return a;o==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function gte(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function yte(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function xte(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function bte(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function vte(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function wte(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=sp(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function Ste(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Nte(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function jA(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function Cte(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return jA(e,n);const a={src:sp(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function _te(e,n){const t={src:sp(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function jte(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function kte(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return jA(e,n);const a={href:sp(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function Tte(e,n){const t={href:sp(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function Ete(e,n,t){const r=e.all(n),a=t?Ate(t):kA(n),o={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const h=r[d];(a||d!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function Ate(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=kA(t[r])}return n}function kA(e){const n=e.spread;return n??e.children.length>1}function Pte(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function Dte(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Ite(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function Rte(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Mte(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=vA(n.children[1]),f=bA(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function Ote(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,h),e.applyData(n,h)}function Lte(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Fj=9,$j=32;function Fte(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(zj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(zj(n.slice(a),a>0,!1)),o.join("")}function zj(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===Fj||o===$j;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===Fj||o===$j;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function $te(e,n){const t={type:"text",value:Fte(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function zte(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const Bte={blockquote:gte,break:yte,code:xte,delete:bte,emphasis:vte,footnoteReference:wte,heading:Ste,html:Nte,imageReference:Cte,image:_te,inlineCode:jte,linkReference:kte,link:Tte,listItem:Ete,list:Pte,paragraph:Dte,root:Ite,strong:Rte,table:Mte,tableCell:Lte,tableRow:Ote,text:$te,thematicBreak:zte,toml:Lx,yaml:Lx,definition:Lx,footnoteDefinition:Lx};function Lx(){}function Ute(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function qte(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function Vte(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||Ute,r=e.options.footnoteBackLabel||qte,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const h=e.all(u),g=String(u.identifier).toUpperCase(),b=sp(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let R=typeof t=="string"?t:t(f,v);typeof R=="string"&&(R={type:"text",value:R}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(R)?R:[R]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const R=T.children[T.children.length-1];R&&R.type==="text"?R.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else h.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...lg(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const uw={}.hasOwnProperty,Hte={};function Gte(e,n){const t=n||Hte,r=new Map,a=new Map,o=new Map,l={...Bte,...t.handlers},d={all:u,applyData:Wte,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:Yte,wrap:Jte};return aA(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),d;function f(h,g){const b=h.type,v=d.handlers[b];if(uw.call(d.handlers,b)&&v)return v(d,h,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,P=lg(T);return P.children=d.all(h),P}return lg(h)}return(d.options.unknownHandler||Qte)(d,h,g)}function u(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Bj(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=Bj(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function Yte(e,n){e.position&&(n.position=SA(e))}function Wte(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,lg(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function Qte(e,n){const t=n.data||{},r="value"in n&&!(uw.call(t,"hProperties")||uw.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function Jte(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Bj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function Kte(e,n){const t=Gte(e,n),r=t.one(e,void 0),a=Vte(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}const Xte=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class Ng{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}Ng.prototype.normal={};Ng.prototype.property={};Ng.prototype.space=void 0;function TA(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new Ng(t,r,n)}function dw(e){return e.toLowerCase()}class Ta{constructor(n,t){this.attribute=t,this.property=n}}Ta.prototype.attribute="";Ta.prototype.booleanish=!1;Ta.prototype.boolean=!1;Ta.prototype.commaOrSpaceSeparated=!1;Ta.prototype.commaSeparated=!1;Ta.prototype.defined=!1;Ta.prototype.mustUseProperty=!1;Ta.prototype.number=!1;Ta.prototype.overloadedBoolean=!1;Ta.prototype.property="";Ta.prototype.spaceSeparated=!1;Ta.prototype.space=void 0;let Zte=0;const rn=rf(),Jr=rf(),fw=rf(),dt=rf(),dr=rf(),zh=rf(),Ya=rf();function rf(){return 2**++Zte}const hw=Object.freeze(Object.defineProperty({__proto__:null,boolean:rn,booleanish:Jr,commaOrSpaceSeparated:Ya,commaSeparated:zh,number:dt,overloadedBoolean:fw,spaceSeparated:dr},Symbol.toStringTag,{value:"Module"})),i1=Object.keys(hw);class _S extends Ta{constructor(n,t,r,a){let o=-1;if(super(n,t),Uj(this,"space",a),typeof r=="number")for(;++o<i1.length;){const l=i1[o];Uj(this,i1[o],(r&hw[l])===hw[l])}}}_S.prototype.defined=!0;function Uj(e,n,t){t&&(e[n]=t)}function op(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new _S(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[dw(r)]=r,t[dw(o.attribute)]=r}return new Ng(n,t,e.space)}const EA=op({properties:{ariaActiveDescendant:null,ariaAtomic:Jr,ariaAutoComplete:null,ariaBusy:Jr,ariaChecked:Jr,ariaColCount:dt,ariaColIndex:dt,ariaColSpan:dt,ariaControls:dr,ariaCurrent:null,ariaDescribedBy:dr,ariaDetails:null,ariaDisabled:Jr,ariaDropEffect:dr,ariaErrorMessage:null,ariaExpanded:Jr,ariaFlowTo:dr,ariaGrabbed:Jr,ariaHasPopup:null,ariaHidden:Jr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:dr,ariaLevel:dt,ariaLive:null,ariaModal:Jr,ariaMultiLine:Jr,ariaMultiSelectable:Jr,ariaOrientation:null,ariaOwns:dr,ariaPlaceholder:null,ariaPosInSet:dt,ariaPressed:Jr,ariaReadOnly:Jr,ariaRelevant:null,ariaRequired:Jr,ariaRoleDescription:dr,ariaRowCount:dt,ariaRowIndex:dt,ariaRowSpan:dt,ariaSelected:Jr,ariaSetSize:dt,ariaSort:null,ariaValueMax:dt,ariaValueMin:dt,ariaValueNow:dt,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function AA(e,n){return n in e?e[n]:n}function PA(e,n){return AA(e,n.toLowerCase())}const ene=op({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:zh,acceptCharset:dr,accessKey:dr,action:null,allow:null,allowFullScreen:rn,allowPaymentRequest:rn,allowUserMedia:rn,alt:null,as:null,async:rn,autoCapitalize:null,autoComplete:dr,autoFocus:rn,autoPlay:rn,blocking:dr,capture:null,charSet:null,checked:rn,cite:null,className:dr,cols:dt,colSpan:null,content:null,contentEditable:Jr,controls:rn,controlsList:dr,coords:dt|zh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:rn,defer:rn,dir:null,dirName:null,disabled:rn,download:fw,draggable:Jr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:rn,formTarget:null,headers:dr,height:dt,hidden:fw,high:dt,href:null,hrefLang:null,htmlFor:dr,httpEquiv:dr,id:null,imageSizes:null,imageSrcSet:null,inert:rn,inputMode:null,integrity:null,is:null,isMap:rn,itemId:null,itemProp:dr,itemRef:dr,itemScope:rn,itemType:dr,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:rn,low:dt,manifest:null,max:null,maxLength:dt,media:null,method:null,min:null,minLength:dt,multiple:rn,muted:rn,name:null,nonce:null,noModule:rn,noValidate:rn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:rn,optimum:dt,pattern:null,ping:dr,placeholder:null,playsInline:rn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:rn,referrerPolicy:null,rel:dr,required:rn,reversed:rn,rows:dt,rowSpan:dt,sandbox:dr,scope:null,scoped:rn,seamless:rn,selected:rn,shadowRootClonable:rn,shadowRootDelegatesFocus:rn,shadowRootMode:null,shape:null,size:dt,sizes:null,slot:null,span:dt,spellCheck:Jr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:dt,step:null,style:null,tabIndex:dt,target:null,title:null,translate:null,type:null,typeMustMatch:rn,useMap:null,value:Jr,width:dt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:dr,axis:null,background:null,bgColor:null,border:dt,borderColor:null,bottomMargin:dt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:rn,declare:rn,event:null,face:null,frame:null,frameBorder:null,hSpace:dt,leftMargin:dt,link:null,longDesc:null,lowSrc:null,marginHeight:dt,marginWidth:dt,noResize:rn,noHref:rn,noShade:rn,noWrap:rn,object:null,profile:null,prompt:null,rev:null,rightMargin:dt,rules:null,scheme:null,scrolling:Jr,standby:null,summary:null,text:null,topMargin:dt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:dt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:rn,disableRemotePlayback:rn,prefix:null,property:null,results:dt,security:null,unselectable:null},space:"html",transform:PA}),tne=op({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ya,accentHeight:dt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:dt,amplitude:dt,arabicForm:null,ascent:dt,attributeName:null,attributeType:null,azimuth:dt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:dt,by:null,calcMode:null,capHeight:dt,className:dr,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:dt,diffuseConstant:dt,direction:null,display:null,dur:null,divisor:dt,dominantBaseline:null,download:rn,dx:null,dy:null,edgeMode:null,editable:null,elevation:dt,enableBackground:null,end:null,event:null,exponent:dt,externalResourcesRequired:null,fill:null,fillOpacity:dt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:zh,g2:zh,glyphName:zh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:dt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:dt,horizOriginX:dt,horizOriginY:dt,id:null,ideographic:dt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:dt,k:dt,k1:dt,k2:dt,k3:dt,k4:dt,kernelMatrix:Ya,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:dt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:dt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:dt,overlineThickness:dt,paintOrder:null,panose1:null,path:null,pathLength:dt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:dr,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:dt,pointsAtY:dt,pointsAtZ:dt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ya,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ya,rev:Ya,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ya,requiredFeatures:Ya,requiredFonts:Ya,requiredFormats:Ya,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:dt,specularExponent:dt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:dt,strikethroughThickness:dt,string:null,stroke:null,strokeDashArray:Ya,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:dt,strokeOpacity:dt,strokeWidth:null,style:null,surfaceScale:dt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ya,tabIndex:dt,tableValues:null,target:null,targetX:dt,targetY:dt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ya,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:dt,underlineThickness:dt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:dt,values:null,vAlphabetic:dt,vMathematical:dt,vectorEffect:null,vHanging:dt,vIdeographic:dt,version:null,vertAdvY:dt,vertOriginX:dt,vertOriginY:dt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:dt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:AA}),DA=op({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),IA=op({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:PA}),RA=op({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),nne=/[A-Z]/g,qj=/-[a-z]/g,rne=/^data[-\w.:]+$/i;function ine(e,n){const t=dw(n);let r=n,a=Ta;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&rne.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(qj,sne);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!qj.test(o)){let l=o.replace(nne,ane);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=_S}return new a(r,n)}function ane(e){return"-"+e.toLowerCase()}function sne(e){return e.charAt(1).toUpperCase()}const one=TA([EA,ene,DA,IA,RA],"html"),MA=TA([EA,tne,DA,IA,RA],"svg"),lne=/["&'<>`]/g,cne=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,une=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,dne=/[|\\{}()[\]^$+*?.]/g,Vj=new WeakMap;function fne(e,n){if(e=e.replace(n.subset?hne(n.subset):lne,r),n.subset||n.escapeOnly)return e;return e.replace(cne,t).replace(une,r);function t(a,o,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(o+2),n)}function r(a,o,l){return n.format(a.charCodeAt(0),l.charCodeAt(o+1),n)}}function hne(e){let n=Vj.get(e);return n||(n=pne(e),Vj.set(e,n)),n}function pne(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(dne,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const mne=/[\dA-Fa-f]/;function gne(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!mne.test(String.fromCharCode(n))?r:r+";"}const yne=/\d/;function xne(e,n,t){const r="&#"+String(e);return t&&n&&!yne.test(String.fromCharCode(n))?r:r+";"}const bne=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],a1={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},vne=["cent","copy","divide","gt","lt","not","para","times"],OA={}.hasOwnProperty,pw={};let Fx;for(Fx in a1)OA.call(a1,Fx)&&(pw[a1[Fx]]=Fx);const wne=/[^\dA-Za-z]/;function Sne(e,n,t,r){const a=String.fromCharCode(e);if(OA.call(pw,a)){const o=pw[a],l="&"+o;return t&&bne.includes(o)&&!vne.includes(o)&&(!r||n&&n!==61&&wne.test(String.fromCharCode(n)))?l:l+";"}return""}function Nne(e,n,t){let r=gne(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=Sne(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const o=xne(e,n,t.omitOptionalSemicolons);o.length<r.length&&(r=o)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function Bh(e,n){return fne(e,Object.assign({format:Nne},n))}const Cne=/^>|^->|<!--|-->|--!>|<!-$/g,_ne=[">"],jne=["<",">"];function kne(e,n,t,r){return r.settings.bogusComments?"<?"+Bh(e.value,Object.assign({},r.settings.characterReferences,{subset:_ne}))+">":"<!--"+e.value.replace(Cne,a)+"-->";function a(o){return Bh(o,Object.assign({},r.settings.characterReferences,{subset:jne}))}}function Tne(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function Hj(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function Ene(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function Ane(e){return e.join(" ").trim()}const Pne=/[ \t\n\f\r]/g;function jS(e){return typeof e=="object"?e.type==="text"?Gj(e.value):!1:Gj(e)}function Gj(e){return e.replace(Pne,"")===""}const ti=FA(1),LA=FA(-1),Dne=[];function FA(e){return n;function n(t,r,a){const o=t?t.children:Dne;let l=(r||0)+e,d=o[l];if(!a)for(;d&&jS(d);)l+=e,d=o[l];return d}}const Ine={}.hasOwnProperty;function $A(e){return n;function n(t,r,a){return Ine.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const kS=$A({body:Mne,caption:s1,colgroup:s1,dd:$ne,dt:Fne,head:s1,html:Rne,li:Lne,optgroup:zne,option:Bne,p:One,rp:Yj,rt:Yj,tbody:qne,td:Wj,tfoot:Vne,th:Wj,thead:Une,tr:Hne});function s1(e,n,t){const r=ti(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&jS(r.value.charAt(0)))}function Rne(e,n,t){const r=ti(t,n);return!r||r.type!=="comment"}function Mne(e,n,t){const r=ti(t,n);return!r||r.type!=="comment"}function One(e,n,t){const r=ti(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function Lne(e,n,t){const r=ti(t,n);return!r||r.type==="element"&&r.tagName==="li"}function Fne(e,n,t){const r=ti(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function $ne(e,n,t){const r=ti(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function Yj(e,n,t){const r=ti(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function zne(e,n,t){const r=ti(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function Bne(e,n,t){const r=ti(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function Une(e,n,t){const r=ti(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function qne(e,n,t){const r=ti(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function Vne(e,n,t){return!ti(t,n)}function Hne(e,n,t){const r=ti(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function Wj(e,n,t){const r=ti(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const Gne=$A({body:Qne,colgroup:Jne,head:Wne,html:Yne,tbody:Kne});function Yne(e){const n=ti(e,-1);return!n||n.type!=="comment"}function Wne(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function Qne(e){const n=ti(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&jS(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function Jne(e,n,t){const r=LA(t,n),a=ti(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&kS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function Kne(e,n,t){const r=LA(t,n),a=ti(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&kS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const $x={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function Xne(e,n,t,r){const a=r.schema,o=a.space==="svg"?!1:r.settings.omitOptionalTags;let l=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const d=[];let f;a.space==="html"&&e.tagName==="svg"&&(r.schema=MA);const u=Zne(r,e.properties),h=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,h&&(l=!1),(u||!o||!Gne(e,n,t))&&(d.push("<",e.tagName,u?" "+u:""),l&&(a.space==="svg"||r.settings.closeSelfClosing)&&(f=u.charAt(u.length-1),(!r.settings.tightSelfClosing||f==="/"||f&&f!=='"'&&f!=="'")&&d.push(" "),d.push("/")),d.push(">")),d.push(h),!l&&(!o||!kS(e,n,t))&&d.push("</"+e.tagName+">"),d.join("")}function Zne(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const o=ere(e,a,n[a]);o&&t.push(o)}}for(;++r<t.length;){const o=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&o!=='"'&&o!=="'"&&(t[r]+=" ")}return t.join("")}function ere(e,n,t){const r=ine(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,o=e.settings.allowDangerousCharacters?0:1;let l=e.quote,d;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const f=Bh(r.attribute,Object.assign({},e.settings.characterReferences,{subset:$x.name[a][o]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?Ene:Ane)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?f:(e.settings.preferUnquoted&&(d=Bh(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:$x.unquoted[a][o]}))),d!==t&&(e.settings.quoteSmart&&Hj(t,l)>Hj(t,e.alternative)&&(l=e.alternative),d=l+Bh(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?$x.single:$x.double)[a][o],attribute:!0}))+l),f+(d&&"="+d))}const tre=["<","&"];function zA(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Bh(e.value,Object.assign({},r.settings.characterReferences,{subset:tre}))}function nre(e,n,t,r){return r.settings.allowDangerousHtml?e.value:zA(e,n,t,r)}function rre(e,n,t,r){return r.all(e)}const ire=eA("type",{invalid:are,unknown:sre,handlers:{comment:kne,doctype:Tne,element:Xne,raw:nre,root:rre,text:zA}});function are(e){throw new Error("Expected node, not `"+e+"`")}function sre(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const ore={},lre={},cre=[];function ure(e,n){const t=n||ore,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:dre,all:fre,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||Xte,characterReferences:t.characterReferences||lre,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?MA:one,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function dre(e,n,t){return ire(e,n,t,this)}function fre(e){const n=[],t=e&&e.children||cre;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const hre={};function o1(e){const n=this,{handlers:t,sanitize:r,...a}=e||hre;let o=!1,l;typeof r=="boolean"?o=!r:r&&(l=r),n.compiler=d;function d(f,u){const h=Kte(f,{handlers:t,allowDangerousHtml:o}),g=o?h:ote(h,l),b=ure(g,{...a,allowDangerousHtml:o});return u.extname&&(u.extname=".html"),f&&f.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const pre=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){h([]);return}const I=d.toLowerCase();h(r.filter(B=>B.name.toLowerCase().includes(I)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one drug.");return}for(const I of o)if(I.selected_pack_quantity===0&&I.selected_loose_quantity===0){b(`Please specify a quantity for ${I.name}.`);return}S(!0),b(null);try{const I={patient_id:t,items:o.map(F=>({drug_id:F.id,name:F.name,pack_quantity:F.selected_pack_quantity,loose_quantity:F.selected_loose_quantity,pack_price:0,loose_price:0,total_price:0,tabletsPerDay:1,numberOfDays:1,directions_to_use:"As directed"})),order_total:0,prescription_for_unavailable_drugs:""},B=await me("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!B.ok){const F=await B.json().catch(()=>({}));throw new Error(F.message||`Failed to create pharmacy order: ${B.statusText} `)}await B.json(),a(t),n(),l([]),f("")}catch(I){b(`Order Creation Error: ${I.message} `)}finally{S(!1)}},T=I=>{if(o.some(B=>B.id===I.id)){b(`${I.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),h([]);return}l(B=>[...B,{...I,selected_pack_quantity:0,selected_loose_quantity:0}]),f(""),h([])},P=I=>{l(B=>B.filter(F=>F.id!==I))},R=(I,B,F)=>{const L=parseInt(F)||0;l(U=>U.map(H=>H.id===I?{...H,[B==="pack"?"selected_pack_quantity":"selected_loose_quantity"]:L}:H))};return e?i.jsx("div",{className:Pt.modalOverlay,children:i.jsxs("div",{className:Pt.modalContent,children:[i.jsxs("div",{className:Pt.modalHeader,children:[i.jsx("h3",{className:Pt.modalTitle,children:"Create Pharmacy Order"}),i.jsx("button",{onClick:n,className:Pt.modalCloseButton,children:i.jsx(Sn,{size:20})})]}),i.jsxs("div",{className:Pt.modalBody,children:[g&&i.jsx("div",{className:Pt.errorText,children:g}),i.jsxs("div",{className:Pt.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Drug"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:d,onChange:I=>f(I.target.value),className:Pt.inputField,autoComplete:"off"}),d&&u.length>0&&i.jsx("div",{className:Pt.searchResultsCard,children:i.jsx("ul",{className:Pt.searchResultsList,children:u.map(I=>i.jsx("li",{onClick:()=>T(I),className:Pt.searchResultItem,children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[i.jsx("span",{children:I.name}),i.jsxs("span",{className:Pt.searchResultPrice,children:["Stock: ",I.stock," (Box) / ",I.loose||0," (Loose)"]})]})},I.id))})})]}),i.jsxs("div",{className:Pt.selectedTestsCard,children:[" ",i.jsx("h4",{className:Pt.selectedTestsHeader,children:"Selected Drugs"}),o.length===0?i.jsx("p",{className:Pt.noTestsMessage,children:"No drugs added yet."}):i.jsx("ul",{className:Pt.selectedTestsList,children:o.map(I=>i.jsxs("li",{className:Pt.selectedTestItem,style:{flexDirection:"column",alignItems:"flex-start",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},children:[i.jsx("span",{className:Pt.selectedTestName,style:{fontWeight:"bold"},children:I.name}),i.jsx("button",{type:"button",onClick:()=>P(String(I.id)),className:Pt.removeTestButton,title:"Remove Drug",children:i.jsx(jr,{size:16})})]}),i.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",width:"100%"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Packs"}),i.jsx("input",{type:"number",min:"0",className:Pt.inputField,style:{padding:"4px 8px"},value:I.selected_pack_quantity||"",onChange:B=>R(I.id,"pack",B.target.value),placeholder:"0"})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Loose"}),i.jsx("input",{type:"number",min:"0",className:Pt.inputField,style:{padding:"4px 8px"},value:I.selected_loose_quantity||"",onChange:B=>R(I.id,"loose",B.target.value),placeholder:"0"})]})]})]},I.id))})]})]}),i.jsxs("div",{className:Pt.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Pt.button} ${Pt.buttonSecondary} `,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${Pt.button} ${Pt.buttonPrimary} ${o.length===0||v?Pt.buttonDisabled:""} `,children:[" ",v?"Creating...":"Create Order"," "]})]})]})}):null},BA=({isOpen:e,onClose:n,onSuccess:t,medication:r,initialPatient:a,initialItems:o})=>{const[l,d]=w.useState(""),[f,u]=w.useState([]),[h,g]=w.useState(null),[b,v]=w.useState(!1);w.useEffect(()=>{if(e&&r){k([{id:Date.now(),medication_name:r.medicationName,drug_id:null,quantity:r.quantity,tablets_per_day:r.tabletsPerDay||1,number_of_days:r.numberOfDays||30,directions:r.directions||"",notes:r.notes||""}]),P(r.frequencyDays);try{const ee=new Date(r.nextDeliveryDate);isNaN(ee.getTime())||I(ee.toISOString().split("T")[0])}catch(ee){console.error("Error parsing date",ee)}g({id:r.patientId,name:r.patientName,phone:r.patientPhone,patient_token_number:r.patientToken})}else e&&(a||o)?(o&&o.length>0&&k(o),a&&g(a)):e&&!r&&!o&&(k([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),P(30),I(""),g(null),d(""))},[e,r,a,o]);const[S,k]=w.useState([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),[T,P]=w.useState(30),[R,I]=w.useState(""),[B,F]=w.useState(null),[L,U]=w.useState(""),[H,K]=w.useState([]),[M,$]=w.useState(!1),[z,W]=w.useState(!1),[te,V]=w.useState(null),G=w.useRef(null),J=w.useRef(null);w.useEffect(()=>{if(e){const ee=new Date;ee.setDate(ee.getDate()+30),I(ee.toISOString().split("T")[0])}},[e]);const oe=w.useCallback(async ee=>{if(!ee.trim()){u([]);return}v(!0);try{const X=await me(`/api/patients?search=${encodeURIComponent(ee)}&limit=10`);if(X.ok){const ye=await X.json();u(ye.patients||[])}}catch(X){console.error("Error searching patients:",X)}finally{v(!1)}},[]);w.useEffect(()=>{G.current&&clearTimeout(G.current),l&&!h?G.current=setTimeout(()=>oe(l),300):u([])},[l,h,oe]);const ie=w.useCallback(async ee=>{if(!ee.trim()){K([]);return}$(!0);try{const X=await me(`/api/drugs?search=${encodeURIComponent(ee)}&limit=10`);if(X.ok){const ye=await X.json();K(ye.drugs||[])}}catch(X){console.error("Error searching drugs:",X)}finally{$(!1)}},[]);w.useEffect(()=>{J.current&&clearTimeout(J.current),L&&B!==null?J.current=setTimeout(()=>ie(L),300):K([])},[L,B,ie]);const E=ee=>{if(!ee)return 1;const X=ee.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return X?parseInt(X[1],10):1},ce=ee=>{g(ee),d(`${ee.name} (${ee.patient_token_number})`),u([])},ge=(ee,X)=>{const ye=[...S];ye[X]={...ye[X],medication_name:ee.name,drug_id:ee.id,pack_size:E(ee.pack),packs:0,loose:0,quantity:0},k(ye),F(null),U(""),K([])},D=(ee,X,ye)=>{const He=[...S],he={...He[ee]},Le=he.pack_size||1;if(X==="packs"||X==="loose"){const ue=parseInt(ye)||0;X==="packs"&&(he.packs=ue),X==="loose"&&(he.loose=ue);const De=he.packs||0,Ye=he.loose||0;he.quantity=De*Le+Ye}else if(X==="tablets_per_day"||X==="number_of_days"){X==="tablets_per_day"&&(he.tablets_per_day=ye),X==="number_of_days"&&(he.number_of_days=ye);const ue=parseFloat(he.tablets_per_day.toString())||0,De=parseInt(he.number_of_days.toString())||0,Ye=Math.ceil(ue*De);he.quantity=Ye,he.packs=Math.floor(Ye/Le),he.loose=Ye%Le}else he[X]=ye;He[ee]=he,k(He)},pe=()=>{k([...S,{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:T,directions:"",notes:"",packs:0,loose:0,pack_size:1}])},Ce=ee=>{S.length>1&&k(S.filter((X,ye)=>ye!==ee))},Z=async ee=>{if(ee.preventDefault(),V(null),!h){V("Please select a patient.");return}if(S.some(ye=>!ye.medication_name||ye.quantity<=0)){V("Please ensure all items have a medication name and valid quantity.");return}W(!0);try{const ye={patient_id:h.id,items:S.map(he=>({medication_name:he.medication_name,drug_id:he.drug_id,quantity:he.quantity,tablets_per_day:he.tablets_per_day,number_of_days:he.number_of_days,directions:he.directions,notes:he.notes,frequency_days:T,next_delivery_date:R}))},He=await me("/api/recurring-medications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ye)});if(!He.ok){const he=await He.json();throw new Error(he.message+(he.error?": "+he.error:"")||"Failed to create recurring medication.")}t(),n(),g(null),d(""),k([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),P(30)}catch(ye){V(ye.message)}finally{W(!1)}};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"add-recurring-modal",style:{maxWidth:"800px",width:"95%"},children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Add Recurring Medication Order"}),i.jsx("button",{className:"close-btn",onClick:n,children:i.jsx(Sn,{size:20})})]}),i.jsxs("div",{className:"modal-body",children:[te&&i.jsx("div",{className:"error-message",children:te}),i.jsxs("form",{onSubmit:Z,className:"recurring-form",children:[i.jsxs("div",{className:"order-settings-row",children:[i.jsxs("div",{className:"form-group",style:{flex:2},children:[i.jsxs("label",{children:[i.jsx(Ts,{size:16})," Patient"]}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search patient...",value:l,onChange:ee=>{d(ee.target.value),g(null)},className:h?"selected":"unselected"}),b&&i.jsx("span",{className:"spinner",children:"..."}),l&&!h&&f.length>0&&i.jsx("ul",{className:"suggestions-list",children:f.map(ee=>i.jsxs("li",{onClick:()=>ce(ee),children:[i.jsx("div",{className:"suggestion-name",children:ee.name}),i.jsxs("div",{className:"suggestion-details",children:[ee.phone,"  ",ee.patient_token_number]})]},ee.id))})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(Pw,{size:16})," Frequency"]}),i.jsxs("select",{value:T,onChange:ee=>{const X=parseInt(ee.target.value);P(X);const ye=new Date;ye.setDate(ye.getDate()+X),I(ye.toISOString().split("T")[0]);const He=S.map(he=>({...he,number_of_days:X}));k(He)},children:[i.jsx("option",{value:15,children:"Every 15 Days"}),i.jsx("option",{value:30,children:"Every 30 Days"}),i.jsx("option",{value:60,children:"Every 60 Days"}),i.jsx("option",{value:90,children:"Every 90 Days"})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(vu,{size:16})," Next Delivery"]}),i.jsx("input",{type:"date",value:R,onChange:ee=>I(ee.target.value)})]})]}),i.jsx("hr",{className:"divider"}),i.jsxs("div",{className:"items-header",children:[i.jsx("h4",{children:"Medications"}),i.jsxs("button",{type:"button",className:"add-item-btn",onClick:pe,children:[i.jsx(_s,{size:14})," Add Drug"]})]}),i.jsx("div",{className:"items-list",children:S.map((ee,X)=>i.jsxs("div",{className:"medication-item-row",children:[i.jsxs("div",{className:"row-top",children:[i.jsxs("div",{className:"form-group med-search-group",children:[i.jsx("label",{children:"Drug Name"}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drug...",value:B===X?L:ee.medication_name,onFocus:()=>{F(X),U(ee.medication_name)},onChange:ye=>{U(ye.target.value),D(X,"medication_name",ye.target.value)}}),B===X&&M&&i.jsx("span",{className:"spinner",children:"..."}),B===X&&L&&H.length>0&&i.jsx("ul",{className:"suggestions-list",children:H.map(ye=>i.jsxs("li",{onClick:()=>ge(ye,X),children:[i.jsx("div",{className:"suggestion-name",children:ye.name}),i.jsxs("div",{className:"suggestion-details",children:["Stock: ",ye.stock]})]},ye.id))})]})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Tabs/Day"}),i.jsx("input",{type:"number",min:"0.5",step:"0.5",value:ee.tablets_per_day,onChange:ye=>D(X,"tablets_per_day",ye.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Days"}),i.jsx("input",{type:"number",min:"1",value:ee.number_of_days,onChange:ye=>D(X,"number_of_days",ye.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:ee.packs||"",onChange:ye=>D(X,"packs",ye.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:ee.loose||"",onChange:ye=>D(X,"loose",ye.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Total"}),i.jsx("input",{type:"number",value:ee.quantity,disabled:!0,style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]}),i.jsx("button",{type:"button",className:"remove-btn",onClick:()=>Ce(X),disabled:S.length===1,children:i.jsx(jr,{size:16})})]}),i.jsxs("div",{className:"row-bottom",children:[i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Directions (e.g. 1-0-1 after food)",value:ee.directions,onChange:ye=>D(X,"directions",ye.target.value)})}),i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Notes",value:ee.notes,onChange:ye=>D(X,"notes",ye.target.value)})})]})]},ee.id))}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",className:"btn-cancel",onClick:n,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-submit",disabled:z,children:z?"Creating...":"Create Recurring Order"})]})]})]})]})}):null},mre=({isOpen:e,onClose:n,onSuccess:t,patientId:r,initialItems:a})=>{const[o,l]=w.useState([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:"",packs:0,loose:0,pack_size:1}]),[d,f]=w.useState(30),[u,h]=w.useState(""),[g,b]=w.useState(null),[v,S]=w.useState(""),[k,T]=w.useState([]),[P,R]=w.useState(!1),[I,B]=w.useState(!1),[F,L]=w.useState(null),U=w.useRef(null);w.useEffect(()=>{if(e){a&&a.length>0?l(a):l([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:"",packs:0,loose:0,pack_size:1}]);const V=new Date;V.setDate(V.getDate()+30),h(V.toISOString().split("T")[0]),f(30)}},[e,a]);const H=w.useCallback(async V=>{if(!V.trim()){T([]);return}R(!0);try{const G=await me(`/api/drugs?search=${encodeURIComponent(V)}&limit=10`);if(G.ok){const J=await G.json();T(J.drugs||[])}}catch(G){console.error("Error searching drugs:",G)}finally{R(!1)}},[]);w.useEffect(()=>{U.current&&clearTimeout(U.current),v&&g!==null?U.current=setTimeout(()=>H(v),300):T([])},[v,g,H]);const K=V=>{if(!V)return 1;const G=V.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return G?parseInt(G[1],10):1},M=(V,G)=>{const J=[...o];J[G]={...J[G],medication_name:V.name,drug_id:V.id,pack_size:K(V.pack),packs:0,loose:0,quantity:0},l(J),b(null),S(""),T([])},$=(V,G,J)=>{const oe=[...o],ie={...oe[V]},E=ie.pack_size||1;if(G==="packs"||G==="loose"){const ce=parseInt(J)||0;G==="packs"&&(ie.packs=ce),G==="loose"&&(ie.loose=ce);const ge=ie.packs||0,D=ie.loose||0;ie.quantity=ge*E+D}else if(G==="tablets_per_day"||G==="number_of_days"){G==="tablets_per_day"&&(ie.tablets_per_day=J),G==="number_of_days"&&(ie.number_of_days=J);const ce=parseFloat(ie.tablets_per_day.toString())||0,ge=parseInt(ie.number_of_days.toString())||0,D=Math.ceil(ce*ge);ie.quantity=D,ie.packs=Math.floor(D/E),ie.loose=D%E}else ie[G]=J;oe[V]=ie,l(oe)},z=()=>{l([...o,{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:d,directions:"",notes:"",packs:0,loose:0,pack_size:1}])},W=V=>{o.length>1&&l(o.filter((G,J)=>J!==V))},te=async V=>{if(V.preventDefault(),L(null),!r){L("Patient ID is missing.");return}if(o.some(J=>!J.medication_name||J.quantity<=0)){L("Please ensure all items have a medication name and valid quantity.");return}B(!0);try{const J={patient_id:r,items:o.map(ie=>({medication_name:ie.medication_name,drug_id:ie.drug_id,quantity:ie.quantity,tablets_per_day:ie.tablets_per_day,number_of_days:ie.number_of_days,directions:ie.directions,notes:ie.notes,frequency_days:d,next_delivery_date:u}))},oe=await me("/api/recurring-medications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)});if(!oe.ok){const ie=await oe.json();throw new Error(ie.message+(ie.error?": "+ie.error:"")||"Failed to create recurring medication.")}t(),n()}catch(J){L(J.message)}finally{B(!1)}};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"add-recurring-modal",style:{maxWidth:"800px",width:"95%"},children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Add Recurring Medications"}),i.jsx("button",{className:"close-btn",onClick:n,children:i.jsx(Sn,{size:20})})]}),i.jsxs("div",{className:"modal-body",children:[F&&i.jsx("div",{className:"error-message",children:F}),i.jsxs("form",{onSubmit:te,className:"recurring-form",children:[i.jsxs("div",{className:"order-settings-row",children:[i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(Pw,{size:16})," Frequency"]}),i.jsxs("select",{value:d,onChange:V=>{const G=parseInt(V.target.value);f(G);const J=new Date;J.setDate(J.getDate()+G),h(J.toISOString().split("T")[0]);const oe=o.map(ie=>({...ie,number_of_days:G}));l(oe)},children:[i.jsx("option",{value:15,children:"Every 15 Days"}),i.jsx("option",{value:30,children:"Every 30 Days"}),i.jsx("option",{value:60,children:"Every 60 Days"}),i.jsx("option",{value:90,children:"Every 90 Days"})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(vu,{size:16})," Next Delivery"]}),i.jsx("input",{type:"date",value:u,onChange:V=>h(V.target.value)})]})]}),i.jsx("hr",{className:"divider"}),i.jsxs("div",{className:"items-header",children:[i.jsx("h4",{children:"Medications"}),i.jsxs("button",{type:"button",className:"add-item-btn",onClick:z,children:[i.jsx(_s,{size:14})," Add Drug"]})]}),i.jsx("div",{className:"items-list",children:o.map((V,G)=>i.jsxs("div",{className:"medication-item-row",children:[i.jsxs("div",{className:"row-top",children:[i.jsxs("div",{className:"form-group med-search-group",children:[i.jsx("label",{children:"Drug Name"}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drug...",value:g===G?v:V.medication_name,onFocus:()=>{b(G),S(V.medication_name)},onChange:J=>{S(J.target.value),$(G,"medication_name",J.target.value)}}),g===G&&P&&i.jsx("span",{className:"spinner",children:"..."}),g===G&&v&&k.length>0&&i.jsx("ul",{className:"suggestions-list",children:k.map(J=>i.jsxs("li",{onClick:()=>M(J,G),children:[i.jsx("div",{className:"suggestion-name",children:J.name}),i.jsxs("div",{className:"suggestion-details",children:["Stock: ",J.stock]})]},J.id))})]})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Tabs/Day"}),i.jsx("input",{type:"number",min:"0.5",step:"0.5",value:V.tablets_per_day,onChange:J=>$(G,"tablets_per_day",J.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Days"}),i.jsx("input",{type:"number",min:"1",value:V.number_of_days,onChange:J=>$(G,"number_of_days",J.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:V.packs||"",onChange:J=>$(G,"packs",J.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:V.loose||"",onChange:J=>$(G,"loose",J.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Total"}),i.jsx("input",{type:"number",value:V.quantity,disabled:!0,style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]}),i.jsx("button",{type:"button",className:"remove-btn",onClick:()=>W(G),disabled:o.length===1,children:i.jsx(jr,{size:16})})]}),i.jsxs("div",{className:"row-bottom",children:[i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Directions (e.g. 1-0-1 after food)",value:V.directions,onChange:J=>$(G,"directions",J.target.value)})}),i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Notes",value:V.notes,onChange:J=>$(G,"notes",J.target.value)})})]})]},V.id))}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",className:"btn-cancel",onClick:n,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-submit",disabled:I,children:I?"Creating...":"Create Recurring Order"})]})]})]})]})}):null},gre=({isOpen:e,onClose:n,onSuccess:t,medication:r})=>{const[a,o]=w.useState(""),[l,d]=w.useState(0),[f,u]=w.useState(1),[h,g]=w.useState(30),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,P]=w.useState(30),[R,I]=w.useState(""),[B,F]=w.useState("active"),[L,U]=w.useState(!1),[H,K]=w.useState(null);w.useEffect(()=>{if(e&&r){o(r.medicationName),d(r.quantity),u(r.tabletsPerDay||1),g(r.numberOfDays||30),v(r.directions||""),k(r.notes||""),P(r.frequencyDays),F(r.status);try{const z=new Date(r.nextDeliveryDate);isNaN(z.getTime())||I(z.toISOString().split("T")[0])}catch(z){console.error("Error parsing date",z)}}},[e,r]);const M=async z=>{if(z.preventDefault(),K(null),!a||l<=0){K("Please provide a valid medication name and quantity.");return}U(!0);try{const W={medication_name:a,quantity:l,tablets_per_day:f,number_of_days:h,directions:b,notes:S,frequency_days:T,next_delivery_date:R,status:B},te=await me(`/api/recurring-medications/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(W)});if(!te.ok){const V=await te.json();throw new Error(V.message||"Failed to update recurring medication.")}t(),n()}catch(W){K(W.message)}finally{U(!1)}},$=async()=>{if(window.confirm("Are you sure you want to delete this recurring medication?")){U(!0);try{if(!(await me(`/api/recurring-medications/${r.id}`,{method:"DELETE"})).ok)throw new Error("Failed to delete recurring medication.");t(),n()}catch(z){K(z.message)}finally{U(!1)}}};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"add-recurring-modal",style:{maxWidth:"600px",width:"90%"},children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Edit Recurring Medication"}),i.jsx("button",{className:"close-btn",onClick:n,children:i.jsx(Sn,{size:20})})]}),i.jsxs("div",{className:"modal-body",children:[H&&i.jsx("div",{className:"error-message",children:H}),i.jsxs("form",{onSubmit:M,className:"recurring-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Medication Name"}),i.jsx("input",{type:"text",value:a,onChange:z=>o(z.target.value)})]}),i.jsxs("div",{className:"order-settings-row",children:[i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(Pw,{size:16})," Frequency"]}),i.jsxs("select",{value:T,onChange:z=>P(parseInt(z.target.value)),children:[i.jsx("option",{value:15,children:"Every 15 Days"}),i.jsx("option",{value:30,children:"Every 30 Days"}),i.jsx("option",{value:60,children:"Every 60 Days"}),i.jsx("option",{value:90,children:"Every 90 Days"})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(vu,{size:16})," Next Delivery"]}),i.jsx("input",{type:"date",value:R,onChange:z=>I(z.target.value)})]})]}),i.jsxs("div",{className:"order-settings-row",children:[i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsx("label",{children:"Tabs/Day"}),i.jsx("input",{type:"number",min:"0.5",step:"0.5",value:f,onChange:z=>u(parseFloat(z.target.value))})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsx("label",{children:"Days"}),i.jsx("input",{type:"number",min:"1",value:h,onChange:z=>g(parseInt(z.target.value))})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsx("label",{children:"Total Qty"}),i.jsx("input",{type:"number",min:"1",value:l,onChange:z=>d(parseInt(z.target.value))})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Directions"}),i.jsx("input",{type:"text",value:b,onChange:z=>v(z.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Notes"}),i.jsx("input",{type:"text",value:S,onChange:z=>k(z.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Status"}),i.jsxs("select",{value:B,onChange:z=>F(z.target.value),children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),i.jsxs("div",{className:"modal-actions",style:{justifyContent:"space-between"},children:[i.jsxs("button",{type:"button",className:"btn-cancel text-red-600 hover:bg-red-50",onClick:$,style:{color:"#dc3545"},children:[i.jsx(jr,{size:16,style:{marginRight:"5px"}})," Delete"]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsx("button",{type:"button",className:"btn-cancel",onClick:n,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-submit",disabled:L,children:L?"Saving...":"Save Changes"})]})]})]})]})]})}):null},yre=({messages:e})=>{const n=w.useRef(null);return w.useEffect(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e]),i.jsxs("div",{className:"conversation-panel",children:[i.jsxs("div",{className:"conversation-header",children:[i.jsx("div",{className:"conversation-title",children:i.jsx("h3",{children:"Conversation"})}),i.jsxs("span",{className:"conversation-count",children:[e.length," messages"]})]}),i.jsxs("div",{ref:n,className:"message-list custom-scrollbar",children:[e.length===0&&i.jsx("div",{className:"empty-state",children:"Start talking to the AI..."}),e.map(t=>i.jsxs("div",{className:`message-wrapper ${t.role}`,children:[i.jsx("div",{className:`message-bubble ${t.role} ${t.role==="system"?t.type||"info":""}`,children:t.role==="ai"||t.role==="system"&&t.type==="loading"?i.jsx("div",{className:"prose prose-sm max-w-none",children:t.role==="system"&&t.type==="loading"?i.jsxs("div",{className:"typing-indicator",children:[i.jsx("span",{className:"dot"}),i.jsx("span",{className:"dot"}),i.jsx("span",{className:"dot"})]}):i.jsx(Wa,{remarkPlugins:[Li],children:t.content})}):i.jsx("div",{className:"whitespace-pre-wrap",children:t.content})}),t.role!=="system"&&i.jsx("span",{className:"message-timestamp",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id))]})]})},l1=e=>{if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return"";const t=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,16)},Qj=()=>{var $o,Bl;const{openCommandBar:e}=Uh(),{recordId:n,patientId:t}=ra(),[r,a]=w.useState(n||void 0),o=Dt(),l=Ur(),[d,f]=w.useState(""),[u]=w.useState([]),[h,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(void 0),[T,P]=w.useState(void 0),[R,I]=w.useState(null),[B,F]=w.useState(!1),[L,U]=w.useState(""),[H,K]=w.useState(!1),[M,$]=w.useState(null),[z,W]=w.useState(null),[te,V]=w.useState(!1),[G,J]=w.useState(!1),[oe,ie]=w.useState(null),[E,ce]=w.useState(""),[ge,D]=w.useState(""),[pe,Ce]=w.useState(null),[Z,ee]=w.useState(!1),[X,ye]=w.useState(!1),[He,he]=w.useState(!1),[Le,ue]=w.useState(window.innerHeight),[De,Ye]=w.useState([]),[et,Ke]=w.useState(!1),[it,ot]=w.useState(null),[vt,Ee]=w.useState([]),[Je,Ae]=w.useState([]),[_e,le]=w.useState([]),[q,de]=w.useState(!1),[be,$e]=w.useState(null),nt=w.useRef(null),ht=w.useRef(null),wt=w.useRef(!1),Et=w.useRef(null),ve=w.useRef(null),ke=w.useRef(null),Ne=w.useRef(null),Oe=w.useRef(null),Ve=w.useRef(null),Ze=w.useRef(null),[jt,Nt]=w.useState([]),[mt,an]=w.useState(!1);w.useEffect(()=>{(async()=>{if(jt.length>0&&!mt){an(!0);const xe=jt[0];xe.current&&(xe.current.scrollIntoView({behavior:"smooth",block:"center"}),xe.current.classList.add("ai-glow"),await new Promise(fe=>setTimeout(fe,2e3)),xe.current&&xe.current.classList.remove("ai-glow")),Nt(fe=>fe.slice(1)),an(!1)}})()},[jt,mt]);const Ln=ne=>{let xe=null;switch(ne){case"update_patient_details":xe=ke;break;case"create_pharmacy_order":case"edit_pharmacy_order":xe=Ne;break;case"create_lab_order":case"edit_lab_order":xe=Oe;break;case"add_complaint_history":xe=Ve;break;case"update_case_summary":xe=Ze;break}xe&&Nt(fe=>[...fe,xe])},[Vt,Ct]=w.useState(55),[xt,hn]=w.useState(!1),Jn=w.useRef(null),un=w.useRef(null),[Hn,hr]=w.useState("response"),sr=w.useRef(null),Ea=w.useRef(null),hc=150,[af,sf]=w.useState([]),[As,Tu]=w.useState([]),[Aa,Ps]=w.useState(!0),[Ds,Is]=w.useState(null),[kr,of]=w.useState(!1),[lf,Rs]=w.useState(!1),[bo,pc]=w.useState(!1),[cf,vl]=w.useState(!1),[lp,mc]=w.useState(!1),[vo,Cr]=w.useState([]),[ts,gc]=w.useState(!1),[Ms,yc]=w.useState(null),[wl,Eu]=w.useState(!1),[xc,ni]=w.useState(null),[wo,Au]=w.useState({}),[bc,vc]=w.useState(!1),[ns,Pu]=w.useState(!1),[ui,Sl]=w.useState(!1),[wc,rs]=w.useState(!1),[Os,Nl]=w.useState(!1),[Cl,wi]=w.useState([]),[is,So]=w.useState(void 0),[di,Sc]=w.useState(!1),[Nc,Du]=w.useState(!1),[Ls,_l]=w.useState(!1),[jl,Fs]=w.useState(!1),[as,Cc]=w.useState(!1),[No,Co]=w.useState(!1),ss=w.useMemo(()=>(b==null?void 0:b.admission_date)&&!(b!=null&&b.discharge_date),[b]),[ia,os]=w.useState(!1),[kl,aa]=w.useState(null),[Tl,_o]=w.useState(""),[_c,An]=w.useState(void 0),[jn,jc]=w.useState(void 0),[qr,Pa]=w.useState(void 0),[Si,$s]=w.useState(!1),[uf,sa]=w.useState(null),[Iu,rr]=w.useState(null),[jo,oa]=w.useState(null),[df,zs]=w.useState(null),[_r,Da]=w.useState(""),[El,Al]=w.useState(!1),[ko,ff]=w.useState(!1),Pl=w.useRef(null),[Xr,Ru]=w.useState(null),[fi,hf]=w.useState([]),Mu=w.useCallback(ne=>{hf(xe=>[...xe,{id:Math.random().toString(36).substr(2,9),timestamp:new Date,role:"system",content:"",...ne}])},[]),[Ni,Dl]=w.useState(null),To=w.useRef(null),Fn=w.useRef(null),[Ia,Il]=w.useState(!1),[Ou,kc]=w.useState(!1),[Mn,Lu]=w.useState(null),[Tc,Ec]=w.useState(""),[ls,la]=w.useState(""),[Fu,Bs]=w.useState(!0),[Us,Rl]=w.useState(!1),[Eo,Ao]=w.useState(!1),[qs,Ml]=w.useState(!1),[cs,pf]=w.useState(!1),Po=w.useRef(null),hi=async()=>{Po.current&&(await Po.current.undoLastAction(),pf(!1))},Ra=async ne=>{try{const xe=await me(`/api/patients/${ne}`);if(!xe.ok){const Ie=await xe.json().catch(()=>({}));throw new Error(Ie.message||`Failed to fetch patient details: ${xe.status}`)}const fe=await xe.json();if(v(fe),k(fe.age),P(fe.gender),ce(fe.ai_response||""),v(Ie=>Ie?{...Ie,current_status:fe.current_status,admission_date:fe.admission_date,discharge_date:fe.discharge_date}:{...fe,current_status:fe.current_status,admission_date:fe.admission_date,discharge_date:fe.discharge_date}),fe.insurance_type&&v(Ie=>Ie?{...Ie,insurance_type:fe.insurance_type}:{...fe}),Ac(ne),fe.ai_response){const Ie=/```json\s*([\s\S]*?)\s*```/,Ue=fe.ai_response.match(Ie);if(Ue&&Ue[1])D(fe.ai_response.replace(Ie,"").trim()),Ce(Ue[1].trim());else{const ct=fe.ai_response.trim();if(ct.startsWith("{")&&ct.endsWith("}"))try{JSON.parse(ct),D(""),Ce(ct)}catch{D(ct),Ce(null)}else if(ct.startsWith("[")&&ct.endsWith("]"))try{JSON.parse(ct),D(""),Ce(ct)}catch{D(ct),Ce(null)}else D(ct),Ce(null)}}else D(""),Ce(null)}catch{v(null),ce(""),D(""),Ce(null)}},Do=async(ne,xe)=>{v(fe=>fe?{...fe,insurance_type:xe}:null);try{const fe=await me(`/api/patients/${ne}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:xe})});if(!fe.ok){const Ie=await fe.json();throw new Error(Ie.message||"Failed to update insurance type")}}catch(fe){console.error("Error updating insurance type:",fe),ne&&Ra(ne)}},Vs=async ne=>{de(!0),$e(null),le([]);try{const xe=await me(`/api/queue/patient/${ne}/complaints`);if(!xe.ok){const Ie=await xe.json().catch(()=>({}));throw new Error(Ie.message||`HTTP error! status: ${xe.status}`)}const fe=await xe.json();le(fe||[])}catch(xe){$e(`Past complaints error: ${xe.message}`)}finally{de(!1)}},qi=async ne=>{Ee([]);try{const xe=await me(`/api/pharmacy-orders/patient/${ne}`);if(!xe.ok){const Ie=await xe.json().catch(()=>({}));throw new Error(Ie.message||`HTTP error! status: ${xe.status}`)}const fe=await xe.json();Ee(fe||[])}catch{}},Io=async ne=>{gc(!0),yc(null),Cr([]);try{const xe=await me(`/api/lab/orders/patient/${ne}`);if(!xe.ok){const Ie=await xe.json().catch(()=>({}));throw new Error(Ie.message||`HTTP error! status: ${xe.status}`)}const fe=await xe.json();Cr(fe||[])}catch(xe){yc(`Pending labs error: ${xe.message}`)}finally{gc(!1)}},us=async ne=>{Ke(!0),ot(null),Ye([]);try{const xe=await me(`/api/lab/patient/${ne}`);if(!xe.ok){const Ie=await xe.json().catch(()=>({}));throw new Error(Ie.message||`HTTP error! status: ${xe.status}`)}const fe=await xe.json();Ye(fe||[])}catch(xe){ot(`Lab reports error: ${xe.message}`)}finally{Ke(!1)}},Ro=async ne=>{try{const xe=await me(`/api/patients/${ne}/context`);if(!xe.ok){console.error("Failed to fetch patient context");return}const fe=await xe.json();if(v(fe.patient),k(fe.patient.age),P(fe.patient.gender),ce(fe.patient.ai_response||""),fe.patient.ai_response){const Ie=/```json\s*([\s\S]*?)\s*```/,Ue=fe.patient.ai_response.match(Ie);if(Ue&&Ue[1])D(fe.patient.ai_response.replace(Ie,"").trim()),Ce(Ue[1].trim());else{const ct=fe.patient.ai_response.trim();if(ct.startsWith("{")&&ct.endsWith("}"))try{JSON.parse(ct),D(""),Ce(ct)}catch{D(ct),Ce(null)}else if(ct.startsWith("[")&&ct.endsWith("]"))try{JSON.parse(ct),D(""),Ce(ct)}catch{D(ct),Ce(null)}else D(ct),Ce(null)}}else D(""),Ce(null);if(Co(fe.patient.current_status==="In Doctor Queue"||fe.patient.current_status==="In Consultation"),le(Array.isArray(fe.history)?fe.history:[]),Ee(Array.isArray(fe.pharmacyOrders)?fe.pharmacyOrders:[]),Array.isArray(fe.labOrders)){const Ie=fe.labOrders,Ue=Ie.filter(_t=>!_t.report);Cr(Ue);const ct=Ie.filter(_t=>_t.report).map(_t=>({..._t.report,id:_t.id,patient_id:_t.patient_id,createdAt:_t.createdAt}));Ye(ct),Ye(ct)}else Cr([]),Ye([]);Array.isArray(fe.recurringMedications)?Ae(fe.recurringMedications):Ae([])}catch(xe){console.error("Error fetching patient context:",xe)}},Ac=async ne=>{try{const xe=await me(`/api/queue/patient/${ne}/latest`);if(!xe.ok){const Ie=await xe.json().catch(()=>({}));throw new Error(Ie.message||`Failed to fetch queue status: ${xe.status}`)}const fe=await xe.json();if(fe){const Ie=new Date(fe.createdAt),Ue=new Date,ct=Ie.getDate()===Ue.getDate()&&Ie.getMonth()===Ue.getMonth()&&Ie.getFullYear()===Ue.getFullYear(),_t=["waiting","consulting"].includes(fe.status);Co(ct&&_t)}else Co(!1)}catch(xe){console.error("Error checking patient queue status:",xe),Co(!1)}},Pc=async(ne,xe)=>{try{if(!(await me(`/api/pharmacy-orders/${ne}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:xe})})).ok)throw new Error("Failed to update pharmacy order date");h&&qi(h)}catch(fe){console.error("Error updating pharmacy order date:",fe),ie("Failed to update pharmacy order date")}},Vi=async(ne,xe,fe)=>{try{const Ie={};if(xe==="order"?Ie.date=fe:xe==="report"&&(Ie.reportDate=fe),!(await me(`/api/lab/orders/${ne}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ie)})).ok)throw new Error("Failed to update lab date");h&&(Io(h),us(h))}catch(Ie){console.error("Error updating lab order date:",Ie),ie("Failed to update lab order date")}},$u=ne=>{o(`/dashboard/edit-pharmacy-order/${ne}`)},mf=ne=>{const xe=ne.medications.map((fe,Ie)=>({id:Date.now()+Ie,medication_name:fe.name,drug_id:fe.drug_id?String(fe.drug_id):null,quantity:(fe.pack_quantity||0)*(fe.pack_size||1)+(fe.loose_quantity||0),tablets_per_day:fe.tabletsPerDay||1,number_of_days:fe.numberOfDays||30,directions:fe.directions_to_use||"",notes:"",packs:fe.pack_quantity,loose:fe.loose_quantity,pack_size:fe.pack_size}));wi(xe),rs(!0)},Dc=ne=>{ie(null),console.log(`Preparing billing navigation for order: ${ne}`);const xe=vt.find(fe=>fe.id===ne);if(xe){const fe=xe.medications.map(Ie=>{const Ue=Ie.price??0;return(Ie.price===void 0||Ie.price===null)&&console.warn(`Medication "${Ie.name}" in order ${ne} is missing a price. Defaulting to 0.`),{name:Ie.name,pack_quantity:Ie.pack_quantity,loose_quantity:Ie.loose_quantity,price:Ue,pack_price:Ie.pack_price,loose_price:Ie.loose_price,total_price:Number(Ie.total_price)||0,isLoose:Ie.isLoose,unit:Ie.unit,drug_id:Ie.drug_id?String(Ie.drug_id):null,tabletsPerDay:Ie.tabletsPerDay,numberOfDays:Ie.numberOfDays,directions_to_use:Ie.directions_to_use,discount_percentage:Ie.discount_percentage??0,batch:Ie.batch,expiry_date:Ie.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:fe}),o(`/dashboard/pharmacy-billing/${ne}`,{state:{initialItems:fe}})}else console.error(`Order with ID ${ne} not found.`),ie(`Order with ID ${ne} not found.`),alert(`Error: Could not find order ${ne} to bill.`)},gf=async(ne,xe)=>{ie(null);const fe=vt.find(Ue=>Ue.id===ne);if(!fe){ie(`Order with ID ${ne} not found.`);return}const Ie={status:xe,medications:fe.medications};try{const Ue=await me(`/api/pharmacy-orders/${ne}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ie)});if(!Ue.ok){const _t=await Ue.text();throw new Error(`Failed to update status: ${Ue.statusText} (${Ue.status}) - ${_t}`)}const ct=await Ue.json();Ee(_t=>_t.map(Qt=>Qt.id===ct.id?{...Qt,status:ct.status}:Qt)),h&&qi(h)}catch(Ue){console.error("Failed to update order status:",Ue),ie(Ue.message||`Failed to update status for order ${ne}.`),alert(`Error updating status for order ${ne}: ${Ue.message||"Please try again."}`)}},Ma=ne=>{Cr(xe=>xe.map(fe=>fe.id===ne?{...fe,isEditing:!0,editedTests:[...fe.tests],editedStatus:fe.status}:{...fe,isEditing:!1}))},Ic=ne=>{Cr(xe=>xe.map(fe=>fe.id===ne?{...fe,isEditing:!1,editedTests:void 0,editedStatus:void 0}:fe))},cp=(ne,xe,fe,Ie)=>{Cr(Ue=>Ue.map(ct=>{if(ct.id===ne){const _t=ct.editedTests?[...ct.editedTests]:[...ct.tests];if(fe==="add")return{...ct,editedTests:[..._t,{id:"",name:"",price:0}]};if(fe==="remove")return{...ct,editedTests:Ie};if(xe!==-1){const Qt={..._t[xe],[fe]:Ie};return _t[xe]=Qt,{...ct,editedTests:_t}}}return ct}))},up=(ne,xe)=>{Cr(fe=>fe.map(Ie=>Ie.id===ne?{...Ie,editedStatus:xe}:Ie))},pi=async ne=>{if(!ne){console.error("Cannot navigate to billing: Lab Order data is missing."),alert("Could not open billing page: Lab Order information is missing.");return}o(`/dashboard/lab-billing/${ne.id}`)},Ci=async(ne,xe)=>{console.log(`Updating lab order ${ne} to status ${xe}`);try{const fe=await me(`/api/lab/${ne}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:xe})});if(!fe.ok){const Ie=await fe.json();throw new Error(Ie.message||`Failed to update lab order status: ${fe.status}`)}h&&(Io(h),us(h)),console.log(`Lab Order ${ne} status updated to ${xe}, refetching data.`)}catch(fe){console.error("Error updating lab order status:",fe),alert(`Failed to update lab order status: ${fe instanceof Error?fe.message:"Unknown error"}`)}},ri=ne=>{ne&&ne.id?o(`/lab/report/${ne.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the report entry page: Lab Order information is missing."))},zu=async(ne,xe,fe)=>{Sc(!0),ie(null);try{if(!xe||xe.length===0)throw new Error("Lab order must have at least one test.");for(const ct of xe)if(!ct.id||!ct.name||isNaN(ct.price)||ct.price<0)throw new Error(`Invalid test data: ${JSON.stringify(ct)}. Each test must have id, name, and a valid price.`);const Ie={tests:xe,status:fe},Ue=await me(`/api/lab/orders/${ne}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ie)});if(!Ue.ok){const ct=await Ue.json().catch(()=>({}));throw new Error(ct.message||`Failed to update lab order: ${Ue.statusText}`)}h&&Io(h),Cr(ct=>ct.map(_t=>_t.id===ne?{..._t,isEditing:!1,editedTests:void 0,editedStatus:void 0}:_t))}catch(Ie){ie(`Lab Order Save Error: ${Ie.message}`)}finally{Sc(!1)}},Mo=async ne=>{if(!window.confirm(`Are you sure you want to delete this ${ne.type.toLowerCase()} record? This action cannot be undone.`))return;Eu(!0),ni(null);let fe=null,Ie;const Ue=ne.type;try{switch(Ue){case"Complaint":if(Ie=ne.data.id,!Ie)throw new Error("Complaint ID is missing.");fe=`/api/patients/complaints/${Ie}`;break;case"Lab Order":if(Ie=ne.data.id,!Ie)throw new Error("Lab Order ID is missing.");fe=`/api/lab/orders/${Ie}`;break;case"Lab Report":if(Ie=ne.data.reportId,!Ie)throw new Error("Lab Report ID is missing.");fe=`/api/lab/reports/${Ie}`;break;case"Pharmacy Order":if(Ie=ne.data.id,!Ie)throw new Error("Pharmacy Order ID is missing.");fe=`/api/pharmacy-orders/${Ie}`;break;default:throw new Error(`Deletion not supported for item type: ${Ue}`)}if(!fe)throw new Error(`Could not determine delete URL for type: ${Ue}`);const ct=await me(fe,{method:"DELETE"});if(!ct.ok){const _t=await ct.json().catch(()=>({}));throw new Error(_t.message||`Failed to delete ${Ue}: ${ct.statusText}`)}h&&(Ue==="Complaint"?Vs(h):Ue==="Lab Order"?(Io(h),us(h)):Ue==="Lab Report"?us(h):Ue==="Pharmacy Order"&&qi(h))}catch(ct){ni(`Delete Error (${Ue}): ${ct.message}`),wl&&Eu(!1)}finally{Eu(!1)}},yf=async()=>{if(!h)return;if(vt.filter(xe=>xe.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}kc(!0);try{const xe=await me(`/api/pharmacy-orders/patient/${h}/merge-pending`,{method:"POST"});if(!xe.ok){const fe=await xe.json().catch(()=>({}));throw new Error(fe.message||"Failed to merge orders")}qi(h)}catch(xe){ie(`Merge Error: ${xe.message}`)}finally{kc(!1)}},ca=w.useMemo(()=>{if(!h||!_e)return[];const ne=_e.map(xe=>({date:new Date(xe.createdAt),type:"Complaint",data:xe,originalDateString:xe.createdAt})).filter(xe=>!isNaN(xe.date.getTime()));return ne.sort((xe,fe)=>fe.date.getTime()-xe.date.getTime()),ne},[h,_e]),ds=w.useMemo(()=>{if(!h)return[];const ne=new Map;(vo??[]).forEach(fe=>{ne.set(fe.id,{...fe})}),(De??[]).forEach(fe=>{if(!ne.has(fe.id))ne.set(fe.id,{id:fe.id,patient_id:fe.patient_id,tests:fe.tests,status:fe.status,createdAt:fe.createdAt,report:fe});else{const Ie=ne.get(fe.id);Ie&&(Ie.report=fe,Ie.status=fe.status)}});let xe=Array.from(ne.values());return xe.sort((fe,Ie)=>new Date(fe.createdAt).getTime()-new Date(Ie.createdAt).getTime()),xe=xe.map((fe,Ie)=>({...fe,serialNumber:Ie+1})),xe.map(fe=>({date:new Date(fe.createdAt),type:"Lab Order",data:fe,originalDateString:fe.createdAt}))},[h,vo,De]),ii=w.useMemo(()=>{if(!h||!vt)return[];const ne=vt.map(xe=>({date:new Date(xe.date),type:"Pharmacy Order",data:xe,originalDateString:xe.date})).filter(xe=>!isNaN(xe.date.getTime()));return ne.sort((xe,fe)=>fe.date.getTime()-xe.date.getTime()),ne},[h,vt]),[Oa,Pe]=w.useState(null),[Qe,Ge]=w.useState([]),[pt,Rt]=w.useState(""),pn=(ne,xe)=>{if(!ne||!ne.report_content||!xe)return"";try{const fe=JSON.parse(ne.report_content||"{}");if(typeof fe!="object"||fe===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${ne.report_content}</pre>`;let Ie="";return xe.forEach(Ue=>{fe[Ue.id]?(Ie+=`<h5 class="font-semibold text-sm mt-2 mb-1">${Ue.name}</h5>`,Ie+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(fe[Ue.id]).map(([ct,_t])=>{var In;const Qt=(In=Ue.default_parameters)==null?void 0:In.find(kn=>kn.name===ct);let Yt="N/A";Qt&&Qt.type==="number"&&(Qt.lower_limit!=null||Qt.upper_limit!=null)?(Yt="",Qt.lower_limit!=null&&(Yt+=` > ${Qt.lower_limit}`),Qt.lower_limit!=null&&Qt.upper_limit!=null&&(Yt+=" - "),Qt.upper_limit!=null&&(Yt+=` < ${Qt.upper_limit}`),Yt=Yt.trim()||"N/A"):(Qt==null?void 0:Qt.type)==="boolean"?Yt="N/A":Qt!=null&&Qt.normal_range&&(Yt=Qt.normal_range),Ie+=`<tr><td>${ct}</td><td>${String(_t)} ${(Qt==null?void 0:Qt.unit)||""}</td><td>${Yt}</td></tr>`}),Ie+="</tbody></table>"):Ie+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${Ue.name}.</p>`}),Ie}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${ne.report_content}</pre>`}};w.useEffect(()=>{const ne=()=>{ue(window.innerHeight)};return window.addEventListener("resize",ne),ne(),()=>window.removeEventListener("resize",ne)},[]),w.useEffect(()=>{const ne=fe=>{if(!xt||!Ea.current||!sr.current)return;const Ie=sr.current.getBoundingClientRect(),ct=fe.clientX-Ea.current.x;let _t=Ea.current.initialWidth+ct;const Qt=Ie.width-hc-10;_t=Math.max(hc,_t),_t=Math.min(_t,Qt);const Yt=_t/Ie.width*100;Ct(Yt)},xe=()=>{hn(!1),Ea.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return xt&&(window.addEventListener("mousemove",ne),window.addEventListener("mouseup",xe),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",xe),document.body.style.cursor="",document.body.style.userSelect=""}},[xt]);const yr=ne=>{if(!sr.current)return;ne.preventDefault();const xe=sr.current.querySelector(".edit-complaint-context-column");xe&&(Ea.current={x:ne.clientX,initialWidth:xe.offsetWidth},hn(!0))},mn=w.useCallback(async()=>{J(!0),ie(null);try{const ne=await me("/api/queue/doctor/new",{method:"POST"});if(!ne.ok){const fe=await ne.json().catch(()=>({}));throw new Error(fe.message||`Failed to create record: ${ne.statusText}`)}const xe=await ne.json();if(!xe.recordId)throw new Error("New record ID not received from server.");o(`/edit-complaint/${xe.recordId}`,{replace:!0})}catch(ne){ie(`Failed to create new complaint record: ${ne.message}`)}finally{J(!1)}},[o]);w.useEffect(()=>{(async()=>{Bs(!0);try{const xe=await me("/api/clinics/settings");if(!xe.ok){const Ie=await xe.json().catch(()=>({}));throw new Error(Ie.message||"Failed to fetch clinic settings.")}const fe=await xe.json();Lu({admissionCharge:parseFloat(fe.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(fe.perDayCharge||0).toFixed(2),otherCharges:parseFloat(fe.otherCharges||0).toFixed(2),aiMemory:fe.aiMemory||"",aiMemoryUpdatedAt:fe.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:fe.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:fe.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:fe.gemini_api_key||""}),Ec(fe.aiMemory||""),la(fe.clinicWideSystemPrompt||"")}catch{}finally{Bs(!1)}})()},[]),w.useEffect(()=>{var xe;(xe=l.state)!=null&&xe.initialComplaint&&f(l.state.initialComplaint);const ne=async fe=>{V(!0),ie(null);try{const Ie=await me(`/api/queue/doctor/complaint/${fe}`);if(!Ie.ok){const ct=await Ie.json().catch(()=>({}));throw new Error(ct.message||`HTTP error! status: ${Ie.status}`)}const Ue=await Ie.json();g(Ue.patientId),k(Ue.age),P(Ue.gender),I(Ue.case_summary||null),W(Ue.updatedAt||null)}catch{ie("Failed to load current complaint details."),g(null),k(void 0),P(void 0),I(null),W(null)}finally{V(!1)}};if(r)ne(r);else if(t){const fe=t;fe&&(g(fe),(async()=>{try{const Ue=await me(`/api/queue/patient/${fe}/latest`);if(Ue.ok){const _t=await Ue.json();if(_t!=null&&_t._id){a(_t._id),ne(_t._id);return}}const ct=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:fe,complaint:"Visit Initiated"})});if(ct.ok){const _t=await ct.json();if(_t!=null&&_t.id){a(_t.id),ne(_t.id);return}}}catch(Ue){console.error("Background queue resolution failed",Ue),ie("Failed to initialize visit record.")}})())}else mn()},[r,mn,($o=l.state)==null?void 0:$o.initialComplaint,t]),w.useEffect(()=>{h?Ro(h):(v(null),le([]),Ee([]),Cr([]),Ye([]),W(null),Co(!1))},[h]),w.useEffect(()=>{var fe;const ne=(fe=l.state)==null?void 0:fe.initialComplaint;ne&&r&&(!te&&!q&&!ts&&!et&&!Aa)&&!wt.current&&d===ne&&(wt.current=!0,ua(),o(l.pathname,{replace:!0,state:{}}))},[(Bl=l.state)==null?void 0:Bl.initialComplaint,r,d,te,q,ts,et,Aa,o]);const Ol=()=>{U(R||""),F(!0),$(null)},xf=()=>{F(!1),U(""),$(null)},mi=async()=>{if(!r){$("Missing Record ID.");return}K(!0),$(null);try{const ne=await me(`/api/queue/doctor/complaint/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:L.trim()})});if(!ne.ok){const fe=await ne.json().catch(()=>({}));throw new Error(fe.message||`Failed to save case summary: ${ne.statusText}`)}const xe=await ne.json();I(xe.case_summary||L.trim()),W(xe.updatedAt||null),F(!1)}catch(ne){$(`Save Error: ${ne.message}`)}finally{K(!1)}};w.useEffect(()=>{(async()=>{Ps(!0),Is(null);try{const[xe,fe]=await Promise.all([me("/api/drugs"),me("/api/lab-tests")]);if(!xe.ok)throw new Error(`Pharmacy inventory error! status: ${xe.status}`);const Ie=await xe.json(),Ue=Ie.drugs||Ie||[];if(sf(Ue),!fe.ok)throw new Error(`Lab inventory error! status: ${fe.status}`);const ct=await fe.json();Tu(ct||[])}catch(xe){Is(xe.message)}finally{Ps(!1)}})()},[]);const Rc=async()=>{if(!Mn)return;if(Tc===Mn.aiMemory&&ls===Mn.clinicWideSystemPrompt){Ao(!1);return}const ne=Tc!==Mn.aiMemory,xe=ls!==Mn.clinicWideSystemPrompt;ne&&Rl(!0),xe&&Ml(!0);try{const fe={...Mn};ne&&(fe.aiMemory=Tc),xe&&(fe.clinicWideSystemPrompt=ls);const Ie=await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify(fe)});if(!Ie.ok){const ct=await Ie.json().catch(()=>({}));throw new Error(ct.message||"Failed to update clinic settings.")}const Ue=await Ie.json();Lu({admissionCharge:parseFloat(Ue.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(Ue.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(Ue.settings.otherCharges).toFixed(2),aiMemory:Ue.settings.aiMemory||"",aiMemoryUpdatedAt:Ue.settings.aiMemoryUpdatedAt||(Mn==null?void 0:Mn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:Ue.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:Ue.settings.clinicWideSystemPromptUpdatedAt||(Mn==null?void 0:Mn.clinicWideSystemPromptUpdatedAt)||null}),ne&&Ec(Ue.settings.aiMemory||""),xe&&(la(Ue.settings.clinicWideSystemPrompt||""),Ao(!1))}catch{}finally{ne&&Rl(!1),xe&&Ml(!1)}},bf=()=>{Mn&&(la(Mn.clinicWideSystemPrompt||""),Ao(!0))},Oo=()=>{Ao(!1),Mn&&la(Mn.clinicWideSystemPrompt||"")},ua=async ne=>{const xe=ne??d;xe.trim()&&(Fn.current&&(clearTimeout(Fn.current),Fn.current=null),Mu({role:"user",content:xe}),Po.current&&(await Po.current.callGenerativeApi(xe),Fn.current=setTimeout(()=>{hf([])},1e4)))},Ll=ne=>{navigator.clipboard.writeText(ne).then(()=>{}).catch(xe=>{console.error("Failed to copy text: ",xe)})},xn=(ne,xe)=>{const fe=window.open("","_blank");fe&&(fe.document.write(`
        <html>
          <head>
            <title>${xe}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${xe}</h2>
            <div id="print-content">${ne}</div>
          </body>
        </html>
      `),fe.document.close(),fe.print())},Hi=()=>{if(E){const ne=t1().use(Li).use(o1).processSync(ge).toString();xn(`<div class="prose">${ne}</div>`,"AI Response")}};w.useEffect(()=>{if(b){let ne=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${b.name||"N/A"}</p>
          <p><strong>Token:</strong> ${b.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${b.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${b.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${b.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${b.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${b.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${b.admission_date?new Date(b.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${b.discharge_date?new Date(b.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${R||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${ca.length>0?`
            <ul>
              ${ca.map(xe=>`<li>${new Date(xe.originalDateString).toLocaleDateString()}: ${xe.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${ii.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${ii.map(xe=>{const fe=xe.data.medications.map((Ue,ct)=>`
                    <tr>
                      ${ct===0?`<td rowspan="${xe.data.medications.length+(xe.data.prescriptionForUnavailableDrugs?1:0)}">${new Date(xe.originalDateString).toLocaleDateString()}</td>`:""}
                      ${ct===0?`<td rowspan="${xe.data.medications.length+(xe.data.prescriptionForUnavailableDrugs?1:0)}">${xe.data.status}</td>`:""}
                      <td><strong>${Ue.name}</strong></td>
                      <td>
                        ${Ue.pack_quantity!==void 0&&Ue.pack_quantity>0?`Packs: ${Ue.pack_quantity}`:""}
                        ${Ue.pack_quantity!==void 0&&Ue.pack_quantity>0&&Ue.loose_quantity!==void 0&&Ue.loose_quantity>0?", ":""}
                        ${Ue.loose_quantity!==void 0&&Ue.loose_quantity>0?`Loose: ${Ue.loose_quantity}`:""}
                      </td>
                      <td>${Ue.tabletsPerDay&&Ue.numberOfDays?`${Ue.tabletsPerDay} tab/day for ${Ue.numberOfDays} days`:"N/A"}</td>
                      <td>${Ue.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("");let Ie="";return xe.data.prescriptionForUnavailableDrugs&&(Ie=`
                      <tr>
                        <td colspan="4" style="background-color: #f9f9f9; padding: 10px;">
                          <div style="font-style: italic; margin-bottom: 5px; font-weight: 600;">Prescription for Unavailable Drugs:</div>
                          <div class="prose" style="font-size: 0.9em;">${t1().use(Li).use(o1).processSync(xe.data.prescriptionForUnavailableDrugs).toString()}</div>
                        </td>
                      </tr>
                    `),fe+Ie}).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${ds.length>0?`
            ${ds.map(xe=>{const fe=xe.data.tests.map(Ue=>Ue.name).join(", ");let Ie="";return xe.data.report&&(Ie=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(xe.data.report.report_date).toLocaleDateString()})</h4>
                    ${pn(xe.data.report,xe.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(xe.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${xe.data.status}</p>
                  <p><strong>Tests:</strong> ${fe}</p>
                  ${Ie}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;Rt(ne)}else Rt("")},[b,R,ca,ii,ds,pn]);const Fl=()=>{pt&&xn(pt,`Patient Details - ${b==null?void 0:b.name}`)},Zr=ne=>{f(ne),Pe(null),Ge([]),setTimeout(()=>{ua(ne)},0)},pr=te||X||He||et||q||Aa||ts||G||kr||lf||bo||cf||lp||di||Si||Us||qs||Ou||wl||Nc||Ls||jl||as||H,Lo=pr,Bu=()=>{f("reports came,please anaylse"),setTimeout(()=>{ua()},0)},fs=ne=>{Au(xe=>({...xe,[ne]:!xe[ne]}))},Gi=ne=>{ne.key==="Enter"&&!ne.shiftKey&&(ne.preventDefault(),!pr&&d.trim()&&r&&ua())};w.useEffect(()=>{const ne=window.SpeechRecognition||window.webkitSpeechRecognition;if(!ne){Ru("Speech recognition not supported in this browser.");return}const xe=new ne;return xe.continuous=!0,xe.interimResults=!0,xe.lang="en-US",xe.onresult=fe=>{let Ie="";for(let Ue=fe.resultIndex;Ue<fe.results.length;++Ue)fe.results[Ue].isFinal&&(Ie+=fe.results[Ue][0].transcript);Ie&&f(Ue=>Ue+(Ue.endsWith(" ")||Ue===""?"":" ")+Ie)},xe.onerror=fe=>{Ru(`Speech error: ${fe.error}`),ff(!1)},xe.onend=()=>{},Pl.current=xe,()=>{Pl.current&&Pl.current.stop()}},[]);const Fo=async()=>{if(h)if(ss){_l(!0);try{const ne=await me(`/api/patients/${h}/discharge`,{method:"POST"});if(!ne.ok){const xe=await ne.json().catch(()=>({}));throw new Error(xe.message||`Failed to discharge patient: ${ne.status}`)}Ra(h)}catch(ne){ie(`Discharge Error: ${ne.message}`)}finally{_l(!1)}}else{Du(!0);try{const ne=await me(`/api/patients/${h}/admit`,{method:"POST"});if(!ne.ok){const xe=await ne.json().catch(()=>({}));throw new Error(xe.message||`Failed to admit patient: ${ne.status}`)}Ra(h)}catch(ne){ie(`Admit Error: ${ne.message}`)}finally{Du(!1)}}},Hs=async ne=>{if(h){Fs(!0);try{const fe=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:h})});if(!fe.ok){const Ie=await fe.json().catch(()=>({}));throw new Error(Ie.message||`Failed to add patient to ${ne} queue: ${fe.status}`)}alert(`Patient added to ${ne} queue successfully!`),h&&(Ra(h),Ac(h))}catch(xe){ie(`Add to Queue Error: ${xe.message}`)}finally{Fs(!1)}}},$l=async()=>{if(r){Cc(!0),ie(null);try{const ne=await me(`/api/queue/${r}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!ne.ok){const xe=await ne.json().catch(()=>({}));throw new Error(xe.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),h&&(Ra(h),Ac(h))}catch(ne){ie(`Error completing consultation: ${ne.message}`)}finally{Cc(!1)}}},zl=async()=>{if(!h){sa("Missing Patient ID.");return}if(!b){sa("Patient details not loaded.");return}$s(!0),sa(null);try{const ne={};let xe=!1;if(Tl!==b.name&&(ne.name=Tl,xe=!0),_c!==b.age&&(ne.age=_c,xe=!0),jn!==b.gender&&(ne.gender=jn,xe=!0),qr!==b.phone&&(ne.phone=qr,xe=!0),!xe){sa("No changes detected."),$s(!1),os(!1);return}const fe=await me(`/api/patients/${h}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ne)});if(!fe.ok){const Ue=await fe.json().catch(()=>({}));throw new Error(Ue.message||`Failed to update patient details: ${fe.statusText}`)}const Ie=await fe.json();v(Ie),k(Ie.age),P(Ie.gender),_o(Ie.name),An(Ie.age),jc(Ie.gender),Pa(Ie.phone),os(!1)}catch(ne){sa(`Save Error: ${ne.message}`)}finally{$s(!1)}},Gs=w.useCallback(()=>{if(!b)return null;const ne={token_number:b.patient_token_number||"N/A",name:b.name||"N/A",age:b.age||"N/A",gender:b.gender||"N/A",phone:b.phone||"N/A"};return ca.length>0?ne.complaints_history=ca.map(xe=>`${xe.data.complaint} (${new Date(xe.originalDateString).toLocaleDateString()})`).join("; "):ne.complaints_history="No past complaints.",ii.length>0?ne.pharmacy_orders_history=ii.map(xe=>`Order: ${xe.data.medications.map(Ie=>{let Ue=`${Ie.name}`;return Ie.pack_quantity!==void 0&&Ie.pack_quantity>0&&(Ue+=` Packs: ${Ie.pack_quantity}`),Ie.loose_quantity!==void 0&&Ie.loose_quantity>0&&(Ue+=` Loose: ${Ie.loose_quantity}`),Ue}).join(", ")} (${xe.data.status}, ${new Date(xe.originalDateString).toLocaleDateString()})`).join("; "):ne.pharmacy_orders_history="No pharmacy orders.",ds.length>0?ne.lab_orders_history=ds.map(xe=>{let Ie=`Lab Order: ${xe.data.tests.map(Ue=>Ue.name).join(", ")} (${xe.data.status}, ${new Date(xe.originalDateString).toLocaleDateString()})`;return xe.data.report&&(Ie+=` - Report: ${xe.data.report.report_content} (${new Date(xe.data.report.report_date).toLocaleDateString()})`),Ie}).join("; "):ne.lab_orders_history="No lab history.",Je.length>0?ne.recurring_medications=Je.map((xe,fe)=>{let Ie=`${fe+1}. ${xe.medicationName} (${xe.frequencyDays} days, ${xe.status})`;return xe.tabletsPerDay&&(Ie+=` - ${xe.tabletsPerDay} tabs/day`),xe.numberOfDays&&(Ie+=` for ${xe.numberOfDays} days`),Ie}).join("; "):ne.recurring_medications="No recurring medications.",ne},[b,ca,ii,ds,Je]),Mc=()=>{if(!b){Ru("Patient details are required to use the Live API.");return}Il(!0)},ai=()=>{var ne;(ne=To.current)==null||ne.click()},Ys=ne=>{var fe;const xe=(fe=ne.target.files)==null?void 0:fe[0];xe&&Dl(xe)},Vr=ne=>{hr(ne),ne==="context"&&Jn.current?Jn.current.scrollIntoView({behavior:"smooth",block:"start"}):ne==="response"&&un.current&&un.current.scrollIntoView({behavior:"smooth",block:"start"})};return w.useEffect(()=>{const ne=new IntersectionObserver(xe=>{xe.forEach(fe=>{fe.isIntersecting&&(fe.target===un.current?hr("response"):fe.target===Jn.current&&hr("context"))})},{root:null,threshold:.5});return un.current&&ne.observe(un.current),Jn.current&&ne.observe(Jn.current),()=>{un.current&&ne.unobserve(un.current),Jn.current&&ne.unobserve(Jn.current)}},[]),i.jsxs("div",{className:"edit-complaint-page",style:{height:`${Le}px`},children:[i.jsx(nte,{ref:Po,recordId:r,patientId:h,patientDetails:b,caseSummary:R,caseSummaryUpdatedAt:z,clinicSettings:Mn,userMessages:u,selectedImageFile:Ni,pendingLabOrders:vo,labReports:De,pastComplaints:_e,pharmacyOrders:vt,pharmacyInventory:af,labInventory:As,recurringMedications:Je,currentComplaint:d,setCurrentComplaint:f,setAiResponse:ce,setAiResponseText:D,setAiResponseJsonString:Ce,setShowAiJsonDetails:ee,setIsLoadingAi:ye,setAiError:()=>{},setIsSubmittingAiOrder:of,setAiOrderSubmissionStatus:()=>{},setIsSubmittingAiLabOrder:Rs,setAiLabOrderSubmissionStatus:()=>{},setIsSubmittingAiComplaint:pc,setAiComplaintSubmissionStatus:()=>{},setIsUpdatingCaseSummary:vl,setAiCaseSummaryUpdateStatus:()=>{},setCaseSummary:I,setCaseSummaryUpdatedAt:W,setIsUpdatingAiMemoryByAI:mc,setAiMemoryUpdateByAIStatus:()=>{},setFollowUpQuestion:Pe,setFollowUpOptions:Ge,setError:ie,setIsSavingAiResponse:he,setSaveAiResponseError:()=>{},fetchPharmacyOrdersData:qi,fetchPendingLabOrdersData:Io,fetchLabReportsData:us,fetchPastComplaintsData:Vs,fetchPatientDetails:Ra,fetchRecurringMedicationsData:Ro,setClinicSettings:Lu,setEditedAiMemory:Ec,handleDeleteItem:Mo,setCanUndo:pf,onAiActionSuccess:Ln,addMessage:Mu}),Ia&&b&&i.jsx(Zb,{onClose:()=>Il(!1),patientData:Gs(),tokenNumber:b.patient_token_number?String(b.patient_token_number):null,onAiSummaryChange:ne=>{ne&&(f(ne),ua(ne),Il(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>o(-1),disabled:pr,className:"back-button",title:"Go Back",children:"< Back"}),i.jsx("span",{ref:ve,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),b&&i.jsx("div",{className:"edit-complaint-patient-details",children:b&&!ia?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{os(!0),_o(b.name||""),An(b.age),jc(b.gender),Pa(b.phone),sa(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:Si,children:i.jsx(uo,{size:14})}),b.name??"N/A",b.patient_token_number!==null&&b.patient_token_number!==void 0&&` (${b.patient_token_number})`," - ",b.age??"N/A"," / ",b.gender??"N/A",b.phone&&` / ${b.phone}`,i.jsx("button",{onClick:ne=>{ne.stopPropagation(),Fl()},disabled:!pt,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(hl,{size:14})})]}):b&&ia?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:Tl,onChange:ne=>_o(ne.target.value),placeholder:"Name",className:"edit-input",disabled:Si}),i.jsx("input",{type:"number",value:_c??"",onChange:ne=>An(ne.target.value?parseInt(ne.target.value):null),placeholder:"Age",className:"edit-input",disabled:Si}),i.jsxs("select",{value:jn??"",onChange:ne=>jc(ne.target.value||null),className:"edit-input",disabled:Si,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:qr??"",onChange:ne=>Pa(ne.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Si}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{os(!1),sa(null)},className:"button-secondary",disabled:Si,children:"Cancel"}),i.jsx("button",{onClick:zl,className:"button-primary blue",disabled:Si,children:Si?"Saving...":"Save"})]}),uf&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:uf})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[S??"N/A"," / ",T??"N/A",i.jsx("button",{onClick:ne=>{ne.stopPropagation(),Fl()},disabled:!pt,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(hl,{size:14})})]})}),!b&&S!==void 0&&T!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[S??"N/A"," / ",T??"N/A",i.jsx("button",{onClick:ne=>{ne.stopPropagation(),Fl()},disabled:!pt,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(hl,{size:14})})]}),i.jsx("div",{style:{minWidth:"64px",display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{onClick:e,className:"icon-button small text-gray-600 hover:text-gray-900 bg-gray-100 hover:bg-gray-200",title:"Open Command Bar (Ctrl+K)",style:{padding:"0.2rem",borderRadius:"8px"},children:i.jsx(Pr,{size:24})})})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:sr,children:[fi.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"edit-complaint-chat-column",style:{width:"30%",minWidth:"320px",maxWidth:"40%",flexShrink:0},children:i.jsx(yre,{messages:fi})}),i.jsx("div",{className:"draggable-divider",onMouseDown:()=>{}})]}),i.jsxs("div",{ref:un,className:"edit-complaint-main-column",style:{flex:1,minWidth:0},children:[oe&&i.jsxs("div",{className:"general-error-message",children:["Error: ",oe]}),(ge||pe)&&i.jsxs("div",{ref:nt,className:`${pe?"ai-function-call-block":"ai-response-container"} group`,children:[ge&&i.jsx(Wa,{remarkPlugins:[Li],children:ge}),pe&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>ee(!Z),className:"ai-json-toggle-button",children:[Z?i.jsx(tC,{size:14,className:"mr-1"}):i.jsx(eC,{size:14,className:"mr-1"}),Z?"Hide":"Show"," AI Function Call Details"]}),Z&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(pe),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>Ll(E),disabled:!E,title:"Copy Full AI Response",children:i.jsx(d6,{size:12})}),i.jsx("button",{onClick:Hi,disabled:!E,title:"Print AI Response",children:i.jsx(hl,{size:12})})]})]})]}),i.jsx("div",{className:"draggable-divider",onMouseDown:yr}),i.jsx("div",{ref:Jn,className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-Vt}% - 5px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsxs("h3",{className:"ai-context-header",children:[i.jsx("span",{children:"AI Context:"}),(b==null?void 0:b.insurance_type)&&i.jsx("div",{className:"insurance-type-container mt-2",children:i.jsxs("select",{ref:Et,value:b.insurance_type,onChange:ne=>Do(b.id,ne.target.value),className:"insurance-type-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),i.jsxs("div",{ref:ke,className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),(b==null?void 0:b.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(b.admission_date).toLocaleDateString()]}),(b==null?void 0:b.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(b.discharge_date).toLocaleDateString()]}),(b==null?void 0:b.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:b.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsx("button",{onClick:Fo,className:`admit-discharge-button ${ss?"discharge":"admit"}`,title:ss?"Discharge Patient":"Admit Patient",disabled:!h||Nc||Ls,children:Nc?"Admitting...":Ls?"Discharging...":ss?"Discharge":"Admit"}),i.jsx("button",{onClick:()=>Hs("doctor"),className:`queue-status-button ${No?"in-queue":"add-to-queue"}`,title:No?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!h||jl||No,children:jl?"Adding...":No?"In Queue":"Add to Queue"}),i.jsx("button",{onClick:$l,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:as,children:as?"Completing...":"Complete Consultation"})]})]}),i.jsx("div",{ref:Ne,children:i.jsx(n1,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:yf,className:"button-primary blue text-xs px-2 py-1",disabled:Ou||vt.filter(ne=>ne.status==="pending").length<2,title:"Merge all pending orders into one",children:Ou?"Merging...":"Merge Orders"}),i.jsxs("button",{onClick:()=>Pu(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!h,children:[i.jsx(_s,{size:12,className:"mr-1"})," Create Order"]})]}),items:ii,isLoading:!1,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(ne,xe)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",ii.length-xe,". Order Status: (",ne.data.status,")",i.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:kl===ne.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",children:i.jsx("input",{type:"datetime-local",defaultValue:l1(ne.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:fe=>{fe.target.value&&Pc(ne.data.id,fe.target.value),aa(null)},onKeyDown:fe=>{if(fe.key==="Enter"){const Ie=fe.target;Ie.value&&Pc(ne.data.id,Ie.value),aa(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:()=>aa(ne.data.id),title:"Click to edit date",children:["(",new Date(ne.originalDateString).toLocaleDateString(),")",i.jsx(uo,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>$u(ne.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(uo,{size:12})}),ne.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>{const fe=t1().use(Li).use(o1).processSync(ne.data.prescriptionForUnavailableDrugs).toString();xn(fe,"Unavailable Drugs Prescription")},className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(hl,{size:12})}),ne.data.status==="dispensed"||ne.data.status==="billed"?i.jsx("button",{onClick:()=>o(`/dashboard/pharmacy-billing/${ne.data.id}`),className:"icon-button small text-blue-600",title:"View Pharmacy Bill",children:i.jsx(fo,{size:12})}):i.jsx("button",{onClick:()=>Mo({type:"Pharmacy Order",data:ne.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(jr,{size:12})}),ne.data.status==="pending"&&i.jsx("button",{onClick:()=>Dc(ne.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:di,children:i.jsx(Hh,{size:12})}),ne.data.status==="billed"&&i.jsx("button",{onClick:()=>gf(ne.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:di,children:i.jsx(Ca,{size:12})}),i.jsx("button",{onClick:()=>mf(ne.data),className:"icon-button small group-hover:block",title:"Add to Recurring Medications",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[i.jsx("path",{d:"m17 2 4 4-4 4"}),i.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),i.jsx("path",{d:"m7 22-4-4 4-4"}),i.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2 cursor-pointer hover:bg-gray-50 transition-colors rounded p-1",onClick:()=>$u(ne.data.id),title:"Click to edit order",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:ne.data.medications.map((fe,Ie)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:fe.name})}),i.jsxs("td",{className:"py-1 px-2",children:[fe.pack_quantity!==void 0&&fe.pack_quantity>0&&`Packs: ${fe.pack_quantity}`,fe.pack_quantity!==void 0&&fe.pack_quantity>0&&fe.loose_quantity!==void 0&&fe.loose_quantity>0&&", ",fe.loose_quantity!==void 0&&fe.loose_quantity>0&&`Loose: ${fe.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:fe.tabletsPerDay&&fe.numberOfDays?`${fe.tabletsPerDay} tab/day for ${fe.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:fe.directions_to_use||"N/A"})]},fe.drug_id||fe.name||Ie))})]})}),ne.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-markdown mt-2",children:[i.jsx("span",{className:"font-semibold text-xs text-gray-600 block mb-1",children:"Prescription for Unavailable Drugs:"}),i.jsx(Wa,{remarkPlugins:[Li],children:ne.data.prescriptionForUnavailableDrugs})]})]})})}),i.jsxs("div",{className:"ai-context-section mt-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("h4",{className:"ai-context-section-title mb-0",children:"Recurring Medications"}),i.jsxs("button",{onClick:()=>{wi([]),rs(!0)},className:"text-xs bg-blue-50 text-blue-600 hover:bg-blue-100 px-2 py-1 rounded flex items-center gap-1",children:[i.jsx(_s,{size:12})," Add"]})]}),Je.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full text-xs text-left",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",children:[i.jsx("th",{className:"py-1 px-2",children:"#"}),i.jsx("th",{className:"py-1 px-2",children:"Medication"}),i.jsx("th",{className:"py-1 px-2",children:"Qty"}),i.jsx("th",{className:"py-1 px-2",children:"Frequency"}),i.jsx("th",{className:"py-1 px-2",children:"Next Delivery"}),i.jsx("th",{className:"py-1 px-2",children:"Status"}),i.jsx("th",{className:"py-1 px-2"})]})}),i.jsx("tbody",{children:Je.map((ne,xe)=>i.jsxs("tr",{className:"border-b last:border-0 hover:bg-gray-50",children:[i.jsx("td",{className:"py-1 px-2 font-medium text-gray-500",children:xe+1}),i.jsxs("td",{className:"py-1 px-2 font-medium",children:[ne.medicationName,i.jsxs("div",{className:"text-[10px] text-gray-500 font-normal",children:[ne.tabletsPerDay?`${ne.tabletsPerDay} tabs/day`:"",ne.tabletsPerDay&&ne.numberOfDays?"  ":"",ne.numberOfDays?`${ne.numberOfDays} days`:"",ne.directions?`  ${ne.directions}`:""]})]}),i.jsx("td",{className:"py-1 px-2",children:ne.quantity}),i.jsxs("td",{className:"py-1 px-2",children:[ne.frequencyDays," days"]}),i.jsx("td",{className:"py-1 px-2",children:new Date(ne.nextDeliveryDate).toLocaleDateString()}),i.jsx("td",{className:"py-1 px-2",children:i.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] ${ne.status==="active"?"bg-green-100 text-green-800":ne.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ne.status})}),i.jsx("td",{className:"py-1 px-2 text-right",children:i.jsx("button",{onClick:()=>{So(ne),Nl(!0)},className:"text-gray-400 hover:text-blue-600 p-1",title:"Edit",children:i.jsx(uo,{size:12})})})]},ne.id))})]})}):i.jsx("p",{className:"text-gray-500 text-sm italic",children:"No recurring medications."})]}),ns&&i.jsx(pre,{isOpen:ns,onClose:()=>Pu(!1),patientId:h,pharmacyInventory:af,fetchPharmacyOrdersData:qi}),i.jsxs("div",{ref:Oe,children:[i.jsx(n1,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:Bu,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:Lo,children:"Analyse Reports"}),i.jsxs("button",{onClick:()=>vc(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!h,children:[i.jsx(_s,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:ds,onDeleteItem:void 0,onEditLabOrder:void 0,onSaveLabOrder:zu,onCancelEditLabOrder:Ic,onLabOrderTestChange:cp,onLabOrderStatusChange:up,onBillLabOrder:void 0,onUpdateLabOrderStatus:void 0,onEnterLabReport:void 0,labInventory:As,isSavingLabOrder:di,isLoading:ts||et,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:wo,toggleLabReport:fs,renderItemContent:(ne,xe)=>{const fe=See(ne.data.report?ne.data.report.status:ne.data.status),Ie=(ne.data.tests||[]).reduce((Ue,ct)=>Ue+(Number(ct.price)||0),0).toFixed(2);return i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{className:"ai-context-text flex items-center flex-wrap",children:[i.jsxs("span",{className:"font-medium cursor-pointer hover:text-blue-600 transition-colors mr-2",onClick:()=>ri(ne.data),title:"Click to enter report",children:["#",ne.data.serialNumber," [Order]"]}),i.jsx("span",{className:`mr-2 ${fe.className}`,children:fe.text}),i.jsx("span",{className:"text-gray-400 inline-flex items-center",children:Iu===ne.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Ue=>Ue.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:l1(ne.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Ue=>{Ue.target.value&&Vi(ne.data.id,"order",Ue.target.value),rr(null)},onKeyDown:Ue=>{if(Ue.key==="Enter"){const ct=Ue.target;ct.value&&Vi(ne.data.id,"order",ct.value),rr(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:Ue=>{Ue.stopPropagation(),rr(ne.data.id)},title:"Click to edit order date",children:["(",new Date(ne.originalDateString).toLocaleDateString(),")",i.jsx(uo,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})})]}),!ne.data.isEditing&&i.jsxs("div",{className:"flex space-x-1 items-center",children:[i.jsx("button",{onClick:()=>Ma(ne.data.id),className:"icon-button small",title:"Edit",disabled:di,children:i.jsx(uo,{size:12})}),ne.data.status==="pending"&&i.jsx("button",{onClick:()=>pi(ne.data),className:"icon-button small font-medium text-green-600 w-auto px-1",title:`Pay total of ${Ie}`,disabled:di,children:i.jsx($k,{size:12})}),ne.data.status==="billed"&&i.jsx("button",{onClick:()=>Ci(ne.data.id,"collected"),className:"icon-button small text-blue-600",title:"Collect Sample",disabled:di,children:"Collect"}),ne.data.status==="collected"&&i.jsx("button",{onClick:()=>Ci(ne.data.id,"processing"),className:"icon-button small text-purple-600",title:"Mark Processing",disabled:di,children:"Process"}),["pending","billed","collected","processing","report_ready","reported","completed"].includes(ne.data.status)&&i.jsx("button",{onClick:()=>ri(ne.data),className:"icon-button small text-indigo-600",title:"Enter Report",disabled:di,children:i.jsx(fo,{size:12})}),(ne.data.status==="report_ready"||ne.data.status==="reported")&&i.jsx("button",{onClick:()=>Ci(ne.data.id,"completed"),className:"icon-button small text-green-600",title:"Mark Completed",disabled:di,children:i.jsx(Ca,{size:12})}),i.jsx("button",{onClick:()=>Mo({type:"Lab Order",data:ne.data}),className:"icon-button small text-red-500",title:"Delete",disabled:di,children:i.jsx(jr,{size:12})})]})]}),i.jsx("div",{className:"lab-order-tests-table-container mt-1 mb-2 cursor-pointer hover:bg-gray-50 transition-colors rounded p-1 border border-gray-100",onClick:()=>{ne.data.status==="pending"?Ma(ne.data.id):ri(ne.data)},title:ne.data.status==="pending"?"Click to edit order":"Click to enter report",children:i.jsxs("table",{className:"w-full text-xs text-left",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b bg-gray-50",children:[i.jsx("th",{className:"py-1 px-2 font-medium text-gray-600",children:"Test Name"}),i.jsx("th",{className:"py-1 px-2 text-right font-medium text-gray-600",children:"Price"})]})}),i.jsxs("tbody",{children:[ne.data.tests&&ne.data.tests.length>0?ne.data.tests.map(Ue=>i.jsxs("tr",{className:"border-b last:border-0 hover:bg-gray-100",children:[i.jsx("td",{className:"py-1 px-2",children:Ue.name}),i.jsxs("td",{className:"py-1 px-2 text-right",children:["",Ue.price]})]},Ue.id||Ue.name)):i.jsx("tr",{children:i.jsx("td",{colSpan:2,className:"py-1 px-2 italic text-gray-500",children:"No tests specified"})}),i.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[i.jsx("td",{className:"py-1 px-2 text-right text-gray-700",children:"Total:"}),i.jsxs("td",{className:"py-1 px-2 text-right text-gray-900",children:["",Ie]})]})]})]})}),ne.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("span",{className:"font-medium text-sm text-gray-700",children:"[Report]"}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"text-gray-400 ml-1 flex items-center text-xs",children:jo===ne.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Ue=>Ue.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:l1(ne.data.report.report_date),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Ue=>{Ue.target.value&&Vi(ne.data.id,"report",Ue.target.value),oa(null)},onKeyDown:Ue=>{if(Ue.key==="Enter"){const ct=Ue.target;ct.value&&Vi(ne.data.id,"report",ct.value),oa(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/reportDate ml-1",onClick:Ue=>{Ue.stopPropagation(),oa(ne.data.id)},title:"Click to edit report date",children:["(",new Date(ne.data.report.report_date).toLocaleDateString(),")",i.jsx(uo,{size:12,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsx("button",{onClick:()=>fs(ne.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400 ml-2",title:wo[ne.data.report.reportId]?"Collapse Report":"Expand Report",children:wo[ne.data.report.reportId]?i.jsx(tC,{size:14}):i.jsx(eC,{size:14})}),i.jsx("button",{onClick:()=>Mo({type:"Lab Report",data:ne.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400 ml-1",title:"Delete Report",children:i.jsx(jr,{size:12})})]})]}),wo[ne.data.report.reportId]&&(()=>{try{const Ue=JSON.parse(ne.data.report.report_content||"{}");return typeof Ue=="object"&&Ue!==null&&ne.data.report.tests?ne.data.report.tests.map(ct=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-xs mt-2 mb-1 text-gray-700",children:ct.name}),Ue[ct.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 bg-gray-50",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2 bg-gray-50",children:"Value"}),i.jsx("th",{className:"py-1 px-2 bg-gray-50",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(Ue[ct.id]).map(([_t,Qt])=>{var In;const Yt=(In=ct.default_parameters)==null?void 0:In.find(kn=>kn.name===_t);return i.jsxs("tr",{className:"border-b last:border-0",children:[i.jsx("td",{className:"py-1 px-2",children:_t}),i.jsxs("td",{className:"py-1 px-2",children:[String(Qt)," ",(Yt==null?void 0:Yt.unit)||""]}),i.jsx("td",{className:"py-1 px-2 text-gray-500",children:(()=>{if(Yt&&Yt.type==="number"&&(Yt.lower_limit!=null||Yt.upper_limit!=null)){let kn="";return Yt.lower_limit!=null&&(kn+=` > ${Yt.lower_limit}`),Yt.lower_limit!=null&&Yt.upper_limit!=null&&(kn+=" - "),Yt.upper_limit!=null&&(kn+=` < ${Yt.upper_limit}`),kn.trim()||"N/A"}else if((Yt==null?void 0:Yt.type)==="boolean")return"N/A";return(Yt==null?void 0:Yt.normal_range)||"N/A"})()})]},_t)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},ct.id)):i.jsx("div",{className:"text-xs prose",children:i.jsx(Wa,{remarkPlugins:[Li],children:ne.data.report.report_content})})}catch{return i.jsx("div",{className:"text-xs prose",children:i.jsx(Wa,{remarkPlugins:[Li],children:ne.data.report.report_content||"*No findings recorded.*"})})}})()]})]})}}),i.jsx(Qee,{isOpen:bc,onClose:()=>vc(!1),patientId:h,labInventory:As,fetchPendingLabOrdersData:Io}),i.jsx("div",{ref:Ve,children:i.jsx(n1,{title:"Complaints History",items:ca,isLoading:q,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(ne,xe)=>i.jsx("div",{className:"ai-context-text w-full",children:df===ne.data.id?i.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[i.jsx("input",{type:"text",value:_r,onChange:fe=>Da(fe.target.value),className:"border rounded px-2 py-1 text-sm w-full",autoFocus:!0,onKeyDown:async fe=>{if(fe.key==="Enter"&&_r.trim()){Al(!0);try{await me(`/api/patients/complaints/${ne.data.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:_r.trim()})}),ne.data.complaint=_r.trim(),zs(null),Da("")}catch(Ie){console.error("Error updating complaint:",Ie)}Al(!1)}fe.key==="Escape"&&(zs(null),Da(""))},disabled:El}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:async()=>{if(_r.trim()){Al(!0);try{await me(`/api/patients/complaints/${ne.data.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:_r.trim()})}),ne.data.complaint=_r.trim(),zs(null),Da("")}catch(fe){console.error("Error updating complaint:",fe)}Al(!1)}},className:"text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600",disabled:El||!_r.trim(),children:El?"Saving...":"Save"}),i.jsx("button",{onClick:()=>{zs(null),Da("")},className:"text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded hover:bg-gray-300",disabled:El,children:"Cancel"})]})]}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 rounded px-1 -mx-1 transition-colors inline-block",onClick:()=>{zs(ne.data.id),Da(ne.data.complaint)},title:"Click to edit",children:[ne.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ne.originalDateString).toLocaleDateString(),")"]})]})}),onDeleteItem:Mo})}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(Ob,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!Eo&&i.jsx("button",{onClick:bf,className:"edit-button",title:"Edit System Prompt",disabled:Fu||Us||qs,children:i.jsx(uo,{size:14})})]}),Eo&&Mn?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:ls,onChange:ne=>la(ne.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:Us||qs}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:Oo,disabled:Us||qs,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:Rc,disabled:Us||qs||Tc===Mn.aiMemory&&ls===Mn.clinicWideSystemPrompt,className:"button-primary purple",children:[i.jsx(Jd,{size:14,className:"mr-1"}),qs||Us?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none cursor-pointer hover:bg-gray-50 rounded p-1 -m-1 transition-colors",onClick:bf,title:"Click to edit system prompt",children:Mn!=null&&Mn.clinicWideSystemPrompt?i.jsx(Wa,{remarkPlugins:[Li],children:Mn.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click to add."})}),!Eo&&(Mn==null?void 0:Mn.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(Mn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{ref:Ze,className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!B&&i.jsx("button",{onClick:Ol,className:"edit-button",title:"Edit Case Summary",disabled:te||H,children:i.jsx(uo,{size:14})})]}),B?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:L,onChange:ne=>U(ne.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:H}),M&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:M}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:xf,disabled:H,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:mi,disabled:H||L===R,className:"button-primary blue",children:H?"Saving...":"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none cursor-pointer hover:bg-gray-50 rounded p-1 -m-1 transition-colors",onClick:Ol,title:"Click to edit case summary",children:R?i.jsx(Wa,{remarkPlugins:[Li],components:{},children:R}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click to add."})}),z&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(z).toLocaleDateString()]})]})]}),ca.length===0&&ds.length===0&&ii.length===0&&!(q||ts||et)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),wl&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),xc&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:xc})]})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsx("div",{className:"mobile-section-selector",children:i.jsxs("div",{className:"selector-container",children:[i.jsx("button",{onClick:()=>Vr("response"),className:`selector-button ${Hn==="response"?"active":""}`,children:"AI Response"}),i.jsx("button",{onClick:()=>Vr("context"),className:`selector-button ${Hn==="context"?"active":""}`,children:"AI Context"})]})}),i.jsxs("div",{className:"status-messages-container",children:[it&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:it}),be&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:be}),Ms&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ms}),Ds&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ds})]}),r&&!G&&i.jsxs(w.Fragment,{children:[Oa&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:Oa}),Qe.length>0&&i.jsx("div",{className:"options-grid",children:Qe.map((ne,xe)=>i.jsx("button",{onClick:()=>Zr(ne),className:"option-button",children:ne},xe))})]}),Xr&&i.jsx("div",{className:"speech-error-display",children:Xr}),Ni&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",Ni.name]}),i.jsx("button",{onClick:()=>{Dl(null),To.current&&(To.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:To,onChange:Ys,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:ht,className:"complaint-textarea",value:d,onChange:ne=>f(ne.target.value),onKeyDown:Gi,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:pr||!r||ko}),i.jsxs("div",{className:"chat-input-actions-container",children:[h&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>o(`/patient/${h}/lab-reports`),disabled:et||!h,className:"icon-button",title:"View Lab Reports",children:i.jsx(fo,{size:14})}),i.jsx("button",{onClick:()=>o("/inventory"),disabled:Aa,className:"icon-button",title:"View Inventory",children:i.jsx(Wd,{size:14})})]}),i.jsx("button",{type:"button",onClick:ai,disabled:pr||!r||ko,className:"icon-button",title:"Attach Image",children:i.jsx(Rb,{size:14})}),i.jsx("button",{type:"button",onClick:Mc,disabled:pr||!r||!Pl.current,className:`mic-button ${ko?"listening":""}`,title:ko?"Stop":"Mic",children:i.jsx(fg,{size:14})}),i.jsx("button",{onClick:()=>ua(),disabled:pr||!d.trim()||!r||ko,className:"send-button",title:pr?"Processing...":"Save & Ask AI",children:pr?i.jsx("div",{className:"custom-loader-circle",role:"status","aria-label":"loading"}):i.jsx(C1,{size:14})}),cs&&i.jsx("button",{type:"button",onClick:hi,disabled:pr,className:"icon-button text-red-500",title:"Undo Last AI Actions",children:i.jsx(jr,{size:14})})]})]})})]})]}),wc&&h&&i.jsx(mre,{isOpen:wc,onClose:()=>rs(!1),onSuccess:()=>{h&&Ro(h),rs(!1),wi([])},patientId:h,initialItems:Cl}),Os&&is&&i.jsx(gre,{isOpen:Os,onClose:()=>Nl(!1),onSuccess:()=>{h&&Ro(h),Nl(!1),So(void 0)},medication:is}),ui&&i.jsx(BA,{isOpen:ui,onClose:()=>{Sl(!1),So(void 0),wi([])},onSuccess:()=>{h&&Ro(h),Sl(!1),So(void 0),wi([])},initialItems:Cl,medication:is,initialPatient:b?{id:b.id,name:b.name,phone:b.phone||"",patient_token_number:String(b.patient_token_number||"")}:void 0})]})},xre=()=>{const{patientId:e}=ra(),n=Dt(),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(!1),[f,u]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){u("Patient ID not provided.");return}d(!0),u(null);try{const b=await me(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();o({name:v.name,age:v.age,gender:v.gender});const S=await me(`/api/patients/${e}/complaints`);if(S.ok){const T=(await S.json()).sort((P,R)=>new Date(R.createdAt).getTime()-new Date(P.createdAt).getTime());r(T)}else if(S.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),u(`Failed to load data. ${b.message}`),r([]),o(null)}finally{d(!1)}})()},[e]);const h=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),f&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",f]}),l&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!f&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>h(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},zx=500,Jj="defaultConsultationFee",bre=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:o=[],billType:l="other",relatedId:d,initialStatus:f="pending",initialDiscountPercentage:u=0,readOnlyMode:h=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[T,P]=w.useState([]),R=w.useRef([]),[I,B]=w.useState(""),[F,L]=w.useState(""),[U,H]=w.useState(1),[K,M]=w.useState(u),[$,z]=w.useState("cash"),[W,te]=w.useState(!1),[V,G]=w.useState(null),[J,oe]=w.useState(!1),[ie,E]=w.useState(!1),[ce,ge]=w.useState(!1),[D,pe]=w.useState(null),[,Ce]=w.useState([]),[Z,ee]=w.useState(null),[X,ye]=w.useState(""),[He,he]=w.useState("cash"),[Le,ue]=w.useState(!1),[De,Ye]=w.useState(zx),[et,Ke]=w.useState(zx.toString()),it=n?"view_pay":"create";w.useEffect(()=>{const ve=localStorage.getItem(Jj),ke=ve?parseFloat(ve):zx;isNaN(ke)||(Ye(ke),Ke(ke.toString()))},[]);const ot=o.length===0;w.useEffect(()=>{e?(async()=>{te(!0),G(null);try{const ke=await me(`/api/patients/${e}`);if(!ke.ok){const Oe=await ke.json().catch(()=>({}));throw new Error(Oe.message||"Failed to fetch patient details")}const Ne=await ke.json();k(Ne)}catch(ke){G(`Failed to load patient details: ${ke.message}`),k(null)}finally{te(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{ge(!0),G(null),pe(null),Ce([]),ee(null);try{const ke=await me(`/api/bills/${n}`);if(!ke.ok){const Oe=await ke.json().catch(()=>({}));throw new Error(Oe.message||"Failed to fetch bill details")}const Ne=await ke.json();if(!Ne.bill||!Ne.payments||!Ne.calculated)throw new Error("Invalid bill details structure.");pe(Ne.bill),Ce(Ne.payments),ee(Ne.calculated),M(Ne.bill.discount_percentage!==void 0&&Ne.bill.discount_percentage!==null?parseFloat(Ne.bill.discount_percentage.toString()):0),!S&&Ne.bill.patient_id&&vt(Ne.bill.patient_id.toString())}catch(ke){G(`Failed to load bill details: ${ke.message}`),pe(null),Ce([]),ee(null)}finally{ge(!1)}})():(pe(null),Ce([]),ee(null))},[n]);const vt=async ve=>{te(!0);try{const ke=await me(`/api/patients/${ve}`);if(!ke.ok)throw new Error("Failed to fetch patient");const Ne=await ke.json();k(Ne)}catch(ke){console.error("Error fetching patient details:",ke),k(null)}finally{te(!1)}},Ee=w.useCallback(async ve=>{E(!0),G(null);const ke=ve.filter(Ne=>Ne.drug_id!=null).map(async Ne=>{try{const Oe=await me(`/api/drugs/${Ne.drug_id}`);if(!Oe.ok)throw new Error(`Drug ${Ne.drug_id} not found.`);const Ve=await Oe.json();return{...Ne,price:Ve.price,total:Ve.price*Ne.quantity}}catch{return G(Ve=>`${Ve?Ve+"; ":""}Failed to fetch price for ${Ne.name}`),Ne}});try{const Ne=await Promise.all(ke);P(Oe=>{const Ve=new Map(Ne.map(Ze=>[Ze.id,Ze]));return Oe.map(Ze=>Ve.get(Ze.id)||Ze)})}catch{}finally{E(!1)}},[me]);w.useEffect(()=>{if(n){P([]),R.current=[];return}JSON.stringify(o)===JSON.stringify(R.current)||(async()=>{let Ne=[];if(o&&o.length>0)Ne=o.map((Oe,Ve)=>({...Oe,id:`initial-${Ve}-${Date.now()}`})),z(f==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),M(u),l==="pharmacy"&&!h&&await Ee(Ne);else if(e&&ot&&l==="consultation"){let Oe=De;if(g)try{const Ve=await me(`/api/staff/${g}`);if(!Ve.ok){const jt=await Ve.json().catch(()=>({}));throw new Error(jt.message||"Doctor not found or error fetching fee")}const Ze=await Ve.json();Ze.opd_fee!=null&&!isNaN(parseFloat(String(Ze.opd_fee)))&&parseFloat(String(Ze.opd_fee))>=0&&(Oe=parseFloat(String(Ze.opd_fee)))}catch(Ve){G(Ze=>`${Ze?Ze+"; ":""}Could not fetch doctor's fee, using default. (${Ve.message})`)}Ne=[{id:Date.now(),name:"Consultation Fee",price:Oe,quantity:1,total:Oe*1,drug_id:null}],z(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else Ne=[],z(v==="no_cash_insurance"?"no_cash_insurance":"cash");P(Ne),R.current=o})()},[n,e,g,o,l,De,ot,f,h,Ee,u,v]);const Je=()=>{const ve=parseFloat(F);if(!h)if(I&&!isNaN(ve)&&ve>=0&&U>0){if(I.trim().toLowerCase()==="consultation fee"&&T.some(Ne=>Ne.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const ke={id:Date.now(),name:I.trim(),price:ve,quantity:U,total:ve*U,drug_id:null};P([...T,ke]),B(""),L(""),H(1)}else alert("Invalid item details.")},Ae=ve=>{h||P(T.filter(ke=>ke.id!==ve))},_e=w.useMemo(()=>{let ve=T.reduce((ke,Ne)=>ke+Ne.total,0);return it==="create"&&K>0&&(ve=ve*(1-K/100)),(Z==null?void 0:Z.totalDue)!==void 0&&(Z==null?void 0:Z.totalDue)!==null?Z.totalDue:ve},[T,Z,K,it]),le=w.useMemo(()=>(Z==null?void 0:Z.totalPaid)??0,[Z]),q=w.useMemo(()=>(Z==null?void 0:Z.balance)!==void 0&&(Z==null?void 0:Z.balance)!==null?Z.balance:_e-le,[Z,_e,le]),de=()=>{const ve=parseFloat(et);!isNaN(ve)&&ve>=0?(Ye(ve),localStorage.setItem(Jj,ve.toString()),alert(`Default Fee set to ${ve.toFixed(2)}`)):alert("Invalid fee amount.")},be=async(ve,ke)=>{oe(!0),G(null);try{const Ne=await me("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:ke,billId:ve})}),Oe=await Ne.json();if(!Ne.ok||!Oe.order)throw new Error(Oe.message||"Failed to create Razorpay order.");const{key_id:Ve,order:Ze}=Oe,jt={key:Ve,amount:Ze.amount,currency:Ze.currency,name:"Newtons Ai HMS Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:Ze.id,handler:async function(Nt){try{const mt=await me("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:Nt.razorpay_payment_id,razorpay_order_id:Nt.razorpay_order_id,razorpay_signature:Nt.razorpay_signature,billId:ve})}),an=await mt.json();if(mt.ok&&an.success)alert("Payment Successful!"),r&&r(ve),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(an.message||"Payment verification failed.")}catch(mt){G(`Payment verification failed: ${mt.message}. Contact support.`)}finally{oe(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:ve,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){G("Payment cancelled."),oe(!1)}}};if(window.Razorpay)new window.Razorpay(jt).open();else throw new Error("Razorpay SDK not loaded.")}catch(Ne){G(`Failed to initiate online payment: ${Ne.message}`),oe(!1)}},$e=async()=>{if(!n){G("Bill ID is missing.");return}if(!X||isNaN(parseFloat(X))||parseFloat(X)<=0){G("Please enter a valid positive payment amount.");return}ue(!0),G(null);const ve={amount_paid:parseFloat(X),payment_mode:He};try{const ke=await me(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)}),Ne=await ke.json();if(!ke.ok)throw new Error(Ne.message||`Failed to record payment (Status: ${ke.status})`);alert(`Payment of ${ve.amount_paid.toFixed(2)} recorded.`),ye(""),a?a():console.log("Payment recorded.")}catch(ke){G(`Failed to record payment: ${ke.message}`)}finally{ue(!1)}},nt=async()=>{if(it==="view_pay")return;if(!e){G("Patient ID is missing for creating a bill.");return}if(T.length===0){G("Cannot finalize an empty bill.");return}oe(!0),G(null);const ve=_e,ke=T.map(({id:Ne,...Oe})=>Oe);if($==="online"){const Ne={patientId:e,queueId:t||null,items:ke,amount:ve,paymentMode:"online",type:l,related_id:d||b||null,status:"pending",discountPercentage:K,labOrderId:b||null};try{const Oe=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)}),Ve=await Oe.json();if(!Oe.ok)throw new Error(Ve.message||"Failed to create pending bill.");be(Ve.id,Math.round(ve*100))}catch(Oe){G(`Failed to create pending bill: ${Oe.message}`),oe(!1)}}else{const Ne="paid";if(!$){G("Payment mode required."),oe(!1);return}const Oe={patientId:e,queueId:t||null,items:ke,amount:ve,paymentMode:$,type:l,related_id:d||b||null,status:Ne,discountPercentage:K,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const Ve=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Oe)}),Ze=await Ve.json();if(!Ve.ok)throw new Error(Ze.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(Ze.id),oe(!1)}catch(Ve){G(`Failed to process bill: ${Ve.message}`),oe(!1)}}},ht=(D==null?void 0:D.type)??l,wt=(D==null?void 0:D.status)??f,Et=it==="view_pay"&&D&&wt==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):W||it==="view_pay"&&ce?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):it==="view_pay"&&!D&&!ce&&V?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",V]}):it==="create"&&!S&&!W&&V?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",V]}):i.jsxs("div",{className:"billing-component-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:it==="create"?"Create Bill":"Bill Details"}),it==="create"&&l==="consultation"&&!h&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),i.jsx("input",{id:"defaultFee",type:"number",value:et,onChange:ve=>Ke(ve.target.value),className:"",placeholder:zx.toString(),disabled:h}),i.jsx("button",{onClick:de,title:"Set Default Fee",className:"",disabled:h,children:i.jsx(Jd,{size:16})})]})]}),V&&!ce&&!Le&&i.jsxs("div",{className:"error-message",role:"alert",children:[i.jsx("strong",{children:"Error: "}),V]}),S&&i.jsxs("div",{className:"patient-details-section",children:[i.jsx("h3",{children:"Patient Details"}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",S.id]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",S.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",i.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),i.jsxs("div",{className:"bill-items-summary-section",children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:it==="create"?"Bill Items":"Billing Summary"}),it==="create"&&l==="pharmacy"&&!h&&T.some(ve=>ve.drug_id!=null)&&i.jsxs("button",{onClick:()=>Ee(T),disabled:ie,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[i.jsx(j1,{size:14,className:`lucide ${ie?"animate-spin":""}`}),ie?"Refreshing...":"Refresh"]})]}),it==="view_pay"&&D&&i.jsxs("div",{className:"bill-info-bar",children:[i.jsxs("span",{children:["Bill ID: ",i.jsx("strong",{children:D.id})]}),i.jsxs("span",{children:["Type: ",i.jsx("strong",{className:"capitalize",children:ht})]}),i.jsxs("span",{children:["Status: ",i.jsx("strong",{className:`capitalize ${wt==="paid"?"status-paid":"status-pending"}`,children:wt})]})]}),(it==="create"||it==="view_pay"&&D)&&i.jsxs("div",{className:"bill-items-list",children:[it==="create"&&ie&&T.length>0&&i.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),it==="create"&&!ie&&T.map((ve,ke)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[ke+1,". ",ve.name]}),ve.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ve.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",ve.total.toFixed(2)]}),it==="create"&&typeof ve.id=="number"&&!h&&i.jsxs("button",{onClick:()=>Ae(ve.id),className:"remove-item-button",title:"Remove",children:[" ",i.jsx(Sn,{size:16})," "]}),(typeof ve.id!="number"||h||ve.name==="Consultation Fee")&&i.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",i.jsx(nC,{size:14})," "]})]})]},ve.id)),it==="view_pay"&&D&&D.items.map((ve,ke)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[ke+1,". ",ve.name]}),ve.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ve.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",(ve.total??ve.price*ve.quantity).toFixed(2)]}),i.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",i.jsx(nC,{size:14})," "]})]})]},ke)),it==="create"&&T.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items added."}),it==="view_pay"&&D&&D.items.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),it==="create"&&!h&&i.jsxs("div",{className:"add-item-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Item"}),i.jsx("input",{type:"text",value:I,onChange:ve=>B(ve.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:U,onChange:ve=>H(parseInt(ve.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[i.jsx("label",{children:"Price ()"}),i.jsx("input",{type:"number",value:F,onChange:ve=>L(ve.target.value),placeholder:"0.00",className:"custom-text-input"})]}),i.jsx("button",{onClick:Je,className:"add-item-button",children:"Add"})]})]})," ",i.jsxs("div",{className:"billing-footer",children:[i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),i.jsxs("span",{className:"total-amount-value",children:["",typeof _e=="number"?_e.toFixed(2):"0.00"]}),it==="create"&&!h&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),i.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:K,onChange:ve=>M(parseFloat(ve.target.value)||0),className:"",disabled:h||J})]}),it==="view_pay"&&D&&(D.status==="pending"||D.status==="paid")&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),i.jsxs("span",{className:"discount-value",children:[K.toFixed(2),"%"]})]})]}),it==="view_pay"&&Z&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),i.jsxs("span",{className:"total-amount-value",children:["",le.toFixed(2)]})]}),it==="view_pay"&&Z&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),i.jsxs("span",{className:"total-amount-value",children:["",q.toFixed(2)]})]}),i.jsxs("div",{className:"footer-actions",children:[it==="create"&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:$,onChange:ve=>z(ve.target.value),className:"custom-select-input",disabled:h||J,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("button",{onClick:nt,disabled:J||T.length===0||h,className:"finalize-button",children:J?"Processing...":"Finalize Bill"})]}),it==="view_pay"&&Et&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Record Payment Amount ()"}),i.jsx("input",{type:"number",value:X,onChange:ve=>ye(ve.target.value),placeholder:`Max: ${q.toFixed(2)}`,className:"custom-text-input",disabled:Le})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:He,onChange:ve=>he(ve.target.value),className:"custom-select-input",disabled:Le,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{onClick:$e,disabled:Le||!X||parseFloat(X)<=0||parseFloat(X)>q,className:"record-payment-button",children:Le?"Recording...":"Record Payment"})]}),it==="create"&&h&&T.length>0&&i.jsx("div",{className:"status-message read-only",children:"Read-only."}),it==="view_pay"&&wt==="paid"&&i.jsx("div",{className:"status-message paid",children:"PAID."}),it==="view_pay"&&wt==="cancelled"&&i.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},vre=()=>{const e=Dt(),n=Ur(),{patientId:t,queueId:r,patientName:a,initialItems:o,billType:l,relatedId:d,initialStatus:f,initialDiscountPercentage:u,doctorId:h,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,T]=w.useState(null),[P,R]=w.useState(null),[I,B]=w.useState(null),[F,L]=w.useState(null),[U,H]=w.useState(null),[K,M]=w.useState(null),[$,z]=w.useState(null),[W,te]=w.useState(!0),[V,G]=w.useState(null),[J,oe]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{te(!0),G(null);try{let pe=t,Ce=o||null,Z=f||null,ee=l||null,X=d||null,ye=u!==void 0?parseFloat(u):null,He=a||null,he=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Le=await me(`/api/bills/${g}`);if(!Le.ok){const De=await Le.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(De.message||`Failed to fetch bill details (Status: ${Le.status})`)}const ue=await Le.json();if(console.log("Fetched Bill Data:",ue),Ce=ue.bill.items||[],Z=ue.bill.status||"pending",ee=ue.bill.type||null,X=ue.bill.related_id||null,ye=ue.bill.discount_percentage!==void 0&&ue.bill.discount_percentage!==null?parseFloat(ue.bill.discount_percentage):0,pe=ue.bill.patient_id,B(Ce),L(Z),H(ee),M(X),z(ye),pe){const De=await me(`/api/patients/${pe}`);if(De.ok){const Ye=await De.json();He=Ye.name,he=Ye.phone??null,R(Ye.insurance_type??null),oe(He),T(he)}else console.warn(`Could not fetch patient details for ID ${pe} from bill.`),oe("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),oe("Patient (Unknown)")}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Le=await me(`/api/lab/${b}`);if(!Le.ok){let De=`Failed to fetch lab order details (Status: ${Le.status} ${Le.statusText})`;try{De=(await Le.json()).message||De}catch{console.error("Response was not valid JSON:",await Le.text())}throw new Error(De)}const ue=await Le.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(ue,null,2)),Ce=(ue.tests||[]).filter(De=>De&&typeof De.name=="string"&&De.price!==void 0&&De.id!==void 0).map(De=>{const Ye=parseFloat(De.price||"0"),et=!isNaN(Ye)&&isFinite(Ye)?Ye:0;return{item_id:De.id,name:De.name,price:et,quantity:1,total:et*1,type:"lab_test"}}),Ce&&Ce.length===0&&(ue.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",ue.tests),G(De=>`${De?De+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),Z="pending",ee="lab",X=b,pe=ue.patient_id,B(Ce),L(Z),H(ee),M(X),pe){const De=await me(`/api/patients/${pe}`);if(De.ok){const Ye=await De.json();He=Ye.name,he=Ye.phone??null,R(Ye.insurance_type??null),oe(He),T(he)}else console.warn(`Could not fetch patient details for ID ${pe} from lab order.`),oe("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),oe("Patient (Unknown)")}else if(B(o||null),L(f||null),H(l||null),M(d||null),z(u!==void 0?parseFloat(u):null),oe(a||`ID ${t}`),pe){const Le=await me(`/api/patients/${pe}`);if(Le.ok){const ue=await Le.json();T(ue.phone??null),R(ue.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${pe}.`)}if(r){const Le=await me(`/api/queue/${r}`);if(Le.ok){const ue=await Le.json();S(ue.token_number)}else console.warn(`Could not fetch queue details for ID ${r}.`)}}catch(pe){console.error("Error fetching billing page details:",pe),G(`Failed to load details: ${pe.message}`),B(null),L(null),H(null),M(null),oe(a||""),T(null),S(null)}finally{te(!1)}})()},[t,g,b,r,e]);const ie=D=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${D}`),e(-1)},E=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(rC,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(W)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(V)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(rC,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:V}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const ge=(F??f)==="paid";return i.jsxs("div",{className:"billing-page-container",children:[i.jsx("div",{className:"back-button-container",children:i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(cn,{size:20,className:"lucide"})," Back"]})}),i.jsxs("div",{className:"billing-content-wrapper",children:[i.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",J||`ID ${t}`]}),i.jsxs("div",{className:"patient-info-bar",children:[v!==null&&i.jsxs("span",{children:[i.jsx(eg,{size:14,className:"lucide"})," Token: ",v]}),k&&i.jsxs("span",{children:[i.jsx(Gk,{size:14,className:"lucide"})," Phone: ",k]}),b&&i.jsxs("span",{className:"lab-order-info",children:[i.jsx(po,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),P&&i.jsxs("span",{className:"insurance-info",children:[i.jsx(pF,{size:14,className:"lucide"})," Insurance: ",P.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase())]}),!k&&v===null&&!b&&!P&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),i.jsx(bre,{patientId:t,labOrderId:b,queueId:r,onBillCreated:ie,onBillUpdated:E,initialItems:I??o,billType:U??l,relatedId:K??d,initialStatus:F??f,initialDiscountPercentage:$??u,readOnlyMode:ge,doctorId:h,patientInsuranceType:P??void 0})]})]})},wre=()=>{const{patientId:e}=ra(),n=Dt(),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided in URL.");return}o(!0),d(null),r([]);try{try{const v=await me(`/api/patients/${e}`);if(v.ok){const S=await v.json();u(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await me(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),d(`Failed to load pharmacy orders: ${g.message}`)}finally{o(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(cn,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(Wd,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",f&&`for ${f}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(h=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(h.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",h.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",h.prescribedBy||"N/A"]}),h.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",h.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:h.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},h.id))})]})},Sre=()=>{const e=Dt(),n=Ur(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState([]),[f,u]=w.useState(""),[h,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState(null),[R,I]=w.useState(!0),[B,F]=w.useState(""),[L,U]=w.useState([]),[H,K]=w.useState(!1),[M,$]=w.useState(null),[z,W]=w.useState(!1),[te,V]=w.useState(!1),[G,J]=w.useState([]),[oe,ie]=w.useState(!1),[E,ce]=w.useState(null),ge=/^\+?[0-9\s\-().]{7,20}$/,D=/^[a-zA-Z\s'-]{2,}$/,pe=w.useCallback(async()=>{try{const Ee=await me("/api/drugs");if(!Ee.ok)throw new Error("Failed to fetch drugs");const Je=await Ee.json(),Ae=Je.drugs||Je||[];o(Ae)}catch(Ee){console.error("Failed to fetch available drugs:",Ee),v("Could not load drug list. "+Ee.message)}},[]),Ce=w.useCallback(async Ee=>{ie(!0),ce(null);try{const Je=await me(`/api/pharmacy-orders/patient/${Ee}`);if(!Je.ok){const _e=await Je.json().catch(()=>({}));throw new Error(_e.message||`HTTP error! status: ${Je.status}`)}const Ae=await Je.json();J(Ae||[])}catch(Je){console.error("Failed to fetch previous pharmacy orders:",Je),ce(`Could not load previous orders: ${Je.message}`)}finally{ie(!1)}},[]);w.useEffect(()=>{var Ee;pe(),(Ee=n.state)!=null&&Ee.patient?X(n.state.patient):I(!0)},[pe,n.state]),w.useEffect(()=>{t!=null&&t.id?Ce(t.id):J([])},[t,Ce]),w.useEffect(()=>{if(!f){g([]);return}const Ee=f.toLowerCase();g(a.filter(Je=>{const Ae=Je.name&&Je.name.toLowerCase().includes(Ee),_e=Je.brand_name&&Je.brand_name.toLowerCase().includes(Ee);return Ae||_e}).slice(0,10))},[f,a]);const Z=w.useMemo(()=>gg(async Ee=>{if(Ee.trim().length<2){U([]),K(!1),$(null);return}K(!0),$(null);try{const Je=new URLSearchParams({search:encodeURIComponent(Ee),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Ae=await me(`/api/patients?${Je.toString()}`);if(!Ae.ok){const le=await Ae.text();throw new Error(`API Error (${Ae.status}): ${le||Ae.statusText}`)}const _e=await Ae.json();U(_e.patients)}catch(Je){console.error("Error searching patients:",Je),$(Je.message||"Failed to search patients."),U([])}finally{K(!1)}},300),[ge]),ee=Ee=>{const Je=Ee.target.value;F(Je),W(ge.test(Je)),V(D.test(Je)&&!ge.test(Je)),K(!0),Z(Je)},X=w.useCallback(Ee=>{r(Ee),I(!1),F(""),U([]),$(null)},[]),ye=w.useCallback(async Ee=>{if(!B||Ee==="phone"&&!z||Ee==="name"&&!te){$(`Invalid ${Ee} to create a new patient.`);return}K(!0),$(null);try{const Ae=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Ee==="name"?B:"direct pharmacy",phone:Ee==="phone"?B:null,age:null,gender:null,token:null})});if(!Ae.ok){const le=await Ae.json();throw new Error(le.message||`Failed to create patient: ${Ae.statusText}`)}const _e=await Ae.json();alert(`New patient "${_e.name}" created with ${Ee==="phone"?`phone ${_e.phone}`:`name ${_e.name}`}.`),X(_e)}catch(Je){console.error("Error creating new patient:",Je),$(Je.message||"Failed to create new patient.")}finally{K(!1)}},[B,z,te,X]),He=()=>{r(null),I(!0),d([]),v(null),J([])},he=Ee=>{if(l.some(Je=>Je.drug_id===Ee.id)){const Je=Ee.name||Ee.brand_name||"This drug";v(`${Je} is already in the order.`),setTimeout(()=>v(null),3e3),u(""),g([]);return}d(Je=>[...Je,{drug_id:Ee.id,name:Ee.name||Ee.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,mrp:Number(Ee.mrp)||0,originalMrp:Number(Ee.mrp)||0,stock:Ee.stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(Ee.mrp)||0)/(ue(Ee.pack)||1),pack:Ee.pack}]),u(""),g([])},Le=()=>{const Ee=f.trim();if(!Ee){v("Please enter a drug name to navigate to the add drug page."),setTimeout(()=>v(null),3e3);return}e("/dashboard/inventory/add",{state:{initialDrugName:Ee}}),u(""),g([])},ue=Ee=>{if(!Ee)return null;const Je=Ee.match(/(?:\d+x)?(\d+)/);return Je?parseInt(Je[1],10):null},De=Ee=>{d(Je=>Je.filter(Ae=>(Ae.drug_id??Ae.name)!==Ee))},Ye=(Ee,Je)=>{d(Ae=>Ae.map(_e=>{if((_e.drug_id??_e.name)===Ee&&_e.isLoose){const q=ue(_e.pack),de=Math.max(0,Je),be=de*(q??1)+(_e.looseUnits??0);return{..._e,loosePacks:de,looseQuantity:be,pack_quantity:de}}return _e}))},et=(Ee,Je)=>{d(Ae=>Ae.map(_e=>{if((_e.drug_id??_e.name)===Ee&&_e.isLoose){const q=ue(_e.pack),de=Math.max(0,Je),be=(_e.loosePacks??0)*(q??1)+de;return{..._e,looseUnits:de,looseQuantity:be}}return _e}))},Ke=Ee=>{const Je=[];Ee.medications.forEach(Ae=>{if(l.find(le=>le.drug_id&&Ae.drug_id&&le.drug_id===Ae.drug_id||le.name.toLowerCase()===Ae.name.toLowerCase()))d(le=>le.map(q=>{if(q.drug_id&&Ae.drug_id&&q.drug_id===Ae.drug_id||q.name.toLowerCase()===Ae.name.toLowerCase()){const de=(q.pack_quantity??0)+(Ae.pack_quantity??0),be=(q.loose_quantity??0)+(Ae.loose_quantity??0),$e=Ae.tabletsPerDay??q.tabletsPerDay,nt=Ae.numberOfDays??q.numberOfDays,ht=ue(q.pack),wt=de*(ht??1)+be;return{...q,pack_quantity:de,loose_quantity:be,directions_to_use:Ae.directions_to_use??q.directions_to_use,tabletsPerDay:$e,numberOfDays:nt,looseQuantity:wt,loosePacks:Math.floor(wt/(ht??1)),looseUnits:wt%(ht??1)}}return q}));else{let le=Ae.drug_id,q=Ae.drug_id?a.find(de=>de.id===Ae.drug_id):void 0;if(!le&&Ae.name){const de=a.find(be=>be.name&&be.name.toLowerCase()===Ae.name.toLowerCase());de&&(le=de.id,q=de)}Je.push({drug_id:le,name:Ae.name,pack_quantity:Ae.pack_quantity??0,loose_quantity:Ae.loose_quantity??0,directions_to_use:Ae.directions_to_use,tabletsPerDay:Ae.tabletsPerDay??1,numberOfDays:Ae.numberOfDays??1,mrp:q?q.mrp:Ae.pack_price,originalMrp:q?q.mrp:Ae.pack_price,stock:q?q.stock:Ae.stock,isLoose:!0,loosePacks:0,looseUnits:(Ae.pack_quantity??0)*(ue((q==null?void 0:q.pack)||Ae.pack)??1)+(Ae.loose_quantity??0),looseQuantity:(Ae.pack_quantity??0)*(ue((q==null?void 0:q.pack)||Ae.pack)??1)+(Ae.loose_quantity??0),pricePerLooseUnit:(q?Number(q.mrp):Number(Ae.pack_price)||0)/(ue((q==null?void 0:q.pack)||Ae.pack)||1),pack:(q==null?void 0:q.pack)||Ae.pack})}}),d(Ae=>[...Ae,...Je]),Ee.prescriptionForUnavailableDrugs&&(!T||!T.includes(Ee.prescriptionForUnavailableDrugs))&&P(Ae=>Ae?`${Ae}

-- From Order ${Ee.id.substring(0,8)} --
${Ee.prescriptionForUnavailableDrugs}`:Ee.prescriptionForUnavailableDrugs),v("Medications from previous order added to current order."),setTimeout(()=>v(null),3e3)},it=async Ee=>{if(Ee.preventDefault(),v(null),k(!0),!t){v("No patient selected for the order."),k(!1);return}if(l.length===0&&!(T!=null&&T.trim())){v("Please add at least one medication or provide a prescription for unavailable drugs."),k(!1);return}const Je=l.filter(_e=>{const le=_e.looseQuantity??0;return le<=0||_e.stock!==void 0&&le>_e.stock});if(Je.length>0){v(`Invalid quantity or insufficient stock for: ${Je.map(_e=>_e.name).join(", ")}`),k(!1);return}const Ae={patient_id:t.id,items:l.map(_e=>{const le=_e.mrp??0,q=_e.pricePerLooseUnit??0,de=q*(_e.looseQuantity??0);return{drug_id:_e.drug_id===void 0?null:_e.drug_id,name:_e.name,pack_quantity:_e.loosePacks??0,loose_quantity:_e.looseUnits??0,pack_price:le,loose_price:q,total_price:de,price:_e.originalMrp??0,directions_to_use:_e.directions_to_use===void 0?null:_e.directions_to_use,tabletsPerDay:_e.tabletsPerDay??1,numberOfDays:_e.numberOfDays??1}}),order_total:ot,prescription_for_unavailable_drugs:T};try{const _e=await me("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ae)});if(!_e.ok){const le=await _e.json();throw new Error(le.message||`Failed to create order: ${_e.statusText}`)}alert(`Pharmacy order created successfully for ${t.name}!`),e(-1)}catch(_e){console.error("Failed to create pharmacy order:",_e),v(_e.message||"Failed to create order. Please try again.")}finally{k(!1)}},ot=w.useMemo(()=>l.reduce((Ee,Je)=>{const Ae=Je.isLoose?Je.pricePerLooseUnit??0:Je.mrp??0,_e=Je.isLoose?Je.looseQuantity??0:Je.quantity??0;return Ee+Ae*_e},0),[l]),vt=(Number(ot)||0).toFixed(2);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-6 max-w-5xl mx-auto",children:[" ",i.jsxs("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:[" ",i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:[i.jsx(cn,{size:20})," "]}),i.jsx("h2",{className:"text-2xl",children:"Create New Pharmacy Order"})," "]})]}),R&&i.jsxs("div",{className:"content-section",children:[" ",i.jsx("h3",{className:"section-title",children:"Select Patient"})," ",i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"})," ",i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:B,onChange:ee,className:"custom-text-input mt-1",autoFocus:!0}),H&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),M&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:M})," ",L.length>0&&i.jsxs("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:[" ",i.jsxs("ul",{children:[" ",L.map(Ee=>i.jsxs("li",{onClick:()=>X({id:Ee.id,name:Ee.name,token:Ee.token,age:Ee.age,gender:Ee.gender,phone:Ee.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",Ee.token]}),Ee.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[Ee.age?`${Ee.age} yrs`:"Age N/A",Ee.gender?` / ${Ee.gender}`:" / Gender N/A",Ee.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",Ee.phone]})]})]}),Ee.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",Ee.phone]})]},Ee.id))]})]}),B.length>=2&&!H&&L.length===0&&!M&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',B,'".']}),z&&i.jsx("button",{type:"button",onClick:()=>ye("phone"),className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:H,children:'Create "direct pharmacy" Patient with this Phone'}),te&&i.jsx("button",{type:"button",onClick:()=>ye("name"),className:"create-patient-button mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ml-2",disabled:H,children:"Create Patient with this Name"})]}),B.length<2&&!H&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]}),t&&!R&&i.jsxs("form",{onSubmit:it,children:[i.jsxs("div",{className:"selected-patient-info content-section flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:"section-title",children:[" ","Patient: ",i.jsx("span",{className:"font-normal",children:t.name})]}),i.jsxs("p",{className:"text-sm mt-1",children:["Token: ",i.jsx("span",{className:"font-medium",children:t.token??"N/A"}),t.age&&`    Age: ${t.age}`,t.gender&&`    Gender: ${t.gender}`,t.phone&&`    Phone: ${t.phone}`]}),i.jsxs("p",{className:"text-xs mt-1",title:`Patient UUID: ${t.id}`,children:["ID: ",t.id.substring(0,12),"..."]})]}),i.jsx("button",{type:"button",onClick:He,className:"change-patient-button mt-2 sm:mt-0 px-3 py-1.5 border rounded-md text-sm font-medium focus:outline-none focus:ring-2",children:"Change Patient"})]}),b&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:b})," ",oe&&i.jsx("div",{className:"content-section text-center py-4",children:i.jsx("p",{className:"text-gray-500",children:"Loading previous orders..."})}),E&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:E}),!oe&&G.length>0&&i.jsxs("div",{className:"content-section mt-4",children:[i.jsx("h3",{className:"section-title",children:"Previous Orders"}),i.jsx("div",{className:"space-y-4",children:G.map(Ee=>i.jsxs("div",{className:"previous-order-card p-4 border rounded-lg shadow-sm bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"font-semibold text-gray-800",children:["Order Date: ",new Date(Ee.date).toLocaleDateString()]}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ee.status==="dispensed"?"bg-green-100 text-green-800":Ee.status==="pending"?"bg-yellow-100 text-yellow-800":Ee.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:Ee.status.charAt(0).toUpperCase()+Ee.status.slice(1)})]}),i.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mb-3",children:Ee.medications.map((Je,Ae)=>i.jsxs("li",{children:[i.jsx("strong",{children:Je.name}),": ",Je.quantity," Qty",Je.directions_to_use&&` - Directions: ${Je.directions_to_use}`]},Ae))}),Ee.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[i.jsx("span",{className:"font-semibold",children:"Prescription for Unavailable:"}),i.jsxs("div",{className:"prose prose-sm max-w-none",children:[" ",i.jsx(Wa,{remarkPlugins:[Li],children:Ee.prescriptionForUnavailableDrugs})]})]}),i.jsxs("button",{type:"button",onClick:()=>Ke(Ee),className:"add-previous-meds-button mt-3 px-3 py-1.5 text-sm font-medium rounded-md flex items-center justify-center",children:[i.jsx(_s,{size:16,className:"mr-1"})," Add Medications to Current Order"]})]},Ee.id))})]}),!oe&&G.length===0&&t&&i.jsx("div",{className:"content-section text-center py-4 mt-4",children:i.jsx("p",{className:"text-gray-500",children:"No previous orders found for this patient."})}),i.jsxs("div",{className:"mb-4 content-section",children:[i.jsx("label",{htmlFor:"prescription-unavailable",className:"form-label",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-unavailable",rows:3,value:T??"",onChange:Ee=>P(Ee.target.value||null),placeholder:"Enter prescription details for any drugs that are currently unavailable...",className:"custom-text-input mt-1 w-full"})]}),i.jsxs("div",{className:"mb-4 relative content-section",children:[" ",i.jsx("label",{htmlFor:"drug-search",className:"form-label",children:"Add Medication"})," ",i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search for drug name or type to add custom...",value:f,onChange:Ee=>u(Ee.target.value),className:"custom-text-input mt-1"}),f&&i.jsxs("div",{className:"drug-search-dropdown mt-1 w-full max-h-60 rounded-md border shadow-lg overflow-auto focus:outline-none sm:text-sm z-20",children:[" ",h.length>0&&i.jsxs("ul",{children:[" ",h.map(Ee=>i.jsxs("li",{onClick:()=>he(Ee),className:"cursor-pointer select-none relative",children:[i.jsx("span",{className:"font-medium block truncate",children:Ee.name||Ee.brand_name}),i.jsxs("span",{className:"drug-stock-price text-xs",children:[" ","(Stock: ",Ee.stock??"N/A",", MRP: ",Number(Ee.mrp||0).toFixed(2),")"]})]},Ee.id))]}),f.trim()&&!a.some(Ee=>Ee.name&&Ee.name.toLowerCase()===f.trim().toLowerCase()||Ee.brand_name&&Ee.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsxs("div",{onClick:Le,className:"add-custom-drug-button cursor-pointer text-sm font-medium",role:"button",children:['Add "',f.trim(),'" as new item']}),f.trim()&&h.length===0&&a.some(Ee=>Ee.name&&Ee.name.toLowerCase()===f.trim().toLowerCase()||Ee.brand_name&&Ee.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsx("p",{className:"text-gray-400 py-2.5 px-4 text-sm",children:"Drug already selected or no new matches."})]})]}),i.jsxs("div",{className:"order-items-section content-section max-h-96 overflow-y-auto",children:[" ",i.jsx("h4",{className:"section-title",children:"Order Items"})," ",l.length===0&&i.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No medications added yet."}),l.length>0&&i.jsx("ul",{className:"space-y-4",children:l.map(Ee=>{const Je=Ee.drug_id??Ee.name,Ae=!Ee.drug_id;return i.jsxs("li",{className:"order-item-card text-sm",children:[" ",i.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3",children:[i.jsxs("div",{className:"flex-grow mb-2 md:mb-0",children:[i.jsxs("span",{className:`item-name block text-base ${Ae?"custom":""}`,children:[" ",Ee.name,Ae?" (custom)":""]}),!Ae&&Ee.pricePerLooseUnit!==void 0&&i.jsxs("span",{className:"item-details text-xs",children:[" ","@ ",(Number(Ee.pricePerLooseUnit)||0).toFixed(2)," per loose unit"]}),Ee.stock!==void 0&&i.jsxs("span",{className:`item-details text-xs ml-2 ${Ee.stock<=10?"item-stock low":""}`,children:[" ","(Stock: ",Ee.stock,")"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2",children:[i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-packs-${Je}`,className:"dosage-label",children:"Packs:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>Ye(Je,(Ee.loosePacks??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-packs-${Je}`,min:"0",value:Ee.loosePacks||"",onChange:_e=>{const le=parseInt(_e.target.value,10);Ye(Je,isNaN(le)?0:le)},onFocus:_e=>_e.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>Ye(Je,(Ee.loosePacks??0)+1),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-units-${Je}`,className:"dosage-label",children:"Loose:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>et(Je,(Ee.looseUnits??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-units-${Je}`,min:"0",value:Ee.looseUnits||"",onChange:_e=>{const le=parseInt(_e.target.value,10);et(Je,isNaN(le)?0:le)},onFocus:_e=>_e.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>et(Je,(Ee.looseUnits??0)+1),className:"quantity-btn",children:"+"})]}),Ee.pack&&i.jsxs("span",{className:"ml-2 text-sm text-gray-400",children:["(",Ee.pack.split("x")[1]||Ee.pack," per pack)"]})]})]}),i.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-3 mt-2 md:mt-0 md:flex-col md:items-end",children:[i.jsxs("div",{className:"w-28 text-right font-semibold",children:[" ","",(Number((Ee.pricePerLooseUnit??0)*(Ee.looseQuantity??0))||0).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>De(Je),className:"remove-item-button p-1.5 -m-1.5 rounded-full",title:"Remove Item",children:i.jsx(jr,{size:18})})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2 mt-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:`tablets-per-day-${Je}`,className:"dosage-label",children:"Per Day:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(_e=>_e.map(le=>le.drug_id===Je?{...le,tabletsPerDay:Math.max(1,(le.tabletsPerDay??1)-1)}:le)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`tablets-per-day-${Je}`,min:"1",value:Ee.tabletsPerDay??1,onChange:_e=>{const le=parseInt(_e.target.value,10);d(q=>q.map(de=>de.drug_id===Je?{...de,tabletsPerDay:isNaN(le)?1:Math.max(1,le)}:de))},onFocus:_e=>_e.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(_e=>_e.map(le=>le.drug_id===Je?{...le,tabletsPerDay:(le.tabletsPerDay??1)+1}:le)),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`number-of-days-${Je}`,className:"dosage-label",children:"No. Days:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(_e=>_e.map(le=>le.drug_id===Je?{...le,numberOfDays:Math.max(1,(le.numberOfDays??1)-1)}:le)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`number-of-days-${Je}`,min:"1",value:Ee.numberOfDays??1,onChange:_e=>{const le=parseInt(_e.target.value,10);d(q=>q.map(de=>de.drug_id===Je?{...de,numberOfDays:isNaN(le)?1:Math.max(1,le)}:de))},onFocus:_e=>_e.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(_e=>_e.map(le=>le.drug_id===Je?{...le,numberOfDays:(le.numberOfDays??1)+1}:le)),className:"quantity-btn",children:"+"})]})]})]}),i.jsx("div",{className:"flex items-center mt-2",children:Ee.pack&&ue(Ee.pack)&&i.jsx("span",{className:"ml-4 text-sm text-gray-400",children:(()=>{const _e=ue(Ee.pack),le=Ee.looseQuantity??0;if(_e&&_e>0){const q=Math.floor(le/_e),de=le%_e;return`(Subtract: ${q} packs, ${de} loose)`}return""})()})}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{htmlFor:`directions-${Je}`,className:"dosage-label",children:"Directions:"}),i.jsx("input",{type:"text",id:`directions-${Je}`,placeholder:"e.g., 'After food', 'Twice a day'",value:Ee.directions_to_use??"",onChange:_e=>{const le=_e.target.value;d(q=>q.map(de=>(de.drug_id??de.name)===Je?{...de,directions_to_use:le}:de))},className:"dosage-input text-sm w-full mt-1"})]})]},Je)})})]}),l.length>0&&i.jsx("div",{className:"mt-6 text-right pr-4",children:i.jsxs("span",{className:"grand-total font-bold",children:[" ","Grand Total: ",vt]})}),i.jsx("div",{className:"mt-8 flex justify-end",children:i.jsx("button",{type:"submit",disabled:S||l.length===0&&!(T!=null&&T.trim()),className:`submit-order-button inline-flex items-center justify-center text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${S||l.length===0&&!(T!=null&&T.trim())?"":"hover:opacity-90"}`,children:S?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner animate-spin rounded-full h-5 w-5 border-2 mr-3"})," ","Creating Order..."]}):"Create Order"})})]})]})},UA=()=>{const{orderId:e}=ra(),n=Dt(),[t,r]=w.useState(null),[a,o]=w.useState(null),[l,d]=w.useState([]),[f,u]=w.useState([]),[h,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,P]=w.useState(!1),[R,I]=w.useState(null),[B,F]=w.useState(!0),L=w.useCallback(async()=>{F(!0);try{const V=await me(`/api/pharmacy-orders/${e}`);if(!V.ok)throw new Error("Failed to fetch order details");const G=await V.json();r(G),o({id:G.patientId,name:G.patientName||"N/A",token:G.patientTokenNumber}),I(G.prescriptionForUnavailableDrugs);const J=G.medications.map(oe=>{const ie=H(oe.pack),E=oe.pack_quantity*(ie??1)+oe.loose_quantity;return{...oe,isLoose:!0,loosePacks:oe.pack_quantity,looseUnits:oe.loose_quantity,looseQuantity:E,pack_price:oe.pack_price,loose_price:oe.loose_price,total_price:oe.total_price,pricePerLooseUnit:oe.loose_price,originalPrice:oe.pack_price,box_number:oe.box_number,pack:oe.pack,batch:oe.batch,expiry_date:oe.expiry_date,discount_percentage:oe.discount_percentage}});u(J)}catch(V){k("Could not load order details. "+V.message)}finally{F(!1)}},[e]),U=w.useCallback(async()=>{try{const V=await me("/api/drugs");if(!V.ok)throw new Error("Failed to fetch drugs");const G=await V.json(),J=G.drugs||G||[];d(J)}catch(V){k("Could not load drug list. "+V.message)}},[]);w.useEffect(()=>{L(),U()},[L,U]),w.useEffect(()=>{if(!h){v([]);return}const V=h.toLowerCase();v(l.filter(G=>{const J=G.name&&G.name.toLowerCase().includes(V),oe=G.brand_name&&G.brand_name.toLowerCase().includes(V);return J||oe}).slice(0,10))},[h,l]);const H=V=>{if(!V)return null;const G=V.match(/(?:\d+x)?(\d+)/);return G?parseInt(G[1],10):null},K=V=>{if(f.some(G=>G.drug_id===V.id)){k(`${V.name||V.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}u(G=>[...G,{drug_id:V.id,name:V.name||V.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(V.mrp)||0,loose_price:(Number(V.mrp)||0)/(H(V.pack)||1),total_price:(Number(V.mrp)||0)/(H(V.pack)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:V.stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(V.mrp)||0)/(H(V.pack)||1),originalPrice:Number(V.mrp)||0,pack:V.pack}]),g(""),v([])},M=V=>{u(G=>G.filter(J=>(J.drug_id??J.name)!==V))},$=(V,G)=>{u(J=>J.map(oe=>{if((oe.drug_id??oe.name)===V&&oe.isLoose){const ie=H(oe.pack),E=Math.max(0,G),ce=E*(ie??1)+(oe.looseUnits??0);return{...oe,loosePacks:E,looseQuantity:ce,pack_quantity:E}}return oe}))},z=(V,G)=>{u(J=>J.map(oe=>{if((oe.drug_id??oe.name)===V&&oe.isLoose){const ie=H(oe.pack),E=Math.max(0,G),ce=(oe.loosePacks??0)*(ie??1)+E;return{...oe,looseUnits:E,looseQuantity:ce,loose_quantity:E}}return oe}))},W=async V=>{if(V.preventDefault(),k(null),P(!0),f.length===0&&!(R!=null&&R.trim())){k("Please add at least one medication or provide a prescription."),P(!1);return}const G=f.filter(oe=>{const ie=oe.looseQuantity??0;return ie<=0||oe.stock!==void 0&&ie>oe.stock});if(G.length>0){k(`Invalid quantity or insufficient stock for: ${G.map(oe=>oe.name).join(", ")}`),P(!1);return}const J={items:f.map(oe=>({drug_id:oe.drug_id??null,name:oe.name,pack_quantity:oe.loosePacks??0,loose_quantity:oe.looseUnits??0,pack_price:oe.pack_price??0,loose_price:oe.loose_price??0,total_price:(oe.loose_price??0)*(oe.looseQuantity??0),discount_percentage:oe.discount_percentage??0,directions_to_use:oe.directions_to_use??null,tabletsPerDay:oe.tabletsPerDay??1,numberOfDays:oe.numberOfDays??1})),prescription_for_unavailable_drugs:R,order_total:te};try{const oe=await me(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)});if(!oe.ok){const ie=await oe.json();throw new Error(ie.message||"Failed to update order")}alert("Pharmacy order updated successfully!"),n(-1)}catch(oe){k(oe.message||"Failed to update order. Please try again.")}finally{P(!1)}},te=w.useMemo(()=>f.reduce((V,G)=>{const J=G.loose_price??0,oe=G.looseQuantity??0;return V+J*oe},0),[f]);return B?i.jsx("div",{className:"p-6 flex justify-center items-center h-screen text-gray-500",children:"Loading order details..."}):t?i.jsxs("div",{className:"edit-pharmacy-order-container",children:[i.jsxs("div",{className:"page-header",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(cn,{size:20})}),i.jsxs("h2",{className:"page-title",children:["EDIT ORDER ",i.jsxs("span",{className:"text-gray-500 text-lg font-normal ml-2",children:[a==null?void 0:a.name," #",t.id.substring(0,4)]})]})]}),i.jsx("div",{className:"header-right",children:i.jsx("span",{className:"status-badge",children:t.status.toUpperCase()})})]}),i.jsx("div",{className:"order-meta",children:i.jsxs("span",{className:"order-date",children:[" Order Date: ",new Date(t.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})]})}),i.jsxs("form",{onSubmit:W,className:"main-layout",children:[i.jsxs("div",{className:"left-column",children:[i.jsxs("div",{className:"card search-section",children:[i.jsx("div",{className:"card-header",children:i.jsx("h3",{children:" Find & Add Medication"})}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or brand...",value:h,onChange:V=>g(V.target.value),className:"search-input"}),h&&i.jsx("div",{className:"dropdown-results",children:b.length>0?i.jsx("ul",{children:b.map(V=>i.jsxs("li",{onClick:()=>K(V),className:"dropdown-item",children:[i.jsx("span",{className:"drug-name",children:V.name||V.brand_name}),i.jsxs("span",{className:"drug-meta",children:["(Stock: ",V.stock??"N/A",", MRP: ",Number(V.mrp||0).toFixed(2),")"]})]},V.id))}):i.jsxs("div",{className:"p-3 text-gray-500 text-sm",children:['No drugs found matching "',h,'"']})})]})]}),i.jsxs("div",{className:"card medications-list-section",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[" Medications in Order ",i.jsxs("span",{className:"item-count",children:[f.length," items"]})]})}),f.length>0?i.jsxs("div",{className:"table-container",children:[i.jsxs("div",{className:"table-header-row",children:[i.jsx("div",{className:"col-medication",children:"MEDICATION"}),i.jsx("div",{className:"col-directions",children:"DIRECTIONS"}),i.jsx("div",{className:"col-quantity",children:"QUANTITY"}),i.jsx("div",{className:"col-subtotal",children:"SUBTOTAL"}),i.jsx("div",{className:"col-action"})]}),i.jsx("div",{className:"table-body",children:f.map(V=>{const G=V.drug_id??V.name;return i.jsxs("div",{className:"table-row",children:[i.jsxs("div",{className:"col-medication",children:[i.jsx("span",{className:"med-name",children:V.name}),V.pack&&i.jsx("span",{className:"med-unit text-xs text-gray-500 block",children:V.pack}),i.jsxs("div",{className:"stock-info",children:[" Stock: ",i.jsxs("span",{className:"stock-value",children:[" ",V.stock!==void 0?V.pack?`BOX OF ${H(V.pack)}`:V.stock:"N/A"]})]})]}),i.jsx("div",{className:"col-directions",children:i.jsx("input",{type:"text",placeholder:"1 tablet twice daily...",value:V.directions_to_use??"",onChange:J=>{const oe=J.target.value;u(ie=>ie.map(E=>(E.drug_id??E.name)===G?{...E,directions_to_use:oe}:E))},className:"directions-input"})}),i.jsx("div",{className:"col-quantity",children:i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"PACKS"}),i.jsx("input",{type:"number",min:"0",value:V.loosePacks||"",onChange:J=>$(G,J.target.value===""?0:parseInt(J.target.value)),className:"qty-input",style:{width:"100%",textAlign:"center"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"LOOSE"}),i.jsx("input",{type:"number",min:"0",value:V.looseUnits||"",onChange:J=>z(G,J.target.value===""?0:parseInt(J.target.value)),className:"qty-input",style:{width:"100%",textAlign:"center"}})]})]})}),i.jsxs("div",{className:"col-subtotal",children:["",(Number((V.pricePerLooseUnit??0)*(V.looseQuantity??0))||0).toFixed(2)]}),i.jsx("div",{className:"col-action",children:i.jsx("button",{type:"button",onClick:()=>M(G),className:"delete-btn",children:i.jsx(jr,{size:16})})})]},G)})})]}):i.jsx("div",{className:"empty-state",children:"No medications added. Search above to add."})]})]}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"card notes-card",children:[i.jsx("div",{className:"card-header border-b-0 pb-2",children:i.jsx("h3",{children:" Prescription Notes"})}),i.jsx("textarea",{rows:3,value:R??"",onChange:V=>I(V.target.value||null),placeholder:"Add notes about unavailable drugs...",className:"notes-input"})]}),i.jsxs("button",{type:"submit",disabled:T,className:"confirm-btn",style:{width:"100%",margin:"20px 0 0 0"},children:[i.jsx("span",{className:"check-icon",children:""})," ",T?"Updating...":"Confirm Changes"]}),S&&i.jsx("div",{className:"error-alert mt-4",children:S})]})]})]}):i.jsx("div",{className:"p-6 text-red-500 flex justify-center items-center h-screen",children:"Order not found or failed to load."})},Nre=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Cre=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},_re=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},jre=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},kre=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},Tre=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},Kj=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),Xj=()=>{var pe,Ce;const{orderId:e}=ra(),n=Dt(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[T,P]=w.useState({}),[R,I]=w.useState(null),[B,F]=w.useState(!1),[L,U]=w.useState(""),[H,K]=w.useState(!1),[M,$]=w.useState(""),z=w.useCallback(async Z=>{var ee;try{const X=await me(`/api/patients/${Z}`);if(!X.ok)throw new Error(`Failed to fetch patient details: ${X.status}`);const ye=await X.json();v(ye.age),k(((ee=ye.sex)==null?void 0:ee.toLowerCase())==="female"?"female":"male"),ye.phone&&r(He=>He?{...He,Patient:{...He.Patient,phone:ye.phone}}:null)}catch(X){console.error("Error fetching patient details:",X),v(null),k(null)}},[]),W=w.useCallback(async()=>{if(e){d(!0),g(null);try{const Z=await me(`/api/lab/${e}`);if(!Z.ok){const ye=await Z.json().catch(()=>({message:`HTTP error! status: ${Z.status}`}));throw new Error(ye.message||`HTTP error! status: ${Z.status}`)}const ee=await Z.json();if(r(ee),ee.createdAt)try{const ye=new Date(ee.createdAt),He=new Date(ye.getTime()-ye.getTimezoneOffset()*6e4).toISOString().slice(0,16);U(He)}catch(ye){console.error("Error formatting date for edit:",ye)}if(ee.report_date)try{const ye=new Date(ee.report_date),He=new Date(ye.getTime()-ye.getTimezoneOffset()*6e4).toISOString().slice(0,16);$(He)}catch(ye){console.error("Error formatting report date for edit:",ye)}else{const ye=new Date,He=new Date(ye.getTime()-ye.getTimezoneOffset()*6e4).toISOString().slice(0,16);$(He)}ee.patient_id&&z(ee.patient_id);const X={};if(ee.tests&&ee.tests.forEach(ye=>{X[ye.id]={},ye.default_parameters&&ye.default_parameters.length>0?ye.default_parameters.forEach(He=>{X[ye.id][He.name]=He.defaultValue}):X[ye.id].report_content=""}),ee.report_content)try{const ye=JSON.parse(ee.report_content);typeof ye=="object"&&ye!==null&&!Array.isArray(ye)?o(ye):(console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),o(X))}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),o(X)}else o({})}catch(Z){console.error("Failed to fetch lab order details:",Z),g(Z instanceof Error?Z.message:"An unknown error occurred while fetching order details.")}finally{d(!1)}}},[e,z]);w.useEffect(()=>{e?W():(g("No Order ID provided in the URL."),d(!1))},[e,W]);const te=(Z,ee,X)=>{o(ye=>{var q,de,be,$e,nt,ht,wt,Et,ve,ke,Ne,Oe,Ve,Ze,jt,Nt,mt,an,Ln;const He={...ye,[Z]:{...ye[Z],[ee]:X}},he=parseFloat((q=He[Z])==null?void 0:q.Creatinine),Le=b,ue=S;if(ee==="Creatinine"&&!isNaN(he)&&Le!==null&&ue!==null){const Vt=Nre(he,Le,ue);Vt!==null&&((de=t==null?void 0:t.tests.find(xt=>xt.id===Z))!=null&&de.default_parameters.find(xt=>xt.name==="eGFR"))&&(He[Z].eGFR=Vt)}const De=parseFloat((be=He[Z])==null?void 0:be["Total Cholesterol"]),Ye=parseFloat(($e=He[Z])==null?void 0:$e["HDL Cholesterol"]),et=parseFloat((nt=He[Z])==null?void 0:nt.Triglycerides);if((ee==="Total Cholesterol"||ee==="HDL Cholesterol"||ee==="Triglycerides")&&!isNaN(De)&&!isNaN(Ye)&&!isNaN(et)){const Vt=Cre(De,Ye,et);Vt!==null&&((ht=t==null?void 0:t.tests.find(xt=>xt.id===Z))!=null&&ht.default_parameters.find(xt=>xt.name==="LDL Cholesterol"))&&(He[Z]["LDL Cholesterol"]=Vt)}const Ke=parseFloat((wt=He[Z])==null?void 0:wt["Total Bilirubin"]),it=parseFloat((Et=He[Z])==null?void 0:Et["Direct Bilirubin"]);if((ee==="Total Bilirubin"||ee==="Direct Bilirubin")&&!isNaN(Ke)&&!isNaN(it)){const Vt=_re(Ke,it);Vt!==null&&((ve=t==null?void 0:t.tests.find(xt=>xt.id===Z))!=null&&ve.default_parameters.find(xt=>xt.name==="Indirect Bilirubin"))&&(He[Z]["Indirect Bilirubin"]=Vt)}const ot=parseFloat((ke=He[Z])==null?void 0:ke["Total Protein"]),vt=parseFloat((Ne=He[Z])==null?void 0:Ne.Albumin);if((ee==="Total Protein"||ee==="Albumin")&&!isNaN(ot)&&!isNaN(vt)){const Vt=jre(ot,vt);Vt!==null&&((Oe=t==null?void 0:t.tests.find(xt=>xt.id===Z))!=null&&Oe.default_parameters.find(xt=>xt.name==="Globulin"))&&(He[Z].Globulin=Vt)}const Ee=parseFloat((Ve=He[Z])==null?void 0:Ve.Sodium),Je=parseFloat((Ze=He[Z])==null?void 0:Ze.Chloride),Ae=parseFloat((jt=He[Z])==null?void 0:jt.Bicarbonate);if((ee==="Sodium"||ee==="Chloride"||ee==="Bicarbonate")&&!isNaN(Ee)&&!isNaN(Je)&&!isNaN(Ae)){const Vt=kre(Ee,Je,Ae);Vt!==null&&((Nt=t==null?void 0:t.tests.find(xt=>xt.id===Z))!=null&&Nt.default_parameters.find(xt=>xt.name==="Anion Gap"))&&(He[Z]["Anion Gap"]=Vt)}const _e=parseFloat((mt=He[Z])==null?void 0:mt.Glucose),le=parseFloat((an=He[Z])==null?void 0:an.BUN);if((ee==="Sodium"||ee==="Glucose"||ee==="BUN")&&!isNaN(Ee)&&!isNaN(_e)&&!isNaN(le)){const Vt=Tre(Ee,_e,le);Vt!==null&&((Ln=t==null?void 0:t.tests.find(xt=>xt.id===Z))!=null&&Ln.default_parameters.find(xt=>xt.name==="Osmolality"))&&(He[Z].Osmolality=Vt)}return He})},V=async Z=>{const ee=a[Z]||{},X=t==null?void 0:t.tests.find(Le=>Le.id===Z);if(!X)return;const ye={};X.default_parameters&&X.default_parameters.forEach(Le=>{ye[Le.name]=Le.defaultValue});const He={...ye,...ee},he={...a,[Z]:He};o(he),u(!0),g(null);try{const Le=await me(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(he),isPartial:!0})});if(!Le.ok)throw new Error(`Save failed: ${Le.status}`);alert(`Report for ${X.name} saved successfully!`)}catch(Le){console.error("Error saving test report:",Le),alert("Failed to save test report.")}finally{u(!1)}},G=(Z=null)=>{I(Z),setTimeout(()=>{window.print()},100)},J=()=>{t&&fS(t)},oe=async()=>{if(!t||!t.tests){alert("Order details not loaded.");return}if(!e){alert("Cannot submit report without an Order ID.");return}const Z={};if(t.tests.forEach(ee=>{const X=a[ee.id]||{},ye={};ee.default_parameters&&ee.default_parameters.forEach(He=>{He.defaultValue!==void 0&&He.defaultValue!==null&&(ye[He.name]=He.defaultValue)}),Z[ee.id]={...ye,...X},(!ee.default_parameters||ee.default_parameters.length===0)&&!Z[ee.id].report_content&&(Z[ee.id].report_content="")}),Object.keys(Z).length===0){alert("Report content cannot be empty.");return}o(Z),u(!0),g(null);try{const ee=await me(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Z)})});if(!ee.ok){const X=await ee.json().catch(()=>({message:`Submission failed: ${ee.status}`}));throw new Error(X.message||`Submission failed: ${ee.status}`)}alert("Report submitted successfully!"),n(-1)}catch(ee){console.error("Error submitting report:",ee),g(ee instanceof Error?ee.message:"An unknown error occurred during submission.")}finally{u(!1)}},ie=async()=>{if(!(!e||!L))try{const Z=await me(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:new Date(L).toISOString()})});if(!Z.ok)throw new Error("Failed to update date");const ee=await Z.json();ee.order&&r(X=>X?{...X,createdAt:ee.order.createdAt}:null),F(!1)}catch(Z){console.error("Failed to update date:",Z),alert("Failed to update date")}},E=async()=>{if(!(!e||!M))try{const Z=await me(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportDate:new Date(M).toISOString()})});if(!Z.ok)throw new Error("Failed to update report date");const ee=await Z.json();ee.order&&r(X=>X?{...X,report_date:ee.order.report_date}:null),K(!1)}catch(Z){console.error("Failed to update report date:",Z),alert("Failed to update report date")}};if(l)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(mo,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(h&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Ar,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:h}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(cn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(ml,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(cn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const ce=(pe=t==null?void 0:t.Patient)==null?void 0:pe.name,ge=(Ce=t==null?void 0:t.Patient)==null?void 0:Ce.patient_token_number;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Enter Lab Report"})," ",i.jsxs("button",{onClick:()=>n(e?"/lab":-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:f,children:[i.jsx(cn,{size:16,style:{marginRight:"5px"}}),e?"Back to Lab Panel":"Back"]}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginLeft:"10px"},children:[i.jsxs("button",{onClick:()=>G(null),className:"lab-inventory-button",title:"Print Full Report",children:[i.jsx(hl,{size:16,style:{marginRight:"5px"}})," Print All"]}),i.jsxs("button",{onClick:J,className:"lab-inventory-button",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},title:"Share via WhatsApp",children:[i.jsx(Wk,{size:16,style:{marginRight:"5px"}})," WhatsApp"]})]})]}),t&&i.jsxs("div",{className:"lab-inventory-card no-print",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(ml,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(Ts,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",ce??"N/A"," (Token: ",ge??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(ZN,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",B?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:L,onChange:Z=>U(Z.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:ie,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Date",children:i.jsx(ib,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if(F(!1),t.createdAt){const Z=new Date(t.createdAt),ee=new Date(Z.getTime()-Z.getTimezoneOffset()*6e4).toISOString().slice(0,16);U(ee)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(Sn,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[Yd(new Date(t.createdAt),"PPpp"),i.jsx("button",{onClick:()=>F(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Date",children:i.jsx(a0,{size:14})})]})]}),i.jsxs("div",{children:[i.jsx(ZN,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Report Date:"})," ",H?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:M,onChange:Z=>$(Z.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Report Date",children:i.jsx(ib,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if(K(!1),t.report_date){const Z=new Date(t.report_date),ee=new Date(Z.getTime()-Z.getTimezoneOffset()*6e4).toISOString().slice(0,16);$(ee)}else{const Z=new Date,ee=new Date(Z.getTime()-Z.getTimezoneOffset()*6e4).toISOString().slice(0,16);$(ee)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(Sn,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[t.report_date?Yd(new Date(t.report_date),"PPpp"):"Not Reported",i.jsx("button",{onClick:()=>K(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Report Date",children:i.jsx(a0,{size:14})})]})]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(A6,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(Z=>Z.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:Are(t.status),children:Ere(t.status)})]})]})]}),i.jsxs("div",{className:"lab-inventory-form-group no-print",style:{marginTop:"20px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:"Report Parameters"}),t==null?void 0:t.tests.map(Z=>{var ee;return i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",margin:0},children:Z.name}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsxs("button",{type:"button",onClick:X=>{X.stopPropagation(),V(Z.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em"},disabled:f,children:[i.jsx(Jd,{size:14,style:{marginRight:"4px"}})," Save"]}),i.jsx("button",{type:"button",onClick:X=>{X.stopPropagation(),G(Z.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em",marginLeft:"5px"},title:"Print This Test Only",children:i.jsx(hl,{size:14})})]})]}),i.jsx("div",{className:"test-parameters-body",style:{display:"block"},children:Z.default_parameters&&Z.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{className:"lab-inventory-table",style:{marginTop:"10px",width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9fafb"},children:[i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Parameter"}),i.jsx("th",{style:{width:"35%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Result"}),i.jsx("th",{style:{width:"15%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Units"}),i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Normal Range"})]})}),i.jsx("tbody",{children:Z.default_parameters.map(X=>{var ye,He,he,Le,ue,De,Ye;return i.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#374151",fontWeight:"500"},children:i.jsx("label",{htmlFor:`${Z.id}-${X.name}`,style:{cursor:"pointer"},children:X.name})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle"},children:X.type==="boolean"?i.jsxs("select",{id:`${Z.id}-${X.name}`,value:((He=(ye=a[Z.id])==null?void 0:ye[X.name])==null?void 0:He.toString())??"false",onChange:et=>te(Z.id,X.name,et.target.value==="true"),className:"lab-inventory-input",disabled:f,style:{margin:0,width:"100%"},children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-Reactive"})]}):i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{id:`${Z.id}-${X.name}`,type:X.type==="number"?"number":"text",value:(()=>{var Ke,it;const et=((Ke=a[Z.id])==null?void 0:Ke[X.name])!==void 0?(it=a[Z.id])==null?void 0:it[X.name]:X.defaultValue??"";return et===0||et==="0"?"":et})(),onChange:et=>{const Ke=X.type==="number"&&et.target.value===""?"":et.target.value;te(Z.id,X.name,Ke)},className:`lab-inventory-input ${X.type==="number"&&((he=a[Z.id])==null?void 0:he[X.name])!==""&&(X.lower_limit!=null&&parseFloat((Le=a[Z.id])==null?void 0:Le[X.name])<X.lower_limit||X.upper_limit!=null&&parseFloat((ue=a[Z.id])==null?void 0:ue[X.name])>X.upper_limit)?"abnormal-result":""}`,disabled:f||Kj(X.name)&&!((De=T[Z.id])!=null&&De[X.name]),style:{margin:0,width:"100%"}}),Kj(X.name)&&i.jsx("button",{type:"button",onClick:()=>P(et=>{var Ke;return{...et,[Z.id]:{...et[Z.id]||{},[X.name]:!((Ke=et[Z.id])!=null&&Ke[X.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.7em",padding:"4px 6px",height:"fit-content",whiteSpace:"nowrap"},disabled:f,title:(Ye=T[Z.id])!=null&&Ye[X.name]?"Disable Manual Edit":"Edit Calculated Field",children:i.jsx(a0,{size:12})})]})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280"},children:X.unit||"-"}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280",fontSize:"0.9em"},children:X.type==="number"&&(X.lower_limit!==null||X.upper_limit!==null)?i.jsxs(i.Fragment,{children:[X.lower_limit!==null&&X.lower_limit!==void 0&&`> ${X.lower_limit}`,X.lower_limit!==null&&X.lower_limit!==void 0&&X.upper_limit!==null&&X.upper_limit!==void 0&&" - ",X.upper_limit!==null&&X.upper_limit!==void 0&&`< ${X.upper_limit}`]}):"-"})]},X.name)})})]})})}):i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:`${Z.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${Z.id}-report_content`,value:((ee=a[Z.id])==null?void 0:ee.report_content)??"",onChange:X=>te(Z.id,"report_content",X.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${Z.name}...`,disabled:f})]})})]},Z.id)}),h&&i.jsxs("p",{className:"error-text",style:{marginTop:"10px"},children:[i.jsx(Ar,{size:15,className:"inline mr-1"}),h]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:f,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:oe,disabled:f,className:"lab-inventory-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(mo,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Jd,{size:16,style:{marginRight:"5px"}})," Submit Full Report"]})})]}),i.jsxs("div",{className:"printable-only",children:[t&&t.Patient&&i.jsxs("div",{style:{marginBottom:"20px",borderBottom:"1px solid #ccc",paddingBottom:"10px"},children:[i.jsx("h2",{style:{textAlign:"center",marginBottom:"15px"},children:"Lab Report"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"12px"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Patient Name:"})," ",t.Patient.name]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age/Sex:"})," ",b??"N/A"," / ",S??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Ref. Doctor:"})," ",t.uploaded_by||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Date:"})," ",Yd(new Date,"PPpp")]})]})]}),t==null?void 0:t.tests.filter(Z=>R===null||Z.id===R).map(Z=>{var ee;return i.jsxs("div",{style:{marginBottom:"20px",pageBreakInside:"avoid"},children:[i.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"5px"},children:Z.name}),Z.default_parameters&&Z.default_parameters.length>0?i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9f9f9"},children:[i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Parameter"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Result"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Units"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Normal Range"})]})}),i.jsx("tbody",{children:Z.default_parameters.map(X=>{var De;const ye=(De=a[Z.id])==null?void 0:De[X.name],He=typeof ye=="string"?parseFloat(ye):typeof ye=="number"?ye:NaN,he=X.type==="number"&&!isNaN(He)&&ye!==""&&(X.lower_limit!=null&&He<X.lower_limit||X.upper_limit!=null&&He>X.upper_limit),Le=X.type==="boolean"&&(ye===!0||ye==="true"),ue=X.type==="boolean"?ye===!0||ye==="true"?"Reactive":"Non-Reactive":ye??"";return i.jsxs("tr",{children:[i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:X.name}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee",fontWeight:he||Le?"bold":"normal",color:he?"red":Le?"green":"inherit"},children:ue}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:X.unit??""}),i.jsxs("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:[X.lower_limit!==null&&X.lower_limit!==void 0&&`> ${X.lower_limit}`,X.lower_limit!==null&&X.lower_limit!==void 0&&X.upper_limit!==null&&X.upper_limit!==void 0&&" - ",X.upper_limit!==null&&X.upper_limit!==void 0&&`< ${X.upper_limit}`]})]},X.name)})})]}):i.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:"12px",padding:"10px"},children:((ee=a[Z.id])==null?void 0:ee.report_content)||"No report content entered."})]},Z.id)})]})]})})},Ere=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",Are=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},Pre=()=>{const{orderId:e}=ra(),n=Dt(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=w.useCallback(async h=>{if(!h){d("No Order ID specified in the URL."),o(!1),r(null);return}o(!0),d(null),r(null);try{console.log(`Fetching order details for ID: ${h}`);const g=await me(`/api/lab/orders/${h}/report`);if(!g.ok){let v;try{v=await g.json()}catch{v={message:`Server returned status ${g.status}`}}throw console.error("Fetch order details error response:",v),new Error(v.message||`Failed to fetch order details: ${g.status}`)}const b=await g.json();if(console.log("Received order data:",b),!b)throw console.error("Invalid order data structure:",b),new Error("Invalid order data received from server.");r(b)}catch(g){console.error("Error fetching order details:",g),d(g instanceof Error?g.message:"An unknown error occurred while fetching the order details")}finally{o(!1)}},[me]);w.useEffect(()=>{f(e)},[e,f]);const u=()=>{t&&fS(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(ks,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(Pr,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(cn,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(hl,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:u,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(Wk,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(Ar,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:l}),e&&i.jsx("button",{onClick:()=>f(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Ts,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(fo,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const h=JSON.parse(t.report_content||"{}");return typeof h=="object"&&h!==null&&t.tests?t.tests.map(g=>i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em"},children:g.name}),h[g.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(h[g.id]).map(([b,v])=>{var I;const S=(I=g.default_parameters)==null?void 0:I.find(B=>B.name===b),k=typeof v=="string"?parseFloat(v):typeof v=="number"?v:NaN,T=(S==null?void 0:S.type)==="number"&&!isNaN(k)&&(S.lower_limit!=null&&k<S.lower_limit||S.upper_limit!=null&&k>S.upper_limit),P=(S==null?void 0:S.type)==="boolean"?v===!0||v==="true"?"Reactive":"Non-Reactive":String(v),R=(S==null?void 0:S.type)==="boolean"&&(v===!0||v==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:b}),i.jsxs("td",{className:`${T?"abnormal-result":""} ${R?"reactive-result":""}`,children:[P," ",S==null?void 0:S.unit]}),i.jsx("td",{children:S&&S.type==="number"&&(S.lower_limit!==null||S.upper_limit!==null)?i.jsxs(i.Fragment,{children:[S.lower_limit!=null&&` > ${S.lower_limit}`,S.lower_limit!=null&&S.upper_limit!=null&&" - ",S.upper_limit!=null&&` < ${S.upper_limit}`,S.unit&&` ${S.unit}`]}):((S==null?void 0:S.type)==="boolean","N/A")})]},b)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},g.id)):i.jsx(Wa,{remarkPlugins:[Li],children:t.report_content})}catch{return i.jsx(Wa,{remarkPlugins:[Li],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(ks,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},Dre=()=>{const e=Dt(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[o,l]=w.useState([]),[d,f]=w.useState(null),[u,h]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{h(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[u]);const g=async()=>{const k=n.trim();if(!k){l([]),f(null);return}a(!0),f(null),l([]),console.log(`Searching for: ${k}`);try{const T=await me("/api/lab");if(!T.ok){let L;try{L=await T.json()}catch{L={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",L),new Error(L.message||`HTTP error! status: ${T.status}`)}const{orders:P}=await T.json();console.log("Received lab orders for search:",P);const I=P.filter(L=>!!L.report_content).map(L=>{var U,H;return{id:L.id,labTokenNumber:String(L.lab_token_number??"N/A"),patientName:((U=L.Patient)==null?void 0:U.name)||"N/A",patientId:L.patient_id,patientTokenNumber:String(((H=L.Patient)==null?void 0:H.patient_token_number)??"N/A"),tests:(L.tests||[]).map(K=>K.name||"Unknown Test"),date:Yd(new Date(L.createdAt),"yyyy-MM-dd"),status:L.status}}),B=n.toLowerCase(),F=I.filter(L=>{var K,M,$,z,W;const U=String(L.labTokenNumber).toLowerCase(),H=String(L.patientTokenNumber).toLowerCase();return(((K=L.patientName)==null?void 0:K.toLowerCase())||"").includes(B)||U.includes(B)||H.includes(B)||((($=(M=L.tests)==null?void 0:M.join(" "))==null?void 0:$.toLowerCase())||"").includes(B)||(((z=L.id)==null?void 0:z.toLowerCase())||"").includes(B)||(((W=L.patientId)==null?void 0:W.toLowerCase())||"").includes(B)});console.log("Filtered search results:",F),l(F),F.length===0&&k?f(`No matching reports found for "${k}".`):f(null)}catch(T){console.error("Failed to search lab reports:",T),f(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(cn,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(Pr,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),d&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(Ar,{size:20,className:"inline mr-2"})," ",d]}),o.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:o.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(s6,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:S(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(fo,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(kF,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(Y3,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&o.length===0&&!d&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&o.length===0&&!d&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},Ire=()=>{const{patientId:e}=ra(),n=Dt(),[t,r]=w.useState([]),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID is missing from the URL."),o(!1);return}o(!0),d(null),r([]),g(null);try{const S=await me(`/api/patients/${e}`);if(S.ok){const P=await S.json();g(P.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await me(`/api/lab/patient/${e}`);if(!k.ok){const P=await k.json().catch(()=>({}));throw new Error(P.message||`HTTP error! status: ${k.status}`)}const T=await k.json();r(T||[])}catch(S){console.error("Error fetching data:",S),d(`Failed to load data: ${S.message}`)}finally{o(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",h?`for ${h}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await me("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(Qa,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(cn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(mo,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(AF,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:l})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(fo,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(ks,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):f?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",f.report_date?Yd(new Date(f.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>u(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(cn,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(f.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(Wa,{remarkPlugins:[Li],children:f.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(fo,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Yd(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:Mre(v.status),children:Rre(v.status)}),i.jsx(Zh,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},Rre=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},Mre=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},qA=()=>{const e=Dt(),[n]=uI(),t=n.get("search")||"",[r,a]=w.useState("pharmacy");return i.jsxs("div",{className:"inventory-management-container",style:{padding:"20px",backgroundColor:"var(--background-color)",minHeight:"100vh"},children:[i.jsxs("div",{className:"inventory-header",style:{marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)"},children:i.jsx(cn,{size:24})}),i.jsx("h1",{style:{margin:0,fontSize:"1.8rem",fontWeight:"700",color:"var(--text-primary)"},children:"Inventory Management"})]}),i.jsxs("div",{className:"inventory-tabs",style:{display:"flex",gap:"5px",backgroundColor:"var(--card-bg, #f3f4f6)",padding:"5px",borderRadius:"12px",border:"1px solid var(--border-color, #e5e7eb)"},children:[i.jsxs("button",{onClick:()=>a("pharmacy"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:r==="pharmacy"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:r==="pharmacy"?"var(--card-bg-active, #fff)":"transparent",boxShadow:r==="pharmacy"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:r==="pharmacy"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:r==="pharmacy"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(Qd,{size:18}),"Pharmacy Stock"]}),i.jsxs("button",{onClick:()=>a("lab"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:r==="lab"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:r==="lab"?"var(--card-bg-active, #fff)":"transparent",boxShadow:r==="lab"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:r==="lab"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:r==="lab"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(po,{size:18}),"Lab Stock"]})]})]}),i.jsx("div",{className:"inventory-content",style:{backgroundColor:"var(--card-bg, #fff)",borderRadius:"16px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden"},children:r==="pharmacy"?i.jsx(FE,{isEmbedded:!0,initialSearch:t}):i.jsx(dS,{isEmbedded:!0})})]})},Ore=({fetchWithAuth:e})=>{const n=Dt(),[t,r]=w.useState(!0),[a,o]=w.useState([]),[l,d]=w.useState(null),[f,u]=w.useState(null),h=w.useCallback(async()=>{r(!0),d(null);try{const S=await(await e("/staff")).json();o(S.map(k=>({...k,id:k._id||k.id})))}catch(v){d(`Failed to load staff data: ${v.message}`),o([])}finally{r(!1)}},[e]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{if(f){const v=setTimeout(()=>u(null),5e3);return()=>clearTimeout(v)}},[f]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return i.jsx(Qk,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return i.jsx(Dw,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return i.jsx(Qd,{size:16,className:"mr-2 text-purple-600"});case"lab":return i.jsx(po,{size:16,className:"mr-2 text-yellow-600"});case"admin":return i.jsx(Ob,{size:16,className:"mr-2 text-teal-600"});default:return i.jsx(ep,{size:16,className:"mr-2 text-gray-500"})}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",i.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[f&&i.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${f.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[f.type==="success"?i.jsx(Ca,{size:18,className:"mr-2"}):i.jsx(Ar,{size:18,className:"mr-2"}),i.jsx("span",{children:f.message}),i.jsx("button",{onClick:()=>u(null),className:"ml-auto text-xl font-bold",children:""})]}),l&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),l,i.jsx("button",{onClick:()=>d(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(cn,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[i.jsx(_s,{size:16,className:"mr-2"})," Add New Staff"]})]}),i.jsx("div",{className:"staff-table-container",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),i.jsx("th",{className:"hidden md:table-cell",children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:a.length===0&&!t?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>i.jsxs("tr",{children:[i.jsx("td",{children:v.name}),i.jsx("td",{className:"hidden md:table-cell",children:v.email}),i.jsx("td",{children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),i.jsx("td",{className:"hidden md:table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"actions",children:i.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[i.jsx(yl,{size:16})," Edit"]})})]},v.id))})]})})]})},Lre=()=>{var k,T,P,R,I,B,F,L,U,H,K,M,$,z;const{patientId:e,billId:n}=ra(),t=Dt(),[r,a]=w.useState(null),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,h]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),f(null);try{const te=await me(`/api/bills/${n}`);if(!te.ok)throw new Error(`HTTP error! status: ${te.status}`);const V=await te.json();if(!V||!V.bill||!V.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(V.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",V.bill.type),new Error(`Unexpected bill type received: ${V.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(V,null,2));const G=Array.isArray(V.admissionPayments)?V.admissionPayments:[];console.log("Processed admissionPaymentsData:",G);const J={...V.bill,amount:V.bill.amount,AdmissionPayments:G,calculated:V.calculated,patient:V.bill.Patient?{id:V.bill.Patient.id,name:V.bill.Patient.name,admission_date:V.bill.Patient.admission_date,discharge_date:V.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(J,null,2)),a(J)}catch(te){console.error("Failed to fetch admission bill details:",te),f(te instanceof Error?te.message:"An unknown error occurred")}finally{l(!1)}})():(f("Bill ID is missing."),l(!1))},[n,e]);const S=async W=>{var te;if(W.preventDefault(),!e||!u||isNaN(parseFloat(u))||parseFloat(u)<=0||parseFloat(u)>(((te=r==null?void 0:r.calculated)==null?void 0:te.balance)??0)){f("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}f(null);try{const V=await me(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(u),payment_mode:g})});if(!V.ok){const oe=await V.json();throw new Error(oe.message||`HTTP error! status: ${V.status}`)}const J=await(await me(`/api/bills/${n}`)).json();if(J&&J.bill&&J.calculated&&J.admissionPayments)a({...J.bill,amount:parseFloat(J.bill.amount),AdmissionPayments:J.admissionPayments,calculated:J.calculated,patient:J.bill.Patient?{id:J.bill.Patient.id,name:J.bill.Patient.name,admission_date:J.bill.Patient.admission_date,discharge_date:J.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");h("")}catch(V){console.error("Failed to submit payment:",V),f(V instanceof Error?V.message:"Failed to record payment")}};return o?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):d?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",d]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=r.patient)==null?void 0:T.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(P=r.patient)!=null&&P.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((R=r.patient)==null?void 0:R.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((I=r.status)==null?void 0:I.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((B=r==null?void 0:r.calculated)==null?void 0:B.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number((F=r==null?void 0:r.calculated)==null?void 0:F.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number((L=r==null?void 0:r.calculated)==null?void 0:L.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((U=r==null?void 0:r.calculated)==null?void 0:U.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((H=r==null?void 0:r.calculated)==null?void 0:H.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:u,onChange:W=>h(W.target.value),placeholder:`Max ${(Number((K=r==null?void 0:r.calculated)==null?void 0:K.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((M=r==null?void 0:r.calculated)==null?void 0:M.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:W=>b(W.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:o||!u||parseFloat(u)<=0||parseFloat(u)>(Number(($=r==null?void 0:r.calculated)==null?void 0:$.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(z=r==null?void 0:r.AdmissionPayments)==null?void 0:z.map(W=>{if(!W||typeof W!="object")return null;let te="Invalid Date";try{W.payment_date&&!isNaN(new Date(W.payment_date).getTime())&&(te=new Date(W.payment_date).toLocaleString())}catch(V){console.error("Error formatting payment date:",W.payment_date,V)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(W.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:W.payment_mode??"N/A"})]},W.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var Fre=Object.defineProperty,_b=Object.getOwnPropertySymbols,VA=Object.prototype.hasOwnProperty,HA=Object.prototype.propertyIsEnumerable,Zj=(e,n,t)=>n in e?Fre(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,mw=(e,n)=>{for(var t in n||(n={}))VA.call(n,t)&&Zj(e,t,n[t]);if(_b)for(var t of _b(n))HA.call(n,t)&&Zj(e,t,n[t]);return e},gw=(e,n)=>{var t={};for(var r in e)VA.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&_b)for(var r of _b(e))n.indexOf(r)<0&&HA.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var ef;(e=>{const n=class wn{constructor(f,u,h,g){if(this.version=f,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],f<wn.MIN_VERSION||f>wn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(h);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<S&&(g=k,S=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,u){const h=e.QrSegment.makeSegments(f);return wn.encodeSegments(h,u)}static encodeBinary(f,u){const h=e.QrSegment.makeBytes(f);return wn.encodeSegments([h],u)}static encodeSegments(f,u,h=1,g=40,b=-1,v=!0){if(!(wn.MIN_VERSION<=h&&h<=g&&g<=wn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=h;;S++){const I=wn.getNumDataCodewords(S,u)*8,B=l.getTotalBits(f,S);if(B<=I){k=B;break}if(S>=g)throw new RangeError("Data too long")}for(const I of[wn.Ecc.MEDIUM,wn.Ecc.QUARTILE,wn.Ecc.HIGH])v&&k<=wn.getNumDataCodewords(S,I)*8&&(u=I);let T=[];for(const I of f){t(I.mode.modeBits,4,T),t(I.numChars,I.mode.numCharCountBits(S),T);for(const B of I.getData())T.push(B)}a(T.length==k);const P=wn.getNumDataCodewords(S,u)*8;a(T.length<=P),t(0,Math.min(4,P-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let I=236;T.length<P;I^=253)t(I,8,T);let R=[];for(;R.length*8<T.length;)R.push(0);return T.forEach((I,B)=>R[B>>>3]|=I<<7-(B&7)),new wn(S,u,R,b)}getModule(f,u){return 0<=f&&f<this.size&&0<=u&&u<this.size&&this.modules[u][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),u=f.length;for(let h=0;h<u;h++)for(let g=0;g<u;g++)h==0&&g==0||h==0&&g==u-1||h==u-1&&g==0||this.drawAlignmentPattern(f[h],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const u=this.errorCorrectionLevel.formatBits<<3|f;let h=u;for(let b=0;b<10;b++)h=h<<1^(h>>>9)*1335;const g=(u<<10|h)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let h=0;h<12;h++)f=f<<1^(f>>>11)*7973;const u=this.version<<12|f;a(u>>>18==0);for(let h=0;h<18;h++){const g=r(u,h),b=this.size-11+h%3,v=Math.floor(h/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(f,u){for(let h=-4;h<=4;h++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(h)),v=f+g,S=u+h;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(f,u){for(let h=-2;h<=2;h++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,u+h,Math.max(Math.abs(g),Math.abs(h))!=1)}setFunctionModule(f,u,h){this.modules[u][f]=h,this.isFunction[u][f]=!0}addEccAndInterleave(f){const u=this.version,h=this.errorCorrectionLevel;if(f.length!=wn.getNumDataCodewords(u,h))throw new RangeError("Invalid argument");const g=wn.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][u],b=wn.ECC_CODEWORDS_PER_BLOCK[h.ordinal][u],v=Math.floor(wn.getNumRawDataModules(u)/8),S=g-v%g,k=Math.floor(v/g);let T=[];const P=wn.reedSolomonComputeDivisor(b);for(let I=0,B=0;I<g;I++){let F=f.slice(B,B+k-b+(I<S?0:1));B+=F.length;const L=wn.reedSolomonComputeRemainder(F,P);I<S&&F.push(0),T.push(F.concat(L))}let R=[];for(let I=0;I<T[0].length;I++)T.forEach((B,F)=>{(I!=k-b||F>=S)&&R.push(B[I])});return a(R.length==v),R}drawCodewords(f){if(f.length!=Math.floor(wn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=h-b,k=(h+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&u<f.length*8&&(this.modules[k][v]=r(f[u>>>3],7-(u&7)),u++)}}a(u==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let h=0;h<this.size;h++){let g;switch(f){case 0:g=(h+u)%2==0;break;case 1:g=u%2==0;break;case 2:g=h%3==0;break;case 3:g=(h+u)%3==0;break;case 4:g=(Math.floor(h/3)+Math.floor(u/2))%2==0;break;case 5:g=h*u%2+h*u%3==0;break;case 6:g=(h*u%2+h*u%3)%2==0;break;case 7:g=((h+u)%2+h*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][h]&&g&&(this.modules[u][h]=!this.modules[u][h])}}getPenaltyScore(){let f=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(S++,S==5?f+=wn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*wn.PENALTY_N3),v=this.modules[b][T],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*wn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(S++,S==5?f+=wn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*wn.PENALTY_N3),v=this.modules[T][b],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*wn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(f+=wn.PENALTY_N2)}let u=0;for(const b of this.modules)u=b.reduce((v,S)=>v+(S?1:0),u);const h=this.size*this.size,g=Math.ceil(Math.abs(u*20-h*10)/h)-1;return a(0<=g&&g<=9),f+=g*wn.PENALTY_N4,a(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let h=[6];for(let g=this.size-7;h.length<f;g-=u)h.splice(1,0,g);return h}}static getNumRawDataModules(f){if(f<wn.MIN_VERSION||f>wn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*f+128)*f+64;if(f>=2){const h=Math.floor(f/7)+2;u-=(25*h-10)*h-55,f>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(f,u){return Math.floor(wn.getNumRawDataModules(f)/8)-wn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][f]*wn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let u=[];for(let g=0;g<f-1;g++)u.push(0);u.push(1);let h=1;for(let g=0;g<f;g++){for(let b=0;b<u.length;b++)u[b]=wn.reedSolomonMultiply(u[b],h),b+1<u.length&&(u[b]^=u[b+1]);h=wn.reedSolomonMultiply(h,2)}return u}static reedSolomonComputeRemainder(f,u){let h=u.map(g=>0);for(const g of f){const b=g^h.shift();h.push(0),u.forEach((v,S)=>h[S]^=wn.reedSolomonMultiply(v,b))}return h}static reedSolomonMultiply(f,u){if(f>>>8||u>>>8)throw new RangeError("Byte out of range");let h=0;for(let g=7;g>=0;g--)h=h<<1^(h>>>7)*285,h^=(u>>>g&1)*f;return a(h>>>8==0),h}finderPenaltyCountPatterns(f){const u=f[1];a(u<=this.size*3);const h=u>0&&f[2]==u&&f[3]==u*3&&f[4]==u&&f[5]==u;return(h&&f[0]>=u*4&&f[6]>=u?1:0)+(h&&f[6]>=u*4&&f[0]>=u?1:0)}finderPenaltyTerminateAndCount(f,u,h){return f&&(this.finderPenaltyAddHistory(u,h),u=0),u+=this.size,this.finderPenaltyAddHistory(u,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(f,u){u[0]==0&&(f+=this.size),u.pop(),u.unshift(f)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(d,f,u){if(f<0||f>31||d>>>f)throw new RangeError("Value out of range");for(let h=f-1;h>=0;h--)u.push(d>>>h&1)}function r(d,f){return(d>>>f&1)!=0}function a(d){if(!d)throw new Error("Assertion error")}const o=class Er{constructor(f,u,h){if(this.mode=f,this.numChars=u,this.bitData=h,u<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(f){let u=[];for(const h of f)t(h,8,u);return new Er(Er.Mode.BYTE,f.length,u)}static makeNumeric(f){if(!Er.isNumeric(f))throw new RangeError("String contains non-numeric characters");let u=[];for(let h=0;h<f.length;){const g=Math.min(f.length-h,3);t(parseInt(f.substring(h,h+g),10),g*3+1,u),h+=g}return new Er(Er.Mode.NUMERIC,f.length,u)}static makeAlphanumeric(f){if(!Er.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],h;for(h=0;h+2<=f.length;h+=2){let g=Er.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h))*45;g+=Er.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h+1)),t(g,11,u)}return h<f.length&&t(Er.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h)),6,u),new Er(Er.Mode.ALPHANUMERIC,f.length,u)}static makeSegments(f){return f==""?[]:Er.isNumeric(f)?[Er.makeNumeric(f)]:Er.isAlphanumeric(f)?[Er.makeAlphanumeric(f)]:[Er.makeBytes(Er.toUtf8ByteArray(f))]}static makeEci(f){let u=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)t(f,8,u);else if(f<16384)t(2,2,u),t(f,14,u);else if(f<1e6)t(6,3,u),t(f,21,u);else throw new RangeError("ECI assignment value out of range");return new Er(Er.Mode.ECI,0,u)}static isNumeric(f){return Er.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return Er.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,u){let h=0;for(const g of f){const b=g.mode.numCharCountBits(u);if(g.numChars>=1<<b)return 1/0;h+=4+b+g.bitData.length}return h}static toUtf8ByteArray(f){f=encodeURI(f);let u=[];for(let h=0;h<f.length;h++)f.charAt(h)!="%"?u.push(f.charCodeAt(h)):(u.push(parseInt(f.substring(h+1,h+3),16)),h+=2);return u}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=o;e.QrSegment=o})(ef||(ef={}));(e=>{(n=>{const t=class{constructor(a,o){this.ordinal=a,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(ef||(ef={}));(e=>{(n=>{const t=class{constructor(a,o){this.modeBits=a,this.numBitsCharCount=o}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(ef||(ef={}));var Oh=ef;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var $re={L:Oh.QrCode.Ecc.LOW,M:Oh.QrCode.Ecc.MEDIUM,Q:Oh.QrCode.Ecc.QUARTILE,H:Oh.QrCode.Ecc.HIGH},GA=128,YA="L",WA="#FFFFFF",QA="#000000",JA=!1,KA=1,zre=4,Bre=0,Ure=.1;function XA(e,n=0){const t=[];return e.forEach(function(r,a){let o=null;r.forEach(function(l,d){if(!l&&o!==null){t.push(`M${o+n} ${a+n}h${d-o}v1H${o+n}z`),o=null;return}if(d===r.length-1){if(!l)return;o===null?t.push(`M${d+n},${a+n} h1v1H${d+n}z`):t.push(`M${o+n},${a+n} h${d+1-o}v1H${o+n}z`);return}l&&o===null&&(o=d)})}),t.join("")}function ZA(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,o)=>o<n.x||o>=n.x+n.w?a:!1))}function qre(e,n,t,r){if(r==null)return null;const a=e.length+t*2,o=Math.floor(n*Ure),l=a/n,d=(r.width||o)*l,f=(r.height||o)*l,u=r.x==null?e.length/2-d/2:r.x*l,h=r.y==null?e.length/2-f/2:r.y*l,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let S=Math.floor(u),k=Math.floor(h),T=Math.ceil(d+u-S),P=Math.ceil(f+h-k);b={x:S,y:k,w:T,h:P}}const v=r.crossOrigin;return{x:u,y:h,h:f,w:d,excavation:b,opacity:g,crossOrigin:v}}function Vre(e,n){return n!=null?Math.max(Math.floor(n),0):e?zre:Bre}function eP({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:o,size:l,boostLevel:d}){let f=Pn.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(...Oh.QrSegment.makeSegments(T)),k),[]);return Oh.QrCode.encodeSegments(S,$re[n],t,void 0,void 0,d)},[e,n,t,d]);const{cells:u,margin:h,numCells:g,calculatedImageSettings:b}=Pn.useMemo(()=>{let v=f.getModules();const S=Vre(r,a),k=v.length+S*2,T=qre(v,l,S,o);return{cells:v,margin:S,numCells:k,calculatedImageSettings:T}},[f,l,o,r,a]);return{qrcode:f,margin:h,cells:u,numCells:g,calculatedImageSettings:b}}var Hre=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Wh=Pn.forwardRef(function(n,t){const r=n,{value:a,size:o=GA,level:l=YA,bgColor:d=WA,fgColor:f=QA,includeMargin:u=JA,minVersion:h=KA,boostLevel:g,marginSize:b,imageSettings:v}=r,k=gw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,P=gw(k,["style"]),R=v==null?void 0:v.src,I=Pn.useRef(null),B=Pn.useRef(null),F=Pn.useCallback(te=>{I.current=te,typeof t=="function"?t(te):t&&(t.current=te)},[t]),[L,U]=Pn.useState(!1),{margin:H,cells:K,numCells:M,calculatedImageSettings:$}=eP({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:u,marginSize:b,imageSettings:v,size:o});Pn.useEffect(()=>{if(I.current!=null){const te=I.current,V=te.getContext("2d");if(!V)return;let G=K;const J=B.current,oe=$!=null&&J!==null&&J.complete&&J.naturalHeight!==0&&J.naturalWidth!==0;oe&&$.excavation!=null&&(G=ZA(K,$.excavation));const ie=window.devicePixelRatio||1;te.height=te.width=o*ie;const E=o/M*ie;V.scale(E,E),V.fillStyle=d,V.fillRect(0,0,M,M),V.fillStyle=f,Hre?V.fill(new Path2D(XA(G,H))):K.forEach(function(ce,ge){ce.forEach(function(D,pe){D&&V.fillRect(pe+H,ge+H,1,1)})}),$&&(V.globalAlpha=$.opacity),oe&&V.drawImage(J,$.x+H,$.y+H,$.w,$.h)}}),Pn.useEffect(()=>{U(!1)},[R]);const z=mw({height:o,width:o},T);let W=null;return R!=null&&(W=Pn.createElement("img",{src:R,key:R,style:{display:"none"},onLoad:()=>{U(!0)},ref:B,crossOrigin:$==null?void 0:$.crossOrigin})),Pn.createElement(Pn.Fragment,null,Pn.createElement("canvas",mw({style:z,height:o,width:o,ref:F,role:"img"},P)),W)});Wh.displayName="QRCodeCanvas";var Gre=Pn.forwardRef(function(n,t){const r=n,{value:a,size:o=GA,level:l=YA,bgColor:d=WA,fgColor:f=QA,includeMargin:u=JA,minVersion:h=KA,boostLevel:g,title:b,marginSize:v,imageSettings:S}=r,k=gw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:P,numCells:R,calculatedImageSettings:I}=eP({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:u,marginSize:v,imageSettings:S,size:o});let B=P,F=null;S!=null&&I!=null&&(I.excavation!=null&&(B=ZA(P,I.excavation)),F=Pn.createElement("image",{href:S.src,height:I.h,width:I.w,x:I.x+T,y:I.y+T,preserveAspectRatio:"none",opacity:I.opacity,crossOrigin:I.crossOrigin}));const L=XA(B,T);return Pn.createElement("svg",mw({height:o,width:o,viewBox:`0 0 ${R} ${R}`,ref:t,role:"img"},k),!!b&&Pn.createElement("title",null,b),Pn.createElement("path",{fill:d,d:`M0,0 h${R}v${R}H0z`,shapeRendering:"crispEdges"}),Pn.createElement("path",{fill:f,d:L,shapeRendering:"crispEdges"}),F)});Gre.displayName="QRCodeSVG";const Yre=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},Wre=()=>{const{orderId:e}=ra(),n=Dt(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[h,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,P]=w.useState("cash"),R=w.useMemo(()=>(t==null?void 0:t.medications.reduce(($,z)=>{const W=z.total_price??0,te=W*(z.discount_percentage??0)/100;return $+W-te},0))??0,[t==null?void 0:t.medications]),I=5,B=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce(($,z,W)=>{var ie,E;const te=z.drug_id??`index-${W}`,V=((ie=h[te])==null?void 0:ie.pack)||0,G=((E=h[te])==null?void 0:E.loose)||0,J=z.pack_price??0,oe=z.loose_price??0;return $+V*J+G*oe},0),[t,h]),F=w.useCallback(async()=>{if(!e){d("Order ID is missing."),o(!1);return}o(!0),d(null);try{const $=await me(`/api/pharmacy-orders/${e}`);if(!$.ok)throw $.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${$.statusText} (${$.status})`);const z=await $.json();console.log("Fetched order data after return:",z);const te=z.medications.map(G=>G.pack_price&&G.loose_price&&G.loose_price>0?{...G,unitsPerPack:Math.round(G.pack_price/G.loose_price)}:{...G,unitsPerPack:0}).map(G=>({...G,discount_percentage:G.discount_percentage??0}));r({...z,medications:te});const V={};te.forEach((G,J)=>{const oe=G.drug_id??`index-${J}`;V[oe]={pack:0,loose:0}}),g(V)}catch($){console.error("Failed to fetch order details:",$),d($.message||"Failed to load order details.")}finally{o(!1)}},[e]);w.useEffect(()=>{F()},[F]),w.useEffect(()=>{(async()=>{try{const z=await me("/api/clinics/settings");if(!z.ok)throw new Error("Failed to fetch clinic settings");const W=await z.json();console.log("Fetched clinic settings:",W),v(W.upi_id||"")}catch(z){console.error("Error fetching clinic settings:",z)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const $=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k($)}else k("")},[t==null?void 0:t.order_total,b]);const L=($,z)=>{r(W=>{if(!W)return null;const te=W.medications.map((G,J)=>(G.drug_id??`index-${J}`)===$?{...G,discount_percentage:isNaN(z)?0:z}:G),V=te.reduce((G,J)=>{const oe=J.total_price??0,ie=oe*(J.discount_percentage??0)/100;return G+oe-ie},0);return{...W,medications:te,order_total:V}})},U=($,z,W)=>{g(te=>{const V=W.unitsPerPack||0,J=W.pack_quantity*V+W.loose_quantity,oe=Math.max(0,Math.min(z,J));let ie=0,E=oe;return V>0&&(ie=Math.floor(oe/V),E=oe%V),{...te,[$]:{pack:ie,loose:E}}})},H=async()=>{const $=t==null?void 0:t.medications.map((z,W)=>{var J,oe;const te=z.drug_id??`index-${W}`,V=((J=h[te])==null?void 0:J.pack)||0,G=((oe=h[te])==null?void 0:oe.loose)||0;return V>0||G>0?{drug_id:z.drug_id,name:z.name,pack_quantity:z.pack_quantity,loose_quantity:z.loose_quantity,returnPackQuantity:V,returnLooseQuantity:G}:null}).filter(z=>z!==null);if(!$||$.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!$){alert("Could not prepare items for return.");return}u(!0),d(null);try{const z=await me(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:$})}),W=await z.json();if(!z.ok)throw new Error(W.message||`Failed to process return: ${z.statusText}`);alert("Return processed successfully! Stock has been updated.");const te={};t==null||t.medications.forEach((V,G)=>{const J=V.drug_id??`index-${G}`;te[J]={pack:0,loose:0}}),g(te),F()}catch(z){console.error("Failed to process return:",z),d(z.message||"An error occurred while processing the return."),alert(`Error processing return: ${z.message||"Unknown error"}`)}finally{u(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(cn,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(cn,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const K=()=>{window.print()},M=Yre(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(cn,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:K,className:"print-button",children:[i.jsx(hl,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${M.text} ${M.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map(($,z)=>{var ie,E,ce,ge,D,pe;const W=$.drug_id??`index-${z}`,te=$.total_price??0,V=te*($.discount_percentage??0)/100,G=te-V,J=((ie=h[W])==null?void 0:ie.pack)||0,oe=((E=h[W])==null?void 0:E.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:$.name}),i.jsx("td",{children:$.pack_quantity??0}),i.jsx("td",{children:((ce=$.pack_price)==null?void 0:ce.toFixed(2))??"N/A"}),i.jsx("td",{children:$.loose_quantity??0}),i.jsx("td",{children:((ge=$.loose_price)==null?void 0:ge.toFixed(2))??"N/A"}),i.jsx("td",{children:((D=$.price)==null?void 0:D.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((pe=$.price)==null?void 0:pe.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:$.discount_percentage??0,onChange:Ce=>L(W,parseFloat(Ce.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[$.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[I.toFixed(1),"%"]}),i.jsx("td",{children:G.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:$.pack_quantity,value:J,onChange:Ce=>{const ee=(parseInt(Ce.target.value,10)||0)*($.unitsPerPack||0)+oe;U(W,ee,$)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:$.loose_quantity+$.pack_quantity*($.unitsPerPack||0)-J*($.unitsPerPack||0),value:oe,onChange:Ce=>{const Z=parseInt(Ce.target.value,10)||0,ee=J*($.unitsPerPack||0)+Z;U(W,ee,$)},className:"return-quantity-input"})})]})]},W)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",R.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",R.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:T,onChange:$=>P($.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Wh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[B>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",B.toFixed(2)]}),i.jsx("button",{onClick:H,disabled:Object.values(h).every($=>$.pack===0&&$.loose===0)||f,className:"process-return-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(j1,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(j1,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},Qre=async()=>{const e=await me("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},Jre=async e=>{const n=await me(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},Kre=async e=>{const n=await me("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},Xre=async(e,n)=>{const t=await me(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},Zre=async e=>{const n=await me(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},eie=async(e,n)=>{const t=await me("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},tie=()=>{const e=Dt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await Qre();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const h=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await Zre(g),f({type:"success",message:"Plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(Ca,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Sn,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(cn,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(_s,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(yl,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(jr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},nie=()=>{const e=Dt(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await Kre(n),f({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(Ca,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Sn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},rie=()=>{const{id:e}=ra(),n=Dt(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const R=await Jre(e);r(R),o({name:R.name,description:R.description||"",price:R.price,period:R.period,interval:R.interval,razorpay_plan_id:R.razorpay_plan_id||"",status:R.status})}catch(R){g(R.message||"Failed to fetch plan details."),v({type:"error",message:R.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const R=setTimeout(()=>v(null),5e3);return()=>clearTimeout(R)}},[b]);const k=R=>{const{name:I,value:B}=R.target;o(F=>({...F,[I]:B}))},T=async R=>{if(R.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await Xre(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const B=I.message||"Failed to update plan.";g(B),v({type:"error",message:B})}finally{d(!1)}},P=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ca,{size:18,className:"mr-2"}):i.jsx(Ar,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Sn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},iie=()=>{const{patientId:e}=ra(),n=Dt(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[T,P]=w.useState(null),R=w.useCallback(async()=>{u(!0),g(null);try{const F=await me(`/api/patients/${e}`);if(!F.ok){const K=await F.json();throw new Error(K.message||"Failed to fetch patient details")}const L=await F.json();r(L);const U=await me("/api/subscriptions");if(!U.ok){const K=await U.json();throw new Error(K.message||"Failed to fetch subscription plans")}const H=await U.json();o(H.filter(K=>K.status==="active"))}catch(F){console.error("Error fetching data:",F),g(`Failed to load data: ${F.message}`)}finally{u(!1)}},[e]);w.useEffect(()=>{e?R():(g("Patient ID is missing."),u(!1))},[e,R]);const I=(F,L)=>{const U=new Date(F),H=L.interval||1;switch(L.period){case"daily":U.setDate(F.getDate()+H);break;case"weekly":U.setDate(F.getDate()+H*7);break;case"monthly":U.setMonth(F.getMonth()+H);break;case"yearly":U.setFullYear(F.getFullYear()+H);break;default:console.warn(`Unknown subscription period: ${L.period}. Defaulting to 1 month.`),U.setMonth(F.getMonth()+1)}return U},B=async()=>{if(!e||!l){P("Please select a subscription plan.");return}const F=a.find(L=>L.id===l);if(!F){P("Selected plan details not found.");return}k(!0),P(null);try{const L=new Date,U=I(L,F);if(b==="manual"){const H={subscription_plan_id:l,subscription_status:"active",subscription_start_date:L.toISOString(),subscription_end_date:U.toISOString(),subscription_payment_method:"manual"},K=await me(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)});if(!K.ok){const M=await K.json();throw new Error(M.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",F);const H=await eie(e,l);if(H&&H.short_url)window.location.href=H.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch(L){console.error("Error starting subscription:",L),P(`Failed to start subscription: ${L.message}`),k(!1)}};return f?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):h?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:h})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(cn,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(cn,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(Ts,{size:28})," ","Start Subscription for ",t.name]}),T&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:T})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map(F=>i.jsxs("div",{className:`subscription-plan-card ${l===F.id?"selected-plan":""}`,onClick:()=>d(F.id),children:[i.jsx("h3",{children:F.name}),i.jsxs("p",{className:"price",children:["",F.price]}),i.jsxs("p",{className:"duration",children:["Every ",F.interval," ",F.period,F.interval>1?"s":""]}),F.description&&i.jsx("p",{children:F.description})]},F.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:B,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(cn,{size:16}),"Back"]})]})},TS=async()=>{const e=await me("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},aie=async e=>{const n=await me(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},sie=async e=>{const n=await me(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},oie=async e=>{const n=await me(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},lie=async e=>{const n=await me("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},cie=async(e,n)=>{const t=await me(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},uie=async e=>{const n=await me(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},die=async e=>{const n=await me("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},fie=async()=>{try{const e=await me("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},hie=async()=>{const e=await me("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()},pie=()=>{const e=Dt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await TS();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const h=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await uie(g),f({type:"success",message:"Clinic plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate clinic plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(Ca,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Sn,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(cn,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(_s,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(yl,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(jr,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},mie=()=>{const e=Dt(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(S):S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await lie(n),f({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(Ca,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Sn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},gie=()=>{const{id:e}=ra(),n=Dt(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const R=await oie(e);r(R),o({name:R.name,description:R.description||"",price:Number(R.price),period:R.period,interval:Number(R.interval),razorpay_plan_id:R.razorpay_plan_id||"",status:R.status})}catch(R){g(R.message||"Failed to fetch clinic plan details."),v({type:"error",message:R.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const R=setTimeout(()=>v(null),5e3);return()=>clearTimeout(R)}},[b]);const k=R=>{const{name:I,value:B,type:F}=R.target;o(L=>({...L,[I]:F==="number"?parseFloat(B):B}))},T=async R=>{if(R.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await cie(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const B=I.message||"Failed to update clinic plan.";g(B),v({type:"error",message:B})}finally{d(!1)}},P=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ca,{size:18,className:"mr-2"}):i.jsx(Ar,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Sn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},yie=()=>{const e=Dt(),[n,t]=w.useState([]),[r,a]=w.useState(""),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,h]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{f(null);try{const T=(await TS()).filter(P=>P.status==="active");t(T),T.length>0&&!r&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),f(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const T=await fie();if(T&&T.short_url){window.location.href=T.short_url,f("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),f(`An unexpected error occurred: ${T.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===r);if(!k){b("Selected plan details not found.");return}h(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await die(r);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),h(!1)}};return o?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):d?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:d})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(cn,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(cn,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(V3,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:S,disabled:!r||u||n.length===0,className:"subscription-btn",children:[u&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),u?"Initiating Payment...":"Buy Pro Plan"]})})]})},xie=()=>{const e=Dt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[P,R]=w.useState(""),[I,B]=w.useState(""),[F,L]=w.useState({}),[U,H]=w.useState(!1),[K,M]=w.useState(null),[$,z]=w.useState([]),[W,te]=w.useState(""),[V,G]=w.useState(!1),[J,oe]=w.useState(null);w.useEffect(()=>{const X=setTimeout(()=>{B(P)},500);return()=>{clearTimeout(X)}},[P]),w.useEffect(()=>{ie(I)},[I]);const ie=async(X="")=>{a(!0);try{const ye=X?`/api/users?search=${encodeURIComponent(X)}`:"/api/users",he=await(await me(ye)).json();if(t(he),he.length>0){const Le=[...new Set(he.map(De=>De.clinic_id).filter(De=>!!De))],ue={};await Promise.all(Le.map(async De=>{try{const Ye=await sie(De);ue[De]=Ye}catch(Ye){console.error(`Failed to fetch subscription status for clinic ${De}`,Ye),ue[De]={hasProPlan:!1}}})),L(ue)}l(null)}catch(ye){l("Failed to fetch users."),console.error(ye)}finally{a(!1)}},E=async X=>{X.preventDefault();try{await me("/users",{method:"POST",body:JSON.stringify(v)}),f(!1),S({name:"",email:"",password:"",role:"user"}),ie()}catch(ye){l("Failed to add user."),console.error(ye)}},ce=async X=>{if(X.preventDefault(),!g)return;const{password:ye,confirmPassword:He,...he}=k,Le={...he};if(ye){if(ye.length<6){l("Password must be at least 6 characters long.");return}if(ye!==He){l("Passwords do not match.");return}Le.password=ye}try{await me(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Le)}),h(!1),b(null),T({...k,password:"",confirmPassword:""}),ie()}catch(ue){l("Failed to update user."),console.error(ue)}},ge=async X=>{if(window.confirm("Are you sure you want to delete this user?"))try{await me(`/users/${X}`,{method:"DELETE"}),ie()}catch(ye){l("Failed to delete user."),console.error(ye)}},D=X=>{b(X),T({name:X.name,email:X.email,role:X.role,password:"",confirmPassword:""}),h(!0)},pe=async()=>{G(!0);try{const X=await TS();z(X),X.length>0&&te(X[0].id),oe(null)}catch(X){oe("Failed to fetch subscription plans."),console.error(X)}finally{G(!1)}},Ce=X=>{M(X),H(!0),pe()},Z=async X=>{if(X.preventDefault(),!K||!W){l("Please select a clinic and a plan.");return}try{await me("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:K,planId:W})}),H(!1),M(null),te(""),ie(),l(null)}catch(ye){l("Failed to manually activate clinic subscription."),console.error(ye)}},ee=async X=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await aie(X),ie(),l(null)}catch(ye){l("Failed to cancel subscription."),console.error(ye)}};return r?i.jsx("div",{children:"Loading users..."}):o?i.jsx("div",{className:"error-message",children:o}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(cn,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:P,onChange:X=>R(X.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>f(!0),className:"add-user-button",children:"Add New User"})]}),d&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>f(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:X=>S({...v,name:X.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:X=>S({...v,email:X.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:X=>S({...v,password:X.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:X=>S({...v,role:X.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),u&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>h(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:ce,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:X=>T({...k,name:X.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:X=>T({...k,email:X.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:X=>T({...k,role:X.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:X=>T({...k,password:X.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:X=>T({...k,confirmPassword:X.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),U&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>H(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),V&&i.jsx("div",{children:"Loading plans..."}),J&&i.jsx("div",{className:"error-message",children:J}),!V&&!J&&$.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!V&&!J&&$.length>0&&i.jsxs("form",{onSubmit:Z,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:W,onChange:X=>te(X.target.value),required:!0,children:$.map(X=>i.jsxs("option",{value:X.id,children:[X.name," - $",X.price,"/",X.interval," ",X.period]},X.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(X=>{const ye=X.clinic_id||"N/A",He=ye!=="N/A"?F[ye]:null,he=(He==null?void 0:He.hasProPlan)??!1,Le=he?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:X.name}),i.jsx("td",{children:X.email}),i.jsx("td",{children:X.role}),i.jsx("td",{children:ye}),i.jsx("td",{children:ye!=="N/A"?i.jsx("span",{className:he?"pro-badge":"standard-badge",children:Le}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>D(X),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>ge(X.id),className:"delete-button",children:"Delete"}),X.clinic_id&&!he&&i.jsx("button",{onClick:()=>Ce(X.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),X.clinic_id&&he&&i.jsx("button",{onClick:()=>ee(X.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},X.id)})})]})]})},bie="_modalOverlay_1spz3_3",vie="_modalContent_1spz3_29",wie="_modalHeader_1spz3_53",Sie="_modalTitle_1spz3_71",Nie="_modalCloseButton_1spz3_83",Cie="_modalBody_1spz3_111",_ie="_formGroup_1spz3_119",jie="_inputField_1spz3_141",kie="_errorText_1spz3_175",Tie="_successText_1spz3_193",Eie="_modalFooter_1spz3_211",Aie="_button_1spz3_227",Pie="_buttonPrimary_1spz3_247",Die="_buttonSecondary_1spz3_265",ta={modalOverlay:bie,modalContent:vie,modalHeader:wie,modalTitle:Sie,modalCloseButton:Nie,modalBody:Cie,formGroup:_ie,inputField:jie,errorText:kie,successText:Tie,modalFooter:Eie,button:Aie,buttonPrimary:Pie,buttonSecondary:Die},Iie=({isOpen:e,onClose:n})=>{const[t,r]=w.useState(""),[a,o]=w.useState(!1),[l,d]=w.useState(!1),[f,u]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{e&&b()},[e]);const b=async()=>{o(!0),u(null);try{const S=await me("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();r(k.value||"")}else S.status}catch(S){console.warn("Could not fetch existing key:",S)}finally{o(!1)}},v=async()=>{d(!0),u(null),g(null);try{if(!(await me("/api/global-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"app_gemini_api_key",value:t})})).ok)throw new Error("Failed to save API Key");g("API Key updated successfully!"),setTimeout(()=>{n(),g(null)},1500)}catch(S){u(S.message||"Error saving key")}finally{d(!1)}};return e?i.jsx("div",{className:ta.modalOverlay,children:i.jsxs("div",{className:ta.modalContent,children:[i.jsxs("div",{className:ta.modalHeader,children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(qk,{size:24}),i.jsx("h3",{className:ta.modalTitle,children:"App Gemini API Key"})]}),i.jsx("button",{onClick:n,className:ta.modalCloseButton,children:i.jsx(Sn,{size:20})})]}),i.jsxs("div",{className:ta.modalBody,children:[f&&i.jsx("div",{className:ta.errorText,children:f}),h&&i.jsx("div",{className:ta.successText,children:h}),i.jsxs("div",{className:ta.formGroup,children:[i.jsx("label",{htmlFor:"gemini-key",children:"Gemini API Key"}),i.jsx("input",{type:"text",id:"gemini-key",value:t,onChange:S=>r(S.target.value),className:ta.inputField,placeholder:"Enter Gemini API Key (AIza...)",disabled:a||l})]}),i.jsx("p",{style:{fontSize:"0.9em",color:"var(--secondary-text-color, #666)"},children:"This key will be used as a fallback for all clinics if their specific Gemini API key is not configured."})]}),i.jsxs("div",{className:ta.modalFooter,children:[i.jsx("button",{onClick:n,className:`${ta.button} ${ta.buttonSecondary}`,disabled:l,children:"Cancel"}),i.jsx("button",{onClick:v,className:`${ta.button} ${ta.buttonPrimary}`,disabled:l,children:l?"Saving...":"Save Key"})]})]})}):null},Rie=()=>{const[e,n]=w.useState(!1);return i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(Ob,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(ks,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(Hh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(ks,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(ep,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),i.jsxs("div",{className:"admin-panel-card",onClick:()=>n(!0),style:{cursor:"pointer"},children:[i.jsx(qk,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage App Gemini API Key"}),i.jsx("p",{children:"Update the fallback Gemini API key used by the application."})]})]}),i.jsx(Iie,{isOpen:e,onClose:()=>n(!1)})]})},c1="tutorialCurrentStep",Mie=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),[o,l]=w.useState(null),d=async()=>{var f,u;t(!0);try{const h=await me("/api/drugs/import-defaults",{method:"POST"}),g=await h.json();if(h.ok){a(!0);const b=((f=g.details)==null?void 0:f.added)||0,v=((u=g.details)==null?void 0:u.updated)||0,S=`Added: ${b}, Updated: ${v}`;l(S),e(!0,"Default medications imported successfully!","pharmacyImport")}else e(!1,"Failed to import medications.")}catch{e(!1,"Error importing medications.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"One click to populate your inventory."}),r?i.jsxs("div",{className:"success-badge flex-col",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ib,{size:16})," Imported"]}),o&&i.jsx("span",{className:"text-xs opacity-80 mt-1",children:o})]}):i.jsx("button",{onClick:d,className:"tutorial-button primary",disabled:n,children:n?i.jsxs(i.Fragment,{children:[i.jsx(mo,{size:18,className:"animate-spin"})," Importing ~80 items..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Aw,{size:18})," Import Drugs"]})})]})},Oie=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),[o,l]=w.useState(null),d=async()=>{var f,u;t(!0);try{const h=await me("/api/lab-tests/import-defaults",{method:"POST"}),g=await h.json();if(h.ok){a(!0);const b=((f=g.details)==null?void 0:f.added)||0,v=((u=g.details)==null?void 0:u.updated)||0,S=`Added: ${b}, Updated: ${v}`;l(S),e(!0,"Default lab tests imported successfully!","labImport")}else e(!1,"Failed to import lab tests.")}catch{e(!1,"Error importing lab tests.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"Setup your lab with common tests."}),r?i.jsxs("div",{className:"success-badge flex-col",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ib,{size:16})," Imported"]}),o&&i.jsx("span",{className:"text-xs opacity-80 mt-1",children:o})]}):i.jsx("button",{onClick:d,className:"tutorial-button primary",disabled:n,children:n?i.jsxs(i.Fragment,{children:[i.jsx(mo,{size:18,className:"animate-spin"})," Importing ~25 items..."]}):i.jsxs(i.Fragment,{children:[i.jsx(po,{size:18})," Import Tests"]})})]})},Lie=({onOpenCommandBar:e})=>i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"Ready to experience the power? Open the command bar to start."}),i.jsx("button",{onClick:e,className:"tutorial-button primary large-button",children:i.jsxs("div",{className:"flex items-center gap-2",children:["Open Command Bar ",i.jsx("span",{className:"shortcut-hint-badge",children:"Ctrl+K"})]})})]}),u1=[{title:"Welcome to Newtons Ai HMS",description:"Your all-in-one clinic management solution. Let's get your clinic ready in less than 2 minutes.",icon:i.jsx(bF,{size:48,className:"step-icon welcome"}),component:null,actionText:"Get Started"},{title:"Pharmacy Setup",description:"Start by populating your pharmacy. We can import a standard list of medicines for you.",icon:i.jsx(Aw,{size:48,className:"step-icon pharmacy"}),component:Mie,actionText:"Next",showSkip:!0},{title:"Lab Configuration",description:"Next, let's set up your lab. Import common lab tests to start generating reports immediately.",icon:i.jsx(po,{size:48,className:"step-icon lab"}),component:Oie,actionText:"Next",showSkip:!0},{title:"Power at Your Fingertips",description:"The Command Bar is your central hub for everything. Search patients, add orders, or use AI tools instantly.",icon:i.jsx($3,{size:48,className:"step-icon ai"}),component:Lie,actionText:null,isLast:!0}],Fie=({onClose:e,onMarkAsSeen:n})=>{const{openCommandBar:t}=Uh(),[r,a]=w.useState(()=>{const T=localStorage.getItem(c1);return T?parseInt(T,10):0}),[o,l]=w.useState(!1),[d,f]=w.useState(null),[u,h]=w.useState(null);w.useEffect(()=>{localStorage.setItem(c1,r.toString()),f(null)},[r]);const g=()=>{l(!0),setTimeout(()=>{a(T=>Math.min(T+1,u1.length-1)),l(!1)},300)},b=(T,P,R)=>{h(T),f(P),T&&(R==="pharmacyImport"||R==="labImport")&&setTimeout(g,1e3)},v=()=>{n(),e(),localStorage.removeItem(c1)},S=()=>{v(),setTimeout(()=>{t()},100)},k=u1[r];return i.jsx("div",{className:"tutorial-overlay",children:i.jsxs("div",{className:`tutorial-card ${o?"fade-out":"fade-in"}`,children:[i.jsxs("div",{className:"tutorial-visual",children:[i.jsx("div",{className:"icon-circle",children:k.icon}),i.jsx("div",{className:"step-indicators",children:u1.map((T,P)=>i.jsx("div",{className:`step-dot ${P===r?"active":""} ${P<r?"completed":""}`},P))})]}),i.jsxs("div",{className:"tutorial-content",children:[i.jsx("button",{className:"close-button",onClick:v,title:"Close Tutorial",children:i.jsx(Sn,{size:20})}),i.jsxs("div",{className:"text-content",children:[i.jsx("h2",{children:k.title}),i.jsx("p",{className:"description",children:k.description})]}),i.jsxs("div",{className:"interactive-area",children:[k.component?i.jsx(k.component,{onActionComplete:b,onOpenCommandBar:S}):null,d&&i.jsx("div",{className:`status-message ${u?"success":"error"}`,children:d})]}),i.jsxs("div",{className:"action-footer",children:[k.showSkip&&i.jsx("button",{onClick:g,className:"tutorial-button text-only",children:"Skip for now"}),k.actionText&&i.jsxs("button",{onClick:g,className:"tutorial-button primary",children:[k.actionText," ",i.jsx(Zh,{size:16})]})]})]})]})})},$ie=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(""),[f,u]=w.useState(1),[h,g]=w.useState(1),[b,v]=w.useState(0),[S,k]=w.useState(!1),[T,P]=w.useState(void 0),R=10,I=w.useRef(null),B=w.useCallback(async($,z)=>{r(!0),o(null);try{let W=`/api/recurring-medications?page=${$}&limit=${R}`;z&&(W+=`&search=${encodeURIComponent(z)}`);const te=await me(W);if(!te.ok)throw new Error("Failed to fetch recurring medications.");const V=await te.json();n(V.medications),g(V.totalPages),v(V.total),u(V.page)}catch(W){console.error(W),o(W.message||"An error occurred while fetching data.")}finally{r(!1)}},[]);w.useEffect(()=>(I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{B(f,l)},500),()=>{I.current&&clearTimeout(I.current)}),[l,f,B]);const F=$=>{d($.target.value),u(1)},L=$=>{$>=1&&$<=h&&u($)},U=$=>{P($),k(!0)},H=()=>{B(f,l),k(!1),P(void 0)},K=$=>$===30?"Every 30 Days (Monthly)":$===15?"Every 15 Days":`Every ${$} Days`,M=$=>{switch($){case"active":return"status-pill status-pill-active";case"paused":return"status-pill status-pill-paused";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill"}};return i.jsxs("div",{className:"refill-reminders-container",children:[i.jsxs("div",{className:"refill-header",children:[i.jsx("h3",{className:"refill-title",children:"Recurring Medications"}),i.jsxs("div",{className:"refill-actions",children:[i.jsxs("button",{className:"refill-action-button btn-add",onClick:()=>{P(void 0),k(!0)},children:[i.jsx(Qa,{size:16})," Add New"]}),i.jsxs("div",{className:"search-box",children:[i.jsx("input",{type:"text",placeholder:"Search patient, phone, medication...",value:l,onChange:F}),i.jsx(Pr,{size:18,className:"search-icon"})]})]})]}),a&&i.jsx("div",{className:"error-message-box",children:a}),i.jsx("div",{className:"refill-table-container",children:t?i.jsx("div",{className:"loading-pulse",children:"Loading..."}):e.length===0?i.jsx("div",{className:"empty-state",children:"No recurring medications found."}):i.jsx("div",{className:"refill-grouped-list",children:Object.values(e.reduce(($,z)=>{const W=z.patientId;return $[W]||($[W]={patientId:z.patientId,patientName:z.patientName,patientPhone:z.patientPhone,patientToken:z.patientToken,medications:[]}),$[W].medications.push(z),$},{})).map($=>i.jsxs("div",{className:"patient-medication-group-card",children:[i.jsxs("div",{className:"group-header",children:[i.jsxs("div",{className:"patient-info",children:[i.jsx("h4",{className:"patient-name",children:$.patientName}),i.jsxs("span",{className:"patient-meta",children:["Token: ",$.patientToken,"  Phone: ",$.patientPhone]})]}),i.jsx("div",{className:"group-actions"})]}),i.jsxs("table",{className:"refill-table group-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Medication"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Frequency"}),i.jsx("th",{children:"Next Delivery"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:$.medications.map(z=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"med-name",children:z.medicationName}),(z.tabletsPerDay||z.numberOfDays||z.directions)&&i.jsxs("div",{className:"med-usage-details",style:{fontSize:"0.8em",color:"#666"},children:[z.tabletsPerDay&&i.jsxs("span",{children:[z.tabletsPerDay," tabs/day  "]}),z.numberOfDays&&i.jsxs("span",{children:[z.numberOfDays," days "]})]}),z.notes&&i.jsxs("div",{className:"med-notes",children:["Note: ",z.notes]})]}),i.jsx("td",{children:z.quantity}),i.jsx("td",{children:i.jsx("span",{className:"frequency-badge",children:K(z.frequencyDays)})}),i.jsx("td",{children:i.jsx("div",{className:"date-display",children:new Date(z.nextDeliveryDate).toLocaleDateString()})}),i.jsx("td",{children:i.jsx("span",{className:M(z.status),children:z.status})}),i.jsx("td",{children:i.jsxs("div",{className:"action-buttons",children:[i.jsx("button",{className:"action-btn edit",title:"Edit",onClick:()=>U(z),children:i.jsx(yl,{size:16})}),i.jsx("button",{className:"action-btn delete",title:"Delete/Cancel",children:i.jsx(jr,{size:16})})]})})]},z.id))})]})]},$.patientId))})}),!t&&h>1&&i.jsxs("div",{className:"pagination-container",children:[i.jsxs("span",{className:"pagination-info",children:["Page ",f," of ",h," (Total ",b,")"]}),i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("button",{onClick:()=>L(f-1),disabled:f===1,className:"page-btn",children:[i.jsx(Ib,{size:16})," Prev"]}),i.jsxs("button",{onClick:()=>L(f+1),disabled:f===h,className:"page-btn",children:["Next ",i.jsx(Zh,{size:16})]})]})]}),i.jsx(BA,{isOpen:S,onClose:()=>{k(!1),P(void 0)},onSuccess:H,medication:T})]})},zie=()=>{const e=Dt(),n=Ur();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const l=await me(`/api/patients?search=${r}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const f=(await l.json()).patients[0];if(!f)throw new Error("Patient with the given token not found");const u=await me(`/api/queue/patient/${f.id}/latest`);if(u.ok){const b=await u.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a}});return}}const h=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:f.id,complaint:a})});if(!h.ok)throw new Error("Failed to create queue entry");const g=await h.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},ek=()=>{const e=Dt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,R]=w.useState(null),[I,B]=w.useState([]),[F,L]=w.useState(null),[U,H]=w.useState(""),[K,M]=w.useState(""),[$,z]=w.useState(""),[W,te]=w.useState(""),[V,G]=w.useState(""),[J,oe]=w.useState(""),[ie,E]=w.useState(""),[ce,ge]=w.useState(""),[D,pe]=w.useState(""),[Ce,Z]=w.useState(""),[ee,X]=w.useState(""),ye=w.useCallback(async()=>{a(!0),l(null);try{const le=await me("/api/distributors");if(!le.ok)throw new Error(`Failed to fetch distributors: ${le.statusText}`);const q=await le.json();t(q)}catch(le){console.error("Failed to fetch distributors:",le),l(le.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{ye()},[ye]);const He=async le=>{le.preventDefault(),l(null);try{const q=await me("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:U,contact_person:K,phone:$,email:W,address:V,gst_number:J,drug_license_number:ie})});if(!q.ok){const de=await q.json();throw new Error(de.message||"Failed to add distributor.")}alert("Distributor added successfully!"),et(),ye()}catch(q){console.error("Error adding distributor:",q),l(q.message||"Failed to add distributor.")}},he=async le=>{if(le.preventDefault(),l(null),!!P)try{const q=await me(`/api/distributors/${P.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:U,contact_person:K,phone:$,email:W,address:V,gst_number:J,drug_license_number:ie})});if(!q.ok){const de=await q.json();throw new Error(de.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),it(),ye()}catch(q){console.error("Error updating distributor:",q),l(q.message||"Failed to update distributor.")}},Le=async()=>{if(l(null),!!P)try{const le=await me(`/api/distributors/${P.id}`,{method:"DELETE"});if(!le.ok){const q=await le.json();throw new Error(q.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),vt(),ye()}catch(le){console.error("Error deleting distributor:",le),l(le.message||"Failed to delete distributor.")}},ue=w.useCallback(async le=>{l(null);try{const q=await me(`/api/distributors/${le}/payments`);if(!q.ok)throw new Error(`Failed to fetch payments: ${q.statusText}`);const be=(await q.json()).map(ht=>({...ht,order_value:parseFloat(ht.order_value),amount_paid:parseFloat(ht.amount_paid),balance_remaining:parseFloat(ht.balance_remaining)}));B(be);const $e=await me(`/api/distributors/${le}/balance`);if(!$e.ok)throw new Error(`Failed to fetch balance: ${$e.statusText}`);const nt=await $e.json();L({totalOrderValue:parseFloat(nt.totalOrderValue),totalAmountPaid:parseFloat(nt.totalAmountPaid),remainingBalance:parseFloat(nt.remainingBalance)})}catch(q){console.error("Error fetching payments/balance:",q),l(q.message||"Failed to load payments or balance.")}},[]),De=async le=>{if(le.preventDefault(),l(null),!!P)try{const q=await me(`/api/distributors/${P.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:ce,order_value:parseFloat(D||"0"),amount_paid:parseFloat(Ce||"0"),notes:ee})});if(!q.ok){const de=await q.json();throw new Error(de.message||"Failed to add payment.")}alert("Payment added successfully!"),_e(),ue(P.id)}catch(q){console.error("Error adding payment:",q),l(q.message||"Failed to add payment.")}},Ye=()=>{H(""),M(""),z(""),te(""),G(""),oe(""),E(""),l(null),f(!0)},et=()=>{f(!1)},Ke=le=>{R(le),H(le.name),M(le.contact_person||""),z(le.phone||""),te(le.email||""),G(le.address||""),oe(le.gst_number||""),E(le.drug_license_number||""),l(null),h(!0)},it=()=>{h(!1),R(null)},ot=le=>{R(le),l(null),b(!0)},vt=()=>{b(!1),R(null)},Ee=le=>{R(le),ue(le.id),l(null),S(!0)},Je=()=>{S(!1),R(null),B([]),L(null)},Ae=le=>{R(le),ge(new Date().toISOString().split("T")[0]),pe("0"),Z("0"),X(""),l(null),T(!0)},_e=()=>{T(!1),R(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):o?i.jsxs("div",{className:"error-indicator",children:["Error: ",o]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(cn,{size:24})," Back"]}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const le=n.reduce((de,be)=>de+parseFloat(be.remainingBalance||"0"),0),q=le>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${q}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",le.toFixed(2)]})})(),i.jsxs("button",{onClick:Ye,className:"add-distributor-button",children:[i.jsx(Qa,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(le=>i.jsxs("tr",{children:[i.jsx("td",{children:le.name}),i.jsx("td",{children:le.contact_person||"-"}),i.jsx("td",{children:le.phone||"-"}),i.jsx("td",{children:le.email||"-"}),i.jsx("td",{children:le.address||"-"}),i.jsx("td",{children:le.gst_number||"-"})," ",i.jsx("td",{children:le.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(le.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",le.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>Ee(le),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(m6,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>Ae(le),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(Qa,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>Ke(le),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(yl,{size:16})}),i.jsx("button",{onClick:()=>ot(le),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(jr,{size:16})})]})})]},le.id))})]})}),d&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:et,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:He,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:U,onChange:le=>H(le.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:K,onChange:le=>M(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:$,onChange:le=>z(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:W,onChange:le=>te(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:V,onChange:le=>G(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:J,onChange:le=>oe(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:ie,onChange:le=>E(le.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:et,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),u&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:it,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:he,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:U,onChange:le=>H(le.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:K,onChange:le=>M(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:$,onChange:le=>z(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:W,onChange:le=>te(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:V,onChange:le=>G(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:J,onChange:le=>oe(le.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:ie,onChange:le=>E(le.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:it,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:vt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',P.name,'"?']}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:vt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Le,className:"button-delete",children:"Delete"})]})]})}),v&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:Je,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",P.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),F&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",F.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",F.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",F.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),I.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:I.map(le=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(le.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",le.order_value.toFixed(2)]}),i.jsxs("td",{children:["",le.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",le.balance_remaining.toFixed(2)]}),i.jsx("td",{children:le.notes||"-"})]},le.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:Je,className:"button-cancel",children:"Close"})})]})}),k&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:_e,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",P.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:De,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:ce,onChange:le=>ge(le.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:D,onChange:le=>pe(le.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:Ce,onChange:le=>Z(le.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:ee,onChange:le=>X(le.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:_e,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},Bie=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[o,l]=w.useState({});if(w.useEffect(()=>{e&&f()},[e,t,a]),!e)return null;const d=(h,g)=>{l(b=>({...b,[h]:g}))},f=()=>{const h={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=Vd(g,b);v&&(h[g]=v.name)}),l(h)},u=()=>{const h={};for(const g in o)o[g]&&o[g]!=="none"&&(h[g]=o[g]);r(h),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(Sn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:f,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((h,g)=>i.jsxs(Pn.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:h}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:o[h]||"",onChange:b=>d(h,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:u,className:"button-submit",children:"Confirm Mapping"})]})]})})},Uie=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",mrp:0,stock:0,pack:"",expiry_date:"",rate:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,h]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",mrp:0,stock:0,pack:"",expiry_date:"",rate:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),f(!1),h(!1))},[e]),w.useEffect(()=>{const T=R=>{R.key==="Tab"&&b.current===document.activeElement&&(u||(h(!0),setTimeout(()=>{var I;(I=v.current)==null||I.focus()},0),R.preventDefault()))},P=R=>{g.current&&!g.current.contains(R.target)&&h(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",P),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",P)}},[u]);const S=T=>{const{name:P,value:R,type:I}=T.target;a(B=>({...B,[P]:I==="number"?parseFloat(R)||null:R}))},k=T=>{if(T.preventDefault(),l(null),f(!0),r.mrp===void 0||r.stock===void 0){l("MRP and Stock Quantity are required."),f(!1);return}const P={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,rate:r.rate===0?null:r.rate,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(P),f(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(Sn,{size:24})})]}),o&&i.jsx("div",{className:"error-message",children:o}),i.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ml,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ml,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"mrp",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ml,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"mrp",id:"mrp",required:!0,step:"0.01",min:"0",value:r.mrp||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ml,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"stock",id:"stock",required:!0,step:"1",min:"0",value:r.stock||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"pack",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"pack",id:"pack",value:r.pack||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>h(!u),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),u&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"rate",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"rate",id:"rate",step:"0.01",min:"0",value:r.rate??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:d,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:d,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:d?"Adding...":"Add Drug"})]})]})]})}):null},qie=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r})=>{const a=w.useRef(new Map),o=["name","mrp","stock","pack","expiry_date","rate","brand_name","box_number","gst","discount","batch","hsn_code","mfg","loose"],l=(d,f,u)=>{if(d.key==="Tab"){d.preventDefault();const h=o.indexOf(u);if(h!==-1){const g=(h+1)%o.length,b=o[g],v=a.current.get(`${f}-${b}`);v==null||v.focus()}}};return e.length===0?i.jsxs("div",{className:"no-drugs-message",children:[i.jsx("p",{children:"No drugs added to the purchase list yet."}),i.jsxs("button",{onClick:r,className:"action-button add-drug-to-table-button",children:[i.jsx(Qa,{size:18,className:"button-icon"}),"Add the first drug"]})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"purchase-drugs-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Composition Name"}),i.jsx("th",{children:"MRP ()"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Pack"}),i.jsx("th",{children:"Supplier"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Rate ()"}),i.jsx("th",{children:"Brand Name"}),i.jsx("th",{children:"Box Number"}),i.jsx("th",{children:"GST (%)"}),i.jsx("th",{children:"Discount (%)"}),i.jsx("th",{children:"Margin (%)"}),i.jsx("th",{children:"Batch"}),i.jsx("th",{children:"HSN Code"}),i.jsx("th",{children:"MFG"}),i.jsx("th",{children:"Loose"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map((d,f)=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("input",{type:"text",value:d.name||"",onChange:u=>n(u,d.id,"name"),onKeyDown:u=>l(u,d.id,"name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.mrp||"",onChange:u=>n(u,d.id,"mrp"),onKeyDown:u=>l(u,d.id,"mrp"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mrp`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.stock||"",onChange:u=>n(u,d.id,"stock"),onKeyDown:u=>l(u,d.id,"stock"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-stock`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.pack||"",onChange:u=>n(u,d.id,"pack"),onKeyDown:u=>l(u,d.id,"pack"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-pack`,u)}})}),i.jsx("td",{children:d.supplier||"N/A"}),i.jsx("td",{children:i.jsx("input",{type:"date",value:d.expiry_date||"",onChange:u=>n(u,d.id,"expiry_date"),onKeyDown:u=>l(u,d.id,"expiry_date"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-expiry_date`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.rate||"",onChange:u=>n(u,d.id,"rate"),onKeyDown:u=>l(u,d.id,"rate"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-rate`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.brand_name||"",onChange:u=>n(u,d.id,"brand_name"),onKeyDown:u=>l(u,d.id,"brand_name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-brand_name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.box_number||"",onChange:u=>n(u,d.id,"box_number"),onKeyDown:u=>l(u,d.id,"box_number"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-box_number`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.gst||"",onChange:u=>n(u,d.id,"gst"),onKeyDown:u=>l(u,d.id,"gst"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-gst`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.discount||"",onChange:u=>n(u,d.id,"discount"),onKeyDown:u=>l(u,d.id,"discount"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-discount`,u)}})}),i.jsx("td",{children:(()=>{const u=d.mrp||0,h=d.rate||0,g=d.gst!==null&&d.gst!==void 0?d.gst/100*h:0,b=d.discount!==null&&d.discount!==void 0?d.discount/100*u:0,v=u-(h+g)-b;return`${(u>0?v/u*100:0).toFixed(2)}%`})()}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.batch||"",onChange:u=>n(u,d.id,"batch"),onKeyDown:u=>l(u,d.id,"batch"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-batch`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.hsn_code||"",onChange:u=>n(u,d.id,"hsn_code"),onKeyDown:u=>l(u,d.id,"hsn_code"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-hsn_code`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.mfg||"",onChange:u=>n(u,d.id,"mfg"),onKeyDown:u=>l(u,d.id,"mfg"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mfg`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.loose||"",onChange:u=>n(u,d.id,"loose"),onKeyDown:u=>l(u,d.id,"loose"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-loose`,u)}})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>t(d.id),className:"delete-button",title:"Remove Item",children:i.jsx(jr,{size:16})})})]},d.id||f))})]})})},Vie="_container_4l9fw_7",Hie="_header_4l9fw_159",Gie="_backButton_4l9fw_173",Yie="_title_4l9fw_217",Wie="_stickyActionBar_4l9fw_239",Qie="_actionRow_4l9fw_269",Jie="_inputWrapper_4l9fw_287",Kie="_inputIcon_4l9fw_297",Xie="_input_4l9fw_287",Zie="_quickDistributors_4l9fw_353",eae="_distributorChip_4l9fw_369",tae="_distributorChipIcon_4l9fw_415",nae="_selectedInfo_4l9fw_425",rae="_resultsDropdown_4l9fw_455",iae="_resultItem_4l9fw_489",aae="_buttonGroup_4l9fw_517",sae="_button_4l9fw_517",oae="_buttonPrimary_4l9fw_561",lae="_buttonSecondary_4l9fw_583",cae="_buttonAccent_4l9fw_605",uae="_buttonDisabled_4l9fw_627",dae="_tableSection_4l9fw_643",fae="_cardTitle_4l9fw_659",hae="_cardIcon_4l9fw_679",pae="_footer_4l9fw_899",mae="_totalValue_4l9fw_933",gae="_footerControls_4l9fw_957",yae="_paidInputGroup_4l9fw_969",xae="_paidLabel_4l9fw_981",bae="_paidInput_4l9fw_969",vae="_errorMsg_4l9fw_1027",Kt={container:Vie,header:Hie,backButton:Gie,title:Yie,stickyActionBar:Wie,actionRow:Qie,inputWrapper:Jie,inputIcon:Kie,input:Xie,quickDistributors:Zie,distributorChip:eae,distributorChipIcon:tae,selectedInfo:nae,resultsDropdown:rae,resultItem:iae,buttonGroup:aae,button:sae,buttonPrimary:oae,buttonSecondary:lae,buttonAccent:cae,buttonDisabled:uae,tableSection:dae,cardTitle:fae,cardIcon:hae,footer:pae,totalValue:mae,footerControls:gae,paidInputGroup:yae,paidLabel:xae,paidInput:bae,errorMsg:vae},tk=()=>{const e=Dt(),{purchaseRows:n,setPurchaseRows:t,selectedDistributor:r,setSelectedDistributor:a,searchTerm:o,setSearchTerm:l,amountPaidToDistributor:d,setAmountPaidToDistributor:f,distributors:u,setDistributors:h}=vk(),[g,b]=w.useState(!1),v=w.useRef(null),S=w.useRef(null),[k,T]=w.useState(!1),P=w.useRef(null),[R,I]=w.useState(!1),[B,F]=w.useState([]),[L,U]=w.useState(null),[H,K]=w.useState(null),[M,$]=w.useState(!1),[z,W]=w.useState([]),te=["name","description","mrp","stock","pack","supplier","expiry_date","rate","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"];w.useEffect(()=>{(async()=>{try{const De=await me("/api/distributors?limit=4");if(De.ok){const Ye=await De.json();W(Array.isArray(Ye)?Ye.slice(0,4):[])}}catch(De){console.error("Failed to fetch initial distributors",De)}})()},[]);const V=()=>{const De={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",mrp:0,stock:0,pack:"",supplier:r?r.name:"",expiry_date:"",rate:0,box_number:"",gst:0,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""};t(Ye=>[...Ye,De])},G=async(ue,De)=>{if(!ue){K("No file provided for import.");return}if(!r){K("Please select a distributor before importing.");return}b(!0),K(null);const Ye=new FormData;Ye.append("inventoryFile",ue),Ye.append("columnMapping",JSON.stringify(De));try{const et=await me("/api/drugs/parse-excel",{method:"POST",body:Ye});if(!et.ok){const it=await et.json();throw new Error(it.message||`Failed to parse Excel file: ${et.statusText}`)}const Ke=await et.json();t(it=>[...it,...Ke.map(ot=>({...ot,id:Date.now().toString()+Math.random().toString(36).substring(2,9),supplier:r?r.name:ot.supplier}))]),alert(`Successfully parsed ${Ke.length} drugs from Excel. They have been added to the purchase list.`)}catch(et){console.error("Failed to parse Excel file:",et),K(et.message||"Failed to parse Excel file. Please check the file format and try again.")}finally{v.current&&(v.current.value=""),b(!1),U(null)}},J=async ue=>{if(ue.target.files&&ue.target.files[0]){const De=ue.target.files[0];U(De),K(null),b(!0);const Ye=new FormData;Ye.append("inventoryFile",De);try{const et=await me("/api/drugs/get-file-headers",{method:"POST",body:Ye});if(!et.ok){const it=await et.json();throw new Error(it.message||`Failed to get file headers: ${et.statusText}`)}const{headers:Ke}=await et.json();F(Ke),I(!0)}catch(et){console.error("Failed to get file headers:",et),K(et.message||"Failed to read file headers. Please check the file format and try again."),U(null)}finally{b(!1)}}else U(null)},oe=ue=>{L?G(L,ue):K("No file selected for import after mapping."),I(!1)},ie=()=>{I(!1),F([]),U(null),v.current&&(v.current.value="")},E=()=>{var ue;(ue=v.current)==null||ue.click()},ce=async ue=>{if(ue.target.files&&ue.target.files[0]){const De=ue.target.files[0];K(null),b(!0);const Ye=new FormData;Ye.append("file",De),Ye.append("output_type","csv");const Ke={Authorization:"Bearer 00841ac4-b279-11f0-ab55-0a3a41e3fad1"};try{const it=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:Ke,body:Ye});if(!it.ok){const q=await it.json();throw new Error(q.message||`Failed to extract data from image/PDF: ${it.statusText}`)}const ot=await it.json();if(!ot.success||!ot.content)throw new Error(ot.detail||"Nanonets API did not return expected content.");let vt=ot.content;vt=vt.split(`
`).filter(q=>!q.startsWith("#")&&q.trim()!=="").join(`
`);const Je=new File([vt],"extracted_data.csv",{type:"text/csv"}),Ae=new FormData;Ae.append("inventoryFile",Je);const _e=await me("/api/drugs/get-file-headers",{method:"POST",body:Ae});if(!_e.ok){const q=await _e.json();throw new Error(q.message||`Failed to get headers from extracted CSV: ${_e.statusText}`)}const{headers:le}=await _e.json();F(le),U(Je),I(!0)}catch(it){console.error("Failed to extract data from image/PDF:",it),K(it.message||"Failed to extract data from image/PDF. Please check the file and try again.")}finally{S.current&&(S.current.value=""),b(!1)}}},ge=()=>{var ue;(ue=S.current)==null||ue.click()},D=()=>{if(!r){K("Please select a distributor before adding a drug manually.");return}$(!0)},pe=()=>{$(!1),K(null)},Ce=ue=>{t(De=>[...De,{...ue,id:Date.now().toString(),supplier:r?r.name:ue.supplier}]),pe()},Z=ue=>{t(De=>De.filter(Ye=>Ye.id!==ue))},ee=(ue,De,Ye)=>{const{value:et}=ue.target;t(Ke=>Ke.map(it=>{if(it.id===De){let ot=et;Ye==="expiry_date"?ot=et.trim()===""?null:et:["mrp","stock","rate","gst","margin","discount","loose"].includes(Ye)&&(ot=parseFloat(et),isNaN(ot)&&(ot=null));const vt={...it,[Ye]:ot};return Ye==="name"&&r&&!vt.supplier&&(vt.supplier=r.name),vt}return it}))},X=w.useCallback(()=>n.reduce((ue,De)=>{const Ye=De.stock||0,et=De.rate||0,Ke=De.gst||0,it=De.discount||0;let ot=et*(1-it/100),vt=Ye*ot;return vt+=vt*(Ke/100),ue+vt},0),[n]),ye=async()=>{if(!r){K("Please select a distributor before submitting the purchase.");return}const ue=n.filter(De=>Object.values(De).some(Ye=>typeof Ye=="string"&&Ye.trim()!==""||typeof Ye=="number"&&Ye!==0||Ye!=null&&typeof Ye!="string"&&typeof Ye!="number"));if(ue.length===0){K("No valid drugs to submit. Please fill in at least one field for a row, or remove empty rows."),b(!1);return}b(!0),K(null);try{for(const Ke of ue){const it={...Ke,expiry_date:Ke.expiry_date===""?null:Ke.expiry_date,distributorId:r.id},ot=await me("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(it)});if(!ot.ok){const vt=await ot.json();throw new Error(vt.message||`Failed to add drug ${Ke.name}: ${ot.statusText}`)}}const De=X(),Ye=new Date().toISOString().split("T")[0],et=await me(`/api/distributors/${r.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:Ye,order_value:De,amount_paid:d,notes:"Payment from purchase page."})});if(!et.ok){const Ke=await et.json();throw new Error(Ke.message||`Failed to record distributor payment: ${et.statusText}`)}alert("All valid drugs added to inventory and distributor payment recorded successfully!"),t([]),a(null),l(""),f(0),e("/dashboard/inventory")}catch(De){console.error("Failed to submit purchase:",De),K(De.message||"Failed to submit purchase. Please try again.")}finally{b(!1)}},He=w.useCallback(async ue=>{if(ue.trim()===""){h([]);return}try{const De=await me(`/api/distributors?search=${encodeURIComponent(ue)}`);if(!De.ok)throw new Error(`Failed to fetch distributors: ${De.statusText}`);const Ye=await De.json();h(Ye)}catch(De){console.error("Failed to fetch distributors:",De),K(De.message||"Failed to load distributors.")}},[]),he=ue=>{const De=ue.target.value;l(De),a(null),P.current&&clearTimeout(P.current),De.trim()!==""?P.current=setTimeout(()=>{He(De),T(!0)},300):(h([]),T(!1))},Le=ue=>{a(ue),l(ue.name),T(!1),h([])};return w.useEffect(()=>{const ue=De=>{De.target instanceof HTMLElement&&!De.target.closest(`.${Kt.inputWrapper}`)&&T(!1)};return document.addEventListener("mousedown",ue),()=>{document.removeEventListener("mousedown",ue),P.current&&clearTimeout(P.current)}},[]),i.jsxs("div",{className:Kt.container,children:[i.jsxs("div",{className:Kt.header,children:[i.jsx("button",{onClick:()=>e(-1),className:Kt.backButton,title:"Go Back",children:i.jsx(cn,{size:24})}),i.jsx("h2",{className:Kt.title,children:"Purchase Inventory"})]}),H&&i.jsxs("div",{className:Kt.errorMsg,children:[i.jsx(Ar,{size:20}),H]}),i.jsx("div",{className:Kt.stickyActionBar,children:i.jsxs("div",{className:Kt.actionRow,children:[i.jsxs("div",{style:{flex:1,minWidth:"300px",position:"relative"},children:[i.jsxs("div",{className:Kt.inputWrapper,children:[i.jsx(Pr,{className:Kt.inputIcon,size:20}),i.jsx("input",{type:"text",placeholder:"Search distributor...",value:o,onChange:he,onFocus:()=>o.trim()!==""&&T(!0),className:Kt.input}),k&&u.length>0&&i.jsx("ul",{className:Kt.resultsDropdown,children:u.map(ue=>i.jsx("li",{onClick:()=>Le(ue),className:Kt.resultItem,children:ue.name},ue.id))})]}),z.length>0&&!r&&i.jsx("div",{className:Kt.quickDistributors,children:z.map(ue=>i.jsxs("button",{className:Kt.distributorChip,onClick:()=>Le(ue),children:[i.jsx(Ts,{className:Kt.distributorChipIcon}),ue.name]},ue.id))}),r&&i.jsxs("div",{className:Kt.selectedInfo,style:{marginTop:"0.5rem",marginBottom:0},children:[i.jsx(Ca,{size:18}),i.jsxs("span",{children:["Selected: ",i.jsx("strong",{children:r.name})]})]})]}),i.jsxs("div",{className:Kt.buttonGroup,children:[i.jsx("input",{ref:v,type:"file",className:"sr-only",style:{display:"none"},accept:".xlsx, .xls, .csv",onChange:J}),i.jsx("input",{ref:S,type:"file",className:"sr-only",style:{display:"none"},accept:".pdf, .png, .jpg, .jpeg",onChange:ce}),i.jsxs("button",{onClick:E,disabled:g||!r,className:`${Kt.button} ${Kt.buttonPrimary} ${g||!r?Kt.buttonDisabled:""}`,title:r?"":"Select a distributor to import",children:[i.jsx(RF,{size:18}),g?"Processing...":"Import Excel/CSV"]}),i.jsxs("button",{onClick:ge,disabled:g||!r,className:`${Kt.button} ${Kt.buttonSecondary} ${g||!r?Kt.buttonDisabled:""}`,title:r?"":"Select a distributor",children:[i.jsx(fo,{size:18}),"Scan Image/PDF"]}),i.jsxs("button",{onClick:D,disabled:!r,className:`${Kt.button} ${Kt.buttonAccent} ${r?"":Kt.buttonDisabled}`,title:r?"":"Select a distributor",children:[i.jsx(Qa,{size:18}),"Add Manually"]})]})]})}),i.jsx(Bie,{isOpen:R,onClose:ie,excelHeaders:B,onConfirm:oe,availableFields:te}),M&&i.jsx(Uie,{isOpen:M,onClose:pe,onDrugAddedToPurchase:Ce}),i.jsxs("div",{className:Kt.tableSection,children:[i.jsxs("div",{className:Kt.cardTitle,children:[i.jsx(_F,{className:Kt.cardIcon,size:24}),"Purchase Items (",n.length,")"]}),i.jsx(qie,{purchaseRows:n,onCellChange:ee,onRemoveDrug:Z,onAddEmptyRow:V})]}),i.jsxs("div",{className:Kt.footer,children:[i.jsxs("button",{onClick:V,className:`${Kt.button} ${Kt.buttonSecondary}`,children:[i.jsx(Qa,{size:18}),"Add New Row"]}),i.jsxs("div",{className:Kt.footerControls,children:[i.jsxs("div",{className:Kt.paidInputGroup,children:[i.jsx("label",{htmlFor:"amount-paid",className:Kt.paidLabel,children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount-paid",value:d,onChange:ue=>f(parseFloat(ue.target.value)||0),placeholder:"0.00",className:Kt.paidInput,step:"0.01",disabled:!r})]}),i.jsxs("div",{className:Kt.totalValue,children:["Total: ",i.jsxs("span",{children:["",X().toFixed(2)]})]}),i.jsx("button",{onClick:ye,disabled:g||n.length===0||!r,className:`${Kt.button} ${Kt.buttonPrimary} ${Kt.submitButton} ${g||!r||n.length===0?Kt.buttonDisabled:""}`,style:{padding:"0.8rem 1.5rem",fontSize:"1rem"},children:g?"Submitting...":"Complete Purchase"})]})]})]})},wae=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},Sae=()=>{const e=Dt(),n=Ur(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(!0),[f,u]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[T,P]=w.useState(""),[R,I]=w.useState(""),[B,F]=w.useState(""),[L,U]=w.useState(""),[H,K]=w.useState(0),M=w.useRef(!1),$=ie=>{const E=Math.max(0,Math.min(100,isNaN(ie)?0:ie));M.current=!0,K(E);const ce=a.map(ge=>({...ge,discount_percentage:E}));o(ce)},z=(ie,E)=>{const ce=[...a];ce[ie].discount_percentage=isNaN(E)?0:E,o(ce)};w.useEffect(()=>{if(M.current){M.current=!1;return}const ie=a.reduce((ge,D)=>ge+(D.total_price??0),0);if(ie===0){K(0);return}const ce=a.reduce((ge,D)=>{const Ce=(D.total_price??0)*((D.discount_percentage??0)/100);return ge+Ce},0)/ie*100;K(ge=>Math.abs(ge-ce)>.01?ce:ge)},[a]);const W=async()=>{if(!t)return u("No order data available to bill."),null;if(a.length===0)return u("Cannot bill an empty order."),null;g(!0),u(null);try{const ie=a.map(pe=>{const Ce=(pe.pricePerLooseUnit??0)*(pe.looseQuantity??0),Z=Ce*((pe.discount_percentage??0)/100),ee=Ce-Z;return{name:pe.name,pack_quantity:pe.loosePacks??0,loose_quantity:pe.looseUnits??0,price:pe.originalPrice??0,pack_price:pe.originalPrice??0,loose_price:pe.pricePerLooseUnit??0,total:ee,drug_id:pe.drug_id,discount_percentage:pe.discount_percentage??0,batch:pe.batch,expiry_date:pe.expiry_date}}),E={patientId:t.patientId,queueId:t.id,items:ie,amount:oe,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:H},ce=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),ge=await ce.json();if(!ce.ok||!ge.id)throw new Error(ge.message||"Failed to create bill.");const D=await me(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ge.id,medications:a})});if(!D.ok){const pe=await D.text();throw new Error(`Failed to update pharmacy order status: ${D.statusText} - ${pe}`)}return r(pe=>pe?{...pe,status:"billed",bill_id:ge.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${ge.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:ge.id},initialItems:a}}),ge.id}catch(ie){return console.error("Billing process failed:",ie),u(ie.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},te=()=>{window.print()},V=async()=>{await W()&&(window.print(),e(-1))};w.useEffect(()=>{const ie=n.pathname.split("/"),E=ie[ie.length-1];E?(async()=>{try{d(!0);const ge=await me(`/api/pharmacy-orders/${E}`);if(!ge.ok)throw new Error("Failed to fetch pharmacy order details");const D=await ge.json();r(D);let pe=[];try{const Z=await me("/api/drugs");if(Z.ok){const ee=await Z.json();pe=ee.drugs||ee||[]}}catch(Z){console.warn("Failed to fetch inventory for billing details",Z)}const Ce=D.medications.map(Z=>{const ee=wae(Z.unit),X=(Z.pack_quantity??0)*ee+(Z.loose_quantity??0),ye=pe.find(Ye=>Z.drug_id&&String(Ye.id)===String(Z.drug_id)||Ye.name.toLowerCase()===Z.name.toLowerCase()),He=Z.batch||(ye==null?void 0:ye.batch)||(ye==null?void 0:ye.batch_number),he=Z.expiry_date||(ye==null?void 0:ye.expiry_date),Le=Number(Z.pack_price)||Number(ye==null?void 0:ye.mrp)||0,ue=Number(ye==null?void 0:ye.rate)||0;let De=Number(Z.loose_price)||0;return De===0&&(Le>0&&ee>0?De=Le/ee:ue>0&&(De=ue)),{...Z,isLoose:!0,loosePacks:Z.pack_quantity??0,looseUnits:Z.loose_quantity??0,looseQuantity:X,pack_price:Le,loose_price:De,total_price:Number(Z.total_price)||De*X,pricePerLooseUnit:De,originalPrice:Le,discount_percentage:Number(Z.discount_percentage)??0,directions_to_use:Z.directions_to_use,tabletsPerDay:Z.tabletsPerDay,numberOfDays:Z.numberOfDays,batch:He,expiry_date:he}});o(Ce)}catch(ge){console.error("Failed to fetch order:",ge),u(ge.message||"Failed to load order details.")}finally{d(!1)}})():(u("No pharmacy order ID provided."),d(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const E=await me("/api/clinics/settings");if(!E.ok)throw new Error("Failed to fetch clinic settings");const ce=await E.json();P(ce.upi_id||""),I(ce.name||""),F(ce.address||""),U(ce.notes||"")}catch(E){console.error("Error fetching clinic settings:",E)}})()},[]);const G=w.useMemo(()=>a.reduce((ie,E)=>ie+(E.total_price??0),0),[a]),J=w.useMemo(()=>a.reduce((ie,E)=>{const ge=(E.total_price??0)*(E.discount_percentage??0)/100;return ie+ge},0),[a]),oe=w.useMemo(()=>G-J,[G,J]);return w.useEffect(()=>{if(oe>0&&T){const ie=`upi://pay?pa=${T}&pn=ClinicName&am=${oe.toFixed(2)}&cu=INR`;k(ie)}else k("")},[oe,T]),l?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):f?i.jsxs("div",{className:"error-message-box",children:["Error: ",f]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:R?`${R} Pharmacy`:"Pharmacy Bill"}),(B||L)&&i.jsxs("div",{className:"clinic-details-print",children:[B&&i.jsx("span",{className:"small-text clinic-address",children:B}),L&&i.jsx("span",{className:"small-text clinic-notes",children:L})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ts,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(eg,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(vu,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(cn,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ts,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(eg,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(Qd,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(vu,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((ie,E)=>{var Ce;const ce=ie.total_price??0,ge=ce*(ie.discount_percentage??0)/100,D=ce-ge;return i.jsxs("tr",{children:[i.jsx("td",{children:E+1}),i.jsx("td",{children:ie.name}),i.jsx("td",{children:ie.batch||"N/A"}),i.jsx("td",{children:ie.expiry_date?new Date(ie.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",ie.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",ie.looseUnits??0]})]}),i.jsx("td",{children:((Ce=ie.originalPrice)==null?void 0:Ce.toFixed(2))??"N/A"}),i.jsx("td",{children:((ie.pricePerLooseUnit??0)*(1-(ie.discount_percentage??0)/100)).toFixed(2)}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:ie.discount_percentage===0?"":ie.discount_percentage,onChange:Z=>z(E,parseFloat(Z.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:D.toFixed(2)})]},E)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Wh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",G.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",H.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",J.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(oe*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",oe.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",G.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",J.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:H===0?"":H,onChange:ie=>$(parseFloat(ie.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:h||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",oe.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Wh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:ie=>v(ie.target.value),className:"payment-mode-select",disabled:h||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:te,className:"secondary-button print-preview-button no-print",disabled:h||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:V,className:"primary-button",disabled:h||a.length===0,children:h?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},Nae=()=>{const e=Dt(),n=Ur(),[t,r]=w.useState(null),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState([]),[h,g]=w.useState(!0),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState("cash"),[R,I]=w.useState(""),[B,F]=w.useState(""),[L,U]=w.useState(""),[H,K]=w.useState(""),[M,$]=w.useState(""),[z,W]=w.useState(0),te=w.useRef(!1),V=D=>{const pe=Math.max(0,Math.min(100,isNaN(D)?0:D));te.current=!0,W(pe);const Ce=f.map(Z=>({...Z,discount_percentage:pe}));u(Ce)},G=(D,pe)=>{const Ce=[...f];Ce[D].discount_percentage=isNaN(pe)?0:pe,u(Ce)};w.useEffect(()=>{if(te.current){te.current=!1;return}const D=f.reduce((Z,ee)=>Z+(ee.price??0),0);if(D===0){W(0);return}const Ce=f.reduce((Z,ee)=>{const ye=(ee.price??0)*((ee.discount_percentage??0)/100);return Z+ye},0)/D*100;W(Z=>Math.abs(Z-Ce)>.01?Ce:Z)},[f]);const J=async()=>{if(!t)return v("No order data available to bill."),null;if(f.length===0)return v("Cannot bill an empty order."),null;k(!0),v(null);try{const D=f.map(X=>{const ye=X.price,He=ye*((X.discount_percentage??0)/100),he=ye-He;return{name:X.name,price:X.price,quantity:1,total:he,item_id:X.id,type:"lab_test",discount_percentage:X.discount_percentage??0}}),pe={patientId:t.patient_id,items:D,amount:ge,paymentMode:T,type:"lab",related_id:t.id,status:"paid",discountPercentage:z},Ce=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(pe)}),Z=await Ce.json();if(!Ce.ok||!Z.id)throw new Error(Z.message||"Failed to create bill.");const ee=await me(`/api/lab/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:Z.id})});if(!ee.ok){const X=await ee.text();throw new Error(`Failed to update lab order status: ${ee.statusText} - ${X}`)}return r(X=>X?{...X,status:"billed",bill_id:Z.id}:null),alert(`Lab Order bill created (ID: ${Z.id}) and marked as billed.`),e(`/dashboard/lab-billing/${t.id}`,{replace:!0,state:{...n.state,order:{...t,status:"billed",bill_id:Z.id}}}),Z.id}catch(D){return console.error("Billing process failed:",D),v(D.message||"Failed to mark order as billed. Please try again."),null}finally{k(!1)}},oe=()=>{window.print()},ie=async()=>{await J()&&(window.print(),e(-1))};w.useEffect(()=>{const D=n.pathname.split("/"),pe=D[D.length-1];pe?(async()=>{try{const Z=await me(`/api/lab/${pe}`);if(!Z.ok)throw new Error("Failed to fetch lab order details");const ee=await Z.json();if(r(ee),ee.patient_id){const ye=await me(`/api/patients/${ee.patient_id}`);if(ye.ok){const He=await ye.json();o(He.name),d(He.patient_token_number)}}const X=ee.tests.map(ye=>({...ye,price:typeof ye.price=="string"?parseFloat(ye.price):Number(ye.price)||0,discount_percentage:0,total_price:typeof ye.price=="string"?parseFloat(ye.price):Number(ye.price)||0}));u(X)}catch(Z){console.error("Failed to fetch order:",Z),v(Z.message||"Failed to load order details.")}finally{g(!1)}})():(v("No lab order ID provided."),g(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const pe=await me("/api/clinics/settings");if(!pe.ok)throw new Error("Failed to fetch clinic settings");const Ce=await pe.json();F(Ce.upi_id||""),U(Ce.name||""),K(Ce.address||""),$(Ce.notes||"")}catch(pe){console.error("Error fetching clinic settings:",pe)}})()},[]);const E=w.useMemo(()=>f.reduce((D,pe)=>D+(pe.price??0),0),[f]),ce=w.useMemo(()=>f.reduce((D,pe)=>{const Z=(pe.price??0)*(pe.discount_percentage??0)/100;return D+Z},0),[f]),ge=w.useMemo(()=>E-ce,[E,ce]);return w.useEffect(()=>{if(ge>0&&B){const D=`upi://pay?pa=${B}&pn=ClinicName&am=${ge.toFixed(2)}&cu=INR`;I(D)}else I("")},[ge,B]),h?i.jsx("div",{className:"loading-pulse",children:"Loading Lab Bill..."}):b?i.jsxs("div",{className:"error-message-box",children:["Error: ",b]}):t?i.jsxs("div",{className:"pharmacy-billing-page",children:[" ",i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"LAB INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:L?`${L} Lab`:"Lab Bill"}),(H||M)&&i.jsxs("div",{className:"clinic-details-print",children:[H&&i.jsx("span",{className:"small-text clinic-address",children:H}),M&&i.jsx("span",{className:"small-text clinic-notes",children:M})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ts,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(eg,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(vu,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(cn,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ts,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(eg,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(po,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(vu,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),f.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"TEST DESCRIPTION"}),i.jsx("th",{children:"PRICE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:f.map((D,pe)=>{const Ce=D.price??0,Z=Ce*(D.discount_percentage??0)/100,ee=Ce-Z;return i.jsxs("tr",{children:[i.jsx("td",{children:pe+1}),i.jsx("td",{children:D.name}),i.jsx("td",{children:typeof D.price=="number"?D.price.toFixed(2):Number(D.price||0).toFixed(2)}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:D.discount_percentage||"",onChange:X=>G(pe,parseFloat(X.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsx("td",{children:ee.toFixed(2)})]},pe)})})]}):i.jsx("p",{children:"No tests in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[R&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${T!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Wh,{value:R,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",z.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",ce.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",ge.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",ce.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:z===0?"":z,onChange:D=>V(parseFloat(D.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:S||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",ge.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:R?i.jsxs(i.Fragment,{children:[i.jsx(Wh,{value:R,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:T,onChange:D=>P(D.target.value),className:"payment-mode-select",disabled:S||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status!=="billed"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:oe,className:"secondary-button print-preview-button no-print",disabled:S||f.length===0,children:"Print Preview"}),i.jsx("button",{onClick:ie,className:"primary-button",disabled:S||f.length===0,children:S?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e("/billing",{state:{billId:t.bill_id}}),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})]}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},Cae=()=>{const e=Dt(),[n,t]=w.useState(!0),[r,a]=w.useState([]),[o,l]=w.useState(""),[d,f]=w.useState(!0),[u,h]=w.useState(!1),[g,b]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",name:"",logoUrl:"",upi_id:"",address:"",notes:"",voice_ai_language:"en-US"}),[v,S]=w.useState(null),[k,T]=w.useState(!1),P=(M,$)=>{S({type:M,message:$}),setTimeout(()=>S(null),3e3)},R=M=>{switch(M){case"doctor":return i.jsx(Qk,{size:14,className:"text-blue-600"});case"receptionist":return i.jsx(Dw,{size:14,className:"text-green-600"});case"pharmacy":return i.jsx(Qd,{size:14,className:"text-purple-600"});case"lab":return i.jsx(po,{size:14,className:"text-yellow-600"});default:return i.jsx(Ob,{size:14,className:"text-gray-500"})}},I=M=>{switch(M){case"doctor":return"avatar-blue";case"receptionist":return"avatar-green";case"pharmacy":return"avatar-purple";case"lab":return"avatar-yellow";default:return"avatar-gray"}},B=w.useCallback(async()=>{t(!0);try{const M=await me("/staff");if(M.ok){const $=await M.json();a($.map(z=>({...z,id:z._id||z.id})))}}catch(M){console.error("Error fetching staff:",M),P("error","Failed to load staff list")}finally{t(!1)}},[]),F=w.useCallback(async()=>{f(!0);try{const M=await me("/api/clinics/settings");if(M.ok){const $=await M.json();b({admissionCharge:parseFloat($.admissionCharge||0).toFixed(2),perDayCharge:parseFloat($.perDayCharge||0).toFixed(2),otherCharges:parseFloat($.otherCharges||0).toFixed(2),aiMemory:$.aiMemory||"",clinicWideSystemPrompt:$.clinicWideSystemPrompt||"",gemini_api_key:$.gemini_api_key||"",low_stock_threshold:$.low_stock_threshold!==void 0&&$.low_stock_threshold!==null?String($.low_stock_threshold):"10",name:$.name||"",logoUrl:$.logoUrl||"",upi_id:$.upi_id||"",address:$.address||"",notes:$.notes||"",clinic_id:$.clinic_id,voice_ai_language:$.voice_ai_language||"en-US"})}}catch(M){console.error("Error fetching settings:",M),P("error","Failed to load settings")}finally{f(!1)}},[]);w.useEffect(()=>{B(),F()},[B,F]);const L=M=>{const{name:$,value:z}=M.target;b(W=>({...W,[$]:z}))},U=async()=>{h(!0);try{const M=parseFloat(g.admissionCharge),$=parseFloat(g.perDayCharge),z=parseFloat(g.otherCharges),W=parseInt(g.low_stock_threshold);if((await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:g.name,admissionCharge:M,perDayCharge:$,otherCharges:z,aiMemory:g.aiMemory,clinicWideSystemPrompt:g.clinicWideSystemPrompt,gemini_api_key:g.gemini_api_key,low_stock_threshold:W,logoUrl:g.logoUrl,upi_id:g.upi_id,address:g.address,notes:g.notes,voice_ai_language:g.voice_ai_language})})).ok)P("success","Changes saved successfully");else throw new Error("Failed to save")}catch(M){console.error("Error saving settings:",M),P("error","Failed to save settings")}finally{h(!1)}},H=r.filter(M=>M.name.toLowerCase().includes(o.toLowerCase())||M.role.toLowerCase().includes(o.toLowerCase())),K=async M=>{for(const $ of M){const z=document.getElementById($);z&&(z.scrollIntoView({behavior:"smooth",block:"center"}),z.classList.add("ai-feedback-glow"),await new Promise(W=>setTimeout(W,1500)),z.classList.remove("ai-feedback-glow"))}};return i.jsxs("div",{className:"clinic-hub-container",children:[i.jsxs("header",{className:"clinic-hub-header",children:[i.jsxs("div",{className:"clinic-hub-title",children:[i.jsx("h1",{children:"Clinic Hub"}),i.jsx("p",{className:"clinic-hub-subtitle",children:"Manage your ecosystem"})]}),i.jsxs("div",{className:"clinic-hub-actions",children:[v&&i.jsx("div",{className:`px-4 py-2 rounded-md text-sm font-medium ${v.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.message}),i.jsxs("button",{className:"btn-add-staff",onClick:()=>e("/dashboard/staff/add"),children:[i.jsx(_s,{size:16})," Add Staff"]}),i.jsxs("button",{className:"btn-save-changes",onClick:U,disabled:u,children:[i.jsx(Jd,{size:16})," ",u?"Saving...":"Save Changes"]})]})]}),i.jsxs("main",{className:"clinic-hub-content",children:[i.jsxs("div",{className:"team-directory-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx(ep,{size:18,className:"text-gray-500"}),i.jsxs("span",{className:"panel-title",children:["Team Directory (",r.length,")"]})]}),i.jsx("div",{className:"search-container",children:i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Pr,{size:16,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Find member...",className:"search-input",value:o,onChange:M=>l(M.target.value)})]})}),i.jsx("div",{className:"team-list",children:n?i.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading staff..."}):H.length===0?i.jsx("div",{className:"empty-state",children:"No staff found."}):H.map(M=>i.jsxs("div",{id:`staff-member-${M.id}`,className:"team-member-item",children:[i.jsx("div",{className:`member-avatar ${I(M.role)}`,children:M.name.charAt(0).toUpperCase()}),i.jsxs("div",{className:"member-info",children:[i.jsx("div",{className:"member-name",children:M.name}),i.jsxs("div",{className:"member-role",children:[R(M.role),M.role]})]}),i.jsx("span",{className:`member-status ${M.active?"status-active":"status-inactive"}`,children:M.active?"Active":"Inactive"}),i.jsx("button",{className:"btn-edit-member",onClick:()=>e(`/dashboard/staff/edit/${M.id}`),children:i.jsx(yl,{size:16})})]},M.id))})]}),i.jsxs("div",{className:"config-console-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx(Vk,{size:18,className:"text-gray-500"}),i.jsx("span",{className:"panel-title",children:"Configuration Console"})]}),d?i.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading settings..."}):i.jsxs("div",{className:"config-content",children:[i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Hk,{size:16})," CLINIC IDENTITY & LOCATION"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Clinic Name"}),i.jsx("input",{type:"text",className:"form-input",name:"name",id:"setting-name",value:g.name,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Logo URL"}),i.jsx("input",{type:"url",className:"form-input",placeholder:"https://",name:"logoUrl",id:"setting-logoUrl",value:g.logoUrl,onChange:L})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Address"}),i.jsx("textarea",{className:"form-textarea",placeholder:"Full physical address",name:"address",id:"setting-address",value:g.address,onChange:L})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Hh,{size:16})," FINANCIAL OPERATIONS"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Admission Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"admissionCharge",id:"setting-admissionCharge",value:g.admissionCharge,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Per Day Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"perDayCharge",id:"setting-perDayCharge",value:g.perDayCharge,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Other Charges ()"}),i.jsx("input",{type:"number",className:"form-input",name:"otherCharges",id:"setting-otherCharges",value:g.otherCharges,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"UPI ID"}),i.jsx("input",{type:"text",className:"form-input",name:"upi_id",id:"setting-upi_id",value:g.upi_id,onChange:L})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(zk,{size:16})," INVENTORY & AI"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Low Stock Threshold"}),i.jsx("input",{type:"number",className:"form-input",name:"low_stock_threshold",id:"setting-low_stock_threshold",value:g.low_stock_threshold,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Voice AI Language"}),i.jsxs("select",{className:"form-input",name:"voice_ai_language",id:"setting-voice_ai_language",value:g.voice_ai_language,onChange:M=>b($=>({...$,voice_ai_language:M.target.value})),children:[i.jsx("option",{value:"en-US",children:"English"}),i.jsx("option",{value:"hi-IN",children:"Hindi"}),i.jsx("option",{value:"te-IN",children:"Telugu"}),i.jsx("option",{value:"bn-IN",children:"Bengali"}),i.jsx("option",{value:"mr-IN",children:"Marathi"}),i.jsx("option",{value:"ta-IN",children:"Tamil"}),i.jsx("option",{value:"gu-IN",children:"Gujarati"}),i.jsx("option",{value:"kn-IN",children:"Kannada"}),i.jsx("option",{value:"ml-IN",children:"Malayalam"}),i.jsx("option",{value:"pa-IN",children:"Punjabi"}),i.jsx("option",{value:"es-ES",children:"Spanish"}),i.jsx("option",{value:"fr-FR",children:"French"}),i.jsx("option",{value:"de-DE",children:"German"}),i.jsx("option",{value:"it-IT",children:"Italian"}),i.jsx("option",{value:"pt-PT",children:"Portuguese"}),i.jsx("option",{value:"ru-RU",children:"Russian"}),i.jsx("option",{value:"ja-JP",children:"Japanese"}),i.jsx("option",{value:"ko-KR",children:"Korean"}),i.jsx("option",{value:"zh-CN",children:"Chinese (Simplified)"}),i.jsx("option",{value:"ar-SA",children:"Arabic"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Gemini API Key"}),i.jsx("input",{type:"password",className:"form-input",name:"gemini_api_key",id:"setting-gemini_api_key",value:g.gemini_api_key,onChange:L,placeholder:"******************"})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Clinic-Wide System Prompt"}),i.jsx("textarea",{className:"form-textarea",name:"clinicWideSystemPrompt",id:"setting-clinicWideSystemPrompt",value:g.clinicWideSystemPrompt,onChange:L,placeholder:"Instructions for the AI..."})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"AI Memory (Context)"}),i.jsx("textarea",{className:"form-textarea",name:"aiMemory",id:"setting-aiMemory",value:g.aiMemory,onChange:L,placeholder:"Shared context for the AI..."})]})]})]})]})]})]}),k&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex justify-end",children:i.jsx("div",{className:"w-96 bg-white h-full shadow-2xl animate-slide-in-right",children:i.jsx(nT,{onClose:()=>T(!1),settings:g,staffList:r,onSettingsUpdate:F,onStaffUpdate:B,onHighlight:K})})})]})},_ae="_container_1sjqk_1",jae="_header_1sjqk_15",kae="_title_1sjqk_37",Tae="_controls_1sjqk_51",Eae="_dateInputGroup_1sjqk_63",Aae="_dateInputLabel_1sjqk_75",Pae="_dateInput_1sjqk_63",Dae="_section_1sjqk_121",Iae="_sectionTitle_1sjqk_137",Rae="_statsGrid_1sjqk_157",Mae="_statCard_1sjqk_171",Oae="_statTitle_1sjqk_197",Lae="_statValue_1sjqk_213",Fae="_statSubtitle_1sjqk_225",$ae="_revenueGrid_1sjqk_239",zae="_revenueCard_1sjqk_253",Bae="_revenueCardTitle_1sjqk_267",Uae="_revenueCardList_1sjqk_281",qae="_revenueCardListItem_1sjqk_293",Vae="_tableContainer_1sjqk_321",Hae="_table_1sjqk_321",Gae="_textGreen_1sjqk_395",Yae="_textRed_1sjqk_403",Wae="_loadingContainer_1sjqk_421",Qae="_errorAlert_1sjqk_439",nn={container:_ae,header:jae,title:kae,controls:Tae,dateInputGroup:Eae,dateInputLabel:Aae,dateInput:Pae,section:Dae,sectionTitle:Iae,statsGrid:Rae,statCard:Mae,statTitle:Oae,statValue:Lae,statSubtitle:Fae,revenueGrid:$ae,revenueCard:zae,revenueCardTitle:Bae,revenueCardList:Uae,revenueCardListItem:qae,tableContainer:Vae,table:Hae,textGreen:Gae,textRed:Yae,loadingContainer:Wae,errorAlert:Qae},Jae=()=>{const e=Dt(),n=Ur(),t=new URLSearchParams(n.search),r=t.get("startDate"),a=t.get("endDate"),o=new Date().toISOString().split("T")[0],[l,d]=w.useState(r||o),[f,u]=w.useState(a||o),[h,g]=w.useState(!1),[b,v]=w.useState(null),{setAnalysisDateRange:S,analysisDateRange:k,setAnalysisData:T,registerAnalysisNavigator:P,registerAnalysisRefresher:R}=Tb(),[I,B]=w.useState(0),[F,L]=w.useState(0),[U,H]=w.useState(null),[K,M]=w.useState(null),[$,z]=w.useState({reception:{},pharmacy:{},lab:{}}),[W,te]=w.useState(null),V=w.useCallback(async(J,oe)=>{g(!0),v(null);const ie=J||l,E=oe||f;if(B(0),L(0),H(null),M(null),z({reception:{},pharmacy:{},lab:{}}),te(null),!ie||!E){v("Please select both start and end dates."),g(!1);return}try{const ce=m3(),[ge,D,pe,Ce]=await Promise.all([me(`/api/bills?startDate=${l}&endDate=${f}`),me(`/api/payment/admission?startDate=${l}&endDate=${f}`),me(`/api/subscriptions/transactions/manual?startDate=${l}&endDate=${f}`),ce?me(`/api/inventory/comprehensive-analysis?startDate=${l}&endDate=${f}&clinicId=${ce}`):Promise.resolve(null)]);if(ge.ok&&D.ok&&pe.ok){const Z=await ge.json(),ee=await D.json(),X=await pe.json(),ye=Z.bills||[],He=ee.admissionPayments||[],he=X||[];let Le=0,ue=0;const De={},Ye={consultation:0,pharmacy:0,lab:0,other:0},et={reception:{},pharmacy:{},lab:{}};ye.forEach(Ke=>{if(Ke.status==="paid"||Ke.type==="pharmacy_return"){const it=parseFloat(Ke.amount.toString()),ot=Ke.payment_mode||"Unknown";let vt=Ke.type||"other";vt==="pharmacy_return"&&(ue+=it,vt="pharmacy"),Le+=it,De[ot]=(De[ot]||0)+it,Ye.hasOwnProperty(vt)?Ye[vt]=(Ye[vt]||0)+it:Ye.other=(Ye.other||0)+it,vt==="pharmacy"?et.pharmacy[ot]=(et.pharmacy[ot]||0)+it:vt==="lab"?et.lab[ot]=(et.lab[ot]||0)+it:et.reception[ot]=(et.reception[ot]||0)+it}}),He.forEach(Ke=>{const it=parseFloat(Ke.amount_paid.toString()),ot=Ke.payment_mode||"Unknown";Le+=it,De[ot]=(De[ot]||0)+it,et.reception[ot]=(et.reception[ot]||0)+it}),he.forEach(Ke=>{var vt,Ee;const it=parseFloat(((Ee=(vt=Ke.subscriptionPlan)==null?void 0:vt.price)==null?void 0:Ee.toString())??"0"),ot=Ke.subscription_payment_method||"manual";Le+=it,De[ot]=(De[ot]||0)+it,et.reception[ot]=(et.reception[ot]||0)+it}),B(Le),L(ue),H(De),M(Ye),z(et)}if(Ce&&Ce.ok){const Z=await Ce.json();te(Z)}}catch(ce){console.error("Analysis Fetch Error:",ce),v("Failed to fetch analysis data. Please try again.")}finally{g(!1)}},[l,f]);w.useEffect(()=>{P(J=>{const oe=`analysis-${J}`,ie=document.getElementById(oe);ie&&(ie.scrollIntoView({behavior:"smooth",block:"center"}),ie.classList.add("ai-highlight-glow"),setTimeout(()=>ie.classList.remove("ai-highlight-glow"),2e3))})},[P]),w.useEffect(()=>{R(async()=>(await V(),null))},[R,V]),w.useEffect(()=>{if(k.startDate&&k.endDate){const J=k.startDate.toISOString().split("T")[0],oe=k.endDate.toISOString().split("T")[0];(J!==l||oe!==f)&&(d(J),u(oe))}},[k]),w.useEffect(()=>{const J=new URLSearchParams(n.search),oe=J.get("section"),ie=J.get("startDate"),E=J.get("endDate");if(ie&&E){d(ie),u(E);const ce=k.startDate?k.startDate.toISOString().split("T")[0]:null,ge=k.endDate?k.endDate.toISOString().split("T")[0]:null;(ce!==ie||ge!==E)&&S({startDate:new Date(ie),endDate:new Date(E)})}if(oe){const ce=`analysis-${oe}`;setTimeout(()=>{const ge=document.getElementById(ce);ge&&(ge.scrollIntoView({behavior:"smooth",block:"center"}),ge.classList.add("ai-highlight-glow"),setTimeout(()=>ge.classList.remove("ai-highlight-glow"),2e3))},500)}},[n.search]),w.useEffect(()=>{V()},[l,f,V]),w.useEffect(()=>{!h&&(I>0||W)&&T({totalRevenue:I,inventoryValue:0,pharmacyRevenue:(K==null?void 0:K.pharmacy)||0,labRevenue:(K==null?void 0:K.lab)||0,receptionRevenue:((K==null?void 0:K.consultation)||0)+((K==null?void 0:K.other)||0),inventorySummary:W?{totalItemsAnalyzed:W.pharmacyAnalysis.length,netPositiveItems:W.pharmacyAnalysis.filter(J=>J.net_change>0).length}:null})},[I,W,K,h,T]);const G=J=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(J);return i.jsxs("div",{className:nn.container,children:[i.jsxs("div",{className:nn.header,children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-gray-100 rounded-full",children:i.jsx(cn,{size:20,className:"text-gray-600"})}),i.jsx("h1",{className:nn.title,children:"Analysis Dashboard"})]}),i.jsxs("div",{className:nn.controls,children:[i.jsxs("div",{className:nn.dateInputGroup,children:[i.jsx("label",{className:nn.dateInputLabel,children:"From:"}),i.jsx("input",{type:"date",className:nn.dateInput,value:l,onChange:J=>{d(J.target.value),f&&S({startDate:new Date(J.target.value),endDate:new Date(f)})}})]}),i.jsxs("div",{className:nn.dateInputGroup,children:[i.jsx("label",{className:nn.dateInputLabel,children:"To:"}),i.jsx("input",{type:"date",className:nn.dateInput,value:f,onChange:J=>{u(J.target.value),l&&S({startDate:new Date(l),endDate:new Date(J.target.value)})}})]})]})]}),b&&i.jsxs("div",{className:nn.errorAlert,children:[i.jsx(Ar,{size:20}),i.jsx("span",{children:b})]}),!h&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{className:nn.section,id:"analysis-financial",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Hh,{className:"text-blue-600"}),i.jsx("h2",{className:nn.sectionTitle,children:"Financial Performance"})]}),i.jsxs("div",{className:nn.statsGrid,children:[i.jsxs("div",{className:nn.statCard,children:[i.jsx("div",{className:nn.statTitle,children:"Total Revenue Collected"}),i.jsx("div",{className:`${nn.statValue} text-blue-600`,children:G(I)}),i.jsx("div",{className:nn.statSubtitle,children:"All payment modes"})]}),U&&Object.entries(U).map(([J,oe])=>i.jsxs("div",{className:nn.statCard,children:[i.jsxs("div",{className:nn.statTitle,children:[J," Collections"]}),i.jsx("div",{className:nn.statValue,children:G(oe)})]},J))]}),$&&i.jsxs("div",{className:nn.revenueGrid,children:[i.jsxs("div",{className:nn.revenueCard,children:[i.jsx("h3",{className:nn.revenueCardTitle,children:"Reception / Clinic"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:G(((K==null?void 0:K.consultation)||0)+((K==null?void 0:K.other)||0))}),i.jsx("ul",{className:nn.revenueCardList,children:Object.entries($.reception).map(([J,oe])=>i.jsxs("li",{className:nn.revenueCardListItem,children:[i.jsx("span",{children:J}),i.jsx("span",{className:"font-medium text-gray-900",children:G(oe)})]},J))})]}),i.jsxs("div",{className:nn.revenueCard,children:[i.jsx("h3",{className:nn.revenueCardTitle,children:"Pharmacy"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:G((K==null?void 0:K.pharmacy)||0)}),F<0&&i.jsxs("div",{className:"text-sm text-red-500 mb-2",children:["Returns: ",G(F)]}),i.jsx("ul",{className:nn.revenueCardList,children:Object.entries($.pharmacy).map(([J,oe])=>i.jsxs("li",{className:nn.revenueCardListItem,children:[i.jsx("span",{children:J}),i.jsx("span",{className:"font-medium text-gray-900",children:G(oe)})]},J))})]}),i.jsxs("div",{className:nn.revenueCard,children:[i.jsx("h3",{className:nn.revenueCardTitle,children:"Laboratory"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:G((K==null?void 0:K.lab)||0)}),i.jsx("ul",{className:nn.revenueCardList,children:Object.entries($.lab).map(([J,oe])=>i.jsxs("li",{className:nn.revenueCardListItem,children:[i.jsx("span",{children:J}),i.jsx("span",{className:"font-medium text-gray-900",children:G(oe)})]},J))})]})]})]}),i.jsxs("section",{className:nn.section,id:"analysis-inventory",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Wd,{className:"text-emerald-600"}),i.jsx("h2",{className:nn.sectionTitle,children:"Inventory Movement"})]}),W&&W.pharmacyAnalysis.length>0?i.jsx("div",{className:nn.tableContainer,children:i.jsxs("table",{className:nn.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Item Name"}),i.jsx("th",{children:"Stock In"}),i.jsx("th",{children:"Stock Out"}),i.jsx("th",{children:"Net Change"}),i.jsx("th",{className:"text-right",children:"Est. Revenue"}),i.jsx("th",{className:"text-right",children:"Est. Profit"})]})}),i.jsx("tbody",{children:W.pharmacyAnalysis.map(J=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:J.name}),i.jsx("div",{className:"text-xs text-gray-500",children:J.supplier})]}),i.jsxs("td",{className:nn.textGreen,children:["+",J.quantity_in,Object.entries(J.quantity_in_by_reason).map(([oe,ie])=>i.jsxs("div",{className:"text-xs opacity-75",children:[oe,": ",ie]},oe))]}),i.jsxs("td",{className:nn.textRed,children:["-",J.quantity_out,Object.entries(J.quantity_out_by_reason).map(([oe,ie])=>i.jsxs("div",{className:"text-xs opacity-75",children:[oe,": ",ie]},oe))]}),i.jsx("td",{children:i.jsxs("span",{className:`font-semibold ${J.net_change>=0?"text-green-600":"text-red-600"}`,children:[J.net_change>0?"+":"",J.net_change]})}),i.jsx("td",{className:"text-right font-medium",children:G(J.revenue)}),i.jsx("td",{className:`text-right font-medium ${J.profit>=0?"text-green-600":"text-red-600"}`,children:G(J.profit)})]},J.drug_id))})]})}):i.jsx("div",{className:"text-center py-8 text-gray-500 mb-4 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No inventory movement recorded for this period."})]})]}),h&&i.jsxs("div",{className:nn.loadingContainer,children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),i.jsx("div",{children:"Analyzing Financial & Inventory Data..."})]})]})};function Kae(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),h=I=>{r(I),n(!0),I.role==="admin"&&!I.has_seen_tutorial&&u(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const I=localStorage.getItem("authToken"),B=localStorage.getItem("currentUser");if(I&&B)try{const F=JSON.parse(B);r(F),n(!0),F.role==="admin"&&!F.has_seen_tutorial&&u(!0)}catch(F){console.error("Error parsing stored user data:",F),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}o(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const B=await hie();d(B)}catch(B){console.error("Error fetching clinic pro plan status:",B),d({hasProPlan:!1})}else d(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const I=B=>{B.preventDefault(),v(B),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",I),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",I)}},[]),w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),B=()=>{I.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return B(),I.addEventListener("change",B),()=>{I.removeEventListener("change",B),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const I=b;I.prompt();const{outcome:B}=await I.userChoice;console.log(`User response to the install prompt: ${B}`),v(null),k(!1)},[b]),P=async()=>{if(t)try{(await me(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(B=>B?{...B,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),u(!1)):console.error("Failed to update tutorial status on backend.")}catch(I){console.error("Error marking tutorial as seen:",I)}};return a?i.jsx(MP,{}):i.jsx(LP,{clientId:"277898779560-33obduhn8r758rini4qagetdrupvisri.apps.googleusercontent.com",children:i.jsx(vI,{children:i.jsx(xI,{children:i.jsx(bI,{children:i.jsxs(aI,{children:[i.jsx(yI,{children:i.jsxs(Dh,{children:[i.jsx(gt,{path:"/login",element:e?i.jsx(_n,{to:"/dashboard"}):i.jsx(kW,{onLoginSuccess:h})}),i.jsx(gt,{path:"/register",element:e?i.jsx(_n,{to:"/dashboard"}):i.jsx(TW,{})}),i.jsx(gt,{path:"/handle-complaint-url",element:e?i.jsx(zie,{}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/live-api",element:e?i.jsx(jY,{}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/create-lab-order",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(AE,{currentUser:t})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/manage-admission",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(TE,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/lab/report/:orderId",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Xj,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Xj,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/add-patient",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(tw,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/billing",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(vre,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(Qj,{}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/edit-complaint/patient/:patientId",element:e&&t?i.jsx(Qj,{}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(UA,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/*",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:Xae(t.role,t,me)}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Pre,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/lab/search-report",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Dre,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Ire,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(wre,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/inventory",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(qA,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/inventory/add",element:e&&t?i.jsx(_n,{to:"/dashboard/purchase",replace:!0}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/inventory/edit/:id",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx($E,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/lab-inventory",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(dS,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(xre,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Lre,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(iie,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/start-clinic-subscription",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(yie,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/refill-reminders",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx($ie,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/create-custom-bill",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(EE,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Sae,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/lab-billing/:orderId",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Nae,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/analysis",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Jae,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"/dashboard/clinic-hub",element:e&&t?i.jsx(gr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Cae,{})}):i.jsx(_n,{to:"/login"})}),i.jsx(gt,{path:"*",element:i.jsx(_n,{to:e?"/dashboard":"/login"})})]})}),f&&(t==null?void 0:t.role)==="admin"&&i.jsx(Fie,{onClose:()=>u(!1),onMarkAsSeen:P}),e&&t&&i.jsx(Zae,{user:t}),e&&t&&i.jsx(jW,{})]})})})})})}const Xae=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(Dh,{children:[i.jsx(gt,{index:!0,element:i.jsx(Rie,{})}),i.jsx(gt,{path:"clinic-subscriptions",element:i.jsx(pie,{})}),i.jsx(gt,{path:"clinic-subscriptions/add",element:i.jsx(mie,{})}),i.jsx(gt,{path:"clinic-subscriptions/edit/:id",element:i.jsx(gie,{})}),i.jsx(gt,{path:"users",element:i.jsx(xie,{})})," ",i.jsx(gt,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(Dh,{children:[i.jsxs(gt,{path:"/",element:i.jsx($W,{fetchWithAuth:t}),children:[i.jsx(gt,{index:!0,element:i.jsx(oQ,{})}),i.jsx(gt,{path:"search-patient",element:i.jsx(Gm,{})}),i.jsx(gt,{path:"patients",element:i.jsx(Z1,{})})]}),i.jsx(gt,{path:"staff",element:i.jsx(Ore,{fetchWithAuth:t})}),i.jsx(gt,{path:"staff/add",element:i.jsx($J,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(gt,{path:"staff/edit/:id",element:i.jsx(zJ,{})}),i.jsx(gt,{path:"patients/add",element:i.jsx(tw,{})}),i.jsx(gt,{path:"inventory",element:i.jsx(FE,{})}),i.jsx(gt,{path:"inventory/edit/:id",element:i.jsx($E,{})}),i.jsx(gt,{path:"distributors",element:i.jsx(ek,{})}),i.jsx(gt,{path:"purchase",element:i.jsx(tk,{})})," ",i.jsx(gt,{path:"queue",element:i.jsx(z0,{})}),i.jsx(gt,{path:"subscriptions",element:i.jsx(tie,{})}),i.jsx(gt,{path:"subscriptions/add",element:i.jsx(nie,{})}),i.jsx(gt,{path:"subscriptions/edit/:id",element:i.jsx(rie,{})}),i.jsx(gt,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(Dh,{children:[i.jsx(gt,{index:!0,element:i.jsx(_n,{to:"search-patient",replace:!0})}),i.jsx(gt,{path:"search-patient",element:i.jsx(Gm,{})}),i.jsx(gt,{path:"queue",element:i.jsx(z0,{})}),i.jsx(gt,{path:":patientId",element:i.jsx(z0,{})}),i.jsx(gt,{path:"add-patient",element:i.jsx(tw,{})}),i.jsx(gt,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(Dh,{children:[i.jsx(gt,{index:!0,element:i.jsx(dQ,{currentUser:n})}),i.jsx(gt,{path:"all-patients",element:i.jsx(Z1,{})}),i.jsx(gt,{path:"search-patient",element:i.jsx(Gm,{})}),i.jsx(gt,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(MJ,{});case"pharmacy":return i.jsxs(Dh,{children:[i.jsx(gt,{index:!0,element:i.jsx(OJ,{})}),i.jsx(gt,{path:"inventory",element:i.jsx(qA,{})}),i.jsx(gt,{path:"settings",element:i.jsx(FJ,{})}),i.jsx(gt,{path:"add-order",element:i.jsx(Sre,{})}),i.jsx(gt,{path:"edit-pharmacy-order/:orderId",element:i.jsx(UA,{})}),i.jsx(gt,{path:"orders/:orderId",element:i.jsx(Wre,{})}),i.jsx(gt,{path:"search-patient-records",element:i.jsx(Gm,{})}),i.jsx(gt,{path:"distributors",element:i.jsx(ek,{})}),i.jsx(gt,{path:"purchase",element:i.jsx(tk,{})})," ",i.jsx(gt,{path:"*",element:i.jsx(_n,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},gr=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:o})=>{const l=Dt(),[d,f]=w.useState(!1),[u,h]=w.useState(window.innerWidth<=768),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>N1.subscribe(R=>{S(R)}),[]),w.useEffect(()=>{const R=()=>{h(window.innerWidth<=768)};return window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[]),w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const I=await me("/api/clinics/settings");if(I.ok){const B=await I.json();b(B.logoUrl)}else console.error("Failed to fetch clinic details for display:",I.statusText),b(null)}catch(I){console.error("Error fetching clinic details for display:",I),b(null)}else b(null)})()},[e==null?void 0:e.clinic_id]);const k=()=>{f(!d)},{toggleCommandBar:T,isOpen:P}=Uh();return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("a",{href:"#",onClick:R=>{R.preventDefault(),l("/dashboard")},className:"logo-container",children:i.jsx("img",{src:g||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:"Newtons Ai"}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),o&&(o.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),!P&&i.jsx("button",{onClick:T,className:"p-2 mr-2 text-slate-500 rounded-full hover:bg-slate-100 hover:text-slate-900 transition-colors",title:"Search & Commands (Ctrl+K)",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"11",cy:"11",r:"8"}),i.jsx("path",{d:"m21 21-4.3-4.3"})]})}),i.jsx("button",{className:"hamburger-icon",onClick:k,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]}),v&&i.jsx("div",{className:"global-loading-bar"})]}),i.jsx("main",{className:"main-content",children:t}),u?i.jsx(FW,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k,roleNavigation:jE}):i.jsx(LW,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k}),!u&&d&&i.jsx("div",{className:"side-panel-overlay",onClick:k}),!u&&d&&i.jsx("div",{className:"side-panel-overlay",onClick:k})]})},Zae=({user:e})=>{const{isOpen:n,closeAssistant:t}=Tb(),r=Dt(),[a,o]=w.useState(null),[l,d]=w.useState([]);return w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const[u,h]=await Promise.all([me("/api/clinics/settings"),me("/api/staff")]);u.ok&&o(await u.json()),h.ok&&d(await h.json())}catch(u){console.error("Failed to fetch initial AI context",u)}})()},[e.clinic_id]),n?i.jsx("div",{className:"ai-assistant-wrapper",children:i.jsx(nT,{onClose:t,settings:a,staffList:l,onSettingsUpdate:()=>{},onStaffUpdate:()=>{},onHighlight:f=>{f.forEach(u=>{if(u.startsWith("navigate_")){const h=u.replace("navigate_","");r(`/dashboard/analysis?section=${h}`)}else{const h=document.getElementById(u);h&&(h.scrollIntoView({behavior:"smooth",block:"center"}),h.classList.add("ai-highlight-glow"),setTimeout(()=>h.classList.remove("ai-highlight-glow"),2e3))}})}})}):null};RP.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(Kae,{})}));
